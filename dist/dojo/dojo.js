//>>built
(function(m,l){var h,d=function(){return"undefined"!==typeof x&&"function"!==typeof x?x:"undefined"!==typeof window?window:"undefined"!==typeof self?self:this}(),b=function(){},g=function(p){for(var A in p)return 0;return 1},k={}.toString,f=function(p){return"[object Function]"==k.call(p)},a=function(p){return"[object String]"==k.call(p)},e=function(p){return"[object Array]"==k.call(p)},c=function(p,A){if(p)for(var n=0;n<p.length;)A(p[n++])},q=function(p,A){for(var n in A)p[n]=A[n];return p},t=function(p,
A){return q(Error(p),{src:"dojoLoader",info:A})},r=1,u=function(){return"_"+r++},v=function(p,A,n){return na(p,A,n,0,v)},x=d,y=x.document,n=y&&y.createElement("DiV"),w=v.has=function(p){return f(z[p])?z[p]=z[p](x,y,n):z[p]},z=w.cache=l.hasCache;f(m)&&(m=m(d));w.add=function(p,A,n,a){(void 0===z[p]||a)&&(z[p]=A);return n&&w(p)};w.add("host-webworker","undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope);w("host-webworker")&&(q(l.hasCache,{"host-browser":0,dom:0,"dojo-dom-ready-api":0,
"dojo-sniff":0,"dojo-inject-api":1,"host-webworker":1,"dojo-guarantee-console":0}),l.loaderPatch={injectUrl:function(p,A){try{importScripts(p),A()}catch(ob){console.info("failed to load resource ("+p+")"),console.error(ob)}}});for(var C in m.has)w.add(C,m.has[C],0,1);v.async=1;var B=w("csp-restrictions")?function(){}:new Function("return eval(arguments[0]);");v.eval=function(p,A){return B(p+"\r\n//# sourceURL\x3d"+A)};var F={},G=v.signal=function(p,A){p=F[p];c(p&&p.slice(0),function(p){p.apply(null,
e(A)?A:[A])})};C=v.on=function(p,A){var n=F[p]||(F[p]=[]);n.push(A);return{remove:function(){for(var p=0;p<n.length;p++)if(n[p]===A){n.splice(p,1);break}}}};var N=[],M={},R=[],P={},Q=v.map={},T=[],O={},S="",H={},Y={},d={},W=0,E=function(p){var A,n,a,c;for(A in Y)n=Y[A],(a=A.match(/^url\:(.+)/))?H["url:"+Ia(a[1],p)]=n:"*now"==A?c=n:"*noref"!=A&&(a=Fa(A,p,!0),H[a.mid]=H["url:"+a.url]=n);c&&c(za(p));Y={}},p=function(p){return p.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(p){return"\\"+p})},A=function(A,
n){n.splice(0,n.length);for(var a in A)n.push([a,A[a],new RegExp("^"+p(a)+"(/|$)"),a.length]);n.sort(function(p,A){return A[3]-p[3]});return n},K=function(A,n){c(A,function(A){n.push([a(A[0])?new RegExp("^"+p(A[0])+"$"):A[0],A[1]])})},U=function(p){var A=p.name;A||(A=p,p={name:A});p=q({main:"main"},p);p.location=p.location?p.location:A;p.packageMap&&(Q[A]=p.packageMap);p.main.indexOf("./")||(p.main=p.main.substring(2));P[A]=p},V=[],X=function(p,n,e){for(var f in p){"waitSeconds"==f&&(v.waitms=1E3*
(p[f]||0));"cacheBust"==f&&(S=p[f]?a(p[f])?p[f]:(new Date).getTime()+"":"");if("baseUrl"==f||"combo"==f)v[f]=p[f];p[f]!==z&&(v.rawConfig[f]=p[f],"has"!=f&&w.add("config-"+f,p[f],0,n))}v.baseUrl||(v.baseUrl="./");/\/$/.test(v.baseUrl)||(v.baseUrl+="/");for(f in p.has)w.add(f,p.has[f],0,n);c(p.packages,U);for(var b in p.packagePaths)c(p.packagePaths[b],function(p){var A=b+"/"+p;a(p)&&(p={name:p});p.location=A;U(p)});A(q(Q,p.map),T);c(T,function(p){p[1]=A(p[1],[]);"*"==p[0]&&(T.star=p)});A(q(M,p.paths),
R);K(p.aliases,N);if(n)V.push({config:p.config});else for(f in p.config)n=ma(f,e),n.config=q(n.config||{},p.config[f]);p.cache&&(E(),Y=p.cache,p.cache["*noref"]&&E());G("config",[p,v.rawConfig])};if(w("dojo-cdn")){var ba=y.getElementsByTagName("script");h=0;for(var fa,ha,ca,ea;h<ba.length;)if(fa=ba[h++],(ca=fa.getAttribute("src"))&&(ea=ca.match(/(((.*)\/)|^)dojo\.js(\W|$)/i))&&(ha=ea[3]||"",l.baseUrl=l.baseUrl||ha,W=fa),ca=fa.getAttribute("data-dojo-config")||fa.getAttribute("djConfig"))d=v.eval("({ "+
ca+" })","data-dojo-config"),W=fa}v.rawConfig={};X(l,1);w("dojo-cdn")&&((P.dojo.location=ha)&&(ha+="/"),P.dijit.location=ha+"../dijit/",P.dojox.location=ha+"../dojox/");X(m,1);X(d,1);var ja=function(p){aa(function(){c(p.deps,la)})},na=function(p,A,n,c,f){var w;if(a(p)){if((w=ma(p,c,!0))&&w.executed)return w.result;throw t("undefinedModule",p);}e(p)||(X(p,0,c),p=A,A=n);if(e(p))if(p.length){n="require*"+u();for(var K,d=[],E=0;E<p.length;)K=p[E++],d.push(ma(K,c));w=q(Ea("",n,0,""),{injected:2,deps:d,
def:A||b,require:c?c.require:v,gc:1});O[w.mid]=w;ja(w);var g=Ga&&!0;aa(function(){ka(w,g)});w.executed||ua.push(w);ya()}else A&&A();return f},za=function(p){if(!p)return v;var A=p.require;A||(A=function(n,a,c){return na(n,a,c,p,A)},p.require=q(A,v),A.module=p,A.toUrl=function(A){return Ia(A,p)},A.toAbsMid=function(A){return Pa(A,p)});return A},ua=[],wa=[],da={},ra=function(p){p.injected=1;da[p.mid]=1;p.url&&(da[p.url]=p.pack||1);Lb()},ga=function(p){p.injected=2;delete da[p.mid];p.url&&delete da[p.url];
g(da)&&pb()},pa=v.idle=function(){return!wa.length&&g(da)&&!ua.length&&!Ga},J=function(p,A){if(A)for(var n=0;n<A.length;n++)if(A[n][2].test(p))return A[n];return 0},D=function(p){var A=[],n,a;for(p=p.replace(/\\/g,"/").split("/");p.length;)n=p.shift(),".."==n&&A.length&&".."!=a?(A.pop(),a=A[A.length-1]):"."!=n&&A.push(a=n);return A.join("/")},Ea=function(p,A,n,a){return{pid:p,mid:A,pack:n,url:a,executed:0,def:0}},L=function(p,A,n,a,e,w,b,K,d){var E,g,q,r;r=/^\./.test(p);if(/(^\/)|(\:)|(\.js$)/.test(p)||
r&&!A)return Ea(0,p,0,p);p=D(r?A.mid+"/../"+p:p);if(/^\./.test(p))throw t("irrationalPath",p);A&&(q=J(A.mid,w));(q=(q=q||w.star)&&J(p,q[1]))&&(p=q[1]+p.substring(q[3]));A=(ea=p.match(/^([^\/]+)(\/(.+))?$/))?ea[1]:"";(E=n[A])?p=A+"/"+(g=ea[3]||E.main):A="";var k=0;c(K,function(A){var n=p.match(A[0]);n&&0<n.length&&(k=f(A[1])?p.replace(A[0],A[1]):A[1])});if(k)return L(k,0,n,a,e,w,b,K,d);if(n=a[p])return d?Ea(n.pid,n.mid,n.pack,n.url):a[p];a=(q=J(p,b))?q[1]+p.substring(q[3]):A?E.location+"/"+g:p;/(^\/)|(\:)/.test(a)||
(a=e+a);return Ea(A,p,E,D(a+".js"))},Fa=function(p,A,n){return L(p,A,P,O,v.baseUrl,n?[]:T,n?[]:R,n?[]:N)},sa=function(p,A,n){return p.normalize?p.normalize(A,function(p){return Pa(p,n)}):Pa(A,n)},Z=0,ma=function(p,A,n){var a,c;(a=p.match(/^(.+?)\!(.*)$/))?(c=ma(a[1],A,n),5!==c.executed||c.load||Wa(c),c.load?(a=sa(c,a[2],A),p=c.mid+"!"+(c.dynamic?++Z+"!":"")+a):(a=a[2],p=c.mid+"!"+ ++Z+"!waitingForPlugin"),p={plugin:c,mid:p,req:za(A),prid:a}):p=Fa(p,A);return O[p.mid]||!n&&(O[p.mid]=p)},Pa=v.toAbsMid=
function(p,A){return Fa(p,A).mid},Ia=v.toUrl=function(p,A){A=Fa(p+"/x",A);var n=A.url;return Aa(0===A.pid?p:n.substring(0,n.length-5))},Ha={injected:2,executed:5,def:3,result:3};ha=function(p){return O[p]=q({mid:p},Ha)};var Xa=ha("require"),oa=ha("exports"),Ma=ha("module"),Ka={},va=0,Wa=function(p){var A=p.result;p.dynamic=A.dynamic;p.normalize=A.normalize;p.load=A.load;return p},Za=function(p){var A={};c(p.loadQ,function(n){var a=sa(p,n.prid,n.req.module),c=p.dynamic?n.mid.replace(/waitingForPlugin$/,
a):p.mid+"!"+a,a=q(q({},n),{mid:c,prid:a,injected:0});O[c]&&O[c].injected||Ca(O[c]=a);A[n.mid]=O[c];ga(n);delete O[n.mid]});p.loadQ=0;var n=function(p){for(var n=p.deps||[],a=0;a<n.length;a++)(p=A[n[a].mid])&&(n[a]=p)},a;for(a in O)n(O[a]);c(ua,n)},Ba=function(p){v.trace("loader-finish-exec",[p.mid]);p.executed=5;p.defOrder=va++;p.loadQ&&(Wa(p),Za(p));for(h=0;h<ua.length;)ua[h]===p?ua.splice(h,1):h++;/^require\*/.test(p.mid)&&delete O[p.mid]},Va=[],ka=function(p,A){if(4===p.executed)return v.trace("loader-circular-dependency",
[Va.concat(p.mid).join("-\x3e")]),!p.def||A?Ka:p.cjs&&p.cjs.exports;if(!p.executed){if(!p.def)return Ka;var n=p.mid,a=p.deps||[],c,e=[],w=0;for(p.executed=4;c=a[w++];){c=c===Xa?za(p):c===oa?p.cjs.exports:c===Ma?p.cjs:ka(c,A);if(c===Ka)return p.executed=0,v.trace("loader-exec-module",["abort",n]),Ka;e.push(c)}v.trace("loader-run-factory",[p.mid]);A=p.def;e=f(A)?A.apply(null,e):A;p.result=void 0===e&&p.cjs?p.cjs.exports:e;Ba(p)}return p.result},Ga=0,aa=function(p){try{Ga++,p()}catch(qb){throw qb;}finally{Ga--}pa()&&
G("idle",[])},ya=function(){Ga||aa(function(){for(var p,A,n=0;n<ua.length;)p=va,A=ua[n],ka(A),p!=va?n=0:n++})},Aa="function"==typeof m.fixupUrl?m.fixupUrl:function(p){p+="";return p+(S?(/\?/.test(p)?"\x26":"?")+S:"")};void 0===w("dojo-loader-eval-hint-url")&&w.add("dojo-loader-eval-hint-url",1);var Ca=function(p){var A=p.plugin;5!==A.executed||A.load||Wa(A);var n=function(A){p.result=A;ga(p);Ba(p);ya()};A.load?A.load(p.prid,p.req,n):A.loadQ?A.loadQ.push(p):(A.loadQ=[p],ua.unshift(A),la(A))},ta=0,
xa=function(p,A){w("config-stripStrict")&&(p=p.replace(/(["'])use strict\1/g,""));p===ta?ta.call(null):v.eval(p,w("dojo-loader-eval-hint-url")?A.url:A.mid)},la=function(p){var A=p.mid,n=p.url;if(!(p.executed||p.injected||da[A]||p.url&&(p.pack&&da[p.url]===p.pack||1==da[p.url])))if(ra(p),p.plugin)Ca(p);else{var a=function(){Ya(p);if(2!==p.injected){if(w("dojo-enforceDefine")){G("error",t("noDefine",p));return}ga(p);q(p,Ha);v.trace("loader-define-nonmodule",[p.url])}ya()};(ta=H[A]||H["url:"+p.url])?
(v.trace("loader-inject",["cache",p.mid,n]),xa(ta,p),a()):(v.trace("loader-inject",["script",p.mid,n]),v.injectUrl(Aa(n),a,p))}},sb=function(p,A,n){v.trace("loader-define-module",[p.mid,A]);if(2===p.injected)return G("error",t("multipleDefine",p)),p;q(p,{deps:A,def:n,cjs:{id:p.mid,uri:p.url,exports:p.result={},setExports:function(A){p.cjs.exports=A},config:function(){return p.config}}});for(var a=0;A[a];a++)A[a]=ma(A[a],p);ga(p);f(n)||A.length||(p.result=n,Ba(p));return p},Ya=function(p,A){for(var n=
[],a,e;wa.length;)e=wa.shift(),A&&(e[0]=A.shift()),a=e[0]&&ma(e[0])||p,n.push([a,e[1],e[2]]);E(p);c(n,function(p){ja(sb.apply(null,p))})},pb=b,Lb=b;w("dom");if(w("dom")){var jb=function(p,A,n,a){p.addEventListener(A,a,!1);return function(){p.removeEventListener(A,a,!1)}},Db=jb(window,"load","onload",function(){v.pageLoaded=1;try{"complete"!=y.readyState&&(y.readyState="complete")}catch(vb){}Db()}),ba=y.getElementsByTagName("script");for(h=0;!W;)/^dojo/.test((fa=ba[h++])&&fa.type)||(W=fa);v.injectUrl=
function(p,A,n){n=n.node=y.createElement("script");var a=jb(n,"load","onreadystatechange",function(p){p=p||window.event;var n=p.target||p.srcElement;if("load"===p.type||/complete|loaded/.test(n.readyState))a(),c(),A&&A()}),c=jb(n,"error","onerror",function(A){a();c();G("error",t("scriptError",[p,A]))});n.type="text/javascript";n.charset="utf-8";n.src=p;W.parentNode.insertBefore(n,W);return n}}v.log=b;v.trace=b;fa=function(p,A,n){var c=arguments.length,e=["require","exports","module"],w=[0,p,A];1==
c?w=[0,f(p)?e:[],p]:2==c&&a(p)?w=[p,f(A)?e:[],A]:3==c&&(w=[p,A,n]);v.trace("loader-define",w.slice(0,2));(c=w[0]&&ma(w[0]))&&!da[c.mid]?ja(sb(c,w[1],w[2])):wa.push(w)};fa.amd={vendor:"dojotoolkit.org"};q(q(v,l.loaderPatch),m.loaderPatch);C("error",function(p){try{if(console.error(p),p instanceof Error){for(var A in p)console.log(A+":",p[A]);console.log(".")}}catch(ob){}});q(v,{uid:u,cache:H,packs:P});x.define||(x.define=fa,x.require=v,c(V,function(p){X(p)}),fa=d.deps||m.deps||l.deps,m=d.callback||
m.callback||l.callback,v.boot=fa||m?[fa||[],m]:0)})(function(m){return m.dojoConfig||m.djConfig||m.require||{}},{async:1,baseUrl:"dojo",hasCache:{"config-deferredInstrumentation":0,"config-selectorEngine":"lite","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-has-api":1,"dojo-loader":1,"dojo-undef-api":0,dom:1,"esri-featurelayer-webgl":0,"esri-promise-compatibility":0,"esri-promise-compatibility-deprecation-warnings":1,"host-browser":1},packages:[{location:"../app",name:"app"},{location:"../dijit",
name:"dijit"},{location:".",name:"dojo"},{location:"../dojox",name:"dojox"},{location:"../dstore",main:"Store",name:"dstore"},{location:"../dgrid",main:"OnDemandGrid",name:"dgrid"},{location:"../esri",name:"esri"},{location:"../moment",main:"moment",name:"moment"}]});
require({cache:{"dojo/domReady":function(){define(["./global","./has"],function(m,l){function h(c){a.push(c);f&&d()}function d(){if(!e){for(e=!0;a.length;)try{a.shift()(b)}catch(r){console.error(r,"in domReady callback",r.stack)}e=!1;h._onQEmpty()}}var b=document,g={loaded:1,complete:1},k="string"!=typeof b.readyState,f=!!g[b.readyState],a=[],e;h.load=function(a,c,e){h(e)};h._Q=a;h._onQEmpty=function(){};k&&(b.readyState="loading");if(!f){var c=[],q=function(a){a=a||m.event;f||"readystatechange"==
a.type&&!g[b.readyState]||(k&&(b.readyState="complete"),f=1,d())};l=function(c,e){c.addEventListener(e,q,!1);a.push(function(){c.removeEventListener(e,q,!1)})};l(b,"DOMContentLoaded");l(m,"load");"onreadystatechange"in b?l(b,"readystatechange"):k||c.push(function(){return g[b.readyState]});if(c.length){var t=function(){if(!f){for(var a=c.length;a--;)if(c[a]()){q("poller");return}setTimeout(t,30)}};t()}}return h})},"dojo/global":function(){define(function(){return"undefined"!==typeof global&&"function"!==
typeof global?global:"undefined"!==typeof window?window:"undefined"!==typeof self?self:this})},"dojo/has":function(){define(["./global","require","module"],function(m,l,h){var d=l.has||function(){};if(!d("dojo-has-api")){var b=(l="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location==location&&window.document==document)&&document,g=b&&b.createElement("DiV"),k=h.config&&h.config()||{},d=function(f){return"function"==typeof k[f]?k[f]=k[f](m,b,g):k[f]};
d.cache=k;d.add=function(f,a,e,c){("undefined"==typeof k[f]||c)&&(k[f]=a);return e&&d(f)};d.add("host-browser",l);d.add("dom",l)}d("host-browser")&&(d.add("touch","ontouchstart"in document||"onpointerdown"in document&&0<navigator.maxTouchPoints||window.navigator.msMaxTouchPoints),d.add("touch-events","ontouchstart"in document),d.add("device-width",screen.availWidth||innerWidth),h=document.createElement("form"),d.add("dom-attributes-specified-flag",0<h.attributes.length&&40>h.attributes.length));d.clearElement=
function(f){f.innerHTML="";return f};d.normalize=function(f,a){var e=f.match(/[\?:]|[^:\?]*/g),c=0,b=function(a){var f=e[c++];if(":"==f)return 0;if("?"==e[c++]){if(!a&&d(f))return b();b(!0);return b(a)}return f||0};return(f=b())&&a(f)};d.load=function(f,a,e){f?a([f],e):e()};return d})},"dojo/_base/browser":function(){require.has&&require.has.add("config-selectorEngine","acme");define("../ready ./kernel ./connect ./unload ./window ./event ./html ./NodeList ../query ./xhr ./fx".split(" "),function(m){return m})},
"dojo/ready":function(){define(["./_base/kernel","./has","require","./has!host-browser?./domReady","./_base/lang"],function(m,l,h,d,b){var g=0,k=[],f=0;l=function(){g=1;m._postLoad=m.config.afterOnLoad=!0;a()};var a=function(){if(!f){for(f=1;g&&(!d||0==d._Q.length)&&(h.idle?h.idle():1)&&k.length;){var a=k.shift();try{a()}catch(t){if(t.info=t.message,h.signal)h.signal("error",t);else throw t;}}f=0}};h.on&&h.on("idle",a);d&&(d._onQEmpty=a);var e=m.ready=m.addOnLoad=function(c,e,f){var d=b._toArray(arguments);
"number"!=typeof c?(f=e,e=c,c=1E3):d.shift();f=f?b.hitch.apply(m,d):function(){e()};f.priority=c;for(d=0;d<k.length&&c>=k[d].priority;d++);k.splice(d,0,f);a()},c=m.config.addOnLoad;if(c)e[b.isArray(c)?"apply":"call"](m,c);d?d(l):l();return e})},"dojo/_base/kernel":function(){define(["../global","../has","./config","require","module"],function(m,l,h,d,b){var g,k={},f={},a={config:h,global:m,dijit:k,dojox:f},k={dojo:["dojo",a],dijit:["dijit",k],dojox:["dojox",f]};b=d.map&&d.map[b.id.match(/[^\/]+/)[0]];
for(g in b)k[g]?k[g][0]=b[g]:k[g]=[b[g],{}];for(g in k)b=k[g],b[1]._scopeName=b[0],h.noGlobals||(m[b[0]]=b[1]);a.scopeMap=k;a.baseUrl=a.config.baseUrl=d.baseUrl;a.isAsync=d.async;a.locale=h.locale;m="$Rev: aaa6750 $".match(/[0-9a-f]{7,}/);a.version={major:1,minor:13,patch:0,flag:"",revision:m?m[0]:NaN,toString:function(){var c=a.version;return c.major+"."+c.minor+"."+c.patch+c.flag+" ("+c.revision+")"}};l("csp-restrictions")||Function("d","d.eval \x3d function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(a);
a.exit=function(){};l("host-webworker");"undefined"!=typeof console||(console={});m="assert count debug dir dirxml error group groupEnd info profile profileEnd time timeEnd trace warn log".split(" ");var e;for(l=0;e=m[l++];)console[e]?console[e]=Function.prototype.bind.call(console[e],console):function(){var a=e+"";console[a]="log"in console?function(){var c=Array.prototype.slice.call(arguments);c.unshift(a+":");console.log(c.join(" "))}:function(){};console[a]._fake=!0}();a.deprecated=a.experimental=
function(){};a._hasResource={};return a})},"dojo/_base/config":function(){define(["../global","../has","require"],function(m,l,h){m={};h=h.rawConfig;for(var d in h)m[d]=h[d];!m.locale&&"undefined"!=typeof navigator&&(d=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language||navigator.userLanguage)&&(m.locale=d.toLowerCase());return m})},"dojo/_base/lang":function(){define(["./kernel","../has","../sniff"],function(m,l){var h=function(f,a,e){e||(e=f[0]&&m.scopeMap[f[0]]?
m.scopeMap[f.shift()][1]:m.global);try{for(var c=0;c<f.length;c++){var b=f[c];if(!(b in e))if(a)e[b]={};else return;e=e[b]}return e}catch(t){}},d=Object.prototype.toString,b=function(f,a,e){return(e||[]).concat(Array.prototype.slice.call(f,a||0))},g=/\{([^\}]+)\}/g,k={_extraNames:[],_mixin:function(f,a,e){var c,b,d={};for(c in a)b=a[c],c in f&&(f[c]===b||c in d&&d[c]===b)||(f[c]=e?e(b):b);return f},mixin:function(f,a){f||(f={});for(var e=1,c=arguments.length;e<c;e++)k._mixin(f,arguments[e]);return f},
setObject:function(f,a,e){var c=f.split(".");f=c.pop();return(e=h(c,!0,e))&&f?e[f]=a:void 0},getObject:function(f,a,e){return f?h(f.split("."),a,e):e},exists:function(f,a){return void 0!==k.getObject(f,!1,a)},isString:function(f){return"string"==typeof f||f instanceof String},isArray:Array.isArray||function(f){return"[object Array]"==d.call(f)},isFunction:function(f){return"[object Function]"===d.call(f)},isObject:function(f){return void 0!==f&&(null===f||"object"==typeof f||k.isArray(f)||k.isFunction(f))},
isArrayLike:function(f){return!!f&&!k.isString(f)&&!k.isFunction(f)&&!(f.tagName&&"form"==f.tagName.toLowerCase())&&(k.isArray(f)||isFinite(f.length))},isAlien:function(f){return f&&!k.isFunction(f)&&/\{\s*\[native code\]\s*\}/.test(String(f))},extend:function(f,a){for(var e=1,c=arguments.length;e<c;e++)k._mixin(f.prototype,arguments[e]);return f},_hitchArgs:function(f,a){var e=k._toArray(arguments,2),c=k.isString(a);return function(){var b=k._toArray(arguments),d=c?(f||m.global)[a]:a;return d&&d.apply(f||
this,e.concat(b))}},hitch:function(f,a){if(2<arguments.length)return k._hitchArgs.apply(m,arguments);a||(a=f,f=null);if(k.isString(a)){f=f||m.global;if(!f[a])throw['lang.hitch: scope["',a,'"] is null (scope\x3d"',f,'")'].join("");return function(){return f[a].apply(f,arguments||[])}}return f?function(){return a.apply(f,arguments||[])}:a},delegate:function(){function f(){}return function(a,e){f.prototype=a;a=new f;f.prototype=null;e&&k._mixin(a,e);return a}}(),_toArray:l("ie")?function(){function f(a,
e,c){c=c||[];for(e=e||0;e<a.length;e++)c.push(a[e]);return c}return function(a){return(a.item?f:b).apply(this,arguments)}}():b,partial:function(f){return k.hitch.apply(m,[null].concat(k._toArray(arguments)))},clone:function(f){if(!f||"object"!=typeof f||k.isFunction(f))return f;if(f.nodeType&&"cloneNode"in f)return f.cloneNode(!0);if(f instanceof Date)return new Date(f.getTime());if(f instanceof RegExp)return new RegExp(f);var a,e,c;if(k.isArray(f))for(a=[],e=0,c=f.length;e<c;++e)e in f&&(a[e]=k.clone(f[e]));
else a=f.constructor?new f.constructor:{};return k._mixin(a,f,k.clone)},trim:String.prototype.trim?function(f){return f.trim()}:function(f){return f.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(f,a,e){return f.replace(e||g,k.isFunction(a)?a:function(c,e){return k.getObject(e,!1,a)})}};k.mixin(m,k);return k})},"dojo/sniff":function(){define(["./has"],function(m){if(m("host-browser")){var l=navigator,h=l.userAgent,l=l.appVersion,d=parseFloat(l);m.add("webkit",void 0);m.add("chrome",void 0);
m.add("safari",(0<=l.indexOf("Safari")&&m("chrome"),void 0));if(h.match(/(iPhone|iPod|iPad)/)){var b=RegExp.$1.replace(/P/,"p"),g=h.match(/OS ([\d_]+)/)?RegExp.$1:"1",g=parseFloat(g.replace(/_/,".").replace(/_/g,""));m.add(b,g);m.add("ios",g)}m("webkit")||(0<=h.indexOf("Opera")&&m.add("opera",9.8<=d?parseFloat(h.split("Version/")[1])||d:d),h.indexOf("Gecko"),document.all&&!m("opera")&&(h=parseFloat(l.split("MSIE ")[1])||void 0,(l=document.documentMode)&&5!=l&&Math.floor(h)!=l&&(h=l),m.add("ie",h)))}return m})},
"dojo/_base/connect":function(){define("./kernel ../on ../topic ../aspect ./event ../mouse ./sniff ./lang ../keys".split(" "),function(m,l,h,d,b,g,k,f){function a(a,c,e,b,n){b=f.hitch(e,b);if(!a||!a.addEventListener&&!a.attachEvent)return d.after(a||m.global,c,b,!0);"string"==typeof c&&"on"==c.substring(0,2)&&(c=c.substring(2));a||(a=m.global);if(!n)switch(c){case "keypress":c=t;break;case "mouseenter":c=g.enter;break;case "mouseleave":c=g.leave}return l(a,c,b,n)}function e(a){a.keyChar=a.charCode?
String.fromCharCode(a.charCode):"";a.charOrCode=a.keyChar||a.keyCode}k.add("events-keypress-typed",function(){var a={charCode:0};try{a=document.createEvent("KeyboardEvent"),(a.initKeyboardEvent||a.initKeyEvent).call(a,"keypress",!0,!0,null,!1,!1,!1,!1,9,3)}catch(v){}return 0==a.charCode&&!k("opera")});var c={106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,229:113},q=function(a,c){c=f.mixin({},a,c);e(c);c.preventDefault=function(){a.preventDefault()};c.stopPropagation=
function(){a.stopPropagation()};return c},t;t=k("events-keypress-typed")?function(a,e){var f=l(a,"keydown",function(n){var a=n.keyCode,f=13!=a&&32!=a&&(27!=a||!k("ie"))&&(48>a||90<a)&&(96>a||111<a)&&(186>a||192<a)&&(219>a||222<a)&&229!=a;if(f||n.ctrlKey){f=f?0:a;if(n.ctrlKey){if(3==a||13==a)return e.call(n.currentTarget,n);f=95<f&&106>f?f-48:!n.shiftKey&&65<=f&&90>=f?f+32:c[f]||f}a=q(n,{type:"keypress",faux:!0,charCode:f});e.call(n.currentTarget,a);if(k("ie"))try{n.keyCode=a.keyCode}catch(C){}}}),
b=l(a,"keypress",function(n){var a=n.charCode;n=q(n,{charCode:32<=a?a:0,faux:!0});return e.call(this,n)});return{remove:function(){f.remove();b.remove()}}}:k("opera")?function(a,c){return l(a,"keypress",function(a){var e=a.which;3==e&&(e=99);e=32>e&&!a.shiftKey?0:e;a.ctrlKey&&!a.shiftKey&&65<=e&&90>=e&&(e+=32);return c.call(this,q(a,{charCode:e}))})}:function(a,c){return l(a,"keypress",function(a){e(a);return c.call(this,a)})};var r={_keypress:t,connect:function(c,e,f,b,n){var w=arguments,d=[],g=
0;d.push("string"==typeof w[0]?null:w[g++],w[g++]);var q=w[g+1];d.push("string"==typeof q||"function"==typeof q?w[g++]:null,w[g++]);for(q=w.length;g<q;g++)d.push(w[g]);return a.apply(this,d)},disconnect:function(a){a&&a.remove()},subscribe:function(a,c,e){return h.subscribe(a,f.hitch(c,e))},publish:function(a,c){return h.publish.apply(h,[a].concat(c))},connectPublisher:function(a,c,e){var f=function(){r.publish(a,arguments)};return e?r.connect(c,e,f):r.connect(c,f)},isCopyKey:function(a){return a.metaKey}};
r.unsubscribe=r.disconnect;f.mixin(m,r);return r})},"dojo/on":function(){define(["require","./_base/kernel","./sniff"],function(m,l,h){function d(a,e,b,d,g){if(d=e.match(/(.*):(.*)/))return e=d[2],d=d[1],k.selector(d,e).call(g,a,b);h("touch")&&f.test(e)&&(b=t(b));if(a.addEventListener){var n=e in c,w=n?c[e]:e;a.addEventListener(w,b,n);return{remove:function(){a.removeEventListener(w,b,n)}}}throw Error("Target must be an event emitter");}function b(){this.cancelable=!1;this.defaultPrevented=!0}function g(){this.bubbles=
!1}h("dom")&&h("touch");var k=function(a,c,e,f){return"function"!=typeof a.on||"function"==typeof c||a.nodeType?k.parse(a,c,e,d,f,this):a.on(c,e)};k.pausable=function(a,c,e,f){var b;a=k(a,c,function(){if(!b)return e.apply(this,arguments)},f);a.pause=function(){b=!0};a.resume=function(){b=!1};return a};k.once=function(a,c,e,f){var b=k(a,c,function(){b.remove();return e.apply(this,arguments)});return b};k.parse=function(a,c,e,f,b,n){var w;if(c.call)return c.call(n,a,e);c instanceof Array?w=c:-1<c.indexOf(",")&&
(w=c.split(/\s*,\s*/));if(w){var d=[];c=0;for(var g;g=w[c++];)d.push(k.parse(a,g,e,f,b,n));d.remove=function(){for(var n=0;n<d.length;n++)d[n].remove()};return d}return f(a,c,e,b,n)};var f=/^touch/;k.matches=function(a,c,e,f,b){b=b&&"function"==typeof b.matches?b:l.query;f=!1!==f;1!=a.nodeType&&(a=a.parentNode);for(;!b.matches(a,c,e);)if(a==e||!1===f||!(a=a.parentNode)||1!=a.nodeType)return!1;return a};k.selector=function(a,c,e){return function(f,b){function n(n){return k.matches(n,a,f,e,w)}var w=
"function"==typeof a?{matches:a}:this,d=c.bubble;return d?k(f,d(n),b):k(f,c,function(a){var c=n(a.target);if(c)return a.selectorTarget=c,b.call(c,a)})}};var a=[].slice,e=k.emit=function(c,e,f){var d=a.call(arguments,2),q="on"+e;if("parentNode"in c){var n=d[0]={},w;for(w in f)n[w]=f[w];n.preventDefault=b;n.stopPropagation=g;n.target=c;n.type=e;f=n}do c[q]&&c[q].apply(c,d);while(f&&f.bubbles&&(c=c.parentNode));return f&&f.cancelable&&f},c={};k.emit=function(a,c,f){if(a.dispatchEvent&&document.createEvent){var b=
(a.ownerDocument||document).createEvent("HTMLEvents");b.initEvent(c,!!f.bubbles,!!f.cancelable);for(var d in f)d in b||(b[d]=f[d]);return a.dispatchEvent(b)&&b}return e.apply(k,arguments)};if(h("touch"))var q=window.orientation,t=function(a){return function(c){var e=c.corrected;if(!e){var f=c.type;try{delete c.type}catch(w){}if(c.type){var e={},b;for(b in c)e[b]=c[b];e.preventDefault=function(){c.preventDefault()};e.stopPropagation=function(){c.stopPropagation()}}else e=c,e.type=f;c.corrected=e;if("resize"==
f){if(q==window.orientation)return null;q=window.orientation;e.type="orientationchange";return a.call(this,e)}"rotation"in e||(e.rotation=0,e.scale=1);if(window.TouchEvent&&c instanceof TouchEvent){var f=e.changedTouches[0],n;for(n in f)delete e[n],e[n]=f[n]}}return a.call(this,e)}};return k})},"dojo/topic":function(){define(["./Evented"],function(m){var l=new m;return{publish:function(h,d){return l.emit.apply(l,arguments)},subscribe:function(h,d){return l.on.apply(l,arguments)}}})},"dojo/Evented":function(){define(["./aspect",
"./on"],function(m,l){function h(){}var d=m.after;h.prototype={on:function(b,g){return l.parse(this,b,g,function(b,f){return d(b,"on"+f,g,!0)})},emit:function(b,d){var g=[this];g.push.apply(g,arguments);return l.emit.apply(l,g)}};return h})},"dojo/aspect":function(){define([],function(){function m(b,f,a,e){var c=b[f],d="around"==f,g;if(d){var k=a(function(){return c.advice(this,arguments)});g={remove:function(){k&&(k=b=a=null)},advice:function(a,e){return k?k.apply(a,e):c.advice(a,e)}}}else g={remove:function(){if(g.advice){var c=
g.previous,e=g.next;e||c?(c?c.next=e:b[f]=e,e&&(e.previous=c)):delete b[f];b=a=g.advice=null}},id:b.nextId++,advice:a,receiveArguments:e};if(c&&!d)if("after"==f){for(;c.next&&(c=c.next););c.next=g;g.previous=c}else"before"==f&&(b[f]=g,g.next=c,c.previous=g);else b[f]=g;return g}function l(b){return function(f,a,e,c){var d=f[a],g;d&&d.target==f||(f[a]=g=function(){for(var a=g.nextId,c=arguments,e=g.before;e;)e.advice&&(c=e.advice.apply(this,c)||c),e=e.next;if(g.around)var f=g.around.advice(this,c);
for(e=g.after;e&&e.id<a;){if(e.advice)if(e.receiveArguments)var b=e.advice.apply(this,c),f=b===h?f:b;else f=e.advice.call(this,f,c);e=e.next}return f},d&&(g.around={advice:function(a,c){return d.apply(a,c)}}),g.target=f,g.nextId=g.nextId||0);f=m(g||d,b,e,c);e=null;return f}}var h,d=l("after"),b=l("before"),g=l("around");return{before:b,around:g,after:d}})},"dojo/_base/event":function(){define(["./kernel","../on","../has","../dom-geometry"],function(m,l,h,d){if(l._fixEvent){var b=l._fixEvent;l._fixEvent=
function(g,k){(g=b(g,k))&&d.normalizeEvent(g);return g}}h={fix:function(b,d){return l._fixEvent?l._fixEvent(b,d):b},stop:function(b){b.preventDefault();b.stopPropagation()}};m.fixEvent=h.fix;m.stopEvent=h.stop;return h})},"dojo/dom-geometry":function(){define(["./sniff","./_base/window","./dom","./dom-style"],function(m,l,h,d){function b(a,c,f,b,d,g){g=g||"px";a=a.style;isNaN(c)||(a.left=c+g);isNaN(f)||(a.top=f+g);0<=b&&(a.width=b+g);0<=d&&(a.height=d+g)}function g(a){return"button"==a.tagName.toLowerCase()||
"input"==a.tagName.toLowerCase()&&"button"==(a.getAttribute("type")||"").toLowerCase()}function k(a){return"border-box"==f.boxModel||"table"==a.tagName.toLowerCase()||g(a)}var f={boxModel:"content-box"};m("ie")&&(f.boxModel="BackCompat"==document.compatMode?"border-box":"content-box");f.getPadExtents=function(a,c){a=h.byId(a);var e=c||d.getComputedStyle(a),f=d.toPixelValue;c=f(a,e.paddingLeft);var b=f(a,e.paddingTop),g=f(a,e.paddingRight);a=f(a,e.paddingBottom);return{l:c,t:b,r:g,b:a,w:c+g,h:b+a}};
f.getBorderExtents=function(a,c){a=h.byId(a);var e=d.toPixelValue,f=c||d.getComputedStyle(a);c="none"!=f.borderLeftStyle?e(a,f.borderLeftWidth):0;var b="none"!=f.borderTopStyle?e(a,f.borderTopWidth):0,g="none"!=f.borderRightStyle?e(a,f.borderRightWidth):0;a="none"!=f.borderBottomStyle?e(a,f.borderBottomWidth):0;return{l:c,t:b,r:g,b:a,w:c+g,h:b+a}};f.getPadBorderExtents=function(a,c){a=h.byId(a);var e=c||d.getComputedStyle(a);c=f.getPadExtents(a,e);a=f.getBorderExtents(a,e);return{l:c.l+a.l,t:c.t+
a.t,r:c.r+a.r,b:c.b+a.b,w:c.w+a.w,h:c.h+a.h}};f.getMarginExtents=function(a,c){a=h.byId(a);var e=c||d.getComputedStyle(a),f=d.toPixelValue;c=f(a,e.marginLeft);var b=f(a,e.marginTop),g=f(a,e.marginRight);a=f(a,e.marginBottom);return{l:c,t:b,r:g,b:a,w:c+g,h:b+a}};f.getMarginBox=function(a,c){a=h.byId(a);c=c||d.getComputedStyle(a);c=f.getMarginExtents(a,c);var e=a.offsetLeft-c.l,b=a.offsetTop-c.t,g=a.parentNode,k=d.toPixelValue;8==m("ie")&&g&&(g=d.getComputedStyle(g),e-="none"!=g.borderLeftStyle?k(a,
g.borderLeftWidth):0,b-="none"!=g.borderTopStyle?k(a,g.borderTopWidth):0);return{l:e,t:b,w:a.offsetWidth+c.w,h:a.offsetHeight+c.h}};f.getContentBox=function(a,c){a=h.byId(a);var e=c||d.getComputedStyle(a);c=a.clientWidth;var b,g=f.getPadExtents(a,e);b=f.getBorderExtents(a,e);var e=a.offsetLeft+g.l+b.l,k=a.offsetTop+g.t+b.t;c?b=a.clientHeight:(c=a.offsetWidth-b.w,b=a.offsetHeight-b.h);if(8==m("ie")){var v=a.parentNode,x=d.toPixelValue;v&&(v=d.getComputedStyle(v),e-="none"!=v.borderLeftStyle?x(a,v.borderLeftWidth):
0,k-="none"!=v.borderTopStyle?x(a,v.borderTopWidth):0)}return{l:e,t:k,w:c-g.w,h:b-g.h}};f.setContentSize=function(a,c,d){a=h.byId(a);var e=c.w;c=c.h;k(a)&&(d=f.getPadBorderExtents(a,d),0<=e&&(e+=d.w),0<=c&&(c+=d.h));b(a,NaN,NaN,e,c)};var a={l:0,t:0,w:0,h:0};f.setMarginBox=function(e,c,q){e=h.byId(e);var t=q||d.getComputedStyle(e);q=c.w;var r=c.h,u=k(e)?a:f.getPadBorderExtents(e,t),t=f.getMarginExtents(e,t);if(m("webkit")&&g(e)){var v=e.style;0<=q&&!v.width&&(v.width="4px");0<=r&&!v.height&&(v.height=
"4px")}0<=q&&(q=Math.max(q-u.w-t.w,0));0<=r&&(r=Math.max(r-u.h-t.h,0));b(e,c.l,c.t,q,r)};f.isBodyLtr=function(a){a=a||l.doc;return"ltr"==(l.body(a).dir||a.documentElement.dir||"ltr").toLowerCase()};f.docScroll=function(a){a=a||l.doc;var c=l.doc.parentWindow||l.doc.defaultView;return"pageXOffset"in c?{x:c.pageXOffset,y:c.pageYOffset}:(c=a.documentElement)&&{x:f.fixIeBiDiScrollLeft(c.scrollLeft||0,a),y:c.scrollTop||0}};f.getIeDocumentElementOffset=function(a){return{x:0,y:0}};f.fixIeBiDiScrollLeft=
function(a,c){c=c||l.doc;var e=m("ie");if(e&&!f.isBodyLtr(c)){c=c.documentElement;var b=l.global;6==e&&b.frameElement&&c.scrollHeight>c.clientHeight&&(a+=c.clientLeft);return 8>e?a+c.clientWidth-c.scrollWidth:-a}return a};f.position=function(a,c){a=h.byId(a);l.body(a.ownerDocument);var e=a.getBoundingClientRect(),e={x:e.left,y:e.top,w:e.right-e.left,h:e.bottom-e.top};9>m("ie")&&(e.x-=0,e.y-=0);c&&(a=f.docScroll(a.ownerDocument),e.x+=a.x,e.y+=a.y);return e};f.getMarginSize=function(a,c){a=h.byId(a);
c=f.getMarginExtents(a,c||d.getComputedStyle(a));a=a.getBoundingClientRect();return{w:a.right-a.left+c.w,h:a.bottom-a.top+c.h}};f.normalizeEvent=function(a){"layerX"in a||(a.layerX=a.offsetX,a.layerY=a.offsetY);if(!("pageX"in a)){var c=a.target,c=c&&c.ownerDocument||document,e=c.documentElement;a.pageX=a.clientX+f.fixIeBiDiScrollLeft(e.scrollLeft||0,c);a.pageY=a.clientY+(e.scrollTop||0)}};return f})},"dojo/_base/window":function(){define(["./kernel","./lang","../sniff"],function(m,l,h){var d={global:m.global,
doc:m.global.document||null,body:function(b){b=b||m.doc;return b.body||b.getElementsByTagName("body")[0]},setContext:function(b,g){m.global=d.global=b;m.doc=d.doc=g},withGlobal:function(b,g,k,f){var a=m.global;try{return m.global=d.global=b,d.withDoc.call(null,b.document,g,k,f)}finally{m.global=d.global=a}},withDoc:function(b,g,k,f){var a=d.doc,e=h("ie"),c,q,t;try{return m.doc=d.doc=b,m.isQuirks=0,h("ie")&&(t=b.parentWindow)&&t.navigator&&(c=parseFloat(t.navigator.appVersion.split("MSIE ")[1])||void 0,
(q=b.documentMode)&&5!=q&&Math.floor(c)!=q&&(c=q),m.isIE=h.add("ie",c,!0,!0)),k&&"string"==typeof g&&(g=k[g]),g.apply(k,f||[])}finally{m.doc=d.doc=a,m.isQuirks=0,m.isIE=h.add("ie",e,!0,!0)}}};l.mixin(m,d);return d})},"dojo/dom":function(){define(["./sniff","./_base/window","./_base/kernel"],function(m,l,h){if(7>=m("ie"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(g){}var d={};m("ie")?d.byId=function(b,d){if("string"!=typeof b)return b;var f=d||l.doc;d=b&&f.getElementById(b);if(!d||
d.attributes.id.value!=b&&d.id!=b){f=f.all[b];if(!f||f.nodeName)f=[f];for(var a=0;d=f[a++];)if(d.attributes&&d.attributes.id&&d.attributes.id.value==b||d.id==b)return d}else return d}:d.byId=function(b,d){return("string"==typeof b?(d||l.doc).getElementById(b):b)||null};h=h.global.document||null;m.add("dom-contains",!(!h||!h.contains));d.isDescendant=m("dom-contains")?function(b,k){return!(!(k=d.byId(k))||!k.contains(d.byId(b)))}:function(b,k){try{for(b=d.byId(b),k=d.byId(k);b;){if(b==k)return!0;b=
b.parentNode}}catch(f){}return!1};m.add("css-user-select",function(b,d,f){if(!f)return!1;b=f.style;d=["Khtml","O","Moz","Webkit"];f=d.length;var a="userSelect";do if("undefined"!==typeof b[a])return a;while(f--&&(a=d[f]+"UserSelect"));return!1});var b=m("css-user-select");d.setSelectable=b?function(g,k){d.byId(g).style[b]=k?"":"none"}:function(b,k){b=d.byId(b);var f=b.getElementsByTagName("*"),a=f.length;if(k)for(b.removeAttribute("unselectable");a--;)f[a].removeAttribute("unselectable");else for(b.setAttribute("unselectable",
"on");a--;)f[a].setAttribute("unselectable","on")};return d})},"dojo/dom-style":function(){define(["./sniff","./dom","./_base/window"],function(m,l,h){function d(a,e,f){e=e.toLowerCase();if("auto"==f){if("height"==e)return a.offsetHeight;if("width"==e)return a.offsetWidth}if("fontweight"==e)switch(f){case 700:return"bold";default:return"normal"}e in c||(c[e]=q.test(e));return c[e]?k(a,f):f}var b,g={};b=m("webkit")?function(a){var c;if(1==a.nodeType){var e=a.ownerDocument.defaultView;c=e.getComputedStyle(a,
null);!c&&a.style&&(a.style.display="",c=e.getComputedStyle(a,null))}return c||{}}:m("ie")&&9>m("ie")?function(a){return 1==a.nodeType&&a.currentStyle?a.currentStyle:{}}:function(a){if(1===a.nodeType){var c=a.ownerDocument.defaultView;return(c.opener?c:h.global.window).getComputedStyle(a,null)}return{}};g.getComputedStyle=b;var k;k=m("ie")?function(a,c){if(!c)return 0;if("medium"==c)return 4;if(c.slice&&"px"==c.slice(-2))return parseFloat(c);var e=a.style,f=a.runtimeStyle,b=e.left,n=f.left;f.left=
a.currentStyle.left;try{e.left=c,c=e.pixelLeft}catch(w){c=0}e.left=b;f.left=n;return c}:function(a,c){return parseFloat(c)||0};g.toPixelValue=k;var f=function(a,c){try{return a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(v){return c?{}:null}},a=9>m("ie")||(m("ie"),0)?function(a){try{return f(a).Opacity/100}catch(u){return 1}}:function(a){return b(a).opacity},e=9>m("ie")||(m("ie"),0)?function(a,c){""===c&&(c=1);var b=100*c;1===c?(a.style.zoom="",f(a)&&(a.style.filter=a.style.filter.replace(/\s*progid:DXImageTransform.Microsoft.Alpha\([^\)]+?\)/i,
""))):(a.style.zoom=1,f(a)?f(a,1).Opacity=b:a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity\x3d"+b+")",f(a,1).Enabled=!0);if("tr"==a.tagName.toLowerCase())for(a=a.firstChild;a;a=a.nextSibling)"td"==a.tagName.toLowerCase()&&e(a,c);return c}:function(a,c){return a.style.opacity=c},c={left:!0,top:!0},q=/margin|padding|width|height|max|min|offset/,t={cssFloat:1,styleFloat:1,"float":1};g.get=function(c,e){var f=l.byId(c),b=arguments.length;if(2==b&&"opacity"==e)return a(f);e=t[e]?"cssFloat"in
f.style?"cssFloat":"styleFloat":e;var q=g.getComputedStyle(f);return 1==b?q:d(f,e,q[e]||f.style[e])};g.set=function(a,c,f){var b=l.byId(a),d=arguments.length,n="opacity"==c;c=t[c]?"cssFloat"in b.style?"cssFloat":"styleFloat":c;if(3==d)return n?e(b,f):b.style[c]=f;for(var w in c)g.set(a,w,c[w]);return g.getComputedStyle(b)};return g})},"dojo/mouse":function(){define(["./_base/kernel","./on","./has","./dom","./_base/window"],function(m,l,h,d,b){function g(b,f){var a=function(a,c){return l(a,b,function(e){if(f)return f(e,
c);if(!d.isDescendant(e.relatedTarget,a))return c.call(this,e)})};a.bubble=function(a){return g(b,function(c,e){var f=a(c.target),b=c.relatedTarget;if(f&&f!=(b&&1==b.nodeType&&a(b)))return e.call(f,c)})};return a}h={LEFT:0,MIDDLE:1,RIGHT:2,isButton:function(b,f){return b.button==f},isLeft:function(b){return 0==b.button},isMiddle:function(b){return 1==b.button},isRight:function(b){return 2==b.button}};m.mouseButtons=h;return{_eventHandler:g,enter:g("mouseover"),leave:g("mouseout"),wheel:"mousewheel",
isLeft:h.isLeft,isMiddle:h.isMiddle,isRight:h.isRight}})},"dojo/_base/sniff":function(){define(["./kernel","./lang","../sniff"],function(m,l,h){if(!h("host-browser"))return h;m._name="browser";l.mixin(m,{isBrowser:!0,isFF:1,isIE:h("ie"),isKhtml:0,isWebKit:h("webkit"),isMozilla:1,isMoz:1,isOpera:h("opera"),isSafari:h("safari"),isChrome:h("chrome"),isMac:1,isIos:h("ios"),isAndroid:0,isWii:0,isQuirks:0,isAir:0});return h})},"dojo/keys":function(){define(["./_base/kernel","./sniff"],function(m,l){return m.keys=
{BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:l("webkit")?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,
NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145,UP_DPAD:175,DOWN_DPAD:176,LEFT_DPAD:177,RIGHT_DPAD:178,copyKey:l("safari")?91:224}})},"dojo/_base/unload":function(){define(["./kernel","./lang","../on"],function(m,l,h){var d=window,b={addOnWindowUnload:function(b,k){m.windowUnloaded||h(d,"unload",m.windowUnloaded=function(){});h(d,"unload",l.hitch(b,k))},addOnUnload:function(b,k){h(d,"beforeunload",
l.hitch(b,k))}};m.addOnWindowUnload=b.addOnWindowUnload;m.addOnUnload=b.addOnUnload;return b})},"dojo/_base/html":function(){define("./kernel ../dom ../dom-style ../dom-attr ../dom-prop ../dom-class ../dom-construct ../dom-geometry".split(" "),function(m,l,h,d,b,g,k,f){m.byId=l.byId;m.isDescendant=l.isDescendant;m.setSelectable=l.setSelectable;m.getAttr=d.get;m.setAttr=d.set;m.hasAttr=d.has;m.removeAttr=d.remove;m.getNodeProp=d.getNodeProp;m.attr=function(a,e,c){return 2==arguments.length?d["string"==
typeof e?"get":"set"](a,e):d.set(a,e,c)};m.hasClass=g.contains;m.addClass=g.add;m.removeClass=g.remove;m.toggleClass=g.toggle;m.replaceClass=g.replace;m._toDom=m.toDom=k.toDom;m.place=k.place;m.create=k.create;m.empty=function(a){k.empty(a)};m._destroyElement=m.destroy=function(a){k.destroy(a)};m._getPadExtents=m.getPadExtents=f.getPadExtents;m._getBorderExtents=m.getBorderExtents=f.getBorderExtents;m._getPadBorderExtents=m.getPadBorderExtents=f.getPadBorderExtents;m._getMarginExtents=m.getMarginExtents=
f.getMarginExtents;m._getMarginSize=m.getMarginSize=f.getMarginSize;m._getMarginBox=m.getMarginBox=f.getMarginBox;m.setMarginBox=f.setMarginBox;m._getContentBox=m.getContentBox=f.getContentBox;m.setContentSize=f.setContentSize;m._isBodyLtr=m.isBodyLtr=f.isBodyLtr;m._docScroll=m.docScroll=f.docScroll;m._getIeDocumentElementOffset=m.getIeDocumentElementOffset=f.getIeDocumentElementOffset;m._fixIeBiDiScrollLeft=m.fixIeBiDiScrollLeft=f.fixIeBiDiScrollLeft;m.position=f.position;m.marginBox=function(a,
e){return e?f.setMarginBox(a,e):f.getMarginBox(a)};m.contentBox=function(a,e){return e?f.setContentSize(a,e):f.getContentBox(a)};m.coords=function(a,e){m.deprecated("dojo.coords()","Use dojo.position() or dojo.marginBox().");a=l.byId(a);var c=h.getComputedStyle(a),c=f.getMarginBox(a,c);a=f.position(a,e);c.x=a.x;c.y=a.y;return c};m.getProp=b.get;m.setProp=b.set;m.prop=function(a,e,c){return 2==arguments.length?b["string"==typeof e?"get":"set"](a,e):b.set(a,e,c)};m.getStyle=h.get;m.setStyle=h.set;m.getComputedStyle=
h.getComputedStyle;m.__toPixelValue=m.toPixelValue=h.toPixelValue;m.style=function(a,e,c){switch(arguments.length){case 1:return h.get(a);case 2:return h["string"==typeof e?"get":"set"](a,e)}return h.set(a,e,c)};return m})},"dojo/dom-attr":function(){define("exports ./sniff ./_base/lang ./dom ./dom-style ./dom-prop".split(" "),function(m,l,h,d,b,g){function k(a,c){a=a.getAttributeNode&&a.getAttributeNode(c);return!!a&&a.specified}var f={innerHTML:1,textContent:1,className:1,htmlFor:l("ie"),value:1},
a={classname:"class",htmlfor:"for",tabindex:"tabIndex",readonly:"readOnly"};m.has=function(e,c){var b=c.toLowerCase();return f[g.names[b]||c]||k(d.byId(e),a[b]||c)};m.get=function(e,c){e=d.byId(e);var b=c.toLowerCase(),t=g.names[b]||c,r=e[t];if(f[t]&&"undefined"!=typeof r)return r;if("textContent"==t)return g.get(e,t);if("href"!=t&&("boolean"==typeof r||h.isFunction(r)))return r;c=a[b]||c;return k(e,c)?e.getAttribute(c):null};m.set=function(e,c,q){e=d.byId(e);if(2==arguments.length){for(var t in c)m.set(e,
t,c[t]);return e}t=c.toLowerCase();var k=g.names[t]||c,u=f[k];if("style"==k&&"string"!=typeof q)return b.set(e,q),e;if(u||"boolean"==typeof q||h.isFunction(q))return g.set(e,c,q);e.setAttribute(a[t]||c,q);return e};m.remove=function(e,c){d.byId(e).removeAttribute(a[c.toLowerCase()]||c)};m.getNodeProp=function(e,c){e=d.byId(e);var f=c.toLowerCase(),b=g.names[f]||c;if(b in e&&"href"!=b)return e[b];c=a[f]||c;return k(e,c)?e.getAttribute(c):null}})},"dojo/dom-prop":function(){define("exports ./_base/kernel ./sniff ./_base/lang ./dom ./dom-style ./dom-construct ./_base/connect".split(" "),
function(m,l,h,d,b,g,k,f){var a={},e=1,c=l._scopeName+"attrid";m.names={"class":"className","for":"htmlFor",tabindex:"tabIndex",readonly:"readOnly",colspan:"colSpan",frameborder:"frameBorder",rowspan:"rowSpan",textcontent:"textContent",valuetype:"valueType"};m.get=function(a,c){a=b.byId(a);var e=c.toLowerCase();return a[m.names[e]||c]};m.set=function(q,t,r){q=b.byId(q);if(2==arguments.length&&"string"!=typeof t){for(var u in t)m.set(q,u,t[u]);return q}u=t.toLowerCase();u=m.names[u]||t;if("style"==
u&&"string"!=typeof r)return g.set(q,r),q;if("innerHTML"==u)return h("ie")&&q.tagName.toLowerCase()in{col:1,colgroup:1,table:1,tbody:1,tfoot:1,thead:1,tr:1,title:1}?(k.empty(q),q.appendChild(k.toDom(r,q.ownerDocument))):q[u]=r,q;if(d.isFunction(r)){var v=q[c];v||(v=e++,q[c]=v);a[v]||(a[v]={});var x=a[v][u];if(x)f.disconnect(x);else try{delete q[u]}catch(y){}r?a[v][u]=f.connect(q,u,r):q[u]=null;return q}q[u]=r;return q}})},"dojo/dom-construct":function(){define("exports ./_base/kernel ./sniff ./_base/window ./dom ./dom-attr".split(" "),
function(m,l,h,d,b,g){function k(a,n){var c=n.parentNode;c&&c.insertBefore(a,n)}function f(a){if("innerHTML"in a)try{a.innerHTML="";return}catch(w){}for(var n;n=a.lastChild;)a.removeChild(n)}var a={option:["select"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","thead","tr"],legend:["fieldset"],caption:["table"],colgroup:["table"],col:["table","colgroup"],li:["ul"]},e=/<\s*([\w\:]+)/,c={},q=0,t="__"+l._scopeName+"ToDomId",r;for(r in a)a.hasOwnProperty(r)&&
(l=a[r],l.pre="option"==r?'\x3cselect multiple\x3d"multiple"\x3e':"\x3c"+l.join("\x3e\x3c")+"\x3e",l.post="\x3c/"+l.reverse().join("\x3e\x3c/")+"\x3e");var u;8>=h("ie")&&(u=function(a){a.__dojo_html5_tested="yes";var n=v("div",{innerHTML:"\x3cnav\x3ea\x3c/nav\x3e",style:{visibility:"hidden"}},a.body);1!==n.childNodes.length&&"abbr article aside audio canvas details figcaption figure footer header hgroup mark meter nav output progress section summary time video".replace(/\b\w+\b/g,function(n){a.createElement(n)});
x(n)});m.toDom=function(f,n){n=n||d.doc;var b=n[t];b||(n[t]=b=++q+"",c[b]=n.createElement("div"));8>=h("ie")&&!n.__dojo_html5_tested&&n.body&&u(n);f+="";var g=f.match(e),k=g?g[1].toLowerCase():"",b=c[b];if(g&&a[k])for(g=a[k],b.innerHTML=g.pre+f+g.post,f=g.length;f;--f)b=b.firstChild;else b.innerHTML=f;if(1==b.childNodes.length)return b.removeChild(b.firstChild);for(f=n.createDocumentFragment();n=b.firstChild;)f.appendChild(n);return f};m.place=function(a,n,c){n=b.byId(n);"string"==typeof a&&(a=/^\s*</.test(a)?
m.toDom(a,n.ownerDocument):b.byId(a));if("number"==typeof c){var e=n.childNodes;!e.length||e.length<=c?n.appendChild(a):k(a,e[0>c?0:c])}else switch(c){case "before":k(a,n);break;case "after":c=a;(e=n.parentNode)&&(e.lastChild==n?e.appendChild(c):e.insertBefore(c,n.nextSibling));break;case "replace":n.parentNode.replaceChild(a,n);break;case "only":m.empty(n);n.appendChild(a);break;case "first":if(n.firstChild){k(a,n.firstChild);break}default:n.appendChild(a)}return a};var v=m.create=function(a,n,c,
e){var f=d.doc;c&&(c=b.byId(c),f=c.ownerDocument);"string"==typeof a&&(a=f.createElement(a));n&&g.set(a,n);c&&m.place(a,c,e);return a};m.empty=function(a){f(b.byId(a))};var x=m.destroy=function(a){if(a=b.byId(a)){var n=a;a=a.parentNode;n.firstChild&&f(n);a&&(h("ie")&&a.canHaveChildren&&"removeNode"in n?n.removeNode(!1):a.removeChild(n))}}})},"dojo/dom-class":function(){define(["./_base/lang","./_base/array","./dom"],function(m,l,h){function d(a){if("string"==typeof a||a instanceof String){if(a&&!g.test(a))return k[0]=
a,k;a=a.split(g);a.length&&!a[0]&&a.shift();a.length&&!a[a.length-1]&&a.pop();return a}return a?l.filter(a,function(a){return a}):[]}var b,g=/\s+/,k=[""],f={};return b={contains:function(a,e){return 0<=(" "+h.byId(a).className+" ").indexOf(" "+e+" ")},add:function(a,e){a=h.byId(a);e=d(e);var c=a.className,f,c=c?" "+c+" ":" ";f=c.length;for(var b=0,g=e.length,k;b<g;++b)(k=e[b])&&0>c.indexOf(" "+k+" ")&&(c+=k+" ");f<c.length&&(a.className=c.substr(1,c.length-2))},remove:function(a,e){a=h.byId(a);var c;
if(void 0!==e){e=d(e);c=" "+a.className+" ";for(var f=0,b=e.length;f<b;++f)c=c.replace(" "+e[f]+" "," ");c=m.trim(c)}else c="";a.className!=c&&(a.className=c)},replace:function(a,e,c){a=h.byId(a);f.className=a.className;b.remove(f,c);b.add(f,e);a.className!==f.className&&(a.className=f.className)},toggle:function(a,e,c){a=h.byId(a);if(void 0===c){e=d(e);for(var f=0,g=e.length,k;f<g;++f)k=e[f],b[b.contains(a,k)?"remove":"add"](a,k)}else b[c?"add":"remove"](a,e);return c}}})},"dojo/_base/array":function(){define(["./kernel",
"../has","./lang"],function(m,l,h){function d(a){return k[a]=new Function("item","index","array",a)}function b(a){var c=!a;return function(e,f,b){var g=0,q=e&&e.length||0,t;q&&"string"==typeof e&&(e=e.split(""));"string"==typeof f&&(f=k[f]||d(f));if(b)for(;g<q;++g){if(t=!f.call(b,e[g],g,e),a^t)return!t}else for(;g<q;++g)if(t=!f(e[g],g,e),a^t)return!t;return c}}function g(e){var c=1,b=0,d=0;e||(c=b=d=-1);return function(g,q,t,k){if(k&&0<c)return a.lastIndexOf(g,q,t);k=g&&g.length||0;var r=e?k+d:b;
t===f?t=e?b:k+d:0>t?(t=k+t,0>t&&(t=b)):t=t>=k?k+d:t;for(k&&"string"==typeof g&&(g=g.split(""));t!=r;t+=c)if(g[t]==q)return t;return-1}}var k={},f,a={every:b(!1),some:b(!0),indexOf:g(!0),lastIndexOf:g(!1),forEach:function(a,c,f){var e=0,b=a&&a.length||0;b&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=k[c]||d(c));if(f)for(;e<b;++e)c.call(f,a[e],e,a);else for(;e<b;++e)c(a[e],e,a)},map:function(a,c,f,b){var e=0,g=a&&a.length||0;b=new (b||Array)(g);g&&"string"==typeof a&&(a=a.split(""));
"string"==typeof c&&(c=k[c]||d(c));if(f)for(;e<g;++e)b[e]=c.call(f,a[e],e,a);else for(;e<g;++e)b[e]=c(a[e],e,a);return b},filter:function(a,c,f){var e=0,b=a&&a.length||0,g=[],q;b&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=k[c]||d(c));if(f)for(;e<b;++e)q=a[e],c.call(f,q,e,a)&&g.push(q);else for(;e<b;++e)q=a[e],c(q,e,a)&&g.push(q);return g},clearCache:function(){k={}}};h.mixin(m,a);return a})},"dojo/_base/NodeList":function(){define(["./kernel","../query","./array","./html","../NodeList-dom"],
function(m,l,h){l=l.NodeList;var d=l.prototype;d.connect=l._adaptAsForEach(function(){return m.connect.apply(this,arguments)});d.coords=l._adaptAsMap(m.coords);l.events="blur focus change click error keydown keypress keyup load mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup submit".split(" ");h.forEach(l.events,function(b){var g="on"+b;d[g]=function(b,f){return this.connect(g,b,f)}});return m.NodeList=l})},"dojo/query":function(){define("./_base/kernel ./has ./dom ./on ./_base/array ./_base/lang ./selector/_loader ./selector/_loader!default".split(" "),
function(m,l,h,d,b,g,k,f){function a(a,c){var n=function(n,e){if("string"==typeof e&&(e=h.byId(e),!e))return new c([]);n="string"==typeof n?a(n,e):n?n.end&&n.on?n:[n]:[];return n.end&&n.on?n:new c(n)};n.matches=a.match||function(a,c,e){return 0<n.filter([a],c,e).length};n.filter=a.filter||function(a,c,e){return n(c,e).filter(function(n){return-1<b.indexOf(a,n)})};if("function"!=typeof a){var e=a.search;a=function(a,n){return e(n||document,a)}}return n}var e=Array.prototype,c=e.slice,q=e.concat,t=
b.forEach,r=function(a,e,f){e=[0].concat(c.call(e,0));f=f||m.global;return function(n){e[0]=n;return a.apply(f,e)}},u=function(a){var n=this instanceof v&&1;"number"==typeof a&&(a=Array(a));var c=a&&"length"in a?a:arguments;if(n||!c.sort){for(var e=n?this:[],f=e.length=c.length,b=0;b<f;b++)e[b]=c[b];if(n)return e;c=e}g._mixin(c,x);c._NodeListCtor=function(a){return v(a)};return c},v=u,x=v.prototype=[];v._wrap=x._wrap=function(a,c,e){a=new (e||this._NodeListCtor||v)(a);return c?a._stash(c):a};v._adaptAsMap=
function(a,c){return function(){return this.map(r(a,arguments,c))}};v._adaptAsForEach=function(a,c){return function(){this.forEach(r(a,arguments,c));return this}};v._adaptAsFilter=function(a,c){return function(){return this.filter(r(a,arguments,c))}};v._adaptWithCondition=function(a,c,e){return function(){var n=arguments,f=r(a,n,e);if(c.call(e||m.global,n))return this.map(f);this.forEach(f);return this}};t(["slice","splice"],function(a){var n=e[a];x[a]=function(){return this._wrap(n.apply(this,arguments),
"slice"==a?this:null)}});t(["indexOf","lastIndexOf","every","some"],function(a){var n=b[a];x[a]=function(){return n.apply(m,[this].concat(c.call(arguments,0)))}});g.extend(u,{constructor:v,_NodeListCtor:v,toString:function(){return this.join(",")},_stash:function(a){this._parent=a;return this},on:function(a,c){var n=this.map(function(n){return d(n,a,c)});n.remove=function(){for(var a=0;a<n.length;a++)n[a].remove()};return n},end:function(){return this._parent?this._parent:new this._NodeListCtor(0)},
concat:function(a){var n=c.call(this,0),e=b.map(arguments,function(a){return c.call(a,0)});return this._wrap(q.apply(n,e),this)},map:function(a,c){return this._wrap(b.map(this,a,c),this)},forEach:function(a,c){t(this,a,c);return this},filter:function(a){var n=arguments,c=this,e=0;if("string"==typeof a){c=y._filterResult(this,n[0]);if(1==n.length)return c._stash(this);e=1}return this._wrap(b.filter(c,n[e],n[e+1]),this)},instantiate:function(a,c){var n=g.isFunction(a)?a:g.getObject(a);c=c||{};return this.forEach(function(a){new n(c,
a)})},at:function(){var a=new this._NodeListCtor(0);t(arguments,function(n){0>n&&(n=this.length+n);this[n]&&a.push(this[n])},this);return a._stash(this)}});var y=a(f,u);m.query=a(f,function(a){return u(a)});y.load=function(n,c,e){k.load(n,c,function(n){e(a(n,u))})};m._filterQueryResult=y._filterResult=function(a,c,e){return new u(y.filter(a,c,e))};m.NodeList=y.NodeList=u;return y})},"dojo/selector/_loader":function(){define(["../has","require"],function(m,l){"undefined"!==typeof document&&document.createElement("div");
var h;return{load:function(d,b,g,k){if(k&&k.isBuild)g();else{k=l;d="default"==d?m("config-selectorEngine")||"css3":d;d="css2"==d||"lite"==d?"./lite":"css2.1"==d?"./lite":"css3"==d?"./lite":"acme"==d?"./acme":(k=b)&&d;if("?"==d.charAt(d.length-1)){d=d.substring(0,d.length-1);var f=!0}if(f&&(m("dom-compliant-qsa")||h))return g(h);k([d],function(a){"./lite"!=d&&(h=a);g(a)})}}}})},"dojo/selector/lite":function(){define(["../has","../_base/kernel"],function(m,l){var h=document.createElement("div"),d=h.matches||
h.webkitMatchesSelector||h.mozMatchesSelector||h.msMatchesSelector||h.oMatchesSelector,b=h.querySelectorAll,g=/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g,k=function(a,e){var c=e?e.ownerDocument||e:l.doc||document,d=(b?/^([\w]*)#([\w\-]+$)|^(\.)([\w\-\*]+$)|^(\w+$)/:/^([\w]*)#([\w\-]+)(?:\s+(.*))?$|(?:^|(>|.+\s+))([\w\-\*]+)(\S*$)/).exec(a);e=e||c;if(d){var g=(m("ie"),null!==e.parentNode&&9!==e.nodeType&&e.parentNode===c);if(d[2]&&g){var r=l.byId?l.byId(d[2],c):c.getElementById(d[2]);if(!r||
d[1]&&d[1]!=r.tagName.toLowerCase())return[];if(e!=c)for(a=r;a!=e;)if(a=a.parentNode,!a)return[];return d[3]?k(d[3],r):[r]}if(d[3]&&e.getElementsByClassName)return e.getElementsByClassName(d[4]);if(d[5])if(r=e.getElementsByTagName(d[5]),d[4]||d[6])a=(d[4]||"")+d[6];else return r}if(b)return 1===e.nodeType&&"object"!==e.nodeName.toLowerCase()?f(e,a,e.querySelectorAll):e.querySelectorAll(a);r||(r=e.getElementsByTagName("*"));d=[];c=0;for(g=r.length;c<g;c++){var u=r[c];1==u.nodeType&&(void 0)(u,a,e)&&
d.push(u)}return d},f=function(a,e,c){var f=a,b=a.getAttribute("id"),d=b||"__dojo__",k=a.parentNode,v=/^\s*[+~]/.test(e);if(v&&!k)return[];b?d=d.replace(/'/g,"\\$\x26"):a.setAttribute("id",d);v&&k&&(a=a.parentNode);e=e.match(g);for(k=0;k<e.length;k++)e[k]="[id\x3d'"+d+"'] "+e[k];e=e.join(",");try{return c.call(a,e)}finally{b||f.removeAttribute("id")}};k.match=d?function(a,e,c){return c&&9!=c.nodeType?f(c,e,function(c){return d.call(a,c)}):d.call(a,e)}:void 0;return k})},"dojo/NodeList-dom":function(){define("./_base/kernel ./query ./_base/array ./_base/lang ./dom-class ./dom-construct ./dom-geometry ./dom-attr ./dom-style".split(" "),
function(m,l,h,d,b,g,k,f,a){function e(a){return function(c,n,e){return 2==arguments.length?a["string"==typeof n?"get":"set"](c,n):a.set(c,n,e)}}var c=function(a){return 1==a.length&&"string"==typeof a[0]},q=function(a){var c=a.parentNode;c&&c.removeChild(a)},t=l.NodeList,r=t._adaptWithCondition,u=t._adaptAsForEach,v=t._adaptAsMap;d.extend(t,{_normalize:function(a,c){var n=!0===a.parse;if("string"==typeof a.template){var e=a.templateFunc||m.string&&m.string.substitute;a=e?e(a.template,a):a}e=typeof a;
"string"==e||"number"==e?(a=g.toDom(a,c&&c.ownerDocument),a=11==a.nodeType?d._toArray(a.childNodes):[a]):d.isArrayLike(a)?d.isArray(a)||(a=d._toArray(a)):a=[a];n&&(a._runParse=!0);return a},_cloneNode:function(a){return a.cloneNode(!0)},_place:function(a,c,n,e){if(1==c.nodeType||"only"!=n)for(var f,b=a.length,d=b-1;0<=d;d--){var w=e?this._cloneNode(a[d]):a[d];if(a._runParse&&m.parser&&m.parser.parse)for(f||(f=c.ownerDocument.createElement("div")),f.appendChild(w),m.parser.parse(f),w=f.firstChild;f.firstChild;)f.removeChild(f.firstChild);
d==b-1?g.place(w,c,n):c.parentNode.insertBefore(w,c);c=w}},position:v(k.position),attr:r(e(f),c),style:r(e(a),c),addClass:u(b.add),removeClass:u(b.remove),toggleClass:u(b.toggle),replaceClass:u(b.replace),empty:u(g.empty),removeAttr:u(f.remove),marginBox:v(k.getMarginBox),place:function(a,c){var n=l(a)[0];return this.forEach(function(a){g.place(a,n,c)})},orphan:function(a){return(a?l._filterResult(this,a):this).forEach(q)},adopt:function(a,c){return l(a).place(this[0],c)._stash(this)},query:function(a){if(!a)return this;
var c=new t;this.map(function(n){l(a,n).forEach(function(a){void 0!==a&&c.push(a)})});return c._stash(this)},filter:function(a){var c=arguments,n=this,e=0;if("string"==typeof a){n=l._filterResult(this,c[0]);if(1==c.length)return n._stash(this);e=1}return this._wrap(h.filter(n,c[e],c[e+1]),this)},addContent:function(a,c){a=this._normalize(a,this[0]);for(var n=0,e;e=this[n];n++)a.length?this._place(a,e,c,0<n):g.empty(e);return this}});return t})},"dojo/_base/xhr":function(){define("./kernel ./sniff require ../io-query ../dom ../dom-form ./Deferred ./config ./json ./lang ./array ../on ../aspect ../request/watch ../request/xhr ../request/util".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){m._xhrObj=u._create;var x=m.config;m.objectToQuery=d.objectToQuery;m.queryToObject=d.queryToObject;m.fieldToObject=g.fieldToObject;m.formToObject=g.toObject;m.formToQuery=g.toQuery;m.formToJson=g.toJson;m._blockAsync=!1;var y=m._contentHandlers=m.contentHandlers={text:function(a){return a.responseText},json:function(n){return a.fromJson(n.responseText||null)},"json-comment-filtered":function(n){f.useCommentedJson||console.warn("Consider using the standard mimetype:application/json. json-commenting can introduce security issues. To decrease the chances of hijacking, use the standard the 'json' handler and prefix your json with: {}\x26\x26\nUse djConfig.useCommentedJson\x3dtrue to turn off this message.");
n=n.responseText;var c=n.indexOf("/*"),e=n.lastIndexOf("*/");if(-1==c||-1==e)throw Error("JSON was not comment filtered");return a.fromJson(n.substring(c+2,e))},javascript:function(a){return m.eval(a.responseText)},xml:function(a){var n=a.responseXML;n&&!n.querySelectorAll&&(n=(new DOMParser).parseFromString(a.responseText,"application/xml"));if(l("ie")&&(!n||!n.documentElement)){var e=function(a){return"MSXML"+a+".DOMDocument"},e=["Microsoft.XMLDOM",e(6),e(4),e(3),e(2)];c.some(e,function(c){try{var e=
new ActiveXObject(c);e.async=!1;e.loadXML(a.responseText);n=e}catch(R){return!1}return!0})}return n},"json-comment-optional":function(a){return a.responseText&&/^[^{\[]*\/\*/.test(a.responseText)?y["json-comment-filtered"](a):y.json(a)}};y.arraybuffer=y.blob=y.document=function(a,n){return a.response};m._ioSetArgs=function(a,n,c,f){var w={args:a,url:a.url},q=null;if(a.form){var q=b.byId(a.form),t=q.getAttributeNode("action");w.url=w.url||(t?t.value:m.doc?m.doc.URL:null);q=g.toObject(q)}t=[{}];q&&
t.push(q);a.content&&t.push(a.content);a.preventCache&&t.push({"dojo.preventCache":(new Date).valueOf()});w.query=d.objectToQuery(e.mixin.apply(null,t));w.handleAs=a.handleAs||"text";var r=new k(function(a){a.canceled=!0;n&&n(a);var c=a.ioArgs.error;c||(c=Error("request cancelled"),c.dojoType="cancel",a.ioArgs.error=c);return c});r.addCallback(c);var u=a.load;u&&e.isFunction(u)&&r.addCallback(function(n){return u.call(a,n,w)});var v=a.error;v&&e.isFunction(v)&&r.addErrback(function(n){return v.call(a,
n,w)});var y=a.handle;y&&e.isFunction(y)&&r.addBoth(function(n){return y.call(a,n,w)});r.addErrback(function(a){return f(a,r)});x.ioPublish&&m.publish&&!1!==w.args.ioPublish&&(r.addCallbacks(function(a){m.publish("/dojo/io/load",[r,a]);return a},function(a){m.publish("/dojo/io/error",[r,a]);return a}),r.addBoth(function(a){m.publish("/dojo/io/done",[r,a]);return a}));r.ioArgs=w;return r};var n=function(a){a=y[a.ioArgs.handleAs](a.ioArgs.xhr,a.ioArgs);return void 0===a?null:a},w=function(a,n){n.ioArgs.args.failOk||
console.error(a);return a},z=function(a){0>=C&&(C=0,x.ioPublish&&m.publish&&(!a||a&&!1!==a.ioArgs.args.ioPublish)&&m.publish("/dojo/io/stop"))},C=0;t.after(r,"_onAction",function(){--C});t.after(r,"_onInFlight",z);m._ioCancelAll=r.cancelAll;m._ioNotifyStart=function(a){x.ioPublish&&m.publish&&!1!==a.ioArgs.args.ioPublish&&(C||m.publish("/dojo/io/start"),C+=1,m.publish("/dojo/io/send",[a]))};m._ioWatch=function(a,n,c,f){a.ioArgs.options=a.ioArgs.args;e.mixin(a,{response:a.ioArgs,isValid:function(c){return n(a)},
isReady:function(n){return c(a)},handleResponse:function(n){return f(a)}});r(a);z(a)};m._ioAddQueryToUrl=function(a){a.query.length&&(a.url+=(-1==a.url.indexOf("?")?"?":"\x26")+a.query,a.query=null)};m.xhr=function(a,c,e){var f,b=m._ioSetArgs(c,function(a){f&&f.cancel()},n,w),d=b.ioArgs;"postData"in c?d.query=c.postData:"putData"in c?d.query=c.putData:"rawBody"in c?d.query=c.rawBody:(2<arguments.length&&!e||-1==="POST|PUT".indexOf(a.toUpperCase()))&&m._ioAddQueryToUrl(d);var g={method:a,handleAs:{arraybuffer:1,
blob:1,document:1}[c.handleAs]?c.handleAs:"text",responseType:c.responseType,timeout:c.timeout,withCredentials:c.withCredentials,ioArgs:d};"undefined"!==typeof c.headers&&(g.headers=c.headers);"undefined"!==typeof c.contentType&&(g.headers||(g.headers={}),g.headers["Content-Type"]=c.contentType);"undefined"!==typeof d.query&&(g.data=d.query);"undefined"!==typeof c.sync&&(g.sync=c.sync);m._ioNotifyStart(b);try{f=u(d.url,g,!0)}catch(Q){return b.cancel(),b}b.ioArgs.xhr=f.response.xhr;f.then(function(){b.resolve(b)}).otherwise(function(a){d.error=
a;a.response&&(a.status=a.response.status,a.responseText=a.response.text,a.xhr=a.response.xhr);b.reject(a)});return b};m.xhrGet=function(a){return m.xhr("GET",a)};m.rawXhrPost=m.xhrPost=function(a){return m.xhr("POST",a,!0)};m.rawXhrPut=m.xhrPut=function(a){return m.xhr("PUT",a,!0)};m.xhrDelete=function(a){return m.xhr("DELETE",a)};m._isDocumentOk=function(a){return v.checkStatus(a.status)};m._getText=function(a){var n;m.xhrGet({url:a,sync:!0,load:function(a){n=a}});return n};e.mixin(m.xhr,{_xhrObj:m._xhrObj,
fieldToObject:g.fieldToObject,formToObject:g.toObject,objectToQuery:d.objectToQuery,formToQuery:g.toQuery,formToJson:g.toJson,queryToObject:d.queryToObject,contentHandlers:y,_ioSetArgs:m._ioSetArgs,_ioCancelAll:m._ioCancelAll,_ioNotifyStart:m._ioNotifyStart,_ioWatch:m._ioWatch,_ioAddQueryToUrl:m._ioAddQueryToUrl,_isDocumentOk:m._isDocumentOk,_getText:m._getText,get:m.xhrGet,post:m.xhrPost,put:m.xhrPut,del:m.xhrDelete});return m.xhr})},"dojo/io-query":function(){define(["./_base/lang"],function(m){var l=
{};return{objectToQuery:function(h){var d=encodeURIComponent,b=[],g;for(g in h){var k=h[g];if(k!=l[g]){var f=d(g)+"\x3d";if(m.isArray(k))for(var a=0,e=k.length;a<e;++a)b.push(f+d(k[a]));else b.push(f+d(k))}}return b.join("\x26")},queryToObject:function(h){var d=decodeURIComponent;h=h.split("\x26");for(var b={},g,k,f=0,a=h.length;f<a;++f)if(k=h[f],k.length){var e=k.indexOf("\x3d");0>e?(g=d(k),k=""):(g=d(k.slice(0,e)),k=d(k.slice(e+1)));"string"==typeof b[g]&&(b[g]=[b[g]]);m.isArray(b[g])?b[g].push(k):
b[g]=k}return b}}})},"dojo/dom-form":function(){define(["./_base/lang","./dom","./io-query","./json"],function(m,l,h,d){var b={fieldToObject:function(b){var d=null;if(b=l.byId(b)){var f=b.name,a=(b.type||"").toLowerCase();if(f&&a&&!b.disabled)if("radio"==a||"checkbox"==a)b.checked&&(d=b.value);else if(b.multiple)for(d=[],b=[b.firstChild];b.length;)for(f=b.pop();f;f=f.nextSibling)if(1==f.nodeType&&"option"==f.tagName.toLowerCase())f.selected&&d.push(f.value);else{f.nextSibling&&b.push(f.nextSibling);
f.firstChild&&b.push(f.firstChild);break}else d=b.value}return d},toObject:function(d){var g={};d=l.byId(d).elements;for(var f=0,a=d.length;f<a;++f){var e=d[f],c=e.name,q=(e.type||"").toLowerCase();if(c&&q&&0>"file|submit|image|reset|button".indexOf(q)&&!e.disabled){var t=g,r=c,e=b.fieldToObject(e);if(null!==e){var u=t[r];"string"==typeof u?t[r]=[u,e]:m.isArray(u)?u.push(e):t[r]=e}"image"==q&&(g[c+".x"]=g[c+".y"]=g[c].x=g[c].y=0)}}return g},toQuery:function(d){return h.objectToQuery(b.toObject(d))},
toJson:function(g,k){return d.stringify(b.toObject(g),null,k?4:0)}};return b})},"dojo/json":function(){define(["./has"],function(m){return JSON})},"dojo/_base/Deferred":function(){define("./kernel ../Deferred ../promise/Promise ../errors/CancelError ../has ./lang ../when".split(" "),function(m,l,h,d,b,g,k){var f=function(){},a=Object.freeze||function(){},e=m.Deferred=function(c){function q(a){if(u)throw Error("This deferred has already been resolved");r=a;u=!0;k()}function k(){for(var a;!a&&w;){var n=
w;w=w.next;if(a=n.progress==f)u=!1;var c=y?n.error:n.resolved;b("config-useDeferredInstrumentation")&&y&&l.instrumentRejected&&l.instrumentRejected(r,!!c);if(c)try{var e=c(r);e&&"function"===typeof e.then?e.then(g.hitch(n.deferred,"resolve"),g.hitch(n.deferred,"reject"),g.hitch(n.deferred,"progress")):(c=a&&void 0===e,a&&!c&&(y=e instanceof Error),n.deferred[c&&y?"reject":"resolve"](c?r:e))}catch(M){n.deferred.reject(M)}else y?n.deferred.reject(r):n.deferred.resolve(r)}}var r,u,v,x,y,n,w,z=this.promise=
new h;this.isResolved=z.isResolved=function(){return 0==x};this.isRejected=z.isRejected=function(){return 1==x};this.isFulfilled=z.isFulfilled=function(){return 0<=x};this.isCanceled=z.isCanceled=function(){return v};this.resolve=this.callback=function(a){this.fired=x=0;this.results=[a,null];q(a)};this.reject=this.errback=function(a){y=!0;this.fired=x=1;b("config-useDeferredInstrumentation")&&l.instrumentRejected&&l.instrumentRejected(a,!!w);q(a);this.results=[null,a]};this.progress=function(a){for(var n=
w;n;){var c=n.progress;c&&c(a);n=n.next}};this.addCallbacks=function(a,n){this.then(a,n,f);return this};z.then=this.then=function(a,c,b){var d=b==f?this:new e(z.cancel);a={resolved:a,error:c,progress:b,deferred:d};w?n=n.next=a:w=n=a;u&&k();return d.promise};var C=this;z.cancel=this.cancel=function(){if(!u){var a=c&&c(C);u||(a instanceof Error||(a=new d(a)),a.log=!1,C.reject(a))}v=!0};a(z)};g.extend(e,{addCallback:function(a){return this.addCallbacks(g.hitch.apply(m,arguments))},addErrback:function(a){return this.addCallbacks(null,
g.hitch.apply(m,arguments))},addBoth:function(a){var c=g.hitch.apply(m,arguments);return this.addCallbacks(c,c)},fired:-1});e.when=m.when=k;return e})},"dojo/Deferred":function(){define(["./has","./_base/lang","./errors/CancelError","./promise/Promise","./has!config-deferredInstrumentation?./promise/instrumentation"],function(m,l,h,d,b){var g=Object.freeze||function(){},k=function(a,e,b,d,g){m("config-deferredInstrumentation")&&2===e&&c.instrumentRejected&&0===a.length&&c.instrumentRejected(b,!1,
d,g);for(g=0;g<a.length;g++)f(a[g],e,b,d)},f=function(f,b,d,g){var q=f[b],k=f.deferred;if(q)try{var t=q(d);if(0===b)"undefined"!==typeof t&&e(k,b,t);else{if(t&&"function"===typeof t.then){f.cancel=t.cancel;t.then(a(k,1),a(k,2),a(k,0));return}e(k,1,t)}}catch(n){e(k,2,n)}else e(k,b,d);m("config-deferredInstrumentation")&&2===b&&c.instrumentRejected&&c.instrumentRejected(d,!!q,g,k.promise)},a=function(a,c){return function(f){e(a,c,f)}},e=function(a,c,e){if(!a.isCanceled())switch(c){case 0:a.progress(e);
break;case 1:a.resolve(e);break;case 2:a.reject(e)}},c=function(a){var e=this.promise=new d,b=this,q,v,x,y=!1,n=[];m("config-deferredInstrumentation")&&Error.captureStackTrace&&(Error.captureStackTrace(b,c),Error.captureStackTrace(e,c));this.isResolved=e.isResolved=function(){return 1===q};this.isRejected=e.isRejected=function(){return 2===q};this.isFulfilled=e.isFulfilled=function(){return!!q};this.isCanceled=e.isCanceled=function(){return y};this.progress=function(a,c){if(q){if(!0===c)throw Error("This deferred has already been fulfilled.");
return e}k(n,0,a,null,b);return e};this.resolve=function(a,c){if(q){if(!0===c)throw Error("This deferred has already been fulfilled.");return e}k(n,q=1,v=a,null,b);n=null;return e};var w=this.reject=function(a,c){if(q){if(!0===c)throw Error("This deferred has already been fulfilled.");return e}m("config-deferredInstrumentation")&&Error.captureStackTrace&&Error.captureStackTrace(x={},w);k(n,q=2,v=a,x,b);n=null;return e};this.then=e.then=function(a,b,d){var w=[d,a,b];w.cancel=e.cancel;w.deferred=new c(function(a){return w.cancel&&
w.cancel(a)});q&&!n?f(w,q,v,x):n.push(w);return w.deferred.promise};this.cancel=e.cancel=function(n,c){if(!q){a&&(c=a(n),n="undefined"===typeof c?n:c);y=!0;if(!q)return"undefined"===typeof n&&(n=new h),w(n),n;if(2===q&&v===n)return n}else if(!0===c)throw Error("This deferred has already been fulfilled.");};g(e)};c.prototype.toString=function(){return"[object Deferred]"};b&&b(c);return c})},"dojo/errors/CancelError":function(){define(["./create"],function(m){return m("CancelError",null,null,{dojoType:"cancel",
log:!1})})},"dojo/errors/create":function(){define(["../_base/lang"],function(m){return function(l,h,d,b){d=d||Error;var g=function(b){if(d===Error){Error.captureStackTrace&&Error.captureStackTrace(this,g);var f=Error.call(this,b),a;for(a in f)f.hasOwnProperty(a)&&(this[a]=f[a]);this.message=b;this.stack=f.stack}else d.apply(this,arguments);h&&h.apply(this,arguments)};g.prototype=m.delegate(d.prototype,b);g.prototype.name=l;return g.prototype.constructor=g}})},"dojo/promise/Promise":function(){define(["../_base/lang"],
function(m){function l(){throw new TypeError("abstract");}return m.extend(function(){},{then:function(h,d,b){l()},cancel:function(h,d){l()},isResolved:function(){l()},isRejected:function(){l()},isFulfilled:function(){l()},isCanceled:function(){l()},always:function(h){return this.then(h,h)},"catch":function(h){return this.then(null,h)},otherwise:function(h){return this.then(null,h)},trace:function(){return this},traceRejected:function(){return this},toString:function(){return"[object Promise]"}})})},
"dojo/when":function(){define(["./Deferred","./promise/Promise"],function(m,l){return function(h,d,b,g){var k=h&&"function"===typeof h.then,f=k&&h instanceof l;if(!k)return 1<arguments.length?d?d(h):h:(new m).resolve(h);f||(k=new m(h.cancel),h.then(k.resolve,k.reject,k.progress),h=k.promise);return d||b||g?h.then(d,b,g):h}})},"dojo/_base/json":function(){define(["./kernel","../json"],function(m,l){m.fromJson=function(h){return eval("("+h+")")};m._escapeString=l.stringify;m.toJsonIndentStr="\t";m.toJson=
function(h,d){return l.stringify(h,function(b,d){return d&&(b=d.__json__||d.json,"function"==typeof b)?b.call(d):d},d&&m.toJsonIndentStr)};return m})},"dojo/request/watch":function(){define("./util ../errors/RequestTimeoutError ../errors/CancelError ../_base/array ../has!host-browser?../_base/window: ../has!host-browser?dom-addeventlistener?:../on:".split(" "),function(m,l,h,d,b,g){function k(){for(var c=+new Date,b=0,d;b<e.length&&(d=e[b]);b++){var g=d.response,k=g.options;d.isCanceled&&d.isCanceled()||
d.isValid&&!d.isValid(g)?(e.splice(b--,1),f._onAction&&f._onAction()):d.isReady&&d.isReady(g)?(e.splice(b--,1),d.handleResponse(g),f._onAction&&f._onAction()):d.startTime&&d.startTime+(k.timeout||0)<c&&(e.splice(b--,1),d.cancel(new l("Timeout exceeded",g)),f._onAction&&f._onAction())}f._onInFlight&&f._onInFlight(d);e.length||(clearInterval(a),a=null)}function f(c){c.response.options.timeout&&(c.startTime=+new Date);c.isFulfilled()||(e.push(c),a||(a=setInterval(k,50)),c.response.options.sync&&k())}
var a=null,e=[];f.cancelAll=function(){try{d.forEach(e,function(a){try{a.cancel(new h("All requests canceled."))}catch(q){}})}catch(c){}};b&&g&&b.doc.attachEvent&&g(b.global,"unload",function(){f.cancelAll()});return f})},"dojo/request/util":function(){define("exports ../errors/RequestError ../errors/CancelError ../Deferred ../io-query ../_base/array ../_base/lang ../promise/Promise ../has".split(" "),function(m,l,h,d,b,g,k,f,a){function e(a){return q(a)}function c(a){return void 0!==a.data?a.data:
a.text}m.deepCopy=function(a,c){for(var e in c){var f=a[e],b=c[e];f!==b&&(f&&"object"===typeof f&&b&&"object"===typeof b?b instanceof Date?a[e]=new Date(b):m.deepCopy(f,b):a[e]=b)}return a};m.deepCreate=function(a,c){c=c||{};var e=k.delegate(a),f,b;for(f in a)(b=a[f])&&"object"===typeof b&&(e[f]=m.deepCreate(b,c[f]));return m.deepCopy(e,c)};var q=Object.freeze||function(a){return a};m.deferred=function(a,b,g,v,x,y){var n=new d(function(c){b&&b(n,a);return c&&(c instanceof l||c instanceof h)?c:new h("Request canceled",
a)});n.response=a;n.isValid=g;n.isReady=v;n.handleResponse=x;g=n.then(e).otherwise(function(n){n.response=a;throw n;});m.notify&&g.then(k.hitch(m.notify,"emit","load"),k.hitch(m.notify,"emit","error"));v=g.then(c);x=new f;for(var w in v)v.hasOwnProperty(w)&&(x[w]=v[w]);x.response=g;q(x);y&&n.then(function(a){y.call(n,a)},function(c){y.call(n,a,c)});n.promise=x;n.then=x.then;return n};m.addCommonMethods=function(a,c){g.forEach(c||["GET","POST","PUT","DELETE"],function(c){a[("DELETE"===c?"DEL":c).toLowerCase()]=
function(e,f){f=k.delegate(f||{});f.method=c;return a(e,f)}})};m.parseArgs=function(a,c,e){var f=c.data,d=c.query;!f||e||"object"!==typeof f||f instanceof ArrayBuffer||f instanceof Blob||(c.data=b.objectToQuery(f));d?("object"===typeof d&&(d=b.objectToQuery(d)),c.preventCache&&(d+=(d?"\x26":"")+"request.preventCache\x3d"+ +new Date)):c.preventCache&&(d="request.preventCache\x3d"+ +new Date);a&&d&&(a+=(~a.indexOf("?")?"\x26":"?")+d);return{url:a,options:c,getHeader:function(a){return null}}};m.checkStatus=
function(a){a=a||0;return 200<=a&&300>a||304===a||1223===a||!a}})},"dojo/errors/RequestError":function(){define(["./create"],function(m){return m("RequestError",function(l,h){this.response=h})})},"dojo/errors/RequestTimeoutError":function(){define(["./create","./RequestError"],function(m,l){return m("RequestTimeoutError",null,l,{dojoType:"timeout"})})},"dojo/request/xhr":function(){define(["../errors/RequestError","./watch","./handlers","./util","../has"],function(m,l,h,d,b){function g(a,c){var e=
a.xhr;a.status=a.xhr.status;try{a.text=e.responseText}catch(w){}"xml"===a.options.handleAs&&(a.data=e.responseXML);if(!c)try{h(a)}catch(w){c=w}var n;if(c)this.reject(c);else{try{h(a)}catch(w){n=w}d.checkStatus(e.status)?n?this.reject(n):this.resolve(a):(c=n?new m("Unable to load "+a.url+" status: "+e.status+" and an error in handleAs: transformation of response",a):new m("Unable to load "+a.url+" status: "+e.status,a),this.reject(c))}}function k(a){return this.xhr.getResponseHeader(a)}function f(v,
h,y){var n=h&&h.data&&h.data instanceof FormData,w=d.parseArgs(v,d.deepCreate(u,h),n);v=w.url;h=w.options;var x=!h.data&&"POST"!==h.method&&"PUT"!==h.method;10>=b("ie")&&(v=v.split("#")[0]);var C,B=d.deferred(w,t,e,c,g,function(){C&&C()}),F=w.xhr=f._create();if(!F)return B.cancel(new m("XHR was not created")),y?B:B.promise;w.getHeader=k;q&&(C=q(F,B,w));var G="undefined"===typeof h.data?null:h.data,N=!h.sync,M=h.method;try{F.open(M,v,N,h.user||r,h.password||r);h.withCredentials&&(F.withCredentials=
h.withCredentials);h.handleAs in a&&(F.responseType=a[h.handleAs]);var R=h.headers;v=n||x?!1:"application/x-www-form-urlencoded";if(R)for(var P in R)"content-type"===P.toLowerCase()?v=R[P]:R[P]&&F.setRequestHeader(P,R[P]);v&&!1!==v&&F.setRequestHeader("Content-Type",v);R&&"X-Requested-With"in R||F.setRequestHeader("X-Requested-With","XMLHttpRequest");d.notify&&d.notify.emit("send",w,B.promise.cancel);F.send(G)}catch(Q){B.reject(Q)}l(B);F=null;return y?B:B.promise}b.add("dojo-force-activex-xhr",function(){return 0});
var a={blob:"blob",document:"document",arraybuffer:"arraybuffer"},e,c,q,t;e=function(a){return!this.isFulfilled()};t=function(a,c){c.xhr.abort()};q=function(a,c,e){function n(a){c.handleResponse(e)}function f(a){a=new m("Unable to load "+e.url+" status: "+a.target.status,e);c.handleResponse(e,a)}function b(a){a.lengthComputable?(e.loaded=a.loaded,e.total=a.total,c.progress(e)):3===e.xhr.readyState&&(e.loaded="loaded"in a?a.loaded:a.position,c.progress(e))}a.addEventListener("load",n,!1);a.addEventListener("error",
f,!1);a.addEventListener("progress",b,!1);return function(){a.removeEventListener("load",n,!1);a.removeEventListener("error",f,!1);a.removeEventListener("progress",b,!1);a=null}};var r,u={data:null,query:null,sync:!1,method:"GET"};f._create=function(){throw Error("XMLHTTP not available");};b("dojo-force-activex-xhr")||(f._create=function(){return new XMLHttpRequest});d.addCommonMethods(f);return f})},"dojo/request/handlers":function(){define(["../json","../_base/kernel","../_base/array","../has",
"../has!dom?../selector/_loader"],function(m,l,h,d){function b(b){var f=g[b.options.handleAs];b.data=f?f(b):b.data||b.text;return b}h=function(b){return b.xhr.response};var g={javascript:function(b){return l.eval(b.text||"")},json:function(b){return m.parse(b.text||null)},xml:void 0,blob:h,arraybuffer:h,document:h};b.register=function(b,f){g[b]=f};return b})},"dojo/_base/fx":function(){define("./kernel ./config ./lang ../Evented ./Color ../aspect ../sniff ../dom ../dom-style".split(" "),function(m,
l,h,d,b,g,k,f,a){var e=h.mixin,c={},q=c._Line=function(a,c){this.start=a;this.end=c};q.prototype.getValue=function(a){return(this.end-this.start)*a+this.start};var t=c.Animation=function(a){e(this,a);h.isArray(this.curve)&&(this.curve=new q(this.curve[0],this.curve[1]))};t.prototype=new d;h.extend(t,{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,_getStep:function(){var a=this._percent,c=this.easing;return c?c(a):a},_fire:function(a,c){c=c||[];if(this[a])if(l.debugAtAllCosts)this[a].apply(this,
c);else try{this[a].apply(this,c)}catch(z){console.error("exception in animation handler for:",a),console.error(z)}return this},play:function(a,c){this._delayTimer&&this._clearTimer();if(c)this._stopTimer(),this._active=this._paused=!1,this._percent=0;else if(this._active&&!this._paused)return this;this._fire("beforeBegin",[this.node]);a=a||this.delay;c=h.hitch(this,"_play",c);if(0<a)return this._delayTimer=setTimeout(c,a),this;c();return this},_play:function(a){this._delayTimer&&this._clearTimer();
this._startTime=(new Date).valueOf();this._paused&&(this._startTime-=this.duration*this._percent);this._active=!0;this._paused=!1;a=this.curve.getValue(this._getStep());this._percent||(this._startRepeatCount||(this._startRepeatCount=this.repeat),this._fire("onBegin",[a]));this._fire("onPlay",[a]);this._cycle();return this},pause:function(){this._delayTimer&&this._clearTimer();this._stopTimer();if(!this._active)return this;this._paused=!0;this._fire("onPause",[this.curve.getValue(this._getStep())]);
return this},gotoPercent:function(a,c){this._stopTimer();this._active=this._paused=!0;this._percent=a;c&&this.play();return this},stop:function(a){this._delayTimer&&this._clearTimer();if(!this._timer)return this;this._stopTimer();a&&(this._percent=1);this._fire("onStop",[this.curve.getValue(this._getStep())]);this._active=this._paused=!1;return this},destroy:function(){this.stop()},status:function(){return this._active?this._paused?"paused":"playing":"stopped"},_cycle:function(){if(this._active){var a=
(new Date).valueOf(),a=0===this.duration?1:(a-this._startTime)/this.duration;1<=a&&(a=1);this._percent=a;this.easing&&(a=this.easing(a));this._fire("onAnimate",[this.curve.getValue(a)]);1>this._percent?this._startTimer():(this._active=!1,0<this.repeat?(this.repeat--,this.play(null,!0)):-1==this.repeat?this.play(null,!0):this._startRepeatCount&&(this.repeat=this._startRepeatCount,this._startRepeatCount=0),this._percent=0,this._fire("onEnd",[this.node]),!this.repeat&&this._stopTimer())}return this},
_clearTimer:function(){clearTimeout(this._delayTimer);delete this._delayTimer}});var r=0,u=null,v={run:function(){}};h.extend(t,{_startTimer:function(){this._timer||(this._timer=g.after(v,"run",h.hitch(this,"_cycle"),!0),r++);u||(u=setInterval(h.hitch(v,"run"),this.rate))},_stopTimer:function(){this._timer&&(this._timer.remove(),this._timer=null,r--);0>=r&&(clearInterval(u),u=null,r=0)}});var x=k("ie")?function(n){var c=n.style;c.width.length||"auto"!=a.get(n,"width")||(c.width="auto")}:function(){};
c._fade=function(n){n.node=f.byId(n.node);var b=e({properties:{}},n);n=b.properties.opacity={};n.start="start"in b?b.start:function(){return+a.get(b.node,"opacity")||0};n.end=b.end;n=c.animateProperty(b);g.after(n,"beforeBegin",h.partial(x,b.node),!0);return n};c.fadeIn=function(a){return c._fade(e({end:1},a))};c.fadeOut=function(a){return c._fade(e({end:0},a))};c._defaultEasing=function(a){return.5+Math.sin((a+1.5)*Math.PI)/2};var y=function(a){this._properties=a;for(var c in a){var n=a[c];n.start instanceof
b&&(n.tempColor=new b)}};y.prototype.getValue=function(a){var c={},n;for(n in this._properties){var e=this._properties[n],f=e.start;f instanceof b?c[n]=b.blendColors(f,e.end,a,e.tempColor).toCss():h.isArray(f)||(c[n]=(e.end-f)*a+f+("opacity"!=n?e.units||"px":0))}return c};c.animateProperty=function(c){var n=c.node=f.byId(c.node);c.easing||(c.easing=m._defaultEasing);c=new t(c);g.after(c,"beforeBegin",h.hitch(c,function(){var c={},f;for(f in this.properties){var d=function(c,n){var e={height:c.offsetHeight,
width:c.offsetWidth}[n];if(void 0!==e)return e;e=a.get(c,n);return"opacity"==n?+e:g?e:parseFloat(e)};if("width"==f||"height"==f)this.node.display="block";var w=this.properties[f];h.isFunction(w)&&(w=w(n));w=c[f]=e({},h.isObject(w)?w:{end:w});h.isFunction(w.start)&&(w.start=w.start(n));h.isFunction(w.end)&&(w.end=w.end(n));var g=0<=f.toLowerCase().indexOf("color");"end"in w?"start"in w||(w.start=d(n,f)):w.end=d(n,f);g?(w.start=new b(w.start),w.end=new b(w.end)):w.start="opacity"==f?+w.start:parseFloat(w.start)}this.curve=
new y(c)}),!0);g.after(c,"onAnimate",h.hitch(a,"set",c.node),!0);return c};c.anim=function(a,e,f,b,d,g){return c.animateProperty({node:a,duration:f||t.prototype.duration,properties:e,easing:b,onEnd:d}).play(g||0)};e(m,c);m._Animation=t;return c})},"dojo/_base/Color":function(){define(["./kernel","./lang","./array","./config"],function(m,l,h,d){var b=m.Color=function(b){b&&this.setColor(b)};b.named={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,
0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],transparent:d.transparentColor||[0,0,0,0]};l.extend(b,{r:255,g:255,b:255,a:1,_set:function(b,d,f,a){this.r=b;this.g=d;this.b=f;this.a=a},setColor:function(d){l.isString(d)?b.fromString(d,this):l.isArray(d)?b.fromArray(d,this):(this._set(d.r,d.g,d.b,d.a),d instanceof b||this.sanitize());return this},sanitize:function(){return this},
toRgb:function(){return[this.r,this.g,this.b]},toRgba:function(){return[this.r,this.g,this.b,this.a]},toHex:function(){return"#"+h.map(["r","g","b"],function(b){b=this[b].toString(16);return 2>b.length?"0"+b:b},this).join("")},toCss:function(b){var d=this.r+", "+this.g+", "+this.b;return(b?"rgba("+d+", "+this.a:"rgb("+d)+")"},toString:function(){return this.toCss(!0)}});b.blendColors=m.blendColors=function(d,k,f,a){var e=a||new b;h.forEach(["r","g","b","a"],function(a){e[a]=d[a]+(k[a]-d[a])*f;"a"!=
a&&(e[a]=Math.round(e[a]))});return e.sanitize()};b.fromRgb=m.colorFromRgb=function(d,k){return(d=d.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/))&&b.fromArray(d[1].split(/\s*,\s*/),k)};b.fromHex=m.colorFromHex=function(d,k){var f=k||new b,a=4==d.length?4:8,e=(1<<a)-1;d=Number("0x"+d.substr(1));if(isNaN(d))return null;h.forEach(["b","g","r"],function(c){var b=d&e;d>>=a;f[c]=4==a?17*b:b});f.a=1;return f};b.fromArray=m.colorFromArray=function(d,k){k=k||new b;k._set(Number(d[0]),Number(d[1]),Number(d[2]),
Number(d[3]));isNaN(k.a)&&(k.a=1);return k.sanitize()};b.fromString=m.colorFromString=function(d,k){var f=b.named[d];return f&&b.fromArray(f,k)||b.fromRgb(d,k)||b.fromHex(d,k)};return b})},"esri/core/request/script":function(){define("require exports dojo/Deferred dojo/request/script dojo/text!./iframe.html ../sniff".split(" "),function(m,l,h,d,b,g){function k(){var a=document.createElement("iframe");if(a.name="esri_core_jsonp_iframe",a.style.display="none",a.setAttribute("sandbox","allow-scripts"),
!g("ff")&&"srcdoc"in a){var c=m.toUrl("dojo/dojo.js"),n=b.replace("../../../dojo/dojo.js",c),c=c.slice(0,-7),n=n.replace("../../../dojo/",c);a.srcdoc=n}else n=m.toUrl("./iframe.html"),"http:"===window.location.protocol&&0===n.indexOf("https:")&&(n=n.replace("https:","http:")),a.src=n;return document.body.appendChild(a),a}function f(){var c=new MessageChannel;return c.port1.addEventListener("message",a),c.port1.start(),c}function a(a){var e=a.data;if("ready"===e){for(var e=0,n=u;e<n.length;e++)a=n[e],
c(a,t);u=null}else(a=v[e.id])&&(delete v[e.id],e.isError?a.dfd.reject(Error(e.message)):a.dfd.resolve(e.response))}function e(a,c){a.addEventListener("load",function(){a.contentWindow.postMessage("init","*",[c.port2])})}function c(a,c){v[a.message.id]=a;c.port1.postMessage(a.message)}Object.defineProperty(l,"__esModule",{value:!0});var q,t,r=0,u=[],v={};l.get=function(a,b){if(!g("esri-script-sandbox"))return d.get(a,b);var n=null;b&&(n={jsonp:b.jsonp,preventCache:b.preventCache,query:b.query,timeout:b.timeout});
b=new h(function(){if(u){var a=u.indexOf(w);-1<a&&u.splice(a,1)}else w.message.id in v&&delete v[w.message.id]});var w={dfd:b,message:{id:"id"+(++r+Math.random()),url:a,options:n}};return q||(q=k(),t=f(),e(q,t)),u?u.push(w):c(w,t),b.promise}})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),function(m,l,h,d,b,g,k,f,a,e,c){function q(a,c){a.canDelete&&x._remove(a.id,c.options.frameDoc,
!0)}function t(a){C&&C.length&&(b.forEach(C,function(a){x._remove(a.id,a.frameDoc);a.frameDoc=null}),C=[]);return a.options.jsonp?!a.data:!0}function r(a){return!!this.scriptLoaded}function u(a){return(a=a.options.checkString)&&eval("typeof("+a+') !\x3d\x3d "undefined"')}function v(a,c){if(this.canDelete){var n=this.response.options;C.push({id:this.id,frameDoc:n.ioArgs?n.ioArgs.frameDoc:n.frameDoc});n.ioArgs&&(n.ioArgs.frameDoc=null);n.frameDoc=null}c?this.reject(c):this.resolve(a)}function x(a,c,
e){var f=h.parseArgs(a,h.deepCopy({},c));a=f.url;c=f.options;var b=h.deferred(f,q,t,c.jsonp?null:c.checkString?u:r,v);g.mixin(b,{id:y+n++,canDelete:!1});c.jsonp&&((new RegExp("[?\x26]"+c.jsonp+"\x3d")).test(a)||(a+=(~a.indexOf("?")?"\x26":"?")+c.jsonp+"\x3d"+(c.frameDoc?"parent.":"")+y+"_callbacks."+b.id),b.canDelete=!0,z[b.id]=function(a){f.data=a;b.handleResponse(f)});h.notify&&h.notify.emit("send",f,b.promise.cancel);if(!c.canAttach||c.canAttach(b)){var d=x._attach(b.id,a,c.frameDoc,function(a){if(!(a instanceof
Error)){var n=Error("Error loading "+(a.target?a.target.src:"script"));n.source=a;a=n}b.reject(a);x._remove(b.id,c.frameDoc,!0)});if(!c.jsonp&&!c.checkString)var C=k(d,"readystatechange",function(a){if("load"===a.type||w.test(d.readyState))C.remove(),b.scriptLoaded=a})}l(b);return e?b:b.promise}var y=m.id.replace(/[\/\.\-]/g,"_"),n=0,w=/complete|loaded/,z=d.global[y+"_callbacks"]={},C=[];x.get=x;x._attach=function(a,n,e,b){e=e||c.doc;var f=e.createElement("script");if(b)k.once(f,"error",b);f.type=
"text/javascript";try{f.src=n}catch(R){b&&b(f)}f.id=a;f.async=!0;f.charset="utf-8";return e.getElementsByTagName("head")[0].appendChild(f)};x._remove=function(c,n,e){a.destroy(f.byId(c,n));z[c]&&(e?z[c]=function(){delete z[c]}:delete z[c])};x._callbacksProperty=y+"_callbacks";return x})},"dojo/text":function(){define(["./_base/kernel","require","./has","./has!host-browser?./request"],function(m,l,h,d){var b;h("host-browser")?b=function(a,c,b){d(a,{sync:!!c,headers:{"X-Requested-With":null}}).then(b)}:
l.getText?b=l.getText:console.error("dojo/text plugin failed to load because loader does not support getText");var g={},k=function(a){if(a){a=a.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var c=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);c&&(a=c[1])}else a="";return a},f={},a={};m.cache=function(a,c,f){var e;"string"==typeof a?/\//.test(a)?(e=a,f=c):e=l.toUrl(a.replace(/\./g,"/")+(c?"/"+c:"")):(e=a+"",f=c);a=void 0!=f&&"string"!=typeof f?f.value:f;f=f&&f.sanitize;if("string"==
typeof a)return g[e]=a,f?k(a):a;if(null===a)return delete g[e],null;e in g||b(e,!0,function(a){g[e]=a});return f?k(g[e]):g[e]};return{dynamic:!0,normalize:function(a,c){a=a.split("!");var e=a[0];return(/^\./.test(e)?c(e):e)+(a[1]?"!"+a[1]:"")},load:function(e,c,d){e=e.split("!");var q=1<e.length,r=e[0],u=c.toUrl(e[0]);e="url:"+u;var v=f,h=function(a){d(q?k(a):a)};r in g?v=g[r]:c.cache&&e in c.cache?v=c.cache[e]:u in g&&(v=g[u]);if(v===f)if(a[u])a[u].push(h);else{var y=a[u]=[h];b(u,!c.async,function(c){g[r]=
g[u]=c;for(var n=0;n<y.length;)y[n++](c);delete a[u]})}else h(v)}}})},"esri/core/sniff":function(){define(["dojo/_base/window","dojo/sniff","../kernel"],function(m,l,h){function d(){if(r)return r;r={available:!1,version:0,supportsHighPrecisionFragment:!1};var a,c=function(a,c){for(var n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],e=null,f=0;f<n.length;++f){try{e=a.getContext(n[f],c)}catch(B){}if(e)break}return e};try{if(!t.WebGLRenderingContext)throw 0;a=document.createElement("canvas")}catch(y){return r}var e=
c(a,{failIfMajorPerformanceCaveat:!0});if(e||(e=c(a),e&&(r.majorPerformanceCaveat=!0)),!e)return r;a=e.getParameter(e.VERSION);if(!a)return r;if(a=a.match(/^WebGL\s+([\d.]*)/))r.version=parseFloat(a[1]),r.available=.94<=r.version,a=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT),r.supportsHighPrecisionFragment=a&&0<a.precision,r.supportsVertexShaderSamplers=0<e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),r.supportsElementIndexUint=null!=e.getExtension("OES_element_index_uint");return r}
if(l("host-node"))return l;var b,g=l("ff"),k=l("ie"),f=void 0===k&&7<=l("trident"),a=l("webkit"),e=l("opera"),c=l("chrome"),q=l("safari"),t=m.global;m=navigator.userAgent;if(b=m.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i),b&&l.add("esri-iphone",parseFloat(b[2].replace("_","."))),b=m.match(/Android\s+(\d+\.\d+)/i),b&&l.add("esri-android",parseFloat(b[1])),b=m.match(/Fennec\/(\d+\.\d+)/i),b&&l.add("esri-fennec",parseFloat(b[1])),0<=m.indexOf("BlackBerry")&&0<=m.indexOf("WebKit")&&l.add("esri-blackberry",
1),l.add("esri-touch",l("esri-iphone")||l("esri-android")||l("esri-blackberry")||6<=l("esri-fennec")||(g||a)&&t.document&&t.document.createTouch?!0:!1),b=m.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i),b&&l.add("esri-mobile",b),l.add("esri-pointer",navigator.pointerEnabled||navigator.msPointerEnabled),h._getDOMAccessor=function(c){var f="";return g?f="Moz":a?f="Webkit":k?f="ms":e&&(f="O"),f+c.charAt(0).toUpperCase()+c.substr(1)},l.add("esri-phonegap",!!t.cordova),l.add("esri-cors",
l("esri-phonegap")||"XMLHttpRequest"in t&&"withCredentials"in new XMLHttpRequest),l.add("esri-canvas-svg-support",function(){return!(l("trident")||l("ie"))}),l.add("esri-wasm","WebAssembly"in t),l("host-webworker"))return l;l.add("esri-workers","Worker"in t);l.add("esri-script-sandbox",function(){return"MessageChannel"in t&&"HTMLIFrameElement"in t&&"sandbox"in HTMLIFrameElement.prototype});l.add("esri-transforms",f||9<=k||3.5<=g||4<=c||3.1<=q||10.5<=e||3.2<=l("esri-iphone")||2.1<=l("esri-android"));
l.add("esri-transitions",f||10<=k||4<=g||4<=c||3.1<=q||10.5<=e||3.2<=l("esri-iphone")||2.1<=l("esri-android"));l.add("esri-transforms3d",f||10<=g||12<=c||4<=q||3.2<=l("esri-iphone")||3<=l("esri-android"));l.add("esri-url-encodes-apostrophe",function(){var a=t.document.createElement("a");return a.href="?'",-1<a.href.indexOf("?%27")});3>l("esri-android")&&(l.add("esri-transforms",!1,!1,!0),l.add("esri-transitions",!1,!1,!0),l.add("esri-transforms3d",!1,!1,!0));h._css=function(f){var b=l("esri-transforms3d");
void 0!==f&&null!==f?b=f:b&&(c||q&&!l("esri-iphone"))&&(b=!1);var d=b?"translate3d(":"translate(",t=b?c?",-1px)":",0px)":")",n=b?"scale3d(":"scale(",w=b?",1)":")",r=b?"rotate3d(0,0,1,":"rotate(",u=b?"matrix3d(":"matrix(",h=b?",0,0,":",",F=b?",0,0,0,0,1,0,":",",G=b?",0,1)":")";return{names:{transition:a&&"-webkit-transition"||g&&"MozTransition"||e&&"OTransition"||k&&"msTransition"||"transition",transform:a&&"-webkit-transform"||g&&"MozTransform"||e&&"OTransform"||k&&"msTransform"||"transform",transformName:a&&
"-webkit-transform"||g&&"-moz-transform"||e&&"-o-transform"||k&&"-ms-transform"||"transform",origin:a&&"-webkit-transform-origin"||g&&"MozTransformOrigin"||e&&"OTransformOrigin"||k&&"msTransformOrigin"||"transformOrigin",endEvent:a&&"webkitTransitionEnd"||g&&"transitionend"||e&&"oTransitionEnd"||k&&"MSTransitionEnd"||"transitionend"},translate:function(a,c){return d+a+"px,"+c+"px"+t},scale:function(a){return n+a+","+a+w},rotate:function(a){return r+a+"deg)"},matrix:function(a){return a.m?(a=a.m,u+
a[0].toFixed(10)+","+a[1].toFixed(10)+h+a[2].toFixed(10)+","+a[3].toFixed(10)+F+a[4].toFixed(10)+(g?"px,":",")+a[5].toFixed(10)+(g?"px":"")+G):u+a.xx.toFixed(10)+","+a.yx.toFixed(10)+h+a.xy.toFixed(10)+","+a.yy.toFixed(10)+F+a.dx.toFixed(10)+(g?"px,":",")+a.dy.toFixed(10)+(g?"px":"")+G},matrix3d:function(a){return a=a.m,"matrix3d("+a[0].toFixed(10)+","+a[1].toFixed(10)+",0,0,"+a[2].toFixed(10)+","+a[3].toFixed(10)+",0,0,0,0,1,0,"+a[4].toFixed(10)+","+a[5].toFixed(10)+",0,1)"},getScaleFromMatrix:function(a){if(!a)return 1;
a=a.toLowerCase();var c=-1<a.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(a.substring(c.length,a.indexOf(",")))}}};var r;return l.add("esri-webgl",function(){return!!d().available}),l.add("esri-webgl-high-precision-fragment",function(){return!!d().supportsHighPrecisionFragment}),l.add("esri-webgl-vertex-shader-samplers",function(){return!!d().supportsVertexShaderSamplers}),l.add("esri-webgl-element-index-uint",function(){return!!d().supportsElementIndexUint}),l.add("esri-webgl-major-performance-caveat",
function(){return!!d().majorPerformanceCaveat}),l})},"esri/kernel":function(){define(["require","./core/requireUtils","dojo/main","dojo/has"],function(m,l,h,d){(function(){var b=h.config,g=b.has&&void 0!==b.has["config-deferredInstrumentation"],k=b.has&&void 0!==b.has["config-useDeferredInstrumentation"];void 0!==b.useDeferredInstrumentation||g||k||(d.add("config-deferredInstrumentation",!1,!0,!0),d.add("config-useDeferredInstrumentation",!1,!0,!0))})();return{version:"4.6",workerMessages:{request:function(b){return l.when(m,
"./request").then(function(d){var g=b.options||{};return g.responseType="array-buffer",d(b.url,g)}).then(function(b){return{data:{data:b.data,ssl:b.ssl},buffers:[b.data]}})}}}})},"esri/core/requireUtils":function(){define(["require","exports","dojo/Deferred"],function(m,l,h){function d(b,g){if(Array.isArray(g)){var k=new h;return b(g,function(){for(var f=[],a=0;a<arguments.length;a++)f[a]=arguments[a];k.resolve(f)}),k.promise}return d(b,[g]).then(function(f){return f[0]})}Object.defineProperty(l,
"__esModule",{value:!0});l.when=d;l.getAbsMid=function(b,d,k){return d.toAbsMid?d.toAbsMid(b):k.id.replace(/\/[^\/]*$/gi,"/")+b}})},"dojo/main":function(){define("./_base/kernel ./has require ./sniff ./_base/lang ./_base/array ./_base/config ./ready ./_base/declare ./_base/connect ./_base/Deferred ./_base/json ./_base/Color require ./has!host-browser?./_base/browser require".split(" "),function(m,l,h,d,b,g,k,f){k.isDebug&&h(["./_firebug/firebug"]);return m})},"dojo/_base/declare":function(){define(["./kernel",
"../has","./lang"],function(m,l,h){function d(a,c){throw Error("declare"+(c?" "+c:"")+": "+a);}function b(a,c){for(var n=[],e=[{cls:0,refs:[]}],f={},b=1,w=a.length,g=0,q,k,t,E,p;g<w;++g){(q=a[g])?"[object Function]"!=C.call(q)&&d("mixin #"+g+" is not a callable constructor.",c):d("mixin #"+g+" is unknown. Did you use dojo.require to pull it in?",c);k=q._meta?q._meta.bases:[q];t=0;for(q=k.length-1;0<=q;--q)E=k[q].prototype,E.hasOwnProperty("declaredClass")||(E.declaredClass="uniqName_"+F++),E=E.declaredClass,
f.hasOwnProperty(E)||(f[E]={count:0,refs:[],cls:k[q]},++b),E=f[E],t&&t!==E&&(E.refs.push(t),++t.count),t=E;++t.count;e[0].refs.push(t)}for(;e.length;){t=e.pop();n.push(t.cls);for(--b;p=t.refs,1==p.length;){t=p[0];if(!t||--t.count){t=0;break}n.push(t.cls);--b}if(t)for(g=0,w=p.length;g<w;++g)t=p[g],--t.count||e.push(t)}b&&d("can't build consistent linearization",c);q=a[0];n[0]=q?q._meta&&q===n[n.length-q._meta.bases.length]?q._meta.bases.length:1:0;return n}function g(a,c,n,e){var f,b,w,g,q,k,t=this._inherited=
this._inherited||{};"string"===typeof a&&(f=a,a=c,c=n,n=e);if("function"===typeof a)w=a,a=c,c=n;else try{w=a.callee}catch(E){if(E instanceof TypeError)d("strict mode inherited() requires the caller function to be passed before arguments",this.declaredClass);else throw E;}(f=f||w.nom)||d("can't deduce a name to call inherited()",this.declaredClass);n=e=0;g=this.constructor._meta;e=g.bases;k=t.p;if("constructor"!=f){if(t.c!==w&&(k=0,q=e[0],g=q._meta,g.hidden[f]!==w)){(b=g.chains)&&"string"==typeof b[f]&&
d("calling chained method with inherited: "+f,this.declaredClass);do if(g=q._meta,b=q.prototype,g&&(b[f]===w&&b.hasOwnProperty(f)||g.hidden[f]===w))break;while(q=e[++k]);k=q?k:-1}if(q=e[++k])if(b=q.prototype,q._meta&&b.hasOwnProperty(f))n=b[f];else{w=z[f];do if(b=q.prototype,(n=b[f])&&(q._meta?b.hasOwnProperty(f):n!==w))break;while(q=e[++k])}n=q&&n||z[f]}else{if(t.c!==w&&(k=0,(g=e[0]._meta)&&g.ctor!==w)){for((b=g.chains)&&"manual"===b.constructor||d("calling chained constructor with inherited",this.declaredClass);(q=
e[++k])&&(!(g=q._meta)||g.ctor!==w););k=q?k:-1}for(;(q=e[++k])&&!(n=(g=q._meta)?g.ctor:q););n=q&&n}t.c=n;t.p=k;if(n)return!0===c?n:n.apply(this,c||a)}function k(a,c,n){return"string"===typeof a?"function"===typeof c?this.__inherited(a,c,n,!0):this.__inherited(a,c,!0):"function"===typeof a?this.__inherited(a,c,!0):this.__inherited(a,!0)}function f(a,c,n,e){var f=this.getInherited(a,c,n);if(f)return f.apply(this,e||n||c||a)}function a(a){for(var c=this.constructor._meta.bases,n=0,e=c.length;n<e;++n)if(c[n]===
a)return!0;return this instanceof a}function e(a,c){for(var n in c)"constructor"!=n&&c.hasOwnProperty(n)&&(a[n]=c[n])}function c(a){n.safeMixin(this.prototype,a);return this}function q(a,c){a instanceof Array||"function"===typeof a||(c=a,a=void 0);c=c||{};a=a||[];return n([this].concat(a),c)}function t(a,c){return function(){var n=arguments,e=n,f=n[0],b,d;d=a.length;var w;if(!(this instanceof n.callee))return y(n);if(c&&(f&&f.preamble||this.preamble))for(w=Array(a.length),w[0]=n,b=0;;){(f=n[0])&&
(f=f.preamble)&&(n=f.apply(this,n)||n);f=a[b].prototype;(f=f.hasOwnProperty("preamble")&&f.preamble)&&(n=f.apply(this,n)||n);if(++b==d)break;w[b]=n}for(b=d-1;0<=b;--b)f=a[b],(f=(d=f._meta)?d.ctor:f)&&f.apply(this,w?w[b]:n);(f=this.postscript)&&f.apply(this,e)}}function r(a,c){return function(){var n=arguments,e=n,f=n[0];if(!(this instanceof n.callee))return y(n);c&&(f&&(f=f.preamble)&&(e=f.apply(this,e)||e),(f=this.preamble)&&f.apply(this,e));a&&a.apply(this,n);(f=this.postscript)&&f.apply(this,n)}}
function u(a){return function(){var c=arguments,n=0,e,f;if(!(this instanceof c.callee))return y(c);for(;e=a[n];++n)if(e=(f=e._meta)?f.ctor:e){e.apply(this,c);break}(e=this.postscript)&&e.apply(this,c)}}function v(a,c,n){return function(){var e,f,b=0,d=1;n&&(b=c.length-1,d=-1);for(;e=c[b];b+=d)f=e._meta,(e=(f?f.hidden:e.prototype)[a])&&e.apply(this,arguments)}}function x(a){B.prototype=a.prototype;a=new B;B.prototype=null;return a}function y(a){var c=a.callee,n=x(c);c.apply(n,a);return n}function n(f,
y,B){"string"!=typeof f&&(B=y,y=f,f="");B=B||{};var F,m,M,N,R,H,Y,W=1,E=y;"[object Array]"==C.call(y)?(H=b(y,f),M=H[0],W=H.length-M,y=H[W]):(H=[0],y?"[object Function]"==C.call(y)?(M=y._meta,H=H.concat(M?M.bases:y)):d("base class is not a callable constructor.",f):null!==y&&d("unknown base class. Did you use dojo.require to pull it in?",f));if(y)for(m=W-1;;--m){F=x(y);if(!m)break;M=H[m];(M._meta?e:w)(F,M.prototype);N=l("csp-restrictions")?function(){}:new Function;N.superclass=y;N.prototype=F;y=F.constructor=
N}else F={};n.safeMixin(F,B);M=B.constructor;M!==z.constructor&&(M.nom="constructor",F.constructor=M);for(m=W-1;m;--m)(M=H[m]._meta)&&M.chains&&(Y=w(Y||{},M.chains));F["-chains-"]&&(Y=w(Y||{},F["-chains-"]));y&&y.prototype&&y.prototype["-chains-"]&&(Y=w(Y||{},y.prototype["-chains-"]));M=!Y||!Y.hasOwnProperty("constructor");H[0]=N=Y&&"manual"===Y.constructor?u(H):1==H.length?r(B.constructor,M):t(H,M);N._meta={bases:H,hidden:B,chains:Y,parents:E,ctor:B.constructor};N.superclass=y&&y.prototype;N.extend=
c;N.createSubclass=q;N.prototype=F;F.constructor=N;F.getInherited=k;F.isInstanceOf=a;F.inherited=G;F.__inherited=g;f&&(F.declaredClass=f,h.setObject(f,N));if(Y)for(R in Y)F[R]&&"string"==typeof Y[R]&&"constructor"!=R&&(M=F[R]=v(R,H,"after"===Y[R]),M.nom=R);return N}var w=h.mixin,z=Object.prototype,C=z.toString,B,F=0;B=l("csp-restrictions")?function(){}:new Function;var G=m.config.isDebug?f:g;m.safeMixin=n.safeMixin=function(a,c){var n,e;for(n in c)e=c[n],e===z[n]&&n in z||"constructor"==n||("[object Function]"==
C.call(e)&&(e.nom=n),a[n]=e);return a};return m.declare=n})},"esri/portal/support/layersCreator":function(){define("require exports dojo/has ../../core/promiseUtils ../../core/requireUtils ../PortalItem ./portalLayers ../../layers/Layer ../../renderers/support/styleUtils ./mapNotesUtils".split(" "),function(m,l,h,d,b,g,k,f,a,e){function c(c,n,e){var f,w;return b.when(m,"../../layers/"+n).then(function(n){var b={};return c.itemId&&(b.portalItem={id:c.itemId,portal:e.context.portal}),f=new n(b),w=f,
w.read(c,e.context),a.loadStyleRenderer(w,e.context).then(function(){return d.resolve(f)})})}function q(a,n){return t(a,n).then(function(e){return c(a,e,n)})}function t(a,c){var n=c.context,f=r(n),b=a.layerType||a.type;!b&&c&&c.defaultLayerType&&(b=c.defaultLayerType);c=f[b]||"UnknownLayer";if("Feature Collection"===a.type){if(a.itemId)return(new g({id:a.itemId,portal:n&&n.portal})).load().then(k.selectLayerClassPath).then(function(a){return a.className})}else"ArcGISFeatureLayer"===b&&e.isMapNotesLayer(a)&&
(c="MapNotesLayer");return a.wmtsInfo&&(c="WMTSLayer"),d.resolve(c)}function r(a){switch(a.origin){case "web-scene":switch(a.layerContainerType){case "basemap":a=w;break;case "ground":a=n;break;default:a=y}break;default:switch(a.layerContainerType){case "basemap":a=C;break;default:a=z}}return a}function u(a,c,n){return c&&c.filter?n.then(function(a){var n=c.filter(a);return void 0===n?d.resolve(a):n instanceof f?d.resolve(n):n}):n}function v(a,c,n){if(!c)return[];for(var e=[],f=[],b=0;b<c.length;b++){var w=
c[b],g=q(w,n);if((e.push(g),f.push(null),"GroupLayer"===w.layerType)&&w.layers&&Array.isArray(w.layers)&&0<w.layers.length){w=w.layers.map(function(a){return q(a,n)});e.push.apply(e,w);for(var k=0;k<w.length;k++)f.push(g)}}var t={};return e.map(function(c,e){var b=function(a,c){t[c.id]=e;var p=a.findIndex(function(p){if(!p.id)return!1;p=t[p.id];return void 0===p?!1:p>e});0>p&&(p=void 0);a.add(c,p)};c=u(a,n,c).then(function(c){return null!==f[e]?f[e].then(function(a){return b(a.layers,c),d.resolve(c)}):
(b(a,c),d.resolve(c))});return x&&(c=c.otherwise(function(a){return console.error(a.toString?a.toString():a),d.reject(a)})),c})}Object.defineProperty(l,"__esModule",{value:!0});var x=h("dojo-debug-messages"),y={ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISMapServiceLayer:"MapImageLayer",PointCloudLayer:"PointCloudLayer",ArcGISSceneServiceLayer:"SceneLayer",IntegratedMeshLayer:"IntegratedMeshLayer",ArcGISTiledElevationServiceLayer:"ElevationLayer",ArcGISTiledImageServiceLayer:"TileLayer",
ArcGISTiledMapServiceLayer:"TileLayer",GroupLayer:"GroupLayer",WebTiledLayer:"WebTileLayer",CSV:"CSVLayer",VectorTileLayer:"VectorTileLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer"},n={ArcGISTiledElevationServiceLayer:"ElevationLayer",DefaultTileLayer:"ElevationLayer"},w={ArcGISTiledMapServiceLayer:"TileLayer",ArcGISTiledImageServiceLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",WebTiledLayer:"WebTileLayer",VectorTileLayer:"VectorTileLayer",ArcGISImageServiceLayer:"UnsupportedLayer",WMS:"UnsupportedLayer",
ArcGISMapServiceLayer:"UnsupportedLayer",DefaultTileLayer:"TileLayer"},z={ArcGISFeatureLayer:"FeatureLayer",ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"UnsupportedLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISStreamLayer:"StreamLayer",ArcGISTiledImageServiceLayer:"TileLayer",ArcGISTiledMapServiceLayer:"TileLayer",VectorTileLayer:"VectorTileLayer",WebTiledLayer:"WebTileLayer",CSV:"CSVLayer",GeoRSS:"GeoRSSLayer",KML:"KMLLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer"},
C={ArcGISImageServiceLayer:"ImageryLayer",ArcGISImageServiceVectorLayer:"UnsupportedLayer",ArcGISMapServiceLayer:"MapImageLayer",ArcGISTiledImageServiceLayer:"TileLayer",ArcGISTiledMapServiceLayer:"TileLayer",OpenStreetMap:"OpenStreetMapLayer",VectorTileLayer:"VectorTileLayer",WebTiledLayer:"WebTileLayer",bingLayer:"UnsupportedLayer",WMS:"WMSLayer",DefaultTileLayer:"TileLayer"};l.createLayer=q;l.processLayer=u;l.populateLayers=v;l.populateOperationalLayers=function(a,c,n){return v(a,c,n)}})},"esri/core/promiseUtils":function(){define("require exports dojo/Deferred dojo/promise/all dojo/when ./Error".split(" "),
function(m,l,h,d,b,g){function k(f){if(f){if("function"!=typeof f.forEach){var a=Object.keys(f),e=a.map(function(a){return f[a]});return k(e).then(function(c){var e={};return a.forEach(function(a,f){return e[a]=c[f]}),e})}var c=new h,b=[],d=f.length;return 0===d&&c.resolve(b),f.forEach(function(a){var e={promise:a};b.push(e);a.then(function(a){e.value=a}).otherwise(function(a){e.error=a}).then(function(){--d;0===d&&c.resolve(b)})}),c.promise}}Object.defineProperty(l,"__esModule",{value:!0});l.all=
function(f){return d(f)};l.filter=function(f,a){var e=f.slice();return d(f.map(function(c,e){return a(c,e)})).then(function(a){return e.filter(function(c,e){return a[e]})})};l.eachAlways=k;l.create=function(f,a){var e=new h(a);return f(function(a){return void 0===a&&(a=null),b(a).then(e.resolve)},e.reject),e.promise};l.reject=function(f){var a=new h;return a.reject(f),a.promise};l.resolve=function(f){void 0===f&&(f=null);var a=new h;return a.resolve(f),a.promise};l.after=function(f,a){void 0===a&&
(a=null);var e=0,c=new h(function(){e&&(clearTimeout(e),e=0)});return e=setTimeout(function(){c.resolve(a)},f),c.promise};l.timeout=function(f,a,e){var c=0,b=new h(f.cancel);return f.then(function(a){b.isFulfilled()||(b.resolve(a),c&&(clearTimeout(c),c=0))}),f.otherwise(function(a){b.isFulfilled()||(b.reject(a),c&&(clearTimeout(c),c=0))}),c=setTimeout(function(){var c=e||new g("promiseUtils:timeout","The wrapped promise did not resolve within "+a+" ms");b.reject(c)},a),b.promise};l.wrapCallback=function(f){var a=
!1,e=new h(function(){return a=!0});return f(function(c){a||e.resolve(c)}),e.promise};l.isThenable=function(f){return f&&"function"==typeof f.then};l.when=function(f){return b(f)}})},"dojo/promise/all":function(){define(["../_base/array","../Deferred","../when"],function(m,l,h){var d=m.some;return function(b){var g,k;b instanceof Array?k=b:b&&"object"===typeof b&&(g=b);var f,a=[];if(g){k=[];for(var e in g)Object.hasOwnProperty.call(g,e)&&(a.push(e),k.push(g[e]));f={}}else k&&(f=[]);if(!k||!k.length)return(new l).resolve(f);
var c=new l;c.promise.always(function(){f=a=null});var q=k.length;d(k,function(e,b){g||a.push(b);h(e,function(e){c.isFulfilled()||(f[a[b]]=e,0===--q&&c.resolve(f))},c.reject);return c.isFulfilled()});return c.promise}})},"esri/core/Error":function(){define(["require","exports","./tsSupport/extendsHelper","./Message","./lang"],function(m,l,h,d,b){m=function(d){function g(f,a,e){var c=d.call(this,f,a,e)||this;return c instanceof g?c:new g(f,a,e)}return h(g,d),g.prototype.toJSON=function(){return{name:this.name,
message:this.message,details:b.clone(this.details),dojoType:this.dojoType}},g.fromJSON=function(f){var a=new g(f.name,f.message,f.details);return null!=f.dojoType&&(a.dojoType=f.dojoType),a},g}(d);return m.prototype.type="error",m})},"esri/core/tsSupport/extendsHelper":function(){define([],function(){return function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,h){l.__proto__=h}||function(l,h){for(var d in h)h.hasOwnProperty(d)&&(l[d]=h[d])};return function(l,h){function d(){this.constructor=
l}m(l,h);l.prototype=null===h?Object.create(h):(d.prototype=h.prototype,new d)}}()})},"esri/core/Message":function(){define(["require","exports","dojo/string"],function(m,l,h){return function(){function d(b,g,k){this instanceof d&&(this.name=b,this.message=g&&h.substitute(g,k,function(f){return null==f?"":f})||"",this.details=k)}return d.prototype.toString=function(){return"["+this.name+"]: "+this.message},d}()})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(m,l){var h=
/[&<>'"\/]/g,d={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},b={};l.setObject("dojo.string",b);b.escape=function(b){return b?b.replace(h,function(b){return d[b]}):""};b.rep=function(b,d){if(0>=d||!b)return"";for(var f=[];;){d&1&&f.push(b);if(!(d>>=1))break;b+=b}return f.join("")};b.pad=function(d,k,f,a){f||(f="0");d=String(d);k=b.rep(f,Math.ceil((k-d.length)/f.length));return a?d+k:k+d};b.substitute=function(b,d,f,a){a=a||m.global;f=f?l.hitch(a,
f):function(a){return a};return b.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,function(e,c,b){if(""==c)return"$";e=l.getObject(c,!1,d);b&&(e=l.getObject(b,!1,a).call(a,e,c));b=f(e,c);if("undefined"===typeof b)throw Error('string.substitute could not find key "'+c+'" in template');return b.toString()})};b.trim=String.prototype.trim?l.trim:function(b){b=b.replace(/^\s+/,"");for(var d=b.length-1;0<=d;d--)if(/\S/.test(b.charAt(d))){b=b.substring(0,d+1);break}return b};return b})},"esri/core/lang":function(){define("dojo/_base/array dojo/_base/kernel dojo/_base/lang dojo/date dojo/number dojo/date/locale dojo/i18n!../nls/common".split(" "),
function(m,l,h,d,b,g,k){function f(a){return void 0!==a&&null!==a}function a(a){return f(a)?a:""}function e(c,e,q){var k,n=q.match(/([^\(]+)(\([^\)]+\))?/i),w=h.trim(n[1]);q=e[c];var n=JSON.parse((n[2]?h.trim(n[2]):"{}").replace(/^\(/,"{").replace(/\)$/,"}").replace(/([{,])\s*([0-9a-zA-Z\_]+)\s*:/gi,'$1"$2":').replace(/\"\s*:\s*\'/gi,'":"').replace(/\'\s*(,|\})/gi,'"$1')),r=n.utcOffset;if(-1===m.indexOf(t,w))k=h.getObject(w),h.isFunction(k)&&(q=k(q,c,e,n));else if("number"==typeof q||"string"==typeof q&&
q&&!isNaN(Number(q)))switch(q=Number(q),w){case "NumberFormat":return c=h.mixin({},n),e=parseFloat(c.places),(isNaN(e)||0>e)&&(c.places=1/0),b.format(q,c);case "DateString":return k=new Date(q),n.local||n.systemLocale?n.systemLocale?k.toLocaleDateString()+(n.hideTime?"":" "+k.toLocaleTimeString()):k.toDateString()+(n.hideTime?"":" "+k.toTimeString()):(k=k.toUTCString(),n.hideTime&&(k=k.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,"")),k);case "DateFormat":return k=new Date(q),f(r)&&(k=d.add(k,"minute",
k.getTimezoneOffset()-r)),g.format(k,n)}return a(q)}function c(a,e){var b;if(e)for(b in a)a.hasOwnProperty(b)&&(void 0===a[b]?delete a[b]:a[b]instanceof Object&&c(a[b],!0));else for(b in a)a.hasOwnProperty(b)&&void 0===a[b]&&delete a[b];return a}function q(a){if(!a||"object"!=typeof a||h.isFunction(a))return a;if("function"==typeof a.clone)a=a.clone();else if("function"==typeof a.map&&"function"==typeof a.forEach)a=a.map(q);else{var c={},e,b,n={};for(e in a){b=a[e];var f=!(e in n)||n[e]!==b;e in c&&
(c[e]===b||!f)||(c[e]=q?q(b):b)}a=c}return a}var t=["NumberFormat","DateString","DateFormat"],r=/<\/?[^>]+>/g;return{equals:function(a,c){return a===c||"number"==typeof a&&isNaN(a)&&"number"==typeof c&&isNaN(c)||h.isFunction((a||{}).getTime)&&h.isFunction((c||{}).getTime)&&a.getTime()==c.getTime()||h.isFunction((a||{}).equals)&&a.equals(c)||h.isFunction((c||{}).equals)&&c.equals(a)||!1},valueOf:function(a,c){for(var e in a)if(a[e]==c)return e;return null},stripTags:function(a){if(a){var c=typeof a;
if("string"===c)a=a.replace(r,"");else if("object"===c)for(var e in a)(c=a[e])&&"string"==typeof c&&(c=c.replace(r,"")),a[e]=c}return a},substitute:function(c,b,d){var g,n,w;if(f(d)&&(h.isObject(d)?(g=d.first,n=d.dateFormat,w=d.numberFormat):g=d),b&&"{*}"!==b)return h.replace(b,h.hitch({obj:c},function(c,b){c=b.split(":");return 1<c.length?(b=c[0],c.shift(),e(b,this.obj,c.join(":"))):n&&-1!==m.indexOf(n.properties||"",b)?e(b,this.obj,n.formatter||"DateString"):w&&-1!==m.indexOf(w.properties||"",b)?
e(b,this.obj,w.formatter||"NumberFormat"):a(this.obj[b])}));var q,t;b=[];b.push('\x3ctable summary\x3d"'+k.fieldsSummary+'"\x3e\x3ctbody\x3e');for(t in c)if(q=c[t],n&&-1!==m.indexOf(n.properties||"",t)?q=e(t,c,n.formatter||"DateString"):w&&-1!==m.indexOf(w.properties||"",t)&&(q=e(t,c,w.formatter||"NumberFormat")),b.push("\x3ctr\x3e\x3cth\x3e"+t+"\x3c/th\x3e\x3ctd\x3e"+a(q)+"\x3c/td\x3e\x3c/tr\x3e"),g)break;return b.push("\x3c/tbody\x3e\x3c/table\x3e"),b.join("")},filter:function(a,c,e){var b;c=[h.isString(a)?
a.split(""):a,e||l.global,h.isString(c)?new Function("item","index","array",c):c];e={};a=c[0];for(b in a)c[2].call(c[b],a[b],b,a)&&(e[b]=a[b]);return e},startsWith:function(a,c,e){return e=e||0,a.indexOf(c,e)===e},endsWith:function(a,c,e){("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>a.length)&&(e=a.length);e-=c.length;a=a.indexOf(c,e);return-1!==a&&a===e},isDefined:f,fixJson:c,clone:q}})},"dojo/date":function(){define(["./has","./_base/lang"],function(m,l){var h={getDaysInMonth:function(d){var b=
d.getMonth();return 1==b&&h.isLeapYear(d)?29:[31,28,31,30,31,30,31,31,30,31,30,31][b]},isLeapYear:function(d){d=d.getFullYear();return!(d%400)||!(d%4)&&!!(d%100)},getTimezoneName:function(d){var b=d.toString(),g="",k=b.indexOf("(");if(-1<k)g=b.substring(++k,b.indexOf(")"));else if(k=/([A-Z\/]+) \d{4}$/,b=b.match(k))g=b[1];else if(b=d.toLocaleString(),k=/ ([A-Z\/]+)$/,b=b.match(k))g=b[1];return"AM"==g||"PM"==g?"":g},compare:function(d,b,g){d=new Date(+d);b=new Date(+(b||new Date));"date"==g?(d.setHours(0,
0,0,0),b.setHours(0,0,0,0)):"time"==g&&(d.setFullYear(0,0,0),b.setFullYear(0,0,0));return d>b?1:d<b?-1:0},add:function(d,b,g){var k=new Date(+d),f=!1,a="Date";switch(b){case "day":break;case "weekday":var e;(b=g%5)?e=parseInt(g/5):(b=0<g?5:-5,e=0<g?(g-5)/5:(g+5)/5);var c=d.getDay(),q=0;6==c&&0<g?q=1:0==c&&0>g&&(q=-1);c+=b;if(0==c||6==c)q=0<g?2:-2;g=7*e+b+q;break;case "year":a="FullYear";f=!0;break;case "week":g*=7;break;case "quarter":g*=3;case "month":f=!0;a="Month";break;default:a="UTC"+b.charAt(0).toUpperCase()+
b.substring(1)+"s"}if(a)k["set"+a](k["get"+a]()+g);f&&k.getDate()<d.getDate()&&k.setDate(0);return k},difference:function(d,b,g){b=b||new Date;g=g||"day";var k=b.getFullYear()-d.getFullYear(),f=1;switch(g){case "quarter":d=d.getMonth();b=b.getMonth();f=Math.floor(b/3)+1+4*k-(Math.floor(d/3)+1);break;case "weekday":k=Math.round(h.difference(d,b,"day"));g=parseInt(h.difference(d,b,"week"));if(0==k%7)k=5*g;else{var f=0,a=d.getDay(),e=b.getDay();g=parseInt(k/7);b=k%7;d=new Date(d);d.setDate(d.getDate()+
7*g);d=d.getDay();if(0<k)switch(!0){case 6==a:f=-1;break;case 0==a:f=0;break;case 6==e:f=-1;break;case 0==e:f=-2;break;case 5<d+b:f=-2}else if(0>k)switch(!0){case 6==a:f=0;break;case 0==a:f=1;break;case 6==e:f=2;break;case 0==e:f=1;break;case 0>d+b:f=2}k=k+f-2*g}f=k;break;case "year":f=k;break;case "month":f=b.getMonth()-d.getMonth()+12*k;break;case "week":f=parseInt(h.difference(d,b,"day")/7);break;case "day":f/=24;case "hour":f/=60;case "minute":f/=60;case "second":f/=1E3;case "millisecond":f*=
b.getTime()-d.getTime()}return Math.round(f)}};l.mixin(l.getObject("dojo.date",!0),h);return h})},"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(m,l,h,d,b){var g={};m.setObject("dojo.number",g);g.format=function(b,a){a=m.mixin({},a||{});var e=l.normalizeLocale(a.locale),e=l.getLocalization("dojo.cldr","number",e);a.customs=e;e=a.pattern||e[(a.type||"decimal")+"Format"];return isNaN(b)||Infinity==Math.abs(b)?null:g._applyPattern(b,
e,a)};g._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;g._applyPattern=function(b,a,e){e=e||{};var c=e.customs.group,f=e.customs.decimal;a=a.split(";");var d=a[0];a=a[0>b?1:0]||"-"+d;if(-1!=a.indexOf("%"))b*=100;else if(-1!=a.indexOf("\u2030"))b*=1E3;else if(-1!=a.indexOf("\u00a4"))c=e.customs.currencyGroup||c,f=e.customs.currencyDecimal||f,a=a.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(a,c,b,f){return(a=e[["symbol","currency","displayName"][b.length-1]]||e.currency||"")?c+a+f:""});else if(-1!=
a.indexOf("E"))throw Error("exponential notation not supported");var k=g._numberPatternRE,d=d.match(k);if(!d)throw Error("unable to find a number expression in pattern: "+a);!1===e.fractional&&(e.places=0);return a.replace(k,g._formatAbsolute(b,d[0],{decimal:f,group:c,places:e.places,round:e.round}))};g.round=function(b,a,e){e=10/(e||10);return(e*+b).toFixed(a)/e};if(0==(.9).toFixed()){var k=g.round;g.round=function(b,a,e){var c=Math.pow(10,-a||0),f=Math.abs(b);if(!b||f>=c)c=0;else if(f/=c,.5>f||
.95<=f)c=0;return k(b,a,e)+(0<b?c:-c)}}g._formatAbsolute=function(b,a,e){e=e||{};!0===e.places&&(e.places=0);Infinity===e.places&&(e.places=6);a=a.split(".");var c="string"==typeof e.places&&e.places.indexOf(","),f=e.places;c?f=e.places.substring(c+1):0<=f||(f=(a[1]||[]).length);0>e.round||(b=g.round(b,f,e.round));b=String(Math.abs(b)).split(".");var k=b[1]||"";a[1]||e.places?(c&&(e.places=e.places.substring(0,c)),c=void 0!==e.places?e.places:a[1]&&a[1].lastIndexOf("0")+1,c>k.length&&(b[1]=d.pad(k,
c,"0",!0)),f<k.length&&(b[1]=k.substr(0,f))):b[1]&&b.pop();f=a[0].replace(",","");c=f.indexOf("0");-1!=c&&(c=f.length-c,c>b[0].length&&(b[0]=d.pad(b[0],c)),-1==f.indexOf("#")&&(b[0]=b[0].substr(b[0].length-c)));var f=a[0].lastIndexOf(","),r,u;-1!=f&&(r=a[0].length-f-1,a=a[0].substr(0,f),f=a.lastIndexOf(","),-1!=f&&(u=a.length-f-1));a=[];for(f=b[0];f;)c=f.length-r,a.push(0<c?f.substr(c):f),f=0<c?f.slice(0,c):"",u&&(r=u,u=void 0);b[0]=a.reverse().join(e.group||",");return b.join(e.decimal||".")};g.regexp=
function(b){return g._parseInfo(b).regexp};g._parseInfo=function(f){f=f||{};var a=l.normalizeLocale(f.locale),a=l.getLocalization("dojo.cldr","number",a),e=f.pattern||a[(f.type||"decimal")+"Format"],c=a.group,d=a.decimal,k=1;if(-1!=e.indexOf("%"))k/=100;else if(-1!=e.indexOf("\u2030"))k/=1E3;else{var r=-1!=e.indexOf("\u00a4");r&&(c=a.currencyGroup||c,d=a.currencyDecimal||d)}a=e.split(";");1==a.length&&a.push("-"+a[0]);a=b.buildGroupRE(a,function(a){a="(?:"+b.escapeString(a,".")+")";return a.replace(g._numberPatternRE,
function(a){var e={signed:!1,separator:f.strict?c:[c,""],fractional:f.fractional,decimal:d,exponent:!1};a=a.split(".");var b=f.places;1==a.length&&1!=k&&(a[1]="###");1==a.length||0===b?e.fractional=!1:(void 0===b&&(b=f.pattern?a[1].lastIndexOf("0")+1:Infinity),b&&void 0==f.fractional&&(e.fractional=!0),!f.places&&b<a[1].length&&(b+=","+a[1].length),e.places=b);a=a[0].split(",");1<a.length&&(e.groupSize=a.pop().length,1<a.length&&(e.groupSize2=a.pop().length));return"("+g._realNumberRegexp(e)+")"})},
!0);r&&(a=a.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(a,c,e,d){a=b.escapeString(f[["symbol","currency","displayName"][e.length-1]]||f.currency||"");if(!a)return"";c=c?"[\\s\\xa0]":"";d=d?"[\\s\\xa0]":"";return f.strict?c+a+d:(c&&(c+="*"),d&&(d+="*"),"(?:"+c+a+d+")?")}));return{regexp:a.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:c,decimal:d,factor:k}};g.parse=function(b,a){a=g._parseInfo(a);b=(new RegExp("^"+a.regexp+"$")).exec(b);if(!b)return NaN;var e=b[1];if(!b[1]){if(!b[2])return NaN;
e=b[2];a.factor*=-1}e=e.replace(new RegExp("["+a.group+"\\s\\xa0]","g"),"").replace(a.decimal,".");return e*a.factor};g._realNumberRegexp=function(f){f=f||{};"places"in f||(f.places=Infinity);"string"!=typeof f.decimal&&(f.decimal=".");"fractional"in f&&!/^0/.test(f.places)||(f.fractional=[!0,!1]);"exponent"in f||(f.exponent=[!0,!1]);"eSigned"in f||(f.eSigned=[!0,!1]);var a=g._integerRegexp(f),e=b.buildGroupRE(f.fractional,function(a){var c="";a&&0!==f.places&&(c="\\"+f.decimal,c=Infinity==f.places?
"(?:"+c+"\\d+)?":c+("\\d{"+f.places+"}"));return c},!0),c=b.buildGroupRE(f.exponent,function(a){return a?"([eE]"+g._integerRegexp({signed:f.eSigned})+")":""}),a=a+e;e&&(a="(?:(?:"+a+")|(?:"+e+"))");return a+c};g._integerRegexp=function(f){f=f||{};"signed"in f||(f.signed=[!0,!1]);"separator"in f?"groupSize"in f||(f.groupSize=3):f.separator="";var a=b.buildGroupRE(f.signed,function(a){return a?"[-+]":""},!0),e=b.buildGroupRE(f.separator,function(a){if(!a)return"(?:\\d+)";a=b.escapeString(a);" "==a?
a="\\s":"\u00a0"==a&&(a="\\s\\xa0");var c=f.groupSize,e=f.groupSize2;return e?(a="(?:0|[1-9]\\d{0,"+(e-1)+"}(?:["+a+"]\\d{"+e+"})*["+a+"]\\d{"+c+"})",0<c-e?"(?:"+a+"|(?:0|[1-9]\\d{0,"+(c-1)+"}))":a):"(?:0|[1-9]\\d{0,"+(c-1)+"}(?:["+a+"]\\d{"+c+"})*)"},!0);return a+e};return g})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./has!host-browser?./_base/xhr ./json module".split(" "),function(m,l,h,d,b,g,k,f,a){h.add("dojo-preload-i18n-Api",1);k=
m.i18n={};var e=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,c=function(a,c,n,e){var b=[n+e];c=c.split("-");for(var f="",d=0;d<c.length;d++)if(f+=(f?"-":"")+c[d],!a||a[f])b.push(n+f+"/"+e),b.specificity=f;return b},q={},t=function(a,c,n){n=n?n.toLowerCase():m.locale;a=a.replace(/\./g,"/");c=c.replace(/\./g,"/");return/root/i.test(n)?a+"/nls/"+c:a+"/nls/"+n+"/"+c},r=m.getL10nName=function(c,n,e){return c=a.id+"!"+t(c,n,e)},u=function(a,n,e,b,f,d){a([n],function(w){var k=g.clone(w.root||w.ROOT),t=c(!w._v1x&&
w,f,e,b);a(t,function(){for(var a=1;a<t.length;a++)k=g.mixin(g.clone(k),arguments[a]);q[n+"/"+f]=k;k.$locale=t.specificity;d()})})},v=function(a){var c=b.extraLocale||[],c=g.isArray(c)?c:[c];c.push(a);return c},x=function(a,c,b){var k=e.exec(a),t=k[1]+"/",r=k[5]||k[4],y=t+r,x=(k=k[5]&&k[4])||m.locale||"",l=y+"/"+x,k=k?[x]:v(x),B=k.length,G=function(){--B||b(g.delegate(q[l]))},x=a.split("*"),H="preload"==x[1];if(h("dojo-preload-i18n-Api")){if(H&&(q[a]||(q[a]=1,z(x[2],f.parse(x[3]),1,c)),b(1)),(x=H)||
(n&&w.push([a,c,b]),x=n&&!q[l]),x)return}else if(H){b(1);return}d.forEach(k,function(a){var n=y+"/"+a;h("dojo-preload-i18n-Api")&&C(n);q[n]?G():u(c,y,t,r,a,G)})};h("dojo-preload-i18n-Api");var y=k.normalizeLocale=function(a){a=a?a.toLowerCase():m.locale;return"root"==a?"ROOT":a},n=0,w=[],z=k._preloadLocalizations=function(a,c,e,b){function f(a,c){b([a],c)}function k(a,c){for(a=a.split("-");a.length;){if(c(a.join("-")))return;a.pop()}c("ROOT")}function t(){for(--n;!n&&w.length;)x.apply(null,w.shift())}
function r(e){e=y(e);k(e,function(w){if(0<=d.indexOf(c,w)){var r=a.replace(/\./g,"/")+"_"+w;n++;f(r,function(a){for(var c in a){var f=a[c],d=c.match(/(.+)\/([^\/]+)$/),p;if(d&&(p=d[2],d=d[1]+"/",f._localized)){var A;if("ROOT"===w){var K=A=f._localized;delete f._localized;K.root=f;q[l.toAbsMid(c)]=K}else A=f._localized,q[l.toAbsMid(d+p+"/"+w)]=f;w!==e&&function(p,a,A,c){var f=[],d=[];k(e,function(A){c[A]&&(f.push(l.toAbsMid(p+A+"/"+a)),d.push(l.toAbsMid(p+a+"/"+A)))});f.length?(n++,b(f,function(){for(var c=
f.length-1;0<=c;c--)A=g.mixin(g.clone(A),arguments[c]),q[d[c]]=A;q[l.toAbsMid(p+a+"/"+e)]=g.clone(A);t()})):q[l.toAbsMid(p+a+"/"+e)]=A}(d,p,f,A)}}t()});return!0}return!1})}b=b||l;r();d.forEach(m.config.extraLocale,r)},C=function(){},C=function(a){for(var c,n=a.split("/"),e=m.global[n[0]],b=1;e&&b<n.length-1;e=e[n[b++]]);e&&((c=e[n[b]])||(c=e[n[b].replace(/-/g,"_")]),c&&(q[a]=c));return c};k.getLocalization=function(a,c,n){var e;a=t(a,c,n);x(a,l,function(a){e=a});return e};return g.mixin(k,{dynamic:!0,
normalize:function(a,c){return/^\./.test(a)?c(a):a},load:x,cache:q,getL10nName:r})})},"dojo/cldr/nls/number":function(){define({root:{scientificFormat:"#E0","currencySpacing-afterCurrency-currencyMatch":"[:^S:]",infinity:"\u221e",superscriptingExponent:"\u00d7",list:";",percentSign:"%",minusSign:"-","currencySpacing-beforeCurrency-surroundingMatch":"[:digit:]","decimalFormat-short":"000T","currencySpacing-afterCurrency-insertBetween":"\u00a0",nan:"NaN",plusSign:"+","currencySpacing-afterCurrency-surroundingMatch":"[:digit:]",
"currencySpacing-beforeCurrency-currencyMatch":"[:^S:]",currencyFormat:"\u00a4\u00a0#,##0.00",perMille:"\u2030",group:",",percentFormat:"#,##0%","decimalFormat-long":"000T",decimalFormat:"#,##0.###",decimal:".","currencySpacing-beforeCurrency-insertBetween":"\u00a0",exponential:"E"},ar:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,"en-au":!0,es:!0,et:!0,fi:!0,fr:!0,"fr-ch":!0,he:!0,hi:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,mk:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-pt":!0,ro:!0,ru:!0,sk:!0,sl:!0,
sr:!0,sv:!0,th:!0,tr:!0,vi:!0,zh:!0,"zh-hant":!0,"zh-hk":!0,"zh-tw":!0})},"dojo/cldr/nls/en/number":function(){define({group:",",percentSign:"%",exponential:"E",scientificFormat:"#E0",percentFormat:"#,##0%",list:";",infinity:"\u221e",minusSign:"-",decimal:".",superscriptingExponent:"\u00d7",nan:"NaN",perMille:"\u2030",decimalFormat:"#,##0.###",currencyFormat:"\u00a4#,##0.00;(\u00a4#,##0.00)",plusSign:"+","decimalFormat-long":"000 trillion","decimalFormat-short":"000T"})},"dojo/regexp":function(){define(["./_base/kernel",
"./_base/lang"],function(m,l){var h={};l.setObject("dojo.regexp",h);h.escapeString=function(d,b){return d.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(d){return b&&-1!=b.indexOf(d)?d:"\\"+d})};h.buildGroupRE=function(d,b,g){if(!(d instanceof Array))return b(d);for(var k=[],f=0;f<d.length;f++)k.push(b(d[f]));return h.group(k.join("|"),g)};h.group=function(d,b){return"("+(b?"?:":"")+d+")"};return h})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),
function(m,l,h,d,b,g,k,f,a){function e(a,c,n,e){return e.replace(/([a-z])\1*/ig,function(b){var f,w,g=b.charAt(0);b=b.length;var q=["abbr","wide","narrow"];switch(g){case "G":f=c[4>b?"eraAbbr":"eraNames"][0>a.getFullYear()?0:1];break;case "y":f=a.getFullYear();switch(b){case 1:break;case 2:if(!n.fullYear){f=String(f);f=f.substr(f.length-2);break}default:w=!0}break;case "Q":case "q":f=Math.ceil((a.getMonth()+1)/3);w=!0;break;case "M":case "L":f=a.getMonth();3>b?(f+=1,w=!0):(g=["months","L"==g?"standAlone":
"format",q[b-3]].join("-"),f=c[g][f]);break;case "w":f=t._getWeekOfYear(a,0);w=!0;break;case "d":f=a.getDate();w=!0;break;case "D":f=t._getDayOfYear(a);w=!0;break;case "e":case "c":if(f=a.getDay(),2>b){f=(f-d.getFirstDayOfWeek(n.locale)+8)%7;break}case "E":f=a.getDay();3>b?(f+=1,w=!0):(g=["days","c"==g?"standAlone":"format",q[b-3]].join("-"),f=c[g][f]);break;case "a":g=12>a.getHours()?"am":"pm";f=n[g]||c["dayPeriods-format-wide-"+g];break;case "h":case "H":case "K":case "k":w=a.getHours();switch(g){case "h":f=
w%12||12;break;case "H":f=w;break;case "K":f=w%12;break;case "k":f=w||24}w=!0;break;case "m":f=a.getMinutes();w=!0;break;case "s":f=a.getSeconds();w=!0;break;case "S":f=Math.round(a.getMilliseconds()*Math.pow(10,b-3));w=!0;break;case "v":case "z":if(f=t._getZone(a,!0,n))break;b=4;case "Z":g=t._getZone(a,!1,n);g=[0>=g?"+":"-",k.pad(Math.floor(Math.abs(g)/60),2),k.pad(Math.abs(g)%60,2)];4==b&&(g.splice(0,0,"GMT"),g.splice(3,0,":"));f=g.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+
e);}w&&(f=k.pad(f,b));return f})}function c(a,c,n,e){var b=function(a){return a};c=c||b;n=n||b;e=e||b;var f=a.match(/(''|[^'])+/g),d="'"==a.charAt(0);l.forEach(f,function(a,e){a?(f[e]=(d?n:c)(a.replace(/''/g,"'")),d=!d):f[e]=""});return e(f.join(""))}function q(a,c,n,e){e=g.escapeString(e);n.strict||(e=e.replace(" a"," ?a"));return e.replace(/([a-z])\1*/ig,function(e){var b;b=e.charAt(0);var f=e.length,d="",w="";n.strict?(1<f&&(d="0{"+(f-1)+"}"),2<f&&(w="0{"+(f-2)+"}")):(d="0?",w="0{0,2}");switch(b){case "y":b=
"\\d{2,4}";break;case "M":case "L":2<f?(b=c["months-"+("L"==b?"standAlone":"format")+"-"+r[f-3]].slice(0).join("|"),n.strict||(b=b.replace(/\./g,""),b="(?:"+b+")\\.?")):b="1[0-2]|"+d+"[1-9]";break;case "D":b="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+d+"[1-9][0-9]|"+w+"[1-9]";break;case "d":b="3[01]|[12]\\d|"+d+"[1-9]";break;case "w":b="[1-4][0-9]|5[0-3]|"+d+"[1-9]";break;case "E":case "e":case "c":b=".+?";break;case "h":b="1[0-2]|"+d+"[1-9]";break;case "k":b="1[01]|"+d+"\\d";break;case "H":b="1\\d|2[0-3]|"+
d+"\\d";break;case "K":b="1\\d|2[0-4]|"+d+"[1-9]";break;case "m":case "s":b="[0-5]\\d";break;case "S":b="\\d{"+f+"}";break;case "a":f=n.am||c["dayPeriods-format-wide-am"];d=n.pm||c["dayPeriods-format-wide-pm"];b=f+"|"+d;n.strict||(f!=f.toLowerCase()&&(b+="|"+f.toLowerCase()),d!=d.toLowerCase()&&(b+="|"+d.toLowerCase()),-1!=b.indexOf(".")&&(b+="|"+b.replace(/\./g,"")));b=b.replace(/\./g,"\\.");break;default:b=".*"}a&&a.push(e);return"("+b+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var t={};m.setObject(a.id.replace(/\//g,
"."),t);t._getZone=function(a,c,n){return c?h.getTimezoneName(a):a.getTimezoneOffset()};t.format=function(a,f){f=f||{};var n=b.normalizeLocale(f.locale),d=f.formatLength||"short",n=t._getGregorianBundle(n),g=[];a=m.hitch(this,e,a,n,f);if("year"==f.selector)return c(n["dateFormatItem-yyyy"]||"yyyy",a);var q;"date"!=f.selector&&(q=f.timePattern||n["timeFormat-"+d])&&g.push(c(q,a));"time"!=f.selector&&(q=f.datePattern||n["dateFormat-"+d])&&g.push(c(q,a));return 1==g.length?g[0]:n["dateTimeFormat-"+d].replace(/\'/g,
"").replace(/\{(\d+)\}/g,function(a,c){return g[c]})};t.regexp=function(a){return t._parseInfo(a).regexp};t._parseInfo=function(a){a=a||{};var e=b.normalizeLocale(a.locale),e=t._getGregorianBundle(e),n=a.formatLength||"short",f=a.datePattern||e["dateFormat-"+n],d=a.timePattern||e["timeFormat-"+n],n="date"==a.selector?f:"time"==a.selector?d:e["dateTimeFormat-"+n].replace(/\{(\d+)\}/g,function(a,c){return[d,f][c]}),g=[];return{regexp:c(n,m.hitch(this,q,g,e,a)),tokens:g,bundle:e}};t.parse=function(a,
c){var n=/[\u200E\u200F\u202A\u202E]/g,e=t._parseInfo(c),b=e.tokens,f=e.bundle;a=(new RegExp("^"+e.regexp.replace(n,"")+"$",e.strict?"":"i")).exec(a&&a.replace(n,""));if(!a)return null;var d=["abbr","wide","narrow"],g=[1970,0,1,0,0,0,0],q="";a=l.every(a,function(a,n){if(!n)return!0;var e=b[n-1];n=e.length;e=e.charAt(0);switch(e){case "y":if(2!=n&&c.strict)g[0]=a;else if(100>a)a=Number(a),e=""+(new Date).getFullYear(),n=100*e.substring(0,2),e=Math.min(Number(e.substring(2,4))+20,99),g[0]=a<e?n+a:n-
100+a;else{if(c.strict)return!1;g[0]=a}break;case "M":case "L":if(2<n){if(n=f["months-"+("L"==e?"standAlone":"format")+"-"+d[n-3]].concat(),c.strict||(a=a.replace(".","").toLowerCase(),n=l.map(n,function(a){return a.replace(".","").toLowerCase()})),a=l.indexOf(n,a),-1==a)return!1}else a--;g[1]=a;break;case "E":case "e":case "c":n=f["days-"+("c"==e?"standAlone":"format")+"-"+d[n-3]].concat();c.strict||(a=a.toLowerCase(),n=l.map(n,function(a){return a.toLowerCase()}));a=l.indexOf(n,a);if(-1==a)return!1;
break;case "D":g[1]=0;case "d":g[2]=a;break;case "a":n=c.am||f["dayPeriods-format-wide-am"];e=c.pm||f["dayPeriods-format-wide-pm"];if(!c.strict){var w=/\./g;a=a.replace(w,"").toLowerCase();n=n.replace(w,"").toLowerCase();e=e.replace(w,"").toLowerCase()}if(c.strict&&a!=n&&a!=e)return!1;q=a==e?"p":a==n?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":if(23<a)return!1;g[3]=a;break;case "m":g[4]=a;break;case "s":g[5]=a;break;case "S":g[6]=a}return!0});n=+g[3];"p"===q&&12>n?g[3]=n+12:"a"===
q&&12==n&&(g[3]=0);n=new Date(g[0],g[1],g[2],g[3],g[4],g[5],g[6]);c.strict&&n.setFullYear(g[0]);var k=b.join(""),e=-1!=k.indexOf("d"),k=-1!=k.indexOf("M");if(!a||k&&n.getMonth()>g[1]||e&&n.getDate()>g[2])return null;if(k&&n.getMonth()<g[1]||e&&n.getDate()<g[2])n=h.add(n,"hour",1);return n};var r=["abbr","wide","narrow"],u=[],v={};t.addCustomFormats=function(a,c){u.push({pkg:a,name:c});v={}};t._getGregorianBundle=function(a){if(v[a])return v[a];var c={};l.forEach(u,function(n){n=b.getLocalization(n.pkg,
n.name,a);c=m.mixin(c,n)},this);return v[a]=c};t.addCustomFormats(a.id.replace(/\/date\/locale$/,".cldr"),"gregorian");t.getNames=function(a,c,n,e){var b;e=t._getGregorianBundle(e);a=[a,n,c];"standAlone"==n&&(n=a.join("-"),b=e[n],1==b[0]&&(b=void 0));a[1]="format";return(b||e[a.join("-")]).concat()};t.isWeekend=function(a,c){c=d.getWeekend(c);a=(a||new Date).getDay();c.end<c.start&&(c.end+=7,a<c.start&&(a+=7));return a>=c.start&&a<=c.end};t._getDayOfYear=function(a){return h.difference(new Date(a.getFullYear(),
0,1,a.getHours()),a)+1};t._getWeekOfYear=function(a,c){1==arguments.length&&(c=0);var n=(new Date(a.getFullYear(),0,1)).getDay(),e=(n-c+7)%7,e=Math.floor((t._getDayOfYear(a)+e-1)/7);n==c&&e++;return e};return t})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(m,l){var h={};m.setObject("dojo.cldr.supplemental",h);h.getFirstDayOfWeek=function(d){d={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,
br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[h._region(d)];return void 0===d?1:d};h._region=function(d){d=l.normalizeLocale(d);d=d.split("-");var b=d[1];b?4==b.length&&(b=d[2]):b={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",
bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",
kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",
sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",
bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",
hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",
mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",
ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[d[0]];return b};h.getWeekend=
function(d){var b=h._region(d);d={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5}[b];b={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[b];void 0===d&&(d=6);void 0===b&&(b=0);return{start:d,end:b}};return h})},"dojo/cldr/nls/gregorian":function(){define({root:{"dateFormatItem-Ehm":"E h:mm a","days-standAlone-short":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"months-format-narrow":"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),
"field-second-relative+0":"now","quarters-standAlone-narrow":["1","2","3","4"],"field-weekday":"Day of the Week","dateFormatItem-yQQQ":"y QQQ","dateFormatItem-yMEd":"y-MM-dd, E","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","dateFormatItem-GyMMMEd":"G y MMM d, E","dateFormatItem-MMMEd":"MMM d, E",eraNarrow:["BCE","CE"],"field-tue-relative+-1":"last Tuesday","days-format-short":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}",
"dateFormat-long":"y MMMM d","field-fri-relative+-1":"last Friday","field-wed-relative+-1":"last Wednesday","months-format-wide":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),"dateTimeFormat-medium":"{1} {0}","dayPeriods-format-wide-pm":"PM","dateFormat-full":"y MMMM d, EEEE","field-thu-relative+-1":"last Thursday","dateFormatItem-Md":"MM-dd","dayPeriods-format-abbr-am":"AM","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","dayPeriods-format-wide-noon":"noon","dateFormatItem-yMd":"y-MM-dd",
"field-era":"Era","dateFormatItem-yM":"y-MM","months-standAlone-wide":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),"timeFormat-short":"HH:mm","quarters-format-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-yQQQQ":"y QQQQ","timeFormat-long":"HH:mm:ss z","field-year":"Year","dateFormatItem-yMMM":"y MMM","dateTimeFormats-appendItem-Era":"{1} {0}","field-hour":"Hour","months-format-abbr":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),"field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday",
"timeFormat-full":"HH:mm:ss zzzz","dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","field-day-relative+0":"today","field-thu-relative+0":"this Thursday","field-day-relative+1":"tomorrow","field-thu-relative+1":"next Thursday","dateFormatItem-GyMMMd":"G y MMM d","dateFormatItem-H":"HH","months-standAlone-abbr":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),"quarters-format-abbr":["Q1","Q2","Q3","Q4"],"quarters-standAlone-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-Gy":"G y","dateFormatItem-M":"L",
"days-standAlone-wide":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dayPeriods-format-abbr-noon":"noon","timeFormat-medium":"HH:mm:ss","field-sun-relative+0":"this Sunday","dateFormatItem-Hm":"HH:mm","field-sun-relative+1":"next Sunday","quarters-standAlone-abbr":["Q1","Q2","Q3","Q4"],eraAbbr:["BCE","CE"],"field-minute":"Minute","field-dayperiod":"Dayperiod","days-standAlone-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateFormatItem-d":"d","dateFormatItem-ms":"mm:ss","quarters-format-narrow":["1",
"2","3","4"],"field-day-relative+-1":"yesterday","dateTimeFormat-long":"{1} {0}","dayPeriods-format-narrow-am":"a","dateFormatItem-h":"h a","dateFormatItem-MMMd":"MMM d","dateFormatItem-MEd":"MM-dd, E","dateTimeFormat-full":"{1} {0}","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","field-day":"Day","days-format-wide":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"field-zone":"Zone","months-standAlone-narrow":"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),"dateFormatItem-y":"y","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})",
"field-year-relative+-1":"last year","field-month-relative+-1":"last month","dateTimeFormats-appendItem-Year":"{1} {0}","dateFormatItem-hm":"h:mm a","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","dayPeriods-format-abbr-pm":"PM","days-format-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),eraNames:["BCE","CE"],"dateFormatItem-yMMMd":"y MMM d","days-format-narrow":"SMTWTFS".split(""),"field-month":"Month","days-standAlone-narrow":"SMTWTFS".split(""),"dateFormatItem-MMM":"LLL","field-tue-relative+0":"this Tuesday",
"dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","field-tue-relative+1":"next Tuesday","dayPeriods-format-wide-am":"AM","dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","dateFormatItem-EHm":"E HH:mm","field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","dateFormat-short":"y-MM-dd","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-Ehms":"E h:mm:ss a","dayPeriods-format-narrow-noon":"n","field-second":"Second","field-sat-relative+-1":"last Saturday",
"dateFormatItem-yMMMEd":"y MMM d, E","field-sun-relative+-1":"last Sunday","field-month-relative+0":"this month","field-month-relative+1":"next month","dateTimeFormats-appendItem-Timezone":"{0} {1}","dateFormatItem-Ed":"d, E","field-week":"Week","dateFormat-medium":"y MMM d","field-week-relative+-1":"last week","field-year-relative+0":"this year","field-year-relative+1":"next year","dayPeriods-format-narrow-pm":"p","dateTimeFormat-short":"{1} {0}","dateFormatItem-Hms":"HH:mm:ss","dateFormatItem-hms":"h:mm:ss a",
"dateFormatItem-GyMMM":"G y MMM","field-mon-relative+-1":"last Monday","field-week-relative+0":"this week","field-week-relative+1":"next week"},ar:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,"en-au":!0,"en-ca":!0,"en-gb":!0,es:!0,et:!0,fi:!0,fr:!0,"fr-ch":!0,he:!0,hi:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,mk:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-pt":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,vi:!0,zh:!0,"zh-hant":!0,"zh-hk":!0,"zh-tw":!0})},"dojo/cldr/nls/en/gregorian":function(){define({"dateFormatItem-Ehm":"E h:mm a",
"days-standAlone-short":"Su Mo Tu We Th Fr Sa".split(" "),"months-format-narrow":"JFMAMJJASOND".split(""),"field-second-relative+0":"now","quarters-standAlone-narrow":["1","2","3","4"],"field-weekday":"Day of the Week","dateFormatItem-yQQQ":"QQQ y","dateFormatItem-yMEd":"E, M/d/y","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","dateFormatItem-GyMMMEd":"E, MMM d, y G","dateFormatItem-MMMEd":"E, MMM d",eraNarrow:["B","A"],"field-tue-relative+-1":"last Tuesday","days-format-short":"Su Mo Tu We Th Fr Sa".split(" "),
"dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","dateFormat-long":"MMMM d, y","field-fri-relative+-1":"last Friday","field-wed-relative+-1":"last Wednesday","months-format-wide":"January February March April May June July August September October November December".split(" "),"dateTimeFormat-medium":"{1}, {0}","dayPeriods-format-wide-pm":"PM","dateFormat-full":"EEEE, MMMM d, y","field-thu-relative+-1":"last Thursday","dateFormatItem-Md":"M/d","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})",
"dayPeriods-format-wide-noon":"noon","dateFormatItem-yMd":"M/d/y","field-era":"Era","dateFormatItem-yM":"M/y","months-standAlone-wide":"January February March April May June July August September October November December".split(" "),"timeFormat-short":"h:mm a","quarters-format-wide":["1st quarter","2nd quarter","3rd quarter","4th quarter"],"dateFormatItem-yQQQQ":"QQQQ y","timeFormat-long":"h:mm:ss a z","field-year":"Year","dateFormatItem-yMMM":"MMM y","dateTimeFormats-appendItem-Era":"{0} {1}","field-hour":"Hour",
"months-format-abbr":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),"field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","timeFormat-full":"h:mm:ss a zzzz","dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","field-day-relative+0":"today","field-thu-relative+0":"this Thursday","field-day-relative+1":"tomorrow","field-thu-relative+1":"next Thursday","dateFormatItem-GyMMMd":"MMM d, y G","dateFormatItem-H":"HH","months-standAlone-abbr":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
"quarters-format-abbr":["Q1","Q2","Q3","Q4"],"quarters-standAlone-wide":["1st quarter","2nd quarter","3rd quarter","4th quarter"],"dateFormatItem-Gy":"y G","dateFormatItem-M":"L","days-standAlone-wide":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),"timeFormat-medium":"h:mm:ss a","field-sun-relative+0":"this Sunday","dateFormatItem-Hm":"HH:mm","field-sun-relative+1":"next Sunday",eraAbbr:["BC","AD"],"field-minute":"Minute","field-dayperiod":"am/pm","dateFormatItem-d":"d","dateFormatItem-ms":"mm:ss",
"field-day-relative+-1":"yesterday","dateFormatItem-h":"h a","dateTimeFormat-long":"{1} 'at' {0}","dayPeriods-format-narrow-am":"a","dateFormatItem-MMMd":"MMM d","dateFormatItem-MEd":"E, M/d","dateTimeFormat-full":"{1} 'at' {0}","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","field-day":"Day","days-format-wide":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),"field-zone":"Time Zone","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})","dateFormatItem-y":"y",
"months-standAlone-narrow":"JFMAMJJASOND".split(""),"field-year-relative+-1":"last year","field-month-relative+-1":"last month","dateFormatItem-hm":"h:mm a","dateTimeFormats-appendItem-Year":"{0} {1}","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","days-format-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateFormatItem-yMMMd":"MMM d, y",eraNames:["Before Christ","Anno Domini"],"days-standAlone-narrow":"SMTWTFS".split(""),"dateFormatItem-MMM":"LLL","field-month":"Month","field-tue-relative+0":"this Tuesday",
"dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","field-tue-relative+1":"next Tuesday","dayPeriods-format-wide-am":"AM","dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","dateFormatItem-EHm":"E HH:mm","field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","dateFormat-short":"M/d/yy","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-Ehms":"E h:mm:ss a","dayPeriods-format-narrow-noon":"n","field-second":"Second","field-sat-relative+-1":"last Saturday",
"dateFormatItem-yMMMEd":"E, MMM d, y","field-sun-relative+-1":"last Sunday","field-month-relative+0":"this month","field-month-relative+1":"next month","dateFormatItem-Ed":"d E","dateTimeFormats-appendItem-Timezone":"{0} {1}","field-week":"Week","dateFormat-medium":"MMM d, y","field-year-relative+0":"this year","field-week-relative+-1":"last week","field-year-relative+1":"next year","dayPeriods-format-narrow-pm":"p","dateTimeFormat-short":"{1}, {0}","dateFormatItem-Hms":"HH:mm:ss","dateFormatItem-hms":"h:mm:ss a",
"dateFormatItem-GyMMM":"MMM y G","field-mon-relative+-1":"last Monday","field-week-relative+0":"this week","field-week-relative+1":"next week"})},"esri/nls/common":function(){define({root:{about:"About",add:"Add",all:"All",apply:"Apply",auth:{logOut:"Log Out",signIn:"Sign In"},back:"Back",cancel:"Cancel",change:"Change",clear:"Clear",close:"Close",collapse:"Collapse",configure:"Configure",control:{pause:"Pause",play:"Play",resume:"Resume",stop:"Stop"},copy:"Copy",create:"Create",cut:"Cut","delete":"Delete",
details:"Details",edit:"Edit",error:"Error",esri:"Esri",exit:"Exit",expand:"Expand",fieldsSummary:"List of attributes and values",find:"Find",form:{no:"No",ok:"OK",password:"Password",submit:"Submit",username:"Username",yes:"Yes"},help:"Help",home:"Home",info:"Info",information:"Information",layer:"Layer",loading:"Loading",maximize:"Maximize",menu:"Menu",more:"More",none:"None",open:"Open",pagination:{first:"First",last:"Last",next:"Next",page:"Page",pageText:"{index} of {total}",previous:"Previous"},
paste:"Paste",percent:"{percent}%",preview:"Preview",print:"Print",publish:"Publish",redo:"Redo",refresh:"Refresh",remove:"Remove",rename:"Rename",reset:"Reset",restore:"Restore",save:"Save",search:"Search",searching:"Searching",select:"Select",settings:"Settings",sort:"Sort",share:"Share",title:"Title",untitled:"Untitled",upload:"Upload",undo:"Undo",view:"View",visibility:{hide:"Hide",show:"Show",toggle:"Toggle"},warning:"Warning"},ar:1,bs:1,cs:1,da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,he:1,hi:1,hr:1,
id:1,it:1,ja:1,ko:1,lv:1,lt:1,nl:1,nb:1,pl:1,"pt-br":1,"pt-pt":1,ro:1,ru:1,sl:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"esri/portal/PortalItem":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Error ../core/lang ../geometry/Extent ../core/JSONSupport ../core/Loadable ./Portal ./PortalRating ../core/promiseUtils ../core/urlUtils".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){return function(a){function e(c){c=
a.call(this)||this;return c.access=null,c.accessInformation=null,c.appProxies=null,c.avgRating=null,c.created=null,c.culture=null,c.description=null,c.extent=null,c.id=null,c.itemControl=null,c.licenseInfo=null,c.modified=null,c.name=null,c.numComments=null,c.numRatings=null,c.numViews=null,c.owner=null,c.portal=null,c.size=null,c.snippet=null,c.tags=null,c.title=null,c.type=null,c.typeKeywords=null,c.url=null,c}return h(e,a),u=e,Object.defineProperty(e.prototype,"displayName",{get:function(){var a=
this.type,c=this.typeKeywords||[],e=a;return"Feature Service"===a||"Feature Collection"===a?e=-1<c.indexOf("Table")?"Table":-1<c.indexOf("Route Layer")?"Route Layer":-1<c.indexOf("Markup")?"Markup":"Feature Layer":"Image Service"===a?e=-1<c.indexOf("Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===a?e="Scene Layer":"Scene Package"===a?e="Scene Layer Package":"Stream Service"===a?e="Feature Layer":"Geoprocessing Service"===a&&this.portal&&this.portal.isPortal?e=-1<c.indexOf("Web Tool")?
"Tool":"Geoprocessing Service":"Geocoding Service"===a?e="Locator":"Microsoft Powerpoint"===a?e="Microsoft PowerPoint":"GeoJson"===a?e="GeoJSON":"Globe Service"===a?e="Globe Layer":"Vector Tile Service"===a?e="Tile Layer":"netCDF"===a?e="NetCDF":"Map Service"===a?e=-1===c.indexOf("Spatiotemporal")&&(-1<c.indexOf("Hosted Service")||-1<c.indexOf("Tiled"))?"Tile Layer":"Map Image Layer":a&&-1<a.toLowerCase().indexOf("add in")?e=a.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===a&&(e="Big Data File Share"),
e},enumerable:!0,configurable:!0}),e.prototype.readExtent=function(a){return a&&a.length?new f(a[0][0],a[0][1],a[1][0],a[1][1]):null},Object.defineProperty(e.prototype,"iconUrl",{get:function(){var a,c=this.type&&this.type.toLowerCase()||"",e=this.typeKeywords||[],b=!1,f=!1,d=!1,g=!1;return 0<c.indexOf("service")||"feature collection"===c||"kml"===c||"wms"===c||"wmts"===c||"wfs"===c?(b=-1<e.indexOf("Hosted Service"),"feature service"===c||"feature collection"===c||"kml"===c||"wfs"===c?(f=-1<e.indexOf("Table"),
d=-1<e.indexOf("Route Layer"),g=-1<e.indexOf("Markup"),a=f?"table":d?"routelayer":g?"markup":b?"featureshosted":"features"):a="map service"===c||"wms"===c||"wmts"===c?b||-1<e.indexOf("Tiled")||"wmts"===c?"maptiles":"mapimages":"scene service"===c?-1<e.indexOf("Line")?"sceneweblayerline":-1<e.indexOf("3DObject")?"sceneweblayermultipatch":-1<e.indexOf("Point")?"sceneweblayerpoint":-1<e.indexOf("IntegratedMesh")?"sceneweblayermesh":-1<e.indexOf("PointCloud")?"sceneweblayerpointcloud":-1<e.indexOf("Polygon")?
"sceneweblayerpolygon":"sceneweblayer":"image service"===c?-1<e.indexOf("Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===c?"streamlayer":"vector tile service"===c?"vectortile":"datastore catalog service"===c?"datastorecollection":"geocoding service"===c?"geocodeservice":"geoprocessing service"===c&&-1<e.indexOf("Web Tool")&&this.portal&&this.portal.isPortal?"tool":"layers"):a="web map"===c||"cityengine web scene"===c?"maps":"web scene"===c?-1<e.indexOf("ViewingMode-Local")?"webscenelocal":
"websceneglobal":"web mapping application"===c||"mobile application"===c||"application"===c||"operation view"===c||"desktop application"===c?"apps":"map document"===c||"map package"===c||"published map"===c||"scene document"===c||"globe document"===c||"basemap package"===c||"mobile basemap package"===c||"mobile map package"===c||"project package"===c||"project template"===c||"pro map"===c||"layout"===c||"layer"===c&&-1<e.indexOf("ArcGIS Pro")||"explorer map"===c&&e.indexOf("Explorer Document")?"mapsgray":
"service definition"===c||"csv"===c||"shapefile"===c||"cad drawing"===c||"geojson"===c||"360 vr experience"===c||"netCDF"===c?"datafiles":"explorer add in"===c||"desktop add in"===c||"windows viewer add in"===c||"windows viewer configuration"===c?"appsgray":"arcgis pro add in"===c||"arcgis pro configuration"===c?"addindesktop":"rule package"===c||"file geodatabase"===c||"csv collection"===c||"kml collection"===c||"windows mobile package"===c||"map template"===c||"desktop application template"===c||
"arcpad package"===c||"code sample"===c||"form"===c||"document link"===c||"vector tile package"===c||"operations dashboard add in"===c||"rules package"===c||"image"===c||"workflow manager package"===c||"explorer map"===c&&-1<e.indexOf("Explorer Mapping Application")||-1<e.indexOf("Document")?"datafilesgray":"network analysis service"===c||"geoprocessing service"===c||"geodata service"===c||"geometry service"===c||"geoprocessing package"===c||"locator package"===c||"geoprocessing sample"===c||"workflow manager service"===
c?"toolsgray":"layer"===c||"layer package"===c||"explorer layer"===c?"layersgray":"scene package"===c?"scenepackage":"tile package"===c?"tilepackage":"task file"===c?"taskfile":"report template"===c?"report-template":"statistical data collection"===c?"statisticaldatacollection":"insights workbook"===c?"workbook":"insights model"===c?"insightsmodel":"insights page"===c?"insightspage":"hub initiative"===c?"hubinitiative":"hubpage"===c?"hubpage":"hub site application"===c?"hubsite":"relational database connection"===
c?"relationaldatabaseconnection":"big data file share"===c?"datastorecollection":"image collection"===c?"imagecollection":"style"===c?"style":"desktop style"===c?"desktopstyle":"dashboard"===c?"dashboard":"raster function template"===c?"rasterprocessingtemplate":"maps",a?m.toUrl("../images/portal/"+a+"16.png"):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLayer",{get:function(){return-1<"Map Service;Feature Service;Feature Collection;Scene Service;Image Service;Stream Service;Vector Tile Service;WMTS;WMS".split(";").indexOf(this.type)},
enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemUrl",{get:function(){var a=this.get("portal.restUrl");return a?a+"/content/items/"+this.id:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thumbnailUrl",{get:function(){var a=this.itemUrl,c=this.thumbnail;return a&&c?this.portal._normalizeUrl(a+"/info/"+c+"?f\x3djson"):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userItemUrl",{get:function(){var a=this.get("portal.restUrl");
if(!a)return null;var c=this.owner||this.get("portal.user.username");return c?a+"/content/users/"+(this.ownerFolder?c+"/"+this.ownerFolder:c)+"/items/"+this.id:null},enumerable:!0,configurable:!0}),e.prototype.load=function(){var a=this;this.portal||(this.portal=c.getDefault());var n=this.portal.load().then(function(){return a.resourceInfo?a.resourceInfo:a.id&&a.itemUrl?a.portal._request(a.itemUrl):{}}).then(function(c){a.resourceInfo=c;a.read(c)});return this.addResolvingPromise(n),this.when()},
e.prototype.addRating=function(a){var c={method:"post",query:{}};return a instanceof q&&(a=a.rating),isNaN(a)||"number"!=typeof a||(c.query.rating=a),this.portal._request(this.itemUrl+"/addRating",c).then(function(){return new q({rating:a,created:new Date})})},e.prototype.deleteRating=function(){return this.portal._request(this.itemUrl+"/deleteRating",{method:"post"}).then(function(){})},e.prototype.fetchData=function(a){return void 0===a&&(a="json"),this.portal._request(this.itemUrl+"/data",{responseType:a})},
e.prototype.fetchRating=function(){return this.portal._request(this.itemUrl+"/rating").then(function(a){return null!=a.rating?(a.created=new Date(a.created),new q(a)):null})},e.prototype.fetchRelatedItems=function(a){return this.portal._requestToTypedArray(this.itemUrl+"/relatedItems",{query:a},"PortalItem")},e.prototype.getThumbnailUrl=function(a){var c=this.thumbnailUrl;return c&&a&&(c+="\x26w\x3d"+a),c},e.prototype.update=function(a){var c=this;return this.id?this.load().then(function(){return c.portal._signIn()}).then(function(){var n=
a&&a.data,e={method:"post"};e.query=c._getPostQuery();for(var b in e.query)null===e.query[b]&&(e.query[b]="");return e.query.clearEmptyFields=!0,null!=n&&("string"==typeof n?e.query.text=n:"object"==typeof n&&(e.query.text=JSON.stringify(n))),c.portal._request(c.userItemUrl+"/update",e).then(function(){return c._reload()})}):t.reject(new g("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))},e.prototype.updateThumbnail=function(a){var c=this;return this.id?this.load().then(function(){return c.portal._signIn()}).then(function(){var n=
a.thumbnail,e={method:"post"};if("string"==typeof n)r.isDataProtocol(n)?e.query={data:n}:e.query={url:r.makeAbsolute(n)};else{var b=new FormData;b.append("file",n);e.body=b}return c.portal._request(c.userItemUrl+"/updateThumbnail",e).then(function(){return c._reload()})}):t.reject(new g("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))},e.prototype.toJSON=function(){var a=this.extent,a={created:this.created&&this.created.getTime(),description:this.description,extent:a&&
[[a.xmin,a.ymin],[a.xmax,a.ymax]],id:this.id,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,tags:this.tags,thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:this.typeKeywords,url:this.url};return k.fixJson(a)},e.fromJSON=function(a){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");return new u({resourceInfo:a})},e.prototype._reload=function(){var a=this;return this.portal._request(this.itemUrl,
{query:{_ts:(new Date).getTime()}}).then(function(c){return a.resourceInfo=c,a.read(c),a})},e.prototype._getPostQuery=function(){var a=this.toJSON(),c;for(c in a)"tags"===c&&null!==a[c]&&(a[c]=a[c].join(", ")),"typeKeywords"===c&&null!==a[c]&&(a[c]=a[c].join(", "));return a},d([b.property()],e.prototype,"access",void 0),d([b.property()],e.prototype,"accessInformation",void 0),d([b.property()],e.prototype,"appProxies",void 0),d([b.property()],e.prototype,"avgRating",void 0),d([b.property({type:Date})],
e.prototype,"created",void 0),d([b.property()],e.prototype,"culture",void 0),d([b.property()],e.prototype,"description",void 0),d([b.property({dependsOn:["type","typeKeywords"],readOnly:!0})],e.prototype,"displayName",null),d([b.property({type:f})],e.prototype,"extent",void 0),d([b.reader("extent")],e.prototype,"readExtent",null),d([b.property({dependsOn:["type","typeKeywords"],readOnly:!0})],e.prototype,"iconUrl",null),d([b.property()],e.prototype,"id",void 0),d([b.property({dependsOn:["type"],readOnly:!0})],
e.prototype,"isLayer",null),d([b.property()],e.prototype,"itemControl",void 0),d([b.property({dependsOn:["portal.restUrl","id"],readOnly:!0})],e.prototype,"itemUrl",null),d([b.property()],e.prototype,"licenseInfo",void 0),d([b.property({type:Date})],e.prototype,"modified",void 0),d([b.property()],e.prototype,"name",void 0),d([b.property()],e.prototype,"numComments",void 0),d([b.property()],e.prototype,"numRatings",void 0),d([b.property()],e.prototype,"numViews",void 0),d([b.property()],e.prototype,
"owner",void 0),d([b.property()],e.prototype,"ownerFolder",void 0),d([b.property({type:c})],e.prototype,"portal",void 0),d([b.property()],e.prototype,"resourceInfo",void 0),d([b.property()],e.prototype,"size",void 0),d([b.property()],e.prototype,"snippet",void 0),d([b.property()],e.prototype,"tags",void 0),d([b.property()],e.prototype,"thumbnail",void 0),d([b.property({dependsOn:["itemUrl","thumbnail","portal.credential.token"],readOnly:!0})],e.prototype,"thumbnailUrl",null),d([b.property()],e.prototype,
"title",void 0),d([b.property()],e.prototype,"type",void 0),d([b.property()],e.prototype,"typeKeywords",void 0),d([b.property()],e.prototype,"url",void 0),d([b.property({dependsOn:["portal.restUrl","portal.user.username","owner","ownerFolder","id"],readOnly:!0})],e.prototype,"userItemUrl",null),e=u=d([b.subclass("esri.portal.PortalItem")],e);var u}(b.declared(a,e))})},"esri/core/tsSupport/declareExtendsHelper":function(){define(["require","exports"],function(m,l){return function(h,d){h.__bases__=
d.__bases__}})},"esri/core/tsSupport/decorateHelper":function(){define([],function(){return function(m,l,h,d){var b,g=arguments.length,k=3>g?l:null===d?d=Object.getOwnPropertyDescriptor(l,h):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)k=Reflect.decorate(m,l,h,d);else for(var f=m.length-1;0<=f;f--)(b=m[f])&&(k=(3>g?b(k):3<g?b(l,h,k):b(l,h))||k);return 3<g&&k&&Object.defineProperty(l,h,k),k}})},"esri/core/accessorSupport/decorators":function(){define("require exports ./decorators/aliasOf ./decorators/autoDestroy ./decorators/cast ./decorators/declared ./decorators/property ./decorators/reader ./decorators/shared ./decorators/subclass ./decorators/writer".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){function q(a){for(var c in a)l.hasOwnProperty(c)||(l[c]=a[c])}Object.defineProperty(l,"__esModule",{value:!0});q(h);q(d);q(b);q(g);q(k);q(f);q(a);q(e);q(c)})},"esri/core/accessorSupport/decorators/aliasOf":function(){define(["require","exports","../metadata"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.aliasOf=function(d){return function(b,g){h.getPropertyMetadata(b,g).aliasOf=d}}})},"esri/core/accessorSupport/metadata":function(){define(["require",
"exports"],function(m,l){function h(b){return null!=b.__accessorMetadata__}function d(f){return h(f)&&null!=b(f).properties}function b(b){return b.__accessorMetadata__||Object.defineProperty(b,"__accessorMetadata__",{value:{},enumerable:!0,configurable:!0,writable:!0}),b.__accessorMetadata__}function g(f){f=b(f);var a=f.properties;return a||(a=f.properties={}),a}function k(f,a){var e=b(f);(f=e.parameters)||(f=e.parameters={});e=f[a];return e||(e=[],f[a]=e),e}Object.defineProperty(l,"__esModule",{value:!0});
l.hasMetadata=h;l.hasPropertiesMetadata=d;l.hasPropertyMetadata=function(b,a){return d(b)&&null!=g(b)[a]};l.hasParametersMetadata=function(f,a){return h(f)&&null!=b(f).parameters&&null!=b(f).parameters[a]};l.getMetadata=b;l.getPropertiesMetadata=g;l.getPropertyMetadata=function(b,a){b=g(b);var e=b[a];return e||(e=b[a]={}),e};l.setPropertyMetadata=function(b,a,e){g(b)[a]=e};l.getParametersMetadata=k;l.getParameterMetadata=function(b,a,e){var c=k(b,a)[e];return c||(k(b,a)[e]=c={index:e}),c}})},"esri/core/accessorSupport/decorators/autoDestroy":function(){define(["require",
"exports","../metadata"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.autoDestroy=function(){return function(d,b,g){return h.getMetadata(d).autoDestroy=!0,d[b]}}})},"esri/core/accessorSupport/decorators/cast":function(){define(["require","exports","../metadata","../ensureType"],function(m,l,h,d){function b(a){var c="_meta"in a?d.ensureType(a):a;return function(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];return a.push(c),"number"==typeof a[2]?k.apply(this,a):g.apply(this,
a)}}function g(a,c,b,f){h.getPropertyMetadata(a,c).cast=f}function k(a,c,b,f){h.getParameterMetadata(a,c,b).cast=f}function f(a){return function(c,e,b){h.getPropertyMetadata(c,a).cast=c[e]}}Object.defineProperty(l,"__esModule",{value:!0});var a=Object.prototype.toString;l.autocastMethod=function(a,c,b){if(h.hasParametersMetadata(a,c)){var e=h.getParametersMetadata(a,c).filter(function(a){return null!=a.cast});if(!e.length)return void console.warn("Method "+a.declaredClass+"::"+c+" is decorated with @cast but no parameters are decorated");
var f=b.value;return b.value=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];for(c=0;c<e.length;c++){var b=e[c];a[b.index]=b.cast(a[b.index])}return f.apply(this,a)},b}};l.cast=function(){for(var e=[],c=0;c<arguments.length;c++)e[c]=arguments[c];return 3!==e.length||"string"!=typeof e[1]?1===e.length&&"[object Function]"===a.call(e[0])?b(e[0]):1===e.length&&"string"==typeof e[0]?f(e[0]):void 0:void 0}})},"esri/core/accessorSupport/ensureType":function(){define(["require","exports",
"../Logger"],function(m,l,h){function d(a,c){return c.isInstanceOf?c.isInstanceOf(a):c instanceof a}function b(a){return null==a?a:new Date(a)}function g(a){return null==a?a:!!a}function k(a){return null==a?a:a.toString()}function f(a){return null==a?a:parseFloat(a)}function a(a){return a&&a.constructor&&void 0!==a.constructor._meta}function e(a,c){return null!=c&&a&&!d(a,c)}function c(c,n){return e(c,n)&&(a(n)?x.error("Accessor#set","Assigning an instance of '"+(n.declaredClass||"unknown")+"' which is not a subclass of '"+
(c&&c.prototype&&c.prototype.declaredClass||"unknown")+"'"):n=new c(n)),n}function q(a){switch(a){case Number:return f;case Boolean:return g;case String:return k;case Date:return b;default:return c.bind(null,a)}}function t(a,c){var n=q(a);return 1===arguments.length?n:n(c)}function r(a,c){return 1===arguments.length?r.bind(null,a):c?Array.isArray(c)?c.map(a):[a(c)]:c}function u(a,c,e){return 0!==c&&Array.isArray(e)?e.map(function(n){return u(a,c-1,n)}):a(e)}function v(a,c,e){if(2===arguments.length)return v.bind(null,
a,c);if(!e)return e;e=u(a,c,e);for(var n=c,b=e;0<n&&Array.isArray(b);)n--,b=b[0];if(void 0!==b)for(b=0;n>b;b++)e=[e];return e}Object.defineProperty(l,"__esModule",{value:!0});var x=h.getLogger("esri.core.Accessor");l.isInstanceOf=d;l.ensureDate=b;l.ensureBoolean=g;l.ensureString=k;l.ensureNumber=f;l.isClassedType=a;l.requiresType=e;l.ensureClass=c;l.ensureType=t;l.ensureArrayTyped=r;l.ensureArray=function(a,c){return 1===arguments.length?r(t.bind(null,a)):r(t.bind(null,a),c)};l.ensureNArrayTyped=
v;l.ensureNArray=function(a,c,e){return 2===arguments.length?v(t.bind(null,a),c):v(t.bind(null,a),c,e)};l.ensureOneOfType=function(c){var n={},b=[],f=[],d;for(d in c.typeMap){var g=c.typeMap[d];n[d]=t(g);b.push(g&&g.prototype&&g.prototype.declaredClass||"unknown");f.push(d)}var q="string"==typeof c.key?function(a){return a[c.key]}:c.key;return function(d){if(c.base&&!e(c.base,d))return d;var w=q(d),g=n[w];if(!g)return x.error("Accessor#set","Invalid property value, value needs to be one of "+("'"+
b.join("', '")+"'")+", or a plain object that can auto-cast (having .type \x3d "+("'"+f.join("', '")+"'")+")"),null;if(!e(c.typeMap[w],d))return d;if("string"!=typeof c.key||a(d))return g(d);var w={},k;for(k in d)k!==c.key&&(w[k]=d[k]);return g(w)}};l["default"]=t})},"esri/core/Logger":function(){define(["require","exports","dojo/has"],function(m,l,h){var d={info:0,warn:1,error:2};m=function(){function b(d){void 0===d&&(d={});this.module=d.module||"";this.writer=d.writer||null;this.level=d.level||
null;null!=d.enabled&&(this.enabled=!!d.enabled);b._loggers[this.module]=this;d=this.module.lastIndexOf(".");-1!==d&&(this.parent=b.getLogger(this.module.slice(0,d)))}return b.prototype.log=function(b){for(var d=[],f=1;f<arguments.length;f++)d[f-1]=arguments[f];this._isEnabled()&&this._matchLevel(b)&&(f=this._inheritedWriter())&&f.apply(void 0,[b,this.module].concat(d))},b.prototype.error=function(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];this.log.apply(this,["error"].concat(b))},
b.prototype.warn=function(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];this.log.apply(this,["warn"].concat(b))},b.prototype.info=function(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];this.log.apply(this,["info"].concat(b))},b.prototype.getLogger=function(d){return b.getLogger(this.module+"."+d)},b.getLogger=function(d){var g=b._loggers[d];return g||(g=new b({module:d})),g},b.prototype._parentWithMember=function(b,d){for(var f=this;f&&null==f[b];)f=f.parent;return f?f[b]:
d},b.prototype._inheritedWriter=function(){return this._parentWithMember("writer",this._consoleWriter)},b.prototype._consoleWriter=function(b,d){for(var f=[],a=2;a<arguments.length;a++)f[a-2]=arguments[a];console[b].apply(console,["["+d+"]"].concat(f))},b.prototype._matchLevel=function(b){return d[this._parentWithMember("level","error")]<=d[b]},b.prototype._isEnabled=function(){return this._parentWithMember("enabled",!0)},b._loggers={},b}();l=m.getLogger("esri");return h("dojo-debug-messages")?l.level=
"info":l.level="warn",m})},"esri/core/accessorSupport/decorators/declared":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.declared=function(h){for(var d=[],b=1;b<arguments.length;b++)d[b-1]=arguments[b];b=function(){return this||{}};return b.__bases__=[h].concat(d),b}})},"esri/core/accessorSupport/decorators/property":function(){define("require exports dojo/has ../../Logger ../../lang ../metadata".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,
"__esModule",{value:!0});var k=d.getLogger("esri.core.accessorSupport.decorators.property");l.property=function(f){return void 0===f&&(f={}),function(a,e){var c=a.constructor.prototype;if(c===Function.prototype)return void(h("dojo-debug-messages")&&k.error("Inappropriate use of @property() on a static field: "+a.name+"."+e+". Accessor does not support static properties."));var d=Object.getOwnPropertyDescriptor(a,e);d&&(d.get||d.set)?(f=b.clone(f),d.set&&(f.set=d.set),d.get&&(f.get=d.get)):d&&d.hasOwnProperty("value")&&
(f=b.clone(f),h("dojo-debug-messages")&&f.hasOwnProperty("value")&&k.warn('@property() will redefine the value of "'+e+'" on "'+a.constructor.name+'" already defined in the metadata',f),f.value=d.value);a=g.getPropertyMetadata(c,e);for(var t in f)e=f[t],Array.isArray(e)?a[t]=(a[t]||[]).concat(e):a[t]=e}};l.propertyJSONMeta=function(b,a,e){b=g.getPropertyMetadata(b.constructor.prototype,e);b.json||(b.json={});b=b.json;return void 0!==a&&(b.origins||(b.origins={}),b.origins[a]||(b.origins[a]={}),b=
b.origins[a]),b}})},"esri/core/accessorSupport/decorators/reader":function(){define(["require","exports","dojo/_base/lang","./property"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.reader=function(b,g,k){var f,a;return void 0===g||Array.isArray(g)?(a=b,k=g,f=[void 0]):(a=g,f=Array.isArray(b)?b:[b]),function(e,c,b){var g=e.constructor.prototype;f.forEach(function(b){b=d.propertyJSONMeta(e,b,a);b.read&&"object"!=typeof b.read&&(b.read={});h.setObject("read.reader",g[c],b);k&&
(b.read.source=(b.read.source||[]).concat(k))})}}})},"esri/core/accessorSupport/decorators/shared":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.shared=function(h){return function(d,b){d[b]=h}}})},"esri/core/accessorSupport/decorators/subclass":function(){define(["require","exports","../../declare","../metadata"],function(m,l,h,d){function b(a,e){a.read&&("function"==typeof a.read?e.push(a.read):"object"==typeof a.read&&a.read.reader&&e.push(a.read.reader))}
function g(a,e){a.write&&("function"==typeof a.write?e.push(a.write):"object"==typeof a.write&&a.write.writer&&e.push(a.write.writer))}function k(a){var c=[];a=d.getPropertiesMetadata(a.prototype);if(!a)return c;for(var e in a){var f=a[e];f.cast&&c.push(f.cast);f.copy&&c.push(f.copy);if(f=f.json)if(b(f,c),g(f,c),f=f.origins)for(var k in f){var h=f[k];b(h,c);g(h,c)}}return c}function f(a){var c={values:{},descriptors:{}},b=["__bases__"],f=d.getPropertiesMetadata(a.prototype),g=k(a);return Object.getOwnPropertyNames(a.prototype).filter(function(c){return-1!==
b.indexOf(c)?!1:f&&f.hasOwnProperty(c)?!1:e(Object.getOwnPropertyDescriptor(a.prototype,c))||-1===g.indexOf(a.prototype[c])?!0:!1}).forEach(function(b){var f=Object.getOwnPropertyDescriptor(a.prototype,b);e(f)?c.descriptors[b]=f:c.values[b]=a.prototype[b]}),c}function a(a){var c=Object.getOwnPropertyNames(a),b=Object.getPrototypeOf(a.prototype).constructor,f=Object.getOwnPropertyNames(Function);f.push("__bases__");var d=Object.getOwnPropertyNames(b),g={values:{},descriptors:{}};return c.filter(function(c){return-1!==
f.indexOf(c)?!1:-1===d.indexOf(c)?!0:b[c]!==a[c]?!0:!1}).forEach(function(c){var b=Object.getOwnPropertyDescriptor(a,c);e(b)?g.descriptors[c]=b:g.values[c]=a[c]}),g}function e(a){return a&&!(!a.get&&!a.set)}Object.defineProperty(l,"__esModule",{value:!0});l.subclass=function(c){return function(e){var b=f(e),d=a(e);null!=c&&(b.values.declaredClass=c);e=h(e.__bases__,b.values);Object.defineProperties(e.prototype,b.descriptors);for(var g in d.values)e[g]=d.values[g];return Object.defineProperties(e,
d.descriptors),e}}})},"esri/core/declare":function(){define(["require","exports","dojo/_base/declare"],function(m,l,h){function d(f,a){return f&&!Array.isArray(f)&&"function"!=typeof f&&(a=f,f=null),f=f||[],a=a||{},b([this].concat(f),a)}function b(b,a){b&&!Array.isArray(b)&&"function"!=typeof b&&(a=b,b=null);"function"==typeof b?b=[b]:b||(b=[]);a=a||{};var e,c;e=0;for(c=g.length;c>e;e++)g[e](b,a);b=h(b,a);b.createSubclass=d;e=0;for(c=k.length;c>e;e++)k[e](b);return b}var g=[],k=[];return function(b){b.hasMixin=
function(a,e){var c;if(c=Array.isArray(a)?a.reduce(function(a,c){return c._meta?a.concat(c._meta.bases):a},[]):a._meta?a._meta.bases:a,!c)return!1;if("string"==typeof e)for(a=c.length-1;0<=a;a--)if(c[a].prototype.declaredClass===e)return!0;return-1!==c.indexOf(e)};b.safeMixin=function(a,e){return h.safeMixin(a,e)};b.before=function(a){g.push(a)};b.after=function(a){k.push(a)}}(b||(b={})),b})},"esri/core/accessorSupport/decorators/writer":function(){define(["require","exports","dojo/_base/lang","./property"],
function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.writer=function(b,g,k){var f,a;return void 0===g?(a=b,f=[void 0]):"string"!=typeof g?(a=b,f=[void 0],k=g):(a=g,f=Array.isArray(b)?b:[b]),function(e,c,b){var g=e.constructor.prototype;f.forEach(function(b){b=d.propertyJSONMeta(e,b,a);b.write&&"object"!=typeof b.write&&(b.write={});k&&h.setObject("write.target",k,b);h.setObject("write.writer",g[c],b)})}}})},"esri/geometry/Extent":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Geometry ./Point ./SpatialReference ../core/lang ./support/spatialReferenceUtils ./support/webMercatorUtils ./support/coordsUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){function t(a,c,e){return null==c?e:null==e?c:a(c,e)}m=function(g){function r(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=g.apply(this,a)||this;return a.type="extent",a.xmin=0,a.ymin=0,a.mmin=void 0,a.zmin=void 0,a.xmax=0,a.ymax=0,a.mmax=void 0,a.zmax=void 0,a}return h(r,g),v=r,r.prototype.normalizeCtorArgs=function(a,c,e,b,d){return!a||"esri.SpatialReference"!==a.declaredClass&&null==a.wkid?"object"==typeof a?(a.spatialReference=null!=a.spatialReference?
a.spatialReference:f.WGS84,a):{xmin:a,ymin:c,xmax:e,ymax:b,spatialReference:null!=d?d:f.WGS84}:{spatialReference:a,xmin:0,ymin:0,xmax:0,ymax:0}},Object.defineProperty(r.prototype,"center",{get:function(){var a=new k({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(a.z=.5*(this.zmin+this.zmax)),this.hasM&&(a.m=.5*(this.mmin+this.mmax)),a},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"extent",{get:function(){return this.clone()},
enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hasM",{get:function(){return null!=this.mmin&&null!=this.mmax},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hasZ",{get:function(){return null!=this.zmin&&null!=this.zmax},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return Math.abs(this.ymax-this.ymin)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return Math.abs(this.xmax-
this.xmin)},enumerable:!0,configurable:!0}),r.prototype.centerAt=function(a){var c=this.center;return null!=a.z&&this.hasZ?this.offset(a.x-c.x,a.y-c.y,a.z-c.z):this.offset(a.x-c.x,a.y-c.y)},r.prototype.clone=function(){var a=new v;return a.xmin=this.xmin,a.ymin=this.ymin,a.xmax=this.xmax,a.ymax=this.ymax,a.spatialReference=this.spatialReference,null!=this.zmin&&(a.zmin=this.zmin,a.zmax=this.zmax),null!=this.mmin&&(a.mmin=this.mmin,a.mmax=this.mmax),a},r.prototype.contains=function(a){if(!a)return!1;
if("point"===a.type){var e=this.spatialReference,n=a.spatialReference,b=void 0,f=a.x,d=a.y;a=a.z;return e&&n&&!e.equals(n)&&c.canProject(e,n)&&(b=e.isWebMercator?c.lngLatToXY(f,d):c.xyToLngLat(f,d,[0,0],0,!0),f=b[0],d=b[1]),f>=this.xmin&&f<=this.xmax&&d>=this.ymin&&d<=this.ymax?null!=a&&this.hasZ?a>=this.zmin&&a<=this.zmax:!0:!1}return"extent"===a.type?this._containsExtent(a):!1},r.prototype.equals=function(a){if(!a)return!1;var e=this.spatialReference;if(!e.equals(a.spatialReference)){if(!c.canProject(a.spatialReference,
e))return!1;a=c.project(a,e)}return this.xmin===a.xmin&&this.ymin===a.ymin&&this.zmin===a.zmin&&this.mmin===a.mmin&&this.xmax===a.xmax&&this.ymax===a.ymax&&this.zmax===a.zmax&&this.mmax===a.mmax},r.prototype.expand=function(a){a=.5*(1-a);var c=this.width*a,e=this.height*a;if(this.xmin+=c,this.ymin+=e,this.xmax-=c,this.ymax-=e,this.hasZ)c=(this.zmax-this.zmin)*a,this.zmin+=c,this.zmax-=c;this.hasM&&(a*=this.mmax-this.mmin,this.mmin+=a,this.mmax-=a);return this},r.prototype.intersects=function(a){if(!a)return!1;
var e=this.spatialReference,n=a.spatialReference;switch(e&&n&&!e.equals(n)&&c.canProject(e,n)&&(a=e.isWebMercator?c.geographicToWebMercator(a):c.webMercatorToGeographic(a,!0)),a.type){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);case "polyline":return this._intersectsPolyline(a)}},r.prototype.normalize=function(){var a=this._normalize(!1,!0);return Array.isArray(a)?
a:[a]},r.prototype.offset=function(a,c,e){return this.xmin+=a,this.ymin+=c,this.xmax+=a,this.ymax+=c,null!=e&&(this.zmin+=e,this.zmax+=e),this},r.prototype.shiftCentralMeridian=function(){return this._normalize(!0)},r.prototype.union=function(a){return this.xmin=Math.min(this.xmin,a.xmin),this.ymin=Math.min(this.ymin,a.ymin),this.xmax=Math.max(this.xmax,a.xmax),this.ymax=Math.max(this.ymax,a.ymax),(this.hasZ||a.hasZ)&&(this.zmin=t(Math.min,this.zmin,a.zmin),this.zmax=t(Math.max,this.zmax,a.zmax)),
(this.hasM||a.hasM)&&(this.mmin=t(Math.min,this.mmin,a.mmin),this.mmax=t(Math.max,this.mmax,a.mmax)),this},r.prototype.intersection=function(a){return this._intersectsExtent(a)?(this.xmin=Math.max(this.xmin,a.xmin),this.ymin=Math.max(this.ymin,a.ymin),this.xmax=Math.min(this.xmax,a.xmax),this.ymax=Math.min(this.ymax,a.ymax),(this.hasZ||a.hasZ)&&(this.zmin=t(Math.max,this.zmin,a.zmin),this.zmax=t(Math.min,this.zmax,a.zmax)),(this.hasM||a.hasM)&&(this.mmin=t(Math.max,this.mmin,a.mmin),this.mmax=t(Math.min,
this.mmax,a.mmax)),this):null},r.prototype.toJSON=function(a){return this.write(null,a)},r.prototype._containsExtent=function(a){var c=a.xmin,e=a.ymin,b=a.zmin,f=a.xmax,d=a.ymax,g=a.zmax;a=a.spatialReference;return null!=b&&this.hasZ?this.contains(new k(c,e,b,a))&&this.contains(new k(c,d,b,a))&&this.contains(new k(f,d,b,a))&&this.contains(new k(f,e,b,a))&&this.contains(new k(c,e,g,a))&&this.contains(new k(c,d,g,a))&&this.contains(new k(f,d,g,a))&&this.contains(new k(f,e,g,a)):this.contains(new k(c,
e,a))&&this.contains(new k(c,d,a))&&this.contains(new k(f,d,a))&&this.contains(new k(f,e,a))},r.prototype._intersectsMultipoint=function(a){for(var c=a.points.length,e=0;c>e;e++)if(this.contains(a.getPoint(e)))return!0;return!1},r.prototype._intersectsExtent=function(a){var c,e,b,f=this.hasZ&&a.hasZ;if(this.xmin<=a.xmin){if(c=a.xmin,this.xmax<c)return!1}else if(c=this.xmin,a.xmax<c)return!1;if(this.ymin<=a.ymin){if(e=a.ymin,this.ymax<e)return!1}else if(e=this.ymin,a.ymax<e)return!1;if(f&&a.hasZ)if(this.zmin<=
a.zmin){if(b=a.zmin,this.zmax<b)return!1}else if(b=this.zmin,a.zmax<b)return!1;return!0},r.prototype._intersectsPolygon=function(a){for(var c=[this.xmin,this.ymax],e=[this.xmax,this.ymax],b=[this.xmin,this.ymin],f=[this.xmax,this.ymin],d=[c,e,b,f],g=new k(0,0,this.spatialReference),q=d.length,t=0;q>t;t++)if(g.x=d[t][0],g.y=d[t][1],a.contains(g))return!0;g.set({x:0,y:0,spatialReference:a.spatialReference});a=a.rings;d=a.length;c=[[b,c],[c,e],[e,f],[f,b]];for(t=0;d>t;t++)if(e=a[t],b=e.length){f=e[0];
if(g.x=f[0],g.y=f[1],this.contains(g))return!0;for(q=1;b>q;q++){var r=e[q];if(g.x=r[0],g.y=r[1],this.contains(g)||this._intersectsLine([f,r],c))return!0;f=r}}return!1},r.prototype._intersectsPolyline=function(a){var c=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],e=a.paths,b=e.length;a=new k(0,0,a.spatialReference);for(var f=0;b>f;f++){var d=e[f],g=d.length;if(g){var q=
d[0];if(a.x=q[0],a.y=q[1],this.contains(a))return!0;for(var t=1;g>t;t++){var r=d[t];if(a.x=r[0],a.y=r[1],this.contains(a)||this._intersectsLine([q,r],c))return!0;q=r}}}return!1},r.prototype._intersectsLine=function(a,c){for(var e=0;e<c.length;e++)if(q._getLineIntersection2(a,c[e]))return!0;return!1},r.prototype._shiftCM=function(b){if(void 0===b&&(b=e.getInfo(this.spatialReference)),!b||!this.spatialReference)return this;var d=this.spatialReference,n=this._getCM(b);if(n){var w=d.isWebMercator?c.webMercatorToGeographic(n):
n;this.xmin-=n.x;this.xmax-=n.x;d.isWebMercator||(w.x=this._normalizeX(w.x,b).x);this.spatialReference=new f(a.substitute({Central_Meridian:w.x},d.isWGS84?b.altTemplate:b.wkTemplate))}return this},r.prototype._getCM=function(a){var c=null,e=a.valid;a=e[0];var e=e[1],b=this.xmin,f=this.xmax;return b>=a&&e>=b&&f>=a&&e>=f||(c=this.center),c},r.prototype._normalize=function(a,c,n){var b=this.spatialReference;if(!b||(n=n||e.getInfo(b),!n))return this;var f=this._getParts(n).map(function(a){return a.extent});
if(2>f.length)return f[0]||this;if(2<f.length)return a?this._shiftCM(n):this.set({xmin:n.valid[0],xmax:n.valid[1]});if(a)return this._shiftCM(n);if(c)return f;var d=!0,g=!0;return f.forEach(function(a){a.hasZ||(d=!1);a.hasM||(g=!1)}),{rings:f.map(function(a){var c=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(d)for(var e=(a.zmax-a.zmin)/2,n=0;n<c.length;n++)c[n].push(e);if(g)for(a=(a.mmax-a.mmin)/2,n=0;n<c.length;n++)c[n].push(a);return c}),hasZ:d,hasM:g,spatialReference:b}},
r.prototype._getParts=function(a){var c=this.cache._parts;if(!c){var c=[],n=this.ymin,b=this.ymax,f=this.spatialReference,d=this.width,g=this.xmin,q=this.xmax,k=void 0;a=a||e.getInfo(f);var t=a.valid,r=t[0],h=t[1],k=this._normalizeX(this.xmin,a),u=k.x,t=k.frameId,k=this._normalizeX(this.xmax,a),x=k.x;a=k.frameId;k=u===x&&0<d;if(d>2*h){d=new v(q>g?u:x,n,h,b,f);g=new v(r,n,q>g?x:u,b,f);q=new v(0,n,h,b,f);n=new v(r,n,0,b,f);b=[];f=[];d.contains(q)&&b.push(t);d.contains(n)&&f.push(t);g.contains(q)&&b.push(a);
g.contains(n)&&f.push(a);for(r=t+1;a>r;r++)b.push(r),f.push(r);c.push({extent:d,frameIds:[t]},{extent:g,frameIds:[a]},{extent:q,frameIds:b},{extent:n,frameIds:f})}else u>x||k?c.push({extent:new v(u,n,h,b,f),frameIds:[t]},{extent:new v(r,n,x,b,f),frameIds:[a]}):c.push({extent:new v(u,n,x,b,f),frameIds:[t]});this.cache._parts=c}a=this.hasZ;n=this.hasM;if(a||n)for(t={},a&&(t.zmin=this.zmin,t.zmax=this.zmax),n&&(t.mmin=this.mmin,t.mmax=this.mmax),a=0;a<c.length;a++)c[a].extent.set(t);return c},r.prototype._normalizeX=
function(a,c){var e,b=c.valid;c=b[0];var b=b[1],f=2*b,d=0;return a>b?(e=Math.ceil(Math.abs(a-b)/f),a-=e*f,d=e):c>a&&(e=Math.ceil(Math.abs(a-c)/f),a+=e*f,d=-e),{x:a,frameId:d}},d([b.property({dependsOn:"xmin ymin zmin mmin xmax ymax zmax mmax spatialReference".split(" ")})],r.prototype,"cache",void 0),d([b.property({readOnly:!0,dependsOn:["cache"]})],r.prototype,"center",null),d([b.property({readOnly:!0,dependsOn:["cache"]})],r.prototype,"extent",null),d([b.property({readOnly:!0,dependsOn:["mmin",
"mmax"],json:{write:{enabled:!1,overridePolicy:null}}})],r.prototype,"hasM",null),d([b.property({readOnly:!0,dependsOn:["zmin","zmax"],json:{write:{enabled:!1,overridePolicy:null}}})],r.prototype,"hasZ",null),d([b.property({readOnly:!0,dependsOn:["ymin","ymax"]})],r.prototype,"height",null),d([b.property({readOnly:!0,dependsOn:["xmin","xmax"]})],r.prototype,"width",null),d([b.property({type:Number,json:{write:!0}})],r.prototype,"xmin",void 0),d([b.property({type:Number,json:{write:!0}})],r.prototype,
"ymin",void 0),d([b.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],r.prototype,"mmin",void 0),d([b.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],r.prototype,"zmin",void 0),d([b.property({type:Number,json:{write:!0}})],r.prototype,"xmax",void 0),d([b.property({type:Number,json:{write:!0}})],r.prototype,"ymax",void 0),d([b.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],
r.prototype,"mmax",void 0),d([b.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],r.prototype,"zmax",void 0),r=v=d([b.subclass("esri.geometry.Extent")],r);var v}(b.declared(g));return m.prototype.toJSON.isDefaultToJSON=!0,m})},"esri/geometry/Geometry":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/JSONSupport ./SpatialReference".split(" "),function(m,l,
h,d,b,g,k){return function(f){function a(){var a=f.call(this)||this;return a.type=null,a.extent=null,a.hasM=!1,a.hasZ=!1,a.spatialReference=k.WGS84,a}return h(a,f),Object.defineProperty(a.prototype,"cache",{get:function(){return{}},enumerable:!0,configurable:!0}),a.prototype.clone=function(){return console.warn(".clone() is not implemented for "+this.declaredClass),null},a.prototype.clearCache=function(){this.notifyChange("cache")},a.prototype.getCacheValue=function(a){return this.cache[a]},a.prototype.setCacheValue=
function(a,c){this.cache[a]=c},d([b.property()],a.prototype,"type",void 0),d([b.property({readOnly:!0,dependsOn:["spatialReference"]})],a.prototype,"cache",null),d([b.property({readOnly:!0,dependsOn:["spatialReference"]})],a.prototype,"extent",void 0),d([b.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],a.prototype,"hasM",void 0),d([b.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],a.prototype,"hasZ",void 0),d([b.property({type:k,
json:{write:!0}})],a.prototype,"spatialReference",void 0),a=d([b.subclass("esri.geometry.Geometry")],a)}(b.declared(g))})},"esri/core/JSONSupport":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./declare ./accessorSupport/read ./accessorSupport/write ./accessorSupport/decorators".split(" "),function(m,l,h,d,b,g,k,f,a){function e(a,c){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");var e=new this;return e.read(a,
c),e}var c=function(c){function b(){return null!==c&&c.apply(this,arguments)||this}return h(b,c),b.prototype.read=function(a,c){return k["default"](this,a,c),this},b.prototype.write=function(a,c){return f["default"](this,a||{},c)},b.prototype.toJSON=function(a){return this.write(null,a)},b.fromJSON=function(a,c){return e.call(this,a,c)},b=d([a.subclass("esri.core.JSONSupport")],b)}(a.declared(b));return c.prototype.toJSON.isDefaultToJSON=!0,g.after(function(a){g.hasMixin(a,c)&&(a.fromJSON=e.bind(a))}),
c})},"esri/core/Accessor":function(){define("./declare ./accessorSupport/Properties ./accessorSupport/get ./accessorSupport/introspection ./accessorSupport/set ./accessorSupport/watch".split(" "),function(m,l,h,d,b,g){l=l["default"];m.before(function(b,a){m.hasMixin(b,k)&&d.processPrototype(a)});m.after(function(b){m.hasMixin(b,k)&&(d.processClass(b),Object.defineProperties(b.prototype,{initialized:{get:function(){return this.__accessor__&&this.__accessor__.initialized||!1}},destroyed:{get:function(){return this.__accessor__&&
this.__accessor__.destroyed||!1}}}))});var k=m(null,{declaredClass:"esri.core.Accessor","-chains-":{initialize:"after",destroy:"before"},constructor:function(){if(this.constructor===k)throw Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");if(Object.defineProperty(this,"__accessor__",{value:new l(this)}),0<arguments.length&&this.normalizeCtorArgs){for(var b=[],a=0;a<arguments.length;a++)b.push(arguments[a]);this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,
b)}},__accessor__:null,postscript:function(b){var a,e=this.__accessor__;b=e.ctorArgs||b;null!=this.getDefaults&&(a=this.getDefaults(b||{}),this.set(a));e.initialize();b&&(this.set(b),e.ctorArgs=null);e.constructed();this.initialize()},initialize:function(){},destroy:function(){if(this.destroyed)try{throw Error("instance is already destroyed");}catch(f){console.warn(f.stack)}else g.removeTarget(this),this.__accessor__.destroy()},get:function(b){return h.get(this,b)},hasOwnProperty:function(b){return this.__accessor__?
this.__accessor__.has(b):Object.prototype.hasOwnProperty.call(this,b)},keys:function(){return this.__accessor__?this.__accessor__.keys():[]},set:function(f,a){return b.set(this,f,a),this},watch:function(b,a,e){return g.watch(this,b,a,e)},_clearOverride:function(b){return this.__accessor__.clearOverride(b)},_override:function(b,a){return this.__accessor__.override(b,a)},_isOverridden:function(b){return this.__accessor__.isOverridden(b)},notifyChange:function(b){this.__accessor__.propertyInvalidated(b)},
_get:function(b){return this.__accessor__.internalGet(b)},_set:function(b,a){return this.__accessor__.internalSet(b,a)}});return k})},"esri/core/accessorSupport/Properties":function(){define("require exports dojo/has ./Store ./PropertyOrigin ./extensions ../Logger".split(" "),function(m,l,h,d,b,g,k){function f(a,b){return b.metadatas[a]?!0:(h("dojo-debug-messages")&&e.warn("cannot access unknown property '"+a+"' on instance of "+b.host.declaredClass+"."),!1)}function a(a,b,f,d){return a.nonNullable&&
null==f?(h("dojo-debug-messages")&&e.warn("cannot set non-nullable property '"+b+"' to null on "+d.host.declaredClass+"."),!1):!0}Object.defineProperty(l,"__esModule",{value:!0});var e=k.getLogger("esri.core.accessorSupport.Properties");m=function(){function c(a){this.host=a;this._origin=b.OriginId.USER;this.ctorArgs=this.cursors=null;this.destroyed=!1;this.dirties={};this.lifecycle=0;this.overridden=null;this.store=new d["default"];a=this.host.constructor.__accessorMetadata__;this.metadatas=a.properties;
this.autoDestroy=a.autoDestroy}return c.prototype.initialize=function(){this.lifecycle=1;g.instanceCreated(this.host,this.metadatas)},c.prototype.constructed=function(){this.lifecycle=2},c.prototype.destroy=function(){this.destroyed=!0;var a=this.cursors;if(this.cursors)for(var c=0,e=Object.getOwnPropertyNames(a);c<e.length;c++){var b=e[c],f=a[b];if(f){for(;0<f.length;)f.pop().propertyDestroyed(this,b);a[b]=null}}if(this.autoDestroy)for(b in this.metadatas)(a=this.internalGet(b))&&a&&"function"==
typeof a.destroy&&(a.destroy(),this.metadatas[b].nonNullable||this.internalSet(b,null))},Object.defineProperty(c.prototype,"initialized",{get:function(){return 0!==this.lifecycle},enumerable:!0,configurable:!0}),c.prototype.clearOverride=function(a){this.isOverridden(a)&&(this.overridden[a]=!1,this.propertyInvalidated(a))},c.prototype.get=function(a){f(a,this);var c=this.metadatas[a];if(this.store.has(a)&&!this.dirties[a])return this.store.get(a);var e=c.get;return e?(c=e.call(this.host),this.store.set(a,
c,b.OriginId.COMPUTED),this.propertyCommitted(a),c):c.value},c.prototype.originOf=function(a){var c=this.store.originOf(a);return void 0===c&&(a=this.metadatas[a])&&a.hasOwnProperty("value")?"defaults":b.idToName(c)},c.prototype.has=function(a){return this.metadatas[a]?this.store.has(a):!1},c.prototype.internalGet=function(a){if(f(a,this)){var c=this.store;return c.has(a)?c.get(a):this.metadatas[a].value}},c.prototype.internalSet=function(a,c){f(a,this)&&(this.propertyInvalidated(a),this.initialized?
this.store.set(a,c,this._origin):this.store.set(a,c,b.OriginId.DEFAULTS),this.propertyCommitted(a))},c.prototype.isOverridden=function(a){return null!=this.overridden&&!0===this.overridden[a]},c.prototype.keys=function(){return this.store.keys()},c.prototype.override=function(c,e){if(f(c,this)){this.overridden||(this.overridden={});var b=this.metadatas[c];a(b,c,e,this)&&((b=b.cast)&&(e=b.call(this.host,e)),this.overridden[c]=!0,this.internalSet(c,e))}},c.prototype.set=function(c,e){if(f(c,this)){var b=
this.metadatas[c];if(a(b,c,e,this)){var d=b.set;(b=b.cast)&&(e=b.call(this.host,e));d?d.call(this.host,e):this.internalSet(c,e)}}},c.prototype.setDefaultOrigin=function(a){this._origin=b.nameToId(a)},c.prototype.propertyInvalidated=function(a){var c=this.dirties,e=this.isOverridden(a),b=this.cursors&&this.cursors[a],f=this.metadatas[a].computes;if(b)for(var d=0;d<b.length;d++)b[d].propertyInvalidated(this,a);if(e||(c[a]=!0),f)for(a=0;a<f.length;a++)this.propertyInvalidated(f[a])},c.prototype.propertyCommitted=
function(a){var c=this.cursors&&this.cursors[a];if(this.dirties[a]=!1,c)for(var e=0;e<c.length;e++)c[e].propertyCommitted(this,a)},c.prototype.addCursor=function(a,c){this.cursors||(this.cursors={});var e=this.cursors[a];e||(this.cursors[a]=e=[]);e.push(c)},c.prototype.removeCursor=function(a,c){var e=this.cursors[a];this.cursors[a]&&(e.splice(e.indexOf(c),1),0===e.length&&(this.cursors[a]=null))},c}();l["default"]=m})},"esri/core/accessorSupport/Store":function(){define(["require","exports","./PropertyOrigin"],
function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function d(){this._values={}}return d.prototype.get=function(b){return this._values[b]},d.prototype.originOf=function(b){return h.OriginId.USER},d.prototype.keys=function(){return Object.keys(this._values)},d.prototype.set=function(b,d){this._values[b]=d},d.prototype.clear=function(b){delete this._values[b]},d.prototype.has=function(b){return b in this._values},d}();l["default"]=m})},"esri/core/accessorSupport/PropertyOrigin":function(){define(["require",
"exports"],function(m,l){function h(d){switch(d){case "defaults":return b.DEFAULTS;case "service":return b.SERVICE;case "portal-item":return b.PORTAL_ITEM;case "web-scene":return b.WEB_SCENE;case "web-map":return b.WEB_MAP;case "user":return b.USER}}function d(d){switch(d){case b.DEFAULTS:return"defaults";case b.SERVICE:return"service";case b.PORTAL_ITEM:return"portal-item";case b.WEB_SCENE:return"web-scene";case b.WEB_MAP:return"web-map";case b.USER:return"user"}}Object.defineProperty(l,"__esModule",
{value:!0});var b;!function(b){b[b.DEFAULTS=0]="DEFAULTS";b[b.COMPUTED=1]="COMPUTED";b[b.SERVICE=2]="SERVICE";b[b.PORTAL_ITEM=3]="PORTAL_ITEM";b[b.WEB_SCENE=4]="WEB_SCENE";b[b.WEB_MAP=5]="WEB_MAP";b[b.USER=6]="USER";b[b.NUM=7]="NUM"}(b=l.OriginId||(l.OriginId={}));l.nameToId=h;l.idToName=d;l.readableNameToId=function(b){return h(b)};l.idToReadableName=function(b){return d(b)};l.writableNameToId=function(b){return h(b)};l.idToWritableName=function(b){return d(b)}})},"esri/core/accessorSupport/extensions":function(){define(["require",
"exports","./extensions/aliasedProperty","./extensions/computedProperty","./extensions/serializableProperty"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});var g=[h["default"],d["default"],b["default"]];l.processPrototypeMetadatas=function(b,f){for(var a=Object.getOwnPropertyNames(b),e=0;e<g.length;e++){var c=g[e];if(c.processPrototypePropertyMetadata)for(var d=0,k=a;d<k.length;d++){var r=k[d];c.processPrototypePropertyMetadata(r,b[r],b,f)}}};l.processClassMetadatas=function(b,
f){for(var a=Object.getOwnPropertyNames(b),e=0;e<g.length;e++){var c=g[e];if(c.processClassPropertyMetadata)for(var d=0,k=a;d<k.length;d++){var r=k[d];c.processClassPropertyMetadata(r,b[r],b,f)}}};l.instanceCreated=function(b,f){for(var a=Object.getOwnPropertyNames(f),e=0;e<g.length;e++){var c=g[e];c.instanceCreated&&c.instanceCreated(b,f,a)}}})},"esri/core/accessorSupport/extensions/aliasedProperty":function(){define("require exports dojo/has ../wire ../utils ../get ../set".split(" "),function(m,
l,h,d,b,g,k){function f(a,c,f){var e=b.getProperties(a);return d.wire(a,f.aliasOf,function(){e.propertyInvalidated(c)})}Object.defineProperty(l,"__esModule",{value:!0});var a=h("dojo-debug-messages");l.AliasedPropertyExtension={processClassPropertyMetadata:function(e,c,b,f){var d=c.aliasOf;if(d){var q=d.split(".")[0];if(null==b[q])return void(a&&console.error("[accessor] class '"+f+"' - property '"+e+"' is alias of aliased of '"+d+"', but '"+q+"' isn't declared as property. This can be fix by adding '"+
q+"' to the metadata for example."));if(c.set)return void(a&&console.error("[accessor] class '"+f+"' - property '"+e+"' is alias of aliased of '"+d+"', so it cannot have a setter defined"));if(c.get)return void(a&&console.error("[accessor] class '"+f+"' - property '"+e+"' is alias of aliased of '"+d+"', so it cannot have a getter defined"));var t;c.get=function(){var a=g["default"](this,d);if("function"==typeof a){t||(t=d.split(".").slice(0,-1).join("."));var c=g["default"](this,t);c&&(a=a.bind(c))}return a};
c.readOnly||(c.set=function(a){return k["default"](this,d,a)})}},instanceCreated:function(a,c,b){for(var e=0;e<b.length;e++){var d=b[e],g=c[d];g.aliasOf&&f(a,d,g)}}};l["default"]=l.AliasedPropertyExtension})},"esri/core/accessorSupport/wire":function(){define(["require","exports","./utils"],function(m,l,h){function d(e,c,d){c=h.splitPath(c);if(Array.isArray(c)){for(var g=[],q=0;q<c.length;q++)g.push((new b(c[q],d)).install(e));return new f(g)}e=(new b(c,d)).install(e);return new a(e)}Object.defineProperty(l,
"__esModule",{value:!0});var b=function(){function a(a,e){return this.path=a,this.callback=e,this.chain=null,this.path=a,-1<a.indexOf(".")&&(this.chain=h.pathToArray(a)),this.callback=e,this}return a.prototype.install=function(a){return this.chain?new k(this,a):new g(this,a)},a.prototype.notify=function(a){this.callback(a,this.path)},a}(),g=function(){function a(a,e){this.binding=a;this.target=e;h.getProperties(e).addCursor(this.binding.path,this)}return a.prototype.destroy=function(){this.target&&
(h.getProperties(this.target).removeCursor(this.binding.path,this),this.target=this.binding=null)},a.prototype.propertyDestroyed=function(a,e){h.getProperties(this.target).removeCursor(e,this)},a.prototype.propertyInvalidated=function(a,e){this.binding&&this.binding.notify(this.target)},a.prototype.propertyCommitted=function(a,e){this.binding&&this.binding.notify(this.target)},a}(),k=function(){function a(a,e){return this.binding=a,this.target=e,this.stack=[],this.properties=h.getProperties(e),this.stack.push({properties:this.properties,
propertyName:a.chain[0]}),this.properties.addCursor(a.chain[0],this),this.moveForward(),this}return a.prototype.destroy=function(){for(;;){var a=this.stack.pop();if(null==a)break;a.properties.removeCursor(a.propertyName,this)}this.target=this.binding=null},a.prototype.propertyDestroyed=function(a,e){this.moveBackward(a,e)},a.prototype.propertyInvalidated=function(a,e){this.binding&&this.binding.notify(this.target)},a.prototype.propertyCommitted=function(a,e){this.binding&&(this.moveBackward(a,e),
this.moveForward(),this.binding.notify(this.target))},a.prototype.moveBackward=function(a,e){for(var c=this.stack,b=c[c.length-1];b.properties!==a&&b.propertyName!==e;)b.properties.removeCursor(b.propertyName,this),c.pop(),b=c[c.length-1]},a.prototype.moveForward=function(){var a=this.stack,e=a[a.length-1],e=e.properties.internalGet(e.propertyName);(e=h.getProperties(e))&&a.length<this.binding.chain.length&&(a=this.binding.chain[a.length],this.stack.push({properties:e,propertyName:a}),e.addCursor(a,
this),this.moveForward())},a}(),f=function(){function a(a){this.cursors=a}return a.prototype.remove=function(){for(var a=this.cursors;0<a.length;)a.pop().destroy();this.cursors=null},a}(),a=function(){function a(a){this.cursor=a}return a.prototype.remove=function(){this.cursor.destroy();this.cursor=null},a}();l.create=function(e,c){e=h.splitPath(e);if(Array.isArray(e)){for(var d=[],g=0;g<e.length;g++)d.push(new b(e[g],c));return function(a){for(var c=[],e=0;e<d.length;e++)c[e]=d[e].install(a);return new f(c)}}var k=
new b(e,c);return function(c){return new a(k.install(c))}};l.wire=d;l["default"]=d})},"esri/core/accessorSupport/utils":function(){define(["require","exports","../lang"],function(m,l,h){function d(b,a){return a?Object.keys(a).reduce(function(e,c){if("value"===c)return e[c]=a[c],e;if(void 0===e[c])return e[c]=h.clone(a[c]),e;var b=e[c],f=a[c];return b===f?e:(Array.isArray(f)||Array.isArray(e)?(b=b?Array.isArray(b)?e[c]=b.concat():e[c]=[b]:e[c]=[],f&&(Array.isArray(f)||(f=[f]),f.forEach(function(a){-1===
b.indexOf(a)&&b.push(a)}))):f&&"object"==typeof f?e[c]=d(b,f):(!e.hasOwnProperty(c)||a.hasOwnProperty(c))&&(e[c]=f),e)},b||{}):b}function b(b){return Array.isArray(b)?b:b.split(".")}function g(b){if(Array.isArray(b)||-1<b.indexOf(",")){b=Array.isArray(b)?b:b.split(",");for(var a=0;a<b.length;a++)b[a]=b[a].trim();return 1===b.length?b[0]:b}return b.trim()}function k(b){var a=!1;return function(){a||(a=!0,b())}}Object.defineProperty(l,"__esModule",{value:!0});l.getProperties=function(b){return b?b.__accessor__?
b.__accessor__:b.propertyInvalidated?b:null:null};l.isPropertyDeclared=function(b,a){return b&&b.metadatas&&null!=b.metadatas[a]};l.merge=d;l.pathToStringOrArray=function(f){return f?"string"==typeof f&&-1===f.indexOf(".")?f:b(f):f};l.pathToArray=b;l.splitPath=g;l.parse=function(b,a,e,c){a=g(a);if(Array.isArray(a)){var f=a.map(function(a){return c(b,a.trim(),e)});return{remove:k(function(){return f.forEach(function(a){return a.remove()})})}}return c(b,a.trim(),e)};l.once=k})},"esri/core/accessorSupport/get":function(){define(["require",
"exports","./utils"],function(m,l,h){function d(b,a,e){if(null!=e.getItemAt||Array.isArray(e)){var c=parseInt(b,10);if(!isNaN(c))return Array.isArray(e)?e[c]:e.getItemAt(c)}c=h.getProperties(e);return a?h.isPropertyDeclared(c,b)?c.get(b):e[b]:h.isPropertyDeclared(c,b)?c.internalGet(b):e[b]}function b(f,a,e,c){if(null==f)return f;f=d(a[c],e,f);return!f&&c<a.length-1?void 0:c===a.length-1?f:b(f,a,e,c+1)}function g(f,a,e,c){return void 0===e&&(e=!1),void 0===c&&(c=0),"string"==typeof a&&-1===a.indexOf(".")?
d(a,e,f):b(f,h.pathToArray(a),e,c)}function k(b,a){return g(b,a,!0)}Object.defineProperty(l,"__esModule",{value:!0});l.valueOf=g;l.get=k;l.exists=function(b,a){return void 0!==g(a,b,!0)};l["default"]=k})},"esri/core/accessorSupport/set":function(){define(["require","exports","dojo/has","../Logger","./get"],function(m,l,h,d,b){function g(f,a,e){if(f&&a)if("object"==typeof a){e=0;for(var c=Object.getOwnPropertyNames(a);e<c.length;e++){var d=c[e];g(f,d,a[d])}}else if("_"!==a[0]){if(-1!==a.indexOf("."))return a=
a.split("."),d=a.splice(a.length-1,1)[0],void g(b["default"](f,a),d,e);h("dojo-debug-messages")&&(d=f.__accessor__,null==d||d.metadatas[a]||k.warn("setting unknown property '"+a+"' on instance of "+d.host.declaredClass));f[a]=e}}Object.defineProperty(l,"__esModule",{value:!0});var k=d.getLogger("esri.core.accessorSupport.set");l.set=g;l["default"]=g})},"esri/core/accessorSupport/extensions/computedProperty":function(){define("require exports dojo/has ../../Logger ../utils ../wire".split(" "),function(m,
l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});var k=h("dojo-debug-messages"),f=d.getLogger("esri.core.accessorSupport.extensions.computedProperty");l.ComputedPropertyExtension={processClassPropertyMetadata:function(a,e,c,d){if(k){var q=e.dependsOn;q&&q.length&&q.map(function(a){return a.split(".")[0]}).forEach(function(e){null==c[e]&&f.error("[accessor] class '"+d+"' - property '"+a+"' depends on unknown property '"+e+"' which hasn't been found during introspection. This can be fix by adding '"+
e+"' to the metadata for example.")})}e.dependsOn&&(q=void 0,(q=e.dependsOn.slice())&&(e.wire=g.create(q,function(c){return b.getProperties(c).propertyInvalidated(a)})))},instanceCreated:function(a,e,c){for(var b=0;b<c.length;b++){var f=e[c[b]];f.wire&&f.wire(a)}}};l["default"]=l.ComputedPropertyExtension})},"esri/core/accessorSupport/extensions/serializableProperty":function(){define("require exports ./serializableProperty/shorthands ./serializableProperty/originAliases ./serializableProperty/reader ./serializableProperty/writer".split(" "),
function(m,l,h,d,b,g){function k(b,a,e){var c=b&&b.json;b&&b.json&&b.json.origins&&e&&(b=b.json.origins[e.origin])&&a in b&&(c=b);return c}Object.defineProperty(l,"__esModule",{value:!0});l.originSpecificReadPropertyDefinition=function(b,a){return k(b,"read",a)};l.originSpecificWritePropertyDefinition=function(b,a){return k(b,"write",a)};l.SerializablePropertyExtension={processPrototypePropertyMetadata:function(f,a,e,c){if(h.process(a)){d.process(a);e=a.type;for(c=0;Array.isArray(e);)e=e[0],c++;if(a.json.origins)for(var q in a.json.origins){var k=
a.json.origins[q];b.create(e,c,f,k);g.create(e,c,f,k)}b.create(e,c,f,a.json);g.create(e,c,f,a.json)}}};l["default"]=l.SerializablePropertyExtension})},"esri/core/accessorSupport/extensions/serializableProperty/shorthands":function(){define(["require","exports"],function(m,l){function h(b){"boolean"==typeof b.read?b.read={enabled:b.read}:"function"==typeof b.read?b.read={enabled:!0,reader:b.read}:b.read&&"object"==typeof b.read&&void 0===b.read.enabled&&(b.read.enabled=!0)}function d(b){"boolean"==
typeof b.write?b.write={enabled:b.write}:"function"==typeof b.write?b.write={enabled:!0,writer:b.write}:b.write&&"object"==typeof b.write&&void 0===b.write.enabled&&(b.write.enabled=!0)}Object.defineProperty(l,"__esModule",{value:!0});l.process=function(b){if(b.json||(b.json={}),h(b.json),d(b.json),b.json.origins)for(var g in b.json.origins)h(b.json.origins[g]),d(b.json.origins[g]);return!0}})},"esri/core/accessorSupport/extensions/serializableProperty/originAliases":function(){define(["require",
"exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.process=function(h){if(h.json&&h.json.origins){var d=h.json.origins,b={"web-document":["web-scene","web-map"]};h=function(g){if(d[g]){var f=d[g];b[g].forEach(function(a){d[a]=f});delete d[g]}};for(var g in b)h(g)}}})},"esri/core/accessorSupport/extensions/serializableProperty/reader":function(){define(["require","exports","dojo/_base/lang","./type"],function(m,l,h,d){function b(c,b,d,k){if(1<b)return f(c,b);if(1===b)return a(c);
if(e(c)){var q=a(c.prototype.itemType.Type);return function(a,e,b){return(a=q(a,e,b))?new c(a):a}}return g(c)}function g(a){return a.prototype.read?function(c,e,b){return null==c?c:(new a).read(c,b)}:a.fromJSON}function k(a,c,e,b){return 0!==b&&Array.isArray(c)?c.map(function(c){return k(a,c,e,b-1)}):a(c,null,e)}function f(a,c){a=g(a);var e=k.bind(null,a);return function(a,b,f){if(null==a)return a;a=e(a,f,c);b=c;for(f=a;0<b&&Array.isArray(f);)b--,f=f[0];if(void 0!==f)for(f=0;b>f;f++)a=[a];return a}}
function a(a){var c=g(a);return function(a,e,b){return null==a?a:Array.isArray(a)?a.map(function(a){return c(a,null,b)}):[c(a,null,b)]}}function e(a){return d.isCollection(a)?(a=a.prototype.itemType)&&a.Type&&"function"==typeof a.Type?c(a.Type):!1:!1}function c(a){return!!a&&(!!a.prototype.read||!!a.fromJSON||e(a))}Object.defineProperty(l,"__esModule",{value:!0});l.create=function(a,e,f,d){(!d.read||!d.read.reader&&!1!==d.read.enabled)&&c(a)&&h.setObject("read.reader",b(a,e,f,d),d)}})},"esri/core/accessorSupport/extensions/serializableProperty/type":function(){define(["require",
"exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.isCollection=function(h){return!!h&&!!h.prototype.declaredClass&&0===h.prototype.declaredClass.indexOf("esri.core.Collection")}})},"esri/core/accessorSupport/extensions/serializableProperty/writer":function(){define(["require","exports","dojo/_base/lang","./type"],function(m,l,h,d){function b(a,c,b,f){h.setObject(b,g(a,f),c)}function g(a,c){return a&&"function"==typeof a.write?a.write({},c):a&&"function"==typeof a.toJSON?
a.toJSON():"number"==typeof a?a===-(1/0)?-Number.MAX_VALUE:a===1/0?Number.MAX_VALUE:isNaN(a)?null:a:a}function k(a,c,b,f){var e;null===a?e=null:a&&"function"==typeof a.map?(e=a.map(function(a){return g(a,f)}),"function"==typeof e.toArray&&(e=e.toArray())):e=[g(a,f)];h.setObject(b,e,c)}function f(a,c,b){return 0!==b&&Array.isArray(a)?a.map(function(a){return f(a,c,b-1)}):g(a,c)}function a(a){return function(c,b,e,d){if(null===c)c=null;else{c=f(c,d,a);d=a;for(var g=c;0<d&&Array.isArray(g);)d--,g=g[0];
if(void 0!==g)for(g=0;d>g;g++)c=[c]}h.setObject(e,c,b)}}Object.defineProperty(l,"__esModule",{value:!0});l.create=function(e,c,f,g){g.write&&!g.write.writer&&!1!==g.write.enabled&&(1===c||d.isCollection(e)?g.write.writer=k:1<c?g.write.writer=a(c):g.write.writer=b)}})},"esri/core/accessorSupport/introspection":function(){define("require exports dojo/_base/lang ./utils ./metadata ./ensureType ./extensions ./decorators/cast".split(" "),function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});
var a=Object.prototype.hasOwnProperty,e=/^_([a-zA-Z0-9]+)(Getter|Setter|Reader|Writer|Caster)$/,c={Getter:"get",Setter:"set",Reader:"json.read.reader",Writer:"json.write.writer",Caster:"cast"},q=/^_(set|get)([a-zA-Z0-9]+)Attr$/;l.processPrototype=function(f){for(var t=f.declaredClass,u=f.properties||{},v=0,x=Object.getOwnPropertyNames(u);v<x.length;v++){var y=x[v],n=u[y],w=typeof n;null==n?b.setPropertyMetadata(f,y,{value:n}):Array.isArray(n)?b.setPropertyMetadata(f,y,{type:[n[0]],value:null}):"object"===
w?d.getProperties(n)||n instanceof Date?b.setPropertyMetadata(f,y,{type:n.constructor,value:n}):b.setPropertyMetadata(f,y,n):"boolean"===w?b.setPropertyMetadata(f,y,{type:Boolean,value:n}):"string"===w?b.setPropertyMetadata(f,y,{type:String,value:n}):"number"===w?b.setPropertyMetadata(f,y,{type:Number,value:n}):"function"===w&&b.setPropertyMetadata(f,y,{type:n,value:null})}v=0;for(x=Object.getOwnPropertyNames(f);v<x.length;v++){var w=x[v],n=f[w],u=y=void 0,z=e.exec(w);if(z?(y=z[1],u=c[z[2]]):(z=q.exec(w),
z&&(y=z[2][0].toLowerCase()+z[2].substr(1),u=z[1].toLowerCase())),y&&u)y=b.getPropertyMetadata(f,y),h.setObject(u,n,y)}v=0;for(x=Object.getOwnPropertyNames(b.getPropertiesMetadata(f));v<x.length;v++)if(y=x[v],n=b.getPropertyMetadata(f,y),u=n.type,w=n.types,void 0===n.value&&a.call(f,y)&&(n.value=f[y]),!n.cast&&u){y=n;n=0;for(w=u;Array.isArray(w);)w=w[0],n++;u=1===n?g.ensureArray(w):1<n?g.ensureNArray(w,n):g.ensureType(u);y.cast=u}else!n.cast&&w&&(Array.isArray(w)?n.cast=g.ensureArrayTyped(g.ensureOneOfType(w[0])):
n.cast=g.ensureOneOfType(w));return k.processPrototypeMetadatas(b.getPropertiesMetadata(f),t),b.getPropertiesMetadata(f)};l.processClass=function(a){for(var c=a.prototype,e=c.declaredClass,g=a._meta.bases,q={},t=g.length-1;0<=t;t--)d.merge(q,b.getMetadata(g[t].prototype));var n=q.properties;k.processClassMetadatas(n,e);Object.defineProperty(a,"__accessorMetadata__",{value:{properties:n,autoDestroy:!!q.autoDestroy}});for(var w={},e=function(a){var c=n[a];w[a]={enumerable:!0,configurable:!0,get:function(){return this.__accessor__?
this.__accessor__.get(a):c.value},set:function(b){var e=this.__accessor__;if(!e)return void Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:b});if(!Object.isFrozen(this)){if(e.initialized&&c.readOnly)throw new TypeError("[accessor] cannot assign to read-only property '"+a+"' of "+this.declaredClass);if(2===e.lifecycle&&c.constructOnly)throw new TypeError("[accessor] cannot assign to construct-only property '"+a+"' of "+this.declaredClass);e.set(a,b)}}}},g=0,t=Object.getOwnPropertyNames(n);g<
t.length;g++)e(t[g]);if(Object.defineProperties(a.prototype,w),q.parameters)for(a=0,e=Object.getOwnPropertyNames(q.parameters);a<e.length;a++)g=e[a],t=Object.getOwnPropertyDescriptor(c,g)||{value:c[g]},(t=f.autocastMethod(c,g,t))&&Object.defineProperty(c,g,t);return q}})},"esri/core/accessorSupport/watch":function(){define("require exports ../Scheduler ../ObjectPool ../ArrayPool ../lang ./utils ./get ./wire".split(" "),function(m,l,h,d,b,g,k,f,a){function e(a){n.has(a)?w.splice(w.indexOf(a),1):n.add(a);
w.push(a);v||(v=h.schedule(q))}function c(a){if(!a.removed){var c=a.callback,b=a.path,e=a.oldValue,n=a.target,d=f.valueOf(n,a.propertyPath,!0);!g.equals(e,d)&&(a.oldValue=d,c.call(n,d,e,b,n))}}function q(){if(v){v=null;var a=w;w=y.acquire();n.clear();for(var b=y.acquire(),e=0;e<a.length;e++){var f=a[e];c(f);f.removed&&b.push(f)}for(e=0;e<w.length;e++)f=w[e],f.removed&&(b.push(f),n["delete"](f),w.splice(e,1),--e);for(e=0;e<b.length;e++)x.pool.release(b[e]);y.release(a);y.release(b);z.forEach(function(a){return a()})}}
function t(c,b,n){var d=k.parse(c,b,n,function(c,b,n){var g,w=f.valueOf(c,b,!0),q=a.wire(c,b,function(a,c){return a.__accessor__.destroyed?void d.remove():(g||(g=x.pool.acquire(a,c,w,n),w=null),void e(g))});return{remove:k.once(function(){q.remove();g&&(g.removed=!0,e(g),g=null);d=q=w=null})}});return d}function r(c,e,b){var n=k.parse(c,e,b,function(c,e,b){var d=f.valueOf(c,e,!0),w=!1;return a.wire(c,e,function(a,c){if(a.__accessor__.destroyed)return void n.remove();if(!w){w=!0;var e=f.valueOf(a,
c,!0);!g.equals(d,e)&&b.call(a,e,d,c,a);d=f.valueOf(a,c,!0);w=!1}})});return n}function u(a,c,e,b){return void 0===b&&(b=!1),!a.__accessor__||a.__accessor__.destroyed?{remove:function(){}}:b?r(a,c,e):t(a,c,e)}Object.defineProperty(l,"__esModule",{value:!0});var v,x=function(){function a(a,c,e,b){this.target=a;this.path=c;this.oldValue=e;this.callback=b;this.removed=!1;this.propertyPath=k.pathToStringOrArray(c)}return a.prototype.release=function(){this.target=this.path=this.propertyPath=this.callback=
this.oldValue=null;this.removed=!0},a.pool=new d(a,!0),a}(),y=new b,n=new Set,w=y.acquire();l.dispatchTarget=function(a){for(var e=y.copy(w),b=0;b<e.length;b++){var f=e[b];f.target===a&&(c(f),n["delete"](f),w.splice(w.indexOf(f),1))}};l.removeTarget=function(a){for(var c=0;c<w.length;c++){var e=w[c];e.target===a&&(e.removed=!0)}};l.dispatch=q;var z=new Set;l.afterDispatch=function(a){return z.add(a),{remove:function(){z["delete"](a)}}};l.watch=u;l.isValueInUse=function(a){return w.some(function(c){return c.oldValue===
a})};l["default"]=u})},"esri/core/Scheduler":function(){define(["./ArrayPool","./ObjectPool","./nextTick","./requestAnimationFrame","./now"],function(m,l,h,d,b){var g=["prepare","preRender","render","postRender","update"],k=new l(function(){this.isActive=!0;this.callback=null},!0,function(a){a.isActive=!1;a.callback=null}),f=function(){},a=function(){this.item.isActive=!1;c.release(this)},e={time:0,deltaTime:0,spendInFrame:0,spendInTask:0},c=new l(function(){this.remove=a;this.item=null},!0,function(a){a.remove=
f;a.item=null});l=function(){this._boundDispatch=this._dispatch.bind(this);this.willDispatch=!1;this._queue=m.acquire();this._frameTasks=m.acquire();this._phaseTasks={};this._previousFrameTime=-1;for(var a=0;a<g.length;a++)this._phaseTasks[g[a]]=m.acquire();this._boundAnimationFrame=this._animationFrame.bind(this);this.executing=!1;this._animationFrameRequestId=null};l.prototype={schedule:function(a){var e=k.acquire();e.callback=a;this._schedule(e);a=c.acquire();return a.item=e,a},_dispatch:function(){for(var a=
this._queue;a.length;){var c=a.shift();c.isActive&&(c.isActive=!1,c.callback());!c.isActive}this.willDispatch=!1},_schedule:function(a){this._queue.push(a);this.willDispatch||(this.willDispatch=!0,h(this._boundDispatch))},addFrameTask:function(a){var c={phases:a,paused:!1,pausedAt:0,epoch:-1,dt:0,ticks:-1,removed:!1};this._frameTasks.push(c);for(var e=0;e<g.length;e++){var f=g[e];a[f]&&this._phaseTasks[f].push(c)}return this._animationFrameRequestId||(this._previousFrameTime=-1,this._requestAnimationFrame()),
{isPaused:function(){return c.paused},remove:function(){c.removed=!0},pause:function(){c.paused=!0;c.pausedAt=b()},resume:function(){c.paused=!1;-1!==c.epoch&&(c.epoch+=b()-c.pausedAt)}}},clearFrameTasks:function(){for(var a=0;a<this._frameTasks.length;a++)this._frameTasks[a].removed=!0},_purge:function(){for(var a=0;a<this._frameTasks.length;){var c=this._frameTasks[a];if(a++,c.removed){this._frameTasks.splice(a-1,1);for(var e=0;e<g.length;e++){var b=g[e];if(c.phases[b]){var b=this._phaseTasks[b],
f=b.indexOf(c);-1!==f&&b.splice(f,1)}}}}},_animationFrame:function(a){this._animationFrameRequestId=null;this.executing=!0;0<this._frameTasks.length&&this._requestAnimationFrame();a=b();0>this._previousFrameTime&&(this._previousFrameTime=a);var c=a-this._previousFrameTime;this._previousFrameTime=a;for(var f=0;f<this._frameTasks.length;f++){var d=this._frameTasks[f];-1!==d.epoch&&(d.dt=c)}for(f=0;f<g.length;f++)for(var c=g[f],q=this._phaseTasks[c],k=0;k<q.length;k++)d=q[k],d.paused||d.removed||(0===
f&&d.ticks++,-1===d.epoch&&(d.epoch=a),e.time=a,e.deltaTime=d.dt,e.spendInFrame=b()-a,e.spendInTask=a-d.epoch,d.phases[c].call(d,e));this._purge();this.executing=!1},_requestAnimationFrame:function(){this._animationFrameRequestId=d(this._boundAnimationFrame)}};var q=new l;return l.schedule=function(a){return q.schedule(a)},l.addFrameTask=function(a){return q.addFrameTask(a)},l.clearFrameTasks=function(){return q.clearFrameTasks()},Object.defineProperty(l,"executing",{get:function(){return q.executing}}),
l.instance=q,l})},"esri/core/ArrayPool":function(){define(["require","exports","./ObjectPool"],function(m,l,h){function d(b){b.length=0}var b=Array.prototype.splice;m=function(){function k(b,a){void 0===b&&(b=50);void 0===a&&(a=50);this._pool=new h(Array,!1,d,a,b)}return k.prototype.acquire=function(){return this._pool.acquire()},k.prototype.copy=function(f){var a=this.acquire();return f.unshift(0,0),b.apply(a,f),f.splice(0,2),a},k.prototype.release=function(b){this._pool.release(b)},k.acquire=function(){return g.acquire()},
k.copy=function(b){return g.copy(b)},k.release=function(b){return g.release(b)},k}();var g=new m(100);return m})},"esri/core/ObjectPool":function(){define(["require","exports"],function(m,l){var h=function(){return function(){}}();return function(){function d(b,d,k,f,a){void 0===f&&(f=1);void 0===a&&(a=0);this.classConstructor=b;this.acquireFunctionOrWithConstructor=d;this.releaseFunction=k;this.growthSize=f;!0===d?this.acquireFunction=this._constructorAcquireFunction:"function"==typeof d&&(this.acquireFunction=
d);this._pool=Array(a);this._set=new Set;this._initialSize=a;for(b=0;a>b;b++)this._pool[b]=new this.classConstructor;this.growthSize=Math.max(f,1)}return d.prototype.acquire=function(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];var k,d=this.classConstructor||h;if(0===this._pool.length)for(var f=this.growthSize,a=0;f>a;a++)this._pool[a]=new d;return k=this._pool.shift(),this.acquireFunction?this.acquireFunction.apply(this,[k].concat(b)):k&&k.acquire&&"function"==typeof k.acquire&&k.acquire.apply(k,
b),this._set["delete"](k),k},d.prototype.release=function(b){b&&!this._set.has(b)&&(this.releaseFunction?this.releaseFunction(b):b&&b.release&&"function"==typeof b.release&&b.release(),this._pool.push(b),this._set.add(b))},d.prototype.prune=function(){if(!(this._pool.length<=this._initialSize))for(var b;this._initialSize>this._pool.length;)b=this._pool.shift(),this._set["delete"](b),b.dispose&&"function"==typeof b.dispose&&b.dispose()},d.prototype._constructorAcquireFunction=function(b){for(var d=
[],k=1;k<arguments.length;k++)d[k-1]=arguments[k];(f=this.classConstructor).call.apply(f,[b].concat(d));var f},d}()})},"esri/core/nextTick":function(){define(["require","exports","./global"],function(m,l,h){function d(){if(h.postMessage&&!h.importScripts){var b=h.onmessage,d=!0;return h.onmessage=function(){d=!1},h.postMessage("","*"),h.onmessage=b,d}return!1}var b=h.MutationObserver||h.WebKitMutationObserver;return function(){var g;if(h.process&&h.process.nextTick)g=function(a){h.process.nextTick(a)};
else if(h.Promise)g=function(a){h.Promise.resolve().then(a)};else if(b){var k=[],f=document.createElement("div");(new b(function(){for(;0<k.length;)k.shift()()})).observe(f,{attributes:!0});g=function(a){k.push(a);f.setAttribute("queueStatus","1")}}else if(d()){var a=[];h.addEventListener("message",function(b){if(b.source===h&&"esri-nexttick-message"===b.data)for(b.stopPropagation();a.length;)a.shift()()},!0);g=function(b){a.push(b);h.postMessage("esri-nexttick-message","*")}}else g=h.setImmediate?
function(a){return h.setImmediate(a)}:function(a){return h.setTimeout(a,0)};return g}()})},"esri/core/global":function(){define(["require","exports"],function(m,l){return"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0})},"esri/core/requestAnimationFrame":function(){define(["require","exports","./global","dojo/sniff","./now"],function(m,l,h,d,b){var g;m=d("ff");l=d("ie");var k=d("webkit");d=d("opera");var f=b(),a=h.requestAnimationFrame;return a||
(g=k&&"webkit"||m&&"moz"||d&&"o"||l&&"ms",a=h[g+"RequestAnimationFrame"],a||(a=function(a){var c=b(),e=Math.max(0,16-(c-f)),d=h.setTimeout(function(){a(b())},e);return f=c+e,d})),a})},"esri/core/now":function(){define(["require","exports","./global"],function(m,l,h){return function(){var d=h.performance||{};if(d.now)return function(){return d.now()};if(d.webkitNow)return function(){return d.webkitNow()};if(d.mozNow)return function(){return d.mozNow()};if(d.msNow)return function(){return d.msNow()};
if(d.oNow)return function(){return d.oNow()};var b;return b=d.timing&&d.timing.navigationStart?d.timing.navigationStart:Date.now(),function(){return Date.now()-b}}()})},"esri/core/accessorSupport/read":function(){define("require exports dojo/_base/lang ./utils ./get ./extensions/serializableProperty".split(" "),function(m,l,h,d,b,g){function k(a,e,c){void 0===c&&(c=f);for(var q=d.getProperties(a),k=q.metadatas,r={},h=0,v=Object.getOwnPropertyNames(e);h<v.length;h++){var x=r,y=k,n=v[h],w=e,z=c,l=g.originSpecificReadPropertyDefinition(y[n],
z);l&&(!l.read||!1!==l.read.enabled&&!l.read.source)&&(x[n]=!0);for(var B=0,m=Object.getOwnPropertyNames(y);B<m.length;B++){var G=m[B],l=g.originSpecificReadPropertyDefinition(y[G],z),N;a:{N=n;var M=w;if(l&&l.read&&!1!==l.read.enabled&&l.read.source)if(l=l.read.source,"string"==typeof l){if(l===N||-1<l.indexOf(".")&&0===l.indexOf(N)&&b.exists(l,M)){N=!0;break a}}else for(var R=0;R<l.length;R++){var P=l[R];if(P===N||-1<P.indexOf(".")&&0===P.indexOf(N)&&b.exists(P,M)){N=!0;break a}}N=!1}N&&(x[G]=!0)}}q.setDefaultOrigin(c.origin);
h=0;for(r=Object.getOwnPropertyNames(r);h<r.length;h++)v=r[h],y=(x=g.originSpecificReadPropertyDefinition(k[v],c).read)&&x.source,n=void 0,n=y&&"string"==typeof y?b.valueOf(e,y):e[v],x&&x.reader&&(n=x.reader.call(a,n,e,c)),void 0!==n&&q.set(v,n);q.setDefaultOrigin("user")}Object.defineProperty(l,"__esModule",{value:!0});var f={origin:"service"};l.read=k;l.readLoadable=function(a,b,c,d){void 0===d&&(d=f);b=h.mixin({},d,{messages:[]});c(b);b.messages.forEach(function(c){"warning"!==c.type||a.loaded?
d&&d.messages.push(c):a.loadWarnings.push(c)})};l["default"]=k})},"esri/core/accessorSupport/write":function(){define("require exports ../Error ../Logger ./PropertyOrigin ./utils ./extensions/serializableProperty".split(" "),function(m,l,h,d,b,g,k){function f(a,f,d,g,k,v){if(!g||!g.write)return!1;var c=a.get(d);if(void 0===c)return!1;if(!k&&g.write.overridePolicy){var q=g.write.overridePolicy.call(a,c,d,v);void 0!==q&&(k=q)}if(k||(k=g.write),!k||!1===k.enabled)return!1;if(null===c){if(k.allowNull)return!0;
k.isRequired&&((a=new h("web-document-write:property-required","Missing value for required property '"+d+"' on '"+a.declaredClass+"'",{propertyName:d,target:a}),v)&&v.messages?v.messages.push(a):a&&!v&&e.error(a.name,a.message));return!1}return!k.ignoreOrigin&&v&&v.origin&&f.store.originOf(d)<b.nameToId(v.origin)?!1:!0}function a(a,e,d){if(a&&"function"==typeof a.toJSON&&(!a.toJSON.isDefaultToJSON||!a.write))return g.merge(e,a.toJSON());var c=g.getProperties(a),q=c.metadatas,t;for(t in q){var h=k.originSpecificWritePropertyDefinition(q[t],
d);if(f(a,c,t,h,null,d)){var y=a.get(t),n={},h=(h.write.writer.call(a,y,n,"string"==typeof h.write.target?h.write.target:t,d),n);0<Object.keys(h).length&&(e=g.merge(e,h),d&&d.writtenProperties&&d.writtenProperties.push({target:a,propName:t,oldOrigin:b.idToReadableName(c.store.originOf(t)),newOrigin:d.origin}))}}return e}Object.defineProperty(l,"__esModule",{value:!0});var e=d.getLogger("esri.core.accessorSupport.write");l.willPropertyWrite=function(a,b,e,d){var c=g.getProperties(a),q=k.originSpecificWritePropertyDefinition(c.metadatas[b],
d);return q?f(a,c,b,q,e,d):!1};l.write=a;l["default"]=a})},"esri/geometry/SpatialReference":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/JSONSupport ./support/spatialReferenceUtils".split(" "),function(m,l,h,d,b,g,k){m=function(e){function c(a){a=e.call(this)||this;return a.latestWkid=null,a.wkid=null,a.wkt=null,a}return h(c,e),g=c,c.fromJSON=function(a){if(!a)return null;if(a.wkid){if(102100===
a.wkid)return g.WebMercator;if(4326===a.wkid)return g.WGS84}var c=new g;return c.read(a),c},c.prototype.normalizeCtorArgs=function(a){return a&&"object"==typeof a?a:(c={},c["string"==typeof a?"wkt":"wkid"]=a,c);var c},Object.defineProperty(c.prototype,"isWGS84",{get:function(){return 4326===this.wkid},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isWebMercator",{get:function(){return-1!==f.indexOf(this.wkid)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isGeographic",
{get:function(){return k.isGeographic(this)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isWrappable",{get:function(){return-1!==a.indexOf(this.wkid)},enumerable:!0,configurable:!0}),c.prototype.writeWkt=function(a,c){this.wkid||(c.wkt=a)},c.prototype.clone=function(){if(this===g.WGS84)return g.WGS84;if(this===g.WebMercator)return g.WebMercator;var a=new g;return null!=this.wkid?(a.wkid=this.wkid,null!=this.latestWkid&&(a.latestWkid=this.latestWkid),null!=this.vcsWkid&&(a.vcsWkid=
this.vcsWkid),null!=this.latestVcsWkid&&(a.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(a.wkt=this.wkt),a},c.prototype.equals=function(a){if(a){if(this===a)return!0;if(null!=this.wkid||null!=a.wkid)return this.wkid===a.wkid||this.isWebMercator&&a.isWebMercator||null!=a.latestWkid&&this.wkid===a.latestWkid||null!=this.latestWkid&&a.wkid===this.latestWkid;if(this.wkt&&a.wkt)return this.wkt.toUpperCase()===a.wkt.toUpperCase()}return!1},c.prototype.toJSON=function(a){return this.write(null,a)},
c.GCS_NAD_1927=null,c.WGS84=null,c.WebMercator=null,d([b.property({dependsOn:["wkid"],readOnly:!0})],c.prototype,"isWGS84",null),d([b.property({dependsOn:["wkid"],readOnly:!0})],c.prototype,"isWebMercator",null),d([b.property({dependsOn:["wkid","wkt"],readOnly:!0})],c.prototype,"isGeographic",null),d([b.property({dependsOn:["wkid"],readOnly:!0})],c.prototype,"isWrappable",null),d([b.property({type:Number,json:{write:!0}})],c.prototype,"latestWkid",void 0),d([b.property({type:Number,json:{write:!0,
origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkt?!0:!1}}}}}}})],c.prototype,"wkid",void 0),d([b.property({type:String,json:{origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkid?!0:!1}}}}}}})],c.prototype,"wkt",void 0),d([b.writer("wkt")],c.prototype,"writeWkt",null),d([b.property({type:Number,json:{write:!0}})],c.prototype,"vcsWkid",void 0),d([b.property({type:Number,json:{write:!0}})],c.prototype,"latestVcsWkid",void 0),
c=g=d([b.subclass("esri.SpatialReference")],c);var g}(b.declared(g));m.prototype.toJSON.isDefaultToJSON=!0;m.GCS_NAD_1927=new m({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'});m.WGS84=new m(4326);m.WebMercator=new m({wkid:102100,latestWkid:3857});Object.freeze&&(Object.freeze(m.GCS_NAD_1927),Object.freeze(m.WGS84),Object.freeze(m.WebMercator));var f=[102113,102100,
3857,3785],a=[102113,102100,3857,3785,4326];return m})},"esri/geometry/support/spatialReferenceUtils":function(){define(["require","exports","./WKIDUnitConversion"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.isGeographic=function(b){return b.wkid?null==h[b.wkid]:b.wkt?!!/^\s*GEOGCS/i.test(b.wkt):!1};l.getInfo=function(b){return b.wkid?d[b.wkid]:null};m=[-2.0037508342788905E7,2.0037508342788905E7];l=[-2.0037508342787E7,2.0037508342787E7];var d={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:m,origin:l,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:m,origin:l,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:m,origin:l,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:m,origin:l,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}}})},"esri/geometry/support/WKIDUnitConversion":function(){define([],function(){var m,l={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],units:"Meter Foot Foot_US Foot_Clarke Yard_Clarke Link_Clarke Yard_Sears Foot_Sears Chain_Sears Chain_Benoit_1895_B Yard_Indian Yard_Indian_1937 Foot_Gold_Coast Chain_Sears_1922_Truncated 50_Kilometers 150_Kilometers".split(" "),
2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,
3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,
3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,
3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,
5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,
6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,
6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,
6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,
6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,
7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,
7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8058:0,8059:0,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,
8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,
26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,53048:0,53049:0,
54034:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,
103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,
103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,
103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,
103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(m=2E3;2045>=m;m++)l[m]=0;for(m=2056;2065>=m;m++)l[m]=0;for(m=2067;2135>=m;m++)l[m]=0;for(m=2137;2154>=m;m++)l[m]=0;for(m=2161;2170>=m;m++)l[m]=0;for(m=2172;2193>=m;m++)l[m]=0;for(m=2195;2198>=m;m++)l[m]=0;for(m=2200;2203>=m;m++)l[m]=0;for(m=2205;2217>=m;m++)l[m]=0;for(m=2222;2224>=m;m++)l[m]=1;for(m=2225;2250>=m;m++)l[m]=2;
for(m=2251;2253>=m;m++)l[m]=1;for(m=2257;2264>=m;m++)l[m]=2;for(m=2274;2279>=m;m++)l[m]=2;for(m=2280;2282>=m;m++)l[m]=1;for(m=2283;2289>=m;m++)l[m]=2;for(m=2290;2292>=m;m++)l[m]=0;for(m=2308;2313>=m;m++)l[m]=0;for(m=2315;2491>=m;m++)l[m]=0;for(m=2494;2866>=m;m++)l[m]=0;for(m=2867;2869>=m;m++)l[m]=1;for(m=2870;2888>=m;m++)l[m]=2;for(m=2891;2895>=m;m++)l[m]=2;for(m=2896;2898>=m;m++)l[m]=1;for(m=2902;2908>=m;m++)l[m]=2;for(m=2915;2920>=m;m++)l[m]=2;for(m=2921;2923>=m;m++)l[m]=1;for(m=2924;2930>=m;m++)l[m]=
2;for(m=2931;2962>=m;m++)l[m]=0;for(m=2964;2968>=m;m++)l[m]=2;for(m=2969;2973>=m;m++)l[m]=0;for(m=2975;2991>=m;m++)l[m]=0;for(m=2995;3051>=m;m++)l[m]=0;for(m=3054;3079>=m;m++)l[m]=0;for(m=3081;3088>=m;m++)l[m]=0;for(m=3092;3101>=m;m++)l[m]=0;for(m=3106;3138>=m;m++)l[m]=0;for(m=3146;3151>=m;m++)l[m]=0;for(m=3153;3166>=m;m++)l[m]=0;for(m=3168;3172>=m;m++)l[m]=0;for(m=3174;3203>=m;m++)l[m]=0;for(m=3294;3358>=m;m++)l[m]=0;for(m=3367;3403>=m;m++)l[m]=0;for(m=3408;3416>=m;m++)l[m]=0;for(m=3417;3438>=m;m++)l[m]=
2;for(m=3441;3446>=m;m++)l[m]=2;for(m=3447;3450>=m;m++)l[m]=0;for(m=3451;3459>=m;m++)l[m]=2;for(m=3460;3478>=m;m++)l[m]=0;for(m=3554;3559>=m;m++)l[m]=0;for(m=3560;3570>=m;m++)l[m]=2;for(m=3571;3581>=m;m++)l[m]=0;for(m=3594;3597>=m;m++)l[m]=0;for(m=3601;3604>=m;m++)l[m]=0;for(m=3637;3639>=m;m++)l[m]=0;for(m=3665;3667>=m;m++)l[m]=0;for(m=3693;3695>=m;m++)l[m]=0;for(m=3701;3727>=m;m++)l[m]=0;for(m=3728;3739>=m;m++)l[m]=2;for(m=3740;3751>=m;m++)l[m]=0;for(m=3753;3760>=m;m++)l[m]=2;for(m=3761;3773>=m;m++)l[m]=
0;for(m=3775;3777>=m;m++)l[m]=0;for(m=3779;3781>=m;m++)l[m]=0;for(m=3783;3785>=m;m++)l[m]=0;for(m=3788;3791>=m;m++)l[m]=0;for(m=3797;3802>=m;m++)l[m]=0;for(m=3814;3816>=m;m++)l[m]=0;for(m=3825;3829>=m;m++)l[m]=0;for(m=3832;3841>=m;m++)l[m]=0;for(m=3844;3852>=m;m++)l[m]=0;for(m=3873;3885>=m;m++)l[m]=0;for(m=3890;3893>=m;m++)l[m]=0;for(m=3907;3912>=m;m++)l[m]=0;for(m=3942;3950>=m;m++)l[m]=0;for(m=3968;3970>=m;m++)l[m]=0;for(m=3973;3976>=m;m++)l[m]=0;for(m=3986;3989>=m;m++)l[m]=0;for(m=3994;3997>=m;m++)l[m]=
0;for(m=4048;4051>=m;m++)l[m]=0;for(m=4056;4063>=m;m++)l[m]=0;for(m=4093;4096>=m;m++)l[m]=0;for(m=4390;4398>=m;m++)l[m]=0;for(m=4399;4413>=m;m++)l[m]=2;for(m=4418;4433>=m;m++)l[m]=2;for(m=4455;4457>=m;m++)l[m]=2;for(m=4484;4489>=m;m++)l[m]=0;for(m=4491;4554>=m;m++)l[m]=0;for(m=4568;4589>=m;m++)l[m]=0;for(m=4652;4656>=m;m++)l[m]=0;for(m=4766;4800>=m;m++)l[m]=0;for(m=5014;5016>=m;m++)l[m]=0;for(m=5069;5072>=m;m++)l[m]=0;for(m=5105;5130>=m;m++)l[m]=0;for(m=5173;5188>=m;m++)l[m]=0;for(m=5253;5259>=m;m++)l[m]=
0;for(m=5269;5275>=m;m++)l[m]=0;for(m=5292;5311>=m;m++)l[m]=0;for(m=5329;5331>=m;m++)l[m]=0;for(m=5343;5349>=m;m++)l[m]=0;for(m=5355;5357>=m;m++)l[m]=0;for(m=5387;5389>=m;m++)l[m]=0;for(m=5459;5463>=m;m++)l[m]=0;for(m=5479;5482>=m;m++)l[m]=0;for(m=5518;5520>=m;m++)l[m]=0;for(m=5530;5539>=m;m++)l[m]=0;for(m=5550;5552>=m;m++)l[m]=0;for(m=5562;5583>=m;m++)l[m]=0;for(m=5623;5625>=m;m++)l[m]=2;for(m=5631;5639>=m;m++)l[m]=0;for(m=5649;5653>=m;m++)l[m]=0;for(m=5663;5680>=m;m++)l[m]=0;for(m=5682;5685>=m;m++)l[m]=
0;for(m=5875;5877>=m;m++)l[m]=0;for(m=5921;5940>=m;m++)l[m]=0;for(m=6050;6125>=m;m++)l[m]=0;for(m=6244;6275>=m;m++)l[m]=0;for(m=6328;6348>=m;m++)l[m]=0;for(m=6350;6356>=m;m++)l[m]=0;for(m=6366;6372>=m;m++)l[m]=0;for(m=6381;6387>=m;m++)l[m]=0;for(m=6393;6404>=m;m++)l[m]=0;for(m=6480;6483>=m;m++)l[m]=0;for(m=6511;6514>=m;m++)l[m]=0;for(m=6579;6581>=m;m++)l[m]=0;for(m=6619;6624>=m;m++)l[m]=0;for(m=6625;6627>=m;m++)l[m]=2;for(m=6628;6632>=m;m++)l[m]=0;for(m=6634;6637>=m;m++)l[m]=0;for(m=6669;6692>=m;m++)l[m]=
0;for(m=6707;6709>=m;m++)l[m]=0;for(m=6720;6723>=m;m++)l[m]=0;for(m=6732;6738>=m;m++)l[m]=0;for(m=6931;6933>=m;m++)l[m]=0;for(m=6956;6959>=m;m++)l[m]=0;for(m=7005;7007>=m;m++)l[m]=0;for(m=7057;7070>=m;m++)l[m]=2;for(m=7074;7082>=m;m++)l[m]=0;for(m=7109;7118>=m;m++)l[m]=0;for(m=7119;7127>=m;m++)l[m]=1;for(m=7374;7376>=m;m++)l[m]=0;for(m=7528;7586>=m;m++)l[m]=0;for(m=7587;7645>=m;m++)l[m]=2;for(m=7755;7787>=m;m++)l[m]=0;for(m=7791;7795>=m;m++)l[m]=0;for(m=7799;7801>=m;m++)l[m]=0;for(m=7803;7805>=m;m++)l[m]=
0;for(m=7825;7831>=m;m++)l[m]=0;for(m=7845;7859>=m;m++)l[m]=0;for(m=8013;8032>=m;m++)l[m]=0;for(m=20002;20032>=m;m++)l[m]=0;for(m=20062;20092>=m;m++)l[m]=0;for(m=20135;20138>=m;m++)l[m]=0;for(m=20248;20258>=m;m++)l[m]=0;for(m=20348;20358>=m;m++)l[m]=0;for(m=20436;20440>=m;m++)l[m]=0;for(m=20822;20824>=m;m++)l[m]=0;for(m=20934;20936>=m;m++)l[m]=0;for(m=21035;21037>=m;m++)l[m]=0;for(m=21095;21097>=m;m++)l[m]=0;for(m=21148;21150>=m;m++)l[m]=0;for(m=21413;21423>=m;m++)l[m]=0;for(m=21473;21483>=m;m++)l[m]=
0;for(m=21780;21782>=m;m++)l[m]=0;for(m=21891;21894>=m;m++)l[m]=0;for(m=21896;21899>=m;m++)l[m]=0;for(m=22171;22177>=m;m++)l[m]=0;for(m=22181;22187>=m;m++)l[m]=0;for(m=22191;22197>=m;m++)l[m]=0;for(m=22234;22236>=m;m++)l[m]=0;for(m=22521;22525>=m;m++)l[m]=0;for(m=22991;22994>=m;m++)l[m]=0;for(m=23028;23038>=m;m++)l[m]=0;for(m=23830;23853>=m;m++)l[m]=0;for(m=23866;23872>=m;m++)l[m]=0;for(m=23877;23884>=m;m++)l[m]=0;for(m=23886;23894>=m;m++)l[m]=0;for(m=23946;23948>=m;m++)l[m]=0;for(m=24311;24313>=
m;m++)l[m]=0;for(m=24342;24347>=m;m++)l[m]=0;for(m=24370;24374>=m;m++)l[m]=10;for(m=24375;24381>=m;m++)l[m]=0;for(m=24718;24721>=m;m++)l[m]=0;for(m=24817;24821>=m;m++)l[m]=0;for(m=24877;24882>=m;m++)l[m]=0;for(m=24891;24893>=m;m++)l[m]=0;for(m=25391;25395>=m;m++)l[m]=0;for(m=25828;25838>=m;m++)l[m]=0;for(m=26191;26195>=m;m++)l[m]=0;for(m=26391;26393>=m;m++)l[m]=0;for(m=26701;26722>=m;m++)l[m]=0;for(m=26729;26799>=m;m++)l[m]=2;for(m=26801;26803>=m;m++)l[m]=2;for(m=26811;26813>=m;m++)l[m]=2;for(m=26847;26870>=
m;m++)l[m]=2;for(m=26891;26899>=m;m++)l[m]=0;for(m=26901;26923>=m;m++)l[m]=0;for(m=26929;26946>=m;m++)l[m]=0;for(m=26948;26998>=m;m++)l[m]=0;for(m=27037;27040>=m;m++)l[m]=0;for(m=27205;27232>=m;m++)l[m]=0;for(m=27258;27260>=m;m++)l[m]=0;for(m=27391;27398>=m;m++)l[m]=0;for(m=27561;27564>=m;m++)l[m]=0;for(m=27571;27574>=m;m++)l[m]=0;for(m=27581;27584>=m;m++)l[m]=0;for(m=27591;27594>=m;m++)l[m]=0;for(m=28191;28193>=m;m++)l[m]=0;for(m=28348;28358>=m;m++)l[m]=0;for(m=28402;28432>=m;m++)l[m]=0;for(m=28462;28492>=
m;m++)l[m]=0;for(m=29118;29122>=m;m++)l[m]=0;for(m=29168;29172>=m;m++)l[m]=0;for(m=29177;29185>=m;m++)l[m]=0;for(m=29187;29195>=m;m++)l[m]=0;for(m=29900;29903>=m;m++)l[m]=0;for(m=30161;30179>=m;m++)l[m]=0;for(m=30491;30494>=m;m++)l[m]=0;for(m=30729;30732>=m;m++)l[m]=0;for(m=31251;31259>=m;m++)l[m]=0;for(m=31265;31268>=m;m++)l[m]=0;for(m=31275;31279>=m;m++)l[m]=0;for(m=31281;31297>=m;m++)l[m]=0;for(m=31461;31469>=m;m++)l[m]=0;for(m=31491;31495>=m;m++)l[m]=0;for(m=31917;31922>=m;m++)l[m]=0;for(m=31965;32E3>=
m;m++)l[m]=0;for(m=32001;32003>=m;m++)l[m]=2;for(m=32005;32031>=m;m++)l[m]=2;for(m=32033;32060>=m;m++)l[m]=2;for(m=32064;32067>=m;m++)l[m]=2;for(m=32074;32077>=m;m++)l[m]=2;for(m=32081;32086>=m;m++)l[m]=0;for(m=32107;32130>=m;m++)l[m]=0;for(m=32133;32158>=m;m++)l[m]=0;for(m=32164;32167>=m;m++)l[m]=2;for(m=32180;32199>=m;m++)l[m]=0;for(m=32201;32260>=m;m++)l[m]=0;for(m=32301;32360>=m;m++)l[m]=0;for(m=32601;32662>=m;m++)l[m]=0;for(m=32664;32667>=m;m++)l[m]=2;for(m=32701;32761>=m;m++)l[m]=0;for(m=53001;53004>=
m;m++)l[m]=0;for(m=53008;53019>=m;m++)l[m]=0;for(m=53021;53032>=m;m++)l[m]=0;for(m=53042;53046>=m;m++)l[m]=0;for(m=53074;53080>=m;m++)l[m]=0;for(m=54001;54004>=m;m++)l[m]=0;for(m=54008;54019>=m;m++)l[m]=0;for(m=54021;54032>=m;m++)l[m]=0;for(m=54042;54046>=m;m++)l[m]=0;for(m=54048;54053>=m;m++)l[m]=0;for(m=54074;54080>=m;m++)l[m]=0;for(m=102001;102040>=m;m++)l[m]=0;for(m=102042;102063>=m;m++)l[m]=0;for(m=102065;102067>=m;m++)l[m]=0;for(m=102070;102117>=m;m++)l[m]=0;for(m=102122;102216>=m;m++)l[m]=
0;for(m=102221;102377>=m;m++)l[m]=0;for(m=102382;102388>=m;m++)l[m]=0;for(m=102389;102398>=m;m++)l[m]=2;for(m=102399;102444>=m;m++)l[m]=0;for(m=102445;102447>=m;m++)l[m]=2;for(m=102448;102458>=m;m++)l[m]=0;for(m=102459;102468>=m;m++)l[m]=2;for(m=102469;102496>=m;m++)l[m]=0;for(m=102500;102519>=m;m++)l[m]=1;for(m=102520;102524>=m;m++)l[m]=0;for(m=102525;102529>=m;m++)l[m]=2;for(m=102530;102568>=m;m++)l[m]=0;for(m=102570;102588>=m;m++)l[m]=0;for(m=102590;102598>=m;m++)l[m]=0;for(m=102601;102603>=m;m++)l[m]=
0;for(m=102605;102628>=m;m++)l[m]=0;for(m=102629;102646>=m;m++)l[m]=2;for(m=102648;102700>=m;m++)l[m]=2;for(m=102701;102703>=m;m++)l[m]=0;for(m=102707;102730>=m;m++)l[m]=2;for(m=102733;102758>=m;m++)l[m]=2;for(m=102767;102900>=m;m++)l[m]=0;for(m=102965;102969>=m;m++)l[m]=0;for(m=102971;102973>=m;m++)l[m]=0;for(m=102975;102989>=m;m++)l[m]=0;for(m=102990;102992>=m;m++)l[m]=1;for(m=102997;103002>=m;m++)l[m]=0;for(m=103003;103008>=m;m++)l[m]=2;for(m=103009;103011>=m;m++)l[m]=0;for(m=103012;103014>=m;m++)l[m]=
2;for(m=103019;103021>=m;m++)l[m]=0;for(m=103022;103024>=m;m++)l[m]=2;for(m=103029;103031>=m;m++)l[m]=0;for(m=103032;103034>=m;m++)l[m]=2;for(m=103065;103068>=m;m++)l[m]=0;for(m=103074;103076>=m;m++)l[m]=0;for(m=103077;103079>=m;m++)l[m]=1;for(m=103080;103082>=m;m++)l[m]=0;for(m=103083;103085>=m;m++)l[m]=2;for(m=103090;103093>=m;m++)l[m]=0;for(m=103097;103099>=m;m++)l[m]=0;for(m=103100;103102>=m;m++)l[m]=2;for(m=103107;103109>=m;m++)l[m]=0;for(m=103110;103112>=m;m++)l[m]=2;for(m=103113;103116>=m;m++)l[m]=
0;for(m=103117;103120>=m;m++)l[m]=2;for(m=103153;103157>=m;m++)l[m]=0;for(m=103158;103162>=m;m++)l[m]=2;for(m=103163;103165>=m;m++)l[m]=0;for(m=103166;103168>=m;m++)l[m]=1;for(m=103169;103171>=m;m++)l[m]=2;for(m=103186;103188>=m;m++)l[m]=0;for(m=103189;103191>=m;m++)l[m]=2;for(m=103192;103195>=m;m++)l[m]=0;for(m=103196;103199>=m;m++)l[m]=2;for(m=103200;103224>=m;m++)l[m]=0;for(m=103225;103227>=m;m++)l[m]=1;for(m=103232;103237>=m;m++)l[m]=0;for(m=103238;103243>=m;m++)l[m]=2;for(m=103244;103246>=m;m++)l[m]=
0;for(m=103247;103249>=m;m++)l[m]=2;for(m=103254;103256>=m;m++)l[m]=0;for(m=103257;103259>=m;m++)l[m]=2;for(m=103264;103266>=m;m++)l[m]=0;for(m=103267;103269>=m;m++)l[m]=2;for(m=103300;103375>=m;m++)l[m]=0;for(m=103381;103383>=m;m++)l[m]=0;for(m=103384;103386>=m;m++)l[m]=1;for(m=103387;103389>=m;m++)l[m]=0;for(m=103390;103392>=m;m++)l[m]=2;for(m=103397;103399>=m;m++)l[m]=0;for(m=103400;103471>=m;m++)l[m]=2;for(m=103476;103478>=m;m++)l[m]=0;for(m=103479;103481>=m;m++)l[m]=2;for(m=103486;103488>=m;m++)l[m]=
0;for(m=103489;103491>=m;m++)l[m]=2;for(m=103492;103495>=m;m++)l[m]=0;for(m=103496;103499>=m;m++)l[m]=2;for(m=103528;103543>=m;m++)l[m]=0;for(m=103544;103548>=m;m++)l[m]=2;for(m=103549;103551>=m;m++)l[m]=0;for(m=103552;103554>=m;m++)l[m]=1;for(m=103555;103557>=m;m++)l[m]=2;for(m=103558;103560>=m;m++)l[m]=0;for(m=103571;103573>=m;m++)l[m]=0;for(m=103574;103576>=m;m++)l[m]=2;for(m=103577;103580>=m;m++)l[m]=0;for(m=103581;103583>=m;m++)l[m]=2;for(m=103600;103694>=m;m++)l[m]=0;for(m=103700;103793>=m;m++)l[m]=
2;for(m=103794;103871>=m;m++)l[m]=0;for(m=103900;103971>=m;m++)l[m]=2;return l})},"esri/geometry/Point":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Geometry ./SpatialReference ./support/spatialReferenceUtils ./support/webMercatorUtils".split(" "),function(m,l,h,d,b,g,k,f,a){function e(a){return a&&("esri.SpatialReference"===a.declaredClass||null!=a.wkid)}var c=[0,0];m=function(g){function q(a,c,b,e,
n){a=g.call(this)||this;return a.x=0,a.y=0,a.z=void 0,a.m=void 0,a.type="point",a}return h(q,g),r=q,q.copy=function(a,c){c.x=a.x;c.y=a.y;c.z=a.z;c.m=a.m;c.spatialReference=Object.isFrozen(a.spatialReference)?a.spatialReference:a.spatialReference.clone()},q.distance=function(a,c){var b=a.x-c.x,e=a.y-c.y;a=a.hasZ&&c.hasZ?a.z-c.z:0;return Math.sqrt(b*b+e*e+a*a)},q.prototype.normalizeCtorArgs=function(b,f,d,g,n){var w;if(Array.isArray(b))w=b,n=f,b=w[0],f=w[1],d=w[2],g=w[3];else if(b&&"object"==typeof b){if(w=
b,b=null!=w.x?w.x:w.longitude,f=null!=w.y?w.y:w.latitude,d=null!=w.z?w.z:w.altitude,g=w.m,n=w.spatialReference,n&&"esri.SpatialReference"!==n.declaredClass&&(n=new k(n)),!w.declaredClass&&n&&n.isWebMercator&&null!=w.longitude&&null!=w.latitude)f=a.lngLatToXY(w.longitude,w.latitude,c),b=f[0],f=f[1]}else e(d)?(n=d,d=null):e(g)&&(n=g,g=null);b={x:b,y:f};return null!=n&&(b.spatialReference=n),null!=d&&(b.z=d),null!=g&&(b.m=g),b},Object.defineProperty(q.prototype,"hasM",{get:function(){return void 0!==
this.m},set:function(a){var c=this._get("hasM");a!==c&&(this._set("m",a?0:void 0),this._set("hasM",a))},enumerable:!0,configurable:!0}),Object.defineProperty(q.prototype,"hasZ",{get:function(){return void 0!==this.z},set:function(a){var c=this._get("hasZ");a!==c&&(this._set("z",a?0:void 0),this._set("hasZ",a))},enumerable:!0,configurable:!0}),Object.defineProperty(q.prototype,"latitude",{get:function(){var b=this._get("spatialReference");if(b){if(b.isWebMercator)return a.xyToLngLat(this.x,this.y,
c)[1];if(b.isWGS84)return this._get("y")}return null},set:function(b){var e=this._get("spatialReference");e&&(e.isWebMercator?this._set("y",a.lngLatToXY(this.x,b,c)[1]):e.isWGS84&&this._set("y",b),this._set("latitude",b))},enumerable:!0,configurable:!0}),Object.defineProperty(q.prototype,"longitude",{get:function(){var b=this._get("spatialReference");if(b){if(b.isWebMercator)return a.xyToLngLat(this._get("x"),this._get("y"),c)[0];if(b.isWGS84)return this._get("x")}return null},set:function(b){var e=
this._get("spatialReference");e&&(e.isWebMercator?this._set("x",a.lngLatToXY(b,this._get("y"),c)[0]):e.isWGS84&&this._set("x",b),this._set("longitude",b))},enumerable:!0,configurable:!0}),q.prototype.clone=function(){var a=new r;return a.x=this.x,a.y=this.y,a.z=this.z,a.m=this.m,a.spatialReference=this.spatialReference,a},q.prototype.copy=function(a){return r.copy(a,this),this},q.prototype.equals=function(c){if(!c)return!1;var b=this.x,e=this.y,f=this.z,n=this.m,d=this.spatialReference,g=c.z,q=c.m,
k=c.x,r=c.y;c=c.spatialReference;if(!d.equals(c)){if(d.isWebMercator&&c.isWGS84)r=a.lngLatToXY(k,r);else{if(!d.isWGS84||!c.isWebMercator)return!1;r=a.xyToLngLat(k,r)}k=r[0];r=r[1];c=d}return b===k&&e===r&&f===g&&n===q&&d.wkid===c.wkid},q.prototype.offset=function(a,c,b){return this.x+=a,this.y+=c,null!=b&&this.hasZ&&(this.z+=b),this},q.prototype.normalize=function(){if(!this.spatialReference)return this;var a=f.getInfo(this.spatialReference);if(!a)return this;var c,b=this.x,e=a.valid,a=e[0],e=e[1],
n=2*e;return b>e?(c=Math.ceil(Math.abs(b-e)/n),b-=c*n):a>b&&(c=Math.ceil(Math.abs(b-a)/n),b+=c*n),this._set("x",b),this},q.prototype.distance=function(a){return r.distance(this,a)},q.prototype.toArray=function(){var a=this.hasZ,c=this.hasM;return a&&c?[this.x,this.y,this.z,this.m]:a?[this.x,this.y,this.z]:c?[this.x,this.y,this.m]:[this.x,this.y]},q.prototype.toJSON=function(a){return this.write(null,a)},d([b.property({dependsOn:["x","y","z","m","spatialReference"]})],q.prototype,"cache",void 0),d([b.property({type:Boolean,
dependsOn:["m"],json:{write:{enabled:!1,overridePolicy:null}}})],q.prototype,"hasM",null),d([b.property({type:Boolean,dependsOn:["z"],json:{write:{enabled:!1,overridePolicy:null}}})],q.prototype,"hasZ",null),d([b.property({type:Number,dependsOn:["y"]})],q.prototype,"latitude",null),d([b.property({type:Number,dependsOn:["x"]})],q.prototype,"longitude",null),d([b.property({type:Number,json:{write:{isRequired:!0}}})],q.prototype,"x",void 0),d([b.property({type:Number,json:{write:!0}})],q.prototype,"y",
void 0),d([b.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],q.prototype,"z",void 0),d([b.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],q.prototype,"m",void 0),q=r=d([b.subclass("esri.geometry.Point")],q);var r}(b.declared(g));return m.prototype.toJSON.isDefaultToJSON=!0,m})},"esri/geometry/support/webMercatorUtils":function(){define(["require","exports","../SpatialReference"],function(m,l,h){function d(a,
c,b,e,f){if("point"===a.type)c=c(a.x,a.y,q,0,e),f.x=c[0],f.y=c[1];else if("extent"===a.type)t=c(a.xmin,a.ymin,q,0,e),f.xmin=t[0],f.ymin=t[1],c=c(a.xmax,a.ymax,q,0,e),f.xmax=c[0],f.ymax=c[1];else if("polyline"===a.type||"polygon"===a.type){var d=(t="polyline"===a.type)?a.paths:a.rings,n=[],g=void 0;for(a=0;a<d.length;a++){var k=d[a],g=[];n.push(g);for(var r=0;r<k.length;r++)g.push(c(k[r][0],k[r][1],[0,0],0,e)),2<k[r].length&&g[r].push(k[r][2]),3<k[r].length&&g[r].push(k[r][3])}t?f.paths=n:f.rings=
n}else if("multipoint"===a.type){t=a.points;d=[];for(a=0;a<t.length;a++)d[a]=c(t[a][0],t[a][1],[0,0],0,e),2<t[a].length&&d[a].push(t[a][2]),3<t[a].length&&d[a].push(t[a][3]);f.points=d}return f.spatialReference=b,f;var t}function b(a,c){a=a&&(null!=a.wkid||null!=a.wkt?a:a.spatialReference);c=c&&(null!=c.wkid||null!=c.wkt?c:c.spatialReference);return a&&c?c.equals(a)?!0:c.isWebMercator&&a.isWGS84||a.isWebMercator&&c.isWGS84:!1}function g(a,b,e,d){void 0===e&&(e=[0,0]);void 0===d&&(d=0);89.99999<b?
b=89.99999:-89.99999>b&&(b=-89.99999);b*=c;return e[d]=a*c*f,e[d+1]=.5*f*Math.log((1+Math.sin(b))/(1-Math.sin(b))),e}function k(c,b,d,g,q){void 0===d&&(d=[0,0]);void 0===g&&(g=0);void 0===q&&(q=!1);c=c/f*e;return d[g]=q?c:c-360*Math.floor((c+180)/360),d[g+1]=(a/2-2*Math.atan(Math.exp(-1*b/f)))*e,d}Object.defineProperty(l,"__esModule",{value:!0});var f=6378137,a=3.141592653589793,e=57.29577951308232,c=.017453292519943,q=[0,0];l.canProject=b;l.project=function(a,c){var e=a&&a.spatialReference;c=c&&
(null!=c.wkid||null!=c.wkt?c:c.spatialReference);return b(e,c)?e.equals(c)?a.clone():c.isWebMercator?d(a,g,h.WebMercator,!1,a.clone()):c.isWGS84?d(a,k,h.WGS84,!1,a.clone()):null:null};l.lngLatToXY=g;l.xyToLngLat=k;l.geographicToWebMercator=function(a,c,b){return void 0===c&&(c=!1),void 0===b&&(b=a.clone()),d(a,g,h.WebMercator,c,b)};l.webMercatorToGeographic=function(a,c,b){return void 0===c&&(c=!1),void 0===b&&(b=a.clone()),d(a,k,h.WGS84,c,b)}})},"esri/geometry/support/coordsUtils":function(){define(["require",
"exports"],function(m,l){function h(a,c){var b=c[0]-a[0],e=c[1]-a[1];return 2<a.length&&2<c.length?(a=a[2]-c[2],Math.sqrt(b*b+e*e+a*a)):Math.sqrt(b*b+e*e)}function d(a,c,b){var e=a[0]+b*(c[0]-a[0]),f=a[1]+b*(c[1]-a[1]);return 2<a.length&&2<c.length?[e,f,a[2]+b*(c[2]-a[2])]:[e,f]}function b(a,c){return d(a,c,.5)}function g(a,c,b){var e=b[0];b=b[1];for(var f=0,d=0,g=c.length;g>d;d++){f++;f===g&&(f=0);var q=c[d],k=q[0],q=q[1],n=c[f],w=n[0],n=n[1];(b>q&&n>=b||b>n&&q>=b)&&e>k+(b-q)/(n-q)*(w-k)&&(a=!a)}return a}
function k(a,c,b,f){for(var e=0,d=0,g=0,q=0,k=0,n=0,w=c.length-1;w>n;n++){var h=c[n],t=h[0],l=h[1],m=h[2],G=c[n+1],N=G[0],M=G[1],R=G[2],P=t*M-N*l,q=q+P,e=e+(t+N)*P,d=d+(l+M)*P;b&&2<h.length&&2<G.length&&(P=t*R-N*m,g+=(m+R)*P,k+=P);t<f[0]&&(f[0]=t);t>f[1]&&(f[1]=t);l<f[2]&&(f[2]=l);l>f[3]&&(f[3]=l);b&&(m<f[4]&&(f[4]=m),m>f[5]&&(f[5]=m))}return 0<q&&(q*=-1),0<k&&(k*=-1),q?(a[0]=e,a[1]=d,a[2]=.5*q,b?(a[3]=g,a[4]=.5*k):a.length=3):a.length=0,a}function f(a,c){for(var e=c?[0,0,0]:[0,0],f=c?[0,0,0]:[0,
0],d=0,g=0,k=0,x=0,y=0,n=a.length;n-1>y;y++){var w=a[y],z=a[y+1];w&&z&&(e[0]=w[0],e[1]=w[1],f[0]=z[0],f[1]=z[1],c&&2<w.length&&2<z.length&&(e[2]=w[2],f[2]=z[2]),length=h(e,f),length)&&(d+=length,w=b(w,z),g+=length*w[0],k+=length*w[1],c&&2<w.length&&(x+=length*w[2]))}return 0<d?c?[g/d,k/d,x/d]:[g/d,k/d]:a.length?a[0]:null}function a(a,c){var b=a[0],e=b[0],b=b[1],f=a[1];a=f[0];var f=f[1],d=c[0],g=d[0],k=d[1],h=c[1];c=h[0]-g;var g=e-g,d=a-e,h=h[1]-k,k=b-k,n=f-b,w=h*d-c*n;if(0===w)return null;c=(c*k-
h*g)/w;g=(d*k-n*g)/w;return 0<=c&&1>=c&&0<=g&&1>=g?[e+c*(a-e),b+c*(f-b)]:null}Object.defineProperty(l,"__esModule",{value:!0});l.geometryToCoordinates=function(a){if(!a)return null;if(Array.isArray(a))return a;var c=a.hasZ,b=a.hasM;if("point"===a.type)return b&&c?[a.x,a.y,a.z,a.m]:c?[a.x,a.y,a.z]:b?[a.x,a.y,a.m]:[a.x,a.y];if("polygon"===a.type)return a.rings.slice(0);if("polyline"===a.type)return a.paths.slice(0);if("multipoint"===a.type)return a.points.slice(0);if("extent"===a.type){a=a.clone().normalize();
if(!a)return null;var e=!1,f=!1;return a.forEach(function(a){a.hasZ&&(e=!0);a.hasM&&(f=!0)}),a.map(function(a){var c=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(e&&a.hasZ)for(var b=.5*(a.zmax-a.zmin),d=0;d<c.length;d++)c[d].push(b);if(f&&a.hasM)for(a=.5*(a.mmax-a.mmin),d=0;d<c.length;d++)c[d].push(a);return c})}return null};l.getLength=h;l.getMidpoint=b;l.contains=function(a,c){if(!a)return!1;if(!Array.isArray(a[0][0]))return g(!1,a,c);for(var b=!1,e=0,f=a.length;f>
e;e++)b=g(b,a[e],c);return b};l.getPathLength=function(a){for(var c=a.length,b=0,e=0;c-1>e;++e)b+=h(a[e],a[e+1]);return b};l.getPointOnPath=function(a,c){if(0>=c)return a[0];for(var b=a.length,e=0,f=0;b-1>f;++f){var g=h(a[f],a[f+1]);if(g>c-e)return d(a[f],a[f+1],(c-e)/g);e+=g}return a[b-1]};l.isClockwise=function(a,c,b){for(var e=a.length,f=0,d=0,g=0,k=0;e>k;k++){var q=a[k],n=a[(k+1)%e],w=2,f=f+(q[0]*n[1]-n[0]*q[1]);2<q.length&&2<n.length&&b&&(d+=q[0]*n[2]-n[0]*q[2],w=3);q.length>w&&n.length>w&&c&&
(g+=q[0]*n[w]-n[0]*q[w])}return 0>=f&&0>=d&&0>=g};l.isSelfIntersecting=function(b){for(var c=0;c<b.length;c++){for(var e=b[c],f=0;f<e.length-1;f++)for(var d=[[e[f][0],e[f][1]],[e[f+1][0],e[f+1][1]]],g=c+1;g<b.length;g++)for(var k=0;k<b[g].length-1;k++){var h=[[b[g][k][0],b[g][k][1]],[b[g][k+1][0],b[g][k+1][1]]],y=a(d,h);if(y&&!(y[0]===d[0][0]&&y[1]===d[0][1]||y[0]===h[0][0]&&y[1]===h[0][1]||y[0]===d[1][0]&&y[1]===d[1][1]||y[0]===h[1][0]&&y[1]===h[1][1]))return!0}k=e.length;if(!(4>=k))for(f=0;k-3>
f;f++){var n=k-1;0===f&&(n=k-2);d=[[e[f][0],e[f][1]],[e[f+1][0],e[f+1][1]]];for(g=f+2;n>g;g++)if(h=[[e[g][0],e[g][1]],[e[g+1][0],e[g+1][1]]],(y=a(d,h))&&!(y[0]===d[0][0]&&y[1]===d[0][1]||y[0]===h[0][0]&&y[1]===h[0][1]||y[0]===d[1][0]&&y[1]===d[1][1]||y[0]===h[1][0]&&y[1]===h[1][1]))return!0}}return!1};l.ringsCentroid=function(a,c,b){var e,d,g=[];a.length=0;for(var q=b?[1/0,-(1/0),1/0,-(1/0),1/0,-(1/0)]:[1/0,-(1/0),1/0,-(1/0)],h=0,y=c.length;y>h;h++)e=k([],c[h],b,q),e.length&&g.push(e);(g.sort(function(a,
c){var e=a[2]-c[2];return 0===e&&b&&(e=a[4]-c[4]),e}),g.length&&(d=6*g[0][2],a[0]=g[0][0]/d,a[1]=g[0][1]/d,b&&(d=6*g[0][4],0!==d?a[2]=g[0][3]/d:a[2]=0),(a[0]<q[0]||a[0]>q[1]||a[1]<q[2]||a[1]>q[3]||b&&(a[2]<q[4]||a[2]>q[5]))&&(a.length=0)),a.length)||(c=c[0]&&c[0].length?f(c[0],b):null)&&(a[0]=c[0],a[1]=c[1],b&&2<c.length&&(a[2]=c[2]));return a};l._getLineIntersection2=a})},"esri/core/Loadable":function(){define("./Promise ./Accessor ./Error ./Warning dojo/aspect dojo/_base/lang dojo/Deferred".split(" "),
function(m,l,h,d,b,g,k){return m.createSubclass([l],{declaredClass:"esri.core.Loadable","-chains-":g.mixin(l._meta.chains,{load:"after"}),constructor:function(){this._set("loadWarnings",[]);var f=new k;this.addResolvingPromise(f.promise);b.around(this,"load",function(a){return function(){return"not-loaded"===this.loadStatus&&(this.loadStatus="loading",a.apply(this)),f&&(f.resolve(),f=null),this.when()}});this.when(function(a){this.loadStatus="loaded"}.bind(this),function(a){this.loadStatus="failed";
this.loadError=a}.bind(this))},properties:{loaded:{readOnly:!0,dependsOn:["loadStatus"],get:function(){return"loaded"===this.loadStatus}},loadError:null,loadStatus:"not-loaded",loadWarnings:{type:[d],readOnly:!0}},load:function(){},cancelLoad:function(){return this.isFulfilled()?this:(this.loadError=new h("load:cancelled","Cancelled"),this._promiseProps.cancel(this.loadError),this)}})})},"esri/core/Promise":function(){define("dojo/_base/lang dojo/promise/all dojo/Deferred dojo/aspect dojo/has dojo/errors/create ./Scheduler ./Logger ./declare".split(" "),
function(m,l,h,d,b,g,k,f,a){function e(a,b){c.warn("DEPRECATED: "+a+"()"+(b?" -- use "+b+" instead":""))}b.add("esri-promise-compatibility",!1);b.add("esri-promise-compatibility-deprecation-warnings",!0);var c=f.getLogger("esri.core.Promise"),q=function(a){var c=a._promiseProps;if(!c.resolver.isFulfilled()){var b,e,f=c.resolvingPromises;c.allPromise&&c.allPromise.cancel();var d=new h;for(b=f.length-1;0<=b;b--)e=f[b],e.isCanceled&&e.isCanceled()?f.splice(b,1):e.then(null,null,c.resolver.progress);
e=null;(c.allPromise=l(f.concat([d.promise]))).then(function(){c.resolver.resolve(a);a=c=d=c.allPromise=c.resolvingPromises=null},function(b){if(c.allPromise=null,!b||"cancel"!==b.dojoType){var e=Array.prototype.slice.call(arguments,0);c.resolver.reject(e[0]);a=c=d=c.allPromise=c.resolvingPromises=null}});d&&k.schedule(function(){d&&d.resolve()})}},t=g("CancelError",null,function(a){this.target=a}),r=function(a){return a||new t(this.instance)},u=function(a){this.instance=a;this.canceler=r.bind(this);
this.resolver=new h;this.initialized=!1;this.resolvingPromises=[]};u.prototype={canceler:null,cancel:function(a){if(!this.resolver.isFulfilled()){this.allPromise.cancel();for(var c=this.resolvingPromises.concat(),b=c.length-1;0<=b;b--)c[b].cancel(a);this.resolver.cancel(a)}}};g={declaredClass:"esri.core.Promise",constructor:function(){Object.defineProperty(this,"_promiseProps",{value:new u(this),enumerable:!1,configurable:!1,writable:!0});var a=d.after(this,"postscript",function(c,b){a.remove();a=
null;q(this)},!0)},_promiseProps:null,always:function(a){return b("esri-promise-compatibility-deprecation-warnings")&&e("always",".when(callback).catch(errBack)"),this.when(a,a)},isResolved:function(){return this._promiseProps.resolver.isResolved()},isRejected:function(){return this._promiseProps.resolver.isRejected()},isFulfilled:function(){return this._promiseProps.resolver.isFulfilled()},otherwise:function(a){return b("esri-promise-compatibility-deprecation-warnings")&&e("otherwise",".when().catch(errback)"),
this.when(null,a)},"catch":function(a){return b("esri-promise-compatibility-deprecation-warnings")&&e("catch",".when().catch(errback)"),this.when(null,a)},when:function(a,c,b){var e=new h(this._promiseProps.canceler);a=e.then(a,c,b);return this._promiseProps.resolver.then(e.resolve,e.reject,e.progress),a},addResolvingPromise:function(a){a&&!this._promiseProps.resolver.isFulfilled()&&(a._promiseProps&&(a=a.when()),this._promiseProps.resolvingPromises.push(a),q(this))}};b("esri-promise-compatibility")||
(g=m.mixin(g,{then:function(a,c,f){return b("esri-promise-compatibility-deprecation-warnings")&&e("then",".when(callback, errback)"),this.when(a,c,f)},cancel:function(){b("esri-promise-compatibility-deprecation-warnings")&&e("cancel")},isCanceled:function(){return b("esri-promise-compatibility-deprecation-warnings")&&e("isCanceled"),!1},trace:function(){return b("esri-promise-compatibility-deprecation-warnings")&&e("trace"),this},traceRejected:function(){return b("esri-promise-compatibility-deprecation-warnings")&&
e("traceRejected"),this}}));return a(null,g)})},"esri/core/Warning":function(){define(["require","exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","./Message"],function(m,l,h,d,b){m=function(b){function d(f,a,e){var c=b.call(this,f,a,e)||this;return c instanceof d?c:new d(f,a,e)}return h(d,b),d}(b);return m.prototype.type="warning",m})},"esri/portal/Portal":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/accessorSupport/decorators ../core/Error ../config ../kernel ../request ../geometry/Extent ../core/global ../core/JSONSupport ../core/Loadable ./PortalQueryParams ./PortalQueryResult ./PortalUser ../core/promiseUtils ../core/requireUtils ../core/urlUtils dojo/promise/all dojo/_base/kernel dojo/_base/lang dojo/_base/url".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G){var N;return function(r){function u(c){c=r.call(this)||this;return c.access=null,c.allSSL=!1,c.authMode="auto",c.authorizedCrossOriginDomains=null,c.basemapGalleryGroupQuery=null,c.bingKey=null,c.canListApps=!1,c.canListData=!1,c.canListPreProvisionedItems=!1,c.canProvisionDirectPurchase=!1,c.canSearchPublic=!1,c.canShareBingPublic=!1,c.canSharePublic=!1,c.canSignInArcGIS=!1,c.canSignInIDP=!1,c.colorSetsGroupQuery=null,c.commentsEnabled=
!1,c.created=null,c.culture=null,c.customBaseUrl=null,c.defaultBasemap=null,c.defaultExtent=null,c.defaultVectorBasemap=null,c.description=null,c.featuredGroups=null,c.featuredItemsGroupQuery=null,c.galleryTemplatesGroupQuery=null,c.livingAtlasGroupQuery=null,c.helperServices=null,c.homePageFeaturedContent=null,c.homePageFeaturedContentCount=null,c.httpPort=null,c.httpsPort=null,c.id=null,c.ipCntryCode=null,c.isPortal=!1,c.layerTemplatesGroupQuery=null,c.maxTokenExpirationMinutes=null,c.modified=
null,c.name=null,c.portalHostname=null,c.portalMode=null,c.portalProperties=null,c.region=null,c.rotatorPanels=null,c.showHomePageDescription=!1,c.supportsHostedServices=!1,c.symbolSetsGroupQuery=null,c.templatesGroupQuery=null,c.units=null,c.url=a.portalUrl,c.urlKey=null,c.user=null,c.useStandardizedQuery=!1,c.useVectorBasemaps=!1,c.vectorBasemapGalleryGroupQuery=null,c}return d(u,r),l=u,u.prototype.normalizeCtorArgs=function(a){return"string"==typeof a?{url:a}:a},u.prototype.destroy=function(){this._esriId_credentialCreateHandle&&
(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)},u.prototype.readAuthorizedCrossOriginDomains=function(c){if(c)for(var b=0;b<c.length;b++){var e=c[b],n=e;z.hasProtocol(n)||(n=z.appUrl.scheme+"://"+n);z.canUseXhr(n)||a.request.corsEnabledServers.push({host:e,withCredentials:!0})}return c},u.prototype.readDefaultBasemap=function(a){return a?(a=N.fromJSON(a),a.portalItem={portal:this},a):null},u.prototype.readDefaultVectorBasemap=function(a){return a?(a=N.fromJSON(a),
a.portalItem={portal:this},a):null},Object.defineProperty(u.prototype,"extraQuery",{get:function(){return this.id&&!this.canSearchPublic?" AND orgid:"+this.id:null},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isOrganization",{get:function(){return!!this.access},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"restUrl",{get:function(){var a=this.url;if(a)var c=a.indexOf("/sharing"),a=0<c?a.substring(0,c):this.url.replace(/\/+$/,""),a=a+"/sharing/rest";return a},
enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"thumbnailUrl",{get:function(){var a=this.restUrl,c=this.thumbnail;return a&&c?this._normalizeSSL(a+"/portals/self/resources/"+c):null},enumerable:!0,configurable:!0}),u.prototype.readUrlKey=function(a){return a?a.toLowerCase():a},u.prototype.readUser=function(a){var c=null;return a&&(c=y.fromJSON(a),c.portal=this),c},u.prototype.load=function(){var a=this,c=w.when(m,"../Basemap").then(function(a){N=a}).then(function(){return a._fetchSelf()}).then(function(c){if(e.id){var b=
e.id;a.credential=b.findCredential(a.restUrl);a.credential||a.authMode!==l.AUTH_MODE_AUTO||(a._esriId_credentialCreateHandle=b.on("credential-create",function(){b.findCredential(a.restUrl)&&a._signIn()}))}a.read(c)});return this.addResolvingPromise(c),this.when()},u.prototype.fetchBasemaps=function(a){var c=new v;return c.query=a||(this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),c.disableExtraQuery=!0,this.queryGroups(c).then(function(a){return(c.num=100,
c.query='type:"Web Map" -type:"Web Application"',a.total)?(a=a.results[0],c.sortField=a.sortField||"name",c.sortOrder=a.sortOrder||"desc",a.queryItems(c)):null}).then(function(a){return a&&a.total?a.results.filter(function(a){return"Web Map"===a.type}).map(function(a){return new N({portalItem:a})}):[]})},u.prototype.fetchFeaturedGroups=function(){var a=this.featuredGroups,c=new v;if(c.num=100,c.sortField="title",a&&a.length){for(var b=[],e=0;e<a.length;e++){var f=a[e];b.push('(title:"'+f.title+'" AND owner:'+
f.owner+")")}return c.query=b.join(" OR "),this.queryGroups(c).then(function(a){return a.results})}return n.resolve([])},u.getDefault=function(){return l._default||(l._default=new l),l._default},u.prototype.queryGroups=function(a){return this._queryPortal("/community/groups",a,"PortalGroup")},u.prototype.queryItems=function(a){return this._queryPortal("/search",a,"PortalItem")},u.prototype.queryUsers=function(a){return a.sortField||(a.sortField="username"),this._queryPortal("/community/users",a,"PortalUser")},
u.prototype.toJSON=function(){throw new f("internal:not-yet-implemented","Portal.toJSON is not yet implemented");},u.prototype._fetchSelf=function(a){void 0===a&&(a=this.authMode);var c=this.restUrl+"/portals/self";a={authMode:a,query:{culture:B.locale}};return"auto"===a.authMode&&(a.authMode="no-prompt"),this._request(c,a)},u.prototype._queryPortal=function(a,c,b){var e=this,n=function(b){return e._request(e.restUrl+a,c.toRequestOptions(e)).then(function(a){var n=c.clone();return n.start=a.nextStart,
new x({nextQueryParams:n,queryParams:c,total:a.total,results:l._resultsToTypedArray(b,{portal:e},a)})}).then(function(a){return C(a.results.map(function(c){return"function"==typeof c.when?c.when():a})).always(function(){return a})})};return b?w.when(m,"./"+b).then(function(a){return n(a)}):n()},u.prototype._signIn=function(){var a=this;if(this.authMode===l.AUTH_MODE_ANONYMOUS)return n.reject(new f("portal:invalid-auth-mode",'Current "authMode"\' is "'+this.authMode+'"'));if("failed"===this.loadStatus)return n.reject(this.loadError);
var c=function(c){return n.resolve().then(function(){return"not-loaded"===a.loadStatus?(c||(a.authMode="immediate"),a.load().then(function(){return null})):"loading"===a.loadStatus?a.load().then(function(){return a.credential?null:(a.credential=c,a._fetchSelf("immediate"))}):a.user&&a.credential===c?null:(a.credential=c,a._fetchSelf("immediate"))}).then(function(c){c&&a.read(c)})};return e.id?e.id.getCredential(this.restUrl).then(function(a){return c(a)}):c(this.credential)},u.prototype._normalizeSSL=
function(a){var c=this.allSSL;if(c||("isSecureContext"in t?c=t.isSecureContext:t.location&&t.location.origin&&(c=0===t.location.origin.indexOf("https:"))),this.isPortal){var b=new G(a);return-1<this.portalHostname.toLowerCase().indexOf(b.host.toLowerCase())&&b.port&&"80"!==b.port&&"443"!==b.port?c?"https://"+b.host+(this.httpsPort&&443!==this.httpsPort?":"+this.httpsPort:"")+b.path+"?"+b.query:"http://"+b.host+(this.httpPort&&80!==this.httpPort?":"+this.httpPort:"")+b.path+"?"+b.query:c?a.replace("http:",
"https:"):a}return c?a.replace("http:","https:"):a},u.prototype._normalizeUrl=function(a){var c=this.credential&&this.credential.token;return this._normalizeSSL(c?a+(-1<a.indexOf("?")?"\x26":"?")+"token\x3d"+c:a)},u.prototype._requestToTypedArray=function(a,c,b){var e=this,n=function(b){return e._request(a,c).then(function(a){var c=l._resultsToTypedArray(b,{portal:e},a);return C(c.map(function(p){return"function"==typeof p.when?p.when():a})).always(function(){return c})})};return b?w.when(m,"./"+
b).then(function(a){return n(a)}):n()},u.prototype._request=function(a,b){var e=this.authMode===l.AUTH_MODE_ANONYMOUS?"anonymous":"auto",n=null,f="auto",d={f:"json"},g="json";b&&(b.authMode&&(e=b.authMode),b.body&&(n=b.body),b.method&&(f=b.method),b.query&&(d=h({},d,b.query)),b.responseType&&(g=b.responseType));b={authMode:e,body:n,callbackParamName:"callback",method:f,query:d,responseType:g,timeout:0};return c(this._normalizeSSL(a),b).then(function(a){return a.data})},u._resultsToTypedArray=function(a,
c,b){var e;return b?(e=b.listings||b.notifications||b.userInvitations||b.tags||b.items||b.groups||b.comments||b.provisions||b.results||b.relatedItems||b,(a||c)&&(e=e.map(function(b){b=F.mixin(a?a.fromJSON(b):b,c);return"function"==typeof b.load&&b.load(),b}))):e=[],e},u.AUTH_MODE_ANONYMOUS="anonymous",u.AUTH_MODE_AUTO="auto",u.AUTH_MODE_IMMEDIATE="immediate",b([k.property()],u.prototype,"access",void 0),b([k.property()],u.prototype,"allSSL",void 0),b([k.property()],u.prototype,"authMode",void 0),
b([k.property()],u.prototype,"authorizedCrossOriginDomains",void 0),b([k.reader("authorizedCrossOriginDomains")],u.prototype,"readAuthorizedCrossOriginDomains",null),b([k.property()],u.prototype,"basemapGalleryGroupQuery",void 0),b([k.property()],u.prototype,"bingKey",void 0),b([k.property()],u.prototype,"canListApps",void 0),b([k.property()],u.prototype,"canListData",void 0),b([k.property()],u.prototype,"canListPreProvisionedItems",void 0),b([k.property()],u.prototype,"canProvisionDirectPurchase",
void 0),b([k.property()],u.prototype,"canSearchPublic",void 0),b([k.property()],u.prototype,"canShareBingPublic",void 0),b([k.property()],u.prototype,"canSharePublic",void 0),b([k.property()],u.prototype,"canSignInArcGIS",void 0),b([k.property()],u.prototype,"canSignInIDP",void 0),b([k.property()],u.prototype,"colorSetsGroupQuery",void 0),b([k.property()],u.prototype,"commentsEnabled",void 0),b([k.property({type:Date})],u.prototype,"created",void 0),b([k.property()],u.prototype,"credential",void 0),
b([k.property()],u.prototype,"culture",void 0),b([k.property()],u.prototype,"customBaseUrl",void 0),b([k.property()],u.prototype,"defaultBasemap",void 0),b([k.reader("defaultBasemap")],u.prototype,"readDefaultBasemap",null),b([k.property({type:q})],u.prototype,"defaultExtent",void 0),b([k.property()],u.prototype,"defaultVectorBasemap",void 0),b([k.reader("defaultVectorBasemap")],u.prototype,"readDefaultVectorBasemap",null),b([k.property()],u.prototype,"description",void 0),b([k.property({dependsOn:["id",
"canSearchPublic"],readOnly:!0})],u.prototype,"extraQuery",null),b([k.property()],u.prototype,"featuredGroups",void 0),b([k.property()],u.prototype,"featuredItemsGroupQuery",void 0),b([k.property()],u.prototype,"galleryTemplatesGroupQuery",void 0),b([k.property()],u.prototype,"livingAtlasGroupQuery",void 0),b([k.property()],u.prototype,"helpBase",void 0),b([k.property()],u.prototype,"helperServices",void 0),b([k.property()],u.prototype,"helpMap",void 0),b([k.property()],u.prototype,"homePageFeaturedContent",
void 0),b([k.property()],u.prototype,"homePageFeaturedContentCount",void 0),b([k.property()],u.prototype,"httpPort",void 0),b([k.property()],u.prototype,"httpsPort",void 0),b([k.property()],u.prototype,"id",void 0),b([k.property()],u.prototype,"ipCntryCode",void 0),b([k.property({dependsOn:["access"],readOnly:!0})],u.prototype,"isOrganization",null),b([k.property()],u.prototype,"isPortal",void 0),b([k.property()],u.prototype,"layerTemplatesGroupQuery",void 0),b([k.property()],u.prototype,"maxTokenExpirationMinutes",
void 0),b([k.property({type:Date})],u.prototype,"modified",void 0),b([k.property()],u.prototype,"name",void 0),b([k.property()],u.prototype,"portalHostname",void 0),b([k.property()],u.prototype,"portalMode",void 0),b([k.property()],u.prototype,"portalProperties",void 0),b([k.property()],u.prototype,"region",void 0),b([k.property({dependsOn:["url"],readOnly:!0})],u.prototype,"restUrl",null),b([k.property()],u.prototype,"rotatorPanels",void 0),b([k.property()],u.prototype,"showHomePageDescription",
void 0),b([k.property()],u.prototype,"staticImagesUrl",void 0),b([k.property()],u.prototype,"stylesGroupQuery",void 0),b([k.property()],u.prototype,"supportsHostedServices",void 0),b([k.property()],u.prototype,"symbolSetsGroupQuery",void 0),b([k.property()],u.prototype,"templatesGroupQuery",void 0),b([k.property()],u.prototype,"thumbnail",void 0),b([k.property({dependsOn:["restUrl","thumbnail"],readOnly:!0})],u.prototype,"thumbnailUrl",null),b([k.property()],u.prototype,"units",void 0),b([k.property()],
u.prototype,"url",void 0),b([k.property()],u.prototype,"urlKey",void 0),b([k.reader("urlKey")],u.prototype,"readUrlKey",null),b([k.property()],u.prototype,"user",void 0),b([k.reader("user")],u.prototype,"readUser",null),b([k.property()],u.prototype,"useStandardizedQuery",void 0),b([k.property()],u.prototype,"useVectorBasemaps",void 0),b([k.property()],u.prototype,"vectorBasemapGalleryGroupQuery",void 0),b([g(1,k.cast(v))],u.prototype,"_queryPortal",null),u=l=b([k.subclass("esri.portal.Portal")],u);
var l}(k.declared(r,u))})},"esri/core/tsSupport/assignHelper":function(){define([],function(){return Object.assign||function(m){for(var l,h=1,d=arguments.length;d>h;h++){l=arguments[h];for(var b in l)Object.prototype.hasOwnProperty.call(l,b)&&(m[b]=l[b])}return m}})},"esri/core/tsSupport/paramHelper":function(){define([],function(){return function(m,l){return function(h,d){l(h,d,m)}}})},"esri/config":function(){define(["require","exports","dojo/_base/window"],function(m,l,h){return{screenDPI:96,geometryService:null,
geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",portalUrl:"https://www.arcgis.com",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{corsDetection:!(h.global&&h.global.cordova),corsDetectionTimeout:15,corsEnabledServers:"basemaps.arcgis.com basemapsbeta.arcgis.com basemapsbetadev.arcgis.com basemapsdev.arcgis.com cdn.arcgis.com cdn-a.arcgis.com cdn-b.arcgis.com demographics1.arcgis.com demographics2.arcgis.com demographics3.arcgis.com demographics4.arcgis.com demographics5.arcgis.com demographics6.arcgis.com dev.arcgis.com devext.arcgis.com elevation3d.arcgis.com elevation3ddev.arcgis.com js.arcgis.com jsdev.arcgis.com jsqa.arcgis.com geocode.arcgis.com geocodedev.arcgis.com geocodeqa.arcgis.com geoenrich.arcgis.com geoenrichdev.arcgis.com geoenrichqa.arcgis.com localvtiles.arcgis.com qaext.arcgis.com server.arcgisonline.com services.arcgis.com services.arcgisonline.com services1.arcgis.com services2.arcgis.com services3.arcgis.com services4.arcgis.com services5.arcgis.com services6.arcgis.com services7.arcgis.com services8.arcgis.com services9.arcgis.com servicesdev.arcgis.com servicesdev1.arcgis.com servicesdev2.arcgis.com servicesdev3.arcgis.com servicesqa.arcgis.com servicesqa1.arcgis.com servicesqa2.arcgis.com servicesqa3.arcgis.com static.arcgis.com staticqa.arcgis.com staticdev.arcgis.com tiles.arcgis.com tiles1.arcgis.com tiles2.arcgis.com tiles3.arcgis.com tiles4.arcgis.com tilesdevext.arcgis.com tilesqa.arcgis.com utility.arcgis.com utility.arcgisonline.com www.arcgis.com".split(" "),
corsStatus:{},forceProxy:!1,maxUrlLength:2E3,maxWorkers:5,proxyRules:[],proxyUrl:null,timeout:6E4,useIdentity:!0,useCors:"with-credentials",httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")},useSpatialIndex:(h.global&&h.global.Worker,!1)}})},"esri/request":function(){define("require dojo/_base/config dojo/Deferred dojo/_base/lang dojo/_base/url dojo/request dojo/io-query ./config ./core/Error ./core/global ./core/sniff ./core/lang ./core/urlUtils ./core/deferredUtils ./core/promiseUtils ./core/requireUtils dojo/has!host-browser?./core/request/script dojo/has!host-webworker?./core/workers/request".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y){function n(a){var c=k.objectToQuery(a.content);if(c&&(a.url+=(-1===a.url.indexOf("?")?"?":"\x26")+c),2E3<a.url.length){if(!t.isDataProtocol(a.url))return u.reject(d.mixin(Error(),{message:"When using responseType 'image', URL length cannot exceed 2000 characters."}));if(3E6<a.url.length)return u.reject(d.mixin(Error(),{message:"When using responseType 'image', data URL length cannot exceed 3000000 characters."}))}var p=new Image;a.allowImageDataAccess&&
(a.withCredentials?p.crossOrigin="use-credentials":p.crossOrigin="anonymous");var b=!1,e=new h(function(a){b=!0;p.onload=p.onerror=p.onabort=null;p.src=""}),c=function(a){p.onload=p.onerror=p.onabort=null;b||e.reject(Error("Unable to load the resource"))};return p.onload=function(){p.onload=p.onerror=p.onabort=null;b||e.resolve(this)},p.onerror=c,p.onabort=c,p.alt="",p.src=a.url,e.promise}function w(a){return a=new b(a),(a.host+(a.port?":"+a.port:"")).toLowerCase()}function z(){return Q?Q:Q=v.when(m,
"./identity/IdentityManager").then(function(a){P=a})}function C(a,b){var p=!!a.useProxy,A=a.method||"auto",e=q.isDefined(a.crossOrigin)?a.crossOrigin:T.useCors;a=d.mixin({},a);a._ssl&&(a.url=a.url.replace(/^http:/i,"https:"));var f=a.content,E=a.url;a._token&&(a.content=a.content||{},a.content.token=a._token);var w,r=0;E&&(w=k.objectToQuery(f),r=w.length+E.length+1,c("esri-url-encodes-apostrophe")&&(r=w.replace(/'/g,"%27").length+E.length+1));a.timeout=q.isDefined(a.timeout)?a.timeout:T.timeout;a.handleAs=
a.handleAs||"json";try{var H,u,v=e&&t.canUseXhr(a.urlObj)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(a.url),z=t.hasSameOrigin(a.urlObj,t.appUrl)||v,y="post"===A||!!a.body||r>T.maxUrlLength,l=!z&&-1!==a.handleAs.indexOf("json")&&a.callbackParamName&&!a.body,C=!!t.getProxyRule(a.url)||T.forceProxy||p||("image"!==a.handleAs||a.allowImageDataAccess)&&(!l||y)&&!z;if(C&&(t.isBlobProtocol(a.url)||t.isDataProtocol(a.url))&&(C=!1),(c("host-browser")||c("host-webworker"))&&C)if(H=t.getProxyUrl(E,
e),u=H.path,H._xo&&(v=!0),!y&&u.length+1+r>T.maxUrlLength&&(y=!0),a.url=u+"?"+E,y)a.content=d.mixin(H.query||{},f);else{var B=k.objectToQuery(d.mixin(H.query||{},f));B&&(a.url+=(-1===E.indexOf("?")?"?":"\x26")+B);a.content=null}if(l&&!y&&!C&&c("host-browser"))return a=R?R(a):a,a.jsonp=a.callbackParamName,a.query=a.content,x.get(a.url,a);var m=a.headers;if(!c("host-browser")&&!c("host-webworker")||m&&m.hasOwnProperty("X-Requested-With")||(m=a.headers=m||{},m["X-Requested-With"]=null),c("host-browser")&&
b){var G=a.content&&a.content.token;G&&(b.set?b.set("token",G):b.append("token",G));a.contentType=!1}if(v&&!a.hasOwnProperty("withCredentials")&&"with-credentials"===T.useCors){var p=C?u:E,F=t.getCorsConfig(p);if(F&&F.hasOwnProperty("withCredentials"))F.withCredentials&&(a.withCredentials=!0);else if(P){var W=P.findServerInfo(p);W&&W.webTierAuth&&(a.withCredentials=!0)}}return a=R?R(a):a,"image"===a.handleAs?n(a):y?(a.body?(a.data=b||a.body,a.query=a.content):a.data=a.content,delete a.body,delete a.content,
!C&&c("safari")&&(a.url+=(-1===a.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+S++),g.post(a.url,a)):(a.query=a.content,delete a.content,g.get(a.url,a))}catch(pa){return a=new h,a.reject(pa),a.promise}}function B(a){var b=T.corsStatus;try{var p=w(a.url);if(T.corsDetection&&T.useCors&&c("esri-cors")&&a.url&&-1!==a.url.toLowerCase().indexOf("/rest/services")&&!t.hasSameOrigin(a.urlObj,t.appUrl)&&!t.canUseXhr(a.urlObj)){if(b[p])return b[p];var A=new h;b[p]=A.promise;var e=a.url.substring(0,
a.url.toLowerCase().indexOf("/rest/")+6)+"info";return g.get(e,{query:{f:"json"},handleAs:"json",headers:{"X-Requested-With":null},timeout:1E3*T.corsDetectionTimeout}).then(function(c){c?(t.canUseXhr(a.url)||T.corsEnabledServers.push(p),A.resolve()):A.reject()},function(a){A.reject()}),A.promise}}catch(U){console.log("esri._detectCors: an unknown error occurred while detecting CORS support")}return Y}function F(c,b,p,A){function e(a){a&&(p._token=a.token,p._ssl=a.ssl)}function n(a){a._pendingDfd=
C(p,k);var c=!!a._pendingDfd.response;(a._pendingDfd.response||a._pendingDfd).then(function(a){if(!c||!a.data)return a;var p=a.getHeader("Content-Type");if(p&&(p=p.toLowerCase(),-1===p.indexOf("text/plain")&&-1===p.indexOf("application/json")))return a;p=a.data;if(p instanceof ArrayBuffer&&750>=p.byteLength)p=new Blob([p]);else if(!(p instanceof Blob&&750>=p.size))return a;var b=new h,A=new FileReader;return A.readAsText(p),A.onloadend=function(){if(!A.error)try{var p=JSON.parse(A.result);p.error&&
(Object.isExtensible(a)||(a=d.mixin({},a)),a._jsonData=p)}catch(ra){}b.resolve(a)},b.promise}).then(function(p){var b=c?p.data:p,e=c?p.getHeader.bind(p):H;if(b&&(p=c&&p._jsonData||b,p.error||"error"===p.status))throw b=d.mixin(Error(),p.error||p),b.getHeader=e,b;a.resolve({data:b,url:A.url,requestOptions:A.requestOptions,getHeader:e});a._pendingDfd=null}).otherwise(function(c){var b,e,n;if(c&&(b=c.code,e=c.subcode,n=c.messageCode,n=n&&n.toUpperCase()),c&&403==b&&(4==e||c.message&&-1<c.message.toLowerCase().indexOf("ssl")&&
-1===c.message.toLowerCase().indexOf("permission"))){if(!p._ssl)return p._ssl=p._sslFromServer=!0,void F(a,!0,p,A)}else if(c&&415==c.status){if(b=p.url,e=T.corsStatus,n=t.getCorsConfig(b,!0),-1<n&&T.corsEnabledServers.splice(n,1),n=new h,n.reject({log:!!l.isDebug}),e[w(b)]=n.promise,!p._err415)return p._err415=1,void F(a,!0,p,A)}else if(E&&"no-prompt"!==p.authMode&&P._errorCodes&&-1!==P._errorCodes.indexOf(b)&&!P._isPublic(p.url)&&(403!=b||O&&-1===O.indexOf(n)&&(!q.isDefined(e)||2==e&&p._token)))return void G(a,
p,A,N("request:server",c,A));a.reject(N("request:server",c,A));a._pendingDfd=null})}var f,g=p.body,E=p.useIdentity,k=null,r=g instanceof FormData;(r||g&&g.elements)&&(k=r?g:new FormData(g));var u=!!(-1!==p.url.toLowerCase().indexOf("token\x3d")||p.content&&p.content.token||k&&k.get&&k.get("token")||g&&g.elements&&g.elements.token);return b||(!E||u||p._token||P._isPublic(p.url)||("immediate"===p.authMode?f=P.getCredential(p.url).then(e):"no-prompt"===p.authMode?f=P.checkSignInStatus(p.url).then(e).otherwise(function(){}):
e(P.findCredential(p.url))),c.then(function(a){if((/\/sharing\/rest\/accounts\/self/i.test(p.url)||/\/sharing\/rest\/portals\/self/i.test(p.url))&&!u&&!p._token&&a.user&&a.user.username){var c=T.corsEnabledServers,b=t.getCorsConfig(p.url,!0),A={host:w(p.url),withCredentials:!0};if(-1===b)c.push(A);else{var e=c[b];"object"==typeof e?e.withCredentials=!0:c.splice(b,1,A)}}if(c=p._credential){var n;(b=(b=P.findServerInfo(c.server))&&b.owningSystemUrl)&&(b=b.replace(/\/?$/,"/sharing"),n=P.findCredential(b,
c.userId),n&&-1===P._getIdenticalSvcIdx(b,n)&&n.resources.splice(0,0,b))}return a}).always(function(c){if(delete p._credential,c){var b=!!p._ssl;c instanceof a?c.details.ssl=b:c.ssl=b}})),f?f.then(function(){n(c)}).otherwise(function(a){c.reject(a)}):n(c),c.promise}function G(a,c,p,b){a._pendingDfd=P.getCredential(c.url,{error:b,token:c._token});a._pendingDfd.then(function(b){c._token=b.token;c._credential=b;c._ssl=c._sslFromServer||b.ssl;F(a,!0,c,p)}).otherwise(function(p){a.reject(p);a._pendingDfd=
null})}function N(c,b,p){var A="Error",e={url:p.url,requestOptions:p.requestOptions,getHeader:H};if(b instanceof a)return b.details?(b.details=q.clone(b.details),b.details.url=p.url,b.details.requestOptions=p.requestOptions):b.details=e,b;if(b){var n=b.response;p=n&&n.getHeader;var n=n&&n.status,f=b.message;p=b.getHeader||p;f&&(A=f);p&&(e.getHeader=p);e.httpStatus=(q.isDefined(b.httpCode)?b.httpCode:b.code)||n;e.subCode=b.subcode;e.messageCode=b.messageCode;"string"==typeof b.details?e.messages=[b.details]:
e.messages=b.details}c=new a(c,A,e);return b&&"cancel"===b.dojoType&&(c.dojoType="cancel"),c}function M(a,n){if(y&&e.invokeStaticMessage)return y.execute(a,n);var p=d.mixin({},n),A={url:a,requestOptions:d.mixin({},n)};if(p.content=p.query,delete p.query,p.preventCache=!!p.cacheBust,delete p.cacheBust,p.handleAs=p.responseType,delete p.responseType,"array-buffer"===p.handleAs&&(p.handleAs="arraybuffer"),"image"===p.handleAs){if(c("host-webworker")||c("host-node"))return u.reject(N("request:invalid-parameters",
Error("responseType 'image' is not supported in Web Workers or Node environment"),A));p.preventCache&&(p.content=p.content||{},p.content["request.preventCache"]=Date.now());p.method="auto"}else if(t.isDataProtocol(a))return u.reject(N("request:invalid-parameters",Error("Data URLs are not supported for responseType \x3d "+p.handleAs),A));var f=T.useIdentity;"anonymous"===p.authMode&&(f=!1);p.useIdentity=f;p.url=t.normalize(a);p.urlObj=new b(p.url);var g=r.makeDeferredCancellingPending();return B(p).always(function(){return f&&
!P?z():void 0}).always(function(){F(g,!1,p,A)}),g.promise}var R,P,Q,T=f.request,O=["COM_0056","COM_0057"],S=0,H=function(){return null},Y=(new h).resolve();return M.setRequestPreCallback=function(a){R=a},M})},"dojo/_base/url":function(){define(["./kernel"],function(m){var l=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,h=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,d=function(){for(var b=arguments,g=[b[0]],k=1;k<b.length;k++)if(b[k]){var f=new d(b[k]+""),g=new d(g[0]+
"");if(""==f.path&&!f.scheme&&!f.authority&&!f.query)null!=f.fragment&&(g.fragment=f.fragment),f=g;else if(!f.scheme&&(f.scheme=g.scheme,!f.authority&&(f.authority=g.authority,"/"!=f.path.charAt(0)))){for(var g=(g.path.substring(0,g.path.lastIndexOf("/")+1)+f.path).split("/"),a=0;a<g.length;a++)"."==g[a]?a==g.length-1?g[a]="":(g.splice(a,1),a--):0<a&&(1!=a||""!=g[0])&&".."==g[a]&&".."!=g[a-1]&&(a==g.length-1?(g.splice(a,1),g[a-1]=""):(g.splice(a-1,2),a-=2));f.path=g.join("/")}g=[];f.scheme&&g.push(f.scheme,
":");f.authority&&g.push("//",f.authority);g.push(f.path);f.query&&g.push("?",f.query);f.fragment&&g.push("#",f.fragment)}this.uri=g.join("");b=this.uri.match(l);this.scheme=b[2]||(b[1]?"":null);this.authority=b[4]||(b[3]?"":null);this.path=b[5];this.query=b[7]||(b[6]?"":null);this.fragment=b[9]||(b[8]?"":null);null!=this.authority&&(b=this.authority.match(h),this.user=b[3]||null,this.password=b[4]||null,this.host=b[6]||b[7],this.port=b[9]||null)};d.prototype.toString=function(){return this.uri};
return m._Url=d})},"dojo/request":function(){define(["./request/default!"],function(m){return m})},"dojo/request/default":function(){define(["exports","require","../has"],function(m,l,h){var d=h("config-requestProvider"),b;if(h("host-browser")||h("host-webworker"))b="./xhr";d||(d=b);m.getPlatformDefaultId=function(){return b};m.load=function(g,k,f,a){l(["platform"==g?b:d],function(a){f(a)})}})},"esri/core/urlUtils":function(){define("require exports dojo/_base/window dojo/_base/lang dojo/_base/url dojo/io-query ../config ./lang ./sniff ./Logger ./Error".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){function q(a){var p={path:null,query:null},c=new b(a),A=a.indexOf("?");return null===c.query?p.path=a:(p.path=a.substring(0,A),p.query=g.queryToObject(c.query)),c.fragment&&(p.hash=c.fragment,null===c.query&&(p.path=p.path.substring(0,p.path.length-(c.fragment.length+1)))),p}function t(a,p){void 0===a&&(a=!1);void 0===p&&(p=!0);var b,e=K.proxyUrl;"string"==typeof a?(b=O(a),(a=v(a))&&(e=a.proxyUrl)):b=!!a;if(!e)throw A.warn(U),new c("urlutils:proxy-not-set",U);var f;
b&&p&&"https"===l.appUrl.scheme&&(p=H(e),n(p)&&(e=p,f=1));e=q(e);return e._xo=f,e}function r(a){var p=a.indexOf("?");return-1!==p?(ca.path=a.slice(0,p),ca.query=a.slice(p+1)):(ca.path=a,ca.query=null),ca}function u(a){return a=r(a).path,a=a&&"/"===a[a.length-1]?a:a+"/",a=Y(a,!0),a=a.toLowerCase()}function v(a){var p=K.proxyRules;a=u(a);for(var c=0;c<p.length;c++)if(0===a.indexOf(p[c].urlPrefix))return p[c]}function x(a){a=F(a);var p=a.indexOf("/sharing");return 0<p?a.substring(0,p):a.replace(/\/+$/,
"")}function y(a,c,b){void 0===b&&(b=!1);a=p(a);c=p(c);return b||a.scheme===c.scheme?a.host.toLowerCase()===c.host.toLowerCase()&&a.port===c.port:!1}function n(p){return a("esri-phonegap")?!0:a("esri-cors")?null!=w(p):!1}function w(a,c){void 0===c&&(c=!1);"string"==typeof a&&(a=M(a)?p(a):l.appUrl);for(var b=K.corsEnabledServers||[],A=0;A<b.length;A++)for(var e=b[A],n=void 0,n="string"==typeof e?z(e):e.host?z(e.host):[],f=0;f<n.length;f++)if(y(a,n[f]))return c?A:e;return c?-1:null}function z(a){return l.corsServersUrlCache[a]||
(T(a)||Q(a)?l.corsServersUrlCache[a]=[new b(C(a))]:l.corsServersUrlCache[a]=[new b("http://"+a),new b("https://"+a)]),l.corsServersUrlCache[a]}function C(a,p,c){void 0===p&&(p=l.appBaseUrl);if(Q(a))a=c&&c.preserveProtocolRelative?a:"http"===l.appUrl.scheme&&l.appUrl.authority===N(a).slice(2)?"http:"+a:"https:"+a;else if(!T(a)){c=G;if("/"===a[0]){var b=p.indexOf("//"),b=p.indexOf("/",b+2);p=-1===b?p:p.slice(0,b)}a=c(p,a)}return a}function B(a,p,c){if(void 0===p&&(p=l.appBaseUrl),!M(a))return a;var b=
F(a),A=b.toLowerCase();p=F(p).toLowerCase().replace(/\/+$/,"");if((c=c?F(c).toLowerCase().replace(/\/+$/,""):null)&&0!==p.indexOf(c))return a;for(var e=function(a,p,c){return c=a.indexOf(p,c),-1===c?a.length:c},n=e(A,"/",A.indexOf("//")+2),f=-1;A.slice(0,n+1)===p.slice(0,n)+"/"&&(f=n+1,n!==A.length);)n=e(A,"/",n+1);if(-1===f||c&&f<c.length)return a;a=b.slice(f);b=p.slice(f-1).replace(/[^\/]+/g,"").length;if(0<b)for(A=0;b>A;A++)a="../"+a;else a="./"+a;return a}function F(a){a=a.trim();var p=a=C(a);
return a="http"===l.appUrl.scheme&&O(p)&&y(l.appBaseUrl,p,!0)&&!n(p)?Q(p)?"http:"+p:p.replace(ba,"http:"):p,a=W(a),a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function G(){for(var a=[],p=0;p<arguments.length;p++)a[p]=arguments[p];if(a&&a.length){p=[];if(M(a[0])){var c=a[0],b=c.indexOf("//");p.push(c.slice(0,b+1));fa.test(a[0])&&(p[0]+="/");a[0]=c.slice(b+2)}else"/"===a[0][0]&&p.push("");a=a.reduce(function(a,p){return p?a.concat(p.split("/")):a},[]);for(c=0;c<a.length;c++)b=a[c],".."===
b&&0<p.length?p.pop():!b||"."===b&&0!==p.length||p.push(b);return p.join("/")}}function N(a){if(R(a)||P(a))return null;var p=a.indexOf("://");if(-1===p&&Q(a))p=2;else{if(-1===p)return null;p+=3}p=a.indexOf("/",p);return-1===p?a:a.slice(0,p)}function M(a){return Q(a)||T(a)}function R(a){return"blob:"===a.slice(0,5)}function P(a){return"data:"===a.slice(0,5)}function Q(a){return a&&"/"===a[0]&&"/"===a[1]}function T(a){return V.test(a)}function O(a){return ba.test(a)||"https"===l.appUrl.scheme&&Q(a)}
function S(a){return X.test(a)||"http"===l.appUrl.scheme&&Q(a)}function H(a){return Q(a)?"https:"+a:a.replace(X,"https:")}function Y(a,p){return void 0===p&&(p=!1),Q(a)?a.slice(2):(a=a.replace(V,""),p&&1<a.length&&"/"===a[0]&&"/"===a[1]&&(a=a.slice(2)),a)}function W(a){var p=k.request.httpsDomains;if(!S(a))return a;var c,b=a.indexOf("/",7);return c=-1===b?a:a.slice(0,b),c=c.toLowerCase().slice(7),"http"!==l.appUrl.scheme||c!==l.appUrl.authority||ha.test(a)&&n(a)?(("https"===l.appUrl.scheme&&c===l.appUrl.authority||
p&&p.some(function(a){return c===a||f.endsWith(c,"."+a)}))&&(a=H(a)),a):a}function E(a,p,c){if(!(p&&c&&a&&M(a)))return a;var b=a.indexOf("//"),A=a.indexOf("/",b+2),e=a.indexOf(":",b+2),A=Math.min(0>A?a.length:A,0>e?a.length:e);if(a.slice(b+2,A).toLowerCase()!==p.toLowerCase())return a;p=a.slice(0,b+2);a=a.slice(A);return""+p+c+a}function p(a){return"string"==typeof a?new b(C(a)):(a.scheme||(a.scheme=l.appUrl.scheme),a)}Object.defineProperty(l,"__esModule",{value:!0});m=h.global;var A=e.getLogger("esri.core.urlUtils"),
K=k.request,U="esri/config: esriConfig.request.proxyUrl is not set. If making a request to a CORS-enabled\n server, please push the domain into esriConfig.request.corsEnabledServers.",V=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,X=/^\s*http:/i,ba=/^\s*https:/i,fa=/^\s*file:/i,ha=/^https?:\/\/[^\/]+\.arcgis.com\/sharing(\/|$)/i;l.appUrl=new b(m.location);l.corsServersUrlCache={};l.appBaseUrl=function(){var a=l.appUrl.path,a=a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-1]));return""+(l.appUrl.scheme+
"://"+l.appUrl.host+(null!=l.appUrl.port?":"+l.appUrl.port:""))+a}();l.urlToObject=q;l.getProxyUrl=t;l.addProxy=function(a){var p,c,b=v(a);b?(c=r(b.proxyUrl),p=c.path,c=c.query?g.queryToObject(c.query):null):K.forceProxy&&(c=t(),p=c.path,c=c.query);p&&(b=q(a),a=p+"?"+b.path,(p=g.objectToQuery(d.mixin(c||{},b.query)))&&(a=a+"?"+p));return a};var ca={path:"",query:""};l.addProxyRule=function(a){a={proxyUrl:a.proxyUrl,urlPrefix:u(a.urlPrefix)};for(var p=K.proxyRules,c=a.urlPrefix,b=p.length,A=0;A<p.length;A++){var e=
p[A].urlPrefix;if(0===c.indexOf(e)){if(c.length===e.length)return-1;b=A;break}0===e.indexOf(c)&&(b=A+1)}return p.splice(b,0,a),b};l.getProxyRule=v;l.hasSamePortal=function(a,p){return a=x(a),p=x(p),Y(a)===Y(p)};l.hasSameOrigin=y;l.canUseXhr=n;l.getCorsConfig=w;l.makeAbsolute=C;l.makeRelative=B;l.normalize=F;l.join=G;l.getOrigin=N;l.isAbsolute=M;l.isBlobProtocol=R;l.isDataProtocol=P;var ea=/^data:(.*?)(;base64)?,(.*)$/;l.dataComponents=function(a){return(a=a.match(ea))?{mediaType:a[1],isBase64:!!a[2],
data:a[3]}:null};l.makeData=function(a){return a.isBase64?"data:"+a.mediaType+";base64,"+a.data:"data:"+a.mediaType+","+a.data};l.isProtocolRelative=Q;l.hasProtocol=T;l.toHTTPS=H;l.removeFile=function(a){var p=0;if(M(a)){var c=a.indexOf("//");-1!==c&&(p=c+2)}c=a.lastIndexOf("/");return p>c?a:a.slice(0,c+1)};l.removeTrailingSlash=function(a){return a.replace(/\/+$/,"")};l.changeDomain=E;l.read=function(a,p){var c=p&&p.url&&p.url.path;a&&c&&(a=C(a,c,{preserveProtocolRelative:!0}));(p=p&&p.portal)&&
!p.isPortal&&p.urlKey&&p.customBaseUrl?(c=p.urlKey+"."+p.customBaseUrl,p=y(l.appUrl,l.appUrl.scheme+"://"+c)?E(a,p.portalHostname,c):E(a,c,p.portalHostname)):p=a;return p};l.write=function(a,p){if(!a)return a;!M(a)&&p&&p.blockedRelativeUrls&&p.blockedRelativeUrls.push(a);var c=C(a);if(p){var b=p.verifyItemRelativeUrls&&p.verifyItemRelativeUrls.rootPath||p.url&&p.url.path;b&&(c=B(c,b,b),c!==a&&p.verifyItemRelativeUrls&&p.verifyItemRelativeUrls.writtenUrls.push(c))}a=c;return c=(p=p&&p.portal)&&!p.isPortal&&
p.urlKey&&p.customBaseUrl?E(a,p.urlKey+"."+p.customBaseUrl,p.portalHostname):a};l.writeOperationalLayerUrl=function(a,p){a&&Q(a)&&(a="https:"+a);p.url=a?F(a):a};l.isSVG=function(a){return ja.test(a)};l.removeQueryParameters=function(a,p){a=q(a);var c=Object.keys(a.query||{});return 0<c.length&&p&&p.warn("removeQueryParameters()","Url query parameters are not supported, the following parameters have been removed: "+c.join(", ")+"."),a.path};var ja=/(^data:image\/svg|\.svg$)/i})},"esri/core/deferredUtils":function(){define(["dojo/Deferred"],
function(m){var l={makeDeferredCancellingPending:function(){var h={},d=l._dfdCanceller.bind(null,h),d=new m(d);return h.deferred=d,d},_dfdCanceller:function(h){h=h.deferred?h.deferred:h;h.canceled=!0;var d=h._pendingDfd;h.isResolved()||!d||d.isResolved()||d.cancel();h._pendingDfd=null},_fixDfd:function(h){var d=h.then;return h.then=function(b,g,k){if(b){var f=b;b=function(a){return a&&a._argsArray?f.apply(null,a):f(a)}}return d.call(this,b,g,k)},h},_resDfd:function(h,d,b){var g=d.length;1===g?b?h.reject(d[0]):
h.resolve(d[0]):1<g?(d._argsArray=!0,h.resolve(d)):h.resolve()}};return l})},"esri/portal/PortalQueryParams":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor ../core/kebabDictionary ../geometry/Extent ../geometry/support/webMercatorUtils ../geometry/SpatialReference dojo/_base/lang".split(" "),function(m,l,h,d,b,g,k,f,a,e,c){var q=k({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",
numViews:"num-views"});return function(g){function k(a){a=g.call(this)||this;return a.disableExtraQuery=!1,a.extent=null,a.num=10,a.query=null,a.sortField=null,a.start=1,a}return h(k,g),t=k,Object.defineProperty(k.prototype,"sortOrder",{get:function(){return this._get("sortOrder")||"asc"},set:function(a){"asc"!==a&&"desc"!==a||this._set("sortOrder",a)},enumerable:!0,configurable:!0}),k.prototype.clone=function(){return new t({disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():
null,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})},k.prototype.toRequestOptions=function(b,f){var d;if(this.extent){var n=a.project(this.extent,e.WGS84);n&&(d=n.xmin+","+n.ymin+","+n.xmax+","+n.ymax)}n=this.query;!this.disableExtraQuery&&b.extraQuery&&(n="("+n+")"+b.extraQuery);b={bbox:d,q:n,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(b.sortField=q.toJSON(this.sortField),b.sortOrder=this.sortOrder),{query:c.mixin(f,
b)}},d([b.property()],k.prototype,"disableExtraQuery",void 0),d([b.property({type:f})],k.prototype,"extent",void 0),d([b.property()],k.prototype,"num",void 0),d([b.property()],k.prototype,"query",void 0),d([b.property()],k.prototype,"sortField",void 0),d([b.property()],k.prototype,"sortOrder",null),d([b.property()],k.prototype,"start",void 0),k=t=d([b.subclass("esri.portal.PortalQueryParams")],k);var t}(b.declared(g))})},"esri/core/kebabDictionary":function(){define(["require","exports"],function(m,
l){return function(h,d){void 0===d&&(d={});var b=d.ignoreUnknown||!1,g={},k;for(k in h)g[h[k]]=k;var f=function(a){return g.hasOwnProperty(a)?g[a]:b?void 0:a},a=function(a){return h.hasOwnProperty(a)?h[a]:b?void 0:a};return{toJSON:f,fromJSON:a,read:function(b){return a(b)},write:function(a,c,b){a=f(a);void 0!==a&&(c[b]=a)}}}})},"esri/portal/PortalQueryResult":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor".split(" "),
function(m,l,h,d,b,g){return function(g){function f(a){a=g.call(this)||this;return a.nextQueryParams=null,a.queryParams=null,a.results=null,a.total=null,a}return h(f,g),d([b.property()],f.prototype,"nextQueryParams",void 0),d([b.property()],f.prototype,"queryParams",void 0),d([b.property()],f.prototype,"results",void 0),d([b.property()],f.prototype,"total",void 0),f=d([b.subclass("esri.portal.PortalQueryResult")],f)}(b.declared(g))})},"esri/portal/PortalUser":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Error ../core/JSONSupport ./PortalFolder ./PortalGroup ../core/promiseUtils ../core/requireUtils dojo/promise/all".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){return function(k){function r(){var a=k.call(this)||this;return a.access=null,a.created=null,a.culture=null,a.description=null,a.email=null,a.fullName=null,a.modified=null,a.orgId=null,a.portal=null,a.preferredView=null,a.privileges=null,a.region=null,a.role=null,a.roleId=null,a.units=null,a.username=null,a.userType=null,a}return h(r,k),Object.defineProperty(r.prototype,"thumbnailUrl",{get:function(){var a=this.url,c=this.thumbnail;return a&&c?this.portal._normalizeUrl(a+
"/info/"+c+"?f\x3djson"):null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userContentUrl",{get:function(){var a=this.get("portal.restUrl");return a?a+"/content/users/"+this.username:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"url",{get:function(){var a=this.get("portal.restUrl");return a?a+"/community/users/"+this.username:null},enumerable:!0,configurable:!0}),r.prototype.addItem=function(a){var c=this,b=a&&a.item,e=a&&a.data;a=a&&a.folder;var n=
{method:"post"};b&&(n.query=b._getPostQuery(),null!=e&&("string"==typeof e?n.query.text=e:"object"==typeof e&&(n.query.text=JSON.stringify(e))));e=this.userContentUrl;return a&&(e+="/"+a.id),this.portal._request(e+"/addItem",n).then(function(a){return b.id=a.id,b.portal=c.portal,b.loaded?b._reload():b.load()})},r.prototype.deleteItem=function(a){var c=this.userContentUrl;return a.ownerFolder&&(c+="/"+a.ownerFolder),this.portal._request(c+("/items/"+a.id+"/delete"),{method:"post"}).then(function(){a.id=
null;a.portal=null})},r.prototype.fetchFolders=function(){var a=this;return this.portal._request(this.userContentUrl,{query:{num:1}}).then(function(c){return c&&c.folders?c.folders.map(function(c){c=f.fromJSON(c);return c.portal=a.portal,c}):[]})},r.prototype.fetchGroups=function(){var c=this;return this.portal._request(this.url).then(function(b){return b&&b.groups?b.groups.map(function(b){b=a.fromJSON(b);return b.portal=c.portal,b}):[]})},r.prototype.fetchItems=function(a){var b=this;a||(a={});var e=
this.userContentUrl;a.folder&&(e+="/"+a.folder.id);var f;return c.when(m,"./PortalItem").then(function(c){f=c;return b.portal._request(e,{query:{folders:!1,num:a.num||10,start:a.start||1}})}).then(function(a){var c;return a&&a.items?(c=a.items.map(function(a){a=f.fromJSON(a);return a.portal=b.portal,a}),q(c.map(function(a){return a.load()})).always(function(){return{items:c,nextStart:a.nextStart,total:a.total}})):{items:[],nextStart:-1,total:0}})},r.prototype.getThumbnailUrl=function(a){var c=this.thumbnailUrl;
return c&&a&&(c+="\x26w\x3d"+a),c},r.prototype.queryFavorites=function(c){return this.favGroupId?(this._favGroup||(this._favGroup=new a({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(c)):e.reject(new g("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))},r.prototype.toJSON=function(){throw new g("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");},d([b.property()],r.prototype,"access",void 0),d([b.property({type:Date})],
r.prototype,"created",void 0),d([b.property()],r.prototype,"culture",void 0),d([b.property()],r.prototype,"description",void 0),d([b.property()],r.prototype,"email",void 0),d([b.property()],r.prototype,"favGroupId",void 0),d([b.property()],r.prototype,"fullName",void 0),d([b.property({type:Date})],r.prototype,"modified",void 0),d([b.property()],r.prototype,"orgId",void 0),d([b.property()],r.prototype,"portal",void 0),d([b.property()],r.prototype,"preferredView",void 0),d([b.property()],r.prototype,
"privileges",void 0),d([b.property()],r.prototype,"region",void 0),d([b.property()],r.prototype,"role",void 0),d([b.property()],r.prototype,"roleId",void 0),d([b.property()],r.prototype,"thumbnail",void 0),d([b.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],r.prototype,"thumbnailUrl",null),d([b.property()],r.prototype,"units",void 0),d([b.property({dependsOn:["portal.restUrl"],readOnly:!0})],r.prototype,"userContentUrl",null),d([b.property({dependsOn:["portal.restUrl"],
readOnly:!0})],r.prototype,"url",null),d([b.property()],r.prototype,"username",void 0),d([b.property()],r.prototype,"userType",void 0),r=d([b.subclass("esri.portal.PortalUser")],r)}(b.declared(k))})},"esri/portal/PortalFolder":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Error ../core/JSONSupport".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(a){a=f.call(this)||this;return a.created=
null,a.id=null,a.portal=null,a.title=null,a.username=null,a}return h(a,f),Object.defineProperty(a.prototype,"url",{get:function(){var a=this.get("portal.restUrl");return a?a+"/content/users/"+this.username+"/"+this.id:null},enumerable:!0,configurable:!0}),a.prototype.toJSON=function(){throw new g("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");},d([b.property({type:Date})],a.prototype,"created",void 0),d([b.property()],a.prototype,"id",void 0),d([b.property()],a.prototype,
"portal",void 0),d([b.property()],a.prototype,"title",void 0),d([b.property({dependsOn:["portal.restUrl"],readOnly:!0})],a.prototype,"url",null),d([b.property()],a.prototype,"username",void 0),a=d([b.subclass("esri.portal.PortalFolder")],a)}(b.declared(k))})},"esri/portal/PortalGroup":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/accessorSupport/decorators ../core/Error ../core/JSONSupport ./PortalQueryParams".split(" "),
function(m,l,h,d,b,g,k,f,a){return function(e){function c(a){a=e.call(this)||this;return a.access=null,a.created=null,a.description=null,a.id=null,a.isInvitationOnly=!1,a.modified=null,a.owner=null,a.portal=null,a.snippet=null,a.sortField=null,a.sortOrder=null,a.tags=null,a.title=null,a}return h(c,e),Object.defineProperty(c.prototype,"thumbnailUrl",{get:function(){var a=this.url,c=this.thumbnail;return a&&c?this.portal._normalizeUrl(a+"/info/"+c+"?f\x3djson"):null},enumerable:!0,configurable:!0}),
Object.defineProperty(c.prototype,"url",{get:function(){var a=this.get("portal.restUrl");return a?a+"/community/groups/"+this.id:null},enumerable:!0,configurable:!0}),c.prototype.fetchMembers=function(){return this.portal._request(this.url+"/users")},c.prototype.getThumbnailUrl=function(a){var c=this.thumbnailUrl;return c&&a&&(c+="\x26w\x3d"+a),c},c.prototype.toJSON=function(){throw new k("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");},c.prototype.queryItems=function(c){return c=
c?c.clone():new a,c.query="group:"+this.id+(c.query?" "+c.query:""),this.portal.queryItems(c)},d([g.property()],c.prototype,"access",void 0),d([g.property({type:Date})],c.prototype,"created",void 0),d([g.property()],c.prototype,"description",void 0),d([g.property()],c.prototype,"id",void 0),d([g.property()],c.prototype,"isInvitationOnly",void 0),d([g.property({type:Date})],c.prototype,"modified",void 0),d([g.property()],c.prototype,"owner",void 0),d([g.property()],c.prototype,"portal",void 0),d([g.property()],
c.prototype,"snippet",void 0),d([g.property()],c.prototype,"sortField",void 0),d([g.property()],c.prototype,"sortOrder",void 0),d([g.property()],c.prototype,"tags",void 0),d([g.property()],c.prototype,"thumbnail",void 0),d([g.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],c.prototype,"thumbnailUrl",null),d([g.property()],c.prototype,"title",void 0),d([g.property({dependsOn:["portal.restUrl"],readOnly:!0})],c.prototype,"url",null),d([b(0,g.cast(a))],c.prototype,"queryItems",
null),c=d([g.subclass("esri.portal.PortalGroup")],c)}(g.declared(f))})},"esri/portal/PortalRating":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor".split(" "),function(m,l,h,d,b,g){return function(g){function f(a){a=g.call(this)||this;return a.created=null,a.rating=null,a}return h(f,g),d([b.property()],f.prototype,"created",void 0),d([b.property()],f.prototype,"rating",void 0),f=d([b.subclass("esri.portal.PortalRating")],
f)}(b.declared(g))})},"esri/portal/support/portalLayers":function(){define("require exports dojo/_base/lang ../PortalItem ../../core/promiseUtils ../../core/requireUtils ../../request ../../core/Collection ../../core/Error ./mapNotesUtils".split(" "),function(m,l,h,d,b,g,k,f,a,e){function c(c){switch(c.type){case "Map Service":return t(c);case "Feature Service":return r(c);case "Feature Collection":return v(c);case "Scene Service":return u(c);case "Image Service":return x(c);case "Stream Service":return{className:"StreamLayer"};
case "Vector Tile Service":return{className:"VectorTileLayer"};case "KML":return{className:"KMLLayer"};case "WMTS":return{className:"WMTSLayer"};case "WMS":return{className:"WMSLayer"};default:return b.reject(new a("portal:unknown-item-type","Unknown item type '${type}'",{type:c.type}))}}function q(a){return g.when(m,"../../layers/"+a.className).then(function(c){return{constructor:c,properties:a.properties}})}function t(a){return y(a).then(function(a){return a?{className:"TileLayer"}:{className:"MapImageLayer"}})}
function r(a){return n(a).then(function(a){if("object"==typeof a){var c={returnZ:!0,outFields:["*"]};return null!=a.id&&(c.layerId=a.id),{className:"FeatureLayer",properties:c}}return{className:"GroupLayer"}})}function u(a){return n(a).then(function(c){if("object"==typeof c){var b={},e=void 0;if(null!=c.id?(b.layerId=c.id,e=a.url+"/layers/"+c.id):e=a.url,Array.isArray(a.typeKeywords)&&0<a.typeKeywords.length){c={IntegratedMesh:"IntegratedMeshLayer","3DObject":"SceneLayer",Point:"SceneLayer",PointCloud:"PointCloudLayer"};
for(var n=0,f=Object.keys(c);n<f.length;n++){var d=f[n];if(-1!==a.typeKeywords.indexOf(d))return{className:c[d]}}}return w(e).then(function(a){var c="SceneLayer";return null!=a&&"IntegratedMesh"===a.layerType?c="IntegratedMeshLayer":null!=a&&"PointCloud"===a.layerType&&(c="PointCloudLayer"),{className:c,properties:b}})}return{className:"GroupLayer"}})}function v(a){return a.load().then(function(){return a.fetchData()}).then(function(a){if(a&&Array.isArray(a.layers)){if(e.isMapNotesLayer(a))return{className:"MapNotesLayer"};
if(1===a.layers.length)return{className:"FeatureLayer"}}return{className:"GroupLayer"}})}function x(a){return y(a).then(function(c){var b=new f(a.typeKeywords);return c?b.find(function(a){return"elevation 3d layer"===a.toLowerCase()})?{className:"ElevationLayer"}:{className:"TileLayer"}:{className:"ImageryLayer"}})}function y(a){return w(a.url).then(function(a){return a.tileInfo})}function n(a){return!a.url||a.url.match(/\/\d+$/)?b.resolve({}):a.load().then(function(){return a.fetchData()}).then(function(c){return c&&
Array.isArray(c.layers)?1===c.layers.length?{id:c.layers[0].id}:!1:w(a.url).then(function(a){return a&&Array.isArray(a.layers)?1===a.layers.length?{id:a.layers[0].id}:!1:{}})})}function w(a){return k(a,{responseType:"json",callbackParamName:"callback",query:{f:"json"}}).then(function(a){return a.data})}Object.defineProperty(l,"__esModule",{value:!0});l.fromItem=function(a){return!a.portalItem||a.portalItem instanceof d||a.portalItem.constructor&&a.portalItem.constructor._meta||(a=h.mixin({},a,{portalItem:new d(a.portalItem)})),
a.portalItem.load().then(c).then(q).then(function(c){var e=h.mixin({portalItem:a.portalItem},c.properties);c=c.constructor;return"esri.layers.FeatureLayer"===c.declaredClass&&(e.returnZ=!0,e.outFields=["*"]),b.resolve(new c(e))})};l.selectLayerClassPath=c})},"esri/core/Collection":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper dojo/aspect ./accessorSupport/decorators ./accessorSupport/ensureType ./Accessor ./ArrayPool ./Evented ./ObjectPool ./Scheduler ./lang".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){function r(a){return a&&a.isInstanceOf&&a.isInstanceOf(G)?!0:!1}function u(a){return a?r(a)?a.toArray():a.length?Array.prototype.slice.apply(a):[]:[]}function v(a){return a&&a.length?a[0]:void 0}function x(a,c,b,e){c&&c.forEach(function(c,n,f){a.push(c);x(a,b.call(e,c,n,f),b,e)})}m=function(){function a(){this.target=null;this.defaultPrevented=this.cancellable=!1}return a.prototype.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)},a.prototype.reset=
function(a){this.defaultPrevented=!1;this.item=a},a}();var y=function(){},n=new c(m,!0,function(a){a.item=null;a.target=null}),w=new Set,z=new Set,C=new Set,B=new Map,F=0,G=function(c){function e(a){a=c.call(this,a)||this;return a._boundDispatch=a._dispatchColChange.bind(a),a._chgListeners=[],a._notifications=null,a._timer=null,a.length=0,a._items=[],Object.defineProperty(a,"uid",{value:F++}),a}return h(e,c),f=e,e.ofType=function(a){if(!a)return f;if(B.has(a))return B.get(a);var c;if("function"==
typeof a)c=a.prototype.declaredClass;else if(a.base)c=a.base.prototype.declaredClass;else for(var b in a.typeMap){var e=a.typeMap[b].prototype.declaredClass;c?c+=" | "+e:c=e}c=f.createSubclass({declaredClass:"esri.core.Collection\x3c"+c+"\x3e"});b={Type:a,ensureType:"function"==typeof a?k.ensureType(a):k.ensureOneOfType(a)};return Object.defineProperty(c.prototype,"itemType",{value:b}),B.set(a,c),c},e.prototype.normalizeCtorArgs=function(a){return a?Array.isArray(a)||r(a)?{items:a}:a:{}},Object.defineProperty(e.prototype,
"items",{get:function(){return this._items},set:function(a){this._emitBeforeChanges()||(this._splice.apply(this,[0,this.length].concat(u(a))),this._emitAfterChanges())},enumerable:!0,configurable:!0}),e.prototype.on=function(a,c){var e;if(Array.isArray(a)?e=a:-1<a.indexOf(",")&&(e=a.split(/\s*,\s*/)),e){var n=[];for(a=0;a<e.length;a++)n.push(this.on(e[a],c));return n.remove=function(){for(var a=0;a<n.length;a++)n[a].remove()},n}if("change"===a){var f=this._chgListeners,d={removed:!1,callback:c};return f.push(d),
this._notifications&&this._notifications.push({listeners:f.slice(),items:this._items.slice(),changes:[]}),{remove:function(){this.remove=y;d.removed=!0;f.splice(f.indexOf(d),1)}}}return b.after(this,"on"+a,c,!0)},e.prototype.hasEventListener=function(a){return"change"===a?0<this._chgListeners.length:this.inherited(arguments)},e.prototype.add=function(a,c){if(this._emitBeforeChanges())return this;c=this.getNextIndex(c);return this._splice(c,0,a),this._emitAfterChanges(),this},e.prototype.addMany=function(a,
c){if(void 0===c&&(c=this._items.length),this._emitBeforeChanges())return this;c=this.getNextIndex(c);return this._splice.apply(this,[c,0].concat(u(a))),this._emitAfterChanges(),this},e.prototype.removeAll=function(){if(!this.length||this._emitBeforeChanges())return[];var a=this._splice(0,this.length)||[];return this._emitAfterChanges(),a},e.prototype.clone=function(){return this._createNewInstance({items:this._items.map(t.clone)})},e.prototype.concat=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=
arguments[c];a=a.map(u);return this._createNewInstance({items:(b=this._items).concat.apply(b,a)});var b},e.prototype.drain=function(a,c){if(this.length&&!this._emitBeforeChanges()){for(var b=this._splice(0,this.length),e=b.length,n=0;e>n;n++)a.call(c,b[n],n,b);this._emitAfterChanges()}},e.prototype.every=function(a,c){return this._items.every(a,c)},e.prototype.filter=function(a,c){var b;return b=2===arguments.length?this._items.filter(a,c):this._items.filter(a),this._createNewInstance({items:b})},
e.prototype.find=function(a,c){if("function"!=typeof a)throw new TypeError(a+" is not a function");for(var b=this._items,e=b.length,n=0;e>n;n++){var f=b[n];if(a.call(c,f,n,b))return f}},e.prototype.findIndex=function(a,c){if("function"!=typeof a)throw new TypeError(a+" is not a function");for(var b=this._items,e=b.length,n=0;e>n;n++)if(a.call(c,b[n],n,b))return n;return-1},e.prototype.flatten=function(a,c){var b=[];return x(b,this,a,c),new f(b)},e.prototype.forEach=function(a,c){for(var b=this._items,
e=b.length,n=0;e>n;n++)a.call(c,b[n],n,b)},e.prototype.getItemAt=function(a){return this._items[a]},e.prototype.getNextIndex=function(a){var c=this.length;return a=null==a?c:a,0>a?a=0:a>c&&(a=c),a},e.prototype.includes=function(a,c){return void 0===c&&(c=0),arguments.length?-1!==this._items.indexOf(a,c):!1},e.prototype.indexOf=function(a,c){return void 0===c&&(c=0),this._items.indexOf(a,c)},e.prototype.join=function(a){return void 0===a&&(a=","),this._items.join(a)},e.prototype.lastIndexOf=function(a,
c){return void 0===c&&(c=this.length-1),this._items.lastIndexOf(a,c)},e.prototype.map=function(a,c){a=this._items.map(a,c);return new f({items:a})},e.prototype.reorder=function(a,c){void 0===c&&(c=this.length-1);var b=this.indexOf(a);if(-1!==b){if(0>c?c=0:c>=this.length&&(c=this.length-1),b!==c){if(this._emitBeforeChanges())return a;this._splice(b,1);this._splice(c,0,a);this._emitAfterChanges()}return a}},e.prototype.pop=function(){if(this.length&&!this._emitBeforeChanges()){var a=v(this._splice(this.length-
1,1));return this._emitAfterChanges(),a}},e.prototype.push=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return this._emitBeforeChanges()?this.length:(this._splice.apply(this,[this.length,0].concat(a)),this._emitAfterChanges(),this.length)},e.prototype.reduce=function(a,c){var b=this._items;return 2===arguments.length?b.reduce(a,c):b.reduce(a)},e.prototype.reduceRight=function(a,c){var b=this._items;return 2===arguments.length?b.reduceRight(a,c):b.reduceRight(a)},e.prototype.remove=
function(a){return this.removeAt(this.indexOf(a))},e.prototype.removeAt=function(a){if(!(0>a||a>=this.length||this._emitBeforeChanges()))return a=v(this._splice(a,1)),this._emitAfterChanges(),a},e.prototype.removeMany=function(a){if(!a||!a.length||this._emitBeforeChanges())return[];a=r(a)?a.toArray():a;for(var c=this._items,b=[],e=a.length,n=0;e>n;n++){var f=c.indexOf(a[n]);if(-1<f){for(var d=n+1,g=f+1,E=Math.min(a.length-d,c.length-g),p=0;E>p&&a[d+p]===c[g+p];)p++;d=1+p;(f=this._splice(f,d))&&0<
f.length&&b.push.apply(b,f);n+=d-1}}return this._emitAfterChanges(),b},e.prototype.reverse=function(){if(this._emitBeforeChanges())return this;var a=this._splice(0,this.length);return a&&(a.reverse(),this._splice.apply(this,[0,0].concat(a))),this._emitAfterChanges(),this},e.prototype.shift=function(){if(this.length&&!this._emitBeforeChanges()){var a=v(this._splice(0,1));return this._emitAfterChanges(),a}},e.prototype.slice=function(a,c){return void 0===a&&(a=0),void 0===c&&(c=this.length),this._createNewInstance({items:this._items.slice(a,
c)})},e.prototype.some=function(a,c){return this._items.some(a,c)},e.prototype.sort=function(a){if(!this.length||this._emitBeforeChanges())return this;var c=this._splice(0,this.length);return arguments.length?c.sort(a):c.sort(),this._splice.apply(this,[0,0].concat(c)),this},e.prototype.splice=function(a,c){for(var b=[],e=2;e<arguments.length;e++)b[e-2]=arguments[e];if(this._emitBeforeChanges())return[];b=this._splice.apply(this,[a,c].concat(b))||[];return this._emitAfterChanges(),b},e.prototype.toArray=
function(){return this._items.slice()},e.prototype.toJSON=function(){return this.toArray()},e.prototype.toLocaleString=function(){return this._items.toLocaleString()},e.prototype.toString=function(){return this._items.toString()},e.prototype.unshift=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return this._emitBeforeChanges()?this.length:(this._splice.apply(this,[0,0].concat(a)),this._emitAfterChanges(),this.length)},e.prototype._createNewInstance=function(a){return new this.constructor(a)},
e.prototype._splice=function(a,c){for(var b=this,e=[],f=2;f<arguments.length;f++)e[f-2]=arguments[f];var d,g,w,f=this._items,E=this.constructor.prototype.itemType;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=q.schedule(this._boundDispatch)),c){if(w=f.splice(a,c),this.hasEventListener("before-remove")){d=n.acquire();d.target=this;d.cancellable=
!0;for(var p=0,A=w.length;A>p;p++)g=w[p],d.reset(g),this.emit("before-remove",d),d.defaultPrevented&&(w.splice(p,1),f.splice(a,0,g),a+=1,--p,--A);n.release(d)}if(this.length=this._items.length,this.hasEventListener("after-remove")){d=n.acquire();d.target=this;d.cancellable=!1;A=w.length;for(p=0;A>p;p++)d.reset(w[p]),this.emit("after-remove",d);n.release(d)}this._notifyChangeEvent(null,w)}if(e&&e.length){if(E){d=[];for(g=0;g<e.length;g++)p=e[g],A=E.ensureType(p),null==A&&null!=p||d.push(A);e=d}if(this.hasEventListener("before-add")){var K=
n.acquire();K.target=this;K.cancellable=!0;e=e.filter(function(a){return K.reset(a),b.emit("before-add",K),!K.defaultPrevented});n.release(K)}if(f.splice.apply(f,[a,0].concat(e)),this.length=this._items.length,this.hasEventListener("after-add")){d=n.acquire();d.target=this;d.cancellable=!1;f=0;for(E=e;f<E.length;f++)g=E[f],d.reset(g),this.emit("after-add",d);n.release(d)}this._notifyChangeEvent(e,null)}return w},e.prototype._emitBeforeChanges=function(){var a=!1;if(this.hasEventListener("before-changes")){var c=
n.acquire();c.target=this;c.cancellable=!0;this.emit("before-changes",c);a=c.defaultPrevented;n.release(c)}return a},e.prototype._emitAfterChanges=function(){if(this.hasEventListener("after-changes")){var a=n.acquire();a.target=this;a.cancellable=!1;this.emit("after-changes",a);n.release(a)}},e.prototype._notifyChangeEvent=function(a,c){this.hasEventListener("change")&&this._notifications[this._notifications.length-1].changes.push({added:a,removed:c})},e.prototype._dispatchColChange=function(){if(this._timer&&
(this._timer.remove(),this._timer=null),this._notifications){var c=this._notifications;this._notifications=null;for(var b=function(c){var b=c.changes;w.clear();z.clear();C.clear();for(var n=0;n<b.length;n++){var f=b[n],d=f.added,f=f.removed;if(d)if(0===C.size&&0===z.size)for(var p=0,A=d;p<A.length;p++)d=A[p],w.add(d);else for(p=0,A=d;p<A.length;p++)d=A[p],z.has(d)?(C.add(d),z["delete"](d)):C.has(d)||w.add(d);if(f)if(0===C.size&&0===w.size)for(p=0;p<f.length;p++)d=f[p],z.add(d);else for(p=0;p<f.length;p++)d=
f[p],w.has(d)?w["delete"](d):(C["delete"](d),z.add(d))}var g=a.acquire();w.forEach(function(a){g.push(a)});var k=a.acquire();z.forEach(function(a){k.push(a)});var q=e._items,h=c.items,r=a.acquire();if(C.forEach(function(a){h.indexOf(a)!==q.indexOf(a)&&r.push(a)}),c.listeners&&(g.length||k.length||r.length))for(b={target:e,added:g,removed:k,moved:r},n=c.listeners.length,d=0;n>d;d++)f=c.listeners[d],f.removed||f.callback.call(e,b);a.release(g);a.release(k);a.release(r)},e=this,n=0;n<c.length;n++)b(c[n]);
w.clear();z.clear();C.clear()}},e.isCollection=r,d([g.property()],e.prototype,"length",void 0),d([g.property()],e.prototype,"items",null),e=f=d([g.subclass("esri.core.Collection")],e);var f}(g.declared(f,e));return G})},"esri/core/Evented":function(){define(["./declare","dojo/Evented"],function(m,l){return m(l,{declaredClass:"esri.core.Evented",hasEventListener:function(h){return h="on"+h,!(!this[h]||!this[h].after)},emit:function(h,d){return this.hasEventListener(h)?(d=d||{},d.target||(d.target=
this),this.inherited(arguments,[h,d])):void 0}})})},"esri/portal/support/mapNotesUtils":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.isMapNotesLayer=function(h){var d=["TITLE","DESCRIPTION","IMAGE_URL","IMAGE_LINK_URL"];if((h=h.layers||h.featureCollection&&h.featureCollection.layers)&&Array.isArray(h))return h=h[0],h.layerDefinition.fields&&h.layerDefinition.fields.forEach(function(b){b=d.indexOf(b.name);-1<b&&d.splice(b,1)}),d.length?!1:
!0}})},"esri/layers/Layer":function(){define("require dojo/Deferred ../core/Accessor ../core/Error ../core/Evented ../core/Identifiable ../core/Loadable ../core/urlUtils ../core/requireUtils ../core/promiseUtils ../core/Logger ../config ../kernel ../request ../geometry/SpatialReference ../geometry/Extent".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){var x=0,y=c.getLogger("esri.layers.Layer");h=h.createSubclass([b,g,k],{declaredClass:"esri.layers.Layer",properties:{attributionDataUrl:null,
credential:{value:null,readOnly:!0,dependsOn:["loaded","parsedUrl"],get:function(){var a=this.loaded&&this.parsedUrl&&t.id&&t.id.findCredential(this.parsedUrl.path)||null;return a&&a.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),a}},fullExtent:new v(-180,-90,180,90,u.WGS84),hasAttributionData:{readOnly:!0,dependsOn:["attributionDataUrl"],get:function(){return null!=this.attributionDataUrl}},id:{get:function(){return Date.now().toString(16)+"-layer-"+x++}},legendEnabled:!0,listMode:"show",opacity:{value:1,
type:Number,cast:function(a){return 0>a?0:1<a?1:a}},parsedUrl:{readOnly:!0,dependsOn:["url"],get:function(){var a=this._get("url");return a?f.urlToObject(a):null}},popupEnabled:!0,attributionVisible:!0,spatialReference:u.WGS84,title:null,token:{dependsOn:["credential.token"],get:function(){var a=this.get("parsedUrl.query.token"),c=this.get("credential.token");return a||c||null},set:function(a){a?this._override("token",a):this._clearOverride("token")}},type:{type:String,readOnly:!0,value:null,json:{read:!1}},
url:{value:null},visible:!0},initialize:function(){this.when()["catch"](function(a){c.getLogger(this.declaredClass).error("#load()","Failed to load layer (title: '"+this.title+"', id: '"+this.id+"')",a)}.bind(this))},createLayerView:function(c){var b=this.viewModulePaths[c.type];return b?a.when(m,b).then(function(a){return a["default"]&&(a=a["default"]),new a({layer:this,view:c})}.bind(this)):e.reject(new d("layerview:module-unavailable","No LayerView module available for layer '${layer.declaredClass}' and view type: '${view.type}'",
{view:c,layer:this}))},destroyLayerView:function(a){a.destroy()},fetchAttributionData:function(){var a;a=this.attributionDataUrl;this.hasAttributionData&&a?a=r(a,{query:{f:"json"},responseType:"json"}).then(function(a){return a.data}):(a=new l,a.reject(new d("layer:no-attribution-data","Layer does not have attribution data")),a=a.promise);return a},refresh:function(){this.emit("refresh")}});return h.fromArcGISServerUrl=function(c){"string"==typeof c&&(c={url:c});var b=a.when(m,"./support/arcgisLayers").then(function(a){return a.fromUrl(c)});
return b.otherwise(function(a){y.error("#fromArcGISServerUrl({ url: '"+c.url+"'})","Failed to create layer from arcgis server url",a)}),b},h.fromPortalItem=function(c){!c||c.portalItem||"object"!=typeof c||c.declaredClass&&"esri.portal.PortalItem"!==c.declaredClass||(c={portalItem:c});var b=a.when(m,"../portal/support/portalLayers").then(function(a){return a.fromItem(c)});return b.otherwise(function(a){var b=c&&c.portalItem;y.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+
(b&&b.portal&&b.portal.url||q.portalUrl)+"', id: '"+(b&&b.id||"unset")+"')",a)}),b},h})},"esri/core/Identifiable":function(){define(["./declare"],function(m){var l=0;return m(null,{constructor:function(){Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+l++})}})})},"esri/renderers/support/styleUtils":function(){define(["require","exports","../../core/promiseUtils","../../core/Warning"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});
l.loadStyleRenderer=function(b,g){var k=b&&b.getAtOrigin&&b.getAtOrigin("renderer",g.origin);return k&&"unique-value"===k.type&&k.styleOrigin?k.populateFromStyle().otherwise(function(f){g&&g.messages&&g.messages.push(new d("renderer:style-reference","Failed to create unique value renderer from style reference: "+f.message,{error:f,context:g}));b.clear("renderer",g.origin)}).then(function(){return null}):h.resolve(null)}})},"esri/views/3d/layers/VectorTileLayerView3D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper dojo/promise/all ../../../core/accessorSupport/decorators ../../../core/promiseUtils ../../../core/watchUtils ../../vectorTiles/SchemaHelper ../../vectorTiles/TileHandler ../../vectorTiles/renderers/Renderer ./TiledLayerView3D".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){return function(q){function r(a){return q.call(this)||this}return h(r,q),r.prototype.initialize=function(){var c,e=this,d=this._getTileInfoSupportError(this.layer.compatibleTileInfo256,this.layer.fullExtent);d?this.addResolvingPromise(k.reject(d)):c=f.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){var c=e.view.basemapTerrain.tilingScheme,b=c.pixelSize[0];e.schemeHelper=new a(b,e.view.spatialReference.isWGS84);b=256===b?e.layer.compatibleTileInfo256:
e.view.spatialReference.isWGS84?e.layer.compatibleTileInfo512:e.layer.tileInfo;if(c=e._getTileInfoCompatibilityError(b,c))throw c;e.tileInfo=b;e._updateMinMaxDataLevel()});var g,d=this._initializeTileHandler();this.tileHandler=d[0];this.renderer=d[1];this._tileHandlerPromise=g=d[2];this.watch("layer.currentStyleInfo",function(){var a,c,b;e._tileHandlerPromise.isFulfilled()||e._tileHandlerPromise.cancel("cancel");b=e._initializeTileHandler();a=b[0];c=b[1];b=b[2];e._tileHandlerPromise=g;b.then(function(){var b=
e.tileHandler;e.renderer=c;e.tileHandler=a;e.emit("data-changed");b.destroy()})});c=b([c,g]);this.addResolvingPromise(c)},r.prototype.destroy=function(){this.renderer=null;this.tileHandler.destroy();this.tileHandler=null},r.prototype._initializeTileHandler=function(){var a=new e(this.layer,function(){},1),b=new c,f=a.start();return f.then(function(){b.initialize(a.spriteMosaic,a.glyphMosaic,!1)}),[a,b,f]},d([g.property({aliasOf:"layer.fullExtent"})],r.prototype,"fullExtent",void 0),d([g.property()],
r.prototype,"layer",void 0),d([g.property()],r.prototype,"updatingPercentageValue",void 0),r=d([g.subclass("esri.views.3d.layers.VectorTileLayerView3D")],r)}(g.declared(q))})},"esri/core/watchUtils":function(){define(["require","exports","dojo/Deferred","dojo/promise/Promise"],function(m,l,h,d){function b(a,c){Array.isArray(a)?a.forEach(c):c(a)}function g(a,c,e,f,n){n=a.watch(c,function(c,b,n,d){f&&!f(c)||e.call(a,c,b,n,d)},n);return b(c,function(c){var b=a.get(c);f&&f(b)&&e.call(a,b,b,c,a)}),n}function k(a,
c,b,e,n){function f(){k&&(k.remove(),k=null)}var k,q=!1,r=new h(f),t=new d;return t.cancel=r.cancel,t.isCanceled=r.isCanceled,t.isFulfilled=r.isFulfilled,t.isRejected=r.isRejected,t.isResolved=r.isResolved,t.then=r.then,t.remove=f,Object.freeze(t),k=g(a,c,function(c,e,n,d){q=!0;f();b&&b.call(a,c,e,n,d);r.resolve({value:c,oldValue:e,propertyName:n,target:d})},e,n),q&&k.remove(),t}function f(a){return!!a}function a(a){return!a}function e(a){return!0===a}function c(a){return!1===a}function q(a){return void 0!==
a}function t(a){return void 0===a}function r(a,c,b,e){var n=Array.isArray(c)?c:-1<c.indexOf(",")?c.split(","):[c];c=a.watch(c,b,e);return n.forEach(function(c){c=c.trim();var e=a.get(c);b.call(a,e,e,c,a)}),c}Object.defineProperty(l,"__esModule",{value:!0});l.init=r;l.watch=function(a,c,b,e){return a.watch(c,b,e)};l.once=function(a,c,b,e){return k(a,c,b,null,e)};l.when=function(a,c,b,e){return g(a,c,b,f,e)};l.whenOnce=function(a,c,b,e){return k(a,c,b,f,e)};l.whenNot=function(c,b,e,f){return g(c,b,
e,a,f)};l.whenNotOnce=function(c,b,e,f){return k(c,b,e,a,f)};l.whenTrue=function(a,c,b,f){return g(a,c,b,e,f)};l.whenTrueOnce=function(a,c,b,f){return k(a,c,b,e,f)};l.whenFalse=function(a,b,e,f){return g(a,b,e,c,f)};l.whenFalseOnce=function(a,b,e,f){return k(a,b,e,c,f)};l.whenDefined=function(a,c,b,e){return g(a,c,b,q,e)};l.whenDefinedOnce=function(a,c,b,e){return k(a,c,b,q,e)};l.whenUndefined=function(a,c,b,e){return g(a,c,b,t,e)};l.whenUndefinedOnce=function(a,c,b,e){return k(a,c,b,t,e)};l.pausable=
function(a,c,b,e){var n=!1,f=a.watch(c,function(c,e,f,d){n||b.call(a,c,e,f,d)},e);return{remove:function(){f.remove()},pause:function(){n=!0},resume:function(){n=!1}}};l.on=function(a,c,b,e,n,f,d){function g(c){var e=w[c];e&&(f&&f(e.target,c,a,b),e.handle.remove(),delete w[c])}var w={},k=r(a,c,function(c,f,d){g(d);c&&"function"==typeof c.on&&(w[d]={handle:c.on(b,e),target:c},n&&n(c,d,a,b))},d);return{remove:function(){k.remove();for(var a in w)g(a)}}}})},"esri/views/vectorTiles/SchemaHelper":function(){define(["require",
"exports"],function(m,l){return function(){function h(d,b){this.lockedSchemaPixelSize=d;this.isWGS84=b}return h.prototype.getCompatibleLevelRowCol=function(d){var b=d[0],g=d[1];d=d[2];return this.isWGS84?(g>>=1,d>>=1):256===this.lockedSchemaPixelSize&&0<b&&(b--,g>>=1,d>>=1),[b,g,d]},h.prototype.getSchemaShift=function(d,b){var g=0,k=0;return(256===this.lockedSchemaPixelSize||this.isWGS84)&&(d[2]%2&&(g=2*b),d[1]%2&&(k=2*b)),[g,k]},h.prototype.adjustLevel=function(d){return this.isWGS84?d:256===this.lockedSchemaPixelSize?
0<d?d-1:0:d},h.create256x256CompatibleTileInfo=function(d){if(!d)return null;if(256===d.rows&&256===d.cols)return d;for(var b,g,k=d.format,f=d.compressionQuality,a=d.dpi,e=d.origin,c=d.spatialReference,q=4326===c.wkid,h=[],r=d.lods.length,u=0;r>u;u++){var v=d.lods[u];b=v.scale;g=q?v.resolution:2*v.resolution;h.push({level:v.level,scale:b,resolution:g})}return{rows:256,cols:256,dpi:a,format:k,compressionQuality:f,origin:e,spatialReference:c,lods:h}},h.create512x512CompatibleTileInfo=function(d){if(!d||
256===d.rows||256===d.cols)return null;for(var b,g,k=d.format,f=d.compressionQuality,a=d.dpi,e=d.origin,c=d.spatialReference,q=[],h=d.lods.length,r=0;h>r;r++){var u=d.lods[r];b=u.scale;g=.5*u.resolution;q.push({level:u.level,scale:b,resolution:g})}return{rows:512,cols:512,dpi:a,format:k,compressionQuality:f,origin:e,spatialReference:c,lods:q}},h}()})},"esri/views/vectorTiles/TileHandler":function(){define("require exports module dojo/Deferred dojo/promise/all dojo/has ../../core/workers ../../core/promiseUtils ../../core/requireUtils ../../core/LRUCache ../../request ../2d/tiling/TileKey ./TileIndex ./SpriteMosaic ./SpriteSource ./GlyphMosaic ./GlyphSource ./VectorTileDisplayObject ./GeometryUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n){var w=new e(10),z=new Map;return function(){function e(a,c,b,e,n){void 0===e&&(e=!1);this.devicePixelRatio=b;this.allowUpdates=e;this._tileIndex=this._connection=this._glyphMosaic=this._spriteMosaic=null;this._updateQueue=new Map;this._ongoingRequests=new Map;this._vectorTileLayer=a;this._styleRepository=a.styleRepository;this._requestUpdate=c}return e.prototype.destroy=function(){this.stop();this._vectorTileLayer=this._requestUpdate=this._styleRepository=
null;this._spriteMosaic&&(this._spriteMosaic.dispose(),this._spriteMosaic=null);this._glyphMosaic&&(this._glyphMosaic.dispose(),this._glyphMosaic=null)},Object.defineProperty(e.prototype,"initialized",{get:function(){return this._broadcastPromise&&this._broadcastPromise.isFulfilled()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spriteMosaic",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glyphMosaic",{get:function(){return this._glyphMosaic},
enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ongoingRequestCount",{get:function(){return this._ongoingRequests.size},enumerable:!0,configurable:!0}),e.prototype.start=function(){var c=this;this.stop();var e=this._styleRepository,n=new u(e.sprite,this.devicePixelRatio);n.devicePixelRatio=this.devicePixelRatio;var f=n.load().then(function(){c._spriteMosaic=new r(1024,1024,250);c._spriteMosaic.setSpriteSource(n);g("stable-symbol-rendering")&&c._spriteMosaic.preloadSpriteItems()}),
w=new x(e.glyphs);this._glyphMosaic=new v(1024,1024,w);var q=this._fetchTileMap(this._vectorTileLayer.tileIndexUrl),t=k.open(this,a.getAbsMid("./WorkerTileHandler",m,h)).then(function(a){c._connection=a}),z=new d(function(a){f.isFulfilled()||f.cancel();q.isFulfilled()||q.cancel();t.isFulfilled()||t.cancel()});return b([f,q,t]).then(function(a){b(c._connection.broadcast("setLayers",e.styleJSON)).then(function(){z.resolve()})}),this._broadcastPromise=z.promise,this._broadcastPromise},e.prototype.stop=
function(){this._broadcastPromise&&!this._broadcastPromise.isFulfilled()&&this._broadcastPromise.cancel();this._updateQueue.forEach(function(a){return a.cancel()});this._ongoingRequests.forEach(function(a){return a.cancel()});this._connection&&(this._connection.close(),this._connection=null)},e.prototype.updateTile=function(a,c){var b=this;if(!this.allowUpdates)return f.resolve(null);if(!this._broadcastPromise.isFulfilled()||!this._connection)return f.reject(Error("no connection"));c=Math.round(n.degToByte(c.state.rotation));
if(a.rotation===c)return f.resolve(null);var e,d=a.key;return this._updateQueue.has(d.id)&&(e=this._updateQueue.get(d.id),e.cancel("cancel")),a.rotation=c,e=this._connection.invoke("update",{key:a.id,rotation:c},[],{id:a.workerID}).then(function(c){return a.updateSymbolData(c),c}).always(function(){b._updateQueue["delete"](d.id)}),this._updateQueue.set(a.id,e),e},e.prototype.getVectorTileWithLRC=function(a,c,b,e){var n=this;void 0===e&&(e=0);a=new q(a,c,b,0);c=this.getRefKey(a);var f=new y(a,c,this._vectorTileLayer.tileInfo,
this._styleRepository,0);return this.getTileData(f.key,0).then(function(a){return f.setData(a.tileData,a.workerId,n._connection),f})},e.prototype.getTileData=function(a,c){var b=this;if(!this._broadcastPromise.isFulfilled()||!this._connection)return f.reject(Error("no connection"));var e=this._tileIndex?this._tileIndex.dataKey(a):a;if(!e)return f.reject(Error("no data"));c=Math.round(n.degToByte(c));return this._getTileData(this._connection,a,e,c).then(function(a){return a&&a.tileData?{tileData:a.tileData,
workerId:a.workerId,connection:b._connection}:f.reject("No data")})},e.prototype.getRefKey=function(a){return this._tileIndex?this._tileIndex.dataKey(a):a},e.prototype.fetchTileData=function(a){a=q.pool.acquire(a);var b=this._vectorTileLayer.getTileUrl(a.level,a.row,a.col);return q.pool.release(a),c(b,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){return{data:{protobuff:a.data},buffers:[a.data]}})},e.prototype.getSprites=function(a){return f.resolve({data:{spriteItems:this._spriteMosaic.getSpriteItems(a.sprites)}})},
e.prototype.getGlyphs=function(a){return this._glyphMosaic.getGlyphItems(a.tileID,a.font,a.codePoints).then(function(a){return{data:{glyphItems:a}}})},e.prototype.getStyleRepository=function(){return this._styleRepository},e.prototype.getTileIndex=function(){return this._tileIndex},e.prototype._getTileData=function(a,c,b,e){var n=this,d={id:null};return(a=this._ongoingRequests.get(c.id))?a:(a=this._connection.invoke("getTile",{key:c.id,refKey:b.id,rotation:e,cacheTile:this.allowUpdates},[],d).then(function(a){return n._ongoingRequests["delete"](c.id),
{tileData:a,workerId:d.id}}).otherwise(function(a){return n._ongoingRequests["delete"](c.id),n._connection.invoke("destructTileData",{key:c.id},[],d),f.reject(a)}),this._ongoingRequests.set(c.id,a),a)},e.prototype._fetchTileMap=function(a){var b=this;if(!a)return null;if(w.has(a))return this._tileIndex=w.use(a),f.resolve();if(z.has(a))return z.get(a);var e=c(a,{callbackParamName:"callback",responseType:"json"}).then(function(c){b._tileIndex=new t(c.data);z["delete"](a);w.insert(a,b._tileIndex)});
return z.set(a,e),e},e}()})},"esri/core/workers":function(){define(["require","exports","./workers/workers"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});for(var d in h)l.hasOwnProperty(d)||(l[d]=h[d])})},"esri/core/workers/workers":function(){define("require exports dojo/promise/all dojo/has ../promiseUtils ./Connection ./DedicatedConnection ./JobProxy".split(" "),function(m,l,h,d,b,g,k,f){function a(){if(z)return z;for(var a=[],c=function(c){var b=f.create(w,c).then(function(a){return x[c]=
a,a});a.push(b)},b=0;r>b;b++)c(b);return z=h(a).then(function(){return!0})}function e(){if(C)return C;for(var a=[],c=function(c){var b=r+c;c=f.create(w,b).then(function(a){return x[b]=a,a});a.push(c)},b=0;u>b;b++)c(b);return C=h(a).then(function(){return!0})}function c(a,c,b){var e=c.id;if(b)return x[c.workerId].openConnection(a,e);c=[];for(b=0;b<x.length;b++)c.push(x[b].openConnection(a,e));return h(c)}function q(a){var c=n++;a=new l.Connection(a,c);return w.set(c,a),a}function t(a){var c=n++,b=
r+v++;v%=u;a=new l.DedicatedConnection(a,c,b);return w.set(c,a),a}Object.defineProperty(l,"__esModule",{value:!0});l.Connection=g;l.DedicatedConnection=k;m=(navigator||{}).hardwareConcurrency||2;var r=d("esri-workers-debug")?1:Math.max(1,Math.ceil(m/2)),u=d("esri-workers-debug")?1:Math.max(1,Math.floor(m/2)),v=0,x=[],y=0,n=0,w=new Map;l.initialize=function(){a();e()};l.open=function(n,f,d){void 0===d&&(d=!1);return(d?e():a()).then(function(a){var e;return e=d?t(n):q(n),c(f,e,d).then(function(){return e}).otherwise(function(a){return b.reject(a)})})};
l.terminate=function(){for(var a=0;a<x.length;a++)x[a]&&x[a].terminate();x.length=0;w.clear()};l.closeConnection=function(a){if(a)if(w.has(a.id)&&w["delete"](a.id),a instanceof l.DedicatedConnection)x[a.workerId].closeConnection(a.id);else for(var c=0;r>c;c++)x[c]&&x[c].closeConnection(a.id)};l.invoke=function(a,c,b,e,n){var f=null;if(e&&(f=e.id),null===f)x.some(function(a,c){return r>c&&!a.hasOutgoingJobs()?(f=a.index,!0):!1})||(f=y=(y+1)%r);a=x[f].invoke(a,c,b,n);return e&&(e.id=f),a};l.broadcast=
function(a,c,b,e){for(var n=[],f=0;r>f;f++)n.push(x[f].invoke(a,c,b,e));return n};var z,C})},"esri/core/workers/Connection":function(){define(["require","exports","./workers"],function(m,l,h){return function(){function d(b,d){this.client=b;this.id=d}return d.prototype.invoke=function(b,d,k,f){return h.invoke(b,d,k,f,this.id)},d.prototype.broadcast=function(b,d,k){return h.broadcast(b,d,k,this.id)},d.prototype.close=function(){h.closeConnection(this)},d}()})},"esri/core/workers/DedicatedConnection":function(){define(["require",
"exports","./workers"],function(m,l,h){return function(){function d(b,d,k){this.client=b;this.id=d;this._targetWorker={id:k}}return Object.defineProperty(d.prototype,"workerId",{get:function(){return this._targetWorker.id},enumerable:!0,configurable:!0}),d.prototype.invoke=function(b,d,k){return h.invoke(b,d,k,this._targetWorker,this.id)},d.prototype.close=function(){h.closeConnection(this)},d}()})},"esri/core/workers/JobProxy":function(){define("require exports dojo/_base/kernel dojo/_base/lang dojo/Deferred ../../kernel ../../config ../../request ../Logger ../Error ../sniff ../urlUtils ./WorkerFallbackImpl".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){function r(){if(!c("esri-workers"))return u(new t);if(!w){var a=void 0;try{a=new Worker(x)}catch(B){v.warn("Failed to create Worker. Fallback to execute module in main thread",event),a=new t}return u(a)}return z||(z=f(x,{responseType:"text"})),z.then(function(a){return new Worker(URL.createObjectURL(new Blob([a.data],{type:"text/javascript"})))}).otherwise(function(a){return v.warn("Failed to create Worker. Fallback to execute module in main thread",a),new t}).then(function(a){return u(a)})}
function u(a){function c(b){if(b&&b.data&&b.data.type)if(b=b.data.type,"\x3cworker-loaded\x3e"===b){b=a;var g;null!=k["default"]?(g=d.mixin({},k),delete g["default"],g=JSON.parse(JSON.stringify(g))):g=JSON.parse(JSON.stringify(k));var w={async:!0,baseUrl:n,locale:h.locale,has:{},paths:{}};d.mixin(w,k.workers.loaderConfig);w.has=d.mixin({"esri-cors":1,"dojo-test-sniff":0,"config-deferredInstrumentation":0,"host-webworker":1,"events-keypress-typed":0},w.has);w.paths=d.mixin({esri:"../esri",dojo:"../dojo",
dojox:"../dojox",dstore:"../dstore",moment:"../moment"},w.paths);b.postMessage({type:"\x3cconfigure\x3e",configure:{esriConfig:g,dojoConfig:w,loaderUrl:y}})}else"\x3cworker-configured\x3e"===b&&(a.removeEventListener("message",c),a.removeEventListener("error",e),f.resolve(a))}function e(b){b.preventDefault();a.removeEventListener("message",c);a.removeEventListener("error",e);v.warn("Failed to create Worker. Fallback to execute module in main thread",b);a=new t;a.addEventListener("message",c);a.addEventListener("error",
e)}var f=new b;return a.addEventListener("message",c),a.addEventListener("error",e),f.promise}var v=a.getLogger("esri.core.workers.JobProxy"),x=q.normalize(m.toUrl("./worker.js")),y=q.makeAbsolute(m.toUrl("dojo/dojo.js")),n=q.makeAbsolute("../",y)+"/",w=!q.hasSameOrigin(x,location.href),z=null;return function(){function a(a,c,b){this.connections=a;this.index=c;this.worker=b;this.msgCount=0;this.outgoingJobs=new Map;this.incomingJobs=new Map;this.incomingStaticJobs=new Map;this.worker.addEventListener("message",
this.message.bind(this));this.worker.addEventListener("error",function(a){a.preventDefault();v.error(a)})}return a.create=function(c,b){return r().then(function(e){return new a(c,b,e)})},a.prototype.terminate=function(){this.worker.terminate()},a.prototype.openConnection=function(a,c){return this.invoke("\x3copen-connection\x3e",{path:a},void 0,c)},a.prototype.closeConnection=function(a){this.invoke("\x3cclose-connection\x3e",void 0,void 0,a)},a.prototype.hasOutgoingJobs=function(){return 0<this.outgoingJobs.size},
a.prototype.invoke=function(a,c,e,n){var f=this,d=++this.msgCount,g=new b(function(a){f.worker.postMessage({type:"\x3ccancel\x3e",id:d,connection:n,data:{reason:a}});f.outgoingJobs.has(d)&&f.outgoingJobs["delete"](d)});return this.outgoingJobs.set(d,g),this.worker.postMessage({type:a,id:d,connection:n,data:c},e),g.promise},a.prototype.message=function(a){var c=this;if(a&&a.data){var b=a.data.type;if(b){var n=a.data,f=a.data.id;if("\x3cresponse\x3e"===b&&f){if(a=this.outgoingJobs.get(f))this.outgoingJobs["delete"](f),
n.error?a.reject(e.fromJSON(JSON.parse(n.error))):a.resolve(n.data)}else if("\x3ccancel\x3e"===b&&f)a=this.incomingJobs.get(f),(a&&a.cancel(n.data.reason),n.staticMsg)&&(a=this.incomingStaticJobs.get(f))&&a.cancel(n.data.reason);else if("\x3cstatic-message\x3e"===b){var d=n.staticMsg;a=g.workerMessages[d];if(!a||"function"!=typeof a)return void this.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:d,id:f,error:d+" message type is not available on the kernel!"});n=a.call(this,n.data);this.incomingStaticJobs.set(f,
n);n.then(function(a){c.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:d,id:f,data:a.data},a.buffers)}).otherwise(function(a){a||(a={message:"Error encountered at method"+d});a.dojoType&&"cancel"===a.dojoType||c.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:d,id:f,error:JSON.stringify(a)})}).always(function(){c.incomingStaticJobs["delete"](f)})}else{var w=n.connection;if(a=this.connections.get(w))if(a=a.client){var k=a[b];"function"==typeof k&&(n=k.call(a,n.data),this.incomingJobs.set(f,
n),n.then(function(a){c.worker.postMessage({type:"\x3cresponse\x3e",id:f,connection:w,error:a.error&&JSON.stringify(a.error),data:a.data},a.buffers)}).otherwise(function(a){a||(a={message:"Error encountered at method"+b});a.dojoType&&"cancel"===a.dojoType||c.worker.postMessage({type:"\x3cresponse\x3e",id:f,connection:w,error:JSON.stringify(a)})}).always(function(){c.incomingJobs["delete"](f)}))}}}}},a}()})},"esri/core/workers/WorkerFallbackImpl":function(){define(["require","exports","../global"],
function(m,l,h){var d=function(){return function(){var b=this,f=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(a){b[a]=function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return f[a].apply(f,b)}})}}(),b=h.MutationObserver||h.WebKitMutationObserver,g=function(){var d;if(h.process&&h.process.nextTick)d=function(a){h.process.nextTick(a)};else if(h.Promise)d=function(a){h.Promise.resolve().then(a)};else if(b){var f=[],a=document.createElement("div");
(new b(function(){for(;0<f.length;)f.shift()()})).observe(a,{attributes:!0});d=function(b){f.push(b);a.setAttribute("queueStatus","1")}}return d}();return function(){function b(){this._dispatcher=new d;this._connections={};this._outgoingStaticMessages={};this._isInitialized=!1;this._workerPostMessage({type:"\x3cworker-loaded\x3e"})}return b.prototype.terminate=function(){this._connections={}},Object.defineProperty(b.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(b){this._onmessageHandler&&
this.removeEventListener("message",this._onmessageHandler);(this._onmessageHandler=b)&&this.addEventListener("message",b)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(b){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler);(this._onerrorHandler=b)&&this.addEventListener("error",b)},enumerable:!0,configurable:!0}),b.prototype.postMessage=function(b,a){var e=this;g(function(){e._workerMessageHandler(new MessageEvent("message",
{data:b}))})},b.prototype.dispatchEvent=function(b){return this._dispatcher.dispatchEvent(b)},b.prototype.addEventListener=function(b,a,e){this._dispatcher.addEventListener(b,a,e)},b.prototype.removeEventListener=function(b,a,e){this._dispatcher.removeEventListener(b,a,e)},b.prototype._workerPostMessage=function(b,a){var e=this;g(function(){e.dispatchEvent(new MessageEvent("message",{data:b}))})},b.prototype._workerMessageHandler=function(b){var a=this,e=b.data;if(e){var c=e.connection,f=e.type;if("\x3cconfigure\x3e"===
f)this._isInitialized||this._workerPostMessage({type:"\x3cworker-configured\x3e"});else if("\x3copen-connection\x3e"===f){b=e.data.path;var d=e.id;if(this._connections[c])return void this._workerPostMessage({type:"\x3cresponse\x3e",id:d,connection:c});m(["./WorkerConnection",b],function(b,e){a._connections[c]=new b(e,{postMessage:function(c,b){return a._workerPostMessage(c,b)}},c);a._workerPostMessage({type:"\x3cresponse\x3e",id:d,data:{connection:c},error:void 0})})}else"\x3cclose-connection\x3e"===
f?this._connections[c]&&delete this._connections[c]:"\x3cstatic-message\x3e"===f?(b=e.id,this._outgoingStaticMessages[b]&&(f=this._outgoingStaticMessages[b],delete this._outgoingStaticMessages[b],e.error?f.reject(e.error):f.resolve(e.data))):f&&(e=this._connections[c])&&e.proxy.message(b)}},b}()})},"esri/core/LRUCache":function(){define(["require","exports"],function(m,l){return function(){function h(d){if(this._cache={},this._lruQueue=[],0>=d)throw Error("LRU cache size must be bigger than zero!");
this._maxSize=d}return h.prototype.has=function(d){return void 0!==this._cache[d]},h.prototype.insert=function(d,b){return null!==this.use(d)?void(this._cache[d]=b):(this._collect(),this._cache[d]=b,void this._lruQueue.unshift(d))},h.prototype.use=function(d){var b=this._cache[d];return b?(this._lruQueue.splice(this._lruQueue.indexOf(d),1),this._lruQueue.unshift(d),b):null},h.prototype.print=function(){for(var d=0,b=this._lruQueue;d<b.length;d++){var g=b[d];console.log("key: "+g+", value: "+this._cache[g])}},
h.prototype._collect=function(){if(!(this._lruQueue.length<this._maxSize)){var d=this._lruQueue.pop(),b=this._cache[d];b&&b.release&&b.release();delete this._cache[d]}},h}()})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(m,l,h){return function(){function d(b,d,k,f){"string"==typeof b?(b=b.split("/"),d=b[1],k=b[2],f=b[3],this.level=+b[0],this.row=+d,this.col=+k,this.world=+f||0):b&&"object"==typeof b?(this.level=b.level||0,this.row=b.row||
0,this.col=b.col||0,this.world=b.world||0):(this.level=+b||0,this.row=+d||0,this.col=+k||0,this.world=+f||0)}return d.from=function(b,g,k,f){return d.pool.acquire(b,g,k,f)},d.getId=function(b,d,k,f){return"object"==typeof b?b.level+"/"+b.row+"/"+b.col+"/"+b.world:b+"/"+d+"/"+k+"/"+f},Object.defineProperty(d.prototype,"id",{get:function(){return d.getId(this)},enumerable:!0,configurable:!0}),d.prototype.equals=function(b){return this.level===b.level&&this.row===b.row&&this.col===b.col&&this.world===
b.world},d.prototype.release=function(){this.world=this.col=this.row=this.level=0},d.prototype.set=function(b,d,k,f){var a=typeof b;"object"===a?(this.level=b.level||0,this.row=b.row||0,this.col=b.col||0,this.world=b.world||0):"string"===a?(b=b.split("/"),d=b[1],k=b[2],f=b[3],this.level=parseFloat(b[0]),this.row=parseFloat(d),this.col=parseFloat(k),this.world=parseFloat(f)):(this.level=b,this.row=d,this.col=k,this.world=f);return this},d.prototype.toString=function(){return this.level+"/"+this.row+
"/"+this.col+"/"+this.world},d.pool=new h(d,!0,null,25,50),d}()})},"esri/views/vectorTiles/TileIndex":function(){define(["require","exports","../2d/tiling/TileKey"],function(m,l,h){return function(){function d(b){if(!("index"in b))throw Error("The tilemap is missing the 'index' property.");this._tilemap=b.index}return d.prototype.dataKey=function(b){var d=[b];if(0>b.level||0>b.row||0>b.col||0<b.row>>b.level||0<b.col>>b.level)return null;for(;0!==b.level;)b=new h(b.level-1,b.row>>1,b.col>>1,b.world),
d.push(b);var k,f=this._tilemap,a=d.pop();if(1===f)return a;for(;d.length;){b=d.pop();k=a.level+1;var e=2*a.row,c=2*a.col;if(k=[h.getId(k,e,c,b.world),h.getId(k,e,c+1,b.world),h.getId(k,e+1,c,b.world),h.getId(k,e+1,c+1,b.world)].indexOf(b.id),f){if(0===f[k]){a=null;break}if(1===f[k]){a=b;break}a=b;f=f[k]}}return a},d.prototype.forEach=function(b,d,k,f,a){this._callback=a;this._maxLevel=d+b;this._forEach(this._tilemap,d,k,f)},d.prototype._forEach=function(b,d,k,f){0!==b&&(this._callback(d,k,f),d!==
this._maxLevel&&"object"==typeof b&&(this._forEach(b[0],d+1,2*k,2*f),this._forEach(b[1],d+1,2*k,2*f+1),this._forEach(b[2],d+1,2*k+1,2*f),this._forEach(b[3],d+1,2*k+1,2*f+1)))},d}()})},"esri/views/vectorTiles/SpriteMosaic":function(){define("require exports ../webgl/Texture ../2d/engine/webgl/Geometry ./Rect ./GeometryUtils ./RectangleBinPack".split(" "),function(m,l,h,d,b,g,k){function f(a){return a-Math.floor(a)}function a(a,b,d){a=0>a?0:.9999991<a?.9999991:a;var g=f(a*e[0]),k=f(a*e[1]),q=f(a*e[2]);
a=f(a*e[3]);b[d+0]=256*(g-g*c[0]);b[d+1]=256*(k-g*c[1]);b[d+2]=256*(q-k*c[2]);b[d+3]=256*(a-q*c[3])}var e=[16777216,65536,256,1],c=[0,1/256,1/256,1/256];return function(){function c(a,c,b){void 0===b&&(b=0);this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects={};this.pixelRatio=1;(0>=a||0>=c)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=
a;this._pageHeight=c;0<b&&(this._maxItemSize=b);this._binPack=new k(a-4,c-4)}return c.prototype.getWidth=function(a){return a>=this._size.length?-1:this._size[a][0]},c.prototype.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]},c.prototype.setSpriteSource=function(a){if(this.dispose(),this.pixelRatio=a.devicePixelRatio,0===this._mosaicsData.length){this._binPack=new k(this._pageWidth-4,this._pageHeight-4);var c=new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight));
this._mosaicsData[0]=c;this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}this._sprites=a},c.prototype.getSpriteItem=function(a,c){void 0===c&&(c=!1);var b=this._mosaicRects[a];if(b)return b;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;var e=this._sprites.getSpriteInfo(a);if(!e||!e.width||!e.height||0>e.width||0>e.height)return null;var f,d=e.width,n=e.height,g=1;if(e.cim){g=this._buildSDF(e.cim);f=g[0];var k=g[1],q=g[2],h=
g[3],r=g[4],g=g[5];if(!f||0>=h||0>=r)return null;var t=this._allocateImage(k,q),r=t[0],h=t[1],t=t[2];if(0>=r.width)return null;(e.cim||e.sdf)&&this._clearRect(r,h,t,1);this._copy(r,{width:k,height:q,x:0,y:0},h,t,c,f);r.x+=4;r.y+=4;r.width-=8;r.height-=8;c=r;f=h;g*=.75;g=q/n;e.sdf=!0}else{q=this._allocateImage(d,n);r=q[0];h=q[1];t=q[2];if(0>=r.width)return null;this._copy(r,e,h,t,c);c=r;f=h}return b={rect:c,width:d,height:n,sdf:e.sdf,pixelRatio:e.pixelRatio,page:f,sdfRatio:g},this._mosaicRects[a]=
b,b},c.prototype.preloadSpriteItems=function(){for(var a=0,c=this._sprites.spriteNames;a<c.length;a++)this.getSpriteItem(c[a],!0)},c.prototype.getSpriteItems=function(a){for(var c={},b=0;b<a.length;b++){var e=a[b];c[e]=this.getSpriteItem(e)}return c},c.prototype.getMosaicItemPosition=function(a,c){c=(a=this.getSpriteItem(a,c))&&a.rect;if(!c)return null;c.width=a.width;c.height=a.height;return{size:[a.width,a.height],tl:[(c.x+2)/this._size[a.page][0],(c.y+2)/this._size[a.page][1]],br:[(c.x+2+a.width)/
this._size[a.page][0],(c.y+2+a.height)/this._size[a.page][1]],page:a.page}},c.prototype.bind=function(a,c,b,e){void 0===b&&(b=0);void 0===e&&(e=0);this._textures[b]||(this._textures[b]=new h(a,{pixelFormat:6408,dataType:5121,width:this._size[b][0],height:this._size[b][1]},new Uint8Array(this._mosaicsData[b].buffer)));var f=this._textures[b];f.setSamplingMode(c);this._dirties[b]&&f.setData(new Uint8Array(this._mosaicsData[b].buffer));a.bindTexture(f,e);this._dirties[b]=!1},c._copyBits=function(a,c,
b,e,f,d,n,g,k,q,h){var w=e*c+b;n=g*d+n;if(h)for(n-=d,h=-1;q>=h;h++,w=((h+q)%q+e)*c+b,n+=d)for(g=-1;k>=g;g++)f[n+g]=a[w+(g+k)%k];else for(h=0;q>h;h++){for(g=0;k>g;g++)f[n+g]=a[w+g];w+=c;n+=d}},c.prototype._copy=function(a,b,e,f,d,g){if(this._sprites&&"loaded"===this._sprites.loadStatus&&!(e>=this._mosaicsData.length)){var n=new Uint32Array(g?g.buffer:this._sprites.image.buffer),w=this._mosaicsData[e];w&&n||console.error("Source or target images are uninitialized!");c._copyBits(n,g?b.width:this._sprites.width,
b.x,b.y,w,f[0],a.x+2,a.y+2,b.width,b.height,d);this._dirties[e]=!0}},c.prototype._allocateImage=function(a,c){a+=2;c+=2;var e=Math.max(a,c);if(this._maxItemSize&&this._maxItemSize<e){var e=Math.pow(2,Math.ceil(g.log2(a))),f=Math.pow(2,Math.ceil(g.log2(c)));a=new b(0,0,a,c);return this._mosaicsData.push(new Uint32Array(e*f)),this._dirties.push(!0),this._size.push([e,f]),this._textures.push(void 0),[a,this._mosaicsData.length-1,[e,f]]}e=a%4?4-a%4:4;f=c%4?4-c%4:4;1===e&&(e=5);1===f&&(f=5);e=this._binPack.allocate(a+
e,c+f);return 0>=e.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new k(this._pageWidth-4,this._pageHeight-4),this._allocateImage(a,c)):[e,this._currentPage,[this._pageWidth,this._pageHeight]]},c.prototype._clearRect=function(c,b,
e,f){(b=this._mosaicsData[b])||console.error("Source image is uninitialized!");var d=[0,0,0,0];a(f,d,0);f=255&d[0]|(255&d[1])<<8|(255&d[2])<<16|d[3]<<24;e=e[0];var d=c.y*e+c.x,g=c.width;c=c.height;for(var n=0;c>n;n++){for(var w=0;g>w;w++)b[d+w]=f;d+=e}},c.prototype.dispose=function(){this._binPack=null;this._mosaicRects={};for(var a=0,c=this._textures;a<c.length;a++){var b=c[a];b&&b.dispose()}this._textures.length=0},c.prototype._extractGeometry=function(a){if(!a)return null;a=a.symbolLayers;if(!a||
1!==a.length)return null;a=a[0];if(!a)return null;a=a.markerGraphics;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;var c=a.geometry;if(!c||!c.rings)return null;a=[];for(var b=0,c=c.rings;b<c.length;b++){for(var e=[],f=0,g=c[b];f<g.length;f++){var n=g[f];e.push(new d.Point(n[0],n[1]))}a.push(e)}return a},c.prototype._getEnvelope=function(a){for(var c=1/0,e=-(1/0),f=1/0,d=-(1/0),g=0;g<a.length;g++)for(var n=0,w=a[g];n<w.length;n++){var k=w[n];k.x<c&&(c=k.x);k.x>e&&(e=k.x);k.y<f&&(f=k.y);
k.y>d&&(d=k.y)}return new b(c,f,e-c,d-f)},c.prototype._buildSDF=function(a){a=this._extractGeometry(a);if(!a)return null;var c=this._getEnvelope(a);if(0>=c.width||0>=c.height)return null;for(var b=86/Math.max(c.width,c.height),e=Math.round(c.width*b),f=Math.round(c.height*b),d=e+32,n=f+32,g=0;g<a.length;g++)for(var k=0,q=a[g];k<q.length;k++){var h=q[k];h.x-=c.x;h.y-=c.y;h.x*=b;h.y*=b;h.x+=15.5;h.y+=15.5}c=this._dist_map(a,d,n,16);return this._sign_dist_map(a,d,n,16,c),[this._encodeDistMap(c),d,n,
e,f,b]},c.prototype._dist_map=function(a,c,b,e){for(var f=c*b,d=new Float32Array(f),n=e*e+1,g=0;f>g;++g)d[g]=n;for(n=0;n<a.length;n++)for(var k=a[n],q=k.length,g=1;q>g;++g){var h=k[g-1],r=k[g],t=void 0,u=void 0;h.x<r.x?(t=h.x,u=r.x):(t=r.x,u=h.x);var v=void 0,l=void 0;h.y<r.y?(v=h.y,l=r.y):(v=r.y,l=h.y);var m=Math.floor(t)-e,u=Math.floor(u)+e,v=Math.floor(v)-e,l=Math.floor(l)+e;0>m&&(m=0);u>c&&(u=c);0>v&&(v=0);l>b&&(l=b);for(var t=r.x-h.x,Q=r.y-h.y,T=t*t+Q*Q;u>m;m++)for(var O=v;l>O;O++){var S=(m-
h.x)*t+(O-h.y)*Q,H=void 0,Y=void 0;0>S?(H=h.x,Y=h.y):S>T?(H=r.x,Y=r.y):(S/=T,H=h.x+S*t,Y=h.y+S*Q);S=(m-H)*(m-H)+(O-Y)*(O-Y);H=(b-O-1)*c+m;S<d[H]&&(d[H]=S)}}for(g=0;f>g;++g)d[g]=Math.sqrt(d[g]);return d},c.prototype._sign_dist_map=function(a,c,b,e,f){for(var d=0;d<a.length;d++)for(var n=a[d],g=n.length,k=1;g>k;++k){var q=n[k-1],h=n[k],r=void 0,t=void 0;q.x<h.x?(r=q.x,t=h.x):(r=h.x,t=q.x);var u=void 0,v=void 0;q.y<h.y?(u=q.y,v=h.y):(u=h.y,v=q.y);r=Math.floor(r);t=Math.floor(t)+1;u=Math.floor(u);v=Math.floor(v)+
1;e>r&&(r=e);t>c-e&&(t=c-e);e>u&&(u=e);for(v>b-e&&(v=b-e);v>u;++u)if(q.y>u!=h.y>u){for(var x=(b-u-1)*c,l=r;t>l;++l)l<(h.x-q.x)*(u-q.y)/(h.y-q.y)+q.x&&(f[x+l]=-f[x+l]);for(l=e;r>l;++l)f[x+l]=-f[x+l]}}},c.prototype._encodeDistMap=function(c){for(var b=c.length,e=new Uint8Array(4*b),f=0;b>f;++f)a(c[f]/16+.5,e,4*f);return e},c}()})},"esri/views/webgl/Texture":function(){define(["require","exports"],function(m,l){return function(){function h(d,b,g){this._glName=this._context=null;this._id=-1;this._desc=
void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=d;this._desc={pixelFormat:b.pixelFormat,internalFormat:b.internalFormat,dataType:b.dataType,target:b.target?b.target:3553,samplingMode:b.samplingMode?b.samplingMode:9729,wrapMode:b.wrapMode?b.wrapMode:10497,maxAnisotropy:b.maxAnisotropy,flipped:void 0!==b.flipped?b.flipped:!1,hasMipmap:void 0!==b.hasMipmap?b.hasMipmap:!1,level:void 0!==b.level?b.level:0,unpackAlignment:b.unpackAlignment?b.unpackAlignment:
4,width:b.width,height:b.height,preMultiplyAlpha:void 0!==b.preMultiplyAlpha?b.preMultiplyAlpha:!1};this._id=++h._nextId;this.setData(g)}return Object.defineProperty(h.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0}),h.prototype.dispose=function(){var d=
this;if(this._context){if(this._glName){var b=this._context.gl;this._boundToUnits.forEach(function(b){d._context.bindTexture(null,b)});b.deleteTexture(this._glName);this._glName=null}this._context=null}},h.prototype.resize=function(d,b){var g=this._desc;g.width===d&&g.height===b||(g.width=d,g.height=b,this.setData(null))},h.prototype.setData=function(d){var b=this._context.gl;this._glName||(this._glName=b.createTexture());void 0===d&&(d=null);null===d&&(this._desc.width=this._desc.width||4,this._desc.height=
this._desc.height||4);var g=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var k=this._desc;h._validateTexture(k);b.pixelStorei(b.UNPACK_ALIGNMENT,k.unpackAlignment);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,k.flipped?1:0);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.preMultiplyAlpha);d instanceof ImageData||d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof HTMLVideoElement?(k.width&&k.height&&console.assert(d.width===k.width&&d.height===k.height),b.texImage2D(b.TEXTURE_2D,
k.level,k.internalFormat?k.internalFormat:k.pixelFormat,k.pixelFormat,k.dataType,d),void 0===this._desc.width&&(this._desc.width=d.width),void 0===this._desc.height&&(this._desc.height=d.height)):((null==k.width||null==k.height)&&console.error("Width and height must be specified!"),b.texImage2D(b.TEXTURE_2D,k.level,k.internalFormat?k.internalFormat:k.pixelFormat,k.width,k.height,0,k.pixelFormat,k.dataType,d));k.hasMipmap&&this.generateMipmap();h._applySamplingMode(b,this._desc);h._applyWrapMode(b,
this._desc);h._applyAnisotropicFilteringParameters(this._context,this._desc);this._context.bindTexture(g,0)},h.prototype.updateData=function(d,b,g,k,f,a){a||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");var e=this._context.gl,c=this._desc,q=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>b||0>g||k>c.width||f>c.height||b+k>c.width||g+f>c.height)&&console.error("An attempt to update out of bounds of the texture!");
a instanceof ImageData||a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement?(console.assert(a.width===k&&a.height===f),e.texSubImage2D(e.TEXTURE_2D,d,b,g,c.pixelFormat,c.dataType,a)):e.texSubImage2D(e.TEXTURE_2D,d,b,g,k,f,c.pixelFormat,c.dataType,a);this._context.bindTexture(q,0)},h.prototype.generateMipmap=function(){var d=this._desc;d.hasMipmap||(d.hasMipmap=!0,h._validateTexture(d));9729===d.samplingMode?(this._samplingModeDirty=!0,d.samplingMode=9985):
9728===d.samplingMode&&(this._samplingModeDirty=!0,d.samplingMode=9984);d=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var b=this._context.gl;b.generateMipmap(b.TEXTURE_2D);this._context.bindTexture(d,0)},h.prototype.setSamplingMode=function(d){d!==this._desc.samplingMode&&(this._desc.samplingMode=d,h._validateTexture(this._desc),this._samplingModeDirty=!0)},h.prototype.setWrapMode=function(d){d!==this._desc.wrapMode&&(this._desc.wrapMode=d,h._validateTexture(this._desc),this._wrapModeDirty=
!0)},h.prototype.applyChanges=function(){var d=this._context.gl,b=this._desc;this._samplingModeDirty&&(h._applySamplingMode(d,b),this._samplingModeDirty=!1);this._wrapModeDirty&&(h._applyWrapMode(d,b),this._wrapModeDirty=!1)},h.prototype.setBoundToUnit=function(d,b){b?this._boundToUnits.add(d):this._boundToUnits["delete"](d)},h._isPowerOfTwo=function(d){return 0===(d&d-1)},h._validateTexture=function(d){(0>d.width||0>d.height)&&console.error("Negative dimension parameters are not allowed!");h._isPowerOfTwo(d.width)&&
h._isPowerOfTwo(d.height)||(33071!==d.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),d.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))},h._applySamplingMode=function(d,b){var g=b.samplingMode;9985===g||9987===g?g=9729:(9984===g||9986===g)&&(g=9728);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,g);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,b.samplingMode)},h._applyWrapMode=function(d,b){d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,
b.wrapMode);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,b.wrapMode)},h._applyAnisotropicFilteringParameters=function(d,b){if(null!=b.maxAnisotropy){var g=d.extensions.textureFilterAnisotropic;g&&(d=d.gl,d.texParameterf(d.TEXTURE_2D,g.TEXTURE_MAX_ANISOTROPY_EXT,b.maxAnisotropy))}},h._nextId=0,h}()})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function h(d,b){this.x=d;this.y=b}return h.prototype.clone=
function(){return new h(this.x,this.y)},h.prototype.equals=function(d,b){return d===this.x&&b===this.y},h.prototype.isEqual=function(d){return d.x===this.x&&d.y===this.y},h.prototype.setCoords=function(d,b){this.x=d;this.y=b},h.prototype.normalize=function(){var d=this.x,b=this.y,d=Math.sqrt(d*d+b*b);this.x/=d;this.y/=d},h.prototype.rightPerpendicular=function(){var d=this.x;this.x=this.y;this.y=-d},h.prototype.move=function(d,b){this.x+=d;this.y+=b},h.prototype.assign=function(d){this.x=d.x;this.y=
d.y},h.prototype.assignAdd=function(d,b){this.x=d.x+b.x;this.y=d.y+b.y},h.prototype.assignSub=function(d,b){this.x=d.x-b.x;this.y=d.y-b.y},h.prototype.rotate=function(d,b){var g=this.x,k=this.y;this.x=g*d-k*b;this.y=g*b+k*d},h.prototype.scale=function(d){this.x*=d;this.y*=d},h.prototype.length=function(){var d=this.x,b=this.y;return Math.sqrt(d*d+b*b)},h.distance=function(d,b){var g=b.x-d.x;d=b.y-d.y;return Math.sqrt(g*g+d*d)},h.add=function(d,b){return new h(d.x+b.x,d.y+b.y)},h.sub=function(d,b){return new h(d.x-
b.x,d.y-b.y)},h}();l.Point=m})},"esri/views/vectorTiles/Rect":function(){define(["require","exports"],function(m,l){return function(){function h(d,b,g,k){void 0===d&&(d=0);void 0===b&&(b=0);void 0===g&&(g=0);void 0===k&&(k=0);this.x=d;this.y=b;this.width=g;this.height=k}return Object.defineProperty(h.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0}),h}()})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(m,
l){function h(b,d){return b%=d,0<=b?b:b+d}Object.defineProperty(l,"__esModule",{value:!0});l.C_INFINITY=Number.POSITIVE_INFINITY;l.C_PI=Math.PI;l.C_2PI=2*l.C_PI;l.C_PI_BY_2=l.C_PI/2;l.C_RAD_TO_256=128/l.C_PI;l.C_256_TO_RAD=l.C_PI/128;l.C_DEG_TO_256=256/360;l.C_DEG_TO_RAD=l.C_PI/180;l.C_SQRT2=1.414213562;l.C_SQRT2_INV=1/l.C_SQRT2;var d=1/Math.LN2;l.positiveMod=h;l.radToByte=function(b){return h(b*l.C_RAD_TO_256,256)};l.degToByte=function(b){return h(b*l.C_DEG_TO_256,256)};l.log2=function(b){return Math.log(b)*
d};l.sqr=function(b){return b*b};l.clamp=function(b,d,k){return Math.min(Math.max(b,d),k)};l.interpolate=function(b,d,k){return b*(1-k)+d*k};l.between=function(b,d,k){return b>=d&&k>=b||b>=k&&d>=b}})},"esri/views/vectorTiles/RectangleBinPack":function(){define(["require","exports","./Rect"],function(m,l,h){return function(){function d(b,d){this._height=this._width=0;this._free=[];this._width=b;this._height=d;this._free.push(new h(0,0,b,d))}return Object.defineProperty(d.prototype,"width",{get:function(){return this._width},
enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),d.prototype.allocate=function(b,d){if(b>this._width||d>this._height)return new h;for(var g=null,f=-1,a=0;a<this._free.length;++a){var e=this._free[a];b<=e.width&&d<=e.height&&(null===g||e.y<=g.y&&e.x<=g.x)&&(g=e,f=a)}return null===g?new h:(this._free.splice(f,1),g.width<g.height?(g.width>b&&this._free.push(new h(g.x+b,g.y,g.width-b,d)),g.height>d&&this._free.push(new h(g.x,
g.y+d,g.width,g.height-d))):(g.width>b&&this._free.push(new h(g.x+b,g.y,g.width-b,g.height)),g.height>d&&this._free.push(new h(g.x,g.y+d,b,g.height-d))),new h(g.x,g.y,b,d))},d.prototype.release=function(b){for(var d=0;d<this._free.length;++d){var k=this._free[d];if(k.y===b.y&&k.height===b.height&&k.x+k.width===b.x)k.width+=b.width;else if(k.x===b.x&&k.width===b.width&&k.y+k.height===b.y)k.height+=b.height;else if(b.y===k.y&&b.height===k.height&&b.x+b.width===k.x)k.x=b.x,k.width+=b.width;else{if(b.x!==
k.x||b.width!==k.width||b.y+b.height!==k.y)continue;k.y=b.y;k.height+=b.height}this._free.splice(d,1);this.release(b)}this._free.push(b)},d}()})},"esri/views/vectorTiles/SpriteSource":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper dojo/Deferred ../../request ../../kernel ../../core/promiseUtils".split(" "),function(m,l,h,d,b,g,k,f){return function(){function a(a,c){this.baseURL=a;this.devicePixelRatio=c;this._isRetina=!1;this._spritesData=
{};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}return Object.defineProperty(a.prototype,"spriteNames",{get:function(){var a=[],c;for(c in this._spritesData)a.push(c);return a.sort(),a},enumerable:!0,configurable:!0}),a.prototype.getSpriteInfo=function(a){return this._spritesData[a]},a.prototype.load=function(){var a=this;return this.loadStatus="loading",this.baseURL?this._loadSprites().then(function(){return a.loadStatus="loaded",a}).otherwise(function(c){return a.loadStatus=
"failed",a}):f.resolve(this)},a.prototype._loadSprites=function(){var a=this;this._isRetina=1.15<this.devicePixelRatio?!0:!1;var c=this.baseURL,d=this._isRetina?"@2x":"";return g(c+d+".json",{callbackParamName:"callback",responseType:"json"}).then(function(e){var g=Object.keys(e.data);if(!g||0===g.length||1===g.length&&"_ssl"===g[0])return f.resolve(null);a._spritesData=e.data;var q=new b,h=new Image;h.crossOrigin="anonymous";h.onload=function(){h.onload=null;a.width=h.width;a.height=h.height;var c=
document.createElement("canvas");c.width=h.width;c.height=h.height;c=c.getContext("2d");c.drawImage(h,0,0,h.width,h.height);for(var c=c.getImageData(0,0,h.width,h.height),b=new Uint8Array(c.data),e=0;e<b.length;e+=4)c=b[e+3]/255,b[e]*=c,b[e+1]*=c,b[e+2]*=c;a.image=b;q.resolve()};e=""+c+d+".png";k.id&&(g=k.id.findCredential(e))&&g.token&&(e+="?token\x3d"+g.token);return h.src=e,q})},a}()})},"esri/views/vectorTiles/GlyphMosaic":function(){define("require exports dojo/has ../../core/promiseUtils ./Rect ../webgl/Texture ./RectangleBinPack".split(" "),
function(m,l,h,d,b,g,k){var f;h("stable-symbol-rendering")&&(f=new Set);return function(){function a(a,c,b){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;(0>=a||0>=c)&&console.error("Glyph mosaic width and height must be greater than zero!");this.width=a;this.height=c;this._glyphSource=b;this._binPack=new k(a-4,c-4);this._glyphData.push(new Uint8Array(a*c));this._dirties.push(!0);this._textures.push(void 0)}
return a.prototype.getGlyphItems=function(a,c,g){var e=this,q=[],u=this._glyphSource,v=new Set;a=1/256;for(var x=0;x<g.length;x++)v.add(Math.floor(g[x]*a));var y=[];return v.forEach(function(a){if(256>=a){var b=c+a;e._rangePromises.has(b)?y.push(e._rangePromises.get(b)):(a=u.getRange(c,a).always(function(){e._rangePromises["delete"](b)}),e._rangePromises.set(b,a),y.push(a))}}),d.all(y).then(function(a){(a=e._glyphIndex[c])||(a={},e._glyphIndex[c]=a);var n;if(h("stable-symbol-rendering")){f.clear();
for(var d=0;d<g.length;d++)n=g[d],f.add(n);var r=[];v.forEach(function(a){r.push(a)});r.sort();n=[];for(d=0;d<r.length;d++)for(var t=r[d],y=0;256>y;++y)n.push(256*t+y)}else n=g;d=0;for(t=n;d<t.length;d++)if(n=t[d],y=a[n])h("stable-symbol-rendering")&&!f.has(n)||(q[n]={rect:y.rect,metrics:y.metrics,page:y.page});else{var x=u.getGlyph(c,n);if(x&&x.metrics){var y=x.metrics,l=void 0;if(0===y.width)l=new b(0,0,0,0);else{var m=y.width+6,R=y.height+6,P=m%4?4-m%4:4,Q=R%4?4-R%4:4;1===P&&(P=5);1===Q&&(Q=5);
l=e._binPack.allocate(m+P,R+Q);l.isEmpty&&(e._dirties[e._currentPage]||(e._glyphData[e._currentPage]=null),e._currentPage=e._glyphData.length,e._glyphData.push(new Uint8Array(e.width*e.height)),e._dirties.push(!0),e._textures.push(void 0),e._binPack=new k(e.width-4,e.height-4),l=e._binPack.allocate(m+P,R+Q));var P=e._glyphData[e._currentPage],x=x.bitmap,T=Q=void 0;if(x)for(var O=0;R>O;O++)for(var Q=m*O,T=e.width*(l.y+O+1)+l.x,S=0;m>S;S++)P[T+S+1]=x[Q+S]}a[n]={rect:l,metrics:y,tileIDs:null,page:e._currentPage};
h("stable-symbol-rendering")&&!f.has(n)||(q[n]={rect:l,metrics:y,page:e._currentPage});e._dirties[e._currentPage]=!0}}return q})},a.prototype.removeGlyphs=function(a){for(var c in this._glyphIndex){var b=this._glyphIndex[c];if(b){var e=void 0,f;for(f in b)if(e=b[f],e.tileIDs["delete"](a),0===e.tileIDs.size){for(var d=this._glyphData[e.page],g=e.rect,k=void 0,h=void 0,n=0;n<g.height;n++)for(k=this.width*(g.y+n)+g.x,h=0;h<g.width;h++)d[k+h]=0;delete b[f];this._dirties[e.page]=!0}}}},a.prototype.bind=
function(a,c,b,f){void 0===f&&(f=0);this._textures[b]||(this._textures[b]=new g(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var e=this._textures[b];e.setSamplingMode(c);this._dirties[b]&&e.setData(this._glyphData[b]);a.bindTexture(e,f);this._dirties[b]=!1},a.prototype.dispose=function(){this._binPack=null;for(var a=0,c=this._textures;a<c.length;a++){var b=c[a];b&&b.dispose()}this._textures.length=0},a}()})},"esri/views/vectorTiles/GlyphSource":function(){define(["require",
"exports","../../core/promiseUtils","../../request","../../core/pbf"],function(m,l,h,d,b){var g=function(){function b(a){if(this._metrics=[],this._bitmaps=[],a)for(;a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var c=b.getMessage(),f=void 0,d=void 0,g=void 0,k=void 0,h=void 0,x=void 0,y=void 0;c.next();)switch(c.tag()){case 1:f=c.getUInt32();break;case 2:d=c.getBytes();break;case 3:g=c.getUInt32();break;case 4:k=c.getUInt32();break;case 5:h=c.getSInt32();
break;case 6:x=c.getSInt32();break;case 7:y=c.getUInt32();break;default:c.skip()}f&&(this._metrics[f]={width:g,height:k,left:h,top:x,advance:y},this._bitmaps[f]=d);break;default:b.skip()}break;default:a.skip()}}return b.prototype.getMetrics=function(a){return this._metrics[a]},b.prototype.getBitmap=function(a){return this._bitmaps[a]},b}(),k=function(){function b(){this._ranges=[]}return b.prototype.getRange=function(a){return this._ranges[a]},b.prototype.addRange=function(a,b){this._ranges[a]=b},
b}();return function(){function f(a){this._glyphInfo={};this._baseURL=a}return f.prototype.getRange=function(a,e){var c=this._getFontStack(a);if(c.getRange(e))return h.resolve();var f=256*e,k=f+255;a=this._baseURL.replace("{fontstack}",a).replace("{range}",f+"-"+k);return d(a,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){c.addRange(e,new g(new b(new Uint8Array(a.data),new DataView(a.data))))}).otherwise(function(){c.addRange(e,new g)})},f.prototype.getGlyph=function(a,
b){if(a=this._getFontStack(a)){var c=Math.floor(b/256);if(!(256<c)&&(a=a.getRange(c)))return{metrics:a.getMetrics(b),bitmap:a.getBitmap(b)}}},f.prototype._getFontStack=function(a){var b=this._glyphInfo[a];return b||(b=this._glyphInfo[a]=new k),b},f}()})},"esri/core/pbf":function(){define(["require","exports"],function(m,l){return function(){function h(d,b,g,k){this._tag=0;this._dataType=99;this._data=d;this._dataView=b;this._pos=g||0;this._end=k||d.byteLength}return h.prototype.clone=function(){return new h(this._data,
this._dataView,this._pos,this._end)},h.prototype.next=function(d){for(;;){if(this._pos===this._end)return!1;var b=this._decodeVarint();if(this._tag=b>>3,this._dataType=7&b,!d||d===this._tag)break;this.skip()}return!0},h.prototype.empty=function(){return this._pos>=this._end},h.prototype.tag=function(){return this._tag},h.prototype.getInt32=function(){return this._decodeVarint()},h.prototype.getInt64=function(){return this._decodeVarint()},h.prototype.getUInt32=function(){return this._decodeVarint()},
h.prototype.getUInt64=function(){return this._decodeVarint()},h.prototype.getSInt32=function(){return this._decodeSVarint()},h.prototype.getSInt64=function(){return this._decodeSVarint()},h.prototype.getBool=function(){var d=0!==this._data[this._pos];return this._skip(1),d},h.prototype.getEnum=function(){return this._decodeVarint()},h.prototype.getFixed64=function(){var d=this._dataView,b=this._pos,d=d.getUint32(b,!0)+4294967296*d.getUint32(b+4,!0);return this._skip(8),d},h.prototype.getSFixed64=
function(){var d=this._dataView,b=this._pos,d=d.getUint32(b,!0)+4294967296*d.getInt32(b+4,!0);return this._skip(8),d},h.prototype.getDouble=function(){var d=this._dataView.getFloat64(this._pos,!0);return this._skip(8),d},h.prototype.getFixed32=function(){var d=this._dataView.getUint32(this._pos,!0);return this._skip(4),d},h.prototype.getSFixed32=function(){var d=this._dataView.getInt32(this._pos,!0);return this._skip(4),d},h.prototype.getFloat=function(){var d=this._dataView.getFloat32(this._pos,
!0);return this._skip(4),d},h.prototype.getString=function(){var d=this._getLength(),b=this._pos,b=this._toString(this._data,b,b+d);return this._skip(d),b},h.prototype.getBytes=function(){var d=this._getLength(),b=this._pos,b=this._toBytes(this._data,b,b+d);return this._skip(d),b},h.prototype.getMessage=function(){var d=this._getLength(),b=this._pos,b=new h(this._data,this._dataView,b,b+d);return this._skip(d),b},h.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;
case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}},h.prototype._skip=function(d){if(this._pos+d>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=d},h.prototype._decodeVarint=function(){var d,b=this._data,g=this._pos,k=0;if(10<=this._end-g){if(d=b[g++],k|=127&d,0!==(128&d))if(d=b[g++],k|=(127&d)<<7,0!==(128&d))if(d=b[g++],k|=(127&d)<<14,0!==(128&d))if(d=b[g++],k|=(127&d)<<21,0!==(128&
d))if(d=b[g++],k+=268435456*(127&d),0!==(128&d))if(d=b[g++],k+=34359738368*(127&d),0!==(128&d))if(d=b[g++],k+=4398046511104*(127&d),0!==(128&d))if(d=b[g++],k+=562949953421312*(127&d),0!==(128&d))if(d=b[g++],k+=72057594037927936*(127&d),0!==(128&d))if(d=b[g++],k+=0x7fffffffffffffff*(127&d),0!==(128&d))throw Error("Varint too long!");}else{for(var f=1;g!==this._end&&(d=b[g],0!==(128&d));)++g,k+=(127&d)*f,f*=128;if(g===this._end)throw Error("Varint overrun!");++g;k+=d*f}return this._pos=g,k},h.prototype._decodeSVarint=
function(){var d=this._decodeVarint();return d%2?-(d+1)/2:d/2},h.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()},h.prototype._toString=function(d,b,g){var k="",f="";for(g=Math.min(this._end,g);g>b;++b){var a=d[b];128&a?f+="%"+a.toString(16):(k+=decodeURIComponent(f)+String.fromCharCode(a),f="")}return f.length&&(k+=decodeURIComponent(f)),k},h.prototype._toBytes=function(d,b,g){return g=Math.min(this._end,g),new Uint8Array(d.buffer,
b,g-b)},h}()})},"esri/views/vectorTiles/VectorTileDisplayObject":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/libs/gl-matrix/vec2 ../../core/libs/gl-matrix/mat4 ../../core/ObjectPool ../../geometry/support/spatialReferenceUtils ../webgl/BufferObject ../2d/engine/DisplayObject ../2d/tiling/TileKey ./RenderBucket".split(" "),function(m,l,h,d,b,g,k,f,a,e,c){return function(a){function q(){for(var c=[],e=0;e<arguments.length;e++)c[e]=arguments[e];e=a.call(this)||this;
return e._renderBuckets=[],e._vectorTileData=null,e._symbolUpdateData=null,e.status=5,e.coords=[0,0],e.bounds=[0,0,0,0],e.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]},e.stencilData={mask:0,reference:0},e.status=0,e.tileTransform.transform=b.create(),e.tileTransform.displayCoord=d.create(),0<c.length&&(f=e.acquire).call.apply(f,[e].concat(c)),e;var f}return h(q,a),q.prototype.reset=function(){e.pool.release(this.key);this.refKey=this.key=null;this.coords[0]=0;this.coords[1]=
0;this.bounds[0]=0;this.bounds[1]=0;this.bounds[2]=0;this.height=this.width=this.bounds[3]=0;this.resolution=null;this.rotation=0;this.id=this._connection=this.workerID=this.styleLayers=this._vectorTileData=null;this.tileTransform.transform.fill(0);this.tileTransform.displayCoord.fill(0);this.stencilData.mask=0;this.stencilData.reference=0;this._renderBuckets.length=0;this._symbolUpdateData=null;this.status=0},q.prototype.acquire=function(a,c,b,e,f){this.key=a;this.refKey=c;c=b.lodAt(a.level).resolution;
var n=b.size[0]*c,d=b.origin,g=a.col*n,q=a.row*n,h=b.spatialReference,r=0;h&&(h._isWrappable?h._isWrappable():h.isWrappable)&&(h=k.getInfo(h),r=h.valid[1]-h.valid[0]);g=d.x+g+a.world*r;d=d.y-q;this.coords[0]=g;this.coords[1]=d;this.bounds[0]=g;this.bounds[1]=d;this.bounds[2]=g+n;this.bounds[3]=d-n;this.widthInPixels=b.size[1];this.coordRange=4096;this.resolution=c;this.rotation=f;this.styleLayers=e;this.id=a.id;this.status=1},q.prototype.setData=function(a,c,b){this._vectorTileData=a;this.workerID=
c;this._connection=b;this.status=3},q.prototype.updateSymbolData=function(a){a&&(this._symbolUpdateData=a,this.requestRender())},q.prototype.dispose=function(){this.fillVertexArrayObject&&(this.fillVertexArrayObject.dispose(),this.fillVertexArrayObject=null);this.fillDDVertexArrayObject&&(this.fillDDVertexArrayObject.dispose(),this.fillDDVertexArrayObject=null);this.outlineVertexArrayObject&&(this.outlineVertexArrayObject.dispose(),this.outlineVertexArrayObject=null);this.outlineDDVertexArrayObject&&
(this.outlineDDVertexArrayObject.dispose(),this.outlineDDVertexArrayObject=null);this.lineVertexArrayObject&&(this.lineVertexArrayObject.dispose(),this.lineVertexArrayObject=null);this.lineDDVertexArrayObject&&(this.lineDDVertexArrayObject.dispose(),this.lineDDVertexArrayObject=null);this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.iconDDVertexArrayObject&&(this.iconDDVertexArrayObject.dispose(),this.iconDDVertexArrayObject=null);this.textVertexArrayObject&&
(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this.textDDVertexArrayObject&&(this.textDDVertexArrayObject.dispose(),this.textDDVertexArrayObject=null);this.fillVertexBuffer&&(this.fillVertexBuffer.dispose(),this.fillVertexBuffer=null);this.fillDDVertexBuffer&&(this.fillDDVertexBuffer.dispose(),this.fillDDVertexBuffer=null);this.fillIndexBuffer&&(this.fillIndexBuffer.dispose(),this.fillIndexBuffer=null);this.outlineVertexBuffer&&(this.outlineVertexBuffer.dispose(),this.outlineVertexBuffer=
null);this.outlineDDVertexBuffer&&(this.outlineDDVertexBuffer.dispose(),this.outlineDDVertexBuffer=null);this.outlineIndexBuffer&&(this.outlineIndexBuffer.dispose(),this.outlineIndexBuffer=null);this.lineVertexBuffer&&(this.lineVertexBuffer.dispose(),this.lineVertexBuffer=null);this.lineDDVertexBuffer&&(this.lineDDVertexBuffer.dispose(),this.lineDDVertexBuffer=null);this.lineIndexBuffer&&(this.lineIndexBuffer.dispose(),this.lineIndexBuffer=null);this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),
this.iconVertexBuffer=null);this.iconDDVertexBuffer&&(this.iconDDVertexBuffer.dispose(),this.iconDDVertexBuffer=null);this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textDDVertexBuffer&&(this.textDDVertexBuffer.dispose(),this.textDDVertexBuffer=null);this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null);this.texture&&(this.texture.dispose(),this.texture=
null);this._renderBuckets.length=0;this.status=7},q.prototype.attach=function(a){if(4===this.status)return!0;if(this.status=3,!this._vectorTileData)return!1;if(!this._vectorTileData.bufferDataInfo)return this.status=4,!0;if(0===this._renderBuckets.length)for(var b=new Uint32Array(this._vectorTileData.bucketDataInfo),e=b.length,d=0;e>d;){var g=b[d],n=b[d+1];if(0===n)n=new c.BackgroundRenderBucket,n.layerID=g,this._renderBuckets.push(n),d+=2;else if(1===n)n=new c.FillRenderBucket,n.layerID=g,n.triangleElementStart=
b[d+2],n.triangleElementCount=b[d+3],n.outlineElementStart=b[d+4],n.outlineElementCount=b[d+5],this._renderBuckets.push(n),d+=6;else if(2===n)n=new c.LineRenderBucket,n.layerID=g,n.triangleElementStart=b[d+2],n.triangleElementCount=b[d+3],this._renderBuckets.push(n),d+=6;else if(3===n){n=new c.SymbolRenderBucket;n.layerID=g;n.isSDF=0!==b[d+2];var w=d+3,g=b[w];if(w++,0<g)for(var k=void 0,q=void 0,h=void 0,r=0;g>r;r++)k=b[w],q=b[w+1],h=b[w+2],n.markerPerPageElementsMap.set(k,[q,h]),w+=3;var t=b[w];
if(w++,0<t)for(h=q=k=void 0,r=0;t>r;r++)k=b[w],q=b[w+1],h=b[w+2],n.glyphPerPageElementsMap.set(k,[q,h]),w+=3;this._renderBuckets.push(n);d+=5+3*g+3*t}else console.error("Bad bucket type!")}a=a.context;b=new Uint32Array(this._vectorTileData.bufferDataInfo);e=b.length;for(n=d=0;e>n;n+=2,d++)if(g=b[n],!(0>=b[n+1]||0===this._vectorTileData.bufferData[d].byteLength))switch(g){case 1:this.fillVertexBuffer?this.fillVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.fillVertexBuffer=f.createVertex(a,
35044,this._vectorTileData.bufferData[d]);break;case 2:this.fillDDVertexBuffer?this.fillDDVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.fillDDVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 3:this.fillIndexBuffer?this.fillIndexBuffer.setData(this._vectorTileData.bufferData[d]):this.fillIndexBuffer=f.createIndex(a,35044,this._vectorTileData.bufferData[d]);break;case 4:this.outlineVertexBuffer?this.outlineVertexBuffer.setData(this._vectorTileData.bufferData[d]):
this.outlineVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 5:this.outlineDDVertexBuffer?this.outlineDDVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.outlineDDVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 6:this.outlineIndexBuffer?this.outlineIndexBuffer.setData(this._vectorTileData.bufferData[d]):this.outlineIndexBuffer=f.createIndex(a,35044,this._vectorTileData.bufferData[d]);break;case 7:this.lineVertexBuffer?
this.lineVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.lineVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 8:this.lineDDVertexBuffer?this.lineDDVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.lineDDVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 9:this.lineIndexBuffer?this.lineIndexBuffer.setData(this._vectorTileData.bufferData[d]):this.lineIndexBuffer=f.createIndex(a,35044,this._vectorTileData.bufferData[d]);
break;case 10:this.iconVertexBuffer?this.iconVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.iconVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 11:this.iconDDVertexBuffer?this.iconDDVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.iconDDVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 12:this.iconIndexBuffer?this.iconIndexBuffer.setData(this._vectorTileData.bufferData[d]):this.iconIndexBuffer=f.createIndex(a,
35044,this._vectorTileData.bufferData[d]);break;case 13:this.textVertexBuffer?this.textVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.textVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 14:this.textDDVertexBuffer?this.textDDVertexBuffer.setData(this._vectorTileData.bufferData[d]):this.textDDVertexBuffer=f.createVertex(a,35044,this._vectorTileData.bufferData[d]);break;case 15:this.textIndexBuffer?this.textIndexBuffer.setData(this._vectorTileData.bufferData[d]):
this.textIndexBuffer=f.createIndex(a,35044,this._vectorTileData.bufferData[d])}return this.status=4,!0},q.prototype.detach=function(c){-1!==this.workerID&&this._connection&&6!==this.status&&7!==this.status&&this._connection.broadcast("destructTileData",{key:this.id,worker:this.workerID},[]);this.dispose();a.prototype.detach.call(this,c)},q.prototype.doRender=function(a){if(this.visible&&4===this.status){var c=a.context,b=a.renderer;if(c&&b){var e=a.drawphase;this._symbolUpdateData&&this._updateSymbolData(a);
c.setStencilFunction(514,this.stencilData.reference,this.stencilData.mask);var f=this.styleLayers,n=void 0!==a.layerOpacity?a.layerOpacity:1;if(0!==n){var d,g=this._renderBuckets.length,k=0;if(0===e)for(k=g-1;0<=k;k--)d=this._renderBuckets[k],3!==d.type&&d.hasData()&&b.renderBucket(c,d,a.displayLevel,a.requiredLevel,e,this,f.layers[d.layerID],n);else for(k=0;g>k;k++)d=this._renderBuckets[k],d.hasData()&&b.renderBucket(c,d,a.displayLevel,a.requiredLevel,e,this,f.layers[d.layerID],n)}}}},q.prototype._updateSymbolData=
function(a){if(!this._symbolUpdateData.bucketDataInfo)return!0;var b=new Uint32Array(this._symbolUpdateData.bucketDataInfo),e=b.length;if(0===e)return this._symbolUpdateData=null,!0;if(1>a.budget.remaining||4!==this.status)return this.requestRender(),!1;a=a.context;for(var d=new Uint32Array(this._symbolUpdateData.bufferDataInfo),g=d.length,n=0,w=0;g>w;w+=2,n++)switch(d[w]){case 10:this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconVertexBuffer=f.createVertex(a,
35044,this._symbolUpdateData.bufferData[n]);break;case 11:this.iconDDVertexBuffer&&(this.iconDDVertexBuffer.dispose(),this.iconDDVertexBuffer=null);this.iconDDVertexBuffer=f.createVertex(a,35044,this._symbolUpdateData.bufferData[n]);break;case 12:this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.iconIndexBuffer=f.createIndex(a,35044,this._symbolUpdateData.bufferData[n]);break;case 13:this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=
null);this.textVertexBuffer=f.createVertex(a,35044,this._symbolUpdateData.bufferData[n]);break;case 14:this.textDDVertexBuffer&&(this.textDDVertexBuffer.dispose(),this.textDDVertexBuffer=null);this.textDDVertexBuffer=f.createVertex(a,35044,this._symbolUpdateData.bufferData[n]);break;case 15:this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null),this.textIndexBuffer=f.createIndex(a,35044,this._symbolUpdateData.bufferData[n])}a=this._renderBuckets.length;for(d=0;a>d;d++)this._renderBuckets[d]instanceof
c.SymbolRenderBucket&&(g=this._renderBuckets[d],g.markerPerPageElementsMap.clear(),g.glyphPerPageElementsMap.clear());for(a=0;e>a;){g=b[a];n=-1;w=this._renderBuckets.length;for(d=0;w>d;d++)if(this._renderBuckets[d].layerID===g){n=d;break}(d=this._renderBuckets[n])||(d=new c.SymbolRenderBucket,d.layerID=g,d.isSDF=0!==b[a+2],this._renderBuckets.push(d));var k=a+3,g=b[k];if(k++,0<g)for(var q=w=n=void 0,h=0;g>h;h++)n=b[k],w=b[k+1],q=b[k+2],d.markerPerPageElementsMap.set(n,[w,q]),k+=3;var r=b[k];if(k++,
0<r)for(q=w=n=void 0,h=0;r>h;h++)n=b[k],w=b[k+1],q=b[k+2],d.glyphPerPageElementsMap.set(n,[w,q]),k+=3;a+=5+3*g+3*r}return this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null),this.iconDDVertexArrayObject&&(this.iconDDVertexArrayObject.dispose(),this.iconDDVertexArrayObject=null),this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null),this.textDDVertexArrayObject&&(this.textDDVertexArrayObject.dispose(),this.textDDVertexArrayObject=
null),this._symbolUpdateData=null,!0},q.pool=new g(q),q}(a)})},"esri/core/libs/gl-matrix/vec2":function(){define(["./common"],function(m){var l={};return l.create=function(){var h=new m.ARRAY_TYPE(2);return h[0]=0,h[1]=0,h},l.clone=function(h){var d=new m.ARRAY_TYPE(2);return d[0]=h[0],d[1]=h[1],d},l.fromValues=function(h,d){var b=new m.ARRAY_TYPE(2);return b[0]=h,b[1]=d,b},l.copy=function(h,d){return h[0]=d[0],h[1]=d[1],h},l.set=function(h,d,b){return h[0]=d,h[1]=b,h},l.add=function(h,d,b){return h[0]=
d[0]+b[0],h[1]=d[1]+b[1],h},l.subtract=function(h,d,b){return h[0]=d[0]-b[0],h[1]=d[1]-b[1],h},l.sub=l.subtract,l.multiply=function(h,d,b){return h[0]=d[0]*b[0],h[1]=d[1]*b[1],h},l.mul=l.multiply,l.divide=function(h,d,b){return h[0]=d[0]/b[0],h[1]=d[1]/b[1],h},l.div=l.divide,l.ceil=function(h,d){return h[0]=Math.ceil(d[0]),h[1]=Math.ceil(d[1]),h},l.floor=function(h,d){return h[0]=Math.floor(d[0]),h[1]=Math.floor(d[1]),h},l.min=function(h,d,b){return h[0]=Math.min(d[0],b[0]),h[1]=Math.min(d[1],b[1]),
h},l.max=function(h,d,b){return h[0]=Math.max(d[0],b[0]),h[1]=Math.max(d[1],b[1]),h},l.round=function(h,d){return h[0]=Math.round(d[0]),h[1]=Math.round(d[1]),h},l.scale=function(h,d,b){return h[0]=d[0]*b,h[1]=d[1]*b,h},l.scaleAndAdd=function(h,d,b,g){return h[0]=d[0]+b[0]*g,h[1]=d[1]+b[1]*g,h},l.distance=function(h,d){var b=d[0]-h[0];h=d[1]-h[1];return Math.sqrt(b*b+h*h)},l.dist=l.distance,l.squaredDistance=function(h,d){var b=d[0]-h[0];h=d[1]-h[1];return b*b+h*h},l.sqrDist=l.squaredDistance,l.length=
function(h){var d=h[0];h=h[1];return Math.sqrt(d*d+h*h)},l.len=l.length,l.squaredLength=function(h){var d=h[0];h=h[1];return d*d+h*h},l.sqrLen=l.squaredLength,l.negate=function(h,d){return h[0]=-d[0],h[1]=-d[1],h},l.inverse=function(h,d){return h[0]=1/d[0],h[1]=1/d[1],h},l.normalize=function(h,d){var b=d[0],g=d[1],b=b*b+g*g;return 0<b&&(b=1/Math.sqrt(b),h[0]=d[0]*b,h[1]=d[1]*b),h},l.dot=function(h,d){return h[0]*d[0]+h[1]*d[1]},l.cross=function(h,d,b){d=d[0]*b[1]-d[1]*b[0];return h[0]=h[1]=0,h[2]=
d,h},l.lerp=function(h,d,b,g){var k=d[0];d=d[1];return h[0]=k+g*(b[0]-k),h[1]=d+g*(b[1]-d),h},l.random=function(h,d){d=d||1;var b=2*m.RANDOM()*Math.PI;return h[0]=Math.cos(b)*d,h[1]=Math.sin(b)*d,h},l.transformMat2=function(h,d,b){var g=d[0];d=d[1];return h[0]=b[0]*g+b[2]*d,h[1]=b[1]*g+b[3]*d,h},l.transformMat2d=function(h,d,b){var g=d[0];d=d[1];return h[0]=b[0]*g+b[2]*d+b[4],h[1]=b[1]*g+b[3]*d+b[5],h},l.transformMat3=function(h,d,b){var g=d[0];d=d[1];return h[0]=b[0]*g+b[3]*d+b[6],h[1]=b[1]*g+b[4]*
d+b[7],h},l.transformMat4=function(h,d,b){var g=d[0];d=d[1];return h[0]=b[0]*g+b[4]*d+b[12],h[1]=b[1]*g+b[5]*d+b[13],h},l.forEach=function(){var h=l.create();return function(d,b,g,k,f,a){b||(b=2);g||(g=0);for(k=k?Math.min(k*b+g,d.length):d.length;k>g;g+=b)h[0]=d[g],h[1]=d[g+1],f(h,h,a),d[g]=h[0],d[g+1]=h[1];return d}}(),l.str=function(h){return"vec2("+h[0]+", "+h[1]+")"},l.exactEquals=function(h,d){return h[0]===d[0]&&h[1]===d[1]},l.equals=function(h,d){var b=h[0];h=h[1];var g=d[0];d=d[1];return Math.abs(b-
g)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(g))&&Math.abs(h-d)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(d))},l})},"esri/core/libs/gl-matrix/common":function(){define([],function(){var m={EPSILON:1E-6};m.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array;m.RANDOM=Math.random;m.ENABLE_SIMD=!1;m.SIMD_AVAILABLE=m.ARRAY_TYPE===Float32Array&&"SIMD"in this;m.USE_SIMD=m.ENABLE_SIMD&&m.SIMD_AVAILABLE;m.setMatrixArrayType=function(h){m.ARRAY_TYPE=h};var l=Math.PI/180;return m.toRadian=function(h){return h*
l},m.equals=function(h,d){return Math.abs(h-d)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(d))},m})},"esri/core/libs/gl-matrix/mat4":function(){define(["./common"],function(m){var l={scalar:{},SIMD:{}};return l.create=function(){var h=new m.ARRAY_TYPE(16);return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},l.clone=function(h){var d=new m.ARRAY_TYPE(16);return d[0]=h[0],d[1]=h[1],d[2]=h[2],d[3]=h[3],d[4]=h[4],d[5]=h[5],d[6]=
h[6],d[7]=h[7],d[8]=h[8],d[9]=h[9],d[10]=h[10],d[11]=h[11],d[12]=h[12],d[13]=h[13],d[14]=h[14],d[15]=h[15],d},l.copy=function(h,d){return h[0]=d[0],h[1]=d[1],h[2]=d[2],h[3]=d[3],h[4]=d[4],h[5]=d[5],h[6]=d[6],h[7]=d[7],h[8]=d[8],h[9]=d[9],h[10]=d[10],h[11]=d[11],h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15],h},l.fromValues=function(h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y){var n=new m.ARRAY_TYPE(16);return n[0]=h,n[1]=d,n[2]=b,n[3]=g,n[4]=k,n[5]=f,n[6]=a,n[7]=e,n[8]=c,n[9]=q,n[10]=t,n[11]=r,n[12]=u,n[13]=
v,n[14]=x,n[15]=y,n},l.set=function(h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n){return h[0]=d,h[1]=b,h[2]=g,h[3]=k,h[4]=f,h[5]=a,h[6]=e,h[7]=c,h[8]=q,h[9]=t,h[10]=r,h[11]=u,h[12]=v,h[13]=x,h[14]=y,h[15]=n,h},l.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},l.scalar.transpose=function(h,d){if(h===d){var b=d[1],g=d[2],k=d[3],f=d[6],a=d[7],e=d[11];h[1]=d[4];h[2]=d[8];h[3]=d[12];h[4]=b;h[6]=d[9];h[7]=d[13];h[8]=
g;h[9]=f;h[11]=d[14];h[12]=k;h[13]=a;h[14]=e}else h[0]=d[0],h[1]=d[4],h[2]=d[8],h[3]=d[12],h[4]=d[1],h[5]=d[5],h[6]=d[9],h[7]=d[13],h[8]=d[2],h[9]=d[6],h[10]=d[10],h[11]=d[14],h[12]=d[3],h[13]=d[7],h[14]=d[11],h[15]=d[15];return h},l.SIMD.transpose=function(h,d){var b,g,k,f,a,e,c,q,t,r;return b=SIMD.Float32x4.load(d,0),g=SIMD.Float32x4.load(d,4),k=SIMD.Float32x4.load(d,8),f=SIMD.Float32x4.load(d,12),a=SIMD.Float32x4.shuffle(b,g,0,1,4,5),e=SIMD.Float32x4.shuffle(k,f,0,1,4,5),c=SIMD.Float32x4.shuffle(a,
e,0,2,4,6),q=SIMD.Float32x4.shuffle(a,e,1,3,5,7),SIMD.Float32x4.store(h,0,c),SIMD.Float32x4.store(h,4,q),a=SIMD.Float32x4.shuffle(b,g,2,3,6,7),e=SIMD.Float32x4.shuffle(k,f,2,3,6,7),t=SIMD.Float32x4.shuffle(a,e,0,2,4,6),r=SIMD.Float32x4.shuffle(a,e,1,3,5,7),SIMD.Float32x4.store(h,8,t),SIMD.Float32x4.store(h,12,r),h},l.transpose=m.USE_SIMD?l.SIMD.transpose:l.scalar.transpose,l.scalar.invert=function(h,d){var b=d[0],g=d[1],k=d[2],f=d[3],a=d[4],e=d[5],c=d[6],q=d[7],t=d[8],r=d[9],u=d[10],v=d[11],x=d[12],
y=d[13],n=d[14];d=d[15];var w=b*e-g*a,z=b*c-k*a,l=b*q-f*a,B=g*c-k*e,m=g*q-f*e,G=k*q-f*c,N=t*y-r*x,M=t*n-u*x,R=t*d-v*x,P=r*n-u*y,Q=r*d-v*y,T=u*d-v*n,O=w*T-z*Q+l*P+B*R-m*M+G*N;return O?(O=1/O,h[0]=(e*T-c*Q+q*P)*O,h[1]=(k*Q-g*T-f*P)*O,h[2]=(y*G-n*m+d*B)*O,h[3]=(u*m-r*G-v*B)*O,h[4]=(c*R-a*T-q*M)*O,h[5]=(b*T-k*R+f*M)*O,h[6]=(n*l-x*G-d*z)*O,h[7]=(t*G-u*l+v*z)*O,h[8]=(a*Q-e*R+q*N)*O,h[9]=(g*R-b*Q-f*N)*O,h[10]=(x*m-y*l+d*w)*O,h[11]=(r*l-t*m-v*w)*O,h[12]=(e*M-a*P-c*N)*O,h[13]=(b*P-g*M+k*N)*O,h[14]=(y*z-x*
B-n*w)*O,h[15]=(t*B-r*z+u*w)*O,h):null},l.SIMD.invert=function(h,d){var b,g,k,f,a,e,c,q,t,r,u=SIMD.Float32x4.load(d,0),v=SIMD.Float32x4.load(d,4),x=SIMD.Float32x4.load(d,8);d=SIMD.Float32x4.load(d,12);return a=SIMD.Float32x4.shuffle(u,v,0,1,4,5),g=SIMD.Float32x4.shuffle(x,d,0,1,4,5),b=SIMD.Float32x4.shuffle(a,g,0,2,4,6),g=SIMD.Float32x4.shuffle(g,a,1,3,5,7),a=SIMD.Float32x4.shuffle(u,v,2,3,6,7),f=SIMD.Float32x4.shuffle(x,d,2,3,6,7),k=SIMD.Float32x4.shuffle(a,f,0,2,4,6),f=SIMD.Float32x4.shuffle(f,
a,1,3,5,7),a=SIMD.Float32x4.mul(k,f),a=SIMD.Float32x4.swizzle(a,1,0,3,2),e=SIMD.Float32x4.mul(g,a),c=SIMD.Float32x4.mul(b,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,a),e),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,a),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),a=SIMD.Float32x4.mul(g,k),a=SIMD.Float32x4.swizzle(a,1,0,3,2),e=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,a),e),t=SIMD.Float32x4.mul(b,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(f,
a)),t=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,a),t),t=SIMD.Float32x4.swizzle(t,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,3,0,1),f),a=SIMD.Float32x4.swizzle(a,1,0,3,2),k=SIMD.Float32x4.swizzle(k,2,3,0,1),e=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,a),e),q=SIMD.Float32x4.mul(b,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(k,a)),q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,a),q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),a=SIMD.Float32x4.mul(b,g),a=SIMD.Float32x4.swizzle(a,
1,0,3,2),q=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,a),q),t=SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,a),t),a=SIMD.Float32x4.swizzle(a,2,3,0,1),q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,a),q),t=SIMD.Float32x4.sub(t,SIMD.Float32x4.mul(k,a)),a=SIMD.Float32x4.mul(b,f),a=SIMD.Float32x4.swizzle(a,1,0,3,2),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(k,a)),q=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,a),q),a=SIMD.Float32x4.swizzle(a,2,3,0,1),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,a),c),q=SIMD.Float32x4.sub(q,
SIMD.Float32x4.mul(g,a)),a=SIMD.Float32x4.mul(b,k),a=SIMD.Float32x4.swizzle(a,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,a),c),t=SIMD.Float32x4.sub(t,SIMD.Float32x4.mul(g,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(f,a)),t=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,a),t),r=SIMD.Float32x4.mul(b,e),r=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(r,2,3,0,1),r),r=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(r,1,0,3,2),r),a=SIMD.Float32x4.reciprocalApproximation(r),
r=SIMD.Float32x4.sub(SIMD.Float32x4.add(a,a),SIMD.Float32x4.mul(r,SIMD.Float32x4.mul(a,a))),(r=SIMD.Float32x4.swizzle(r,0,0,0,0))?(SIMD.Float32x4.store(h,0,SIMD.Float32x4.mul(r,e)),SIMD.Float32x4.store(h,4,SIMD.Float32x4.mul(r,c)),SIMD.Float32x4.store(h,8,SIMD.Float32x4.mul(r,q)),SIMD.Float32x4.store(h,12,SIMD.Float32x4.mul(r,t)),h):null},l.invert=m.USE_SIMD?l.SIMD.invert:l.scalar.invert,l.scalar.adjoint=function(h,d){var b=d[0],g=d[1],k=d[2],f=d[3],a=d[4],e=d[5],c=d[6],q=d[7],t=d[8],r=d[9],u=d[10],
v=d[11],x=d[12],y=d[13],n=d[14];d=d[15];return h[0]=e*(u*d-v*n)-r*(c*d-q*n)+y*(c*v-q*u),h[1]=-(g*(u*d-v*n)-r*(k*d-f*n)+y*(k*v-f*u)),h[2]=g*(c*d-q*n)-e*(k*d-f*n)+y*(k*q-f*c),h[3]=-(g*(c*v-q*u)-e*(k*v-f*u)+r*(k*q-f*c)),h[4]=-(a*(u*d-v*n)-t*(c*d-q*n)+x*(c*v-q*u)),h[5]=b*(u*d-v*n)-t*(k*d-f*n)+x*(k*v-f*u),h[6]=-(b*(c*d-q*n)-a*(k*d-f*n)+x*(k*q-f*c)),h[7]=b*(c*v-q*u)-a*(k*v-f*u)+t*(k*q-f*c),h[8]=a*(r*d-v*y)-t*(e*d-q*y)+x*(e*v-q*r),h[9]=-(b*(r*d-v*y)-t*(g*d-f*y)+x*(g*v-f*r)),h[10]=b*(e*d-q*y)-a*(g*d-f*y)+
x*(g*q-f*e),h[11]=-(b*(e*v-q*r)-a*(g*v-f*r)+t*(g*q-f*e)),h[12]=-(a*(r*n-u*y)-t*(e*n-c*y)+x*(e*u-c*r)),h[13]=b*(r*n-u*y)-t*(g*n-k*y)+x*(g*u-k*r),h[14]=-(b*(e*n-c*y)-a*(g*n-k*y)+x*(g*c-k*e)),h[15]=b*(e*u-c*r)-a*(g*u-k*r)+t*(g*c-k*e),h},l.SIMD.adjoint=function(h,d){var b,g,k,f,a,e,c,q,t,r,u,v;b=SIMD.Float32x4.load(d,0);g=SIMD.Float32x4.load(d,4);k=SIMD.Float32x4.load(d,8);d=SIMD.Float32x4.load(d,12);return q=SIMD.Float32x4.shuffle(b,g,0,1,4,5),a=SIMD.Float32x4.shuffle(k,d,0,1,4,5),f=SIMD.Float32x4.shuffle(q,
a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,q,1,3,5,7),q=SIMD.Float32x4.shuffle(b,g,2,3,6,7),c=SIMD.Float32x4.shuffle(k,d,2,3,6,7),e=SIMD.Float32x4.shuffle(q,c,0,2,4,6),c=SIMD.Float32x4.shuffle(c,q,1,3,5,7),q=SIMD.Float32x4.mul(e,c),q=SIMD.Float32x4.swizzle(q,1,0,3,2),t=SIMD.Float32x4.mul(a,q),r=SIMD.Float32x4.mul(f,q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),t=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,q),t),r=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,q),r),r=SIMD.Float32x4.swizzle(r,2,3,0,1),q=SIMD.Float32x4.mul(a,
e),q=SIMD.Float32x4.swizzle(q,1,0,3,2),t=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,q),t),v=SIMD.Float32x4.mul(f,q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),t=SIMD.Float32x4.sub(t,SIMD.Float32x4.mul(c,q)),v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,q),v),v=SIMD.Float32x4.swizzle(v,2,3,0,1),q=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,3,0,1),c),q=SIMD.Float32x4.swizzle(q,1,0,3,2),e=SIMD.Float32x4.swizzle(e,2,3,0,1),t=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,q),t),u=SIMD.Float32x4.mul(f,q),q=SIMD.Float32x4.swizzle(q,
2,3,0,1),t=SIMD.Float32x4.sub(t,SIMD.Float32x4.mul(e,q)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,q),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),q=SIMD.Float32x4.mul(f,a),q=SIMD.Float32x4.swizzle(q,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,q),u),v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,q),v),q=SIMD.Float32x4.swizzle(q,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,q),u),v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(e,q)),q=SIMD.Float32x4.mul(f,c),q=SIMD.Float32x4.swizzle(q,1,0,3,2),r=SIMD.Float32x4.sub(r,
SIMD.Float32x4.mul(e,q)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,q),u),q=SIMD.Float32x4.swizzle(q,2,3,0,1),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,q),r),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,q)),q=SIMD.Float32x4.mul(f,e),q=SIMD.Float32x4.swizzle(q,1,0,3,2),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,q),r),v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(a,q)),q=SIMD.Float32x4.swizzle(q,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(c,q)),v=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,q),v),SIMD.Float32x4.store(h,
0,t),SIMD.Float32x4.store(h,4,r),SIMD.Float32x4.store(h,8,u),SIMD.Float32x4.store(h,12,v),h},l.adjoint=m.USE_SIMD?l.SIMD.adjoint:l.scalar.adjoint,l.determinant=function(h){var d=h[0],b=h[1],g=h[2],k=h[3],f=h[4],a=h[5],e=h[6],c=h[7],q=h[8],t=h[9],r=h[10],u=h[11],v=h[12],x=h[13],y=h[14];h=h[15];return(d*a-b*f)*(r*h-u*y)-(d*e-g*f)*(t*h-u*x)+(d*c-k*f)*(t*y-r*x)+(b*e-g*a)*(q*h-u*v)-(b*c-k*a)*(q*y-r*v)+(g*c-k*e)*(q*x-t*v)},l.SIMD.multiply=function(h,d,b){var g=SIMD.Float32x4.load(d,0),k=SIMD.Float32x4.load(d,
4),f=SIMD.Float32x4.load(d,8);d=SIMD.Float32x4.load(d,12);var a=SIMD.Float32x4.load(b,0),a=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,0,0,0,0),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,3,3,3,3),d))));SIMD.Float32x4.store(h,0,a);a=SIMD.Float32x4.load(b,4);a=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,0,0,0,
0),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,3,3,3,3),d))));SIMD.Float32x4.store(h,4,a);a=SIMD.Float32x4.load(b,8);a=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,0,0,0,0),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(a,
3,3,3,3),d))));SIMD.Float32x4.store(h,8,a);b=SIMD.Float32x4.load(b,12);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,0,0,0,0),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,3,3,3,3),d))));return SIMD.Float32x4.store(h,12,g),h},l.scalar.multiply=function(h,d,b){var g=d[0],k=d[1],f=d[2],a=d[3],e=d[4],c=d[5],q=d[6],t=d[7],r=d[8],u=d[9],
v=d[10],x=d[11],y=d[12],n=d[13],w=d[14];d=d[15];var z=b[0],l=b[1],B=b[2],m=b[3];return h[0]=z*g+l*e+B*r+m*y,h[1]=z*k+l*c+B*u+m*n,h[2]=z*f+l*q+B*v+m*w,h[3]=z*a+l*t+B*x+m*d,z=b[4],l=b[5],B=b[6],m=b[7],h[4]=z*g+l*e+B*r+m*y,h[5]=z*k+l*c+B*u+m*n,h[6]=z*f+l*q+B*v+m*w,h[7]=z*a+l*t+B*x+m*d,z=b[8],l=b[9],B=b[10],m=b[11],h[8]=z*g+l*e+B*r+m*y,h[9]=z*k+l*c+B*u+m*n,h[10]=z*f+l*q+B*v+m*w,h[11]=z*a+l*t+B*x+m*d,z=b[12],l=b[13],B=b[14],m=b[15],h[12]=z*g+l*e+B*r+m*y,h[13]=z*k+l*c+B*u+m*n,h[14]=z*f+l*q+B*v+m*w,h[15]=
z*a+l*t+B*x+m*d,h},l.multiply=m.USE_SIMD?l.SIMD.multiply:l.scalar.multiply,l.mul=l.multiply,l.scalar.translate=function(h,d,b){var g,k,f,a,e,c,q,t,r,u,v,x,y=b[0],n=b[1];b=b[2];return d===h?(h[12]=d[0]*y+d[4]*n+d[8]*b+d[12],h[13]=d[1]*y+d[5]*n+d[9]*b+d[13],h[14]=d[2]*y+d[6]*n+d[10]*b+d[14],h[15]=d[3]*y+d[7]*n+d[11]*b+d[15]):(g=d[0],k=d[1],f=d[2],a=d[3],e=d[4],c=d[5],q=d[6],t=d[7],r=d[8],u=d[9],v=d[10],x=d[11],h[0]=g,h[1]=k,h[2]=f,h[3]=a,h[4]=e,h[5]=c,h[6]=q,h[7]=t,h[8]=r,h[9]=u,h[10]=v,h[11]=x,h[12]=
g*y+e*n+r*b+d[12],h[13]=k*y+c*n+u*b+d[13],h[14]=f*y+q*n+v*b+d[14],h[15]=a*y+t*n+x*b+d[15]),h},l.SIMD.translate=function(h,d,b){var g=SIMD.Float32x4.load(d,0),k=SIMD.Float32x4.load(d,4),f=SIMD.Float32x4.load(d,8),a=SIMD.Float32x4.load(d,12);b=SIMD.Float32x4(b[0],b[1],b[2],0);d!==h&&(h[0]=d[0],h[1]=d[1],h[2]=d[2],h[3]=d[3],h[4]=d[4],h[5]=d[5],h[6]=d[6],h[7]=d[7],h[8]=d[8],h[9]=d[9],h[10]=d[10],h[11]=d[11]);g=SIMD.Float32x4.mul(g,SIMD.Float32x4.swizzle(b,0,0,0,0));k=SIMD.Float32x4.mul(k,SIMD.Float32x4.swizzle(b,
1,1,1,1));f=SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(b,2,2,2,2));d=SIMD.Float32x4.add(g,SIMD.Float32x4.add(k,SIMD.Float32x4.add(f,a)));return SIMD.Float32x4.store(h,12,d),h},l.translate=m.USE_SIMD?l.SIMD.translate:l.scalar.translate,l.scalar.scale=function(h,d,b){var g=b[0],k=b[1];b=b[2];return h[0]=d[0]*g,h[1]=d[1]*g,h[2]=d[2]*g,h[3]=d[3]*g,h[4]=d[4]*k,h[5]=d[5]*k,h[6]=d[6]*k,h[7]=d[7]*k,h[8]=d[8]*b,h[9]=d[9]*b,h[10]=d[10]*b,h[11]=d[11]*b,h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15],h},l.SIMD.scale=
function(h,d,b){var g,k,f;b=SIMD.Float32x4(b[0],b[1],b[2],0);return g=SIMD.Float32x4.load(d,0),SIMD.Float32x4.store(h,0,SIMD.Float32x4.mul(g,SIMD.Float32x4.swizzle(b,0,0,0,0))),k=SIMD.Float32x4.load(d,4),SIMD.Float32x4.store(h,4,SIMD.Float32x4.mul(k,SIMD.Float32x4.swizzle(b,1,1,1,1))),f=SIMD.Float32x4.load(d,8),SIMD.Float32x4.store(h,8,SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(b,2,2,2,2))),h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15],h},l.scale=m.USE_SIMD?l.SIMD.scale:l.scalar.scale,l.rotate=
function(h,d,b,g){var k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,l,B,F,G,N,M,R,P,Q,T=g[0],O=g[1];g=g[2];var S=Math.sqrt(T*T+O*O+g*g);return Math.abs(S)<m.EPSILON?null:(S=1/S,T*=S,O*=S,g*=S,k=Math.sin(b),f=Math.cos(b),a=1-f,e=d[0],c=d[1],q=d[2],t=d[3],r=d[4],u=d[5],v=d[6],x=d[7],y=d[8],n=d[9],w=d[10],z=d[11],l=T*T*a+f,B=O*T*a+g*k,F=g*T*a-O*k,G=T*O*a-g*k,N=O*O*a+f,M=g*O*a+T*k,R=T*g*a+O*k,P=O*g*a-T*k,Q=g*g*a+f,h[0]=e*l+r*B+y*F,h[1]=c*l+u*B+n*F,h[2]=q*l+v*B+w*F,h[3]=t*l+x*B+z*F,h[4]=e*G+r*N+y*M,h[5]=c*G+u*N+n*M,h[6]=
q*G+v*N+w*M,h[7]=t*G+x*N+z*M,h[8]=e*R+r*P+y*Q,h[9]=c*R+u*P+n*Q,h[10]=q*R+v*P+w*Q,h[11]=t*R+x*P+z*Q,d!==h&&(h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15]),h)},l.scalar.rotateX=function(h,d,b){var g=Math.sin(b);b=Math.cos(b);var k=d[4],f=d[5],a=d[6],e=d[7],c=d[8],q=d[9],t=d[10],r=d[11];return d!==h&&(h[0]=d[0],h[1]=d[1],h[2]=d[2],h[3]=d[3],h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15]),h[4]=k*b+c*g,h[5]=f*b+q*g,h[6]=a*b+t*g,h[7]=e*b+r*g,h[8]=c*b-k*g,h[9]=q*b-f*g,h[10]=t*b-a*g,h[11]=r*b-e*g,h},l.SIMD.rotateX=
function(h,d,b){var g=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));d!==h&&(h[0]=d[0],h[1]=d[1],h[2]=d[2],h[3]=d[3],h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15]);var k=SIMD.Float32x4.load(d,4);d=SIMD.Float32x4.load(d,8);return SIMD.Float32x4.store(h,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(k,b),SIMD.Float32x4.mul(d,g))),SIMD.Float32x4.store(h,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,b),SIMD.Float32x4.mul(k,g))),h},l.rotateX=m.USE_SIMD?l.SIMD.rotateX:l.scalar.rotateX,l.scalar.rotateY=
function(h,d,b){var g=Math.sin(b);b=Math.cos(b);var k=d[0],f=d[1],a=d[2],e=d[3],c=d[8],q=d[9],t=d[10],r=d[11];return d!==h&&(h[4]=d[4],h[5]=d[5],h[6]=d[6],h[7]=d[7],h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15]),h[0]=k*b-c*g,h[1]=f*b-q*g,h[2]=a*b-t*g,h[3]=e*b-r*g,h[8]=k*g+c*b,h[9]=f*g+q*b,h[10]=a*g+t*b,h[11]=e*g+r*b,h},l.SIMD.rotateY=function(h,d,b){var g=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));d!==h&&(h[4]=d[4],h[5]=d[5],h[6]=d[6],h[7]=d[7],h[12]=d[12],h[13]=d[13],
h[14]=d[14],h[15]=d[15]);var k=SIMD.Float32x4.load(d,0);d=SIMD.Float32x4.load(d,8);return SIMD.Float32x4.store(h,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,b),SIMD.Float32x4.mul(d,g))),SIMD.Float32x4.store(h,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(k,g),SIMD.Float32x4.mul(d,b))),h},l.rotateY=m.USE_SIMD?l.SIMD.rotateY:l.scalar.rotateY,l.scalar.rotateZ=function(h,d,b){var g=Math.sin(b);b=Math.cos(b);var k=d[0],f=d[1],a=d[2],e=d[3],c=d[4],q=d[5],t=d[6],r=d[7];return d!==h&&(h[8]=d[8],h[9]=d[9],h[10]=d[10],
h[11]=d[11],h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15]),h[0]=k*b+c*g,h[1]=f*b+q*g,h[2]=a*b+t*g,h[3]=e*b+r*g,h[4]=c*b-k*g,h[5]=q*b-f*g,h[6]=t*b-a*g,h[7]=r*b-e*g,h},l.SIMD.rotateZ=function(h,d,b){var g=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));d!==h&&(h[8]=d[8],h[9]=d[9],h[10]=d[10],h[11]=d[11],h[12]=d[12],h[13]=d[13],h[14]=d[14],h[15]=d[15]);var k=SIMD.Float32x4.load(d,0);d=SIMD.Float32x4.load(d,4);return SIMD.Float32x4.store(h,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(k,
b),SIMD.Float32x4.mul(d,g))),SIMD.Float32x4.store(h,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,b),SIMD.Float32x4.mul(k,g))),h},l.rotateZ=m.USE_SIMD?l.SIMD.rotateZ:l.scalar.rotateZ,l.fromTranslation=function(h,d){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=d[0],h[13]=d[1],h[14]=d[2],h[15]=1,h},l.fromScaling=function(h,d){return h[0]=d[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=d[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=d[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,
h[15]=1,h},l.fromRotation=function(h,d,b){var g,k,f,a=b[0],e=b[1];b=b[2];var c=Math.sqrt(a*a+e*e+b*b);return Math.abs(c)<m.EPSILON?null:(c=1/c,a*=c,e*=c,b*=c,g=Math.sin(d),k=Math.cos(d),f=1-k,h[0]=a*a*f+k,h[1]=e*a*f+b*g,h[2]=b*a*f-e*g,h[3]=0,h[4]=a*e*f-b*g,h[5]=e*e*f+k,h[6]=b*e*f+a*g,h[7]=0,h[8]=a*b*f+e*g,h[9]=e*b*f-a*g,h[10]=b*b*f+k,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h)},l.fromXRotation=function(h,d){var b=Math.sin(d);d=Math.cos(d);return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=d,h[6]=b,h[7]=
0,h[8]=0,h[9]=-b,h[10]=d,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},l.fromYRotation=function(h,d){var b=Math.sin(d);d=Math.cos(d);return h[0]=d,h[1]=0,h[2]=-b,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=b,h[9]=0,h[10]=d,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},l.fromZRotation=function(h,d){var b=Math.sin(d);d=Math.cos(d);return h[0]=d,h[1]=b,h[2]=0,h[3]=0,h[4]=-b,h[5]=d,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},l.fromRotationTranslation=function(h,d,b){var g=d[0],
k=d[1],f=d[2],a=d[3],e=g+g,c=k+k,q=f+f;d=g*e;var t=g*c,g=g*q,r=k*c,k=k*q,f=f*q,e=a*e,c=a*c,a=a*q;return h[0]=1-(r+f),h[1]=t+a,h[2]=g-c,h[3]=0,h[4]=t-a,h[5]=1-(d+f),h[6]=k+e,h[7]=0,h[8]=g+c,h[9]=k-e,h[10]=1-(d+r),h[11]=0,h[12]=b[0],h[13]=b[1],h[14]=b[2],h[15]=1,h},l.getTranslation=function(h,d){return h[0]=d[12],h[1]=d[13],h[2]=d[14],h},l.getRotation=function(h,d){var b=d[0]+d[5]+d[10],g=0;return 0<b?(g=2*Math.sqrt(b+1),h[3]=.25*g,h[0]=(d[6]-d[9])/g,h[1]=(d[8]-d[2])/g,h[2]=(d[1]-d[4])/g):d[0]>d[5]&
d[0]>d[10]?(g=2*Math.sqrt(1+d[0]-d[5]-d[10]),h[3]=(d[6]-d[9])/g,h[0]=.25*g,h[1]=(d[1]+d[4])/g,h[2]=(d[8]+d[2])/g):d[5]>d[10]?(g=2*Math.sqrt(1+d[5]-d[0]-d[10]),h[3]=(d[8]-d[2])/g,h[0]=(d[1]+d[4])/g,h[1]=.25*g,h[2]=(d[6]+d[9])/g):(g=2*Math.sqrt(1+d[10]-d[0]-d[5]),h[3]=(d[1]-d[4])/g,h[0]=(d[8]+d[2])/g,h[1]=(d[6]+d[9])/g,h[2]=.25*g),h},l.fromRotationTranslationScale=function(h,d,b,g){var k=d[0],f=d[1],a=d[2],e=d[3],c=k+k,q=f+f,t=a+a;d=k*c;var r=k*q,k=k*t,u=f*q,f=f*t,a=a*t,c=e*c,q=e*q,e=e*t,t=g[0],v=g[1];
g=g[2];return h[0]=(1-(u+a))*t,h[1]=(r+e)*t,h[2]=(k-q)*t,h[3]=0,h[4]=(r-e)*v,h[5]=(1-(d+a))*v,h[6]=(f+c)*v,h[7]=0,h[8]=(k+q)*g,h[9]=(f-c)*g,h[10]=(1-(d+u))*g,h[11]=0,h[12]=b[0],h[13]=b[1],h[14]=b[2],h[15]=1,h},l.fromRotationTranslationScaleOrigin=function(h,d,b,g,k){var f=d[0],a=d[1],e=d[2],c=d[3],q=f+f,t=a+a,r=e+e;d=f*q;var u=f*t,f=f*r,v=a*t,a=a*r,e=e*r,q=c*q,t=c*t,c=c*r,r=g[0],x=g[1];g=g[2];var y=k[0],n=k[1];k=k[2];return h[0]=(1-(v+e))*r,h[1]=(u+c)*r,h[2]=(f-t)*r,h[3]=0,h[4]=(u-c)*x,h[5]=(1-(d+
e))*x,h[6]=(a+q)*x,h[7]=0,h[8]=(f+t)*g,h[9]=(a-q)*g,h[10]=(1-(d+v))*g,h[11]=0,h[12]=b[0]+y-(h[0]*y+h[4]*n+h[8]*k),h[13]=b[1]+n-(h[1]*y+h[5]*n+h[9]*k),h[14]=b[2]+k-(h[2]*y+h[6]*n+h[10]*k),h[15]=1,h},l.fromQuat=function(h,d){var b=d[0],g=d[1],k=d[2];d=d[3];var f=b+b,a=g+g,e=k+k,b=b*f,c=g*f,g=g*a,q=k*f,t=k*a,k=k*e,f=d*f,a=d*a;d*=e;return h[0]=1-g-k,h[1]=c+d,h[2]=q-a,h[3]=0,h[4]=c-d,h[5]=1-b-k,h[6]=t+f,h[7]=0,h[8]=q+a,h[9]=t-f,h[10]=1-b-g,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},l.frustum=function(h,
d,b,g,k,f,a){var e=1/(b-d),c=1/(k-g),q=1/(f-a);return h[0]=2*f*e,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=2*f*c,h[6]=0,h[7]=0,h[8]=(b+d)*e,h[9]=(k+g)*c,h[10]=(a+f)*q,h[11]=-1,h[12]=0,h[13]=0,h[14]=a*f*2*q,h[15]=0,h},l.perspective=function(h,d,b,g,k){d=1/Math.tan(d/2);var f=1/(g-k);return h[0]=d/b,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=d,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=(k+g)*f,h[11]=-1,h[12]=0,h[13]=0,h[14]=2*k*g*f,h[15]=0,h},l.perspectiveFromFieldOfView=function(h,d,b,g){var k=Math.tan(d.upDegrees*Math.PI/180),
f=Math.tan(d.downDegrees*Math.PI/180),a=Math.tan(d.leftDegrees*Math.PI/180);d=Math.tan(d.rightDegrees*Math.PI/180);var e=2/(a+d),c=2/(k+f);return h[0]=e,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=c,h[6]=0,h[7]=0,h[8]=-((a-d)*e*.5),h[9]=(k-f)*c*.5,h[10]=g/(b-g),h[11]=-1,h[12]=0,h[13]=0,h[14]=g*b/(b-g),h[15]=0,h},l.ortho=function(h,d,b,g,k,f,a){var e=1/(d-b),c=1/(g-k),q=1/(f-a);return h[0]=-2*e,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*c,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*q,h[11]=0,h[12]=(d+b)*e,h[13]=(k+g)*c,h[14]=
(a+f)*q,h[15]=1,h},l.lookAt=function(h,d,b,g){var k,f,a,e,c,q,t,r,u,v,x=d[0],y=d[1];d=d[2];var n=g[0],w=g[1];g=g[2];var z=b[0],C=b[1];b=b[2];return Math.abs(x-z)<m.EPSILON&&Math.abs(y-C)<m.EPSILON&&Math.abs(d-b)<m.EPSILON?l.identity(h):(t=x-z,r=y-C,u=d-b,v=1/Math.sqrt(t*t+r*r+u*u),t*=v,r*=v,u*=v,k=w*u-g*r,f=g*t-n*u,a=n*r-w*t,v=Math.sqrt(k*k+f*f+a*a),v?(v=1/v,k*=v,f*=v,a*=v):(k=0,f=0,a=0),e=r*a-u*f,c=u*k-t*a,q=t*f-r*k,v=Math.sqrt(e*e+c*c+q*q),v?(v=1/v,e*=v,c*=v,q*=v):(e=0,c=0,q=0),h[0]=k,h[1]=e,h[2]=
t,h[3]=0,h[4]=f,h[5]=c,h[6]=r,h[7]=0,h[8]=a,h[9]=q,h[10]=u,h[11]=0,h[12]=-(k*x+f*y+a*d),h[13]=-(e*x+c*y+q*d),h[14]=-(t*x+r*y+u*d),h[15]=1,h)},l.str=function(h){return"mat4("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+", "+h[9]+", "+h[10]+", "+h[11]+", "+h[12]+", "+h[13]+", "+h[14]+", "+h[15]+")"},l.frob=function(h){return Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2)+Math.pow(h[2],2)+Math.pow(h[3],2)+Math.pow(h[4],2)+Math.pow(h[5],2)+Math.pow(h[6],2)+Math.pow(h[7],
2)+Math.pow(h[8],2)+Math.pow(h[9],2)+Math.pow(h[10],2)+Math.pow(h[11],2)+Math.pow(h[12],2)+Math.pow(h[13],2)+Math.pow(h[14],2)+Math.pow(h[15],2))},l.add=function(h,d,b){return h[0]=d[0]+b[0],h[1]=d[1]+b[1],h[2]=d[2]+b[2],h[3]=d[3]+b[3],h[4]=d[4]+b[4],h[5]=d[5]+b[5],h[6]=d[6]+b[6],h[7]=d[7]+b[7],h[8]=d[8]+b[8],h[9]=d[9]+b[9],h[10]=d[10]+b[10],h[11]=d[11]+b[11],h[12]=d[12]+b[12],h[13]=d[13]+b[13],h[14]=d[14]+b[14],h[15]=d[15]+b[15],h},l.subtract=function(h,d,b){return h[0]=d[0]-b[0],h[1]=d[1]-b[1],
h[2]=d[2]-b[2],h[3]=d[3]-b[3],h[4]=d[4]-b[4],h[5]=d[5]-b[5],h[6]=d[6]-b[6],h[7]=d[7]-b[7],h[8]=d[8]-b[8],h[9]=d[9]-b[9],h[10]=d[10]-b[10],h[11]=d[11]-b[11],h[12]=d[12]-b[12],h[13]=d[13]-b[13],h[14]=d[14]-b[14],h[15]=d[15]-b[15],h},l.sub=l.subtract,l.multiplyScalar=function(h,d,b){return h[0]=d[0]*b,h[1]=d[1]*b,h[2]=d[2]*b,h[3]=d[3]*b,h[4]=d[4]*b,h[5]=d[5]*b,h[6]=d[6]*b,h[7]=d[7]*b,h[8]=d[8]*b,h[9]=d[9]*b,h[10]=d[10]*b,h[11]=d[11]*b,h[12]=d[12]*b,h[13]=d[13]*b,h[14]=d[14]*b,h[15]=d[15]*b,h},l.multiplyScalarAndAdd=
function(h,d,b,g){return h[0]=d[0]+b[0]*g,h[1]=d[1]+b[1]*g,h[2]=d[2]+b[2]*g,h[3]=d[3]+b[3]*g,h[4]=d[4]+b[4]*g,h[5]=d[5]+b[5]*g,h[6]=d[6]+b[6]*g,h[7]=d[7]+b[7]*g,h[8]=d[8]+b[8]*g,h[9]=d[9]+b[9]*g,h[10]=d[10]+b[10]*g,h[11]=d[11]+b[11]*g,h[12]=d[12]+b[12]*g,h[13]=d[13]+b[13]*g,h[14]=d[14]+b[14]*g,h[15]=d[15]+b[15]*g,h},l.exactEquals=function(h,d){return h[0]===d[0]&&h[1]===d[1]&&h[2]===d[2]&&h[3]===d[3]&&h[4]===d[4]&&h[5]===d[5]&&h[6]===d[6]&&h[7]===d[7]&&h[8]===d[8]&&h[9]===d[9]&&h[10]===d[10]&&h[11]===
d[11]&&h[12]===d[12]&&h[13]===d[13]&&h[14]===d[14]&&h[15]===d[15]},l.equals=function(h,d){var b=h[0],g=h[1],k=h[2],f=h[3],a=h[4],e=h[5],c=h[6],q=h[7],t=h[8],r=h[9],u=h[10],v=h[11],x=h[12],y=h[13],n=h[14];h=h[15];var w=d[0],z=d[1],l=d[2],B=d[3],F=d[4],G=d[5],N=d[6],M=d[7],R=d[8],P=d[9],Q=d[10],T=d[11],O=d[12],S=d[13],H=d[14];d=d[15];return Math.abs(b-w)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(w))&&Math.abs(g-z)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(k-l)<=m.EPSILON*Math.max(1,
Math.abs(k),Math.abs(l))&&Math.abs(f-B)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(B))&&Math.abs(a-F)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(F))&&Math.abs(e-G)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(G))&&Math.abs(c-N)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(N))&&Math.abs(q-M)<=m.EPSILON*Math.max(1,Math.abs(q),Math.abs(M))&&Math.abs(t-R)<=m.EPSILON*Math.max(1,Math.abs(t),Math.abs(R))&&Math.abs(r-P)<=m.EPSILON*Math.max(1,Math.abs(r),Math.abs(P))&&Math.abs(u-Q)<=m.EPSILON*Math.max(1,Math.abs(u),
Math.abs(Q))&&Math.abs(v-T)<=m.EPSILON*Math.max(1,Math.abs(v),Math.abs(T))&&Math.abs(x-O)<=m.EPSILON*Math.max(1,Math.abs(x),Math.abs(O))&&Math.abs(y-S)<=m.EPSILON*Math.max(1,Math.abs(y),Math.abs(S))&&Math.abs(n-H)<=m.EPSILON*Math.max(1,Math.abs(n),Math.abs(H))&&Math.abs(h-d)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(d))},l})},"esri/views/webgl/BufferObject":function(){define(["require","exports"],function(m,l){return function(){function h(d,b,g,k,f){this._glName=this._context=null;this._bufferType=
void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=d;this._bufferType=b;this._usage=g;this._id=h._nextId++;this._glName=this._context.gl.createBuffer();k&&this.setData(k,f)}return h.createIndex=function(d,b,g,k){return new h(d,34963,b,g,k)},h.createVertex=function(d,b,g){return new h(d,34962,b,g)},Object.defineProperty(h.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"glName",{get:function(){return this._glName},
enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,
"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0}),h.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context=null)},h.prototype.setData=function(d,b){if(d){if("number"==typeof d){if(0>d&&console.error("Buffer size cannot be negative!"),34963===this._bufferType&&b)switch(this._indexType=b,this._size=d,b){case 5123:d*=2;
break;case 5125:d*=4}}else b=d.byteLength,d instanceof Uint16Array&&(b/=2,this._indexType=5123),d instanceof Uint32Array&&(b/=4,this._indexType=5125),this._size=b;b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,d,this._usage);this._context.bindVAO(b)}},h.prototype.setSubData=function(d,b,g,k){if(void 0===b&&(b=0),void 0===g&&(g=0),d){(0>b||b>=this._size)&&console.error("offset is out of range!");var f=b,a=g,e=k,
c=d.byteLength;d instanceof Uint16Array&&(c/=2,f*=2,a*=2,e*=2);d instanceof Uint32Array&&(c/=4,f*=4,a*=4,e*=4);void 0===k&&(k=c-1);g>=k&&console.error("end must be bigger than start!");b+g-k>this._size&&console.error("An attempt to write beyond the end of the buffer!");b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferSubData(this._bufferType,f,(d instanceof ArrayBuffer?d:d.buffer).slice(a,e));this._context.bindVAO(b)}},h._nextId=0,h}()})},
"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./Evented"],function(m,l,h,d){return function(b){function d(){var d=null!==b&&b.apply(this,arguments)||this;return d._renderRequestedCalled=!1,d._attached=!1,d._opacity=1,d.renderRequested=!1,d._visible=!0,d}return h(d,b),Object.defineProperty(d.prototype,"attached",{get:function(){return this._attached},set:function(b){this._attached!==b&&(this._attached=b,b?this.hasEventListener("attach")&&
this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"opacity",{get:function(){return this._opacity},set:function(b){this._opacity!==b&&(this._opacity=b,this.requestRender())},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"visible",{get:function(){return this._visible},set:function(b){this._visible!==b&&(this._visible=b,this.requestRender())},enumerable:!0,configurable:!0}),d.prototype.attach=
function(b){return!0},d.prototype.detach=function(b){},d.prototype.processRender=function(b){this._renderRequestedCalled=!1;this.doRender(b);this._renderRequestedCalled||(this.renderRequested=!1);this.hasEventListener("post-render")&&this.emit("post-render")},d.prototype.requestRender=function(){var b=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestChildRender(this);b!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")},
d.prototype.dispose=function(){},d}(d.Evented)})},"esri/views/2d/engine/Evented":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","dojo/aspect","dojo/on"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function g(){}return g.prototype.on=function(b,f){return d.after(this,"on"+b,f,!0)},g.prototype.once=function(d,f){return b.once(this,d,f)},g.prototype.emit=function(d){b.emit(this,d,this)},g.prototype.hasEventListener=function(b){b="on"+
b;return!(!this[b]||!this[b].after)},g}();l.Evented=m;l.EventedMixin=function(g){return function(g){function f(){return null!==g&&g.apply(this,arguments)||this}return h(f,g),f.prototype.on=function(a,b){return d.after(this,"on"+a,b,!0)},f.prototype.once=function(a,e){return b.once(this,a,e)},f.prototype.emit=function(a,e){b.emit(this,a,e)},f.prototype.hasEventListener=function(a){a="on"+a;return!(!this[a]||!this[a].after)},f}(g)}})},"esri/views/vectorTiles/RenderBucket":function(){define(["require",
"exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(){return function(b){this.type=b}}();l.RenderBucket=m;d=function(b){function d(){var d=b.call(this,2)||this;return d.triangleElementStart=0,d.triangleElementCount=0,d.joinStart=0,d.joinCount=0,d}return h(d,b),d.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.joinCount},d}(m);l.LineRenderBucket=d;d=function(b){function d(){var d=
b.call(this,1)||this;return d.triangleElementStart=0,d.triangleElementCount=0,d.outlineElementStart=0,d.outlineElementCount=0,d}return h(d,b),d.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.outlineElementCount},d}(m);l.FillRenderBucket=d;d=function(b){function d(){var d=b.call(this,3)||this;return d.markerPerPageElementsMap=new Map,d.glyphPerPageElementsMap=new Map,d.isSDF=!1,d}return h(d,b),d.prototype.hasData=function(){return 0<this.markerPerPageElementsMap.size||0<this.glyphPerPageElementsMap.size},
d}(m);l.SymbolRenderBucket=d;m=function(b){function d(){return b.call(this,0)||this}return h(d,b),d.prototype.hasData=function(){return!0},d}(m);l.BackgroundRenderBucket=m})},"esri/views/vectorTiles/renderers/Renderer":function(){define("require exports ../../webgl/FramebufferObject ../../../core/libs/gl-matrix/mat4 ../GeometryUtils ./BackgroundRenderer ./LineRenderer ./FillRenderer ./SymbolRenderer ./TileInfoRenderer ./FadeRecorder".split(" "),function(m,l,h,d,b,g,k,f,a,e,c){return function(){function q(){this._extrudeRotateVector=
new Float32Array([0,0,1]);this._extrudeScaleVector=new Float32Array([1,1,1]);this._state={rotation:0,width:0,height:0};this._cachedRotation=this._cachedHeight=this._cachedWidth=0}return q.prototype.initialize=function(b,d,q){void 0===q&&(q=!0);this._SpriteMosaic=b;this._glyphMosaic=d;this._ignoreSpeed=!q;this._backgroundRenderer=new g;this._lineRenderer=new k;this._fillRenderer=new f;this._symbolRenderer=new a;this._tileInfoRenderer=new e;this._fadeRecorder=new c.FadeRecorder(300);this._extrudeMatrix=
new Float32Array(16);this._extrudeNoRotationMatrix=new Float32Array(16);this._backgroundColor=new Float32Array([1,0,0,1])},q.prototype.dispose=function(){this._backgroundRenderer&&(this._backgroundRenderer.dispose(),this._backgroundRenderer=null);this._lineRenderer&&(this._lineRenderer.dispose(),this._lineRenderer=null);this._fillRenderer&&(this._fillRenderer.dispose(),this._fillRenderer=null);this._symbolRenderer&&(this._symbolRenderer.dispose(),this._symbolRenderer=null);this._tileInfoRenderer&&
(this._tileInfoRenderer.dispose(),this._tileInfoRenderer=null);this._hittestFBO&&(this._hittestFBO.dispose(),this._hittestFBO=null)},q.prototype.setStateParams=function(a,c,e){this._fadeRecorder.recordLevel(e);this._state=a;(this._state.width!==this._cachedWidth||this._state.height!==this._cachedHeight||this._state.rotation!==this._cachedRotation)&&(this._extrudeScaleVector[0]=2/a.width,this._extrudeScaleVector[1]=-2/a.height,d.identity(this._extrudeMatrix),d.rotate(this._extrudeMatrix,this._extrudeMatrix,
-a.rotation*b.C_DEG_TO_RAD,this._extrudeRotateVector),d.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),d.transpose(this._extrudeMatrix,this._extrudeMatrix),d.identity(this._extrudeNoRotationMatrix),d.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),d.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation)},
q.prototype.drawClippingMasks=function(a,c){if(0!==c.length){a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setClearStencil(0);a.clear(a.gl.STENCIL_BUFFER_BIT);for(var b=0;b<c.length;b++){var e=c[b];e.attached&&e.visible&&(a.setStencilFunctionSeparate(1032,519,e.stencilData.reference,e.stencilData.mask),this._backgroundRenderer.renderSolidColor(a,{u_matrix:e.tileTransform.transform,
u_normalized_origin:e.tileTransform.displayCoord,u_coord_range:e.coordRange,u_depth:0,u_color:this._backgroundColor}))}a.setColorMask(!0,!0,!0,!0);a.setBlendingEnabled(!0)}},q.prototype.renderDebug=function(a,c){var b=c.key;this._backgroundColor.set([b.col%2,b.row%2,0===b.col%2&&0===b.row%2?1:0,.5]);this._backgroundRenderer.renderSolidColor(a,{u_matrix:c.tileTransform.transform,u_normalized_origin:c.tileTransform.displayCoord,u_coord_range:c.coordRange,u_depth:0,u_color:this._backgroundColor})},q.prototype.renderBucket=
function(a,c,b,e,d,f,n,g){if(!(void 0!==n.minzoom&&n.minzoom>b||void 0!==n.maxzoom&&n.maxzoom<=b))switch(c.type){case 0:2!==d&&this._renderBackground(a,c,b,d,f,n,g);break;case 1:2!==d&&this._renderFill(a,c,b,d,f,n,g);break;case 2:1!==d&&3!==d||this._renderLine(a,c,b,d,f,n,g);break;case 3:2!==d&&3!==d||this._renderSymbol(a,c,b,d,e,f,n,g)}},q.prototype.renderTileInfo=function(a,c){this._tileInfoRenderer.render(a,c)},q.prototype.needsRedraw=function(){return this._fadeRecorder.needsRedraw()},q.prototype.hitTest=
function(a,c,b,e,d,f,n){var g=[0,0],k=[0,0],q=a.state;q.toMap(g,[0,0]);q.toMap(k,[f,f]);c=e.filter(function(a){return!(g[0]>a.bounds[2]||k[0]<a.bounds[0]||g[1]<a.bounds[3]||k[1]>a.bounds[1])});if(0===c.length)return[];c.sort(function(a,c){return a.key.level-c.key.level});b=c.length;for(e=1;b>=e;e++){var r=c[e-1];r.attached&&(r.stencilData.reference=e,r.stencilData.mask=255)}n(q,d,c);d=a.context;this._hittestFBO||(this._hittestFBO=h.create(d,{colorTarget:0,depthStencilTarget:3,width:f,height:f}));
n=d.getViewport();q=d.getBoundFramebufferObject();d.bindFramebuffer(this._hittestFBO);d.setViewport(0,0,f,f);e=d.gl;d.setDepthWriteEnabled(!0);d.setStencilWriteMask(255);d.setClearColor(1,1,1,1);d.setClearDepth(1);d.setClearStencil(0);d.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT);d.setDepthWriteEnabled(!1);this.drawClippingMasks(d,c);d.setBlendingEnabled(!1);d.setStencilWriteMask(0);d.setStencilOp(7680,7680,7681);d.setDepthFunction(515);d.setDepthTestEnabled(!0);d.setDepthWriteEnabled(!0);
d.setStencilTestEnabled(!0);for(e=0;b>e;e++)r=c[e],r.attached&&r.doRender(a);d.setStencilTestEnabled(!1);d.setDepthTestEnabled(!1);this._readbackBuffer||(this._readbackBuffer=new Uint8Array(4*f*f),this._readbackBuffer32=new Uint32Array(this._readbackBuffer.buffer));this._hittestFBO.readPixels(0,0,f,f,6408,5121,this._readbackBuffer);a=new Set;f*=f;c=this._readbackBuffer32[Math.round(f/2)];4294967295!==c&&a.add(c);for(e=0;f>e;e++)c=this._readbackBuffer32[e],4294967295!==c&&a.add(c);d.bindFramebuffer(q);
d.setViewport(n.x,n.y,n.width,n.height);var t=[];return a.forEach(function(a){t.push(a)}),t},q.prototype._renderBackground=function(a,c,b,e,d,f,n){this._backgroundRenderer.render(a,c,b,e,d,f,this._SpriteMosaic,this._SpriteMosaic.pixelRatio,n)},q.prototype._renderLine=function(a,c,b,e,d,f,n){this._lineRenderer.render(a,c,b,e,this._state,d,f,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,n)},q.prototype._renderFill=function(a,c,b,e,d,f,n){this._fillRenderer.render(a,c,b,this._state.rotation,
e,d,f,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,n)},q.prototype._renderSymbol=function(a,c,b,e,d,f,n,g){var w=!0;d===f.key.level&&(w=!1);a.setStencilTestEnabled(w);this._symbolRenderer.render(a,c,b,e,this._state.rotation,this._fadeRecorder.getFadeValues(this._ignoreSpeed),f,n,this._SpriteMosaic,this._glyphMosaic,this._extrudeMatrix,this._extrudeNoRotationMatrix,this._SpriteMosaic.pixelRatio,g)},q}()})},"esri/views/webgl/FramebufferObject":function(){define(["require","exports",
"./Texture"],function(m,l,h){return function(){function d(b,g,k,f){if(this._context=null,this._glName=null,this._depthAttachment=null,this._stencilAttachment=null,this._colorAttachment=null,this._initialized=!1,this._context=b,this._desc={colorTarget:g.colorTarget,depthStencilTarget:g.depthStencilTarget,width:g.width,height:g.height,multisampled:g.multisampled},this._id=d._nextId++,k)b=void 0,k instanceof h?(this._colorAttachment=k,b=k.descriptor):(b=k,this._colorAttachment=new h(this._context,b)),
0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),d._validateTextureDimensions(b,this._desc);f&&(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),k=void 0,f instanceof h?(this._depthStencilTexture=f,k=this._depthStencilTexture.descriptor):(k=f,this._depthStencilTexture=
new h(this._context,k)),d._validateTextureDimensions(k,this._desc))}return d.create=function(b,g){return new d(b,g)},d.createWithAttachments=function(b,g,k,f){return new d(b,k,g,f)},Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0}),
Object.defineProperty(d.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof h?this._colorAttachment:null},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this._desc.height},
enumerable:!0,configurable:!0}),d.prototype.dispose=function(){this._context&&this._glName&&(this._disposeColorAttachment(),this._disposeDepthStencilAttachments(),this._context.gl.deleteFramebuffer(this._glName),this._glName=null)},d.prototype.attachColorTexture=function(b){if(b){if(d._validateTextureDimensions(b.descriptor,this._desc),this._disposeColorAttachment(),this._initialized){this._context.bindFramebuffer(this);var g=this._context.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,
g.TEXTURE_2D,b.glName,0)}this._colorAttachment=b}},d.prototype.detachColorTexture=function(){var b=void 0;if(this._colorAttachment instanceof h){if(b=this._colorAttachment,this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;this._context.gl.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0)}this._colorAttachment=null}return b},d.prototype.attachDepthStencilTexture=function(b){if(b){var g=b.descriptor;if(34041!==g.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),
34042!==g.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!"),this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),d._validateTextureDimensions(g,this._desc),4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4),this._disposeDepthStencilAttachments(),this._initialized)this._context.bindFramebuffer(this),g=this._context.gl,g.framebufferTexture2D(g.FRAMEBUFFER,
g.DEPTH_STENCIL_ATTACHMENT,g.TEXTURE_2D,b.glName,0);this._depthStencilTexture=b}},d.prototype.detachDepthStencilTexture=function(){var b=this._depthStencilTexture;if(b&&this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;this._context.gl.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.TEXTURE_2D,null,0)}return this._depthStencilTexture=null,b},d.prototype.copyToTexture=function(b,d,k,f,a,e,c){(0>b||0>d||0>a||0>e)&&console.error("Offsets cannot be negative!");
(0>=k||0>=f)&&console.error("Copy width and height must be greater than zero!");var g=this._desc,h=c.descriptor;3553!==c.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");(b+k>g.width||d+f>g.height||a+k>h.width||e+f>h.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");g=this._context;g.bindTexture(c);g.bindFramebuffer(this);g.gl.copyTexSubImage2D(3553,0,a,e,b,d,k,f)},d.prototype.readPixels=function(b,d,k,f,a,e,c){(0>=
k||0>=f)&&console.error("Copy width and height must be greater than zero!");c||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(b,d,k,f,a,e,c)},d.prototype.resize=function(b,g){var k=this._desc;if(k.width!==b||k.height!==g){if(!this._initialized){if(k.width=b,k.height=g,this._colorAttachment instanceof h)k=this._colorAttachment,k.resize(b,g);return void(this._depthStencilTexture&&this._depthStencilTexture.resize(b,g))}if(k.width=b,
k.height=g,this._colorAttachment instanceof h){var k=this._colorAttachment,f=k.descriptor;f.width=b;f.height=g;this._colorAttachment.dispose();this._colorAttachment=new h(this._context,f);d._validateTextureDimensions(k.descriptor,this._desc)}else this._colorAttachment&&this._disposeColorAttachment();null!=this._depthStencilTexture?(f=this._depthStencilTexture.descriptor,f.width=b,f.height=g,this._depthStencilTexture.dispose(),this._depthStencilTexture=new h(this._context,f)):(this._depthAttachment||
this._stencilAttachment)&&this._disposeDepthStencilAttachments();this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null);this._initialized=!1}},d.prototype.initialize=function(){if(this._initialized)return!1;var b=this._context.gl;this._glName&&b.deleteFramebuffer(this._glName);var d=b.createFramebuffer(),k=this._desc;if(b.bindFramebuffer(b.FRAMEBUFFER,d),!this._colorAttachment)if(0===k.colorTarget)this._colorAttachment=new h(this._context,{target:3553,pixelFormat:6408,
dataType:5121,samplingMode:9728,wrapMode:33071,width:k.width,height:k.height});else{var f=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,f);b.renderbufferStorage(b.RENDERBUFFER,b.RGBA4,k.width,k.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.RENDERBUFFER,f);this._colorAttachment=f}this._colorAttachment instanceof h&&b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,this._colorAttachment.glName,0);switch(k.depthStencilTarget){case 1:case 3:f=b.createRenderbuffer();
b.bindRenderbuffer(b.RENDERBUFFER,f);var a=1===k.depthStencilTarget?b.DEPTH_ATTACHMENT:b.DEPTH_STENCIL_ATTACHMENT;b.renderbufferStorage(b.RENDERBUFFER,1===k.depthStencilTarget?b.DEPTH_COMPONENT16:b.DEPTH_STENCIL,k.width,k.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,a,b.RENDERBUFFER,f);this._depthAttachment=f;break;case 2:f=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,f);b.renderbufferStorage(b.RENDERBUFFER,b.STENCIL_INDEX8,k.width,k.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,
b.STENCIL_ATTACHMENT,b.RENDERBUFFER,f);this._stencilAttachment=f;break;case 4:this._depthStencilTexture||(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new h(this._context,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:k.width,height:k.height})),b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,
b.TEXTURE_2D,this._depthStencilTexture.glName,0)}return b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=d,this._initialized=!0,!0},d.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof h){var b=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0)}b.dispose()}else this._colorAttachment instanceof
WebGLRenderbuffer&&(b=this._colorAttachment,d=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(b));this._colorAttachment=null},d.prototype._disposeDepthStencilAttachments=function(){var b=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,1===this._desc.depthStencilTarget?
d.DEPTH_ATTACHMENT:d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,null)}b.deleteRenderbuffer(this._depthAttachment);this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),d=this._context.gl,d.framebufferRenderbuffer(d.FRAMEBUFFER,d.STENCIL_ATTACHMENT,d.RENDERBUFFER,null)),b.deleteRenderbuffer(this._stencilAttachment),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),b=this._context.gl,
b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)},d._validateTextureDimensions=function(b,d){console.assert(0<=b.width&&0<=b.height);3553!==b.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==d.width&&0<=d.width&&void 0!==d.height&&0<=d.height?(d.width!==b.width||d.height!==b.height)&&console.error("Color attachment texture must match the framebuffer's!"):(d.width=b.width,d.height=
b.height)},d._nextId=0,d}()})},"esri/views/vectorTiles/renderers/BackgroundRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../webgl/VertexArrayObject ../../webgl/BufferObject ../MemoryBuffer ../../webgl/ShaderVariations ./vtShaderSnippets ./rendererUtils".split(" "),function(m,l,h,d,b,g,k,f,a,e){return function(){function c(){this._solidAttributeLocations={a_pos:0};this._attributeLocations={a_pos:0,a_id:1};this._patternMatrix=h.create();
this._color=d.create();this._rendererInitialized=this._solidrendererInitialized=!1;this._color.set([1,0,0,1])}return c.prototype.dispose=function(){this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)},c.prototype.renderSolidColor=function(a,c){this._solidrendererInitialized||this._initializeSolidRenderer(a);a.bindVAO(this._solidVertexArrayObject);var b=this._shaderVariations.getProgram([!1,
!1],void 0,void 0,this._solidAttributeLocations);a.bindProgram(b);b.setUniformMatrix4fv("u_transformMatrix",c.u_matrix);b.setUniform2fv("u_normalized_origin",c.u_normalized_origin);b.setUniform1f("u_coord_range",c.u_coord_range||4096);b.setUniform1f("u_depth",c.u_depth||0);b.setUniform4fv("u_color",c.u_color||this._color);a.drawArrays(5,0,4);a.bindVAO()},c.prototype.render=function(a,c,b,d,f,g,k,n,w){this._rendererInitialized||this._initialize(a);var q=g.getPaintValue("background-color",b);w*=g.getPaintValue("background-opacity",
b);var r=g.getPaintValue("background-pattern",b),t=void 0!==r,u=q[3]*w,v=t||1>u;if(!(v&&0===d||!v&&1===d)){v=3===d;d=this._shaderVariations.getProgram([t,v],void 0,void 0,this._attributeLocations);if(a.bindVAO(this._vertexArrayObject),a.bindProgram(d),d.setUniform1f("u_coord_range",f.coordRange),d.setUniform1f("u_depth",g.z||0),d.setUniformMatrix4fv("u_transformMatrix",f.tileTransform.transform),d.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),t){g=k.getMosaicItemPosition(r,!0);
if(!g)return;b=f.coordRange/512/Math.pow(2,Math.floor(b)-f.key.level)/n;h.identity(this._patternMatrix);f=1/(g.size[1]*b);this._patternMatrix[0]=1/(g.size[0]*b);this._patternMatrix[4]=f;k.bind(a,9729,0);d.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix);d.setUniform1f("u_opacity",w);d.setUniform2f("u_pattern_tl",g.tl[0],g.tl[1]);d.setUniform2f("u_pattern_br",g.br[0],g.br[1]);d.setUniform1i("u_texture",0)}else this._color[0]=u*q[0],this._color[1]=u*q[1],this._color[2]=u*q[2],this._color[3]=
u,d.setUniform4fv("u_color",this._color);v&&(c=e.int32To4Bytes(c.layerID),d.setUniform4f("u_id",c[0],c[1],c[2],c[3]));a.drawArrays(5,0,4);a.bindVAO()}},c.prototype._initializeSolidRenderer=function(c){if(this._solidrendererInitialized)return!0;if(!this._shaderVariations){var e=new f("background",["backgroundVS","backgroundFS"],[],a,c);e.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN");e.addDefine("ID","ID",[!0,!0],"ID");this._shaderVariations=e}e=new Int8Array([0,0,1,0,0,1,1,1]);e=g.createVertex(c,
35044,e);return this._solidVertexArrayObject=new b(c,{a_pos:0},{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:e}),this._solidrendererInitialized=!0,!0},c.prototype._initialize=function(c){if(this._rendererInitialized)return!0;if(!this._shaderVariations){var e=new f("background",["backgroundVS","backgroundFS"],[],a,c);e.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN");e.addDefine("ID","ID",[!0,!0],"ID");this._shaderVariations=e}e=[];e.push(k.i1616to32(0,
0));e.push(k.i1616to32(1,0));e.push(k.i1616to32(0,1));e.push(k.i1616to32(1,1));e=new Uint32Array(e);e=g.createVertex(c,35044,e);return this._vertexArrayObject=new b(c,{a_pos:0},{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:e}),this._rendererInitialized=!0,!0},c}()})},"esri/core/libs/gl-matrix/mat3":function(){define(["./common"],function(m){var l={};return l.create=function(){var h=new m.ARRAY_TYPE(9);return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=
0,h[6]=0,h[7]=0,h[8]=1,h},l.fromMat4=function(h,d){return h[0]=d[0],h[1]=d[1],h[2]=d[2],h[3]=d[4],h[4]=d[5],h[5]=d[6],h[6]=d[8],h[7]=d[9],h[8]=d[10],h},l.clone=function(h){var d=new m.ARRAY_TYPE(9);return d[0]=h[0],d[1]=h[1],d[2]=h[2],d[3]=h[3],d[4]=h[4],d[5]=h[5],d[6]=h[6],d[7]=h[7],d[8]=h[8],d},l.copy=function(h,d){return h[0]=d[0],h[1]=d[1],h[2]=d[2],h[3]=d[3],h[4]=d[4],h[5]=d[5],h[6]=d[6],h[7]=d[7],h[8]=d[8],h},l.fromValues=function(h,d,b,g,k,f,a,e,c){var q=new m.ARRAY_TYPE(9);return q[0]=h,q[1]=
d,q[2]=b,q[3]=g,q[4]=k,q[5]=f,q[6]=a,q[7]=e,q[8]=c,q},l.set=function(h,d,b,g,k,f,a,e,c,q){return h[0]=d,h[1]=b,h[2]=g,h[3]=k,h[4]=f,h[5]=a,h[6]=e,h[7]=c,h[8]=q,h},l.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},l.transpose=function(h,d){if(h===d){var b=d[1],g=d[2],k=d[5];h[1]=d[3];h[2]=d[6];h[3]=b;h[5]=d[7];h[6]=g;h[7]=k}else h[0]=d[0],h[1]=d[3],h[2]=d[6],h[3]=d[1],h[4]=d[4],h[5]=d[7],h[6]=d[2],h[7]=d[5],h[8]=d[8];return h},l.invert=function(h,d){var b=
d[0],g=d[1],k=d[2],f=d[3],a=d[4],e=d[5],c=d[6],q=d[7];d=d[8];var t=d*a-e*q,r=-d*f+e*c,u=q*f-a*c,v=b*t+g*r+k*u;return v?(v=1/v,h[0]=t*v,h[1]=(-d*g+k*q)*v,h[2]=(e*g-k*a)*v,h[3]=r*v,h[4]=(d*b-k*c)*v,h[5]=(-e*b+k*f)*v,h[6]=u*v,h[7]=(-q*b+g*c)*v,h[8]=(a*b-g*f)*v,h):null},l.adjoint=function(h,d){var b=d[0],g=d[1],k=d[2],f=d[3],a=d[4],e=d[5],c=d[6],q=d[7];d=d[8];return h[0]=a*d-e*q,h[1]=k*q-g*d,h[2]=g*e-k*a,h[3]=e*c-f*d,h[4]=b*d-k*c,h[5]=k*f-b*e,h[6]=f*q-a*c,h[7]=g*c-b*q,h[8]=b*a-g*f,h},l.determinant=function(h){var d=
h[3],b=h[4],g=h[5],k=h[6],f=h[7],a=h[8];return h[0]*(a*b-g*f)+h[1]*(-a*d+g*k)+h[2]*(f*d-b*k)},l.multiply=function(h,d,b){var g=d[0],k=d[1],f=d[2],a=d[3],e=d[4],c=d[5],q=d[6],t=d[7];d=d[8];var r=b[0],u=b[1],v=b[2],l=b[3],y=b[4],n=b[5],w=b[6],z=b[7];b=b[8];return h[0]=r*g+u*a+v*q,h[1]=r*k+u*e+v*t,h[2]=r*f+u*c+v*d,h[3]=l*g+y*a+n*q,h[4]=l*k+y*e+n*t,h[5]=l*f+y*c+n*d,h[6]=w*g+z*a+b*q,h[7]=w*k+z*e+b*t,h[8]=w*f+z*c+b*d,h},l.mul=l.multiply,l.translate=function(h,d,b){var g=d[0],k=d[1],f=d[2],a=d[3],e=d[4],
c=d[5],q=d[6],t=d[7];d=d[8];var r=b[0];b=b[1];return h[0]=g,h[1]=k,h[2]=f,h[3]=a,h[4]=e,h[5]=c,h[6]=r*g+b*a+q,h[7]=r*k+b*e+t,h[8]=r*f+b*c+d,h},l.rotate=function(h,d,b){var g=d[0],k=d[1],f=d[2],a=d[3],e=d[4],c=d[5],q=d[6],t=d[7];d=d[8];var r=Math.sin(b);b=Math.cos(b);return h[0]=b*g+r*a,h[1]=b*k+r*e,h[2]=b*f+r*c,h[3]=b*a-r*g,h[4]=b*e-r*k,h[5]=b*c-r*f,h[6]=q,h[7]=t,h[8]=d,h},l.scale=function(h,d,b){var g=b[0];b=b[1];return h[0]=g*d[0],h[1]=g*d[1],h[2]=g*d[2],h[3]=b*d[3],h[4]=b*d[4],h[5]=b*d[5],h[6]=
d[6],h[7]=d[7],h[8]=d[8],h},l.fromTranslation=function(h,d){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=d[0],h[7]=d[1],h[8]=1,h},l.fromRotation=function(h,d){var b=Math.sin(d);d=Math.cos(d);return h[0]=d,h[1]=b,h[2]=0,h[3]=-b,h[4]=d,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},l.fromScaling=function(h,d){return h[0]=d[0],h[1]=0,h[2]=0,h[3]=0,h[4]=d[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},l.fromMat2d=function(h,d){return h[0]=d[0],h[1]=d[1],h[2]=0,h[3]=d[2],h[4]=d[3],h[5]=0,h[6]=d[4],h[7]=d[5],h[8]=1,h},l.fromQuat=
function(h,d){var b=d[0],g=d[1],k=d[2];d=d[3];var f=b+b,a=g+g,e=k+k,b=b*f,c=g*f,g=g*a,q=k*f,t=k*a,k=k*e,f=d*f,a=d*a;d*=e;return h[0]=1-g-k,h[3]=c-d,h[6]=q+a,h[1]=c+d,h[4]=1-b-k,h[7]=t-f,h[2]=q-a,h[5]=t+f,h[8]=1-b-g,h},l.normalFromMat4=function(h,d){var b=d[0],g=d[1],k=d[2],f=d[3],a=d[4],e=d[5],c=d[6],q=d[7],t=d[8],r=d[9],u=d[10],v=d[11],l=d[12],y=d[13],n=d[14];d=d[15];var w=b*e-g*a,z=b*c-k*a,C=b*q-f*a,B=g*c-k*e,m=g*q-f*e,G=k*q-f*c,N=t*y-r*l,M=t*n-u*l,t=t*d-v*l,R=r*n-u*y,r=r*d-v*y,u=u*d-v*n;return(v=
w*u-z*r+C*R+B*t-m*M+G*N)?(v=1/v,h[0]=(e*u-c*r+q*R)*v,h[1]=(c*t-a*u-q*M)*v,h[2]=(a*r-e*t+q*N)*v,h[3]=(k*r-g*u-f*R)*v,h[4]=(b*u-k*t+f*M)*v,h[5]=(g*t-b*r-f*N)*v,h[6]=(y*G-n*m+d*B)*v,h[7]=(n*C-l*G-d*z)*v,h[8]=(l*m-y*C+d*w)*v,h):null},l.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},l.frob=function(h){return Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2)+Math.pow(h[2],2)+Math.pow(h[3],2)+Math.pow(h[4],2)+Math.pow(h[5],2)+Math.pow(h[6],
2)+Math.pow(h[7],2)+Math.pow(h[8],2))},l.add=function(h,d,b){return h[0]=d[0]+b[0],h[1]=d[1]+b[1],h[2]=d[2]+b[2],h[3]=d[3]+b[3],h[4]=d[4]+b[4],h[5]=d[5]+b[5],h[6]=d[6]+b[6],h[7]=d[7]+b[7],h[8]=d[8]+b[8],h},l.subtract=function(h,d,b){return h[0]=d[0]-b[0],h[1]=d[1]-b[1],h[2]=d[2]-b[2],h[3]=d[3]-b[3],h[4]=d[4]-b[4],h[5]=d[5]-b[5],h[6]=d[6]-b[6],h[7]=d[7]-b[7],h[8]=d[8]-b[8],h},l.sub=l.subtract,l.multiplyScalar=function(h,d,b){return h[0]=d[0]*b,h[1]=d[1]*b,h[2]=d[2]*b,h[3]=d[3]*b,h[4]=d[4]*b,h[5]=d[5]*
b,h[6]=d[6]*b,h[7]=d[7]*b,h[8]=d[8]*b,h},l.multiplyScalarAndAdd=function(h,d,b,g){return h[0]=d[0]+b[0]*g,h[1]=d[1]+b[1]*g,h[2]=d[2]+b[2]*g,h[3]=d[3]+b[3]*g,h[4]=d[4]+b[4]*g,h[5]=d[5]+b[5]*g,h[6]=d[6]+b[6]*g,h[7]=d[7]+b[7]*g,h[8]=d[8]+b[8]*g,h},l.exactEquals=function(h,d){return h[0]===d[0]&&h[1]===d[1]&&h[2]===d[2]&&h[3]===d[3]&&h[4]===d[4]&&h[5]===d[5]&&h[6]===d[6]&&h[7]===d[7]&&h[8]===d[8]},l.equals=function(h,d){var b=h[0],g=h[1],k=h[2],f=h[3],a=h[4],e=h[5],c=h[6],q=h[7],t=h[8],r=d[0],u=d[1],
v=d[2],l=d[3],y=d[4],n=d[5];h=h[6];var w=d[7];d=d[8];return Math.abs(b-r)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(r))&&Math.abs(g-u)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(u))&&Math.abs(k-v)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(v))&&Math.abs(f-l)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(l))&&Math.abs(a-y)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(e-n)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(n))&&Math.abs(c-h)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(h))&&Math.abs(q-
w)<=m.EPSILON*Math.max(1,Math.abs(q),Math.abs(w))&&Math.abs(t-d)<=m.EPSILON*Math.max(1,Math.abs(t),Math.abs(d))},l})},"esri/core/libs/gl-matrix/vec4":function(){define(["./common"],function(m){var l={};return l.create=function(){var h=new m.ARRAY_TYPE(4);return h[0]=0,h[1]=0,h[2]=0,h[3]=0,h},l.clone=function(h){var d=new m.ARRAY_TYPE(4);return d[0]=h[0],d[1]=h[1],d[2]=h[2],d[3]=h[3],d},l.fromValues=function(h,d,b,g){var k=new m.ARRAY_TYPE(4);return k[0]=h,k[1]=d,k[2]=b,k[3]=g,k},l.copy=function(h,
d){return h[0]=d[0],h[1]=d[1],h[2]=d[2],h[3]=d[3],h},l.set=function(h,d,b,g,k){return h[0]=d,h[1]=b,h[2]=g,h[3]=k,h},l.add=function(h,d,b){return h[0]=d[0]+b[0],h[1]=d[1]+b[1],h[2]=d[2]+b[2],h[3]=d[3]+b[3],h},l.subtract=function(h,d,b){return h[0]=d[0]-b[0],h[1]=d[1]-b[1],h[2]=d[2]-b[2],h[3]=d[3]-b[3],h},l.sub=l.subtract,l.multiply=function(h,d,b){return h[0]=d[0]*b[0],h[1]=d[1]*b[1],h[2]=d[2]*b[2],h[3]=d[3]*b[3],h},l.mul=l.multiply,l.divide=function(h,d,b){return h[0]=d[0]/b[0],h[1]=d[1]/b[1],h[2]=
d[2]/b[2],h[3]=d[3]/b[3],h},l.div=l.divide,l.ceil=function(h,d){return h[0]=Math.ceil(d[0]),h[1]=Math.ceil(d[1]),h[2]=Math.ceil(d[2]),h[3]=Math.ceil(d[3]),h},l.floor=function(h,d){return h[0]=Math.floor(d[0]),h[1]=Math.floor(d[1]),h[2]=Math.floor(d[2]),h[3]=Math.floor(d[3]),h},l.min=function(h,d,b){return h[0]=Math.min(d[0],b[0]),h[1]=Math.min(d[1],b[1]),h[2]=Math.min(d[2],b[2]),h[3]=Math.min(d[3],b[3]),h},l.max=function(h,d,b){return h[0]=Math.max(d[0],b[0]),h[1]=Math.max(d[1],b[1]),h[2]=Math.max(d[2],
b[2]),h[3]=Math.max(d[3],b[3]),h},l.round=function(h,d){return h[0]=Math.round(d[0]),h[1]=Math.round(d[1]),h[2]=Math.round(d[2]),h[3]=Math.round(d[3]),h},l.scale=function(h,d,b){return h[0]=d[0]*b,h[1]=d[1]*b,h[2]=d[2]*b,h[3]=d[3]*b,h},l.scaleAndAdd=function(h,d,b,g){return h[0]=d[0]+b[0]*g,h[1]=d[1]+b[1]*g,h[2]=d[2]+b[2]*g,h[3]=d[3]+b[3]*g,h},l.distance=function(h,d){var b=d[0]-h[0],g=d[1]-h[1],k=d[2]-h[2];h=d[3]-h[3];return Math.sqrt(b*b+g*g+k*k+h*h)},l.dist=l.distance,l.squaredDistance=function(h,
d){var b=d[0]-h[0],g=d[1]-h[1],k=d[2]-h[2];h=d[3]-h[3];return b*b+g*g+k*k+h*h},l.sqrDist=l.squaredDistance,l.length=function(h){var d=h[0],b=h[1],g=h[2];h=h[3];return Math.sqrt(d*d+b*b+g*g+h*h)},l.len=l.length,l.squaredLength=function(h){var d=h[0],b=h[1],g=h[2];h=h[3];return d*d+b*b+g*g+h*h},l.sqrLen=l.squaredLength,l.negate=function(h,d){return h[0]=-d[0],h[1]=-d[1],h[2]=-d[2],h[3]=-d[3],h},l.inverse=function(h,d){return h[0]=1/d[0],h[1]=1/d[1],h[2]=1/d[2],h[3]=1/d[3],h},l.normalize=function(h,
d){var b=d[0],g=d[1],k=d[2];d=d[3];var f=b*b+g*g+k*k+d*d;return 0<f&&(f=1/Math.sqrt(f),h[0]=b*f,h[1]=g*f,h[2]=k*f,h[3]=d*f),h},l.dot=function(h,d){return h[0]*d[0]+h[1]*d[1]+h[2]*d[2]+h[3]*d[3]},l.lerp=function(h,d,b,g){var k=d[0],f=d[1],a=d[2];d=d[3];return h[0]=k+g*(b[0]-k),h[1]=f+g*(b[1]-f),h[2]=a+g*(b[2]-a),h[3]=d+g*(b[3]-d),h},l.random=function(h,d){return d=d||1,h[0]=m.RANDOM(),h[1]=m.RANDOM(),h[2]=m.RANDOM(),h[3]=m.RANDOM(),l.normalize(h,h),l.scale(h,h,d),h},l.transformMat4=function(h,d,b){var g=
d[0],k=d[1],f=d[2];d=d[3];return h[0]=b[0]*g+b[4]*k+b[8]*f+b[12]*d,h[1]=b[1]*g+b[5]*k+b[9]*f+b[13]*d,h[2]=b[2]*g+b[6]*k+b[10]*f+b[14]*d,h[3]=b[3]*g+b[7]*k+b[11]*f+b[15]*d,h},l.transformQuat=function(h,d,b){var g=d[0],k=d[1],f=d[2],a=b[0],e=b[1],c=b[2];b=b[3];var q=b*g+e*f-c*k,t=b*k+c*g-a*f,r=b*f+a*k-e*g,g=-a*g-e*k-c*f;return h[0]=q*b+g*-a+t*-c-r*-e,h[1]=t*b+g*-e+r*-a-q*-c,h[2]=r*b+g*-c+q*-e-t*-a,h[3]=d[3],h},l.forEach=function(){var h=l.create();return function(d,b,g,k,f,a){b||(b=4);g||(g=0);for(k=
k?Math.min(k*b+g,d.length):d.length;k>g;g+=b)h[0]=d[g],h[1]=d[g+1],h[2]=d[g+2],h[3]=d[g+3],f(h,h,a),d[g]=h[0],d[g+1]=h[1],d[g+2]=h[2],d[g+3]=h[3];return d}}(),l.str=function(h){return"vec4("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},l.exactEquals=function(h,d){return h[0]===d[0]&&h[1]===d[1]&&h[2]===d[2]&&h[3]===d[3]},l.equals=function(h,d){var b=h[0],g=h[1],k=h[2];h=h[3];var f=d[0],a=d[1],e=d[2];d=d[3];return Math.abs(b-f)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(f))&&Math.abs(g-a)<=m.EPSILON*Math.max(1,
Math.abs(g),Math.abs(a))&&Math.abs(k-e)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(e))&&Math.abs(h-d)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(d))},l})},"esri/views/webgl/VertexArrayObject":function(){define(["require","exports"],function(m,l){return function(){function h(d,b,g,k,f){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=d;this._layout=g;this._buffers=k;this._locations=b;f&&(this._indexBuffer=f);this._id=
h._nextId++}return Object.defineProperty(h.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,
"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0}),h.prototype.dispose=function(d){if(void 0===d&&(d=!0),this._context){var b=this._context.extensions.vao;b&&this._glName&&(b.deleteVertexArrayOES(this._glName),this._glName=null);if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),d){for(var g in this._buffers)this._buffers[g].dispose(),delete this._buffers[g];
this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}this._context=null}},h.prototype.initialize=function(){if(!this._initialized){var d=this._context.extensions.vao;if(d){var b=d.createVertexArrayOES();d.bindVertexArrayOES(b);this._bindLayout();d.bindVertexArrayOES(null);this._glName=b}this._initialized=!0}},h.prototype.bind=function(){this.initialize();var d=this._context.extensions.vao;d?d.bindVertexArrayOES(this.glName):(this._context.bindVAO(null),this._bindLayout())},h.prototype._bindLayout=
function(){var d=this._buffers,b=this._context.extensions.vao,g=this._layout,k=this._indexBuffer;d||console.error("Vertex buffer dictionary is empty!");var f,a,e=this._context.gl,c=0,q;for(q in d)for((f=d[q])||console.error("Vertex buffer is uninitialized!"),(a=g[q])||console.error("Vertex element descriptor is empty!"),this._context.bindBuffer(f),c=0;c<a.length;++c){f=a[c];var h=this._locations[f.name],r=f.baseInstance?f.baseInstance*f.stride:0;if(void 0===h&&console.error("There is no location for vertex attribute '"+
f.name+"' defined."),f.baseInstance&&!f.divisor&&console.error("Vertex attribute '"+f.name+"' uses baseInstanceOffset without divisor."),4>=f.count){if(e.enableVertexAttribArray(h),e.vertexAttribPointer(h,f.count,f.type,f.normalized,f.stride,f.offset+r),f.divisor&&0<f.divisor){var u=this._context.extensions.angleInstancedArrays;u&&u.vertexAttribDivisorANGLE(h,f.divisor)}}else if(16===f.count&&5126===f.type)for(var v=0;4>v;v++)(e.enableVertexAttribArray(h+v),e.vertexAttribPointer(h+v,4,f.type,f.normalized,
f.stride,f.offset+16*v+r),f.divisor&&0<f.divisor)&&(u=this._context.extensions.angleInstancedArrays)&&u.vertexAttribDivisorANGLE(h+v,f.divisor);else console.error("Unsupported vertex attribute element count: "+f.count)}k&&(b?e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,k.glName):this._context.bindBuffer(k))},h.prototype.unbind=function(){this.initialize();var d=this._context.extensions.vao;d?d.bindVertexArrayOES(null):this._unbindLayout()},h.prototype._unbindLayout=function(){var d=this._buffers,b=this._layout,
g=this._locations,k=this._context;d||console.error("Vertex buffer dictionary is empty!");var f,a,e,c=k.gl,q=0,h=0,r;for(r in d){(f=d[r])||console.error("Vertex buffer is uninitialized!");a=b[r];q=0;for(h=a.length;h>q;++q)e=a[q],c.disableVertexAttribArray(g[e.name]);k.unbindBuffer(f.bufferType)}(d=this._indexBuffer)&&k.unbindBuffer(d.bufferType)},h._nextId=0,h}()})},"esri/views/vectorTiles/MemoryBuffer":function(){define(["require","exports"],function(m,l){return function(){function h(d){this._array=
[];0>=d&&console.error("strideInBytes must be positive!");this._stride=d}return Object.defineProperty(h.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"index",{get:function(){return 4*this._array.length/this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"itemSize",{get:function(){return this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"sizeInBytes",{get:function(){return 4*
this._array.length},enumerable:!0,configurable:!0}),h.prototype.reset=function(){this.array.length=0},h.prototype.toBuffer=function(){return(new Uint32Array(this._array)).buffer},h.i1616to32=function(d,b){return 65535&d|b<<16},h.i8888to32=function(d,b,g,k){return 255&d|(255&b)<<8|(255&g)<<16|k<<24},h.i8816to32=function(d,b,g){return 255&d|(255&b)<<8|g<<16},h}()})},"esri/views/webgl/ShaderVariations":function(){define(["require","exports","./Program","./Util","./ShaderSourceVariator"],function(m,l,
h,d,b){function g(b){return b.reduce(function(b,a,e){return a&&(b|=1<<e),b},0)}return function(){function k(b,a,e,c,d,g){"string"==typeof b?this._initParams(b,a,e,c,d,g):this._initObject({programNamePrefix:b.programNamePrefix,shaderSnippetPrefixes:b.shaderSnippetPrefixes,baseDefines:b.baseDefines,snippets:b.snippets,rctx:b.rctx,vertexAttribLocs:b.vertexAttribLocs})}return k.prototype._initObject=function(b){this._initParams(b.programNamePrefix,b.shaderSnippetPrefixes,b.baseDefines,b.snippets,b.rctx,
b.vertexAttribLocs)},k.prototype._initParams=function(d,a,e,c,g,k){this._defaultSnippets=c;this._defaultRctx=g;this._defaultVertexAttribLocs=k;this._programCache=new Map;this._variationInfo=new Map;this._shaderSourceVariator=new b(d,a,e)},k.prototype.addDefine=function(b,a,e,c){this._shaderSourceVariator.addDefine(b,a,e,c)},k.prototype.addBinaryShaderSnippetSuffix=function(b,a,e){this._shaderSourceVariator.addBinaryShaderSnippetSuffix(b,a,e)},k.prototype.addNaryShaderSnippetSuffix=function(b,a){this._shaderSourceVariator.addNaryShaderSnippetSuffix(b,
a)},k.prototype.getProgram=function(b,a,e,c){if(a=a||this._defaultSnippets,e=e||this._defaultRctx,c=c||this._defaultVertexAttribLocs,!a)throw Error("No ShaderSnippets provided to getProgram nor to ShaderVariations constructor.");if(!e)throw Error("No RenderingContext provided to getProgram nor to ShaderVariations constructor.");if(!c)throw Error("No VertexAttributeLocations provided to getProgram nor to ShaderVariations constructor.");var f=g(b);if(this._programCache[f])return this._programCache[f];
var k,r=this._shaderSourceVariator.getShaderVariation(b);b=r.shaderSnippetNames[0];k=a[b];d.assert(null!=k,"shader snippet '"+b+"' does not exist");b=r.shaderSnippetNames[1];a=a[b];d.assert(null!=a,"shader snippet '"+b+"' does not exist");e=new h(e,k,a,c,r.defines);return this._programCache[f]=e,e},k.prototype.getProgramByKey=function(b){if(this._programCache[b])return this._programCache[b];if(!this._variationInfo[b])return null;var a,e,c,f=this._variationInfo[b];c=this._defaultSnippets;var g=this._defaultRctx,
k=this._defaultVertexAttribLocs;a=f.shaderSnippetNames[0];e=c[a];d.assert(null!=e,"shader snippet '"+a+"' does not exist");a=f.shaderSnippetNames[1];c=c[a];d.assert(null!=c,"shader snippet '"+a+"' does not exist");a=new h(g,e,c,k,f.defines);return this._programCache[b]=a,a},k.prototype.getProgramInfo=function(b){var a=this._shaderSourceVariator.getShaderVariation(b);b=g(b);return this._variationInfo[b]||(this._variationInfo[b]=a),{name:a.programName,key:b}},k}()})},"esri/views/webgl/Program":function(){define(["require",
"exports","dojo/has"],function(m,l,h){var d=h("dojo-debug-messages");return function(){function b(d,k,f,a,e){if(void 0===e&&(e={}),this._context=null,this._glName=null,this._locations={},this._id=void 0,this._initialized=!1,this._vShader=null,this._fShader=null,this._defines={},this._nameToUniformLocation={},this._nameToAttribLocation={},this._nameToUniform1={},this._nameToUniform2={},this._nameToUniform3={},this._nameToUniform4={},this._nameToUniformMatrix3={},this._nameToUniformMatrix4={},d||console.error("RenderingContext isn't initialized!"),
0===k.length&&console.error("Shaders source should not be empty!"),this._context=d,this._vertexShaderSource=k,this._fragmentShaderSource=f,Array.isArray(e))for(d=0;d<e.length;d++)this._defines[e[d]]="1";else this._defines=e;this._id=b._nextId++;this._locations=a}return Object.defineProperty(b.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,
"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0}),b.prototype.getDefine=function(b){return this._defines[b]},b.prototype.dispose=function(){if(this._context){var b=this._context.gl;this._vShader&&(b.deleteShader(this._vShader),this._vShader=null);this._fShader&&(b.deleteShader(this._fShader),this._fShader=null);this._glName&&(b.deleteProgram(this._glName),this._glName=null);this._context=null}},b.prototype.initialize=function(){if(!this._initialized){this._vShader=
this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var b=this._context.gl,d=b.createProgram();b.attachShader(d,this._vShader);b.attachShader(d,this._fShader);for(var f in this._locations)b.bindAttribLocation(d,this._locations[f],f);b.linkProgram(d);b.getProgramParameter(d,b.LINK_STATUS)||console.error("Could not initialize shader\nVALIDATE_STATUS: "+b.getProgramParameter(d,b.VALIDATE_STATUS)+", gl error ["+b.getError()+
"]infoLog: "+b.getProgramInfoLog(d));this._glName=d;this._initialized=!0}},b.prototype.getUniformLocation=function(b){return this.initialize(),void 0===this._nameToUniformLocation[b]&&(this._nameToUniformLocation[b]=this._context.gl.getUniformLocation(this._glName,b)),this._nameToUniformLocation[b]},b.prototype.hasUniform=function(b){return null!==this.getUniformLocation(b)},b.prototype.getAttribLocation=function(b){return this.initialize(),void 0===this._nameToAttribLocation[b]&&(this._nameToAttribLocation[b]=
this._context.gl.getAttribLocation(this._glName,b)),this._nameToAttribLocation[b]},b.prototype.setUniform1i=function(b,d){var f=this._nameToUniform1[b];if(void 0===f||d!==f)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(b),d),this._nameToUniform1[b]=d},b.prototype.setUniform1f=function(b,d){var f=this._nameToUniform1[b];if(void 0===f||d!==f)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(b),d),this._nameToUniform1[b]=d},b.prototype.setUniform1fv=
function(d,k){var f=this._nameToUniform2[d];void 0!==f&&b._arraysEqual(k,f)||(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(d),k),void 0===f?this._nameToUniform2[d]=new Float32Array(k):f.set(k))},b.prototype.setUniform2f=function(b,d,f){var a=this._nameToUniform2[b];if(void 0===a||d!==a[0]||f!==a[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(b),d,f),void 0===a?this._nameToUniform2[b]=new Float32Array([d,f]):(a[0]=d,a[1]=
f)},b.prototype.setUniform2fv=function(g,k){d&&0!==k.length%2&&console.error("Value array must have even number of elements!");var f=this._nameToUniform2[g];void 0!==f&&b._arraysEqual(k,f)||(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(g),k),void 0===f?this._nameToUniform2[g]=new Float32Array(k):f.set(k))},b.prototype.setUniform3f=function(b,d,f,a){var e=this._nameToUniform3[b];if(void 0===e||d!==e[0]||f!==e[1]||a!==e[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(b),
d,f,a),void 0===e?this._nameToUniform3[b]=new Float32Array([d,f,a]):(e[0]=d,e[1]=f,e[2]=a)},b.prototype.setUniform3fv=function(g,k){d&&0!==k.length%3&&console.error("Value array must contain sets of three values!");var f=this._nameToUniform3[g];void 0!==f&&b._arraysEqual(k,f)||(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(g),k),void 0===f?this._nameToUniform3[g]=new Float32Array(k):f.set(k))},b.prototype.setUniform4f=function(b,d,f,a,e){var c=this._nameToUniform4[b];
if(void 0===c||d!==c[0]||f!==c[1]||a!==c[2]||e!==c[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(b),d,f,a,e),void 0===c?this._nameToUniform4[b]=new Float32Array([d,f,a,e]):(c[0]=d,c[1]=f,c[2]=a,c[3]=e)},b.prototype.setUniform4fv=function(g,k){d&&0!==k.length%4&&console.error("Value array must contain sets of four values!");var f=this._nameToUniform4[g];void 0!==f&&b._arraysEqual(k,f)||(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(g),
k),void 0===f?this._nameToUniform4[g]=new Float32Array(k):f.set(k))},b.prototype.setUniformMatrix3fv=function(g,k,f){void 0===f&&(f=!1);d&&0!==k.length%9&&console.error("Matrix array must contain sets ot 9 elements!");var a=this._nameToUniformMatrix3[g];void 0!==a&&(9===a.length?b._matrix3Equal(a,k):b._arraysEqual(k,a))||(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(g),f,k),void 0===a?this._nameToUniformMatrix3[g]=new Float32Array(k):a.set(k))},b.prototype.setUniformMatrix4fv=
function(g,k,f){void 0===f&&(f=!1);d&&0!==k.length%16&&console.error("Matrix array must contain sets ot 16 elements!");var a=this._nameToUniformMatrix4[g];void 0!==a&&(16===a.length?b._matrix4Equal(a,k):b._arraysEqual(k,a))||(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(g),f,k),void 0===a?this._nameToUniformMatrix4[g]=new Float32Array(k):a.set(k))},b._padToThree=function(b){var d=b.toString();return 1E3>b&&(d=("  "+b).slice(-3)),d},b.prototype._addLineNumbers=
function(d){var g=2;return d.replace(/\n/g,function(){return"\n"+b._padToThree(g++)+":"})},b.prototype._loadShader=function(b){var d=35633===b?this._vertexShaderSource:this._fragmentShaderSource,f="",a;for(a in this._defines)f+="#define "+a+" "+this._defines[a]+"\n";d=f+d;f=this._context.gl;b=f.createShader(b);return f.shaderSource(b,d),f.compileShader(b),f.getShaderParameter(b,f.COMPILE_STATUS)||(console.error(f.getShaderInfoLog(b)),console.error(this._addLineNumbers(d))),b},b._matrix4Equal=function(b,
k){return d&&(16!==b.length||16!==k.length)&&console.error("Matrix object must contain 16 elements!"),b[0]===k[0]&&b[1]===k[1]&&b[2]===k[2]&&b[3]===k[3]&&b[4]===k[4]&&b[5]===k[5]&&b[6]===k[6]&&b[7]===k[7]&&b[8]===k[8]&&b[9]===k[9]&&b[10]===k[10]&&b[11]===k[11]&&b[12]===k[12]&&b[13]===k[13]&&b[14]===k[14]&&b[15]===k[15]},b._matrix3Equal=function(b,k){return d&&(9!==b.length||9!==k.length)&&console.error("Matrix object must contain 16 elements!"),b[0]===k[0]&&b[1]===k[1]&&b[2]===k[2]&&b[3]===k[3]&&
b[4]===k[4]&&b[5]===k[5]&&b[6]===k[6]&&b[7]===k[7]&&b[8]===k[8]},b._arraysEqual=function(b,d){if(b.length!==d.length)return!1;for(var f=0;f<b.length;++f)if(b[f]!==d[f])return!1;return!0},b._nextId=0,b}()})},"esri/views/webgl/Util":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/Error"],function(m,l,h,d){return function(){function b(){}return b.vertexCount=function(d,k){return d.vertexBuffers[k].size/b.getStride(d.layout[k])},b.getStride=function(b){return b[0].stride},
b.getBytesPerElement=function(b){switch(b){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw Error("Unknown data type");}},b.addDescriptor=function(d,k,f,a,e,c){var g=b.getBytesPerElement(a);if(0<d.length){var h=d[0].stride,r=h+g*f;d.forEach(function(a){return a.stride=r});d.push({name:k,count:f,type:a,offset:h,stride:r,normalized:e,divisor:c})}else d.push({name:k,count:f,type:a,offset:0,stride:g*f,normalized:e,
divisor:c})},b.assertCompatibleVertexAttributeLocations=function(b,d){b=b.locations===d.locations;return b||console.error("VertexAttributeLocations are incompatible"),b},b.hasAttribute=function(b,d){for(var f=0;f<b.length;f++)if(b[f].name===d)return!0;return!1},b.findAttribute=function(b,d){for(var f=0;f<b.length;f++)if(b[f].name===d)return b[f];return null},b.copyFramebufferToTexture=function(b,d,f,a,e){void 0===e&&(e=0);var c=b.getBoundFramebufferObject(),g=b.getBoundTexture(0);b.bindFramebuffer(d);
b.bindTexture(f,0);b.gl.copyTexImage2D(b.gl.TEXTURE_2D,e,f.descriptor.pixelFormat,a[0],a[1],a[2],a[3],0);b.gl.flush();b.bindFramebuffer(c);b.bindTexture(g,0)},b.assert=function(b,k){if(!b)throw new d(k);},b.setBaseInstanceOffset=function(b,d){var f={},a;for(a in b)f[a]=b[a].map(function(a){return a.divisor?h({},a,{baseInstance:d}):a});return f},b}()})},"esri/views/webgl/ShaderSourceVariator":function(){define(["require","exports","dojo/_base/lang","./Util"],function(m,l,h,d){return function(){function b(b,
k,f){var a;"string"==typeof b?a=b:(a=b.programNamePrefix,k=b.shaderSnippetPrefixes,f=b.baseDefines);d.assert(k,"you must specify shader snippet prefixes");d.assert(2===k.length,"you must specify shader snippet prefixes for vertex and fragment shaders");f&&0!==f.length||(f=[]);this.programNamePrefix=a;this.shaderSnippetPrefixes=k;this.baseDefines=f;this.variables=[];this.sealed=!1}return b.prototype.addDefine=function(b,k,f,a){d.assert(!this.sealed,"you cannot add another variable after the first program has been generated");
d.assert(b,"you must specify a program name suffix");this.variables.push({programNameSuffixes:["",b],shaderNameSuffixes:a||b,defineStr:k,affectsShaderTypes:f||[!0,!0]})},b.prototype.addBinaryShaderSnippetSuffix=function(b,k,f){d.assert(!this.sealed,"you cannot add another variable after the first program has been generated");d.assert(b,"you must specify a program name suffix");this.variables.push({programNameSuffixes:["",b],shaderSnippetSuffixes:["",k],affectsShaderTypes:f||[!0,!0]})},b.prototype.addNaryShaderSnippetSuffix=
function(b,k){d.assert(!this.sealed,"you cannot add another variable after the first program has been generated");var f=b.map(function(a){return d.assert(null!=a.value,"value must always be specified"),a.value});this.variables.push({values:f,programNameSuffixes:b.map(function(a,b){return null!=a.programNameSuffix?a.programNameSuffix:f[b]}),shaderSnippetSuffixes:b.map(function(a,b){return null!=a.shaderSnippetSuffix?a.shaderSnippetSuffix:f[b]}),affectsShaderTypes:k||[!0,!0]})},b.prototype.getShaderVariation=
function(b){d.assert(b.length===this.variables.length,"you must specify a value for each variable");for(var g=this.programNamePrefix,f=h.clone(this.shaderSnippetPrefixes),a=h.clone(this.shaderSnippetPrefixes),e=h.clone(this.baseDefines),c=0;c<this.variables.length;c++){var q=this.variables[c],t=b[c],r=void 0;q.values?(r=q.values.indexOf(t),d.assert(0<=r,"invalid value "+t+" for variable "+c)):r=t?1:0;g+=q.programNameSuffixes[r];for(t=0;2>t;t++)q.affectsShaderTypes[t]&&(q.shaderSnippetSuffixes&&(f[t]+=
q.shaderSnippetSuffixes[r],a[t]+=q.shaderSnippetSuffixes[r]),q.defineStr&&r&&(e.push(q.defineStr),a[t]+=q.shaderNameSuffixes))}return{programName:g,shaderSnippetNames:f,shaderNames:a,defines:e}},b}()})},"esri/views/vectorTiles/renderers/vtShaderSnippets":function(){define("require exports ../../webgl/ShaderSnippets dojo/text!./shaders/backgroundShaders.xml dojo/text!./shaders/fillShaders.xml dojo/text!./shaders/outlineShaders.xml dojo/text!./shaders/lineShaders.xml dojo/text!./shaders/iconShaders.xml dojo/text!./shaders/textShaders.xml dojo/text!./shaders/tileInfo.vs.glsl dojo/text!./shaders/tileInfo.fs.glsl".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){function q(a,c){t+='\x3csnippet name\x3d"'+a+'"\x3e\x3c![CDATA[';t+=c;t+="]]\x3e\x3c/snippet\x3e"}var t="",t=t+'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e',t=t+"\x3csnippets\x3e";q("tileInfoVS",e);q("tileInfoFS",c);t+="\x3c/snippets\x3e";m=new h;return h.parse(d,m),h.parse(t,m),h.parse(b,m),h.parse(g,m),h.parse(k,m),h.parse(f,m),h.parse(a,m),m})},"esri/views/webgl/ShaderSnippets":function(){define(["require","exports","dojox/xml/parser"],function(m,l,h){return function(){function d(b){if(b)for(var d in b)this[d]=
b[d]}return d.parse=function(b,d){b=h.parse(b).getElementsByTagName("snippet");for(var g=/\$[a-zA-Z][a-zA-Z0-9]*(?:\([^\(\)]*\))?[ \t]*/,f=/[\$\s]+/g,a=/\(([^\(\)]*)\)/,e=0;e<b.length;e++){for(var c=b[e].getAttribute("name"),q=b[e].textContent;;){var t=q.match(g);if(null==t)break;var r=t[0].replace(f,""),u=r.match(a),v=void 0;u&&(v=u[1].split(",").map(function(a){return a.trim()}));r=r.replace(a,"");v=d._instantiate(r,v);q=q.replace(t[0],v)}d[c]=q}},d.prototype._instantiate=function(b,d){b=this[b];
for(d||(d=[]);;){var g=b.match(/\$(\d+)/);if(null==g)break;var f=parseInt(g[1],10);b=b.replace(g[0],d[f])}return b},d}()})},"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(m){m.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(l,h){var d=m.doc,b;h=h||"text/xml";if(l&&m.trim(l)&&"DOMParser"in m.global){b=(new DOMParser).parseFromString(l,h);l=b.documentElement;if("parsererror"==l.nodeName&&
"http://www.mozilla.org/newlayout/xml/parsererror.xml"==l.namespaceURI){if(d=l.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext")[0])d=d.firstChild.data;throw Error("Error parsing text "+l.firstChild.data+" \n"+d);}return b}if("ActiveXObject"in m.global){d=function(b){return"MSXML"+b+".DOMDocument"};d=["Microsoft.XMLDOM",d(6),d(4),d(3),d(2)];m.some(d,function(d){try{b=new ActiveXObject(d)}catch(f){return!1}return!0});if(l&&b&&(b.async=!1,b.loadXML(l),l=b.parseError,
0!==l.errorCode))throw Error("Line: "+l.line+"\nCol: "+l.linepos+"\nReason: "+l.reason+"\nError Code: "+l.errorCode+"\nSource: "+l.srcText);if(b)return b}else if(d.implementation&&d.implementation.createDocument){if(l&&m.trim(l)&&d.createElement){h=d.createElement("xml");h.innerHTML=l;var g=d.implementation.createDocument("foo","",null);m.forEach(h.childNodes,function(b){g.importNode(b,!0)});return g}return d.implementation.createDocument("","",null)}return null};dojox.xml.parser.textContent=function(l,
h){if(1<arguments.length)return dojox.xml.parser.replaceChildren(l,(l.ownerDocument||m.doc).createTextNode(h)),h;if(void 0!==l.textContent)return l.textContent;var d="";l&&m.forEach(l.childNodes,function(b){switch(b.nodeType){case 1:case 5:d+=dojox.xml.parser.textContent(b);break;case 3:case 2:case 4:d+=b.nodeValue}});return d};dojox.xml.parser.replaceChildren=function(l,h){var d=[];m.isIE&&m.forEach(l.childNodes,function(b){d.push(b)});dojox.xml.parser.removeChildren(l);m.forEach(d,m.destroy);m.isArray(h)?
m.forEach(h,function(b){l.appendChild(b)}):l.appendChild(h)};dojox.xml.parser.removeChildren=function(l){for(var h=l.childNodes.length;l.hasChildNodes();)l.removeChild(l.firstChild);return h};dojox.xml.parser.innerXML=function(l){return l.innerXML?l.innerXML:l.xml?l.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(l):null};return dojox.xml.parser})},"esri/views/vectorTiles/renderers/rendererUtils":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,
"__esModule",{value:!0});var h=new Uint32Array(1),d=new Uint8Array(h.buffer);l.int32To4Bytes=function(b){return h[0]=0|b,[d[0],d[1],d[2],d[3]]}})},"esri/views/vectorTiles/renderers/LineRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../../core/libs/gl-matrix/vec2 ../../webgl/VertexArrayObject ../GeometryUtils ./rendererUtils ../../webgl/ShaderVariations ./vtShaderSnippets".split(" "),function(m,l,
h,d,b,g,k,f,a,e,c){return function(){function q(){this._attributeLocations={a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2};this._attributeLocationsDD={a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4};this._initialized=!1;this._viewProjMat=h.create();this._offsetVector=b.create();this._color=d.create();this._dashArray=g.create()}return q.prototype.dispose=function(){},q.prototype.render=function(c,b,e,d,g,k,n,w,q,l,B){if(0!==b.triangleElementCount){this._initialized||
this._initialize(c);var r=k.tileTransform.transform,t=k.coordRange/512,u=n.getPaintValue("line-translate",e);if(0!==u[0]||0!==u[1]){h.copy(this._viewProjMat,k.tileTransform.transform);var r=u[0],u=u[1],v=0,z=0,z=(1<<k.key.level)/Math.pow(2,e)*t;g=g.rotation;if(1===n.getPaintValue("line-translate-anchor",e)){v=-f.C_DEG_TO_RAD*g;g=Math.sin(v);var y=Math.cos(v),v=z*(r*y-u*g),z=z*(r*g+u*y)}else v=z*r,z*=u;this._offsetVector[0]=v;this._offsetVector[1]=z;this._offsetVector[2]=0;h.translate(this._viewProjMat,
this._viewProjMat,this._offsetVector);r=this._viewProjMat}var x,u=n.getPaintValue("line-pattern",e),z=void 0!==u;l=1/l;g=n.getPaintValue("line-blur",e)+l;l=n.getPaintValue("line-width",e);v=B*n.getPaintValue("line-opacity",e);B=n.getPaintValue("line-color",e);var y=n.hasDataDrivenLine,C=3===d;C&&(x=a.int32To4Bytes(b.layerID));if(d=this._getLineVAO(c,k,y))c.bindVAO(d),d=this._shaderVariations.getProgram([z,y,C],void 0,void 0,y?this._attributeLocationsDD:this._attributeLocations),(c.bindProgram(d),
d.setUniformMatrix4fv("u_transformMatrix",r),d.setUniformMatrix4fv("u_extrudeMatrix",q),d.setUniform2fv("u_normalized_origin",k.tileTransform.displayCoord),d.setUniform1f("u_depth",n.z),d.setUniform1f("u_blur",g),y)||(k=v*B[3],this._color[0]=k*B[0],this._color[1]=k*B[1],this._color[2]=k*B[2],this._color[3]=k,d.setUniform4fv("u_color",this._color),d.setUniform1f("u_width",l)),(C&&d.setUniform4f("u_id",x[0],x[1],x[2],x[3]),z)?(e=w.getMosaicItemPosition(u,!0))&&(w.bind(c,9729,e.page,1),d.setUniform2f("u_pattern_tl",
e.tl[0],e.tl[1]),d.setUniform2f("u_pattern_br",e.br[0],e.br[1]),d.setUniform2f("u_spriteSize",t*e.size[0],e.size[1]),d.setUniform1i("u_texture",1)):(w=n.getPaintValue("line-dasharray",e),2>w.length&&(w=[1,-1]),this._dashArray[0]=t*w[0],this._dashArray[1]=t*w[1],d.setUniform2fv("u_dasharray",this._dashArray)),c.drawElements(4,b.triangleElementCount,5125,12*b.triangleElementStart),c.bindVAO()}},q.prototype._initialize=function(a){if(this._initialized)return!0;a=new e("line",["lineVS","lineFS"],[],c,
a);return a.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN"),a.addDefine("DD","DD",[!0,!1],"DD"),a.addDefine("ID","ID",[!0,!0],"ID"),this._shaderVariations=a,this._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]},this._vertexAttributesDD={geometry:[{name:"a_pos",count:2,
type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]},this._initialized=!0,!0},q.prototype._getLineVAO=function(a,c,b){if(b){if(c.lineDDVertexArrayObject)return c.lineDDVertexArrayObject;
b=c.lineDDVertexBuffer;var e=c.lineIndexBuffer;return b&&e?(c.lineDDVertexArrayObject=new k(a,this._attributeLocationsDD,this._vertexAttributesDD,{geometry:b},e),c.lineDDVertexArrayObject):null}if(c.lineVertexArrayObject)return c.lineVertexArrayObject;b=c.lineVertexBuffer;e=c.lineIndexBuffer;return b&&e?(c.lineVertexArrayObject=new k(a,this._attributeLocations,this._vertexAttributes,{geometry:b},e),c.lineVertexArrayObject):null},q}()})},"esri/core/libs/gl-matrix/vec3":function(){define(["./common"],
function(m){var l={};return l.create=function(){var h=new m.ARRAY_TYPE(3);return h[0]=0,h[1]=0,h[2]=0,h},l.clone=function(h){var d=new m.ARRAY_TYPE(3);return d[0]=h[0],d[1]=h[1],d[2]=h[2],d},l.fromValues=function(h,d,b){var g=new m.ARRAY_TYPE(3);return g[0]=h,g[1]=d,g[2]=b,g},l.copy=function(h,d){return h[0]=d[0],h[1]=d[1],h[2]=d[2],h},l.set=function(h,d,b,g){return h[0]=d,h[1]=b,h[2]=g,h},l.add=function(h,d,b){return h[0]=d[0]+b[0],h[1]=d[1]+b[1],h[2]=d[2]+b[2],h},l.subtract=function(h,d,b){return h[0]=
d[0]-b[0],h[1]=d[1]-b[1],h[2]=d[2]-b[2],h},l.sub=l.subtract,l.multiply=function(h,d,b){return h[0]=d[0]*b[0],h[1]=d[1]*b[1],h[2]=d[2]*b[2],h},l.mul=l.multiply,l.divide=function(h,d,b){return h[0]=d[0]/b[0],h[1]=d[1]/b[1],h[2]=d[2]/b[2],h},l.div=l.divide,l.ceil=function(h,d){return h[0]=Math.ceil(d[0]),h[1]=Math.ceil(d[1]),h[2]=Math.ceil(d[2]),h},l.floor=function(h,d){return h[0]=Math.floor(d[0]),h[1]=Math.floor(d[1]),h[2]=Math.floor(d[2]),h},l.min=function(h,d,b){return h[0]=Math.min(d[0],b[0]),h[1]=
Math.min(d[1],b[1]),h[2]=Math.min(d[2],b[2]),h},l.max=function(h,d,b){return h[0]=Math.max(d[0],b[0]),h[1]=Math.max(d[1],b[1]),h[2]=Math.max(d[2],b[2]),h},l.round=function(h,d){return h[0]=Math.round(d[0]),h[1]=Math.round(d[1]),h[2]=Math.round(d[2]),h},l.scale=function(h,d,b){return h[0]=d[0]*b,h[1]=d[1]*b,h[2]=d[2]*b,h},l.scaleAndAdd=function(h,d,b,g){return h[0]=d[0]+b[0]*g,h[1]=d[1]+b[1]*g,h[2]=d[2]+b[2]*g,h},l.distance=function(h,d){var b=d[0]-h[0],g=d[1]-h[1];h=d[2]-h[2];return Math.sqrt(b*b+
g*g+h*h)},l.dist=l.distance,l.squaredDistance=function(h,d){var b=d[0]-h[0],g=d[1]-h[1];h=d[2]-h[2];return b*b+g*g+h*h},l.sqrDist=l.squaredDistance,l.length=function(h){var d=h[0],b=h[1];h=h[2];return Math.sqrt(d*d+b*b+h*h)},l.len=l.length,l.squaredLength=function(h){var d=h[0],b=h[1];h=h[2];return d*d+b*b+h*h},l.sqrLen=l.squaredLength,l.negate=function(h,d){return h[0]=-d[0],h[1]=-d[1],h[2]=-d[2],h},l.inverse=function(h,d){return h[0]=1/d[0],h[1]=1/d[1],h[2]=1/d[2],h},l.normalize=function(h,d){var b=
d[0],g=d[1],k=d[2],b=b*b+g*g+k*k;return 0<b&&(b=1/Math.sqrt(b),h[0]=d[0]*b,h[1]=d[1]*b,h[2]=d[2]*b),h},l.dot=function(h,d){return h[0]*d[0]+h[1]*d[1]+h[2]*d[2]},l.cross=function(h,d,b){var g=d[0],k=d[1];d=d[2];var f=b[0],a=b[1];b=b[2];return h[0]=k*b-d*a,h[1]=d*f-g*b,h[2]=g*a-k*f,h},l.lerp=function(h,d,b,g){var k=d[0],f=d[1];d=d[2];return h[0]=k+g*(b[0]-k),h[1]=f+g*(b[1]-f),h[2]=d+g*(b[2]-d),h},l.hermite=function(h,d,b,g,k,f){var a=f*f,e=a*(2*f-3)+1,c=a*(f-2)+f,q=a*(f-1);f=a*(3-2*f);return h[0]=d[0]*
e+b[0]*c+g[0]*q+k[0]*f,h[1]=d[1]*e+b[1]*c+g[1]*q+k[1]*f,h[2]=d[2]*e+b[2]*c+g[2]*q+k[2]*f,h},l.bezier=function(h,d,b,g,k,f){var a=1-f,e=a*a,c=f*f,q=e*a,e=3*f*e,a=3*c*a;f*=c;return h[0]=d[0]*q+b[0]*e+g[0]*a+k[0]*f,h[1]=d[1]*q+b[1]*e+g[1]*a+k[1]*f,h[2]=d[2]*q+b[2]*e+g[2]*a+k[2]*f,h},l.random=function(h,d){d=d||1;var b=2*m.RANDOM()*Math.PI,g=2*m.RANDOM()-1,k=Math.sqrt(1-g*g)*d;return h[0]=Math.cos(b)*k,h[1]=Math.sin(b)*k,h[2]=g*d,h},l.transformMat4=function(h,d,b){var g=d[0],k=d[1];d=d[2];var f=b[3]*
g+b[7]*k+b[11]*d+b[15];return f=f||1,h[0]=(b[0]*g+b[4]*k+b[8]*d+b[12])/f,h[1]=(b[1]*g+b[5]*k+b[9]*d+b[13])/f,h[2]=(b[2]*g+b[6]*k+b[10]*d+b[14])/f,h},l.transformMat3=function(h,d,b){var g=d[0],k=d[1];d=d[2];return h[0]=g*b[0]+k*b[3]+d*b[6],h[1]=g*b[1]+k*b[4]+d*b[7],h[2]=g*b[2]+k*b[5]+d*b[8],h},l.transformQuat=function(h,d,b){var g=d[0],k=d[1],f=d[2];d=b[0];var a=b[1],e=b[2];b=b[3];var c=b*g+a*f-e*k,q=b*k+e*g-d*f,t=b*f+d*k-a*g,g=-d*g-a*k-e*f;return h[0]=c*b+g*-d+q*-e-t*-a,h[1]=q*b+g*-a+t*-d-c*-e,h[2]=
t*b+g*-e+c*-a-q*-d,h},l.rotateX=function(h,d,b,g){var k=[],f=[];return k[0]=d[0]-b[0],k[1]=d[1]-b[1],k[2]=d[2]-b[2],f[0]=k[0],f[1]=k[1]*Math.cos(g)-k[2]*Math.sin(g),f[2]=k[1]*Math.sin(g)+k[2]*Math.cos(g),h[0]=f[0]+b[0],h[1]=f[1]+b[1],h[2]=f[2]+b[2],h},l.rotateY=function(h,d,b,g){var k=[],f=[];return k[0]=d[0]-b[0],k[1]=d[1]-b[1],k[2]=d[2]-b[2],f[0]=k[2]*Math.sin(g)+k[0]*Math.cos(g),f[1]=k[1],f[2]=k[2]*Math.cos(g)-k[0]*Math.sin(g),h[0]=f[0]+b[0],h[1]=f[1]+b[1],h[2]=f[2]+b[2],h},l.rotateZ=function(h,
d,b,g){var k=[],f=[];return k[0]=d[0]-b[0],k[1]=d[1]-b[1],k[2]=d[2]-b[2],f[0]=k[0]*Math.cos(g)-k[1]*Math.sin(g),f[1]=k[0]*Math.sin(g)+k[1]*Math.cos(g),f[2]=k[2],h[0]=f[0]+b[0],h[1]=f[1]+b[1],h[2]=f[2]+b[2],h},l.forEach=function(){var h=l.create();return function(d,b,g,k,f,a){b||(b=3);g||(g=0);for(k=k?Math.min(k*b+g,d.length):d.length;k>g;g+=b)h[0]=d[g],h[1]=d[g+1],h[2]=d[g+2],f(h,h,a),d[g]=h[0],d[g+1]=h[1],d[g+2]=h[2];return d}}(),l.angle=function(h,d){h=l.fromValues(h[0],h[1],h[2]);d=l.fromValues(d[0],
d[1],d[2]);l.normalize(h,h);l.normalize(d,d);d=l.dot(h,d);return 1<d?0:Math.acos(d)},l.str=function(h){return"vec3("+h[0]+", "+h[1]+", "+h[2]+")"},l.exactEquals=function(h,d){return h[0]===d[0]&&h[1]===d[1]&&h[2]===d[2]},l.equals=function(h,d){var b=h[0],g=h[1];h=h[2];var k=d[0],f=d[1];d=d[2];return Math.abs(b-k)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(k))&&Math.abs(g-f)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(f))&&Math.abs(h-d)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(d))},l})},"esri/views/vectorTiles/renderers/FillRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../webgl/VertexArrayObject ../GeometryUtils ./rendererUtils ../../webgl/ShaderVariations ./vtShaderSnippets".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){var q=1/65536;return function(){function t(){this._fillAttributeLocations={a_pos:0};this._fillAttributeLocationsDD={a_pos:0,a_color:1};this._outlineAttributeLocations={a_pos:0,a_offset:1,a_xnormal:2};this._outlineAttributeLocationsDD={a_pos:0,a_offset:1,a_xnormal:2,a_color:3};this._initialized=!1;this._viewProjMat=h.create();this._offsetVector=g.create();this._patternMatrix=d.create();this._color=b.create();this._outlineColor=b.create()}return t.prototype.dispose=function(){},
t.prototype.render=function(c,b,e,d,g,n,w,k,t,l,m){if(0!==b.triangleElementCount){this._initialized||this._initialize(c);var r,u=void 0!==w.getPaintValue("fill-pattern",e),v=m*w.getPaintValue("fill-opacity",e),z=w.getPaintValue("fill-color",e),y=3===g;y&&(r=a.int32To4Bytes(b.layerID));var x=n.tileTransform.transform,C=n.coordRange/512,B=w.getPaintValue("fill-translate",e);if(0!==B[0]||0!==B[1]){h.copy(this._viewProjMat,n.tileTransform.transform);var x=B[0],B=B[1],F=0,H=0,C=(1<<n.key.level)/Math.pow(2,
e)*C;1===w.getPaintValue("fill-translate-anchor",e)?(F=-f.C_DEG_TO_RAD*d,d=Math.sin(F),H=Math.cos(F),F=C*(x*H-B*d),H=C*(x*d+B*H)):(F=C*x,H=C*B);this._offsetVector[0]=F;this._offsetVector[1]=H;this._offsetVector[2]=0;h.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);x=this._viewProjMat}this._drawFill(c,b,e,g,n,w,k,x,l,m,y,r);if(w.getPaintValue("fill-antialias",e)&&!u&&0<b.outlineElementCount&&(1===g||3===g)){g=w.hasDataDrivenOutline;e=w.getPaintValue("fill-outline-color",e);if(0===
e[3]){if(1!==this._color[3]&&!g)return;e=z}l=.75/l;if(z=this._getOutlineVAO(c,n,g))c.bindVAO(z),z=this._outlineShaderVariations.getProgram([g,y],void 0,void 0,g?this._outlineAttributeLocationsDD:this._outlineAttributeLocations),(c.bindProgram(z),z.setUniformMatrix4fv("u_transformMatrix",x),z.setUniformMatrix4fv("u_extrudeMatrix",t),z.setUniform2fv("u_normalized_origin",n.tileTransform.displayCoord),z.setUniform1f("u_depth",w.z+q),z.setUniform1f("u_outline_width",l),g)||(n=v*e[3],this._outlineColor[0]=
n*e[0],this._outlineColor[1]=n*e[1],this._outlineColor[2]=n*e[2],this._outlineColor[3]=n,z.setUniform4fv("u_color",this._outlineColor)),y&&z.setUniform4f("u_id",r[0],r[1],r[2],r[3]),c.drawElements(4,b.outlineElementCount,5125,12*b.outlineElementStart),c.bindVAO()}}},t.prototype._initialize=function(a){if(this._initialized)return!0;var b=new e("fill",["fillVS","fillFS"],[],c,a);b.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN");b.addDefine("DD","DD",[!0,!1],"DD");b.addDefine("ID","ID",[!0,!0],"ID");
this._fillShaderVariations=b;this._fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};this._fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]};a=new e("outline",["outlineVS","outlineFS"],[],c,a);return a.addDefine("DD","DD",[!0,!1],"DD"),a.addDefine("ID","ID",[!0,!0],"ID"),this._outlineShaderVariations=a,
this._outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]},this._outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,
offset:6,stride:12,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,divisor:0}]},this._initialized=!0,!0},t.prototype._drawFill=function(a,c,b,e,f,n,g,k,h,t,l,m){var w=n.getPaintValue("fill-pattern",b),r=void 0!==w,u=t*n.getPaintValue("fill-opacity",b);t=n.getPaintValue("fill-color",b);var z=n.hasDataDrivenFill,v=z?.5:t[3]*u,y=!1;if(r||1!==v||(y=!0),!(r&&0===e||y&&1===e)&&(r||y||0!==e))if(e=this._getFillVAO(a,f,z)){a.bindVAO(e);e=this._fillShaderVariations.getProgram([r,
z,l],void 0,void 0,z?this._fillAttributeLocationsDD:this._fillAttributeLocations);if(a.bindProgram(e),r)if(w=g.getMosaicItemPosition(w,!0))b=f.coordRange/512/Math.pow(2,Math.round(b)-f.key.level)/h,d.identity(this._patternMatrix),h=1/(w.size[1]*b),this._patternMatrix[0]=1/(w.size[0]*b),this._patternMatrix[4]=h,g.bind(a,9729,w.page,1),e.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix),e.setUniform2f("u_pattern_tl",w.tl[0],w.tl[1]),e.setUniform2f("u_pattern_br",w.br[0],w.br[1]),e.setUniform1i("u_texture",
1);(e.setUniformMatrix4fv("u_transformMatrix",k),e.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),e.setUniform1f("u_depth",n.z+q),z)||(f=u*t[3],this._color[0]=f*t[0],this._color[1]=f*t[1],this._color[2]=f*t[2],this._color[3]=f,e.setUniform4fv("u_color",this._color));l&&e.setUniform4f("u_id",m[0],m[1],m[2],m[3]);a.drawElements(4,c.triangleElementCount,5125,12*c.triangleElementStart);a.bindVAO()}},t.prototype._getFillVAO=function(a,c,b){if(b){if(c.fillDDVertexArrayObject)return c.fillDDVertexArrayObject;
b=c.fillDDVertexBuffer;var e=c.fillIndexBuffer;return b&&e?(c.fillDDVertexArrayObject=new k(a,this._fillAttributeLocationsDD,this._fillVertexAttributesDD,{geometry:b},e),c.fillDDVertexArrayObject):null}if(c.fillVertexArrayObject)return c.fillVertexArrayObject;b=c.fillVertexBuffer;e=c.fillIndexBuffer;return b&&e?(c.fillVertexArrayObject=new k(a,this._fillAttributeLocations,this._fillVertexAttributes,{geometry:b},e),c.fillVertexArrayObject):null},t.prototype._getOutlineVAO=function(a,c,b){if(b){if(c.outlineDDVertexArrayObject)return c.outlineDDVertexArrayObject;
b=c.outlineDDVertexBuffer;var e=c.outlineIndexBuffer;return b&&e?(c.outlineDDVertexArrayObject=new k(a,this._outlineAttributeLocationsDD,this._outlineVertexAttributesDD,{geometry:b},e),c.outlineDDVertexArrayObject):null}if(c.outlineVertexArrayObject)return c.outlineVertexArrayObject;b=c.outlineVertexBuffer;e=c.outlineIndexBuffer;return b&&e?(c.outlineVertexArrayObject=new k(a,this._outlineAttributeLocations,this._outlineVertexAttributes,{geometry:b},e),c.outlineVertexArrayObject):null},t}()})},"esri/views/vectorTiles/renderers/SymbolRenderer":function(){define(["require",
"exports","./IconRenderer","./SDFRenderer"],function(m,l,h,d){return function(){function b(){this._iconRenderer=new h;this._sdfRenderer=new d}return b.prototype.dispose=function(){this._iconRenderer&&(this._iconRenderer.dispose(),this._iconRenderer=null);this._sdfRenderer&&(this._sdfRenderer.dispose(),this._sdfRenderer=null)},b.prototype.render=function(b,d,f,a,e,c,q,h,r,u,v,l,y,n){d.hasData()&&(0<d.markerPerPageElementsMap.size&&this._iconRenderer.render(b,d,f,a,e,c,q,h,r,v,l,n),0<d.glyphPerPageElementsMap.size&&
this._sdfRenderer.render(b,d,f,a,e,c,q,h,u,v,l,y,n))},b}()})},"esri/views/vectorTiles/renderers/IconRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec3 ../../webgl/VertexArrayObject ../GeometryUtils ./rendererUtils ../../webgl/ShaderVariations ./vtShaderSnippets".split(" "),function(m,l,h,d,b,g,k,f,a){return function(){function e(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._attributeLocationsDD={a_pos:0,
a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5};this._spritesTextureSize=new Float32Array(2);this._initialized=!1;this._viewProjMat=h.create();this._offsetVector=d.create();this._extrudeMat=h.create()}return e.prototype.dispose=function(){},e.prototype.render=function(a,b,e,d,f,v,l,y,n,w,z,C){var c=this;this._initialized||this._initialize(a);var q=y.getLayoutValue("icon-size",e);C*=y.getPaintValue("icon-opacity",e);var r=y.getLayoutValue("icon-rotation-alignment",e);2===r&&(r=1===y.getLayoutValue("symbol-placement",
e)?0:1);var t=0===r,u=b.isSDF,x=y.hasDataDrivenIcon;d=3===d;var r=g.degToByte(f),m=l.tileTransform.transform,Q=y.getPaintValue("icon-translate",e);if(0!==Q[0]||0!==Q[1]){h.copy(this._viewProjMat,l.tileTransform.transform);var m=Q[0],Q=Q[1],T=0,O=0,O=(1<<l.key.level)/Math.pow(2,e)*(l.coordRange/512);if(1===y.getPaintValue("icon-translate-anchor",e)){T=-g.C_DEG_TO_RAD*f;f=Math.sin(T);var S=Math.cos(T),T=O*(m*S-Q*f),O=O*(m*f+Q*S)}else T=O*m,O*=Q;this._offsetVector[0]=T;this._offsetVector[1]=O;this._offsetVector[2]=
0;h.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);m=this._viewProjMat}t?h.copy(this._extrudeMat,w):h.copy(this._extrudeMat,z);if(w=this._getIconVAO(a,l,x)){a.bindVAO(w);var H=this._shaderVariations.getProgram([u,x,d],void 0,void 0,x?this._attributeLocationsDD:this._attributeLocations);if(a.bindProgram(H),u)w=y.getPaintValue("icon-color",e),z=y.getPaintValue("icon-halo-color",e),u=y.getPaintValue("icon-halo-width",e),H.setUniform4f("u_color",w[0],w[1],w[2],w[3]),H.setUniform4f("u_outlineColor",
z[0],z[1],z[2],z[3]),H.setUniform1f("u_outlineSize",u);if(H.setUniformMatrix4fv("u_transformMatrix",m),H.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),H.setUniform2fv("u_normalized_origin",l.tileTransform.displayCoord),H.setUniform1f("u_depth",y.z),H.setUniform1f("u_mapRotation",r),H.setUniform1f("u_keepUpright",0),H.setUniform1f("u_level",10*e),H.setUniform1f("u_fadeSpeed",10*v.fadeSpeed),H.setUniform1f("u_minfadeLevel",10*v.minfadeLevel),H.setUniform1f("u_maxfadeLevel",10*v.maxfadeLevel),
H.setUniform1f("u_fadeChange",10*(e+v.fadeChange)),H.setUniform1i("u_texture",1),H.setUniform1f("u_size",q),H.setUniform1f("u_opacity",C),d)e=k.int32To4Bytes(b.layerID),H.setUniform4f("u_id",e[0],e[1],e[2],e[3]);b.markerPerPageElementsMap.forEach(function(b,e){c._spritesTextureSize[0]=n.getWidth(e)/4;c._spritesTextureSize[1]=n.getHeight(e)/4;H.setUniform2fv("u_mosaicSize",c._spritesTextureSize);n.bind(a,9729,e,1);a.drawElements(4,b[1],5125,12*b[0])});a.bindVAO()}},e.prototype._initialize=function(c){if(this._initialized)return!0;
c=new f("icon",["iconVS","iconFS"],[],a,c);return c.addDefine("SDF","SDF",[!0,!0],"SDF"),c.addDefine("DD","DD",[!0,!1],"DD"),c.addDefine("ID","ID",[!0,!0],"ID"),this._shaderVariations=c,this._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,
stride:16,normalized:!1,divisor:0}]},this._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,
offset:20,stride:24,normalized:!1,divisor:0}]},this._initialized=!0,!0},e.prototype._getIconVAO=function(a,e,d){if(d){if(e.iconDDVertexArrayObject)return e.iconDDVertexArrayObject;d=e.iconDDVertexBuffer;var c=e.iconIndexBuffer;return d&&c?(e.iconDDVertexArrayObject=new b(a,this._attributeLocationsDD,this._vertexAttributesDD,{geometry:d},c),e.iconDDVertexArrayObject):null}if(e.iconVertexArrayObject)return e.iconVertexArrayObject;d=e.iconVertexBuffer;c=e.iconIndexBuffer;return d&&c?(e.iconVertexArrayObject=
new b(a,this._attributeLocations,this._vertexAttributes,{geometry:d},c),e.iconVertexArrayObject):null},e}()})},"esri/views/vectorTiles/renderers/SDFRenderer":function(){define("require exports dojo/has ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../webgl/VertexArrayObject ../GeometryUtils ./rendererUtils ../../webgl/ShaderVariations ./vtShaderSnippets".split(" "),function(m,l,h,d,b,g,k,f,a,e,c){var q=1/65536;return function(){function t(){this._attributeLocations=
{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._attributeLocationsDD={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5};this._initialized=!1;this._viewProjMat=d.create();this._offsetVector=g.create();this._extrudeMat=d.create();this._haloColor=b.create();this._sdfColor=b.create();this._scaleVec=g.create()}return t.prototype.dispose=function(){},t.prototype.render=function(c,b,e,g,k,n,w,t,l,m,F,G,N){var r=this;if(!h("esri-vector-tiles-avoid-text")){this._initialized||this._initialize(c);
var u=t.getLayoutValue("text-size",e),z=f.degToByte(k),v=t.getLayoutValue("text-rotation-alignment",e);2===v&&(v=1===t.getLayoutValue("symbol-placement",e)?0:1);var y=0===v,v=t.getLayoutValue("text-keep-upright",e)&&y;g=3===g;G=.8*3/G;var x=N*t.getPaintValue("text-opacity",e);this._glyphTextureSize||(this._glyphTextureSize=new Float32Array([l.width/4,l.height/4]));N=w.tileTransform.transform;var C=t.getPaintValue("text-translate",e);if(0!==C[0]||0!==C[1]){d.copy(this._viewProjMat,w.tileTransform.transform);
N=C[0];var C=C[1],H=0,B=0,B=(1<<w.key.level)/Math.pow(2,e)*(w.coordRange/512);if(1===t.getPaintValue("text-translate-anchor",e)){H=-f.C_DEG_TO_RAD*k;k=Math.sin(H);var W=Math.cos(H),H=B*(N*W-C*k),B=B*(N*k+C*W)}else H=B*N,B*=C;this._offsetVector[0]=H;this._offsetVector[1]=B;this._offsetVector[2]=0;d.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);N=this._viewProjMat}y?d.copy(this._extrudeMat,m):d.copy(this._extrudeMat,F);this._scaleVec[0]=1/24;this._scaleVec[1]=1/24;this._scaleVec[2]=
1;d.scale(this._extrudeMat,this._extrudeMat,this._scaleVec);m=t.hasDataDrivenText;if(F=this._getSDFVAO(c,w,m)){c.bindVAO(F);var E=this._shaderVariations.getProgram([m,g],void 0,void 0,m?this._attributeLocationsDD:this._attributeLocations);if(c.bindProgram(E),E.setUniformMatrix4fv("u_transformMatrix",N),E.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),E.setUniform2fv("u_normalized_origin",w.tileTransform.displayCoord),E.setUniform1f("u_depth",t.z+q),E.setUniform2fv("u_mosaicSize",this._glyphTextureSize),
E.setUniform1f("u_mapRotation",z),E.setUniform1f("u_keepUpright",v?1:0),E.setUniform1f("u_level",10*e),E.setUniform1f("u_fadeSpeed",10*n.fadeSpeed),E.setUniform1f("u_minfadeLevel",10*n.minfadeLevel),E.setUniform1f("u_maxfadeLevel",10*n.maxfadeLevel),E.setUniform1f("u_fadeChange",10*(e+n.fadeChange)),E.setUniform1f("u_opacity",x),E.setUniform1i("u_texture",0),E.setUniform1f("u_size",u),E.setUniform1f("u_antialiasingWidth",G),g)n=a.int32To4Bytes(b.layerID),E.setUniform4f("u_id",n[0],n[1],n[2],n[3]);
b.glyphPerPageElementsMap.forEach(function(a,b){l.bind(c,9729,b,0);var p=t.getPaintValue("text-halo-color",e);b=t.getPaintValue("text-halo-width",e);if(0<p[3]&&0<b){var A=p[3]*x;r._haloColor[0]=A*p[0];r._haloColor[1]=A*p[1];r._haloColor[2]=A*p[2];r._haloColor[3]=A;p=3*t.getPaintValue("text-halo-blur",e);b*=3;E.setUniform4fv("u_color",r._haloColor);E.setUniform1f("u_halo",1);E.setUniform1f("u_edgeDistance",b);E.setUniform1f("u_edgeBlur",p);c.drawElements(4,a[1],5125,12*a[0])}b=t.getPaintValue("text-color",
e);0<b[3]&&(p=b[3]*x,r._sdfColor[0]=p*b[0],r._sdfColor[1]=p*b[1],r._sdfColor[2]=p*b[2],r._sdfColor[3]=p,E.setUniform4fv("u_color",r._sdfColor),E.setUniform1f("u_halo",0),E.setUniform1f("u_edgeDistance",0),E.setUniform1f("u_edgeBlur",0),c.drawElements(4,a[1],5125,12*a[0]))});c.bindVAO()}}},t.prototype._initialize=function(a){if(this._initialized)return!0;a=new e("text",["textVS","textFS"],[],c,a);return a.addDefine("DD","DD",[!0,!1],"DD"),a.addDefine("ID","ID",[!0,!0],"ID"),this._shaderVariations=
a,this._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]},this._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,
type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}]},this._initialized=!0,!0},t.prototype._getSDFVAO=function(a,c,b){if(b){if(c.textDDVertexArrayObject)return c.textDDVertexArrayObject;
b=c.textDDVertexBuffer;var e=c.textIndexBuffer;return b&&e?(c.textDDVertexArrayObject=new k(a,this._attributeLocationsDD,this._vertexAttributesDD,{geometry:b},e),c.textDDVertexArrayObject):null}if(c.textVertexArrayObject)return c.textVertexArrayObject;b=c.textVertexBuffer;e=c.textIndexBuffer;return b&&e?(c.textVertexArrayObject=new k(a,this._attributeLocations,this._vertexAttributes,{geometry:b},e),c.textVertexArrayObject):null},t}()})},"esri/views/vectorTiles/renderers/TileInfoRenderer":function(){define("require exports ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Texture ../GeometryUtils ./vtShaderSnippets".split(" "),
function(m,l,h,d,b,g,k,f){return function(){function a(){this._initialized=!1;this._maxWidth=0;this._color=new Float32Array([1,0,0,1])}return a.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),
this._tileInfoVertexArrayObject=null)},a.prototype.render=function(a,c){this._initialized||this._initialize(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",c.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",c.tileTransform.displayCoord);this._outlineProgram.setUniform1f("u_coord_range",c.coordRange);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",
this._color);a.setLineWidth(2);a.drawArrays(3,0,4);a.bindVAO();var b=this._getTexture(a,c);b&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(b,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",c.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",c.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform1f("u_coord_ratio",c.coordRange/512),this._tileInfoProgram.setUniform2f("u_delta",
8,8),this._tileInfoProgram.setUniform2f("u_dimensions",b.descriptor.width,b.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())},a.prototype._initialize=function(a){if(this._initialized)return!0;var c={a_pos:0},e=new h(a,f.backgroundVS,f.backgroundFS,c),g=new h(a,f.tileInfoVS,f.tileInfoFS,c),k={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},u=new Int8Array([0,0,1,0,1,1,0,1]),u=b.createVertex(a,35044,u),u=new d(a,c,k,{geometry:u}),v=new Int8Array([0,0,1,0,0,
1,1,1]),v=b.createVertex(a,35044,v);a=new d(a,c,k,{geometry:v});return this._outlineProgram=e,this._tileInfoProgram=g,this._outlineVertexArrayObject=u,this._tileInfoVertexArrayObject=a,this._initialized=!0,!0},a.prototype._getTexture=function(a,c){if(c.texture)return c.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));
var b=c.key.id,e=this._canvas.getContext("2d");e.font="24px sans-serif";e.textAlign="left";e.textBaseline="middle";var d=e.measureText(b),d=Math.pow(2,Math.ceil(k.log2(d.width+2)));d>this._maxWidth&&(this._maxWidth=d);return e.clearRect(0,0,this._maxWidth,32),e.fillStyle=c.key.level>c.refKey.level?"red":"blue",e.fillText(b,0,16),c.texture=new g(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas),c.texture},a}()})},"esri/views/vectorTiles/renderers/FadeRecorder":function(){define(["require",
"exports","../../../core/now"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});m=(function(){return function(d,b){this.level=d;this.now=b}}(),function(){return function(d,b,g,k){this.fadeSpeed=d;this.minfadeLevel=b;this.maxfadeLevel=g;this.fadeChange=k}}());l.FadeProperties=m;m=function(){function d(b){void 0===b&&(b=300);this._levelSnapshots=[];this._duration=b}return d.prototype.recordLevel=function(b){var d=h(),k=this._levelSnapshots;0===k.length&&(k.push({level:b,now:0}),k.push({level:b,
now:0}));2!==k.length&&k[0].level===b||k.push({level:b,now:d})},d.prototype.needsRedraw=function(){if(0===this._levelSnapshots.length)return!1;for(var b=this._duration,d=this._levelSnapshots,k=d.length,f=d[k-1],a=-1;k>a+1&&d[a+1].now+b<f.now;)a++;for(0>a&&(a=0);k>a;a++)if(d[a].level!==f.level)return!0;return!1},d.prototype.getFadeValues=function(b){void 0===b&&(b=!1);for(var d=this._duration,k=h(),f=this._levelSnapshots;3<f.length&&f[1].now+d<k;)f.shift();f[1].now+d<k&&(f[0].level=f[1].level);var a=
f[0].level,e=f[f.length-1],c=e.level,q=Math.min(a,c),a=Math.max(a,c),f=(e.level-f[1].level)/((e.now-f[1].now)/d),d=(k-e.now)/d*f;return b?{fadeSpeed:0,minfadeLevel:q,maxfadeLevel:a,fadeChange:0}:{fadeSpeed:f,minfadeLevel:q,maxfadeLevel:a,fadeChange:d}},d}();l.FadeRecorder=m})},"esri/views/3d/layers/TiledLayerView3D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Error ./LayerView3D ./support/LayerViewUpdatingPercentage ../terrain/terrainUtils".split(" "),
function(m,l,h,d,b,g,k,f,a){return function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;return a.minDataLevel=0,a.maxDataLevel=1/0,a._numUpdating=0,a._maxNumUpdating=0,a._isUpdating=!1,a}return h(c,e),Object.defineProperty(c.prototype,"formatIsTransparent",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isTransparent",{get:function(){return 1>this.fullOpacity||this.formatIsTransparent},enumerable:!0,configurable:!0}),c.prototype.getTileUrl=
function(a,c,b){return this.layer.getTileUrl(a,c,b)},c.prototype._evaluateUpdatingState=function(a){this._isUpdating=a;this.notifyChange("updating")},c.prototype.isUpdating=function(){return this._isUpdating},c.prototype._getTileInfoSupportError=function(c,b){if(c=a.checkIfTileInfoSupportedForView(c,b,this.view.spatialReference,this.view.basemapTerrain.manifold)){b={layer:this.layer,error:c};var e=void 0;switch(c.name){case "tilingscheme:local-gcs-not-supported":e=new g("layerview:local-gcs-not-supported",
"Geographic coordinate systems are not supported in local scenes",b);break;case "tilingscheme:spatial-reference-mismatch":case "tilingscheme:global-unsupported-spatial-reference":e=new g("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",b);break;default:e=new g("layerview:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",b)}return e}return null},c.prototype._getTileInfoCompatibilityError=
function(a,c){return c.compatibleWith(a)?null:new g("layerview:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface")},c.prototype._updateMinMaxDataLevel=function(){var a=1/0,c=0;this.tileInfo.lods.forEach(function(b){a=Math.min(b.level,a);c=Math.max(b.level,c)});b=[a,c];this.minDataLevel=b[0];this.maxDataLevel=b[1];var b},d([b.property({readOnly:!0})],c.prototype,"formatIsTransparent",null),d([b.property()],c.prototype,"fullExtent",void 0),
d([b.property({readOnly:!0,dependsOn:["fullOpacity","formatIsTransparent"]})],c.prototype,"isTransparent",null),d([b.property()],c.prototype,"layer",void 0),d([b.property()],c.prototype,"minDataLevel",void 0),d([b.property()],c.prototype,"maxDataLevel",void 0),d([b.property()],c.prototype,"tileInfo",void 0),c=d([b.subclass("esri.views.3d.layers.TiledLayerView3D")],c)}(b.declared(k,f))})},"esri/views/3d/layers/LayerView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/promiseUtils ../../../core/watchUtils ../../../geometry/support/heightModelInfoUtils ../../layers/LayerView".split(" "),
function(m,l,h,d,b,g,k,f,a){return function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;return c.supportsHeightUnitConversion=!1,c}return h(c,a),c.prototype.postscript=function(a){this.inherited(arguments);f.mayHaveHeightModelInfo(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())},c.prototype._validateHeightModelInfo=function(){var a=this;return g.create(function(c,b){k.whenFalseOnce(a.view.defaultsFromMap,"isHeightModelInfoSearching",function(){var e=f.rejectLayerError(a.layer,
a.view.heightModelInfo,a.supportsHeightUnitConversion);e?b(e):c()})})},d([b.property()],c.prototype,"view",void 0),c=d([b.subclass("esri.views.3d.layers.LayerView3D")],c)}(b.declared(a))})},"esri/geometry/support/heightModelInfoUtils":function(){define(["require","exports","../../core/Error","../../layers/support/arcgisLayerUrl","../HeightModelInfo"],function(m,l,h,d,b){function g(a,b,e){if(!k(a)||!k(b))return 4;if(null==a||null==b)return 0;if(!e&&a.heightUnit!==b.heightUnit)return 1;if(a.heightModel!==
b.heightModel)return 2;switch(a.heightModel){case "gravity-related-height":return 0;case "ellipsoidal":return a.vertCRS===b.vertCRS?0:3;default:return 4}}function k(a){return null==a||null!=a.heightModel&&null!=a.heightUnit}function f(c){var f=c.url&&d.parse(c.url);return null==(c.spatialReference&&c.spatialReference.vcsWkid)&&f&&"ImageServer"===f.serverType||!c.heightModelInfo?("hasZ"in c?!0===c.hasZ:a(c))?b.deriveUnitFromSR(e,c.spatialReference):null:c.heightModelInfo}function a(a){switch(a.type){case "elevation":case "integrated-mesh":case "point-cloud":case "scene":return!0;
default:return!1}}Object.defineProperty(l,"__esModule",{value:!0});l.validateWebSceneError=function(a,e){if(!a)return null;if(!k(a))return new h("webscene:unsupported-height-model-info","The vertical coordinate system of the scene is not supported",{heightModelInfo:a});var c=a.heightUnit;a=b.deriveUnitFromSR(a,e).heightUnit;return c!==a?new h("webscene:incompatible-height-unit","The vertical units of the scene ("+c+") must match the horizontal units of the scene ("+a+")",{verticalUnit:c,horizontalUnit:a}):
null};l.rejectLayerError=function(c,e,d){var k=f(c),q=g(k,e,d),t=null;if(k){var l=b.deriveUnitFromSR(k,c.spatialReference).heightUnit;d||l===k.heightUnit||(t=new h("layerview:unmatched-height-unit","The vertical units of the layer must match the horizontal units ("+l+")",{horizontalUnit:l}))}if(null==c.heightModelInfo&&null==c.spatialReference&&("hasZ"in c?!0===c.hasZ:a(c))||4===q||t)return new h("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",
{heightModelInfo:k,error:t});t=null;switch(q){case 1:c=k.heightUnit||"unknown";d=e.heightUnit||"unknown";t=new h("layerview:incompatible-height-unit","The vertical units of the layer ("+c+") must match the vertical units of the scene ("+d+")",{layerUnit:c,sceneUnit:d});break;case 2:c=k.heightModel||"unknown";d=e.heightModel||"unknown";t=new h("layerview:incompatible-height-model","The height model of the layer ("+c+") must match the height model of the scene ("+d+")",{layerHeightModel:c,sceneHeightModel:d});
break;case 3:c=k.vertCRS||"unknown",d=e.vertCRS||"unknown",t=new h("layerview:incompatible-vertical-datum","The vertical datum of the layer ("+c+") must match the vertical datum of the scene ("+d+")",{layerDatum:c,sceneDatum:d})}return t?new h("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:k,sceneHeightModelInfo:e,error:t}):null};l.deriveHeightModelInfoFromLayer=f;l.mayHaveHeightModelInfo=function(c){return null!=
c.layers||a(c)||void 0!==c.hasZ||void 0!==c.heightModelInfo};var e=new b({heightModel:"gravity-related-height"})})},"esri/layers/support/arcgisLayerUrl":function(){define(["require","exports","../../core/urlUtils"],function(m,l,h){function d(d){var g=h.urlToObject(d).path.match(l.match);if(!g)return null;d=g[1];var f=g[2],a=g[3],g=g[4],e=f.indexOf("/");return{title:b(-1!==e?f.slice(e+1):f),serverType:a,sublayer:null!=g&&""!==g?parseInt(g,10):null,url:{path:d}}}function b(b){return b=b.replace(/\s*[\/_]+\s*/g,
" "),b[0].toUpperCase()+b.slice(1)}Object.defineProperty(l,"__esModule",{value:!0});l.serverTypes="MapServer ImageServer FeatureServer SceneServer StreamServer VectorTileServer".split(" ");l.match=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/("+l.serverTypes.join("|")+"))(?:\\/(?:layers\\/)?(\\d+))?","i");l.test=function(b){return!!l.match.test(b)};l.parse=d;l.cleanTitle=b;l.titleFromUrlAndName=function(g,k){var f=[];g&&(g=d(g))&&g.title&&f.push(g.title);k&&(k=b(k),f.push(k));
if(2===f.length){if(-1!==f[0].toLowerCase().indexOf(f[1].toLowerCase()))return f[0];if(-1!==f[1].toLowerCase().indexOf(f[0].toLowerCase()))return f[1]}return f.join(" - ")};l.isHostedAgolService=function(b){if(!b)return!1;b=b.toLowerCase();var d=-1!==b.indexOf(".arcgis.com/");b=-1!==b.indexOf("//services")||-1!==b.indexOf("//tiles")||-1!==b.indexOf("//features");return d&&b};l.isHostedSecuredProxyService=function(b,d){return d&&b&&-1!==b.toLowerCase().indexOf(d.toLowerCase())};l.sanitizeUrl=function(b,
d){return b?h.removeTrailingSlash(h.removeQueryParameters(b,d)):b};l.sanitizeUrlWithLayerId=function(b,k,f){if(!k)return{url:k};k=h.removeQueryParameters(k,f);var a;f=h.urlToObject(k);f=d(f.path);return f&&null!=f.sublayer&&(null==b.layerId&&(a=f.sublayer),k=f.url.path),{url:h.removeTrailingSlash(k),layerId:a}};l.writeUrlWithLayerId=function(b,d,f,a){var e=null;a?e=f:a=f;h.writeOperationalLayerUrl(d,a);a.url&&null!=b.layerId&&(a.url=h.join(a.url,e,b.layerId.toString()))}})},"esri/geometry/HeightModelInfo":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang ../core/JSONSupport ../core/kebabDictionary ../core/Warning ../core/accessorSupport/decorators ./support/scaleUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e){function c(a,c){return new f("height-unit:unsupported","Height unit of value '"+a+"' is not supported",c)}function q(a,c){return new f("height-model:unsupported","Height model of value '"+a+"' is not supported",c)}var t=k({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"},{ignoreUnknown:!0}),r=k({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links",
"sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"},{ignoreUnknown:!0});return function(f){function g(a){a=f.call(this)||this;return a.heightModel="gravity-related-height",a.heightUnit="meters",a.vertCRS=
null,a}return h(g,f),k=g,g.prototype.writeHeightModel=function(a,c,b){return t.write(a,c,b)},g.prototype.readHeightModel=function(a,c,b){return(c=t.read(a))?c:(b&&b.messages&&b.messages.push(q(a,{context:b})),null)},g.prototype.readHeightUnit=function(a,b,e){return(b=r.read(a))?b:(e&&e.messages&&e.messages.push(c(a,{context:e})),null)},g.prototype.readHeightUnitService=function(a,b,d){return(b=e.unitFromRESTJSON(a)||r.read(a))?b:(d&&d.messages&&d.messages.push(c(a,{context:d})),null)},g.prototype.readVertCRS=
function(a,c){return c.vertCRS||c.ellipsoid||c.geoid},g.prototype.clone=function(){return new k({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})},g.prototype.equals=function(a){return a?this===a?!0:this.heightModel===a.heightModel&&this.heightUnit===a.heightUnit&&this.vertCRS===a.vertCRS:!1},g.deriveUnitFromSR=function(a,c){c=e.getVerticalUnitStringForSR(c);return new k({heightModel:a.heightModel,heightUnit:c,vertCRS:a.vertCRS})},g.prototype.write=function(a,c){return c=
b.mixin({},{origin:"web-scene"},c),this.inherited(arguments,[a,c])},g.fromJSON=function(a){if(!a)return null;var c=new k;return c.read(a,{origin:"web-scene"}),c},d([a.property({type:String,constructOnly:!0})],g.prototype,"heightModel",void 0),d([a.writer("web-scene","heightModel")],g.prototype,"writeHeightModel",null),d([a.reader(["web-scene","service"],"heightModel")],g.prototype,"readHeightModel",null),d([a.property({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:r.write}}}})],g.prototype,
"heightUnit",void 0),d([a.reader("web-scene","heightUnit")],g.prototype,"readHeightUnit",null),d([a.reader("service","heightUnit")],g.prototype,"readHeightUnitService",null),d([a.property({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],g.prototype,"vertCRS",void 0),d([a.reader("service","vertCRS",["vertCRS","ellipsoid","geoid"])],g.prototype,"readVertCRS",null),g=k=d([a.subclass("esri.HeightModelInfo")],g);var k}(a.declared(g))})},"esri/geometry/support/scaleUtils":function(){define(["require",
"exports","../../config","../../core/kebabDictionary","./WKIDUnitConversion"],function(m,l,h,d,b){function g(a){return u.fromJSON(a.toLowerCase())||null}function k(a){return f(a)||q}function f(a){var c,b,e;(a&&("object"==typeof a?(c=a.wkid,b=a.wkt):"number"==typeof a?c=a:"string"==typeof a&&(b=a)),c)?e=r.values[r[c]]:b&&-1!==b.search(/^PROJCS/i)&&(a=t.exec(b))&&a[1]&&(e=parseFloat(a[1].split(",")[1]));return e}function a(a){var c,b,e;(a&&("object"==typeof a?(c=a.wkid,b=a.wkt):"number"==typeof a?c=
a:"string"==typeof a&&(b=a)),c)?e=r.units[r[c]]:b&&-1!==b.search(/^PROJCS/i)&&(a=t.exec(b))&&a[1]&&(a=/[\\"\\']{1}([^\\"\\']+)/.exec(a[1]),e=a&&a[1]);return e?g(e):null}function e(a,b){b=k(b);return a/(b*c*h.screenDPI)}Object.defineProperty(l,"__esModule",{value:!0});var c=39.37,q=20015077/180,t=/UNIT\[([^\]]+)\]\]$/i,r=b,u=d({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",
chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"},{ignoreUnknown:!0});l.unitFromRESTJSON=g;l.unitToRESTJSON=function(a){return u.toJSON(a)||null};l.getMetersPerVerticalUnitForSR=function(a){a=k(a);return 1E5<a?1:a};l.getVerticalUnitStringForSR=function(c){return 1E5<
k(c)?"meters":a(c)};l.getMetersPerUnitForSR=k;l.getMetersPerUnit=f;l.getUnitString=a;l.getScale=function(a,b){b=b||a.extent;a=a.width;var e=f(b&&b.spatialReference);return b&&a?b.width/a*(e||q)*c*h.screenDPI:0};l.getResolutionForScale=e;l.getExtentForScale=function(a,c){var b=a.extent;a=a.width;c=e(c,b.spatialReference);return b.clone().expand(c*a/b.width)}})},"esri/views/layers/LayerView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Evented ../../core/HandleRegistry ../../core/Identifiable ../../core/Logger ../../core/Promise ../../core/promiseUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){return function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;return c.handles=new f,c.layer=null,c.parent=null,c.view=null,c}return h(c,a),c.prototype.initialize=function(){var a=this;this.addResolvingPromise(this.layer);this.when()["catch"](function(c){if("layerview:create-error"!==c.name){var b=a.layer&&a.layer.id||"no id",d=a.layer&&a.layer.title||"no title";return e.getLogger(a.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+
d+"', id: '"+b+"')",c),q.reject(c)}})},c.prototype.destroy=function(){this.layer=this.view=this.parent=null},Object.defineProperty(c.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"updating",{get:function(){return!this.suspended&&this.isUpdating()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(a){return void 0===a?void this._clearOverride("visible"):
void this._override("visible",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"fullOpacity",{get:function(){var a=this.get("layer.opacity"),a=null!=a?a:1,c=this.get("parent.fullOpacity");return a*(null!=c?c:1)},enumerable:!0,configurable:!0}),c.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},c.prototype.isUpdating=function(){return!1},d([b.property()],c.prototype,"layer",void 0),d([b.property()],
c.prototype,"parent",void 0),d([b.property({readOnly:!0,dependsOn:["view","visible","layer.loaded","parent.suspended"]})],c.prototype,"suspended",null),d([b.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],c.prototype,"updating",null),d([b.property()],c.prototype,"view",void 0),d([b.property({dependsOn:["layer.visible"]})],c.prototype,"visible",null),d([b.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],c.prototype,"fullOpacity",null),c=d([b.subclass("esri.views.layers.LayerView")],
c)}(b.declared(g,k,a,c))})},"esri/core/HandleRegistry":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./accessorSupport/decorators ./Accessor ./Collection".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;return a._groups=new Map,a}return h(a,f),a.prototype.destroy=function(){this.removeAll()},Object.defineProperty(a.prototype,"size",{get:function(){var a=0;return this._groups.forEach(function(c){a+=
c.length}),a},enumerable:!0,configurable:!0}),a.prototype.add=function(a,c){if(!this._isHandle(a)&&!Array.isArray(a)&&!k.isCollection(a))return this;var b=this._getOrCreateGroup(c);return Array.isArray(a)||k.isCollection(a)?a.forEach(function(a){return b.push(a)}):b.push(a),this.notifyChange("size"),this},a.prototype.has=function(a){return this._groups.has(this._ensureGroupKey(a))},a.prototype.remove=function(a){if(Array.isArray(a)||k.isCollection(a))return a.forEach(this.remove,this),this;if(!this.has(a))return this;
for(var c=this._getGroup(a),b=0;b<c.length;b++)c[b].remove();return this._deleteGroup(a),this.notifyChange("size"),this},a.prototype.removeAll=function(){return this._groups.forEach(function(a){for(var c=0;c<a.length;c++)a[c].remove()}),this._groups.clear(),this.notifyChange("size"),this},a.prototype._isHandle=function(a){return a&&!!a.remove},a.prototype._getOrCreateGroup=function(a){if(this.has(a))return this._getGroup(a);var c=[];return this._groups.set(this._ensureGroupKey(a),c),c},a.prototype._getGroup=
function(a){return this._groups.get(this._ensureGroupKey(a))},a.prototype._deleteGroup=function(a){return this._groups["delete"](this._ensureGroupKey(a))},a.prototype._ensureGroupKey=function(a){return a||"_default_"},d([b.property({readOnly:!0})],a.prototype,"size",null),a=d([b.subclass()],a)}(b.declared(g))})},"esri/views/3d/layers/support/LayerViewUpdatingPercentage":function(){define(["../../../../core/Accessor"],function(m){return m.createSubclass([],{properties:{updating:{readOnly:!0},updatingPercentageValue:{value:100,
readOnly:!0},updatingPercentage:{dependsOn:["updating","updatingPercentageValue"],readOnly:!0,value:0,get:function(){return this.updating?this.updatingPercentageValue:0}}},constructor:function(){}})})},"esri/views/3d/terrain/terrainUtils":function(){define("require exports ./terrainUtilsPlanar ./terrainUtilsSpherical ../../../layers/TiledLayer ../../../layers/TileLayer ../../../layers/BaseTileLayer ../../../layers/BaseElevationLayer ../../../layers/ElevationLayer ../../../layers/VectorTileLayer ../../../layers/WMTSLayer ../../../support/basemapDefinitions".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){function t(a){return a&&"esri.views.3d.layers.TileLayerView3D"===a.declaredClass}function r(a){return a&&"esri.views.3d.layers.VectorTileLayerView3D"===a.declaredClass}function u(a){return a&&"esri.views.3d.layers.WMTSLayerView3D"===a.declaredClass}function v(a){return a&&"esri.views.3d.layers.ElevationLayerView3D"===a.declaredClass}function x(){w={};for(var a in q)q[a].baseMapLayers.forEach(function(a){w[a.url]=19});w["//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"]=
20}function y(a,c,b,e){var d;return d="local"===e||"planar"===e?"planar":"spherical",n[d].checkIfTileInfoSupportedForViewSR(a,c,b)}Object.defineProperty(l,"__esModule",{value:!0});var n={planar:h,spherical:d};l.weakAssert=function(a,c){a||console.warn("Terrain: "+c)};l.autoUpdateSkirtsVisibility=function(a,c){n[a.manifold].autoUpdateSkirtsVisibility(a,c)};l.isTiledLayer=function(a){return a&&(a.isInstanceOf(b)||a.isInstanceOf(k)||a.isInstanceOf(f)||a.isInstanceOf(c))};l.isVectorTileLayer=function(a){return a&&
a.isInstanceOf(e)};l.isTileLayerView=t;l.isVectorTileLayerView=r;l.isWMTSLayerView=u;l.isElevationLayerView=v;l.isTiledLayerView=function(a){return a&&(t(a)||v(a)||r(a)||u(a))};l.useFetchTileForLayer=function(c){return c.fetchTile&&!(c.fetchTile===g.prototype.fetchTile||c.fetchTile===a.prototype.fetchTile)};var w=null;l.getKnownTiledServiceLevelCap=function(a){w||x();a=a&&a.replace(/https?:/,"");return a in w?w[a]:1/0};l.prepareKnownTiledServiceLevelCaps=x;l.checkIfTileInfoSupportedForView=y;l.getTiledLayerInfo=
function(a,b,d){var n,f;if(a.isInstanceOf(c)){if(a=a.activeLayer){var g=a.tileMatrixSet;if(g)n=g.tileInfo,f=g.fullExtent;else if(a=a.tileMatrixSets)if(a=a.find(function(a){return null==y(a.tileInfo,a.fullExtent,b,d)}))return{tileInfo:a.tileInfo,fullExtent:a.fullExtent}}}else n=a.isInstanceOf(e)?a.compatibleTileInfo256:a.tileInfo,f=a.fullExtent;return n&&f&&null==y(n,f,b,d)?{tileInfo:n,fullExtent:f}:{tileInfo:null,fullExtent:null}}})},"esri/views/3d/terrain/terrainUtilsPlanar":function(){define("require exports ./TilingScheme ./TerrainConst ../../../core/Error ../support/aaBoundingRect ../lib/glMatrix".split(" "),
function(m,l,h,d,b,g,k){function f(a,b,d,f){e.set(d,c);c[f]=b[f];f=e.subtract(c,b);var n=e.subtract(a,b,q),n=e.dot(n,f),g=e.dot(f,f);b=0>=n?b:n>=g?d:e.add(b,e.scale(f,n/g),c);a=e.subtract(a,b,c);return Math.PI/2-Math.atan(a[2]/Math.sqrt(a[0]*a[0]+a[1]*a[1]))}function a(a,c){var b=a.getElevationBounds();a=a.extent;b=.5*(b[0]+b[1]);t[0]=a[0];t[1]=a[1];t[2]=b;r[0]=a[2];r[1]=a[3];r[2]=b;b=1/0;a=1/0;return c[0]<t[0]?b=f(c,t,r,0):c[0]>r[0]&&(b=f(c,r,t,0)),c[1]<t[1]?a=f(c,t,r,1):c[1]>r[1]&&(a=f(c,r,t,1)),
Math.min(b,a)}Object.defineProperty(l,"__esModule",{value:!0});var e=k.vec3d,c=e.create(),q=e.create(),t=e.create(),r=e.create();l.autoUpdateSkirtsVisibility=function(c,b){var e,d=!0,n=c.extent,f=g.containsPoint(n,b);f?e=c.getElevation(b):(e=c.getElevationBounds(),e=.5*(e[0]+e[1]));e>b[2]?d=!1:f||(g.containsPointWithMargin(n,b,c.hideSkirtsDistanceFromExtentMargin*Math.min(n[2]-n[0],n[3]-n[1]))?a(c,b)>c.hideSkirtsMinimumCameraTilt&&(d=!1):d=!1);d!==c.skirts&&(c.skirts=d)};l.tiltOnEdge=f;l.tiltToExtentEdge=
a;l.checkIfTileInfoSupportedForViewSR=function(a,c,e){if(a.spatialReference.isGeographic)return new b("tilingscheme:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes");var f=h.checkUnsupported(a);if(f)return f;var n;n=a.lods;var f=n[0].resolution*Math.pow(2,n[0].level),w=[f*a.size[0],f*a.size[1]],k=[a.origin.x,a.origin.y];c=g.fromExtent(c);var q=g.create();h.computeRowColExtent(c,w,k,q);w=(q[2]-q[0])*(q[3]-q[1]);w>d.MAX_ROOT_TILES?(n=n[0].scale*Math.pow(2,n[0].level),
f=Math.max((c[3]-c[1])/a.size[1],(c[2]-c[0])/a.size[0])*n/f,c=Math.floor(Math.log(f)/Math.log(10)),n=(f=Math.ceil(f/Math.pow(10,c))*Math.pow(10,c),new b("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(n).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+f.toLocaleString()+".",{level0Scale:n,suggestedLevel0Scale:f,requiredNumRootTiles:w,allowedNumRootTiles:d.MAX_ROOT_TILES}))):n=null;return n?n:e&&!a.spatialReference.equals(e)?new b("tilingscheme:spatial-reference-mismatch",
"The tiling scheme does not match the spatial reference of the local scene"):null}})},"esri/views/3d/terrain/TilingScheme":function(){define(["../../../core/Error","../../../geometry/SpatialReference","../../../geometry/support/scaleUtils","../support/projectionUtils","../support/mathUtils"],function(m,l,h,d,b){var g=d.webMercator.x2lon,k=d.webMercator.y2lat,f=[0,0,0,0],a=function(b){var c=a._checkUnsupported(b);if(c)throw c;this.spatialReference=b.spatialReference;this._isWebMercator=this.spatialReference.isWebMercator;
this._isWGS84=this.spatialReference.isWGS84;this.origin=[b.origin.x,b.origin.y];this.pixelSize=[b.size[0],b.size[1]];var e=b.lods.reduce(function(a,c,b){return c.level<a.min&&(a.min=c.level,a.minIndex=b),a.max=Math.max(a.max,c.level),a},{min:1/0,minIndex:0,max:-(1/0)}),d=b.lods[e.minIndex],f=Math.pow(2,d.level),c=d.resolution*f,d=d.scale*f;this.levels=Array(e.max+1);for(e=0;e<this.levels.length;e++)this.levels[e]={resolution:c,scale:d,tileSize:[c*b.size[0],c*b.size[1]]},c/=2,d/=2};return a.prototype=
{getExtent:function(a,c,d,f,h){f=f||Array(4);var e=this.levels[a];a=e.tileSize[0];e=e.tileSize[1];f[0]=this.origin[0]+d*a;f[2]=f[0]+a;f[3]=this.origin[1]-c*e;f[1]=f[3]-e;h&&(this._isWebMercator?(h[0]=g(f[0]),h[1]=k(f[1]),h[2]=g(f[2]),h[3]=k(f[3])):this._isWGS84&&(h[0]=b.deg2rad(f[0]),h[1]=b.deg2rad(f[1]),h[2]=b.deg2rad(f[2]),h[3]=b.deg2rad(f[3])))},ensureMaxLod:function(a){for(;this.levels.length<=a;){var c=this.levels[this.levels.length-1],b=c.resolution/2;this.levels.push({resolution:b,scale:c.scale/
2,tileSize:[b*this.pixelSize[0],b*this.pixelSize[1]]})}},capMaxLod:function(a){this.levels.length>a+1&&(this.levels.length=a+1)},getMaxLod:function(){return this.levels.length-1},scaleAtLevel:function(a){return this.levels[0].scale/Math.pow(2,a)},levelAtScale:function(a){var c=this.levels[0].scale;return a>=c?0:Math.log(c/a)*Math.LOG2E},compatibleWith:function(e){if(!(e instanceof a)){if(a._checkUnsupported(e))return!1;e=new a(e)}if(!e.spatialReference.equals(this.spatialReference)||e.pixelSize[0]!==
this.pixelSize[0]||e.pixelSize[1]!==this.pixelSize[1])return!1;var c=Math.min(this.levels.length,e.levels.length)-1,d=this.levels[c].resolution,f=b.floatEqualAbsolute,g=.5*d;return f(e.origin[0],this.origin[0],g)&&f(e.origin[1],this.origin[1],g)?(g=.5*d/Math.pow(2,c)/Math.max(this.pixelSize[0],this.pixelSize[1])*12,f(d,e.levels[c].resolution,g)):!1},rootTilesInExtent:function(b,c,d){var e=this.levels[0].tileSize;a.computeRowColExtent(b,e,this.origin,f);b=f[1];var g=f[3],k=f[0],q=f[2],h=q-k,y=g-b;
h*y>d&&(d=Math.floor(Math.sqrt(d)),y>d&&(b=b+Math.floor(.5*y)-Math.floor(.5*d),g=b+d),h>d&&(k=k+Math.floor(.5*h)-Math.floor(.5*d),q=k+d));d=Array((q-k)*(g-b));h=0;for(y=b;g>y;y++)for(var n=k;q>n;n++)d[h++]=[0,y,n];return c&&(c[0]=this.origin[0]+k*e[0],c[1]=this.origin[1]-g*e[1],c[2]=this.origin[0]+q*e[0],c[3]=this.origin[1]-b*e[1]),d}},a.computeRowColExtent=function(a,c,b,d){var e=.001*(a[2]-a[0]+(a[3]-a[1]));d[0]=Math.floor((a[0]+e-b[0])/c[0]);d[2]=Math.ceil((a[2]-e-b[0])/c[0]);d[1]=Math.floor((b[1]-
a[3]+e)/c[1]);d[3]=Math.ceil((b[1]-a[1]-e)/c[1])},a.isPowerOfTwo=function(a){a=a.lods;var c=a[0].resolution*Math.pow(2,a[0].level);return!a.some(function(a){return!b.floatEqualRelative(a.resolution,c/Math.pow(2,a.level))})},a.hasGapInLevels=function(a){a=a.lods.map(function(a){return a.level});a.sort(function(a,c){return a-c});for(var c=1;c<a.length;c++)if(a[c]!==a[0]+c)return!0;return!1},a.tileSizeSupported=function(a){var c=a.size[1];return c===a.size[0]&&0===(c&c-1)&&128<=c&&512>=c},a._checkUnsupported=
function(b){return b?1>b.lods.length?new m("tilingscheme:generic","Tiling scheme must have at least one level"):a.isPowerOfTwo(b)?null:new m("tilingscheme:power-of-two","Tiling scheme must be power of two"):new m("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")},a.checkUnsupported=function(b){var c=a._checkUnsupported(b);return c?c:a.hasGapInLevels(b)?new m("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):a.tileSizeSupported(b)?
null:new m("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]")},a.fromExtent=function(b,c){var e=b[2]-b[0],d=b[3]-b[1],f=h.getMetersPerUnitForSR(c),g=1.2*Math.max(e,d);b=new a({size:[256,256],origin:{x:b[0]-.5*(g-e),y:b[3]+.5*(g-d)},lods:[{level:0,resolution:g/256,scale:1/(256/96*.0254/(g*f))}],spatialReference:c});return b.ensureMaxLod(20),b},a.WebMercatorAuxiliarySphereTileInfo={size:[256,256],origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:l.WebMercator,
lods:[{level:0,resolution:156543.03392800014,scale:5.91657527591555E8}]},a.makeWebMercatorAuxiliarySphere=function(b){b=b||19;var c=new a(a.WebMercatorAuxiliarySphereTileInfo);return c.ensureMaxLod(b),c},a.WebMercatorAuxiliarySphere=a.makeWebMercatorAuxiliarySphere(19),a.makeWGS84WithTileSize=function(b,c){c=c||16;var e=256/b;b=new a({size:[b,b],origin:{x:-180,y:90},spatialReference:l.WGS84,lods:[{level:0,resolution:.703125*e,scale:2.95497598570834E8*e}]});return b.ensureMaxLod(c),b},a})},"esri/views/3d/support/projectionUtils":function(){define("../../../geometry/SpatialReference ../../../geometry/Point ./mathUtils ./earthUtils ../lib/glMatrix ../webgl-engine/lib/BufferVectorMath".split(" "),
function(m,l,h,d,b,g){var k,f,a,e,c=b.vec3d,q=b.mat4d,t=g.Vec3Compact,r=c.create(),u=c.create(),v=c.create(),x=h.deg2rad(1),y=h.rad2deg(1),n=new m({wkt:'      GEOCCS["Spherical geocentric",        DATUM["Not specified",          SPHEROID["Sphere",'+d.earthRadius+',0]],        PRIMEM["Greenwich",0.0,          AUTHORITY["EPSG","8901"]],        UNIT["m",1.0],        AXIS["Geocentric X",OTHER],        AXIS["Geocentric Y",EAST],        AXIS["Geocentric Z",NORTH]      ]    '}),w=new m({wkt:'      GEOCCS["WGS 84",        DATUM["WGS_1984",          SPHEROID["WGS 84",6378137,298.257223563,            AUTHORITY["EPSG","7030"]],          AUTHORITY["EPSG","6326"]],        PRIMEM["Greenwich",0,          AUTHORITY["EPSG","8901"]],        UNIT["m",1.0,          AUTHORITY["EPSG","9001"]],        AXIS["Geocentric X",OTHER],        AXIS["Geocentric Y",OTHER],        AXIS["Geocentric Z",NORTH],        AUTHORITY["EPSG","4978"]      ]    '}),
z=d.earthRadius,C=function(a){return a===n?1:a.isWGS84?2:a.isWebMercator?3:a===w?4:0};m=function(a,c,b,e){b[e++]=a[c++];b[e++]=a[c++];b[e]=a[c]};var B=function(a,c,b,e){var d=.4999999*Math.PI,f=x*a[c+1],f=h.clamp(f,-d,d),d=Math.sin(f);b[e++]=x*a[c]*z;b[e++]=z/2*Math.log((1+d)/(1-d));b[e]=a[c+2]},F=function(a,c,b,e){var d=z+a[c+2],f=x*a[c+1];a=x*a[c];c=Math.cos(f);b[e++]=Math.cos(a)*c*d;b[e++]=Math.sin(a)*c*d;b[e]=Math.sin(f)*d},G=[void 0,F,m,B,function(a,c,b,e){var d=x*a[c],f=x*a[c+1];a=a[c+2];c=
Math.sin(f);var f=Math.cos(f),n=6378137/Math.sqrt(1-.006694379990137799*c*c);b[e++]=(n+a)*f*Math.cos(d);b[e++]=(n+a)*f*Math.sin(d);b[e++]=(.9933056200098622*n+a)*c}],N=[void 0,function(a,c,b,e){var d=t.length(a,c),f=h.asin(a[c+2]/d);a=(0<a[c+1]?1:-1)*h.acos(a[c]/(Math.cos(f)*d));b[e++]=y*a;b[e++]=y*f;b[e]=d-z},m,function(a,c,b,e){b[e++]=y*(a[c++]/z);b[e++]=y*(Math.PI/2-2*Math.atan(Math.exp(-1*a[c++]/z)));b[e]=a[c]},function(a,c,b,e){var d,f,n,g,w,k,E,p,A,K,q;K=a[c];w=a[c+1];a=a[c+2];c=Math.abs(a);
d=K*K+w*w;f=Math.sqrt(d);n=d+a*a;g=Math.sqrt(n);K=Math.atan2(w,K);w=a*a/n;k=d/n;d=1.8230912546075456E9/g;n=142.91722289812412-4.557728136518864E9/g;.3<k?(E=c/g*(1+k*(42697.67270715754+d+w*n)/g),q=Math.asin(E),A=E*E,p=Math.sqrt(1-A)):(p=f/g*(1-w*(42840.589930055656-d-k*n)/g),q=Math.acos(p),A=1-p*p,E=Math.sqrt(A));A=1-.006694379990137799*A;d=6378137/Math.sqrt(A);g=.9933056200098622*d;d=f-d*p;n=c-g*E;c=p*d+E*n;E=p*n-E*d;p=E/(g/A+c);q+=p;0>a&&(q=-q);b[e++]=y*K;b[e++]=y*q;b[e]=c+E*p/2}];return{SphericalECEFSpatialReference:n,
WGS84ECEFSpatialReference:w,vectorToVector:function(a,b,e,d){return 2===a.length?(r[0]=a[0],r[1]=a[1],r[2]=0,a=r):a===e&&(c.set(a,r),a=r),this.bufferToBuffer(a,b,0,e,d,0,1)},pointToVector:function(a,c,b){r[0]=a.x;r[1]=a.y;var e=a.z;return r[2]=void 0!==e?e:0,this.bufferToBuffer(r,a.spatialReference,0,c,b,0,1)},vectorToPoint:function(a,c,b,e){var d;return"esri.SpatialReference"===b.declaredClass?(e=b,d=new l({spatialReference:e})):(d=b,e=e||d.spatialReference),this.bufferToBuffer(a,c,0,r,e,0,1)?(d.x=
r[0],d.y=r[1],d.z=r[2],d.spatialReference=e,d):null},xyzToVector:function(a,c,b,e,d,f){return r[0]=a,r[1]=c,r[2]=b,this.bufferToBuffer(r,e,0,d,f,0,1)},bufferToBuffer:function(c,b,d,n,g,w,q){q=q||1;k!==b&&(f=C(b),k=b);a!==g&&(e=C(g),a=g);q=d+3*q;if(f!==e||0===f&&!b.equals(g)){if(!(0<f&&0<e))return!1;if(2!==e){var h=G[e];if(2!==f)for(g=N[f];q>d;d+=3,w+=3)g(c,d,u,0,b.wkid),h(u,0,n,w);else for(;q>d;d+=3,w+=3)h(c,d,n,w)}else for(g=N[f];q>d;d+=3,w+=3)g(c,d,n,w,b.wkid)}else if(n!==c||d!==w)for(;q>d;d++,
w++)n[w]=c[d];return!0},computeLinearTransformation:function(a,c,b,e){var d=C(a),f=C(e);if(d===f&&(0!==d||a.equals(e)))return q.identity(b),q.translate(b,c),!0;if(1===f){if(e=N[d])return e(c,0,u,0,a.wkid),F(u,0,v,0),e=x*u[0],c=x*u[1],a=Math.sin(e),e=Math.cos(e),d=Math.sin(c),c=Math.cos(c),b[0]=-a,b[4]=-d*e,b[8]=c*e,b[12]=v[0],b[1]=e,b[5]=-d*a,b[9]=c*a,b[13]=v[1],b[2]=0,b[6]=c,b[10]=d,b[14]=v[2],b[3]=0,b[7]=0,b[11]=0,b[15]=1,!0}else if(3===f&&(2===d||1===d))return N[d](c,0,u,0,a.wkid),a=x*u[1],B(u,
0,v,0),q.identity(b),q.translate(b,v),a=1/Math.cos(a),q.scale(b,[a,a,1]),!0;return!1},mbsToMbs:function(a,c,b,e){var d=C(c),f=C(e);if(d===f&&(0!==d||c.equals(e)))return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],!0;if(1===f){if(e=N[d])return e(a,0,u,0,c.wkid),F(u,0,b,0),b[3]=a[3],!0}else if(3===f&&(2===d||1===d))return N[d](a,0,u,0,c.wkid),c=x*u[1],(c=Math.abs(c)+Math.asin(a[3]/(z+a[2])),B(u,0,b,0),c>.9999*Math.PI)?b[3]=Number.MAX_VALUE:b[3]=1/Math.cos(c)*a[3],!0;return!1},extentToBoundingBox:function(a,
c,b){if(null==a)return!1;var e=!0;return r[0]=null!=a.xmin?a.xmin:0,r[1]=null!=a.ymin?a.ymin:0,r[2]=null!=a.zmin?a.zmin:0,e=e&&this.bufferToBuffer(r,a.spatialReference,0,c,b,0,1),r[0]=null!=a.xmax?a.xmax:0,r[1]=null!=a.ymax?a.ymax:0,r[2]=null!=a.zmax?a.zmax:0,e=e&&this.bufferToBuffer(r,a.spatialReference,0,c,b,3,1),null==a.xmin&&(c[0]=-(1/0)),null==a.ymin&&(c[1]=-(1/0)),null==a.zmin&&(c[2]=-(1/0)),null==a.xmax&&(c[3]=1/0),null==a.ymax&&(c[4]=1/0),null==a.zmax&&(c[5]=1/0),e},extentToBoundingRect:function(a,
c,b){if(null==a)return!1;var e=!0;return r[0]=null!=a.xmin?a.xmin:0,r[1]=null!=a.ymin?a.ymin:0,r[2]=null!=a.zmin?a.zmin:0,e=e&&this.bufferToBuffer(r,a.spatialReference,0,r,b,0,1),c[0]=r[0],c[1]=r[1],r[0]=null!=a.xmax?a.xmax:0,r[1]=null!=a.ymax?a.ymax:0,r[2]=null!=a.zmax?a.zmax:0,e=e&&this.bufferToBuffer(r,a.spatialReference,0,r,b,0,1),c[2]=r[0],c[3]=r[1],null==a.xmin&&(c[0]=-(1/0)),null==a.ymin&&(c[1]=-(1/0)),null==a.xmax&&(c[2]=1/0),null==a.ymax&&(c[3]=1/0),e},webMercator:{x2lon:function(a){return a/
z},y2lat:function(a){return Math.PI/2-2*Math.atan(Math.exp(-1*a/z))},lon2x:function(a){return a*z},lat2y:function(a){a=Math.sin(a);return z/2*Math.log((1+a)/(1-a))}}}})},"esri/views/3d/support/mathUtils":function(){define(["require","exports","../lib/glMatrix"],function(m,l,h){function d(a){return Math.acos(1<a?1:-1>a?-1:a)}function b(a,b,e){return b>a?b:a>e?e:a}function g(a){for(var c in a){var b=a[c];b instanceof Function&&(a[c]=b.bind(a))}return a}Object.defineProperty(l,"__esModule",{value:!0});
l.deg2rad=function(a){return a*Math.PI/180};l.rad2deg=function(a){return 180*a/Math.PI};l.asin=function(a){return Math.asin(1<a?1:-1>a?-1:a)};l.acos=d;l.sign=Math.sign||function(a){return+(0<a)-+(0>a)||+a};l.log2=Math.log2||function(a){return Math.log(a)/Math.LN2};l.fovx2fovy=function(a,b,e){return 2*Math.atan(e*Math.tan(.5*a)/b)};l.fovy2fovx=function(a,b,e){return 2*Math.atan(b*Math.tan(.5*a)/e)};l.lerp=function(a,b,e){return a+(b-a)*e};l.bilerp=function(a,b,e,d,f,g){a+=(b-a)*f;return a+(e+(d-e)*
f-a)*g};l.slerp=function(a,b,e,d){void 0===d&&(d=a);var c=h.vec3d.length(a),g=h.vec3d.length(b),q=h.vec3d.dot(a,b)/c/g;.999999999999>q?(h.vec3d.cross(a,b,k),h.mat4d.identity(f),h.mat4d.rotate(f,e*Math.acos(q),k),h.mat4d.multiplyVec3(f,a,d),h.vec3d.scale(d,((1-e)*c+e*g)/c)):h.vec3d.lerp(a,b,e,d);return d};l.slerpOrLerp=function(a,b,e,d,g){var c=h.vec3d.length(a),q=h.vec3d.length(b);(h.vec3d.cross(a,b,k),h.vec3d.length(k)/c/q>g)?(b=Math.acos(h.vec3d.dot(a,b)/c/q),h.mat4d.identity(f),h.mat4d.rotate(f,
e*b,k),h.mat4d.multiplyVec3(f,a,d),h.vec3d.scale(d,((1-e)*c+e*q)/c)):h.vec3d.lerp(a,b,e,d);return d};l.angle=function(c,b,f){c=h.vec3d.normalize(c,a);b=h.vec3d.normalize(b,e);var g=d(h.vec3d.dot(c,b));return f&&(c=h.vec3d.cross(c,b,k),0>h.vec3d.dot(c,f))?-g:g};l.clamp=b;l.isFinite=Number.isFinite||function(a){return"number"==typeof a&&window.isFinite(a)};l.isNaN=Number.isNaN||function(a){return a!==a};l.makePiecewiseLinearFunction=function(a){var c=a.length;return function(b){var e=0;if(b<=a[0][0])return a[0][1];
if(b>=a[c-1][0])return a[c-1][1];for(;b>a[e][0];)e++;var d=a[e][0];b=(d-b)/(d-a[e-1][0]);return b*a[e-1][1]+(1-b)*a[e][1]}};l.vectorEquals=function(a,b){if(null==a||null==b)return a!==b;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0};l.floatEqualRelative=function(a,b,e){if(void 0===e&&(e=1E-6),l.isNaN(a)||l.isNaN(b))return!1;if(a===b)return!0;var c=Math.abs(a-b),d=Math.abs(a),f=Math.abs(b);if(0===a||0===b||1E-12>d&&1E-12>f){if(c>.01*e)return!1}else if(c/
(d+f)>e)return!1;return!0};l.floatEqualAbsolute=function(a,b,e){return(void 0===e&&(e=1E-6),l.isNaN(a)||l.isNaN(b))?!1:e>=(a>b?a-b:b-a)};m=function(){function a(a,c){this.min=a;this.max=c;this.range=c-a}return a.prototype.ndiff=function(a,c){return void 0===c&&(c=0),Math.ceil((a-c)/this.range)*this.range+c},a.prototype._normalize=function(a,c,b,e){return void 0===e&&(e=0),b-=e,a>b?b+=this.ndiff(a-b):b>c&&(b-=this.ndiff(b-c)),b+e},a.prototype.normalize=function(a,c){return this._normalize(this.min,
this.max,a,c)},a.prototype.clamp=function(a,c){return void 0===c&&(c=0),b(a-c,this.min,this.max)+c},a.prototype.monotonic=function(a,c,b){return c>a?c:c+this.ndiff(a-c,b)},a.prototype.minimalMonotonic=function(a,c,b){return this._normalize(a,a+this.range,c,b)},a.prototype.center=function(a,c,b){return c=this.monotonic(a,c,b),this.normalize((a+c)/2,b)},a.prototype.diff=function(a,c,b){return this.monotonic(a,c,b)-a},a.prototype.contains=function(a,c,b){return c=this.minimalMonotonic(a,c),b=this.minimalMonotonic(a,
b),b>a&&c>b},a}();l.Cyclical=m;l.cyclical2PI=g(new m(0,2*Math.PI));l.cyclicalPI=g(new m(-Math.PI,Math.PI));l.cyclicalDeg=g(new m(0,360));var k=h.vec3d.create(),f=h.mat4d.create(),a=h.vec3d.create(),e=h.vec3d.create()})},"esri/views/3d/lib/glMatrix":function(){define([],function(){var m={};return function(l,h){h(l,!0);h(l,!1)}(m,function(l,h){var d={};!function(){if("undefined"!=typeof Float32Array){var a=new Float32Array(1),c=new Int32Array(a.buffer);d.invsqrt=function(b){a[0]=b;c[0]=1597463007-(c[0]>>
1);var e=a[0];return e*(1.5-.5*b*e*e)}}else d.invsqrt=function(a){return 1/Math.sqrt(a)}}();var b=Array;"undefined"!=typeof Float32Array&&(b=h?Float32Array:Array);var g={create:function(a){var c=new b(3);return a?(c[0]=a[0],c[1]=a[1],c[2]=a[2]):c[0]=c[1]=c[2]=0,c},createFrom:function(a,c,e){var d=new b(3);return d[0]=a,d[1]=c,d[2]=e,d},set:function(a,c){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c},set3:function(a,c,b,e){return e[0]=a,e[1]=c,e[2]=b,e},add:function(a,c,b){return b&&a!==b?(b[0]=a[0]+c[0],
b[1]=a[1]+c[1],b[2]=a[2]+c[2],b):(a[0]+=c[0],a[1]+=c[1],a[2]+=c[2],a)},subtract:function(a,c,b){return b&&a!==b?(b[0]=a[0]-c[0],b[1]=a[1]-c[1],b[2]=a[2]-c[2],b):(a[0]-=c[0],a[1]-=c[1],a[2]-=c[2],a)},multiply:function(a,c,b){return b&&a!==b?(b[0]=a[0]*c[0],b[1]=a[1]*c[1],b[2]=a[2]*c[2],b):(a[0]*=c[0],a[1]*=c[1],a[2]*=c[2],a)},max:function(a,c,b){return b[0]=Math.max(a[0],c[0]),b[1]=Math.max(a[1],c[1]),b[2]=Math.max(a[2],c[2]),b},min:function(a,c,b){return b[0]=Math.min(a[0],c[0]),b[1]=Math.min(a[1],
c[1]),b[2]=Math.min(a[2],c[2]),b},negate:function(a,c){return c||(c=a),c[0]=-a[0],c[1]=-a[1],c[2]=-a[2],c},scale:function(a,c,b){return b&&a!==b?(b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c,b):(a[0]*=c,a[1]*=c,a[2]*=c,a)},normalize:function(a,c){c||(c=a);var b=a[0],e=a[1];a=a[2];var d=Math.sqrt(b*b+e*e+a*a);return d?1===d?(c[0]=b,c[1]=e,c[2]=a,c):(d=1/d,c[0]=b*d,c[1]=e*d,c[2]=a*d,c):(c[0]=0,c[1]=0,c[2]=0,c)},cross:function(a,c,b){b||(b=a);var e=a[0],d=a[1];a=a[2];var f=c[0],n=c[1];c=c[2];return b[0]=d*c-
a*n,b[1]=a*f-e*c,b[2]=e*n-d*f,b},length:function(a){var c=a[0],b=a[1];a=a[2];return Math.sqrt(c*c+b*b+a*a)},length2:function(a){var c=a[0],b=a[1];a=a[2];return c*c+b*b+a*a},dot:function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]},direction:function(a,c,b){b||(b=a);var e=a[0]-c[0],d=a[1]-c[1];a=a[2]-c[2];return(c=Math.sqrt(e*e+d*d+a*a))?(c=1/c,b[0]=e*c,b[1]=d*c,b[2]=a*c,b):(b[0]=0,b[1]=0,b[2]=0,b)},lerp:function(a,c,b,e){return e||(e=a),e[0]=a[0]+b*(c[0]-a[0]),e[1]=a[1]+b*(c[1]-a[1]),e[2]=a[2]+b*(c[2]-
a[2]),e},dist:function(a,c){var b=c[0]-a[0],e=c[1]-a[1];a=c[2]-a[2];return Math.sqrt(b*b+e*e+a*a)},dist2:function(a,c){var b=c[0]-a[0],e=c[1]-a[1];a=c[2]-a[2];return b*b+e*e+a*a}},k=null,f=new b(4);g.unproject=function(a,c,b,e,d){d||(d=a);k||(k=u.create());var n=k;return f[0]=2*(a[0]-e[0])/e[2]-1,f[1]=2*(a[1]-e[1])/e[3]-1,f[2]=2*a[2]-1,f[3]=1,u.multiply(b,c,n),u.inverse(n)?(u.multiplyVec4(n,f),0===f[3]?null:(d[0]=f[0]/f[3],d[1]=f[1]/f[3],d[2]=f[2]/f[3],d)):null};var a=g.createFrom(1,0,0),e=g.createFrom(0,
1,0),c=g.createFrom(0,0,1);g.rotationTo=function(b,d,f){f||(f=v.create());var n=g.dot(b,d),w=g.create();if(1<=n)v.set(x,f);else if(-.999999>n)g.cross(a,b,w),1E-6>w.length&&g.cross(e,b,w),1E-6>w.length&&g.cross(c,b,w),g.normalize(w),v.fromAxisAngle(w,Math.PI,f);else{var n=Math.sqrt(2*(1+n)),k=1/n;g.cross(b,d,w);f[0]=w[0]*k;f[1]=w[1]*k;f[2]=w[2]*k;f[3]=.5*n;v.normalize(f)}return 1<f[3]?f[3]=1:-1>f[3]&&(f[3]=-1),f};var q=g.create(),t=g.create();g.project=function(a,c,b,e){e||(e=a);g.direction(c,b,q);
g.subtract(a,c,t);a=g.dot(q,t);g.scale(q,a,e);g.add(e,c,e)};g.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var r={create:function(a){var c=new b(9);return a?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8]):c[0]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=0,c},createFrom:function(a,c,e,d,f,g,k,q,h){var n=new b(9);return n[0]=a,n[1]=c,n[2]=e,n[3]=d,n[4]=f,n[5]=g,n[6]=k,n[7]=q,n[8]=h,n},determinant:function(a){var c=a[3],b=a[4],e=a[5],d=a[6],f=a[7],n=
a[8];return a[0]*(n*b-e*f)+a[1]*(-n*c+e*d)+a[2]*(f*c-b*d)},inverse:function(a,c){var b,e=a[0],d=a[1],f=a[2],n=a[3],g=a[4],w=a[5],k=a[6],q=a[7];a=a[8];var h=a*g-w*q,t=-a*n+w*k,u=q*n-g*k,y=e*h+d*t+f*u;return y?(b=1/y,c||(c=r.create()),c[0]=h*b,c[1]=(-a*d+f*q)*b,c[2]=(w*d-f*g)*b,c[3]=t*b,c[4]=(a*e-f*k)*b,c[5]=(-w*e+f*n)*b,c[6]=u*b,c[7]=(-q*e+d*k)*b,c[8]=(g*e-d*n)*b,c):null},multiply:function(a,c,b){b||(b=a);var e=a[0],d=a[1],f=a[2],n=a[3],g=a[4],w=a[5],k=a[6],q=a[7];a=a[8];var h=c[0],r=c[1],t=c[2],u=
c[3],H=c[4],y=c[5],v=c[6],E=c[7];c=c[8];return b[0]=h*e+r*n+t*k,b[1]=h*d+r*g+t*q,b[2]=h*f+r*w+t*a,b[3]=u*e+H*n+y*k,b[4]=u*d+H*g+y*q,b[5]=u*f+H*w+y*a,b[6]=v*e+E*n+c*k,b[7]=v*d+E*g+c*q,b[8]=v*f+E*w+c*a,b},add:function(a,c,b){return b||(b=a),b[0]=a[0]+c[0],b[1]=a[1]+c[1],b[2]=a[2]+c[2],b[3]=a[3]+c[3],b[4]=a[4]+c[4],b[5]=a[5]+c[5],b[6]=a[6]+c[6],b[7]=a[7]+c[7],b[8]=a[8]+c[8],b},subtract:function(a,c,b){return b||(b=a),b[0]=a[0]-c[0],b[1]=a[1]-c[1],b[2]=a[2]-c[2],b[3]=a[3]-c[3],b[4]=a[4]-c[4],b[5]=a[5]-
c[5],b[6]=a[6]-c[6],b[7]=a[7]-c[7],b[8]=a[8]-c[8],b},multiplyVec2:function(a,c,b){b||(b=c);var e=c[0];c=c[1];return b[0]=e*a[0]+c*a[3]+a[6],b[1]=e*a[1]+c*a[4]+a[7],b},multiplyVec3:function(a,c,b){b||(b=c);var e=c[0],d=c[1];c=c[2];return b[0]=e*a[0]+d*a[3]+c*a[6],b[1]=e*a[1]+d*a[4]+c*a[7],b[2]=e*a[2]+d*a[5]+c*a[8],b},set:function(a,c){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8],c},identity:function(a){return a||(a=r.create()),a[0]=1,a[1]=0,a[2]=
0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},transpose:function(a,c){if(!c||a===c){c=a[1];var b=a[2],e=a[5];return a[1]=a[3],a[2]=a[6],a[3]=c,a[5]=a[7],a[6]=b,a[7]=e,a}return c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8],c},toMat4:function(a,c){return c||(c=u.create()),c[15]=1,c[14]=0,c[13]=0,c[12]=0,c[11]=0,c[10]=a[8],c[9]=a[7],c[8]=a[6],c[7]=0,c[6]=a[5],c[5]=a[4],c[4]=a[3],c[3]=0,c[2]=a[2],c[1]=a[1],c[0]=a[0],c},str:function(a){return"["+a[0]+", "+a[1]+
", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},u={create:function(a){var c=new b(16);return 4===arguments.length?(c[0]=arguments[0],c[1]=arguments[1],c[2]=arguments[2],c[3]=arguments[3],c[4]=arguments[4],c[5]=arguments[5],c[6]=arguments[6],c[7]=arguments[7],c[8]=arguments[8],c[9]=arguments[9],c[10]=arguments[10],c[11]=arguments[11],c[12]=arguments[12],c[13]=arguments[13],c[14]=arguments[14],c[15]=arguments[15]):a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=
a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c},createFrom:function(a,c,e,d,f,g,k,q,h,r,t,u,y,v,l,H){var n=new b(16);return n[0]=a,n[1]=c,n[2]=e,n[3]=d,n[4]=f,n[5]=g,n[6]=k,n[7]=q,n[8]=h,n[9]=r,n[10]=t,n[11]=u,n[12]=y,n[13]=v,n[14]=l,n[15]=H,n},createFromMatrixRowMajor:function(a){var c=new b(16);return c[0]=a[0],c[4]=a[1],c[8]=a[2],c[12]=a[3],c[1]=a[4],c[5]=a[5],c[9]=a[6],c[13]=a[7],c[2]=a[8],c[6]=a[9],c[10]=a[10],c[14]=a[11],
c[3]=a[12],c[7]=a[13],c[11]=a[14],c[15]=a[15],c},createFromMatrix:function(a){var c=new b(16);return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c},set:function(a,c){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c},setRowMajor:function(a,c){return c[0]=
a[0],c[4]=a[1],c[8]=a[2],c[12]=a[3],c[1]=a[4],c[5]=a[5],c[9]=a[6],c[13]=a[7],c[2]=a[8],c[6]=a[9],c[10]=a[10],c[14]=a[11],c[3]=a[12],c[7]=a[13],c[11]=a[14],c[15]=a[15],c},identity:function(a){return a||(a=u.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},transpose:function(a,c){if(!c||a===c){c=a[1];var b=a[2],e=a[3],d=a[6],f=a[7],n=a[11];return a[1]=a[4],a[2]=a[8],a[3]=a[12],a[4]=c,a[6]=a[9],a[7]=a[13],a[8]=b,a[9]=d,
a[11]=a[14],a[12]=e,a[13]=f,a[14]=n,a}return c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15],c},determinant:function(a){var c=a[0],b=a[1],e=a[2],d=a[3],f=a[4],n=a[5],g=a[6],k=a[7],q=a[8],h=a[9],r=a[10],t=a[11],u=a[12],y=a[13],H=a[14];a=a[15];return u*h*g*d-q*y*g*d-u*n*r*d+f*y*r*d+q*n*H*d-f*h*H*d-u*h*e*k+q*y*e*k+u*b*r*k-c*y*r*k-q*b*H*k+c*h*H*k+u*n*e*t-f*y*e*t-u*b*g*t+c*y*g*t+
f*b*H*t-c*n*H*t-q*n*e*a+f*h*e*a+q*b*g*a-c*h*g*a-f*b*r*a+c*n*r*a},inverse:function(a,c){c||(c=a);var b,e=a[0],d=a[1],f=a[2],n=a[3],g=a[4],w=a[5],k=a[6],q=a[7],h=a[8],r=a[9],t=a[10],u=a[11],H=a[12],y=a[13],v=a[14];a=a[15];var E=e*w-d*g,p=e*k-f*g,A=e*q-n*g,K=d*k-f*w,U=d*q-n*w,V=f*q-n*k,l=h*y-r*H,x=h*v-t*H,m=h*a-u*H,ha=r*v-t*y,ca=r*a-u*y,ea=t*a-u*v,ja=E*ea-p*ca+A*ha+K*m-U*x+V*l;return ja?(b=1/ja,c[0]=(w*ea-k*ca+q*ha)*b,c[1]=(-d*ea+f*ca-n*ha)*b,c[2]=(y*V-v*U+a*K)*b,c[3]=(-r*V+t*U-u*K)*b,c[4]=(-g*ea+k*
m-q*x)*b,c[5]=(e*ea-f*m+n*x)*b,c[6]=(-H*V+v*A-a*p)*b,c[7]=(h*V-t*A+u*p)*b,c[8]=(g*ca-w*m+q*l)*b,c[9]=(-e*ca+d*m-n*l)*b,c[10]=(H*U-y*A+a*E)*b,c[11]=(-h*U+r*A-u*E)*b,c[12]=(-g*ha+w*x-k*l)*b,c[13]=(e*ha-d*x+f*l)*b,c[14]=(-H*K+y*p-v*E)*b,c[15]=(h*K-r*p+t*E)*b,c):null},toRotationMat:function(a,c){return c||(c=u.create()),c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},toMat3:function(a,c){return c||
(c=r.create()),c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[4],c[4]=a[5],c[5]=a[6],c[6]=a[8],c[7]=a[9],c[8]=a[10],c},toInverseMat3:function(a,c){var b,e=a[0],d=a[1],f=a[2],n=a[4],g=a[5],w=a[6],k=a[8],q=a[9];a=a[10];var h=a*g-w*q,t=-a*n+w*k,u=q*n-g*k,y=e*h+d*t+f*u;return y?(b=1/y,c||(c=r.create()),c[0]=h*b,c[1]=(-a*d+f*q)*b,c[2]=(w*d-f*g)*b,c[3]=t*b,c[4]=(a*e-f*k)*b,c[5]=(-w*e+f*n)*b,c[6]=u*b,c[7]=(-q*e+d*k)*b,c[8]=(g*e-d*n)*b,c):null},multiply:function(a,c,b){b||(b=a);var e=a[0],d=a[1],f=a[2],n=a[3],g=a[4],
k=a[5],w=a[6],q=a[7],h=a[8],r=a[9],t=a[10],u=a[11],H=a[12],y=a[13],v=a[14];a=a[15];var E=c[0],p=c[1],A=c[2],K=c[3],U=c[4],V=c[5],l=c[6],z=c[7],x=c[8],m=c[9],ca=c[10],ea=c[11],ja=c[12],na=c[13],za=c[14];c=c[15];return b[0]=E*e+p*g+A*h+K*H,b[1]=E*d+p*k+A*r+K*y,b[2]=E*f+p*w+A*t+K*v,b[3]=E*n+p*q+A*u+K*a,b[4]=U*e+V*g+l*h+z*H,b[5]=U*d+V*k+l*r+z*y,b[6]=U*f+V*w+l*t+z*v,b[7]=U*n+V*q+l*u+z*a,b[8]=x*e+m*g+ca*h+ea*H,b[9]=x*d+m*k+ca*r+ea*y,b[10]=x*f+m*w+ca*t+ea*v,b[11]=x*n+m*q+ca*u+ea*a,b[12]=ja*e+na*g+za*h+c*
H,b[13]=ja*d+na*k+za*r+c*y,b[14]=ja*f+na*w+za*t+c*v,b[15]=ja*n+na*q+za*u+c*a,b},multiplyVec3:function(a,c,b){b||(b=c);var e=c[0],d=c[1];c=c[2];return b[0]=a[0]*e+a[4]*d+a[8]*c+a[12],b[1]=a[1]*e+a[5]*d+a[9]*c+a[13],b[2]=a[2]*e+a[6]*d+a[10]*c+a[14],b},multiplyVec4:function(a,c,b){b||(b=c);var e=c[0],d=c[1],f=c[2];c=c[3];return b[0]=a[0]*e+a[4]*d+a[8]*f+a[12]*c,b[1]=a[1]*e+a[5]*d+a[9]*f+a[13]*c,b[2]=a[2]*e+a[6]*d+a[10]*f+a[14]*c,b[3]=a[3]*e+a[7]*d+a[11]*f+a[15]*c,b},translate:function(a,c,b){var e,d,
f,n,g,k,w,q,h,r,t,u,H=c[0],y=c[1];c=c[2];return b&&a!==b?(e=a[0],d=a[1],f=a[2],n=a[3],g=a[4],k=a[5],w=a[6],q=a[7],h=a[8],r=a[9],t=a[10],u=a[11],b[0]=e,b[1]=d,b[2]=f,b[3]=n,b[4]=g,b[5]=k,b[6]=w,b[7]=q,b[8]=h,b[9]=r,b[10]=t,b[11]=u,b[12]=e*H+g*y+h*c+a[12],b[13]=d*H+k*y+r*c+a[13],b[14]=f*H+w*y+t*c+a[14],b[15]=n*H+q*y+u*c+a[15],b):(a[12]=a[0]*H+a[4]*y+a[8]*c+a[12],a[13]=a[1]*H+a[5]*y+a[9]*c+a[13],a[14]=a[2]*H+a[6]*y+a[10]*c+a[14],a[15]=a[3]*H+a[7]*y+a[11]*c+a[15],a)},scale:function(a,c,b){var e=c[0],
d=c[1];c=c[2];return b&&a!==b?(b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e,b[3]=a[3]*e,b[4]=a[4]*d,b[5]=a[5]*d,b[6]=a[6]*d,b[7]=a[7]*d,b[8]=a[8]*c,b[9]=a[9]*c,b[10]=a[10]*c,b[11]=a[11]*c,b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b):(a[0]*=e,a[1]*=e,a[2]*=e,a[3]*=e,a[4]*=d,a[5]*=d,a[6]*=d,a[7]*=d,a[8]*=c,a[9]*=c,a[10]*=c,a[11]*=c,a)},maxScale:function(a){return Math.max(Math.max(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8]),Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])),Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))},
rotate:function(a,c,b,e){var d,f,n,g,k,w,q,h,r,t,u,H,y,v,E,p,A,K,U,V,l,z,x,C,m=b[0],ea=b[1];b=b[2];var ja=Math.sqrt(m*m+ea*ea+b*b);return ja?(1!==ja&&(ja=1/ja,m*=ja,ea*=ja,b*=ja),d=Math.sin(c),f=Math.cos(c),n=1-f,g=a[0],k=a[1],w=a[2],q=a[3],h=a[4],r=a[5],t=a[6],u=a[7],H=a[8],y=a[9],v=a[10],E=a[11],p=m*m*n+f,A=ea*m*n+b*d,K=b*m*n-ea*d,U=m*ea*n-b*d,V=ea*ea*n+f,l=b*ea*n+m*d,z=m*b*n+ea*d,x=ea*b*n-m*d,C=b*b*n+f,e?a!==e&&(e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]):e=a,e[0]=g*p+h*A+H*K,e[1]=k*p+r*A+
y*K,e[2]=w*p+t*A+v*K,e[3]=q*p+u*A+E*K,e[4]=g*U+h*V+H*l,e[5]=k*U+r*V+y*l,e[6]=w*U+t*V+v*l,e[7]=q*U+u*V+E*l,e[8]=g*z+h*x+H*C,e[9]=k*z+r*x+y*C,e[10]=w*z+t*x+v*C,e[11]=q*z+u*x+E*C,e):null},rotateX:function(a,c,b){var e=Math.sin(c);c=Math.cos(c);var d=a[4],f=a[5],n=a[6],g=a[7],k=a[8],w=a[9],q=a[10],h=a[11];return b?a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]):b=a,b[4]=d*c+k*e,b[5]=f*c+w*e,b[6]=n*c+q*e,b[7]=g*c+h*e,b[8]=d*-e+k*c,b[9]=f*-e+w*c,b[10]=n*
-e+q*c,b[11]=g*-e+h*c,b},rotateY:function(a,c,b){var e=Math.sin(c);c=Math.cos(c);var d=a[0],f=a[1],n=a[2],g=a[3],k=a[8],w=a[9],q=a[10],h=a[11];return b?a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]):b=a,b[0]=d*c+k*-e,b[1]=f*c+w*-e,b[2]=n*c+q*-e,b[3]=g*c+h*-e,b[8]=d*e+k*c,b[9]=f*e+w*c,b[10]=n*e+q*c,b[11]=g*e+h*c,b},rotateZ:function(a,c,b){var e=Math.sin(c);c=Math.cos(c);var d=a[0],f=a[1],n=a[2],g=a[3],k=a[4],w=a[5],q=a[6],h=a[7];return b?a!==b&&(b[8]=
a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]):b=a,b[0]=d*c+k*e,b[1]=f*c+w*e,b[2]=n*c+q*e,b[3]=g*c+h*e,b[4]=d*-e+k*c,b[5]=f*-e+w*c,b[6]=n*-e+q*c,b[7]=g*-e+h*c,b},frustum:function(a,c,b,e,d,f,g){g||(g=u.create());var n=c-a,k=e-b,w=f-d;return g[0]=2*d/n,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2*d/k,g[6]=0,g[7]=0,g[8]=(c+a)/n,g[9]=(e+b)/k,g[10]=-(f+d)/w,g[11]=-1,g[12]=0,g[13]=0,g[14]=-(f*d*2)/w,g[15]=0,g},perspective:function(a,c,b,e,d){a=b*Math.tan(a*Math.PI/360);c*=
a;return u.frustum(-c,c,-a,a,b,e,d)},ortho:function(a,c,b,e,d,f,g){g||(g=u.create());var n=c-a,k=e-b,w=f-d;return g[0]=2/n,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2/k,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=-2/w,g[11]=0,g[12]=-(a+c)/n,g[13]=-(e+b)/k,g[14]=-(f+d)/w,g[15]=1,g},lookAt:function(a,c,b,e){e||(e=u.create());var d,f,n,g,k,w,q,h,r,t,y=a[0],H=a[1];a=a[2];var v=b[0],l=b[1];b=b[2];var E=c[0],p=c[1];c=c[2];return y===E&&H===p&&a===c?u.identity(e):(q=y-E,h=H-p,r=a-c,t=1/Math.sqrt(q*q+h*h+r*r),q*=t,h*=t,r*=
t,d=l*r-b*h,f=b*q-v*r,n=v*h-l*q,t=Math.sqrt(d*d+f*f+n*n),t?(t=1/t,d*=t,f*=t,n*=t):(d=0,f=0,n=0),g=h*n-r*f,k=r*d-q*n,w=q*f-h*d,t=Math.sqrt(g*g+k*k+w*w),t?(t=1/t,g*=t,k*=t,w*=t):(g=0,k=0,w=0),e[0]=d,e[1]=g,e[2]=q,e[3]=0,e[4]=f,e[5]=k,e[6]=h,e[7]=0,e[8]=n,e[9]=w,e[10]=r,e[11]=0,e[12]=-(d*y+f*H+n*a),e[13]=-(g*y+k*H+w*a),e[14]=-(q*y+h*H+r*a),e[15]=1,e)},fromRotationTranslation:function(a,c,b){b||(b=u.create());var e=a[0],d=a[1],f=a[2],n=a[3],g=e+e,k=d+d,w=f+f;a=e*g;var q=e*k,e=e*w,h=d*k,d=d*w,f=f*w,g=
n*g,k=n*k,n=n*w;return b[0]=1-(h+f),b[1]=q+n,b[2]=e-k,b[3]=0,b[4]=q-n,b[5]=1-(a+f),b[6]=d+g,b[7]=0,b[8]=e+k,b[9]=d-g,b[10]=1-(a+h),b[11]=0,b[12]=c[0],b[13]=c[1],b[14]=c[2],b[15]=1,b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},v={create:function(a){var c=new b(4);return a?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3]):c[0]=c[1]=c[2]=c[3]=0,c},createFrom:function(a,
c,e,d){var f=new b(4);return f[0]=a,f[1]=c,f[2]=e,f[3]=d,f},set:function(a,c){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c},identity:function(a){return a||(a=v.create()),a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}},x=v.identity();v.calculateW=function(a,c){var b=a[0],e=a[1],d=a[2];return c&&a!==c?(c[0]=b,c[1]=e,c[2]=d,c[3]=-Math.sqrt(Math.abs(1-b*b-e*e-d*d)),c):(a[3]=-Math.sqrt(Math.abs(1-b*b-e*e-d*d)),a)};v.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]+a[3]*c[3]};v.inverse=function(a,c){var b=a[0],
e=a[1],d=a[2],f=a[3],b=(b=b*b+e*e+d*d+f*f)?1/b:0;return c&&a!==c?(c[0]=-a[0]*b,c[1]=-a[1]*b,c[2]=-a[2]*b,c[3]=a[3]*b,c):(a[0]*=-b,a[1]*=-b,a[2]*=-b,a[3]*=b,a)};v.conjugate=function(a,c){return c&&a!==c?(c[0]=-a[0],c[1]=-a[1],c[2]=-a[2],c[3]=a[3],c):(a[0]*=-1,a[1]*=-1,a[2]*=-1,a)};v.length=function(a){var c=a[0],b=a[1],e=a[2];a=a[3];return Math.sqrt(c*c+b*b+e*e+a*a)};v.normalize=function(a,c){c||(c=a);var b=a[0],e=a[1],d=a[2];a=a[3];var f=Math.sqrt(b*b+e*e+d*d+a*a);return 0===f?(c[0]=0,c[1]=0,c[2]=
0,c[3]=0,c):(f=1/f,c[0]=b*f,c[1]=e*f,c[2]=d*f,c[3]=a*f,c)};v.add=function(a,c,b){return b&&a!==b?(b[0]=a[0]+c[0],b[1]=a[1]+c[1],b[2]=a[2]+c[2],b[3]=a[3]+c[3],b):(a[0]+=c[0],a[1]+=c[1],a[2]+=c[2],a[3]+=c[3],a)};v.multiply=function(a,c,b){b||(b=a);var e=a[0],d=a[1],f=a[2];a=a[3];var n=c[0],g=c[1],k=c[2];c=c[3];return b[0]=e*c+a*n+d*k-f*g,b[1]=d*c+a*g+f*n-e*k,b[2]=f*c+a*k+e*g-d*n,b[3]=a*c-e*n-d*g-f*k,b};v.multiplyVec3=function(a,c,b){b||(b=c);var e=c[0],d=c[1],f=c[2];c=a[0];var n=a[1],g=a[2];a=a[3];
var k=a*e+n*f-g*d,w=a*d+g*e-c*f,q=a*f+c*d-n*e,e=-c*e-n*d-g*f;return b[0]=k*a+e*-c+w*-g-q*-n,b[1]=w*a+e*-n+q*-c-k*-g,b[2]=q*a+e*-g+k*-n-w*-c,b};v.scale=function(a,c,b){return b&&a!==b?(b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c,b[3]=a[3]*c,b):(a[0]*=c,a[1]*=c,a[2]*=c,a[3]*=c,a)};v.toMat3=function(a,c){c||(c=r.create());var b=a[0],e=a[1],d=a[2],f=a[3],n=b+b,g=e+e,k=d+d;a=b*n;var w=b*g,b=b*k,q=e*g,e=e*k,d=d*k,n=f*n,g=f*g,f=f*k;return c[0]=1-(q+d),c[1]=w+f,c[2]=b-g,c[3]=w-f,c[4]=1-(a+d),c[5]=e+n,c[6]=b+g,c[7]=
e-n,c[8]=1-(a+q),c};v.toMat4=function(a,c){c||(c=u.create());var b=a[0],e=a[1],d=a[2],f=a[3],n=b+b,g=e+e,k=d+d;a=b*n;var q=b*g,b=b*k,w=e*g,e=e*k,d=d*k,n=f*n,g=f*g,f=f*k;return c[0]=1-(w+d),c[1]=q+f,c[2]=b-g,c[3]=0,c[4]=q-f,c[5]=1-(a+d),c[6]=e+n,c[7]=0,c[8]=b+g,c[9]=e-n,c[10]=1-(a+w),c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c};v.slerp=function(a,c,b,e){e||(e=a);var d,f,n,g,k=a[0]*c[0]+a[1]*c[1]+a[2]*c[2]+a[3]*c[3];return 1<=Math.abs(k)?(e!==a&&(e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3]),e):(d=Math.acos(k),
f=Math.sqrt(1-k*k),.001>Math.abs(f)?(e[0]=.5*a[0]+.5*c[0],e[1]=.5*a[1]+.5*c[1],e[2]=.5*a[2]+.5*c[2],e[3]=.5*a[3]+.5*c[3],e):(n=Math.sin((1-b)*d)/f,g=Math.sin(b*d)/f,e[0]=a[0]*n+c[0]*g,e[1]=a[1]*n+c[1]*g,e[2]=a[2]*n+c[2]*g,e[3]=a[3]*n+c[3]*g,e))};v.fromRotationMatrix=function(a,c){c||(c=v.create());var b,e=a[0]+a[4]+a[8];if(0<e)b=Math.sqrt(e+1),c[3]=.5*b,b=.5/b,c[0]=(a[7]-a[5])*b,c[1]=(a[2]-a[6])*b,c[2]=(a[3]-a[1])*b;else{b=v.fromRotationMatrix.s_iNext=v.fromRotationMatrix.s_iNext||[1,2,0];e=0;a[4]>
a[0]&&(e=1);a[8]>a[3*e+e]&&(e=2);var d=b[e],f=b[d];b=Math.sqrt(a[3*e+e]-a[3*d+d]-a[3*f+f]+1);c[e]=.5*b;b=.5/b;c[3]=(a[3*f+d]-a[3*d+f])*b;c[d]=(a[3*d+e]+a[3*e+d])*b;c[f]=(a[3*f+e]+a[3*e+f])*b}return c};r.toQuat4=v.fromRotationMatrix;(function(){var a=r.create();v.fromAxes=function(c,b,e,d){return a[0]=b[0],a[3]=b[1],a[6]=b[2],a[1]=e[0],a[4]=e[1],a[7]=e[2],a[2]=c[0],a[5]=c[1],a[8]=c[2],v.fromRotationMatrix(a,d)}})();v.identity=function(a){return a||(a=v.create()),a[0]=0,a[1]=0,a[2]=0,a[3]=1,a};v.fromAngleAxis=
function(a,c,b){b||(b=v.create());a*=.5;var e=Math.sin(a);return b[3]=Math.cos(a),b[0]=e*c[0],b[1]=e*c[1],b[2]=e*c[2],b};v.toAngleAxis=function(a,c){c||(c=a);var b=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<b?(c[3]=2*Math.acos(a[3]),b=d.invsqrt(b),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b):(c[3]=0,c[0]=1,c[1]=0,c[2]=0);return c};v.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var y={create:function(a){var c=new b(4);return a?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3]):c[0]=c[1]=c[2]=c[3]=0,c},createFrom:function(a,
c,e,d){var f=new b(4);return f[0]=a,f[1]=c,f[2]=e,f[3]=d,f},set:function(a,c){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c},identity:function(a){return a||(a=y.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},transpose:function(a,c){return c&&a!==c?(c[0]=a[0],c[1]=a[2],c[2]=a[1],c[3]=a[3],c):(c=a[1],a[1]=a[2],a[2]=c,a)},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},inverse:function(a,c){c||(c=a);var b=a[0],e=a[1],d=a[2];a=a[3];var f=b*a-d*e;return f?(f=1/f,c[0]=a*f,c[1]=-e*f,c[2]=-d*f,c[3]=b*f,
c):null},multiply:function(a,c,b){b||(b=a);var e=a[0],d=a[1],f=a[2];a=a[3];return b[0]=e*c[0]+d*c[2],b[1]=e*c[1]+d*c[3],b[2]=f*c[0]+a*c[2],b[3]=f*c[1]+a*c[3],b},rotate:function(a,c,b){b||(b=a);var e=a[0],d=a[1],f=a[2];a=a[3];var g=Math.sin(c);c=Math.cos(c);return b[0]=e*c+d*g,b[1]=e*-g+d*c,b[2]=f*c+a*g,b[3]=f*-g+a*c,b},multiplyVec2:function(a,c,b){b||(b=c);var e=c[0];c=c[1];return b[0]=e*a[0]+c*a[1],b[1]=e*a[2]+c*a[3],b},scale:function(a,c,b){b||(b=a);var e=a[1],d=a[2],f=a[3],g=c[0];c=c[1];return b[0]=
a[0]*g,b[1]=e*c,b[2]=d*g,b[3]=f*c,b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};h=h?"":"d";l["glMath"+h]=d;l["vec2"+h]={create:function(a){var c=new b(2);return a?(c[0]=a[0],c[1]=a[1]):(c[0]=0,c[1]=0),c},createFrom:function(a,c){var e=new b(2);return e[0]=a,e[1]=c,e},add:function(a,c,b){return b||(b=c),b[0]=a[0]+c[0],b[1]=a[1]+c[1],b},subtract:function(a,c,b){return b||(b=c),b[0]=a[0]-c[0],b[1]=a[1]-c[1],b},multiply:function(a,c,b){return b||(b=c),b[0]=a[0]*c[0],b[1]=a[1]*
c[1],b},divide:function(a,c,b){return b||(b=c),b[0]=a[0]/c[0],b[1]=a[1]/c[1],b},scale:function(a,c,b){return b||(b=a),b[0]=a[0]*c,b[1]=a[1]*c,b},dist:function(a,c){var b=c[0]-a[0];a=c[1]-a[1];return Math.sqrt(b*b+a*a)},dist2:function(a,c){var b=c[0]-a[0];a=c[1]-a[1];return b*b+a*a},set:function(a,c){return c[0]=a[0],c[1]=a[1],c},set2:function(a,c,b){return b[0]=a,b[1]=c,b},negate:function(a,c){return c||(c=a),c[0]=-a[0],c[1]=-a[1],c},normalize:function(a,c){c||(c=a);var b=a[0]*a[0]+a[1]*a[1];return 0<
b?(b=Math.sqrt(b),c[0]=a[0]/b,c[1]=a[1]/b):c[0]=c[1]=0,c},cross:function(a,c,b){a=a[0]*c[1]-a[1]*c[0];return b?(b[0]=b[1]=0,b[2]=a,b):a},length:function(a){var c=a[0];a=a[1];return Math.sqrt(c*c+a*a)},dot:function(a,c){return a[0]*c[0]+a[1]*c[1]},direction:function(a,c,b){b||(b=a);var e=a[0]-c[0];a=a[1]-c[1];return(c=e*e+a*a)?(c=1/Math.sqrt(c),b[0]=e*c,b[1]=a*c,b):(b[0]=0,b[1]=0,b[2]=0,b)},lerp:function(a,c,b,e){return e||(e=a),e[0]=a[0]+b*(c[0]-a[0]),e[1]=a[1]+b*(c[1]-a[1]),e},str:function(a){return"["+
a[0]+", "+a[1]+"]"}};l["vec3"+h]=g;l["vec4"+h]={create:function(a){var c=new b(4);return a?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3]):(c[0]=0,c[1]=0,c[2]=0,c[3]=0),c},createFrom:function(a,c,e,d){var f=new b(4);return f[0]=a,f[1]=c,f[2]=e,f[3]=d,f},add:function(a,c,b){return b||(b=c),b[0]=a[0]+c[0],b[1]=a[1]+c[1],b[2]=a[2]+c[2],b[3]=a[3]+c[3],b},subtract:function(a,c,b){return b||(b=c),b[0]=a[0]-c[0],b[1]=a[1]-c[1],b[2]=a[2]-c[2],b[3]=a[3]-c[3],b},multiply:function(a,c,b){return b||(b=c),b[0]=a[0]*
c[0],b[1]=a[1]*c[1],b[2]=a[2]*c[2],b[3]=a[3]*c[3],b},divide:function(a,c,b){return b||(b=c),b[0]=a[0]/c[0],b[1]=a[1]/c[1],b[2]=a[2]/c[2],b[3]=a[3]/c[3],b},scale:function(a,c,b){return b||(b=a),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c,b[3]=a[3]*c,b},dot:function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]+a[3]*c[3]},set:function(a,c){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c},set4:function(a,c,b,e,d){return d[0]=a,d[1]=c,d[2]=b,d[3]=e,d},negate:function(a,c){return c||(c=a),c[0]=-a[0],c[1]=-a[1],c[2]=
-a[2],c[3]=-a[3],c},lerp:function(a,c,b,e){return e||(e=a),e[0]=a[0]+b*(c[0]-a[0]),e[1]=a[1]+b*(c[1]-a[1]),e[2]=a[2]+b*(c[2]-a[2]),e[3]=a[3]+b*(c[3]-a[3]),e},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};l["mat2"+h]=y;l["mat3"+h]=r;l["mat4"+h]=u;l["quat4"+h]=v}),m})},"esri/views/3d/support/earthUtils":function(){define("require exports ./mathUtils ../../../geometry/Point ../../../geometry/SpatialReference ../../../geometry/support/webMercatorUtils".split(" "),function(m,l,h,d,
b,g){function k(a,c,b,e){var f,g;a instanceof d&&c instanceof d&&(b=c.longitude,e=c.latitude,g=a.latitude,f=a.longitude);a=h.deg2rad(g);e=h.deg2rad(e);f=h.deg2rad(f);c=h.deg2rad(b);b=Math.sin((a-e)/2);f=Math.sin((f-c)/2);b=2*h.asin(Math.sqrt(b*b+Math.cos(a)*Math.cos(e)*f*f))*l.earthRadius;return Math.round(1E4*b)/1E4}function f(a,c,b){a=b/l.earthRadius;c=h.deg2rad(c);a=Math.sin(a/2);c=Math.cos(c);c=2*h.asin(Math.sqrt(a*a/(c*c)));return h.rad2deg(c)}function a(a,c,b){return h.rad2deg(b/l.earthRadius)}
function e(a,c){a/=15;return c||(a=Math.round(a)),a}Object.defineProperty(l,"__esModule",{value:!0});l.wgs84Radius=6378137;l.wgs84InverseFlattening=298.257223563;l.wgs84Flattening=1/l.wgs84InverseFlattening;l.wgs84PolarRadius=l.wgs84Radius*(1-l.wgs84Flattening);l.wgs84Eccentricity=.0818191908426215;l.earthRadius=l.wgs84Radius;l.halfEarthCircumference=Math.PI*l.earthRadius;l.earthCircumference=2*l.halfEarthCircumference;l.metersPerDegree=l.halfEarthCircumference/180;var c=new d(0,0,b.WGS84);l.getGreatCircleDistance=
k;l.getGreatCircleSpanAt=function(a,c,b){var e=c.spatialReference,f=new d(c.x,a.y,e),g=new d(b.x,a.y,e);c=new d(a.x,c.y,e);a=new d(a.x,b.y,e);return{lon:k(f,g),lat:k(c,a)}};l.getLonDeltaForDistance=f;l.getLatDeltaForDistance=a;l.getLatLonDeltaForDistance=function(c,b,e){return{lat:a(c,b,e),lon:f(c,b,e)}};l.getMaxCameraAltitude=function(a){a=h.deg2rad(a/2);return(1-Math.sin(a))*l.earthRadius/Math.sin(a)};l.getViewExtentDistance=function(a,c){c=h.deg2rad(c/2);return 2*h.acos((Math.pow(a+l.earthRadius,
2)+Math.pow(l.earthRadius,2)-Math.pow((a+l.earthRadius)*Math.cos(c)-Math.sqrt(Math.pow(Math.cos(c)*(a+l.earthRadius),2)-a*a-2*a*l.earthRadius),2))/(2*(a+l.earthRadius)*l.earthRadius))*l.earthRadius};l.computeCarthesianDistance=function(a,c){function b(a){var c=h.deg2rad(a.latitude),b=h.deg2rad(a.longitude),e=Math.cos(c);a=l.earthRadius+(a.z||0);return[Math.cos(b)*e*a,Math.sin(c)*a,-Math.sin(b)*e*a]}a=b(a);c=b(c);c=[c[0]-a[0],c[1]-a[1],c[2]-a[2]];return Math.sqrt(c[0]*c[0]+c[1]*c[1]+c[2]*c[2])};l.longitudeToTimezone=
e;l.positionToTimezone=function(a,d){a.spatialReference.wkid!==b.WGS84.wkid?g.webMercatorToGeographic(a,!1,c):(c.x=a.x,c.y=a.y);c.z=a.z;d||(d={hours:0,minutes:0,seconds:0});d.hours=e(c.x,!0);a=d.hours%1;d.hours-=a;d.minutes=60*a;a=d.minutes%1;return d.minutes-=a,d.seconds=Math.round(60*a),d}})},"esri/views/3d/webgl-engine/lib/BufferVectorMath":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});!function(h){h.length=function(d,b){var g=d[b],k=d[b+
1];d=d[b+2];return Math.sqrt(g*g+k*k+d*d)};h.normalize=function(d,b){var g=d[b],k=d[b+1],f=d[b+2],g=1/Math.sqrt(g*g+k*k+f*f);d[b]*=g;d[b+1]*=g;d[b+2]*=g};h.scale=function(d,b,g){d[b]*=g;d[b+1]*=g;d[b+2]*=g};h.add=function(d,b,g,k,f,a){void 0===a&&(a=b);f=f||d;f[a]=d[b]+g[k];f[a+1]=d[b+1]+g[k+1];f[a+2]=d[b+2]+g[k+2]};h.subtract=function(d,b,g,k,f,a){void 0===a&&(a=b);f=f||d;f[a]=d[b]-g[k];f[a+1]=d[b+1]-g[k+1];f[a+2]=d[b+2]-g[k+2]}}(l.Vec3Compact||(l.Vec3Compact={}))})},"esri/views/3d/terrain/TerrainConst":function(){define(["require",
"exports","./TilingScheme","../support/aaBoundingRect"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});!function(b){b[b.MAP=0]="MAP";b[b.ELEVATION=1]="ELEVATION";b[b.LAYER_CLASS_COUNT=2]="LAYER_CLASS_COUNT"}(l.LayerClass||(l.LayerClass={}));!function(b){b[b.NONE=0]="NONE";b[b.SPLIT=1]="SPLIT";b[b.VSPLITMERGE=2]="VSPLITMERGE";b[b.MERGE=4]="MERGE";b[b.DECODE_ELEVATION=8]="DECODE_ELEVATION";b[b.UPDATE_GEOMETRY=16]="UPDATE_GEOMETRY";b[b.UPDATE_TEXTURE=32]="UPDATE_TEXTURE"}(l.TileUpdateTypes||
(l.TileUpdateTypes={}));l.TILE_LOADING_DEBUGLOG=!1;l.MAX_ROOT_TILES=64;l.MAX_TILE_TESSELATION=512;l.ELEVATION_NODATA_VALUE=3.40282347E37;l.noDataValueOpt={noDataValue:l.ELEVATION_NODATA_VALUE};l.ELEVATION_DESIRED_RESOLUTION_LEVEL=4;l.TILEMAP_SIZE_EXP=5;l.TILEMAP_SIZE=1<<l.TILEMAP_SIZE_EXP;l.WEBMERCATOR_WORLD_EXTENT=d.create([0,0,0,0]);h.WebMercatorAuxiliarySphere.getExtent(0,0,0,l.WEBMERCATOR_WORLD_EXTENT);l.GEOGRAPHIC_WORLD_EXTENT=d.create([-180,-90,180,90]);l.TOO_MANY_ROOT_TILES_AFTER_CHANGE_ERROR=
"Cannot extend surface to encompass all layers because it would result in too many root tiles.";l.TOO_MANY_ROOT_TILES_FOR_LAYER_ERROR="Surface extent is too large for tile resolution at level 0.";l.DEFAULT_TILE_BACKGROUND="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAIAAADTED8xAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAA2JJREFUeNrs3d1O20AQgFFvRJInQLQBhHj/h0JVW34El1yQ2F73DVq3jTys55zrqUBbPrErZUSZ+vcOsto4AjK76Lqu1vr8+G3mPzjc3D/+eJj/Bcz/cd75R80fbu79BsAVCAQAAgABgABAACAAEAAIAAQAAgABQPOKfQAy83Ho+HnnHzXv49B4A4AAQAAgABAACAAEAAIAAYAAQAAgABAANM4+AKnZB4ifd/5R8/YB8AYAAYAAQAAgABAACAAEAAIAAYAAQAAgAGicfQBSsw8QP+/8o+btA+ANAAIAAYAAQAAgABAACAAEAAIAAYAAQADQOPsApGYfIH7e+UfN2wfAGwAEAAIAAYAAQAAgABAACAAEAAIAAXA201QdggAggH0AUrMPED8/jsPL03fns/y8fQC8AUAAIAAQAAgABAACAAGAAEAAIAAQAAgAGmcfgNTsA8TP2weImrcPgDcACAAEAAIAAYAAQAAgABAACAAEAAIAAUDj7AOQmn2A+Hn7AFHz9gHwBgABgABAACAAEAAIAAQAAgABgABgNS4cAf9pu9u3O1+m/n2aplKK/0j+TX86/tVP5+eZ3+729gFIfwWyDxA7bx8gat4+ANkJAAGAAEAAIAAQAAgABAACAAGAAEAAIABonn0AUrMPED9vHyBq3j4A3gAgABAACAAEAAIAAYAAQAAgABAA51VrdQgCAAHAsuwDkJp9gPj5vj+9vvx0PsvP2wfAGwAEAAIAAYAAQAAgABAACAAEAAIAAYAAoHH2AUjNPkD8vH2AqHn7AHgDgABAACAAEAAIAAQAAgABgABAACAAEAA0zj4AqdkHiJ+3DxA1bx8AbwAQACQ0DL0AyKuOowBwBYKUSikCIHUBAsAVCAQAAgABgABAALBy9gFIzT5A/Lx9gKj5y6trVyC8AUAAIAAQAAgAVq90Pg5N5gA2AsAVCAQAAgABgABAALB29gFIzT5A/Lx9gKj5q6+3rkB4A4AAQAAgABAACADWzB/IIHsCAsAVCARAlKlWhyAAEAAIABZjH4DU7APEz5+OH2+vT85n+fkvhztXILwBQAAgABAACAAEAGtWigBIHcBGALgCgQBAACAAyPMO9nHosxuHodZx5vB2t691HIdh/nx/Os7/Zsz/fvgXAAAA//8DAF1P1hM2ICMfAAAAAElFTkSuQmCC"})},
"esri/views/3d/support/aaBoundingRect":function(){define(["require","exports","./mathUtils"],function(m,l,h){function d(b){return b[0]>=b[2]?0:b[2]-b[0]}function b(b){return b[1]>=b[3]?0:b[3]-b[1]}function g(b){return 4===b.length}Object.defineProperty(l,"__esModule",{value:!0});l.create=function(b){return void 0===b&&(b=l.ZERO),[b[0],b[1],b[2],b[3]]};l.fromExtent=function(b){return[b.xmin,b.ymin,b.xmax,b.ymax]};l.expand=function(b,d,a){void 0===a&&(a=b);var e=d.declaredClass;return"esri.geometry.Extent"===
e?(a[0]=Math.min(b[0],d.xmin),a[1]=Math.min(b[1],d.ymin),a[2]=Math.max(b[2],d.xmax),a[3]=Math.max(b[3],d.ymax)):"esri.geometry.Point"===e?(a[0]=Math.min(b[0],d.x),a[1]=Math.min(b[1],d.y),a[2]=Math.max(b[2],d.x),a[3]=Math.max(b[3],d.y)):g(d)?(a[0]=Math.min(b[0],d[0]),a[1]=Math.min(b[1],d[1]),a[2]=Math.max(b[2],d[2]),a[3]=Math.max(b[3],d[3])):Array.isArray(d)&&(2===d.length||3===d.length)&&(a[0]=Math.min(b[0],d[0]),a[1]=Math.min(b[1],d[1]),a[2]=Math.max(b[2],d[0]),a[3]=Math.max(b[3],d[1])),a};l.allFinite=
function(b){for(var d=0;4>d;d++)if(!isFinite(b[d]))return!1;return!0};l.width=d;l.height=b;l.center=function(g,f){return void 0===f&&(f=[0,0]),f[0]=g[0]+d(g)/2,f[1]=g[1]+b(g)/2,f};l.containsPoint=function(b,d){return d[0]>=b[0]&&d[1]>=b[1]&&d[0]<=b[2]&&d[1]<=b[3]};l.containsPointWithMargin=function(b,d,a){return d[0]>=b[0]-a&&d[1]>=b[1]-a&&d[0]<=b[2]+a&&d[1]<=b[3]+a};l.intersects=function(b,d){return Math.max(d[0],b[0])<=Math.min(d[2],b[2])&&Math.max(d[1],b[1])<=Math.min(d[3],b[3])};l.contains=function(b,
d){return d[0]>=b[0]&&d[2]<=b[2]&&d[1]>=b[1]&&d[3]<=b[3]};l.intersection=function(b,d,a){void 0===a&&(a=b);var e=d[0],c=d[1],f=d[2];d=d[3];return a[0]=h.clamp(b[0],e,f),a[1]=h.clamp(b[1],c,d),a[2]=h.clamp(b[2],e,f),a[3]=h.clamp(b[3],c,d),a};l.offset=function(b,d,a,e){return void 0===e&&(e=b),e[0]=b[0]+d,e[1]=b[1]+a,e[2]=b[2]+d,e[3]=b[3]+a,e};l.setMin=function(b,d,a){return void 0===a&&(a=b),a[0]=d[0],a[1]=d[1],a!==b&&(a[2]=b[2],a[3]=b[3]),a};l.setMax=function(b,d,a){return void 0===a&&(a=b),a[2]=
d[0],a[3]=d[1],a!==b&&(a[0]=b[0],a[1]=b[1]),b};l.set=function(b,d){return b[0]=d[0],b[1]=d[1],b[2]=d[2],b[3]=d[3],b};l.is=g;l.isPoint=function(g){return!(0!==d(g)&&isFinite(g[0])||0!==b(g)&&isFinite(g[1]))};l.equals=function(b,d,a){if(null==b||null==d)return b===d;if(!g(b)||!g(d))return!1;if(a)for(var e=0;e<b.length;e++){if(!a(b[e],d[e]))return!1}else for(e=0;e<b.length;e++)if(b[e]!==d[e])return!1;return!0};l.POSITIVE_INFINITY=[-(1/0),-(1/0),1/0,1/0];l.NEGATIVE_INFINITY=[1/0,1/0,-(1/0),-(1/0)];l.ZERO=
[0,0,0,0]})},"esri/views/3d/terrain/terrainUtilsSpherical":function(){define(["require","exports","./TilingScheme","../../../core/Error"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.autoUpdateSkirtsVisibility=function(b,d){};l.checkIfTileInfoSupportedForViewSR=function(b,g,k){g=b.lods.length-1;if(b.spatialReference.isWebMercator){if(!h.makeWebMercatorAuxiliarySphere(g).compatibleWith(b))return new d("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!b.spatialReference.isWGS84)return new d("tilingscheme:global-unsupported-spatial-reference",
"The tiling scheme spatial reference is not supported in global scenes");if(!h.makeWGS84WithTileSize(b.size[1],g).compatibleWith(b))return new d("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme")}return k&&!b.spatialReference.equals(k)?new d("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene"):void 0}})},"esri/layers/TiledLayer":function(){define(["../request",
"./Layer","./support/TileInfo"],function(m,l,h){return l.createSubclass({properties:{attributionDataUrl:null,tileInfo:h},viewModulePaths:{"2d":"../views/2d/layers/TiledLayerView2D","3d":"../views/3d/layers/TileLayerView3D"},getTileUrl:function(d,b,g){},fetchTile:function(d,b,g,k){d=this.getTileUrl(d,b,g);b={responseType:"image",allowImageDataAccess:k&&k.allowImageDataAccess||!1};return k&&k.timestamp&&(b.query={_ts:k.timestamp}),"string"==typeof d?m(d,b).then(function(b){return b.data}):d.then(function(b){return m(b,
{responseType:"image"})}).then(function(b){return b.data})}})})},"esri/layers/support/TileInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/_base/lang ../../core/JSONSupport ../../core/kebabDictionary ../../core/accessorSupport/decorators ../../geometry/SpatialReference ../../geometry/Point ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/scaleUtils ./LOD".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){var u=k({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc"});return function(g){function k(a){a=g.call(this)||this;return a.dpi=96,a.format=null,a.origin=null,a.minScale=0,a.maxScale=0,a.size=null,a.spatialReference=null,a}return h(k,g),y=k,k.create=function(b){void 0===b&&(b={size:256,spatialReference:a.WebMercator});
var d=b.scales,f=b.size||256;b=b.spatialReference||a.WebMercator;var g=c.getInfo(b),g=g?new e(g.origin[0],g.origin[1],b):new e(0,0,b),n=1/(39.37*t.getMetersPerUnitForSR(b)*96),k=[];if(d)for(var q=0;q<d.length;q++){var h=d[q],r=h*n;k.push({level:q,scale:h,resolution:r})}else for(d=256/f*5.91657527591555E8,k.push({level:0,scale:d,resolution:d*n}),q=1;24>q;q++)h=d/2,r=h*n,k.push({level:q,scale:h,resolution:r}),d=h;return new y({dpi:96,lods:k,origin:g,size:f,spatialReference:b})},Object.defineProperty(k.prototype,
"isWrappable",{get:function(){var a=this.spatialReference,b=this.origin;if(a&&b){var e=c.getInfo(a);return a.isWrappable&&Math.abs(e.origin[0]-b.x)<=e.dx}return!1},enumerable:!0,configurable:!0}),k.prototype.readOrigin=function(a,c){return e.fromJSON(b.mixin({spatialReference:c.spatialReference},a))},Object.defineProperty(k.prototype,"lods",{set:function(a){var c=this,b=0,e=0,d=[];this._levelToLOD={};a&&(b=-(1/0),e=1/0,a.forEach(function(a){d.push(a.scale);b=a.scale>b?a.scale:b;e=a.scale<e?a.scale:
e;c._levelToLOD[a.level]=a}));this._set("scales",d);this._set("minScale",b);this._set("maxScale",e);this._set("lods",a);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0}),k.prototype.readSize=function(a,c){return[c.cols,c.rows]},k.prototype.writeSize=function(a,c){c.cols=a[0];c.rows=a[0]},k.prototype.zoomToScale=function(a){var c=this.scales;if(0>=a)return c[0];if(a>=c.length)return c[c.length-1];var b=Math.round(a);return c[b]+(b-a)*(c[Math.round(a-.5)]-c[b])},k.prototype.scaleToZoom=
function(a){for(var c=this.scales,b=c.length-1,e=0;b>e;e++){var d=c[e],f=c[e+1];if(a>=d)break;if(f===a)return e+1;if(d>a&&a>f)return e+1-(a-f)/(d-f)}return e},k.prototype.snapScale=function(a,c){void 0===c&&(c=.95);a=this.scaleToZoom(a);return a%Math.floor(a)>=c?this.zoomToScale(Math.ceil(a)):this.zoomToScale(Math.floor(a))},k.prototype.tileAt=function(a,c,b,e){var d=this.lodAt(a);if(!d)return null;e||(e={id:null,level:0,row:0,col:0,extent:[0,0,0,0]});var f;if("number"==typeof c)f=c,c=b;else{if(c.spatialReference.equals(this.spatialReference))f=
c.x,c=c.y;else{e=q.project(c,this.spatialReference);if(!e)return null;f=e.x;c=e.y}e=b}b=d.resolution*this.size[0];d=d.resolution*this.size[1];return e.level=a,e.row=Math.floor((this.origin.y-c)/d+.001),e.col=Math.floor((f-this.origin.x)/b+.001),this.updateTileInfo(e),e},k.prototype.updateTileInfo=function(a){var c=this.lodAt(a.level),b=c.resolution*this.size[0],c=c.resolution*this.size[1];a.id=a.level+"/"+a.row+"/"+a.col;a.extent||(a.extent=[0,0,0,0]);a.extent[0]=this.origin.x+a.col*b;a.extent[1]=
this.origin.y-(a.row+1)*c;a.extent[2]=a.extent[0]+b;a.extent[3]=a.extent[1]+c},k.prototype.upsampleTile=function(a){var c=this._upsampleLevels[a.level];return c&&-1!==c.parentLevel?(a.level=c.parentLevel,a.row=Math.floor(a.row/c.factor+.001),a.col=Math.floor(a.col/c.factor+.001),this.updateTileInfo(a),!0):!1},k.prototype.lodAt=function(a){return this._levelToLOD&&this._levelToLOD[a]||null},k.prototype.clone=function(){return y.fromJSON(this.write({}))},k.prototype._initializeUpsampleLevels=function(){var a=
this.lods;this._upsampleLevels=[];for(var c=null,b=0;b<a.length;b++){var e=a[b];this._upsampleLevels[e.level]={parentLevel:c?c.level:-1,factor:c?c.resolution/e.resolution:0};c=e}},d([f.property({type:Number,json:{write:!0}})],k.prototype,"compressionQuality",void 0),d([f.property({type:Number,json:{write:!0}})],k.prototype,"dpi",void 0),d([f.property({type:String,json:{read:u.read,write:u.write}})],k.prototype,"format",void 0),d([f.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],
k.prototype,"isWrappable",null),d([f.property({type:e,json:{write:!0}})],k.prototype,"origin",void 0),d([f.reader("origin")],k.prototype,"readOrigin",null),d([f.property({type:[r],value:null,json:{write:!0}})],k.prototype,"lods",null),d([f.property({readOnly:!0})],k.prototype,"minScale",void 0),d([f.property({readOnly:!0})],k.prototype,"maxScale",void 0),d([f.property({readOnly:!0})],k.prototype,"scales",void 0),d([f.property({cast:function(a){return Array.isArray(a)?a:"number"==typeof a?[a,a]:[256,
256]}})],k.prototype,"size",void 0),d([f.reader("size",["rows","cols"])],k.prototype,"readSize",null),d([f.writer("size",{cols:{type:Number},rows:{type:Number}})],k.prototype,"writeSize",null),d([f.property({type:a,json:{write:!0}})],k.prototype,"spatialReference",void 0),k=y=d([f.subclass("esri.layers.support.TileInfo")],k);var y}(f.declared(g))})},"esri/layers/support/LOD":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport".split(" "),
function(m,l,h,d,b,g){return function(g){function f(a){a=g.call(this,a)||this;return a.level=0,a.levelValue=null,a.resolution=0,a.scale=0,a}return h(f,g),a=f,f.prototype.clone=function(){return new a({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})},d([b.property({type:Number,json:{write:!0}})],f.prototype,"level",void 0),d([b.property({type:String,json:{write:!0}})],f.prototype,"levelValue",void 0),d([b.property({type:Number,json:{write:!0}})],f.prototype,
"resolution",void 0),d([b.property({type:Number,json:{write:!0}})],f.prototype,"scale",void 0),f=a=d([b.subclass("esri.layers.support.LOD")],f);var a}(b.declared(g))})},"esri/layers/TileLayer":function(){define("dojo/_base/lang dojo/io-query ../request ../core/urlUtils ../core/promiseUtils ../geometry/SpatialReference ./TiledLayer ./mixins/ArcGISMapService ./mixins/ArcGISCachedService ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./support/arcgisLayers ./support/arcgisLayerUrl".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){return k.createSubclass([f,a,t,e,c,q],{declaredClass:"esri.layers.TileLayer",_mapsWithAttribution:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),
_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",JPEG:"jpg",GIF:"gif"},_attributionServices:["services.arcgisonline.com/arcgis/rest/services","servicesdev.arcgisonline.com/arcgis/rest/services","servicesqa.arcgisonline.com/arcgis/rest/services"],normalizeCtorArgs:function(a,c){return"string"==typeof a?m.mixin({},{url:a},c):a},load:function(){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service","Map Service"]}).always(this._fetchService.bind(this))),
this.when()},properties:{operationalLayerType:{get:function(){if(this.capabilities)return-1!==this.capabilities.indexOf("Map")?"ArcGISTiledMapServiceLayer":"ArcGISTiledImageServiceLayer";var a=this.url||this.portalItem&&this.portalItem.url;return a&&/\/ImageServer(\/|\/?$)/i.test(a)?"ArcGISTiledImageServiceLayer":"ArcGISTiledMapServiceLayer"}},attributionDataUrl:{dependsOn:["parsedUrl"],get:function(){return this._getDefaultAttribution(this._getMapName(this.parsedUrl.path.toLowerCase()))}},popupTemplates:null,
tileServers:{dependsOn:["parsedUrl"],value:null,cast:function(a){return Array.isArray(a)?a.map(function(a){return d.urlToObject(a).path}):null},get:function(){return this._getDefaultTileServers(this.parsedUrl.path)}},url:{json:{origins:{"web-scene":{write:{isRequired:!0,writer:d.writeOperationalLayerUrl}}}}},type:{value:"tile",json:{read:!1}},spatialReference:{json:{read:{source:["spatialReference","tileInfo"],reader:function(a,c){return a=a||c.tileInfo&&c.tileInfo.spatialReference,a&&g.fromJSON(a)}}}}},
getTileUrl:function(a,c,b){var e=this.tileServers,d=this.parsedUrl.query?l.objectToQuery(this.parsedUrl.query):"";this.token&&(d=d+(d?"\x26":"")+"token\x3d"+encodeURIComponent(this.token));this.resampling&&!this.tilemapCache&&this.supportsBlankTile&&(d=d+(d?"\x26":"")+"blankTile\x3dfalse");this.refreshTimestamp&&(d=d+(d?"\x26":"")+"_ts\x3d"+this.refreshTimestamp);a=(e&&e.length?e[c%e.length]:this.parsedUrl.path)+"/tile/"+a+"/"+c+"/"+b;return a+=d?"?"+d:""},_fetchService:function(){return b.resolve().then(function(){return this.resourceInfo||
h(this.parsedUrl.path,{query:m.mixin({f:"json"},this.parsedUrl.query),responseType:"json",callbackParamName:"callback"})}.bind(this)).then(function(a){return a.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.read(a.data,{origin:"service",url:this.parsedUrl}),10.1!==this.version||u.isHostedAgolService(this.url)?void 0:r.fetchServerVersion(this.url).then(function(a){this.read({currentVersion:a})}.bind(this)).otherwise(function(){})}.bind(this))},_getMapName:function(a){return(a=a.match(/^(?:https?:)?\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i))&&
a[2]},_getDefaultAttribution:function(a){if(a){var c;a=a.toLowerCase();for(var b=0,e=this._mapsWithAttribution.length;e>b;b++)if(c=this._mapsWithAttribution[b],-1<c.toLowerCase().indexOf(a))return d.makeAbsolute("//static.arcgis.com/attribution/"+c)}},_getDefaultTileServers:function(a){var c=-1!==a.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i),b=-1!==a.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i);return c||b?[a,a.replace(c?/server\.arcgisonline/i:/services\.arcgisonline/i,c?"services.arcgisonline":
"server.arcgisonline")]:[]}})})},"esri/layers/mixins/ArcGISMapService":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./ArcGISService ../../geometry/Extent ../../geometry/SpatialReference".split(" "),function(m,l,h,d,b,g,k,f){return function(a){function e(){var c=null!==a&&a.apply(this,arguments)||this;return c.copyright=null,c.fullExtent=null,c.legendEnabled=!0,c.spatialReference=null,c.version=
null,c}return h(e,a),e.prototype.readCapabilities=function(a,b){return a&&a.split(",").map(function(a){return a.trim()})},e.prototype.readCopyright=function(a,b){return b.copyrightText},e.prototype.readPopupEnabled=function(a,b){return!b.disablePopup},e.prototype.readVersion=function(a,b){a=b.currentVersion;return a||(a=b.hasOwnProperty("capabilities")||b.hasOwnProperty("tables")?10:b.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3),a},d([b.property()],e.prototype,"capabilities",void 0),d([b.reader("service",
"capabilities")],e.prototype,"readCapabilities",null),d([b.property()],e.prototype,"copyright",void 0),d([b.reader("copyright",["copyrightText"])],e.prototype,"readCopyright",null),d([b.property({type:k})],e.prototype,"fullExtent",void 0),d([b.property({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],e.prototype,"id",void 0),d([b.property({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],e.prototype,"legendEnabled",void 0),
d([b.reader("popupEnabled",["disablePopup"])],e.prototype,"readPopupEnabled",null),d([b.property({type:f})],e.prototype,"spatialReference",void 0),d([b.property()],e.prototype,"version",void 0),d([b.reader("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],e.prototype,"readVersion",null),e=d([b.subclass("esri.layers.mixins.ArcGISMapService")],e)}(b.declared(g))})},"esri/layers/mixins/ArcGISService":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/MultiOriginJSONSupport ../../core/Logger ../support/arcgisLayerUrl".split(" "),
function(m,l,h,d,b,g,k,f){var a=k.getLogger("esri.layers.mixins.ArcGISService");return function(e){function c(){return null!==e&&e.apply(this,arguments)||this}return h(c,e),Object.defineProperty(c.prototype,"title",{get:function(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var a=f.parse(this.url);if(a&&a.title)return a.title}return this._get("title")||""},set:function(a){this._set("title",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,
"url",{set:function(c){this._set("url",f.sanitizeUrl(c,a))},enumerable:!0,configurable:!0}),d([b.property({dependsOn:["url"]})],c.prototype,"title",null),d([b.property({type:String})],c.prototype,"url",null),c=d([b.subclass("esri.layers.mixins.ArcGISService")],c)}(b.declared(g))})},"esri/core/MultiOriginJSONSupport":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./accessorSupport/decorators ./Accessor ./accessorSupport/read ./accessorSupport/write ./accessorSupport/utils ./accessorSupport/MultiOriginStore ./accessorSupport/PropertyOrigin".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){return function(g){function q(){var b=g.call(this)||this,d=a.getProperties(b),f=d.metadatas,k=d.store,q=new e["default"];return d.store=q,k.keys().forEach(function(a){q.set(a,k.get(a),c.OriginId.DEFAULTS)}),Object.keys(f).forEach(function(a){d.internalGet(a)&&q.set(a,d.internalGet(a),c.OriginId.DEFAULTS)}),b}return h(q,g),q.prototype.clear=function(b,e){return void 0===e&&(e="user"),a.getProperties(this).store.clear(b,c.nameToId(e))},q.prototype.read=function(a,c){return k["default"](this,
a,c),this},q.prototype.write=function(a,c){return a=a||{},f["default"](this,a,c),a},q.prototype.getAtOrigin=function(b,e){var d=a.getProperties(this).store,f=c.nameToId(e);if("string"==typeof b)return d.get(b,f);var g={};return b.forEach(function(a){g[a]=d.get(a,f)}),g},q.prototype.originOf=function(b){var e=a.getProperties(this).store;if("string"==typeof b)return c.idToName(e.originOf(b));b.forEach(function(a){c.idToName(e.originOf(a))})},q.prototype.revert=function(b,e){var d=a.getProperties(this).store,
f=c.nameToId(e),g=a.getProperties(this);("string"==typeof b?"*"===b?Object.keys(d.getAll(f)):[b]:b).forEach(function(a){g.propertyInvalidated(a);d.revert(a,f);g.propertyCommitted(a)})},q.prototype.removeOrigin=function(b){var e=a.getProperties(this).store;b=c.nameToId(b);var d=e.getAll(b),f;for(f in d)e.originOf(f)===b&&e.set(f,d[f],c.OriginId.USER)},q.prototype.updateOrigin=function(b,e){var d=a.getProperties(this).store;e=c.nameToId(e);var f=this.get(b);d.clear(b);d.set(b,f,e)},q=d([b.subclass("esri.core.MultiOriginJSONSupport")],
q)}(b.declared(g))})},"esri/core/accessorSupport/MultiOriginStore":function(){define(["require","exports","./PropertyOrigin"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function d(){this._propertyOriginMap={};this._originStores=Array(h.OriginId.NUM);this._values={}}return d.prototype.get=function(b,d){return(d=void 0===d?this._values:this._originStores[d])?d[b]:void 0},d.prototype.keys=function(){return Object.keys(this._values)},d.prototype.set=function(b,d,k){void 0===
k&&(k=h.OriginId.USER);var f=this._originStores[k];return(f||(f={},this._originStores[k]=f),f[b]=d,!(b in this._values)||this._propertyOriginMap[b]<=k)?(f=this._values[b],this._values[b]=d,this._propertyOriginMap[b]=k,f!==d):!1},d.prototype.clear=function(b,d){void 0===d&&(d=h.OriginId.USER);var g=this._originStores[d];if(g){var f=g[b];if(delete g[b],b in this._values&&this._propertyOriginMap[b]===d)for(delete this._values[b],--d;0<=d;d--)if((g=this._originStores[d])&&b in g){this._values[b]=g[b];
this._propertyOriginMap[b]=d;break}return f}},d.prototype.has=function(b,d){return(d=void 0===d?this._values:this._originStores[d])?b in d:!1},d.prototype.revert=function(b,d){for(;0<d&&!this.has(b,d);)--d;var g=this._originStores[d],g=g&&g[b],f=this._values[b];return this._values[b]=g,this._propertyOriginMap[b]=d,f!==g},d.prototype.originOf=function(b,d){return this._propertyOriginMap[b]||h.OriginId.DEFAULTS},d.prototype.getAll=function(b){return this._originStores[b]},d}();l["default"]=m})},"esri/layers/mixins/ArcGISCachedService":function(){define(["dojo/_base/lang",
"dojo/io-query","./ArcGISService","../support/TileInfo","../support/TilemapCache"],function(m,l,h,d,b){return h.createSubclass([],{declaredClass:"esri.layers.mixins.ArcGISCachedService",properties:{minScale:{json:{origins:{service:{read:!1}}}},maxScale:{json:{origins:{service:{read:!1}}}},resampling:!0,supportsBlankTile:{value:!1,readOnly:!0,dependsOn:["version"],get:function(){return 10.2<=this.version}},tileInfo:{value:null,type:d,json:{read:function(b,k){var f=k.minScale?k.minScale:+(1/0),a=k.maxScale?
k.maxScale:-(1/0);return b?(b.lods=b.lods.filter(function(b){return b.scale<=f&&b.scale>=a}),d.fromJSON(b)):null}}},tilemapCache:{value:null,json:{read:{source:["capabilities"],reader:function(d,k){return k.capabilities&&-1<k.capabilities.indexOf("Tilemap")?new b({layer:this}):null}}}},refreshTimestamp:null,version:{}},refresh:function(){this.refreshTimestamp=Date.now();this.inherited(arguments)},getTileUrl:function(b,d,f){var a=m.mixin({},this.parsedUrl.query,{token:this.token,blankTile:!this.tilemapCache&&
this.resampling&&this.supportsBlankTile?!1:null,_ts:this.refreshTimestamp});b=this.parsedUrl.path+"/tile/"+b+"/"+d+"/"+f;return a=l.objectToQuery(a),b+=a?"?"+a:""}})})},"esri/layers/support/TilemapCache":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/_base/lang dojo/io-query ../../request ../../core/Accessor ../../core/LRUMap ../../core/promiseUtils ../../core/watchUtils ../../core/Error ../../core/HandleRegistry ../../core/Logger ../../core/accessorSupport/decorators ./Tilemap".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){var x=r.getLogger("esri.layers.support.TilemapCache");return function(f){function n(a){a=f.call(this)||this;return a._handles=new t,a._pendingTilemapRequests={},a._availableLevels={},a.levels=5,a.cacheByteSize=2097152,a.request=k,a}return h(n,f),n.prototype.initialize=function(){var b=this;this._tilemapCache=new a(this.cacheByteSize,{sizeOfFunction:function(a){return a.byteSize}});this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers"],function(){return b._initializeTilemapDefinition()}),
c.init(this,"layer.tileInfo.lods",function(a){return b._initializeAvailableLevels(a)},!0)]);this._initializeTilemapDefinition()},n.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)},n.prototype.castLevels=function(a){return 2>=a?(x.error("Minimum levels for Tilemap is 3, but got ",a),3):a},Object.defineProperty(n.prototype,"size",{get:function(){return 1<<this.levels},enumerable:!0,configurable:!0}),n.prototype.getTilemap=function(a,c,b){return this._tilemapFromCache(a,
c,b,this._tmpTilemapDefinition)},n.prototype.fetchTilemap=function(a,c,b,d){var f=this;if(!this._availableLevels[a])return e.reject(new q("tilemap-cache:level-unavailable","Level "+a+" is unavailable in the service"));var g=this._tmpTilemapDefinition;if(a=this._tilemapFromCache(a,c,b,g))return e.resolve(a);var n=v.tilemapDefinitionId(g);a=this._pendingTilemapRequests[n];return a||(a=v.Tilemap.fromDefinition(g,d).then(function(a){return f._tilemapCache.set(n,a),delete f._pendingTilemapRequests[n],
a}).otherwise(function(a){return delete f._pendingTilemapRequests[n],e.reject(a)}),this._pendingTilemapRequests[n]=a),a},n.prototype.getAvailability=function(a,c,b){return this._availableLevels[a]?(a=this.getTilemap(a,c,b))?a.getAvailability(c,b):"unknown":"unavailable"},n.prototype.getAvailabilityUpsample=function(a,c,b,e){e.level=a;e.row=c;e.col=b;a=this.layer.tileInfo;for(a.updateTileInfo(e);;){c=this.getAvailability(e.level,e.row,e.col);if("unavailable"!==c)return c;if(!a.upsampleTile(e))return"unavailable"}},
n.prototype.fetchAvailability=function(a,c,b,d){return this._availableLevels[a]?this.fetchTilemap(a,c,b,d).always(function(d){return d instanceof v.Tilemap?(d=d.getAvailability(c,b),"unavailable"===d?e.reject(new q("tile-map:tile-unavailable","Tile is not available",{level:a,row:c,col:b})):d):"unknown"}):e.reject(new q("tilemap-cache:level-unavailable","Level "+a+" is unavailable in the service"))},n.prototype.fetchAvailabilityUpsample=function(a,c,b,d,f){var g=this;d.level=a;d.row=c;d.col=b;var n=
this.layer.tileInfo;return n.updateTileInfo(d),this.fetchAvailability(a,c,b,f).otherwise(function(a){return n.upsampleTile(d)?g.fetchAvailabilityUpsample(d.level,d.row,d.col,d):e.reject(a)})},n.prototype._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var a=this.layer.parsedUrl,c=a.query;c&&c.token||!this.layer.token||(c=b.mixin(c,{token:this.layer.token}));this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:a.path,query:c?g.objectToQuery(c):null,tileServers:this.layer.tileServers,
request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}},n.prototype._tilemapFromCache=function(a,c,b,e){a=this._getTilemapDefinition(a,c,b,e);a=v.tilemapDefinitionId(a);return this._tilemapCache.get(a)},n.prototype._getTilemapDefinition=function(a,c,b,e){return e.level=a,e.row=c-c%this.size,e.col=b-b%this.size,e},n.prototype._initializeAvailableLevels=function(a){var c=this;this._availableLevels={};a&&a.forEach(function(a){return c._availableLevels[a.level]=!0})},d([u.property({constructOnly:!0,
type:Number})],n.prototype,"levels",void 0),d([u.cast("levels")],n.prototype,"castLevels",null),d([u.property({readOnly:!0,dependsOn:["levels"],type:Number})],n.prototype,"size",null),d([u.property({constructOnly:!0,type:Number})],n.prototype,"cacheByteSize",void 0),d([u.property({constructOnly:!0})],n.prototype,"layer",void 0),d([u.property({constructOnly:!0})],n.prototype,"request",void 0),n=d([u.subclass("esri.layers.support.TilemapCache")],n)}(u.declared(f))})},"esri/core/LRUMap":function(){define(["require",
"exports"],function(m,l){return function(){function h(d,b){if(void 0===d&&(d=0),this.sizeOfFunction=function(){return 1},this._sizeOf=0,this._cache=new Map,this._queue=[],0>=d)throw Error("LRU cache size must be bigger than zero!");this._maxSize=d;b&&(b.disposeFunction&&(this.disposeFunction=b.disposeFunction),b.sizeOfFunction&&(this.sizeOfFunction=b.sizeOfFunction))}return Object.defineProperty(h.prototype,"length",{get:function(){return this._cache.size},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,
"size",{get:function(){return this._sizeOf},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"keys",{get:function(){return this._queue.slice()},enumerable:!0,configurable:!0}),h.prototype.clear=function(){var d=this;this._queue.length=0;this.disposeFunction&&this._cache.forEach(function(b,g){d.disposeFunction(g,b)});this._cache.clear();this._sizeOf=0},h.prototype["delete"]=function(d){var b=this._cache.get(d);return this._cache["delete"](d)?(this._sizeOf-=this.sizeOfFunction(b),this.disposeFunction&&
this.disposeFunction(d,b),this._queue.splice(this._queue.indexOf(d),1),!0):!1},h.prototype.forEach=function(d,b){this._cache.forEach(d,b)},h.prototype.get=function(d){var b=this._cache.get(d);if(void 0!==b)return this._queue.splice(this._queue.indexOf(d),1),this._queue.unshift(d),b},h.prototype.has=function(d){return this._cache.has(d)},h.prototype.set=function(d,b){var g=this.get(d);return void 0!==g?this._sizeOf-=this.sizeOfFunction(g):this._queue.unshift(d),this._sizeOf+=this.sizeOfFunction(b),
this._cache.set(d,b),this._collect(),this},h.prototype._collect=function(){for(;this._queue.length&&this._sizeOf>this._maxSize;){var d=this._queue.pop(),b=this._cache.get(d);this._cache["delete"](d)&&(this._sizeOf-=this.sizeOfFunction(b),this.disposeFunction&&this.disposeFunction(d,b))}},h}()})},"esri/layers/support/Tilemap":function(){define("require exports dojo/_base/lang ../../request ../../core/lang ../../core/Error".split(" "),function(m,l,h,d,b,g){function k(b){var a=b.service.tileServers,
a=(a&&a.length?a[b.row%a.length]:b.service.url)+"/tilemap/"+b.level+"/"+b.row+"/"+b.col+"/"+b.width+"/"+b.height;b=b.service.query;return b&&(a=a+"?"+b),a}Object.defineProperty(l,"__esModule",{value:!0});m=function(){function f(){this.location={left:0,top:0,width:0,height:0};this.byteSize=40}return f.prototype.getAvailability=function(a,b){if(this._isAllAvailable)return"available";if(this._isAllUnvailable)return"unavailable";a=(a-this.location.top)*this.location.width+(b-this.location.left);b=a>>
3;var c=this._tileAvailabilityBitSet;return 0>b||b>c.length?"unknown":c[b]&1<<a%8?"available":"unavailable"},f.prototype._updateFromData=function(a){for(var b=!0,c=!0,d=new Uint8Array(Math.ceil(this.location.width*this.location.height/8)),f=0,g=0;g<a.length;g++){var k=g%8;a[g]?(c=!1,d[f]|=1<<k):b=!1;7===k&&++f}this._isAllUnvailable=c;(this._isAllAvailable=b)||this._isAllUnvailable||(this._tileAvailabilityBitSet=d,this.byteSize+=d.length)},f.fromDefinition=function(a,b){var c=a.service.request||d,
e=a.row,t=a.col,r=a.width,u=a.height,l={callbackParamName:"callback"};return b=b?h.mixin(l,b):l,c(k(a),b).then(function(a){var c=a.data;if(c.location&&(c.location.top!==e||c.location.left!==t||c.location.width!==r||c.location.height!==u))throw new g("tilemap:location-mismatch","Tilemap response for different location than requested",{response:c,definition:{top:e,left:t,width:r,height:u}});return f.fromJSON(a.data)})},f.fromJSON=function(a){f.validateJSON(a);var e=new f;return e.location=Object.freeze(b.clone(a.location)),
e._updateFromData(a.data),Object.freeze(e)},f.validateJSON=function(a){if(!a||!a.location)throw new g("tilemap:missing-location","Location missing from tilemap response");if(!a.valid)throw new g("tilemap:invalid","Tilemap response was marked as invalid");if(!a.data)throw new g("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(a.data))throw new g("tilemap:data-mismatch","Data must be an array of numbers");if(a.data.length!==a.location.width*a.location.height)throw new g("tilemap:data-mismatch",
"Number of data items does not match width/height of tilemap");},f}();l.Tilemap=m;l.tilemapDefinitionId=function(b){return b.level+"/"+b.row+"/"+b.col+"/"+b.width+"/"+b.height};l.tilemapDefinitionUrl=k;l["default"]=m})},"esri/layers/mixins/OperationalLayer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/MultiOriginJSONSupport ../../core/Error ../../core/urlUtils ../../core/accessorSupport/write ../../core/accessorSupport/read".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){m=function(g){function k(){var a=null!==g&&g.apply(this,arguments)||this;return a.title="Layer",a}return h(k,g),t=k,k.prototype.writeListMode=function(a,c,b,d){d&&"ground"===d.layerContainerType?c[b]=a:a&&e.willPropertyWrite(this,b,{},d)&&(c[b]=a)},k.prototype.writeTitle=function(a,c){c.title=a||"Layer"},k.prototype.writeOperationalLayerType=function(a,c){a&&(c.layerType=a)},k.prototype.readOpacity=function(a,c,b){return void 0===c.opacity||b&&"web-map"!==b.origin&&
"web-scene"!==b.origin?b&&"service"!==b.origin||!c.drawingInfo||void 0===c.drawingInfo.transparency?c.layerDefinition&&c.layerDefinition.drawingInfo&&void 0!==c.layerDefinition.drawingInfo.transparency?1-c.layerDefinition.drawingInfo.transparency/100:void 0:1-c.drawingInfo.transparency/100:c.opacity},k.prototype.readVisible=function(a,c){return!!c.visibility},k.prototype.read=function(a,b){var e=this,d=arguments;return b&&(b.layer=this),c.readLoadable(this,a,function(c){return e.inherited(d,[a,c])},
b),this},k.prototype.write=function(a,c){if(c&&c.origin){var b=c.origin+"/"+(c.layerContainerType||"operational-layers"),e=t.supportedTypes[b],e=e&&e[this.operationalLayerType];if("write"!==e&&"readwrite"!==e)return c.messages&&c.messages.push(new f("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' are not supported in the context of '"+b+"'",{layer:this})),null;if(!this.url&&!q[this.operationalLayerType])return c.messages&&c.messages.push(new f("layer:unsupported",
"Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' require a url to a service to be written to a '"+c.origin+"'",{layer:this})),null}return this.inherited(arguments,[a,c])},d([b.property({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}}}}})],k.prototype,"id",void 0),d([b.property({type:String,json:{write:{ignoreOrigin:!0}}})],k.prototype,"listMode",void 0),d([b.writer("listMode")],k.prototype,"writeListMode",null),d([b.property({type:String,
json:{write:{ignoreOrigin:!0,allowNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}}}}})],k.prototype,"title",void 0),d([b.writer("title")],k.prototype,"writeTitle",null),d([b.property({type:String,json:{write:{ignoreOrigin:!0,writer:a.writeOperationalLayerUrl}}})],k.prototype,"url",void 0),d([b.property({type:String,json:{write:{target:"layerType",ignoreOrigin:!0}}})],k.prototype,"operationalLayerType",void 0),d([b.writer("operationalLayerType")],k.prototype,"writeOperationalLayerType",
null),d([b.property({type:Number,json:{write:{ignoreOrigin:!0}}})],k.prototype,"opacity",void 0),d([b.reader("opacity",["opacity","layerDefinition.drawingInfo.transparency","drawingInfo.transparency"])],k.prototype,"readOpacity",null),d([b.property({type:Boolean,json:{write:{target:"visibility",ignoreOrigin:!0}}})],k.prototype,"visible",void 0),d([b.reader("visible",["visibility"])],k.prototype,"readVisible",null),k=t=d([b.subclass("esri.layers.mixins.OperationalLayer")],k);var t}(b.declared(g,k));
var q={GroupLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,ArcGISFeatureLayer:!0,CSV:!0,VectorTileLayer:!0,KML:!0};return function(a){a.typeModuleMap={ArcGISFeatureLayer:"../FeatureLayer",ArcGISImageServiceLayer:"../ImageryLayer",ArcGISImageServiceVectorLayer:null,ArcGISMapServiceLayer:"../MapImageLayer",ArcGISSceneServiceLayer:"../SceneLayer",ArcGISStreamLayer:"../StreamLayer",ArcGISTiledElevationServiceLayer:"../ElevationLayer",ArcGISTiledImageServiceLayer:"../TileLayer",ArcGISTiledMapServiceLayer:"../TileLayer",
bingLayer:null,CSV:"../CSVLayer",GeoRSS:"../GeoRSSLayer",GroupLayer:"../GroupLayer",IntegratedMeshLayer:"../IntegratedMeshLayer",KML:"../KMLLayer",OpenStreetMap:"../OpenStreetMapLayer",PointCloudLayer:"../PointCloudLayer",VectorTileLayer:"../VectorTileLayer",WebTiledLayer:"../WebTileLayer",WMS:"../WMSLayer"};a.supportedTypes={"web-scene/operational-layers":{ArcGISFeatureLayer:"readwrite",ArcGISImageServiceLayer:"readwrite",ArcGISMapServiceLayer:"readwrite",ArcGISSceneServiceLayer:"readwrite",ArcGISTiledElevationServiceLayer:"read",
ArcGISTiledImageServiceLayer:"readwrite",ArcGISTiledMapServiceLayer:"readwrite",GroupLayer:"readwrite",IntegratedMeshLayer:"readwrite",PointCloudLayer:"readwrite",WebTiledLayer:"readwrite",CSV:"readwrite",VectorTileLayer:"readwrite",WMS:"readwrite"},"web-scene/basemap":{ArcGISTiledImageServiceLayer:"readwrite",ArcGISTiledMapServiceLayer:"readwrite",WebTiledLayer:"readwrite",OpenStreetMap:"readwrite",VectorTileLayer:"readwrite",ArcGISImageServiceLayer:"readwrite",WMS:"readwrite",ArcGISMapServiceLayer:"readwrite"},
"web-scene/ground":{ArcGISTiledElevationServiceLayer:"readwrite"},"web-map/operational-layers":{ArcGISImageServiceLayer:"readwrite",ArcGISImageServiceVectorLayer:"readwrite",ArcGISMapServiceLayer:"readwrite",ArcGISStreamLayer:"readwrite",ArcGISTiledImageServiceLayer:"readwrite",ArcGISTiledMapServiceLayer:"readwrite",ArcGISFeatureLayer:"readwrite",CSV:"readwrite",GeoRSS:"readwrite",KML:"readwrite",VectorTileLayer:"readwrite",WMS:"readwrite",WebTiledLayer:"readwrite"},"web-map/basemap":{ArcGISImageServiceLayer:"readwrite",
ArcGISImageServiceVectorLayer:"readwrite",ArcGISMapServiceLayer:"readwrite",ArcGISTiledImageServiceLayer:"readwrite",ArcGISTiledMapServiceLayer:"readwrite",OpenStreetMap:"readwrite",VectorTileLayer:"readwrite",WMS:"readwrite",WebTiledLayer:"readwrite",bingLayer:"readwrite"}}}(m||(m={})),m})},"esri/layers/mixins/PortalLayer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Error ../../core/Logger ../../core/requireUtils ../../core/promiseUtils ../../core/urlUtils ../../portal/PortalItem ../../portal/Portal".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){var r=f.getLogger("esri.layers.mixins.PortalLayer");return function(f){function g(){return null!==f&&f.apply(this,arguments)||this}return h(g,f),Object.defineProperty(g.prototype,"portalItem",{set:function(a){a!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",a))},enumerable:!0,configurable:!0}),g.prototype.writePortalItem=function(a,c,b){a&&a.id&&(c.itemId=a.id)},g.prototype.loadFromPortal=function(c){var b=this;return this.portalItem&&
this.portalItem.id?a.when(m,"../../portal/support/layersLoader").then(function(a){return a.load({instance:b,supportedTypes:c.supportedTypes,validateItem:c.validateItem,supportsData:c.supportsData}).otherwise(function(a){throw r.warn("Failed to load layer ("+b.title+", "+b.id+") portal item ("+b.portalItem.id+")\n  "+a),a;})}):e.resolve()},g.prototype.read=function(a,c){return c&&(c.layer=this),this.inherited(arguments)},g.prototype.write=function(a,b){var e=b&&b.portal,d=this.portalItem&&this.portalItem.id&&
(this.portalItem.portal||t.getDefault());return e&&d&&!c.hasSamePortal(d.restUrl,e.restUrl)?(b.messages&&b.messages.push(new k("layer:cross-portal","The layer '"+this.title+" ("+this.id+")' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer",{layer:this})),null):this.inherited(arguments)},d([b.property({type:q})],g.prototype,
"portalItem",null),d([b.writer("portalItem",{itemId:{type:String}})],g.prototype,"writePortalItem",null),g=d([b.subclass("esri.layers.mixins.PortalLayer")],g)}(b.declared(g))})},"esri/layers/mixins/RefreshableLayer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor".split(" "),function(m,l,h,d,b,g){return function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;return a.refreshInterval=
0,a}return h(f,g),f.prototype.refresh=function(){this.emit("refresh")},d([b.property({type:Number,cast:function(a){return.1<=a?a:0>=a?0:.1},json:{read:{source:"refreshInterval"},write:{target:"refreshInterval"},origins:{"web-scene":{read:!1,write:!1}}}})],f.prototype,"refreshInterval",void 0),f=d([b.subclass("esri.layers.mixins.RefreshableLayer")],f)}(b.declared(g))})},"esri/layers/mixins/ScaleRangeLayer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/accessorSupport/write".split(" "),
function(m,l,h,d,b,g,k){return function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;return a.minScale=0,a.maxScale=0,a}return h(a,f),d([b.property({type:Number,json:{write:{overridePolicy:function(a,c,b){return k.willPropertyWrite(this,"maxScale",{},b)?{ignoreOrigin:!0}:void 0}}}})],a.prototype,"minScale",void 0),d([b.property({type:Number,json:{write:{overridePolicy:function(a,c,b){return k.willPropertyWrite(this,"minScale",{},b)?{ignoreOrigin:!0}:void 0}}}})],a.prototype,"maxScale",
void 0),a=d([b.subclass("esri.layers.mixins.ScaleRangeLayer")],a)}(b.declared(g))})},"esri/layers/support/arcgisLayers":function(){define("require exports dojo/_base/lang dojo/when ./arcgisLayerUrl ../../core/promiseUtils ../../core/requireUtils ../../request ../../core/Error ./arcgisLayerUrl".split(" "),function(m,l,h,d,b,g,k,f,a,e){function c(a,c){return a.sublayerIds.map(function(b){return new a.Constructor(h.mixin({},c,{layerId:b,sublayerTitleMode:"service-name"}))})}function q(c){var b=e.parse(c);
if(!b)return g.reject(new a("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:c}));var f;f=b.serverType;var q=b.sublayer,h={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"};switch(f){case "MapServer":f=null!=q?"FeatureLayer":r(c).then(function(a){return a?"TileLayer":"MapImageLayer"});break;case "ImageServer":f=v(c).then(function(a){var c=a.tileInfo&&a.tileInfo.format;return a.tileInfo?c&&"LERC"===c.toUpperCase()&&a.cacheType&&
"elevation"===a.cacheType.toLowerCase()?"ElevationLayer":"TileLayer":"ImageryLayer"});break;case "SceneServer":f=v(b.url.path).then(function(a){var c={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer"};return a&&Array.isArray(a.layers)&&0<a.layers.length&&(a=a.layers[0].layerType,null!=c[a])?c[a]:"SceneLayer"});break;default:f=h[f]}var u,y={FeatureLayer:!0,SceneLayer:!0},l={parsedUrl:b,Constructor:null,sublayerIds:null};return d(f).then(function(a){return u=
a,y[a]&&null==q?t(c).then(function(a){1!==a.length&&(l.sublayerIds=a)}):void 0}).then(function(){return k.when(m,x+"/"+u)}).then(function(a){return l.Constructor=a,l})}function t(a){return v(a).then(function(a){return a&&Array.isArray(a.layers)?a.layers.map(function(a){return a.id}).reverse():[]})}function r(a){return v(a).then(function(a){return a.tileInfo})}function u(a,c){a=a.Constructor.prototype.declaredClass;return"esri.layers.FeatureLayer"===a||"esri.layers.StreamLayer"===a?h.mixin({returnZ:!0,
outFields:["*"]},c):c}function v(a){return f(a,{responseType:"json",callbackParamName:"callback",query:{f:"json"}}).then(function(a){return a.data})}Object.defineProperty(l,"__esModule",{value:!0});var x="..";l.fromUrl=function(a){return q(a.url).then(function(b){var e=u(b,h.mixin({},a.properties,{url:a.url}));return b.sublayerIds?k.when(m,x+"/GroupLayer").then(function(a){var d=new a({title:b.parsedUrl.title});return c(b,e).forEach(function(a){return d.add(a)}),g.resolve(d)}):g.resolve(new b.Constructor(e))})};
l.fetchServerVersion=function(a){if(!b.test(a))return g.reject();a=a.replace(/(.*\/rest)\/.*/i,"$1")+"/info";return f(a,{query:{f:"json"},responseType:"json",callbackParamName:"callback"}).then(function(a){return a.data&&a.data.currentVersion?a.data.currentVersion:g.reject()})}})},"esri/layers/BaseTileLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../request ../core/Error ../geometry/Extent ../geometry/SpatialReference ./Layer ./mixins/ScaleRangeLayer ./support/TileInfo ../core/accessorSupport/decorators ./mixins/RefreshableLayer dojo/_base/lang".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){var u={id:"0/0/0",level:0,row:0,col:0,extent:null};return function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;return b.tileInfo=c.create({spatialReference:f.WebMercator,size:256}),b.type="base-tile",b.fullExtent=new k(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,f.WebMercator),b.spatialReference=f.WebMercator,b}return h(e,a),e.prototype.getTileBounds=function(a,c,b,e){e=e||[0,0,0,0];return u.level=a,u.row=c,u.col=
b,u.extent=e,this.tileInfo.updateTileInfo(u),u.extent=null,e},e.prototype.getTileUrl=function(a,c,b){throw new g("basetilelayer:gettileurl-not-implemented","getTileUrl() is not implemented");},e.prototype.fetchTile=function(a,c,e,d){a=this.getTileUrl(a,c,e);var f={responseType:"image"};return d&&d.timestamp&&(f.query={_ts:d.timestamp}),"string"==typeof a?b(a,r.mixin({allowImageDataAccess:d&&d.allowImageDataAccess||!1},f)).then(function(a){return a.data}):a.then(function(a){return b(a,f)}).then(function(a){return a.data})},
d([q.shared({"2d":"../views/2d/layers/TiledLayerView2D","3d":"../views/3d/layers/TileLayerView3D"})],e.prototype,"viewModulePaths",void 0),d([q.property({type:c})],e.prototype,"tileInfo",void 0),d([q.property({readOnly:!0,value:"base-tile"})],e.prototype,"type",void 0),d([q.property()],e.prototype,"fullExtent",void 0),d([q.property()],e.prototype,"spatialReference",void 0),e=d([q.subclass("esri.layers.BaseTileLayer")],e)}(q.declared(a,t,e))})},"esri/layers/BaseElevationLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Error ../geometry/Extent ../geometry/SpatialReference ./Layer ./support/TileInfo ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a,e){var c={id:"0/0/0",level:0,row:0,col:0,extent:null};return function(f){function q(){var c=null!==f&&f.apply(this,arguments)||this;return c.tileInfo=a.create({spatialReference:k.WebMercator,size:256}),c.fullExtent=new g(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,k.WebMercator),c.spatialReference=k.WebMercator,c.type="base-elevation",c}return h(q,f),q.prototype.getTileBounds=function(a,b,e,d){d=d||[0,0,0,0];return c.level=a,c.row=b,c.col=e,c.extent=
d,this.tileInfo.updateTileInfo(c),c.extent=null,d},q.prototype.fetchTile=function(a,c,e,d){throw new b("BaseElevationLayer:fetchtile-not-implemented","fetchTile() is not implemented");},d([e.shared({"3d":"../views/3d/layers/ElevationLayerView3D"})],q.prototype,"viewModulePaths",void 0),d([e.property({type:a})],q.prototype,"tileInfo",void 0),d([e.property()],q.prototype,"fullExtent",void 0),d([e.property()],q.prototype,"spatialReference",void 0),d([e.property({readOnly:!0,value:"base-elevation"})],
q.prototype,"type",void 0),q=d([e.subclass("esri.layers.BaseElevationLayer")],q)}(e.declared(f))})},"esri/layers/ElevationLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators dojo/_base/lang dojo/_base/kernel ../request ../core/Error ../core/promiseUtils ../core/requireUtils ../core/urlUtils ../geometry/HeightModelInfo ./TiledLayer ./mixins/ArcGISMapService ./mixins/ArcGISCachedService ./mixins/OperationalLayer ./mixins/PortalLayer ./support/rasterFormats/LercCodec".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n){return function(w){function r(a){a=w.call(this)||this;return a.heightModelInfo=null,a.type="elevation",a.url=null,a.opacity=1,a.operationalLayerType="ArcGISTiledElevationServiceLayer",a}return h(r,w),r.prototype.normalizeCtorArgs=function(a,c){return"string"==typeof a?g.mixin({},{url:a},c):a},Object.defineProperty(r.prototype,"minScale",{get:function(){},set:function(a){k.deprecated(this.declaredClass+".minScale support has been removed.","","4.5")},
enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxScale",{get:function(){},set:function(a){k.deprecated(this.declaredClass+".maxScale support has been removed.","","4.5")},enumerable:!0,configurable:!0}),r.prototype.load=function(){var c=this;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:function(c){for(var b=0;b<c.typeKeywords.length;b++)if("elevation 3d layer"===c.typeKeywords[b].toLowerCase())return!0;throw new a("portal:invalid-layer-item-type",
"Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"});}}).always(function(){return c._fetchImageService()})),this.when()},r.prototype.fetchTile=function(a,c,b,e){var d=this;return void 0===e&&(e=0),this.load().then(function(){return d._fetchTileAvailability(a,c,b)}).then(function(){var e=d.getTileUrl(a,c,b);return f(e,{responseType:"array-buffer",failOk:!0})}).then(function(a){a=n.decode(a.data,{noDataValue:e,returnFileInfo:!0});
return{values:a.pixelData,width:a.width,height:a.height,maxZError:a.fileInfo.maxZError,noDataValue:a.noDataValue}})},r.prototype.queryElevation=function(a,b){var e=this;return c.when(m,"./support/ElevationQuery").then(function(c){return(new c.ElevationQuery).query(e,a,b)})},r.prototype._fetchTileAvailability=function(a,c,b){return this.tilemapCache?this.tilemapCache.fetchAvailability(a,c,b):e.resolve("unknown")},r.prototype._fetchImageService=function(){var a=this;return e.resolve().then(function(){if(a.resourceInfo)return a.resourceInfo;
var c={query:g.mixin({f:"json"},a.parsedUrl.query),responseType:"json",callbackParamName:"callback"};return f(a.parsedUrl.path,c)}).then(function(c){c.ssl&&(a.url=a.url.replace(/^http:/i,"https:"));a.read(c.data,{origin:"service",url:a.parsedUrl})})},d([b.shared({"3d":"../views/3d/layers/ElevationLayerView3D"})],r.prototype,"viewModulePaths",void 0),d([b.property({readOnly:!0,type:t})],r.prototype,"heightModelInfo",void 0),d([b.property({json:{read:!1,write:!1}})],r.prototype,"minScale",null),d([b.property({json:{read:!1,
write:!1}})],r.prototype,"maxScale",null),d([b.property()],r.prototype,"resourceInfo",void 0),d([b.property({json:{read:!1},value:"elevation",readOnly:!0})],r.prototype,"type",void 0),d([b.property({json:{origins:{"web-scene":{write:{isRequired:!0,writer:q.writeOperationalLayerUrl}}}}})],r.prototype,"url",void 0),d([b.property({json:{read:!1,write:!1}})],r.prototype,"opacity",void 0),d([b.property()],r.prototype,"operationalLayerType",void 0),r=d([b.subclass("esri.layers.ElevationLayer")],r)}(b.declared(r,
u,v,x,y))})},"esri/layers/support/rasterFormats/LercCodec":function(){define([],function(){var m={defaultNoDataValue:-3.4027999387901484E38,decode:function(h,d){var b;d=d||{};var g=d.inputOffset||0,k=d.encodedMaskData||null===d.encodedMaskData,f={},a=new Uint8Array(h,g,10);if(f.fileIdentifierString=String.fromCharCode.apply(null,a),"CntZImage"!=f.fileIdentifierString.trim())throw"Unexpected file identifier string: "+f.fileIdentifierString;g+=10;a=new DataView(h,g,24);if(f.fileVersion=a.getInt32(0,
!0),f.imageType=a.getInt32(4,!0),f.height=a.getUint32(8,!0),f.width=a.getUint32(12,!0),f.maxZError=a.getFloat64(16,!0),g+=24,!k)if(a=new DataView(h,g,16),f.mask={},f.mask.numBlocksY=a.getUint32(0,!0),f.mask.numBlocksX=a.getUint32(4,!0),f.mask.numBytes=a.getUint32(8,!0),f.mask.maxValue=a.getFloat32(12,!0),g+=16,0<f.mask.numBytes){var k=new Uint8Array(Math.ceil(f.width*f.height/8)),a=new DataView(h,g,f.mask.numBytes),e=a.getInt16(0,!0),c=2,q=0;do{if(0<e)for(;e--;)k[q++]=a.getUint8(c++);else for(var t=
a.getUint8(c++),e=-e;e--;)k[q++]=t;e=a.getInt16(c,!0);c+=2}while(c<f.mask.numBytes);if(-32768!==e||q<k.length)throw"Unexpected end of mask RLE encoding";f.mask.bitset=k;g+=f.mask.numBytes}else 0===(f.mask.numBytes|f.mask.numBlocksY|f.mask.maxValue)&&(k=new Uint8Array(Math.ceil(f.width*f.height/8)),f.mask.bitset=k);a=new DataView(h,g,16);f.pixels={};f.pixels.numBlocksY=a.getUint32(0,!0);f.pixels.numBlocksX=a.getUint32(4,!0);f.pixels.numBytes=a.getUint32(8,!0);f.pixels.maxValue=a.getFloat32(12,!0);
g+=16;k=f.pixels.numBlocksX;a=f.pixels.numBlocksY;k+=0<f.width%k?1:0;e=a+(0<f.height%a?1:0);f.pixels.blocks=Array(k*e);c=1E9;for(t=q=0;e>t;t++)for(var r=0;k>r;r++){var u=0,a=new DataView(h,g,Math.min(10,h.byteLength-g)),v={};f.pixels.blocks[q++]=v;var x=a.getUint8(0);if(u++,v.encoding=63&x,3<v.encoding)throw"Invalid block encoding ("+v.encoding+")";if(2!==v.encoding){if(0!==x&&2!==x){if(x>>=6,v.offsetType=x,2===x)v.offset=a.getInt8(1),u++;else if(1===x)v.offset=a.getInt16(1,!0),u+=2;else{if(0!==x)throw"Invalid block offset type";
v.offset=a.getFloat32(1,!0);u+=4}if(c=Math.min(v.offset,c),1===v.encoding)if(x=a.getUint8(u),u++,v.bitsPerPixel=63&x,x>>=6,v.numValidPixelsType=x,2===x)v.numValidPixels=a.getUint8(u),u++;else if(1===x)v.numValidPixels=a.getUint16(u,!0),u+=2;else{if(0!==x)throw"Invalid valid pixel count type";v.numValidPixels=a.getUint32(u,!0);u+=4}}if(g+=u,3!=v.encoding)if(0===v.encoding){a=(f.pixels.numBytes-1)/4;if(a!==Math.floor(a))throw"uncompressed block has invalid length";u=new ArrayBuffer(4*a);x=new Uint8Array(u);
x.set(new Uint8Array(h,g,4*a));u=new Float32Array(u);for(x=0;x<u.length;x++)c=Math.min(c,u[x]);v.rawData=u;g+=4*a}else 1===v.encoding&&(a=Math.ceil(v.numValidPixels*v.bitsPerPixel/8),u=new ArrayBuffer(4*Math.ceil(a/4)),x=new Uint8Array(u),x.set(new Uint8Array(h,g,a)),v.stuffedData=new Uint32Array(u),g+=a)}else g++,c=Math.min(c,0)}h=(f.pixels.minValue=c,f.eofOffset=g,f);var g=null!=d.noDataValue?d.noDataValue:m.defaultNoDataValue,k=d.encodedMaskData,v=d.returnMask,a=0,e=h.pixels.numBlocksX,c=h.pixels.numBlocksY,
q=Math.floor(h.width/e),t=Math.floor(h.height/c),r=2*h.maxZError,k=k||(h.mask?h.mask.bitset:null),y,f=new (d.pixelType||Float32Array)(h.width*h.height);v&&k&&(y=new Uint8Array(h.width*h.height));for(var n,w,v=new Float32Array(q*t),u=0;c>=u;u++)if(x=u!==c?t:h.height%c,0!==x)for(var z=0;e>=z;z++){var C=z!==e?q:h.width%e;if(0!==C){var B,F,G=u*h.width*t+z*q,N=h.width-C,M=h.pixels.blocks[a];if(2>M.encoding){if(0===M.encoding)B=M.rawData;else{B=M.stuffedData;F=M.bitsPerPixel;n=M.numValidPixels;w=M.offset;
var R=r,P=v,Q=h.pixels.maxValue,T=void 0,O=void 0,S=void 0,H=(1<<F)-1,Y=0,W=0,E=Math.ceil((Q-w)/R);B[B.length-1]<<=8*(4*B.length-Math.ceil(F*n/8));for(T=0;n>T;T++)(0===W&&(S=B[Y++],W=32),W>=F)?(O=S>>>W-F&H,W-=F):(W=F-W,O=(S&H)<<W&H,S=B[Y++],W=32-W,O+=S>>>W),P[T]=E>O?w+O*R:Q;B=v}F=0}else b=2===M.encoding?0:M.offset;var p;if(k)for(w=0;x>w;w++){7&G&&(p=k[G>>3],p<<=7&G);for(n=0;C>n;n++)7&G||(p=k[G>>3]),128&p?(y&&(y[G]=1),f[G++]=2>M.encoding?B[F++]:b):(y&&(y[G]=0),f[G++]=g),p<<=1;G+=N}else if(2>M.encoding)for(w=
0;x>w;w++){for(n=0;C>n;n++)f[G++]=B[F++];G+=N}else for(w=0;x>w;w++){for(n=0;C>n;n++)f[G++]=b;G+=N}if(1===M.encoding&&F!==M.numValidPixels)throw"Block and Mask do not match";a++}}b=y;y={width:h.width,height:h.height,pixelData:f,minValue:h.pixels.minValue,maxValue:h.pixels.maxValue,noDataValue:g};b&&(y.maskData=b);d.returnEncodedMask&&h.mask&&(y.encodedMaskData=h.mask.bitset?h.mask.bitset:null);if(d.returnFileInfo&&(y.fileInfo=l(h),d.computeUsedBitDepths)){d=y.fileInfo;b=h.pixels.numBlocksX*h.pixels.numBlocksY;
p={};for(B=0;b>B;B++)F=h.pixels.blocks[B],0===F.encoding?p.float32=!0:1===F.encoding?p[F.bitsPerPixel]=!0:p[0]=!0;b=Object.keys(p);d.bitDepths=b}return y}},l=function(h){return{fileIdentifierString:h.fileIdentifierString,fileVersion:h.fileVersion,imageType:h.imageType,height:h.height,width:h.width,maxZError:h.maxZError,eofOffset:h.eofOffset,mask:h.mask?{numBlocksX:h.mask.numBlocksX,numBlocksY:h.mask.numBlocksY,numBytes:h.mask.numBytes,maxValue:h.mask.maxValue}:null,pixels:{numBlocksX:h.pixels.numBlocksX,
numBlocksY:h.pixels.numBlocksY,numBytes:h.pixels.numBytes,maxValue:h.pixels.maxValue,minValue:h.pixels.minValue,noDataValue:this.noDataValue}}};return m})},"esri/layers/VectorTileLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang ../core/accessorSupport/decorators ../core/Error ../core/MultiOriginJSONSupport ../core/urlUtils ../core/promiseUtils ../core/lang ../request ../geometry/Extent ../geometry/SpatialReference ../portal/support/jsonContext ./TiledLayer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./mixins/ArcGISCachedService ./support/TileInfo ./support/vectorTileLayerLoader ../views/vectorTiles/style/StyleRepository ../views/vectorTiles/SchemaHelper".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F){return function(f){function n(a,c){a=f.call(this)||this;return a.currentStyleInfo=null,a.fullExtent=null,a.style=null,a.operationalLayerType="VectorTileLayer",a.tileInfo=null,a.type="vector-tile",a.url=null,a}return h(n,f),n.prototype.normalizeCtorArgs=function(a,c){return"string"==typeof a?b.mixin({},{url:a},c):a},n.prototype.load=function(){var a=this,c=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1}).then(function(){if(a.portalItem&&
a.portalItem.id){var c=a.portalItem.itemUrl+"/resources/styles/root.json";return q(c,{query:{f:"json"}}).then(function(b){b.data&&a.read({url:c},u.createForItem(a.portalItem))})}}).always(function(){return a.loadStyle()});return this.addResolvingPromise(c),this.when()},Object.defineProperty(n.prototype,"attributionDataUrl",{get:function(){var c=this.currentStyleInfo;return(c=c&&c.serviceUrl&&a.urlToObject(c.serviceUrl))?this._getDefaultAttribution(c.path):null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,
"serviceUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"spatialReference",{get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"styleUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null},enumerable:!0,configurable:!0}),n.prototype.writeStyleUrl=function(b,e){b&&a.isProtocolRelative(b)&&
(b="https:"+b);b&&!c.endsWith(b,"root.json")&&(b=a.join(b,"root.json"));e.styleUrl=b},n.prototype.readTileIndexType=function(a,c){return c.type},n.prototype.readTileIndexUrl=function(c,b){return a.join(this.serviceUrl,b.tileMap)},n.prototype.readTileServers=function(c,b){var e=this;c=b.tiles;return this.serviceUrl&&c.forEach(function(c,b,d){d[b]=a.join(e.serviceUrl,c)}),c},n.prototype.readVersion=function(a,c){return c.version?parseFloat(c.version):parseFloat(c.currentVersion)},n.prototype.readCompatibleTileInfo256=
function(a,c){return z.fromJSON(F.create256x256CompatibleTileInfo(c.tileInfo))},n.prototype.readCompatibleTileInfo512=function(a,c){return z.fromJSON(F.create512x512CompatibleTileInfo(c.tileInfo))},n.prototype.loadStyle=function(a){a=a||this.style||this.url;if(this._loadingPromise&&"string"==typeof a&&this.url===a)return this._loadingPromise;var c=this._loadingPromise;return this._loadingPromise=this._getSourceAndStyle(a),c&&!c.isFulfilled()&&c.cancel(),this._loadingPromise},n.prototype.getTileUrl=
function(a,c,b){var e=this.tileServers[c%this.tileServers.length];return e=e.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,c.toString()).replace(/\{x\}/gi,b.toString())},n.prototype.write=function(a,c){return c&&c.origin&&!this.styleUrl?(c.messages&&c.messages.push(new k("vectortilelayer:unsupported","VectorTileLayer ("+this.title+", "+this.id+") with style defined by JSON only are not supported",{layer:this})),null):this.inherited(arguments,[a,c])},n.prototype._getSourceAndStyle=function(a){var c=
this;return a?C.loadMetadata(a).then(function(b){c._set("currentStyleInfo",{serviceUrl:b.serviceUrl,styleUrl:b.styleUrl,spriteUrl:b.spriteUrl,glyphsUrl:b.glyphsUrl,style:b.style,layerDefinition:b.layerDefinition});"string"==typeof a?(c.url=a,c.style=null):(c.url=null,c.style=a);c._set("styleRepository",new B(b.style,b));c.read(b.layerDefinition)}):e.reject(Error("invalid style!"))},n.prototype._getDefaultAttribution=function(c){var b=c.match(/^https?:\/\/(basemaps|basemapsbeta|basemapsdev)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);
c=["World_Basemap","World_Basemap_v2","World_Basemap_GCS_v2","World_Basemap_WGS84"];if(b){var e=b[3]&&b[3].toLowerCase();if(e)for(var b=b[2]||"",d=0;d<c.length;d++){var f=c[d];if(-1<f.toLowerCase().indexOf(e))return a.normalize("//static.arcgis.com/attribution/Vector"+b+"/"+f)}}},d([g.shared({"2d":"../views/2d/layers/VectorTileLayerView2D","3d":"../views/3d/layers/VectorTileLayerView3D"})],n.prototype,"viewModulePaths",void 0),d([g.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],n.prototype,
"attributionDataUrl",null),d([g.property({readOnly:!0})],n.prototype,"currentStyleInfo",void 0),d([g.property({type:t,readOnly:!0})],n.prototype,"fullExtent",void 0),d([g.property()],n.prototype,"style",void 0),d([g.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],n.prototype,"serviceUrl",null),d([g.property({type:r,dependsOn:["tileInfo"],readOnly:!0})],n.prototype,"spatialReference",null),d([g.property({readOnly:!0})],n.prototype,"styleRepository",void 0),d([g.property({type:String,readOnly:!0,
dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],n.prototype,"styleUrl",null),d([g.writer(["portal-item","web-document"],"styleUrl")],n.prototype,"writeStyleUrl",null),d([g.property({readOnly:!0})],n.prototype,"tileIndexType",void 0),d([g.reader("tileIndexType",["tileIndexType","type"])],n.prototype,"readTileIndexType",null),d([g.property({readOnly:!0})],n.prototype,"tileIndexUrl",void 0),d([g.reader("tileIndexUrl",["tileIndexUrl",
"tileMap"])],n.prototype,"readTileIndexUrl",null),d([g.property({readOnly:!0,type:z})],n.prototype,"tileInfo",void 0),d([g.property({readOnly:!0})],n.prototype,"tileServers",void 0),d([g.reader("tileServers",["tiles"])],n.prototype,"readTileServers",null),d([g.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],n.prototype,"type",void 0),d([g.property({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],n.prototype,"url",void 0),
d([g.property({readOnly:!0})],n.prototype,"version",void 0),d([g.reader("version",["version","currentVersion"])],n.prototype,"readVersion",null),d([g.property({readOnly:!0})],n.prototype,"compatibleTileInfo256",void 0),d([g.reader("compatibleTileInfo256",["tileInfo"])],n.prototype,"readCompatibleTileInfo256",null),d([g.property({readOnly:!0})],n.prototype,"compatibleTileInfo512",void 0),d([g.reader("compatibleTileInfo512",["tileInfo"])],n.prototype,"readCompatibleTileInfo512",null),n=d([g.subclass("esri.layers.VectorTileLayer")],
n)}(g.declared(v,x,y,n,f,w))})},"esri/portal/support/jsonContext":function(){define(["require","exports","../Portal","../../core/urlUtils"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.createForItem=function(b){return{origin:"portal-item",url:d.urlToObject(b.itemUrl),portal:b.portal||h.getDefault()}}})},"esri/layers/support/vectorTileLayerLoader":function(){define("require exports dojo/has dojo/_base/lang ../../core/promiseUtils ../../core/urlUtils ../../config ../../request".split(" "),
function(m,l,h,d,b,g,k,f){function a(a){if(a){var c=g.getOrigin(a);return g.canUseXhr(c)||-1!==v.indexOf(c)||v.push(c),a}}function e(a,b,e){if(null!=b.sources){e&&-1!==e.path.indexOf("root.json")&&(e.path=e.path.substr(0,e.path.indexOf("root.json")),a.styleUrl=e.path);var d=t(b,e),f=b.sprite||null,n=b.glyphs||null,d=e&&e.path||d&&d.url;return d&&(b.sprite&&!g.isAbsolute(b.sprite)&&(f=g.normalize(g.join(d,b.sprite))),b.glyphs&&!g.isAbsolute(b.glyphs)&&(n=g.normalize(g.join(d,b.glyphs)))),a.style=b,
a.spriteUrl=f,a.glyphsUrl=n,q(a,b,e)}return b.hasOwnProperty("tileInfo")?(a.layerDefinition=b,a.serviceUrl=e.path,c(a,b,e)):void 0}function c(c,b,e){if(u&&!b.hasOwnProperty("defaultStyles"))throw Error("Service definition must have 'defaultStyles' element!");b=b.defaultStyles;return g.isAbsolute(b)?c.styleUrl=g.normalize(b):c.styleUrl=g.normalize(g.join(e.path,b)),a(c.styleUrl),f(g.join(c.styleUrl,"root.json"),{responseType:"json"}).then(function(a){var b=a.data.sprite||null,e=a.data.glyphs||null;
return b&&!g.isAbsolute(b)&&(b=g.normalize(g.join(c.styleUrl,b))),e&&!g.isAbsolute(e)&&(e=g.normalize(g.join(c.styleUrl,e))),c.spriteUrl=b,c.glyphsUrl=e,c.style=a.data,a.data})}function q(c,e,d){e=t(e,d);return e||b.reject("Source isn't available in the syle object!"),e.url?(c.serviceUrl=e.url,g.isAbsolute(c.serviceUrl)||(c.serviceUrl=g.join(d.path,c.serviceUrl)),a(c.serviceUrl),f(c.serviceUrl,{query:{f:"json"},responseType:"json"}).then(function(a){return c.layerDefinition=r(a.data),c})):(c.layerDefinition=
r(e),b.resolve(c))}function t(a,c){if(!a.sources)return null;var b=a.sources;a=null;if(b.esri){if(a=b.esri,c&&a.url&&!g.isAbsolute(a.url))b=c.path.substring(0,c.path.lastIndexOf("/")),a.url=g.join(b,a.url)}else{for(var e=0,d=Object.keys(b);e<d.length;e++)if(c=d[e],-1!==c.toLocaleLowerCase().indexOf("street")&&"vector"===a.type){a=b[c];break}if(!a)for(e=0,d=Object.keys(b);e<d.length&&(c=d[e],a=b[c],"vector"!==a.type);e++);}return a}function r(c){if(c.hasOwnProperty("tileInfo"))return c;for(var b={xmin:-2.0037507067161843E7,
ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},e=(b.xmax-b.xmin)/512,d=[],f=c.hasOwnProperty("minzoom")?parseFloat(c.minzoom):0,g=c.hasOwnProperty("maxzoom")?parseFloat(c.maxzoom):16;g>f;f++){var k=e/Math.pow(2,f);d.push({level:f,scale:Math.floor(3779.527559055118*k),resolution:k})}return c.tiles.forEach(a),{capabilities:"TilesOnly",initialExtent:b,fullExtent:b,minScale:d[0].scale,maxScale:d[d.length-1].scale,tiles:c.tiles,tileInfo:{rows:512,
cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:d,spatialReference:{wkid:102100}}}}Object.defineProperty(l,"__esModule",{value:!0});var u=h("dojo-debug-messages"),v=k.defaults&&k.defaults.io.corsEnabledServers||k.request.corsEnabledServers;l.loadMetadata=function(c){if(!c)return b.reject("invalid input URL!");var k={layerDefinition:null,parsedUrl:null,serviceUrl:null,style:null,styleUrl:null,url:null,spriteUrl:null,glyphsUrl:null};if("string"!=typeof c)return e(k,
c,null).then(function(){return k});c=k.url=g.normalize(c);var n=k.parsedUrl=g.urlToObject(c);return a(c),f(n.path,{responseType:"json",query:d.mixin({f:"json"},n.query)}).then(function(a){return e(k,a.data,n)}).then(function(){return k})}})},"esri/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","./StyleLayer","dojo/has"],function(m,l,h,d){return function(){function b(g,k){if(this.styleJSON=g,this.version=parseFloat(g.version),this.sprite=k?k.spriteUrl:g.sprite,this.glyphs=
k?k.glyphsUrl:g.glyphs,d("stable-symbol-rendering")){var f=(g.layers||[]).filter(function(a){return a.layout&&a.layout["text-font"]})[0];f&&(g.layers||[]).forEach(function(a){a.layout&&a.layout["text-font"]&&(a.layout["text-font"]=f.layout["text-font"])})}this.layers=(g.layers||[]).map(b._create);this._identifyRefLayers()}return b.prototype._identifyRefLayers=function(){for(var b=[],d=[],f=0,a=0,e=this.layers;a<e.length;a++){var c=e[a];if(1===c.type){var q=c,h=c.sourceLayer,h=h+("|"+JSON.stringify(c.minzoom)),
h=h+("|"+JSON.stringify(c.maxzoom)),h=h+("|"+JSON.stringify(c.filter));(q.hasDataDrivenFill||q.hasDataDrivenOutline)&&(h+="|"+JSON.stringify(f));b.push({key:h,layer:c})}2===c.type&&(q=c,h=c.sourceLayer,h+="|"+JSON.stringify(c.minzoom),h+="|"+JSON.stringify(c.maxzoom),h+="|"+JSON.stringify(c.filter),h+="|"+JSON.stringify(c.layout&&c.layout["line-cap"]),h+="|"+JSON.stringify(c.layout&&c.layout["line-join"]),q.hasDataDrivenLine&&(h+="|"+JSON.stringify(f)),d.push({key:h,layer:c}));++f}this._assignRefLayers(b);
this._assignRefLayers(d)},b.prototype._assignRefLayers=function(b){b.sort(function(a,c){return a.key<c.key?-1:a.key>c.key?1:0});for(var d,f,a=b.length,e=0;a>e;e++){var c=b[e];if(c.key===d)c.layer.refLayerId=f;else if(d=c.key,f=c.layer.id,1===c.layer.type&&!c.layer.getPaintProperty("fill-outline-color"))for(var g=e+1;a>g;g++){var h=b[g];if(h.key!==d)break;if(h.layer.getPaintProperty("fill-outline-color")){b[e]=h;b[g]=c;f=h.layer.id;break}}}},b._create=function(b,d,f){d=1-1/(f.length+1)*(1+d);switch(b.type){case "background":return new h.BackgroundStyleLayer(0,
b,d);case "fill":return new h.FillStyleLayer(1,b,d);case "line":return new h.LineStyleLayer(2,b,d);case "symbol":return new h.SymbolStyleLayer(3,b,d);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":throw Error("Unsupported vector tile circle layer");}throw Error("Unknown vector tile layer");},b}()})},"esri/views/vectorTiles/style/StyleLayer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./StyleDefinition ./StyleProperty ./Filter".split(" "),
function(m,l,h,d,b,g,k){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function d(a,e,c){switch(this.type=a,this.id=e.id,this.source=e.source,this.sourceLayer=e["source-layer"],this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this.filter=e.filter,this.layout=e.layout,this.paint=e.paint,this.z=c,a){case 0:this._layoutDefinition=b.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=b.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=b.StyleDefinition.fillLayoutDefinition;
this._paintDefinition=b.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=b.StyleDefinition.lineLayoutDefinition;this._paintDefinition=b.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=b.StyleDefinition.symbolLayoutDefinition,this._paintDefinition=b.StyleDefinition.symbolPaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}return d.prototype.getFeatureFilter=function(){return void 0!==
this._featureFilter?this._featureFilter:this._featureFilter=k.createFilter(this.filter)},d.prototype.getLayoutProperty=function(a){var b=this._layoutProperties;return b?b[a]:void 0},d.prototype.getPaintProperty=function(a){var b=this._paintProperties;return b?b[a]:void 0},d.prototype.getLayoutValue=function(a,b,c){var e,d=this._layoutProperties;d&&(d=d[a])&&(e=d.getValue(b,c));a=this._layoutDefinition[a];return void 0===e&&(e=a["default"]),"enum"===a.type&&(e=a.values.indexOf(e)),e},d.prototype.getPaintValue=
function(a,b,c){var e,d=this._paintProperties;d&&(d=d[a])&&(e=d.getValue(b,c));a=this._paintDefinition[a];return void 0===e&&(e=a["default"]),"enum"===a.type&&(e=a.values.indexOf(e)),e},d.prototype._parseLayout=function(a){var b={},c;for(c in a){var d=this._layoutDefinition[c];d&&(b[c]=new g(c,d,a[c]))}return b},d.prototype._parsePaint=function(a){var b={},c;for(c in a){var d=this._paintDefinition[c];d&&(b[c]=new g(c,d,a[c]))}return b},d}();l.StyleLayer=m;d=function(b){function a(a,c,d){return b.call(this,
a,c,d)||this}return h(a,b),a}(m);l.BackgroundStyleLayer=d;d=function(b){function a(a,c,d){a=b.call(this,a,c,d)||this;a.hasDataDrivenFill=!1;(c=a.getPaintProperty("fill-color"))&&c.isDataDriven&&(a.hasDataDrivenFill=!0);(d=a.getPaintProperty("fill-opacity"))&&d.isDataDriven&&(a.hasDataDrivenFill=!0);a.hasDataDrivenOutline=!1;d=a.getPaintProperty("fill-outline-color");return d&&d.isDataDriven&&(a.hasDataDrivenOutline=!0),d||c&&c.isDataDriven&&(a.hasDataDrivenOutline=!0),a}return h(a,b),a}(m);l.FillStyleLayer=
d;d=function(b){function a(a,c,d){a=b.call(this,a,c,d)||this;a.hasDataDrivenLine=!1;(c=a.getPaintProperty("line-color"))&&c.isDataDriven&&(a.hasDataDrivenLine=!0);(c=a.getPaintProperty("line-opacity"))&&c.isDataDriven&&(a.hasDataDrivenLine=!0);c=a.getPaintProperty("line-width");return c&&c.isDataDriven&&(a.hasDataDrivenLine=!0),a}return h(a,b),a}(m);l.LineStyleLayer=d;m=function(b){function a(a,c,d){a=b.call(this,a,c,d)||this;a.hasDataDrivenIcon=!1;(c=a.getPaintProperty("icon-color"))&&c.isDataDriven&&
(a.hasDataDrivenIcon=!0);(c=a.getPaintProperty("icon-opacity"))&&c.isDataDriven&&(a.hasDataDrivenIcon=!0);(c=a.getLayoutProperty("icon-size"))&&c.isDataDriven&&(a.hasDataDrivenIcon=!0);a.hasDataDrivenText=!1;(c=a.getPaintProperty("text-color"))&&c.isDataDriven&&(a.hasDataDrivenText=!0);(c=a.getPaintProperty("text-opacity"))&&c.isDataDriven&&(a.hasDataDrivenText=!0);c=a.getLayoutProperty("text-size");return c&&c.isDataDriven&&(a.hasDataDrivenText=!0),a}return h(a,b),a}(m);l.SymbolStyleLayer=m;m=function(){return function(b,
a,e){this.cap=b.getLayoutValue("line-cap",a,e);this.join=b.getLayoutValue("line-join",a,e);this.miterLimit=b.getLayoutValue("line-miter-limit",a,e);this.roundLimit=b.getLayoutValue("line-round-limit",a,e)}}();l.LineLayout=m;m=function(){return function(b,a,e,c){this.allowOverlap=b.getLayoutValue("icon-allow-overlap",a,c);this.ignorePlacement=b.getLayoutValue("icon-ignore-placement",a,c);this.optional=b.getLayoutValue("icon-optional",a,c);this.rotationAlignment=b.getLayoutValue("icon-rotation-alignment",
a,c);this.size=b.getLayoutValue("icon-size",a,c);this.rotate=b.getLayoutValue("icon-rotate",a,c);this.padding=b.getLayoutValue("icon-padding",a,c);this.keepUpright=b.getLayoutValue("icon-keep-upright",a,c);this.offset=b.getLayoutValue("icon-offset",a,c);2===this.rotationAlignment&&(this.rotationAlignment=e?0:1)}}();l.IconLayout=m;m=function(){return function(b,a,e,c){this.allowOverlap=b.getLayoutValue("text-allow-overlap",a,c);this.ignorePlacement=b.getLayoutValue("text-ignore-placement",a,c);this.optional=
b.getLayoutValue("text-optional",a,c);this.rotationAlignment=b.getLayoutValue("text-rotation-alignment",a,c);this.fontArray=b.getLayoutValue("text-font",a,c);this.maxWidth=b.getLayoutValue("text-max-width",a,c);this.lineHeight=b.getLayoutValue("text-line-height",a,c);this.letterSpacing=b.getLayoutValue("text-letter-spacing",a,c);this.justify=b.getLayoutValue("text-justify",a,c);this.anchor=b.getLayoutValue("text-anchor",a,c);this.maxAngle=b.getLayoutValue("text-max-angle",a,c);this.size=b.getLayoutValue("text-size",
a,c);this.rotate=b.getLayoutValue("text-rotate",a,c);this.padding=b.getLayoutValue("text-padding",a,c);this.keepUpright=b.getLayoutValue("text-keep-upright",a,c);this.transform=b.getLayoutValue("text-transform",a,c);this.offset=b.getLayoutValue("text-offset",a,c);2===this.rotationAlignment&&(this.rotationAlignment=e?0:1)}}();l.TextLayout=m})},"esri/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function h(){}
return h.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}},h.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}},h.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"line-cap":{type:"enum",values:["butt","round","square"],"default":"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],"default":"miter"},"line-miter-limit":{type:"number","default":2},"line-round-limit":{type:"number",
"default":1.05}},h.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"symbol-placement":{type:"enum",values:["point","line"],"default":"point"},"symbol-spacing":{type:"number",minimum:1,"default":250},"symbol-avoid-edges":{type:"boolean","default":!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean","default":!1},"icon-ignore-placement":{type:"boolean","default":!1},"icon-optional":{type:"boolean","default":!1},"icon-rotation-alignment":{type:"enum",
values:["map","viewport","auto"],"default":"auto"},"icon-size":{type:"number",minimum:0,"default":1},"icon-rotate":{type:"number","default":0},"icon-padding":{type:"number",minimum:0,"default":2},"icon-keep-upright":{type:"boolean","default":!1},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],"default":"auto"},"text-font":{type:"array",value:"string","default":["Open Sans Regular",
"Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,"default":16},"text-max-width":{type:"number",minimum:0,"default":10},"text-line-height":{type:"number","default":1.2},"text-letter-spacing":{type:"number","default":0},"text-justify":{type:"enum",values:["left","center","right"],"default":"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),"default":"center"},"text-max-angle":{type:"number",minimum:0,"default":45},
"text-rotate":{type:"number","default":0},"text-padding":{type:"number",minimum:0,"default":2},"text-keep-upright":{type:"boolean","default":!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],"default":"none"},"text-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-allow-overlap":{type:"boolean","default":!1},"text-ignore-placement":{type:"boolean","default":!1},"text-optional":{type:"boolean","default":!1}},h.backgroundPaintDefinition={"background-opacity":{type:"number",
minimum:0,maximum:1,"default":1},"background-color":{type:"color","default":[0,0,0,1]},"background-pattern":{type:"string"}},h.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,"default":1},"fill-antialias":{type:"boolean","default":!0},"fill-color":{type:"color","default":[0,0,0,1]},"fill-outline-color":{type:"color","default":[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},
"fill-pattern":{type:"string"}},h.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,"default":1},"line-color":{type:"color","default":[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"line-width":{type:"number",minimum:0,"default":1},"line-gap-width":{type:"number",minimum:0,"default":0},"line-offset":{type:"number","default":0},"line-blur":{type:"number",minimum:0,
"default":0},"line-dasharray":{type:"array",value:"number","default":[]},"line-pattern":{type:"string"}},h.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,"default":1},"icon-color":{type:"color","default":[0,0,0,1]},"icon-halo-color":{type:"color","default":[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,"default":0},"icon-halo-blur":{type:"number",minimum:0,"default":0},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0]},"icon-translate-anchor":{type:"enum",
values:["map","viewport"],"default":"map"},"text-opacity":{type:"number",minimum:0,maximum:1,"default":1},"text-color":{type:"color","default":[0,0,0,1]},"text-halo-color":{type:"color","default":[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,"default":0},"text-halo-blur":{type:"number",minimum:0,"default":0},"text-translate":{type:"array",value:"number",length:2,"default":[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}},h.rasterPaintDefinition={"raster-opacity":{type:"number",
minimum:0,maximum:1,"default":1},"raster-hue-rotate":{type:"number","default":0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,"default":0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,"default":1},"raster-saturation":{type:"number",minimum:-1,maximum:1,"default":0},"raster-contrast":{type:"number",minimum:-1,maximum:1,"default":0},"raster-fade-duration":{type:"number",minimum:0,"default":300}},h.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,
"default":1},"circle-radius":{type:"number",minimum:0,"default":5},"circle-color":{type:"color","default":[0,0,0,1]},"circle-blur":{type:"number",minimum:0,"default":0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}},h}();l.StyleDefinition=m})},"esri/views/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../Color","../GeometryUtils"],function(m,l,h,d){return function(){function b(d,
k,f){this.isDataDriven=!1;switch(k.type){case "number":d=!0;break;case "color":d=!0;f=b._parseColor(f);break;case "array":d="number"===k.value;break;default:d=!1}var a=f.stops&&0<f.stops.length;if(this.isDataDriven=!!f.property,this.isDataDriven)if(a)switch(f.type){case "identity":this.getValue=this._buildIdentity(f,k);break;case "categorical":this.getValue=this._buildCategorical(f,k);break;default:d&&"interval"===f.type&&(d=!1),d?this.getValue=this._buildInterpolate(f,k):this.getValue=this._buildInterval(f,
k)}else this.getValue=this._buildIdentity(f,k);else a?d?this.getValue=this._buildZoomInterpolate(f):this.getValue=this._buildZoomInterval(f):this.getValue=this._buildSimple(f)}return b.prototype._buildSimple=function(b){return function(){return b}},b.prototype._buildIdentity=function(d,k){return function(f,a){var e;return a&&(e=a.values[d.property],"color"===k.type&&(e=b._parseColor(e))),void 0!==e?e:void 0!==d["default"]?d["default"]:k["default"]}},b.prototype._buildCategorical=function(b,d){var f=
this;return function(a,e){var c;return e&&(c=e.values[b.property]),c=f._categorical(c,b.stops),void 0!==c?c:void 0!==b["default"]?b["default"]:d["default"]}},b.prototype._buildInterval=function(b,d){var f=this;return function(a,e){var c;return e&&(c=e.values[b.property]),"number"==typeof c?f._interval(c,b.stops):void 0!==b["default"]?b["default"]:d["default"]}},b.prototype._buildInterpolate=function(b,d){var f=this;return function(a,e){var c;return e&&(c=e.values[b.property]),"number"==typeof c?f._interpolate(c,
b.stops,b.base||1):void 0!==b["default"]?b["default"]:d["default"]}},b.prototype._buildZoomInterpolate=function(b){var d=this;return function(f){return d._interpolate(f,b.stops,b.base||1)}},b.prototype._buildZoomInterval=function(b){var d=this;return function(f){return d._interval(f,b.stops)}},b.prototype._categorical=function(b,d){for(var f=d.length,a=0;f>a;a++)if(d[a][0]===b)return d[a][1]},b.prototype._interval=function(b,d){for(var f=d.length,a=0,e=0;f>e&&d[e][0]<=b;e++)a=e;return d[a][1]},b.prototype._interpolate=
function(b,k,f){for(var a,e,c=k.length,g=0;c>g;g++){var h=k[g];if(!(h[0]<=b)){e=h;break}a=h}if(a&&e){g=e[0]-a[0];b-=a[0];f=1===f?b/g:(Math.pow(f,b)-1)/(Math.pow(f,g)-1);if(Array.isArray(a[1])){a=a[1];e=e[1];b=[];for(g=0;g<a.length;g++)b.push(d.interpolate(a[g],e[g],f));return b}return d.interpolate(a[1],e[1],f)}return a?a[1]:e?e[1]:void 0},b._isEmpty=function(b){for(var d in b)if(b.hasOwnProperty(d))return!1;return!0},b._parseColor=function(d){if(Array.isArray(d))return d;if("string"!=typeof d)return d&&
d["default"]&&(d["default"]=b._parseColor(d["default"])),d&&d.stops&&(d.stops=d.stops.map(function(d){return[d[0],b._parseColor(d[1])]})),d;d=new h(d);if(!this._isEmpty(d))return h.toUnitRGBA(d)},b}()})},"esri/Color":function(){define(["./core/declare","dojo/colors"],function(m,l){function h(b){return Math.max(0,Math.min(Math.round(b),255))}var d=m([l],{declaredClass:"esri.Color",toJSON:function(){return[h(this.r),h(this.g),h(this.b),1<this.a?this.a:h(255*this.a)]},clone:function(){return new d(this.toRgba())}});
d.toJSON=function(b){return b&&[h(b.r),h(b.g),h(b.b),1<b.a?b.a:h(255*b.a)]};d.fromJSON=function(b){return b&&new d([b[0],b[1],b[2],b[3]/255])};d.toUnitRGB=function(b){return[b.r/255,b.g/255,b.b/255]};d.toUnitRGBA=function(b){return[b.r/255,b.g/255,b.b/255,null!=b.a?b.a:1]};var b="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(m=0;m<b.length;m++)d[b[m]]=l[b[m]];return d.named.rebeccapurple=[102,51,153],d})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color",
"./_base/array"],function(m,l,h,d){var b={};l.setObject("dojo.colors",b);var g=function(b,a,e){0>e&&++e;1<e&&--e;var c=6*e;return 1>c?b+(a-b)*c:1>2*e?a:2>3*e?b+(a-b)*(2/3-e)*6:b};m.colorFromRgb=h.fromRgb=function(b,a){var e=b.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(e){b=e[2].split(/\s*,\s*/);var c=b.length,e=e[1];if("rgb"==e&&3==c||"rgba"==e&&4==c)return e=b[0],"%"==e.charAt(e.length-1)?(e=d.map(b,function(a){return 2.56*parseFloat(a)}),4==c&&(e[3]=b[3]),h.fromArray(e,a)):h.fromArray(b,
a);if("hsl"==e&&3==c||"hsla"==e&&4==c){var e=(parseFloat(b[0])%360+360)%360/360,f=parseFloat(b[1])/100,k=parseFloat(b[2])/100,f=.5>=k?k*(f+1):k+f-k*f,k=2*k-f,e=[256*g(k,f,e+1/3),256*g(k,f,e),256*g(k,f,e-1/3),1];4==c&&(e[3]=b[3]);return h.fromArray(e,a)}}return null};var k=function(b,a,e){b=Number(b);return isNaN(b)?e:b<a?a:b>e?e:b};h.prototype.sanitize=function(){this.r=Math.round(k(this.r,0,255));this.g=Math.round(k(this.g,0,255));this.b=Math.round(k(this.b,0,255));this.a=k(this.a,0,1);return this};
b.makeGrey=h.makeGrey=function(b,a){return h.fromArray([b,b,b,a])};l.mixin(h.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,
0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,
105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],
lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,
85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,
112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,
191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return h})},"esri/views/vectorTiles/style/Filter":function(){define(["require","exports"],function(m,l){return function(){function h(d,b,g){this._op=d;"$type"===b?(g instanceof Array?this._val=g.map(function(b){return h._types.indexOf(b)}):this._val=h._types.indexOf(g),this._op+=11):(this._key=b,this._val=g)}return h.prototype.filter=function(d){switch(this._op){case 0:return this._val;
case 1:return d.values[this._key]===this._val;case 2:return d.values[this._key]!==this._val;case 3:return d.values[this._key]<this._val;case 4:return d.values[this._key]>this._val;case 5:return d.values[this._key]<=this._val;case 6:return d.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(d.values[this._key]);case 8:return-1===this._val.indexOf(d.values[this._key]);case 9:for(var b=0,g=this._val;b<g.length;b++){var k=g[b];if(k.filter(d))return!0}return!1;case 10:b=0;for(g=this._val;b<
g.length;b++)if(k=g[b],!k.filter(d))return!1;return!0;case 11:b=0;for(g=this._val;b<g.length;b++)if(k=g[b],k.filter(d))return!1;return!0;case 12:return d.type===this._val;case 13:return d.type!==this._val;case 14:return d.type<this._val;case 15:return d.type>this._val;case 16:return d.type>=this._val;case 17:return d.type<=this._val;case 18:return-1!==this._val.indexOf(d.type);case 19:return-1===this._val.indexOf(d.type)}},h.createFilter=function(d){if(!d)return new h(0,void 0,!0);var b=d[0];if(1>=
d.length)return new h(0,void 0,"any"!==b);switch(b){case "\x3d\x3d":return new h(1,d[1],d[2]);case "!\x3d":return new h(2,d[1],d[2]);case "\x3e":return new h(4,d[1],d[2]);case "\x3c":return new h(3,d[1],d[2]);case "\x3e\x3d":return new h(6,d[1],d[2]);case "\x3c\x3d":return new h(5,d[1],d[2]);case "in":return new h(7,d[1],d.slice(2));case "!in":return new h(8,d[1],d.slice(2));case "any":return new h(9,void 0,d.slice(1).map(h.createFilter.bind(this)));case "all":return new h(10,void 0,d.slice(1).map(h.createFilter.bind(this)));
case "none":return new h(11,void 0,d.slice(1).map(h.createFilter.bind(this)));default:throw Error("invalid operator: "+b);}},h._types=["Unknown","Point","LineString","Polygon"],h}()})},"esri/layers/WMTSLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators dojo/_base/lang ../request ../core/Error ../core/HandleRegistry ../core/Collection ../core/promiseUtils ../geometry/Extent ./Layer ./WebTileLayer ./mixins/OperationalLayer ./mixins/PortalLayer ./support/WMTSSublayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./support/wmtsUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w){function z(a,c){return a.map(function(a){var b=new x;return b.read(a,c),b})}var C={"image/png":".png","image/png8":".png","image/png24":".png","image/png32":".png","image/jpg":".jpg","image/jpeg":".jpeg","image/gif":".gif","image/bmp":".bmp","image/tiff":".tif","image/jpgpng":"","image/jpegpng":"","image/unknown":""};return function(n){function t(c,b){var e=n.call(this)||this;return e._sublayersHandles=new a,e.copyright=null,e.customParameters=null,
e.customLayerParameters=null,e.fullExtent=null,e.operationalLayerType="WebTiledLayer",e.resourceInfo=null,e.serviceMode="RESTful",e.sublayers=null,e.type="wmts",e.version="1.0.0",e.watch("activeLayer",function(a,c){c&&(c.layer=null);a&&(a.layer=e)},!0),e.watch("sublayers",function(c,b){b&&(b.forEach(function(a){a.layer=null}),e._sublayersHandles.removeAll(),e._sublayersHandles=null);c&&(c.forEach(function(a){a.layer=e}),e._sublayersHandles||(e._sublayersHandles=new a),e._sublayersHandles.add([c.on("after-add",
function(a){a.item.layer=e}),c.on("after-remove",function(a){a.item.layer=null})]))},!0),e}return h(t,n),t.prototype.normalizeCtorArgs=function(a,c){return"string"==typeof a?g.mixin({},{url:a},c):a},t.prototype.load=function(){var a=this;return"KVP"!==this.serviceMode&&"RESTful"!==this.serviceMode?void console.error("WMTS mode could only be 'KVP' or 'RESTful'"):(this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WMTS"]}).then(function(){return a._fetchService()}).otherwise(function(){return c.reject(new f("wmtslayer:unsupported-service-data",
"Invalid response from the WMTS service."))})),this.when())},Object.defineProperty(t.prototype,"activeLayer",{get:function(){return this._get("activeLayer")},set:function(a){this._set("activeLayer",a)},enumerable:!0,configurable:!0}),t.prototype.readActiveLayerFromService=function(a,c,b){var e,d=this;return this.activeLayer?c.layers.some(function(a){return a.id===d.activeLayer.id?(e=a,!0):!1}):(this.activeLayer=new x,e=c.layers[0]),this.activeLayer.read(e,b),this.activeLayer},t.prototype.readActiveLayerFromItemOrWebDoc=
function(a,c,b){return new x({id:c.wmtsInfo.layerIdentifier,tileMatrixSetId:c.wmtsInfo.tileMatrixSet})},t.prototype.writeActiveLayer=function(a,c){a=this.activeLayer;c.templateUrl=this.getUrlTemplate(a.id,a.tileMatrixSetId,a.imageFormat,a.styleId);c.wmtsInfo=g.mixin(c.wmtsInfo||{},{layerIdentifier:a.id,tileMatrixSet:a.tileMatrixSetId})},Object.defineProperty(t.prototype,"fullExtents",{get:function(){var a=[];return this.activeLayer.tileMatrixSets.forEach(function(c){c.fullExtent&&a.push(c.fullExtent)}),
a},enumerable:!0,configurable:!0}),t.prototype.readServiceMode=function(a,c,b){return-1<c.templateUrl.indexOf("?")?"KVP":"RESTful"},t.prototype.readSublayersFromService=function(a,c,b){return z(c.layers,b)},Object.defineProperty(t.prototype,"supportedSpatialReferences",{get:function(){return this.activeLayer.tileMatrixSets.map(function(a){return a.tileInfo.spatialReference}).toArray()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return"Layer"===this._get("title")?
this.activeLayer&&this.activeLayer.title:this._get("title")},set:function(a){this._set("title",a)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._get("url")},set:function(a){a&&"/"===a.substr(-1)?this._set("url",a.slice(0,-1)):this._set("url",a)},enumerable:!0,configurable:!0}),t.prototype.createWebTileLayer=function(a){var c=this.getUrlTemplate(this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId),
b=this._getTileMatrixSetById(a.tileMatrixSetId).tileInfo,e=a.fullExtent;a={layerIdentifier:a.id,tileMatrixSet:a.tileMatrixSetId,url:this.url};return this.customLayerParameters&&(a.customLayerParameters=this.customLayerParameters),this.customParameters&&(a.customParameters=this.customParameters),new r({fullExtent:e,urlTemplate:c,tileInfo:b,wmtsInfo:a})},t.prototype.fetchTile=function(a,c,b){a=this.getTileUrl(a,c,b);return k(a,{responseType:"image"}).then(function(a){return a.data})},t.prototype.findSublayerById=
function(a){return this.sublayers.find(function(c){return c.id===a})},t.prototype.getTileUrl=function(a,c,b){var e=this._getTileMatrixSetById(this.activeLayer.tileMatrixSetId).tileInfo.lods[a],e=e.levelValue?e.levelValue:String(e.level);(a=this.resourceInfo?"":w.getTileUrlFromResourceUrls(this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.styleId,a,c,b))||(a=this.getUrlTemplate(this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId).replace(/\{level\}/gi,
e).replace(/\{row\}/gi,c).replace(/\{col\}/gi,b));return a=this._appendCustomLayerParameters(a)},t.prototype.getUrlTemplate=function(a,c,b,e){var d="";if(!this.resourceInfo&&(d=w.getTileUrlTemplateFromResourceUrls(a,c,b,e)))return d;"KVP"===this.serviceMode?d=this.url+"?SERVICE\x3dWMTS\x26VERSION\x3d"+this.version+"\x26REQUEST\x3dGetTile\x26LAYER\x3d"+a+"\x26STYLE\x3d"+e+"\x26FORMAT\x3d"+b+"\x26TILEMATRIXSET\x3d"+c+"\x26TILEMATRIX\x3d{level}\x26TILEROW\x3d{row}\x26TILECOL\x3d{col}":"RESTful"===this.serviceMode&&
(d="",C[b.toLowerCase()]&&(d=C[b.toLowerCase()]),d=this.url+a+"/"+e+"/"+c+"/{level}/{row}/{col}"+d);return d},t.prototype._fetchService=function(){var a=this;return c.resolve().then(function(){if(a.resourceInfo)return"KVP"===a.resourceInfo.serviceMode&&(a.url+=-1<a.url.indexOf("?")?"":"?"),{ssl:!1,data:a.resourceInfo};var c=a._getCapabilitiesUrl(a.serviceMode);return k(c,{responseType:"text",callbackParamName:"callback"}).otherwise(function(b){return c=a._getCapabilitiesUrl("KVP"===a.serviceMode?
"RESTful":"KVP"),k(c,{responseType:"text",callbackParamName:"callback"})})}).then(function(c){a.resourceInfo?c.data=w.parseResourceInfo(c.data):c.data=w.parseCapabilities(c.data,{serviceMode:a.serviceMode});c.data&&a.read(c.data,{origin:"service"})})},t.prototype._getTileMatrixSetById=function(a){return this.findSublayerById(this.activeLayer.id).tileMatrixSets.find(function(c){return c.id===a})},t.prototype._appendCustomParameters=function(a){if(this.customParameters)for(var c in this.customParameters)a+=
(-1===a.indexOf("?")?"?":"\x26")+c+"\x3d"+encodeURIComponent(this.customParameters[c]);return a},t.prototype._appendCustomLayerParameters=function(a){if(this.customLayerParameters||this.customParameters){var c=g.clone(this.customParameters||{});g.mixin(c,this.customLayerParameters||{});for(var b in c)a+=(-1===a.indexOf("?")?"?":"\x26")+b+"\x3d"+encodeURIComponent(c[b])}return a},t.prototype._getCapabilitiesUrl=function(a){var c;return this.url=this.url.split("?")[0],"KVP"===a?c=this.url+"?request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+
this.version:"RESTful"===a&&(c=this.url+"/"+this.version+"/WMTSCapabilities.xml"),c=this._appendCustomParameters(c)},d([b.shared({"2d":"../views/2d/layers/WMTSLayerView2D","3d":"../views/3d/layers/WMTSLayerView3D"})],t.prototype,"viewModulePaths",void 0),d([b.property({type:x,dependsOn:["sublayers"],json:{origins:{"web-document":{write:{ignoreOrigin:!0}}}}})],t.prototype,"activeLayer",null),d([b.reader("service","activeLayer",["layers"])],t.prototype,"readActiveLayerFromService",null),d([b.reader(["web-document",
"portal-item"],"activeLayer",["wmtsInfo"])],t.prototype,"readActiveLayerFromItemOrWebDoc",null),d([b.writer(["web-document","portal-item"],"activeLayer")],t.prototype,"writeActiveLayer",null),d([b.property()],t.prototype,"copyright",void 0),d([b.property({json:{origins:{"web-document":{read:{source:"wmtsInfo.customParameters"},write:{target:"wmtsInfo.customParameters"}},"portal-item":{read:{source:"wmtsInfo.customParameters"},write:{target:"wmtsInfo.customParameters"}}}}})],t.prototype,"customParameters",
void 0),d([b.property({json:{origins:{"web-document":{read:{source:"wmtsInfo.customLayerParameters"},write:{target:"wmtsInfo.customLayerParameters"}},"portal-item":{read:{source:"wmtsInfo.customLayerParameters"},write:{target:"wmtsInfo.customLayerParameters"}}}}})],t.prototype,"customLayerParameters",void 0),d([b.property({type:q,json:{write:{ignoreOrigin:!0},origins:{"web-document":{read:{source:"fullExtent"}},"portal-item":{read:{source:"fullExtent"}}}}})],t.prototype,"fullExtent",void 0),d([b.property({readOnly:!0,
dependsOn:["activeLayer"]})],t.prototype,"fullExtents",null),d([b.property()],t.prototype,"operationalLayerType",void 0),d([b.property()],t.prototype,"resourceInfo",void 0),d([b.property()],t.prototype,"serviceMode",void 0),d([b.reader(["portal-item","web-document"],"serviceMode",["templateUrl"])],t.prototype,"readServiceMode",null),d([b.property({type:e.ofType(x)})],t.prototype,"sublayers",void 0),d([b.reader("service","sublayers",["layers"])],t.prototype,"readSublayersFromService",null),d([b.property({readOnly:!0,
dependsOn:["activeLayer"]})],t.prototype,"supportedSpatialReferences",null),d([b.property({dependsOn:["activeLayer"],json:{read:{source:"title"}}})],t.prototype,"title",null),d([b.property({json:{read:!1},readOnly:!0,value:"wmts"})],t.prototype,"type",void 0),d([b.property({json:{origins:{service:{read:{source:"tileUrl"}},"web-document":{read:{source:"wmtsInfo.url"},write:{target:"wmtsInfo.url"}},"portal-item":{read:{source:"wmtsInfo.url"},write:{target:"wmtsInfo.url"}}}}})],t.prototype,"url",null),
d([b.property()],t.prototype,"version",void 0),t=d([b.subclass("esri.layers.WMTSLayer")],t)}(b.declared(t,u,v,y,n))})},"esri/layers/WebTileLayer":function(){define("dojo/_base/lang dojo/_base/url dojo/string ../core/Error ../core/MultiOriginJSONSupport ../core/urlUtils ../geometry/SpatialReference ../geometry/Extent ../geometry/Point ./TiledLayer ./mixins/OperationalLayer ./mixins/ScaleRangeLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./support/TileInfo ./support/LOD".split(" "),function(m,
l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){return e.createSubclass([c,b,q,t,r],{declaredClass:"esri.layers.WebTileLayer",normalizeCtorArgs:function(a,c){return"string"==typeof a?m.mixin({urlTemplate:a},c||{}):a},getDefaults:function(c){var b=new f(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,k.WebMercator);return m.mixin(this.inherited(arguments),{fullExtent:b,tileInfo:new u({size:256,dpi:96,format:"PNG8",compressionQuality:0,origin:new a({x:-2.0037508342787E7,y:2.0037508342787E7,spatialReference:k.WebMercator}),
spatialReference:k.WebMercator,lods:[new v({level:0,scale:5.91657527591555E8,resolution:156543.033928}),new v({level:1,scale:2.95828763795777E8,resolution:78271.5169639999}),new v({level:2,scale:1.47914381897889E8,resolution:39135.7584820001}),new v({level:3,scale:7.3957190948944E7,resolution:19567.8792409999}),new v({level:4,scale:3.6978595474472E7,resolution:9783.93962049996}),new v({level:5,scale:1.8489297737236E7,resolution:4891.96981024998}),new v({level:6,scale:9244648.868618,resolution:2445.98490512499}),
new v({level:7,scale:4622324.434309,resolution:1222.99245256249}),new v({level:8,scale:2311162.217155,resolution:611.49622628138}),new v({level:9,scale:1155581.108577,resolution:305.748113140558}),new v({level:10,scale:577790.554289,resolution:152.874056570411}),new v({level:11,scale:288895.277144,resolution:76.4370282850732}),new v({level:12,scale:144447.638572,resolution:38.2185141425366}),new v({level:13,scale:72223.819286,resolution:19.1092570712683}),new v({level:14,scale:36111.909643,resolution:9.55462853563415}),
new v({level:15,scale:18055.954822,resolution:4.77731426794937}),new v({level:16,scale:9027.977411,resolution:2.38865713397468}),new v({level:17,scale:4513.988705,resolution:1.19432856685505}),new v({level:18,scale:2256.994353,resolution:.597164283559817}),new v({level:19,scale:1128.497176,resolution:.298582141647617})]})})},properties:{copyright:{type:String,value:"",json:{write:!0}},fullExtent:{json:{write:!0}},legendEnabled:{json:{read:{source:["showLegend"],reader:function(a,c){return null!=c.showLegend?
c.showLegend:!0}},write:{target:"showLegend"}}},levelValues:{dependsOn:["tileInfo"],get:function(){var a=[];return this.tileInfo?(this.tileInfo.lods.forEach(function(c){a[c.level]=c.levelValue||c.level},this),a):null}},operationalLayerType:"WebTiledLayer",popupEnabled:{json:{read:{source:["disablePopup"],reader:function(a,c){return null!=c.disablePopup?!c.disablePopup:!0}}}},refreshInterval:{json:{write:!0}},spatialReference:{type:k,value:k.WebMercator,json:{read:{source:["spatialReference","fullExtent.spatialReference"],
reader:function(a,c){return a||c.fullExtent&&c.fullExtent.spatialReference&&k.fromJSON(c.fullExtent.spatialReference)}}}},subDomains:{type:[String],value:null,json:{write:!0}},tileInfo:{type:u,json:{write:!0}},tileServers:{value:null,dependsOn:["urlTemplate","subDomains"],get:function(){if(!this.urlTemplate)return null;var a,c=new l(this.urlTemplate),b=c.scheme?c.scheme+"://":"//",e=b+c.authority+"/",d=this.subDomains,f=[];return-1===c.authority.indexOf("{subDomain}")&&f.push(e),d&&0<d.length&&1<
c.authority.split(".").length&&d.forEach(function(e){-1<c.authority.indexOf("{subDomain}")&&(a=b+c.authority.replace(/\{subDomain\}/gi,e)+"/");f.push(a)},this),f=f.map(function(a){return"/"!==a.charAt(a.length-1)&&(a+="/"),a})}},type:{value:"web-tile",json:{read:!1}},urlPath:{dependsOn:["urlTemplate"],get:function(){if(!this.urlTemplate)return null;var a=this.urlTemplate,c=new l(a);return a.substring(((c.scheme?c.scheme+"://":"//")+c.authority+"/").length)}},urlTemplate:{type:String,json:{origins:{"portal-item":{read:{source:"url"}}},
read:{source:["urlTemplate","templateUrl"],reader:function(a,c){return a||c.templateUrl}},write:{target:"templateUrl",writer:function(a,c,b){a&&g.isProtocolRelative(a)&&(a="https:"+a);c[b]=a?g.normalize(a):a}}}},url:{json:{write:!1}},wmtsInfo:{json:{write:!0}}},getTileUrl:function(a,c,b){a=this.levelValues[a];var e=this.tileServers[c%this.tileServers.length]+h.substitute(this.urlPath,{level:a,col:b,row:c});return e=e.replace(/\{level\}/gi,a).replace(/\{row\}/gi,c).replace(/\{col\}/gi,b)},load:function(){var a=
this.loadFromPortal({supportedTypes:["WMTS"]}).then(function(){if(!this.urlTemplate)throw new d("layer:load","WebTileLayer (title: '"+this.title+"', id: '"+this.id+"') is missing the required 'urlTemplate' property value");}.bind(this));return this.addResolvingPromise(a),this}})})},"esri/layers/support/WMTSSublayer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/paramHelper ../../core/accessorSupport/decorators ../../core/Collection ../../core/JSONSupport ./TileMatrixSet ./WMTSStyle ../../geometry/Extent".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){return function(b){function f(a){a=b.call(this)||this;return a.fullExtent=null,a.imageFormats=null,a.id=null,a.layer=null,a.styles=null,a.tileMatrixSetId=null,a.tileMatrixSets=null,a}return h(f,b),q=f,Object.defineProperty(f.prototype,"description",{get:function(){return this._get("description")},set:function(a){this._set("description",a)},enumerable:!0,configurable:!0}),f.prototype.readFullExtent=function(a,b,e){return a=b.fullExtent,a?c.fromJSON(a):null},Object.defineProperty(f.prototype,
"imageFormat",{get:function(){var a=this._get("imageFormat");return a||(a=this.imageFormats&&this.imageFormats.length?this.imageFormats[0]:""),a},set:function(a){return(-1<a.indexOf("image/")||-1===this.imageFormats.indexOf(a))&&(-1===a.indexOf("image/")&&(a="image/"+a),this.imageFormats&&-1===this.imageFormats.indexOf(a))?void console.error("The layer doesn't support the format of "+a):void this._set("imageFormat",a)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"styleId",{get:function(){var a=
this._get("styleId");return a||(a=this.styles&&this.styles.length?this.styles.getItemAt(0).id:""),a},set:function(a){this._set("styleId",a)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"title",{get:function(){return this._get("title")},set:function(a){this._set("title",a)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"tileMatrixSet",{get:function(){var a=this;return this.tileMatrixSets.find(function(c){return c.id===a.tileMatrixSetId})},enumerable:!0,configurable:!0}),
f.prototype.clone=function(){var a=new q;return this.hasOwnProperty("description")&&(a.description=this.description),this.hasOwnProperty("imageFormats")&&(a.imageFormats=this.imageFormats&&this.imageFormats.slice()),this.hasOwnProperty("imageFormat")&&(a.imageFormat=this.imageFormat),this.hasOwnProperty("fullExtent")&&(a.fullExtent=this.fullExtent&&this.fullExtent.clone()),this.hasOwnProperty("id")&&(a.id=this.id),this.hasOwnProperty("layer")&&(a.layer=this.layer),this.hasOwnProperty("styleId")&&
(a.styleId=this.styleId),this.hasOwnProperty("styles")&&(a.styles=this.styles&&this.styles.clone()),this.hasOwnProperty("tileMatrixSetId")&&(a.tileMatrixSetId=this.tileMatrixSetId),this.hasOwnProperty("tileMatrixSets")&&(a.tileMatrixSets=this.tileMatrixSets.clone()),this.hasOwnProperty("title")&&(a.title=this.title),a},d([g.property()],f.prototype,"description",null),d([g.property()],f.prototype,"fullExtent",void 0),d([g.reader("fullExtent",["fullExtent"])],f.prototype,"readFullExtent",null),d([g.property({dependsOn:["imageFormats"]})],
f.prototype,"imageFormat",null),d([g.property({json:{read:{source:"formats"}}})],f.prototype,"imageFormats",void 0),d([g.property()],f.prototype,"id",void 0),d([g.property()],f.prototype,"layer",void 0),d([g.property()],f.prototype,"styleId",null),d([g.property({type:k.ofType(e),json:{read:{source:"styles"}}})],f.prototype,"styles",void 0),d([g.property({value:null,json:{write:{ignoreOrigin:!0}}})],f.prototype,"title",null),d([g.property()],f.prototype,"tileMatrixSetId",void 0),d([g.property({readOnly:!0,
dependsOn:["tileMatrixSetId"]})],f.prototype,"tileMatrixSet",null),d([g.property({type:k.ofType(a),json:{read:{source:"tileMatrixSets"}}})],f.prototype,"tileMatrixSets",void 0),f=q=d([g.subclass("esri.layers.support.WMTSSublayer")],f);var q}(g.declared(f))})},"esri/layers/support/TileMatrixSet":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/paramHelper ../../core/accessorSupport/decorators ../../core/JSONSupport".split(" "),
function(m,l,h,d,b,g,k){return function(b){function a(a){a=b.call(this)||this;return a.fullExtent=null,a.id=null,a.tileInfo=null,a}return h(a,b),e=a,a.prototype.clone=function(){var a=new e;return this.hasOwnProperty("fullExtent")&&(a.fullExtent=this.fullExtent&&this.fullExtent.clone()),this.hasOwnProperty("id")&&(a.id=this.id),this.hasOwnProperty("tileInfo")&&(a.tileInfo=this.tileInfo&&this.tileInfo.clone()),a},d([g.property({json:{read:{source:"fullExtent"}}})],a.prototype,"fullExtent",void 0),
d([g.property({json:{read:{source:"id"}}})],a.prototype,"id",void 0),d([g.property({json:{read:{source:"tileInfo"}}})],a.prototype,"tileInfo",void 0),a=e=d([g.subclass("esri.layer.support.TileMatrixSet")],a);var e}(g.declared(k))})},"esri/layers/support/WMTSStyle":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/paramHelper ../../core/accessorSupport/decorators ../../core/JSONSupport".split(" "),function(m,l,h,d,
b,g,k){return function(b){function a(a){a=b.call(this)||this;return a.id=null,a.title=null,a.description=null,a.legendUrl=null,a}return h(a,b),e=a,a.prototype.clone=function(){var a=new e;return this.hasOwnProperty("description")&&(a.description=this.description),this.hasOwnProperty("id")&&(a.id=this.id),this.hasOwnProperty("isDefault")&&(a.isDefault=this.isDefault),this.hasOwnProperty("keywords")&&(a.keywords=this.keywords&&this.keywords.slice()),this.hasOwnProperty("legendUrl")&&(a.legendUrl=this.legendUrl),
this.hasOwnProperty("title")&&(a.title=this.title),a},d([g.property({json:{read:{source:"id"}}})],a.prototype,"id",void 0),d([g.property({json:{read:{source:"title"}}})],a.prototype,"title",void 0),d([g.property({json:{read:{source:"abstract"}}})],a.prototype,"description",void 0),d([g.property({json:{read:{source:"legendUrl"}}})],a.prototype,"legendUrl",void 0),d([g.property({json:{read:{source:"isDefault"}}})],a.prototype,"isDefault",void 0),d([g.property({json:{read:{source:"keywords"}}})],a.prototype,
"keywords",void 0),a=e=d([g.subclass("esri.layer.support.WMTSStyle")],a);var e}(g.declared(k))})},"esri/layers/support/wmtsUtils":function(){define("require exports ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/WKIDUnitConversion ./TileInfo ../../core/Error".split(" "),function(m,l,h,d,b,g,k,f){function a(a,c){return(a=c.getElementsByTagName(a))&&0<a.length?a[0]:null}function e(a,c){return Array.prototype.slice.call(c.getElementsByTagName(a)).map(function(a){return a.textContent})}
function c(c,b){return c.split("\x3e").forEach(function(c){b=a(c,b)}),b&&b.textContent}function q(c,b,e,d){var f;return Array.prototype.slice.call(d.childNodes).some(function(d){if(-1<d.nodeName.indexOf(c)){var g=a(b,d),g=g&&g.textContent;return g===e||e.split(":")&&e.split(":")[1]===g?(f=d,!0):!1}}),f}function t(a){var b,d,f,g,n=[],k=F[a],h=Array.prototype.slice.call(k.getElementsByTagName("ResourceURL")),k=k.getElementsByTagName("Dimension");return k.length&&(b=c("Identifier",k[0]),d=e("Default",
k[0])||e("Value",k[0])),1<k.length&&(f=c("Identifier",k[1]),g=e("Default",k[1])||e("Value",k[1])),B[a]={dimensions:d,dimensions2:g},h.forEach(function(a){var c=a.getAttribute("template");if(b&&d.length)if(-1<c.indexOf("{"+b+"}"))c=c.replace("{"+b+"}","{dimensionValue}");else{var e=c.toLowerCase().indexOf("{"+b.toLowerCase()+"}");-1<e&&(c=c.substring(0,e)+"{dimensionValue}"+c.substring(e+b.length+2))}f&&g.length&&(-1<c.indexOf("{"+f+"}")?c=c.replace("{"+f+"}","{dimensionValue2}"):(e=c.toLowerCase().indexOf("{"+
f.toLowerCase()+"}"),-1<e&&(c=c.substring(0,e)+"{dimensionValue2}"+c.substring(e+f.length+2))));n.push({template:c,format:a.getAttribute("fomrat"),resourceType:a.getAttribute("resourceType")})}),n}function r(b){return Array.prototype.slice.call(b.getElementsByTagName("Style")).map(function(b){var d=a("LegendURL",b),f=a("Keywords",b),f=f&&e("Keyword",f);return{"abstract":c("Abstract",b),id:c("Identifier",b),isDefault:"true"===b.getAttribute("isDefault"),keywords:f,legendUrl:d&&d.getAttribute("xlink:href"),
title:c("Title",b)}})}function u(a,c){return e("TileMatrixSet",a).map(function(b){return v(b,a,c)})}function v(b,d,f){d=q("TileMatrixSetLink","TileMatrixSet",b,d);d=e("TileMatrix",d);var g=q("TileMatrixSet","Identifier",b,f);f=x(g);var h=f.spatialReference,w=h.wkid,r=a("TileMatrix",g),r=[parseInt(c("TileWidth",r),10),parseInt(c("TileHeight",r),10)],t=[];d.length?d.forEach(function(a,c){a=q("TileMatrix","Identifier",a,g);t.push(n(a,w,c,b))}):Array.prototype.slice.call(g.getElementsByTagName("TileMatrix")).forEach(function(a,
c){t.push(n(a,w,c,b))});d=y(g,f,r,t[0]);return{id:b,fullExtent:d,tileInfo:new k({dpi:96,spatialReference:h,size:r,origin:f,lods:t})}}function x(e){var f=c("SupportedCRS",e);f&&(f=f.toLowerCase());var g=parseInt(f.split(":").pop(),10);900913!==g&&3857!==g||(g=102100);var n=!1;-1<f.indexOf("crs84")||-1<f.indexOf("crs:84")?(g=4326,n=!0):-1<f.indexOf("crs83")||-1<f.indexOf("crs:83")?(g=4269,n=!0):(-1<f.indexOf("crs27")||-1<f.indexOf("crs:27"))&&(g=4267,n=!0);var k,h=new b({wkid:g});e=a("TileMatrix",e);
var q=c("TopLeftCorner",e).split(" ");e=q[0].split("E").map(function(a){return Number(a)});var q=q[1].split("E").map(function(a){return Number(a)}),w=e[0],r=q[0];1<e.length&&(w=e[0]*Math.pow(10,e[1]));1<q.length&&(r=q[0]*Math.pow(10,q[1]));var H=n&&4326===g&&90===w&&-180===r;return C.some(function(a,c){var b=Number(f.split(":").pop());return b>=a[0]&&b<=a[1]||4326===g&&(!n||H)?(k=new d(r,w,h),!0):(c===C.length-1&&(k=new d(w,r,h)),!1)}),k}function y(b,e,d,f){var g,n,k=a("BoundingBox",b);k&&(g=c("LowerCorner",
k).split(" "),n=c("UpperCorner",k).split(" "));g&&1<g.length&&n&&1<n.length?(b=parseFloat(g[0]),d=parseFloat(g[1]),g=parseFloat(n[0]),n=parseFloat(n[1])):(b=a("TileMatrix",b),g=parseFloat(c("MatrixWidth",b)),k=parseFloat(c("MatrixHeight",b)),b=e.x,n=e.y,g=b+g*d[0]*f.resolution,d=n-k*d[1]*f.resolution);return new h(b,d,g,n,e.spatialReference)}function n(a,b,e,d){var f=c("Identifier",a);a=c("ScaleDenominator",a).split("E").map(function(a){return Number(a)});a=1<a.length?a[0]*Math.pow(10,a[1]):a[0];
b=w(b,a,d);return a*=96/z,{level:e,levelValue:f,scale:a,resolution:b}}function w(a,c,b){var e;return e=g.hasOwnProperty(String(a))?g.values[g[a]]:"default028mm"===b?6370997*Math.PI/180:6378137*Math.PI/180,7*c/25E3/e}Object.defineProperty(l,"__esModule",{value:!0});var z=90.71428571428571,C=[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,
4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,
2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,
5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],B=new Map,F=new Map;l.parseCapabilities=function(b,d){b=b.replace(/ows:/gi,"");b=(new DOMParser).parseFromString(b,"text/xml").documentElement;var g=a("Contents",b);if(!g)throw new f("wmtslayer:wmts-capabilities-xml-is-not-valid");
var n,k,h,w=a("OperationsMetadata",b),w=(w=(w=w&&w.querySelector("[name\x3d'GetTile']"))&&w.getElementsByTagName("Get"))&&Array.prototype.slice.call(w),t=d.serviceMode;(w&&w.length&&w.some(function(c){var b=a("Constraint",c);return!b||q("AllowedValues","Value",t,b)?(k=c.attributes[0].nodeValue,!0):(!b||q("AllowedValues","Value","RESTful",b)||q("AllowedValues","Value","REST",b)?h=c.attributes[0].nodeValue:(!b||q("AllowedValues","Value","KVP",b))&&(n=c.attributes[0].nodeValue),!1)}),k)||(h?(k=h,t="RESTful"):
n?(k=n,t="KVP"):k=a("ServiceMetadataURL",b).getAttribute("xlink:href"));d=k.indexOf("1.0.0/");-1===d&&"RESTful"===t?k+="/":-1<d&&(k=k.substring(0,d));"KVP"===t&&(k+=-1<d?"":"?");d=c("ServiceIdentification\x3eAccessConstraints",b);b=Array.prototype.slice.call(g.getElementsByTagName("Layer")).map(function(b){var d=c("Identifier",b);F[d]=b;var f=c("Abstract",b),n=e("Format",b),E,p=a("WGS84BoundingBox",b);E=p?c("LowerCorner",p).split(" "):["-180","-90"];p=p?c("UpperCorner",p).split(" "):["180","90"];
E={xmin:parseFloat(E[0]),ymin:parseFloat(E[1]),xmax:parseFloat(p[0]),ymax:parseFloat(p[1]),spatialReference:{wkid:4326}};var p=r(b),A=c("Title",b);b=u(b,g);return{id:d,fullExtent:E,description:f,formats:n,styles:p,title:A,tileMatrixSets:b}});return{copyright:d,layers:b,tileUrl:k,serviceMode:t}};l.parseResourceInfo=function(a){return a.layers.forEach(function(a){a.tileMatrixSets.forEach(function(a){var c=a.tileInfo;96!==c.dpi&&(c.lods.forEach(function(b){b.scale=96*b.scale/c.dpi;b.resolution=w(c.spatialReference.wkid,
b.scale*z/96,a.id)}),c.dpi=96)})}),a};l.getTileUrlFromResourceUrls=function(a,c,b,e,d,f){var g=t(a),n=B[a].dimensions&&B[a].dimensions[0];a=B[a].dimensions2&&B[a].dimensions2[0];var k="";return g&&0<g.length&&(k=g[d%g.length].template.replace(/\{Style\}/gi,b).replace(/\{TileMatrixSet\}/gi,c).replace(/\{TileMatrix\}/gi,e).replace(/\{TileRow\}/gi,d).replace(/\{TileCol\}/gi,f).replace(/\{dimensionValue\}/gi,n).replace(/\{dimensionValue2\}/gi,a)),k};l.getTileUrlTemplateFromResourceUrls=function(a,c,b,
e){b=t(a);var d="";if(b&&0<b.length){var f=B[a].dimensions&&B[a].dimensions[0];a=B[a].dimensions2&&B[a].dimensions2[0];d=b[0].template;d.indexOf(".xxx")===d.length-4&&(d=d.slice(0,d.length-4));d=d.replace(/\{Style\}/gi,e);d=d.replace(/\{TileMatrixSet\}/gi,c);d=d.replace(/\{TileMatrix\}/gi,"{level}");d=d.replace(/\{TileRow\}/gi,"{row}");d=d.replace(/\{TileCol\}/gi,"{col}");d=d.replace(/\{dimensionValue\}/gi,f);d=d.replace(/\{dimensionValue2\}/gi,a)}return d}})},"esri/support/basemapDefinitions":function(){define(["require",
"exports","dojo/i18n!../nls/basemaps"],function(m,l,h){return{streets:{id:"streets",title:h.streets,thumbnailUrl:m.toUrl("../images/basemap/streets.jpg"),baseMapLayers:[{id:"streets-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Street Map",showLegend:!1,visibility:!0,opacity:1}]},satellite:{id:"satellite",title:h.satellite,thumbnailUrl:m.toUrl("../images/basemap/satellite.jpg"),baseMapLayers:[{id:"satellite-base-layer",
url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",title:h.hybrid,thumbnailUrl:m.toUrl("../images/basemap/hybrid.jpg"),baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",
url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Boundaries and Places",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",title:h.terrain,thumbnailUrl:m.toUrl("../images/basemap/terrain.jpg"),baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",
showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},topo:{id:"topo",title:h.topo,thumbnailUrl:m.toUrl("../images/basemap/topo.jpg"),baseMapLayers:[{id:"topo-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",
title:"World Topo Map",showLegend:!1,visibility:!0,opacity:1}]},gray:{id:"gray",title:h.gray,thumbnailUrl:m.toUrl("../images/basemap/gray.jpg"),baseMapLayers:[{id:"gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",
layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"dark-gray":{id:"dark-gray",title:h["dark-gray"],thumbnailUrl:m.toUrl("../images/basemap/dark-gray.jpg"),baseMapLayers:[{id:"dark-gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"dark-gray-reference-layer",
url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",title:h.oceans,thumbnailUrl:m.toUrl("../images/basemap/oceans.jpg"),baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",
showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"national-geographic":{id:"national-geographic",title:h["national-geographic"],thumbnailUrl:m.toUrl("../images/basemap/national-geographic.jpg"),baseMapLayers:[{id:"national-geographic-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",
title:"NatGeo World Map",showLegend:!1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,opacity:1}]},osm:{id:"osm",title:h.osm,thumbnailUrl:m.toUrl("../images/basemap/osm.jpg"),baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",title:h["dark-gray"],thumbnailUrl:m.toUrl("../images/basemap/dark-gray.jpg"),baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/c11ce4f7801740b2905eb03ddc963ac8/resources/styles/root.json",
layerType:"VectorTileLayer",title:"World Dark Gray",visibility:!0,opacity:1}]},"gray-vector":{id:"gray-vector",title:h.gray,thumbnailUrl:m.toUrl("../images/basemap/gray.jpg"),baseMapLayers:[{id:"gray-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/8a2cba3b0ebf4140b7c0dc5ee149549a/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Light Gray",visibility:!0,opacity:1}]},"streets-vector":{id:"streets-vector",title:h.streets,thumbnailUrl:m.toUrl("../images/basemap/streets.jpg"),
baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},"topo-vector":{id:"topo-vector",title:h.topo,thumbnailUrl:m.toUrl("../images/basemap/topo.jpg"),baseMapLayers:[{id:"topo-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",
title:"World Topo",visibility:!0,opacity:1}]},"streets-night-vector":{id:"streets-night-vector",title:h["streets-night-vector"],thumbnailUrl:m.toUrl("../images/basemap/streets-night.jpg"),baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",title:h["streets-relief-vector"],
thumbnailUrl:m.toUrl("../images/basemap/streets-relief.jpg"),baseMapLayers:[{id:"streets-relief-vector-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Streets Relief Base",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-reference-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief Reference",
layerType:"VectorTileLayer",showLegend:!1,visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",title:h["streets-navigation-vector"],thumbnailUrl:m.toUrl("../images/basemap/streets-navigation.jpg"),baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]}}})},"esri/nls/basemaps":function(){define({root:{streets:"Streets",
satellite:"Imagery",hybrid:"Imagery with Labels",terrain:"Terrain with Labels",topo:"Topographic",gray:"Light Gray Canvas","dark-gray":"Dark Gray Canvas",oceans:"Oceans","national-geographic":"National Geographic",osm:"OpenStreetMap","streets-night-vector":"World Street Map (Night)","streets-relief-vector":"World Street Map (with Relief)","streets-navigation-vector":"World Navigation Map"},ar:1,bs:1,cs:1,da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lv:1,lt:1,nl:1,nb:1,pl:1,
"pt-br":1,"pt-pt":1,ro:1,ru:1,sl:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"esri/Map":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/Accessor ./core/CollectionFlattener ./core/Evented ./core/Logger ./support/LayersMixin ./Basemap ./Ground ./support/basemapUtils ./support/groundUtils ./core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){var u=f.getLogger("esri.Map");return function(a){function b(b){b=
a.call(this)||this;return b.basemap=null,b.ground=new c,b._basemapCache=q.createCache(),b}return h(b,a),Object.defineProperty(b.prototype,"allLayers",{get:function(){return new g({root:this,rootCollectionNames:["basemap.baseLayers","ground.layers","layers","basemap.referenceLayers"],getChildrenFunction:function(a){return a.layers}})},enumerable:!0,configurable:!0}),b.prototype.castBasemap=function(a){return q.ensureType(a,this._basemapCache)},b.prototype.castGround=function(a){return(a=t.ensureType(a))?
a:(u.error("Map.ground may not be set to null or undefined"),this._get("ground"))},d([r.property({readOnly:!0})],b.prototype,"allLayers",null),d([r.property({type:e})],b.prototype,"basemap",void 0),d([r.cast("basemap")],b.prototype,"castBasemap",null),d([r.property({type:c})],b.prototype,"ground",void 0),d([r.cast("ground")],b.prototype,"castGround",null),b=d([r.subclass("esri.Map")],b)}(r.declared(b,k,a))})},"esri/core/CollectionFlattener":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./accessorSupport/decorators ./Collection ./HandleRegistry".split(" "),
function(m,l,h,d,b,g,k){return function(f){function a(a){a=f.call(this)||this;return a._handles=new k,a.root=null,a.refresh=a.refresh.bind(a),a.updateCollections=a.updateCollections.bind(a),a}return h(a,f),a.prototype.initialize=function(){var a=this;this._handles.add(this.rootCollectionNames.map(function(c){return a.watch("root."+c,a.updateCollections,!0)}));this.updateCollections()},a.prototype.destroy=function(){this.root=null;this.refresh();this._handles.destroy();this._handles=null},a.prototype.updateCollections=
function(){var a=this;this._collections=this.rootCollectionNames.map(function(c){return a.get("root."+c)}).filter(function(a){return null!=a});this.refresh()},a.prototype.refresh=function(){var a=this._handles;a.remove("collections");this.removeAll();for(var c=this._collections.slice(),b=0,d=this._collections;b<d.length;b++)this._processCollection(c,this,d[b]);for(b=0;b<c.length;b++)a.add(c[b].on("after-changes",this.refresh),"collections")},a.prototype._createNewInstance=function(a){return new g(a)},
a.prototype._processCollection=function(a,c,b){var e=this;b&&(a.push(b),b.forEach(function(b){b&&(c.push(b),e._processCollection(a,c,e.getChildrenFunction(b)))}))},d([b.property()],a.prototype,"rootCollectionNames",void 0),d([b.property()],a.prototype,"root",void 0),d([b.property()],a.prototype,"getChildrenFunction",void 0),a=d([b.subclass("esri.core.CollectionFlattener")],a)}(b.declared(g))})},"esri/support/LayersMixin":function(){define(["../core/Accessor","../core/Collection","../core/Logger"],
function(m,l,h){var d=function(b,k,f){for(var a,e,c=0,g=b.length;g>c;c++){if(a=b.getItemAt(c),a[k]===f)return a;if(a.layers&&(e=d(a.layers,k,f)))return e}},b=h.getLogger("esri.support.LayersMixin");return m.createSubclass({declaredClass:"esri.support.LayersMixin",destroy:function(){this._layersHandle.remove();this._layersHandle=null;this.layers.drain(this._lyrRemove,this)},properties:{layers:{type:l,get:function(){var d=this._get("layers");return d?d:(d=new l,d.on("after-add",function(d){d=d.item;
d.parent&&d.parent!==this&&d.parent.remove(d);d.parent=this;this.layerAdded(d);"elevation"===d.type&&b.error("Layer '"+d.title+", id:"+d.id+"' of type '"+d.type+"' is not supported as an operational layer and will therefore be ignored.")}.bind(this)),d.on("after-remove",function(b){b=b.item;b.parent=null;this.layerRemoved(b)}.bind(this)),d)},set:function(b){var d=this._get("layers");d&&this.remove(d.toArray());this.addMany(b.toArray())}}},findLayerById:function(b){return d(this.layers,"id",b)},add:function(b,
d){var f=this.layers;return d=f.getNextIndex(d),b.parent===this?void this.reorder(b,d):void f.add(b,d)},addMany:function(b,d){var f=this.layers;d=f.getNextIndex(d);b.slice().forEach(function(a){return a.parent===this?void this.reorder(a,d):(f.add(a,d),void(d+=1))},this)},remove:function(b){return this.layers.remove(b)},removeMany:function(b){return this.layers.removeMany(b)},removeAll:function(){return this.layers.removeAll()},reorder:function(b,d){return this.layers.reorder(b,d)},findLayerByUid:function(b){return d(this.layers,
"uid",b)},layerAdded:function(b){},layerRemoved:function(b){}})})},"esri/Basemap":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/accessorSupport/decorators dojo/_base/lang ./support/basemapDefinitions ./core/Collection ./core/collectionUtils ./core/Evented ./core/JSONSupport ./core/Loadable ./core/promiseUtils ./core/requireUtils ./core/urlUtils ./core/Logger ./portal/Portal ./portal/PortalItem ./layers/Layer".split(" "),function(m,
l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n){var w=0,z=f.ofType(n),C=v.getLogger("esri.Basemap");return function(c){function e(a){a=c.call(this)||this;a.id=null;a.portalItem=null;a.thumbnailUrl=null;a.title="Basemap";a.id=Date.now().toString(16)+"-basemap-"+w++;a.baseLayers=new f;a.referenceLayers=new f;var b=function(a){"elevation"===a.type&&C.error("Layer '"+a.title+", id:"+a.id+"' of type '"+a.type+"' is not supported as a basemap layer and will therefore be ignored.")};return a.baseLayers.on("after-add",
function(a){return b(a.item)}),a.referenceLayers.on("after-add",function(a){return b(a.item)}),a}return h(e,c),n=e,e.prototype.initialize=function(){var a=this;this.when()["catch"](function(c){C.error("#load()","Failed to load basemap (title: '"+a.title+"', id: '"+a.id+"')",c)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)},e.prototype.normalizeCtorArgs=function(a){return a&&"resourceInfo"in a&&(this._set("resourceInfo",a.resourceInfo),a=g.mixin({},a),delete a.resourceInfo),
a},Object.defineProperty(e.prototype,"baseLayers",{set:function(c){this._set("baseLayers",a.referenceSetter(c,this._get("baseLayers"),z))},enumerable:!0,configurable:!0}),e.prototype.writeBaseLayers=function(a,c,b,e){var d=[];return a?(e=g.mixin({},e,{layerContainerType:"basemap"}),this.baseLayers.forEach(function(a){if(a.write){var c={};a.write(c,e)&&d.push(c)}}),this.referenceLayers.forEach(function(a){if(a.write){var c={isReference:!0};a.write(c,e)&&d.push(c)}}),void(c[b]=d)):void(c[b]=d)},Object.defineProperty(e.prototype,
"referenceLayers",{set:function(c){this._set("referenceLayers",a.referenceSetter(c,this._get("referenceLayers"),z))},enumerable:!0,configurable:!0}),e.prototype.writeTitle=function(a,c){c.title=a||"Basemap"},e.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},e.prototype.clone=function(){var a={id:this.id,title:this.title,portalItem:this.portalItem,resourceInfo:this.resourceInfo,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};
return this.loaded&&(a.loadStatus="loaded"),new n(a)},e.prototype.read=function(a,c){return this.resourceInfo||this._set("resourceInfo",{data:a,context:c}),this.inherited(arguments)},e.prototype.write=function(a,c){return a=a||{},c&&c.origin||(c=g.mixin({origin:"web-map"},c)),this.inherited(arguments,[a,c]),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(a.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(function(a){a=g.clone(a);return a.url&&u.isProtocolRelative(a.url)&&
(a.url="https:"+a.url),a.templateUrl&&u.isProtocolRelative(a.templateUrl)&&(a.templateUrl="https:"+a.templateUrl),a})),a},e.prototype._loadFromSource=function(){var a=this.resourceInfo,c=this.portalItem;return a?this._loadLayersFromJSON(a.data,a.context?a.context.url:null):c?this._loadFromItem(c):t.resolve(null)},e.prototype._loadLayersFromJSON=function(a,c){var b=this,e=this.resourceInfo&&this.resourceInfo.context,d=this.portalItem&&this.portalItem.portal||e&&e.portal||null,f=e&&"web-scene"===e.origin?
"web-scene":"web-map";return r.when(m,"./portal/support/layersCreator").then(function(e){var g=[];if(a.baseMapLayers&&Array.isArray(a.baseMapLayers)){var n={context:{origin:f,url:c,portal:d,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},k=e.populateOperationalLayers(b.baseLayers,a.baseMapLayers.filter(function(a){return!a.isReference}),n);g.push.apply(g,k);e=e.populateOperationalLayers(b.referenceLayers,a.baseMapLayers.filter(function(a){return a.isReference}),n);g.push.apply(g,
e)}return t.eachAlways(g)}).then(function(){})},e.prototype._loadFromItem=function(a){var c=this;return a.load().then(function(a){return a.fetchData()}).then(function(b){var e=u.urlToObject(a.itemUrl);return c._set("resourceInfo",{data:b.baseMap,context:{origin:"web-map",portal:a.portal||x.getDefault(),url:e}}),c.read(c.resourceInfo.data,c.resourceInfo.context),c.read({title:a.title,thumbnailUrl:a.thumbnailUrl},{origin:"portal-item",portal:a.portal||x.getDefault(),url:e}),c._loadLayersFromJSON(c.resourceInfo.data,
e)})},e.fromId=function(a){return(a=k[a])?n.fromJSON(a):null},d([b.property({type:z,json:{write:{ignoreOrigin:!0,target:"baseMapLayers"}}}),b.cast(a.castForReferenceSetter)],e.prototype,"baseLayers",null),d([b.writer("baseLayers")],e.prototype,"writeBaseLayers",null),d([b.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],e.prototype,"id",void 0),d([b.property({type:y})],e.prototype,"portalItem",void 0),d([b.property({type:z}),b.cast(a.castForReferenceSetter)],e.prototype,"referenceLayers",
null),d([b.property({readOnly:!0})],e.prototype,"resourceInfo",void 0),d([b.property()],e.prototype,"thumbnailUrl",void 0),d([b.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],e.prototype,"title",void 0),d([b.writer("title")],e.prototype,"writeTitle",null),e=n=d([b.subclass("esri.Basemap")],e);var n}(b.declared(c,e,q))})},"esri/core/collectionUtils":function(){define(["require","exports","./Collection"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});
l.referenceSetter=function(d,b,g){void 0===g&&(g=h);b||(b=new g);b.removeAll();return d&&(Array.isArray(d)||d.isInstanceOf&&d.isInstanceOf(h))?b.addMany(d):b.add(d),b};l.castForReferenceSetter=function(d){return d}})},"esri/Ground":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/accessorSupport/decorators dojo/_base/lang ./core/JSONSupport ./core/Loadable ./core/Collection ./core/collectionUtils ./core/Logger ./core/requireUtils ./core/promiseUtils ./core/Error ./layers/Layer ./layers/support/types".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){var x=a.ofType(u),y=c.getLogger("esri.Ground");return function(a){function c(c){c=a.call(this)||this;return c.layers=new x,c.layers.on("after-add",function(a){a=a.item;v.isOfType(a,["elevation","base-elevation"])||y.error("Layer '"+a.title+", id:"+a.id+"' of type '"+a.type+"' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.")}),c}return h(c,a),f=c,c.prototype.initialize=function(){this.when()["catch"](function(a){y.error("#load()",
"Failed to load ground",a)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)},c.prototype.normalizeCtorArgs=function(a){return a&&"resourceInfo"in a&&(this._set("resourceInfo",a.resourceInfo),a=g.mixin({},a),delete a.resourceInfo),a},Object.defineProperty(c.prototype,"layers",{set:function(a){this._set("layers",e.referenceSetter(a,this._get("layers"),x))},enumerable:!0,configurable:!0}),c.prototype.writeLayers=function(a,c,b,e){var d=[];return a?(e=g.mixin({},e,{layerContainerType:"ground"}),
a.forEach(function(a){if(a.write){var c={};a.write(c,e)&&d.push(c)}else e&&e.messages&&e.messages.push(new r("layer:unsupported","Layers ("+a.title+", "+a.id+") of type '"+a.declaredClass+"' cannot be persisted in the ground",{layer:a}))}),void(c.layers=d)):void(c.layers=d)},c.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},c.prototype.queryElevation=function(a,c){var b=this;return q.when(m,"./layers/support/ElevationQuery").then(function(e){e=new e.ElevationQuery;
var d=b.layers.filter(function(a){return"elevation"===a.type}).toArray();return e.queryAll(d,a,c)})},c.prototype.clone=function(){var a={resourceInfo:this.resourceInfo,layers:this.layers.slice()};return this.loaded&&(a.loadStatus="loaded"),new f(a)},c.prototype.read=function(a,c){return this.resourceInfo||this._set("resourceInfo",{data:a,context:c}),this.inherited(arguments)},c.prototype._loadFromSource=function(){var a=this.resourceInfo;return a?this._loadLayersFromJSON(a.data,a.context):t.resolve(null)},
c.prototype._loadLayersFromJSON=function(a,c){var b=this,e=c&&c.origin||"web-scene",d=c&&c.portal||null,f=c&&c.url||null;return q.when(m,"./portal/support/layersCreator").then(function(c){var g=[];a.layers&&Array.isArray(a.layers)&&g.push.apply(g,c.populateOperationalLayers(b.layers,a.layers,{context:{origin:e,url:f,portal:d,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"}));return t.eachAlways(g)}).then(function(){})},d([b.property({type:x,json:{read:!1}}),b.cast(e.castForReferenceSetter)],
c.prototype,"layers",null),d([b.writer("layers")],c.prototype,"writeLayers",null),d([b.property({readOnly:!0})],c.prototype,"resourceInfo",void 0),c=f=d([b.subclass("esri.Ground")],c);var f}(b.declared(k,f))})},"esri/layers/support/types":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.isOfType=function(h,d){h=h.constructor._meta;if(!h||!h.bases)return!1;h=h.bases;var b=Array.isArray(d);return h.some(function(g){g=g.__accessorMetadata__;if(!g)return!1;
g=g.properties;if(!g||!g.type||!g.type.value)return!1;g=g.type.value;return b?-1!==d.indexOf(g):g===d})}})},"esri/support/basemapUtils":function(){define("require exports ./basemapDefinitions ../core/accessorSupport/ensureType ../core/Collection ../core/urlUtils ../core/Logger ../Basemap".split(" "),function(m,l,h,d,b,g,k,f){function a(a,c){var b;if("string"==typeof a){if(!(a in h))return c=Object.keys(h).map(function(a){return'"'+a+'"'}).join(", "),n.warn("Unable to find basemap definition for: "+
a+". Try one of these: "+c),null;c&&(b=c[a]);b||(b=f.fromId(a),c&&(c[a]=b))}else b=d["default"](f,a);return b}function e(a,c){return a.map(function(a){return c.find(function(c){var b=t(a);c=t(c);return b.type===c.type&&b.url===c.url})||a})}function c(a){return a?!a.loaded&&a.resourceInfo?r(a.resourceInfo.data):{baseLayers:q(a.baseLayers),referenceLayers:q(a.referenceLayers)}:null}function q(a){return(b.isCollection(a)?a.toArray():a).map(t)}function t(a){return{type:a.type,url:y(a.urlTemplate||a.url||
a.styleUrl)}}function r(a){return a?{baseLayers:u(a.baseMapLayers.filter(function(a){return!a.isReference})),referenceLayers:u(a.baseMapLayers.filter(function(a){return a.isReference}))}:null}function u(a){return a.map(function(a){var c;switch(a.layerType){case "VectorTileLayer":c="vector-tile";break;case "ArcGISTiledMapServiceLayer":c="tile";break;default:c="unknown"}return{type:c,url:y(a.templateUrl||a.urlTemplate||a.styleUrl||a.url)}})}function v(a,c,b){return null!=a!=(null!=c)?"not-equal":a?
x(a.baseLayers,c.baseLayers)?x(a.referenceLayers,c.referenceLayers)?"equal":b.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function x(a,c){return a.length!==c.length?!1:!a.some(function(a){return!c.some(function(c){return a.type===c.type&&a.url===c.url})})}function y(a){return a?g.normalize(a).replace(/^\s*https?:/i,"").toLowerCase():""}Object.defineProperty(l,"__esModule",{value:!0});var n=k.getLogger("esri.support.basemapUtils");l.createCache=function(){return{}};l.ensureType=
a;l.clonePreservingTiledLayers=function(c,b){void 0===b&&(b=null);c=a(c);if(!c)return null;var d=new f({id:c.id,title:c.title,baseLayers:c.baseLayers.slice(),referenceLayers:c.referenceLayers.slice()});return b&&(d.baseLayers=e(d.baseLayers,b.baseLayers),d.referenceLayers=e(d.referenceLayers,b.referenceLayers)),d.load(),d.portalItem=c.portalItem,d};l.getWellKnownBasemapId=function(a){var b=null;a=c(a);for(var e in h){var d=r(h[e]),d=v(a,d,{mustMatchReferences:!1});if("equal"===d){b=e;break}"base-layers-equal"===
d&&(b=e)}return b};l.contentEquals=function(a,b){if(a===b)return!0;a=c(a);b=c(b);return"equal"===v(a,b,{mustMatchReferences:!0})}})},"esri/support/groundUtils":function(){define("require exports ../core/accessorSupport/ensureType ../core/Logger ../Ground ../layers/ElevationLayer".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});var k=d.getLogger("esri.support.groundUtils");l.groundElevationLayers={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer"}};
l.ensureType=function(d){var a;"string"==typeof d?d in l.groundElevationLayers?(d=l.groundElevationLayers[d],d=new g({id:d.id,url:d.url}),a=new b({layers:[d]})):k.warn("Unable to find ground definition for: "+d+'. Try "world-elevation"'):a=h["default"](b,d);return a}})},"esri/views/MapView":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/promise/all ../core/accessorSupport/decorators ../core/HandleRegistry ../core/promiseUtils ../core/workers ./MapViewBase ./DOMContainer ../geometry/ScreenPoint ./ui/2d/DefaultUI2D ./2d/engine/Stage ./2d/layers/support/GraphicsView2D ./2d/input/MapViewInputManager ./2d/navigation/MapViewNavigation ./2d/support/HighlightOptions ./BreakpointsOwner ./support/screenshotUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w){a.initialize();return function(a){function c(c){c=a.call(this,c)||this;return c._graphicsView=null,c._mapViewHandles=new k,c._stage=null,c.highlightOptions=new y,c.inputManager=new v({view:c}),c.navigation=null,c.ui=null,c.rendering=!1,c}return h(c,a),Object.defineProperty(c.prototype,"interacting",{get:function(){return this.navigation&&this.navigation.interacting||!1},enumerable:!0,configurable:!0}),c.prototype.hitTest=function(a,c){if(!this._setup)return null;
var e;e=null!=a&&a.x?a:new q({x:a,y:c});var d=this.toMap(e);a=[this._graphicsView];return a.push.apply(a,this.allLayerViews.toArray().reverse()),b(a.map(function(a){return a&&a.hitTest?a.hitTest(e.x,e.y):null})).then(function(a){return{screenPoint:e,results:a.filter(function(a){return null!=a}).map(function(a){return{mapPoint:d,graphic:a}})}})},c.prototype.takeScreenshot=function(a){return this._setup?(a=w.adjustScreenshotSettings(a,this),this._stage.takeScreenshot(a)):f.reject("Map view cannot be used before it is ready")},
c.prototype.on=function(a,c,b){var e=this.inputManager&&this.inputManager.viewEvents.register(a,c,b);return e?e:this.inherited(arguments)},c.prototype.destroyLayerViews=function(){this.inherited(arguments);this._stage&&(this._stage.destroy(),this._stage=null)},c.prototype._startup=function(){var a=this;this.inherited(arguments);var c=new r(this.surface),b=new u({view:this,graphics:this.graphics}),e=new x({view:this,animationManager:this.animationManager});this._stage=c;this._graphicsView=b;this._set("navigation",
e);this._mapViewHandles.add([this.allLayerViews.on("change",function(){return a._updateStageChildren()}),c.on("post-render",function(){return a._set("rendering",a.allLayerViews.some(function(a){return!0===a.rendering}))}),this.watch("stationary",function(a){return c.stationary=a},!0),this.watch("state.viewpoint",function(b){return c.state=a.state},!0)]);c.state=this.state;this._updateStageChildren()},c.prototype._tearDown=function(){this._setup&&(this._graphicsView.destroy(),this._mapViewHandles.removeAll(),
this._stage.destroy(),this.navigation.destroy(),this._stage=null,this._graphicsView=null,this._set("navigation",null),this.inherited(arguments))},c.prototype._updateStageChildren=function(){var a=this;this._stage.removeAllChildren();this.allLayerViews.filter(function(a){return null!=a.container}).forEach(function(c,b){a._stage.addChildAt(c.container,b)});this._stage.addChild(this._graphicsView.container)},d([g.property({readOnly:!0})],c.prototype,"inputManager",void 0),d([g.property({readOnly:!0})],
c.prototype,"navigation",void 0),d([g.property({dependsOn:["navigation.interacting"],type:Boolean})],c.prototype,"interacting",null),d([g.property({type:t})],c.prototype,"ui",void 0),d([g.property({readOnly:!0})],c.prototype,"rendering",void 0),c=d([g.subclass("esri.views.MapView")],c)}(g.declared(e,c,n))})},"esri/views/MapViewBase":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang ../core/accessorSupport/decorators ../core/HandleRegistry ../core/Logger ../core/promiseUtils ../core/Error ../Viewpoint ../geometry ../geometry/support/webMercatorUtils ./View ./ViewAnimation ./2d/FrameTask ./2d/PaddedViewState ./2d/MapViewConstraints ./2d/AnimationManager ./2d/viewpointUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w){var z=f.getLogger("esri.views.MapView");return function(f){function r(a){var c=f.call(this,a)||this;c._frameTask=new v(c);c._mapViewBaseHandles=new k;c._setup=!1;c.fullOpacity=1;c.interacting=!1;c.initialExtent=null;c.resizeAlign="center";c.type="2d";c.constraints=new y;c.padding={top:0,right:0,bottom:0,left:0};var b=function(){this._set("updating",this.layerViewManager.factory.working||this.allLayerViews.some(function(a){return!0===a.updating}))}.bind(c),
e=c._mapViewBaseHandles;return e.add([c.watch("viewpoint",function(a){return c._flipStationary()},!0),c.on("resize",function(a){return c._resizeHandler(a)}),c.watch("animationManager.animation",function(a){c.animation=a}),c.allLayerViews.on("change",function(){b();e.remove("layerViewsUpdating");e.add(c.allLayerViews.map(function(a){return a.watch("updating",b)}).toArray(),"layerViewsUpdating")})]),c.watch("ready",function(a){a?c._startup():c._tearDown()}),c}return h(r,f),r.prototype.destroy=function(){this.destroyed||
(this._set("ready",!1),this._mapViewBaseHandles.removeAll(),this.layerViewManager.empty(),this._frameTask.destroy(),this._tearDown(),this._gotoTask=this._mapViewBaseHandles=this._frameTask=null)},Object.defineProperty(r.prototype,"animation",{set:function(a){var c=this,b=this._get("animation");if(a!==b){if(b&&b.stop(),!a||a.isFulfilled())return void this._set("animation",null);this._set("animation",a);b=function(){a===c._get("animation")&&(c._set("animation",null),c._frameTask.requestFrame())};a.when(b,
b,function(a){c.state&&(c.state.viewpoint=a)})}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"center",{get:function(){if(!this._setup)return this._get("center");var a=this.content.center;return new q.Point({x:a[0],y:a[1],spatialReference:this.content.spatialReference})},set:function(a){if(null!=a){if(!this._normalizeInput(a))return void z.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference));
if(!this._setup)return this._set("center",a),void this.notifyChange("initialExtentRequired");var c=this.viewpoint;w.centerAt(c,c,a);this.viewpoint=c}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"constraints",{set:function(a){var c=this,b=this._get("constraints");b&&(this._mapViewBaseHandles.remove("constraints"),b.destroy());this._set("constraints",a);a&&(this._setup&&(a.view=this,this.state.viewpoint=a.fit(this.content.viewpoint)),this._mapViewBaseHandles.add(a.on("update",
function(){c._setup&&c.state&&(c.state.viewpoint=a.fit(c.content.viewpoint))}),"constraints"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"extent",{get:function(){return this._setup?this.content.extent.clone():this._get("extent")},set:function(a){if(null!=a){var c=this._normalizeInput(a);if(!c)return void z.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference));if(!c.width||
!c.height)return void z.error("#extent","invalid extent size");if(!this._setup)return this._set("extent",c),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");a=this.viewpoint;w.setExtent(a,a,c,this.size,{constraints:this.constraints});this.viewpoint=a}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"initialExtentRequired",{get:function(){var a=this.extent,c=this.center,b=this.scale,e=this.viewpoint,
d=this.zoom;return this.get("map.initialViewProperties.viewpoint")?!1:a?!1:!c||0===b&&-1===d?e?!1:!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"padding",{get:function(){return this._setup?this.state.padding:this._get("padding")},set:function(a){return this._setup?(this.state.padding=a,void this._set("padding",this.state.padding)):void this._set("padding",a)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rotation",{get:function(){return this._setup?
this.content.rotation:this._get("rotation")},set:function(a){if(!isNaN(a)){if(!this._setup)return void this._set("rotation",a);var c=this.viewpoint;w.rotateTo(c,c,a);this.viewpoint=c}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scale",{get:function(){return this._setup?this.content.scale:this._get("scale")},set:function(a){if(a&&!isNaN(a)){if(!this._setup)return this._set("scale",a),this._set("zoom",-1),a=this._get("extent"),a&&(this._set("extent",null),this._set("center",
a.center)),void this.notifyChange("initialExtentRequired");var c=this.viewpoint;w.scaleTo(c,c,a);this.viewpoint=c}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stationary",{get:function(){return!(this.animation||this.interacting||this._get("resizing")||this._stationaryTimer)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"viewpoint",{get:function(){if(!this._setup)return this._get("viewpoint");var a=this.content;return a&&a.viewpoint.clone()},set:function(a){if(null!=
a){var c=this._normalizeInput(a);if(!c)return void(!a.scale||isNaN(a.scale)?z.error("#viewpoint","invalid scale value of "+a.scale):a.targetGeometry?z.error("#viewpoint","incompatible spatialReference "+JSON.stringify(a.targetGeometry.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference)):z.error("#viewpoint","geometry not defined"));if(!this._setup)return this._set("viewpoint",c),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",
0),void this.notifyChange("initialExtentRequired");a=w.create();w.copy(a,c);this.constraints.constrain(a,this.content.viewpoint);this.state.viewpoint=a;this._frameTask.requestFrame();this._set("viewpoint",a)}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"zoom",{get:function(){return this._setup?this.constraints.scaleToZoom(this.scale):this._get("zoom")},set:function(a){if(null!=a){if(!this._setup){this.notifyChange("initialExtentRequired");this._set("zoom",a);this._set("scale",
0);var c=this._get("extent");c&&(this._set("extent",null),this._set("center",c.center))}this.constraints.effectiveLODs&&(c=this.viewpoint,w.scaleTo(c,c,this.constraints.zoomToScale(a)),this.viewpoint=c,this._set("zoom",this.constraints.scaleToZoom(this.scale)))}},enumerable:!0,configurable:!0}),r.prototype.goTo=function(a,c){if(this.animation&&(this.animation=null),!this._setup)return void z.error("#goTo()","MapView cannot be used before it is ready");c=b.mixin({animate:!0},c);a=w.createAsync(a,this);
return this._gotoTask={},c.animate?this._gotoAnimated(a,c):this._gotoImmediate(a,c)},r.prototype.hitTest=function(c,b){return a.reject("Should be implemented by subclasses")},r.prototype.toMap=function(a,c,b){if(!this._setup)return null;a&&null!=a.x&&(b=c,c=a.y,a=a.x);var e=[0,0];return this.state.toMap(e,[a,c]),b=b||new q.Point,b.x=e[0],b.y=e[1],b.spatialReference=this.spatialReference,b},r.prototype.isTileInfoRequired=function(){return!0},r.prototype.toScreen=function(a,c,b,e){if(!this._setup)return null;
a&&null!=a.x&&(e=c,a=this._normalizeInput(a),c=a.y,a=a.x);e=b||e||new q.ScreenPoint;a=[a,c];return this.state.toScreen(a,a),e.x=a[0],e.y=a[1],e},r.prototype.pixelSizeAt=function(a,c){return this._setup?(a&&null!=a.x&&(c=a.y,a=a.x),this.content.pixelSizeAt([a,c])):NaN},r.prototype.requestLayerViewUpdate=function(a){this._setup&&this._frameTask.requestLayerViewUpdate(a)},r.prototype.getDefaultSpatialReference=function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||
null},r.prototype.isSpatialReferenceSupported=function(a,c){if(c||this._get("ready"))return!0;c=this._normalizeInput(this._get("center"),a);var b=this._normalizeInput(this._get("extent"),a),e=this._normalizeInput(this._get("viewpoint"),a),d=this._userSpatialReference,f=null,g=null;(e=e&&e.targetGeometry)&&("extent"===e.type?f=e:"point"===e.type&&(g=e));e=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent"),a);a=this._normalizeInput(this.initialExtent,a);a=b||
f||e||a;return c||g||a&&a.center?!0:(d&&z.error("The view could not be initialized with the spatialReference "+d.wkid+".","Try specifying an extent or a center and scale"),!1)},r.prototype._createOrReplaceAnimation=function(a){return(!this.animation||this.animation.done)&&(this.animation=new u),this.animation.update(a),this.animation},r.prototype._cancellableGoTo=function(c,b,e){var d=this,f=e.then(function(){c===d._gotoTask&&(d.animation=null)}).otherwise(function(a){throw c===d._gotoTask&&(d.animation=
null,b.done||b.stop()),a;}),g=a.create(function(a){return a(f)},function(){c===d._gotoTask&&!b.done&&b.stop()});return b["catch"](function(){c===d._gotoTask&&g.cancel()}),g},r.prototype._gotoImmediate=function(a,c){var b=this,d=this._gotoTask,f=this._createOrReplaceAnimation(a);a=a.then(function(a){if(d!==b._gotoTask)throw new e("view:goto-interrupted","Goto was interrupted");b.viewpoint=f.target=a;f.finish()});return this._cancellableGoTo(d,f,a)},r.prototype._gotoAnimated=function(a,c){var b=this,
d=this._gotoTask,f=this._createOrReplaceAnimation(a);a=a.then(function(a){if(d!==b._gotoTask)throw new e("view:goto-interrupted","Goto was interrupted");return f.update(a),b.animationManager.animate(f,b.viewpoint,c),f.when().then(function(){})});return this._cancellableGoTo(d,f,a)},r.prototype._resizeHandler=function(a){var c=this.state;if(c){var b=this.content.viewpoint,e=this.content.size.concat();c.size=[a.width,a.height];w.resize(b,b,e,this.content.size,this.resizeAlign);b=this.constraints.constrain(b,
null);this.state.viewpoint=b}},r.prototype._startup=function(){if(!this._setup){var a=this.constraints,b=this._get("zoom"),e=this._get("scale"),d=this._normalizeInput(this._get("center")),f=this._normalizeInput(this._get("extent")),g=this._get("rotation"),k=this._normalizeInput(this._get("viewpoint"));a.view=this;a.effectiveLODs?-1!==b&&(e=a.zoomToScale(b)):b=-1;var h=null,q=null,r=0,b=k&&k.rotation,H=k&&k.targetGeometry;H&&("extent"===H.type?h=H:"point"===H.type&&(q=H,r=k.scale));k=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent"));
H=this._normalizeInput(this.initialExtent);f=f||h||k||H;d=d||q||f&&f.center;e=e||r||f&&w.extentToScale(f,this.size);g=new c({targetGeometry:d,scale:e,rotation:g||b||0});a.fit(g);this._set("animationManager",new n);this._set("state",new x({padding:this._get("padding"),size:this.size,viewpoint:g}));this._set("content",this.state.content);this._setup=!0}},r.prototype._tearDown=function(){if(this._setup){this._setup=!1;this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=
null,this.notifyChange("stationary"));var a=this._get("content"),c=a.center,b=a.spatialReference,c=new q.Point({x:c[0],y:c[1],spatialReference:b});this._set("viewpoint",null);this._set("extent",null);this._set("center",c);this._set("zoom",-1);this._set("rotation",a.rotation);this._set("scale",a.scale);this._set("spatialReference",b);this.constraints.view=null;this.animationManager.destroy();this._set("animationManager",null);this._set("state",null);this._set("content",null);this.animation=null}},
r.prototype._flipStationary=function(){var a=this;this._stationaryTimer&&clearTimeout(this._stationaryTimer);this._stationaryTimer=setTimeout(function(){a._stationaryTimer=null;a.notifyChange("stationary")},160);this.notifyChange("stationary")},r.prototype._normalizeInput=function(a,c){void 0===c&&(c=this.spatialReference);var b=a&&a.targetGeometry||a;return c?b?c.equals(b.spatialReference)?a:t.canProject(b,c)?a&&"esri.Viewpoint"===a.declaredClass?(a.targetGeometry=t.project(b,c),a):t.project(b,c):
null:null:a},d([g.property()],r.prototype,"animation",null),d([g.property({readOnly:!0})],r.prototype,"animationManager",void 0),d([g.property({value:null,type:q.Point,dependsOn:["content.center"]})],r.prototype,"center",null),d([g.property({type:y})],r.prototype,"constraints",null),d([g.property({readOnly:!0})],r.prototype,"content",void 0),d([g.property({value:null,type:q.Extent,dependsOn:["content.extent"]})],r.prototype,"extent",null),d([g.property()],r.prototype,"fullOpacity",void 0),d([g.property({readOnly:!0})],
r.prototype,"interacting",void 0),d([g.property({type:q.Extent})],r.prototype,"initialExtent",void 0),d([g.property({dependsOn:["map.initialViewProperties.viewpoint"]})],r.prototype,"initialExtentRequired",null),d([g.property({value:{top:0,right:0,bottom:0,left:0},cast:function(a){return b.mixin({top:0,right:0,bottom:0,left:0},a)}})],r.prototype,"padding",null),d([g.property()],r.prototype,"resizeAlign",void 0),d([g.property({value:0,type:Number,dependsOn:["content.rotation"]})],r.prototype,"rotation",
null),d([g.property({value:0,type:Number,dependsOn:["content.scale"]})],r.prototype,"scale",null),d([g.property({type:q.SpatialReference,dependsOn:["map.initialViewProperties.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],r.prototype,"spatialReference",void 0),d([g.property({readOnly:!0})],r.prototype,"state",void 0),d([g.property()],r.prototype,"stationary",null),d([g.property({readOnly:!0})],r.prototype,"type",void 0),d([g.property({value:null,type:c,dependsOn:["content.viewpoint"]})],
r.prototype,"viewpoint",null),d([g.property({value:-1,dependsOn:["content.scale"]})],r.prototype,"zoom",null),r=d([g.subclass("esri.views.MapViewBase")],r)}(g.declared(r))})},"esri/Viewpoint":function(){define(["./core/JSONSupport","./Camera","./geometry/support/typeUtils","./geometry/support/jsonUtils"],function(m,l,h,d){var b=m.createSubclass({declaredClass:"esri.Viewpoint",properties:{rotation:{type:Number,value:0,cast:function(b){return b%=360,0>b&&(b+=360),b},json:{write:!0}},scale:{type:Number,
value:0,json:{write:!0}},targetGeometry:{value:null,types:h.types,json:{read:function(b){return d.fromJSON(b)},write:!0}},camera:{value:null,type:l,json:{write:!0}}},clone:function(){return new b({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry?this.targetGeometry.clone():null,camera:this.camera?this.camera.clone():null})}});return b})},"esri/Camera":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/JSONSupport ./geometry/Point ./views/3d/support/mathUtils ./core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f){return function(a){function b(c,b,e,d){c=a.call(this)||this;return c.position=null,c.heading=0,c.tilt=0,c.fov=55,c}return h(b,a),c=b,b.prototype.getDefaults=function(a){return a.position?void 0:{position:new g([0,0,0])}},b.prototype.normalizeCtorArgs=function(a,c,b,e){return a&&"object"==typeof a&&("x"in a||Array.isArray(a))?(a={position:a},null!=c&&(a.heading=c),null!=b&&(a.tilt=b),null!=e&&(a.fov=e),a):a},b.prototype.equals=function(a){return a?this.tilt===a.tilt&&this.heading===
a.heading&&this.fov===a.fov&&this.position.equals(a.position):!1},b.prototype.clone=function(){return new c({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})},d([f.property({type:g,json:{write:{isRequired:!0}}})],b.prototype,"position",void 0),d([f.property({type:Number,json:{write:{isRequired:!0}}}),f.cast(k.cyclicalDeg.normalize)],b.prototype,"heading",void 0),d([f.property({type:Number,json:{write:{isRequired:!0}}}),f.cast(function(a){return k.clamp(a,-180,180)})],
b.prototype,"tilt",void 0),d([f.property({json:{read:!1,write:!1}})],b.prototype,"fov",void 0),b=c=d([f.subclass("esri.Camera")],b);var c}(f.declared(b))})},"esri/geometry/support/typeUtils":function(){define("require exports ../../core/accessorSupport/ensureType ../Geometry ../Extent ../Multipoint ../Point ../Polyline ../Polygon".split(" "),function(m,l,h,d,b,g,k,f,a){Object.defineProperty(l,"__esModule",{value:!0});l.types={base:d,key:"type",typeMap:{extent:b,multipoint:g,point:k,polyline:f,polygon:a}};
l.ensureType=h.ensureOneOfType(l.types)})},"esri/geometry/Multipoint":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Geometry ./Extent ./Point ../core/lang ./support/zmUtils".split(" "),function(m,l,h,d,b,g,k,f,a,e){function c(a){return function(c,b){return null==c?b:null==b?c:a(c,b)}}m=function(g){function q(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=g.apply(this,a)||this;return a.points=
[],a.type="multipoint",a}return h(q,g),r=q,q.prototype.normalizeCtorArgs=function(a,c){if(!a&&!c)return null;var b={};Array.isArray(a)?(b.points=a,b.spatialReference=c):!a||"esri.SpatialReference"!==a.declaredClass&&null==a.wkid?(a.points&&(b.points=a.points),a.spatialReference&&(b.spatialReference=a.spatialReference),a.hasZ&&(b.hasZ=a.hasZ),a.hasM&&(b.hasM=a.hasM)):b.spatialReference=a;a=b.points&&b.points[0];return a&&(void 0===b.hasZ&&void 0===b.hasM?(b.hasZ=2<a.length,b.hasM=!1):void 0===b.hasZ?
b.hasZ=3<a.length:void 0===b.hasM&&(b.hasM=3<a.length)),b},Object.defineProperty(q.prototype,"extent",{get:function(){var a=this.points;if(!a.length)return null;for(var b,e,d,f,g=new k,h=this.hasZ,q=this.hasM,r=h?3:2,t=a[0],l=c(Math.min),m=c(Math.max),M=t[0],R=t[1],P=t[0],t=t[1],Q=0,T=a.length;T>Q;Q++){var O=a[Q],S=O[0],H=O[1];if(M=l(M,S),R=l(R,H),P=m(P,S),t=m(t,H),h&&2<O.length)S=O[2],b=l(b,S),d=m(d,S);q&&O.length>r&&(O=O[r],e=l(e,O),f=m(f,O))}return g.xmin=M,g.ymin=R,g.xmax=P,g.ymax=t,g.spatialReference=
this.spatialReference,h?(g.zmin=b,g.zmax=d):(g.zmin=null,g.zmax=null),q?(g.mmin=e,g.mmax=f):(g.mmin=null,g.mmax=null),g},enumerable:!0,configurable:!0}),q.prototype.writePoints=function(c,b,e,d){b.points=a.clone(this.points)},q.prototype.addPoint=function(a){return this.clearCache(),e.updateSupportFromPoint(this,a),Array.isArray(a)?this.points.push(a):this.points.push(a.toArray()),this},q.prototype.clone=function(){var c={points:a.clone(this.points),spatialReference:this.spatialReference};return this.hasZ&&
(c.hasZ=!0),this.hasM&&(c.hasM=!0),new r(c)},q.prototype.getPoint=function(a){if(!this._validateInputs(a))return null;a=this.points[a];var c={x:a[0],y:a[1],spatialReference:this.spatialReference},b=2;return this.hasZ&&(c.z=a[2],b=3),this.hasM&&(c.m=a[b]),new f(c)},q.prototype.removePoint=function(a){return this._validateInputs(a)?(this.clearCache(),new f(this.points.splice(a,1)[0],this.spatialReference)):null},q.prototype.setPoint=function(a,c){return this._validateInputs(a)?(this.clearCache(),e.updateSupportFromPoint(c),
this.points[a]=c.toArray(),this):this},q.prototype.toJSON=function(a){return this.write(null,a)},q.prototype._validateInputs=function(a){return null!=a&&0<=a&&a<this.points.length},d([b.property({dependsOn:["points","hasZ","hasM","spatialReference"]})],q.prototype,"cache",void 0),d([b.property({dependsOn:["cache"]})],q.prototype,"extent",null),d([b.property({type:[[Number]],json:{write:{isRequired:!0}}})],q.prototype,"points",void 0),d([b.writer("points")],q.prototype,"writePoints",null),q=r=d([b.subclass("esri.geometry.Multipoint")],
q);var r}(b.declared(g));return m.prototype.toJSON.isDefaultToJSON=!0,m})},"esri/geometry/support/zmUtils":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.updateSupportFromPoint=function(h,d,b){void 0===b&&(b=!1);var g=h.hasM,k=h.hasZ;Array.isArray(d)?4!==d.length||g||k?3===d.length&&b&&!g?(k=!0,g=!1):3===d.length&&g&&k&&(g=!1,k=!1):(g=!0,k=!0):(k=!k&&d.hasZ&&(!g||d.hasM),g=!g&&d.hasM&&(!k||d.hasZ));h.hasZ=k;h.hasM=g}})},"esri/geometry/Polyline":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/lang ./Geometry ./Extent ./Point ./SpatialReference ./support/zmUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){function q(a){return function(c,b){return null==c?b:null==b?c:a(c,b)}}var t=q(Math.min),r=q(Math.max);m=function(k){function q(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=k.apply(this,a)||this;return a.paths=[],a.type="polyline",a}return h(q,k),l=q,q.prototype.normalizeCtorArgs=function(a,c){var b,d,f=null,g=null;return a&&!Array.isArray(a)?(f=a.paths?a.paths:null,c||(a.spatialReference?c=a.spatialReference:a.paths||(c=a)),b=a.hasZ,d=a.hasM):f=a,f=
f||[],c=c||e.WGS84,f.length&&f[0]&&null!=f[0][0]&&"number"==typeof f[0][0]&&(f=[f]),g=f[0]&&f[0][0],g&&(void 0===b&&void 0===d?(b=2<g.length,d=!1):void 0===b?b=!d&&3<g.length:void 0===d&&(d=!b&&3<g.length)),{paths:f,spatialReference:c,hasZ:b,hasM:d}},Object.defineProperty(q.prototype,"extent",{get:function(){var a=this.hasZ,c=this.hasM,b=this.spatialReference,e=this.paths,d=a?3:2;if(!e.length||!e[0].length)return null;for(var g=e[0][0],k=g[0],g=g[1],h=e[0][0],q=h[0],h=h[1],l=void 0,u=void 0,v=void 0,
x=void 0,m=[],O=0;O<e.length;O++){for(var S=e[O],H=S[0],Y=H[0],H=H[1],W=S[0],E=W[0],W=W[1],p=void 0,A=void 0,K=void 0,U=void 0,V=0;V<S.length;V++){var X=S[V],ba=X[0],fa=X[1];if(k=t(k,ba),g=t(g,fa),q=r(q,ba),h=r(h,fa),Y=t(Y,ba),H=t(H,fa),E=r(E,ba),W=r(W,fa),a&&2<X.length)ba=X[2],l=t(l,ba),u=r(u,ba),p=t(p,ba),A=r(A,ba);c&&X.length>d&&(U=X[d],v=t(l,U),x=r(u,U),K=t(p,U),U=r(A,U))}m.push(new f({xmin:Y,ymin:H,zmin:p,mmin:K,xmax:E,ymax:W,zmax:A,mmax:U,spatialReference:b}))}e=new f;return e.xmin=k,e.ymin=
g,e.xmax=q,e.ymax=h,e.spatialReference=b,a&&(e.zmin=l,e.zmax=u),c&&(e.mmin=v,e.mmax=x),e.cache._partwise=1<m.length?m:null,e},enumerable:!0,configurable:!0}),q.prototype.writePaths=function(a,c,b,e){c.paths=g.clone(this.paths)},q.prototype.addPath=function(a){if(a){this.clearCache();var c=this.paths,b=c.length;if(Array.isArray(a[0]))c[b]=a.concat();else{for(var e=[],d=0,f=a.length;f>d;d++)e[d]=a[d].toArray();c[b]=e}return this}},q.prototype.clone=function(){var a=new l;return a.spatialReference=this.spatialReference,
a.paths=g.clone(this.paths),a.hasZ=this.hasZ,a.hasM=this.hasM,a},q.prototype.getPoint=function(c,b){if(!this._validateInputs(c,b))return null;c=this.paths[c][b];b=this.hasZ;var e=this.hasM;return b&&!e?new a(c[0],c[1],c[2],void 0,this.spatialReference):e&&!b?new a(c[0],c[1],void 0,c[2],this.spatialReference):b&&e?new a(c[0],c[1],c[2],c[3],this.spatialReference):new a(c[0],c[1],this.spatialReference)},q.prototype.insertPoint=function(a,b,e){return this._validateInputs(a,b,!0)?(this.clearCache(),c.updateSupportFromPoint(this,
e),Array.isArray(e)||(e=e.toArray()),this.paths[a].splice(b,0,e),this):this},q.prototype.removePath=function(c){if(!this._validateInputs(c,null))return null;this.clearCache();c=this.paths.splice(c,1)[0];var b=this.spatialReference;return c.map(function(c){return new a(c,b)})},q.prototype.removePoint=function(c,b){return this._validateInputs(c,b)?(this.clearCache(),new a(this.paths[c].splice(b,1)[0],this.spatialReference)):null},q.prototype.setPoint=function(a,b,e){return this._validateInputs(a,b)?
(this.clearCache(),c.updateSupportFromPoint(this,e),Array.isArray(e)||(e=e.toArray()),this.paths[a][b]=e,this):this},q.prototype._validateInputs=function(a,c,b){if((void 0===b&&(b=!1),null==a||null==c)||0>a||a>=this.paths.length)return!1;a=this.paths[a];return b&&0>c||c>a.length?!1:0>c||c>=a.length?!1:!0},q.prototype.toJSON=function(a){return this.write(null,a)},d([b.property({dependsOn:["hasM","hasZ","paths"]})],q.prototype,"cache",void 0),d([b.property({dependsOn:["cache"],readOnly:!0})],q.prototype,
"extent",null),d([b.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],q.prototype,"paths",void 0),d([b.writer("paths")],q.prototype,"writePaths",null),q=l=d([b.subclass("esri.geometry.Polyline")],q);var l}(b.declared(k));return m.prototype.toJSON.isDefaultToJSON=!0,m})},"esri/geometry/Polygon":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/lang ./Geometry ./Extent ./Point ./SpatialReference ./support/webMercatorUtils ./support/zmUtils ./support/coordsUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){function r(a){return function(c,b){return null==c?b:null==b?c:a(c,b)}}var u=r(Math.min),v=r(Math.max);m=function(k){function r(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=k.apply(this,a)||this;return a.rings=[],a.type="polygon",a}return h(r,k),n=r,r.createEllipse=function(a){var c=a.center.x,b=a.center.y,e=a.center.z,d=a.center.m,f=a.center.hasZ,g=a.center.hasM,k=a.longAxis,h=a.shortAxis,q=a.numberOfPoints;a=a.view;for(var w=[],r=2*Math.PI/q,t=
f?3:2,l=0;q>l;l++){var H=a.toMap(k*Math.cos(l*r)+c,h*Math.sin(l*r)+b),H=[H.x,H.y];f&&(H[2]=e);g&&(H[t]=d);w.push(H)}w.push(w[0]);return new n({rings:[w],spatialReference:a.spatialReference})},r.createCircle=function(a){return n.createEllipse({center:a.center,longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,view:a.view})},r.fromExtent=function(a){var c=a.clone().normalize();a=a.spatialReference;var b=!1,e=!1;c.map(function(a){a.hasZ&&(b=!0);a.hasM&&(e=!0)});c={rings:c.map(function(a){var c=
[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(b&&a.hasZ)for(var d=(a.zmax-a.zmin)/2,f=0;f<c.length;f++)c[f].push(d);if(e&&a.hasM)for(a=(a.mmax-a.mmin)/2,f=0;f<c.length;f++)c[f].push(a);return c}),spatialReference:a};return b&&(c.hasZ=!0),e&&(c.hasM=!0),new n(c)},r.prototype.normalizeCtorArgs=function(a,c){var b,d,f=null,g=null;return a&&!Array.isArray(a)?(f=a.rings?a.rings:null,c||(a.spatialReference?c=a.spatialReference:a.rings||(c=a)),b=a.hasZ,d=a.hasM):f=
a,f=f||[],c=c||e.WGS84,f.length&&f[0]&&null!=f[0][0]&&"number"==typeof f[0][0]&&(f=[f]),g=f[0]&&f[0][0],g&&(void 0===b&&void 0===d?(b=2<g.length,d=!1):void 0===b?b=!d&&3<g.length:void 0===d&&(d=!b&&3<g.length)),{rings:f,spatialReference:c,hasZ:b,hasM:d}},Object.defineProperty(r.prototype,"centroid",{get:function(){var c=t.ringsCentroid([],this.rings,this.hasZ);if(isNaN(c[0])||isNaN(c[1])||this.hasZ&&isNaN(c[2]))return null;var b=new a;return b.x=c[0],b.y=c[1],b.spatialReference=this.spatialReference,
this.hasZ&&(b.z=c[2]),b},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"extent",{get:function(){var a=this.hasZ,c=this.hasM,b=this.spatialReference,e=this.rings,d=a?3:2;if(!e.length||!e[0].length)return null;for(var g=e[0][0],n=g[0],g=g[1],k=e[0][0],h=k[0],k=k[1],q=void 0,r=void 0,t=void 0,l=void 0,y=[],H=0;H<e.length;H++){for(var x=e[H],m=x[0],E=m[0],m=m[1],p=x[0],A=p[0],p=p[1],K=void 0,U=void 0,V=void 0,X=void 0,ba=0;ba<x.length;ba++){var fa=x[ba],ha=fa[0],ca=fa[1];if(n=u(n,
ha),g=u(g,ca),h=v(h,ha),k=v(k,ca),E=u(E,ha),m=u(m,ca),A=v(A,ha),p=v(p,ca),a&&2<fa.length)ha=fa[2],q=u(q,ha),r=v(r,ha),K=u(K,ha),U=v(U,ha);c&&fa.length>d&&(X=fa[d],t=u(q,X),l=v(r,X),V=u(K,X),X=v(U,X))}y.push(new f({xmin:E,ymin:m,zmin:K,mmin:V,xmax:A,ymax:p,zmax:U,mmax:X,spatialReference:b}))}e=new f;return e.xmin=n,e.ymin=g,e.xmax=h,e.ymax=k,e.spatialReference=b,a&&(e.zmin=q,e.zmax=r),c&&(e.mmin=t,e.mmax=l),e.cache._partwise=1<y.length?y:null,e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,
"isSelfIntersecting",{get:function(){return t.isSelfIntersecting(this.rings)},enumerable:!0,configurable:!0}),r.prototype.writePaths=function(a,c,b,e){c.rings=g.clone(this.rings)},r.prototype.addRing=function(a){if(a){this.clearCache();var c=this.rings,b=c.length;if(Array.isArray(a[0]))c[b]=a.concat();else{for(var e=[],d=0,f=a.length;f>d;d++)e[d]=a[d].toArray();c[b]=e}return this}},r.prototype.clone=function(){var a=new n;return a.spatialReference=this.spatialReference,a.rings=g.clone(this.rings),
a.hasZ=this.hasZ,a.hasM=this.hasM,a},r.prototype.contains=function(a){return a?(c.canProject(a,this.spatialReference)&&(a=c.project(a,this.spatialReference)),t.contains(this.rings,t.geometryToCoordinates(a))):!1},r.prototype.isClockwise=function(a){var c,b=this;return c=Array.isArray(a[0])?a:a.map(function(a){return b.hasZ?b.hasM?[a.x,a.y,a.z,a.m]:[a.x,a.y,a.z]:[a.x,a.y]}),t.isClockwise(c,this.hasM,this.hasZ)},r.prototype.getPoint=function(c,b){if(!this._validateInputs(c,b))return null;c=this.rings[c][b];
b=this.hasZ;var e=this.hasM;return b&&!e?new a(c[0],c[1],c[2],void 0,this.spatialReference):e&&!b?new a(c[0],c[1],void 0,c[2],this.spatialReference):b&&e?new a(c[0],c[1],c[2],c[3],this.spatialReference):new a(c[0],c[1],this.spatialReference)},r.prototype.insertPoint=function(a,c,b){return this._validateInputs(a,c,!0)?(this.clearCache(),q.updateSupportFromPoint(this,b),Array.isArray(b)||(b=b.toArray()),this.rings[a].splice(c,0,b),this):this},r.prototype.removePoint=function(c,b){return this._validateInputs(c,
b)?(this.clearCache(),new a(this.rings[c].splice(b,1)[0],this.spatialReference)):null},r.prototype.removeRing=function(c){if(!this._validateInputs(c,null))return null;this.clearCache();c=this.rings.splice(c,1)[0];var b=this.spatialReference;return c.map(function(c){return new a(c,b)})},r.prototype.setPoint=function(a,c,b){return this._validateInputs(a,c)?(this.clearCache(),q.updateSupportFromPoint(this,b),Array.isArray(b)||(b=b.toArray()),this.rings[a][c]=b,this):this},r.prototype._validateInputs=
function(a,c,b){if((void 0===b&&(b=!1),null==a||null==c)||0>a||a>=this.rings.length)return!1;a=this.rings[a];return b&&0>c||c>a.length?!1:0>c||c>=a.length?!1:!0},r.prototype.toJSON=function(a){return this.write(null,a)},d([b.property({dependsOn:["hasM","hasZ","rings"]})],r.prototype,"cache",void 0),d([b.property({readOnly:!0,dependsOn:["cache"]})],r.prototype,"centroid",null),d([b.property({dependsOn:["cache"],readOnly:!0})],r.prototype,"extent",null),d([b.property({dependsOn:["cache"],readOnly:!0})],
r.prototype,"isSelfIntersecting",null),d([b.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],r.prototype,"rings",void 0),d([b.writer("rings")],r.prototype,"writePaths",null),r=n=d([b.subclass("esri.geometry.Polygon")],r);var n}(b.declared(k));return m.prototype.toJSON.isDefaultToJSON=!0,m})},"esri/geometry/support/jsonUtils":function(){define("require exports ../Extent ../Multipoint ../Point ../Polygon ../Polyline".split(" "),function(m,l,h,d,b,g,k){function f(a){return a?void 0!==a.x&&
void 0!==a.y?b.fromJSON(a):void 0!==a.paths?k.fromJSON(a):void 0!==a.rings?g.fromJSON(a):void 0!==a.points?d.fromJSON(a):void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax?h.fromJSON(a):null:null}Object.defineProperty(l,"__esModule",{value:!0});l.fromJson=function(a){try{throw Error("fromJson is deprecated, use fromJSON instead");}catch(c){console.warn(c.stack)}return f(a)};l.fromJSON=f;l.getJsonType=function(a){return a instanceof b?"esriGeometryPoint":a instanceof k?"esriGeometryPolyline":
a instanceof g?"esriGeometryPolygon":a instanceof h?"esriGeometryEnvelope":a instanceof d?"esriGeometryMultipoint":null};var a={esriGeometryPoint:b,esriGeometryPolyline:k,esriGeometryPolygon:g,esriGeometryEnvelope:h,esriGeometryMultipoint:d};l.getGeometryType=function(b){return b&&a[b]||null}})},"esri/geometry":function(){define("require exports ./geometry/Extent ./geometry/Multipoint ./geometry/Point ./geometry/Polygon ./geometry/Polyline ./geometry/SpatialReference ./geometry/ScreenPoint ./geometry/Geometry ./geometry/support/jsonUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){Object.defineProperty(l,"__esModule",{value:!0});l.Extent=h;l.Multipoint=d;l.Point=b;l.Polygon=g;l.Polyline=k;l.SpatialReference=f;l.ScreenPoint=a;l.BaseGeometry=e;l.isGeometry=function(a){return a instanceof l.BaseGeometry};l.fromJSON=c.fromJSON})},"esri/geometry/ScreenPoint":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g){return function(b){function f(){for(var a=
[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;return a.x=0,a.y=0,a.z=void 0,a}return h(f,b),a=f,f.prototype.normalizeCtorArgs=function(a,c){return"number"==typeof a?{x:a,y:c}:Array.isArray(a)?{x:a[0],y:a[1]}:a},f.prototype.clone=function(){return new a({x:this.x,y:this.y,z:this.z})},f.prototype.toArray=function(){return null==this.z?[this.x,this.y]:[this.x,this.y,this.z]},d([g.property({type:Number})],f.prototype,"x",void 0),d([g.property({type:Number})],f.prototype,"y",
void 0),d([g.property({type:Number})],f.prototype,"z",void 0),f=a=d([g.subclass("esri.geometry.ScreenPoint")],f);var a}(g.declared(b))})},"esri/views/View":function(){define("dojo/_base/lang ../Graphic ../core/Accessor ../core/Collection ../core/CollectionFlattener ../core/Evented ../core/HandleRegistry ../core/Promise ../core/watchUtils ../core/promiseUtils ../core/Scheduler ../geometry/Extent ../geometry/HeightModelInfo ../geometry/SpatialReference ./LayerViewManager ./RefreshManager ./BasemapView ./GroundView ./support/DefaultsFromMap".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n){return h.createSubclass([f,g],{declaredClass:"esri.views.View",properties:{allLayerViews:{readOnly:!0},basemapView:{},animation:{},resizing:{},interacting:{},graphics:{type:d.ofType(l)},groundView:{},defaultsFromMap:n,heightModelInfo:{readOnly:!0,type:t,dependsOn:["map.heightModelInfo","defaultsFromMap.heightModelInfo"]},initialExtent:{readOnly:!0,type:q,dependsOn:["defaultsFromMap.extent"]},initialExtentRequired:{},layerViews:{type:d},map:{},ready:{readOnly:!0,
dependsOn:"map spatialReference width height initialExtentRequired initialExtent defaultsFromMap.isSpatialReferenceDone map.loaded".split(" ")},size:{readOnly:!0,dependsOn:["width","height"],get:function(){return[this.width,this.height]}},spatialReference:{type:r,dependsOn:["defaultsFromMap.spatialReference","defaultsFromMap.vcsWkid","defaultsFromMap.latestVcsWkid"]},stationary:{dependsOn:["animation","interacting","resizing"]},type:{},updating:{},padding:{},width:{},height:{},cursor:{}},constructor:function(a){this._viewHandles=
new k;this._viewHandles.add(this.watch("ready",function(a,c){a?this._currentSpatialReference=this.spatialReference:this._currentSpatialReference=null;this.notifyChange("spatialReference");!a&&c&&this.layerViewManager.empty()}.bind(this)));this.allLayerViews=new b({root:this,rootCollectionNames:["basemapView.baseLayerViews","groundView.layerViews","layerViews","basemapView.referenceLayerViews"],getChildrenFunction:function(a){return a.layerViews}});this.defaultsFromMap=new n({view:this})},getDefaults:function(){return m.mixin(this.inherited(arguments),
{layerViews:[],graphics:[],padding:{left:0,top:0,right:0,bottom:0}})},initialize:function(){var c=this.validate().then(function(){this._isValid=!0;this.notifyChange("ready");var c=function(){return a.whenOnce(this,"ready").then(function(){return e.after(0)}.bind(this)).then(function(){return this.ready?void 0:c()}.bind(this))}.bind(this);return c()}.bind(this));this.addResolvingPromise(c);this.basemapView=new x({view:this});this.groundView=new y({view:this});this.layerViewManager=new u({view:this});
this.refreshManager=new v({view:this});this._resetInitialViewPropertiesFromContent()},destroy:function(){this.destroyed||(this.basemapView.destroy(),this.groundView.destroy(),this.destroyLayerViews(),this.refreshManager.destroy(),this.defaultsFromMap.destroy(),this.defaultsFromMap=null,this._viewHandles.destroy(),this.map=null)},destroyLayerViews:function(){this.layerViewManager.destroy()},_viewHandles:null,_isValid:!1,_readyCycleForced:!1,_userSpatialReference:null,_currentSpatialReference:null,
animation:null,basemapView:null,groundView:null,graphics:null,_graphicsSetter:function(a){this._graphicsView&&(this._graphicsView.graphics=a);this._set("graphics",a)},heightModelInfo:null,_heightModelInfoGetter:function(){return this.getDefaultHeightModelInfo()},interacting:!1,layerViews:null,map:null,_mapSetter:function(a){var c=this._get("map");a!==c&&(a&&a.load&&a.load(),this._forceReadyCycle(),this._resetInitialViewPropertiesFromContent(),this._set("map",a))},padding:null,_readyGetter:function(){return!!(this._isValid&&
!this._readyCycleForced&&this.map&&0!==this.width&&0!==this.height&&this.spatialReference&&(!this.map.load||this.map.loaded)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isSpatialReferenceDone)&&this.defaultsFromMap&&this.defaultsFromMap.isTileInfoDone&&this.isSpatialReferenceSupported(this.spatialReference))},spatialReference:null,_spatialReferenceGetter:function(){var a=this._userSpatialReference||this._currentSpatialReference||
this.getDefaultSpatialReference()||null;return a&&this.isHeightModelInfoRequired&&this.defaultsFromMap&&(a=a.clone(),a.vcsWkid=this.defaultsFromMap.vcsWkid,a.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),a},_spatialReferenceSetter:function(a){this._userSpatialReference=a;this._set("spatialReference",a)},stationary:!0,_stationaryGetter:function(){return!this.animation&&!this.interacting&&!this.resizing},type:null,updating:!1,initialExtentRequired:!0,initialExtent:null,_initialExtentGetter:function(){return this.defaultsFromMap&&
this.defaultsFromMap.extent},cursor:"default",whenLayerView:function(a){return this.layerViewManager.whenLayerView(a)},getDefaultSpatialReference:function(){return this.get("defaultsFromMap.spatialReference")},getDefaultHeightModelInfo:function(){return this.get("map.supportsHeightModelInfo")&&this.get("map.heightModelInfo")||this.get("defaultsFromMap.heightModelInfo")||null},validate:function(){return e.resolve()},isSpatialReferenceSupported:function(){return!0},isTileInfoRequired:function(){return!1},
_resetInitialViewPropertiesFromContent:function(){if(this.defaultsFromMap){var b=this.defaultsFromMap.start.bind(this.defaultsFromMap);this.defaultsFromMap.reset();this._currentSpatialReference=null;this.notifyChange("spatialReference");this._viewHandles.remove("defaultsFromMap");this._viewHandles.add([a.watch(this,"spatialReference",b),a.watch(this,"initialExtentRequired",b),c.schedule(b)],"defaultsFromMap")}},_forceReadyCycle:function(){this.ready&&(this._readyCycleForced=!0,a.whenFalseOnce(this,
"ready",function(){this._readyCycleForced=!1;this.notifyChange("ready")}.bind(this)),this.notifyChange("ready"))}})})},"esri/Graphic":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/accessorSupport/decorators dojo/_base/lang ./core/lang ./core/JSONSupport ./PopupTemplate ./symbols/support/typeUtils ./symbols/support/jsonUtils ./geometry ./geometry/support/typeUtils".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t){var r=0;return function(f){function l(a,
c,b,e){a=f.call(this,a,c,b,e)||this;return a.layer=null,Object.defineProperty(a,"uid",{value:r++}),a}return h(l,f),u=l,l.prototype.normalizeCtorArgs=function(a,c,b,e){return a&&!a.declaredClass?a:{geometry:a,symbol:c,attributes:b,popupTemplate:e}},Object.defineProperty(l.prototype,"attributes",{set:function(a){var c=this._get("attributes");c!==a&&(this._set("attributes",a),this._notifyLayer("attributes",c,a))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"geometry",{set:function(a){var c=
this._get("geometry");c!==a&&(this._set("geometry",a),this._notifyLayer("geometry",c,a))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"popupTemplate",{get:function(){return this.get("layer.popupTemplate")||null},set:function(a){return void 0===a?void this._clearOverride("popupTemplate"):void this._override("popupTemplate",a)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"symbol",{set:function(a){var c=this._get("symbol");c!==a&&(this._set("symbol",a),this._notifyLayer("symbol",
c,a))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"visible",{set:function(a){var c=this._get("visible");c!==a&&(this._set("visible",a),this._notifyLayer("visible",c,a))},enumerable:!0,configurable:!0}),l.prototype.getAttribute=function(a){return this.attributes&&this.attributes[a]},l.prototype.setAttribute=function(a,c){if(this.attributes){var b=this.getAttribute(a);this.attributes[a]=c;this._notifyLayer("attributes",b,c,a)}else this.attributes=(b={},b[a]=c,b),this._notifyLayer("attributes",
void 0,c,a)},l.prototype.toJSON=function(){return{geometry:this.geometry&&this.geometry.toJSON(),symbol:this.symbol&&this.symbol.toJSON(),attributes:g.mixin({},this.attributes),popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}},l.prototype.clone=function(){return new u({attributes:k.clone(this.attributes),geometry:this.geometry&&this.geometry.clone()||null,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),symbol:this.symbol&&this.symbol.clone()||null,visible:this.visible})},
l.prototype._notifyLayer=function(a,c,b,e){this.layer&&(a={graphic:this,property:a,oldValue:c,newValue:b},e&&(a.attributeName=e),this.layer.graphicChanged(a))},d([b.property({value:null})],l.prototype,"attributes",null),d([b.property({value:null,types:t.types,json:{read:q.fromJSON}})],l.prototype,"geometry",null),d([b.property()],l.prototype,"layer",void 0),d([b.property({dependsOn:["layer.popupTemplate"],type:a})],l.prototype,"popupTemplate",null),d([b.property({value:null,types:e.types,json:{read:c.read}})],
l.prototype,"symbol",null),d([b.property({value:!0,set:function(a){}})],l.prototype,"visible",null),l=u=d([b.subclass("esri.Graphic")],l);var u}(b.declared(f))})},"esri/PopupTemplate":function(){define("require exports ./core/tsSupport/assignHelper ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/accessorSupport/decorators ./core/date ./core/Collection ./core/kebabDictionary ./core/JSONSupport ./core/lang ./support/Action ./support/arcadeUtils ./layers/support/fieldUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){var u=a({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),v=a({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});return function(a){function e(){var c=null!==a&&a.apply(this,arguments)||this;return c.actions=null,c.content="",c.expressionInfos=null,c.fieldInfos=null,c.layerOptions=null,c.overwriteActions=!1,c.title="",c.relatedRecordsInfo=null,c}return d(e,a),n=e,e.prototype.readContent=function(a,c){var b=
this,e=c.description,d=c.mediaInfos;a=c.showAttachments;if((c=c.popupElements)&&c.length)return c.map(function(a){return"text"!==a.type||a.text?"media"===a.type&&(a.mediaInfos||d)&&(a.mediaInfos||(a.mediaInfos=d),a.mediaInfos=b._readMediaInfos(a.mediaInfos)):a.text=e,a});c=[];return e?c.push({type:"text",text:e}):c.push({type:"fields"}),d&&d.length&&c.push({type:"media",mediaInfos:this._readMediaInfos(d)}),a&&c.push({type:"attachments",displayType:"list"}),c.length?c:e},e.prototype.writeContent=function(a,
b){var e=this;return b.showAttachments=!1,"string"==typeof a?void(b.description=a):Array.isArray(a)?(b.popupElements=c.clone(a),void b.popupElements.forEach(function(a){return"attachments"!==a.type||b.showAttachments?"media"!==a.type||b.mediaInfos?"text"!==a.type||b.description?"fields"!==a.type||b.fieldInfos||(a.fieldInfos&&(b.fieldInfos=e._writeFieldInfos(c.clone(a.fieldInfos))),delete a.fieldInfos):(a.text&&(b.description=a.text),delete a.text):(a.mediaInfos&&(b.mediaInfos=c.clone(a.mediaInfos),
b.mediaInfos.forEach(function(a){a.type=v.toJSON(a.type)})),delete a.mediaInfos):b.showAttachments=!0,a})):void 0},e.prototype.writeExpressionInfos=function(a,c){c.expressionInfos=a||null},e.prototype.readFieldInfos=function(a){return a?(a.forEach(function(a){var c=a.format&&a.format.dateFormat,b=a.stringFieldOption;c&&(a.format.dateFormat=k.fromJSON(c));b&&(a.stringFieldOption=u.fromJSON(b))}),a):void 0},e.prototype.writeFieldInfos=function(a,b){b.fieldInfos=a?this._writeFieldInfos(c.clone(a)):a},
e.prototype.writeLayerOptions=function(a,c){c.layerOptions=a||null},e.prototype.writeTitle=function(a,c){c.title=a||""},e.prototype.writeRelatedRecordsInfo=function(a,c){c.relatedRecordsInfo=a||null},Object.defineProperty(e.prototype,"requiredFields",{get:function(){return this.collectRequiredFields()},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var a=this.actions,a=a?c.clone(a.toArray()):[];return new n({actions:a,content:Array.isArray(this.content)?c.clone(this.content):this.content,
fieldInfos:this.fieldInfos?c.clone(this.fieldInfos):null,layerOptions:this.layerOptions?c.clone(this.layerOptions):null,overwriteActions:this.overwriteActions,relatedRecordsInfo:this.relatedRecordsInfo?c.clone(this.relatedRecordsInfo):null,title:this.title})},e.prototype.collectRequiredFields=function(){return this._getActionsFields(this.actions).concat(this._getTitleFields(this.title),this._getContentFields(this.content),this._getExpressionInfoFields(this.expressionInfos)).filter(function(a,c,b){return c===
b.indexOf(a)})},e.prototype._getContentElementFields=function(a){var c=this;return a&&"attachments"!==a.type?"fields"===a.type?this._getFieldInfoFields(a.fieldInfos||this.fieldInfos):"media"===a.type?(a.mediaInfos||[]).reduce(function(a,b){return a.concat(c._getMediaInfoFields(b))},[]):"text"===a.type?r.extractFieldNames(a.text):void 0:[]},e.prototype._getMediaInfoFields=function(a){var c=a.caption,b=a.value||{},e=b.fields,d=void 0===e?[]:e,e=b.normalizeField,f=b.tooltipField,g=b.sourceURL,b=b.linkURL;
a=r.extractFieldNames(a.title).concat(r.extractFieldNames(c),r.extractFieldNames(g),r.extractFieldNames(b),d);return e&&a.push(e),f&&a.push(f),a},e.prototype._getContentFields=function(a){var c=this;return"string"==typeof a?r.extractFieldNames(a):Array.isArray(a)?a.reduce(function(a,b){return a.concat(c._getContentElementFields(b))},[]):[]},e.prototype._getExpressionInfoFields=function(a){return a?a.reduce(function(a,c){return a.concat(t.extractFieldNames(c.expression))},[]):[]},e.prototype._getFieldInfoFields=
function(a){return a?a.filter(function(a){return"undefined"==typeof a.visible?!0:!!a.visible}).map(function(a){return a.fieldName}).filter(function(a){return-1===a.indexOf("relationships/")&&-1===a.indexOf("expression/")}):[]},e.prototype._getActionsFields=function(a){var c=this;return a?a.toArray().reduce(function(a,b){return a.concat(c._getActionFields(b))},[]):[]},e.prototype._getActionFields=function(a){return r.extractFieldNames(a.title).concat(r.extractFieldNames(a.className),r.extractFieldNames(a.image))},
e.prototype._getTitleFields=function(a){return"string"==typeof a?r.extractFieldNames(a):[]},e.prototype._readMediaInfos=function(a){return a.forEach(function(a){a.type=v.fromJSON(a.type)}),a},e.prototype._writeFieldInfos=function(a){return a.forEach(function(a){var c=a.format&&a.format.dateFormat,b=a.stringFieldOption;c&&(a.format.dateFormat=k.toJSON(c));b&&(a.stringFieldOption=u.toJSON(b));a.format||delete a.format}),a},b([g.property({type:f.ofType(q)})],e.prototype,"actions",void 0),b([g.property()],
e.prototype,"content",void 0),b([g.reader("content",["description","popupElements","mediaInfos","showAttachments"])],e.prototype,"readContent",null),b([g.writer("content")],e.prototype,"writeContent",null),b([g.property()],e.prototype,"expressionInfos",void 0),b([g.writer("expressionInfos")],e.prototype,"writeExpressionInfos",null),b([g.property()],e.prototype,"fieldInfos",void 0),b([g.reader("fieldInfos")],e.prototype,"readFieldInfos",null),b([g.writer("fieldInfos")],e.prototype,"writeFieldInfos",
null),b([g.property()],e.prototype,"layerOptions",void 0),b([g.writer("layerOptions")],e.prototype,"writeLayerOptions",null),b([g.property()],e.prototype,"overwriteActions",void 0),b([g.property()],e.prototype,"title",void 0),b([g.writer("title")],e.prototype,"writeTitle",null),b([g.property()],e.prototype,"relatedRecordsInfo",void 0),b([g.writer("relatedRecordsInfo")],e.prototype,"writeRelatedRecordsInfo",null),b([g.property({dependsOn:["actions","title","content","fieldInfos","expressionInfos"],
readOnly:!0})],e.prototype,"requiredFields",null),e=n=b([g.subclass("esri.PopupTemplate")],e);var n}(g.declared(e))})},"esri/core/date":function(){define(["require","exports","./kebabDictionary"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});var d={"short-date":"(datePattern: 'M/d/y', selector: 'date')","short-date-le":"(datePattern: 'd/M/y', selector: 'date')","long-month-day-year":"(datePattern: 'MMMM d, y', selector: 'date')","day-short-month-year":"(datePattern: 'd MMM y', selector: 'date')",
"long-date":"(datePattern: 'EEEE, MMMM d, y', selector: 'date')","short-date-short-time":"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')","short-date-le-short-time":"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')","short-date-short-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')","short-date-le-short-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')","short-date-long-time":"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",
"short-date-le-long-time":"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')","short-date-long-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')","short-date-le-long-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')","long-month-year":"(datePattern: 'MMMM y', selector: 'date')","short-month-year":"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"};m=h({shortDate:"short-date",
shortDateLE:"short-date-le",longDate:"long-date",dayShortMonthYear:"day-short-month-year",longMonthDayYear:"long-month-day-year",shortDateLongTime:"short-date-long-time",shortDateLELongTime:"short-date-le-long-time",shortDateShortTime:"short-date-short-time",shortDateLEShortTime:"short-date-le-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLongTime24:"short-date-long-time-24",shortDateLELongTime24:"short-date-le-long-time-24",
longMonthYear:"long-month-year",shortMonthYear:"short-month-year"});l.toJSON=m.toJSON;l.fromJSON=m.fromJSON;l.getFormat=function(b){return d[b]}})},"esri/support/Action":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/Identifiable ../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g,k){return function(b){function a(a){a=b.call(this)||this;return a.className="",a.temporary=!1,a.image="",a.id="",a.title=
"",a.visible=!0,a}return h(a,b),e=a,a.prototype.clone=function(){return new e({className:this.className,image:this.image,id:this.id,title:this.title,visible:this.visible})},d([k.property()],a.prototype,"className",void 0),d([k.property()],a.prototype,"temporary",void 0),d([k.property()],a.prototype,"image",void 0),d([k.property()],a.prototype,"id",void 0),d([k.property()],a.prototype,"title",void 0),d([k.property()],a.prototype,"visible",void 0),a=e=d([k.subclass("esri.support.Action")],a);var e}(k.declared(b,
g))})},"esri/support/arcadeUtils":function(){define(["require","exports","dojo/_base/lang","../arcade/arcade","../arcade/Dictionary"],function(m,l,h,d,b){function g(a){var b;try{b=a?d.parseScript(a):null}catch(c){b=null}return b}Object.defineProperty(l,"__esModule",{value:!0});var k=/^\$feature\./i,f={vars:{$feature:"any",$view:"any"},spatialReference:null};l.createSyntaxTree=g;l.createFunction=function(a,b){b=b||h.clone(f);var c;a="string"==typeof a?g(a):a;try{c=a?d.compileScript(a,b):null}catch(q){c=
null}return c};l.createExecContext=function(a,b){return{vars:{$feature:d.constructFeature(a),$view:b&&b.view},spatialReference:b&&b.sr}};l.createFeature=function(a){return d.constructFeature(a)};l.updateExecContext=function(a,b){a.vars.$feature=b};l.evalSyntaxTree=function(a,b){var c;try{c=d.executeScript(a,b,b.spatialReference)}catch(q){c=null}return c};l.executeFunction=function(a,b){var c;try{c=a?a(b,b.spatialReference):null}catch(q){c=null}return c};l.extractFieldNames=function(a){if(!a)return[];
a="string"==typeof a?g(a):a;var b=[];return d.extractFieldLiterals(a).forEach(function(a){k.test(a)&&(a=a.replace(k,""),b.push(a))}),b.sort(),b.filter(function(a,e){return 0===e||b[e-1]!==a})};l.dependsOnView=function(a){return d.referencesMember(a,"$view")};l.getViewInfo=function(a){return a&&a.viewingMode&&null!=a.scale&&a.spatialReference?{view:new b({viewingMode:a.viewingMode,scale:a.scale}),sr:a.spatialReference}:void 0}})},"esri/arcade/arcade":function(){define("require exports ./arcadeRuntime ./parser ./Feature ./arcadeCompiler dojo/has dojo/Deferred".split(" "),
function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});var a="disjoint intersects touches crosses within contains overlaps equals relate intersection union difference symmetricdifference clip cut area areageodetic length lengthgeodetic distance densify densifygeodetic generalize buffer buffergeodetic offset rotate issimple simplify multiparttosinglepart".split(" ");l.compileScript=function(a,c){return k("csp-restrictions")?function(c,b){return h.executeScript(a,c,b)}:g.compileScript(a,
c)};l.extend=function(a){h.extend(a);g.extend(a)};l.constructFeature=function(a){return b.fromFeature(a)};l.parseScript=function(a){return d.parseScript(a)};l.validateScript=function(a,c){return d.validateScript(a,c,"simple")};l.scriptCheck=function(a,c,b){return d.scriptCheck(a,c,b,"full")};l.parseAndExecuteScript=function(a,c,b){return h.executeScript(d.parseScript(a),c,b)};l.executeScript=function(a,c,b){return h.executeScript(a,c,b)};l.referencesMember=function(a,c){return h.referencesMember(a,
c)};l.referencesFunction=function(a,c){return h.referencesFunction(a,c)};l.extractFieldLiterals=function(a,c){return void 0===c&&(c=!1),d.extractFieldLiterals(a,c)};l.scriptUsesGeometryEngine=function(b){b=h.findFunctionCalls(b);for(var c=0;c<b.length;c++)if(-1<a.indexOf(b[c]))return!0;return!1};l.enableGeometrySupport=function(){var a=new f;return m(["esri/geometry/geometryEngine","./functions/geomsync"],function(c,b){b.setGeometryEngine(c);a.resolve(!0)},function(c){a.reject(c)}),a.promise}})},
"esri/arcade/arcadeRuntime":function(){define("require exports ../geometry/Polygon ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../geometry/SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./FunctionWrapper ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/geomsync ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,
w,z,C){function B(a,c){for(var b=[],p=0;p<c.arguments.length;p++)b.push(G(a,c.arguments[p]));return b}function F(a,c,b){try{return b(a,c,B(a,c))}catch(na){throw na;}}function G(b,p){try{switch(p.type){case "EmptyStatement":return a.voidOperation;case "VariableDeclarator":var d=null===p.init?null:G(b,p.init);d===a.voidOperation&&(d=null);var A=p.id.name.toLowerCase();return null!==b.localScope?b.localScope[A]={value:d,valueset:!0,node:p.init}:b.globalScope[A]={value:d,valueset:!0,node:p.init},a.voidOperation;
case "VariableDeclaration":for(var f=0;f<p.declarations.length;f++)G(b,p.declarations[f]);return a.voidOperation;case "BlockStatement":var g;a:{for(var K=a.voidOperation,f=0;f<p.body.length;f++)if(K=G(b,p.body[f]),K instanceof a.ReturnResult||K===a.breakResult||K===a.continueResult){g=K;break a}g=K}return g;case "FunctionDeclaration":var E=p.id.name.toLowerCase();return b.globalScope[E]={valueset:!0,node:null,value:new t(p,b)},a.voidOperation;case "ReturnStatement":var n;if(null===p.argument)n=new a.ReturnResult(a.voidOperation);
else{var k=G(b,p.argument);n=new a.ReturnResult(k)}return n;case "IfStatement":var h;if("AssignmentExpression"===p.test.type||"UpdateExpression"===p.test.type)throw Error(e.nodeErrorMessage(p.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var U=G(b,p.test);if(!0===U)h=G(b,p.consequent);else if(!1===U)h=null!==p.alternate?G(b,p.alternate):a.voidOperation;else throw Error(e.nodeErrorMessage(p,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));return h;case "ExpressionStatement":var r;if("AssignmentExpression"===
p.expression.type||"UpdateExpression"===p.expression.type)r=G(b,p.expression);else{var w=G(b,p.expression);r=w===a.voidOperation?a.voidOperation:new a.ImplicitResult(w)}return r;case "AssignmentExpression":var V;var l=G(b,p.right),f=null,u="";if("MemberExpression"===p.left.type){if(f=G(b,p.left.object),u=!0===p.left.computed?G(b,p.left.property):p.left.property.name,a.isArray(f)){if(!a.isNumber(u))throw Error("Invalid Parameter");if(0>u&&(u=f.length+u),0>u||u>f.length)throw Error("Assignment outside of array bounds");
if(u===f.length&&"\x3d"!==p.operator)throw Error("Invalid Parameter");f[u]=M(l,p.operator,f[u],p)}else{if(f instanceof c){if(!1===a.isString(u))throw Error("Dictionary accessor must be a string");}else{if(!(f instanceof q))throw a.isImmutableArray(f)?Error("Array is Immutable"):Error("Invalid Parameter");if(!1===a.isString(u))throw Error("Feature accessor must be a string");}if(!0===f.hasField(u))f.setField(u,M(l,p.operator,f.field(u),p));else{if("\x3d"!==p.operator)throw Error("Invalid Parameter");
f.setField(u,M(l,p.operator,null,p))}}V=a.voidOperation}else if(f=p.left.name.toLowerCase(),null!==b.localScope&&void 0!==b.localScope[f])V=(b.localScope[f]={value:M(l,p.operator,b.localScope[f].value,p),valueset:!0,node:p.right},a.voidOperation);else if(void 0!==b.globalScope[f])V=(b.globalScope[f]={value:M(l,p.operator,b.globalScope[f].value,p),valueset:!0,node:p.right},a.voidOperation);else throw Error("Variable not recognised");return V;case "UpdateExpression":var v,f=null;V="";if("MemberExpression"===
p.argument.type){if(f=G(b,p.argument.object),V=!0===p.argument.computed?G(b,p.argument.property):p.argument.property.name,a.isArray(f)){if(!a.isNumber(V))throw Error("Invalid Parameter");if(0>V&&(V=f.length+V),0>V||V>=f.length)throw Error("Assignment outside of array bounds");v=a.toNumber(f[V]);f[V]="++"===p.operator?v+1:v-1}else{if(f instanceof c){if(!1===a.isString(V))throw Error("Dictionary accessor must be a string");}else{if(!(f instanceof q))throw a.isImmutableArray(f)?Error("Array is Immutable"):
Error("Invalid Parameter");if(!1===a.isString(V))throw Error("Feature accessor must be a string");}if(!0!==f.hasField(V))throw Error("Invalid Parameter");v=a.toNumber(f.field(V));f.setField(V,"++"===p.operator?v+1:v-1)}u=!1===p.prefix?v:"++"===p.operator?v+1:v-1}else if(f=p.argument.name.toLowerCase(),null!==b.localScope&&void 0!==b.localScope[f])u=(v=a.toNumber(b.localScope[f].value),b.localScope[f]={value:"++"===p.operator?v+1:v-1,valueset:!0,node:p},!1===p.prefix?v:"++"===p.operator?v+1:v-1);else if(void 0!==
b.globalScope[f])u=(v=a.toNumber(b.globalScope[f].value),b.globalScope[f]={value:"++"===p.operator?v+1:v-1,valueset:!0,node:p},!1===p.prefix?v:"++"===p.operator?v+1:v-1);else throw Error("Variable not recognised");return u;case "BreakStatement":return a.breakResult;case "ContinueStatement":return a.continueResult;case "ForStatement":null!==p.init&&G(b,p.init);f={testResult:!0,lastAction:a.voidOperation};do a:{V=b;l=p;u=f;if(null!==l.test){if(u.testResult=G(V,l.test),!1===u.testResult)break a;if(!0!==
u.testResult)throw Error(e.nodeErrorMessage(l,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}u.lastAction=G(V,l.body);u.lastAction===a.breakResult?u.testResult=!1:u.lastAction instanceof a.ReturnResult?u.testResult=!1:null!==l.update&&G(V,l.update)}while(!0===f.testResult);return f.lastAction instanceof a.ReturnResult?f.lastAction:a.voidOperation;case "ForInStatement":return N(b,p);case "Identifier":return S(b,p);case "MemberExpression":return P(b,p);case "Literal":return p.value;case "ThisExpression":throw Error(e.nodeErrorMessage(p,
"RUNTIME","NOTSUPPORTED"));case "CallExpression":return H(b,p);case "UnaryExpression":return Q(b,p);case "BinaryExpression":return T(b,p);case "LogicalExpression":return O(b,p);case "ConditionalExpression":throw Error(e.nodeErrorMessage(p,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{for(f=[],V=0;V<p.elements.length;V++){var y=G(b,p.elements[V]);if(a.isFunctionParameter(y))throw Error(e.nodeErrorMessage(p,"RUNTIME","FUNCTIONCONTEXTILLEGAL"));y===a.voidOperation?f.push(null):f.push(y)}}catch(Ha){throw Ha;
}return f;case "ObjectExpression":f={};for(V=0;V<p.properties.length;V++){var X=G(b,p.properties[V]);if(a.isFunctionParameter(X.value))throw Error("Illegal Argument");if(!1===a.isString(X.key))throw Error("Illegal Argument");X.value===a.voidOperation?f[X.key.toString()]=null:f[X.key.toString()]=X.value}var x=new c(f);return x.immutable=!1,x;case "Property":return{key:"Identifier"===p.key.type?p.key.name:G(b,p.key),value:G(b,p.value)};case "Array":throw Error(e.nodeErrorMessage(p,"RUNTIME","NOTSUPPORTED"));
default:throw Error(e.nodeErrorMessage(p,"RUNTIME","UNREOGNISED"));}}catch(Ha){throw Ha;}}function N(b,p){var d=G(b,p.right);"VariableDeclaration"===p.left.type&&G(b,p.left);var f=null,A="VariableDeclaration"===p.left.type?p.left.declarations[0].id.name:p.left.name;if(null!==b.localScope&&void 0!==b.localScope[A]&&(f=b.localScope[A]),null===f&&void 0!==b.globalScope[A]&&(f=b.globalScope[A]),null===f)throw Error(e.nodeErrorMessage(p,"RUNTIME","VARIABLENOTDECLARED"));if(a.isArray(d)||a.isString(d)){for(var d=
d.length,g=0;d>g;g++){f.value=g;A=G(b,p.body);if(A===a.breakResult)break;if(A instanceof a.ReturnResult)return A}return a.voidOperation}if(a.isImmutableArray(d)){for(g=0;g<d.length();g++){f.value=g;A=G(b,p.body);if(A===a.breakResult)break;if(A instanceof a.ReturnResult)return A}return a.voidOperation}if(!(d instanceof c||d instanceof q))return a.voidOperation;d=d.keys();for(g=0;g<d.length;g++){f.value=d[g];A=G(b,p.body);if(A===a.breakResult)break;if(A instanceof a.ReturnResult)return A}}function M(c,
b,p,d){switch(b){case "\x3d":return c===a.voidOperation?null:c;case "/\x3d":return a.toNumber(p)/a.toNumber(c);case "*\x3d":return a.toNumber(p)*a.toNumber(c);case "-\x3d":return a.toNumber(p)-a.toNumber(c);case "+\x3d":return a.isString(p)||a.isString(c)?a.toString(p)+a.toString(c):a.toNumber(p)+a.toNumber(c);case "%\x3d":return a.toNumber(p)%a.toNumber(c);default:throw Error(e.nodeErrorMessage(d,"RUNTIME","OPERATORNOTRECOGNISED"));}}function R(b,p,d,f){switch(p=p.toLowerCase()){case "hasz":return b=
b.hasZ,void 0===b?!1:b;case "hasm":return b=b.hasM,void 0===b?!1:b;case "spatialreference":return p=b.spatialReference._arcadeCacheId,void 0===p&&(d=!0,Object.freeze&&Object.isFrozen(b.spatialReference)&&(d=!1),d&&(X++,b.spatialReference._arcadeCacheId=X,p=X)),b=new c({wkt:b.spatialReference.wkt,wkid:b.spatialReference.wkid}),void 0!==p&&(b._arcadeCacheId="SPREF"+p.toString()),b}switch(b.type){case "extent":switch(p){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return b=
b[p],void 0!==b?b:null;case "type":return"Extent"}break;case "polygon":switch(p){case "rings":return p=a.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===p&&(X++,p=X,a.isVersion4?b.cache._arcadeCacheId=p:b.setCacheValue("_arcadeCacheId",p)),b=new w(b.rings,b.spatialReference,!0===b.hasZ,!0===b.hasM,p);case "type":return"Polygon"}break;case "point":switch(p){case "x":case "y":case "z":case "m":return void 0!==b[p]?b[p]:null;case "type":return"Point"}break;case "polyline":switch(p){case "paths":return p=
a.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===p&&(X++,p=X,a.isVersion4?b.cache._arcadeCacheId=p:b.setCacheValue("_arcadeCacheId",p)),b=new w(b.paths,b.spatialReference,!0===b.hasZ,!0===b.hasM,p);case "type":return"Polyline"}break;case "multipoint":switch(p){case "points":return p=a.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===p&&(X++,p=X,a.isVersion4?b.cache._arcadeCacheId=p:b.setCacheValue("_arcadeCacheId",p)),b=new z(b.points,b.spatialReference,
!0===b.hasZ,!0===b.hasM,p,1);case "type":return"Multipoint"}}throw Error(e.nodeErrorMessage(f,"RUNTIME","PROPERTYNOTFOUND"));}function P(b,p){try{var d=G(b,p.object);if(null===d)throw Error(e.nodeErrorMessage(p,"RUNTIME","NOTFOUND"));if(!1===p.computed){if(d instanceof c||d instanceof q)return d.field(p.property.name);if(d instanceof C)return R(d,p.property.name,b,p);throw Error(e.nodeErrorMessage(p,"RUNTIME","INVALIDTYPE"));}var f=G(b,p.property);if(d instanceof c||d instanceof q){if(a.isString(f))return d.field(f);
throw Error(e.nodeErrorMessage(p,"RUNTIME","INVALIDTYPE"));}if(d instanceof C){if(a.isString(f))return R(d,f,b,p);throw Error(e.nodeErrorMessage(p,"RUNTIME","INVALIDTYPE"));}if(a.isArray(d)){if(a.isNumber(f)&&isFinite(f)&&Math.floor(f)===f){if(0>f&&(f=d.length+f),f>=d.length||0>f)throw Error(e.nodeErrorMessage(p,"RUNTIME","OUTOFBOUNDS"));return d[f]}throw Error(e.nodeErrorMessage(p,"RUNTIME","INVALIDTYPE"));}if(a.isString(d)){if(a.isNumber(f)&&isFinite(f)&&Math.floor(f)===f){if(0>f&&(f=d.length+f),
f>=d.length||0>f)throw Error(e.nodeErrorMessage(p,"RUNTIME","OUTOFBOUNDS"));return d[f]}throw Error(e.nodeErrorMessage(p,"RUNTIME","INVALIDTYPE"));}if(a.isImmutableArray(d)&&a.isNumber(f)&&isFinite(f)&&Math.floor(f)===f){if(0>f&&(f=d.length()+f),f>=d.length()||0>f)throw Error(e.nodeErrorMessage(p,"RUNTIME","OUTOFBOUNDS"));return d.get(f)}throw Error(e.nodeErrorMessage(p,"RUNTIME","INVALIDTYPE"));}catch(za){throw za;}}function Q(c,b){try{var p=G(c,b.argument);if(a.isBoolean(p)){if("!"===b.operator)return!p;
if("-"===b.operator)return-1*a.toNumber(p);if("+"===b.operator)return 1*a.toNumber(p);throw Error(e.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===b.operator)return-1*a.toNumber(p);if("+"===b.operator)return 1*a.toNumber(p);throw Error(e.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}catch(na){throw na;}}function T(c,b){try{var p=[G(c,b.left),G(c,b.right)],d=p[0],f=p[1];switch(b.operator){case "\x3d\x3d":return a.equalityTest(d,f);case "\x3d":return a.equalityTest(d,
f);case "!\x3d":return!a.equalityTest(d,f);case "\x3c":return a.greaterThanLessThan(d,f,b.operator);case "\x3e":return a.greaterThanLessThan(d,f,b.operator);case "\x3c\x3d":return a.greaterThanLessThan(d,f,b.operator);case "\x3e\x3d":return a.greaterThanLessThan(d,f,b.operator);case "+":return a.isString(d)||a.isString(f)?a.toString(d)+a.toString(f):a.toNumber(d)+a.toNumber(f);case "-":return a.toNumber(d)-a.toNumber(f);case "*":return a.toNumber(d)*a.toNumber(f);case "/":return a.toNumber(d)/a.toNumber(f);
case "%":return a.toNumber(d)%a.toNumber(f);default:throw Error(e.nodeErrorMessage(b,"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(ua){throw ua;}}function O(c,b){try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(e.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw Error(e.nodeErrorMessage(b.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var p=G(c,b.left);
if(!a.isBoolean(p))throw Error(e.nodeErrorMessage(b,"RUNTIME","ONLYBOOLEAN"));switch(b.operator){case "||":if(!0===p)return p;var d=G(c,b.right);if(a.isBoolean(d))return d;throw Error(e.nodeErrorMessage(b,"RUNTIME","ONLYORORAND"));case "\x26\x26":if(!1===p)return p;d=G(c,b.right);if(a.isBoolean(d))return d;throw Error(e.nodeErrorMessage(b,"RUNTIME","ONLYORORAND"));default:throw Error(e.nodeErrorMessage(b,"RUNTIME","ONLYORORAND"));}}catch(za){throw za;}}function S(a,c){var b;try{var p=c.name.toLowerCase();
if(null!==a.localScope&&void 0!==a.localScope[p])return b=a.localScope[p],!0===b.valueset?b.value:(b.value=G(a,b.node),b.valueset=!0,b.value);if(void 0!==a.globalScope[p])return b=a.globalScope[p],!0===b.valueset?b.value:(b.value=G(a,b.node),b.valueset=!0,b.value);throw Error(e.nodeErrorMessage(c,"RUNTIME","VARIABLENOTFOUND"));}catch(za){throw za;}}function H(c,b){try{if("Identifier"!==b.callee.type)throw Error(e.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==c.localScope&&void 0!==
c.localScope[b.callee.name.toLowerCase()]){var p=c.localScope[b.callee.name.toLowerCase()];if(p.value instanceof a.NativeFunction)return p.value.fn(c,b);if(p.value instanceof t)return K(c,b,p.value.definition);throw Error(e.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}if(void 0!==c.globalScope[b.callee.name.toLowerCase()]){p=c.globalScope[b.callee.name.toLowerCase()];if(p.value instanceof a.NativeFunction)return p.value.fn(c,b);if(p.value instanceof t)return K(c,b,p.value.definition);throw Error(e.nodeErrorMessage(b,
"RUNTIME","NOTAFUNCTION"));}throw Error(e.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(na){throw na;}}function Y(p){return null==p?"":a.isArray(p)?"Array":a.isImmutableArray(p)?"Array":a.isDate(p)?"Date":a.isString(p)?"String":a.isBoolean(p)?"Boolean":a.isNumber(p)?"Number":p instanceof c?"Dictionary":p instanceof q?"Feature":p instanceof b?"Point":p instanceof h?"Polygon":p instanceof d?"Polyline":p instanceof k?"Multipoint":p instanceof g?"Extent":a.isFunctionParameter(p)?"Function":p===a.voidOperation?
"":"number"==typeof p&&isNaN(p)?"Number":"Unrecognised Type"}function W(c,b,p,e){try{var d=G(c,b.arguments[p]);if(a.equalityTest(d,e))return G(c,b.arguments[p+1]);var f=b.arguments.length-p;return 1===f?G(c,b.arguments[p]):2===f?null:3===f?G(c,b.arguments[p+2]):W(c,b,p+2,e)}catch(wa){throw wa;}}function E(c,b,p,e){try{if(!0===e)return G(c,b.arguments[p+1]);if(3===b.arguments.length-p)return G(c,b.arguments[p+2]);var d=G(c,b.arguments[p+2]);if(!1===a.isBoolean(d))throw Error("WHEN needs boolean test conditions");
return E(c,b,p+2,d)}catch(ua){throw ua;}}function p(a,c){var b=a.length,e=Math.floor(b/2);if(0===b)c=[];else if(1===b)c=[a[0]];else{var d=p(a.slice(0,e),c);a=p(a.slice(e,b),c);for(b=[];0<d.length||0<a.length;)0<d.length&&0<a.length?(e=c(d[0],a[0]),isNaN(e)&&(e=0),0>=e?(b.push(d[0]),d=d.slice(1)):(b.push(a[0]),a=a.slice(1))):0<d.length?(b.push(d[0]),d=d.slice(1)):0<a.length&&(b.push(a[0]),a=a.slice(1));c=b}return c}function A(c,b,p){try{var e=c.body;if(p.length!==c.params.length)throw Error("Invalid Parameter calls to function.");
for(var d=0;d<p.length;d++)b.localScope[c.params[d].name.toLowerCase()]={value:p[d],valueset:!0,node:null};var f=G(b,e);if(f instanceof a.ReturnResult)return f.value;if(f===a.breakResult)throw Error("Cannot Break from a Function");if(f===a.continueResult)throw Error("Cannot Continue from a Function");return f instanceof a.ImplicitResult?f.value:f}catch(wa){throw wa;}}function K(a,c,b){return F(a,c,function(c,p,e){c={spatialReference:a.spatialReference,applicationCache:void 0===a.applicationCache?
null:a.applicationCache,globalScope:a.globalScope,depthCounter:a.depthCounter+1,console:a.console,localScope:{}};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");return A(b,c,e)})}function U(a){return function(){var c={applicationCache:void 0===a.context.applicationCache?null:a.context.applicationCache,spatialReference:a.context.spatialReference,console:a.context.console,localScope:{},depthCounter:a.context.depthCounter+1,globalScope:a.context.globalScope};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");
return A(a.definition,c,arguments)}}function V(a){console.log(a)}Object.defineProperty(l,"__esModule",{value:!0});var X=0,ba={};r.registerFunctions(ba,F);u.registerFunctions(ba,F);v.registerFunctions(ba,F);x.registerFunctions(ba,F);n.registerFunctions(ba,F);y.registerFunctions(ba,F);ba["typeof"]=function(c,b){return F(c,b,function(c,b,p){a.pcCheck(p,1,1);c=Y(p[0]);if("Unrecognised Type"===c)throw Error("Unrecognised Type");return c})};ba.iif=function(c,b){try{a.pcCheck(null===b.arguments?[]:b.arguments,
3,3);var p=G(c,b.arguments[0]);if(!1===a.isBoolean(p))throw Error("IF Function must have a boolean test condition");return!0===p?G(c,b.arguments[1]):G(c,b.arguments[2])}catch(na){throw na;}};ba.decode=function(a,c){try{if(2>c.arguments.length)throw Error("Missing Parameters");if(2===c.arguments.length)return G(a,c.arguments[1]);if(0===(c.arguments.length-1)%2)throw Error("Must have a default value result.");var b=G(a,c.arguments[0]);return W(a,c,1,b)}catch(na){throw na;}};ba.when=function(c,b){try{if(3>
b.arguments.length)throw Error("Missing Parameters");if(0===b.arguments.length%2)throw Error("Must have a default value result.");var p=G(c,b.arguments[0]);if(!1===a.isBoolean(p))throw Error("WHEN needs boolean test conditions");return E(c,b,0,p)}catch(na){throw na;}};ba.top=function(c,b){return F(c,b,function(c,b,p){if(a.pcCheck(p,2,2),a.isArray(p[0]))return a.toNumber(p[1])>=p[0].length?p[0].slice(0):p[0].slice(0,a.toNumber(p[1]));if(a.isImmutableArray(p[0]))return a.toNumber(p[1])>=p[0].length()?
p[0].slice(0):p[0].slice(0,a.toNumber(p[1]));throw Error("Top cannot accept this parameter type");})};ba.first=function(c,b){return F(c,b,function(c,b,p){return a.pcCheck(p,1,1),a.isArray(p[0])?0===p[0].length?null:p[0][0]:a.isImmutableArray(p[0])?0===p[0].length()?null:p[0].get(0):null})};ba.sort=function(c,b){return F(c,b,function(c,b,e){a.pcCheck(e,1,2);c=e[0];if(a.isImmutableArray(c)&&(c=c.toArray()),!1===a.isArray(c))throw Error("Illegal Argument");if(1<e.length){if(!1===a.isFunctionParameter(e[1]))throw Error("Illegal Argument");
var d=U(e[1]);return c=p(c,function(a,c){return d(a,c)})}if(0===c.length)return[];e={};for(b=0;b<c.length;b++){var f=Y(c[b]);""!==f&&(e[f]=!0)}if(!0===e.Array||!0===e.Dictionary||!0===e.Feature||!0===e.Point||!0===e.Polygon||!0===e.Polyline||!0===e.Multipoint||!0===e.Extent||!0===e.Function)return c.slice(0);b=0;var f="",A;for(A in e)b++,f=A;return c=1<b||"String"===f?p(c,function(c,b){if(null===c||void 0===c||c===a.voidOperation)return null===b||void 0===b||b===a.voidOperation?0:1;if(null===b||void 0===
b||b===a.voidOperation)return-1;c=a.toString(c);b=a.toString(b);return b>c?-1:c===b?0:1}):"Number"===f?p(c,function(a,c){return a-c}):"Boolean"===f?p(c,function(a,c){return a===c?0:c?-1:1}):"Date"===f?p(c,function(a,c){return c-a}):c.slice(0)})};for(var fa in ba)ba[fa]={value:new a.NativeFunction(ba[fa]),valueset:!0,node:null};var ha=function(){};ha.prototype=ba;ha.prototype.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};ha.prototype.pi={value:Math.PI,valueset:!0,node:null};l.functionHelper=
{fixSpatialReference:a.fixSpatialReference,parseArguments:B,standardFunction:F};l.extend=function(c){for(var b={mode:"sync",compiled:!1,functions:{},signatures:[],standardFunction:F,evaluateIdentifier:S,arcadeCustomFunctionHandler:U},p=0;p<c.length;p++)c[p].registerFunctions(b);for(var d in b.functions)ba[d]={value:new a.NativeFunction(b.functions[d]),valueset:!0,node:null},ha.prototype[d]=ba[d];for(p=0;p<b.signatures.length;p++)e.addFunctionDeclaration(b.signatures[p],"f")};l.executeScript=function(b,
p,e){e||(e=new f(102100));var d=p.vars,A=p.customfunctions,g=new ha;d||(d={});A||(A={});var K=new c({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});K.immutable=!1;g.textformatting={value:K,valueset:!0,node:null};for(var E in A)g[E]={value:new a.NativeFunction(A[E]),"native":!0,valueset:!0,node:null};for(E in d)d[E]&&"esri.Graphic"===d[E].declaredClass?g[E]={value:new q(d[E]),valueset:!0,node:null}:g[E]={value:d[E],valueset:!0,node:null};b=G({spatialReference:e,
globalScope:g,localScope:null,console:p.console?p.console:V,depthCounter:1,applicationCache:void 0===p.applicationCache?null:p.applicationCache},b.body[0].body);if(b instanceof a.ReturnResult&&(b=b.value),b instanceof a.ImplicitResult&&(b=b.value),b===a.voidOperation&&(b=null),b===a.breakResult)throw Error("Cannot return BREAK");if(b===a.continueResult)throw Error("Cannot return CONTINUE");if(b instanceof t)throw Error("Cannot return FUNCTION");if(b instanceof a.NativeFunction)throw Error("Cannot return FUNCTION");
return b};l.extractFieldLiterals=function(a,c){return void 0===c&&(c=!1),e.findFieldLiterals(a,c)};l.validateScript=function(a,c){return e.validateScript(a,c,"simple")};l.referencesMember=function(a,c){return e.referencesMember(a,c)};l.referencesFunction=function(a,c){return e.referencesFunction(a,c)};l.findFunctionCalls=function(a){return e.findFunctionCalls(a,!1)}})},"esri/arcade/languageUtils":function(){define("require exports ../geometry/Geometry ../moment dojo/number ./ImmutableArray ../kernel ./ImmutablePointArray ./ImmutablePathArray dojo/_base/array ../geometry/Point ../geometry/Polyline ../geometry/Polygon ../geometry/Extent ../geometry/Multipoint ./FunctionWrapper".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){function x(a,c,b){if(""===c||null===c||void 0===c||c===b||c===b)return a;do a=a.replace(c,b);while(-1!==a.indexOf(c));return a}function y(a){return a instanceof W||a instanceof v||a instanceof E}function n(a){return"string"==typeof a||a instanceof String}function w(a){return"boolean"==typeof a}function z(a){return"number"==typeof a}function C(a){return a instanceof Array}function B(a){return a instanceof Date}function F(a,c){return!1===isNaN(a)?void 0===c||
null===c||""===c?a.toString():(c=x(c,"\u2030",""),c=x(c,"\u00a4",""),b.format(a,{pattern:c})):a.toString()}function G(a,c){a=d(a);return void 0===c||null===c||""===c?a.format():a.format(N(c))}function N(a){return a.replace(/(LTS)|L|l/g,function(a){return"["+a+"]"})}function M(a,c,b){switch(b){case "\x3e":return a>c;case "\x3c":return c>a;case "\x3e\x3d":return a>=c;case "\x3c\x3d":return c>=a}return!1}function R(b,e){if(b===e||null===b&&e===l.voidOperation||null===e&&b===l.voidOperation)return!0;
if(B(b)&&B(e))return b.getTime()===e.getTime();if(b instanceof a||b instanceof f)return b.equalityTest(e);if(b instanceof c&&e instanceof c){var p=void 0,d=void 0;if(l.isVersion4?(p=b.cache._arcadeCacheId,d=e.cache._arcadeCacheId):(p=b.getCacheValue("_arcadeCacheId"),d=e.getCacheValue("_arcadeCacheId")),void 0!==p&&null!==p)return p===d}return void 0!==b&&void 0!==e&&null!==b&&null!==e&&"object"==typeof b&&"object"==typeof e&&(b._arcadeCacheId===e._arcadeCacheId&&void 0!==b._arcadeCacheId&&null!==
b._arcadeCacheId||b._underlyingGraphic===e._underlyingGraphic&&void 0!==b._underlyingGraphic&&null!==b._underlyingGraphic)?!0:!1}function P(a,c){if(n(a))return a;if(null===a)return"";if(z(a))return F(a,c);if(w(a))return a.toString();if(B(a))return G(a,c);if(a instanceof h)return JSON.stringify(a.toJSON());if(C(a)){c=[];for(var b=0;b<a.length;b++)c[b]=T(a[b]);return"["+c.join(",")+"]"}if(a instanceof g){c=[];for(b=0;b<a.length();b++)c[b]=T(a.get(b));return"["+c.join(",")+"]"}return null!==a&&"object"==
typeof a&&void 0!==a.castToText?a.castToText():y(a)?"object, Function":(a===l.voidOperation,"")}function Q(a,c){if(n(a))return a;if(null===a)return"";if(z(a))return F(a,c);if(w(a))return a.toString();if(B(a))return G(a,c);if(a instanceof h)return a instanceof r?'{"xmin":'+a.xmin.toString()+',"ymin":'+a.ymin.toString()+","+(a.hasZ?'"zmin":'+a.zmin.toString()+",":"")+(a.hasM?'"mmin":'+a.mmin.toString()+",":"")+'"xmax":'+a.xmax.toString()+',"ymax":'+a.ymax.toString()+","+(a.hasZ?'"zmax":'+a.zmax.toString()+
",":"")+(a.hasM?'"mmax":'+a.mmax.toString()+",":"")+'"spatialReference":'+H(a.spatialReference)+"}":H(a.toJSON(),function(a,c){return a.key===c.key?0:"spatialReference"===a.key?1:"spatialReference"===c.key?-1:a.key<c.key?-1:a.key>c.key?1:0});if(C(a)){c=[];for(var b=0;b<a.length;b++)c[b]=T(a[b]);return"["+c.join(",")+"]"}if(a instanceof g){c=[];for(b=0;b<a.length();b++)c[b]=T(a.get(b));return"["+c.join(",")+"]"}return null!==a&&"object"==typeof a&&void 0!==a.castToText?a.castToText():y(a)?"object, Function":
(a===l.voidOperation,"")}function T(a){return null===a?"null":w(a)||z(a)||n(a)?JSON.stringify(a):a instanceof h||a instanceof g||a instanceof Array?Q(a):a instanceof Date?JSON.stringify(G(a,"")):null!==a&&"object"==typeof a&&void 0!==a.castToText?a.castToText():"null"}function O(a,c){return z(a)?a:null===a?0:""===a?0:B(a)?NaN:w(a)?a?1:0:C(a)?NaN:""===a?NaN:void 0===a?NaN:void 0!==c&&n(a)?(c=x(c,"\u2030",""),c=x(c,"\u00a4",""),b.parse(a,{pattern:c})):a===l.voidOperation?0:Number(a)}function S(a,c){var b;
return e.some(c.fields,function(c){return c.name===a&&(b=c.domain),!!b}),b}function H(a,c){c||(c={});"function"==typeof c&&(c={cmp:c});var b="boolean"==typeof c.cycles?c.cycles:!1,p=c.cmp&&function(a){return function(c){return function(b,p){return a({key:b,value:c[b]},{key:p,value:c[p]})}}}(c.cmp),e=[];return function ba(a){if(a&&a.toJSON&&"function"==typeof a.toJSON&&(a=a.toJSON()),void 0!==a){if("number"==typeof a)return isFinite(a)?""+a:"null";if("object"!=typeof a)return JSON.stringify(a);var c,
d;if(Array.isArray(a)){d="[";for(c=0;c<a.length;c++)c&&(d+=","),d+=ba(a[c])||"null";return d+"]"}if(null===a)return"null";if(-1!==e.indexOf(a)){if(b)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON");}var f=e.push(a)-1,A=Object.keys(a).sort(p&&p(a));d="";for(c=0;c<A.length;c++){var g=A[c],K=ba(a[g]);K&&(d&&(d+=","),d+=JSON.stringify(g)+":"+K)}return e.splice(f,1),"{"+d+"}"}}(a)}Object.defineProperty(l,"__esModule",{value:!0});m=function(){return function(a){this.value=
a}}();var Y=function(){return function(a){this.value=a}}(),W=function(){return function(a){this.fn=a}}(),E=function(){return function(a){this.fn=a}}();l.NativeFunction=W;l.ImplicitResult=Y;l.ReturnResult=m;l.SizzleFunction=E;l.isVersion4=0===k.version.indexOf("4.");l.voidOperation={type:"VOID"};l.breakResult={type:"BREAK"};l.continueResult={type:"CONTINUE"};l.multiReplace=x;l.isFunctionParameter=y;l.isSimpleType=function(a){return n(a)?!0:z(a)?!0:B(a)?!0:w(a)?!0:null===a?!0:a===l.voidOperation?!0:
"number"==typeof a?!0:!1};l.defaultUndefined=function(a,c){return void 0===a?c:a};l.isString=n;l.isBoolean=w;l.isNumber=z;l.isArray=C;l.isFeatureCursor=function(a){return a&&void 0!==a.isFeatureCursor};l.isImmutableArray=function(a){return a instanceof g};l.isDate=B;l.pcCheck=function(a,c,b){if(a.length<c||a.length>b)throw Error("Function called with wrong number of Parameters");};l.generateUUID=function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var b=
(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"===c?b:3&b|8).toString(16)})};l.formatNumber=F;l.formatDate=G;l.standardiseDateFormat=N;l.greaterThanLessThan=function(a,c,b){if(null===a){if(null===c||c===l.voidOperation)return M(null,null,b);if(z(c))return M(0,c,b);if(n(c)||w(c))return M(0,O(c),b);if(B(c))return M(0,c.getTime(),b)}if(a===l.voidOperation){if(null===c||c===l.voidOperation)return M(null,null,b);if(z(c))return M(0,c,b);if(n(c)||w(c))return M(0,O(c),b);if(B(c))return M(0,c.getTime(),
b)}else if(z(a)){if(z(c))return M(a,c,b);if(w(c))return M(a,O(c),b);if(null===c||c===l.voidOperation)return M(a,0,b);if(n(c))return M(a,O(c),b);if(B(c))return M(a,c.getTime(),b)}else if(n(a)){if(n(c))return M(P(a),P(c),b);if(B(c))return M(O(a),c.getTime(),b);if(z(c))return M(O(a),c,b);if(null===c||c===l.voidOperation)return M(O(a),0,b);if(w(c))return M(O(a),O(c),b)}else if(B(a)){if(B(c))return M(a,c,b);if(null===c||c===l.voidOperation)return M(a.getTime(),0,b);if(z(c))return M(a.getTime(),c,b);if(w(c)||
n(c))return M(a.getTime(),O(c),b)}else if(w(a)){if(w(c))return M(a,c,b);if(z(c))return M(O(a),O(c),b);if(B(c))return M(O(a),c.getTime(),b);if(null===c||c===l.voidOperation)return M(O(a),0,b);if(n(c))return M(O(a),O(c),b)}return!R(a,c)||"\x3c\x3d"!==b&&"\x3e\x3d"!==b?!1:!0};l.equalityTest=R;l.toString=P;l.toNumberArray=function(a){var c=[];if(!1===C(a))return null;if(a instanceof g){for(var b=0;b<a.length();b++)c[b]=O(a.get(b));return c}for(b=0;b<a.length;b++)c[b]=O(a[b]);return c};l.toStringExplicit=
Q;l.toNumber=O;l.toDate=function(a,c){return B(a)?a:n(a)&&(a=d(a,[void 0===c||null===c||""===c?d.ISO_8601:c]),a.isValid())?a.toDate():null};l.toDateM=function(a,c){return B(a)?d(a):n(a)&&(a=d(a,[void 0===c||null===c||""===c?d.ISO_8601:c]),a.isValid())?a:null};l.toBoolean=function(a){return w(a)?a:n(a)?(a=a.toLowerCase(),"true"===a?!0:!1):z(a)?0===a?!1:isNaN(a)?!1:!0:!1};l.fixSpatialReference=function(a,c){return null===a||void 0===a?null:((null===a.spatialReference||void 0===a.spatialReference)&&
(a.spatialReference=c),a)};l.fixNullGeometry=function(a){return null===a?null:a instanceof c?"NaN"===a.x||null===a.x||isNaN(a.x)?null:a:a instanceof t?0===a.rings.length?null:a:a instanceof q?0===a.paths.length?null:a:a instanceof u?0===a.points.length?null:a:a instanceof r?"NaN"===a.xmin||null===a.xmin||isNaN(a.xmin)?null:a:null};l.getDomainValue=function(a,c){if(!a||!a.domain)return null;var b=null;c="string"===a.field.type||"esriFieldTypeString"===a.field.type?P(c):O(c);for(var p=0;p<a.domain.codedValues.length;p++){var e=
a.domain.codedValues[p];e.code===c&&(b=e)}return null===b?null:b.name};l.getDomainCode=function(a,c){if(!a||!a.domain)return null;var b=null;c=P(c);for(var p=0;p<a.domain.codedValues.length;p++){var e=a.domain.codedValues[p];e.name===c&&(b=e)}return null===b?null:b.code};l.getDomain=function(a,c,b,d){if((void 0===b&&(b=null),!c)||!c.fields)return null;for(var p=null,f=0;f<c.fields.length;f++){var A=c.fields[f];A.name.toLowerCase()===a.toString().toLowerCase()&&(p=A)}if(null===p)return null;var g,
E;return d||(d=b&&c.typeIdField&&b._field(c.typeIdField)),null!=d&&e.some(c.types,function(a){return a.id===d?(g=a.domains&&a.domains[p.name],g&&"inherited"===g.type&&(g=S(p.name,c),E=!0),!0):!1}),E||g||(g=S(a,c)),{field:p,domain:g}};l.stableStringify=H})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(m,l,h){return h})},"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel","moment/moment"],function(m,l,h,d){Object.defineProperty(l,"__esModule",
{value:!0});var b={ar:1,"ar-dz":1,"ar-kw":1,"ar-ly":1,"ar-ma":1,"ar-sa":1,"ar-tn":1,bs:1,cs:1,da:1,de:1,"de-at":1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-nz":1,es:1,"es-do":1,"es-us":1,et:1,fi:1,fr:1,"fr-ca":1,"fr-ch":1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sl:1,sr:1,"sr-cyrl":1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1};l.load=function(g,k,f){g=h.locale;var a=g in b;if(!a){var e=g.split("-");1<e.length&&e[0]in b&&
(g=e[0],a=!0)}a?k(["moment/locale/"+g],function(){f(d)}):f(d)}})},"moment/moment":function(){(function(m,l){"object"===typeof exports&&"undefined"!==typeof module?module.exports=l():"function"===typeof define&&define.amd?define(l):m.moment=l()})(this,function(){function m(){return hd.apply(null,arguments)}function l(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function h(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function d(a){if(Object.getOwnPropertyNames)return 0===
Object.getOwnPropertyNames(a).length;for(var c in a)if(a.hasOwnProperty(c))return!1;return!0}function b(a){return void 0===a}function g(a){return"number"===typeof a||"[object Number]"===Object.prototype.toString.call(a)}function k(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function f(a,c){var b=[],p;for(p=0;p<a.length;++p)b.push(c(a[p],p));return b}function a(a,c){return Object.prototype.hasOwnProperty.call(a,c)}function e(c,b){for(var p in b)a(b,p)&&(c[p]=b[p]);
a(b,"toString")&&(c.toString=b.toString);a(b,"valueOf")&&(c.valueOf=b.valueOf);return c}function c(a,c,b,p){return Va(a,c,b,p,!0).utc()}function q(a){null==a._pf&&(a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1});return a._pf}function t(a){if(null==a._isValid){var c=q(a),b=id.call(c.parsedDateParts,function(a){return null!=a}),b=!isNaN(a._d.getTime())&&
0>c.overflow&&!c.empty&&!c.invalidMonth&&!c.invalidWeekday&&!c.weekdayMismatch&&!c.nullInput&&!c.invalidFormat&&!c.userInvalidated&&(!c.meridiem||c.meridiem&&b);a._strict&&(b=b&&0===c.charsLeftOver&&0===c.unusedTokens.length&&void 0===c.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(a))return b;a._isValid=b}return a._isValid}function r(a){var b=c(NaN);null!=a?e(q(b),a):q(b).userInvalidated=!0;return b}function u(a,c){var p,e,d;b(c._isAMomentObject)||(a._isAMomentObject=c._isAMomentObject);b(c._i)||
(a._i=c._i);b(c._f)||(a._f=c._f);b(c._l)||(a._l=c._l);b(c._strict)||(a._strict=c._strict);b(c._tzm)||(a._tzm=c._tzm);b(c._isUTC)||(a._isUTC=c._isUTC);b(c._offset)||(a._offset=c._offset);b(c._pf)||(a._pf=q(c));b(c._locale)||(a._locale=c._locale);if(0<Tc.length)for(p=0;p<Tc.length;p++)e=Tc[p],d=c[e],b(d)||(a[e]=d);return a}function v(a){u(this,a);this._d=new Date(null!=a._d?a._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));!1===Uc&&(Uc=!0,m.updateOffset(this),Uc=!1)}function x(a){return a instanceof
v||null!=a&&null!=a._isAMomentObject}function y(a){return 0>a?Math.ceil(a)||0:Math.floor(a)}function n(a){a=+a;var c=0;0!==a&&isFinite(a)&&(c=y(a));return c}function w(a,c,b){var p=Math.min(a.length,c.length),e=Math.abs(a.length-c.length),d=0,f;for(f=0;f<p;f++)(b&&a[f]!==c[f]||!b&&n(a[f])!==n(c[f]))&&d++;return d+e}function z(a){!1===m.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}function C(a,c){var b=!0;return e(function(){null!=
m.deprecationHandler&&m.deprecationHandler(null,a);if(b){for(var p=[],e,d=0;d<arguments.length;d++){e="";if("object"===typeof arguments[d]){e+="\n["+d+"] ";for(var f in arguments[0])e+=f+": "+arguments[0][f]+", ";e=e.slice(0,-2)}else e=arguments[d];p.push(e)}z(a+"\nArguments: "+Array.prototype.slice.call(p).join("")+"\n"+Error().stack);b=!1}return c.apply(this,arguments)},c)}function B(a,c){null!=m.deprecationHandler&&m.deprecationHandler(a,c);jd[a]||(z(c),jd[a]=!0)}function F(a){return a instanceof
Function||"[object Function]"===Object.prototype.toString.call(a)}function G(c,b){var p=e({},c),d;for(d in b)a(b,d)&&(h(c[d])&&h(b[d])?(p[d]={},e(p[d],c[d]),e(p[d],b[d])):null!=b[d]?p[d]=b[d]:delete p[d]);for(d in c)a(c,d)&&!a(b,d)&&h(c[d])&&(p[d]=e({},p[d]));return p}function N(a){null!=a&&this.set(a)}function M(a,c){var b=a.toLowerCase();Ib[b]=Ib[b+"s"]=Ib[c]=a}function R(a){return"string"===typeof a?Ib[a]||Ib[a.toLowerCase()]:void 0}function P(c){var b={},p,e;for(e in c)a(c,e)&&(p=R(e))&&(b[p]=
c[e]);return b}function Q(a){var c=[],b;for(b in a)c.push({unit:b,priority:Ta[b]});c.sort(function(a,c){return a.priority-c.priority});return c}function T(a,c,b){var p=""+Math.abs(a);return(0<=a?b?"+":"":"-")+Math.pow(10,Math.max(0,c-p.length)).toString().substr(1)+p}function O(a,c,b,p){var e=p;"string"===typeof p&&(e=function(){return this[p]()});a&&(kb[a]=e);c&&(kb[c[0]]=function(){return T(e.apply(this,arguments),c[1],c[2])});b&&(kb[b]=function(){return this.localeData().ordinal(e.apply(this,arguments),
a)})}function S(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function H(a){var c=a.match(Nb),b,p;b=0;for(p=c.length;b<p;b++)c[b]=kb[c[b]]?kb[c[b]]:S(c[b]);return function(b){var e="",d;for(d=0;d<p;d++)e+=F(c[d])?c[d].call(b,a):c[d];return e}}function Y(a,c){if(!a.isValid())return a.localeData().invalidDate();c=W(c,a.localeData());Ob[c]=Ob[c]||H(c);return Ob[c](a)}function W(a,c){function b(a){return c.longDateFormat(a)||a}var p=5;for(Pb.lastIndex=0;0<=p&&Pb.test(a);)a=
a.replace(Pb,b),Pb.lastIndex=0,--p;return a}function E(a,c,b){Vc[a]=F(c)?c:function(a,p){return a&&b?b:c}}function p(c,b){return a(Vc,c)?Vc[c](b._strict,b._locale):new RegExp(A(c))}function A(a){return K(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,c,b,p,e){return c||b||p||e}))}function K(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26")}function U(a,c){var b,p=c;"string"===typeof a&&(a=[a]);g(c)&&(p=function(a,b){b[c]=n(a)});for(b=0;b<a.length;b++)Wc[a[b]]=p}
function V(a,c){U(a,function(a,b,p,e){p._w=p._w||{};c(a,p._w,p,e)})}function X(a){return 0===a%4&&0!==a%100||0===a%400}function ba(a,c){return function(b){return null!=b?(ha(this,a,b),m.updateOffset(this,c),this):fa(this,a)}}function fa(a,c){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+c]():NaN}function ha(a,c,b){if(a.isValid()&&!isNaN(b))if("FullYear"===c&&X(a.year())&&1===a.month()&&29===a.date())a._d["set"+(a._isUTC?"UTC":"")+c](b,a.month(),ca(b,a.month()));else a._d["set"+(a._isUTC?"UTC":
"")+c](b)}function ca(a,c){if(isNaN(a)||isNaN(c))return NaN;var b=(c%12+12)%12;return 1===b?X(a+(c-b)/12)?29:28:31-b%7%2}function ea(a,c){var b;if(!a.isValid())return a;if("string"===typeof c)if(/^\d+$/.test(c))c=n(c);else if(c=a.localeData().monthsParse(c),!g(c))return a;b=Math.min(a.date(),ca(a.year(),c));a._d["set"+(a._isUTC?"UTC":"")+"Month"](c,b);return a}function ja(a){return null!=a?(ea(this,a),m.updateOffset(this,!0),this):fa(this,"Month")}function na(){function a(a,c){return c.length-a.length}
var b=[],p=[],e=[],d,f;for(d=0;12>d;d++)f=c([2E3,d]),b.push(this.monthsShort(f,"")),p.push(this.months(f,"")),e.push(this.months(f,"")),e.push(this.monthsShort(f,""));b.sort(a);p.sort(a);e.sort(a);for(d=0;12>d;d++)b[d]=K(b[d]),p[d]=K(p[d]);for(d=0;24>d;d++)e[d]=K(e[d]);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+e.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+p.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+b.join("|")+")","i")}function za(a,c,b,p,e,d,f){c=
new Date(a,c,b,p,e,d,f);100>a&&0<=a&&isFinite(c.getFullYear())&&c.setFullYear(a);return c}function ua(a){var c=new Date(Date.UTC.apply(null,arguments));100>a&&0<=a&&isFinite(c.getUTCFullYear())&&c.setUTCFullYear(a);return c}function wa(a,c,b){b=7+c-b;return-((7+ua(a,0,b).getUTCDay()-c)%7)+b-1}function da(a,c,b,p,e){b=(7+b-p)%7;p=wa(a,p,e);p=1+7*(c-1)+b+p;0>=p?(c=a-1,a=(X(c)?366:365)+p):p>(X(a)?366:365)?(c=a+1,a=p-(X(a)?366:365)):(c=a,a=p);return{year:c,dayOfYear:a}}function ra(a,c,b){var p=wa(a.year(),
c,b),p=Math.floor((a.dayOfYear()-p-1)/7)+1;1>p?(a=a.year()-1,c=p+ga(a,c,b)):p>ga(a.year(),c,b)?(c=p-ga(a.year(),c,b),a=a.year()+1):(a=a.year(),c=p);return{week:c,year:a}}function ga(a,c,b){var p=wa(a,c,b);c=wa(a+1,c,b);return((X(a)?366:365)-p+c)/7}function pa(a,b,p){var e,d;a=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],e=0;7>e;++e)d=c([2E3,1]).day(e),this._minWeekdaysParse[e]=this.weekdaysMin(d,"").toLocaleLowerCase(),
this._shortWeekdaysParse[e]=this.weekdaysShort(d,"").toLocaleLowerCase(),this._weekdaysParse[e]=this.weekdays(d,"").toLocaleLowerCase();if(p)b="dddd"===b?La.call(this._weekdaysParse,a):"ddd"===b?La.call(this._shortWeekdaysParse,a):La.call(this._minWeekdaysParse,a);else if("dddd"===b){b=La.call(this._weekdaysParse,a);if(-1!==b)return b;b=La.call(this._shortWeekdaysParse,a);if(-1!==b)return b;b=La.call(this._minWeekdaysParse,a)}else if("ddd"===b){b=La.call(this._shortWeekdaysParse,a);if(-1!==b)return b;
b=La.call(this._weekdaysParse,a);if(-1!==b)return b;b=La.call(this._minWeekdaysParse,a)}else{b=La.call(this._minWeekdaysParse,a);if(-1!==b)return b;b=La.call(this._weekdaysParse,a);if(-1!==b)return b;b=La.call(this._shortWeekdaysParse,a)}return-1!==b?b:null}function J(){function a(a,c){return c.length-a.length}var b=[],p=[],e=[],d=[],f,A,g,E;for(f=0;7>f;f++)A=c([2E3,1]).day(f),g=this.weekdaysMin(A,""),E=this.weekdaysShort(A,""),A=this.weekdays(A,""),b.push(g),p.push(E),e.push(A),d.push(g),d.push(E),
d.push(A);b.sort(a);p.sort(a);e.sort(a);d.sort(a);for(f=0;7>f;f++)p[f]=K(p[f]),e[f]=K(e[f]),d[f]=K(d[f]);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+d.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+e.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+p.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+b.join("|")+")","i")}function D(){return this.hours()%12||12}function Ea(a,c){O(a,0,0,function(){return this.localeData().meridiem(this.hours(),
this.minutes(),c)})}function L(a,c){return c._meridiemParse}function Fa(a){return a?a.toLowerCase().replace("_","-"):a}function sa(a){var c=null;if(!$a[a]&&"undefined"!==typeof module&&module&&module.exports)try{c=Bc._abbr,require("./locale/"+a),Z(c)}catch(Sd){}return $a[a]}function Z(a,c){a&&(a=b(c)?Pa(a):ma(a,c))&&(Bc=a);return Bc._abbr}function ma(a,c){if(null!==c){var b=kd;c.abbr=a;if(null!=$a[a])B("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),
b=$a[a]._config;else if(null!=c.parentLocale)if(null!=$a[c.parentLocale])b=$a[c.parentLocale]._config;else return mc[c.parentLocale]||(mc[c.parentLocale]=[]),mc[c.parentLocale].push({name:a,config:c}),null;$a[a]=new N(G(b,c));mc[a]&&mc[a].forEach(function(a){ma(a.name,a.config)});Z(a);return $a[a]}delete $a[a];return null}function Pa(a){var c;a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr);if(!a)return Bc;if(!l(a)){if(c=sa(a))return c;a=[a]}a:{c=0;for(var b,p,e,d;c<a.length;){d=Fa(a[c]).split("-");
b=d.length;for(p=(p=Fa(a[c+1]))?p.split("-"):null;0<b;){if(e=sa(d.slice(0,b).join("-"))){a=e;break a}if(p&&p.length>=b&&w(d,p,!0)>=b-1)break;b--}c++}a=null}return a}function Ia(a){var c;(c=a._a)&&-2===q(a).overflow&&(c=0>c[db]||11<c[db]?db:1>c[xb]||c[xb]>ca(c[ab],c[db])?xb:0>c[bb]||24<c[bb]||24===c[bb]&&(0!==c[tb]||0!==c[Eb]||0!==c[Qb])?bb:0>c[tb]||59<c[tb]?tb:0>c[Eb]||59<c[Eb]?Eb:0>c[Qb]||999<c[Qb]?Qb:-1,q(a)._overflowDayOfYear&&(c<ab||c>xb)&&(c=xb),q(a)._overflowWeeks&&-1===c&&(c=xd),q(a)._overflowWeekday&&
-1===c&&(c=Cc),q(a).overflow=c);return a}function Ha(a,c,b){return null!=a?a:null!=c?c:b}function Xa(a){var c,b=[],p;if(!a._d){p=new Date(m.now());p=a._useUTC?[p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate()]:[p.getFullYear(),p.getMonth(),p.getDate()];if(a._w&&null==a._a[xb]&&null==a._a[db]){var e,d,f,A,g,E;e=a._w;if(null!=e.GG||null!=e.W||null!=e.E){if(g=1,E=4,d=Ha(e.GG,a._a[ab],ra(ka(),1,4).year),f=Ha(e.W,1),A=Ha(e.E,1),1>A||7<A)c=!0}else if(g=a._locale._week.dow,E=a._locale._week.doy,f=ra(ka(),
g,E),d=Ha(e.gg,a._a[ab],f.year),f=Ha(e.w,f.week),null!=e.d){if(A=e.d,0>A||6<A)c=!0}else if(null!=e.e){if(A=e.e+g,0>e.e||6<e.e)c=!0}else A=g;1>f||f>ga(d,g,E)?q(a)._overflowWeeks=!0:null!=c?q(a)._overflowWeekday=!0:(c=da(d,f,A,g,E),a._a[ab]=c.year,a._dayOfYear=c.dayOfYear)}if(null!=a._dayOfYear){c=Ha(a._a[ab],p[ab]);if(a._dayOfYear>(X(c)?366:365)||0===a._dayOfYear)q(a)._overflowDayOfYear=!0;c=ua(c,0,a._dayOfYear);a._a[db]=c.getUTCMonth();a._a[xb]=c.getUTCDate()}for(c=0;3>c&&null==a._a[c];++c)a._a[c]=
b[c]=p[c];for(;7>c;c++)a._a[c]=b[c]=null==a._a[c]?2===c?1:0:a._a[c];24===a._a[bb]&&0===a._a[tb]&&0===a._a[Eb]&&0===a._a[Qb]&&(a._nextDay=!0,a._a[bb]=0);a._d=(a._useUTC?ua:za).apply(null,b);null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm);a._nextDay&&(a._a[bb]=24);a._w&&"undefined"!==typeof a._w.d&&a._w.d!==a._d.getDay()&&(q(a).weekdayMismatch=!0)}}function oa(a){var c,b;c=a._i;var p=yd.exec(c)||zd.exec(c),e,d,f,A;if(p){q(a).iso=!0;c=0;for(b=Dc.length;c<b;c++)if(Dc[c][1].exec(p[1])){d=
Dc[c][0];e=!1!==Dc[c][2];break}if(null==d)a._isValid=!1;else{if(p[3]){c=0;for(b=Xc.length;c<b;c++)if(Xc[c][1].exec(p[3])){f=(p[2]||" ")+Xc[c][0];break}if(null==f){a._isValid=!1;return}}if(e||null==f){if(p[4])if(Ad.exec(p[4]))A="Z";else{a._isValid=!1;return}a._f=d+(f||"")+(A||"");va(a)}else a._isValid=!1}}else a._isValid=!1}function Ma(a){var c=Bd.exec(a._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim());if(c){var b=c[3],p=c[2],e=c[5],d=c[6],f=c[7],A=parseInt(c[4],10),b=[49>=A?2E3+
A:999>=A?1900+A:A,Rb.indexOf(b),parseInt(p,10),parseInt(e,10),parseInt(d,10)];f&&b.push(parseInt(f,10));a:{if(f=c[1])if(f=Sb.indexOf(f),p=(new Date(b[0],b[1],b[2])).getDay(),f!==p){q(a).weekdayMismatch=!0;f=a._isValid=!1;break a}f=!0}f&&(a._a=b,(f=c[8])?c=nc[f]:c[9]?c=0:(c=parseInt(c[10],10),f=c%100,c=(c-f)/100*60+f),a._tzm=c,a._d=ua.apply(null,a._a),a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),q(a).rfc2822=!0)}else a._isValid=!1}function Ka(a){var c=Cd.exec(a._i);null!==c?a._d=new Date(+c[1]):
(oa(a),!1===a._isValid&&(delete a._isValid,Ma(a),!1===a._isValid&&(delete a._isValid,m.createFromInputFallback(a))))}function va(c){if(c._f===m.ISO_8601)oa(c);else if(c._f===m.RFC_2822)Ma(c);else{c._a=[];q(c).empty=!0;var b=""+c._i,e,d,f,A,g,E=b.length,K=0;f=W(c._f,c._locale).match(Nb)||[];for(e=0;e<f.length;e++){A=f[e];if(d=(b.match(p(A,c))||[])[0])g=b.substr(0,b.indexOf(d)),0<g.length&&q(c).unusedInput.push(g),b=b.slice(b.indexOf(d)+d.length),K+=d.length;if(kb[A]){if(d?q(c).empty=!1:q(c).unusedTokens.push(A),
g=c,null!=d&&a(Wc,A))Wc[A](d,g._a,g,A)}else c._strict&&!d&&q(c).unusedTokens.push(A)}q(c).charsLeftOver=E-K;0<b.length&&q(c).unusedInput.push(b);12>=c._a[bb]&&!0===q(c).bigHour&&0<c._a[bb]&&(q(c).bigHour=void 0);q(c).parsedDateParts=c._a.slice(0);q(c).meridiem=c._meridiem;b=c._a;e=bb;E=c._locale;f=c._a[bb];K=c._meridiem;null!=K&&(null!=E.meridiemHour?f=E.meridiemHour(f,K):null!=E.isPM&&((E=E.isPM(K))&&12>f&&(f+=12),E||12!==f||(f=0)));b[e]=f;Xa(c);Ia(c)}}function Wa(a){if(!a._d){var c=P(a._i);a._a=
f([c.year,c.month,c.day||c.date,c.hour,c.minute,c.second,c.millisecond],function(a){return a&&parseInt(a,10)});Xa(a)}}function Za(a){var c=a._i,b=a._f;a._locale=a._locale||Pa(a._l);if(null===c||void 0===b&&""===c)return r({nullInput:!0});"string"===typeof c&&(a._i=c=a._locale.preparse(c));if(x(c))return new v(Ia(c));if(k(c))a._d=c;else if(l(b)){var p,d,f;if(0===a._f.length)q(a).invalidFormat=!0,a._d=new Date(NaN);else{for(c=0;c<a._f.length;c++)if(b=0,p=u({},a),null!=a._useUTC&&(p._useUTC=a._useUTC),
p._f=a._f[c],va(p),t(p)&&(b+=q(p).charsLeftOver,b+=10*q(p).unusedTokens.length,q(p).score=b,null==f||b<f))f=b,d=p;e(a,d||p)}}else b?va(a):Ba(a);t(a)||(a._d=null);return a}function Ba(a){var c=a._i;b(c)?a._d=new Date(m.now()):k(c)?a._d=new Date(c.valueOf()):"string"===typeof c?Ka(a):l(c)?(a._a=f(c.slice(0),function(a){return parseInt(a,10)}),Xa(a)):h(c)?Wa(a):g(c)?a._d=new Date(c):m.createFromInputFallback(a)}function Va(a,c,b,p,e){var f={};if(!0===b||!1===b)p=b,b=void 0;if(h(a)&&d(a)||l(a)&&0===a.length)a=
void 0;f._isAMomentObject=!0;f._useUTC=f._isUTC=e;f._l=b;f._i=a;f._f=c;f._strict=p;a=new v(Ia(Za(f)));a._nextDay&&(a.add(1,"d"),a._nextDay=void 0);return a}function ka(a,c,b,p){return Va(a,c,b,p,!1)}function Ga(a,c){var b,p;1===c.length&&l(c[0])&&(c=c[0]);if(!c.length)return ka();b=c[0];for(p=1;p<c.length;++p)if(!c[p].isValid()||c[p][a](b))b=c[p];return b}function aa(a){for(var c in a)if(-1===La.call(mb,c)||null!=a[c]&&isNaN(a[c]))return!1;c=!1;for(var b=0;b<mb.length;++b)if(a[mb[b]]){if(c)return!1;
parseFloat(a[mb[b]])!==n(a[mb[b]])&&(c=!0)}return!0}function ya(a){a=P(a);var c=a.year||0,b=a.quarter||0,p=a.month||0,e=a.week||0,d=a.day||0,f=a.hour||0,A=a.minute||0,g=a.second||0,E=a.millisecond||0;this._isValid=aa(a);this._milliseconds=+E+1E3*g+6E4*A+36E5*f;this._days=+d+7*e;this._months=+p+3*b+12*c;this._data={};this._locale=Pa();this._bubble()}function Aa(a){return a instanceof ya}function Ca(a){return 0>a?-1*Math.round(-1*a):Math.round(a)}function ta(a,c){O(a,0,0,function(){var a=this.utcOffset(),
b="+";0>a&&(a=-a,b="-");return b+T(~~(a/60),2)+c+T(~~a%60,2)})}function xa(a,c){a=(c||"").match(a);if(null===a)return null;a=((a[a.length-1]||[])+"").match(Ec)||["-",0,0];c=+(60*a[1])+n(a[2]);return 0===c?0:"+"===a[0]?c:-c}function la(a,c){return c._isUTC?(c=c.clone(),a=(x(a)||k(a)?a.valueOf():ka(a).valueOf())-c.valueOf(),c._d.setTime(c._d.valueOf()+a),m.updateOffset(c,!1),c):ka(a).local()}function sb(){return this.isValid()?this._isUTC&&0===this._offset:!1}function Ya(c,b){var p=c,e=null;Aa(c)?p=
{ms:c._milliseconds,d:c._days,M:c._months}:g(c)?(p={},b?p[b]=c:p.milliseconds=c):(e=Fc.exec(c))?(p="-"===e[1]?-1:1,p={y:0,d:n(e[xb])*p,h:n(e[bb])*p,m:n(e[tb])*p,s:n(e[Eb])*p,ms:n(Ca(1E3*e[Qb]))*p}):(e=Gc.exec(c))?(p="-"===e[1]?-1:1,p={y:pb(e[2],p),M:pb(e[3],p),w:pb(e[4],p),d:pb(e[5],p),h:pb(e[6],p),m:pb(e[7],p),s:pb(e[8],p)}):null==p?p={}:"object"===typeof p&&("from"in p||"to"in p)&&(e=ka(p.from),p=ka(p.to),e.isValid()&&p.isValid()?(p=la(p,e),e.isBefore(p)?p=Lb(e,p):(p=Lb(p,e),p.milliseconds=-p.milliseconds,
p.months=-p.months),e=p):e={milliseconds:0,months:0},p={},p.ms=e.milliseconds,p.M=e.months);p=new ya(p);Aa(c)&&a(c,"_locale")&&(p._locale=c._locale);return p}function pb(a,c){a=a&&parseFloat(a.replace(",","."));return(isNaN(a)?0:a)*c}function Lb(a,c){var b={milliseconds:0,months:0};b.months=c.month()-a.month()+12*(c.year()-a.year());a.clone().add(b.months,"M").isAfter(c)&&--b.months;b.milliseconds=+c-+a.clone().add(b.months,"M");return b}function jb(a,c){return function(b,p){var e;null===p||isNaN(+p)||
(B(c,"moment()."+c+"(period, number) is deprecated. Please use moment()."+c+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),e=b,b=p,p=e);b=Ya("string"===typeof b?+b:b,p);Db(this,b,a);return this}}function Db(a,c,b,p){var e=c._milliseconds,d=Ca(c._days);c=Ca(c._months);a.isValid()&&(p=null==p?!0:p,c&&ea(a,fa(a,"Month")+c*b),d&&ha(a,"Date",fa(a,"Date")+d*b),e&&a._d.setTime(a._d.valueOf()+e*b),p&&m.updateOffset(a,d||c))}function vb(a,c){var b=12*(c.year()-
a.year())+(c.month()-a.month()),p=a.clone().add(b,"months");0>c-p?(a=a.clone().add(b-1,"months"),c=(c-p)/(p-a)):(a=a.clone().add(b+1,"months"),c=(c-p)/(a-p));return-(b+c)||0}function qb(a){if(void 0===a)return this._locale._abbr;a=Pa(a);null!=a&&(this._locale=a);return this}function ob(){return this._locale}function fb(a,c){O(0,[a,a.length],0,c)}function kc(a,c,b,p,e){var d;if(null==a)return ra(this,p,e).year;d=ga(a,p,e);c>d&&(c=d);a=da(a,c,b,p,e);a=ua(a.year,0,a.dayOfYear);this.year(a.getUTCFullYear());
this.month(a.getUTCMonth());this.date(a.getUTCDate());return this}function wb(a,c){c[Qb]=n(1E3*("0."+a))}function bc(a){return a}function rb(a,b,p,e){var d=Pa();b=c().set(e,b);return d[p](b,a)}function Hb(a,c,b){g(a)&&(c=a,a=void 0);a=a||"";if(null!=c)return rb(a,c,b,"month");var p=[];for(c=0;12>c;c++)p[c]=rb(a,c,b,"month");return p}function cc(a,c,b,p){"boolean"!==typeof a&&(b=c=a,a=!1);g(c)&&(b=c,c=void 0);c=c||"";var e=Pa();a=a?e._week.dow:0;if(null!=b)return rb(c,(b+a)%7,p,"day");e=[];for(b=0;7>
b;b++)e[b]=rb(c,(b+a)%7,p,"day");return e}function lc(a,c,b,p){c=Ya(c,b);a._milliseconds+=p*c._milliseconds;a._days+=p*c._days;a._months+=p*c._months;return a._bubble()}function Mb(a){return 0>a?Math.floor(a):Math.ceil(a)}function ib(a){return function(){return this.as(a)}}function lb(a){return function(){return this.isValid()?this._data[a]:NaN}}function Ac(a,c,b,p,e){return e.relativeTime(c||1,!!b,a,p)}function Cb(a){return(0<a)-(0>a)||+a}function Tb(){if(!this.isValid())return this.localeData().invalidDate();
var a=Dd(this._milliseconds)/1E3,c=Dd(this._days),b=Dd(this._months),p,e;p=y(a/60);e=y(p/60);a%=60;p%=60;var d=y(b/12),b=b%12,a=a?a.toFixed(3).replace(/\.?0+$/,""):"",f=this.asSeconds();if(!f)return"P0D";var A=0>f?"-":"",g=Cb(this._months)!==Cb(f)?"-":"",E=Cb(this._days)!==Cb(f)?"-":"",f=Cb(this._milliseconds)!==Cb(f)?"-":"";return A+"P"+(d?g+d+"Y":"")+(b?g+b+"M":"")+(c?E+c+"D":"")+(e||p||a?"T":"")+(e?f+e+"H":"")+(p?f+p+"M":"")+(a?f+a+"S":"")}var hd,id;id=Array.prototype.some?Array.prototype.some:
function(a){for(var c=Object(this),b=c.length>>>0,p=0;p<b;p++)if(p in c&&a.call(this,c[p],p,c))return!0;return!1};var Tc=m.momentProperties=[],Uc=!1,jd={};m.suppressDeprecationWarnings=!1;m.deprecationHandler=null;var ld;ld=Object.keys?Object.keys:function(c){var b,p=[];for(b in c)a(c,b)&&p.push(b);return p};var Ib={},Ta={},Nb=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,
Pb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ob={},kb={},Ub=/\d/,cb=/\d\d/,Vb=/\d{3}/,Wb=/\d{4}/,Xb=/[+-]?\d{6}/,Qa=/\d\d?/,oc=/\d\d\d\d?/,dc=/\d\d\d\d\d\d?/,Fb=/\d{1,3}/,Yb=/\d{1,4}/,Zb=/[+-]?\d{1,6}/,pc=/\d+/,Hc=/[+-]?\d+/,Ed=/Z|[+-]\d\d:?\d\d/gi,Ic=/Z|[+-]\d\d(?::?\d\d)?/gi,qc=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Vc={},Wc={},ab=0,db=1,xb=2,bb=3,tb=4,Eb=5,Qb=6,xd=7,Cc=8;O("Y",0,0,function(){var a=this.year();return 9999>=
a?""+a:"+"+a});O(0,["YY",2],0,function(){return this.year()%100});O(0,["YYYY",4],0,"year");O(0,["YYYYY",5],0,"year");O(0,["YYYYYY",6,!0],0,"year");M("year","y");Ta.year=1;E("Y",Hc);E("YY",Qa,cb);E("YYYY",Yb,Wb);E("YYYYY",Zb,Xb);E("YYYYYY",Zb,Xb);U(["YYYYY","YYYYYY"],ab);U("YYYY",function(a,c){c[ab]=2===a.length?m.parseTwoDigitYear(a):n(a)});U("YY",function(a,c){c[ab]=m.parseTwoDigitYear(a)});U("Y",function(a,c){c[ab]=parseInt(a,10)});m.parseTwoDigitYear=function(a){return n(a)+(68<n(a)?1900:2E3)};
var rc=ba("FullYear",!0),La;La=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var c;for(c=0;c<this.length;++c)if(this[c]===a)return c;return-1};O("M",["MM",2],"Mo",function(){return this.month()+1});O("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});O("MMMM",0,0,function(a){return this.localeData().months(this,a)});M("month","M");Ta.month=8;E("M",Qa);E("MM",Qa,cb);E("MMM",function(a,c){return c.monthsShortRegex(a)});E("MMMM",function(a,c){return c.monthsRegex(a)});
U(["M","MM"],function(a,c){c[db]=n(a)-1});U(["MMM","MMMM"],function(a,c,b,p){p=b._locale.monthsParse(a,p,b._strict);null!=p?c[db]=p:q(b).invalidMonth=a});var sc=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Rb="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");O("w",["ww",2],"wo","week");O("W",["WW",2],"Wo","isoWeek");M("week","w");M("isoWeek","W");Ta.week=5;Ta.isoWeek=5;E("w",Qa);E("ww",Qa,cb);E("W",Qa);E("WW",Qa,cb);V(["w","ww","W","WW"],function(a,c,b,p){c[p.substr(0,1)]=n(a)});O("d",0,"do","day");
O("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});O("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});O("dddd",0,0,function(a){return this.localeData().weekdays(this,a)});O("e",0,0,"weekday");O("E",0,0,"isoWeekday");M("day","d");M("weekday","e");M("isoWeekday","E");Ta.day=11;Ta.weekday=11;Ta.isoWeekday=11;E("d",Qa);E("e",Qa);E("E",Qa);E("dd",function(a,c){return c.weekdaysMinRegex(a)});E("ddd",function(a,c){return c.weekdaysShortRegex(a)});E("dddd",function(a,
c){return c.weekdaysRegex(a)});V(["dd","ddd","dddd"],function(a,c,b,p){p=b._locale.weekdaysParse(a,p,b._strict);null!=p?c.d=p:q(b).invalidWeekday=a});V(["d","e","E"],function(a,c,b,p){c[p]=n(a)});var Sb="Sun Mon Tue Wed Thu Fri Sat".split(" ");O("H",["HH",2],0,"hour");O("h",["hh",2],0,D);O("k",["kk",2],0,function(){return this.hours()||24});O("hmm",0,0,function(){return""+D.apply(this)+T(this.minutes(),2)});O("hmmss",0,0,function(){return""+D.apply(this)+T(this.minutes(),2)+T(this.seconds(),2)});
O("Hmm",0,0,function(){return""+this.hours()+T(this.minutes(),2)});O("Hmmss",0,0,function(){return""+this.hours()+T(this.minutes(),2)+T(this.seconds(),2)});Ea("a",!0);Ea("A",!1);M("hour","h");Ta.hour=13;E("a",L);E("A",L);E("H",Qa);E("h",Qa);E("k",Qa);E("HH",Qa,cb);E("hh",Qa,cb);E("kk",Qa,cb);E("hmm",oc);E("hmmss",dc);E("Hmm",oc);E("Hmmss",dc);U(["H","HH"],bb);U(["k","kk"],function(a,c,b){a=n(a);c[bb]=24===a?0:a});U(["a","A"],function(a,c,b){b._isPm=b._locale.isPM(a);b._meridiem=a});U(["h","hh"],function(a,
c,b){c[bb]=n(a);q(b).bigHour=!0});U("hmm",function(a,c,b){var p=a.length-2;c[bb]=n(a.substr(0,p));c[tb]=n(a.substr(p));q(b).bigHour=!0});U("hmmss",function(a,c,b){var p=a.length-4,e=a.length-2;c[bb]=n(a.substr(0,p));c[tb]=n(a.substr(p,2));c[Eb]=n(a.substr(e));q(b).bigHour=!0});U("Hmm",function(a,c,b){b=a.length-2;c[bb]=n(a.substr(0,b));c[tb]=n(a.substr(b))});U("Hmmss",function(a,c,b){b=a.length-4;var p=a.length-2;c[bb]=n(a.substr(0,b));c[tb]=n(a.substr(b,2));c[Eb]=n(a.substr(p))});var Fd=ba("Hours",
!0),kd={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",
d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January February March April May June July August September October November December".split(" "),monthsShort:Rb,week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysShort:Sb,meridiemParse:/[ap]\.?m?\.?/i},$a={},mc={},Bc,yd=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,
zd=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ad=/Z|[+-]\d\d(?::?\d\d)?/,Dc=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Xc=
[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Cd=/^\/?Date\((\-?\d+)/i,Bd=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,nc={UT:0,GMT:0,EDT:-240,
EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};m.createFromInputFallback=C("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});m.ISO_8601=function(){};
m.RFC_2822=function(){};var Jc=C("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=ka.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:r()}),Kc=C("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=ka.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:a:r()}),mb="year quarter month week day hour minute second millisecond".split(" ");
ta("Z",":");ta("ZZ","");E("Z",Ic);E("ZZ",Ic);U(["Z","ZZ"],function(a,c,b){b._useUTC=!0;b._tzm=xa(Ic,a)});var Ec=/([\+\-]|\d\d)/gi;m.updateOffset=function(){};var Fc=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Gc=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;Ya.fn=ya.prototype;Ya.invalid=function(){return Ya(NaN)};var Lc=jb(1,"add"),Mc=jb(-1,"subtract");m.defaultFormat=
"YYYY-MM-DDTHH:mm:ssZ";m.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var $b=C("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});O(0,["gg",2],0,function(){return this.weekYear()%100});O(0,["GG",2],0,function(){return this.isoWeekYear()%100});fb("gggg","weekYear");fb("ggggg","weekYear");fb("GGGG","isoWeekYear");fb("GGGGG","isoWeekYear");M("weekYear",
"gg");M("isoWeekYear","GG");Ta.weekYear=1;Ta.isoWeekYear=1;E("G",Hc);E("g",Hc);E("GG",Qa,cb);E("gg",Qa,cb);E("GGGG",Yb,Wb);E("gggg",Yb,Wb);E("GGGGG",Zb,Xb);E("ggggg",Zb,Xb);V(["gggg","ggggg","GGGG","GGGGG"],function(a,c,b,p){c[p.substr(0,2)]=n(a)});V(["gg","GG"],function(a,c,b,p){c[p]=m.parseTwoDigitYear(a)});O("Q",0,"Qo","quarter");M("quarter","Q");Ta.quarter=7;E("Q",Ub);U("Q",function(a,c){c[db]=3*(n(a)-1)});O("D",["DD",2],"Do","date");M("date","D");Ta.date=9;E("D",Qa);E("DD",Qa,cb);E("Do",function(a,
c){return a?c._dayOfMonthOrdinalParse||c._ordinalParse:c._dayOfMonthOrdinalParseLenient});U(["D","DD"],xb);U("Do",function(a,c){c[xb]=n(a.match(Qa)[0],10)});var tc=ba("Date",!0);O("DDD",["DDDD",3],"DDDo","dayOfYear");M("dayOfYear","DDD");Ta.dayOfYear=4;E("DDD",Fb);E("DDDD",Vb);U(["DDD","DDDD"],function(a,c,b){b._dayOfYear=n(a)});O("m",["mm",2],0,"minute");M("minute","m");Ta.minute=14;E("m",Qa);E("mm",Qa,cb);U(["m","mm"],tb);var Nc=ba("Minutes",!1);O("s",["ss",2],0,"second");M("second","s");Ta.second=
15;E("s",Qa);E("ss",Qa,cb);U(["s","ss"],Eb);var Oc=ba("Seconds",!1);O("S",0,0,function(){return~~(this.millisecond()/100)});O(0,["SS",2],0,function(){return~~(this.millisecond()/10)});O(0,["SSS",3],0,"millisecond");O(0,["SSSS",4],0,function(){return 10*this.millisecond()});O(0,["SSSSS",5],0,function(){return 100*this.millisecond()});O(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});O(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});O(0,["SSSSSSSS",8],0,function(){return 1E5*
this.millisecond()});O(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});M("millisecond","ms");Ta.millisecond=16;E("S",Fb,Ub);E("SS",Fb,cb);E("SSS",Fb,Vb);var ub;for(ub="SSSS";9>=ub.length;ub+="S")E(ub,pc);for(ub="S";9>=ub.length;ub+="S")U(ub,wb);var Pc=ba("Milliseconds",!1);O("z",0,0,"zoneAbbr");O("zz",0,0,"zoneName");var qa=v.prototype;qa.add=Lc;qa.calendar=function(a,c){a=a||ka();var b=la(a,this).startOf("day"),b=m.calendarFormat(this,b)||"sameElse";c=c&&(F(c[b])?c[b].call(this,a):
c[b]);return this.format(c||this.localeData().calendar(b,this,ka(a)))};qa.clone=function(){return new v(this)};qa.diff=function(a,c,b){var p;if(!this.isValid())return NaN;a=la(a,this);if(!a.isValid())return NaN;p=6E4*(a.utcOffset()-this.utcOffset());c=R(c);switch(c){case "year":c=vb(this,a)/12;break;case "month":c=vb(this,a);break;case "quarter":c=vb(this,a)/3;break;case "second":c=(this-a)/1E3;break;case "minute":c=(this-a)/6E4;break;case "hour":c=(this-a)/36E5;break;case "day":c=(this-a-p)/864E5;
break;case "week":c=(this-a-p)/6048E5;break;default:c=this-a}return b?c:y(c)};qa.endOf=function(a){a=R(a);if(void 0===a||"millisecond"===a)return this;"date"===a&&(a="day");return this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")};qa.format=function(a){a||(a=this.isUtc()?m.defaultFormatUtc:m.defaultFormat);a=Y(this,a);return this.localeData().postformat(a)};qa.from=function(a,c){return this.isValid()&&(x(a)&&a.isValid()||ka(a).isValid())?Ya({to:this,from:a}).locale(this.locale()).humanize(!c):
this.localeData().invalidDate()};qa.fromNow=function(a){return this.from(ka(),a)};qa.to=function(a,c){return this.isValid()&&(x(a)&&a.isValid()||ka(a).isValid())?Ya({from:this,to:a}).locale(this.locale()).humanize(!c):this.localeData().invalidDate()};qa.toNow=function(a){return this.to(ka(),a)};qa.get=function(a){a=R(a);return F(this[a])?this[a]():this};qa.invalidAt=function(){return q(this).overflow};qa.isAfter=function(a,c){a=x(a)?a:ka(a);if(!this.isValid()||!a.isValid())return!1;c=R(b(c)?"millisecond":
c);return"millisecond"===c?this.valueOf()>a.valueOf():a.valueOf()<this.clone().startOf(c).valueOf()};qa.isBefore=function(a,c){a=x(a)?a:ka(a);if(!this.isValid()||!a.isValid())return!1;c=R(b(c)?"millisecond":c);return"millisecond"===c?this.valueOf()<a.valueOf():this.clone().endOf(c).valueOf()<a.valueOf()};qa.isBetween=function(a,c,b,p){p=p||"()";return("("===p[0]?this.isAfter(a,b):!this.isBefore(a,b))&&(")"===p[1]?this.isBefore(c,b):!this.isAfter(c,b))};qa.isSame=function(a,c){a=x(a)?a:ka(a);if(!this.isValid()||
!a.isValid())return!1;c=R(c||"millisecond");if("millisecond"===c)return this.valueOf()===a.valueOf();a=a.valueOf();return this.clone().startOf(c).valueOf()<=a&&a<=this.clone().endOf(c).valueOf()};qa.isSameOrAfter=function(a,c){return this.isSame(a,c)||this.isAfter(a,c)};qa.isSameOrBefore=function(a,c){return this.isSame(a,c)||this.isBefore(a,c)};qa.isValid=function(){return t(this)};qa.lang=$b;qa.locale=qb;qa.localeData=ob;qa.max=Kc;qa.min=Jc;qa.parsingFlags=function(){return e({},q(this))};qa.set=
function(a,c){if("object"===typeof a){a=P(a);c=Q(a);for(var b=0;b<c.length;b++)this[c[b].unit](a[c[b].unit])}else if(a=R(a),F(this[a]))return this[a](c);return this};qa.startOf=function(a){a=R(a);switch(a){case "year":this.month(0);case "quarter":case "month":this.date(1);case "week":case "isoWeek":case "day":case "date":this.hours(0);case "hour":this.minutes(0);case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===a&&this.weekday(0);"isoWeek"===a&&this.isoWeekday(1);"quarter"===
a&&this.month(3*Math.floor(this.month()/3));return this};qa.subtract=Mc;qa.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};qa.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}};qa.toDate=function(){return new Date(this.valueOf())};qa.toISOString=function(){if(!this.isValid())return null;var a=
this.clone().utc();return 0>a.year()||9999<a.year()?Y(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):F(Date.prototype.toISOString)?this.toDate().toISOString():Y(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")};qa.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",c="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",c="Z");var a="["+a+'("]',b=0<=this.year()&&9999>=this.year()?"YYYY":"YYYYYY";return this.format(a+b+"-MM-DD[T]HH:mm:ss.SSS"+(c+'[")]'))};qa.toJSON=
function(){return this.isValid()?this.toISOString():null};qa.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};qa.unix=function(){return Math.floor(this.valueOf()/1E3)};qa.valueOf=function(){return this._d.valueOf()-6E4*(this._offset||0)};qa.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};qa.year=rc;qa.isLeapYear=function(){return X(this.year())};qa.weekYear=function(a){return kc.call(this,
a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};qa.isoWeekYear=function(a){return kc.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)};qa.quarter=qa.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)};qa.month=ja;qa.daysInMonth=function(){return ca(this.year(),this.month())};qa.week=qa.weeks=function(a){var c=this.localeData().week(this);return null==a?c:this.add(7*(a-c),"d")};qa.isoWeek=qa.isoWeeks=function(a){var c=
ra(this,1,4).week;return null==a?c:this.add(7*(a-c),"d")};qa.weeksInYear=function(){var a=this.localeData()._week;return ga(this.year(),a.dow,a.doy)};qa.isoWeeksInYear=function(){return ga(this.year(),1,4)};qa.date=tc;qa.day=qa.days=function(a){if(!this.isValid())return null!=a?this:NaN;var c=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=a){var b=this.localeData();"string"===typeof a&&(isNaN(a)?(a=b.weekdaysParse(a),a="number"===typeof a?a:null):a=parseInt(a,10));return this.add(a-c,"d")}return c};
qa.weekday=function(a){if(!this.isValid())return null!=a?this:NaN;var c=(this.day()+7-this.localeData()._week.dow)%7;return null==a?c:this.add(a-c,"d")};qa.isoWeekday=function(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var c=this.localeData();a="string"===typeof a?c.weekdaysParse(a)%7||7:isNaN(a)?null:a;return this.day(this.day()%7?a:a-7)}return this.day()||7};qa.dayOfYear=function(a){var c=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==
a?c:this.add(a-c,"d")};qa.hour=qa.hours=Fd;qa.minute=qa.minutes=Nc;qa.second=qa.seconds=Oc;qa.millisecond=qa.milliseconds=Pc;qa.utcOffset=function(a,c,b){var p=this._offset||0,e;if(!this.isValid())return null!=a?this:NaN;if(null!=a){if("string"===typeof a){if(a=xa(Ic,a),null===a)return this}else 16>Math.abs(a)&&!b&&(a*=60);!this._isUTC&&c&&(e=15*-Math.round(this._d.getTimezoneOffset()/15));this._offset=a;this._isUTC=!0;null!=e&&this.add(e,"m");p!==a&&(!c||this._changeInProgress?Db(this,Ya(a-p,"m"),
1,!1):this._changeInProgress||(this._changeInProgress=!0,m.updateOffset(this,!0),this._changeInProgress=null));return this}return this._isUTC?p:15*-Math.round(this._d.getTimezoneOffset()/15)};qa.utc=function(a){return this.utcOffset(0,a)};qa.local=function(a){this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};qa.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var a=
xa(Ed,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this};qa.hasAlignedHourOffset=function(a){if(!this.isValid())return!1;a=a?ka(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};qa.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};qa.isLocal=function(){return this.isValid()?!this._isUTC:!1};qa.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};qa.isUtc=sb;qa.isUTC=sb;qa.zoneAbbr=function(){return this._isUTC?
"UTC":""};qa.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""};qa.dates=C("dates accessor is deprecated. Use date instead.",tc);qa.months=C("months accessor is deprecated. Use month instead",ja);qa.years=C("years accessor is deprecated. Use year instead",rc);qa.zone=C("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(a,c){return null!=a?("string"!==typeof a&&(a=-a),this.utcOffset(a,c),this):-this.utcOffset()});
qa.isDSTShifted=C("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!b(this._isDSTShifted))return this._isDSTShifted;var a={};u(a,this);a=Za(a);if(a._a){var p=a._isUTC?c(a._a):ka(a._a);this._isDSTShifted=this.isValid()&&0<w(a._a,p.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var Na=N.prototype;Na.calendar=function(a,c,b){a=this._calendar[a]||this._calendar.sameElse;return F(a)?a.call(c,b):a};Na.longDateFormat=
function(a){var c=this._longDateFormat[a],b=this._longDateFormat[a.toUpperCase()];if(c||!b)return c;this._longDateFormat[a]=b.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)});return this._longDateFormat[a]};Na.invalidDate=function(){return this._invalidDate};Na.ordinal=function(a){return this._ordinal.replace("%d",a)};Na.preparse=bc;Na.postformat=bc;Na.relativeTime=function(a,c,b,p){var e=this._relativeTime[b];return F(e)?e(a,c,b,p):e.replace(/%d/i,a)};Na.pastFuture=function(a,c){a=this._relativeTime[0<
a?"future":"past"];return F(a)?a(c):a.replace(/%s/i,c)};Na.set=function(a){var c,b;for(b in a)c=a[b],F(c)?this[b]=c:this["_"+b]=c;this._config=a;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)};Na.months=function(a,c){return a?l(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||sc).test(c)?"format":"standalone"][a.month()]:l(this._months)?this._months:this._months.standalone};Na.monthsShort=
function(a,c){return a?l(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[sc.test(c)?"format":"standalone"][a.month()]:l(this._monthsShort)?this._monthsShort:this._monthsShort.standalone};Na.monthsParse=function(a,b,p){var e,d;if(this._monthsParseExact){a:{a=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],e=0;12>e;++e)d=c([2E3,e]),this._shortMonthsParse[e]=this.monthsShort(d,"").toLocaleLowerCase(),this._longMonthsParse[e]=
this.months(d,"").toLocaleLowerCase();if(p)b="MMM"===b?La.call(this._shortMonthsParse,a):La.call(this._longMonthsParse,a);else if("MMM"===b){b=La.call(this._shortMonthsParse,a);if(-1!==b)break a;b=La.call(this._longMonthsParse,a)}else{b=La.call(this._longMonthsParse,a);if(-1!==b)break a;b=La.call(this._shortMonthsParse,a)}b=-1!==b?b:null}return b}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(e=0;12>e;e++)if(d=c([2E3,e]),p&&!this._longMonthsParse[e]&&
(this._longMonthsParse[e]=new RegExp("^"+this.months(d,"").replace(".","")+"$","i"),this._shortMonthsParse[e]=new RegExp("^"+this.monthsShort(d,"").replace(".","")+"$","i")),p||this._monthsParse[e]||(d="^"+this.months(d,"")+"|^"+this.monthsShort(d,""),this._monthsParse[e]=new RegExp(d.replace(".",""),"i")),p&&"MMMM"===b&&this._longMonthsParse[e].test(a)||p&&"MMM"===b&&this._shortMonthsParse[e].test(a)||!p&&this._monthsParse[e].test(a))return e};Na.monthsRegex=function(c){if(this._monthsParseExact)return a(this,
"_monthsRegex")||na.call(this),c?this._monthsStrictRegex:this._monthsRegex;a(this,"_monthsRegex")||(this._monthsRegex=qc);return this._monthsStrictRegex&&c?this._monthsStrictRegex:this._monthsRegex};Na.monthsShortRegex=function(c){if(this._monthsParseExact)return a(this,"_monthsRegex")||na.call(this),c?this._monthsShortStrictRegex:this._monthsShortRegex;a(this,"_monthsShortRegex")||(this._monthsShortRegex=qc);return this._monthsShortStrictRegex&&c?this._monthsShortStrictRegex:this._monthsShortRegex};
Na.week=function(a){return ra(a,this._week.dow,this._week.doy).week};Na.firstDayOfYear=function(){return this._week.doy};Na.firstDayOfWeek=function(){return this._week.dow};Na.weekdays=function(a,c){return a?l(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(c)?"format":"standalone"][a.day()]:l(this._weekdays)?this._weekdays:this._weekdays.standalone};Na.weekdaysMin=function(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin};Na.weekdaysShort=function(a){return a?
this._weekdaysShort[a.day()]:this._weekdaysShort};Na.weekdaysParse=function(a,b,p){var e,d;if(this._weekdaysParseExact)return pa.call(this,a,b,p);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(e=0;7>e;e++)if(d=c([2E3,1]).day(e),p&&!this._fullWeekdaysParse[e]&&(this._fullWeekdaysParse[e]=new RegExp("^"+this.weekdays(d,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[e]=new RegExp("^"+this.weekdaysShort(d,"").replace(".",
".?")+"$","i"),this._minWeekdaysParse[e]=new RegExp("^"+this.weekdaysMin(d,"").replace(".",".?")+"$","i")),this._weekdaysParse[e]||(d="^"+this.weekdays(d,"")+"|^"+this.weekdaysShort(d,"")+"|^"+this.weekdaysMin(d,""),this._weekdaysParse[e]=new RegExp(d.replace(".",""),"i")),p&&"dddd"===b&&this._fullWeekdaysParse[e].test(a)||p&&"ddd"===b&&this._shortWeekdaysParse[e].test(a)||p&&"dd"===b&&this._minWeekdaysParse[e].test(a)||!p&&this._weekdaysParse[e].test(a))return e};Na.weekdaysRegex=function(c){if(this._weekdaysParseExact)return a(this,
"_weekdaysRegex")||J.call(this),c?this._weekdaysStrictRegex:this._weekdaysRegex;a(this,"_weekdaysRegex")||(this._weekdaysRegex=qc);return this._weekdaysStrictRegex&&c?this._weekdaysStrictRegex:this._weekdaysRegex};Na.weekdaysShortRegex=function(c){if(this._weekdaysParseExact)return a(this,"_weekdaysRegex")||J.call(this),c?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;a(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=qc);return this._weekdaysShortStrictRegex&&c?this._weekdaysShortStrictRegex:
this._weekdaysShortRegex};Na.weekdaysMinRegex=function(c){if(this._weekdaysParseExact)return a(this,"_weekdaysRegex")||J.call(this),c?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;a(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=qc);return this._weekdaysMinStrictRegex&&c?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};Na.isPM=function(a){return"p"===(a+"").toLowerCase().charAt(0)};Na.meridiem=function(a,c,b){return 11<a?b?"pm":"PM":b?"am":"AM"};Z("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,
ordinal:function(a){var c=a%10,c=1===n(a%100/10)?"th":1===c?"st":2===c?"nd":3===c?"rd":"th";return a+c}});m.lang=C("moment.lang is deprecated. Use moment.locale instead.",Z);m.langData=C("moment.langData is deprecated. Use moment.localeData instead.",Pa);var gb=Math.abs,md=ib("ms"),nd=ib("s"),od=ib("m"),pd=ib("h"),I=ib("d"),ac=ib("w"),eb=ib("M"),Gb=ib("y"),ia=lb("milliseconds"),Md=lb("seconds"),Nd=lb("minutes"),Od=lb("hours"),Pd=lb("days"),Qd=lb("months"),Rd=lb("years"),ec=Math.round,Jb={ss:44,s:45,
m:45,h:22,d:26,M:11},Dd=Math.abs,Oa=ya.prototype;Oa.isValid=function(){return this._isValid};Oa.abs=function(){var a=this._data;this._milliseconds=gb(this._milliseconds);this._days=gb(this._days);this._months=gb(this._months);a.milliseconds=gb(a.milliseconds);a.seconds=gb(a.seconds);a.minutes=gb(a.minutes);a.hours=gb(a.hours);a.months=gb(a.months);a.years=gb(a.years);return this};Oa.add=function(a,c){return lc(this,a,c,1)};Oa.subtract=function(a,c){return lc(this,a,c,-1)};Oa.as=function(a){if(!this.isValid())return NaN;
var c,b=this._milliseconds;a=R(a);if("month"===a||"year"===a)return c=this._days+b/864E5,c=this._months+4800*c/146097,"month"===a?c:c/12;c=this._days+Math.round(146097*this._months/4800);switch(a){case "week":return c/7+b/6048E5;case "day":return c+b/864E5;case "hour":return 24*c+b/36E5;case "minute":return 1440*c+b/6E4;case "second":return 86400*c+b/1E3;case "millisecond":return Math.floor(864E5*c)+b;default:throw Error("Unknown unit "+a);}};Oa.asMilliseconds=md;Oa.asSeconds=nd;Oa.asMinutes=od;Oa.asHours=
pd;Oa.asDays=I;Oa.asWeeks=ac;Oa.asMonths=eb;Oa.asYears=Gb;Oa.valueOf=function(){return this.isValid()?this._milliseconds+864E5*this._days+this._months%12*2592E6+31536E6*n(this._months/12):NaN};Oa._bubble=function(){var a=this._milliseconds,c=this._days,b=this._months,p=this._data;0<=a&&0<=c&&0<=b||0>=a&&0>=c&&0>=b||(a+=864E5*Mb(146097*b/4800+c),b=c=0);p.milliseconds=a%1E3;a=y(a/1E3);p.seconds=a%60;a=y(a/60);p.minutes=a%60;a=y(a/60);p.hours=a%24;c+=y(a/24);a=y(4800*c/146097);b+=a;c-=Mb(146097*a/4800);
a=y(b/12);p.days=c;p.months=b%12;p.years=a;return this};Oa.clone=function(){return Ya(this)};Oa.get=function(a){a=R(a);return this.isValid()?this[a+"s"]():NaN};Oa.milliseconds=ia;Oa.seconds=Md;Oa.minutes=Nd;Oa.hours=Od;Oa.days=Pd;Oa.weeks=function(){return y(this.days()/7)};Oa.months=Qd;Oa.years=Rd;Oa.humanize=function(a){if(!this.isValid())return this.localeData().invalidDate();var c=this.localeData(),b;b=!a;var p=Ya(this).abs(),e=ec(p.as("s")),d=ec(p.as("m")),f=ec(p.as("h")),A=ec(p.as("d")),g=ec(p.as("M")),
p=ec(p.as("y")),e=e<=Jb.ss&&["s",e]||e<Jb.s&&["ss",e]||1>=d&&["m"]||d<Jb.m&&["mm",d]||1>=f&&["h"]||f<Jb.h&&["hh",f]||1>=A&&["d"]||A<Jb.d&&["dd",A]||1>=g&&["M"]||g<Jb.M&&["MM",g]||1>=p&&["y"]||["yy",p];e[2]=b;e[3]=0<+this;e[4]=c;b=Ac.apply(null,e);a&&(b=c.pastFuture(+this,b));return c.postformat(b)};Oa.toISOString=Tb;Oa.toString=Tb;Oa.toJSON=Tb;Oa.locale=qb;Oa.localeData=ob;Oa.toIsoString=C("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Tb);Oa.lang=$b;O("X",0,
0,"unix");O("x",0,0,"valueOf");E("x",Hc);E("X",/[+-]?\d+(\.\d{1,3})?/);U("X",function(a,c,b){b._d=new Date(1E3*parseFloat(a,10))});U("x",function(a,c,b){b._d=new Date(n(a))});m.version="2.19.2";hd=ka;m.fn=qa;m.min=function(){var a=[].slice.call(arguments,0);return Ga("isBefore",a)};m.max=function(){var a=[].slice.call(arguments,0);return Ga("isAfter",a)};m.now=function(){return Date.now?Date.now():+new Date};m.utc=c;m.unix=function(a){return ka(1E3*a)};m.months=function(a,c){return Hb(a,c,"months")};
m.isDate=k;m.locale=Z;m.invalid=r;m.duration=Ya;m.isMoment=x;m.weekdays=function(a,c,b){return cc(a,c,b,"weekdays")};m.parseZone=function(){return ka.apply(null,arguments).parseZone()};m.localeData=Pa;m.isDuration=Aa;m.monthsShort=function(a,c){return Hb(a,c,"monthsShort")};m.weekdaysMin=function(a,c,b){return cc(a,c,b,"weekdaysMin")};m.defineLocale=ma;m.updateLocale=function(a,c){if(null!=c){var b,p=kd;b=sa(a);null!=b&&(p=b._config);c=G(p,c);c=new N(c);c.parentLocale=$a[a];$a[a]=c;Z(a)}else null!=
$a[a]&&(null!=$a[a].parentLocale?$a[a]=$a[a].parentLocale:null!=$a[a]&&delete $a[a]);return $a[a]};m.locales=function(){return ld($a)};m.weekdaysShort=function(a,c,b){return cc(a,c,b,"weekdaysShort")};m.normalizeUnits=R;m.relativeTimeRounding=function(a){return void 0===a?ec:"function"===typeof a?(ec=a,!0):!1};m.relativeTimeThreshold=function(a,c){if(void 0===Jb[a])return!1;if(void 0===c)return Jb[a];Jb[a]=c;"s"===a&&(Jb.ss=c-1);return!0};m.calendarFormat=function(a,c){a=a.diff(c,"days",!0);return-6>
a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":7>a?"nextWeek":"sameElse"};m.prototype=qa;return m})},"esri/arcade/ImmutableArray":function(){define(["require","exports"],function(m,l){return function(){function h(d){void 0===d&&(d=[]);this._elements=d}return h.prototype.length=function(){return this._elements.length},h.prototype.get=function(d){return this._elements[d]},h.prototype.toArray=function(){for(var d=[],b=0;b<this.length();b++)d.push(this.get(b));return d},h}()})},
"esri/arcade/ImmutablePointArray":function(){define("require exports ../core/tsSupport/extendsHelper ./ImmutableArray ../geometry/Point ../kernel".split(" "),function(m,l,h,d,b,g){var k=0===g.version.indexOf("4.");return function(d){function a(a,c,b,f,g,k){a=d.call(this,a)||this;return a._lazyPt=[],a._hasZ=!1,a._hasM=!1,a._spRef=c,a._hasZ=b,a._hasM=f,a._cacheId=g,a._partId=k,a}return h(a,d),a.prototype.get=function(a){if(void 0===this._lazyPt[a]){var c=this._elements[a];if(void 0===c)return;var e=
this._hasZ,d=this._hasM,f=null,f=e&&!d?new b(c[0],c[1],c[2],void 0,this._spRef):d&&e?new b(c[0],c[1],void 0,c[2],this._spRef):e&&d?new b(c[0],c[1],c[2],c[3],this._spRef):new b(c[0],c[1],this._spRef);k?f.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+a.toString():f.setCacheValue("_arcadeCacheId",this._cacheId.toString()+"-"+this._partId.toString()+"-"+a.toString());this._lazyPt[a]=f}return this._lazyPt[a]},a.prototype.equalityTest=function(b){return b===this?!0:null===
b?!1:0==b instanceof a?!1:b.getUniqueHash()===this.getUniqueHash()},a.prototype.getUniqueHash=function(){return this._cacheId.toString()+"-"+this._partId.toString()},a}(d)})},"esri/arcade/ImmutablePathArray":function(){define(["require","exports","../core/tsSupport/extendsHelper","./ImmutableArray","./ImmutablePointArray"],function(m,l,h,d,b){return function(d){function g(b,a,e,c,g){b=d.call(this,b)||this;return b._lazyPath=[],b._hasZ=!1,b._hasM=!1,b._hasZ=e,b._hasM=c,b._spRef=a,b._cacheId=g,b}return h(g,
d),g.prototype.get=function(d){if(void 0===this._lazyPath[d]){var a=this._elements[d];if(void 0===a)return;this._lazyPath[d]=new b(a,this._spRef,this._hasZ,this._hasM,this._cacheId,d)}return this._lazyPath[d]},g.prototype.equalityTest=function(b){return b===this?!0:null===b?!1:0==b instanceof g?!1:b.getUniqueHash()===this.getUniqueHash()},g.prototype.getUniqueHash=function(){return this._cacheId.toString()},g}(d)})},"esri/arcade/FunctionWrapper":function(){define(["require","exports"],function(m,
l){return function(){return function(h,d){this.context=this.definition=null;this.definition=h;this.context=d}}()})},"esri/arcade/treeAnalysis":function(){define(["require","exports"],function(m,l){function h(a,c,b,e){return"0"!==a.min&&b.length<Number(a.min)?-2:"*"!==a.max&&b.length>Number(a.max)?-2:1}function d(a,c,b){if(null!==b.localScope&&void 0!==b.localScope[a.toLowerCase()]){var e=b.localScope[a.toLowerCase()];if("FormulaFunction"===e.type||"any"===e.type)return void 0===e.signature&&(e.signature=
{min:"0",max:"*"}),h(e.signature,a,c,b)}return void 0!==b.globalScope[a.toLowerCase()]&&(e=b.globalScope[a.toLowerCase()],"FormulaFunction"===e.type||"any"===e.type)?(void 0===e.signature&&(e.signature={min:"0",max:"*"}),h(e.signature,a,c,b)):-1}function b(a,c){void 0===c&&(c=!0);var e=t(a,"SYNTAX","UNREOGNISED");try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?t(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"):"Identifier"!==a.id.type?t(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER"):
null!==a.init?b(a.init,!1):"";case "VariableDeclaration":for(var d=0;d<a.declarations.length;d++)if(e=b(a.declarations[d],c),""!==e)return e;return"";case "ForInStatement":if(e=b(a.left,c),""!==e)break;if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return t(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return t(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return t(a,"SYNTAX","LEFTNOTVAR");return e=b(a.right,c),""!==e?e:(e=b(a.body,c),""!==
e?e:"");case "ForStatement":return null!==a.test&&(e=b(a.test,c),""!==e)?e:null!==a.init&&(e=b(a.init,c),""!==e)?e:null!==a.update&&(e=b(a.update,c),""!==e)?e:null!==a.body&&(e=b(a.body,c),""!==e)?e:"";case "ContinueStatement":return"";case "EmptyStatement":return"";case "BreakStatement":return"";case "IfStatement":return e=b(a.test,c),""!==e?e:null!==a.consequent&&(e=b(a.consequent,!1),""!==e)?e:null!==a.alternate&&(e=b(a.alternate,!1),""!==e)?e:"";case "BlockStatement":for(var f=[],d=0;d<a.body.length;d++)"EmptyStatement"!==
a.body[d].type&&f.push(a.body[d]);a.body=f;for(d=0;d<a.body.length;d++)if(e=b(a.body[d],c),""!==e)return e;return"";case "FunctionDeclaration":return!1===c?t(a,"SYNTAX","GLOBALFUNCTIONSONLY"):"Identifier"!==a.id.type?t(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"):b(a.body,!1);case "ReturnStatement":return null!==a.argument?b(a.argument,c):"";case "UpdateExpression":return"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?t(a,"SYNTAX","ASSIGNMENTTOVARSONLY"):b(a.argument,c);case "AssignmentExpression":if("Identifier"!==
a.left.type&&"MemberExpression"!==a.left.type)return t(a,"SYNTAX","ASSIGNMENTTOVARSONLY");if(e=b(a.left,c),""!==e)break;switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:return t(a,"SYNTAX","OPERATORNOTRECOGNISED")}return b(a.right,!1);case "ExpressionStatement":return b(a.expression,!1);case "Identifier":e="";break;case "MemberExpression":return e=b(a.object,c),""!==e?e:!0===a.computed?b(a.property,c):"";case "Literal":return"";case "ThisExpression":return t(a,
"SYNTAX","NOTSUPPORTED");case "CallExpression":if("Identifier"!==a.callee.type)return t(a,"SYNTAX","ONLYNODESSUPPORTED");e="";for(d=0;d<a.arguments.length;d++)if(e=b(a.arguments[d],c),""!==e)return e;return"";case "UnaryExpression":e=b(a.argument,c);break;case "BinaryExpression":if(e=b(a.left,c),""!==e)break;if(e=b(a.right,c),""!==e)break;switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:return t(a,
"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "LogicalExpression":if(e=b(a.left,c),""!==e)break;if(e=b(a.right),""!==e)break;switch(a.operator){case "\x26\x26":case "||":break;default:return t(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "ConditionalExpression":return t(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":e="";for(d=0;d<a.elements.length&&(e=b(a.elements[d],c),""===e);d++);break;case "Array":return t(a,"SYNTAX","NOTSUPPORTED");case "ObjectExpression":e="";for(d=0;d<a.properties.length;d++){if(e=
"",null!==a.properties[d].key&&("Literal"!==a.properties[d].key.type&&"Identifier"!==a.properties[d].key.type&&(e=t(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[d].key.type))f=a.properties[d].key.value,"string"==typeof f||f instanceof String||(e=t(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"));if(""===e&&(e=b(a.properties[d],c)),""!==e)break}break;case "Property":return"Literal"!==a.key.type&&"Identifier"!==a.key.type?t(a,"SYNTAX","ONLYLITERAL"):"Identifier"!==a.key.type&&(e=b(a.key,
c),""!==e)?e:e=b(a.value,c)}return e}catch(B){throw B;}}function g(a,b){var f=t(a,"SYNTAX","UNREOGNISED"),n=null,k="";try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type)return t(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR");null!==b.localScope?void 0!==b.localScope[a.id.name.toLowerCase()]:void 0!==b.globalScope[a.id.name.toLowerCase()];var h=null===a.init?"":g(a.init,b);return""!==h?h:(null===b.localScope?b.globalScope[a.id.name.toLowerCase()]={type:"any"}:
b.localScope[a.id.name.toLowerCase()]={type:"any"},"");case "FunctionDeclaration":return n=e(a.id.name.toLowerCase(),a,b),k=c(a,b),""!==k?k:null!==b.localScope?t(a,"SYNTAX","GLOBALFUNCTIONSONLY"):(n.isnative=!1,b.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[n]},"");case "VariableDeclaration":for(var f="",q=0;q<a.declarations.length&&(f=g(a.declarations[q],b),""===f);q++);break;case "IfStatement":return f=g(a.test,b),""!==f?f:"AssignmentExpression"===a.test.type||"UpdateExpression"===
a.test.type?t(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):null!==a.consequent&&(f=g(a.consequent,b),""!==f)?f:null!==a.alternate&&(f=g(a.alternate,b),""!==f)?f:"";case "EmptyStatement":return"";case "BlockStatement":for(q=0;q<a.body.length;q++)if(f=g(a.body[q],b),""!==f)return f;return"";case "ReturnStatement":return null!==a.argument?g(a.argument,b):"";case "ForInStatement":if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return t(a,"SYNTAX","ONLY1VAR");if(null!==
a.left.declarations[0].init)return t(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return t(a,"SYNTAX","LEFTNOTVAR");return f=g(a.left,b),""!==f?f:(f=g(a.right,b),""!==f?f:(f=g(a.body,b),""!==f?f:""));case "ForStatement":return null!==a.init&&(f=g(a.init,b),""!==f)?f:null!==a.test&&(f=g(a.test,b),""!==f)?f:null!==a.body&&(f=g(a.body,b),""!==f)?f:null!==a.update&&(f=g(a.update,b),""!==f)?f:"";case "BreakStatement":return"";case "ContinueStatement":return"";case "UpdateExpression":if("Identifier"!==
a.argument.type&&"MemberExpression"!==a.argument.type)return t(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var r=!1;return"MemberExpression"===a.argument.type?g(a.argument,b):(null!==b.localScope&&void 0!==b.localScope[a.argument.name.toLowerCase()]&&(r=!0),void 0!==b.globalScope[a.argument.name.toLowerCase()]&&(r=!0),!1===r?"Identifier "+a.argument.name+" has not been declared.":"");case "AssignmentExpression":if("Identifier"!==a.left.type&&"MemberExpression"!==a.left.type)return t(a,"SYNTAX","ASSIGNMENTTOVARSONLY");
var l=g(a.right,b);return""!==l?l:(r=!1,"MemberExpression"===a.left.type?(l=g(a.left,b),""!==l?l:""):(null!==b.localScope&&void 0!==b.localScope[a.left.name.toLowerCase()]&&(r=!0),void 0!==b.globalScope[a.left.name.toLowerCase()]&&(r=!0),!1===r?"Identifier "+a.left.name+" has not been declared.":""));case "ExpressionStatement":return g(a.expression,b);case "Identifier":var u=a.name.toLowerCase();if(null!==b.localScope&&void 0!==b.localScope[u])return"";f=void 0!==b.globalScope[u]?"":t(a,"SYNTAX",
"VARIABLENOTFOUND");break;case "MemberExpression":return f=g(a.object,b),""!==f?f:!0===a.computed?g(a.property,b):"";case "Literal":return"";case "ThisExpression":f=t(a,"SYNTAX","NOTSUPPORTED");break;case "CallExpression":if("Identifier"!==a.callee.type)return t(a,"SYNTAX","ONLYNODESSUPPORTED");f="";for(q=0;q<a.arguments.length;q++)if(f=g(a.arguments[q],b),""!==f)return f;var v=d(a.callee.name,a.arguments,b);-1===v&&(f=t(a,"SYNTAX","NOTFOUND"));-2===v&&(f=t(a,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":f=
g(a.argument,b);break;case "BinaryExpression":return f=g(a.left,b),""!==f?f:(f=g(a.right,b),""!==f?f:"");case "LogicalExpression":return f=g(a.left,b),""!==f?f:"AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type?t(a.left,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):(f=g(a.right,b),""!==f?f:"AssignmentExpression"===a.right.type||"UpdateExpression"===a.right.type?t(a.right,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):"");case "ConditionalExpression":return t(a,"SYNTAX","NOTSUPPORTED");
case "ArrayExpression":f="";for(q=0;q<a.elements.length&&(f=g(a.elements[q],b),""===f);q++);break;case "ObjectExpression":f="";for(q=0;q<a.properties.length;q++){if(f="",null!==a.properties[q].key&&("Literal"!==a.properties[q].key.type&&"Identifier"!==a.properties[q].key.type&&(f=t(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[q].key.type)){var y=a.properties[q].key.value;"string"==typeof y||y instanceof String||(f=t(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}if(""===f&&(f=g(a.properties[q],
b)),""!==f)break}break;case "Property":return"Literal"!==a.key.type&&"Identifier"!==a.key.type?t(a,"SYNTAX","ONLYLITERAL"):"Identifier"!==a.key.type&&(f=g(a.key,b),""!==f)?f:f=g(a.value,b);case "Array":return t(a,"SYNTAX","NOTSUPPORTED")}return f}catch(Q){throw Q;}}function k(a,c){var b=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?k(a.init,c):b;case "FunctionDeclaration":return k(a.body,c);case "VariableDeclaration":for(var e=0;e<a.declarations.length;e++)if(k(a.declarations[e],
c))return!0;return b;case "IfStatement":return k(a.test,c)?!0:null!==a.consequent&&k(a.consequent,c)?!0:null!==a.alternate&&k(a.alternate,c)?!0:b;case "EmptyStatement":return b;case "BlockStatement":for(e=0;e<a.body.length;e++)if(k(a.body[e],c))return!0;return b;case "ReturnStatement":return null!==a.argument?k(a.argument,c):b;case "UpdateExpression":return k(a.argument,c);case "AssignmentExpression":return b=k(a.right,c),b?b:k(a.left,c);case "ExpressionStatement":return k(a.expression,c);case "ForInStatement":return(b=
k(a.left,c))?b:(b=k(a.right,c))?b:(b=k(a.body,c),b);case "ForStatement":return null!==a.init&&(b=k(a.init,c))?b:null!==a.test&&(b=k(a.test,c))?b:null!==a.body&&(b=k(a.body,c))?b:(null!==a.update&&(b=k(a.update,c)),b);case "BreakStatement":return b;case "ContinueStatement":return b;case "Compound":return b;case "Identifier":return c.toLowerCase()===a.name.toLowerCase();case "MemberExpression":return(b=k(a.object,c))?b:(!0===a.computed&&(b=k(a.property,c)),b);case "Literal":return b;case "ThisExpression":return b;
case "CallExpression":for(e=0;e<a.arguments.length;e++)k(a.arguments[e],c)&&(b=!0);return b;case "ArrayExpression":for(e=0;e<a.elements.length;e++)k(a.elements[e],c)&&(b=!0);return b;case "UnaryExpression":return k(a.argument,c);case "BinaryExpression":return(b=k(a.left,c))?b:b=k(a.right,c);case "LogicalExpression":return(b=k(a.left,c))?b:b=k(a.right,c);case "ObjectExpression":for(e=0;e<a.properties.length;e++)k(a.properties[e],c)&&(b=!0);return b;case "Property":return b=k(a.value,c);case "ConditionalExpression":return b;
case "Array":return b;default:return b}}catch(C){throw C;}}function f(a,c){var b=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?f(a.init,c):b;case "FunctionDeclaration":return f(a.body,c);case "VariableDeclaration":for(var e=0;e<a.declarations.length;e++)if(f(a.declarations[e],c))return!0;return b;case "IfStatement":return f(a.test,c)?!0:null!==a.consequent&&f(a.consequent,c)?!0:null!==a.alternate&&f(a.alternate,c)?!0:b;case "EmptyStatement":return b;case "BlockStatement":for(e=
0;e<a.body.length;e++)if(f(a.body[e],c))return!0;return b;case "ReturnStatement":return null!==a.argument?f(a.argument,c):b;case "UpdateExpression":return f(a.argument,c);case "AssignmentExpression":return f(a.left,c)?!0:f(a.right,c);case "ExpressionStatement":return f(a.expression,c);case "ForInStatement":return(b=f(a.left,c))?b:(b=f(a.right,c))?b:(b=f(a.body,c),b);case "ForStatement":return null!==a.init&&(b=f(a.init,c))?b:null!==a.test&&(b=f(a.test,c))?b:null!==a.body&&(b=f(a.body,c))?b:(null!==
a.update&&(b=f(a.update,c)),b);case "BreakStatement":return b;case "ContinueStatement":return b;case "Compound":return b;case "Identifier":return b;case "MemberExpression":return(b=f(a.object,c))?b:(!0===a.computed&&(b=f(a.property,c)),b);case "Literal":return b;case "ThisExpression":return b;case "CallExpression":if(a.callee.name.toLowerCase()===c.toLowerCase())return!0;for(e=0;e<a.arguments.length;e++)f(a.arguments[e],c)&&(b=!0);return b;case "ArrayExpression":for(e=0;e<a.elements.length;e++)f(a.elements[e],
c)&&(b=!0);return b;case "UnaryExpression":return f(a.argument,c);case "BinaryExpression":return(b=f(a.left,c))?b:b=f(a.right,c);case "LogicalExpression":return(b=f(a.left,c))?b:b=f(a.right,c);case "ConditionalExpression":return b;case "ObjectExpression":for(e=0;e<a.properties.length;e++)f(a.properties[e],c)&&(b=!0);return b;case "Property":return b=f(a.value,c);case "Array":return b;default:return b}}catch(C){throw C;}}function a(c,b){var e,d=[];try{switch(c.type){case "VariableDeclarator":return null!==
c.init?a(c.init,b):d;case "FunctionDeclaration":return a(c.body,b);case "VariableDeclaration":for(var f=0;f<c.declarations.length;f++)e=a(c.declarations[f],b),d=d.concat(e);return d;case "ForInStatement":return e=a(c.left,b),d=d.concat(e),e=a(c.right,b),d=d.concat(e),e=a(c.body,b),d=d.concat(e);case "ForStatement":return null!==c.init&&(e=a(c.init,b),d=d.concat(e)),null!==c.test&&(e=a(c.test,b),d=d.concat(e)),null!==c.body&&(e=a(c.body,b),d=d.concat(e)),null!==c.update&&(e=a(c.update,b),d=d.concat(e)),
d;case "IfStatement":return e=a(c.test,b),d=d.concat(e),null!==c.consequent&&(e=a(c.consequent,b),d=d.concat(e)),null!==c.alternate&&(e=a(c.alternate,b),d=d.concat(e)),d;case "EmptyStatement":return d;case "BlockStatement":for(f=0;f<c.body.length;f++)e=a(c.body[f],b),d=d.concat(e);return d;case "ReturnStatement":return null!==c.argument?a(c.argument,b):d;case "UpdateExpression":return a(c.argument,b);case "AssignmentExpression":return d=a(c.left,b),d=d.concat(a(c.right,b));case "ExpressionStatement":return a(c.expression,
b);case "BreakStatement":return d;case "ContinueStatement":return d;case "Compound":return d;case "Identifier":return d;case "MemberExpression":if("Identifier"!==c.object.type)return d;if(!1===c.computed)d.push(c.object.name.toLowerCase()+"."+c.property.name.toLowerCase());else try{"Literal"===c.property.type&&"string"==typeof c.property.value&&d.push(c.object.name.toLowerCase()+"."+c.property.value.toString().toLowerCase())}catch(B){}return d;case "Literal":return d;case "ThisExpression":return d;
case "CallExpression":for(f=0;f<c.arguments.length;f++)e=a(c.arguments[f],b),d=d.concat(e);return d;case "ArrayExpression":for(f=0;f<c.elements.length;f++)e=a(c.elements[f],b),d=d.concat(e);return d;case "UnaryExpression":return a(c.argument,b);case "ObjectExpression":for(f=0;f<c.properties.length;f++)e=a(c.properties[f],b),d=d.concat(e);return d;case "Property":return a(c.value,b);case "BinaryExpression":return e=a(c.left,b),d=d.concat(e),e=a(c.right,b),d=d.concat(e);case "LogicalExpression":return e=
a(c.left,b),d=d.concat(e),e=a(c.right,b),d=d.concat(e);case "ConditionalExpression":return d;case "Array":return d;default:return d}}catch(B){throw B;}}function e(a,c,b){b=[];if(void 0!==c.params&&null!==c.params)for(var e=0;e<c.params.length;e++)b.push("any");return{name:a,"return":"any",params:b}}function c(a,c){c={globalScope:c.globalScope,localScope:{}};for(var b=0;b<a.params.length;b++)c.localScope[a.params[b].name.toLowerCase()]={type:"any"};return g(a.body,c)}function q(a,c,b,e){var d={};void 0!==
a&&null!==a||(a={});void 0!==b&&null!==b||(b={});d.infinity={type:"any"};d.textformatting={type:"any"};d.pi={type:"any"};for(var f in c)("simple"!==e||"simple"===e&&"a"===c[f].av)&&(d[f]={type:"FormulaFunction",signature:{min:c[f].min,max:c[f].max}},"simple"!==e&&(void 0!==c[f].fmin&&(d[f].signature.min=c[f].fmin),void 0!==c[f].fmax&&(d[f].signature.max=c[f].fmax)));for(c=0;c<b.length;c++)f=b[c],d[f.name]={type:"FormulaFunction",signature:f};for(f in a)d[f]=a[f],d[f].type="any";return d}function t(a,
c,b){var e="";switch(c){case "SYNTAX":e="Syntax Error: ";break;case "RUNTIME":e="Runtime Error: ";break;default:e="Syntax Error: "}try{switch(a.type){case "IfStatement":switch(b){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":e+=" Assignments not be made in logical tests";break;case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":e+=" Non Boolean used as Condition"}break;case "UpdateExpression":case "AssignmentExpression":switch(b){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":e+=" Assignments not be made in logical tests";
break;case "ASSIGNMENTTOVARSONLY":e+=" Assignments can only be made to identifiers"}break;case "ExpressionStatement":e+=" Assignments can only be made to identifiers";break;case "FunctionDeclaration":switch(b){case "GLOBALFUNCTIONSONLY":e+=" Functions cannot be declared as variables";break;case "FUNCTIONMUSTHAVEIDENTIFIER":e+=" Function Definition must have an identifier"}break;case "VariableDeclaration":e+=" Only 1 variable can be declared at a time";break;case "VariableDeclarator":switch(b){case "FUNCTIONVARIABLEDECLARATOR":e+=
" Functions cannot be declared as variables";break;case "VARIABLEMUSTHAVEIDENTIFIER":e+=" Variable Definition must have an identifier"}break;case "Identifier":e+=" Identifier Not Found. ";e+=a.name;break;case "ObjectExpression":switch(b){case "OBJECTPROPERTYMUSTBESTRING":e+=" Property name must be a string"}break;case "ForStatement":switch(b){case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":e+=" Non Boolean used as Condition"}break;case "ForInStatement":switch(b){case "ONLY1VAR":e+=" Can only declare 1 var for use with IN";
break;case "CANNOTDECLAREVAL":e+=" Can only declare value for use with IN";break;case "LEFTNOVAR":e+="Must provide a variable to iterate with.";break;case "VARIABLENOTDECLARED":e+="Variable must be declared before it is used..";break;case "CANNOTITERATETHISTYPE":e+="This type cannot be used in an IN loop"}break;case "MemberExpression":switch(b){case "PROPERTYNOTFOUND":e+="Cannot find member property. ";e+=!1===a.computed?a.property.name:"";break;case "OUTOFBOUNDS":e+="Out of Bounds. ";e+=!1===a.computed?
a.property.name:"";break;case "NOTFOUND":e+="Cannot call member method on null. ";e+=!1===a.computed?a.property.name:"";break;case "INVALIDTYPE":e+="Cannot call member property on object of this type. ",e+=!1===a.computed?a.property.name:""}break;case "Property":switch(b){case "ONLYLITERAL":e+="Property names must be literals or identifiers"}break;case "Literal":break;case "ThisExpression":e+="THIS construct is not supported.";case "CallExpression":switch(b){case "WRONGSIGNATURE":e+="Function signature does not match: ";
e+=a.callee.name;break;case "ONLYNODESUPPORTED":e+="Functions must be declared.";e+=a.callee.name;break;case "NOTAFUNCTION":e+="Not a Function: ";e+=a.callee.name;break;case "NOTFOUND":e+="Function Not Found: "+a.callee.name}break;case "UnaryExpression":switch(b){case "NOTSUPPORTEDUNARYOPERATOR":e+="Operator "+a.operator+" not allowed in this context. Only ! can be used with boolean, and - with a number";break;case "NOTSUPPORTEDTYPE":e+="Unary operator "+a.operator+" cannot be used with this argument."}case "BinaryExpression":switch(b){case "OPERATORNOTRECOGNISED":e+=
"Binary Operator not recognised "+a.operator}break;case "LogicalExpression":switch(b){case "ONLYBOOLEAN":e+="Operator "+a.operator+" cannot be used. Only || or \x26\x26 are allowed values";break;case "ONLYORORAND":e+="Logical Expression "+a.operator+" being applied to parameters that are not boolean."}break;case "ConditionalExpression":e+="Conditional statements not supported.";break;case "ArrayExpression":switch(b){case "FUNCTIONCONTEXTILLEGAL":e+=" Cannot Put Function inside Array."}break;case "Array":e+=
"Expression contains unrecognised array structure.";break;default:e+="Expression contains unrecognised code structures."}}catch(C){throw C;}return e}function r(a,c,b){return{line:a.loc.start.line,character:a.loc.start.column,reason:t(a,c,b)}}function u(a,c,b,e,d){void 0===d&&(d=!0);c={globalScope:c.globalScope,localScope:{}};for(d=0;d<a.params.length;d++)c.localScope[a.params[d].name.toLowerCase()]={type:"any"};v(a.body,c,b,e,!1)}function v(a,c,b,f,g){if(void 0===g&&(g=!0),null===a)throw Error("Unnexpexted Expression Syntax");
var n=null;try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?void f.push(r(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR")):("Identifier"!==a.id.type?f.push(r(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER")):(null!==c.localScope?void 0!==c.localScope[a.id.name.toLowerCase()]:void 0!==c.globalScope[a.id.name.toLowerCase()],null===c.localScope?c.globalScope[a.id.name.toLowerCase()]={type:"any"}:c.localScope[a.id.name.toLowerCase()]={type:"any"}),void(null===a.init?
"":v(a.init,c,b,f,g)));case "FunctionDeclaration":return!1===g&&f.push(r(a,"SYNTAX","GLOBALFUNCTIONSONLY")),"Identifier"!==a.id.type&&f.push(r(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER")),n=e("",a,c),u(a,c,b,f,g),null!==c.localScope&&f.push(r(a,"SYNTAX","GLOBALFUNCTIONSONLY")),n.isnative=!1,void("Identifier"===a.id.type&&(c.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[n]}));case "VariableDeclaration":for(var k=0;k<a.declarations.length;k++)v(a.declarations[k],c,b,f,g);break;
case "IfStatement":return null!==a.test&&(v(a.test,c,b,f,g),("AssignmentExpression"===a.test.type||"UpdateExpression"===a.test.type)&&f.push(r(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"))),null!==a.consequent&&v(a.consequent,c,b,f,g),void(null!==a.alternate&&v(a.alternate,c,b,f,g));case "EmptyStatement":break;case "BlockStatement":if(null!==a.body)for(k=0;k<a.body.length;k++)v(a.body[k],c,b,f,g);break;case "ReturnStatement":return void(null!==a.argument&&v(a.argument,c,b,f,g));case "ForInStatement":return"VariableDeclaration"===
a.left.type?(1<a.left.declarations.length&&f.push(r(a,"SYNTAX","ONLY1VAR")),null!==a.left.declarations[0].init&&f.push(r(a,"SYNTAX","CANNOTDECLAREVAL"))):"Identifier"!==a.left.type&&f.push(r(a,"SYNTAX","LEFTNOTVAR")),v(a.left,c,b,f,g),v(a.right,c,b,f,g),void v(a.body,c,b,f,g);case "ForStatement":return null!==a.init&&v(a.init,c,b,f,g),null!==a.test&&v(a.test,c,b,f,g),null!==a.body&&v(a.body,c,b,f,g),void(null!==a.update&&v(a.update,c,b,f,g));case "BreakStatement":break;case "ContinueStatement":break;
case "UpdateExpression":"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?f.push(r(a,"SYNTAX","ASSIGNMENTTOVARSONLY")):("Identifier"===a.argument.type&&(n=!1,!1===b&&(null!==c.localScope&&void 0!==c.localScope[a.argument.name.toLowerCase()]&&(n=!0),void 0!==c.globalScope[a.argument.name.toLowerCase()]&&(n=!0),!1===n&&f.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."}))),"MemberExpression"===
a.argument.type&&v(a.argument,c,b,f,g));break;case "AssignmentExpression":switch("Identifier"!==a.left.type&&"MemberExpression"!==a.left.type&&f.push(r(a,"SYNTAX","ASSIGNMENTTOVARSONLY")),a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:f.push(r(a,"SYNTAX","OPERATORNOTRECOGNISED"))}v(a.right,c,b,f,g);n=!1;return"Identifier"===a.left.type&&(null!==c.localScope&&void 0!==c.localScope[a.left.name.toLowerCase()]&&(n=!0),void 0!==c.globalScope[a.left.name.toLowerCase()]&&
(n=!0),!1===b&&!1===n&&f.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."})),void("MemberExpression"===a.left.type&&v(a.left,c,b,f,g));case "ExpressionStatement":return void v(a.expression,c,b,f,g);case "Identifier":var h=a.name.toLowerCase();if(null!==c.localScope&&void 0!==c.localScope[h])break;if(void 0!==c.globalScope[h])break;!1===b&&f.push(r(a,"SYNTAX","VARIABLENOTFOUND"));break;case "MemberExpression":return v(a.object,
c,b,f,g),void(!0===a.computed&&v(a.property,c,b,f,g));case "Literal":return"";case "ThisExpression":f.push(r(a,"SYNTAX","NOTSUPPORTED"));break;case "CallExpression":"Identifier"!==a.callee.type&&f.push(r(a,"SYNTAX","ONLYNODESSUPPORTED"));for(k=0;k<a.arguments.length;k++)v(a.arguments[k],c,b,f,g);var q=d(a.callee.name,a.arguments,c);return!1===b&&-1===q&&f.push(r(a,"SYNTAX","NOTFOUND")),void(-2===q&&f.push(r(a,"SYNTAX","WRONGSIGNATURE")));case "UnaryExpression":return void v(a.argument,c,b,f,g);case "BinaryExpression":switch(v(a.left,
c,b,f,g),v(a.right,c,b,f,g),a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:f.push(r(a,"SYNTAX","OPERATORNOTRECOGNISED"))}break;case "LogicalExpression":switch(a.operator){case "\x26\x26":case "||":break;default:f.push(r(a,"SYNTAX","OPERATORNOTRECOGNISED"))}return v(a.left,c,b,f,g),("AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type)&&f.push(r(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")),
v(a.right,c,b,f,g),void(("AssignmentExpression"===a.right.type||"UpdateExpression"===a.right.type)&&f.push(r(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")));case "ConditionalExpression":f.push(r(a,"SYNTAX","NOTSUPPORTED"));break;case "ArrayExpression":for(k=0;k<a.elements.length;k++)v(a.elements[k],c,b,f,g);break;case "Array":f.push(r(a,"SYNTAX","NOTSUPPORTED"));case "ObjectExpression":for(k=0;k<a.properties.length;k++)v(a.properties[k],c,b,f,g);break;case "Property":return"Literal"!==a.key.type&&
"Identifier"!==a.key.type&&f.push(r(a,"SYNTAX","ONLYLITERAL")),"Literal"===a.key.type&&v(a.key,c,b,f,g),void v(a.value,c,b,f,g);default:f.push(r(a,"SYNTAX","UNRECOGNISED"))}}catch(M){f.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Unnexpected Syntax"})}}function x(a,c){var b,e=[];try{switch(a.type){case "VariableDeclarator":return null!==a.init?x(a.init,c):e;case "FunctionDeclaration":return x(a.body,c);case "VariableDeclaration":for(var d=0;d<a.declarations.length;d++)b=
x(a.declarations[d],c),e=e.concat(b);return e;case "ForInStatement":return b=x(a.left,c),e=e.concat(b),b=x(a.right,c),e=e.concat(b),b=x(a.body,c),e=e.concat(b);case "ForStatement":return null!==a.init&&(b=x(a.init,c),e=e.concat(b)),null!==a.test&&(b=x(a.test,c),e=e.concat(b)),null!==a.body&&(b=x(a.body,c),e=e.concat(b)),null!==a.update&&(b=x(a.update,c),e=e.concat(b)),e;case "IfStatement":return b=x(a.test,c),e=e.concat(b),null!==a.consequent&&(b=x(a.consequent,c),e=e.concat(b)),null!==a.alternate&&
(b=x(a.alternate,c),e=e.concat(b)),e;case "EmptyStatement":return e;case "BlockStatement":for(d=0;d<a.body.length;d++)b=x(a.body[d],c),e=e.concat(b);return e;case "ReturnStatement":return null!==a.argument?x(a.argument,c):e;case "UpdateExpression":return x(a.argument,c);case "AssignmentExpression":return e=x(a.left,c),e=e.concat(x(a.right,c));case "ExpressionStatement":return x(a.expression,c);case "BreakStatement":return e;case "ContinueStatement":return e;case "Compound":return e;case "Identifier":return e;
case "MemberExpression":return e;case "Literal":return e;case "ThisExpression":return e;case "CallExpression":for(d=0;d<a.arguments.length;d++)b=x(a.arguments[d],c),e=e.concat(b);return e.push(a.callee.name.toLowerCase()),e;case "ArrayExpression":for(d=0;d<a.elements.length;d++)b=x(a.elements[d],c),e=e.concat(b);return e;case "UnaryExpression":return x(a.argument,c);case "ObjectExpression":for(d=0;d<a.properties.length;d++)b=x(a.properties[d],c),e=e.concat(b);return e;case "Property":return x(a.value,
c);case "BinaryExpression":return b=x(a.left,c),e=e.concat(b),b=x(a.right,c),e=e.concat(b);case "LogicalExpression":return b=x(a.left,c),e=e.concat(b),b=x(a.right,c),e=e.concat(b);case "ConditionalExpression":return e;case "Array":return e;default:return e}}catch(B){throw B;}}Object.defineProperty(l,"__esModule",{value:!0});l.functionDecls={concatenate:{min:"0",max:"*",av:"a"},split:{min:"2",max:"4",av:"a"},guid:{min:"0",max:"1",av:"a"},today:{min:"0",max:"0",av:"a"},now:{min:"0",max:"0",av:"a"},
timestamp:{min:"0",max:"0",av:"a"},day:{min:"1",max:"1",av:"a"},month:{min:"1",max:"1",av:"a"},year:{min:"1",max:"1",av:"a"},hour:{min:"1",max:"1",av:"a"},second:{min:"1",max:"1",av:"a"},millisecond:{min:"1",max:"1",av:"a"},minute:{min:"1",max:"1",av:"a"},weekday:{min:"1",max:"1",av:"a"},toutc:{min:"1",max:"1",av:"a"},tolocal:{min:"1",max:"1",av:"a"},date:{min:"0",max:"7",av:"a"},datediff:{min:"2",max:"3",av:"a"},dateadd:{min:"2",max:"3",av:"a"},trim:{min:"1",max:"1",av:"a"},text:{min:"1",max:"2",
av:"a"},left:{min:"2",max:"2",av:"a"},right:{min:"2",max:"2",av:"a"},mid:{min:"2",max:"3",av:"a"},upper:{min:"1",max:"1",av:"a"},proper:{min:"1",max:"2",av:"a"},lower:{min:"1",max:"1",av:"a"},find:{min:"2",max:"3",av:"a"},iif:{min:"3",max:"3",av:"a"},decode:{min:"2",max:"*",av:"a"},when:{min:"2",max:"*",av:"a"},defaultvalue:{min:"2",max:"2",av:"a"},isempty:{min:"1",max:"1",av:"a"},domaincode:{min:"3",max:"4",av:"a"},domainname:{min:"2",max:"4",av:"a"},polygon:{min:"1",max:"1",av:"a"},point:{min:"1",
max:"1",av:"a"},polyline:{min:"1",max:"1",av:"a"},extent:{min:"1",max:"1",av:"a"},multipoint:{min:"1",max:"1",av:"a"},geometry:{min:"1",max:"1",av:"a"},count:{min:"0",max:"*",av:"a"},number:{min:"1",max:"2",av:"a"},acos:{min:"1",max:"1",av:"a"},asin:{min:"1",max:"1",av:"a"},atan:{min:"1",max:"1",av:"a"},atan2:{min:"2",max:"2",av:"a"},ceil:{min:"1",max:"2",av:"a"},floor:{min:"1",max:"2",av:"a"},round:{min:"1",max:"2",av:"a"},cos:{min:"1",max:"1",av:"a"},exp:{min:"1",max:"1",av:"a"},log:{min:"1",max:"1",
av:"a"},min:{min:"0",max:"*",av:"a"},constrain:{min:"3",max:"3",av:"a"},console:{min:"0",max:"*",av:"a"},max:{min:"0",max:"*",av:"a"},pow:{min:"2",max:"2",av:"a"},random:{min:"0",max:"0",av:"a"},sqrt:{min:"1",max:"1",av:"a"},sin:{min:"1",max:"1",av:"a"},tan:{min:"1",max:"1",av:"a"},abs:{min:"1",max:"1",av:"a"},isnan:{min:"1",max:"1",av:"a"},stdev:{min:"0",max:"*",av:"a"},average:{min:"0",max:"*",av:"a"},mean:{min:"0",max:"*",av:"a"},sum:{min:"0",max:"*",av:"a"},variance:{min:"0",max:"*",av:"a"},distinct:{min:"0",
max:"*",av:"a"},first:{min:"1",max:"1",av:"a"},top:{min:"2",max:"2",av:"a"},"boolean":{min:"1",max:"1",av:"a"},dictionary:{min:"0",max:"*",av:"a"},"typeof":{min:"1",max:"1",av:"a"},reverse:{min:"1",max:"1",av:"a"},replace:{min:"3",max:"4",av:"a"},sort:{min:"1",max:"2",av:"a"},feature:{min:"1",max:"*",av:"a"},haskey:{min:"2",max:"2",av:"a"},indexof:{min:"2",max:"2",av:"a"},disjoint:{min:"2",max:"2",av:"a"},intersects:{min:"2",max:"2",av:"a"},touches:{min:"2",max:"2",av:"a"},crosses:{min:"2",max:"2",
av:"a"},within:{min:"2",max:"2",av:"a"},contains:{min:"2",max:"2",av:"a"},overlaps:{min:"2",max:"2",av:"a"},equals:{min:"2",max:"2",av:"a"},relate:{min:"3",max:"3",av:"a"},intersection:{min:"2",max:"2",av:"a"},union:{min:"1",max:"2",av:"a"},difference:{min:"2",max:"2",av:"a"},symmetricdifference:{min:"2",max:"2",av:"a"},clip:{min:"2",max:"2",av:"a"},cut:{min:"2",max:"2",av:"a"},area:{min:"1",max:"2",av:"a"},areageodetic:{min:"1",max:"2",av:"a"},length:{min:"1",max:"2",av:"a"},lengthgeodetic:{min:"1",
max:"2",av:"a"},distance:{min:"2",max:"3",av:"a"},densify:{min:"2",max:"3",av:"a"},densifygeodetic:{min:"2",max:"3",av:"a"},generalize:{min:"2",max:"4",av:"a"},buffer:{min:"2",max:"3",av:"a"},buffergeodetic:{min:"2",max:"3",av:"a"},offset:{min:"2",max:"6",av:"a"},rotate:{min:"2",max:"3",av:"a"},issimple:{min:"1",max:"1",av:"a"},simplify:{min:"1",max:"1",av:"a"},centroid:{min:"1",max:"1",av:"a"},multiparttosinglepart:{min:"1",max:"1",av:"a"},setgeometry:{min:"2",max:"2",av:"a"}};l.addFunctionDeclaration=
function(a,c){var b=l.functionDecls[a.name.toLowerCase()];void 0===b?l.functionDecls[a.name.toLowerCase()]={min:a.min,max:a.max,av:c}:"a"===b.av&&"f"===c?(void 0!==b.fmin&&delete b.fmin,void 0!==b.fmax&&delete b.fmax,b.fmin=a.min,b.fmax=a.max):"f"===b.av&&"a"===c?(void 0===b.fmin&&(b.fmin=b.min),void 0===b.fmax&&(b.fmax=b.max),b.min=a.min,b.max=a.max,b.av="a"):"f"===c?(b.fmin=a.min,b.fmax=a.max):"a"===c&&(b.min=a.min,b.max=a.max)};l.checkFunctionSignature=h;l.findFunction=d;l.validateLanguageNode=
b;l.testValidityOfExpression=g;l.referencesMemberImpl=k;l.referencesMember=function(a,c){return!0===k(a.body[0].body,c.toLowerCase())?!0:!1};l.referencesFunctionImpl=f;l.referencesFunction=function(a,c){return!0===f(a.body[0].body,c)?!0:!1};l.findFieldLiteralsImpl=a;l.findFieldLiterals=function(c,b){return a(c.body[0].body,b)};l.extractFunctionDeclaration=e;l.validateFunction=c;l.constructGlobalScope=q;l.validateScript=function(a,c,b){void 0===b&&(b="full");c={globalScope:q(c.vars,l.functionDecls,
c.customFunctions,b),localScope:null};return g(a.body[0].body,c)};l.validateLanguage=function(a){return"BlockStatement"!==a.body[0].body.type?"Invalid formula content.":b(a.body[0].body)};l.nodeErrorMessage=t;l.makeError=r;l.extractAllIssuesInFunction=u;l.extractAllIssues=v;l.checkScript=function(a,c,b,e){void 0===e&&(e="full");var d=[];if("BlockStatement"!==a.body[0].body.type)return[{line:0,character:0,reason:"Invalid Body"}];null!==c&&void 0!==c||(c={vars:{},customFunctions:[]});c={globalScope:q(c.vars,
l.functionDecls,c.customFunctions,e),localScope:null};try{v(a.body[0].body,c,b,d)}catch(B){}return d};l.findFunctionCallsImpl=x;l.findFunctionCalls=function(a,c){return x(a.body[0].body,c)}})},"esri/arcade/Dictionary":function(){define(["require","exports","./languageUtils","../geometry/Geometry","./ImmutableArray"],function(m,l,h,d,b){return function(){function g(b){this.attributes=null;this.plain=!1;this.immutable=!0;b instanceof g?this.attributes=b.attributes:void 0===b?this.attributes={}:null===
b?this.attributes={}:this.attributes=b}return g.prototype.field=function(b){var d=b.toLowerCase();b=this.attributes[b];if(void 0!==b)return b;for(var a in this.attributes)if(a.toLowerCase()===d)return this.attributes[a];throw Error("Field not Found");},g.prototype.setField=function(b,d){if(this.immutable)throw Error("Dictionary is Immutable");var a=b.toLowerCase();if(void 0!==this.attributes[b])return void(this.attributes[b]=d);for(var e in this.attributes)if(e.toLowerCase()===a)return void(this.attributes[e]=
d);this.attributes[b]=d},g.prototype.hasField=function(b){var d=b.toLowerCase();if(void 0!==this.attributes[b])return!0;for(var a in this.attributes)if(a.toLowerCase()===d)return!0;return!1},g.prototype.keys=function(){var b=[],d;for(d in this.attributes)b.push(d);return b=b.sort()},g.prototype.castToText=function(){var g="",f;for(f in this.attributes){""!==g&&(g+=",");var a=this.attributes[f];null==a?g+=JSON.stringify(f)+":null":h.isBoolean(a)||h.isNumber(a)||h.isString(a)?g+=JSON.stringify(f)+":"+
JSON.stringify(a):a instanceof d?g+=JSON.stringify(f)+":"+h.toStringExplicit(a):a instanceof b?g+=JSON.stringify(f)+":"+h.toStringExplicit(a):a instanceof Array?g+=JSON.stringify(f)+":"+h.toStringExplicit(a):a instanceof Date?g+=JSON.stringify(f)+":"+JSON.stringify(a):null!==a&&"object"==typeof a&&void 0!==a.castToText&&(g+=JSON.stringify(f)+":"+a.castToText())}return"{"+g+"}"},g}()})},"esri/arcade/Feature":function(){define("require exports dojo/_base/lang ../geometry/Geometry ../geometry/support/jsonUtils ./Dictionary ./languageUtils ./ImmutableArray ../geometry/Point".split(" "),
function(m,l,h,d,b,g,k,f,a){return function(){function e(a,f,k){(this.geometry=null,this.attributes=null,this._layer=null,this._datesfixed=!0,this.immutable=!0,a instanceof e)?(this.attributes=a.attributes,this.geometry=a.geometry,a._layer&&(this._layer=a._layer)):a&&"esri.Graphic"===a.declaredClass?(this.geometry=a.geometry,void 0===a.attributes?this.attributes={}:null===a.attributes?this.attributes={}:this.attributes=a.attributes,a._sourceLayer?(this._layer=a._sourceLayer,this._datesfixed=!1):a._layer?
(this._layer=a._layer,this._datesfixed=!1):a.layer&&(this._layer=a.layer,this._datesfixed=!1)):a instanceof g?(this.attributes=a.field("attributes"),null!==this.attributes&&(this.attributes instanceof g?this.attributes=this.attributes.attributes:this.attributes=null),this.geometry=a.field("geometry"),null!==this.geometry&&(this.geometry instanceof g?this.geometry=e.parseGeometryFromDictionary(this.geometry):this.geometry instanceof d||(this.geometry=null))):(f instanceof d||null===f?(this.geometry=
f,void 0===a?this.attributes={}:null===a?this.attributes={}:this.attributes=a):"string"==typeof a?(a=JSON.parse(a),null!==a.geometry&&void 0!==a.geometry&&(this.geometry=b.fromJSON(a.geometry)),void 0===a.attributes?this.attributes={}:null===a.attributes?this.attributes={}:this.attributes=a.attributes):(void 0===a?this.attributes={}:null===a&&(this.attributes={}),this.geometry=null),void 0!==k&&(this._layer=k))}return e.prototype.castToText=function(){var a="",b;for(b in this.attributes){""!==a&&
(a+=",");var e=this.attributes[b];null==e?a+=JSON.stringify(b)+":null":k.isBoolean(e)||k.isNumber(e)||k.isString(e)?a+=JSON.stringify(b)+":"+JSON.stringify(e):e instanceof d?a+=JSON.stringify(b)+":"+k.toStringExplicit(e):e instanceof f?a+=JSON.stringify(b)+":"+k.toStringExplicit(e):e instanceof Array?a+=JSON.stringify(b)+":"+k.toStringExplicit(e):e instanceof Date?a+=JSON.stringify(b)+":"+JSON.stringify(e):null!==e&&"object"==typeof e&&void 0!==e.castToText&&(a+=JSON.stringify(b)+":"+e.castToText())}return'{"geometry":'+
(null===this.geometry?"null":k.toStringExplicit(this.geometry))+',"attributes":{'+a+"}}"},e.prototype._fixDates=function(){for(var a=[],b=0;b<this._layer.fields.length;b++){var e=this._layer.fields[b];"date"!==e.type&&"esriFieldTypeDate"!==e.type||a.push(e.name)}0<a.length&&this._fixDateFields(a);this._datesfixed=!0},e.prototype._fixDateFields=function(a){this.attributes=h.mixin({},this.attributes);for(var c=0;c<a.length;c++){var b=this.attributes[a[c]];if(null!==b)if(void 0===b)for(var e in this.attributes){if(e.toLowerCase()===
a[c]){b=this.attributes[e];null!==b&&(b instanceof Date||(this.attributes[e]=new Date(b)));break}}else b instanceof Date||(this.attributes[a[c]]=new Date(b))}},e.prototype.field=function(a){!1===this._datesfixed&&this._fixDates();var c=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var b in this.attributes)if(b.toLowerCase()===c)return this.attributes[b];if(this._hasFieldDefinition(c))return null;throw Error("Field not Found");},e.prototype._hasFieldDefinition=function(a){if(null===
this._layer)return!1;for(var c=0;c<this._layer.fields.length;c++)if(this._layer.fields[c].name.toLowerCase()===a)return!0;return!1},e.prototype._field=function(a){!1===this._datesfixed&&this._fixDates();var c=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var b in this.attributes)if(b.toLowerCase()===c)return this.attributes[b];return null},e.prototype.setField=function(a,b){if(this.immutable)throw Error("Feature is Immutable");if(!1===k.isSimpleType(b))throw Error("Illegal Value Assignment to Feature");
var c=a.toLowerCase();if(void 0!==this.attributes[a])return void(this.attributes[a]=b);for(var e in this.attributes)if(e.toLowerCase()===c)return void(this.attributes[e]=b);this.attributes[a]=b},e.prototype.hasField=function(a){var c=a.toLowerCase();if(void 0!==this.attributes[a])return!0;for(var b in this.attributes)if(b.toLowerCase()===c)return!0;return this._hasFieldDefinition(c)?!0:!1},e.prototype.keys=function(){var a=[],b={},e;for(e in this.attributes)a.push(e),b[e.toLowerCase()]=1;if(null!==
this._layer)for(e=0;e<this._layer.fields.length;e++){var d=this._layer.fields[e];1!==b[d.name.toLowerCase()]&&a.push(d.name)}return a=a.sort()},e.fromFeature=function(a){return new e(a)},e.parseGeometryFromDictionary=function(a){a=e.convertDictionaryToJson(a,!0);return void 0!==a.spatialreference&&(a.spatialReference=a.spatialreference,delete a.spatialreference),void 0!==a.rings&&(a.rings=this.fixPathArrays(a.rings,!0===a.hasZ,!0===a.hasM)),void 0!==a.paths&&(a.paths=this.fixPathArrays(a.paths,!0===
a.hasZ,!0===a.hasM)),void 0!==a.points&&(a.points=this.fixPointArrays(a.points,!0===a.hasZ,!0===a.hasM)),b.fromJSON(a)},e.fixPathArrays=function(a,b,e){var c=[];if(a instanceof Array)for(var d=0;d<a.length;d++)c.push(this.fixPointArrays(a[d],b,e));else if(a instanceof f)for(d=0;d<a.length();d++)c.push(this.fixPointArrays(a.get(d),b,e));return c},e.fixPointArrays=function(c,b,e){var d=[];if(c instanceof Array)for(var g=0;g<c.length;g++){var k=c[g];k instanceof a?b&&e?d.push([k.x,k.y,k.z,k.m]):b?d.push([k.x,
k.y,k.z]):e?d.push([k.x,k.y,k.m]):d.push([k.x,k.y]):d.push(k)}else if(c instanceof f)for(g=0;g<c.length();g++)k=c.get(g),k instanceof a?b&&e?d.push([k.x,k.y,k.z,k.m]):b?d.push([k.x,k.y,k.z]):e?d.push([k.x,k.y,k.m]):d.push([k.x,k.y]):d.push(k);return d},e.convertDictionaryToJson=function(a,b){void 0===b&&(b=!1);var c={},d;for(d in a.attributes){var f=a.attributes[d];f instanceof g&&(f=e.convertDictionaryToJson(f));b?c[d.toLowerCase()]=f:c[d]=f}return c},e.parseAttributesFromDictionary=function(a){var c=
{},b;for(b in a.attributes){var e=a.attributes[b];if(!k.isSimpleType(e))throw Error("Illegal Argument");c[b]=e}return c},e.fromJson=function(a){var c=null;null!==a.geometry&&void 0!==a.geometry&&(c=b.fromJSON(a.geometry));var d={};if(null!==a.attributes&&void 0!==a.attributes)for(var f in a.attributes){var g=a.attributes[f];if(!(k.isString(g)||k.isNumber(g)||k.isBoolean(g)||k.isDate(g)))throw Error("Illegal Argument");d[f]=g}return new e(d,c)},e.prototype.domainValueLookup=function(a,b,e){if(null===
this._layer||!this._layer.fields)return null;e=k.getDomain(a,this._layer,this,e);if(void 0===b)try{b=this.field(a)}catch(r){return null}return k.getDomainValue(e,b)},e.prototype.domainCodeLookup=function(a,b,e){if(null===this._layer||!this._layer.fields)return null;a=k.getDomain(a,this._layer,this,e);return k.getDomainCode(a,b)},e}()})},"esri/arcade/functions/date":function(){define(["require","exports","../../moment","../languageUtils"],function(m,l,h,d){function b(b){return null===b?b:isNaN(b.getTime())?
null:b}Object.defineProperty(l,"__esModule",{value:!0});l.registerFunctions=function(g,k){g.today=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,0,0);a=new Date;return a.setHours(0,0,0,0),a})};g.now=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,0,0);return new Date})};g.timestamp=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,0,0);a=new Date;return a=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())})};
g.toutc=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?null:new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())})};g.tolocal=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?null:h.utc([a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()]).toDate()})};g.day=function(b,a){return k(b,
a,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getDate()})};g.month=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getMonth()})};g.year=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getFullYear()})};g.hour=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getHours()})};g.second=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,
1,1);a=d.toDate(b[0]);return null===a?NaN:a.getSeconds()})};g.millisecond=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getMilliseconds()})};g.minute=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getMinutes()})};g.weekday=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getDay()})};g.date=function(f,a){return k(f,a,function(a,c,f){if(d.pcCheck(f,
0,7),3===f.length)return b(new Date(d.toNumber(f[0]),d.toNumber(f[1]),d.toNumber(f[2]),0,0,0,0));if(4===f.length)return b(new Date(d.toNumber(f[0]),d.toNumber(f[1]),d.toNumber(f[2]),d.toNumber(f[3]),0,0,0));if(5===f.length)return b(new Date(d.toNumber(f[0]),d.toNumber(f[1]),d.toNumber(f[2]),d.toNumber(f[3]),d.toNumber(f[4]),0,0));if(6===f.length)return b(new Date(d.toNumber(f[0]),d.toNumber(f[1]),d.toNumber(f[2]),d.toNumber(f[3]),d.toNumber(f[4]),d.toNumber(f[5]),0));if(7===f.length)return b(new Date(d.toNumber(f[0]),
d.toNumber(f[1]),d.toNumber(f[2]),d.toNumber(f[3]),d.toNumber(f[4]),d.toNumber(f[5]),d.toNumber(f[6])));if(2===f.length){a=d.toString(f[1]);if(""===a)return null;a=d.standardiseDateFormat(a);f=h(d.toString(f[0]),a,!0);return!0===f.isValid()?f.toDate():null}if(1===f.length){if(d.isString(f[0])&&""===f[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;a=d.toNumber(f[0]);return!1===isNaN(a)?b(new Date(a)):d.toDate(f[0])}return 0===f.length?new Date:void 0})};g.datediff=function(b,a){return k(b,
a,function(a,c,b){d.pcCheck(b,2,3);a=d.toDateM(b[0]);c=d.toDateM(b[1]);if(null===a||null===c)return NaN;switch(d.toString(b[2]).toLowerCase()){case "days":case "day":case "d":return a.diff(c,"days",!0);case "months":case "month":return a.diff(c,"months",!0);case "minutes":case "minute":case "m":return"M"===b[2]?a.diff(c,"months",!0):a.diff(c,"minutes",!0);case "seconds":case "second":case "s":return a.diff(c,"seconds",!0);case "milliseconds":case "millisecond":case "ms":return a.diff(c);case "hours":case "hour":case "h":return a.diff(c,
"hours",!0);case "years":case "year":case "y":return a.diff(c,"years",!0);default:return a.diff(c)}})};g.dateadd=function(b,a){return k(b,a,function(a,c,b){d.pcCheck(b,2,3);a=d.toDateM(b[0]);if(null===a)return null;c="milliseconds";switch(d.toString(b[2]).toLowerCase()){case "days":case "day":case "d":c="days";break;case "months":case "month":c="months";break;case "minutes":case "minute":case "m":c="M"===b[2]?"months":"minutes";break;case "seconds":case "second":case "s":c="seconds";break;case "milliseconds":case "millisecond":case "ms":c=
"milliseconds";break;case "hours":case "hour":case "h":c="hours";break;case "years":case "year":case "y":c="years"}return a.add(d.toNumber(b[1]),c),a.toDate()})}}})},"esri/arcade/functions/string":function(){define(["require","exports","../languageUtils","../Feature"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.registerFunctions=function(b,g){b.trim=function(b,d){return g(b,d,function(a,b,c){return h.pcCheck(c,1,1),h.toString(c[0]).trim()})};b.upper=function(b,d){return g(b,
d,function(a,b,c){return h.pcCheck(c,1,1),h.toString(c[0]).toUpperCase()})};b.proper=function(b,d){return g(b,d,function(a,b,c){h.pcCheck(c,1,2);a=1;2===c.length&&"firstword"===h.toString(c[1]).toLowerCase()&&(a=2);b=/\s/;c=h.toString(c[0]);for(var e="",d=!0,f=0;f<c.length;f++){var g=c[f];b.test(g)?1===a&&(d=!0):g.toUpperCase()!==g.toLowerCase()&&(d?(g=g.toUpperCase(),d=!1):g=g.toLowerCase());e+=g}return e})};b.lower=function(b,d){return g(b,d,function(a,b,c){return h.pcCheck(c,1,1),h.toString(c[0]).toLowerCase()})};
b.guid=function(b,d){return g(b,d,function(a,b,c){if(h.pcCheck(c,0,1),0<c.length)switch(h.toString(c[0]).toLowerCase()){case "digits":return h.generateUUID().replace("-","").replace("-","").replace("-","").replace("-","");case "digits-hyphen":return h.generateUUID();case "digits-hyphen-parentheses":return"("+h.generateUUID()+")"}return"{"+h.generateUUID()+"}"})};b.console=function(b,d){return g(b,d,function(a,e,c){return 0===c.length||(1===c.length?b.console(h.toString(c[0])):b.console(h.toString(c))),
h.voidOperation})};b.mid=function(b,d){return g(b,d,function(a,b,c){h.pcCheck(c,2,3);a=h.toNumber(c[1]);if(isNaN(a))return"";if(0>a&&(a=0),2===c.length)return h.toString(c[0]).substr(a);b=h.toNumber(c[2]);return isNaN(b)?"":(0>b&&(b=0),h.toString(c[0]).substr(a,b))})};b.find=function(b,d){return g(b,d,function(a,b,c){h.pcCheck(c,2,3);a=0;if(2<c.length){if(a=h.toNumber(h.defaultUndefined(c[2],0)),isNaN(a))return-1;0>a&&(a=0)}return h.toString(c[1]).indexOf(h.toString(c[0]),a)})};b.left=function(b,
d){return g(b,d,function(a,b,c){h.pcCheck(c,2,2);a=h.toNumber(c[1]);return isNaN(a)?"":(0>a&&(a=0),h.toString(c[0]).substr(0,a))})};b.right=function(b,d){return g(b,d,function(a,b,c){h.pcCheck(c,2,2);a=h.toNumber(c[1]);return isNaN(a)?"":(0>a&&(a=0),h.toString(c[0]).substr(-1*a,a))})};b.split=function(b,d){return g(b,d,function(a,b,c){h.pcCheck(c,2,4);var e;a=h.toNumber(h.defaultUndefined(c[2],-1));b=h.toBoolean(h.defaultUndefined(c[3],!1));if(-1===a||null===a||!0===b?e=h.toString(c[0]).split(h.toString(c[1])):
(isNaN(a)&&(a=-1),-1>a&&(a=-1),e=h.toString(c[0]).split(h.toString(c[1]),a)),!1===b)return e;c=[];for(b=0;b<e.length&&!(-1!==a&&c.length>=a);b++)""!==e[b]&&void 0!==e[b]&&c.push(e[b]);return c})};b.text=function(b,d){return g(b,d,function(a,b,c){return h.pcCheck(c,1,2),h.toStringExplicit(c[0],c[1])})};b.concatenate=function(b,d){return g(b,d,function(a,b,c){a=[];if(1>c.length)return"";if(h.isArray(c[0])){b=h.defaultUndefined(c[2],"");for(var e=0;e<c[0].length;e++)a[e]=h.toStringExplicit(c[0][e],b);
return 1<c.length?a.join(c[1]):a.join("")}if(h.isImmutableArray(c[0])){b=h.defaultUndefined(c[2],"");for(e=0;e<c[0].length();e++)a[e]=h.toStringExplicit(c[0].get(e),b);return 1<c.length?a.join(c[1]):a.join("")}for(e=0;e<c.length;e++)a[e]=h.toStringExplicit(c[e]);return a.join("")})};b.reverse=function(b,d){return g(b,d,function(a,b,c){if(h.pcCheck(c,1,1),h.isArray(c[0]))return a=c[0].slice(0),a.reverse(),a;if(h.isImmutableArray(c[0]))return a=c[0].toArray().slice(0),a.reverse(),a;throw Error("Invalid Parameter");
})};b.replace=function(b,d){return g(b,d,function(a,b,c){h.pcCheck(c,3,4);a=h.toString(c[0]);b=h.toString(c[1]);var e=h.toString(c[2]);return(4===c.length?h.toBoolean(c[3]):1)?h.multiReplace(a,b,e):a.replace(b,e)})};b.domainname=function(b,f){return g(b,f,function(a,b,c){if(h.pcCheck(c,2,4),c[0]instanceof d)return c[0].domainValueLookup(h.toString(c[1]),c[2],void 0===c[3]?void 0:h.toNumber(c[3]));throw Error("Invalid Parameter");})};b.domaincode=function(b,f){return g(b,f,function(a,b,c){if(h.pcCheck(c,
3,4),c[0]instanceof d)return c[0].domainCodeLookup(h.toString(c[1]),c[2],void 0===c[3]?void 0:h.toNumber(c[3]));throw Error("Invalid Parameter");})}}})},"esri/arcade/functions/maths":function(){define(["require","exports","../languageUtils","dojo/number"],function(m,l,h,d){function b(b,d,f){return"undefined"==typeof f||0===+f?Math[b](d):(d=+d,f=+f,isNaN(d)||"number"!=typeof f||0!==f%1?NaN:(d=d.toString().split("e"),d=Math[b](+(d[0]+"e"+(d[1]?+d[1]-f:-f))),d=d.toString().split("e"),+(d[0]+"e"+(d[1]?
+d[1]+f:f))))}Object.defineProperty(l,"__esModule",{value:!0});l.registerFunctions=function(g,k){function f(a,b,c){a=h.toNumber(a);return isNaN(a)?a:isNaN(b)||isNaN(c)?NaN:b>c?NaN:b>a?b:a>c?c:a}g.number=function(a,b){return k(a,b,function(a,b,e){h.pcCheck(e,1,2);a=e[0];return h.isNumber(a)?a:null===a?0:h.isDate(a)||h.isBoolean(a)?Number(a):h.isArray(a)?NaN:""===a||void 0===a?Number(a):h.isString(a)?void 0!==e[1]?(e=h.multiReplace(e[1],"\u2030",""),e=h.multiReplace(e,"\u00a4",""),d.parse(a,{pattern:e})):
Number(a.trim()):Number(a)})};g.abs=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,1,1),Math.abs(h.toNumber(e[0]))})};g.acos=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,1,1),Math.acos(h.toNumber(e[0]))})};g.asin=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,1,1),Math.asin(h.toNumber(e[0]))})};g.atan=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,1,1),Math.atan(h.toNumber(e[0]))})};g.atan2=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,
2,2),Math.atan2(h.toNumber(e[0]),h.toNumber(e[1]))})};g.ceil=function(a,e){return k(a,e,function(a,e,d){return(h.pcCheck(d,1,2),2===d.length)?(a=h.toNumber(d[1]),isNaN(a)&&(a=0),b("ceil",h.toNumber(d[0]),-1*a)):Math.ceil(h.toNumber(d[0]))})};g.round=function(a,e){return k(a,e,function(a,e,d){return(h.pcCheck(d,1,2),2===d.length)?(a=h.toNumber(d[1]),isNaN(a)&&(a=0),b("round",h.toNumber(d[0]),-1*a)):Math.round(h.toNumber(d[0]))})};g.floor=function(a,e){return k(a,e,function(a,e,d){return(h.pcCheck(d,
1,2),2===d.length)?(a=h.toNumber(d[1]),isNaN(a)&&(a=0),b("floor",h.toNumber(d[0]),-1*a)):Math.floor(h.toNumber(d[0]))})};g.cos=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,1,1),Math.cos(h.toNumber(e[0]))})};g.isnan=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,1,1),"number"==typeof e[0]&&isNaN(e[0])})};g.exp=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,1,1),Math.exp(h.toNumber(e[0]))})};g.log=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,
1,1),Math.log(h.toNumber(e[0]))})};g.pow=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,2,2),Math.pow(h.toNumber(e[0]),h.toNumber(e[1]))})};g.random=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,0,0),Math.random()})};g.sin=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,1,1),Math.sin(h.toNumber(e[0]))})};g.sqrt=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,1,1),Math.sqrt(h.toNumber(e[0]))})};g.tan=function(a,b){return k(a,b,function(a,b,
e){return h.pcCheck(e,1,1),Math.tan(h.toNumber(e[0]))})};g.defaultvalue=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,2,2),null===e[0]?e[1]:""===e[0]?e[1]:void 0===e[0]?e[1]:e[0]})};g.isempty=function(a,b){return k(a,b,function(a,b,e){return h.pcCheck(e,1,1),null===e[0]?!0:""===e[0]?!0:void 0===e[0]?!0:!1})};g["boolean"]=function(a,b){return k(a,b,function(a,b,e){h.pcCheck(e,1,1);return h.toBoolean(e[0])})};g.constrain=function(a,b){return k(a,b,function(a,b,e){h.pcCheck(e,3,3);a=
h.toNumber(e[1]);b=h.toNumber(e[2]);if(h.isArray(e[0])){var c=[],d=0;for(e=e[0];d<e.length;d++)c.push(f(e[d],a,b));return c}if(h.isImmutableArray(e[0])){c=[];for(d=0;d<e[0].length();d++)c.push(f(e[0].get(d),a,b));return c}return f(e[0],a,b)})}}})},"esri/arcade/functions/geometry":function(){define("require exports ../../geometry/Geometry ../../geometry/Polygon ../../geometry/Polyline ../../geometry/Point ../../geometry/Extent ../../geometry/Multipoint ../../geometry/support/jsonUtils ../languageUtils ../Dictionary ../Feature".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){Object.defineProperty(l,"__esModule",{value:!0});l.registerFunctions=function(t,r){t.polygon=function(b,f){return r(b,f,function(f,g,n){e.pcCheck(n,1,1);f=null;if(n[0]instanceof c){if(f=e.fixSpatialReference(q.parseGeometryFromDictionary(n[0]),b.spatialReference),0==f instanceof d)throw Error("Illegal Parameter");}else f=n[0]instanceof d?a.fromJSON(n[0].toJSON()):e.fixSpatialReference(new d(JSON.parse(n[0])),b.spatialReference);if(null!==f&&!1===f.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return e.fixNullGeometry(f)})};t.polyline=function(d,f){return r(d,f,function(f,g,n){e.pcCheck(n,1,1);f=null;if(n[0]instanceof c){if(f=e.fixSpatialReference(q.parseGeometryFromDictionary(n[0]),d.spatialReference),0==f instanceof b)throw Error("Illegal Parameter");}else f=n[0]instanceof b?a.fromJSON(n[0].toJSON()):e.fixSpatialReference(new b(JSON.parse(n[0])),d.spatialReference);if(null!==f&&!1===f.spatialReference.equals(d.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return e.fixNullGeometry(f)})};t.point=function(b,d){return r(b,d,function(d,f,n){e.pcCheck(n,1,1);d=null;if(n[0]instanceof c){if(d=e.fixSpatialReference(q.parseGeometryFromDictionary(n[0]),b.spatialReference),0==d instanceof g)throw Error("Illegal Parameter");}else d=n[0]instanceof g?a.fromJSON(n[0].toJSON()):e.fixSpatialReference(new g(JSON.parse(n[0])),b.spatialReference);if(null!==d&&!1===d.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return e.fixNullGeometry(d)})};t.multipoint=function(b,d){return r(b,d,function(d,g,n){e.pcCheck(n,1,1);d=null;if(n[0]instanceof c){if(d=e.fixSpatialReference(q.parseGeometryFromDictionary(n[0]),b.spatialReference),0==d instanceof f)throw Error("Illegal Parameter");}else d=n[0]instanceof f?a.fromJSON(n[0].toJSON()):e.fixSpatialReference(new f(JSON.parse(n[0])),b.spatialReference);if(null!==d&&!1===d.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return e.fixNullGeometry(d)})};t.extent=function(h,t){return r(h,t,function(r,t,n){e.pcCheck(n,1,1);r=null;n[0]instanceof c?r=e.fixSpatialReference(q.parseGeometryFromDictionary(n[0]),h.spatialReference):n[0]instanceof g?(r={xmin:n[0].x,ymin:n[0].y,xmax:n[0].x,ymax:n[0].y,spatialReference:n[0].spatialReference.toJSON()},n[0].hasZ?(r.zmin=n[0].z,r.zmax=n[0].z):n[0].hasM&&(r.mmin=n[0].m,r.mmax=n[0].m),r=a.fromJSON(r)):r=n[0]instanceof d?a.fromJSON(n[0].extent.toJSON()):n[0]instanceof b?a.fromJSON(n[0].extent.toJSON()):
n[0]instanceof f?a.fromJSON(n[0].extent.toJSON()):n[0]instanceof k?a.fromJSON(n[0].toJSON()):e.fixSpatialReference(new k(JSON.parse(n[0])),h.spatialReference);if(null!==r&&!1===r.spatialReference.equals(h.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return e.fixNullGeometry(r)})};t.geometry=function(b,d){return r(b,d,function(d,f,g){e.pcCheck(g,1,1);d=null;if(d=g[0]instanceof q?e.fixSpatialReference(g[0].geometry,
b.spatialReference):g[0]instanceof c?e.fixSpatialReference(q.parseGeometryFromDictionary(g[0]),b.spatialReference):e.fixSpatialReference(a.fromJSON(JSON.parse(g[0])),b.spatialReference),null!==d&&!1===d.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return e.fixNullGeometry(d)})};t.setgeometry=function(a,c){return r(a,c,function(a,c,b){if(e.pcCheck(b,2,2),!(b[0]instanceof q))throw Error("Illegal Argument");
if(!0===b[0].immutable)throw Error("Feature is Immutable");if(!(b[1]instanceof h||null===b[1]))throw Error("Illegal Argument");return b[0].geometry=b[1],e.voidOperation})};t.feature=function(a,b){return r(a,b,function(b,d,f){if(0===f.length)throw Error("Missing Parameters");b=null;if(1===f.length)if(e.isString(f[0]))b=q.fromJson(JSON.parse(f[0]));else if(f[0]instanceof q)b=new q(f[0]);else if(f[0]instanceof h)b=new q(null,f[0]);else{if(!(f[0]instanceof c))throw Error("Illegal Argument");b=f[0].hasField("geometry")?
f[0].field("geometry"):null;d=f[0].hasField("attributes")?f[0].field("attributes"):null;null!==b&&b instanceof c&&(b=q.parseGeometryFromDictionary(b));null!==d&&(d=q.parseAttributesFromDictionary(d));b=new q(d,b)}else{if(2===f.length){d=b=null;if(null!==f[0])if(f[0]instanceof h)b=f[0];else{if(!(b instanceof c))throw Error("Illegal Argument");b=q.parseGeometryFromDictionary(f[0])}if(null!==f[1]){if(!(f[1]instanceof c))throw Error("Illegal Argument");d=q.parseAttributesFromDictionary(f[1])}}else{b=
null;d={};if(null!==f[0])if(f[0]instanceof h)b=f[0];else{if(!(b instanceof c))throw Error("Illegal Argument");b=q.parseGeometryFromDictionary(f[0])}for(var g=1;g<f.length;g+=2){var n=e.toString(f[g]),k=f[g+1];if(!(null===k||void 0===k||e.isString(k)||isNaN(k)||e.isDate(k)||e.isNumber(k)||e.isBoolean(k)))throw Error("Illegal Argument");if(e.isFunctionParameter(k)||!1===e.isSimpleType(k))throw Error("Illegal Argument");k===e.voidOperation?d[n]=null:d[n]=k}}b=new q(d,b)}return b.geometry=e.fixSpatialReference(b.geometry,
a.spatialReference),b.immutable=!1,b})};t.dictionary=function(a,b){return r(a,b,function(a,b,d){if(0===d.length)throw Error("Missing Parameters");if(0!==d.length%2)throw Error("Missing Parameters");a={};for(b=0;b<d.length;b+=2){var f=e.toString(d[b]),g=d[b+1];if(!(null===g||void 0===g||e.isString(g)||isNaN(g)||e.isDate(g)||e.isNumber(g)||e.isBoolean(g)||e.isArray(g)||e.isImmutableArray(g)))throw Error("Illegal Argument");if(e.isFunctionParameter(g))throw Error("Illegal Argument");g===e.voidOperation?
a[f]=null:a[f]=g}d=new c(a);return d.immutable=!1,d})};t.haskey=function(a,b){return r(a,b,function(a,b,d){e.pcCheck(d,2,2);a=e.toString(d[1]);if(d[0]instanceof q||d[0]instanceof c)return d[0].hasField(a);throw Error("Illegal Argument");})};t.indexof=function(a,c){return r(a,c,function(a,c,b){e.pcCheck(b,2,2);a=b[1];if(e.isArray(b[0])){for(c=0;c<b[0].length;c++)if(e.equalityTest(a,b[0][c]))return c;return-1}if(e.isImmutableArray(b[0])){var d=b[0].length();for(c=0;d>c;c++)if(e.equalityTest(a,b[0].get(c)))return c;
return-1}throw Error("Illegal Argument");})}}})},"esri/arcade/functions/geomsync":function(){define("require exports ../../geometry/Geometry ../../geometry/Polygon ../../geometry/Polyline ../../geometry/Point ../../geometry/Extent ../../geometry/Multipoint ../../geometry/support/jsonUtils ./centroid ../languageUtils ../kernel ../../kernel".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t){function r(c){return x?c.clone():a.fromJSON(c.toJSON())}function u(a){return 0===t.version.indexOf("4.")?d.fromExtent(a):
new d({spatialReference:a.spatialReference,rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]})}Object.defineProperty(l,"__esModule",{value:!0});var v=null,x=0===t.version.indexOf("4.");l.setGeometryEngine=function(a){v=a};l.registerFunctions=function(t,n){function l(a){if(!((c.pcCheck(a,2,2),a[0]instanceof h&&a[1]instanceof h)||a[0]instanceof h&&null===a[1]||a[1]instanceof h&&null===a[0]||null===a[0]&&null===a[1]))throw Error("Illegal Argument");}t.disjoint=
function(a,c){return n(a,c,function(a,c,b){return l(b),null===b[0]||null===b[1]?!0:v.disjoint(b[0],b[1])})};t.intersects=function(a,c){return n(a,c,function(a,c,b){return l(b),null===b[0]||null===b[1]?!1:v.intersects(b[0],b[1])})};t.touches=function(a,c){return n(a,c,function(a,c,b){return l(b),null===b[0]||null===b[1]?!1:v.touches(b[0],b[1])})};t.crosses=function(a,c){return n(a,c,function(a,c,b){return l(b),null===b[0]||null===b[1]?!1:v.crosses(b[0],b[1])})};t.within=function(a,c){return n(a,c,
function(a,c,b){return l(b),null===b[0]||null===b[1]?!1:v.within(b[0],b[1])})};t.contains=function(a,c){return n(a,c,function(a,c,b){return l(b),null===b[0]||null===b[1]?!1:v.contains(b[0],b[1])})};t.overlaps=function(a,c){return n(a,c,function(a,c,b){return l(b),null===b[0]||null===b[1]?!1:v.overlaps(b[0],b[1])})};t.equals=function(a,b){return n(a,b,function(a,b,e){return c.pcCheck(e,2,2),e[0]===e[1]?!0:e[0]instanceof h&&e[1]instanceof h?v.equals(e[0],e[1]):c.isDate(e[0])&&c.isDate(e[1])?e[0].getTime()===
e[1].getTime():!1})};t.relate=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,3,3),e[0]instanceof h&&e[1]instanceof h)return v.relate(e[0],e[1],c.toString(e[2]));if(e[0]instanceof h&&null===e[1]||e[1]instanceof h&&null===e[0]||null===e[0]&&null===e[1])return!1;throw Error("Illegal Argument");})};t.intersection=function(a,c){return n(a,c,function(a,c,b){return l(b),null===b[0]||null===b[1]?null:v.intersect(b[0],b[1])})};t.union=function(a,b){return n(a,b,function(b,e,d){b=[];if(0===d.length)throw Error("Function called with wrong number of Parameters");
if(1===d.length)if(c.isArray(d[0]))for(e=0;e<d[0].length;e++){if(null!==d[0][e]){if(!(d[0][e]instanceof h))throw Error("Illegal Argument");b.push(d[0][e])}}else{if(!c.isImmutableArray(d[0])){if(d[0]instanceof h)return c.fixSpatialReference(r(d[0]),a.spatialReference);if(null===d[0])return null;throw Error("Illegal Argument");}d=d[0].toArray();for(e=0;e<d.length;e++)if(null!==d[e]){if(!(d[e]instanceof h))throw Error("Illegal Argument");b.push(d[e])}}else for(e=0;e<d.length;e++)if(null!==d[e]){if(!(d[e]instanceof
h))throw Error("Illegal Argument");b.push(d[e])}return 0===b.length?null:v.union(b)})};t.difference=function(a,c){return n(a,c,function(a,c,b){return l(b),null!==b[0]&&null===b[1]?r(b[0]):null===b[0]?null:v.difference(b[0],b[1])})};t.symmetricdifference=function(a,c){return n(a,c,function(a,c,b){return l(b),null===b[0]&&null===b[1]?null:null===b[0]?r(b[1]):null===b[1]?r(b[0]):v.symmetricDifference(b[0],b[1])})};t.clip=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,2,2),!(e[1]instanceof
k)&&null!==e[1])throw Error("Illegal Argument");if(null===e[0])return null;if(!(e[0]instanceof h))throw Error("Illegal Argument");return null===e[1]?null:v.clip(e[0],e[1])})};t.cut=function(a,e){return n(a,e,function(a,e,d){if(c.pcCheck(d,2,2),!(d[1]instanceof b)&&null!==d[1])throw Error("Illegal Argument");if(null===d[0])return[];if(!(d[0]instanceof h))throw Error("Illegal Argument");return null===d[1]?[r(d[0])]:v.cut(d[0],d[1])})};t.area=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,
1,2),null===e[0])return 0;if(!(e[0]instanceof h))throw Error("Illegal Argument");return v.planarArea(e[0],q.convertSquareUnitsToCode(c.defaultUndefined(e[1],-1)))})};t.areageodetic=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,1,2),null===e[0])return 0;if(!(e[0]instanceof h))throw Error("Illegal Argument");return v.geodesicArea(e[0],q.convertSquareUnitsToCode(c.defaultUndefined(e[1],-1)))})};t.length=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,1,2),null===e[0])return 0;if(!(e[0]instanceof
h))throw Error("Illegal Argument");return v.planarLength(e[0],q.convertLinearUnitsToCode(c.defaultUndefined(e[1],-1)))})};t.lengthgeodetic=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,1,2),null===e[0])return 0;if(!(e[0]instanceof h))throw Error("Illegal Argument");return v.geodesicLength(e[0],q.convertLinearUnitsToCode(c.defaultUndefined(e[1],-1)))})};t.distance=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,2,3),!(e[0]instanceof h))throw Error("Illegal Argument");if(!(e[1]instanceof
h))throw Error("Illegal Argument");return v.distance(e[0],e[1],q.convertLinearUnitsToCode(c.defaultUndefined(e[2],-1)))})};t.densify=function(a,e){return n(a,e,function(a,e,f){if(c.pcCheck(f,2,3),null===f[0])return null;if(!(f[0]instanceof h))throw Error("Illegal Argument");a=c.toNumber(f[1]);if(isNaN(a))throw Error("Illegal Argument");if(0>=a)throw Error("Illegal Argument");return f[0]instanceof d||f[0]instanceof b?v.densify(f[0],a,q.convertLinearUnitsToCode(c.defaultUndefined(f[2],-1))):f[0]instanceof
k?v.densify(u(f[0]),a,q.convertLinearUnitsToCode(c.defaultUndefined(f[2],-1))):f[0]})};t.densifygeodetic=function(a,e){return n(a,e,function(a,e,f){if(c.pcCheck(f,2,3),null===f[0])return null;if(!(f[0]instanceof h))throw Error("Illegal Argument");a=c.toNumber(f[1]);if(isNaN(a))throw Error("Illegal Argument");if(0>=a)throw Error("Illegal Argument");return f[0]instanceof d||f[0]instanceof b?v.geodesicDensify(f[0],a,q.convertLinearUnitsToCode(c.defaultUndefined(f[2],-1))):f[0]instanceof k?v.geodesicDensify(u(f[0]),
a,q.convertLinearUnitsToCode(c.defaultUndefined(f[2],-1))):f[0]})};t.generalize=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,2,4),null===e[0])return null;if(!(e[0]instanceof h))throw Error("Illegal Argument");a=c.toNumber(e[1]);if(isNaN(a))throw Error("Illegal Argument");return v.generalize(e[0],a,c.toBoolean(c.defaultUndefined(e[2],!0)),q.convertLinearUnitsToCode(c.defaultUndefined(e[3],-1)))})};t.buffer=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,2,3),null===e[0])return null;
if(!(e[0]instanceof h))throw Error("Illegal Argument");a=c.toNumber(e[1]);if(isNaN(a))throw Error("Illegal Argument");return 0===a?r(e[0]):v.buffer(e[0],a,q.convertLinearUnitsToCode(c.defaultUndefined(e[2],-1)))})};t.buffergeodetic=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,2,3),null===e[0])return null;if(!(e[0]instanceof h))throw Error("Illegal Argument");a=c.toNumber(e[1]);if(isNaN(a))throw Error("Illegal Argument");return 0===a?r(e[0]):v.geodesicBuffer(e[0],a,q.convertLinearUnitsToCode(c.defaultUndefined(e[2],
-1)))})};t.offset=function(a,e){return n(a,e,function(a,e,f){if(c.pcCheck(f,2,6),null===f[0])return null;if(!(f[0]instanceof d||f[0]instanceof b))throw Error("Illegal Argument");a=c.toNumber(f[1]);if(isNaN(a))throw Error("Illegal Argument");e=c.toNumber(c.defaultUndefined(f[4],10));if(isNaN(e))throw Error("Illegal Argument");var g=c.toNumber(c.defaultUndefined(f[5],0));if(isNaN(g))throw Error("Illegal Argument");return v.offset(f[0],a,q.convertLinearUnitsToCode(c.defaultUndefined(f[2],-1)),c.toString(c.defaultUndefined(f[3],
"round")).toLowerCase(),e,g)})};t.rotate=function(a,b){return n(a,b,function(a,b,e){c.pcCheck(e,2,3);a=e[0];if(null===a)return null;if(!(a instanceof h))throw Error("Illegal Argument");a instanceof k&&(a=d.fromExtent(a));b=c.toNumber(e[1]);if(isNaN(b))throw Error("Illegal Argument");e=c.defaultUndefined(e[2],null);if(null===e)return v.rotate(a,b);if(e instanceof g)return v.rotate(a,b,e);throw Error("Illegal Argument");})};t.centroid=function(a,q){return n(a,q,function(n,q,t){if(c.pcCheck(t,1,1),null===
t[0])return null;if(!(t[0]instanceof h))throw Error("Illegal Argument");return t[0]instanceof g?c.fixSpatialReference(r(t[0]),a.spatialReference):t[0]instanceof d?x?t[0].centroid:t[0].getCentroid():t[0]instanceof b?e.centroidPolyline(t[0]):t[0]instanceof f?e.centroidMultiPoint(t[0]):t[0]instanceof k?x?t[0].center:t[0].getExtent().getCenter():null})};t.multiparttosinglepart=function(e,q){return n(e,q,function(n,q,t){c.pcCheck(t,1,1);q=[];if(null===t[0])return null;if(!(t[0]instanceof h))throw Error("Illegal Argument");
if(t[0]instanceof g||t[0]instanceof k)return[c.fixSpatialReference(r(t[0]),e.spatialReference)];n=v.simplify(t[0]);if(n instanceof d){q=[];var l=[];for(t=0;t<n.rings.length;t++)if(n.isClockwise(n.rings[t])){var w=a.fromJSON({rings:[n.rings[t]],hasZ:n.hasZ,hasM:n.hasM,spatialReference:x?n.spatialReference.toJSON():n.spatialReference.toJson()});q.push(w)}else l.push({ring:n.rings[t],pt:n.getPoint(t,0)});for(n=0;n<l.length;n++)for(t=0;t<q.length;t++)if(q[t].contains(l[n].pt)){q[t].addRing(l[n].ring);
break}return q}if(n instanceof b){q=[];for(t=0;t<n.paths.length;t++)l=a.fromJSON({paths:[n.paths[t]],hasZ:n.hasZ,hasM:n.hasM,spatialReference:x?n.spatialReference.toJSON():n.spatialReference.toJson()}),q.push(l);return q}if(t[0]instanceof f){n=c.fixSpatialReference(r(t[0]),e.spatialReference);for(t=0;t<n.points.length;t++)q.push(n.getPoint(t));return q}return null})};t.issimple=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,1,1),null===e[0])return!0;if(e[0]instanceof h)return v.isSimple(e[0]);
throw Error("Illegal Argument");})};t.simplify=function(a,b){return n(a,b,function(a,b,e){if(c.pcCheck(e,1,1),null===e[0])return null;if(e[0]instanceof h)return v.simplify(e[0]);throw Error("Illegal Argument");})}}})},"esri/arcade/functions/centroid":function(){define(["require","exports","../../geometry/Point","../../kernel"],function(m,l,h,d){function b(b,a,e){var c={x:0,y:0};a&&(c.z=0);e&&(c.m=0);for(var d=0,f=b[0],k=0;k<b.length;k++){var h=b[k],l;a:if(h.length!==f.length)l=!1;else{for(l=0;l<h.length;l++)if(h[l]!==
f[l]){l=!1;break a}l=!0}if(!1===l){l=g(f,h,a);var x=h,y=a,n=e,w={x:(f[0]+x[0])/2,y:(f[1]+x[1])/2},f=(y&&(w.z=(f[2]+x[2])/2),y&&n?w.m=(f[3]+x[3])/2:n&&(w.m=(f[2]+x[2])/2),w);f.x*=l;f.y*=l;c.x+=f.x;c.y+=f.y;a&&(f.z*=l,c.z+=f.z);e&&(f.m*=l,c.m+=f.m);d+=l;f=h}}return 0<d?(c.x/=d,c.y/=d,a&&(c.z/=d),e&&(c.m/=d)):(c.x=b[0][0],c.y=b[0][1],a&&(c.z=b[0][2]),e&&a?c.m=b[0][3]:e&&(c.m=b[0][2])),c}function g(b,a,e){var c=a[0]-b[0];b=a[1]-b[1];return e?(a=a[2]-a[2],Math.sqrt(c*c+b*b+a*a)):Math.sqrt(c*c+b*b)}Object.defineProperty(l,
"__esModule",{value:!0});var k=0===d.version.indexOf("4.");l.centroidPolyline=function(d){for(var a={x:0,y:0,spatialReference:k?d.spatialReference.toJSON():d.spatialReference.toJson()},e={x:0,y:0,spatialReference:k?d.spatialReference.toJSON():d.spatialReference.toJson()},c=0,f=0,t=0;t<d.paths.length;t++)if(0!==d.paths[t].length){var r;r=d.paths[t];var l=!0===d.hasZ;if(1>=r.length)r=0;else{for(var v=0,x=1;x<r.length;x++)v+=g(r[x-1],r[x],l);r=v}0===r?(l=b(d.paths[t],!0===d.hasZ,!0===d.hasM),a.x+=l.x,
a.y+=l.y,!0===d.hasZ&&(a.z+=l.z),!0===d.hasM&&(a.m+=l.m),++c):(l=b(d.paths[t],!0===d.hasZ,!0===d.hasM),e.x+=l.x*r,e.y+=l.y*r,!0===d.hasZ&&(e.z+=l.z*r),!0===d.hasM&&(e.m+=l.m*r),f+=r)}return 0<f?(e.x/=f,e.y/=f,!0===d.hasZ&&(e.z/=f),!0===d.hasM&&(e.m/=f),new h(e)):0<c?(a.x/=c,a.y/=c,!0===d.hasZ&&(e.z/=c),!0===d.hasM&&(a.m/=c),new h(a)):null};l.centroidMultiPoint=function(b){if(0===b.points.length)return null;for(var a=0,e=0,c=0,d=0,f=0;f<b.points.length;f++){var g=b.getPoint(f);!0===g.hasZ&&(c+=g.z);
!0===g.hasM&&(d+=g.m);a+=g.x;e+=g.y;d+=g.m}a={x:a/b.points.length,y:e/b.points.length,spatialReference:null};return a.spatialReference=k?b.spatialReference.toJSON():b.spatialReference.toJson(),!0===b.hasZ&&(a.z=c/b.points.length),!0===b.hasM&&(a.m=d/b.points.length),new h(a)}})},"esri/arcade/kernel":function(){define(["require","exports","../geometry/Extent"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.errback=function(d){return function(b){d.reject(b)}};l.callback=function(d,
b){return function(){try{d.apply(null,arguments)}catch(g){b.reject(g)}}};l.convertSquareUnitsToCode=function(d){if(void 0===d)return null;if("number"==typeof d)return d;switch(d.toLowerCase()){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":case "square-meter":case "square_meters":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":case "square-miles":case "square-mile":return 109413;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "square-kilometers":case "square-kilometer":case "km":return 109414;
case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;case "yard":case "yd":case "yards":case "square-yards":case "square-yard":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "square-feet":case "square-foot":case "squarefeet":case "squarefoot":return 109405}return null};l.shapeExtent=function(d){if(null===d)return null;switch(d.type){case "polygon":case "multipoint":case "polyline":return d.extent;case "point":return new h({xmin:d.x,
ymin:d.y,xmax:d.x,ymax:d.y,spatialReference:d.spatialReference});case "extent":return d}return null};l.convertLinearUnitsToCode=function(d){if(void 0===d)return null;if("number"==typeof d||"number"==typeof d)return d;switch(d.toLowerCase()){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":case "square-meter":case "square-meters":return 9001;case "miles":case "mile":case "squaremile":case "squaremiles":case "square-miles":case "square-mile":return 9035;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "square-kilometers":case "square-kilometer":case "km":return 9036;
case "yard":case "yd":case "yards":case "square-yards":case "square-yard":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "square-feet":case "square-foot":case "squarefeet":case "squarefoot":return 9002}return null};l.sameGeomType=function(d,b){return d===b?!0:"point"===d&&"esriGeometryPoint"===b?!0:"polyline"===d&&"esriGeometryPolyline"===b?!0:"polygon"===d&&"esriGeometryPolygon"===b?!0:"extent"===d&&"esriGeometryEnvelope"===b?!0:"multipoint"===d&&"esriGeometryMultipoint"===
b?!0:"point"===b&&"esriGeometryPoint"===d?!0:"polyline"===b&&"esriGeometryPolyline"===d?!0:"polygon"===b&&"esriGeometryPolygon"===d?!0:"extent"===b&&"esriGeometryEnvelope"===d?!0:"multipoint"===b&&"esriGeometryMultipoint"===d?!0:!1}})},"esri/arcade/functions/stats":function(){define(["require","exports","../languageUtils","./fieldStats"],function(m,l,h,d){function b(b,k,f,a){if(1===a.length){if(h.isArray(a[0]))return d.calculateStat(b,a[0],-1);if(h.isImmutableArray(a[0]))return d.calculateStat(b,
a[0].toArray(),-1)}return d.calculateStat(b,a,-1)}Object.defineProperty(l,"__esModule",{value:!0});l.registerFunctions=function(d,k){d.stdev=function(d,a){return k(d,a,function(a,c,d){return b("stdev",a,c,d)})};d.variance=function(d,a){return k(d,a,function(a,c,d){return b("variance",a,c,d)})};d.average=function(d,a){return k(d,a,function(a,c,d){return b("mean",a,c,d)})};d.mean=function(d,a){return k(d,a,function(a,c,d){return b("mean",a,c,d)})};d.sum=function(d,a){return k(d,a,function(a,c,d){return b("sum",
a,c,d)})};d.min=function(d,a){return k(d,a,function(a,c,d){return b("min",a,c,d)})};d.max=function(d,a){return k(d,a,function(a,c,d){return b("max",a,c,d)})};d.distinct=function(d,a){return k(d,a,function(a,c,d){return b("distinct",a,c,d)})};d.count=function(b,a){return k(b,a,function(a,c,b){if(h.pcCheck(b,1,1),h.isArray(b[0])||h.isString(b[0]))return b[0].length;if(h.isImmutableArray(b[0]))return b[0].length();throw Error("Invalid Parameters for Count");})}}})},"esri/arcade/functions/fieldStats":function(){define(["require",
"exports","../languageUtils"],function(m,l,h){function d(b){for(var d=0,f=0;f<b.length;f++)d+=b[f];return d/b.length}function b(b){for(var g=d(b),f=0,a=0;a<b.length;a++)f+=Math.pow(g-b[a],2);return f/b.length}Object.defineProperty(l,"__esModule",{value:!0});l.decodeStatType=function(b){switch(b.toLowerCase()){case "distinct":return"distinct";case "avg":case "mean":return"avg";case "min":return"min";case "sum":return"sum";case "max":return"max";case "stdev":case "stddev":return"stddev";case "var":case "variance":return"var";
case "count":return"count"}return""};l.calculateStat=function(g,k,f){switch(void 0===f&&(f=1E3),g.toLowerCase()){case "distinct":a:{g=f;f=[];for(var a={},e=[],c=0;c<k.length;c++){if(void 0!==k[c]&&null!==k[c]&&k[c]!==h.voidOperation){var q=k[c];if(h.isNumber(q)||h.isString(q))void 0===a[q]&&(f.push(q),a[q]=1);else{for(var t=!1,r=0;r<e.length;r++)!0===h.equalityTest(e[r],q)&&(t=!0);!1===t&&(e.push(q),f.push(q))}}if(f.length>=g&&-1!==g){k=f;break a}}k=f}return k;case "avg":case "mean":return d(h.toNumberArray(k));
case "min":return Math.min.apply(Math,h.toNumberArray(k));case "sum":k=h.toNumberArray(k);for(f=g=0;f<k.length;f++)g+=k[f];return g;case "max":return Math.max.apply(Math,h.toNumberArray(k));case "stdev":case "stddev":return Math.sqrt(b(h.toNumberArray(k)));case "var":case "variance":return b(h.toNumberArray(k));case "count":return k.length}return 0}})},"esri/arcade/parser":function(){define(["require","exports","./treeAnalysis","./lib/esprima"],function(m,l,h,d){Object.defineProperty(l,"__esModule",
{value:!0});l.parseScript=function(b){b=d.parse("function _() { "+b+"\n}");if(null===b.body||void 0===b.body)throw Error("No formula provided.");if(0===b.body.length)throw Error("No formula provided.");if(0===b.body.length)throw Error("No formula provided.");if("BlockStatement"!==b.body[0].body.type)throw Error("Invalid formula content.");var g=h.validateLanguage(b);if(""!==g)throw Error(g);return b};l.scriptCheck=function(b,g,k,f){var a=[];try{var e=d.parse("function _() { "+b+"\n}",{tolerant:!0,
loc:!0}),c=e.errors;if(0<c.length)for(var q=0;q<c.length;q++)a.push({line:c[q].lineNumber,character:c[q].column,reason:c[q].description});var t=h.checkScript(e,g,k,f);for(g=0;g<t.length;g++)a.push(t[g])}catch(r){try{"Unexpected token }"===r.description?(r.index=("function _() { "+b+"\n}").length-1,a.push({line:r.lineNumber,character:r.column,reason:"Unexpected end of script"})):a.push({line:r.lineNumber,character:r.column,reason:r.description})}catch(u){}}return a};l.extractFieldLiterals=function(b,
d){return void 0===d&&(d=!1),h.findFieldLiterals(b,d)};l.validateScript=function(b,d,k){return void 0===k&&(k="full"),h.validateScript(b,d,k)};l.referencesMember=function(b,d){return h.referencesMember(b,d)};l.referencesFunction=function(b,d){return h.referencesFunction(b,d)}})},"esri/arcade/lib/esprima":function(){!function(m,l){"function"==typeof define&&define.amd?define(["exports"],l):l("undefined"!=typeof exports?exports:m.esprima={})}(this,function(m){function l(a,c){if(!a)throw Error("ASSERT: "+
c);}function h(a){return 48<=a&&57>=a}function d(a){return 0<="0123456789abcdefABCDEF".indexOf(a)}function b(a){return 0<="01234567".indexOf(a)}function g(a){return 10===a||13===a||8232===a||8233===a}function k(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||92===a||128<=a&&Va.NonAsciiIdentifierStart.test(String.fromCharCode(a))}function f(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||48<=a&&57>=a||92===a||128<=a&&Va.NonAsciiIdentifierPart.test(String.fromCharCode(a))}function a(a){switch(a=
a.toLowerCase(),a.length){case 2:return"if"===a||"in"===a;case 3:return"var"===a||"for"===a;case 4:return"else"===a;case 5:return"break"===a;case 6:return"return"===a;case 8:return"function"===a.toLowerCase()||"continue"===a;default:return!1}}function e(a,c,b,p,e){var d;l("number"==typeof b,"Comment must have valid position");xa.lastCommentStart>=b||(xa.lastCommentStart=b,d={type:a,value:c},la.range&&(d.range=[b,p]),la.loc&&(d.loc=e),la.comments.push(d),la.attachComment&&(la.leadingComments.push(d),
la.trailingComments.push(d)))}function c(a){var b,c,p,d;b=aa-a;for(c={start:{line:ya,column:aa-Aa-a}};Ca>aa;)if(p=ka.charCodeAt(aa),++aa,g(p))return la.comments&&(d=ka.slice(b+a,aa-1),c.end={line:ya,column:aa-Aa-1},e("Line",d,b,aa-1,c)),13===p&&10===ka.charCodeAt(aa)&&++aa,++ya,void(Aa=aa);la.comments&&(d=ka.slice(b+a,aa),c.end={line:ya,column:aa-Aa},e("Line",d,b,aa,c))}function q(){var a,b;for(b=0===aa;Ca>aa;)if(a=ka.charCodeAt(aa),32===a||9===a||11===a||12===a||160===a||5760<=a&&0<=[5760,6158,8192,
8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(a))++aa;else if(g(a))++aa,13===a&&10===ka.charCodeAt(aa)&&++aa,++ya,Aa=aa,b=!0;else if(47===a)if(a=ka.charCodeAt(aa+1),47===a)++aa,++aa,c(2),b=!0;else{if(42!==a)break;++aa;++aa;a:{var p=void 0,d=void 0,f=void 0,A=void 0;for(la.comments&&(p=aa-2,d={start:{line:ya,column:aa-Aa-2}});Ca>aa;)if(f=ka.charCodeAt(aa),g(f))13===f&&10===ka.charCodeAt(aa+1)&&++aa,++ya,++aa,Aa=aa,aa>=Ca&&H();else{if(42===f&&47===ka.charCodeAt(aa+
1)){++aa;++aa;la.comments&&(A=ka.slice(p+2,aa-2),d.end={line:ya,column:aa-Aa},e("Block",A,p,aa,d));break a}++aa}H()}}else if(b&&45===a){if(45!==ka.charCodeAt(aa+1)||62!==ka.charCodeAt(aa+2))break;aa+=3;c(3)}else{if(60!==a)break;if("!--"!==ka.slice(aa+1,aa+4))break;++aa;++aa;++aa;++aa;c(4)}}function t(a){var b,c,p=0;b="u"===a?4:2;for(a=0;b>a;++a){if(!(Ca>aa&&d(ka[aa])))return"";c=ka[aa++];p=16*p+"0123456789abcdef".indexOf(c.toLowerCase())}return String.fromCharCode(p)}function r(){var a,b;a=ka.charCodeAt(aa++);
b=String.fromCharCode(a);for(92===a&&(117!==ka.charCodeAt(aa)&&H(),++aa,a=t("u"),a&&"\\"!==a&&k(a.charCodeAt(0))||H(),b=a);Ca>aa&&(a=ka.charCodeAt(aa),f(a));)++aa,b+=String.fromCharCode(a),92===a&&(b=b.substr(0,b.length-1),117!==ka.charCodeAt(aa)&&H(),++aa,a=t("u"),a&&"\\"!==a&&f(a.charCodeAt(0))||H(),b+=a);return b}function u(){var a,b,c,p,e=aa,d=ka.charCodeAt(aa),f=ka[aa];switch(d){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++aa,la.tokenize&&
(40===d?la.openParenToken=la.tokens.length:123===d&&(la.openCurlyToken=la.tokens.length)),{type:oa.Punctuator,value:String.fromCharCode(d),lineNumber:ya,lineStart:Aa,start:e,end:aa};default:if(a=ka.charCodeAt(aa+1),61===a)switch(d){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return aa+=2,{type:oa.Punctuator,value:String.fromCharCode(d)+String.fromCharCode(a),lineNumber:ya,lineStart:Aa,start:e,end:aa};case 33:case 61:return aa+=2,61===ka.charCodeAt(aa)&&++aa,{type:oa.Punctuator,
value:ka.slice(e,aa),lineNumber:ya,lineStart:Aa,start:e,end:aa}}}return p=ka.substr(aa,4),"\x3e\x3e\x3e\x3d"===p?(aa+=4,{type:oa.Punctuator,value:p,lineNumber:ya,lineStart:Aa,start:e,end:aa}):(c=p.substr(0,3),"\x3e\x3e\x3e"===c||"\x3c\x3c\x3d"===c||"\x3e\x3e\x3d"===c?(aa+=3,{type:oa.Punctuator,value:c,lineNumber:ya,lineStart:Aa,start:e,end:aa}):(b=c.substr(0,2),f===b[1]&&0<="+-\x3c\x3e\x26|".indexOf(f)||"\x3d\x3e"===b?(aa+=2,{type:oa.Punctuator,value:b,lineNumber:ya,lineStart:Aa,start:e,end:aa}):
0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(f)?(++aa,{type:oa.Punctuator,value:f,lineNumber:ya,lineStart:Aa,start:e,end:aa}):void H()))}function v(){var a,c,p;if(p=ka[aa],l(h(p.charCodeAt(0))||"."===p,"Numeric literal must start with a decimal digit or a decimal point"),c=aa,a="","."!==p){if(a=ka[aa++],p=ka[aa],"0"===a){if("x"===p||"X"===p){++aa;for(var e="";Ca>aa&&d(ka[aa]);)e+=ka[aa++];return 0===e.length&&H(),k(ka.charCodeAt(aa))&&H(),{type:oa.NumericLiteral,value:parseInt("0x"+e,16),lineNumber:ya,lineStart:Aa,
start:c,end:aa}}if("b"===p||"B"===p){++aa;for(a="";Ca>aa&&(e=ka[aa],"0"===e||"1"===e);)a+=ka[aa++];return 0===a.length&&H(),Ca>aa&&(e=ka.charCodeAt(aa),(k(e)||h(e))&&H()),{type:oa.NumericLiteral,value:parseInt(a,2),lineNumber:ya,lineStart:Aa,start:c,end:aa}}if("o"===p||"O"===p||b(p)){var f,A;for(b(p)?(A=!0,f="0"+ka[aa++]):(A=!1,++aa,f="");Ca>aa&&b(ka[aa]);)f+=ka[aa++];return A||0!==f.length||H(),(k(ka.charCodeAt(aa))||h(ka.charCodeAt(aa)))&&H(),{type:oa.NumericLiteral,value:parseInt(f,8),octal:A,
lineNumber:ya,lineStart:Aa,start:c,end:aa}}p&&h(p.charCodeAt(0))&&H()}for(;h(ka.charCodeAt(aa));)a+=ka[aa++];p=ka[aa]}if("."===p){for(a+=ka[aa++];h(ka.charCodeAt(aa));)a+=ka[aa++];p=ka[aa]}if("e"===p||"E"===p)if(a+=ka[aa++],p=ka[aa],("+"===p||"-"===p)&&(a+=ka[aa++]),h(ka.charCodeAt(aa)))for(;h(ka.charCodeAt(aa));)a+=ka[aa++];else H();return k(ka.charCodeAt(aa))&&H(),{type:oa.NumericLiteral,value:parseFloat(a),lineNumber:ya,lineStart:Aa,start:c,end:aa}}function x(){ta=null;q();T("Regular Expression language structures not supported")}
function y(){q();x()}function n(){var a,b;if(a=la.tokens[la.tokens.length-1],!a)return y();if("Punctuator"===a.type){if("]"===a.value)return u();if(")"===a.value)return b=la.tokens[la.openParenToken-1],!b||"Keyword"!==b.type||"if"!==b.value.toLowerCase()&&"while"!==b.value.toLowerCase()&&"for"!==b.value.toLowerCase()&&"with"!==b.value.toLowerCase()?u():y();if("}"===a.value){if(la.tokens[la.openCurlyToken-3]&&"Keyword"===la.tokens[la.openCurlyToken-3].type){if(b=la.tokens[la.openCurlyToken-4],!b)return u()}else{if(!la.tokens[la.openCurlyToken-
4]||"Keyword"!==la.tokens[la.openCurlyToken-4].type)return u();if(b=la.tokens[la.openCurlyToken-5],!b)return y()}return 0<=Ka.indexOf(b.value)?u():y()}return y()}return"Keyword"===a.type&&"this"!==a.value?y():u()}function w(){var c;q();var p;if(aa>=Ca)p={type:oa.EOF,lineNumber:ya,lineStart:Aa,start:aa,end:aa};else if(c=ka.charCodeAt(aa),k(c)){var e,A;p=aa;var E;if(92===ka.charCodeAt(aa))E=r();else a:{var K;for(E=aa++;Ca>aa;){if(K=ka.charCodeAt(aa),92===K){E=(aa=E,r());break a}if(!f(K))break;++aa}E=
ka.slice(E,aa)}p=(e=E,A=1===e.length?oa.Identifier:a(e)?oa.Keyword:"null"===e.toLowerCase()?oa.NullLiteral:"true"===e.toLowerCase()||"false"===e.toLowerCase()?oa.BooleanLiteral:oa.Identifier,{type:A,value:e,lineNumber:ya,lineStart:Aa,start:p,end:aa})}else if(40===c||41===c||59===c)p=u();else if(39===c||34===c){var U,V,w="",X=!1;K=ya;c=Aa;e=ka[aa];l("'"===e||'"'===e,"String literal must starts with a quote");A=aa;for(++aa;Ca>aa;){if(p=ka[aa++],p===e){e="";break}if("\\"===p)if(p=ka[aa++],p&&g(p.charCodeAt(0)))++ya,
"\r"===p&&"\n"===ka[aa]&&++aa,Aa=aa;else switch(p){case "u":case "x":if("{"===ka[aa]){++aa;U=w;var x,y=x=void 0,w=V=void 0;x=ka[aa];y=0;for("}"===x&&H();Ca>aa&&(x=ka[aa++],d(x));)y=16*y+"0123456789abcdef".indexOf(x.toLowerCase());x=((1114111<y||"}"!==x)&&H(),65535>=y?String.fromCharCode(y):(V=(y-65536>>10)+55296,w=(y-65536&1023)+56320,String.fromCharCode(V,w)));w=U+x}else V=aa,(U=t(p))?w+=U:(aa=V,w+=p);break;case "n":w+="\n";break;case "r":w+="\r";break;case "t":w+="\t";break;case "b":w+="\b";break;
case "f":w+="\f";break;case "v":w+="\x0B";break;default:b(p)?(E="01234567".indexOf(p),0!==E&&(X=!0),Ca>aa&&b(ka[aa])&&(X=!0,E=8*E+"01234567".indexOf(ka[aa++]),0<="0123".indexOf(p)&&Ca>aa&&b(ka[aa])&&(E=8*E+"01234567".indexOf(ka[aa++]))),w+=String.fromCharCode(E)):w+=p}else{if(g(p.charCodeAt(0)))break;w+=p}}p=(""!==e&&H(),{type:oa.StringLiteral,value:w,octal:X,startLineNumber:K,startLineStart:c,lineNumber:ya,lineStart:Aa,start:A,end:aa})}else p=46===c?h(ka.charCodeAt(aa+1))?v():u():h(c)?v():la.tokenize&&
47===c?n():u();return p}function z(){var a,b,c,p;return q(),a={start:{line:ya,column:aa-Aa}},b=w(),a.end={line:ya,column:aa-Aa},b.type!==oa.EOF&&(c=ka.slice(b.start,b.end),p={type:Ma[b.type],value:c,range:[b.start,b.end],loc:a},b.regex&&(p.regex={pattern:b.regex.pattern,flags:b.regex.flags}),la.tokens.push(p)),b}function C(){var a;return a=ta,aa=a.end,ya=a.lineNumber,Aa=a.lineStart,ta="undefined"!=typeof la.tokens?z():w(),aa=a.end,ya=a.lineNumber,Aa=a.lineStart,a}function B(){var a,b,c;a=aa;b=ya;
c=Aa;ta="undefined"!=typeof la.tokens?z():w();aa=a;ya=b;Aa=c}function F(){this.line=ya;this.column=aa-Aa}function G(){this.start=new F;this.end=null}function N(a){a.type===oa.StringLiteral?this.start={line:a.startLineNumber,column:a.start-a.startLineStart}:this.start={line:a.lineNumber,column:a.start-a.lineStart};this.end=null}function M(){aa=ta.start;ta.type===oa.StringLiteral?(ya=ta.startLineNumber,Aa=ta.startLineStart):(ya=ta.lineNumber,Aa=ta.lineStart);la.range&&(this.range=[aa,0]);la.loc&&(this.loc=
new G)}function R(a){la.range&&(this.range=[a.start,0]);la.loc&&(this.loc=new N(a))}function P(){var a,b,c,p;return a=aa,b=ya,c=Aa,q(),p=ya!==b,aa=a,ya=b,Aa=c,p}function Q(a,b,c){var p=Error("Line "+a+": "+c);return p.index=b,p.lineNumber=a,p.column=b-Aa+1,p.description=c,p}function T(a){var b,c;throw b=Array.prototype.slice.call(arguments,1),c=a.replace(/%(\d)/g,function(a,c){return l(c<b.length,"Message reference must be in range"),b[c]}),Q(ya,aa,c);}function O(a){var b,c,p;if(b=Array.prototype.slice.call(arguments,
1),c=a.replace(/%(\d)/g,function(a,c){return l(c<b.length,"Message reference must be in range"),b[c]}),p=Q(ya,aa,c),!la.errors)throw p;la.errors.push(p)}function S(a,b){var c=Ba.UnexpectedToken;a&&(c=b?b:a.type===oa.EOF?Ba.UnexpectedEOS:a.type===oa.Identifier?Ba.UnexpectedIdentifier:a.type===oa.NumericLiteral?Ba.UnexpectedNumber:a.type===oa.StringLiteral?Ba.UnexpectedString:Ba.UnexpectedToken);return c=c.replace("%0",a?a.value:"ILLEGAL"),a&&"number"==typeof a.lineNumber?Q(a.lineNumber,a.start,c):
Q(ya,aa,c)}function H(a,b){throw S(a,b);}function Y(a,b){a=S(a,b);if(!la.errors)throw a;la.errors.push(a)}function W(a){var b=C();b.type===oa.Punctuator&&b.value===a||H(b)}function E(){var a;la.errors?(a=ta,a.type===oa.Punctuator&&","===a.value?C():a.type===oa.Punctuator&&";"===a.value?(C(),Y(a)):Y(a,Ba.UnexpectedToken)):W(",")}function p(a){var b=C();b.type===oa.Keyword&&b.value.toLowerCase()===a.toLowerCase()||H(b)}function A(a){return ta.type===oa.Punctuator&&ta.value===a}function K(a){return ta.type===
oa.Keyword&&ta.value.toLowerCase()===a.toLowerCase()}function U(){var a;return 59===ka.charCodeAt(aa)||A(";")?void C():(a=ya,q(),void(ya===a&&(ta.type===oa.EOF||A("}")||H(ta))))}function V(a){return a.type===va.Identifier||a.type===va.MemberExpression}function X(a,b){var c,p;b=new M;return c=Ga,p=sa(),Ga=c,b.finishFunctionExpression(null,a,[],p)}function ba(){var a,b,c;return a=Ga,Ga=!0,b=Pa(),c=X(b.params),Ga=a,c}function fa(){var a,b=new M;return a=C(),a.type===oa.StringLiteral||a.type===oa.NumericLiteral?
(Ga&&a.octal&&Y(a,Ba.StrictOctalLiteral),b.finishLiteral(a)):b.finishIdentifier(a.value)}function ha(){var a,b,c,p,e,d=new M;if(a=ta,a.type===oa.Identifier)return c=fa(),"get"!==a.value||A(":")||A("(")?"set"!==a.value||A(":")||A("(")?A(":")?(C(),p=pa(),d.finishProperty("init",c,p,!1,!1)):A("(")?(p=ba(),d.finishProperty("init",c,p,!0,!1)):(p=c,d.finishProperty("init",c,p,!1,!0)):(b=fa(),W("("),a=ta,a.type!==oa.Identifier?(W(")"),Y(a),p=X([])):(e=[D()],W(")"),p=X(e,a)),d.finishProperty("set",b,p,!1,
!1)):(b=fa(),W("("),W(")"),p=X([]),d.finishProperty("get",b,p,!1,!1));if(a.type===oa.EOF||a.type===oa.Punctuator)H(a);else{if(b=fa(),A(":"))return C(),p=pa(),d.finishProperty("init",b,p,!1,!1);if(A("("))return p=ba(),d.finishProperty("init",b,p,!0,!1);H(C())}}function ca(a){var b,c,p=[],e={},d=String,f=new M;for(!0!==a&&W("{");!A("}");)a=ha(),b=a.key.type===va.Identifier?a.key.name:d(a.key.value),c="init"===a.kind?Za.Data:"get"===a.kind?Za.Get:Za.Set,b="$"+b,Object.prototype.hasOwnProperty.call(e,
b)?(e[b]===Za.Data?Ga&&c===Za.Data?O(Ba.StrictDuplicateProperty):c!==Za.Data&&O(Ba.AccessorDataProperty):c===Za.Data?O(Ba.AccessorDataProperty):e[b]&c&&O(Ba.AccessorGetSet),e[b]|=c):e[b]=c,p.push(a),A("}")||E();return W("}"),f.finishObjectExpression(p)}function ea(){var a,b,c,e;if(A("("))return W("("),A(")")?(C(),Wa.ArrowParameterPlaceHolder):(++xa.parenthesisCount,e=J(),W(")"),e);if(A("[")){var d=[],f=new M;for(W("[");!A("]");)A(",")?(C(),d.push(null)):(d.push(pa()),A("]")||W(","));return C(),f.finishArrayExpression(d)}if(A("{"))return ca();
if(a=ta.type,e=new M,a===oa.Identifier)c=e.finishIdentifier(C().value);else if(a===oa.StringLiteral||a===oa.NumericLiteral)Ga&&ta.octal&&Y(ta,Ba.StrictOctalLiteral),c=e.finishLiteral(C());else if(a===oa.Keyword){if(K("function")){var g,E,n,k;a=null;b=[];c=[];e=new M;return p("function"),A("(")||(a=D()),E=Pa(f),b=E.params,c=E.defaults,d=E.stricted,f=E.firstRestricted,E.message&&(g=E.message),k=Ga,n=sa(),Ga&&f&&H(f,g),Ga&&d&&Y(d,g),Ga=k,e.finishFunctionExpression(a,b,c,n)}K("this")?(C(),c=e.finishThisExpression()):
H(C())}else a===oa.BooleanLiteral?(b=C(),b.value="true"===b.value.toLowerCase(),c=e.finishLiteral(b)):a===oa.NullLiteral?(b=C(),b.value=null,c=e.finishLiteral(b)):A("/")||A("/\x3d")?(c="undefined"!=typeof la.tokens?e.finishLiteral(y()):e.finishLiteral(x()),B()):H(C());return c}function ja(){var a=[];if(W("("),!A(")"))for(;Ca>aa&&(a.push(pa()),!A(")"));)E();return W(")"),a}function na(){var a,b=new M;return a=C(),a.type===oa.Identifier||a.type===oa.Keyword||a.type===oa.BooleanLiteral||a.type===oa.NullLiteral||
H(a),b.finishIdentifier(a.value)}function za(){var a;return W("["),a=J(),W("]"),a}function ua(){var a,b,c=new M;p("new");var e,d,f;l(xa.allowIn,"callee of new expression always allow in keyword.");f=ta;for(e=K("new")?ua():ea();;)if(A("["))d=za(),e=(new R(f)).finishMemberExpression("[",e,d);else{if(!A("."))break;d=(W("."),na());e=(new R(f)).finishMemberExpression(".",e,d)}return a=e,b=A("(")?ja():[],c.finishNewExpression(a,b)}function wa(){var a,b,c=ta,p,e,d,f=xa.allowIn;d=ta;xa.allowIn=!0;for(p=K("new")?
ua():ea();;)if(A("."))e=(W("."),na()),p=(new R(d)).finishMemberExpression(".",p,e);else if(A("("))e=ja(),p=(new R(d)).finishCallExpression(p,e);else{if(!A("["))break;e=za();p=(new R(d)).finishMemberExpression("[",p,e)}return a=(xa.allowIn=f,p),ta.type===oa.Punctuator&&(!A("++")&&!A("--")||P()||(V(a)||O(Ba.InvalidLHSInAssignment),b=C(),a=(new R(c)).finishPostfixExpression(b.value,a))),a}function da(){var a,b,c;return ta.type!==oa.Punctuator&&ta.type!==oa.Keyword?b=wa():A("++")||A("--")?(c=ta,a=C(),
b=da(),V(b)||O(Ba.InvalidLHSInAssignment),b=(new R(c)).finishUnaryExpression(a.value,b)):A("+")||A("-")||A("~")||A("!")?(c=ta,a=C(),b=da(),b=(new R(c)).finishUnaryExpression(a.value,b)):K("delete")||K("void")||K("typeof")?(c=ta,a=C(),b=da(),b=(new R(c)).finishUnaryExpression(a.value,b),Ga&&"delete"===b.operator&&b.argument.type===va.Identifier&&O(Ba.StrictDelete)):b=wa(),b}function ra(a,b){var c=0;if(a.type!==oa.Punctuator&&a.type!==oa.Keyword)return 0;switch(a.value){case "||":c=1;break;case "\x26\x26":c=
2;break;case "|":c=3;break;case "^":c=4;break;case "\x26":c=5;break;case "\x3d\x3d":case "!\x3d":case "\x3d\x3d\x3d":case "!\x3d\x3d":c=6;break;case "\x3c":case "\x3e":case "\x3c\x3d":case "\x3e\x3d":case "instanceof":c=7;break;case "in":c=b?7:0;break;case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":c=8;break;case "+":case "-":c=9;break;case "*":case "/":case "%":c=11}return c}function ga(a){var b,c,p,e,d,f,A,g;e=[];d=[];f=0;A={paramSet:{}};b=0;for(c=a.length;c>b;b+=1)if(p=a[b],p.type===va.Identifier)e.push(p),
d.push(null),Z(A,p,p.name);else{if(p.type!==va.AssignmentExpression)return null;e.push(p.left);d.push(p.right);++f;Z(A,p.left,p.left.name)}return A.message===Ba.StrictParamDupe&&(g=Ga?A.stricted:A.firstRestricted,H(g,A.message)),0===f&&(d=[]),{params:e,defaults:d,rest:null,stricted:A.stricted,firstRestricted:A.firstRestricted,message:A.message}}function pa(){var a,b,c,p,e,d;a=xa.parenthesisCount;b=d=ta;var f,g,E,K;c=ta;var n;var k,h,U,q,r;if((n=ta,k=da(),k!==Wa.ArrowParameterPlaceHolder)&&(h=ta,U=
ra(h,xa.allowIn),0!==U)){h.prec=U;C();n=[n,ta];r=da();for(q=[k,h,r];0<(U=ra(ta,xa.allowIn));){for(;2<q.length&&U<=q[q.length-2].prec;)r=q.pop(),h=q.pop().value,k=q.pop(),n.pop(),k=(new R(n[n.length-1])).finishBinaryExpression(h,k,r),q.push(k);h=C();h.prec=U;q.push(h);n.push(ta);k=da();q.push(k)}U=q.length-1;k=q[U];for(n.pop();1<U;)k=(new R(n.pop())).finishBinaryExpression(q[U-1].value,q[U-2],k),U-=2}n=k;c=(f=n,f===Wa.ArrowParameterPlaceHolder?f:(A("?")&&(C(),g=xa.allowIn,xa.allowIn=!0,E=pa(),xa.allowIn=
g,W(":"),K=pa(),f=(new R(c)).finishConditionalExpression(f,E,K)),f));if(c!==Wa.ArrowParameterPlaceHolder&&!A("\x3d\x3e")||xa.parenthesisCount!==a&&xa.parenthesisCount!==a+1||(c.type===va.Identifier?e=ga([c]):c.type===va.AssignmentExpression?e=ga([c]):c.type===va.SequenceExpression?e=ga(c.expressions):c===Wa.ArrowParameterPlaceHolder&&(e=ga([])),!e)){var t;d=((ta.type!==oa.Punctuator?!1:(t=ta.value,"\x3d"===t||"*\x3d"===t||"/\x3d"===t||"%\x3d"===t||"+\x3d"===t||"-\x3d"===t||"\x3c\x3c\x3d"===t||"\x3e\x3e\x3d"===
t||"\x3e\x3e\x3e\x3d"===t||"\x26\x3d"===t||"^\x3d"===t||"|\x3d"===t))&&(V(c)||O(Ba.InvalidLHSInAssignment),b=C(),p=pa(),c=(new R(d)).finishAssignmentExpression(b.value,c,p)),c)}else{b=e;p=new R(d);var l,w;d=(W("\x3d\x3e"),l=Ga,w=A("{")?sa():pa(),Ga&&b.firstRestricted&&H(b.firstRestricted,b.message),Ga&&b.stricted&&Y(b.stricted,b.message),Ga=l,p.finishArrowFunctionExpression(b.params,b.defaults,w,w.type!==va.BlockStatement))}return d}function J(){var a,b=ta;if(a=pa(),A(",")){for(a=[a];Ca>aa&&A(",");)C(),
a.push(pa());a=(new R(b)).finishSequenceExpression(a)}return a}function D(){var a,b=new M;return a=C(),a.type!==oa.Identifier&&H(a),b.finishIdentifier(a.value)}function Ea(a){var b,c=null,p=new M;return b=D(),"const"===a?(W("\x3d"),c=pa()):A("\x3d")&&(C(),c=pa()),p.finishVariableDeclarator(b,c)}function L(a){var b=[];do{if(b.push(Ea(a)),!A(","))break;C()}while(Ca>aa);return b}function Fa(a){var b,c,e,d,f=ta.type;if(f===oa.EOF&&H(ta),f===oa.Punctuator&&"{"===ta.value){if(a){W("{");var g,E,n,h,q;g=
ta;g=(E=aa,n=ya,h=Aa,C(),q=A(":"),ta=g,aa=E,ya=n,Aa=h,q);if(ta.type!==oa.Identifier&&ta.type!==oa.StringLiteral||!g){g=new M;for(var r=[];Ca>aa&&!A("}")&&(d=Ha(),"undefined"!=typeof d);)r.push(d);g=(W("}"),g.finishBlockStatement(r))}else g=ca(!0);return g}return ca()}if(d=new M,f===oa.Punctuator)switch(ta.value){case ";":return g=new M,W(";"),g.finishEmptyStatement();case "(":return g=J(),U(),d.finishExpressionStatement(g)}else if(f===oa.Keyword)switch(ta.value.toLowerCase()){case "break":var t;g=
null;return p("break"),59===ka.charCodeAt(aa)?(C(),xa.inIteration||xa.inSwitch||T(Ba.IllegalBreak),d.finishBreakStatement(null)):P()?(xa.inIteration||xa.inSwitch||T(Ba.IllegalBreak),d.finishBreakStatement(null)):(ta.type===oa.Identifier&&(g=D(),t="$"+g.name,Object.prototype.hasOwnProperty.call(xa.labelSet,t)||T(Ba.UnknownLabel,g.name)),U(),null!==g||xa.inIteration||xa.inSwitch||T(Ba.IllegalBreak),d.finishBreakStatement(g));case "continue":var l;g=null;return p("continue"),59===ka.charCodeAt(aa)?(C(),
xa.inIteration||T(Ba.IllegalContinue),d.finishContinueStatement(null)):P()?(xa.inIteration||T(Ba.IllegalContinue),d.finishContinueStatement(null)):(ta.type===oa.Identifier&&(g=D(),l="$"+g.name,Object.prototype.hasOwnProperty.call(xa.labelSet,l)||T(Ba.UnknownLabel,g.name)),U(),null!==g||xa.inIteration||T(Ba.IllegalContinue),d.finishContinueStatement(g));case "for":var w,u;h=xa.allowIn;q=E=n=null;p("for");W("(");if(A(";"))C();else{if(K("var")){xa.allowIn=!1;var v,X;q=new M;q=(v=C(),X=L(),q.finishVariableDeclaration(X,
v.value));xa.allowIn=h;1===q.declarations.length&&K("in")&&(C(),g=q,r=J(),q=null)}else xa.allowIn=!1,q=J(),xa.allowIn=h,K("in")&&(V(q)||O(Ba.InvalidLHSInForIn),C(),g=q,r=J(),q=null);"undefined"==typeof g&&W(";")}return"undefined"==typeof g&&(A(";")||(E=J()),W(";"),A(")")||(n=J())),W(")"),u=xa.inIteration,xa.inIteration=!0,w=Fa(!0),xa.inIteration=u,"undefined"==typeof g?d.finishForStatement(q,E,n,w):d.finishForInStatement(g,r,w);case "function":return Ia(d);case "if":var x,y,ba;return p("if"),W("("),
x=J(),W(")"),y=Fa(!0),K("else")?(C(),ba=Fa(!0)):ba=null,d.finishIfStatement(x,y,ba);case "return":return g=null,p("return"),xa.inFunctionBody||O(Ba.IllegalReturn),32===ka.charCodeAt(aa)&&k(ka.charCodeAt(aa+1))?(g=J(),U(),d.finishReturnStatement(g)):P()?d.finishReturnStatement(null):(A(";")||A("}")||ta.type===oa.EOF||(g=J()),U(),d.finishReturnStatement(g));case "var":var m;return p("var"),m=L(),U(),d.finishVariableDeclaration(m,"var")}return b=J(),b.type===va.Identifier&&A(":")?(C(),e="$"+b.name,Object.prototype.hasOwnProperty.call(xa.labelSet,
e)&&T(Ba.Redeclaration,"Label",b.name),xa.labelSet[e]=!0,c=Fa(!1),delete xa.labelSet[e],d.finishLabeledStatement(b,c)):(U(),d.finishExpressionStatement(b))}function sa(){var a,b,c,p,e,d,f=[],g=new M;for(W("{");Ca>aa&&ta.type===oa.StringLiteral&&(b=ta,a=Ha(),f.push(a),a.expression.type===va.Literal);)c=ka.slice(b.start+1,b.end-1),"use strict"===c?(Ga=!0,p&&Y(p,Ba.StrictOctalLiteral)):!p&&b.octal&&(p=b);b=xa.labelSet;c=xa.inIteration;p=xa.inSwitch;e=xa.inFunctionBody;d=xa.parenthesizedCount;xa.labelSet=
{};xa.inIteration=!1;xa.inSwitch=!1;xa.inFunctionBody=!0;for(xa.parenthesizedCount=0;Ca>aa&&!A("}")&&(a=Ha(),"undefined"!=typeof a);)f.push(a);return W("}"),xa.labelSet=b,xa.inIteration=c,xa.inSwitch=p,xa.inFunctionBody=e,xa.parenthesizedCount=d,g.finishBlockStatement(f)}function Z(a,b,c){c="$"+c;Ga?Object.prototype.hasOwnProperty.call(a.paramSet,c)&&(a.stricted=b,a.message=Ba.StrictParamDupe):a.firstRestricted||Object.prototype.hasOwnProperty.call(a.paramSet,c)&&(a.firstRestricted=b,a.message=Ba.StrictParamDupe);
a.paramSet[c]=!0}function ma(a){var b,c,p;return b=ta,c=D(),Z(a,b,b.value),A("\x3d")&&(C(),p=pa(),++a.defaultCount),a.params.push(c),a.defaults.push(p),!A(")")}function Pa(a){if(a={params:[],defaultCount:0,defaults:[],firstRestricted:a},W("("),!A(")"))for(a.paramSet={};Ca>aa&&ma(a);)W(",");return W(")"),0===a.defaultCount&&(a.defaults=[]),{params:a.params,defaults:a.defaults,stricted:a.stricted,firstRestricted:a.firstRestricted,message:a.message}}function Ia(){var a,b,c,e,d,f,A,g=[],E=[],K=new M;
return p("function"),a=D(),e=Pa(d),g=e.params,E=e.defaults,c=e.stricted,d=e.firstRestricted,e.message&&(f=e.message),A=Ga,b=sa(),Ga&&d&&H(d,f),Ga&&c&&Y(c,f),Ga=A,K.finishFunctionDeclaration(a,g,E,b)}function Ha(){return ta.type===oa.Keyword?"function"===ta.value.toLowerCase()?Ia():Fa(!1):ta.type!==oa.EOF?Fa(!1):void 0}function Xa(){var a,b,c,p=[];for(a=0;a<la.tokens.length;++a)b=la.tokens[a],c={type:b.type,value:b.value},b.regex&&(c.regex={pattern:b.regex.pattern,flags:b.regex.flags}),la.range&&(c.range=
b.range),la.loc&&(c.loc=b.loc),p.push(c);la.tokens=p}var oa,Ma,Ka,va,Wa,Za,Ba,Va,ka,Ga,aa,ya,Aa,Ca,ta,xa,la;oa={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};Ma={};Ma[oa.BooleanLiteral]="Boolean";Ma[oa.EOF]="\x3cend\x3e";Ma[oa.Identifier]="Identifier";Ma[oa.Keyword]="Keyword";Ma[oa.NullLiteral]="Null";Ma[oa.NumericLiteral]="Numeric";Ma[oa.Punctuator]="Punctuator";Ma[oa.StringLiteral]="String";Ma[oa.RegularExpression]=
"RegularExpression";Ka="( { [ in typeof instanceof new return case delete throw void \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3c\x3c\x3d \x3e\x3e\x3d \x3e\x3e\x3e\x3d \x26\x3d |\x3d ^\x3d , + - * / % ++ -- \x3c\x3c \x3e\x3e \x3e\x3e\x3e \x26 | ^ ! ~ \x26\x26 || ? : \x3d\x3d\x3d \x3d\x3d \x3e\x3d \x3c\x3d \x3c \x3e !\x3d !\x3d\x3d".split(" ");va={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",
CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",
ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"};Wa={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};Za={Data:1,Get:2,Set:4};Ba={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",
UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",
Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",
StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",
StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};Va={NonAsciiIdentifierStart:/[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/,
NonAsciiIdentifierPart:/[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/};
R.prototype=M.prototype={processComment:function(){var a,b,c,p,e,d=la.bottomRightStack,f=d[d.length-1];if(!(this.type===va.Program&&0<this.body.length)){if(0<la.trailingComments.length){c=[];for(p=la.trailingComments.length-1;0<=p;--p)e=la.trailingComments[p],e.range[0]>=this.range[1]&&(c.unshift(e),la.trailingComments.splice(p,1));la.trailingComments=[]}else f&&f.trailingComments&&f.trailingComments[0].range[0]>=this.range[1]&&(c=f.trailingComments,delete f.trailingComments);if(f)for(;f&&f.range[0]>=
this.range[0];)a=f,f=d.pop();if(a)a.leadingComments&&a.leadingComments[a.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=a.leadingComments,a.leadingComments=void 0);else if(0<la.leadingComments.length)for(b=[],p=la.leadingComments.length-1;0<=p;--p)e=la.leadingComments[p],e.range[1]<=this.range[0]&&(b.unshift(e),la.leadingComments.splice(p,1));b&&0<b.length&&(this.leadingComments=b);c&&0<c.length&&(this.trailingComments=c);d.push(this)}},finish:function(){la.range&&(this.range[1]=
aa);la.loc&&(this.loc.end=new F,la.source&&(this.loc.source=la.source));la.attachComment&&this.processComment()},finishArrayExpression:function(a){return this.type=va.ArrayExpression,this.elements=a,this.finish(),this},finishAssignmentExpression:function(a,b,c){return this.type=va.AssignmentExpression,this.operator=a,this.left=b,this.right=c,this.finish(),this},finishBinaryExpression:function(a,b,c){return this.type="||"===a||"\x26\x26"===a?va.LogicalExpression:va.BinaryExpression,this.operator=a,
this.left=b,this.right=c,this.finish(),this},finishBlockStatement:function(a){return this.type=va.BlockStatement,this.body=a,this.finish(),this},finishBreakStatement:function(a){return this.type=va.BreakStatement,this.label=a,this.finish(),this},finishCallExpression:function(a,b){return this.type=va.CallExpression,this.callee=a,this.arguments=b,this.finish(),this},finishConditionalExpression:function(a,b,c){return this.type=va.ConditionalExpression,this.test=a,this.consequent=b,this.alternate=c,this.finish(),
this},finishContinueStatement:function(a){return this.type=va.ContinueStatement,this.label=a,this.finish(),this},finishEmptyStatement:function(){return this.type=va.EmptyStatement,this.finish(),this},finishExpressionStatement:function(a){return this.type=va.ExpressionStatement,this.expression=a,this.finish(),this},finishForStatement:function(a,b,c,p){return this.type=va.ForStatement,this.init=a,this.test=b,this.update=c,this.body=p,this.finish(),this},finishForInStatement:function(a,b,c){return this.type=
va.ForInStatement,this.left=a,this.right=b,this.body=c,this.each=!1,this.finish(),this},finishFunctionDeclaration:function(a,b,c,p){return this.type=va.FunctionDeclaration,this.id=a,this.params=b,this.defaults=c,this.body=p,this.rest=null,this.generator=!1,this.expression=!1,this.finish(),this},finishFunctionExpression:function(a,b,c,p){return this.type=va.FunctionExpression,this.id=a,this.params=b,this.defaults=c,this.body=p,this.rest=null,this.generator=!1,this.expression=!1,this.finish(),this},
finishIdentifier:function(a){return this.type=va.Identifier,this.name=a,this.finish(),this},finishIfStatement:function(a,b,c){return this.type=va.IfStatement,this.test=a,this.consequent=b,this.alternate=c,this.finish(),this},finishLiteral:function(a){return this.type=va.Literal,this.value=a.value,this.raw=ka.slice(a.start,a.end),a.regex&&(this.regex=a.regex),this.finish(),this},finishMemberExpression:function(a,b,c){return this.type=va.MemberExpression,this.computed="["===a,this.object=b,this.property=
c,this.finish(),this},finishObjectExpression:function(a){return this.type=va.ObjectExpression,this.properties=a,this.finish(),this},finishPostfixExpression:function(a,b){return this.type=va.UpdateExpression,this.operator=a,this.argument=b,this.prefix=!1,this.finish(),this},finishProgram:function(a){return this.type=va.Program,this.body=a,this.finish(),this},finishProperty:function(a,b,c,p,e){return this.type=va.Property,this.key=b,this.value=c,this.kind=a,this.method=p,this.shorthand=e,this.finish(),
this},finishReturnStatement:function(a){return this.type=va.ReturnStatement,this.argument=a,this.finish(),this},finishUnaryExpression:function(a,b){return this.type="++"===a||"--"===a?va.UpdateExpression:va.UnaryExpression,this.operator=a,this.argument=b,this.prefix=!0,this.finish(),this},finishVariableDeclaration:function(a,b){return this.type=va.VariableDeclaration,this.declarations=a,this.kind=b,this.finish(),this},finishVariableDeclarator:function(a,b){return this.type=va.VariableDeclarator,this.id=
a,this.init=b,this.finish(),this}};m.version="2.0.0-dev";m.tokenize=function(a,b){var c,p;c=String;"string"==typeof a||a instanceof String||(a=c(a));ka=a;aa=0;ya=0<ka.length?1:0;Aa=0;Ca=ka.length;ta=null;xa={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};la={};b=b||{};b.tokens=!0;la.tokens=[];la.tokenize=!0;la.openParenToken=-1;la.openCurlyToken=-1;la.range="boolean"==typeof b.range&&b.range;la.loc="boolean"==typeof b.loc&&b.loc;"boolean"==typeof b.comment&&
b.comment&&(la.comments=[]);"boolean"==typeof b.tolerant&&b.tolerant&&(la.errors=[]);try{if(B(),ta.type===oa.EOF)return la.tokens;for(C();ta.type!==oa.EOF;)try{C()}catch(jb){if(la.errors){la.errors.push(jb);break}throw jb;}Xa();p=la.tokens;"undefined"!=typeof la.comments&&(p.comments=la.comments);"undefined"!=typeof la.errors&&(p.errors=la.errors)}catch(jb){throw jb;}finally{la={}}return p};m.parse=function(a,b){var c,p;p=String;"string"==typeof a||a instanceof String||(a=p(a));ka=a;aa=0;ya=0<ka.length?
1:0;Aa=0;Ca=ka.length;ta=null;xa={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};la={};"undefined"!=typeof b&&(la.range="boolean"==typeof b.range&&b.range,la.loc="boolean"==typeof b.loc&&b.loc,la.attachComment="boolean"==typeof b.attachComment&&b.attachComment,la.loc&&null!==b.source&&void 0!==b.source&&(la.source=p(b.source)),"boolean"==typeof b.tokens&&b.tokens&&(la.tokens=[]),"boolean"==typeof b.comment&&b.comment&&(la.comments=[]),"boolean"==
typeof b.tolerant&&b.tolerant&&(la.errors=[]),la.attachComment&&(la.range=!0,la.comments=[],la.bottomRightStack=[],la.trailingComments=[],la.leadingComments=[]));try{var e;q();B();e=new M;Ga=!1;var d,f,A,g;for(a=[];Ca>aa&&(f=ta,f.type===oa.StringLiteral)&&(d=Ha(),a.push(d),d.expression.type===va.Literal);)A=ka.slice(f.start+1,f.end-1),"use strict"===A?(Ga=!0,g&&Y(g,Ba.StrictOctalLiteral)):!g&&f.octal&&(g=f);for(;Ca>aa&&(d=Ha(),"undefined"!=typeof d);)a.push(d);c=e.finishProgram(a);"undefined"!=typeof la.comments&&
(c.comments=la.comments);"undefined"!=typeof la.tokens&&(Xa(),c.tokens=la.tokens);"undefined"!=typeof la.errors&&(c.errors=la.errors)}catch(fb){throw fb;}finally{la={}}return c};m.Syntax=function(){var a,b={};"function"==typeof Object.create&&(b=Object.create(null));for(a in va)va.hasOwnProperty(a)&&(b[a]=va[a]);return"function"==typeof Object.freeze&&Object.freeze(b),b}()})},"esri/arcade/arcadeCompiler":function(){define("require exports ../geometry/Polygon ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../geometry/SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/geomsync ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z){function C(a,b,c){try{return c(a,null,b)}catch(ca){throw ca;}}function B(a,b){try{switch(b.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return R(a,b);case "VariableDeclaration":for(var c=[],p=0;p<b.declarations.length;p++)c.push(B(a,b.declarations[p]));return c.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";case "BlockStatement":return M(a,b);case "FunctionDeclaration":var d=b.id.name.toLowerCase(),f={applicationCache:void 0===
a.applicationCache?null:a.applicationCache,spatialReference:a.spatialReference,console:a.console,symbols:a.symbols,localScope:{_SymbolsMap:{}},depthCounter:a.depthCounter+1,globalScope:a.globalScope};if(64<f.depthCounter)throw Error("Exceeded maximum function depth");for(var c="new lc.SizzleFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; var lscope \x3d [];\n ",A=0;A<b.params.length;A++){var g=b.params[A].name.toLowerCase(),E=Y(g,a);f.localScope._SymbolsMap[g]=
E;c+="lscope['"+E+"']\x3darguments["+A.toString()+"];\n"}(c+=M(f,b.body)+"\n return lastStatement; }, runtimeCtx))",c+="\n lastStatement \x3d lc.voidOperation; \n",void 0!==a.globalScope[d])?p="gscope['"+d+"']\x3d"+c:void 0!==a.globalScope._SymbolsMap[d]?p="gscope['"+a.globalScope._SymbolsMap[d]+"']\x3d"+c:(E=Y(d,a),p=(a.globalScope._SymbolsMap[d]=E,"gscope['"+E+"']\x3d"+c));return p;case "ReturnStatement":var K;K=null===b.argument?"return lc.voidOperation;":"return "+B(a,b.argument)+";";return K;
case "IfStatement":if("AssignmentExpression"===b.test.type||"UpdateExpression"===b.test.type)throw Error(e.nodeErrorMessage(b.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var n=B(a,b.test),k=W(a),h="var "+k+" \x3d "+n+";\n if ("+k+" \x3d\x3d\x3d true) {\n"+N(a,b.consequent)+"\n }\n";return h+=null!==b.alternate?"else if ("+k+"\x3d\x3d\x3dfalse)   { \n"+N(a,b.alternate)+"}\n":"else if ("+k+"\x3d\x3d\x3dfalse) { \n lastStatement \x3d lc.voidOperation;\n }\n",h+="else { lang.error({type: '"+
b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION'); \n}\n";case "ExpressionStatement":return"AssignmentExpression"===b.expression.type?"lastStatement \x3d lc.voidOperation; "+B(a,b.expression)+" \n ":"lastStatement \x3d "+B(a,b.expression)+";";case "AssignmentExpression":return G(a,b);case "UpdateExpression":return F(a,b);case "BreakStatement":return"break;";case "ContinueStatement":return"continue;";case "ForStatement":c="lastStatement \x3d lc.voidOperation; \n";null!==b.init&&(c+=B(a,b.init));
var U=W(a),q=W(a);return c+="var "+U+" \x3d true;",c+="\n do { ",null!==b.update&&(c+=" if ("+U+"\x3d\x3d\x3dfalse) {\n "+B(a,b.update)+"  \n}\n "+U+"\x3dfalse; \n"),null!==b.test&&(c+="var "+q+" \x3d "+B(a,b.test)+";",c+="if ("+q+"\x3d\x3d\x3dfalse) { break; } else if ("+q+"!\x3d\x3dtrue) { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION');   }\n"),c+=B(a,b.body),null!==b.update&&(c+="\n "+B(a,b.update)),c+="\n"+U+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation;";
case "ForInStatement":var H=W(a),r=W(a),V=W(a),t="var "+H+" \x3d "+B(a,b.right)+";\n";"VariableDeclaration"===b.left.type&&(t+=B(a,b.left));var l="VariableDeclaration"===b.left.type?b.left.declarations[0].id.name:b.left.name,l=l.toLowerCase(),c="";return null!==a.localScope&&(void 0!==a.localScope[l]?c="lscope['"+l+"']":void 0!==a.localScope._SymbolsMap[l]&&(c="lscope['"+a.localScope._SymbolsMap[l]+"']")),""===c&&(void 0!==a.globalScope[l]?c="gscope['"+l+"']":void 0!==a.globalScope._SymbolsMap[l]&&
(c="gscope['"+a.globalScope._SymbolsMap[l]+"']")),t+="if ("+H+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n ",t+="else if (lc.isArray("+H+") || lc.isString("+H+")) {",t+="var "+r+"\x3d"+H+".length; \n",t+="for(var "+V+"\x3d0; "+V+"\x3c"+r+"; "+V+"++) {\n",t+=c+"\x3d"+V+";\n",t+=B(a,b.body),t+="\n}\n",t+=" lastStatement \x3d lc.voidOperation; \n",t+=" \n}\n",t+="else if (lc.isImmutableArray("+H+")) {",t+="var "+r+"\x3d"+H+".length(); \n",t+="for(var "+V+"\x3d0; "+V+"\x3c"+r+"; "+V+
"++) {\n",t+=c+"\x3d"+V+";\n",t+=B(a,b.body),t+="\n}\n",t+=" lastStatement \x3d lc.voidOperation; \n",t+=" \n}\n",t+="else if (( "+H+" instanceof lang.Dictionary) || ( "+H+" instanceof lang.Feature)) {",t+="var "+r+"\x3d"+H+".keys(); \n",t+="for(var "+V+"\x3d0; "+V+"\x3c"+r+".length; "+V+"++) {\n",t+=c+"\x3d"+r+"["+V+"];\n",t+=B(a,b.body),t+="\n}\n",t+=" lastStatement \x3d lc.voidOperation; \n",t+=" \n}\n",t+="else { lastStatement \x3d lc.voidOperation; } \n";case "Identifier":return Q(a,b);case "MemberExpression":var w;
try{c=void 0,w=(c=!0===b.computed?B(a,b.property):"'"+b.property.name+"'","lang.member("+B(a,b.object)+","+c+")")}catch(Ka){throw Ka;}return w;case "Literal":return null===b.value||void 0===b.value?"null":JSON.stringify(b.value);case "ThisExpression":throw Error(e.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "CallExpression":try{if("Identifier"!==b.callee.type)throw Error(e.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));var u=b.callee.name.toLowerCase(),p="";if(null!==a.localScope&&(void 0!==
a.localScope[u]?p="lscope['"+u+"']":void 0!==a.localScope._SymbolsMap[u]&&(p="lscope['"+a.localScope._SymbolsMap[u]+"']")),""===p&&(void 0!==a.globalScope[u]?p="gscope['"+u+"']":void 0!==a.globalScope._SymbolsMap[u]&&(p="gscope['"+a.globalScope._SymbolsMap[u]+"']")),""!==p){d="[";for(f=0;f<b.arguments.length;f++)0<f&&(d+=", "),d+=B(a,b.arguments[f]);c=(d+="]","lang.callfunc("+p+","+d+",runtimeCtx)")}else throw Error(e.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(Ka){throw Ka;}return c;case "UnaryExpression":var v;
try{v="lang.unary("+B(a,b.argument)+",'"+b.operator+"')"}catch(Ka){throw Ka;}return v;case "BinaryExpression":var X;try{X="lang.binary("+B(a,b.left)+","+B(a,b.right)+",'"+b.operator+"')"}catch(Ka){throw Ka;}return X;case "LogicalExpression":var x;try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(e.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw Error(e.nodeErrorMessage(b.right,
"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("\x26\x26"===b.operator||"||"===b.operator)x="(lang.logicalCheck("+B(a,b.left)+") "+b.operator+" lang.logicalCheck("+B(a,b.right)+"))";else throw Error(e.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));}catch(Ka){throw Ka;}return x;case "ConditionalExpression":throw Error(e.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{c=[];for(p=0;p<b.elements.length;p++)"Literal"===b.elements[p].type?c.push(B(a,b.elements[p])):
c.push("lang.aCheck("+B(a,b.elements[p])+",'ArrayExpression')");A="["+c.join(",")+"]"}catch(Ka){throw Ka;}return A;case "ObjectExpression":c="lang.dictionary([";for(p=0;p<b.properties.length;p++){var y=b.properties[p],ba="Identifier"===y.key.type?"'"+y.key.name+"'":B(a,y.key),m=B(a,y.value);0<p&&(c+=",");c+="lang.strCheck("+ba+",'ObjectExpression'),lang.aCheck("+m+", 'ObjectExpression')"}return c+="])";case "Property":throw Error("Should not get here");case "Array":throw Error(e.nodeErrorMessage(b,
"RUNTIME","NOTSUPPORTED"));default:throw Error(e.nodeErrorMessage(b,"RUNTIME","UNREOGNISED"));}}catch(Ka){throw Ka;}}function F(a,b){var c=null,p="";if("MemberExpression"===b.argument.type)return c=B(a,b.argument.object),p=!0===b.argument.computed?B(a,b.argument.property):"'"+b.argument.property.name+"'","lang.memberupdate("+c+","+p+",'"+b.operator+"',"+b.prefix+")";if(c=b.argument.name.toLowerCase(),null!==a.localScope){if(void 0!==a.localScope[c])return"lang.update(lscope, '"+c+"','"+b.operator+
"',"+b.prefix+")";if(void 0!==a.localScope._SymbolsMap[c])return"lang.update(lscope, '"+a.localScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")"}if(void 0!==a.globalScope[c])return"lang.update(gscope, '"+c+"','"+b.operator+"',"+b.prefix+")";if(void 0!==a.globalScope._SymbolsMap[c])return"lang.update(gscope, '"+a.globalScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")";throw Error("Variable not recognised");}function G(a,b){var c=B(a,b.right),p=null,e="";if("MemberExpression"===b.left.type)return p=
B(a,b.left.object),e=!0===b.left.computed?B(a,b.left.property):"'"+b.left.property.name+"'","lang.assignmember("+p+","+e+",'"+b.operator+"',"+c+");";if(p=b.left.name.toLowerCase(),null!==a.localScope){if(void 0!==a.localScope[p])return"lscope['"+p+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+p+"']); ";if(void 0!==a.localScope._SymbolsMap[p])return"lscope['"+a.localScope._SymbolsMap[p]+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+a.localScope._SymbolsMap[p]+"']); "}if(void 0!==a.globalScope[p])return"gscope['"+
p+"']\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+p+"']); ";if(void 0!==a.globalScope._SymbolsMap[p])return"gscope['"+a.globalScope._SymbolsMap[p]+"']\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+a.globalScope._SymbolsMap[p]+"']); ";throw Error("Variable not recognised");}function N(a,b){return"BlockStatement"===b.type?B(a,b):"ReturnStatement"===b.type?B(a,b):"BreakStatement"===b.type?B(a,b):"ContinueStatement"===b.type?B(a,b):"UpdateExpression"===b.type?"lastStatement \x3d "+B(a,b)+";":
"ExpressionStatement"===b.type?B(a,b):"ObjectExpression"===b.type?"lastStatement \x3d "+B(a,b)+";":B(a,b)}function M(a,b){for(var c="",p=0;p<b.body.length;p++)c+="ReturnStatement"===b.body[p].type?B(a,b.body[p])+" \n":"BreakStatement"===b.body[p].type?B(a,b.body[p])+" \n":"ContinueStatement"===b.body[p].type?B(a,b.body[p])+" \n":"UpdateExpression"===b.body[p].type?"lastStatement \x3d "+B(a,b.body[p])+"; \n":"ObjectExpression"===b.body[p].type?"lastStatement \x3d "+B(a,b.body[p])+"; \n":B(a,b.body[p])+
" \n";return c}function R(b,c){var p=null===c.init?null:B(b,c.init);p===a.voidOperation&&(p=null);c=c.id.name.toLowerCase();if(null!==b.localScope){if(void 0!==b.localScope[c])return"lscope['"+c+"']\x3d"+p+";";if(void 0!==b.localScope._SymbolsMap[c])return"lscope['"+b.localScope._SymbolsMap[c]+"']\x3d"+p+";";var e=Y(c,b);return b.localScope._SymbolsMap[c]=e,"lscope['"+e+"']\x3d"+p+";"}if(void 0!==b.globalScope[c])return"gscope['"+c+"']\x3d"+p+";";if(void 0!==b.globalScope._SymbolsMap[c])return"gscope['"+
b.globalScope._SymbolsMap[c]+"']\x3d"+p+";";e=Y(c,b);return b.globalScope._SymbolsMap[c]=e,"gscope['"+e+"']\x3d"+p+";"}function P(b,p,d){switch(p=p.toLowerCase()){case "hasz":return b=b.hasZ,void 0===b?!1:b;case "hasm":return b=b.hasM,void 0===b?!1:b;case "spatialreference":return p=b.spatialReference._arcadeCacheId,void 0===p&&(d=!0,Object.freeze&&Object.isFrozen(b.spatialReference)&&(d=!1),d&&(A++,b.spatialReference._arcadeCacheId=A,p=A)),b=new c({wkt:b.spatialReference.wkt,wkid:b.spatialReference.wkid}),
void 0!==p&&(b._arcadeCacheId="SPREF"+p.toString()),b}switch(b.type){case "extent":switch(p){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return b=b[p],void 0!==b?b:null;case "type":return"Extent"}break;case "polygon":switch(p){case "rings":return p=a.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===p&&(A++,p=A,a.isVersion4?b.cache._arcadeCacheId=p:b.setCacheValue("_arcadeCacheId",p)),b=new n(b.rings,b.spatialReference,
!0===b.hasZ,!0===b.hasM,p);case "type":return"Polygon"}break;case "point":switch(p){case "x":case "y":case "z":case "m":return void 0!==b[p]?b[p]:null;case "type":return"Point"}break;case "polyline":switch(p){case "paths":return p=a.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===p&&(A++,p=A,a.isVersion4?b.cache._arcadeCacheId=p:b.setCacheValue("_arcadeCacheId",p)),b=new n(b.paths,b.spatialReference,!0===b.hasZ,!0===b.hasM,p);case "type":return"Polyline"}break;case "multipoint":switch(p){case "points":return p=
a.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===p&&(A++,p=A,a.isVersion4?b.cache._arcadeCacheId=p:b.setCacheValue("_arcadeCacheId",p)),b=new w(b.points,b.spatialReference,!0===b.hasZ,!0===b.hasM,p,1);case "type":return"Multipoint"}}throw Error(e.nodeErrorMessage(d,"RUNTIME","PROPERTYNOTFOUND"));}function Q(a,b){try{var c=b.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[c])return"lscope['"+c+"']";if(void 0!==a.localScope._SymbolsMap[c])return"lscope['"+
a.localScope._SymbolsMap[c]+"']"}if(void 0!==a.globalScope[c])return"gscope['"+c+"']";if(void 0!==a.globalScope._SymbolsMap[c])return"gscope['"+a.globalScope._SymbolsMap[c]+"']";throw Error(e.nodeErrorMessage(b,"RUNTIME","VARIABLENOTFOUND"));}catch(ca){throw ca;}}function T(p){return null===p?"":a.isArray(p)?"Array":a.isImmutableArray(p)?"Array":a.isDate(p)?"Date":a.isString(p)?"String":a.isBoolean(p)?"Boolean":a.isNumber(p)?"Number":p instanceof c?"Dictionary":p instanceof q?"Feature":p instanceof
b?"Point":p instanceof h?"Polygon":p instanceof d?"Polyline":p instanceof k?"Multipoint":p instanceof g?"Extent":a.isFunctionParameter(p)?"Function":p===a.voidOperation?"":"number"==typeof p&&isNaN(p)?"Number":"Unrecognised Type"}function O(b,c,p,e){try{if(a.equalityTest(c[p],e))return c[p+1];var d=c.length-p;return 1===d?c[p]:2===d?null:3===d?c[p+2]:O(b,c,p+2,e)}catch(ja){throw ja;}}function S(b,c,p,e){try{if(!0===e)return c[p+1];if(3===c.length-p)return c[p+2];var d=c[p+2];if(!1===a.isBoolean(d))throw Error("WHEN needs boolean test conditions");
return S(b,c,p+2,d)}catch(ja){throw ja;}}function H(a,b){var c=a.length,p=Math.floor(c/2);if(0===c)b=[];else if(1===c)b=[a[0]];else{var e=H(a.slice(0,p),b);a=H(a.slice(p,c),b);for(c=[];0<e.length||0<a.length;)0<e.length&&0<a.length?(p=b(e[0],a[0]),isNaN(p)&&(p=0),0>=p?(c.push(e[0]),e=e.slice(1)):(c.push(a[0]),a=a.slice(1))):0<e.length?(c.push(e[0]),e=e.slice(1)):0<a.length&&(c.push(a[0]),a=a.slice(1));b=c}return b}function Y(a,b){return b.symbols.symbolCounter++,"_T"+b.symbols.symbolCounter.toString()}
function W(a){return a.symbols.symbolCounter++,"_Tvar"+a.symbols.symbolCounter.toString()}function E(a,b,c){var p={};a||(a={});c||(c={});p._SymbolsMap={};p.textformatting=1;p.infinity=1;p.pi=1;for(var e in b)p[e]=1;for(e in c)p[e]=1;for(e in a)p[e]=1;return p}function p(a){console.log(a)}Object.defineProperty(l,"__esModule",{value:!0});var A=0,K={};t.registerFunctions(K,C);r.registerFunctions(K,C);u.registerFunctions(K,C);v.registerFunctions(K,C);y.registerFunctions(K,C);x.registerFunctions(K,C);
K["typeof"]=function(b,c){return C(b,c,function(b,c,p){a.pcCheck(p,1,1);b=T(p[0]);if("Unrecognised Type"===b)throw Error("Unrecognised Type");return b})};K.iif=function(b,c){try{return C(b,c,function(b,c,p){if(a.pcCheck(p,3,3),!1===a.isBoolean(p[0]))throw Error("IF Function must have a boolean test condition");return p[0]?p[1]:p[2]})}catch(ha){throw ha;}};K.decode=function(a,b){try{return C(a,b,function(b,c,p){if(2>p.length)throw Error("Missing Parameters");if(2===p.length)return p[1];if(0===(p.length-
1)%2)throw Error("Must have a default value result.");return O(a,p,1,p[0])})}catch(ha){throw ha;}};K.when=function(b,c){try{return C(b,c,function(c,p,e){if(3>e.length)throw Error("Missing Parameters");if(0===e.length%2)throw Error("Must have a default value result.");c=e[0];if(!1===a.isBoolean(c))throw Error("WHEN needs boolean test conditions");return S(b,e,0,c)})}catch(ha){throw ha;}};K.top=function(b,c){return C(b,c,function(b,c,p){if(a.pcCheck(p,2,2),a.isArray(p[0]))return a.toNumber(p[1])>=p[0].length?
p[0].slice(0):p[0].slice(0,a.toNumber(p[1]));if(a.isImmutableArray(p[0]))return a.toNumber(p[1])>=p[0].length()?p[0].slice(0):p[0].slice(0,a.toNumber(p[1]));throw Error("Top cannot accept this parameter type");})};K.first=function(b,c){return C(b,c,function(b,c,p){return a.pcCheck(p,1,1),a.isArray(p[0])?0===p[0].length?null:p[0][0]:a.isImmutableArray(p[0])?0===p[0].length()?null:p[0].get(0):null})};K.sort=function(b,c){return C(b,c,function(b,c,p){a.pcCheck(p,1,2);c=p[0];if(a.isImmutableArray(c)&&
(c=c.toArray()),!1===a.isArray(c))throw Error("Illegal Argument");if(1<p.length){if(!1===a.isFunctionParameter(p[1]))throw Error("Illegal Argument");return c=H(c,function(a,c){return X.callfunc(p[1],[a,c],b)})}if(0===c.length)return[];for(var e={},d=0;d<c.length;d++){var f=T(c[d]);""!==f&&(e[f]=!0)}if(!0===e.Array||!0===e.Dictionary||!0===e.Feature||!0===e.Point||!0===e.Polygon||!0===e.Polyline||!0===e.Multipoint||!0===e.Extent||!0===e.Function)return c.slice(0);var d=0,f="",A;for(A in e)d++,f=A;
return c=1<d||"String"===f?H(c,function(b,c){if(null===b||void 0===b||b===a.voidOperation)return null===c||void 0===c||c===a.voidOperation?0:1;if(null===c||void 0===c||c===a.voidOperation)return-1;b=a.toString(b);c=a.toString(c);return c>b?-1:b===c?0:1}):"Number"===f?H(c,function(a,b){return a-b}):"Boolean"===f?H(c,function(a,b){return a===b?0:b?-1:1}):"Date"===f?H(c,function(a,b){return b-a}):c.slice(0)})};for(var U in K)K[U]=new a.NativeFunction(K[U]);var V=function(){};V.prototype=K;l.functionHelper=
{fixSpatialReference:a.fixSpatialReference,parseArguments:function(a,b){for(var c=[],p=0;p<b.arguments.length;p++)c.push(B(a,b.arguments[p]));return c},standardFunction:C};l.extend=function(b){for(var c={mode:"sync",compiled:!0,functions:{},signatures:[],standardFunction:C},p=0;p<b.length;p++)b[p].registerFunctions(c);for(var d in c.functions)K[d]=new a.NativeFunction(c.functions[d]),V.prototype[d]=K[d];for(p=0;p<c.signatures.length;p++)e.addFunctionDeclaration(c.signatures[p],"f")};l.executeScript=
function(a,b,c){return a(b,c)};l.extractFieldLiterals=function(a,b){return void 0===b&&(b=!1),e.findFieldLiterals(a,b)};l.validateScript=function(a,b){return e.validateScript(a,b,"simple")};l.referencesMember=function(a,b){return e.referencesMember(a,b)};l.referencesFunction=function(a,b){return e.referencesFunction(a,b)};var X={error:function(a,b,c){throw Error(e.nodeErrorMessage(a,b,c));},functionDepthchecker:function(a,b){return function(){if(b.depthCounte++,64<b.depthCounter)throw Error("Exceeded maximum function depth");
var c=a.apply(this,arguments);return b.depthCounte--,c}},aCheck:function(b,c){if(a.isFunctionParameter(b))throw Error(e.nodeErrorMessage({type:c},"RUNTIME","FUNCTIONCONTEXTILLEGAL"));return b===a.voidOperation?null:b},Dictionary:c,Feature:q,dictionary:function(b){for(var p={},e=0;e<b.length;e+=2){if(a.isFunctionParameter(b[e+1]))throw Error("Illegal Argument");if(!1===a.isString(b[e]))throw Error("Illegal Argument");b[e+1]===a.voidOperation?p[b[e].toString()]=null:p[b[e].toString()]=b[e+1]}b=new c(p);
return b.immutable=!1,b},strCheck:function(b,c){if(!1===a.isString(b))throw Error("Illegal Argument");return b},unary:function(b,c){if(a.isBoolean(b)){if("!"===c)return!b;if("-"===c)return-1*a.toNumber(b);if("+"===c)return 1*a.toNumber(b);throw Error(e.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===c)return-1*a.toNumber(b);if("+"===c)return 1*a.toNumber(b);throw Error(e.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));},
logicalCheck:function(b){if(!1===a.isBoolean(b))throw Error(e.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));return b},logical:function(b,c,p){if(!a.isBoolean(b)||!a.isBoolean(c))throw Error(e.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));switch(p){case "||":return b||c;case "\x26\x26":return b&&c;default:throw Error(e.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));}},binary:function(b,c,p){switch(p){case "\x3d\x3d":return a.equalityTest(b,c);case "\x3d":return a.equalityTest(b,
c);case "!\x3d":return!a.equalityTest(b,c);case "\x3c":return a.greaterThanLessThan(b,c,p);case "\x3e":return a.greaterThanLessThan(b,c,p);case "\x3c\x3d":return a.greaterThanLessThan(b,c,p);case "\x3e\x3d":return a.greaterThanLessThan(b,c,p);case "+":return a.isString(b)||a.isString(c)?a.toString(b)+a.toString(c):a.toNumber(b)+a.toNumber(c);case "-":return a.toNumber(b)-a.toNumber(c);case "*":return a.toNumber(b)*a.toNumber(c);case "/":return a.toNumber(b)/a.toNumber(c);case "%":return a.toNumber(b)%
a.toNumber(c);default:throw Error(e.nodeErrorMessage({type:"BinaryExpression"},"RUNTIME","OPERATORNOTRECOGNISED"));}},assign:function(b,c,p){switch(c){case "\x3d":return b===a.voidOperation?null:b;case "/\x3d":return a.toNumber(p)/a.toNumber(b);case "*\x3d":return a.toNumber(p)*a.toNumber(b);case "-\x3d":return a.toNumber(p)-a.toNumber(b);case "+\x3d":return a.isString(p)||a.isString(b)?a.toString(p)+a.toString(b):a.toNumber(p)+a.toNumber(b);case "%\x3d":return a.toNumber(p)%a.toNumber(b);default:throw Error(e.nodeErrorMessage("AssignmentExpression",
"RUNTIME","OPERATORNOTRECOGNISED"));}},update:function(b,c,p,e){var d=a.toNumber(b[c]);return b[c]="++"===p?d+1:d-1,!1===e?d:"++"===p?d+1:d-1},memberupdate:function(b,p,e,d){var f;if(a.isArray(b)){if(!a.isNumber(p))throw Error("Invalid Parameter");if(0>p&&(p=b.length+p),0>p||p>=b.length)throw Error("Assignment outside of array bounds");f=a.toNumber(b[p]);b[p]="++"===e?f+1:f-1}else{if(b instanceof c){if(!1===a.isString(p))throw Error("Dictionary accessor must be a string");}else{if(!(b instanceof q))throw a.isImmutableArray(b)?
Error("Array is Immutable"):Error("Invalid Parameter");if(!1===a.isString(p))throw Error("Feature accessor must be a string");}if(!0!==b.hasField(p))throw Error("Invalid Parameter");f=a.toNumber(b.field(p));b.setField(p,"++"===e?f+1:f-1)}return!1===d?f:"++"===e?f+1:f-1},assignmember:function(b,p,e,d){if(a.isArray(b)){if(!a.isNumber(p))throw Error("Invalid Parameter");if(0>p&&(p=b.length+p),0>p||p>b.length)throw Error("Assignment outside of array bounds");if(p===b.length&&"\x3d"!==e)throw Error("Invalid Parameter");
b[p]=this.assign(d,e,b[p])}else{if(b instanceof c){if(!1===a.isString(p))throw Error("Dictionary accessor must be a string");}else{if(!(b instanceof q))throw a.isImmutableArray(b)?Error("Array is Immutable"):Error("Invalid Parameter");if(!1===a.isString(p))throw Error("Feature accessor must be a string");}if(!0===b.hasField(p))b.setField(p,this.assign(d,e,b.field(p)));else{if("\x3d"!==e)throw Error("Invalid Parameter");b.setField(p,this.assign(d,e,null))}}},member:function(b,p){if(null===b)throw Error(e.nodeErrorMessage("MemberExpression",
"RUNTIME","NOTFOUND"));if(b instanceof c||b instanceof q){if(a.isString(p))return b.field(p);throw Error(e.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(b instanceof z){if(a.isString(p))return P(b,p,"MemberExpression");throw Error(e.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(a.isArray(b)){if(a.isNumber(p)&&isFinite(p)&&Math.floor(p)===p){if(0>p&&(p=b.length+p),p>=b.length||0>p)throw Error(e.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return b[p]}throw Error(e.nodeErrorMessage("MemberExpression",
"RUNTIME","INVALIDTYPE"));}if(a.isString(b)){if(a.isNumber(p)&&isFinite(p)&&Math.floor(p)===p){if(0>p&&(p=b.length+p),p>=b.length||0>p)throw Error(e.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return b[p]}throw Error(e.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(a.isImmutableArray(b)&&a.isNumber(p)&&isFinite(p)&&Math.floor(p)===p){if(0>p&&(p=b.length()+p),p>=b.length()||0>p)throw Error(e.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return b.get(p)}throw Error(e.nodeErrorMessage("MemberExpression",
"RUNTIME","INVALIDTYPE"));},callfunc:function(b,c,p){return b instanceof a.NativeFunction?b.fn(p,c):b instanceof a.SizzleFunction?b.fn.apply(this,c):b.apply(this,c)}};l.compileScript=function(b,e){void 0===e&&(e=null);null===e&&(e={vars:{},customfunctions:{}});e={globalScope:E(e.vars,K,e.customfunctions),localScope:null,console:p,symbols:{symbolCounter:0}};b=B(e,b.body[0].body);""===b&&(b="lc.voidOperation;");e={lc:a,lang:X,postProcess:function(b){if(b instanceof a.ReturnResult&&(b=b.value),b instanceof
a.ImplicitResult&&(b=b.value),b===a.voidOperation&&(b=null),b===a.breakResult)throw Error("Cannot return BREAK");if(b===a.continueResult)throw Error("Cannot return CONTINUE");if(a.isFunctionParameter(b))throw Error("Cannot return FUNCTION");return b},prepare:function(a,b){b||(b=new f({wkid:102100}));var e=a.vars,d=a.customfunctions,A=new V;e||(e={});d||(d={});var g=new c({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});g.immutable=!1;A._SymbolsMap={textformatting:1,
infinity:1,pi:1};A.textformatting=g;A.infinity=Number.POSITIVE_INFINITY;A.pi=Math.PI;for(var E in d)A[E]=d[E],A._SymbolsMap[E]=1;for(E in e)A._SymbolsMap[E]=1,e[E]&&"esri.Graphic"===e[E].declaredClass?A[E]=new q(e[E]):A[E]=e[E];return{spatialReference:b,globalScope:A,localScope:null,console:a.console?a.console:p,symbols:{symbolCounter:0},depthCounter:1,applicationCache:void 0===a.applicationCache?null:a.applicationCache}}};return(new Function("context","spatialReference","var runtimeCtx\x3dthis.prepare(context, spatialReference);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+
b+"\n return lastStatement; } \n return this.postProcess(mainBody());")).bind(e)}})},"esri/layers/support/fieldUtils":function(){define(["require","exports","dojo/_base/lang"],function(m,l,h){function d(d,k,f){if(d)for(var a=0;a<d.length;a++){var e=d[a],c=h.getObject(e,!1,k);(c=c&&"function"!=typeof c&&b(c,f))&&h.setObject(e,c.name,k)}}function b(b,d){if(null!=d){b=b.toLowerCase();for(var f=0;f<d.length;f++){var a=d[f];if(a&&a.name.toLowerCase()===b)return a}}return null}Object.defineProperty(l,"__esModule",
{value:!0});l.extractFieldNames=function(b){if(!b||"string"!=typeof b)return[];b=b.match(/{[^}]*}/g);if(!b)return[];var d=/\{(\w+):.+\}/;return(b=b.filter(function(b){return!(0===b.indexOf("{relationships/")||0===b.indexOf("{expression/"))}).map(function(b){return b.replace(d,"{$1}")}))?b.map(function(b){return b.slice(1,-1)}):[]};l.fixRendererFields=function(b,k){if(null!=b&&null!=k){var f=0;for(b=Array.isArray(b)?b:[b];f<b.length;f++){var a=b[f];if(d(l.rendererFields,a,k),a.visualVariables)for(var e=
0,a=a.visualVariables;e<a.length;e++)d(l.visualVariableFields,a[e],k)}}};l.getField=b;l.rendererFields="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" ");l.visualVariableFields=["field","normalizationField"];l.numericTypes=["integer","small-integer","single","double"];l.isNumericField=function(b,d){return b?-1<l.numericTypes.indexOf(b.type)&&b.name!==d.objectIdField:
!1};l.isStringField=function(b,d){return b?"string"===b.type&&b.name!==d.objectIdField:!1};l.isDateField=function(b){return b?"date"===b.type:!1}})},"esri/symbols/support/typeUtils":function(){define("require exports ../../core/accessorSupport/ensureType ../Symbol ../PictureFillSymbol ../PictureMarkerSymbol ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../TextSymbol ../WebStyleSymbol ../LabelSymbol3D ../LineSymbol3D ../MeshSymbol3D ../PointSymbol3D ../PolygonSymbol3D".split(" "),function(m,
l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){Object.defineProperty(l,"__esModule",{value:!0});l.types={base:d,key:"type",typeMap:{"simple-fill":k,"picture-fill":b,"picture-marker":g,"simple-line":f,"simple-marker":a,text:e,"label-3d":q,"line-3d":t,"mesh-3d":r,"point-3d":u,"polygon-3d":v,"web-style":c}};l.types3D={base:d,key:"type",typeMap:{"label-3d":q,"line-3d":t,"mesh-3d":r,"point-3d":u,"polygon-3d":v,"web-style":c}};l.ensureType=h.ensureOneOfType(l.types)})},"esri/symbols/Symbol":function(){define(["../core/lang",
"../core/kebabDictionary","../core/JSONSupport","../Color"],function(m,l,h,d){var b=l({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d"}),g=0;return h.createSubclass({declaredClass:"esri.symbols.Symbol",constructor:function(){this.id="sym"+g++},properties:{type:{type:String,
value:null,json:{read:b.fromJSON,write:{ignoreOrigin:!0,writer:function(d,f){f.type=b.toJSON(this.type)}}}},color:{type:d,value:new d([0,0,0,1]),json:{read:function(b){return b&&m.isDefined(b[0])?[b[0],b[1],b[2],b[3]/255]:b},write:!0}}}})})},"esri/symbols/PictureFillSymbol":function(){define("../core/declare dojo/_base/lang ../core/lang ../core/screenUtils ./FillSymbol ./support/urlUtils".split(" "),function(m,l,h,d,b,g){var k={xscale:1,yscale:1,xoffset:0,yoffset:0,width:12,height:12},f=m(b,{declaredClass:"esri.symbols.PictureFillSymbol",
properties:{type:"picture-fill",url:g.urlPropertyDefinition,xscale:{value:1,json:{write:!0}},yscale:{value:1,json:{write:!0}},width:{value:12,cast:d.toPt,json:{write:!0}},height:{value:12,cast:d.toPt,json:{write:!0}},xoffset:{value:0,cast:d.toPt,json:{write:!0}},yoffset:{value:0,cast:d.toPt,json:{write:!0}},source:g.sourcePropertyDefinition},getDefaults:function(){return l.mixin(this.inherited(arguments),k)},normalizeCtorArgs:function(a,b,c,f){if(a&&"string"!=typeof a&&null==a.imageData)return a;
var e={};return a&&(e.url=a),b&&(e.outline=b),null!=c&&(e.width=d.toPt(c)),null!=f&&(e.height=d.toPt(f)),e},clone:function(){var a=new f({color:h.clone(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return a._set("source",h.clone(this.source)),a}});return f.defaultProps=k,f})},"esri/core/screenUtils":function(){define(["require","exports"],function(m,l){function h(b){return b?
72*b/l.DPI:0}Object.defineProperty(l,"__esModule",{value:!0});var d=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;l.DPI=96;l.pt2px=function(b){return b?b/72*l.DPI:0};l.px2pt=h;l.toPt=function(b){if("string"==typeof b){if(d.test(b)){var g=b.match(d),k=Number(g[1]),g=g[3]&&g[3].toLowerCase();b="-"===b.charAt(0);k="px"===g?h(k):k;return b?-k:k}return console.warn("screenUtils.toPt: input not recognized!"),null}return b}})},"esri/symbols/FillSymbol":function(){define(["dojo/_base/lang","./Symbol","./SimpleLineSymbol"],
function(m,l,h){return l.createSubclass({declaredClass:"esri.symbols.FillSymbol",properties:{outline:{type:h,json:{write:!0}},type:null},read:function b(g,k){return this.getInherited(b,arguments).call(this,m.mixin({outline:null},g),k)}})})},"esri/symbols/SimpleLineSymbol":function(){define(["../core/declare","dojo/_base/lang","../core/lang","../core/screenUtils","./LineSymbol"],function(m,l,h,d,b){var g={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dash-dot",STYLE_DASHDOTDOT:"long-dash-dot-dot",
STYLE_NULL:"none",STYLE_SHORTDASH:"short-dash",STYLE_SHORTDOT:"short-dot",STYLE_SHORTDASHDOT:"short-dash-dot",STYLE_SHORTDASHDOTDOT:"short-dash-dot-dot",STYLE_LONGDASH:"long-dash",STYLE_LONGDASHDOT:"long-dash-dot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},k={color:[0,0,0,1],style:g.STYLE_SOLID,width:.75,cap:g.CAP_BUTT,join:g.JOIN_MITER,miterLimit:7.5},f=m(b,{declaredClass:"esri.symbols.SimpleLineSymbol",properties:{type:"simple-line",
style:{value:g.STYLE_SOLID,json:{read:function(a,b){return h.valueOf(this._jsonStyles,a)||void 0},write:function(a,b){b.style=this._jsonStyles[a]}}},cap:{value:g.CAP_BUTT,json:{read:!1,write:!1}},join:{value:g.JOIN_MITER,json:{read:!1,write:!1}},miterLimit:{value:7.5,cast:d.toPt,json:{read:!1,write:!1}}},_jsonStyles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot","dash-dot":"esriSLSDashDot","long-dash-dot-dot":"esriSLSDashDotDot",none:"esriSLSNull","inside-frame":"esriSLSInsideFrame","short-dash":"esriSLSShortDash",
"short-dot":"esriSLSShortDot","short-dash-dot":"esriSLSShortDashDot","short-dash-dot-dot":"esriSLSShortDashDotDot","long-dash":"esriSLSLongDash","long-dash-dot":"esriSLSLongDashDot"},getDefaults:function(){return l.mixin(this.inherited(arguments),k)},normalizeCtorArgs:function(a,b,c,f,g,k){if(a&&"string"!=typeof a)return a;var e={};return null!=a&&(e.style=a),null!=b&&(e.color=b),null!=c&&(e.width=d.toPt(c)),null!=f&&(e.cap=f),null!=g&&(e.join=g),null!=k&&(e.miterLimit=d.toPt(k)),e},clone:function(){return new f({color:h.clone(this.color),
style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit})}});return l.mixin(f,g),f.defaultProps=k,f})},"esri/symbols/LineSymbol":function(){define(["../core/declare","../core/screenUtils","./Symbol"],function(m,l,h){return m(h,{declaredClass:"esri.symbols.LineSymbol",properties:{color:{},type:"simple-line",width:{value:.75,cast:l.toPt,json:{write:!0}}}})})},"esri/symbols/support/urlUtils":function(){define(["require","exports","../../core/urlUtils"],function(m,l,h){function d(d,
a,e){return a.imageData?h.makeData({mediaType:a.contentType||"image/png",isBase64:!0,data:a.imageData}):b(a.url,e)}function b(b,a){return!a||"service"!==a.origin&&"portal-item"!==a.origin||!a.layer||"feature"!==a.layer.type&&"stream"!==a.layer.type||h.isAbsolute(b)||!a.layer.parsedUrl?h.read(b,a):h.join(a.layer.parsedUrl.path,"images",b)}function g(b,a,e,c){h.isDataProtocol(b)?(b=h.dataComponents(b),a.contentType=b.mediaType,a.imageData=b.data,e&&e.imageData===a.imageData&&e.url&&(a.url=k(e.url,c))):
a.url=k(b,c)}function k(b,a){return h.write(b,a)}Object.defineProperty(l,"__esModule",{value:!0});l.readImageDataOrUrl=d;l.read=b;l.writeImageDataAndUrl=g;l.write=k;l.urlPropertyDefinition={json:{read:{source:["imageData","url"],reader:d},write:{writer:function(b,a,e,c){g(b,a,this.source,c)}}}};l.sourcePropertyDefinition={readOnly:!0,json:{read:{source:["imageData","url"],reader:function(d,a,e){d={};return a.imageData&&(d.imageData=a.imageData),a.contentType&&(d.contentType=a.contentType),a.url&&
(d.url=b(a.url,e)),d}}}}})},"esri/symbols/PictureMarkerSymbol":function(){define("../core/declare dojo/_base/lang ../core/lang ../core/screenUtils ./MarkerSymbol ./support/urlUtils".split(" "),function(m,l,h,d,b,g){var k={width:12,height:12,angle:0,xoffset:0,yoffset:0},f=m(b,{declaredClass:"esri.symbols.PictureMarkerSymbol",properties:{color:{json:{write:!1}},type:"picture-marker",url:g.urlPropertyDefinition,source:g.sourcePropertyDefinition,height:{json:{read:{source:["height","size"],reader:function(a,
b){return b.size||a}},write:!0},cast:d.toPt},width:{json:{read:{source:["width","size"],reader:function(a,b){return b.size||a}},write:!0},cast:d.toPt},size:{json:{write:!1}}},getDefaults:function(){return l.mixin(this.inherited(arguments),k)},normalizeCtorArgs:function(a,b,c){if(a&&"string"!=typeof a&&null==a.imageData)return a;var e={};return a&&(e.url=a),null!=b&&(e.width=d.toPt(b)),null!=c&&(e.height=d.toPt(c)),e},clone:function(){var a=new f({angle:this.angle,height:this.height,url:this.url,width:this.width,
xoffset:this.xoffset,yoffset:this.yoffset});return a._set("source",h.clone(this.source)),a}});return f.defaultProps=k,f})},"esri/symbols/MarkerSymbol":function(){define(["../core/declare","../core/screenUtils","./Symbol"],function(m,l,h){return m(h,{declaredClass:"esri.symbols.MarkerSymbol",properties:{angle:{value:0,json:{read:function(d){return d&&-1*d},write:function(d,b){b.angle=d&&-1*d}}},type:{},xoffset:{value:0,cast:l.toPt,json:{write:!0}},yoffset:{value:0,cast:l.toPt,json:{write:!0}},size:{value:9,
cast:function(d){return"auto"===d?d:l.toPt(d)},json:{write:!0}}}})})},"esri/symbols/SimpleFillSymbol":function(){define(["../core/declare","dojo/_base/lang","../core/lang","./FillSymbol","./SimpleLineSymbol"],function(m,l,h,d,b){var g={style:"solid",outline:new b,color:[0,0,0,.25]},k=m(d,{declaredClass:"esri.symbols.SimpleFillSymbol",properties:{color:{},type:"simple-fill",style:{value:"solid",type:String,json:{read:function(b){return h.valueOf(this._styles,b)||void 0},write:function(b,a){a.style=
this._styles[b]}}}},_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical","forward-diagonal":"esriSFSForwardDiagonal","backward-diagonal":"esriSFSBackwardDiagonal",cross:"esriSFSCross","diagonal-cross":"esriSFSDiagonalCross"},getDefaults:function(){return l.mixin(this.inherited(arguments),g)},normalizeCtorArgs:function(b,a,e){if(b&&"string"!=typeof b)return b;var c={};return b&&(c.style=b),a&&(c.outline=a),e&&(c.color=e),c},clone:function(){return new k({color:h.clone(this.color),
outline:this.outline&&this.outline.clone(),style:this.style})}});return l.mixin(k,{STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forward-diagonal",STYLE_BACKWARD_DIAGONAL:"backward-diagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonal-cross"}),k.defaultProps=g,k})},"esri/symbols/SimpleMarkerSymbol":function(){define("../core/declare dojo/_base/lang ../core/lang ../core/screenUtils ./MarkerSymbol ./SimpleLineSymbol".split(" "),
function(m,l,h,d,b,g){var k={style:"circle",color:[255,255,255,.25],outline:new g,size:12,angle:0,xoffset:0,yoffset:0},f=m(b,{declaredClass:"esri.symbols.SimpleMarkerSymbol",properties:{color:{json:{write:function(a,b){a&&"x"!==this.style&&"cross"!==this.style&&(b.color=a.toJSON())}}},type:"simple-marker",size:{value:12},style:{type:String,value:"circle",json:{read:function(a){return h.valueOf(this._styles,a)},write:function(a,b){b.style=this._styles[a]}}},path:{type:String,value:null,set:function(a){this.style=
"path";this._set("path",a)},json:{write:!0}},outline:{type:g,json:{write:!0}}},_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},getDefaults:function(){return l.mixin(this.inherited(arguments),k)},normalizeCtorArgs:function(a,b,c,f){if(a&&"string"!=typeof a)return a;var e={};return a&&(e.style=a),null!=b&&(e.size=d.toPt(b)),c&&(e.outline=c),f&&(e.color=f),e},clone:function(){return new f({angle:this.angle,color:h.clone(this.color),
outline:this.outline&&this.outline.clone(),size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})},read:function e(b,d){return this.getInherited(e,arguments).call(this,l.mixin({outline:null},b),d)}});return l.mixin(f,{STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"}),f.defaultProps=k,f})},"esri/symbols/TextSymbol":function(){define("../core/declare dojo/_base/lang ../core/lang ../core/screenUtils ../Color ./Symbol ./Font".split(" "),
function(m,l,h,d,b,g,k){var f={text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:{},angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},a=m(g,{declaredClass:"esri.symbols.TextSymbol",properties:{backgroundColor:{type:b,json:{write:!0}},borderLineColor:{type:b,json:{write:!0}},borderLineSize:{type:Number,json:{write:!0}},color:{},font:{type:k,json:{write:!0}},horizontalAlignment:{value:"center",json:{write:!0}},kerning:{value:!0,json:{write:!0}},haloColor:{type:b,json:{write:!0}},haloSize:{type:Number,
cast:d.toPt,json:{write:!0}},rightToLeft:{json:{write:!0}},rotated:{value:!1,json:{write:!0}},text:{type:String,json:{write:!0}},type:"text",verticalAlignment:{type:String,json:{write:!0}},xoffset:{value:0,type:Number,cast:d.toPt,json:{write:!0}},yoffset:{value:0,type:Number,cast:d.toPt,json:{write:!0}},angle:{type:Number,value:0,json:{read:function(a){return a&&-1*a},write:function(a,b){b.angle=a&&-1*a}}},width:{json:{write:!0}}},getDefaults:function(){return l.mixin(this.inherited(arguments),f)},
normalizeCtorArgs:function(a,b,d){if(a&&"string"!=typeof a)return a;var c={};return a&&(c.text=a),b&&(c.font=b),d&&(c.color=d),c},clone:function(){return new a({angle:this.angle,backgroundColor:h.clone(this.backgroundColor),borderLineColor:h.clone(this.borderLineColor),borderLineSize:this.borderLineSize,color:h.clone(this.color),font:this.font&&this.font.clone(),haloColor:h.clone(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,rightToLeft:this.rightToLeft,
rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}});return l.mixin(a,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"}),a.defaultProps=f,a})},"esri/symbols/Font":function(){define(["dojo/_base/lang","../core/JSONSupport","../core/lang","../core/screenUtils"],function(m,l,h,d){var b=
{style:"normal",weight:"normal",size:9,family:"serif",decoration:"none"},g=l.createSubclass({declaredClass:"esri.symbols.Font",properties:{decoration:{},family:{},size:{cast:d.toPt},style:{},weight:{}},getDefaults:function(){return b},normalizeCtorArgs:function(b,f,a,e){if(b&&"string"!=typeof b)return b;var c={};return null!=b&&(c.size=d.toPt(b)),null!=f&&(c.style=f),null!=a&&(c.weight=a),e&&(c.family=e),c},toJSON:function(){return h.fixJson({size:this.size,style:this.style,decoration:this.decoration,
weight:this.weight,family:this.family})},clone:function(){return new g({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}});return g.defaultProps=b,m.mixin(g,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"}),g})},"esri/symbols/WebStyleSymbol":function(){define("require exports ../core/tsSupport/extendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/urlUtils ../core/Logger ../core/requireUtils ./Symbol ../portal/Portal ./support/Thumbnail".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){var q=k.getLogger("esri.symbols.WebStyleSymbol");return function(a){function k(b){b=a.call(this,b)||this;return b.styleName=null,b.portal=null,b.styleUrl=null,b.thumbnail=null,b.name=null,b.type="web-style",b}return h(k,a),t=k,k.prototype._readStyleUrl=function(a,b,c){return g.read(a,c)},k.prototype._writeStyleUrl=function(a,b,c,e){b.styleUrl=g.write(a,e);g.isAbsolute(b.styleUrl)&&(b.styleUrl=g.normalize(b.styleUrl))},k.prototype._writeType=function(a,b,c,e){b.type=
"styleSymbolReference"},k.prototype.read=function(a,b){return this.portal=b?b.portal:void 0,this.inherited(arguments,[a,b]),this},k.prototype.clone=function(){return new t({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})},k.prototype.fetchSymbol=function(){var a=this;return f.when(m,"./support/styleUtils").then(function(b){b=b.resolveWebStyleSymbol(a,{portal:a.portal});return b.otherwise(function(a){q.error("#fetchSymbol()","Failed to create symbol from style",
a)}),b})},d([b.property({json:{write:!1}})],k.prototype,"color",void 0),d([b.property({type:String,json:{write:!0}})],k.prototype,"styleName",void 0),d([b.property({type:e,json:{write:!1}})],k.prototype,"portal",void 0),d([b.property({type:String,json:{write:!0}})],k.prototype,"styleUrl",void 0),d([b.reader("styleUrl")],k.prototype,"_readStyleUrl",null),d([b.writer("styleUrl")],k.prototype,"_writeStyleUrl",null),d([b.property({type:c["default"],json:{read:!1}})],k.prototype,"thumbnail",void 0),d([b.property({type:String,
json:{write:!0}})],k.prototype,"name",void 0),d([b.property({type:String,readOnly:!0,json:{read:!1}})],k.prototype,"type",void 0),d([b.writer("type")],k.prototype,"_writeType",null),k=t=d([b.subclass("esri.symbols.WebStyleSymbol")],k);var t}(b.declared(a))})},"esri/symbols/support/Thumbnail":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,
"__esModule",{value:!0});m=function(g){function f(){return null!==g&&g.apply(this,arguments)||this}return h(f,g),a=f,f.prototype.clone=function(){return new a({url:this.url})},d([b.property({type:String})],f.prototype,"url",void 0),f=a=d([b.subclass("esri.symbols.support.Thumbnail")],f);var a}(b.declared(g));l.Thumbnail=m;l["default"]=m})},"esri/symbols/LabelSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/Collection ./Symbol3D ./TextSymbol3DLayer ./support/Symbol3DVerticalOffset ./callouts/calloutUtils ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){var q=g.ofType({base:null,key:"type",typeMap:{text:f}});return function(f){function g(a){a=f.call(this)||this;return a.verticalOffset=null,a.callout=null,a.symbolLayers=new q,a.type="label-3d",a}return h(g,f),k=g,g.prototype.supportsCallout=function(){return!0},g.prototype.hasVisibleCallout=function(){return e.hasVisibleCallout(this)},g.prototype.hasVisibleVerticalOffset=function(){return e.hasVisibleVerticalOffset(this)},g.prototype.clone=function(){return new k({styleOrigin:b.clone(this.styleOrigin),
symbolLayers:b.clone(this.symbolLayers),thumbnail:b.clone(this.thumbnail),callout:b.clone(this.callout),verticalOffset:b.clone(this.verticalOffset)})},d([c.property({type:a["default"],json:{write:!0}})],g.prototype,"verticalOffset",void 0),d([c.property(e.calloutProperty)],g.prototype,"callout",void 0),d([c.property({type:q})],g.prototype,"symbolLayers",void 0),d([c.property()],g.prototype,"type",void 0),g=k=d([c.subclass("esri.symbols.LabelSymbol3D")],g);var k}(c.declared(k))})},"esri/symbols/Symbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/Logger ../core/collectionUtils ../core/Warning ../core/urlUtils ../core/accessorSupport/metadata ./Symbol ./Symbol3DLayer ./IconSymbol3DLayer ./ObjectSymbol3DLayer ./LineSymbol3DLayer ./PathSymbol3DLayer ./FillSymbol3DLayer ./ExtrudeSymbol3DLayer ./TextSymbol3DLayer ./support/Thumbnail ./support/StyleOrigin ../portal/Portal ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B){var F={icon:t,object:r,line:u,path:v,fill:x,extrude:y,text:n},G=b.ofType({base:q,key:"type",typeMap:F}),N=g.getLogger("esri.symbols.Symbol3D");return function(b){function c(a){a=b.call(this)||this;a.styleOrigin=null;a.thumbnail=null;a.type=null;var c=e.getMetadata(a).properties.symbolLayers.type;return a._set("symbolLayers",new c),a}return h(c,b),Object.defineProperty(c.prototype,"color",{get:function(){return null},set:function(a){N.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")},
enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"symbolLayers",{set:function(a){k.referenceSetter(a,this._get("symbolLayers"))},enumerable:!0,configurable:!0}),c.prototype.readSymbolLayers=function(a,b,c){b=[];for(var e=0;e<a.length;e++){var d=a[e],g=q.typeJSONDictionary.read(d.type),n=F[g];n?(d=new n,d.read(a[e],c),b.push(d)):(N.warn("Unknown symbol layer type: "+g),c&&c.messages&&c.messages.push(new f("symbol-layer:unsupported","Symbol layers of type '"+(g||"unknown")+"' are not supported",
{definition:d,context:c})))}return b},c.prototype.readStyleOrigin=function(b,c,e){return b.styleUrl&&b.name?(c=a.read(b.styleUrl,e),new z({styleUrl:c,name:b.name})):b.styleName&&b.name?new z({portal:e&&e.portal||C.getDefault(),styleName:b.styleName,name:b.name}):void(e&&e.messages&&e.messages.push(new f("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:e,definition:b})))},c.prototype.writeStyleOrigin=function(b,c,e,d){b.styleUrl&&
b.name?(e=a.write(b.styleUrl,d),a.isAbsolute(e)&&(e=a.normalize(e)),c.styleOrigin={styleUrl:e,name:b.name}):b.styleName&&b.name&&(b.portal&&d&&d.portal&&!a.hasSamePortal(b.portal.restUrl,d.portal.restUrl)?d&&d.messages&&d.messages.push(new f("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):c.styleOrigin={styleName:b.styleName,name:b.name})},c.prototype.normalizeCtorArgs=function(a){return a instanceof
q||a&&F[a.type]?{symbolLayers:[a]}:Array.isArray(a)?{symbolLayers:a}:a},d([B.property({json:{read:!1,write:!1}})],c.prototype,"color",null),d([B.property({type:G,nonNullable:!0,json:{write:!0}}),B.cast(k.castForReferenceSetter)],c.prototype,"symbolLayers",null),d([B.reader("symbolLayers")],c.prototype,"readSymbolLayers",null),d([B.property({type:z})],c.prototype,"styleOrigin",void 0),d([B.reader("styleOrigin")],c.prototype,"readStyleOrigin",null),d([B.writer("styleOrigin",{"styleOrigin.styleUrl":{type:String},
"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],c.prototype,"writeStyleOrigin",null),d([B.property({type:w["default"],json:{read:!1}})],c.prototype,"thumbnail",void 0),d([B.property({type:String,readOnly:!0,json:{read:!1}})],c.prototype,"type",void 0),c=d([B.subclass("esri.symbols.Symbol3D")],c)}(B.declared(c))})},"esri/symbols/Symbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/kebabDictionary ./support/Symbol3DMaterial ./support/ElevationInfo ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a){var e=g({Icon:"icon",Object:"object",Line:"line",Path:"path",Fill:"fill",Extrude:"extrude",Text:"text"});m=function(b){function c(a){a=b.call(this)||this;return a.enabled=!0,a.material=null,a.type=null,a}return h(c,b),c.prototype.writeEnabled=function(a,b,c){a||(b[c]=a)},d([a.property({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],c.prototype,"enabled",void 0),d([a.writer("enabled")],c.prototype,"writeEnabled",null),d([a.property({type:f,json:{read:!1,
write:!1}})],c.prototype,"elevationInfo",void 0),d([a.property({type:k["default"],json:{write:!0}})],c.prototype,"material",void 0),d([a.property({type:String,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:e.write}}})],c.prototype,"type",void 0),c=d([a.subclass("esri.symbols.Symbol3DLayer")],c)}(a.declared(b));(m||(m={})).typeJSONDictionary=e;return m})},"esri/symbols/support/Symbol3DMaterial":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ./materialUtils ../../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}return h(a,b),e=a,a.prototype.clone=function(){return new e({color:this.color?this.color.clone():null})},d([k.property(g.colorAndTransparencyProperty)],a.prototype,"color",void 0),a=e=d([k.subclass("esri.symbols.support.Symbol3DMaterial")],a);var e}(k.declared(b));l.Symbol3DMaterial=m;l["default"]=m})},"esri/symbols/support/materialUtils":function(){define(["require",
"exports","../../Color","../../core/screenUtils"],function(m,l,h,d){function b(a){return Math.max(0,Math.min(Math.round(100*(1-a)),100))}function g(a){return Math.max(0,Math.min(1-a/100,1))}function k(a,b){a=null!=b.transparency?g(b.transparency):1;return(b=b.color)&&Array.isArray(b)?new h([b[0]||0,b[1]||0,b[2]||0,a]):void 0}function f(a,e){e.color=a.toJSON().slice(0,3);a=b(a.a);0!==a&&(e.transparency=a)}Object.defineProperty(l,"__esModule",{value:!0});l.opacityToTransparency=b;l.transparencyToOpacity=
g;l.readColorAndTransparency=k;l.writeColorAndTransparency=f;l.colorAndTransparencyProperty={type:h,json:{type:[Number],read:{source:["color","transparency"],reader:k},write:{target:{color:{type:[Number]},transparency:{type:Number}},writer:f}}};l.screenSizeProperty={type:Number,cast:d.toPt,json:{write:!0}}})},"esri/symbols/support/ElevationInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport ../../core/kebabDictionary ../../support/arcadeUtils".split(" "),
function(m,l,h,d,b,g,k,f){var a=k({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),e=k({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"}),c=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return h(c,a),e=c,Object.defineProperty(c.prototype,"requiredFields",{get:function(){return f.extractFieldNames(this.expression)},enumerable:!0,configurable:!0}),
c.prototype.clone=function(){return new e({expression:this.expression})},d([b.property({type:String,json:{write:!0}})],c.prototype,"expression",void 0),d([b.property({readOnly:!0,dependsOn:["expression"]})],c.prototype,"requiredFields",null),c=e=d([b.subclass("esri.layers.support.FeatureExpressionInfo")],c);var e}(b.declared(g));return function(f){function g(){return null!==f&&f.apply(this,arguments)||this}return h(g,f),k=g,g.prototype.readFeatureExpressionInfo=function(a,b){return null!=a?a:b.featureExpression&&
0===b.featureExpression.value?{expression:"0"}:void 0},g.prototype.writeFeatureExpressionInfo=function(a,b,c,e){b[c]=a.write(null,e);"0"===a.expression&&(b.featureExpression={value:0})},Object.defineProperty(g.prototype,"mode",{get:function(){var a=this._get("mode");return a?a:null!=this.offset||this.featureExpressionInfo?"relative-to-ground":"on-the-ground"},set:function(a){this._set("mode",a)},enumerable:!0,configurable:!0}),g.prototype.write=function(a,b){return this.offset||this.mode||this.featureExpressionInfo||
this.unit?this.inherited(arguments):null},g.prototype.clone=function(){return new k({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})},d([b.property({type:c,json:{write:!0}})],g.prototype,"featureExpressionInfo",void 0),d([b.reader("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],g.prototype,"readFeatureExpressionInfo",null),d([b.writer("featureExpressionInfo")],g.prototype,"writeFeatureExpressionInfo",
null),d([b.property({type:String,dependsOn:["offset","featureExpressionInfo"],json:{read:a.read,write:{writer:a.write,isRequired:!0}}})],g.prototype,"mode",null),d([b.property({type:Number,json:{write:!0}})],g.prototype,"offset",void 0),d([b.property({type:String,json:{read:e.read,write:e.write}})],g.prototype,"unit",void 0),g=k=d([b.subclass("esri.layers.support.ElevationInfo")],g);var k}(b.declared(g))})},"esri/symbols/IconSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/kebabDictionary ../core/urlUtils ../core/accessorSupport/decorators ./Symbol3DLayer ./support/Symbol3DOutline ./support/Symbol3DResource ./support/materialUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){var q=b({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right"},{ignoreUnknown:!0}),t=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h(b,a),c=b,b.prototype.readHref=function(a,b,c){return a?g.read(a,c):b.dataURI},b.prototype.writeHref=function(a,b,c,e){a&&(g.isDataProtocol(a)?b.dataURI=a:(b.href=g.write(a,e),g.isAbsolute(b.href)&&
(b.href=g.normalize(b.href))))},b.prototype.clone=function(){return new c({href:this.href,primitive:this.primitive})},d([k.property({json:{write:!0,read:{source:["href","dataURI"]}}})],b.prototype,"href",void 0),d([k.reader("href")],b.prototype,"readHref",null),d([k.writer("href")],b.prototype,"writeHref",null),b=c=d([k.subclass("esri.symbols.support.IconSymbol3DLayerResource")],b);var c}(k.declared(e["default"]));return function(b){function e(a){a=b.call(this)||this;return a.material=null,a.resource=
null,a.type="icon",a.size=12,a.anchor=void 0,a.outline=void 0,a}return h(e,b),f=e,e.prototype.clone=function(){return new f({anchor:this.anchor,enabled:this.enabled,elevationInfo:this.elevationInfo&&this.elevationInfo.clone(),material:this.material&&this.material.clone(),outline:this.outline&&this.outline.clone(),resource:this.resource&&this.resource.clone(),size:this.size})},d([k.property()],e.prototype,"material",void 0),d([k.property({type:t,json:{write:!0}})],e.prototype,"resource",void 0),d([k.property()],
e.prototype,"type",void 0),d([k.property(c.screenSizeProperty)],e.prototype,"size",void 0),d([k.property({type:String,json:{read:q.read,write:q.write}})],e.prototype,"anchor",void 0),d([k.property({type:a["default"],json:{write:!0}})],e.prototype,"outline",void 0),e=f=d([k.subclass("esri.symbols.IconSymbol3DLayer")],e);var f}(k.declared(f))})},"esri/symbols/support/Symbol3DOutline":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../Color ./materialUtils ../../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});m=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.color=new g([0,0,0,1]),b.size=1,b}return h(b,a),c=b,b.prototype.clone=function(){return new c({color:this.color?this.color.clone():null,size:this.size})},d([f.property(k.colorAndTransparencyProperty)],b.prototype,"color",void 0),d([f.property(k.screenSizeProperty)],b.prototype,"size",void 0),b=c=d([f.subclass("esri.symbols.support.Symbol3DOutline")],
b);var c}(f.declared(b));l.Symbol3DOutline=m;l["default"]=m})},"esri/symbols/support/Symbol3DResource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/urlUtils ../../core/JSONSupport ../../core/kebabDictionary ../../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});var a=k({invertedCone:"inverted-cone"});m=function(e){function c(){return null!==e&&e.apply(this,
arguments)||this}return h(c,e),g=c,c.prototype.readHref=function(a,c,e){return b.read(a,e)},c.prototype.writeHref=function(a,c,e,d){a&&(c.href=b.write(a,d),b.isAbsolute(c.href)&&(c.href=b.normalize(c.href)))},c.prototype.readPrimitive=function(b){return a.fromJSON(b)},c.prototype.writePrimitive=function(b,c){c.primitive=a.toJSON(b)},c.prototype.clone=function(){return new g({href:this.href,primitive:this.primitive})},d([f.property({type:String,json:{write:!0}})],c.prototype,"href",void 0),d([f.reader("href")],
c.prototype,"readHref",null),d([f.writer("href")],c.prototype,"writeHref",null),d([f.property({type:String,json:{write:!0}})],c.prototype,"primitive",void 0),d([f.reader("primitive")],c.prototype,"readPrimitive",null),d([f.writer("primitive")],c.prototype,"writePrimitive",null),c=g=d([f.subclass("esri.symbols.support.Symbol3DResource")],c);var g}(f.declared(g));l.Symbol3DResource=m;l["default"]=m})},"esri/symbols/ObjectSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/kebabDictionary ./Symbol3DLayer ./support/Symbol3DMaterial ./support/Symbol3DResource ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a){var e=b({center:"center",top:"top",bottom:"bottom",origin:"origin"},{ignoreUnknown:!0});return function(b){function c(a){a=b.call(this)||this;return a.material=null,a.resource=null,a.type="object",a.width=void 0,a.height=void 0,a.depth=void 0,a.anchor=void 0,a.heading=void 0,a.tilt=void 0,a.roll=void 0,a}return h(c,b),g=c,c.prototype.clone=function(){return new g({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,depth:this.depth,enabled:this.enabled,
elevationInfo:this.elevationInfo&&this.elevationInfo.clone(),height:this.height,material:this.material&&this.material.clone(),resource:this.resource&&this.resource.clone(),width:this.width})},Object.defineProperty(c.prototype,"isPrimitive",{get:function(){return!this.resource||"string"!=typeof this.resource.href},enumerable:!0,configurable:!0}),d([a.property({type:k["default"]})],c.prototype,"material",void 0),d([a.property({type:f["default"],json:{write:!0}})],c.prototype,"resource",void 0),d([a.property()],
c.prototype,"type",void 0),d([a.property({type:Number,json:{write:!0}})],c.prototype,"width",void 0),d([a.property({type:Number,json:{write:!0}})],c.prototype,"height",void 0),d([a.property({type:Number,json:{write:!0}})],c.prototype,"depth",void 0),d([a.property({type:String,json:{read:e.read,write:e.write}})],c.prototype,"anchor",void 0),d([a.property({type:Number,json:{write:!0}})],c.prototype,"heading",void 0),d([a.property({type:Number,json:{write:!0}})],c.prototype,"tilt",void 0),d([a.property({type:Number,
json:{write:!0}})],c.prototype,"roll",void 0),d([a.property({readOnly:!0,dependsOn:["resource","resource.href"]})],c.prototype,"isPrimitive",null),c=g=d([a.subclass("esri.symbols.ObjectSymbol3DLayer")],c);var g}(a.declared(g))})},"esri/symbols/LineSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Symbol3DLayer ./support/materialUtils ../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g,k){return function(b){function a(a){a=
b.call(this)||this;return a.material=null,a.type="line",a.size=1,a}return h(a,b),e=a,a.prototype.clone=function(){return new e({enabled:this.enabled,elevationInfo:this.elevationInfo&&this.elevationInfo.clone(),material:this.material&&this.material.clone(),size:this.size})},d([k.property()],a.prototype,"material",void 0),d([k.property()],a.prototype,"type",void 0),d([k.property(g.screenSizeProperty)],a.prototype,"size",void 0),a=e=d([k.subclass("esri.symbols.LineSymbol3DLayer")],a);var e}(k.declared(b))})},
"esri/symbols/PathSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Symbol3DLayer ../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g){return function(b){function f(a){a=b.call(this)||this;return a.material=null,a.type="path",a.size=void 0,a}return h(f,b),a=f,f.prototype.readSize=function(a,b){return a||b.width||0},f.prototype.clone=function(){return new a({enabled:this.enabled,elevationInfo:this.elevationInfo&&
this.elevationInfo.clone(),material:this.material&&this.material.clone(),size:this.size})},d([g.property()],f.prototype,"material",void 0),d([g.property()],f.prototype,"type",void 0),d([g.property({type:Number,json:{write:!0}})],f.prototype,"size",void 0),d([g.reader("size",["size","width"])],f.prototype,"readSize",null),f=a=d([g.subclass("esri.symbols.PathSymbol3DLayer")],f);var a}(g.declared(b))})},"esri/symbols/FillSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Symbol3DLayer ./support/Symbol3DOutline ./support/Symbol3DFillMaterial ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f){return function(a){function b(b){b=a.call(this)||this;return b.type="fill",b.material=null,b.outline=null,b}return h(b,a),c=b,b.prototype.clone=function(){return new c({enabled:this.enabled,elevationInfo:this.elevationInfo&&this.elevationInfo.clone(),material:this.material&&this.material.clone(),outline:this.outline&&this.outline.clone()})},d([f.property()],b.prototype,"type",void 0),d([f.property({type:k["default"]})],b.prototype,"material",void 0),d([f.property({type:g["default"],
json:{write:!0}})],b.prototype,"outline",void 0),b=c=d([f.subclass("esri.symbols.FillSymbol3DLayer")],b);var c}(f.declared(b))})},"esri/symbols/support/Symbol3DFillMaterial":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ./Symbol3DMaterial ../../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function f(){return null!==b&&b.apply(this,arguments)||this}
return h(f,b),a=f,f.prototype.clone=function(){return new a({color:this.color?this.color.clone():null,colorMixMode:this.colorMixMode})},d([g.property({type:String,json:{read:!0,write:!0}})],f.prototype,"colorMixMode",void 0),f=a=d([g.subclass("esri.symbols.support.Symbol3DFillMaterial")],f);var a}(g.declared(b["default"]));l.Symbol3DFillMaterial=m;l["default"]=m})},"esri/symbols/ExtrudeSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Symbol3DLayer ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g){return function(b){function f(a){a=b.call(this)||this;return a.type="extrude",a.size=void 0,a.material=null,a}return h(f,b),a=f,f.prototype.clone=function(){return new a({enabled:this.enabled,elevationInfo:this.elevationInfo&&this.elevationInfo.clone(),material:this.material&&this.material.clone(),size:this.size})},d([g.property()],f.prototype,"type",void 0),d([g.property({type:Number,json:{write:!0}})],f.prototype,"size",void 0),d([g.property()],f.prototype,"material",void 0),
f=a=d([g.subclass("esri.symbols.ExtrudeSymbol3DLayer")],f);var a}(g.declared(b))})},"esri/symbols/TextSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ./Symbol3DLayer ./support/Symbol3DHalo ./support/materialUtils ../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g,k,f,a){return function(e){function c(a){a=e.call(this)||this;return a.font=null,a.halo=null,a.material=null,a.size=void 0,a.text=void 0,
a.type="text",a}return h(c,e),g=c,c.prototype.writeFont=function(a,c){a&&(c.font=b.clone(a))},c.prototype.clone=function(){return new g({enabled:this.enabled,elevationInfo:this.elevationInfo&&this.elevationInfo.clone(),font:this.font&&b.clone(this.font),halo:this.halo&&b.clone(this.halo),material:this.material&&this.material.clone(),size:this.size,text:this.text})},d([a.property()],c.prototype,"font",void 0),d([a.writer("font",{"font.family":{type:String},"font.weight":{type:String},"font.style":{type:String}})],
c.prototype,"writeFont",null),d([a.property({type:k["default"],json:{write:!0}})],c.prototype,"halo",void 0),d([a.property()],c.prototype,"material",void 0),d([a.property(f.screenSizeProperty)],c.prototype,"size",void 0),d([a.property({type:String,json:{write:!0}})],c.prototype,"text",void 0),d([a.property()],c.prototype,"type",void 0),c=g=d([a.subclass("esri.symbols.TextSymbol3DLayer")],c);var g}(a.declared(g))})},"esri/symbols/support/Symbol3DHalo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/lang ./materialUtils ../../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a){Object.defineProperty(l,"__esModule",{value:!0});m=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;return a.color=new b([0,0,0,1]),a.size=0,a}return h(c,e),g=c,c.prototype.clone=function(){return new g({color:k.clone(this.color),size:this.size})},d([a.property(f.colorAndTransparencyProperty)],c.prototype,"color",void 0),d([a.property(f.screenSizeProperty)],c.prototype,"size",void 0),c=g=d([a.subclass("esri.symbols.support.Symbol3DHalo")],c);var g}(a.declared(g));
l.Symbol3DHalo=m;l["default"]=m})},"esri/symbols/support/StyleOrigin":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../portal/Portal".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;return a.portal=null,a}return h(a,f),e=a,a.prototype.clone=function(){return new e({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,
portal:this.portal})},d([b.property({type:String})],a.prototype,"name",void 0),d([b.property({type:String})],a.prototype,"styleUrl",void 0),d([b.property({type:String})],a.prototype,"styleName",void 0),d([b.property({type:k})],a.prototype,"portal",void 0),a=e=d([b.subclass("esri.symbols.support.StyleOrigin")],a);var e}(b.declared(g))})},"esri/symbols/support/Symbol3DVerticalOffset":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(m,l,h,d,b,g,k){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;return a.screenLength=0,a.minWorldLength=0,a}return h(a,b),e=a,a.prototype.writeMinWorldLength=function(a,b,e){a&&(b[e]=a)},a.prototype.clone=function(){return new e({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})},d([g.property(k.screenSizeProperty)],a.prototype,"screenLength",void 0),d([g.property({type:Number,
json:{write:!0}})],a.prototype,"minWorldLength",void 0),d([g.writer("minWorldLength")],a.prototype,"writeMinWorldLength",null),d([g.property({type:Number,json:{write:!0}})],a.prototype,"maxWorldLength",void 0),a=e=d([g.subclass("esri.symbols.support.Symbol3DVerticalOffset")],a);var e}(g.declared(b));l.Symbol3DVerticalOffset=m;l["default"]=m})},"esri/symbols/callouts/calloutUtils":function(){define(["require","exports","./Callout3D","./LineCallout3D"],function(m,l,h,d){function b(b){return b?(b=b.verticalOffset)?
0>=b.screenLength||0>=b.maxWorldLength?!1:!0:!1:!1}function g(b,f,a){if(!b)return b;switch(b.type){case "line":return f=new d,f.read(b,a),f}}Object.defineProperty(l,"__esModule",{value:!0});l.hasVisibleVerticalOffset=b;l.hasVisibleCallout=function(d){if(!d||!d.supportsCallout||!d.supportsCallout())return!1;var f=d.callout;return f&&f.visible&&b(d)?!0:!1};l.isCalloutSupport=function(b){return"point-3d"===b.type||"label-3d"===b.type};l.read=g;l.calloutProperty={types:{key:"type",base:h,typeMap:{line:d}},
json:{read:g,write:!0}}})},"esri/symbols/callouts/Callout3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/_base/lang ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(a){a=f.call(this)||this;return a.visible=!0,a}return h(a,f),a.prototype.normalizeCtorArgs=function(a){return a&&a.type?(a=b.mixin({},a),delete a.type,a):a},a.prototype.clone=function(){},
d([k.property({type:String,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],a.prototype,"type",void 0),d([k.property({readOnly:!0})],a.prototype,"visible",void 0),a=d([k.subclass("esri.symbols.callouts.Callout3D")],a)}(k.declared(g))})},"esri/symbols/callouts/LineCallout3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/lang ../../core/screenUtils ../../core/accessorSupport/decorators ./Callout3D ../support/materialUtils ./LineCallout3DBorder".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){return function(a){function q(c){c=a.call(this)||this;return c.type="line",c.color=new b([0,0,0,1]),c.size=k.px2pt(1),c.border=null,c}return h(q,a),r=q,Object.defineProperty(q.prototype,"visible",{get:function(){return 0<this.size&&0<this.color.a},enumerable:!0,configurable:!0}),q.prototype.clone=function(){return new r({color:g.clone(this.color),size:this.size,border:g.clone(this.border)})},d([f.property({type:String})],q.prototype,"type",void 0),d([f.property(e.colorAndTransparencyProperty)],
q.prototype,"color",void 0),d([f.property(e.screenSizeProperty)],q.prototype,"size",void 0),d([f.property({type:c["default"],json:{write:!0}})],q.prototype,"border",void 0),d([f.property({dependsOn:["size","color"],readOnly:!0})],q.prototype,"visible",null),q=r=d([f.subclass("esri.symbols.callouts.LineCallout3D")],q);var r}(f.declared(a))})},"esri/symbols/callouts/LineCallout3DBorder":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../support/materialUtils".split(" "),
function(m,l,h,d,b,g,k,f,a){Object.defineProperty(l,"__esModule",{value:!0});m=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;return a.color=new b("white"),a}return h(c,e),g=c,c.prototype.clone=function(){return new g({color:k.clone(this.color)})},d([f.property(a.colorAndTransparencyProperty)],c.prototype,"color",void 0),c=g=d([f.subclass("esri.symbols.support.LineCallout3DBorder")],c);var g}(f.declared(g));l.LineCallout3DBorder=m;l["default"]=m})},"esri/symbols/LineSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/Collection ./Symbol3D ./LineSymbol3DLayer ./PathSymbol3DLayer ./TextSymbol3DLayer ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){var q=g.ofType({base:null,key:"type",typeMap:{line:f,text:e,path:a}});return function(a){function e(b){b=a.call(this)||this;return b.symbolLayers=new q,b.type="line-3d",b}return h(e,a),f=e,e.prototype.clone=function(){return new f({styleOrigin:b.clone(this.styleOrigin),symbolLayers:b.clone(this.symbolLayers),thumbnail:b.clone(this.thumbnail)})},d([c.property({type:q})],e.prototype,"symbolLayers",void 0),d([c.property()],e.prototype,"type",void 0),e=f=d([c.subclass("esri.symbols.LineSymbol3D")],
e);var f}(c.declared(k))})},"esri/symbols/MeshSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/Collection ./Symbol3D ./FillSymbol3DLayer ../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g,k,f,a){var e=g.ofType({base:null,key:"type",typeMap:{fill:f}});return function(c){function f(a){a=c.call(this)||this;return a.symbolLayers=new e,a.type="mesh-3d",a}return h(f,c),g=f,f.prototype.clone=function(){return new g({styleOrigin:b.clone(this.styleOrigin),
symbolLayers:b.clone(this.symbolLayers),thumbnail:b.clone(this.thumbnail)})},d([a.property({type:e})],f.prototype,"symbolLayers",void 0),d([a.property()],f.prototype,"type",void 0),f=g=d([a.subclass("esri.symbols.MeshSymbol3D")],f);var g}(a.declared(k))})},"esri/symbols/PointSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/Collection ./Symbol3D ./IconSymbol3DLayer ./ObjectSymbol3DLayer ./TextSymbol3DLayer ./support/Symbol3DVerticalOffset ./callouts/calloutUtils ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){var r=g.ofType({base:null,key:"type",typeMap:{icon:f,object:a,text:e}});return function(a){function e(b){b=a.call(this)||this;return b.verticalOffset=null,b.callout=null,b.symbolLayers=new r,b.type="point-3d",b}return h(e,a),f=e,e.prototype.supportsCallout=function(){if(1!==(this.symbolLayers?this.symbolLayers.length:0))return!1;switch(this.symbolLayers.getItemAt(0).type){case "icon":case "text":case "object":return!0}return!1},e.prototype.hasVisibleCallout=function(){return q.hasVisibleCallout(this)},
e.prototype.hasVisibleVerticalOffset=function(){return q.hasVisibleVerticalOffset(this)},e.prototype.clone=function(){return new f({verticalOffset:b.clone(this.verticalOffset),callout:b.clone(this.callout),styleOrigin:b.clone(this.styleOrigin),symbolLayers:b.clone(this.symbolLayers),thumbnail:b.clone(this.thumbnail)})},d([t.property({type:c["default"],json:{write:!0}})],e.prototype,"verticalOffset",void 0),d([t.property(q.calloutProperty)],e.prototype,"callout",void 0),d([t.property({type:r})],e.prototype,
"symbolLayers",void 0),d([t.property()],e.prototype,"type",void 0),e=f=d([t.subclass("esri.symbols.PointSymbol3D")],e);var f}(t.declared(k))})},"esri/symbols/PolygonSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/Collection ./Symbol3D ./ExtrudeSymbol3DLayer ./FillSymbol3DLayer ./IconSymbol3DLayer ./LineSymbol3DLayer ./ObjectSymbol3DLayer ./TextSymbol3DLayer ../core/accessorSupport/decorators".split(" "),function(m,
l,h,d,b,g,k,f,a,e,c,q,t,r){var u=g.ofType({base:null,key:"type",typeMap:{extrude:f,fill:a,icon:e,line:c,object:q,text:t}});return function(a){function c(b){b=a.call(this)||this;return b.type="polygon-3d",b}return h(c,a),e=c,c.prototype.clone=function(){return new e({styleOrigin:b.clone(this.styleOrigin),symbolLayers:b.clone(this.symbolLayers),thumbnail:b.clone(this.thumbnail)})},c.fromJSON=function(a){var b=new e;if(b.read(a),2===b.symbolLayers.length&&"fill"===b.symbolLayers.getItemAt(0).type&&"line"===
b.symbolLayers.getItemAt(1).type){var c=b.symbolLayers.getItemAt(0),d=b.symbolLayers.getItemAt(1);!d.enabled||a.symbolLayers&&a.symbolLayers[1]&&!1===a.symbolLayers[1].enable||(c.outline={size:d.size,color:d.material.color});b.symbolLayers.removeAt(1)}return b},d([r.property({type:u})],c.prototype,"symbolLayers",void 0),d([r.property()],c.prototype,"type",void 0),c=e=d([r.subclass("esri.symbols.PolygonSymbol3D")],c);var e}(r.declared(k))})},"esri/symbols/support/jsonUtils":function(){define("require exports ../../core/Error ../../core/Warning ../Symbol3D ../SimpleLineSymbol ../SimpleMarkerSymbol ../PictureMarkerSymbol ../PictureFillSymbol ../SimpleFillSymbol ../TextSymbol ../PointSymbol3D ../LineSymbol3D ../PolygonSymbol3D ../MeshSymbol3D ../LabelSymbol3D ../WebStyleSymbol ../callouts/LineCallout3D ./symbolConversion".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n){function w(a,c,e){if(!a)return null;if(!e||"web-scene"!==e.origin||a.isInstanceOf(b)||a.isInstanceOf(x))return a.write(c,e);var d=n.to3D(a);return d.symbol?d.symbol.write(c,e):(e.messages&&e.messages.push(new h("symbol:unsupported","Symbols of type '"+a.declaredClass+"' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView",{symbol:a,context:e,error:d.error})),null)}Object.defineProperty(l,"__esModule",{value:!0});
var z={esriSMS:k,esriPMS:f,esriTS:c,esriSLS:g,esriSFS:e,esriPFS:a,PointSymbol3D:q,LineSymbol3D:t,PolygonSymbol3D:r,MeshSymbol3D:u,LabelSymbol3D:v,styleSymbolReference:x};l.read=function(a,b,c){return(b=a?z[a.type]||null:null)?(b=new b,b.read(a,c),b):(c&&c.messages&&a&&c.messages.push(new d("symbol:unsupported","Symbols of type '"+(a.type||"unknown")+"' are not supported",{definition:a,context:c})),null)};l.writeTarget=function(a,b,c,e){(a=w(a,{},e))&&(b[c]=a)};l.write=w;l.fromJSON=function(a,b){var c=
a?z[a.type]||null:null;return c?c.fromJSON(a,b):null};l.readCallout3D=function(a,b){if(!a||!a.type)return null;var c=null;switch(a.type){case "line":c=new y}return c&&c.read(a,b),c}})},"esri/symbols/support/symbolConversion":function(){define("require exports dojo/_base/lang ../../core/lang ../../core/Error ../Font ../SimpleLineSymbol ../SimpleMarkerSymbol ../PictureMarkerSymbol ../SimpleFillSymbol ../TextSymbol ../WebStyleSymbol ../Symbol3D ../LineSymbol3D ../PointSymbol3D ../PolygonSymbol3D ../LabelSymbol3D ../LineSymbol3DLayer ../IconSymbol3DLayer ../FillSymbol3DLayer ../TextSymbol3DLayer ../../Color".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C){function B(b){var c,e,d,f=b.color?b.color.clone():new C([255,255,255]);b instanceof a?(b.color&&0===b.color.r&&0===b.color.g&&0===b.color.b&&(f=new C([255,255,255])),c={href:b.url},e=b.width<=b.height?b.height:b.width):(c=b.style,c={primitive:c in F?F[c]:(console.log(c+' cannot be mapped to Icon symbol. Fallback to "circle"'),"circle")},e=b.size,b.outline&&b.outline.color&&0<b.outline.width&&(d={size:b.outline.width,color:b.outline.color.clone()}));
return new u(new n({size:e,resource:c,material:{color:f},outline:d}))}Object.defineProperty(l,"__esModule",{value:!0});var F={};F[f.STYLE_CIRCLE]="circle";F[f.STYLE_CROSS]="cross";F[f.STYLE_DIAMOND]="kite";F[f.STYLE_SQUARE]="square";F[f.STYLE_X]="x";l.to3D=function(n,l,m,C){if(void 0===l&&(l=!1),void 0===m&&(m=!1),void 0===C&&(C=!0),!n)return{symbol:null};if(n instanceof t||n instanceof q)C=n.clone();else if(n instanceof k)C=new r(new y({size:n.width||1,material:{color:n.color?n.color.clone():[255,
255,255]}}));else if(n instanceof f)C=B(n);else if(n instanceof a)C=B(n);else if(n instanceof e)C=new w({material:{color:n.color?n.color.clone():[255,255,255]}}),C=(n.outline&&n.outline.color&&(C.outline={size:n.outline.width||0,color:n.outline.color}),new v(C));else{if(!(n instanceof c))return{error:new b("symbol-conversion:unsupported-2d-symbol","2D symbol of type '"+(n.type||n.declaredClass)+"' is unsupported in 3D",{symbol:n})};var F=h.clone(g.defaultProps);n.font&&h.mixin(F,n.font);var G;G=n.haloColor;
var N=n.haloSize;G=G&&0<N?{color:d.clone(G),size:N}:null;C=new (C?x:u)(new z({size:F.size,font:{family:F.family,weight:F.weight,style:F.style},halo:G,material:{color:n.color.clone()},text:n.text}))}if(l&&(C.id=n.id),m&&C.isInstanceOf(t))for(n=0;n<C.symbolLayers.length;++n)C.symbolLayers.getItemAt(n)._ignoreDrivers=!0;return{symbol:C}}})},"esri/views/LayerViewManager":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor ../core/Error ../core/HandleRegistry ../core/Scheduler ../core/promiseUtils ../core/watchUtils ./LayerViewFactory".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){return function(g){function r(){var a=g.call(this)||this;return a._promisesMap=new Map,a._layerViewsMap=new Map,a._handles=new f,a.factory=new q,a.ready=!1,a.layersToLayerViews=function(){var a=new Map;return a.set("view.map.basemap.baseLayers","view.basemapView.baseLayerViews"),a.set("view.map.ground.layers","view.groundView.layerViews"),a.set("view.map.layers","view.layerViews"),a.set("view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"),a}(),
a._doWork=a._doWork.bind(a),a.refresh=a.refresh.bind(a),a._handles.add(c.init(a,"view.ready",function(b){return a.ready=b})),a._handles.add(a.watch(["view.map.basemap","view.map.ground","view.map.layers","ready"],a.refresh),"watcher"),a}return h(r,g),r.prototype.destroy=function(){this._handles&&(this.empty(),this.view=null,this.factory.destroy(),this.factory=null,this._handles.destroy(),this._handles=null,this._promisesMap=null,this._layerViewsMap=null,this._map=null)},r.prototype.empty=function(){this._layerViewsMap.forEach(this._disposeLayerView,
this);this._promisesMap.forEach(function(a){return a.cancel()});this._layerViewsMap.clear();this._promisesMap.clear();this._refreshCollections()},r.prototype.refresh=function(){var b=this._handles;b.remove("refresh");b.add(a.schedule(this._doWork),"refresh")},r.prototype.whenLayerView=function(a){return this.refresh(),this._doWork(),this._promisesMap.has(a)?this._promisesMap.get(a):e.reject(new k("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:a}))},r.prototype._doWork=
function(){var a=this,b=this._handles,c=this.get("view.map");if(this._map!==c&&(this.empty(),this._map=c),b.has("refresh")){b.remove("refresh");b.remove("collection-change");this.factory.paused=!this.ready;var e=this._map&&this._map.allLayers;e&&(e.forEach(this._createLayerView,this),this._refreshCollections(),this._promisesMap.forEach(function(b,c){e.includes(c)||a._disposeLayerView(a._layerViewsMap.get(c),c)}),b.add(e.on("change",this.refresh),"collection-change"))}},r.prototype._refreshCollections=
function(){var a=this;this.layersToLayerViews.forEach(function(b,c){a._populateLayerViewsOwners(a.get(c),a.get(b),a.view)})},r.prototype._populateLayerViewsOwners=function(a,b,c){var e=this;if(!a||!b)return void(b&&b.removeAll());var d=0;a.forEach(function(a){var f=e._layerViewsMap.get(a);f&&(f.layer=a,f.parent=c,b.getItemAt(d)!==f&&b.splice(d,0,f),a.layers&&e._populateLayerViewsOwners(a.layers,f.layerViews,f),d+=1)});d<b.length&&b.splice(d,b.length)},r.prototype._createLayerView=function(a){var b=
this,c=this.view,e=this.factory,d=this._layerViewsMap,f=this._promisesMap;if(d.has(a))return void a.load();f.has(a)||(e=e.create(c,a).then(function(e){if(!b._map||!b._map.allLayers.some(function(b){return a===b}))throw new k("view:no-layerview-for-layer","The layer has been removed from the map",{layer:a});return d.set(a,e),b._refreshCollections(),a.emit("layerview-create",{view:c,layerView:e}),c.emit("layerview-create",{layer:a,layerView:e}),e.when()}),f.set(a,e),e.always(this.refresh))},r.prototype._disposeLayerView=
function(a,b){if(this._promisesMap.has(b)&&(this._promisesMap.get(b).cancel(),this._promisesMap["delete"](b),a)){b=a.layer;var c=a.view;this.factory.dispose(a);a.layer=a.parent=a.view=null;this._layerViewsMap["delete"](b);b.emit("layerview-destroy",{view:c,layerView:a});c.emit("layerview-destroy",{layer:b,layerView:a})}},d([b.property()],r.prototype,"ready",void 0),d([b.property()],r.prototype,"view",void 0),r=d([b.subclass("esri.views.LayerViewManager")],r)}(b.declared(g))})},"esri/views/LayerViewFactory":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators dojo/Deferred dojo/when ../core/Accessor ../core/Collection ../core/Error ../core/watchUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){return function(f){function q(){var b=null!==f&&f.apply(this,arguments)||this;return b.creationRequests=new a,b.paused=!0,b}return h(q,f),q.prototype.initialize=function(){var a=this;c.whenFalse(this,"paused",function(){a.creationRequests.toArray().forEach(a._processRequest,a)},!0)},q.prototype.destroy=function(){this.creationRequests.drain(function(a){return a.deferred.cancel(void 0)})},Object.defineProperty(q.prototype,"working",{get:function(){return 0<this.creationRequests.length},
enumerable:!0,configurable:!0}),q.prototype.create=function(a,b){var c=this.getLayerViewPromise(b);if(c)return c;var d=this.creationRequests,f={deferred:new g(function(){var a=new e("cancelled:layerview-create","layerview creation cancelled",{layer:b});return d.remove(f),f.creationPromise&&f.creationPromise.cancel(a),a}),view:a,layer:b,started:!1,creationPromise:null};return d.push(f),this.paused||this._processRequest(f),f.deferred.promise},q.prototype.dispose=function(a){a.layer.destroyLayerView(a)},
q.prototype.getLayerViewPromise=function(a){var b=this.creationRequests&&this.creationRequests.find(function(b){return b.layer===a});return b&&b.deferred.promise},q.prototype._processRequest=function(a){var b=this;if(!a.started){a.started=!0;var c=a.deferred,d=a.layer,f=a.view;d.load().then(function(b){return c.isCanceled()?void 0:(a.creationPromise=b.createLayerView(f),a.creationPromise)}).then(function(b){return c.isCanceled()?b:a.creationPromise=k(b.when())})["catch"](function(a){c.isCanceled()||
c.reject(new e("layerview:create-error","layerview creation failed",{layer:d,error:a}))}).then(function(e){return b.creationRequests&&b.creationRequests.remove(a),c.isFulfilled()?e&&b.dispose(e):c.resolve(e),e})}},d([b.property()],q.prototype,"creationRequests",void 0),d([b.property()],q.prototype,"paused",void 0),d([b.property()],q.prototype,"view",void 0),d([b.property({dependsOn:["paused","creationRequests.length"],readOnly:!0})],q.prototype,"working",null),q=d([b.subclass("esri.views.LayerViewFactory")],
q)}(b.declared(f))})},"esri/views/RefreshManager":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor ../core/HandleRegistry".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;return a._handles=new k,a._currentTick=0,a}return h(a,f),a.prototype.initialize=function(){var a=this;this.view.allLayerViews.on("after-changes",function(){a.notifyChange("tickInterval");
a._handles.remove("layerViewsUpdating");a._handles.add(a._getLayerViewHandles(),"layerViewsUpdating")});this.watch("tickInterval",function(){return a._restartTicking()});this.watch("view.ready",function(){return a._restartTicking()});this._restartTicking()},a.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null,this._intervalID&&clearInterval(this._intervalID),this._currentTick=0)},Object.defineProperty(a.prototype,"tickInterval",{get:function(){var a=this.view.allLayerViews.filter(function(a){return!!a.refresh});
return this._getCommonInterval(a)},enumerable:!0,configurable:!0}),a.prototype._restartTicking=function(){var a=this;this._currentTick=0;this._intervalID&&clearInterval(this._intervalID);this.get("view.ready")&&(this._intervalID=setInterval(function(){var b=Date.now();a._currentTick+=a.tickInterval;a.view.allLayerViews.forEach(function(c){if(c.refresh){var e=Math.round(6E4*c.refreshInterval),d=0===a._currentTick%e,f=6E3>b-c.refreshTimestamp;e&&d&&!f&&c.refresh(b)}})},this.tickInterval))},a.prototype._getLayerViewHandles=
function(){var a=this,b=[];return this.view.allLayerViews.forEach(function(c){if(c.refresh){var e=c.watch("refreshInterval",function(){return a.notifyChange("tickInterval")});if(b.push(e),c.layer)e=c.layer.on("refresh",function(){var a=Date.now();6E3>a-c.refreshTimestamp||c.refresh(a)}),b.push(e)}}),b},a.prototype._getCommonInterval=function(a){var b=function(a,c){return isNaN(a)||isNaN(c)?0:0>=c?a:b(c,a%c)};return a.toArray().reduce(function(a,c){return b(Math.round(6E4*c.refreshInterval),a)},0)},
d([b.property()],a.prototype,"view",void 0),d([b.property({readOnly:!0})],a.prototype,"tickInterval",null),a=d([b.subclass("esri.views.RefreshManager")],a)}(b.declared(g))})},"esri/views/BasemapView":function(){define(["../core/Accessor","../core/Collection","../core/watchUtils"],function(m,l,h){return m.createSubclass({declaredClass:"esri.views.BasemapView",properties:{view:{},baseLayerViews:{type:l},referenceLayerViews:{type:l}},constructor:function(){this._loadingHdl=h.init(this,"view.map.basemap",
this._loadBasemap)},getDefaults:function(){return{baseLayerViews:[],referenceLayerViews:[]}},destroy:function(){this.view=null;this._loadingHdl&&(this._loadingHdl.remove(),this._loadingHdl=null)},_suspendedGetter:function(){return this.view?this.view.suspended:!0},_loadBasemap:function(d){d&&d.load()}})})},"esri/views/GroundView":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor ../core/Collection ../core/watchUtils ../core/HandleRegistry".split(" "),
function(m,l,h,d,b,g,k,f,a){return function(e){function c(){var b=null!==e&&e.apply(this,arguments)||this;return b.handles=new a,b.layerViews=new k,b}return h(c,e),c.prototype.initialize=function(){this.handles.add(f.when(this,"view.map.ground",function(a){return a.load()}))},c.prototype.destroy=function(){this.view=null;this.handles&&(this.handles.destroy(),this.handles=null)},Object.defineProperty(c.prototype,"suspended",{get:function(){return!this.view||this.view.suspended},enumerable:!0,configurable:!0}),
d([b.property()],c.prototype,"view",void 0),d([b.property({type:k})],c.prototype,"layerViews",void 0),d([b.property()],c.prototype,"suspended",null),c=d([b.subclass("esri.views.GroundView")],c)}(b.declared(g))})},"esri/views/support/DefaultsFromMap":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/arrayUtils ../../core/watchUtils ../../core/Accessor ../../core/HandleRegistry ../../portal/support/geometryServiceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/heightModelInfoUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){return function(f){function r(){var b=null!==f&&f.apply(this,arguments)||this;return b._handles=new a,b._waitTask=null,b._isStarted=!1,b._spatialReferenceCandidates=null,b._extentCandidates=null,b.isSpatialReferenceDone=!1,b.isTileInfoDone=!1,b.isHeightModelInfoSearching=!1,b.spatialReference=null,b.extent=null,b.heightModelInfo=null,b.vcsWkid=null,b.latestVcsWkid=null,b.mapCollectionPaths=l.DefaultMapCollectionPaths.slice(),b.tileInfo=null,b}return h(r,f),l=r,r.prototype.initialize=
function(){var a=this;this.watch("mapCollectionPaths",function(){a._isStarted&&(a.reset(),a.start())})},r.prototype.destroy=function(){this._set("view",null);this._handles&&(this._handles.destroy(),this._handles=null,this._isStarted=!1);this._cancelLoading()},r.prototype.reset=function(){this._handles.removeAll();this._isStarted=!1;this._set("isSpatialReferenceDone",!1);this._set("isTileInfoDone",!1);this._set("isHeightModelInfoSearching",!1);this._set("spatialReference",null);this._set("extent",
null);this._set("heightModelInfo",null);this._set("vcsWkid",null);this._set("latestVcsWkid",null);this._set("tileInfo",null);this._extentCandidates=this._spatialReferenceCandidates=null},r.prototype.start=function(){this._handles.removeAll();this._isStarted=!0;for(var a=this._updateLayerChange.bind(this),b=0,c=this.mapCollectionPaths;b<c.length;b++)this._handles.add(k.on(this.view,"map."+c[b],"change",a,a,a,!0))},r.prototype._ownerNameFromCollectionName=function(a){var b=a.lastIndexOf(".");return-1===
b?"view":"view."+a.slice(0,b)},r.prototype._ensureLoadedOwnersFromCollectionName=function(a){var b;a=this._ownerNameFromCollectionName(a).split(".");for(var c=0;c<a.length&&(b=this.get(a.slice(0,c+1).join(".")),b);c++)if(b.load&&!b.isFulfilled())return{owner:null,loading:b.load()};return{owner:b}},r.prototype._cancelLoading=function(){this._waitTask=null;this._extentProjectTask&&(this._extentProjectTask.cancel(),this._extentProjectTask=null)},r.prototype._updateWhen=function(a){var b=this,c=!0,e=
!1,d=a.always(function(){c?e=!0:d===b._waitTask&&b._update()});return c=!1,e||(this._waitTask=d),e},r.prototype._updateLayerChange=function(){this.isSpatialReferenceDone&&!this.spatialReference&&this._set("isSpatialReferenceDone",!1);this._update()},r.prototype._update=function(){var a=this;if(this._cancelLoading(),this.view){if(!this.isSpatialReferenceDone&&0!==this._processMapCollections(function(b){return a._processSpatialReferenceSource(b)})){var b=null,c=this._spatialReferenceCandidates;!c||
1>c.length?b=this.defaultSpatialReference:(this.defaultSpatialReference&&1<c.length&&-1<g.findIndex(c,function(b){return b.equals(a.defaultSpatialReference)})&&(c=[this.defaultSpatialReference]),b=c[0]);this._set("spatialReference",b);this._set("isSpatialReferenceDone",!0);b&&(this._processMapCollections(function(c){return a._findExtent(c,b)}),this.extent||this._projectExtentCandidate())}null==this.heightModelInfo&&this.view.isHeightModelInfoRequired&&(c=this._processMapCollections(function(b){return a._processHeightModelInfoSource(b)},
function(a){return q.mayHaveHeightModelInfo(a)}),this._set("isHeightModelInfoSearching",0===c));null==this.tileInfo&&(c=!1,this.view.isTileInfoRequired()&&(c=this._deriveTileInfo()),c||this._set("isTileInfoDone",!0))}},r.prototype._processMapCollections=function(a,b){for(var c=0,e=this.mapCollectionPaths;c<e.length;c++){var d="map."+e[c],f=this._ensureLoadedOwnersFromCollectionName(d);if(f.loading&&!this._updateWhen(f.loading))return 0;f=f.owner;if(!(!f||f.isRejected&&f.isRejected())&&(d=this.view.get(d))&&
(d=this._processMapCollection(d,a,b),2!==d))return d}return 2},r.prototype._processMapCollection=function(a,b,c){for(var e=0;e<a.length;e++){var d=a.getItemAt(e),f=null!=c&&!c(d);if(!f&&d.load&&!d.isFulfilled()&&!this._updateWhen(d.load()))return 0;if(!f&&(!d.load||d.isResolved())){if(b(d))return 1;if(d.layers&&(d=this._processMapCollection(d.layers,b),2!==d))return d}}return 2},r.prototype._processSpatialReferenceSource=function(a){a=this._getSupportedSpatialReferences(a);return 0===a.length?!1:
(this._spatialReferenceCandidates?(a=g.intersect(a,this._spatialReferenceCandidates,function(a,b){return a.equals(b)}),0<a.length&&(this._spatialReferenceCandidates=a)):this._spatialReferenceCandidates=a,1===this._spatialReferenceCandidates.length)},r.prototype._findExtent=function(a,b){var c=a.fullExtents||(a.fullExtent?[a.fullExtent]:[]),e=g.find(c,function(a){return a.spatialReference.equals(b)});if(e)return this._set("extent",e),!0;0<this._getSupportedSpatialReferences(a).length&&(c=c.map(function(b){return{extent:b,
layer:a}}),this._extentCandidates=(this._extentCandidates||[]).concat(c));return!1},r.prototype._projectExtentCandidate=function(){var a=this;if(this._extentCandidates&&this._extentCandidates.length){var b=this.spatialReference,d=g.find(this._extentCandidates,function(a){return c.canProject(a.extent.spatialReference,b)});d?this._set("extent",c.project(d.extent,b)):(d=this._extentCandidates[0],this._extentProjectTask=e.projectGeometry(d.extent,b,d.layer.portalItem).then(function(b){a._set("extent",
b)}))}},r.prototype._getSupportedSpatialReferences=function(a){var b=this;return(a.supportedSpatialReferences||(a.spatialReference?[a.spatialReference]:[])).filter(function(c){return b.view.isSpatialReferenceSupported(c,a)})},r.prototype._processHeightModelInfoSource=function(a){var b=q.deriveHeightModelInfoFromLayer(a);return b?(this._set("heightModelInfo",b),this._set("isHeightModelInfoSearching",!1),a.spatialReference&&(this._set("vcsWkid",a.spatialReference.vcsWkid),this._set("latestVcsWkid",
a.spatialReference.latestVcsWkid)),!0):!1},r.prototype._deriveTileInfo=function(){if(!this.isSpatialReferenceDone)return!0;var a=this.get("view.map");if(!a)return!0;var b=a.basemap,c=b&&b.get("baseLayers.0"),a=a.get("layers.0"),e=!1,d=null;return b&&"failed"!==b.loadStatus?b.loaded?c&&"failed"!==c.loadStatus?c.loaded?d=c.tileInfo:(this._updateWhen(c.load()),e=!0):a&&"failed"!==a.loadStatus?a.loaded?d=a.tileInfo:(this._updateWhen(a.load()),e=!0):e=!0:(this._updateWhen(b.load()),e=!0):a&&"failed"!==
a.loadStatus&&(a.loaded?d=a.tileInfo:(this._updateWhen(a.load()),e=!0)),d&&!d.spatialReference.equals(this.spatialReference)&&(d=null),e||this._set("tileInfo",d),e},r.DefaultMapCollectionPaths=["basemap.baseLayers","layers","ground.layers","basemap.referenceLayers"],d([b.property({readOnly:!0})],r.prototype,"isSpatialReferenceDone",void 0),d([b.property({readOnly:!0})],r.prototype,"isTileInfoDone",void 0),d([b.property({readOnly:!0})],r.prototype,"isHeightModelInfoSearching",void 0),d([b.property({constructOnly:!0})],
r.prototype,"view",void 0),d([b.property({readOnly:!0})],r.prototype,"spatialReference",void 0),d([b.property({readOnly:!0})],r.prototype,"extent",void 0),d([b.property({readOnly:!0})],r.prototype,"heightModelInfo",void 0),d([b.property({readOnly:!0})],r.prototype,"vcsWkid",void 0),d([b.property({readOnly:!0})],r.prototype,"latestVcsWkid",void 0),d([b.property()],r.prototype,"mapCollectionPaths",void 0),d([b.property()],r.prototype,"defaultSpatialReference",void 0),d([b.property({readOnly:!0})],r.prototype,
"tileInfo",void 0),r=l=d([b.subclass("esri.views.support.DefaultsFromMap")],r);var l}(b.declared(f))})},"esri/core/arrayUtils":function(){define([],function(){function m(d,b){return-1===d.indexOf(b)}function l(d,b,g){return!d.some(b.bind(null,g))}var h={findIndex:function(d,b,g){for(var k,f=d.length,a=0;f>a;a++)if(k=d[a],b.call(g,k,a,d))return a;return-1},find:function(d,b,g){for(var k,f=d.length,a=0;f>a;a++)if(k=d[a],b.call(g,k,a,d))return k},equals:function(d,b,g){if(!d&&!b)return!0;if(!d||!b||
d.length!=b.length)return!1;if(g)for(var k=0;k<d.length;k++){if(!g(d[k],b[k]))return!1}else for(g=0;g<d.length;g++)if(d[g]!==b[g])return!1;return!0},difference:function(d,b,g){var k,f;return g?(k=b.filter(l.bind(null,d,g)),f=d.filter(l.bind(null,b,g))):(k=b.filter(m.bind(null,d)),f=d.filter(m.bind(null,b))),{added:k,removed:f}},intersect:function(d,b,g){return d&&b?g?d.filter(function(d){return-1<h.findIndex(b,function(b){return g(d,b)})}):d.filter(function(d){return-1<b.indexOf(d)}):[]},range:function(d,
b){null==b&&(b=d,d=0);for(var g=Array(b-d),k=d;b>k;k++)g[k-d]=k;return g},constant:function(d,b){for(var g=Array(d),k=0;d>k;k++)g[k]=b;return g},binaryIndexOf:function(d,b,g){for(var k=d.length,f=0,a=k-1;a>f;){var e=f+Math.floor((a-f)/2);b>d[e]?f=e+1:a=e}a=d[f];return g?b>=d[k-1]?-1:a===b?f:f-1:a===b?f:-1}};return h})},"esri/portal/support/geometryServiceUtils":function(){define("require exports ../Portal ../PortalItem ../../config ../../tasks/GeometryService ../../tasks/support/ProjectParameters ../../core/promiseUtils ../../core/Error".split(" "),
function(m,l,h,d,b,g,k,f,a){function e(c){if(void 0===c&&(c=null),b.geometryServiceUrl)return f.resolve(new g({url:b.geometryServiceUrl}));if(!c)return f.reject(new a("internal:geometry-service-url-not-configured"));var e;return c.isInstanceOf(d)?e=c.portal||h.getDefault():c.isInstanceOf(h)&&(e=c),e.load().then(function(b){if(b.helperServices&&b.helperServices.geometry&&b.helperServices.geometry.url)return f.resolve(new g({url:b.helperServices.geometry.url}));throw new a("internal:geometry-service-url-not-configured");
})}Object.defineProperty(l,"__esModule",{value:!0});l.create=e;l.projectGeometry=function(a,b,d){return void 0===d&&(d=null),e(d).then(function(c){var e=new k;return e.geometries=[a],e.outSpatialReference=b,c.project(e)}).then(function(a){return a&&Array.isArray(a)&&1===a.length?a[0]:f.reject()})}})},"esri/tasks/GeometryService":function(){define("../core/kebabDictionary ../core/accessorSupport/ensureType ../geometry/Extent ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon ../geometry/support/jsonUtils ../request ./Task ./support/ProjectParameters dojo/_base/lang".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){var q=m({MGRS:"mgrs",USNG:"usng",UTM:"utm",GeoRef:"geo-ref",GARS:"gars",DMS:"dms",DDM:"ddm",DD:"dd"}),t=l.ensureType(e);m=a.createSubclass({declaredClass:"esri.tasks.GeometryService",areasAndLengths:function(a,b){a={query:c.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/areasAndLengths",a).then(function(a){return a.data})},autoComplete:function(a,
b,e){var d=a[0].spatialReference;a={query:c.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(d.toJSON()),polygons:JSON.stringify(this._encodeGeometries(a).geometries),polylines:JSON.stringify(this._encodeGeometries(b).geometries)}),callbackParamName:"callback"};return(this.requestOptions||e)&&(a=c.mixin({},this.requestOptions,e,a)),f(this.parsedUrl.path+"/autoComplete",a).then(function(a){return(a.data.geometries||[]).map(function(a){return new g({spatialReference:d,rings:a.rings})})})},
buffer:function(a,b){var e=c.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),d=a.outSpatialReference||a.geometries[0].spatialReference;a={query:e,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/buffer",a).then(function(a){return(a.data.geometries||[]).map(function(a){return new g({spatialReference:d,rings:a.rings})})})},cut:function(a,b,e){var d=a[0].spatialReference,g=a.map(function(a){return a.toJSON()});a={query:c.mixin({},
this.parsedUrl.query,{f:"json",sr:JSON.stringify(d.toJSON()),target:JSON.stringify({geometryType:k.getJsonType(a[0]),geometries:g}),cutter:JSON.stringify(b.toJSON())}),callbackParamName:"callback"};return(this.requestOptions||e)&&(a=c.mixin({},this.requestOptions,e,a)),f(this.parsedUrl.path+"/cut",a).then(function(a){a=a.data;return{cutIndexes:a.cutIndexes,geometries:(a.geometries||[]).map(function(a){return k.fromJSON(a).set("spatialReference",d)})}})},convexHull:function(a,b){var e=a[0].spatialReference;
a={query:c.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(e.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/convexHull",a).then(function(a){return k.fromJSON(a.data.geometry).set("spatialReference",e)})},densify:function(a,b){var e=c.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),d=a.geometries[0].spatialReference;a={query:e,callbackParamName:"callback"};
return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/densify",a).then(function(a){return(a.data.geometries||[]).map(function(a){return k.fromJSON(a).set("spatialReference",d)})})},difference:function(a,b,e){var d=a[0].spatialReference;a={query:c.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(d.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a)),geometry:JSON.stringify({geometryType:k.getJsonType(b),geometry:b.toJSON()})}),callbackParamName:"callback"};
return(this.requestOptions||e)&&(a=c.mixin({},this.requestOptions,e,a)),f(this.parsedUrl.path+"/difference",a).then(function(a){return(a.data.geometries||[]).map(function(a){return k.fromJSON(a).set("spatialReference",d)})})},distance:function(a,b){a={query:c.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/distance",a).then(this._handleDistanceResponse)},fromGeoCoordinateString:function(a,
b){var e={};c.isObject(a.sr)?e.sr=a.sr.wkid||JSON.stringify(a.sr.toJSON()):e.sr=a.sr;e.strings=JSON.stringify(a.strings);e.conversionType=q.toJSON(a.conversionType||"mgrs");e.conversionMode=a.conversionMode;a={query:c.mixin({},this.parsedUrl.query,{f:"json"},e),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/fromGeoCoordinateString",a).then(this._handleFromGeoCoordinateResponse)},generalize:function(a,b){var e=c.mixin({},
this.parsedUrl.query,{f:"json"},a.toJSON()),d=a.geometries[0].spatialReference;a={query:e,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/generalize",a).then(function(a){return(a.data.geometries||[]).map(function(a){return k.fromJSON(a).set("spatialReference",d)})})},intersect:function(a,b,e){var d=a[0].spatialReference;a={query:c.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(d.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a)),
geometry:JSON.stringify({geometryType:k.getJsonType(b),geometry:b.toJSON()})}),callbackParamName:"callback"};return(this.requestOptions||e)&&(a=c.mixin({},this.requestOptions,e,a)),f(this.parsedUrl.path+"/intersect",a).then(function(a){return(a.data.geometries||[]).map(function(a){return k.fromJSON(a).set("spatialReference",d)})})},lengths:function(a,b){a={query:c.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,
b,a)),f(this.parsedUrl.path+"/lengths",a).then(function(a){return a.data})},labelPoints:function(a,b){var e=a.map(function(a){return a.toJSON()}),d=a[0].spatialReference;a={query:c.mixin({},this.parsedUrl.query,{f:"json",sr:d.wkid?d.wkid:JSON.stringify(d.toJSON()),polygons:JSON.stringify(e)}),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/labelPoints",a).then(function(a){return(a.data.labelPoints||[]).map(function(a){return k.fromJSON(a).set("spatialReference",
d)})})},offset:function(a,b){var e=c.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),d=a.geometries[0].spatialReference;a={query:e,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/offset",a).then(function(a){return(a.data.geometries||[]).map(function(a){return k.fromJSON(a).set("spatialReference",d)})})},project:function(a,b){a=t(a);var e=c.mixin({},a.toJSON(),this.parsedUrl.query,{f:"json"}),d=a.outSpatialReference,
g=k.getJsonType(a.geometries[0]),n=this._decodeGeometries;a={query:e,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/project",a).then(function(a){return n(a.data,g,d)})},relation:function(a,b){a={query:c.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/relation",a).then(this._handleRelationResponse)},
reshape:function(a,b,e){var d=a.spatialReference;a={query:c.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(d.toJSON()),target:JSON.stringify({geometryType:k.getJsonType(a),geometry:a.toJSON()}),reshaper:JSON.stringify(b.toJSON())}),callbackParamName:"callback"};return(this.requestOptions||e)&&(a=c.mixin({},this.requestOptions,e,a)),f(this.parsedUrl.path+"/reshape",a).then(function(a){return k.fromJSON(a.data.geometry).set("spatialReference",d)})},simplify:function(a,b){var e=a[0].spatialReference,
d=c.mixin({},this.parsedUrl.query,{f:"json",sr:e.wkid?e.wkid:JSON.stringify(e.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}),g=k.getJsonType(a[0]),n=this._decodeGeometries;a={query:d,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/simplify",a).then(function(a){return n(a.data,g,e)})},toGeoCoordinateString:function(a,b){var e={};c.isObject(a.sr)?e.sr=a.sr.wkid||JSON.stringify(a.sr.toJSON()):e.sr=a.sr;e.coordinates=
JSON.stringify(a.coordinates);e.conversionType=q.toJSON(a.conversionType||"mgrs");e.conversionMode=a.conversionMode;e.numOfDigits=a.numOfDigits;e.rounding=a.rounding;e.addSpaces=a.addSpaces;a={query:c.mixin({},this.parsedUrl.query,{f:"json"},e),callbackParamName:"callback"};return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/toGeoCoordinateString",a).then(this._handleToGeoCoordinateResponse)},trimExtend:function(a,e){var d=c.mixin({},this.parsedUrl.query,
{f:"json"},a.toJSON()),g=a.sr;a={query:d,callbackParamName:"callback"};return(this.requestOptions||e)&&(a=c.mixin({},this.requestOptions,e,a)),f(this.parsedUrl.path+"/trimExtend",a).then(function(a){return(a.data.geometries||[]).map(function(a){return new b({spatialReference:g,paths:a.paths})})})},union:function(a,b){var e=a[0].spatialReference;a={query:c.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(e.toJSON()),geometries:JSON.stringify(this._encodeGeometries(a))}),callbackParamName:"callback"};
return(this.requestOptions||b)&&(a=c.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+"/union",a).then(function(a){return k.fromJSON(a.data.geometry).set("spatialReference",e)})},_handleRelationResponse:function(a){return a.data.relations},_handleDistanceResponse:function(a){return a=a.data,a&&a.distance},_handleToGeoCoordinateResponse:function(a){return a.data.strings},_handleFromGeoCoordinateResponse:function(a){return a.data.coordinates},_encodeGeometries:function(a){var b,c=[],e=a.length;
for(b=0;e>b;b++)c.push(a[b].toJSON());return{geometryType:k.getJsonType(a[0]),geometries:c}},_decodeGeometries:function(a,b,e){var d=k.getGeometryType(b);a=a.geometries;var f=[],g={spatialReference:e.toJSON()},h=c.mixin;return a.forEach(function(a,b){f[b]=new d(h(a,g))}),f},_toProjectGeometry:function(a){var c=a.spatialReference.toJSON();return a instanceof h?new g({rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]],spatialReference:c}):new b({paths:[[].concat(a.points)],
spatialReference:c})},_fromProjectedGeometry:function(a,b,c){return"extent"===b?(a=a.rings[0],new h(a[0][0],a[0][1],a[2][0],a[2][1],c)):new d({points:a.paths[0],spatialReference:c.toJSON()})}});return c.mixin(m,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,
UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,
UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,
UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",
UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"}),m})},"esri/tasks/Task":function(){define(["dojo/_base/lang","../core/Accessor","../core/urlUtils"],function(m,l,h){return l.createSubclass({declaredClass:"esri.tasks.Task",normalizeCtorArgs:function(d,b){if("string"!=typeof d)return d;var g={};return d&&(g.url=d),b&&m.mixin(g,b),g},properties:{normalization:{value:!0},parsedUrl:{value:null,readOnly:!0,dependsOn:["url"],
get:function(){return this._parseUrl(this.url)}},requestOptions:{value:null},url:{value:null,type:String}},_parseUrl:function(d){return d?h.urlToObject(d):null},_useSSL:function(){var d=this.parsedUrl,b=/^http:/i;this.url&&this.set("url",this.url.replace(b,"https:"));d&&d.path&&(d.path=d.path.replace(b,"https:"))},_encode:function(d,b,g){var k,f,a,e,c,h={};for(a in d)if("declaredClass"!==a&&(k=d[a],f=typeof k,null!==k&&void 0!==k&&"function"!==f))if(m.isArray(k))for(h[a]=[],c=k.length,e=0;c>e;e++)h[a][e]=
this._encode(k[e]);else"object"===f?k.toJSON&&(e=k.toJSON(g&&g[a]),"esri.tasks.support.FeatureSet"===k.declaredClass&&e.spatialReference&&(e.sr=e.spatialReference,delete e.spatialReference),h[a]=b?e:JSON.stringify(e)):h[a]=k;return h}})})},"esri/tasks/support/ProjectParameters":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/lang ../../geometry/support/jsonUtils ../../core/JSONSupport ../../core/Logger".split(" "),
function(m,l,h,d,b,g,k,f,a){var e=a.getLogger("esri.tasks.support.ProjectParameters");return function(a){function c(b){b=a.call(this)||this;return b.geometries=null,b.outSpatialReference=null,b.transformation=null,b.transformForward=null,b}return h(c,a),Object.defineProperty(c.prototype,"outSR",{get:function(){return e.warn("ProjectParameters.outSR is deprecated. Use outSpatialReference instead."),this.outSpatialReference},set:function(a){e.warn("ProjectParameters.outSR is deprecated. Use outSpatialReference instead.");
this.outSpatialReference=a},enumerable:!0,configurable:!0}),c.prototype.toJSON=function(){var a=this.geometries.map(function(a){return a.toJSON()}),b=this.geometries[0],c={};return c.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),c.inSR=b.spatialReference.wkid||JSON.stringify(b.spatialReference.toJSON()),c.geometries=JSON.stringify({geometryType:k.getJsonType(b),geometries:a}),this.transformation&&(c.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),
g.isDefined(this.transformForward)&&(c.transformForward=this.transformForward),c},d([b.property()],c.prototype,"geometries",void 0),d([b.property({json:{read:{source:"outSR"}}})],c.prototype,"outSpatialReference",void 0),d([b.property({json:{read:!1}})],c.prototype,"outSR",null),d([b.property()],c.prototype,"transformation",void 0),d([b.property()],c.prototype,"transformForward",void 0),c=d([b.subclass("esri.tasks.support.ProjectParameters")],c)}(b.declared(f))})},"esri/views/ViewAnimation":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators dojo/Deferred ../core/Accessor ../core/Promise ../core/Scheduler ../core/Error ../core/promiseUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){m=function(f){function k(a){a=f.call(this)||this;return a.state="running",a.target=null,a}return h(k,f),k.prototype.initialize=function(){this._dfd=new g;this.addResolvingPromise(this._dfd.promise)},Object.defineProperty(k.prototype,"done",{get:function(){return"finished"===this.state||"stopped"===this.state},enumerable:!0,configurable:!0}),k.prototype.stop=function(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),a.schedule(this._dfd.reject.bind(this._dfd,
new e("ViewAnimation stopped"))))},k.prototype.finish=function(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),a.schedule(this._dfd.resolve))},k.prototype.update=function(a,b){b||(b=c.isThenable(a)?"waiting-for-target":"running");this._set("target",a);this._set("state",b)},d([b.property({readOnly:!0,dependsOn:["state"]})],k.prototype,"done",null),d([b.property({readOnly:!0,type:String})],k.prototype,"state",void 0),d([b.property()],k.prototype,"target",void 0),k=
d([b.subclass("esri.views.ViewAnimation")],k)}(b.declared(k,f));(m||(m={})).State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};return m})},"esri/views/2d/FrameTask":function(){define(["require","exports","../../core/Scheduler","./FrameBudget"],function(m,l,h,d){return function(){function b(b){var g=this;this.view=b;this._frameTaskHandle=null;this._budget=new d(6);this.budget=6;this.updateEnabled=this.stationary=!0;this.prepare=function(){g._updateParameters.state=
g.view.state;g._updateParameters.stationary=g.view.stationary;g._updateParameters.devicePixelRatio=window.devicePixelRatio;g._budget.reset(g.budget)};this.update=function(){if(g.updateEnabled){for(var b=g._budget,a=g.view,e=a.allLayerViews.toArray().filter(function(a){return a.isFulfilled()&&null==a.layerViews}),c=e.length,d=a.state,k=0;k<e.length;k++)if(a=e[k],a.attached){var h=g._layerViewsState[a.uid];null!=h&&(g.stationary||a.moving)||(a.moving=!0,a.moveStart());h!==d.id&&a.viewChange();g.stationary&&
a.moving&&(a.moving=!1,a.moveEnd());g._layerViewsState[a.uid]=d.id}d=g._layerViewsTrash;for(k=0;k<d.length;k++)a=d[k],g._detachLayerView(a);for(k=d.length=0;c>k;k++)a=e[k],a.isFulfilled()&&!a.attached&&g._attachLayerView(a);e=g._layerViewsToUpdate;c=e.slice();a=g._updateParameters;for(g._layerViewsToUpdate.length=0;!b.done&&0<c.length;)c.shift().processUpdate(a);0<c.length&&e.unshift.apply(e,c);0===e.length&&0===d.length&&g._frameTaskHandle.pause()}};b.watch("ready",function(b){b?g.start():g.stop()})}
return b.prototype.destroy=function(){this.stop()},b.prototype.start=function(){var b=this;this._updateParameters={budget:this._budget,state:this.view.state,devicePixelRatio:window.devicePixelRatio,stationary:!0};this._layerViewsTrash=[];this._layerViewsToUpdate=[];this._layerViewsState={};this._allLayerViewsChangeHandle=this.view.allLayerViews.on("change",function(d){Array.prototype.push.apply(b._layerViewsTrash,d.removed);b.requestFrame()});this._stationaryHandle=this.view.watch("stationary",function(d){b.stationary=
d;b.requestFrame()});this._frameTaskHandle=h.addFrameTask(this)},b.prototype.stop=function(){var b=this;this._frameTaskHandle&&(this.view.allLayerViews.forEach(function(d){return b._detachLayerView(d)}),this._stationaryHandle.remove(),this._allLayerViewsChangeHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._allLayerViewsChangeHandle=this._frameTaskHandle=this._layerViewsTrash=this._layerViewsToUpdate=this._layerViewsState=null,this.stationary=!0)},
b.prototype.requestLayerViewUpdate=function(b){this._layerViewsToUpdate.push(b);this.requestFrame()},b.prototype.requestFrame=function(){this._frameTaskHandle&&this._frameTaskHandle.isPaused()&&this._frameTaskHandle.resume()},b.prototype._attachLayerView=function(b){b.attached||(b.attached=!0,b.moving=!1,b.attach())},b.prototype._detachLayerView=function(b){b.attached&&(b.detach(),b.attached=!1,b.moving=!1)},b}()})},"esri/views/2d/FrameBudget":function(){define(["require","exports","../../core/now"],
function(m,l,h){return function(){function d(b){void 0===b&&(b=Number.MAX_VALUE);this._budget=this._begin=0;this.enabled=!0;this.reset(b)}return d.now=function(){return h()},Object.defineProperty(d.prototype,"done",{get:function(){return this.enabled&&this.elapsed>=this._budget},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"elapsed",{get:function(){return h()-this._begin},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"remaining",{get:function(){return Math.max(this._budget-
this.elapsed,0)},enumerable:!0,configurable:!0}),d.prototype.reset=function(b){void 0===b&&(b=Number.MAX_VALUE);this._begin=h();this._budget=this.enabled?b:Number.MAX_VALUE},d}()})},"esri/views/2d/PaddedViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./viewpointUtils ./ViewState ./libs/gl-matrix/vec2 ./libs/gl-matrix/mat2d ./libs/gl-matrix/common ../../core/Accessor".split(" "),function(m,
l,h,d,b,g,k,f,a,e,c){var q=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;return b.left=0,b.top=0,b.right=0,b.bottom=0,b}return h(c,a),d([b.property()],c.prototype,"left",void 0),d([b.property()],c.prototype,"top",void 0),d([b.property()],c.prototype,"right",void 0),d([b.property()],c.prototype,"bottom",void 0),c=d([b.subclass("esri.views.2d.PaddedViewState.Padding")],c)}(b.declared(c));return function(c){function r(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];
a=c.apply(this,a)||this;return a.content=new k,a.padding=new q,a.size=f.fromValues(0,0),a}return h(r,c),Object.defineProperty(r.prototype,"clipRect",{get:function(){var b=this.worldScreenWidth;if(!b)return null;var c=e.toRadian(this.rotation),d=this.width*Math.abs(Math.cos(c))+this.height*Math.abs(Math.sin(c));if(b>d)return null;var g=f.clone(this.screenCenter),n=a.fromTranslation(a.create(),g);return a.rotate(n,n,c),f.negate(g,g),a.translate(n,n,g),f.transformMat2d(g,this.paddedScreenCenter,n),{top:-Math.round(d),
left:Math.round(g[0]-.5*b),right:Math.round(g[0]+.5*b),bottom:+Math.round(d)}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"padding",{set:function(a){this._set("padding",a||new q);this._updateContent()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"size",{set:function(a){this._set("size",a);this._updateContent()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paddedScreenCenter",{get:function(){var a=this.content.size,b=this.padding,a=
f.scale(f.create(),a,.5);return a[0]+=b.left,a[1]+=b.top,a},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"viewpoint",{set:function(a){var b=a.clone();this.content.viewpoint=a;g.addPadding(b,a,this._get("size"),this._get("padding"));this._set("viewpoint",g.addPadding(b.clone(),a,this._get("size"),this._get("padding")))},enumerable:!0,configurable:!0}),r.prototype._updateContent=function(){var a=f.create(),b=this._get("size"),c=this._get("padding");if(b&&c){var e=this.content;f.set(a,
c.left+c.right,c.top+c.bottom);f.subtract(a,b,a);e.size=a;(a=e.viewpoint)&&(this.viewpoint=a)}},d([b.shared({transform:{dependsOn:["padding"]}})],r.prototype,"properties",void 0),d([b.property({dependsOn:["worldScreenWidth","rotation","paddedScreenCenter","screenCenter"],readOnly:!0})],r.prototype,"clipRect",null),d([b.property()],r.prototype,"content",void 0),d([b.property({type:q})],r.prototype,"padding",null),d([b.property()],r.prototype,"size",null),d([b.property({dependsOn:["size","padding"],
readOnly:!0})],r.prototype,"paddedScreenCenter",null),d([b.property()],r.prototype,"viewpoint",null),r=d([b.subclass("esri.views.2d.PaddedViewState")],r)}(b.declared(k))})},"esri/views/2d/viewpointUtils":function(){define("require exports ./libs/gl-matrix/common ./libs/gl-matrix/mat2d ./libs/gl-matrix/vec2 ../../Viewpoint ../../core/promiseUtils ../../core/Error ../../geometry/SpatialReference ../../geometry/Geometry ../../geometry/Point ../../geometry/Extent ../../geometry/support/webMercatorUtils ../../geometry/support/scaleUtils ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){function x(a,c,e,p){p&&e&&!p.equals(e)&&t.canProject(p,e)&&p.isWebMercator?p.isWebMercator?(e=c[1],a=(89.99999<e?e=89.99999:-89.99999>e&&(e=-89.99999),e=Math.sin(h.toRadian(e)),b.set(a,h.toRadian(c[0])*O,.5*O*Math.log((1+e)/(1-e))))):(e=h.toDegree(c[0]/O),a=b.set(a,e-360*Math.floor((e+180)/360),h.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*c[1]/O))))):a=b.copy(a,c);return a}function y(b){return b.wkid?b:b.spatialReference||a.WGS84}function n(a,c){return c.type?
b.set(a,c.x,c.y):b.copy(a,c)}function w(a,b){return Math.max(a.width/b[0],a.height/b[1])*R(a.spatialReference)}function z(a,b,d){var p;if(!a)return null;if(Array.isArray(a)&&2===a.length&&"number"==typeof a[0]&&"number"==typeof a[1])return new c(a);if(a.reduce)return a.reduce(function(a,c){return z(c,b,a)},d);if(a instanceof e?p=a:a.geometry&&(p=a.geometry),!p)return null;var f;if(f="point"===p.type?new q({xmin:p.x,ymin:p.y,xmax:p.x,ymax:p.y,spatialReference:p.spatialReference}):p.extent,!f)return null;
a=t.canProject(f,b);if(!f.spatialReference.equals(b)&&a)f=t.project(f,b);else if(!a)return null;return d=d?d.union(f):f.clone()}function C(a,e){if(!a)return new g({targetGeometry:new c,scale:0,rotation:0});var d=e.spatialReference,p=e.size,f=e.viewpoint,K=e.constraints,k=null;"esri.Viewpoint"===a.declaredClass?k=a:a.viewpoint?k=a.viewpoint:a.target&&"esri.Viewpoint"===a.target.declaredClass&&(k=a.target);var h=null;k&&k.targetGeometry?h=k.targetGeometry:a instanceof q?h=a:(a||a&&(a.hasOwnProperty("center")||
a.hasOwnProperty("extent")||a.hasOwnProperty("target")))&&(h=z(a.center,d)||z(a.extent,d)||z(a.target,d)||z(a,d));!h&&f&&f.targetGeometry?h=f.targetGeometry:!h&&e.extent&&(h=e.extent);var H=y(h);if(d||(d=y(e.spatialReference||e.extent||h)),!v.canProject(h,d)&&H&&!H.equals(d))return null;var r=n(b.create(),h.center?h.center:h),H=new c(x(r,r,H,d),d),r=null,r=k&&k.targetGeometry&&"point"===k.targetGeometry.type?k.scale:a.hasOwnProperty("scale")&&a.scale?a.scale:a.hasOwnProperty("zoom")&&-1!==a.zoom&&
K&&K.effectiveLODs?K.zoomToScale(a.zoom):Array.isArray(h)||"point"===h.type||"extent"===h.type&&0===h.width&&0===h.height?e.extent&&t.canProject(e.extent,d)?w(t.project(e.extent,d),p):e.extent?w(e.extent,p):f.scale:t.canProject(h.extent,d)?w(t.project(h.extent,d),p):w(h.extent,p);e=0;k?e=k.rotation:a.hasOwnProperty("rotation")?e=a.rotation:f&&(e=f.rotation);a=new g({targetGeometry:H,scale:r,rotation:e});return K&&(a=K.fit(a),K.rotationEnabled||(a.rotation=0)),a}function B(a,b){var c=a.targetGeometry,
p=b.targetGeometry;return c.x=p.x,c.y=p.y,c.spatialReference=p.spatialReference,a.scale=b.scale,a.rotation=b.rotation,a}function F(a,c,e){return e?b.set(a,.5*(c[0]-e.right+e.left),.5*(c[1]-e.bottom+e.top)):b.scale(a,c,.5)}function G(a,b,c,p){return l.getTransform(a,b,c,p),d.invert(a,a)}function N(a,c,e){var p=h.toRadian(c.rotation)||0;c=Math.abs(Math.cos(p));p=Math.abs(Math.sin(p));return b.set(a,Math.round(e[1]*p+e[0]*c),Math.round(e[1]*c+e[0]*p))}function M(a){return a.scale*(1/(r.getMetersPerUnitForSR(a.targetGeometry.spatialReference)*
T*96))}function R(a){return r.getMetersPerUnitForSR(a)*T*96}function P(a){return a.isWrappable?(a=u.getInfo(a),a.valid[1]-a.valid[0]):0}function Q(a,b){return Math.round(P(a)/b)}Object.defineProperty(l,"__esModule",{value:!0});var T=39.37,O=6378137,S=180/Math.PI;l.extentToScale=w;l.create=C;l.copy=B;l.getAnchor=F;l.getExtent=function(){var a=b.create();return function(b,c,p){var e=c.targetGeometry;n(a,e);c=.5*M(c);return b.xmin=a[0]-c*p[0],b.ymin=a[1]-c*p[1],b.xmax=a[0]+c*p[0],b.ymax=a[1]+c*p[1],
b.spatialReference=e.spatialReference,b}}();l.setExtent=function(a,b,c,p,e){return l.centerAt(a,b,c.center),a.scale=w(c,p),e&&e.constraints&&e.constraints.constrain(a),a};l.getOuterExtent=function(){var a=b.create(),c=b.create();return function(b,p,e){n(a,p.targetGeometry);N(c,p,e);e=.5*M(p);return b.set({xmin:a[0]-e*c[0],ymin:a[1]-e*c[1],xmax:a[0]+e*c[0],ymax:a[1]+e*c[1],spatialReference:p.targetGeometry.spatialReference}),b}}();l.getClippedExtent=function(){var a=b.create(),c=b.create();return function(b,
p,e){var d=M(p),f=p.targetGeometry.spatialReference,A=Q(f,d);n(a,p.targetGeometry);N(c,p,e);f.isWrappable&&c[0]>A&&(c[0]=A);p=.5*d;return b.set({xmin:a[0]-p*c[0],ymin:a[1]-p*c[1],xmax:a[0]+p*c[0],ymax:a[1]+p*c[1],spatialReference:f}),b}}();l.getOuterSize=N;l.getPaddingScreenTranslation=function(){var a=b.create();return function(c,e,p){return b.sub(c,b.scale(c,e,.5),F(a,e,p))}}();var H=function(){var a=d.create(),c=b.create();return function(e,p,f,g){var A=M(p);p=h.toRadian(p.rotation)||0;return b.set(c,
A,A),d.fromScaling(a,c),d.rotate(a,a,p),d.translate(a,a,l.getPaddingScreenTranslation(c,f,g)),d.translate(a,a,[0,g.top-g.bottom]),b.set(e,a[4],a[5])}}();l.getResolution=M;l.getResolutionToScaleFactor=R;l.getMatrix=function(){var a=b.create(),c=b.create(),e=b.create();return function(p,f,g,E,n,k){return b.negate(a,f),b.scale(c,g,.5*k),b.set(e,1/E*k,-1/E*k),d.identity(p),d.translate(p,p,c),n&&d.rotate(p,p,n),d.scale(p,p,e),d.translate(p,p,a),p}}();l.getTransform=function(){var a=b.create();return function(b,
c,p,e){var d=M(c),f=h.toRadian(c.rotation)||0;return n(a,c.targetGeometry),l.getMatrix(b,a,p,d,f,e)}}();l.getTransformNoRotation=function(){var a=b.create();return function(b,c,p,e){var d=M(c);return n(a,c.targetGeometry),l.getMatrix(b,a,p,d,0,e)}}();l.getWorldWidth=P;l.getWorldScreenWidth=Q;l.createAsync=function(a,b){if(a=C(a,b))return k.resolve(a);a=new f("viewpointUtils-createAsync:different-spatialReference","Target spatialReference cannot be projected and is different from out spatialReference");
return k.reject(a)};l.angleBetween=function(){var a=b.create(),c=b.create(),e=b.create();return function(p,d,f){b.subtract(a,p,d);b.normalize(a,a);b.subtract(c,p,f);b.normalize(c,c);b.cross(e,a,c);p=Math.acos(b.dot(a,c)/(b.length(a)*b.length(c)))*S;return 0>e[2]&&(p=-p),isNaN(p)&&(p=0),p}}();l.addPadding=function(){var a=b.create();return function(b,c,p,e){var d=b.targetGeometry;return B(b,c),H(a,c,p,e),d.x+=a[0],d.y+=a[1],b}}();l.removePadding=function(){var a=b.create();return function(b,c,p,e){var d=
b.targetGeometry;return B(b,c),H(a,c,p,e),d.x-=a[0],d.y-=a[1],b}}();l.centerAt=function(){var a=b.create();return function(b,c,p){B(b,c);c=b.targetGeometry;var e=y(p),d=y(c);return n(a,p),x(a,a,e,d),c.x=a[0],c.y=a[1],b}}();l.pixelSizeAt=function(a,b,c){return M(b)};l.resize=function(){var a=b.create();return function(c,e,p,d,f){f||(f="center");b.sub(a,p,d);b.scale(a,a,.5);p=a[0];d=a[1];switch(f){case "center":b.set(a,0,0);break;case "left":b.set(a,-p,0);break;case "top":b.set(a,0,d);break;case "right":b.set(a,
p,0);break;case "bottom":b.set(a,0,-d);break;case "top-left":b.set(a,-p,d);break;case "bottom-left":b.set(a,-p,-d);break;case "top-right":b.set(a,p,d);break;case "bottom-right":b.set(a,p,-d)}return l.translateBy(c,e,a),c}}();l.rotateBy=function(a,b,c){return B(a,b),a.rotation+=c,a};l.rotateTo=function(a,b,c){return B(a,b),a.rotation=c,a};l.scaleBy=function(){var a=b.create();return function(c,e,p,d,f){return B(c,e),0!==p&&(l.toMap(a,d,e,f),c.scale=e.scale*p,l.toScreen(a,a,c,f),l.translateBy(c,c,b.set(a,
a[0]-d[0],d[1]-a[1]))),c}}();l.scaleTo=function(a,b,c){return B(a,b),a.scale=c,a};l.scaleAndRotateBy=function(){var a=b.create();return function(c,e,p,d,f,g){return B(c,e),0!==p&&(l.toMap(a,f,e,g),c.scale=e.scale*p,c.rotation+=d,l.toScreen(a,a,c,g),l.translateBy(c,c,b.set(a,a[0]-f[0],f[1]-a[1]))),c}}();l.padAndScaleAndRotateBy=function(){var a=b.create(),c=b.create();return function(e,p,d,f,g,n,k){return l.getPaddingScreenTranslation(c,n,k),b.add(a,g,c),f?l.scaleAndRotateBy(e,p,d,f,a,n):l.scaleBy(e,
p,d,a,n)}}();l.toMap=function(){var a=d.create();return function(c,e,p,d){return b.transformMat2d(c,e,G(a,p,d,1))}}();l.toScreen=function(){var a=d.create();return function(c,e,p,d){return b.transformMat2d(c,e,l.getTransform(a,p,d,1))}}();l.translateBy=function(){var a=b.create(),c=d.create();return function(e,p,f){B(e,p);var A=M(p),g=e.targetGeometry;return d.fromRotation(c,h.toRadian(p.rotation)||0),d.scale(c,c,b.fromValues(A,A)),b.transformMat2d(a,f,c),g.x+=a[0],g.y+=a[1],e}}()})},"esri/views/2d/libs/gl-matrix/common":function(){define([],
function(){if(!m)var m=1E-6;if(!l)var l="undefined"!=typeof Float32Array?Float32Array:Array;if(!h)var h=Math.random;var d={GLMAT_EPSILON:m,GLMAT_ARRAY_TYPE:l,GLMAT_RANDOM:h,setMatrixArrayType:function(b){d.GLMAT_ARRAY_TYPE=b}},b=Math.PI/180,g=180/Math.PI;return d.toRadian=function(d){return d*b},d.toDegree=function(b){return b*g},d.setMatrixArrayType(Array),d})},"esri/views/2d/libs/gl-matrix/mat2d":function(){define(["./common"],function(m){var l=m.GLMAT_ARRAY_TYPE;m={};return m.create=function(){var h=
new l(6);return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},m.clone=function(h){var d=new l(6);return d[0]=h[0],d[1]=h[1],d[2]=h[2],d[3]=h[3],d[4]=h[4],d[5]=h[5],d},m.copy=function(h,d){return h[0]=d[0],h[1]=d[1],h[2]=d[2],h[3]=d[3],h[4]=d[4],h[5]=d[5],h},m.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},m.invert=function(h,d){var b=d[0],g=d[1],k=d[2],f=d[3],a=d[4];d=d[5];var e=b*f-g*k;return e?(e=1/e,h[0]=f*e,h[1]=-g*e,h[2]=-k*e,h[3]=b*e,h[4]=(k*d-f*a)*e,h[5]=(g*a-b*d)*
e,h):null},m.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},m.multiply=function(h,d,b){var g=d[0],k=d[1],f=d[2],a=d[3],e=d[4];d=d[5];var c=b[0],q=b[1],l=b[2],r=b[3],u=b[4];b=b[5];return h[0]=g*c+f*q,h[1]=k*c+a*q,h[2]=g*l+f*r,h[3]=k*l+a*r,h[4]=g*u+f*b+e,h[5]=k*u+a*b+d,h},m.mul=m.multiply,m.rotate=function(h,d,b){var g=d[0],k=d[1],f=d[2],a=d[3],e=d[4];d=d[5];var c=Math.sin(b);b=Math.cos(b);return h[0]=g*b+f*c,h[1]=k*b+a*c,h[2]=g*-c+f*b,h[3]=k*-c+a*b,h[4]=e,h[5]=d,h},m.scale=function(h,d,b){var g=
d[1],k=d[2],f=d[3],a=d[4],e=d[5],c=b[0];b=b[1];return h[0]=d[0]*c,h[1]=g*c,h[2]=k*b,h[3]=f*b,h[4]=a,h[5]=e,h},m.translate=function(h,d,b){var g=d[0],k=d[1],f=d[2],a=d[3],e=d[4];d=d[5];var c=b[0];b=b[1];return h[0]=g,h[1]=k,h[2]=f,h[3]=a,h[4]=g*c+f*b+e,h[5]=k*c+a*b+d,h},m.fromRotation=function(h,d){var b=Math.sin(d);d=Math.cos(d);return h[0]=d,h[1]=b,h[2]=-b,h[3]=d,h[4]=0,h[5]=0,h},m.fromScaling=function(h,d){return h[0]=d[0],h[1]=0,h[2]=0,h[3]=d[1],h[4]=0,h[5]=0,h},m.fromTranslation=function(h,d){return h[0]=
1,h[1]=0,h[2]=0,h[3]=1,h[4]=d[0],h[5]=d[1],h},m.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},m.frob=function(h){return Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2)+Math.pow(h[2],2)+Math.pow(h[3],2)+Math.pow(h[4],2)+Math.pow(h[5],2)+1)},m})},"esri/views/2d/libs/gl-matrix/vec2":function(){define(["./common"],function(m){var l=m.GLMAT_ARRAY_TYPE,h=m.GLMAT_RANDOM,d={};return d.create=function(){var b=new l(2);return b[0]=0,b[1]=0,b},d.clone=function(b){var d=
new l(2);return d[0]=b[0],d[1]=b[1],d},d.fromValues=function(b,d){var g=new l(2);return g[0]=b,g[1]=d,g},d.copy=function(b,d){return b[0]=d[0],b[1]=d[1],b},d.set=function(b,d,k){return b[0]=d,b[1]=k,b},d.add=function(b,d,k){return b[0]=d[0]+k[0],b[1]=d[1]+k[1],b},d.subtract=function(b,d,k){return b[0]=d[0]-k[0],b[1]=d[1]-k[1],b},d.sub=d.subtract,d.multiply=function(b,d,k){return b[0]=d[0]*k[0],b[1]=d[1]*k[1],b},d.mul=d.multiply,d.divide=function(b,d,k){return b[0]=d[0]/k[0],b[1]=d[1]/k[1],b},d.div=
d.divide,d.min=function(b,d,k){return b[0]=Math.min(d[0],k[0]),b[1]=Math.min(d[1],k[1]),b},d.max=function(b,d,k){return b[0]=Math.max(d[0],k[0]),b[1]=Math.max(d[1],k[1]),b},d.scale=function(b,d,k){return b[0]=d[0]*k,b[1]=d[1]*k,b},d.scaleAndAdd=function(b,d,k,f){return b[0]=d[0]+k[0]*f,b[1]=d[1]+k[1]*f,b},d.distance=function(b,d){var g=d[0]-b[0];b=d[1]-b[1];return Math.sqrt(g*g+b*b)},d.dist=d.distance,d.squaredDistance=function(b,d){var g=d[0]-b[0];b=d[1]-b[1];return g*g+b*b},d.sqrDist=d.squaredDistance,
d.length=function(b){var d=b[0];b=b[1];return Math.sqrt(d*d+b*b)},d.len=d.length,d.squaredLength=function(b){var d=b[0];b=b[1];return d*d+b*b},d.sqrLen=d.squaredLength,d.negate=function(b,d){return b[0]=-d[0],b[1]=-d[1],b},d.inverse=function(b,d){return b[0]=1/d[0],b[1]=1/d[1],b},d.normalize=function(b,d){var g=d[0],f=d[1],g=g*g+f*f;return 0<g&&(g=1/Math.sqrt(g),b[0]=d[0]*g,b[1]=d[1]*g),b},d.dot=function(b,d){return b[0]*d[0]+b[1]*d[1]},d.cross=function(b,d,k){d=d[0]*k[1]-d[1]*k[0];return b[0]=b[1]=
0,b[2]=d,b},d.lerp=function(b,d,k,f){var a=d[0];d=d[1];return b[0]=a+f*(k[0]-a),b[1]=d+f*(k[1]-d),b},d.random=function(b,d){d=d||1;var g=2*h()*Math.PI;return b[0]=Math.cos(g)*d,b[1]=Math.sin(g)*d,b},d.transformMat2=function(b,d,k){var f=d[0];d=d[1];return b[0]=k[0]*f+k[2]*d,b[1]=k[1]*f+k[3]*d,b},d.transformMat2d=function(b,d,k){var f=d[0];d=d[1];return b[0]=k[0]*f+k[2]*d+k[4],b[1]=k[1]*f+k[3]*d+k[5],b},d.transformMat3=function(b,d,k){var f=d[0];d=d[1];return b[0]=k[0]*f+k[3]*d+k[6],b[1]=k[1]*f+k[4]*
d+k[7],b},d.transformMat4=function(b,d,k){var f=d[0];d=d[1];return b[0]=k[0]*f+k[4]*d+k[12],b[1]=k[1]*f+k[5]*d+k[13],b},d.forEach=function(){var b=d.create();return function(d,k,f,a,e,c){k||(k=2);f||(f=0);for(a=a?Math.min(a*k+f,d.length):d.length;a>f;f+=k)b[0]=d[f],b[1]=d[f+1],e(b,b,c),d[f]=b[0],d[f+1]=b[1];return d}}(),d.str=function(b){return"vec2("+b[0]+", "+b[1]+")"},d})},"esri/views/2d/ViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../geometry/Extent ./viewpointUtils ./libs/gl-matrix/vec2 ./libs/gl-matrix/mat2d".split(" "),
function(m,l,h,d,b,g,k,f,a,e){return function(c){function g(){var a=null!==c&&c.apply(this,arguments)||this;return a.pixelRatio=1,a.size=[0,0],a}return h(g,c),l=g,Object.defineProperty(g.prototype,"center",{get:function(){var b=this.viewpoint.targetGeometry;return a.set(a.create(),b.x,b.y)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"extent",{get:function(){return f.getExtent(new k,this.viewpoint,this.size)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,
"height",{get:function(){return this.size?this.size[1]:0},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"id",{get:function(){return this._get("id")+1},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"inverseTransform",{get:function(){return e.invert(e.create(),this.transform)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"latitude",{get:function(){return this.viewpoint.targetGeometry.latitude},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,
"longitude",{get:function(){return this.viewpoint.targetGeometry.longitude},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"resolution",{get:function(){return f.getResolution(this.viewpoint)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"rotation",{get:function(){return this.viewpoint.rotation},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"scale",{get:function(){return this.viewpoint.scale},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,
"screenCenter",{get:function(){return a.scale(a.create(),this.size,.5)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"spatialReference",{get:function(){return this.viewpoint.targetGeometry.spatialReference},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"transform",{get:function(){return f.getTransform(e.create(),this.viewpoint,this.size,this.pixelRatio)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"transformNoRotation",{get:function(){return f.getTransformNoRotation(e.create(),
this.viewpoint,this.size,this.pixelRatio)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"clippedExtent",{get:function(){return f.getClippedExtent(new k,this.viewpoint,this.size)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"width",{get:function(){return this.size?this.size[0]:0},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"worldScreenWidth",{get:function(){return f.getWorldScreenWidth(this.spatialReference,this.resolution)},enumerable:!0,
configurable:!0}),Object.defineProperty(g.prototype,"worldWidth",{get:function(){return f.getWorldWidth(this.spatialReference)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"wrappable",{get:function(){return!!this.spatialReference&&this.spatialReference.isWrappable},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"x",{get:function(){return this.center[0]},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"y",{get:function(){return this.center[1]},
enumerable:!0,configurable:!0}),g.prototype.copy=function(b){return this.viewpoint&&this.size?(this._set("viewpoint",f.copy(this.viewpoint,b.viewpoint)),this._set("size",a.copy(this.size,b.size))):(this.viewpoint=b.viewpoint.clone(),a.copy(this.size,b.size)),this._set("pixelRatio",b.pixelRatio),this},g.prototype.clone=function(){return new l({viewpoint:this.viewpoint.clone(),size:a.clone(this.size)})},g.prototype.toMap=function(b,c){return a.transformMat2d(b,c,this.inverseTransform)},g.prototype.toScreen=
function(b,c){return a.transformMat2d(b,c,this.transform)},g.prototype.pixelSizeAt=function(a){return f.pixelSizeAt(a,this.viewpoint,this.size)},d([b.property({dependsOn:["viewpoint"]})],g.prototype,"center",null),d([b.property({readOnly:!0,dependsOn:["viewpoint","size"]})],g.prototype,"extent",null),d([b.property({readOnly:!0,dependsOn:["size"]})],g.prototype,"height",null),d([b.property({value:0,readOnly:!0,dependsOn:["transform"]})],g.prototype,"id",null),d([b.property({readOnly:!0,dependsOn:["transform"]})],
g.prototype,"inverseTransform",null),d([b.property({readOnly:!0,dependsOn:["viewpoint"]})],g.prototype,"latitude",null),d([b.property({readOnly:!0,dependsOn:["viewpoint"]})],g.prototype,"longitude",null),d([b.property()],g.prototype,"pixelRatio",void 0),d([b.property({readOnly:!0,dependsOn:["viewpoint"]})],g.prototype,"resolution",null),d([b.property({readOnly:!0,dependsOn:["viewpoint"]})],g.prototype,"rotation",null),d([b.property({readOnly:!0,dependsOn:["viewpoint"]})],g.prototype,"scale",null),
d([b.property({readOnly:!0,dependsOn:["size"]})],g.prototype,"screenCenter",null),d([b.property()],g.prototype,"size",void 0),d([b.property({readOnly:!0,dependsOn:["viewpoint"]})],g.prototype,"spatialReference",null),d([b.property({readOnly:!0,dependsOn:["viewpoint","size","pixelRatio"]})],g.prototype,"transform",null),d([b.property({readOnly:!0,dependsOn:["viewpoint","size","pixelRatio"]})],g.prototype,"transformNoRotation",null),d([b.property()],g.prototype,"viewpoint",void 0),d([b.property({readOnly:!0,
dependsOn:["viewpoint","size"]})],g.prototype,"clippedExtent",null),d([b.property({readOnly:!0,dependsOn:["size"]})],g.prototype,"width",null),d([b.property({readOnly:!0,dependsOn:["worldWidth","resolution"]})],g.prototype,"worldScreenWidth",null),d([b.property({readOnly:!0,dependsOn:["spatialReference"]})],g.prototype,"worldWidth",null),d([b.property({readOnly:!0,dependsOn:["spatialReference"]})],g.prototype,"wrappable",null),d([b.property({readOnly:!0,dependsOn:["center"]})],g.prototype,"x",null),
d([b.property({readOnly:!0,dependsOn:["center"]})],g.prototype,"y",null),g=l=d([b.subclass("esri.views.2d.ViewState")],g);var l}(b.declared(g))})},"esri/views/2d/MapViewConstraints":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Evented ../../layers/support/LOD ./constraints/ZoomConstraint ./constraints/RotationConstraint".split(" "),function(m,l,h,d,b,g,k,f,a,e){return function(c){function g(){var a=
null!==c&&c.apply(this,arguments)||this;return a.enabled=!0,a.lods=null,a.minScale=0,a.maxScale=0,a.minZoom=-1,a.maxZoom=-1,a.rotationEnabled=!0,a.snapToZoom=!0,a}return h(g,c),g.prototype.initialize=function(){this.watch("_zoom, _rotation",this.emit.bind(this,"update"),!0)},g.prototype.destroy=function(){this.view=null;this._set("_zoom",null);this._set("_rotation",null)},Object.defineProperty(g.prototype,"_rotation",{get:function(){return new e({rotationEnabled:this.rotationEnabled})},enumerable:!0,
configurable:!0}),Object.defineProperty(g.prototype,"_defaultLODs",{get:function(){var a=this.get("view.defaultsFromMap.tileInfo"),b=this.get("view.spatialReference");return a&&b&&a.spatialReference.equals(b)?a.lods:null},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"_zoom",{get:function(){return new a({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})},enumerable:!0,configurable:!0}),
g.prototype.canZoomInTo=function(a){var b=this.effectiveMaxScale;return 0===b||a>=b},g.prototype.canZoomOutTo=function(a){var b=this.effectiveMinScale;return 0===b||b>=a},g.prototype.constrain=function(a,b){return this.enabled?(this._zoom.constrain(a,b),this._rotation.constrain(a,b),a):a},g.prototype.fit=function(a){return this.enabled&&this.snapToZoom?(this._zoom.fit(a),a):a},g.prototype.zoomToScale=function(a){return this._zoom.zoomToScale(a)},g.prototype.scaleToZoom=function(a){return this._zoom.scaleToZoom(a)},
g.prototype.snapScale=function(a){return this._zoom.snapToClosestScale(a)},g.prototype.snapToNextScale=function(a){return this._zoom.snapToNextScale(a)},g.prototype.snapToPreviousScale=function(a){return this._zoom.snapToPreviousScale(a)},d([b.property({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],g.prototype,"effectiveLODs",void 0),d([b.property({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],g.prototype,"effectiveMinScale",void 0),d([b.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"})],
g.prototype,"effectiveMaxScale",void 0),d([b.property({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],g.prototype,"effectiveMinZoom",void 0),d([b.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],g.prototype,"effectiveMaxZoom",void 0),d([b.property()],g.prototype,"enabled",void 0),d([b.property({type:[f]})],g.prototype,"lods",void 0),d([b.property()],g.prototype,"minScale",void 0),d([b.property()],g.prototype,"maxScale",void 0),d([b.property()],g.prototype,"minZoom",void 0),d([b.property()],
g.prototype,"maxZoom",void 0),d([b.property()],g.prototype,"rotationEnabled",void 0),d([b.property()],g.prototype,"snapToZoom",void 0),d([b.property()],g.prototype,"view",void 0),d([b.property({type:e,dependsOn:["rotationEnabled"]})],g.prototype,"_rotation",null),d([b.property({dependsOn:["view.spatialReference","view.defaultsFromMap.tileInfo"]})],g.prototype,"_defaultLODs",null),d([b.property({readOnly:!0,type:a,dependsOn:"lods minZoom maxZoom minScale maxScale snapToZoom _defaultLODs".split(" ")})],
g.prototype,"_zoom",null),g=d([b.subclass("esri.views.2d.MapViewConstraints")],g)}(b.declared(g,k))})},"esri/views/2d/constraints/ZoomConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../layers/support/LOD".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;return a._lodByScale={},a._scales=
[],a.effectiveLODs=null,a.effectiveMinZoom=-1,a.effectiveMaxZoom=-1,a.effectiveMinScale=0,a.effectiveMaxScale=0,a.enabled=!0,a.lods=null,a.minZoom=-1,a.maxZoom=-1,a.minScale=0,a.maxScale=0,a.snapToZoom=!0,a}return h(a,f),e=a,a.prototype.initialize=function(){var a=this,b=this.lods,e=this.minScale,d=this.maxScale,f=this.minZoom,g=this.maxZoom,k=-1,h=-1,n=!1,l=!1;if(0!==e&&0!==d&&d>e&&(C=[d,e],e=C[0],d=C[1]),!b||!b.length)return this._set("effectiveMinScale",e),void this._set("effectiveMaxScale",d);
b=b.map(function(a){return a.clone()});b.sort(function(a,b){return b.scale-a.scale});b.forEach(function(a,b){return a.level=b});for(var m,C=0,B=b;C<B.length;C++){var F=B[C];!n&&0<e&&e>=F.scale&&(k=F.level,n=!0);!l&&0<d&&d>=F.scale&&(h=m?m.level:-1,l=!0);m=F}-1===f&&(f=0===e?0:k);-1===g&&(g=0===d?b.length-1:h);f=Math.max(f,0);f=Math.min(f,b.length-1);g=Math.max(g,0);g=Math.min(g,b.length-1);f>g&&(G=[g,f],f=G[0],g=G[1]);e=b[f].scale;d=b[g].scale;b.splice(0,f);b.splice(g-f+1,b.length);b.forEach(function(b,
c){a._lodByScale[b.scale]=b;a._scales[c]=b.scale});this._set("effectiveLODs",b);this._set("effectiveMinZoom",f);this._set("effectiveMaxZoom",g);this._set("effectiveMinScale",e);this._set("effectiveMaxScale",d);var C,G},a.prototype.constrain=function(a,b){if(!this.enabled||b&&a.scale===b.scale)return a;var c=this.effectiveMinScale,e=this.effectiveMaxScale,d=a.targetGeometry,f=b&&b.targetGeometry,g=0!==c&&a.scale>c;if(0!==e&&a.scale<e||g)c=g?c:e,f&&(b=(c-b.scale)/(a.scale-b.scale),d.x=f.x+(d.x-f.x)*
b,d.y=f.y+(d.y-f.y)*b),a.scale=c;return this.snapToZoom&&this.effectiveLODs&&(a.scale=this._getClosestScale(a.scale)),a},a.prototype.fit=function(a){if(!this.effectiveLODs)return this.constrain(a,null);var b=a.scale,c=this.scaleToZoom(b);return.99<Math.abs(c-Math.round(c))?a.scale=this.snapToPreviousScale(b):a.scale=this.zoomToScale(Math.round(c)),a},a.prototype.zoomToScale=function(a){if(!this.effectiveLODs)return 0;a-=this.effectiveMinZoom;a=Math.max(0,a);var b=this._scales;if(0>=a)return b[0];
if(a>=b.length)return b[b.length-1];var c=Math.round(a);return b[c]+(c-a)*(b[Math.round(a-.5)]-b[c])},a.prototype.scaleToZoom=function(a){if(!this.effectiveLODs)return-1;var b,c,e=this._scales,d=0,f=e.length-1;for(d;f>d;d++){if(b=e[d],c=e[d+1],a>=b)return d+this.effectiveMinZoom;if(c===a)return d+1+this.effectiveMinZoom;if(b>a&&a>c)return d+1-(a-c)/(b-c)+this.effectiveMinZoom}return d},a.prototype.snapToClosestScale=function(a){if(!this.effectiveLODs)return a;a=this.scaleToZoom(a);return this.zoomToScale(Math.round(a))},
a.prototype.snapToNextScale=function(a,b){if(void 0===b&&(b=.5),!this.effectiveLODs)return a*b;a=Math.round(this.scaleToZoom(a));return this.zoomToScale(a+1)},a.prototype.snapToPreviousScale=function(a,b){if(void 0===b&&(b=2),!this.effectiveLODs)return a*b;a=Math.round(this.scaleToZoom(a));return this.zoomToScale(a-1)},a.prototype.clone=function(){return new e({enabled:this.enabled,lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})},a.prototype._getClosestScale=
function(a){return this._lodByScale[a]?this._lodByScale[a].scale:(a=this._scales.reduce(function(b,c,e,d){return Math.abs(c-a)<=Math.abs(b-a)?c:b},this._scales[0]),this._lodByScale[a].scale)},d([b.property({readOnly:!0})],a.prototype,"effectiveLODs",void 0),d([b.property({readOnly:!0})],a.prototype,"effectiveMinZoom",void 0),d([b.property({readOnly:!0})],a.prototype,"effectiveMaxZoom",void 0),d([b.property({readOnly:!0})],a.prototype,"effectiveMinScale",void 0),d([b.property({readOnly:!0})],a.prototype,
"effectiveMaxScale",void 0),d([b.property()],a.prototype,"enabled",void 0),d([b.property({type:[k]})],a.prototype,"lods",void 0),d([b.property()],a.prototype,"minZoom",void 0),d([b.property()],a.prototype,"maxZoom",void 0),d([b.property()],a.prototype,"minScale",void 0),d([b.property()],a.prototype,"maxScale",void 0),d([b.property()],a.prototype,"snapToZoom",void 0),a=e=d([b.subclass("esri.views.2d.constraints.ZoomConstraint")],a);var e}(b.declared(g))})},"esri/views/2d/constraints/RotationConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),
function(m,l,h,d,b,g){return function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;return a.enabled=!0,a.rotationEnabled=!0,a}return h(f,g),a=f,f.prototype.constrain=function(a,b){return this.enabled?(this.rotationEnabled||(a.rotation=0),a):a},f.prototype.clone=function(){return new a({enabled:this.enabled,rotationEnabled:this.rotationEnabled})},d([b.property()],f.prototype,"enabled",void 0),d([b.property()],f.prototype,"rotationEnabled",void 0),f=a=d([b.subclass("esri.views.2d.constraints.RotationConstraint")],
f);var a}(b.declared(g))})},"esri/views/2d/AnimationManager":function(){define("../../core/Accessor ../../core/Scheduler ../../core/now ../ViewAnimation ./unitBezier ./viewpointUtils".split(" "),function(m,l,h,d,b,g){var k=function(d,a,e,c){var f=d.targetGeometry,g=a.targetGeometry;c?"string"==typeof c&&(c=b.parse(c)||b.ease):c=b.ease;this.easing=c;this.duration=e;this.sCenterX=f.x;this.sCenterY=f.y;this.sScale=d.scale;this.sRotation=d.rotation;this.tCenterX=g.x;this.tCenterY=g.y;this.tScale=a.scale;
this.tRotation=a.rotation;this.dCenterX=this.tCenterX-this.sCenterX;this.dCenterY=this.tCenterY-this.sCenterY;this.dScale=this.tScale-this.sScale;this.dRotation=this.tRotation-this.sRotation;180<this.dRotation?this.dRotation-=360:-180>this.dRotation&&(this.dRotation+=360)};k.prototype.applyRatio=function(b,a){var e,c,d,f,g=this.easing(a);1<=a?(e=this.tCenterX,c=this.tCenterY,d=this.tRotation,f=this.tScale):(e=this.sCenterX+g*this.dCenterX,c=this.sCenterY+g*this.dCenterY,d=this.sRotation+g*this.dRotation,
f=this.sScale+g*this.dScale);b.targetGeometry.x=e;b.targetGeometry.y=c;b.scale=f;b.rotation=d};return m.createSubclass({constructor:function(){this._updateTask=l.addFrameTask({postRender:this._postRender.bind(this)});this._updateTask.pause()},getDefaults:function(){return{viewpoint:g.create()}},properties:{animation:null,duration:{value:200},transition:{value:null},easing:{value:b.ease},viewpoint:null},animate:function(b,a,e){this.stop();return g.copy(this.viewpoint,a),this.transition=new k(this.viewpoint,
b.target,e&&e.duration||this.duration,e&&e.easing||this.easing),b.always(function(){this.animation===b&&this._updateTask&&("finished"===b.state&&(this.transition.applyRatio(this.viewpoint,1),this.animation._dfd.progress(this.viewpoint)),this._updateTask.pause(),this.animation=null,this.updateFunction=null)}.bind(this)),this._startTime=h(),this._updateTask.resume(),this.animation=b,b},animateContinous:function(b,a){this.stop();this.updateFunction=a;this.viewpoint=b;var e=new d({target:b.clone()});
return e.always(function(){this.animation===e&&this._updateTask&&(this._updateTask.pause(),this.animation=null,this.updateFunction=null)}.bind(this)),this._startTime=h(),this._updateTask.resume(),this.animation=e,e},stop:function(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)},_postRender:function(b){var a=this.animation;if(!a||a.state===d.STOPPED)return void this._updateTask.pause();this.updateFunction?this.updateFunction(this.viewpoint,b.deltaTime):(b=(h()-
this._startTime)/this.transition.duration,a=1<=b,this.transition.applyRatio(this.viewpoint,b),a&&this.animation.finish());this.animation._dfd.progress(this.viewpoint)}})})},"esri/views/2d/unitBezier":function(){define([],function(){var m=function(h,d,b,g){function k(b,c){var d,g,k,n,h;c=null==c?1E-6:c;k=b;for(h=0;8>h;h++){if(n=((e*k+a)*k+f)*k-b,Math.abs(n)<c)return k;if(g=(3*e*k+2*a)*k+f,1E-6>Math.abs(g))break;k-=n/g}if(d=0,g=1,k=b,d>k)return d;if(k>g)return g;for(;g>d&&!(n=((e*k+a)*k+f)*k,Math.abs(n-
b)<c);)b>n?d=k:g=k,k=.5*(g-d)+d;return k}var f=3*h,a=3*(b-h)-f,e=1-f-a,c=3*d,q=3*(g-d)-c,l=1-c-q;return function(a,b){a=k(a,b);return((l*a+q)*a+c)*a}},l=/^cubic-bezier\((.*)\)/;return m.parse=function(h){var d=m[h]||null;!d&&(h=l.exec(h))&&(h=h[1].split(",").map(function(b){return parseFloat(b.trim())}),4!==h.length||h.some(function(b){return isNaN(b)})||(d=m.apply(m,h)));return d},m.ease=m(.25,.1,.25,1),m.linear=m(0,0,1,1),m.easeIn=m["ease-in"]=m(.42,0,1,1),m.easeOut=m["ease-out"]=m(0,0,.58,1),m.easeInOut=
m["ease-in-out"]=m(.42,0,.58,1),m})},"esri/views/DOMContainer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang dojo/on dojo/dom dojo/dom-construct ../core/Accessor ../core/Evented ../core/HandleRegistry ../core/Scheduler ../core/watchUtils ../widgets/Popup ./PopupManager ./overlay/ViewOverlay ./ui/DefaultUI ../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y){var n=[0,0];return function(a){function e(){var b=
a.call(this)||this;return b._domHandles=new c,b._freqInfo={freq:16,time:750},b._overlayRenderTaskHandle=null,b.height=0,b.position=null,b.resizing=!1,b.root=null,b.surface=null,b.suspended=!0,b.width=0,b.watch("cursor",function(a){var c=b.surface;c&&c.setAttribute("data-cursor",a)}),b.watch("interacting",function(a){var c=b.surface;c&&c.setAttribute("data-interacting",a.toString())}),b}return h(e,a),e.prototype.getDefaults=function(){return b.mixin(this.inherited(arguments),{popup:{},ui:{}})},e.prototype.destroy=
function(){this.ui.destroy();this.popup&&this.popup.destroy();this.container=null;this._domHandles.destroy()},Object.defineProperty(e.prototype,"container",{set:function(a){var b=this,c=this._get("container");if(c!==a)if(this._stopMeasuring(),c&&(c.classList.remove("esri-view"),this.popupManager.destroy(),this._set("popupManager",null),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),f.destroy(this.root),
this._set("root",null)),a){a.classList.add("esri-view");c=document.createElement("div");c.className="esri-view-root";a.insertBefore(c,a.firstChild);this._set("root",c);var e=document.createElement("div");e.className="esri-view-surface";k.setSelectable(e,!1);c.appendChild(e);this._set("surface",e);e=new v;c.appendChild(e.surface);this._set("overlay",e);e.watch("needsRender",function(a){a&&!b._overlayRenderTaskHandle?b._overlayRenderTaskHandle=q.addFrameTask({render:function(){b.overlay.render()}}):
b._overlayRenderTaskHandle&&(b._overlayRenderTaskHandle.remove(),b._overlayRenderTaskHandle=null)});this._forceReadyCycle();this._set("container",a);this._startMeasuring();a=new u({enabled:!0,view:this});this._set("popupManager",a)}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"popup",{set:function(a){var b=this._get("popup");
a!==b&&(a||(a=new r({container:document.createElement("div")})),this._domHandles.remove("view-popup"),b&&b.destroy(),a&&(a.viewModel.view=this,this._domHandles.add([t.init(this,"root",function(b,c){var e=a.container;e||(a.container=document.createElement("div"));var d=e&&e.parentNode;k.isDescendant(d,c)&&d.removeChild(e);b&&!d&&f.place(a.container,b)})],"view-popup")),this._set("popup",a))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return[this.width,
this.height]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ui",{set:function(a){var b=this._get("ui");a!==b&&(this._domHandles.remove("ui"),b&&b.destroy(),a&&(a.view=this,this._domHandles.add([t.init(this,"root",function(b){a.container=b?f.create("div",null,b):null})],"ui")),this._set("ui",a))},enumerable:!0,configurable:!0}),e.prototype.focus=function(){this.surface&&this.surface.focus()},e.prototype.pageToContainer=function(a,b,c){var e=this.position;return a-=e[0],b-=e[1],
c?(c[0]=a,c[1]=b):c=[a,b],c},e.prototype.containerToPage=function(a,b,c){var e=this.position;return a+=e[0],b+=e[1],c?(c[0]=a,c[1]=b):c=[a,b],c},e.prototype._stopMeasuring=function(){this._domHandles.remove("measuring");this._get("resizing")&&this._set("resizing",!1)},e.prototype._startMeasuring=function(){var a=this,b=this._freqInfo;b.freq=16;b.time=750;this._domHandles.add([g(window,"resize",function(){b.freq=16;b.time=750}),q.addFrameTask({prepare:function(b){var c=a._measure(),e=a._freqInfo;(e.time+=
b.deltaTime,c&&(e.freq=16,a._get("resizing")||a._set("resizing",!0)),e.time<e.freq)||(e.time=0,a._position()||c?e.freq=16:e.freq=Math.min(750,2*e.freq),!c&&512<=e.freq&&a._get("resizing")&&a._set("resizing",!1))}})],"measuring");this._measure();this._position()},e.prototype._measure=function(){var a=this.container,b=a?a.clientWidth:0,c=a?a.clientHeight:0;if(0===b||0===c||"hidden"===window.getComputedStyle(a).visibility)return this.suspended||this._set("suspended",!0),!1;var a=this.width,e=this.height;
return b===a&&c===e?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",b),this._set("height",c),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:a,oldHeight:e,width:b,height:c}),!0)},e.prototype._position=function(){var a=this.container,b=this.position,c;c=(a.ownerDocument||window.document).defaultView;a=a.getBoundingClientRect();c=(n[0]=a.left+c.pageXOffset,n[1]=a.top+c.pageYOffset,n);return b&&c[0]===b[0]&&c[1]===b[1]?!1:(this._set("position",c.slice()),!0)},
d([y.property({value:null,cast:function(a){return k.byId(a)}})],e.prototype,"container",null),d([y.property({readOnly:!0})],e.prototype,"height",void 0),d([y.property({type:r})],e.prototype,"popup",null),d([y.property({type:u})],e.prototype,"popupManager",void 0),d([y.property({type:v})],e.prototype,"overlay",void 0),d([y.property({readOnly:!0})],e.prototype,"position",void 0),d([y.property({readOnly:!0})],e.prototype,"resizing",void 0),d([y.property({readOnly:!0})],e.prototype,"root",void 0),d([y.property({value:null,
dependsOn:["width","height"],readOnly:!0})],e.prototype,"size",null),d([y.property({readOnly:!0})],e.prototype,"surface",void 0),d([y.property({readOnly:!0})],e.prototype,"suspended",void 0),d([y.property({type:x})],e.prototype,"ui",null),d([y.property({readOnly:!0})],e.prototype,"width",void 0),e=d([y.subclass("esri.views.DOMContainer")],e)}(y.declared(a,e))})},"esri/widgets/Popup":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ./support/widget ../core/accessorSupport/decorators ../core/lang ../core/Logger ../core/HandleRegistry ../core/watchUtils ./Widget ../widgets/support/widgetUtils ./Popup/PopupRenderer ./Popup/PopupViewModel dojo/i18n!./Popup/nls/Popup ./Spinner dojo/dom-geometry dojo/keys".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n){function w(a,b){return void 0===b?B+"__"+a:B+"__"+a+"-"+b}var z=m.toUrl("./Popup/images/default-action.svg"),C={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},B="esri-popup",F=a.getLogger("esri.widgets.Popup");return function(a){function l(b){b=a.call(this)||this;return b._blurContainer=!1,b._containerNode=null,b._mainContainerNode=null,b._featureMenuNode=null,b._focusContainer=!1,b._focusDockButton=!1,b._focusFeatureMenuButton=!1,b._focusFirstFeature=
!1,b._handleRegistry=new e,b._displayActionTextLimit=2,b._pointerOffsetInPx=16,b._spinner=null,b._closeFeatureMenuHandle=null,b.actions=null,b.alignment="auto",b.autoCloseEnabled=null,b.content=null,b.collapsed=!1,b.collapseEnabled=!0,b.dockEnabled=!1,b.featureCount=null,b.featureMenuOpen=!1,b.features=null,b.featureNavigationEnabled=!0,b.highlightEnabled=null,b.location=null,b.popupRenderers=[],b.promises=null,b.selectedFeature=null,b.selectedFeatureIndex=null,b.selectedPopupRenderer=null,b.spinnerEnabled=
!0,b.title=null,b.updateLocationEnabled=null,b.view=null,b.viewModel=new u,b.visible=null,b}return h(l,a),l.prototype.postInitialize=function(){var a=this,b=c.pausable(this,"\n      viewModel.visible,\n      dockEnabled,\n      viewModel.selectedFeature\n    ",function(){return a._closeFeatureMenu()});this._closeFeatureMenuHandle=b;this.own(c.watch(this,"viewModel.screenLocation",function(){return a._positionContainer()}),c.watch(this,["viewModel.visible","dockEnabled"],function(){return a._toggleScreenLocationEnabled()}),
c.watch(this,"viewModel.screenLocation",function(b,c){!!b!=!!c&&a.reposition()}),c.watch(this,"viewModel.features",function(b){return a._createPopupRenderers(b)}),c.watch(this,"viewModel.view.padding viewModel.view.size viewModel.visible viewModel.waitingForResult viewModel.location alignment".split(" "),function(){return a.reposition()}),b,c.watch(this,"spinnerEnabled",function(b){return a._spinnerEnabledChange(b)}),c.watch(this,["title","content"],function(){return a._hasFeatureUpdated()}),c.watch(this,
"viewModel.view.size",function(b,c){return a._updateDockEnabledForViewSize(b,c)}),c.watch(this,"viewModel.view",function(b,c){return a._viewChange(b,c)}),c.watch(this,"viewModel.view.ready",function(b,c){return a._viewReadyChange(b,c)}),c.watch(this,["viewModel.waitingForResult","viewModel.location"],function(){return a._displaySpinner()}),c.watch(this,["popupRenderers","viewModel.selectedFeatureIndex"],function(){return a._updatePopupRenderer()}),c.watch(this,"selectedPopupRenderer.viewModel.title",
function(b){return a._setTitleFromPopupRenderer(b)}),c.watch(this,["selectedPopupRenderer.viewModel.content","selectedPopupRenderer.viewModel.waitingForContent"],function(){return a._setContentFromPopupRenderer()}),c.watch(this,"featureMenuOpen",function(b){return a._featureMenuOpenChanged(b)}),c.watch(this,"visible",function(b){return a._visibleChanged(b)}),c.on(this,"viewModel","trigger-action",function(b){return a._zoomToAction(b)}))},l.prototype.destroy=function(){this._destroyPopupRenderers();
this._destroySpinner();this._handleRegistry.destroy();this._handleRegistry=null},Object.defineProperty(l.prototype,"currentAlignment",{get:function(){return this._getCurrentAlignment()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"currentDockPosition",{get:function(){return this._getCurrentDockPosition()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"dockOptions",{get:function(){return this._get("dockOptions")||C},set:function(a){var c=b({},C),e=this.get("viewModel.view.breakpoints"),
d={};e&&(d.width=e.xsmall,d.height=e.xsmall);a=b({},c,a);c=b({},c.breakpoint,d);d=a.breakpoint;!0===d?a.breakpoint=c:"object"==typeof d&&(a.breakpoint=b({},c,d));this._set("dockOptions",a);this._setCurrentDockPosition();this.reposition()},enumerable:!0,configurable:!0}),l.prototype.blur=function(){this.visible||F.warn("Popup cannot be blurred while visible is false");this._blurContainer=!0;this.scheduleRender()},l.prototype.clear=function(){},l.prototype.close=function(){this.visible=!1},l.prototype.focus=
function(){this.visible||F.warn("Popup cannot be focused while visible is false");this._focusContainer=!0;this.scheduleRender()},l.prototype.next=function(){return null},l.prototype.open=function(a){a=b({visible:!0},{featureMenuOpen:!1,updateLocationEnabled:!1,promises:[]},a);a.featureMenuOpen&&this._closeFeatureMenuHandle.pause();this.set(a);this._visibleChanged(!0)},l.prototype.previous=function(){return null},l.prototype.reposition=function(){this.renderNow();this._positionContainer();this._setCurrentAlignment()},
l.prototype.triggerAction=function(a){return null},l.prototype.render=function(){var a=this.collapsed,b=this.collapseEnabled,c=this.dockEnabled,e=this.actions,d=this.featureMenuOpen,n=this.featureNavigationEnabled,k=this.popupRenderers,h=this.visible,q=this.viewModel,l=q.featureCount,E=q.promiseCount,p=q.pendingPromisesCount,A=q.selectedFeatureIndex,K=q.title,q=q.waitingForResult,U=1<l&&n,n=1<l&&d,V=b&&!n&&a,r=e&&e.length,u=U&&this._getPageText(l,A),x=this._renderContent(),y=t.isRtl(),m=this.get("selectedPopupRenderer")?
this.get("selectedPopupRenderer.viewModel.waitingForContent")||this.get("selectedPopupRenderer.viewModel.content"):x,z=c?v.undock:v.dock,e=this.currentAlignment,a=this.currentDockPosition,p=p?g.tsx("div",{key:w("loading-container"),role:"presentation","class":"esri-popup__loading-container","aria-label":v.loading,title:v.loading},g.tsx("span",{"aria-hidden":"true","class":g.join("esri-popup__icon","esri-icon-loading-indicator","esri-rotating")})):null,C=(B={},B["esri-icon-layer-list"]=!n,B["esri-icon-close"]=
n,B),B=g.tsx("span",{"aria-hidden":"true","class":"esri-popup__icon",classes:C}),C=(F={},F["esri-icon-right-triangle-arrow"]=y,F["esri-popup__pagination-previous-icon--rtl"]=y,F["esri-icon-left-triangle-arrow"]=!y,F["esri-popup__pagination-previous-icon"]=!y,F),F=g.tsx("span",{"aria-hidden":"true","class":"esri-popup__icon",classes:C}),F=g.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,"class":g.join("esri-popup__button","esri-popup__pagination-previous"),
"aria-label":v.previous,title:v.previous},F),y=(G={},G["esri-icon-left-triangle-arrow"]=y,G["esri-popup__pagination-next-icon--rtl"]=y,G["esri-icon-right-triangle-arrow"]=!y,G["esri-popup__pagination-next-icon"]=!y,G),G=g.tsx("span",{"aria-hidden":"true","class":"esri-popup__icon",classes:y}),y=g.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,"class":g.join("esri-popup__button","esri-popup__pagination-next"),"aria-label":v.next,title:v.next},G),G=this.id+"-feature-menu",
d=g.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,"class":g.join("esri-popup__button","esri-popup__feature-menu-button"),"aria-haspopup":"true","aria-controls":G,"aria-expanded":d,"aria-label":v.menu,title:v.menu},B),u=g.tsx("div",{"class":"esri-popup__pagination-page-text"},u),d=U?g.tsx("div",{"class":"esri-popup__navigation-buttons"},F,u,y,d):
null,u=this._wouldDockTo(),u=(N={},N["esri-icon-minimize"]=c,N["esri-popup__icon--dock-icon"]=!c,N["esri-icon-dock-right"]=!c&&("top-right"===u||"bottom-right"===u),N["esri-icon-dock-left"]=!c&&("top-left"===u||"bottom-left"===u),N["esri-icon-maximize"]=!c&&"top-center"===u,N["esri-icon-dock-bottom"]=!c&&"bottom-center"===u,N),N=g.tsx("span",{"aria-hidden":"true",classes:u,"class":"esri-popup__icon"}),N=this.get("dockOptions.buttonEnabled")?g.tsx("div",{role:"button","aria-label":z,title:z,tabIndex:0,
bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,"class":g.join("esri-popup__button","esri-popup__button--dock")},N):null,b=b&&(m||r||U),z=(da={},da["esri-popup__header-title--button"]=b,da),u=b?V?v.expand:v.collapse:"",da=this.id+"-popup-title",K=K?g.tsx("h1",{"class":"esri-popup__header-title",id:da,role:b?"button":"heading","aria-label":u,title:u,classes:z,bind:this,tabIndex:b?0:-1,onclick:this._toggleCollapsed,
onkeydown:this._toggleCollapsed,innerHTML:K}):null,b=g.tsx("span",{"aria-hidden":"true","class":g.join("esri-popup__icon","esri-icon-close")}),b=g.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,"class":"esri-popup__button","aria-label":v.close,title:v.close},b),b=g.tsx("header",{"class":"esri-popup__header"},K,g.tsx("div",{"class":"esri-popup__header-buttons"},N,b)),N=this.id+"-popup-content",x=m&&!V?g.tsx("article",{key:w("content-container"),id:N,"class":"esri-popup__content"},
x):null,m=!V&&("bottom-left"===e||"bottom-center"===e||"bottom-right"===e||"top-left"===a||"top-center"===a||"top-right"===a),V=!V&&("top-left"===e||"top-center"===e||"top-right"===e||"bottom-left"===a||"bottom-center"===a||"bottom-right"===a),z=n?null:g.tsx("div",{key:w("actions"),"class":"esri-popup__actions"},this._renderActions()),p=g.tsx("section",{key:w("navigation"),"class":"esri-popup__navigation"},p,d),U=U||r?g.tsx("div",{key:w("feature-buttons"),"class":"esri-popup__feature-buttons"},z,
p):null;(A=this._renderFeatureMenuNode(k,A,n,G))&&this._closeFeatureMenuHandle.resume();k=f.substitute({total:k.length},v.selectedFeatures);A=g.tsx("section",{key:w("menu"),"class":"esri-popup__feature-menu"},g.tsx("h2",{"class":"esri-popup__feature-menu-header"},k),g.tsx("nav",{"class":"esri-popup__feature-menu-viewport",afterCreate:this._featureMenuViewportNodeUpdated,afterUpdate:this._featureMenuViewportNodeUpdated},A));k=c?null:g.tsx("div",{key:w("pointer"),"class":"esri-popup__pointer",role:"presentation"},
g.tsx("div",{"class":g.join("esri-popup__pointer-direction","esri-popup--shadow")}));n=(ra={},ra["esri-popup--aligned-top-center"]="top-center"===e,ra["esri-popup--aligned-bottom-center"]="bottom-center"===e,ra["esri-popup--aligned-top-left"]="top-left"===e,ra["esri-popup--aligned-bottom-left"]="bottom-left"===e,ra["esri-popup--aligned-top-right"]="top-right"===e,ra["esri-popup--aligned-bottom-right"]="bottom-right"===e,ra["esri-popup--is-docked"]=c,ra["esri-popup--shadow"]=!c,ra["esri-popup--feature-updated"]=
h,ra["esri-popup--is-docked-top-left"]="top-left"===a,ra["esri-popup--is-docked-top-center"]="top-center"===a,ra["esri-popup--is-docked-top-right"]="top-right"===a,ra["esri-popup--is-docked-bottom-left"]="bottom-left"===a,ra["esri-popup--is-docked-bottom-center"]="bottom-center"===a,ra["esri-popup--is-docked-bottom-right"]="bottom-right"===a,ra["esri-popup--feature-menu-open"]=n,ra);ra=this.get("selectedFeature.layer.title");e=this.get("selectedFeature.layer.id");c=(ga={},ga["esri-popup--shadow"]=
c,ga);ga=m?A:null;A=V?A:null;a=m?U:null;U=V?U:null;h=h&&!q&&(E?l:1)?g.tsx("div",{key:w("container"),"class":"esri-popup__position-container",classes:n,"data-layer-title":ra,"data-layer-id":e,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},g.tsx("div",{"class":g.join("esri-popup__main-container","esri-widget"),classes:c,tabIndex:-1,"aria-role":"dialog","aria-labelledby":K?da:"","aria-describedby":x?N:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,
afterUpdate:this._mainContainerNodeUpdated},a,ga,b,x,U,A),k):null;return g.tsx("div",{key:w("base"),"class":"esri-popup",role:"presentation"},h);var B,F,G,N,da,ra,ga},l.prototype._visibleChanged=function(a){a&&(this._focusContainer=!0,this.scheduleRender())},l.prototype._featureMenuOpenChanged=function(a){a?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0;this.scheduleRender()},l.prototype._setTitleFromPopupRenderer=function(a){this.viewModel.title=a||""},l.prototype._setContentFromPopupRenderer=
function(){this.viewModel.content=this.selectedPopupRenderer||null;this.scheduleRender()},l.prototype._handleFeatureMenuKeyup=function(a){a.keyCode===n.ESCAPE&&(a.stopPropagation(),this.featureMenuOpen=!1)},l.prototype._handleFeatureMenuItemKeyup=function(a){var b=a.keyCode,c=this._featureMenuNode,e=this.get("features.length"),d=a.currentTarget["data-feature-index"];if(c){c=c.querySelectorAll("li");if(b===n.UP_ARROW)return a.stopPropagation(),void c[(d-1+e)%e].focus();if(b===n.DOWN_ARROW)return a.stopPropagation(),
void c[(d+1+e)%e].focus();if(b===n.HOME)return a.stopPropagation(),void c[0].focus();if(b===n.END)return a.stopPropagation(),void c[c.length-1].focus()}},l.prototype._handleMainKeyup=function(a){var b=a.keyCode;b===n.LEFT_ARROW&&(a.stopPropagation(),this.previous());b===n.RIGHT_ARROW&&(a.stopPropagation(),this.next())},l.prototype._zoomToAction=function(a){a.action&&"zoom-to"===a.action.id&&this.viewModel.zoomToLocation()},l.prototype._spinnerEnabledChange=function(a){if(this._destroySpinner(),a)a=
this.get("viewModel.view"),this._createSpinner(a)},l.prototype._displaySpinner=function(){var a=this._spinner;if(a){var b=this.viewModel,c=b.location;return b.waitingForResult?void a.show({location:c}):void a.hide()}},l.prototype._getIconStyles=function(a){return{"background-image":a?"url("+a+")":""}},l.prototype._renderAction=function(a,b,e,d){var n=this,k=c.watch(a,["id","className","title","image","visible"],function(){return n.scheduleRender()});this._handleRegistry.add(k,d);k=this.get("selectedFeature.attributes");
"zoom-to"===a.id&&(a.title=v.zoom,this._handleRegistry.add(c.init(this,"view.animation.state",function(b){a.className="waiting-for-target"===b?g.join("esri-popup__icon","esri-icon-loading-indicator","esri-rotating"):g.join("esri-popup__icon","esri-icon-zoom-in-magnifying-glass")}),d));d=a.title;var h=a.className,q=a.image||h?a.image:z;d=d&&k?f.substitute(k,d):d;h=h&&k?f.substitute(k,h):h;k=q&&k?f.substitute(k,q):q;q=h||"esri-popup__icon";h=(l={},l["esri-popup__action-image"]=!!k,l);l=(r={},r["esri-disabled"]=
-1!==q.indexOf("esri-icon-loading-indicator"),r);e=e<=this._displayActionTextLimit?g.tsx("span",{key:w("action-text-"+b+"-"+a.uid),"class":"esri-popup__action-text"},d):null;return a.visible?g.tsx("div",{key:w("action-"+b+"-"+a.uid),role:"button",tabIndex:0,title:d,"aria-label":d,classes:l,"class":g.join("esri-popup__button","esri-popup__action"),bind:this,"data-action-index":b,onclick:this._triggerAction,onkeydown:this._triggerAction},g.tsx("span",{key:w("action-icon-"+b+"-"+a.uid+"-"+q),"aria-hidden":"true",
"class":q,classes:h,styles:this._getIconStyles(k)}),e):null;var l,r},l.prototype._renderActions=function(){var a=this;this._handleRegistry.remove("actions");var b=this.actions;if(b){var c=b.length;return b.toArray().map(function(b,e){return a._renderAction(b,e,c,"actions")})}},l.prototype._updatePopupRenderer=function(){var a=this.popupRenderers[this.viewModel.selectedFeatureIndex]||null;a&&!a.contentEnabled&&(a.contentEnabled=!0);this._set("selectedPopupRenderer",a)},l.prototype._destroyPopupRenderers=
function(){this.popupRenderers.forEach(function(a){return a.destroy()});this._set("popupRenderers",[])},l.prototype._createPopupRenderers=function(a){var b=this;this._destroyPopupRenderers();var c=[];a&&a.forEach(function(a){a=new r({contentEnabled:!1,graphic:a,view:b.get("viewModel.view")});c.push(a)});this._set("popupRenderers",c)},l.prototype._isScreenLocationWithinView=function(a,b){return-1<a.x&&-1<a.y&&a.x<=b.width&&a.y<=b.height},l.prototype._isOutsideView=function(a){var b=a.popupHeight,c=
a.popupWidth,e=a.screenLocation,d=a.side;a=a.view;if(isNaN(c)||isNaN(b)||!a||!e)return!1;var f=a.padding;return"right"===d&&e.x+c/2>a.width-f.right?!0:"left"===d&&e.x-c/2<f.left?!0:"top"===d&&e.y-b<f.top?!0:"bottom"===d&&e.y+b>a.height-f.bottom?!0:!1},l.prototype._determineCurrentAlignment=function(){var a=this._pointerOffsetInPx,b=this._containerNode,c=this._mainContainerNode,e=this.viewModel,d=e.screenLocation,e=e.view;if(!d||!e||!b)return"top-center";if(!this._isScreenLocationWithinView(d,e))return this._get("currentAlignment")||
"top-center";var f=c?window.getComputedStyle(c,null):null,c=f?parseInt(f.getPropertyValue("max-height").replace(/[^-\d\.]/g,""),10):0,f=f?parseInt(f.getPropertyValue("height").replace(/[^-\d\.]/g,""),10):0,g=y.getContentBox(b),b=g.w+a,g=Math.max(g.h,c,f)+a,a=this._isOutsideView({popupHeight:g,popupWidth:b,screenLocation:d,side:"right",view:e}),c=this._isOutsideView({popupHeight:g,popupWidth:b,screenLocation:d,side:"left",view:e}),f=this._isOutsideView({popupHeight:g,popupWidth:b,screenLocation:d,
side:"top",view:e}),d=this._isOutsideView({popupHeight:g,popupWidth:b,screenLocation:d,side:"bottom",view:e});return c?f?"bottom-right":"top-right":a?f?"bottom-left":"top-left":f?d?"top-center":"bottom-center":"top-center"},l.prototype._getCurrentAlignment=function(){var a=this.alignment;return this.dockEnabled?null:"auto"===a?this._determineCurrentAlignment():"function"==typeof a?a.call(this):a},l.prototype._setCurrentAlignment=function(){this._set("currentAlignment",this._getCurrentAlignment())},
l.prototype._setCurrentDockPosition=function(){this._set("currentDockPosition",this._getCurrentDockPosition())},l.prototype._getDockPosition=function(){var a=this.get("dockOptions.position");return"auto"===a?this._determineCurrentDockPosition():"function"==typeof a?a.call(this):a},l.prototype._getCurrentDockPosition=function(){return this.dockEnabled?this._getDockPosition():null},l.prototype._wouldDockTo=function(){return this.dockEnabled?null:this._getDockPosition()},l.prototype._renderFeatureMenuItemNode=
function(a,b,c,e){var d=b===c;e=(f={},f["esri-popup__feature-menu-item--selected"]=d,f);a=a.title||v.untitled;d=d?g.tsx("span",{key:w("feature-menu-selected-feature-"+c),title:v.selectedFeature,"aria-label":v.selectedFeature,"class":"esri-icon-check-mark"}):null;return g.tsx("li",{role:"menuitem",tabIndex:-1,key:w("feature-menu-feature-"+c),classes:e,"class":"esri-popup__feature-menu-item",title:a,"aria-label":a,bind:this,"data-feature-index":b,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,
onkeydown:this._selectFeature},g.tsx("span",{"class":"esri-popup__feature-menu-title"},a,d));var f},l.prototype._renderFeatureMenuNode=function(a,b,c,e){var d=this;return 1<a.length?g.tsx("ol",{"class":"esri-popup__feature-menu-list",id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},a.map(function(a,e){return d._renderFeatureMenuItemNode(a,e,b,c)})):null},l.prototype._determineCurrentDockPosition=function(){var a=
this.get("viewModel.view"),b=t.isRtl()?"top-left":"top-right";if(!a)return b;var c=a.padding||{left:0,right:0,top:0,bottom:0},c=a.width-c.left-c.right;return(a=a.get("breakpoints"))&&c<=a.xsmall?"bottom-center":b},l.prototype._renderContent=function(){var a=this.get("viewModel.content");return"string"==typeof a?g.tsx("div",{key:w("content-string"),innerHTML:a}):a&&a.isInstanceOf&&a.isInstanceOf(q)?g.tsx("div",{key:w("content-widget")},a.render()):a instanceof HTMLElement?g.tsx("div",{key:w("content-html-element"),
bind:a,afterUpdate:this._attachToNode,afterCreate:this._attachToNode}):a&&"function"==typeof a.postMixInProperties&&"function"==typeof a.buildRendering&&"function"==typeof a.postCreate&&"function"==typeof a.startup?g.tsx("div",{key:w("content-dijit"),bind:a.domNode,afterUpdate:this._attachToNode,afterCreate:this._attachToNode}):void 0},l.prototype._attachToNode=function(a){a.appendChild(this)},l.prototype._positionContainer=function(a){if(void 0===a&&(a=this._containerNode),a&&(this._containerNode=
a),a){var b=this.viewModel.screenLocation,c=y.getContentBox(a);(b=this._calculatePositionStyle(b,c))&&(a.style.top=b.top,a.style.left=b.left,a.style.bottom=b.bottom,a.style.right=b.right)}},l.prototype._calculateFullWidth=function(a){var b=this.currentAlignment,c=this._pointerOffsetInPx;return"top-left"===b||"bottom-left"===b||"top-right"===b||"bottom-right"===b?a+c:a},l.prototype._calculateAlignmentPosition=function(a,b,c,e){var d=this.currentAlignment,f=this._pointerOffsetInPx;e/=2;var g=c.height-
b;c=c.width-a;return"bottom-center"===d?{top:b+f,left:a-e}:"top-left"===d?{bottom:g+f,right:c+f}:"bottom-left"===d?{top:b+f,right:c+f}:"top-right"===d?{bottom:g+f,left:a+f}:"bottom-right"===d?{top:b+f,left:a+f}:"top-center"===d?{bottom:g+f,left:a-e}:void 0},l.prototype._calculatePositionStyle=function(a,b){var c=this.dockEnabled,e=this.view;if(e){var d=e.padding;if(c)return{left:d.left?d.left+"px":"",top:d.top?d.top+"px":"",right:d.right?d.right+"px":"",bottom:d.bottom?d.bottom+"px":""};if(a&&b&&
(b=this._calculateFullWidth(b.w),a=this._calculateAlignmentPosition(a.x,a.y,e,b)))return{top:void 0!==a.top?a.top+"px":"auto",left:void 0!==a.left?a.left+"px":"auto",bottom:void 0!==a.bottom?a.bottom+"px":"auto",right:void 0!==a.right?a.right+"px":"auto"}}},l.prototype._viewChange=function(a,b){a&&b&&(this.close(),this.clear())},l.prototype._viewReadyChange=function(a,b){if(a)return a=this.get("viewModel.view"),void this._wireUpView(a);b&&(this.close(),this.clear())},l.prototype._wireUpView=function(a){if(this._destroySpinner(),
a)this.spinnerEnabled&&this._createSpinner(a),this._setDockEnabledForViewSize(this.dockOptions)},l.prototype._dockingThresholdCrossed=function(a,b,c){var e=a[0];a=a[1];var d=b[0];b=b[1];var f=c.width;c=c.height;return f>=e&&d>f||e>f&&f>=d||c>=a&&b>c||a>c&&c>=b},l.prototype._updateDockEnabledForViewSize=function(a,b){if(a&&b){var c=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},e=c.left+c.right,d=c.top+c.bottom,c=[],f=[];c[0]=a[0]-e;c[1]=a[1]-d;f[0]=b[0]-e;f[1]=b[1]-d;a=this.dockOptions;
this._dockingThresholdCrossed(c,f,a.breakpoint)&&this._setDockEnabledForViewSize(a);this._setCurrentDockPosition()}},l.prototype._hasFeatureUpdated=function(){var a=this._containerNode,b=this.viewModel.pendingPromisesCount,c=this.get("selectedPopupRenderer.viewModel.waitingForContent");!a||b||c||(a.classList.remove("esri-popup--feature-updated"),a.offsetHeight,a.classList.add("esri-popup--feature-updated"))},l.prototype._focusDockButtonNode=function(a){this._focusDockButton&&(this._focusDockButton=
!1,a.focus())},l.prototype._mainContainerNodeUpdated=function(a){return this._mainContainerNode=a,this._focusContainer?(this._focusContainer=!1,void a.focus()):this._blurContainer?(this._blurContainer=!1,void a.blur()):void 0},l.prototype._featureMenuNodeUpdated=function(a){if(this._featureMenuNode=a,a&&this._focusFirstFeature)this._focusFirstFeature=!1,a=a.querySelectorAll("li"),a.length&&a[0].focus()},l.prototype._focusFeatureMenuButtonNode=function(a){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=
!1,a.focus())},l.prototype._featureMenuViewportNodeUpdated=function(a){a&&(a.scrollTop=0)},l.prototype._toggleScreenLocationEnabled=function(){var a=this.dockEnabled,b=this.visible,c=this.viewModel;c&&(c.screenLocationEnabled=b&&!a)},l.prototype._shouldDockAtCurrentViewSize=function(a){a=a.breakpoint;var b=this.get("viewModel.view.ui"),c=b.width,b=b.height;if(isNaN(c)||isNaN(b))return!1;c=a.hasOwnProperty("width")&&c<=a.width;a=a.hasOwnProperty("height")&&b<=a.height;return c||a},l.prototype._setDockEnabledForViewSize=
function(a){a.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(a))},l.prototype._getPageText=function(a,b){return f.substitute({index:b+1,total:a},v.pageText)},l.prototype._destroySpinner=function(){this._spinner&&(this._spinner.destroy(),this._spinner=null)},l.prototype._createSpinner=function(a){a&&(this._spinner=new x({container:document.createElement("div"),view:a}),a.root.appendChild(this._spinner.container))},l.prototype._closeFeatureMenu=function(){this.featureMenuOpen=!1},l.prototype._toggleCollapsed=
function(){this.collapsed=!this.collapsed},l.prototype._close=function(){this.close();this.view&&this.view.focus()},l.prototype._toggleDockEnabled=function(){this.dockEnabled=!this.dockEnabled;this._focusDockButton=!0;this.scheduleRender()},l.prototype._toggleFeatureMenu=function(){this.featureMenuOpen=!this.featureMenuOpen},l.prototype._triggerAction=function(a){this.viewModel.triggerAction(a.currentTarget["data-action-index"])},l.prototype._selectFeature=function(a){a=a.currentTarget["data-feature-index"];
isNaN(a)||(this.viewModel.selectedFeatureIndex=a);this._closeFeatureMenu()},l.prototype._next=function(){this.next()},l.prototype._previous=function(){this.previous()},d([k.aliasOf("viewModel.actions"),g.renderable()],l.prototype,"actions",void 0),d([k.property()],l.prototype,"alignment",void 0),d([k.aliasOf("viewModel.autoCloseEnabled")],l.prototype,"autoCloseEnabled",void 0),d([k.aliasOf("viewModel.content"),g.renderable()],l.prototype,"content",void 0),d([k.property(),g.renderable()],l.prototype,
"collapsed",void 0),d([k.property(),g.renderable()],l.prototype,"collapseEnabled",void 0),d([k.property({readOnly:!0,dependsOn:["dockEnabled","alignment"]}),g.renderable()],l.prototype,"currentAlignment",null),d([k.property({readOnly:!0,dependsOn:["dockEnabled","dockOptions"]}),g.renderable()],l.prototype,"currentDockPosition",null),d([k.property(),g.renderable()],l.prototype,"dockOptions",null),d([k.property(),g.renderable()],l.prototype,"dockEnabled",void 0),d([k.aliasOf("viewModel.featureCount"),
g.renderable()],l.prototype,"featureCount",void 0),d([k.property(),g.renderable()],l.prototype,"featureMenuOpen",void 0),d([k.aliasOf("viewModel.features"),g.renderable()],l.prototype,"features",void 0),d([k.property(),g.renderable()],l.prototype,"featureNavigationEnabled",void 0),d([k.aliasOf("viewModel.highlightEnabled")],l.prototype,"highlightEnabled",void 0),d([k.aliasOf("viewModel.location"),g.renderable()],l.prototype,"location",void 0),d([k.property({readOnly:!0}),g.renderable()],l.prototype,
"popupRenderers",void 0),d([k.aliasOf("viewModel.promises")],l.prototype,"promises",void 0),d([k.aliasOf("viewModel.selectedFeature"),g.renderable()],l.prototype,"selectedFeature",void 0),d([k.aliasOf("viewModel.selectedFeatureIndex"),g.renderable()],l.prototype,"selectedFeatureIndex",void 0),d([k.property({readOnly:!0}),g.renderable()],l.prototype,"selectedPopupRenderer",void 0),d([k.property()],l.prototype,"spinnerEnabled",void 0),d([k.aliasOf("viewModel.title"),g.renderable()],l.prototype,"title",
void 0),d([k.aliasOf("viewModel.updateLocationEnabled")],l.prototype,"updateLocationEnabled",void 0),d([k.aliasOf("viewModel.view")],l.prototype,"view",void 0),d([k.property({type:u}),g.renderable("viewModel.screenLocation viewModel.screenLocationEnabled viewModel.state viewModel.pendingPromisesCount viewModel.promiseCount viewModel.waitingForResult".split(" ")),g.vmEvent(["triggerAction","trigger-action"])],l.prototype,"viewModel",void 0),d([k.aliasOf("viewModel.visible"),g.renderable()],l.prototype,
"visible",void 0),d([k.aliasOf("viewModel.clear")],l.prototype,"clear",null),d([k.aliasOf("viewModel.next")],l.prototype,"next",null),d([k.aliasOf("viewModel.previous")],l.prototype,"previous",null),d([k.aliasOf("viewModel.triggerAction")],l.prototype,"triggerAction",null),d([g.accessibleHandler()],l.prototype,"_toggleCollapsed",null),d([g.accessibleHandler()],l.prototype,"_close",null),d([g.accessibleHandler()],l.prototype,"_toggleDockEnabled",null),d([g.accessibleHandler()],l.prototype,"_toggleFeatureMenu",
null),d([g.accessibleHandler()],l.prototype,"_triggerAction",null),d([g.accessibleHandler()],l.prototype,"_selectFeature",null),d([g.accessibleHandler()],l.prototype,"_next",null),d([g.accessibleHandler()],l.prototype,"_previous",null),l=d([k.subclass("esri.widgets.Popup")],l)}(k.declared(q))})},"esri/widgets/support/widget":function(){define(["require","exports","./decorators","./jsxFactory","./widgetUtils"],function(m,l,h,d,b){function g(b){for(var d in b)l.hasOwnProperty(d)||(l[d]=b[d])}Object.defineProperty(l,
"__esModule",{value:!0});g(h);g(d);g(b)})},"esri/widgets/support/decorators":function(){define(["require","exports","./decorators/accessibleHandler","./decorators/renderable","./decorators/vmEvent"],function(m,l,h,d,b){function g(b){for(var d in b)l.hasOwnProperty(d)||(l[d]=b[d])}Object.defineProperty(l,"__esModule",{value:!0});g(h);g(d);g(b)})},"esri/widgets/support/decorators/accessibleHandler":function(){define(["require","exports","dojo/keys"],function(m,l,h){function d(b){return function(d){for(var g=
[],f=1;f<arguments.length;f++)g[f-1]=arguments[f];f=d.type;return d instanceof KeyboardEvent||"keyup"===f||"keydown"===f||"keypress"===f?void((d.keyCode===h.ENTER||d.keyCode===h.SPACE)&&(d.preventDefault(),d.target.click())):void b.call.apply(b,[this,d].concat(g))}}Object.defineProperty(l,"__esModule",{value:!0});l.accessibleHandler=function(){return function(b,g){return{value:d(b[g])}}}})},"esri/widgets/support/decorators/renderable":function(){define(["require","exports","./propUtils"],function(m,
l,h){Object.defineProperty(l,"__esModule",{value:!0});l.renderable=function(d){var b="string"==typeof d?h.splitProps(d):d;return function(d,k){d._renderableProps||(d._renderableProps=[]);d=d._renderableProps;return b?void d.push.apply(d,h.normalizePropNames(b,k)):void d.push(k)}}})},"esri/widgets/support/decorators/propUtils":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.splitProps=function(h){return h.split(",").map(function(d){return d.trim()})};
l.normalizePropNames=function(h,d){return h.map(function(b){return 0===b.indexOf(d)?b:d+"."+b})}})},"esri/widgets/support/decorators/vmEvent":function(){define(["require","exports","./propUtils"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.vmEvent=function(d){return function(b){b._delegatedEventNames||(b._delegatedEventNames=[]);var g=Array.isArray(d)?d:h.splitProps(d);b._delegatedEventNames=b._delegatedEventNames.concat(g)}}})},"esri/widgets/support/jsxFactory":function(){define(["require",
"exports","../libs/maquette/maquette"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.tsx=h.h})},"esri/widgets/libs/maquette/maquette":function(){!function(m,l){"function"==typeof define&&define.amd?define(["exports"],l):l("object"==typeof exports&&"string"!=typeof exports.nodeName?exports:m.maquette={})}(this,function(m){var l,h,d=[],b=function(a,b){var c={};return Object.keys(a).forEach(function(b){c[b]=a[b]}),b&&Object.keys(b).forEach(function(a){c[a]=b[a]}),c},g=function(a,
b){return a.vnodeSelector!==b.vnodeSelector?!1:a.properties&&b.properties?a.properties.key!==b.properties.key?!1:a.properties.bind===b.properties.bind:!a.properties&&!b.properties},k=function(a){return{vnodeSelector:"",properties:void 0,children:void 0,text:a.toString(),domNode:null}},f=function(a,b,c){for(var e=0,d=b.length;d>e;e++){var g=b[e];Array.isArray(g)?f(a,g,c):null!==g&&void 0!==g&&(g.hasOwnProperty("vnodeSelector")||(g=k(g)),c.push(g))}},a=function(){throw Error("Provide a transitions object to the projectionOptions to do animations");
},e={namespace:void 0,eventHandlerInterceptor:void 0,styleApplyer:function(a,b,c){a.style[b]=c},transitions:{enter:a,exit:a}},c=function(a){if("string"!=typeof a)throw Error("Style values must be strings");},q=function(a,b,e){if(b)for(var d=e.eventHandlerInterceptor,f=Object.keys(b),g=f.length,n=function(g){g=f[g];var n=b[g];if("className"===g)throw Error('Property "className" is not supported, use "class".');if("class"===g)n.split(/\s+/).forEach(function(b){return a.classList.add(b)});else if("classes"===
g){var k=Object.keys(n),h=k.length;for(g=0;h>g;g++){var q=k[g];n[q]&&a.classList.add(q)}}else if("styles"===g)for(k=Object.keys(n),h=k.length,g=0;h>g;g++){var q=k[g],l=n[q];l&&(c(l),e.styleApplyer(a,q,l))}else"key"!==g&&null!==n&&void 0!==n&&(k=typeof n,"function"===k?0===g.lastIndexOf("on",0)&&(d&&(n=d(g,n,a,b)),"oninput"===g&&!function(){var a=n;n=function(b){a.apply(this,[b]);b.target["oninput-value"]=b.target.value}}(),a[g]=n):"string"===k&&"value"!==g&&"innerHTML"!==g?"http://www.w3.org/2000/svg"===
e.namespace&&"href"===g?a.setAttributeNS("http://www.w3.org/1999/xlink",g,n):a.setAttribute(g,n):a[g]=n)},k=0;g>k;k++)n(k)},t=function(a,b){var c=a.domNode;if(a.properties){var e=a.properties.exitAnimation;if(e){c.style.pointerEvents="none";var d=function(){c.parentNode&&c.parentNode.removeChild(c)};return"function"==typeof e?void e(c,d,a.properties):void b.exit(a.domNode,a.properties,e,d)}}c.parentNode&&c.parentNode.removeChild(c)},r=function(a,b,c,e){var d=a[b];if(""!==d.vnodeSelector){var f=d.properties;
if(!(f&&(void 0===f.key?f.bind:f.key)))for(f=0;f<a.length;f++)if(f!==b&&g(a[f],d))throw"added"===e?Error(c.vnodeSelector+" had a "+d.vnodeSelector+" child added, but there is now more than one. You must add unique key properties to make them distinguishable."):Error(c.vnodeSelector+" had a "+d.vnodeSelector+" child removed, but there were more than one. You must add unique key properties to make them distinguishable.");}},u=function(a,b,c){var e=b.children;if(e)for(var d=0;d<e.length;d++)l(e[d],a,
void 0,c);b.text&&(a.textContent=b.text);q(a,b.properties,c);b.properties&&b.properties.afterCreate&&b.properties.afterCreate.apply(b.properties.bind||b.properties,[a,c,b.vnodeSelector,b.properties,b.children])};l=function(a,c,e,d){var f,g,n,k,h,q=0,l=a.vnodeSelector,r=c.ownerDocument;if(""===l)f=a.domNode=r.createTextNode(a.text),void 0!==e?c.insertBefore(f,e):c.appendChild(f);else{for(g=0;g<=l.length;++g)n=l.charAt(g),(g===l.length||"."===n||"#"===n)&&(k=l.charAt(q-1),h=l.slice(q,g),"."===k?f.classList.add(h):
"#"===k?f.id=h:("svg"===h&&(d=b(d,{namespace:"http://www.w3.org/2000/svg"})),void 0!==d.namespace?f=a.domNode=r.createElementNS(d.namespace,h):(f=a.domNode=a.domNode||r.createElement(h),"input"===h&&a.properties&&void 0!==a.properties.type&&f.setAttribute("type",a.properties.type)),void 0!==e?c.insertBefore(f,e):f.parentNode!==c&&c.appendChild(f)),q=g+1);u(f,a,d)}};h=function(a,e,f){var n=a.domNode,k=!1;if(a===e)return!1;var q=!1;if(""===e.vnodeSelector){if(e.text!==a.text)return a=n.ownerDocument.createTextNode(e.text),
n.parentNode.replaceChild(a,n),e.domNode=a,k=!0}else{0===e.vnodeSelector.lastIndexOf("svg",0)&&(f=b(f,{namespace:"http://www.w3.org/2000/svg"}));a.text!==e.text&&(q=!0,void 0===e.text?n.removeChild(n.firstChild):n.textContent=e.text);var u;u=a.children;var v=e.children,x=f;if(u===v)u=!1;else{u=u||d;for(var v=v||d,y,m=u.length,R=v.length,P=x.transitions,Q=y=0,T=!1;R>Q;){var O=m>y?u[y]:void 0,S=v[Q];if(void 0!==O&&g(O,S))T=h(O,S,x)||T,y++;else{b:{var O=u,H=S;if(""!==H.vnodeSelector)for(var Y=y+1;Y<
O.length;Y++)if(g(O[Y],H)){O=Y;break b}O=-1}if(0<=O){for(;O>y;y++)t(u[y],P),r(u,y,e,"removed");T=h(u[O],S,x)||T;y=O+1}else l(S,n,m>y?u[y].domNode:void 0,x),O=P,S.properties&&(H=S.properties.enterAnimation)&&("function"==typeof H?H(S.domNode,S.properties):O.enter(S.domNode,S.properties,H)),r(v,Q,e,"added")}Q++}if(m>y)for(;m>y;y++)t(u[y],P),r(u,y,e,"removed");u=T}q=u||q;u=a.properties;v=e.properties;x=f;if(v){T=!1;m=Object.keys(v);R=m.length;for(P=0;R>P;P++)if(S=m[P],Q=v[S],y=u[S],"class"===S){if(y!==
Q)throw Error('"class" property may not be updated. Use the "classes" property for conditional css classes.');}else if("classes"===S)for(O=n.classList,H=Object.keys(Q),Y=H.length,S=0;Y>S;S++){var W=H[S],E=!!Q[W];E!==!!y[W]&&(T=!0,E?O.add(W):O.remove(W))}else if("styles"===S)for(O=Object.keys(Q),H=O.length,S=0;H>S;S++)Y=O[S],W=Q[Y],W!==y[Y]&&(T=!0,W?(c(W),x.styleApplyer(n,Y,W)):x.styleApplyer(n,Y,""));else if(Q||"string"!=typeof y||(Q=""),"value"===S)O=n[S],O!==Q&&(n["oninput-value"]?O===n["oninput-value"]:
Q!==y)&&(n[S]=Q,n["oninput-value"]=void 0),Q!==y&&(T=!0);else if(Q!==y){T=typeof Q;if("function"===T)throw Error("Functions may not be updated on subsequent renders (property: "+S+"). Hint: declare event handler functions outside the render() function.");"string"===T&&"innerHTML"!==S?"http://www.w3.org/2000/svg"===x.namespace&&"href"===S?n.setAttributeNS("http://www.w3.org/1999/xlink",S,Q):"role"===S&&""===Q?n.removeAttribute(S):n.setAttribute(S,Q):n[S]!==Q&&(n[S]=Q);T=!0}u=T}else u=void 0;q=u||q;
e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[n,f,e.vnodeSelector,e.properties,e.children])}return q&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(n,e.properties,a.properties),e.domNode=a.domNode,k};var v=function(a,b){return{update:function(c){if(a.vnodeSelector!==c.vnodeSelector)throw Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");
h(a,c,b);a=c},domNode:a.domNode}};m.h=function(a){var b=arguments[1];if("string"!=typeof a)throw Error();var c=1;!b||b.hasOwnProperty("vnodeSelector")||Array.isArray(b)||"object"!=typeof b?b=void 0:c=2;var e,d,g=arguments.length;if(g===c+1){var h=arguments[c];"string"==typeof h?e=h:void 0!==h&&null!==h&&1===h.length&&"string"==typeof h[0]&&(e=h[0])}if(void 0===e)for(d=[];g>c;c++)h=arguments[c],null===h||void 0===h||(Array.isArray(h)?f(a,h,d):h.hasOwnProperty("vnodeSelector")?d.push(h):d.push(k(h)));
return{vnodeSelector:a,properties:b,children:d,text:""===e?void 0:e,domNode:null}};m.dom={create:function(a,c){return c=b(e,c),l(a,document.createElement("div"),void 0,c),v(a,c)},append:function(a,c,d){return d=b(e,d),l(c,a,void 0,d),v(c,d)},insertBefore:function(a,c,d){return d=b(e,d),l(c,a.parentNode,a,d),v(c,d)},merge:function(a,c,d){return d=b(e,d),c.domNode=a,u(a,c,d),v(c,d)},replace:function(a,c,d){return d=b(e,d),l(c,a.parentNode,a,d),a.parentNode.removeChild(a),v(c,d)}};m.createCache=function(){var a,
b;return{invalidate:function(){a=b=void 0},result:function(c,e){if(a)for(var d=0;d<c.length;d++)a[d]!==c[d]&&(b=void 0);return b||(b=e(),a=c),b}}};m.createMapping=function(a,b,c){var e=[],d=[];return{results:d,map:function(f){for(var g=f.map(a),k=d.slice(),n=0,h=0;h<f.length;h++){var q=f[h],l=g[h];if(l===e[n])d[h]=k[n],c(q,k[n],h),n++;else{for(var r=!1,t=1;t<e.length+1;t++){var w=(n+t)%e.length;if(e[w]===l){d[h]=k[w];c(f[h],k[w],h);n=w+1;r=!0;break}}r||(d[h]=b(q,h))}}d.length=f.length;e=g}}};m.createProjector=
function(a){var c,d=b(e,a);d.eventHandlerInterceptor=function(a,b,e,d){return function(){return c.scheduleRender(),b.apply(d.bind||this,arguments)}};var f,g=!0,k=!1,h=[],q=[],l=function(){if(f=void 0,g){g=!1;for(var a=0;a<h.length;a++){var b=q[a]();h[a].update(b)}g=!0}};return c={renderNow:l,scheduleRender:function(){f||k||(f=requestAnimationFrame(l))},stop:function(){f&&(cancelAnimationFrame(f),f=void 0);k=!0},resume:function(){k=!1;g=!0;c.scheduleRender()},append:function(a,b){h.push(m.dom.append(a,
b(),d));q.push(b)},insertBefore:function(a,b){h.push(m.dom.insertBefore(a,b(),d));q.push(b)},merge:function(a,b){h.push(m.dom.merge(a,b(),d));q.push(b)},replace:function(a,b){h.push(m.dom.replace(a,b(),d));q.push(b)},detach:function(a){for(var b=0;b<q.length;b++)if(q[b]===a)return q.splice(b,1),h.splice(b,1)[0];throw Error("renderMaquetteFunction was not found");}}}})},"esri/widgets/support/widgetUtils":function(){define(["require","exports","../../core/Logger","dojo/has"],function(m,l,h,d){Object.defineProperty(l,
"__esModule",{value:!0});var b=d("dojo-debug-messages"),g=h.getLogger("esri.widgets.support.widgetUtils");l.join=function(){for(var d=[],f=0;f<arguments.length;f++)d[f]=arguments[f];return b&&2>d.length&&g.error("[Widget] `join` is intended for 2 or more CSS classes."),d.join(" ")};l.isRtl=function(){return"rtl"===document.dir};l.storeNode=function(d){var f=d.getAttribute("data-node-ref");if(b){if(!f)return void g.error("[Widget] node ref not found, did you forget the 'data-node-ref' attribute?");
if(!(f in this))return void g.error("[Widget] cannot store "+f+" if not defined on instance.")}this[f]=d}})},"esri/widgets/Widget":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor ../core/Evented ../core/HandleRegistry ../core/Logger ../core/watchUtils dojo/_base/lang dojo/dom ./libs/maquette/maquette ../core/Collection".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){var u=a.getLogger("esri.widgets.Widget"),
v=0;return function(a){function g(b,c){b=a.call(this)||this;return b._attached=!1,b.className="",b.destroyed=!1,b.domNode=null,b.visible=!0,b._handles=new f,b.render=b.render.bind(b),b}return h(g,a),g.prototype.normalizeCtorArgs=function(a,b){a=c.mixin({},a);return b&&(a.container=b),a},g.prototype.initialize=function(){var a=this;this._handles.add(this._renderableProps.map(function(b){return e.init(a,b,function(a,c){var e=this;if(r.isCollection(c)&&this._handles.remove(this.declaredClass+":"+b+"-collection-change-event-listener"),
r.isCollection(a))a=a.on("change",function(){return e.scheduleRender()}),this._handles.add(a,this.declaredClass+":"+b+"-collection-change-event-listener");this.scheduleRender()})}));this._delegatedEventNames.length&&this._handles.add(e.init(this,"viewModel",function(){a._get("viewModel")&&a._handles.remove("delegated-events");a._delegatedEventNames.map(function(b){return a.viewModel.on(b,function(c){a.emit(b,c)})})}),"delegated-events");this.postInitialize();this._handles.add(e.whenOnce(this,"container",
function(b){return a._attach(b)}))},g.prototype.postInitialize=function(){},g.prototype.destroy=function(){this.destroyed||(this.viewModel&&this.viewModel.destroy(),this._detach(this.container),this._handles.destroy(),this._set("destroyed",!0))},g.prototype.startup=function(){u.warn("Widget.startup() is deprecated and no longer needed")},Object.defineProperty(g.prototype,"container",{set:function(a){this._get("container")||this._set("container",a)},enumerable:!0,configurable:!0}),g.prototype.castContainer=
function(a){return q.byId(a)},Object.defineProperty(g.prototype,"id",{get:function(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+v++},set:function(a){a&&this._set("id",a)},enumerable:!0,configurable:!0}),g.prototype.scheduleRender=function(){this._projector.scheduleRender()},g.prototype.on=function(a,b){var c=this.inherited(arguments);return this._handles.add(c),c},g.prototype.own=function(a){1<arguments.length&&(a=Array.prototype.slice.call(arguments));this._handles.add(a)},
g.prototype.renderNow=function(){this._projector.renderNow()},g.prototype._attach=function(a){a&&(this._projector.merge(a,this.render),this._attached=!0)},g.prototype._detach=function(a){a&&this._attached&&(this._projector.detach(this.render),a.parentNode&&a.parentNode.removeChild(a),this._attached=!1)},d([b.shared(t.createProjector())],g.prototype,"_projector",void 0),d([b.shared([])],g.prototype,"_renderableProps",void 0),d([b.shared([])],g.prototype,"_delegatedEventNames",void 0),d([b.property({value:null})],
g.prototype,"container",null),d([b.cast("container")],g.prototype,"castContainer",null),d([b.property({readOnly:!0})],g.prototype,"destroyed",void 0),d([b.property({aliasOf:"container"})],g.prototype,"domNode",void 0),d([b.property({dependsOn:["container"]})],g.prototype,"id",null),d([b.property()],g.prototype,"viewModel",void 0),d([b.property()],g.prototype,"visible",void 0),g=d([b.subclass("esri.widgets.Widget")],g)}(b.declared(g,k))})},"esri/widgets/Popup/PopupRenderer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../support/widget ../Widget ./PopupRendererViewModel ../../core/requireUtils ../support/uriUtils dojo/i18n!./nls/PopupRenderer ../../core/watchUtils dojo/keys".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){function r(a,b){return void 0===b?u+"__"+a:u+"__"+a+"-"+b}var u="esri-popup-renderer";return function(l){function u(a){a=l.call(this)||this;return a._chartMap=new Map,a._activeMediaMap=new Map,a._chartRequirePromise=null,a._refreshTimers=new Map,a._mediaInfo=new Map,a.contentEnabled=null,a.graphic=null,a.title=null,a.view=null,a.viewModel=new f,a}return h(u,l),u.prototype.postInitialize=function(){var a=this;this.own(q.init(this,"viewModel.content",function(){return a._setupMediaRefreshTimers()}))},
u.prototype.destroy=function(){this._clearMediaRefreshTimers();this._activeMediaMap.clear();this._activeMediaMap=null;this._cancelChartModules();this._destroyCharts()},u.prototype.render=function(){var a=g.tsx("div",{key:r("loading-container"),"class":"esri-popup-renderer__loading-container"},g.tsx("span",{"class":g.join("esri-icon-loading-indicator esri-rotating","esri-popup-renderer__loading-spinner")})),a=this.viewModel.waitingForContent?a:this._renderContent();return g.tsx("div",{"class":"esri-popup-renderer"},
g.tsx("div",{"class":"esri-popup-renderer__size-container"},g.tsx("div",{"class":"esri-popup-renderer__main-container"},a)))},u.prototype.goToMedia=function(a,b){this._setContentElementMedia(a,b)},u.prototype.nextMedia=function(a){this._pageContentElementMedia(a,"next")},u.prototype.previousMedia=function(a){this._pageContentElementMedia(a,"previous")},u.prototype._cancelChartModules=function(){this._chartRequirePromise&&this._chartRequirePromise.cancel()},u.prototype._destroyChart=function(a){var b=
this._chartMap.get(a);b&&(b.chart.destroy(),b.tooltip.destroy());this._chartMap["delete"](a)},u.prototype._destroyCharts=function(){this._chartMap.forEach(function(a){a.chart.destroy();a.tooltip.destroy()});this._chartMap.clear()},u.prototype._renderContent=function(){this._destroyCharts();var a=this.viewModel.content;return"string"==typeof a?g.tsx("div",{key:r("content-string"),innerHTML:a}):a&&a.isInstanceOf&&a.isInstanceOf(k)?g.tsx("div",{key:r("content-widget")},a.render()):a instanceof HTMLElement?
g.tsx("div",{key:r("content-html-element"),bind:a,afterUpdate:this._attachToNode,afterCreate:this._attachToNode}):a&&"function"==typeof a.postMixInProperties&&"function"==typeof a.buildRendering&&"function"==typeof a.postCreate&&"function"==typeof a.startup?g.tsx("div",{key:r("content-dijit"),bind:a.domNode,afterUpdate:this._attachToNode,afterCreate:this._attachToNode}):Array.isArray(a)?a.length?g.tsx("div",{key:r("content-content-elements")},a.map(this._renderContentElement,this)):null:void 0},u.prototype._renderContentElement=
function(a,b){var c=this.viewModel.contentTypes;switch(a.type){case c.attachments:return this._renderAttachments(a,b);case c.fields:return this._renderFields(a,b);case c.media:return this._renderMedia(a,b);case c.text:return this._renderText(a,b);default:return null}},u.prototype._renderAttachmentInfo=function(a,b){return g.tsx("li",{"class":"esri-popup-renderer__attachments-item",key:r("attachment",b)},g.tsx("a",{"class":"esri-popup-renderer__attachments-item-link",href:a.url,target:"_blank"},g.tsx("span",
{"class":g.join("esri-icon-download","esri-popup-renderer__attachments-item-icon")}),g.tsx("span",{"class":"esri-popup-renderer__attachments-item-title"},a.name||c.noTitle)))},u.prototype._renderAttachments=function(a,b){return(a=a.attachmentInfos)&&a.length?g.tsx("div",{key:r("attachments-element"),"class":g.join("esri-popup-renderer__attachments","esri-popup-renderer__content-element")},g.tsx("div",{"class":"esri-popup-renderer__attachments-title"},c.attach),g.tsx("ul",{"class":"esri-popup-renderer__attachments-items"},
a.map(this._renderAttachmentInfo))):null},u.prototype._renderFieldInfo=function(a,b){var c=this.viewModel,d=c.formattedAttributes.content[b]||c.formattedAttributes.global,f=a.fieldName,c=a.label||f;a=!(!a.format||!a.format.dateFormat);d=e.autoLink(null==d[f]?"":d[f]);a=(k={},k["esri-popup-renderer__field-data--date"]=a,k);return g.tsx("tr",{key:r("fields-element-info-row",b)},g.tsx("th",{key:r("fields-element-info-row-header",b),"class":"esri-popup-renderer__field-header",innerHTML:c}),g.tsx("td",
{key:r("fields-element-info-row-data",b),"class":"esri-popup-renderer__field-data",classes:a,innerHTML:d}));var k},u.prototype._renderFields=function(a,b){var e=this;return(a=a.fieldInfos)?g.tsx("div",{key:r("fields-element",b),"class":g.join("esri-popup-renderer__fields","esri-popup-renderer__content-element")},g.tsx("table",{summary:c.fieldsSummary,key:r("fields-element-table",b)},g.tsx("tbody",{key:r("fields-element-table-body",b)},a.map(function(a){return e._renderFieldInfo(a,b)})))):null},u.prototype._shouldOpenInNewTab=
function(a){void 0===a&&(a="");return!/^(?:mailto:|tel:)/.test(a.trim().toLowerCase())},u.prototype._clearMediaRefreshTimers=function(){this._refreshTimers.forEach(function(a){return clearTimeout(a)});this._refreshTimers.clear()},u.prototype._clearMediaRefreshTimer=function(a){var b=this._refreshTimers.get(a);b&&(clearTimeout(b),this._refreshTimers["delete"](a))},u.prototype._getImageSource=function(a,b){var c=-1!==a.indexOf("?")?"\x26":"?";a=a.split("#");var e=a[1],e=void 0===e?"":e;return""+a[0]+
c+"timestamp\x3d"+b+(e?"#":"")+e},u.prototype._setupMediaRefreshTimer=function(a){var b=this.get("viewModel.content");if(Array.isArray(b)&&(b=b[a])&&"media"===b.type){var c=this._activeMediaMap.get(a);isNaN(c)&&(c=0);(b=b.mediaInfos[c])&&"image"===b.type&&b.refreshInterval&&this._setRefreshTimeout(a,b)}},u.prototype._setupMediaRefreshTimers=function(){var a=this;this._clearMediaRefreshTimers();var b=this.get("viewModel.content");Array.isArray(b)&&b.forEach(function(b,c){return a._setupMediaRefreshTimer(c)})},
u.prototype._updateMediaInfoTimestamp=function(a,b){var c=Date.now();this._mediaInfo.set(b,{timestamp:c,sourceURL:this._getImageSource(a,c)});this.scheduleRender()},u.prototype._setRefreshTimeout=function(a,b){var c=this,e=b.refreshInterval,d=b.value;e&&(b=6E4*e,this._updateMediaInfoTimestamp(d.sourceURL,a),b=setInterval(function(){c._updateMediaInfoTimestamp(d.sourceURL,a)},b),this._refreshTimers.set(a,b))},u.prototype._renderMediaInfoType=function(a,b){var c=a.value,e=a.title,e=void 0===e?"":e,
d=a.type,f=a.refreshInterval,k=c.sourceURL,c=c.linkURL;return"image"===d?(a=this._shouldOpenInNewTab(c)?"_self":"_blank",k=(f=f?this._mediaInfo.get(b):null)?f.sourceURL:k,b=g.tsx("img",{alt:e,key:r("media-image-"+(f?f.timestamp:0),b),src:k}),(e=c?g.tsx("a",{title:e,href:c,target:a},b):null)?e:b):-1!==d.indexOf("chart")?g.tsx("div",{key:r("chart",b),bind:this,"data-media-info":a,"data-content-element-index":b,"class":"esri-popup-renderer__media-chart",afterCreate:this._getChartDependencies,afterUpdate:this._getChartDependencies}):
void 0},u.prototype._getChartDependencies=function(b){var c=this,e=b["data-media-info"],d=b["data-content-element-index"],f=e.value,g=f.theme||"Claro",k=e.type,e=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],h=g;"string"==typeof g&&(h=g.replace(/\./g,"/"),-1===h.indexOf("/")&&(h="dojox/charting/themes/"+h));e.push(h);this._cancelChartModules();this._chartRequirePromise=a.when(m,e).then(function(a){c._renderChart(b,d,k,f,a[0],a[1],a[2]);c._chartRequirePromise=null})},u.prototype._renderChart=
function(a,b,c,e,d,f,g){a=new d(a,{margins:{l:4,t:4,r:4,b:4}});switch(g&&a.setTheme(g),c){case "pie-chart":a.addPlot("default",{type:"Pie",labels:!1});a.addSeries("Series A",e.fields);break;case "line-chart":a.addPlot("default",{type:"Markers"});a.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});a.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});e.fields.forEach(function(a,b){a.x=b+1});a.addSeries("Series A",e.fields);break;case "column-chart":a.addPlot("default",
{type:"Columns",gap:3});a.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});a.addSeries("Series A",e.fields);break;case "bar-chart":a.addPlot("default",{type:"Bars",gap:3}),a.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),a.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),a.addSeries("Series A",e.fields)}c=new f(a);a.render();this._chartMap.set(b,{chart:a,tooltip:c})},u.prototype._renderMediaInfo=function(a,b){this._destroyChart(b);var c=
this._renderMediaInfoType(a,b),e=a.title?g.tsx("div",{key:r("media-title",b),"class":"esri-popup-renderer__media-item-title",innerHTML:a.title}):null;a=a.caption?g.tsx("div",{key:r("media-caption",b),"class":"esri-popup-renderer__media-item-caption",innerHTML:a.caption}):null;return g.tsx("div",{key:r("media-container",b),"class":"esri-popup-renderer__media-item-container"},g.tsx("div",{key:r("media-item-container",b),"class":"esri-popup-renderer__media-item"},c),e,a)},u.prototype._renderMediaStatsItem=
function(a,b,c){c="chart"===c?g.join("esri-popup-renderer__media-chart-icon","esri-icon-chart"):g.join("esri-popup-renderer__media-image-icon","esri-icon-media");return g.tsx("li",{"class":"esri-popup-renderer__media-image-summary"},g.tsx("span",{"class":"esri-popup-renderer__media-count","aria-label":a},"("+b+")"),g.tsx("span",{"aria-hidden":"true","class":c}))},u.prototype._renderMediaPageButton=function(a,b){var e=(a="previous"===a)?c.previous:c.next,d=a?g.join("esri-popup-renderer__button","esri-popup-renderer__media-previous"):
g.join("esri-popup-renderer__button","esri-popup-renderer__media-next"),f=a?g.join("esri-popup-renderer__icon","esri-popup-renderer__media-previous-icon","esri-icon-left-triangle-arrow"):g.join("esri-popup-renderer__icon","esri-popup-renderer__media-next-icon","esri-icon-right-triangle-arrow"),k=a?g.join("esri-popup-renderer__icon","esri-popup-renderer__media-previous-icon--rtl","esri-icon-right-triangle-arrow"):g.join("esri-popup-renderer__icon","esri-popup-renderer__media-next-icon--rtl","esri-icon-left-triangle-arrow"),
h=a?this._previousClick:this._nextClick;return g.tsx("div",{key:r(a?"previous":"next",b),title:e,tabIndex:0,role:"button","class":d,"data-content-element-index":b,bind:this,onkeydown:h,onclick:h},g.tsx("span",{"aria-hidden":"true","class":f}),g.tsx("span",{"aria-hidden":"true","class":k}),g.tsx("span",{"class":"esri-icon-font-fallback-text"},e))},u.prototype._handleMediaKeyup=function(a){var b=a.currentTarget["data-content-element-index"],c=a.keyCode;c===t.LEFT_ARROW&&(a.stopPropagation(),this.previousMedia(b));
c===t.RIGHT_ARROW&&(a.stopPropagation(),this.nextMedia(b))},u.prototype._renderMedia=function(a,b){a=a.mediaInfos;var e=this._getMediaStats(a),d=e.total,f=(k={},k["esri-popup-renderer--media-pagination-visible"]=1<e.total,k),k=this._renderMediaStatsItem(c.numImages,e.images,"image"),e=this._renderMediaStatsItem(c.numCharts,e.charts,"chart"),h=this._renderMediaPageButton("previous",b),n=this._renderMediaPageButton("next",b),q=this._activeMediaMap.get(b);return isNaN(q)&&(this._activeMediaMap.set(b,
0),q=0),d?g.tsx("div",{key:r("media-element",b),"data-content-element-index":b,bind:this,onkeyup:this._handleMediaKeyup,"class":g.join("esri-popup-renderer__media","esri-popup-renderer__content-element"),classes:f},g.tsx("ul",{"class":"esri-popup-renderer__media-summary"},k,e),g.tsx("div",{key:r("media-element-container",b),"class":"esri-popup-renderer__media-container"},h,this._renderMediaInfo(a[q],b),n)):null;var k},u.prototype._renderText=function(a,b){return a.text?g.tsx("div",{key:r("text-element",
b),innerHTML:a.text,"class":g.join("esri-popup-renderer__text","esri-popup-renderer__content-element")}):null},u.prototype._attachToNode=function(a){a.appendChild(this)},u.prototype._getMediaStats=function(a){var b=0,c=0;return a.forEach(function(a){a=a.type;"image"===a?b++:-1!==a.indexOf("chart")&&c++}),{total:c+b,images:b,charts:c}},u.prototype._setContentElementMedia=function(a,b){this._clearMediaRefreshTimer(a);var c=this.viewModel.content;(c=(c=c&&c[a])&&c.mediaInfos)&&c.length&&(this._activeMediaMap.set(a,
(b+c.length)%c.length),this._setupMediaRefreshTimer(a),this.scheduleRender())},u.prototype._pageContentElementMedia=function(a,b){b="previous"===b?-1:1;b=this._activeMediaMap.get(a)+b;this._setContentElementMedia(a,b)},u.prototype._previousClick=function(a){this.previousMedia(a.currentTarget["data-content-element-index"])},u.prototype._nextClick=function(a){this.nextMedia(a.currentTarget["data-content-element-index"])},d([b.aliasOf("viewModel.contentEnabled")],u.prototype,"contentEnabled",void 0),
d([b.aliasOf("viewModel.graphic")],u.prototype,"graphic",void 0),d([b.aliasOf("viewModel.title")],u.prototype,"title",void 0),d([b.aliasOf("viewModel.view")],u.prototype,"view",void 0),d([b.property({type:f}),g.renderable(["viewModel.waitingForContent","viewModel.content"])],u.prototype,"viewModel",void 0),d([g.accessibleHandler()],u.prototype,"_previousClick",null),d([g.accessibleHandler()],u.prototype,"_nextClick",null),u=d([b.subclass("esri.widgets.Popup.PopupRenderer")],u)}(b.declared(k))})},
"esri/widgets/Popup/PopupRendererViewModel":function(){define("../Widget ../../core/Accessor ../../core/date ../../core/Error ../../core/HandleRegistry ../../core/lang ../../core/Logger ../../core/urlUtils ../../core/promiseUtils ../../core/watchUtils ../../request ../../support/arcadeUtils ../../tasks/support/StatisticDefinition ../../tasks/support/Query ../../tasks/QueryTask dojo/promise/all dojo/i18n!dojo/cldr/nls/number dojox/html/entities".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,
x,y){var n=/\'/g,w=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,z=/^\s*expression\//i,C=/(\{([^\{\r\n]+)\})/g,B={attachments:"attachments",fields:"fields",media:"media",text:"text"},F=k.getLogger("esri.widgets.Popup.PopupRendererViewModel");return l.createSubclass({declaredClass:"esri.widgets.Popup.PopupRendererViewModel",properties:{content:{readOnly:!0},contentEnabled:!0,contentTypes:{readOnly:!0},formattedAttributes:{readOnly:!0},graphic:{},title:{readOnly:!0},view:{},waitingForContent:{readOnly:!0}},
constructor:function(){this._handles=new b},initialize:function(){this._handles.add([e.watch(this,["graphic","graphic.popupTemplate.title","graphic.popupTemplate.content","graphic.popupTemplate.fieldInfos","contentEnabled"],function(){this._updateGraphic(this.graphic,this.contentEnabled)}.bind(this))]);this._updateGraphic(this.graphic,this.contentEnabled)},destroy:function(){this._handles.destroy();this._handles=null;this._clearRelatedInfo();this._cancelPromises();this.graphic=null;this._set("title",
null);this._set("content",null);this._set("waitingForContent",null)},content:null,contentEnabled:!0,contentTypes:B,formattedAttributes:null,graphic:null,title:"",view:null,waitingForContent:!1,_handles:null,_contentPromise:null,_contentElementPromises:null,_relatedRecordsPromise:null,_relatedRecordsQueryPromises:[],_relatedLayersInfo:null,_relatedInfo:null,_addValuesToHref:function(a,b,c,e){return b=this._trimString(b),g.substitute((b?"{"!==b[0]:1)?e:c,a)},_cancelPromises:function(){this._contentElementPromises&&
(this._contentElementPromises.forEach(function(a){a.cancel()},this),this._contentElementPromises=null);this._contentPromise&&(this._contentPromise.cancel(),this._contentPromise=null);this._relatedRecordsQueryPromises.forEach(function(a){a.cancel()});this._relatedRecordsQueryPromises.length=0;this._relatedRecordsPromise&&(this._relatedRecordsPromise.cancel(),this._relatedRecordsPromise=null)},_clearRelatedInfo:function(){this._relatedInfo=this._relatedLayersInfo=null},_compileContent:function(a,b){var c=
a.content;if(c&&(c.nodeName||c&&c&&"function"==typeof c.postMixInProperties&&"function"==typeof c.buildRendering&&"function"==typeof c.postCreate&&"function"==typeof c.startup||c&&c.isInstanceOf&&c.isInstanceOf(m)))return c;if("string"==typeof c)return this._compileText(a,{type:B.text,text:c}).text;if(Array.isArray(c))return c.map(function(c,e){e=(e=b&&b[e])&&e.value;switch(c.type){case B.attachments:return this._proxyAttachments(c,e);case B.fields:return this._compileFields(a,c);case B.media:return this._compileMedia(a,
c);case B.text:return this._compileText(a,c)}},this);if(c)try{throw new d(this.declaredClass+"::invalid content type.");}catch(R){F.warn(R.stack)}},_compileFields:function(a,b){b=g.clone(b);var c=(a=a.template)&&a.expressionInfos;a=a&&g.clone(a.fieldInfos);a=b.fieldInfos||a;var e=[];return a&&a.forEach(function(a){var b=a.fieldName.toLowerCase();if(a.hasOwnProperty("visible")?a.visible:1)b=this._isExpressionField(b)?this._getExpressionInfo(c,b):null,a.label=b?b.title:a.label,e.push(a)},this),b.fieldInfos=
e,b},_compileMedia:function(a,b){var c,e;b=g.clone(b);var d=b.mediaInfos,f=a.attributes,k=a.layer,h=this.formattedAttributes.global,n=a.substOptions;return d&&(c=[],d.forEach(function(b){e=0;var d=b.value;switch(b.type){case "image":var q=d.sourceURL,q=q&&this._trimString(g.substitute(f,this._fixTokens(q,k)));e=!!q;break;case "pie-chart":case "line-chart":case "column-chart":case "bar-chart":var E,q=d.normalizeField;d.fields=d.fields.map(function(a){return E=this._getLayerFieldInfo(k,a),E?E.name:
a},this);q&&(E=this._getLayerFieldInfo(k,q),d.normalizeField=E?E.name:q);e=d.fields.some(function(a){return g.isDefined(f[a])||-1!==a.indexOf("relationships/")&&this._relatedInfo},this);break;default:return}if(e){b=g.clone(b);var d=b.value,q=b.title?this._processFieldsInLinks(this._fixTokens(b.title,k),f):"",p=b.caption?this._processFieldsInLinks(this._fixTokens(b.caption,k),f):"";if(b.title=q?this._trimString(g.substitute(h,q,n)):"",b.caption=p?this._trimString(g.substitute(h,p,n)):"","image"===
b.type)d.sourceURL=g.substitute(f,this._fixTokens(d.sourceURL,k)),d.linkURL&&(d.linkURL=this._trimString(g.substitute(f,this._fixTokens(d.linkURL,k))));else{var A,K=(q=a.template)&&q.fieldInfos;d.fields.forEach(function(a,b){if(-1!==a.indexOf("relationships/"))a=this._getRelatedChartInfos(k,K,a,d,f,n),Array.isArray(a)?d.fields=a:d.fields[b]=a;else{var c=f[a],c=void 0===c?null:c;A=f[d.normalizeField]||0;c&&A&&(c/=A);var e=K&&this._getFieldInfo(K,a);d.fields[b]={y:c,tooltip:(e&&e.label||a)+":"+this._formatValue(c,
{fieldInfos:K,fieldName:a,layer:k,substOptions:n,preventPlacesFormatting:!!A})}}},this)}c.push(b)}},this)),b.mediaInfos=c,b},_compileText:function(a,b){if((b=g.clone(b))&&b.text){var c=a.attributes,e=this.formattedAttributes.global,d=a.substOptions;a=this._processFieldsInLinks(this._fixTokens(b.text,a.layer),c);b.text=this._trimString(g.substitute(e,a,d))}return b},_compileTitle:function(a){var b="",c=a.title,e=a.layer,d=a.attributes,f=a.substOptions,k=this.formattedAttributes.global;c&&("function"==
typeof c&&(c=c.call(null,{graphic:a.graphic})),"string"==typeof c)&&(a=this._processFieldsInLinks(this._fixTokens(c,e),d),b=this._trimString(g.substitute(k,a,f)));return b},_getExpressionInfo:function(a,b){if(this._isExpressionField(b)){b=b.replace(z,"");b=b.toLowerCase();var c;return a.some(function(a){return a.name.toLowerCase()===b&&(c=a),!!c}),c}},_createGraphicInfo:function(a,b){var c=a.popupTemplate,e=c&&c.title,d=c&&c.content,f=a.layer,k=f&&f._getDateOpts&&f._getDateOpts().properties,n=g.clone(a.attributes)||
{},q={dateFormat:{properties:k,formatter:"DateFormat"+h.getFormat("short-date-short-time")}};return{graphic:a,template:c,title:e,content:d,contentEnabled:b,layer:f,attributes:n,properties:k,substOptions:q}},_fixTokens:function(a,b){return a.replace(C,function(a,c,e){return(a=this._getLayerFieldInfo(b,e))?"{"+a.name+"}":c}.bind(this))},_encodeAttributes:function(a){var b=g.clone(a)||{};return Object.keys(b).forEach(function(a){var c=b[a];"string"==typeof c&&(c=encodeURIComponent(c).replace(n,"\x26apos;"),
b[a]=c)}),b},_formatAttributesToFieldInfos:function(a,b,c,e,d){a.forEach(function(f){var g=f.fieldName,k=this._getLayerFieldInfo(b,g);k&&(g=f.fieldName=k.name);if(d[g]=this._formatValue(d[g],{fieldInfos:a,fieldName:g,layer:b,substOptions:c}),e&&f.format&&f.format.dateFormat)f=e.indexOf(g),-1<f&&e.splice(f,1)},this)},_getArcadeViewingMode:function(a){return a&&"local"===a.viewingMode?"localScene":"globalScene"},_formatAttributes:function(a,b,c,e,d,f,k,h){var n=g.clone(d);if(k&&k.forEach(function(a){var b=
"expression/"+a.name;a=h[a.name];var c=this.view,c=c&&q.getViewInfo({viewingMode:"3d"===c.type?this._getArcadeViewingMode(c):"map",scale:c.scale,spatialReference:c.spatialReference});a=q.executeFunction(a&&a.compiledFunc,q.createExecContext(f,c));"string"==typeof a&&(a=y.encode(a));n[b]=a},this),this._relatedInfo&&Object.keys(this._relatedInfo).forEach(function(a){var b=this._relatedInfo[a];a=this._relatedLayersInfo[a];b&&(b.relatedFeatures.forEach(this._relatedFeaturesAttributes.bind(this,a,d,n)),
b.relatedStatsFeatures.forEach(this._relatedStatsAttributes.bind(this,a,d,n)))},this),a&&this._formatAttributesToFieldInfos(a,b,c,e,n),b){var H=b.typeIdField;Object.keys(d).forEach(function(a){if(-1===a.indexOf("relationships/")){var c=d[a];if(g.isDefined(c)){var e=this._getDomainName(b,f,a,c);g.isDefined(e)?n[a]=e:a===H&&(c=this._getTypeName(b,f,c),g.isDefined(c)&&(n[a]=c))}}},this)}return n},_formatValue:function(a,b){var c=b.fieldInfos,e=b.fieldName,d=b.substOptions,c=c&&this._getFieldInfo(c,e),
f=g.clone(c),c=b.preventPlacesFormatting;(b=this._getLayerFieldInfo(b.layer,e))&&"date"===b.type&&(b=f.format||{},b.dateFormat=b.dateFormat||"short-date-short-time",f.format=b);b=f&&f.format;e="number"==typeof a&&d.dateFormat.properties&&-1===d.dateFormat.properties.indexOf(e)&&(!b||!b.dateFormat);if(!g.isDefined(a)||!f||!g.isDefined(b))return e?this._forceLTR(a):a;var k="",n=[],f=b.hasOwnProperty("places")||b.hasOwnProperty("digitSeparator"),q=b.hasOwnProperty("digitSeparator")?b.digitSeparator:
!0;if(f)k="NumberFormat",g.isDefined(b.places)&&(!c||0<b.places)&&(n.push("places: "+Number(b.places)),k+="("+n.join(",")+")");else{if(!b.dateFormat)return e?this._forceLTR(a):a;k="DateFormat"+h.getFormat(b.dateFormat)||h.getFormat("short-date-short-time")}a=g.substitute({myKey:a},"{myKey:"+k+"}",d)||"";return f&&!q&&x.group&&(a=a.replace(new RegExp("\\"+x.group,"g"),"")),e?this._forceLTR(a):a},_forceLTR:function(a){return"\x26lrm;"+a},_getDomainName:function(a,b,c,e){return(a=a.getFieldDomain&&a.getFieldDomain(c,
{feature:b}))&&a.codedValues?a.getName(e):null},_getFieldInfo:function(a,b){var c;b=b.toLowerCase();for(var e=0;e<a.length;e++){var d=a[e];if(d.fieldName&&d.fieldName.toLowerCase()===b){c=d;break}}return c},_getLayerFieldInfo:function(a,b){return b&&a&&a.getField?a.getField(b):null},_getTypeName:function(a,b){return(a=a.getType&&a.getType(b))&&a.name},_processFieldsInLinks:function(a,b){var c=this._encodeAttributes(b);return a&&(a=a.replace(w,function(a,e,d){return this._addValuesToHref(a,e||d,b,
c)}.bind(this))),a},_proxyAttachments:function(a,b){a=g.clone(a);b&&!(b instanceof d)&&b.attachmentInfos&&b.attachmentInfos.length&&(b=b.attachmentInfos.map(function(a){return a.url=f.addProxy(a.url),a},this),a.attachmentInfos=b);return a},_queryAttachments:function(b){var c=b.layer;if(!c)return a.resolve();"scene"===c.type&&c.associatedLayer&&(c=c.associatedLayer);var e=b.attributes;b=c&&c.objectIdField;e=e&&b&&e[b];return b&&c.get("capabilities.data.supportsAttachment")&&e?this._queryAttachmentInfos(c,
e):void 0},_queryAttachmentInfos:function(a,b){var e=a.url+"/"+a.layerId+"/"+b+"/attachments",d=a.token||"";return c(e,{query:{f:"json",token:d},callbackParamName:"callback"}).then(function(a){a=a.data;return a.attachmentInfos.forEach(function(a){a.url=e+"/"+a.id;d&&(a.url+="?token\x3d"+d);a.objectId=b}),a})},_queryContentElements:function(b){var c=b.content;if(!c||!Array.isArray(c))return a.resolve();var e=[],d={};return c.forEach(function(a,c){a.type===B.attachments&&(a=this._queryAttachments(b))&&
(d[c]=a,e.push(a))},this),this._contentElementPromises=e,0===e.length?a.resolve():a.eachAlways(d).always(function(a){return this._contentElementPromises=null,a}.bind(this))},_trimString:function(a){return(a||"").trim()},_getContent:function(b){var c=b.template,c=c&&c.content;return"function"==typeof c&&(c=c.call(null,{graphic:b.graphic})),c&&"function"==typeof c.then?c:a.resolve(c)},_updateContent:function(b){var c;return b.contentEnabled?(c=this._getContent(b).then(function(a){return b.content=a,
this._queryContentElements(b)}.bind(this)).then(function(a){this._set("content",this._compileContent(b,a))}.bind(this)).otherwise(function(a){F.log("error loading template",a)}.bind(this)).then(function(){this._contentPromise=null}.bind(this)),this._contentPromise=c,c):c=a.resolve()},_isExpressionField:function(a){return z.test(a)},_compileExpressions:function(a){if(a){var b={};return a.forEach(function(a){b[a.name]={compiledFunc:q.createFunction(a.expression)}}),b}},_createFormattedAttributes:function(a){var b=
a.graphic,c=a.attributes,e=a.layer,d=a.template,f=d&&d.fieldInfos,g=d&&d.expressionInfos,k=this._compileExpressions(g),h=a.substOptions,n=a.properties,q={global:this._formatAttributes(f,e,h,n,c,b,g,k),content:[]};a=d&&d.content;return Array.isArray(a)&&a.forEach(function(a,d){a.type===B.fields&&a.fieldInfos&&(q.content[d]=this._formatAttributes(a.fieldInfos,e,h,n,c,b,g,k))},this),q},_queryGraphicInfo:function(a,b){var c=this._createGraphicInfo(a,b);return this._checkForRelatedRecords(c).then(function(){return this._set("formattedAttributes",
this._createFormattedAttributes(c)),this._set("title",this._compileTitle(c)),this._updateContent(c)}.bind(this))},_updateGraphic:function(a,b){this._handles&&(this._clearRelatedInfo(),this._cancelPromises(),this._set("title",""),this._set("content",null),this._set("formattedAttributes",null),this._set("waitingForContent",!1),a)&&(this._set("waitingForContent",!0),this._relatedRecordsPromise=this._queryGraphicInfo(a,b).always(function(){this._relatedRecordsPromise=null;this._relatedRecordsQueryPromises.length=
0;this._set("waitingForContent",!1)}.bind(this)))},_getAllFieldInfos:function(a){var b=[],c=a.template,e=c&&c.fieldInfos;a=a.contentEnabled;if(e&&(b=b.concat(e)),a)c=c&&c.content,Array.isArray(c)&&c.forEach(function(a){b=b.concat(a&&a.fieldInfos)},this);return b},_checkForRelatedRecords:function(b){var c=this._getAllFieldInfos(b).filter(function(a){return a&&a.fieldName&&-1!==a.fieldName.indexOf("relationships/")},this);return b.layer&&c&&0<c.length?this._getRelatedRecords({graphic:b.graphic,fieldsInfo:c}):
a.resolve()},_relatedFeaturesAttributes:function(a,b,c,e){Object.keys(e.attributes).forEach(function(d){if("esriRelCardinalityOneToOne"===a.relation.cardinality){var f=this._toRelatedFieldName([a.relation.id,d]);b[f]=c[f]=e.attributes[d]}},this)},_relatedStatsAttributes:function(a,b,c,e){Object.keys(e.attributes).forEach(function(d){var f=this._toRelatedFieldName([a.relation.id,d]);b[f]=c[f]=e.attributes[d]},this)},_getRelatedChartInfos:function(a,b,c,e,d,f){var g,k,h,n,q,l,E;return g=[],E=this._fromRelatedFieldName(c),
q=E[0],k=this._relatedInfo[q],l=this._relatedLayersInfo[q],k&&k.relatedFeatures.forEach(function(p){var A,K=p.attributes;Object.keys(K).forEach(function(p){p===E[1]&&((A={},n=K[p],e.normalizeField&&(h=-1!==e.normalizeField.indexOf("relationships/")?K[this._fromRelatedFieldName(e.normalizeField)[1]]:d[e.normalizeField]),n&&h&&(n/=h),e.tooltipField)?-1!==e.tooltipField.indexOf("relationships/")?(p=this._fromRelatedFieldName(e.tooltipField)[1],p=K[p],A.tooltip=p+": "+this._formatValue(n,{fieldInfos:b,
fieldName:p,layer:a,substOptions:f,preventPlacesFormatting:!!h})):((p=this._getLayerFieldInfo(a,c))&&(c=p.name),A.tooltip=c+": "+this._formatValue(n,{fieldInfos:b,fieldName:e.tooltipField,layer:a,substOptions:f,preventPlacesFormatting:!!h})):A.tooltip=n,A.y=n,g.push(A))},this)},this),"esriRelCardinalityOneToMany"===l.relation.cardinality||"esriRelCardinalityManyToMany"===l.relation.cardinality?g:g[0]},_getRelatedRecords:function(a){var b=a.graphic;return this._relatedLayersInfo?this._queryRelatedLayers(b).then(function(a){return this._setRelatedRecords(a),
a}.bind(this)):this._getRelatedLayersInfo(a).then(function(a){return Object.keys(a).forEach(function(b){a[b]&&(this._relatedLayersInfo[b].relatedLayerInfo=a[b].data)},this),this._queryRelatedLayers(b).then(function(a){return this._setRelatedRecords(a),a}.bind(this))}.bind(this))},_getRelatedLayersInfo:function(a){var b,e=a.fieldsInfo,d={};return b=a.graphic.layer,this._relatedLayersInfo||(this._relatedLayersInfo={}),e.forEach(function(a){var c,e,d,f,g;if(c=this._fromRelatedFieldName(a.fieldName),
e=c[0],d=c[1],e)this._relatedLayersInfo[e]||((c=b&&b.relationships)&&c.some(function(a){return a.id==e?(g=a,!0):void 0}),g&&(this._relatedLayersInfo[e]={relation:g,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[e]&&(this._relatedLayersInfo[e].relatedFields.push(d),a.statisticType&&(f=new t({statisticType:a.statisticType,onStatisticField:d,outStatisticFieldName:d}),this._relatedLayersInfo[e].outStatistics.push(f)))},this),Object.keys(this._relatedLayersInfo).forEach(function(a){var e,
f;this._relatedLayersInfo[a]&&(e=this._relatedLayersInfo[a].relation,f=b.url+"/"+e.relatedTableId,this._relatedLayersInfo[a].relatedLayerUrl=f,d[a]=c(f,{query:{f:"json"},callbackParamName:"callback"}))},this),v(d)},_queryRelatedLayers:function(a){var b={};return Object.keys(this._relatedLayersInfo).forEach(function(c){b[c]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[c]})},this),v(b)},_queryRelatedLayer:function(a){var b,c,e,d,f,g,k,h,n,q,l,E,p,A;return b=a.graphic,c=b.layer,
e=c.layerId,E=a.relatedInfo,d=E.relatedLayerInfo,p=E.relatedLayerUrl,A=E.relation,d&&d.relationships&&d.relationships.some(function(a){return a.relatedTableId===parseInt(e,10)?(f=a,!0):void 0}),f&&(d.fields.some(function(a){if(a.name===f.keyField)return g=-1!==["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(a.type)?"number":"string",!0}),q="string"===g?f.keyField+"\x3d'"+b.attributes[A.keyField]+"'":f.keyField+"\x3d"+b.attributes[A.keyField],
k=new r({where:q,outFields:E.relatedFields}),E.outStatistics&&0<E.outStatistics.length&&d.supportsStatistics&&(l=new r({where:k.where,outFields:k.outFields,outStatistics:E.outStatistics})),h=new u({url:p}),n=[h.execute(k)],l&&n.push(h.execute(l))),this._relatedRecordsQueryPromises=this._relatedRecordsQueryPromises.concat(n),v(n)},_setRelatedRecords:function(a){this._relatedInfo=[];Object.keys(a).forEach(function(b){if(a[b]){var c=a[b];this._relatedInfo[b]={relatedFeatures:c[0].features};g.isDefined(c[1])&&
(this._relatedInfo[b].relatedStatsFeatures=c[1].features)}},this)},_fromRelatedFieldName:function(a){return-1!==a.indexOf("relationships/")?a.split("/").slice(1):[]},_toRelatedFieldName:function(a){return a&&0<a.length?"relationships/"+a[0]+"/"+a[1]:""}})})},"esri/tasks/support/StatisticDefinition":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport".split(" "),function(m,l,h,
d,b,g){return function(g){function f(a){a=g.call(this)||this;return a.maxPointCount=void 0,a.maxRecordCount=void 0,a.maxVertexCount=void 0,a.onStatisticField=null,a.outStatisticFieldName=null,a.statisticType=null,a}return h(f,g),a=f,f.prototype.clone=function(){return new a({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType})},
d([b.property({type:Number,json:{write:!0}})],f.prototype,"maxPointCount",void 0),d([b.property({type:Number,json:{write:!0}})],f.prototype,"maxRecordCount",void 0),d([b.property({type:Number,json:{write:!0}})],f.prototype,"maxVertexCount",void 0),d([b.property({type:String,json:{write:!0}})],f.prototype,"onStatisticField",void 0),d([b.property({type:String,json:{write:!0}})],f.prototype,"outStatisticFieldName",void 0),d([b.property({type:String,json:{write:!0}})],f.prototype,"statisticType",void 0),
f=a=d([b.subclass("esri.tasks.support.StatisticDefinition")],f);var a}(b.declared(g))})},"esri/tasks/support/Query":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../TimeExtent ../../core/accessorSupport/decorators ../../core/JSONSupport ../../core/lang ../../core/kebabDictionary ../../geometry/SpatialReference ../../geometry/support/typeUtils ../../geometry/support/jsonUtils ../../symbols/support/typeUtils ../../symbols/support/jsonUtils ./QuantizationParameters ./StatisticDefinition".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){var x=a({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),y=a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",
esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(a){function k(b){b=a.call(this,b)||this;return b.distance=void 0,b.geometry=null,b.geometryPrecision=void 0,b.groupByFieldsForStatistics=null,b.maxAllowableOffset=void 0,b.multipatchOption=null,b.num=void 0,b.objectIds=null,b.orderByFields=null,b.outFields=null,b.outSpatialReference=null,b.outStatistics=null,b.pixelSize=null,b.quantizationParameters=null,b.relationParameter=null,b.resultType=null,
b.returnDistinctValues=!1,b.returnGeometry=!1,b.returnCentroid=!1,b.returnExceededLimitFeatures=!0,b.returnJSON=!1,b.returnM=!1,b.returnZ=!1,b.spatialRelationship="intersects",b.start=void 0,b.sqlFormat=null,b.text=null,b.timeExtent=null,b.units="meters",b.where=null,b}return h(k,a),n=k,k.prototype.writeStart=function(a,b,c){b.resultOffset=this.start;b.resultRecordCount=this.num||10;b.where="1\x3d1"},k.prototype.writeWhere=function(a,b,c){b.where=a||"1\x3d1"},k.prototype.clone=function(){return new n(f.clone({distance:this.distance,
geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,maxAllowableOffset:this.maxAllowableOffset,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,relationParameter:this.relationParameter,resultType:this.resultType,
returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnJSON:this.returnJSON,returnM:this.returnM,returnZ:this.returnZ,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.text,text:this.text,timeExtent:this.timeExtent,units:this.units,where:this.where}))},d([g.property({type:Number,json:{write:!0}})],k.prototype,"distance",void 0),d([g.property({types:c.types,
json:{read:q.fromJSON,write:!0}})],k.prototype,"geometry",void 0),d([g.property({type:Number,json:{write:!0}})],k.prototype,"geometryPrecision",void 0),d([g.property({type:[String],json:{write:!0}})],k.prototype,"groupByFieldsForStatistics",void 0),d([g.property({type:Number,json:{write:!0}})],k.prototype,"maxAllowableOffset",void 0),d([g.property({type:String,json:{write:!0}})],k.prototype,"multipatchOption",void 0),d([g.property({type:Number,json:{read:{source:"resultRecordCount"}}})],k.prototype,
"num",void 0),d([g.property({type:[Number],json:{write:!0}})],k.prototype,"objectIds",void 0),d([g.property({type:[String],json:{write:!0}})],k.prototype,"orderByFields",void 0),d([g.property({type:[String],json:{write:!0}})],k.prototype,"outFields",void 0),d([g.property({type:e,json:{read:{source:"outSR"},write:{target:"outSR"}}})],k.prototype,"outSpatialReference",void 0),d([g.property({type:[v],json:{write:!0}})],k.prototype,"outStatistics",void 0),d([g.property({types:t.types,json:{read:r.read,
write:!0}})],k.prototype,"pixelSize",void 0),d([g.property({type:u,json:{write:!0}})],k.prototype,"quantizationParameters",void 0),d([g.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy:function(a){return{enabled:"relation"===this.spatialRelationship}}}}})],k.prototype,"relationParameter",void 0),d([g.property({type:String,json:{write:!0}})],k.prototype,"resultType",void 0),d([g.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],
k.prototype,"returnDistinctValues",void 0),d([g.property({type:Boolean,json:{write:!0}})],k.prototype,"returnGeometry",void 0),d([g.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],k.prototype,"returnCentroid",void 0),d([g.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:!a}}}}})],k.prototype,"returnExceededLimitFeatures",void 0),d([g.property({type:Boolean,json:{read:!1,write:!1}})],k.prototype,"returnJSON",void 0),d([g.property({type:Boolean,
json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],k.prototype,"returnM",void 0),d([g.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],k.prototype,"returnZ",void 0),d([g.property({type:String,json:{read:{source:"spatialRel",reader:x.read},write:{target:"spatialRel",writer:x.write}}})],k.prototype,"spatialRelationship",void 0),d([g.property({type:Number})],k.prototype,"start",void 0),d([g.writer("start"),g.writer("num")],k.prototype,"writeStart",null),
d([g.property({type:String,json:{write:!0}})],k.prototype,"sqlFormat",void 0),d([g.property({type:String,json:{write:!0}})],k.prototype,"text",void 0),d([g.property({type:b,json:{write:!0}})],k.prototype,"timeExtent",void 0),d([g.property({type:String,json:{read:y.read,write:{writer:y.write,overridePolicy:function(a){return{enabled:0<this.distance}}}}})],k.prototype,"units",void 0),d([g.property({type:String,json:{write:{overridePolicy:function(a){return{enabled:null!=a||0<this.start}}}}})],k.prototype,
"where",void 0),d([g.writer("where")],k.prototype,"writeWhere",null),k=n=d([g.subclass("esri.tasks.support.Query")],k);var n}(g.declared(k))})},"esri/TimeExtent":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/accessorSupport/decorators ./core/JSONSupport".split(" "),function(m,l,h,d,b,g){var k={milliseconds:{getter:"getUTCMilliseconds",setter:"setUTCMilliseconds",multiplier:1},seconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",multiplier:1},
minutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},hours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},days:{getter:"getUTCDate",setter:"setUTCDate",multiplier:1},weeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},months:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},years:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},decades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},centuries:{getter:"getUTCFullYear",setter:"setUTCFullYear",
multiplier:100}};return function(f){function a(a,b){a=f.call(this)||this;return a.endTime=null,a.startTime=null,a}return h(a,f),e=a,a.prototype.normalizeCtorArgs=function(a,b){return!a||a instanceof Date?{startTime:a,endTime:b}:a},a.prototype.readEndTime=function(a,b){return null!=b.endTime?new Date(b.endTime):null},a.prototype.writeEndTime=function(a,b,e){b.endTime=a?a.getTime():null},a.prototype.readStartTime=function(a,b){return null!=b.startTime?new Date(b.startTime):null},a.prototype.writeStartTime=
function(a,b,e){b.startTime=a?a.getTime():null},a.prototype.clone=function(){return new e({endTime:this.endTime,startTime:this.startTime})},a.prototype.intersection=function(a){if(!a)return null;var b,c,d=this.startTime?this.startTime.getTime():-(1/0),f=this.endTime?this.endTime.getTime():1/0,g=a.startTime?a.startTime.getTime():-(1/0);a=a.endTime?a.endTime.getTime():1/0;if(g>=d&&f>=g?b=g:d>=g&&a>=d&&(b=d),f>=g&&a>=f?c=f:a>=d&&f>=a&&(c=a),isNaN(b)||isNaN(c))return null;d=new e;return d.startTime=b===
-(1/0)?null:new Date(b),d.endTime=c===1/0?null:new Date(c),d},a.prototype.offset=function(a,b){var c=new e,d=this.startTime,f=this.endTime;return d&&(c.startTime=this._offsetDate(d,a,b)),f&&(c.endTime=this._offsetDate(f,a,b)),c},a.prototype._offsetDate=function(a,b,e){a=new Date(a.getTime());b&&e&&(e=k[e],a[e.setter](a[e.getter]()+b*e.multiplier));return a},d([b.property({type:Date,json:{write:{allowNull:!0}}})],a.prototype,"endTime",void 0),d([b.reader("endTime")],a.prototype,"readEndTime",null),
d([b.writer("endTime")],a.prototype,"writeEndTime",null),d([b.property({type:Date,json:{write:{allowNull:!0}}})],a.prototype,"startTime",void 0),d([b.reader("startTime")],a.prototype,"readStartTime",null),d([b.writer("startTime")],a.prototype,"writeStartTime",null),a=e=d([b.subclass("esri.TimeExtent")],a);var e}(b.declared(g))})},"esri/tasks/support/QuantizationParameters":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport ../../core/kebabDictionary ../../core/lang ../../geometry/Extent".split(" "),
function(m,l,h,d,b,g,k,f,a){var e=k({upperLeft:"upper-left",lowerLeft:"lower-left"});return function(c){function g(){var a=null!==c&&c.apply(this,arguments)||this;return a.extent=null,a.mode="view",a.originPosition="upper-left",a}return h(g,c),k=g,g.prototype.clone=function(){return new k(f.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))},d([b.property({type:a,json:{write:!0}})],g.prototype,"extent",void 0),d([b.property({type:String,json:{write:!0}})],
g.prototype,"mode",void 0),d([b.property({type:String,json:{read:e.read,write:e.write}})],g.prototype,"originPosition",void 0),d([b.property({type:Number,json:{write:!0}})],g.prototype,"tolerance",void 0),g=k=d([b.subclass("esri.tasks.support.QuantizationParameters")],g);var k}(b.declared(g))})},"esri/tasks/QueryTask":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/accessorSupport/decorators dojo/_base/lang ../request ./Task ./support/FeatureSet ./support/Query ../geometry ../geometry/support/jsonUtils ../geometry/support/normalizeUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){return function(a){function l(b){b=a.call(this,b)||this;return b.gdbVersion=null,b.source=null,b}return h(l,a),u=l,l.queryToQueryStringParameters=function(a){var b=a.geometry;a=a.toJSON();if(b&&(a.geometry=JSON.stringify(b),a.geometryType=t.getJsonType(b),a.inSR=b.spatialReference.wkid||JSON.stringify(b.spatialReference)),a.groupByFieldsForStatistics&&(a.groupByFieldsForStatistics=a.groupByFieldsForStatistics.join(",")),a.objectIds&&(a.objectIds=a.objectIds.join(",")),
a.orderByFields&&(a.orderByFields=a.orderByFields.join(",")),a.outFields&&(a.outFields=a.outFields.join(",")),a.outSR?a.outSR=a.outSR.wkid||JSON.stringify(a.outSR):b&&(a.returnGeometry||a.returnCentroid)&&(a.outSR=a.inSR),a.returnGeometry&&delete a.returnGeometry,a.outStatistics&&(a.outStatistics=JSON.stringify(a.outStatistics)),a.pixelSize&&(a.pixelSize=JSON.stringify(a.pixelSize)),a.quantizationParameters&&(a.quantizationParameters=JSON.stringify(a.quantizationParameters)),a.timeExtent)b=a.timeExtent,
a.time=[null!=b.startTime?b.startTime:"null",null!=b.endTime?b.endTime:"null"],delete a.timeExtent;return a},l.prototype.execute=function(a,b){var c=this;return this.rawExecute(a,b).then(function(a){return c._handleExecuteResponse(a)})},l.prototype.rawExecute=function(a,b){var c=this;return r.normalizeCentralMeridian(a.geometry?[a.geometry]:[]).then(function(e){e=c._encode(k.mixin({},c.parsedUrl.query,{f:"json"},c._normalizeQuery(a,e&&e[0])));if(c.source){var d={source:c.source.toJSON()};e.layer=
JSON.stringify(d)}c.gdbVersion&&(e.gdbVersion=c.gdbVersion);e={query:e,callbackParamName:"callback"};return(c.requestOptions||b)&&(e=k.mixin({},c.requestOptions,b,e)),f(c.parsedUrl.path+"/query",e)})},l.prototype.executeRelationshipQuery=function(a,b){a=this._encode(k.mixin({},this.parsedUrl.query,{f:"json"},a.toJSON()));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);a={query:a,callbackParamName:"callback"};return(this.requestOptions||b)&&(a=k.mixin({},this.requestOptions,b,a)),f(this.parsedUrl.path+
"/queryRelatedRecords",a).then(this._handleExecuteRelationshipQueryResponse)},l.prototype.executeForIds=function(a,b){var c=this;return r.normalizeCentralMeridian(a.geometry?[a.geometry]:[]).then(function(e){e=c._encode(k.mixin({},c.parsedUrl.query,{f:"json",returnIdsOnly:!0},c._normalizeQuery(a,e&&e[0])));if(c.source){var d={source:c.source.toJSON()};e.layer=JSON.stringify(d)}c.gdbVersion&&(e.gdbVersion=c.gdbVersion);e={query:e,callbackParamName:"callback"};return(c.requestOptions||b)&&(e=k.mixin({},
c.requestOptions,b,e)),f(c.parsedUrl.path+"/query",e)}).then(this._handleExecuteForIdsResponse)},l.prototype.executeForCount=function(a,b){var c=this;return r.normalizeCentralMeridian(a.geometry?[a.geometry]:[]).then(function(e){e=c._encode(k.mixin({},c.parsedUrl.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},c._normalizeQuery(a,e&&e[0])));if(c.source){var d={source:c.source.toJSON()};e.layer=JSON.stringify(d)}c.gdbVersion&&(e.gdbVersion=c.gdbVersion);e={query:e,callbackParamName:"callback"};
return(c.requestOptions||b)&&(e=k.mixin({},c.requestOptions,b,e)),f(c.parsedUrl.path+"/query",e)}).then(this._handleExecuteForCountResponse)},l.prototype.executeForExtent=function(a,b){var c=this;return r.normalizeCentralMeridian(a.geometry?[a.geometry]:[]).then(function(e){e=c._encode(k.mixin({},c.parsedUrl.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},c._normalizeQuery(a,e&&e[0])));if(c.source){var d={source:c.source.toJSON()};e.layer=JSON.stringify(d)}c.gdbVersion&&(e.gdbVersion=c.gdbVersion);
e={query:e,callbackParamName:"callback"};return(c.requestOptions||b)&&(e=k.mixin({},c.requestOptions,b,e)),f(c.parsedUrl.path+"/query",e)}).then(this._handleExecuteForExtentResponse)},l.prototype._handleExecuteResponse=function(a){return e.fromJSON(a.data)},l.prototype._handleExecuteRelationshipQueryResponse=function(a){a=a.data;var b=a.geometryType,c=a.spatialReference,d={};return a.relatedRecordGroups.forEach(function(a){var f=e.fromJSON({geometryType:b,spatialReference:c,features:a.relatedRecords});
if(null!=a.objectId)d[a.objectId]=f;else for(var g in a)a.hasOwnProperty(g)&&"relatedRecords"!==g&&(d[a[g]]=f)}),d},l.prototype._handleExecuteForIdsResponse=function(a){return a.data.objectIds},l.prototype._handleExecuteForCountResponse=function(a){a=a.data;var b=a.features,c=a.objectIds;if(c)a=c.length;else{if(b)throw Error("Unable to perform query. Please check your parameters.");a=a.count}return a},l.prototype._handleExecuteForExtentResponse=function(a){a=a.data;if(a.hasOwnProperty("extent"))a.extent=
q.Extent.fromJSON(a.extent);else{if(a.features)throw Error("Layer does not support extent calculation.");if(a.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");}return a},l.prototype._normalizeQuery=function(a,b){return b&&(a=a.clone(),a.geometry=b),u.queryToQueryStringParameters(a)},d([g.property()],l.prototype,"gdbVersion",void 0),d([g.property()],l.prototype,"source",void 0),d([b(0,g.cast(c))],l.prototype,"execute",null),d([b(0,g.cast(c))],l.prototype,"rawExecute",
null),d([b(0,g.cast(c))],l.prototype,"executeForIds",null),d([b(0,g.cast(c))],l.prototype,"executeForCount",null),d([b(0,g.cast(c))],l.prototype,"executeForExtent",null),l=u=d([g.subclass("esri.tasks.QueryTask")],l);var u}(g.declared(a))})},"esri/tasks/support/FeatureSet":function(){define("../../core/kebabDictionary ../../core/JSONSupport ../../core/lang ../../Graphic ../../layers/support/Field ../../geometry/SpatialReference ../../geometry/support/graphicsUtils ../../geometry/support/jsonUtils dojo/_base/lang".split(" "),
function(m,l,h,d,b,g,k,f,a){m=m({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"});return l.createSubclass({declaredClass:"esri.tasks.support.FeatureSet",getDefaults:function(){return a.mixin(this.inherited(arguments),{features:[]})},properties:{displayFieldName:null,exceededTransferLimit:null,features:{value:null,json:{read:function(a,b){var c,e=g.fromJSON(b.spatialReference);return c=a.map(function(a){var b=
d.fromJSON(a);a=a.geometry&&a.geometry.spatialReference;return b.geometry&&!a&&(b.geometry.spatialReference=e),b}),b.transform&&this._hydrate(b.transform,b.geometryType,c),c}}},fields:{value:null,type:[b]},geometryType:{value:null,json:{read:m.fromJSON}},spatialReference:{type:g}},toJSON:function(a){var b={hasZ:this.hasZ,hasM:this.hasM};return this.displayFieldName&&(b.displayFieldName=this.displayFieldName),this.fields&&(b.fields=this.fields.map(function(a){return a.toJSON()})),this.spatialReference?
b.spatialReference=this.spatialReference.toJSON():this.features[0]&&this.features[0].geometry&&(b.spatialReference=this.features[0].geometry.spatialReference.toJSON()),this.features[0]&&(this.features[0].geometry&&(b.geometryType=f.getJsonType(this.features[0].geometry)),b.features=k._encodeGraphics(this.features,a)),b.exceededTransferLimit=this.exceededTransferLimit,b.transform=this.transform,h.fixJson(b)},quantize:function(a){var b,e,d=a.translate[0],f=a.translate[1],g=a.scale[0],k=a.scale[1],h=
this.features,l=function(a,b,c){var e,d,f,g,k,h,n,q=[];e=0;for(d=a.length;d>e;e++)f=a[e],0<e?(h=b(f[0]),n=c(f[1]),(h!==g||n!==k)&&(q.push([h-g,n-k]),g=h,k=n)):(g=b(f[0]),k=c(f[1]),q.push([g,k]));return 0<q.length?q:null},n=function(a,b,c){return"point"===a?function(a){return a.x=b(a.x),a.y=c(a.y),a}:"polyline"===a||"polygon"===a?function(a){var e,d,f,g,k;f=a.rings||a.paths;k=[];e=0;for(d=f.length;d>e;e++)g=f[e],(g=l(g,b,c))&&k.push(g);return 0<k.length?(a.rings?a.rings=k:a.paths=k,a):null}:"multipoint"===
a?function(a){var e;return e=l(a.points,b,c),0<e.length?(a.points=e,a):null}:"extent"===a?function(a){return a}:void 0}(this.geometryType,function(a){return Math.round((a-d)/g)},function(a){return Math.round((f-a)/k)});b=0;for(e=h.length;e>b;b++)n(h[b].geometry)||(h.splice(b,1),b--,e--);return this.transform=a,this},_hydrate:function(a,b,d){if(a){var c=a.translate[0],e=a.translate[1],f=a.scale[0],g=a.scale[1],k=function(a,b,c){return"esriGeometryPoint"===a?function(a){a.x=b(a.x);a.y=c(a.y)}:"esriGeometryPolyline"===
a||"esriGeometryPolygon"===a?function(a){var e,d,f,g,k,h,n,q=a.rings||a.paths;a=0;for(e=q.length;e>a;a++)for(g=q[a],d=0,f=g.length;f>d;d++)k=g[d],0<d?(h+=k[0],n+=k[1]):(h=k[0],n=k[1]),k[0]=b(h),k[1]=c(n)}:"esriGeometryEnvelope"===a?function(a){a.xmin=b(a.xmin);a.ymin=c(a.ymin);a.xmax=b(a.xmax);a.ymax=c(a.ymax)}:"esriGeometryMultipoint"===a?function(a){var e,d,f,g,k=a.points;a=0;for(e=k.length;e>a;a++)d=k[a],0<a?(f+=d[0],g+=d[1]):(f=d[0],g=d[1]),d[0]=b(f),d[1]=c(g)}:void 0}(b,function(a){return a*
f+c},function(a){return e-a*g});a=0;for(b=d.length;b>a;a++)d[a].geometry&&k(d[a].geometry)}}})})},"esri/layers/support/Field":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport ../../core/kebabDictionary ./domains".split(" "),function(m,l,h,d,b,g,k,f){var a=k({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",
esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});return function(e){function c(a){a=e.call(this)||this;return a.alias=null,a.domain=null,a.editable=!1,a.length=-1,a.name=null,a.nullable=!0,a.type=null,a}return h(c,e),g=c,c.prototype.readDomain=function(a){var b=a&&a.type;return"range"===
b?f.RangeDomain.fromJSON(a):"codedValue"===b?f.CodedValueDomain.fromJSON(a):null},c.prototype.clone=function(){return new g({alias:this.alias,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type})},d([b.property({type:String,json:{write:!0}})],c.prototype,"alias",void 0),d([b.property({types:f.types,json:{write:!0}})],c.prototype,"domain",void 0),d([b.reader("domain")],c.prototype,"readDomain",null),d([b.property({type:Boolean,
json:{write:!0}})],c.prototype,"editable",void 0),d([b.property({type:Number,json:{write:!0}})],c.prototype,"length",void 0),d([b.property({type:String,json:{write:!0}})],c.prototype,"name",void 0),d([b.property({type:Boolean,json:{write:!0}})],c.prototype,"nullable",void 0),d([b.property({type:String,json:{read:a.read,write:a.write}})],c.prototype,"type",void 0),c=g=d([b.subclass("esri.layers.support.Field")],c);var g}(b.declared(g))})},"esri/layers/support/domains":function(){define("require exports ./Domain ./RangeDomain ./CodedValueDomain ./InheritedDomain".split(" "),
function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});l.DomainBase=h;l.RangeDomain=d;l.CodedValueDomain=b;l.InheritedDomain=g;l.types={key:"type",base:l.DomainBase,typeMap:{range:l.RangeDomain,"coded-value":l.CodedValueDomain}}})},"esri/layers/support/Domain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport ../../core/kebabDictionary".split(" "),function(m,
l,h,d,b,g,k){var f=k({inherited:"inherited",codedValue:"coded-value",range:"range"});return function(a){function e(b){b=a.call(this,b)||this;return b.name=null,b.type=null,b}return h(e,a),d([b.property({json:{write:!0}})],e.prototype,"name",void 0),d([b.property({json:{read:f.read,write:f.write}})],e.prototype,"type",void 0),e=d([b.subclass("esri.layers.support.Domain")],e)}(b.declared(g))})},"esri/layers/support/RangeDomain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Domain".split(" "),
function(m,l,h,d,b,g){return function(g){function f(a){a=g.call(this,a)||this;return a.maxValue=null,a.minValue=null,a.type="range",a}return h(f,g),a=f,f.prototype.clone=function(){return new a({maxValue:this.maxValue,minValue:this.minValue,name:this.name})},d([b.property({json:{read:{source:"range",reader:function(a,b){return b.range&&b.range[1]}},write:{target:"range",writer:function(a,b,d){b[d]=[this.minValue,a]}}}})],f.prototype,"maxValue",void 0),d([b.property({json:{read:{source:"range",reader:function(a,
b){return b.range&&b.range[0]}},write:{target:"range",writer:function(a,b,d){b[d]=[a,this.maxValue]}}}})],f.prototype,"minValue",void 0),d([b.property()],f.prototype,"type",void 0),f=a=d([b.subclass("esri.layers.support.RangeDomain")],f);var a}(b.declared(g))})},"esri/layers/support/CodedValueDomain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Domain ../../core/lang".split(" "),function(m,
l,h,d,b,g,k){return function(f){function a(a){a=f.call(this,a)||this;return a.codedValues=null,a.type="coded-value",a}return h(a,f),e=a,a.prototype.writeCodedValues=function(a,b){var c=null;a&&(c=a.map(function(a){return k.fixJson(k.clone(a))}));b.codedValues=c},a.prototype.getName=function(a){var b=null;if(this.codedValues){var c=String(a);this.codedValues.some(function(a){return String(a.code)===c&&(b=a.name),!!b})}return b},a.prototype.clone=function(){return new e({codedValues:k.clone(this.codedValues),
name:this.name})},d([b.property({json:{write:!0}})],a.prototype,"codedValues",void 0),d([b.writer("codedValues")],a.prototype,"writeCodedValues",null),d([b.property()],a.prototype,"type",void 0),a=e=d([b.subclass("esri.layers.support.CodedValueDomain")],a);var e}(b.declared(g))})},"esri/layers/support/InheritedDomain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Domain".split(" "),function(m,
l,h,d,b,g){return function(g){function f(a){a=g.call(this,a)||this;return a.type="inherited",a}return h(f,g),a=f,f.prototype.clone=function(){return new a},d([b.property()],f.prototype,"type",void 0),f=a=d([b.subclass("esri.layers.support.InheritedDomain")],f);var a}(b.declared(g))})},"esri/geometry/support/graphicsUtils":function(){define(["require","exports","dojo/_base/array","../Extent","../../core/Collection"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});l.graphicsExtent=
function(g){if(!g||!g.length)return null;var k=b.isCollection(g)?g.getItemAt(0).geometry:g[0].geometry,f=k.extent,a=k;null===f&&(f=new d(a.x,a.y,a.x,a.y,k.spatialReference));for(var e=1;e<g.length;e++){var a=k=b.isCollection(g)?g.getItemAt(e).geometry:g[e].geometry,c=k.extent;null===c&&(c=new d(a.x,a.y,a.x,a.y,k.spatialReference));f=f.clone().union(c)}return 0>f.width&&0>f.height?null:f};l.getGeometries=function(b){return h.map(b,function(b){return b.geometry})};l._encodeGraphics=function(b,d){var f=
[];return h.forEach(b,function(a,b){a=a.toJSON();var c={};if(a.geometry){var e=d&&d[b];c.geometry=e&&e.toJSON()||a.geometry}a.attributes&&(c.attributes=a.attributes);f[b]=c}),f}})},"esri/geometry/support/normalizeUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../core/promiseUtils ../../config ../../tasks/GeometryService ../Polygon ../Polyline ../SpatialReference ./webMercatorUtils ./spatialReferenceUtils".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q){function t(a){return"polygon"===
a.type?a.rings:a.paths}function r(a,b){return Math.ceil((a-b)/(2*b))}function u(a,b){for(var c=t(a),e=0;e<c.length;e++)for(var d=c[e],f=0;f<d.length;f++){var g=a.getPoint(e,f);a.setPoint(e,f,g.clone().offset(b,0))}return a}function v(a){for(var b=[],c=0,e=0,d=0;d<a.length;d++){for(var f=a[d],g=null,k=0;k<f.length;k++)g=f[k],b.push(g),0===k?(c=g[0],e=c):(c=Math.min(c,g[0]),e=Math.max(e,g[0]));g&&b.push([(c+e)/2,0])}return b}function x(b,c){if(!(b instanceof a||b instanceof f))throw z.error("straightLineDensify: the input geometry is neither polyline nor polygon"),
new h("straightLineDensify: the input geometry is neither polyline nor polygon");for(var e=[],d=0,g=t(b);d<g.length;d++){var k=g[d],n=[];e.push(n);n.push([k[0][0],k[0][1]]);for(var q=0;q<k.length-1;q++){var l=k[q][0],r=k[q][1],u=k[q+1][0],H=k[q+1][1],w=Math.sqrt((u-l)*(u-l)+(H-r)*(H-r)),v=(H-r)/w,E=(u-l)/w,p=w/c;if(1<p){for(var A=1;p-1>=A;A++){var K=A*c;n.push([E*K+l,v*K+r])}w=(w+Math.floor(p-1)*c)/2;n.push([E*w+l,v*w+r])}n.push([u,H])}}return"polygon"===b.type?new f({rings:e,spatialReference:b.spatialReference}):
new a({paths:e,spatialReference:b.spatialReference})}function y(a,b,e){b&&(a=x(a,1E6),a=c.webMercatorToGeographic(a,!0));return e&&(a=u(a,e)),a}function n(a,b,c){if(Array.isArray(a)){var e=a[0];if(e>b){var d=r(e,b);a[0]=e+-2*d*b}else c>e&&(d=r(e,c),a[0]=e+-2*d*c)}else e=a.x,e>b?(d=r(e,b),a=a.clone().offset(-2*d*b,0)):c>e&&(d=r(e,c),a=a.clone().offset(-2*d*c,0));return a}function w(a,b){var c=-1;return b.cutIndexes.forEach(function(e,d){var f=b.geometries[d];if(t(f).forEach(function(a,b){a.some(function(c){if(180>
c[0])return!0;for(var e=c=0;e<a.length;e++){var d=a[e][0];c=d>c?d:c}c=Number(c.toFixed(9));c=-360*r(c,180);for(e=0;e<a.length;e++)d=f.getPoint(b,e),f.setPoint(b,e,d.clone().offset(c,0));return!0})}),e===c)if("polygon"===a[0].type){d=0;for(var g=t(f);d<g.length;d++)a[e]=a[e].addRing(g[d])}else{if("polyline"===a[0].type)for(d=0,g=t(f);d<g.length;d++)a[e]=a[e].addPath(g[d])}else c=e,a[e]=f}),a}Object.defineProperty(l,"__esModule",{value:!0});var z=d.getLogger("esri.geometry.support.normalizeUtils");
l.straightLineDensify=x;var C;l.normalizeCentralMeridian=function(d,h){h||(h=(C||(C=new k({url:g.geometryServiceUrl})),C));for(var l,t,v,x,m,z,B,F,S=0,H=[],Y=d.map(function(b){if(!b||(l||(l=b.spatialReference,t=q.getInfo(l),v=l.isWebMercator,x=v?2.0037508342788905E7:180,m=v?-2.0037508342788905E7:-180,z=v?102100:4326,B=new a({paths:[[[x,m],[x,x]]],spatialReference:new e({wkid:z})}),F=new a({paths:[[[m,m],[m,x]]],spatialReference:new e({wkid:z})})),!t))return b;if("point"===b.type)return n(b.clone(),
x,m);if("multipoint"===b.type){var c=b.clone();return c.points=c.points.map(function(a){return n(a,x,m)}),c}if("extent"===b.type)return c=b.clone(),c=c._normalize(!1,!1,t),c.rings?new f(c):c;if(b.extent){var c=b.extent,d=2*r(c.xmin,m)*x;b=0===d?b.clone():u(b.clone(),d);return c.offset(d,0),c.intersects(B)&&c.xmax!==x?(S=c.xmax>S?c.xmax:S,b=y(b,v),H.push(b),"cut"):c.intersects(F)&&c.xmin!==m?(S=2*c.xmax*x>S?2*c.xmax*x:S,b=y(b,v,360),H.push(b),"cut"):b}return b.clone()}),W=r(S,x),E=-90,p=W,A=new a;0<
W;){var K=-180+360*W;A.addPath([[K,E],[K,-1*E]]);E*=-1;W--}return 0<H.length&&0<p?h.cut(H,A).then(function(a){return w(H,a)}).then(function(a){var b=[],e=Y.map(function(e,p){if("cut"!==e)return e;e=a.shift();p=d[p];return"polygon"===p.type&&p.rings&&1<p.rings.length&&e.rings.length>=p.rings.length?(b.push(e),"simplify"):v?c.geographicToWebMercator(e):e});return b.length?h.simplify(b).then(function(a){return e.map(function(b){return"simplify"!==b?b:v?c.geographicToWebMercator(a.shift()):a.shift()})}):
Y}):b.resolve(Y.map(function(a){if("cut"!==a)return a;a=H.shift();return!0===v?c.geographicToWebMercator(a):a}))};l.getDenormalizedExtent=function(a){if(!a)return null;var b=a.extent;if(!b)return null;var c=a.spatialReference&&q.getInfo(a.spatialReference);if(!c)return b;var c=c.valid,e=c[0],c=c[1],d=b.width,f=b.xmin,g=b.xmax;if(h=[g,f],f=h[0],g=h[1],"extent"===a.type||0===d||c>=d||d>2*c||e>f||g>c)return b;var k;switch(a.type){case "polygon":if(!(1<a.rings.length))return b;k=v(a.rings);break;case "polyline":if(!(1<
a.paths.length))return b;k=v(a.paths);break;case "multipoint":k=a.points}a=b.clone();for(h=0;h<k.length;h++)e=k[h][0],0>e?(e+=c,g=Math.max(e,g)):(e-=c,f=Math.min(e,f));return a.xmin=f,a.xmax=g,a.width<d?(a.xmin-=c,a.xmax-=c,a):b;var h}})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(m){var l=m.getObject("dojox.html.entities",!0),h=function(b,d){var g,f;if(d._encCache&&d._encCache.regexp&&d._encCache.mapper&&d.length==d._encCache.length)g=d._encCache.mapper,f=d._encCache.regexp;
else{g={};f=["["];var a;for(a=0;a<d.length;a++)g[d[a][0]]="\x26"+d[a][1]+";",f.push(d[a][0]);f.push("]");f=new RegExp(f.join(""),"g");d._encCache={mapper:g,regexp:f,length:d.length}}return b=b.replace(f,function(a){return g[a]})},d=function(b,d){var g,f;if(d._decCache&&d._decCache.regexp&&d._decCache.mapper&&d.length==d._decCache.length)g=d._decCache.mapper,f=d._decCache.regexp;else{g={};f=["("];var a;for(a=0;a<d.length;a++){var e="\x26"+d[a][1]+";";a&&f.push("|");g[e]=d[a][0];f.push(e)}f.push(")");
f=new RegExp(f.join(""),"g");d._decCache={mapper:g,regexp:f,length:d.length}}return b=b.replace(f,function(a){return g[a]})};l.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];l.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],
["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca",
"Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4",
"auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe",
"thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2",
"beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],
["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],
["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295",
"oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e",
"lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];l.encode=function(b,d){b&&(d?b=h(b,d):(b=h(b,l.html),b=h(b,l.latin)));return b};l.decode=function(b,g){b&&(g?b=d(b,g):(b=d(b,l.html),b=d(b,l.latin)));return b};return l})},"esri/widgets/support/uriUtils":function(){define(["require",
"exports","../../core/lang","dojo/i18n!./nls/uriUtils"],function(m,l,h,d){function b(b){var d=null;return g.some(function(a){return a.pattern.test(b)&&(d=a),!!d}),d}Object.defineProperty(l,"__esModule",{value:!0});var g=[{id:"http",pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:d.view},{id:"tel",pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{id:"mailto",pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{id:"arcgis-appstudio-player",pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,
label:d.openInApp,appName:"App Studio Player"},{id:"arcgis-collector",pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:d.openInApp,appName:"Collector"},{id:"arcgis-explorer",pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:d.openInApp,appName:"Explorer"},{id:"arcgis-navigator",pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:d.openInApp,appName:"Navigator"},{id:"arcgis-survey123",pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:d.openInApp,appName:"Survey123"},{id:"arcgis-trek2there",
pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:d.openInApp,appName:"Trek2There"},{id:"arcgis-workforce",pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:d.openInApp,appName:d.workforce},{id:"iform",pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:d.openInApp,appName:"iForm"},{id:"flow",pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:d.openInApp,appName:"FlowFinity"},{id:"lfmobile",pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:d.openInApp,appName:"Laserfische"},{id:"mspbi",pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,
label:d.openInApp,appName:"Microsoft Power Bi"}];l.autoLink=function(d){if("string"!=typeof d||!d)return d;var f=b(d);if(!f)return d;var a=d.match(f.pattern),a=h.substitute({appName:f.appName,hierPart:a&&a[2]},f.label);return d.replace(f.pattern,"\x3ca "+(f.target?'target\x3d"'+f.target+'"':"")+'" href\x3d"$1"\x3e'+a+"\x3c/a\x3e")}})},"esri/widgets/support/nls/uriUtils":function(){define({root:{openInApp:"Open in {appName}",view:"View"},ar:1,bs:1,cs:1,da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,he:1,hi:1,
hr:1,id:1,it:1,ja:1,ko:1,lv:1,lt:1,nl:1,nb:1,pl:1,"pt-br":1,"pt-pt":1,ro:1,ru:1,sl:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"esri/widgets/Popup/nls/PopupRenderer":function(){define({root:{attach:"Attachments",fields:"Fields",fieldsSummary:"List of attributes and values",media:"Media",next:"Next",numCharts:"Number of charts",numImages:"Number of images",noTitle:"Untitled",previous:"Previous"},ar:1,bs:1,cs:1,da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,hr:1,he:1,hi:1,id:1,it:1,ja:1,ko:1,lv:1,
lt:1,nl:1,nb:1,pl:1,"pt-br":1,"pt-pt":1,ro:1,ru:1,sl:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"esri/widgets/Popup/PopupViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/Collection ../../core/Error ../../core/HandleRegistry ../../core/promiseUtils ../../core/watchUtils ../../geometry/geometryEngine ../../geometry/support/webMercatorUtils ../../support/Action ../support/AnchorElementViewModel ../../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){function v(a,b){return b.allLayerViews.find(function(b){return b.layer===a})}m=new t({id:"zoom-to"});var x=new (g.ofType(t))([m]);return function(b){function n(a){a=b.call(this)||this;return a._handles=new f,a._originalActions=null,a.actions=x,a.goToOptions=null,a.autoCloseEnabled=!1,a.content=null,a.highlightEnabled=!0,a.title=null,a.updateLocationEnabled=!0,a.view=null,a.visible=!1,a.zoomFactor=4,a}return h(n,b),n.prototype.initialize=function(){this._handles.add([this.on("view-change",
this._autoClose),e.watch(this,["highlightEnabled","selectedFeature","visible","view"],this._highlightFeature),e.watch(this,"selectedFeature.popupTemplate.actions",this._getSelectedFeatureActions),e.watch(this,"selectedFeature.popupTemplate.overwriteActions",this._getSelectedFeatureActions)])},n.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null},Object.defineProperty(n.prototype,"featureCount",{get:function(){return this.features.length},enumerable:!0,configurable:!0}),
Object.defineProperty(n.prototype,"features",{get:function(){return this._get("features")||[]},set:function(a){a=a||[];this._set("features",a);var b=this.pendingPromisesCount,c=this.selectedFeatureIndex,e=this.promiseCount&&a.length;return e&&b&&-1===c?void(this.selectedFeatureIndex=0):void(e&&-1!==c||(this.selectedFeatureIndex=a.length?0:-1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"location",{get:function(){return this._get("location")||null},set:function(a){var b=this.get("location"),
c=this.get("view.spatialReference.isWebMercator");a&&a.get("spatialReference.isWGS84")&&c&&(a=q.geographicToWebMercator(a));this._set("location",a);a!==b&&this._centerAtLocation()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pendingPromisesCount",{get:function(){return this.promises.filter(function(a){return a&&!a.isFulfilled()}).length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"waitingForResult",{get:function(){return 0<this.pendingPromisesCount&&0===
this.featureCount},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"promiseCount",{get:function(){return this.promises.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"promises",{get:function(){return this._get("promises")||[]},set:function(b){var c=this;this._get("promises").forEach(function(a){a.cancel()});this.features=[];this._set("promises",b);b.length&&(b=b.slice(0),b.forEach(function(a){a.always(function(b){c.notifyChange("pendingPromisesCount");
c._updateFeatures(a,b)})}),a.eachAlways(b).then(function(){c.featureCount||(c.visible=!1)}))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedFeature",{get:function(){var a=this.selectedFeatureIndex,b=this.updateLocationEnabled;return-1===a?null:(a=this.features[a])?(b&&(this.location=this._getPointFromGeometry(a.geometry)),a):null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedFeatureIndex",{get:function(){var a=this._get("selectedFeatureIndex");
return"number"==typeof a?a:-1},set:function(a){var b=this.featureCount;a=isNaN(a)||-1>a||!b?-1:(a+b)%b;this._set("selectedFeatureIndex",a)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0}),n.prototype.centerAtLocation=function(){var b=this.location,c=this.view;return b&&c?c.goTo({target:b,scale:c.scale},this.goToOptions):a.reject(new k(this.declaredClass+"::Cannot center at location without a location and view."))},
n.prototype.clear=function(){this.set({promises:[],features:[],content:null,title:null,location:null})},n.prototype.triggerAction=function(a){(a=this.actions.getItemAt(a))&&this.emit("trigger-action",{action:a})},n.prototype.next=function(){return this.selectedFeatureIndex+=1,this},n.prototype.previous=function(){return--this.selectedFeatureIndex,this},n.prototype.zoomToLocation=function(){var b=this,c=this.location,e=this.selectedFeature,d=this.view,f=this.zoomFactor;if(!c||!d)return a.reject(new k(this.declaredClass+
"::Cannot zoom to location without a location and view."));var f=d.scale/f,g=this.get("selectedFeature.geometry"),h=e&&"3d"===d.type,c=(h=g||h)?e:c,n=h&&g&&"point"===g.type&&this._isScreenSize(e);return d.goTo({target:c,scale:n?f:void 0},this.goToOptions).then(function(){n&&"point"===g.type&&(b.location=g)})},n.prototype._autoClose=function(){this.autoCloseEnabled&&(this.visible=!1)},n.prototype._isScreenSize=function(a){var b=this.view;return"3d"!==b.type||"esri.Graphic"!==a.declaredClass?!0:(b=
b.getViewForGraphic(a))&&b.whenGraphicBounds?b.whenGraphicBounds(a).then(function(a){return!a||a[0]===a[3]&&a[1]===a[4]&&a[2]===a[5]}):!0},n.prototype._getSelectedFeatureActions=function(){this._originalActions&&(this.actions=this._originalActions,this._originalActions=null);var a=this.actions.filter(function(a){return!a.temporary}),b=this.get("selectedFeature.popupTemplate");b&&b.overwriteActions&&(this._originalActions=a);this.actions=this._getNewActions(b,a)},n.prototype._getNewActions=function(a,
b){if(!a||!a.actions)return b;var c=a.actions;return c.forEach(function(a){a.temporary=!0}),a.overwriteActions?c:b.concat(c)},n.prototype._getPointFromGeometry=function(a){return a?"point"===a.type?a:"extent"===a.type?a.center:"polygon"===a.type?a.centroid:"multipoint"===a.type?a.extent.center:"polyline"===a.type?a.extent.center:null:null},n.prototype._centerAtLocation=function(){var a=this.location,b=this.updateLocationEnabled,e=this.get("view.extent");b&&e&&a&&!c.contains(e,a)&&this.centerAtLocation()},
n.prototype._highlightFeature=function(){this._handles.remove("highlight");var a=this.selectedFeature,b=this.highlightEnabled,c=this.view,e=this.visible;a&&c&&b&&e&&(b=a.layer)&&(c=v(b,c))&&"function"==typeof c.highlight&&(b=b.objectIdField,e=a.attributes,a=c.highlight(e&&e[b]||a,{}),this._handles.add(a,"highlight"))},n.prototype._updateFeatures=function(a,b){var c=this.features;if(a&&b&&b.length&&!(!this._validatePromise(a)||b instanceof k||b instanceof Error)){if(!c.length)return void(this.features=
b);a=b.filter(function(a){return-1===c.indexOf(a)});this.features=c.concat(a)}},n.prototype._validatePromise=function(a){return!a.isCanceled()&&-1<this.promises.indexOf(a)},d([u.property({type:g.ofType(t)})],n.prototype,"actions",void 0),d([u.property()],n.prototype,"goToOptions",void 0),d([u.property()],n.prototype,"autoCloseEnabled",void 0),d([u.property()],n.prototype,"content",void 0),d([u.property({readOnly:!0,dependsOn:["features"]})],n.prototype,"featureCount",null),d([u.property()],n.prototype,
"features",null),d([u.property()],n.prototype,"highlightEnabled",void 0),d([u.property()],n.prototype,"location",null),d([u.property({readOnly:!0,dependsOn:["promises"]})],n.prototype,"pendingPromisesCount",null),d([u.property({readOnly:!0,dependsOn:["featureCount","pendingPromisesCount"]})],n.prototype,"waitingForResult",null),d([u.property({readOnly:!0,dependsOn:["promises"]})],n.prototype,"promiseCount",null),d([u.property()],n.prototype,"promises",null),d([u.property({value:null,readOnly:!0,dependsOn:["features",
"selectedFeatureIndex","updateLocationEnabled"]})],n.prototype,"selectedFeature",null),d([u.property({value:-1})],n.prototype,"selectedFeatureIndex",null),d([u.property({readOnly:!0,dependsOn:["view.ready"]})],n.prototype,"state",null),d([u.property()],n.prototype,"title",void 0),d([u.property()],n.prototype,"updateLocationEnabled",void 0),d([u.property()],n.prototype,"view",void 0),d([u.property()],n.prototype,"visible",void 0),d([u.property()],n.prototype,"zoomFactor",void 0),d([u.property()],n.prototype,
"centerAtLocation",null),d([u.property()],n.prototype,"clear",null),d([u.property()],n.prototype,"triggerAction",null),d([u.property()],n.prototype,"next",null),d([u.property()],n.prototype,"previous",null),d([u.property()],n.prototype,"zoomToLocation",null),n=d([u.subclass("esri.widgets.Popup.PopupViewModel")],n)}(u.declared(r))})},"esri/geometry/geometryEngine":function(){define("require exports ../kernel ./Geometry ./Polygon ./Polyline ./Point ./Extent ./Multipoint dojo/_base/lang".split(" "),
function(m,l,h,d,b,g,k,f,a,e){function c(c){if(void 0===k.fromJson){if(void 0!==c.x&&void 0!==c.y)return new k(c);if(void 0!==c.paths)return new g(c);if(void 0!==c.rings)return new b(c);if(void 0!==c.points)return new a(c);if(void 0!==c.xmin&&void 0!==c.ymin&&void 0!==c.xmax&&void 0!==c.ymax)return new f(c)}else{if(void 0!==c.x&&void 0!==c.y)return k.fromJson(c);if(void 0!==c.paths)return g.fromJson(c);if(void 0!==c.rings)return b.fromJson(c);if(void 0!==c.points)return a.fromJson(c);if(void 0!==
c.xmin&&void 0!==c.ymin&&void 0!==c.xmax&&void 0!==c.ymax)return f.fromJson(c)}}function q(c){if(void 0===k.fromJson){if(void 0!==c.x&&void 0!==c.y)return new k(c);if(void 0!==c.paths)return new g(c);if(void 0!==c.rings)return new b(c);if(void 0!==c.points)return new a(c);if(void 0!==c.xmin&&void 0!==c.ymin&&void 0!==c.xmax&&void 0!==c.ymax)return new f(c)}else{if(void 0!==c.x&&void 0!==c.y)return k.fromJSON(c);if(void 0!==c.paths)return g.fromJSON(c);if(void 0!==c.rings)return b.fromJSON(c);if(void 0!==
c.points)return a.fromJSON(c);if(void 0!==c.xmin&&void 0!==c.ymin&&void 0!==c.xmax&&void 0!==c.ymax)return f.fromJSON(c)}}function t(a,b){var c;if(null==a||void 0===a||"number"===typeof a)return a;var e=a.toString();if(""===e)return null;if(2==b){if(c=Q[e],void 0!==c)return c}else if(0==b){c=P[e];if(void 0!==c)return c;c=T[a];if(void 0!==c)return c}else if(3==b&&(c=P[e],void 0!==c))return c;if(1==b&&(c=T[a],void 0!==c))return c;if(!0===/^\d+$/.test(e))return parseInt(e);throw Error("Unrecognised Unit Type");
}function r(a){if(void 0!==a&&null!==a)switch(a){case "loxodrome":return 1;case "great-elliptic":return 2;case "normal-section":return 3;case "shape-preserving":return 4}return 0}function u(c,e){if(null===c||void 0===c||c.s())return null;switch(c.D()){case z.Xn.Point:var d=new k(c.lk(),c.mk(),e);if(M){var E=c.hasAttribute(z.xf.M);c.hasAttribute(z.xf.Z)&&d.set("z",c.lO());E&&d.set("m",c.NN())}return d;case z.Xn.Polygon:var d=c.hasAttribute(z.xf.Z),E=c.hasAttribute(z.xf.M),p=v(c,d,E),d=new b({rings:p,
hasZ:d,hasM:E});M?d.set("spatialReference",e):d.setSpatialReference(e);d.setCacheValue("_geVersion",c);return d;case z.Xn.Polyline:return d=c.hasAttribute(z.xf.Z),E=c.hasAttribute(z.xf.M),p=v(c,d,E),d=new g({paths:p,hasZ:d,hasM:E}),M?d.set("spatialReference",e):d.setSpatialReference(e),d.setCacheValue("_geVersion",c),d;case z.Xn.MultiPoint:var d=c.hasAttribute(z.xf.Z),E=c.hasAttribute(z.xf.M),A=p=null;d&&(p=c.mc(z.xf.Z));E&&(A=c.mc(z.xf.M));var K=new z.b,h=c.F();e=new a(e);M&&(e.set("hasZ",d),e.set("hasM",
E));for(var n=0;n<h;n++){c.w(n,K);var q=[K.x,K.y];d&&q.push(p.get(n));E&&q.push(A.get(n));e.addPoint(q)}e.setCacheValue("_geVersion",c);return e;case z.Xn.Envelope:return p=c.hasAttribute(z.xf.Z),d=c.hasAttribute(z.xf.M),E=new f(c.R.v,c.R.C,c.R.B,c.R.G,e),M&&(p&&(p=c.Ah(z.xf.Z,0),E.set("zmin",p.qa),E.set("zmax",p.va)),d&&(p=c.Ah(z.xf.M,0),E.set("mmin",p.qa),E.set("mmax",p.va))),E.setCacheValue("_geVersion",c),E}return null}function v(a,b,c){var e=[],d=a.ea(),f=null,g=null;b&&(f=a.mc(z.xf.Z));c&&(g=
a.mc(z.xf.M));for(var k=new z.b,h=0;h<d;h++){for(var n=a.Ea(h),q=a.Ha(h),H=0,l=0,r=NaN,t=NaN,u=NaN,w=NaN,v=a.vc(h),x=[],m=n;m<n+q;m++){a.w(m,k);var w=u=NaN,y=[k.x,k.y];b&&(u=f.get(m),y.push(u));c&&(w=g.get(m),y.push(w));m==n&&v&&(H=k.x,l=k.y,r=u,t=w);x.push(y)}!v||H==k.x&&l==k.y&&(!b||isNaN(r)&&isNaN(u)||r==u)&&(!c||isNaN(t)&&isNaN(w)||t==w)||x.push(x[0].slice(0));e.push(x)}return e}function x(a){var b=a._geVersion;if(null==b||void 0==b){if(Object.freeze&&Object.isFrozen(a))return 102100===a.wkid?
S:4326===a.wkid?O:b=z.Nf.create(a.wkid);-1!=a.wkid&&null!==a.wkid&&void 0!==a.wkid?(b=z.Nf.create(a.wkid),a._geVersion=b):""!==a.wkt&&void 0!==a.wkt&&null!==a.wkt&&(b=z.Nf.NL(a.wkt),a._geVersion=b)}return b}function y(a){if(null==a)return null;var b=a.getCacheValue("_geVersion");if(null==b||void 0==b)b=z.Pb.IL(a),a.setCacheValue("_geVersion",b);return b}function n(a){return null===a.spatialReference?null:x(a.spatialReference)}var w=this&&this.__extends||function(a,b){function c(){this.constructor=
a}for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},z;(function(a){var b=function(){function a(){}a.Sk=!1;a.it=!1;a.$v="";return a}();a.ah=b;if("undefined"!==typeof window)a.ah.$v="browser","Float64Array"in window&&(a.ah.it=!0),"ArrayBuffer"in window&&(a.ah.Sk=!0);else if("undefined"!==typeof process)b.$v="node",a.ah.Sk=!0,a.ah.it=!0;else{b.$v="browser";try{var c=new ArrayBuffer(0);new Uint8Array(c);a.ah.Sk=!0;a.ah.it=!0}catch(E){a.ah.Sk=
!1}}})(z||(z={}));(function(a){(function(a){a[a.Unknown=0]="Unknown";a[a.Point=33]="Point";a[a.Line=322]="Line";a[a.Envelope=197]="Envelope";a[a.MultiPoint=550]="MultiPoint";a[a.Polyline=1607]="Polyline";a[a.Polygon=1736]="Polygon"})(a.Xn||(a.Xn={}));(function(a){a[a.enumMild=0]="enumMild";a[a.enumMedium=1]="enumMedium";a[a.enumHot=2]="enumHot"})(a.rH||(a.rH={}));var b=function(){function b(){this.description=null;this.Ux=0}b.prototype.D=function(){return 0};b.prototype.fb=function(){return-1};b.prototype.Qf=
function(a){this.qc();a!=this.description&&this.nm(a)};b.prototype.nm=function(){};b.prototype.Ik=function(b){this.qc();b!=this.description&&(b=a.Od.QN(this.description,b),b!=this.description&&this.nm(b))};b.prototype.hasAttribute=function(a){return this.description.hasAttribute(a)};b.prototype.Ne=function(b){this.qc();this.description.hasAttribute(b)||(b=a.Od.PN(this.description,b),this.nm(b))};b.prototype.Ah=function(){return null};b.prototype.Fp=function(){};b.prototype.o=function(){};b.prototype.Cn=
function(){};b.prototype.dd=function(a){this.o(a)};b.prototype.s=function(){return!0};b.prototype.Ja=function(){};b.prototype.Oe=function(){};b.prototype.Pa=function(){return null};b.prototype.copyTo=function(){};b.prototype.Mh=function(){return 0};b.prototype.$b=function(){return 0};b.prototype.WC=function(){return this.hasAttribute(1)};b.ve=function(a){return((a&192)>>6)+1>>1};b.Km=function(a){return 0!=(a&32)};b.qT=function(a){return 0!=(a&64)};b.SO=function(a){return 0!=(a&128)};b.Lc=function(a){return 0!=
(a&256)};b.Th=function(a){return 0!=(a&512)};b.Kc=function(a){return 0!=(a&1024)};b.prototype.vm=function(){var a=this.Pa();this.copyTo(a);return a};b.prototype.Rf=function(){return null};b.Yj=function(a){var b=a.Pa();a.copyTo(b);return b};b.prototype.qc=function(){0<=this.Ux&&(this.Ux+=2147483649)};b.Vu=function(c){var e=c.D();if(b.Th(e))return c.F();if(c.s())return 0;if(197==e)return 4;if(33==e)return 1;if(b.Lc(e))return 2;throw a.g.ra("missing type");};return b}();a.T=b})(z||(z={}));(function(a){var b=
function(){function b(){this.y=this.x=0}b.Oa=function(a,c){var e=new b;e.x=a;e.y=c;return e};b.prototype.ma=function(a,b){this.x=a;this.y=b};b.prototype.J=function(a){this.x=a.x;this.y=a.y};b.prototype.Cq=function(a,b){return this.x===a&&this.y===b};b.prototype.Ww=function(a){return 2.220446049250313E-16>=Math.abs(this.x-a.x)&&2.220446049250313E-16>=Math.abs(this.y-a.y)};b.prototype.ub=function(a){return this.x===a.x&&this.y===a.y};b.prototype.lc=function(a){return a==this?!0:a instanceof b?this.x==
a.x&&this.y==a.y:!1};b.prototype.sub=function(a){this.x-=a.x;this.y-=a.y};b.prototype.pc=function(a,b){this.x=a.x-b.x;this.y=a.y-b.y};b.prototype.add=function(a,b){void 0!==b?(this.x=a.x+b.x,this.y=a.y+b.y):(this.x+=a.x,this.y+=a.y)};b.prototype.Bp=function(){this.x=-this.x;this.y=-this.y};b.prototype.qr=function(a){this.x=-a.x;this.y=-a.y};b.prototype.OO=function(a,b,c){this.x=a.x*(1-c)+b.x*c;this.y=a.y*(1-c)+b.y*c};b.prototype.Fr=function(a,b){this.x=this.x*a+b.x;this.y=this.y*a+b.y};b.prototype.DR=
function(a,b,c){this.x=b.x*a+c.x;this.y=b.y*a+c.y};b.prototype.scale=function(a){this.x*=a;this.y*=a};b.prototype.compare=function(a){return this.y<a.y?-1:this.y>a.y?1:this.x<a.x?-1:this.x>a.x?1:0};b.prototype.normalize=function(){var a=this.length();0==a&&(this.x=1,this.y=0);this.x/=a;this.y/=a};b.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};b.prototype.Up=function(){return this.x*this.x+this.y*this.y};b.Fb=function(a,b){return Math.sqrt(this.Zb(a,b))};b.Yv=function(a,
b,c,e){a-=c;b-=e;return Math.sqrt(a*a+b*b)};b.prototype.ml=function(a){return this.x*a.x+this.y*a.y};b.prototype.uA=function(a){return Math.abs(this.x*a.x)+Math.abs(this.y*a.y)};b.prototype.Ai=function(a){return this.x*a.y-this.y*a.x};b.prototype.Er=function(a,b){var c=-this.x*b+this.y*a;this.x=this.x*a+this.y*b;this.y=c};b.prototype.tt=function(){var a=this.x;this.x=-this.y;this.y=a};b.prototype.zD=function(a){this.x=-a.y;this.y=a.x};b.prototype.Kp=function(){var a=this.x;this.x=this.y;this.y=-a};
b.prototype.FA=function(){this.y=this.x=NaN};b.prototype.pv=function(){return isNaN(this.x)};b.prototype.ps=function(){return 0<this.x?0<=this.y?1:4:0<this.y?2:0==this.x?4:3};b.cq=function(a,b){var c=a.ps(),e=b.ps();return e==c?(c=a.Ai(b),0>c?1:0<c?-1:0):c<e?-1:1};b.HT=function(a,c){return b.cq(a,c)};b.Zb=function(a,b){var c=a.x-b.x;a=a.y-b.y;return c*c+a*a};b.prototype.toString=function(){return"("+this.x+" , "+this.y+")"};b.prototype.Eh=function(){this.y=this.x=NaN};b.prototype.yJ=function(){return this.pv()?
NaN:Math.abs(this.x)>=Math.abs(this.y)?Math.abs(this.x):Math.abs(this.y)};b.prototype.offset=function(a,c){var e=b.Fb(a,c),d=b.Oa(this.x,this.y);if(0==e)return b.Fb(d,a);var p=new b;p.J(c);p.sub(a);d.sub(a);return d.Ai(p)/e};b.yn=function(b,c,e){var d=new a.$k;d.set(c.x);d.sub(b.x);var p=new a.$k;p.set(e.y);p.sub(b.y);var f=new a.$k;f.set(c.y);f.sub(b.y);var A=new a.$k;A.set(e.x);A.sub(b.x);d.Ap(p);f.Ap(A);d.sub(f);if(!d.Dq())return e=d.value(),0>e?-1:0<e?1:0;d=new a.Tn(c.x);p=new a.Tn(b.x);f=new a.Tn(b.y);
d=d.nr(p);b=new a.Tn(e.y);b=b.nr(f);c=new a.Tn(c.y);c=c.nr(f);e=new a.Tn(e.x);e=e.nr(p);d=d.Wp(b);c=c.Wp(e);d=d.Wp(c);return d.vP()?-1:d.nO()?1:0};b.prototype.hc=function(){return a.I.Rh(a.I.Rh())};return b}();a.b=b})(z||(z={}));(function(a){var b=function(){function a(a){this.Ov=this.Or=0;this.ES=a}a.prototype.reset=function(){this.Ov=this.Or=0};a.prototype.add=function(a){a-=this.Ov;var b=this.Or+a;this.Ov=b-this.Or-a;this.Or=b};a.prototype.sub=function(a){this.add(-a)};a.prototype.rl=function(){return this.ES+
this.Or};return a}();a.av=b;b=function(){function a(){}a.LT=function(a,b){return 0<=b?Math.abs(a):-Math.abs(a)};a.sign=function(a){return 0>a?-1:0<a?1:0};a.gH=function(a){return a-360*Math.floor(a/360)};a.round=function(a){return Math.floor(a+.5)};a.Ty=function(a){return a*a};a.ut=function(a,b,c){var e;.5>=c?e=a+(b-a)*c:e=b-(b-a)*(1-c);return e};a.BD=function(a,b,c,e){.5>=c?(e.x=a.x+(b.x-a.x)*c,e.y=a.y+(b.y-a.y)*c):(e.x=b.x-(b.x-a.x)*(1-c),e.y=b.y-(b.y-a.y)*(1-c))};a.tP=function(a,b,c,e,d,f){.5>=
d?(f.x=a+(c-a)*d,f.y=b+(e-b)*d):(f.x=c-(c-a)*(1-d),f.y=e-(e-b)*(1-d))};return a}();a.vi=b})(z||(z={}));(function(a){var b=function(b){function c(){b.call(this);this.ha=this.la=this.ja=this.na=0;this.fa=null}w(c,b);c.prototype.Mb=function(){return a.b.Oa(this.na,this.ja)};c.prototype.ht=function(a){a.x=this.na;a.y=this.ja};c.prototype.ed=function(a){this.gl(0,a)};c.prototype.Ny=function(b,c){this.gl(0,a.b.Oa(b,c))};c.prototype.En=function(a){this.wA(0,a)};c.prototype.setStart=function(a){this.CA(0,
a)};c.prototype.gt=function(a,b){return this.yd(0,a,b)};c.prototype.My=function(a,b,c){this.om(0,a,b,c)};c.prototype.oc=function(){return a.b.Oa(this.la,this.ha)};c.prototype.uw=function(a){a.x=this.la;a.y=this.ha};c.prototype.vd=function(a){this.gl(1,a)};c.prototype.Ok=function(b,c){this.gl(1,a.b.Oa(b,c))};c.prototype.Bn=function(a){this.wA(1,a)};c.prototype.setEnd=function(a){this.CA(1,a)};c.prototype.Ws=function(a,b){return this.yd(1,a,b)};c.prototype.Cy=function(a,b,c){this.om(1,a,b,c)};c.prototype.fb=
function(){return 1};c.prototype.s=function(){return this.sc()};c.prototype.Ja=function(){};c.prototype.Mh=function(){return 0};c.prototype.Ga=function(a,b,c,e,d){return this.wJ(a,b,c,e,d)};c.prototype.jc=function(a,b){return 0!=this.fq(a,b,!1)};c.prototype.Eq=function(a,b){return this.qs(a,b,!1)};c.prototype.qs=function(){return null};c.prototype.sc=function(){return!1};c.prototype.rv=function(b){this.qc();if(null==this.fa&&0<b)this.fa=a.I.Lh(2*b);else if(null!=this.fa&&this.fa.length<2*b){for(var c=
this.fa.slice(0),e=this.fa.length;e<2*b;e++)c[e]=0;this.fa=c}};c.KI=function(a,b,c){if(0<c)var e=0;for(var d=0;d<c;d++)b[0+e]=a[0],e++};c.prototype.gl=function(a,b){0!=a?(this.la=b.x,this.ha=b.y):(this.na=b.x,this.ja=b.y)};c.prototype.nm=function(b){if(null!=this.fa){for(var e=a.Od.iu(b,this.description),d=[],p=c.Xk(this.description,0),f=c.Xk(this.description,1),g=c.Xk(b,0),E=c.Xk(b,1),k=0,h=1,n=b.Aa;h<n;h++){var q=b.Hd(h),l=a.pa.Wa(q);if(-1==e[h])for(var H=a.pa.ue(q),q=0;q<l;q++)d[g+k]=H,d[E+k]=
H,k++;else for(H=this.description.fj(e[h])-2,q=0;q<l;q++)d[g+k]=this.fa[p+H],d[E+k]=this.fa[f+H],k++,H++}this.fa=d}this.description=b};c.prototype.wA=function(b,c){if(this.sc())throw a.g.ra("empty geometry");c.Qf(this.description);c.sc()&&c.ko();for(var e=0;e<this.description.Aa;e++)for(var d=this.description.Fd(e),p=0,f=a.pa.Wa(d);p<f;p++){var A=this.yd(b,d,p);c.setAttribute(d,p,A)}};c.prototype.CA=function(b,c){this.qc();if(c.sc())throw a.g.ra("empty geometry");for(var e=c.description,d=0,p=e.Aa;d<
p;d++)for(var f=e.Fd(d),A=a.pa.Wa(f),g=0;g<A;g++){var E=c.ld(f,g);this.om(b,f,g,E)}};c.prototype.yd=function(b,e,d){if(this.sc())throw a.g.ra("This operation was performed on an Empty Geometry.");if(0==e)return 0!=b?0!=d?this.ha:this.la:0!=d?this.ja:this.na;if(d>=a.pa.Wa(e))throw a.g.Uc();var p=this.description.zf(e);return 0<=p?(null!=this.fa&&this.rv(this.description.le.length-2),this.fa[c.Xk(this.description,b)+this.description.fj(p)-2+d]):a.pa.ue(e)};c.prototype.om=function(b,e,d,f){this.qc();
if(d>=a.pa.Wa(e))throw a.g.Uc();var p=this.description.zf(e);0>p&&(this.Ne(e),p=this.description.zf(e));0==e?0!=b?0!=d?this.ha=f:this.la=f:0!=d?this.ja=f:this.na=f:(null==this.fa&&this.rv(this.description.le.length-2),this.fa[c.Xk(this.description,b)+this.description.fj(p)-2+d]=f)};c.prototype.copyTo=function(b){if(b.D()!=this.D())throw a.g.N();b.description=this.description;b.rv(this.description.le.length-2);c.KI(this.fa,b.fa,2*(this.description.le.length-2));b.na=this.na;b.ja=this.ja;b.la=this.la;
b.ha=this.ha;b.qc();this.eo(b)};c.prototype.Ah=function(b,c){var e=new a.Nd;if(this.sc())return e.Ja(),e;e.qa=this.yd(0,b,c);e.va=e.qa;e.Oj(this.yd(1,b,c));return e};c.prototype.XE=function(a){this.sc()?a.Ja():(a.qa=this.yd(0,0,0),a.va=a.qa,a.Oj(this.yd(1,0,0)))};c.prototype.uu=function(b,c){c.Qf(this.description);c.ic(this.Kb(b));for(var e=1,d=this.description.Aa;e<d;e++)for(var p=this.description.Fd(e),f=a.pa.Wa(p),A=0;A<f;A++){var g=this.ld(b,p,A);c.setAttribute(p,A,g)}};c.prototype.sJ=function(a){if(this.description!=
a.description||this.na!=a.na||this.la!=a.la||this.ja!=a.ja||this.ha!=a.ha)return!1;for(var b=0;b<2*(this.description.le.length-2);b++)if(this.fa[b]!=a.fa[b])return!1;return!0};c.prototype.kD=function(){return this.na==this.la&&this.ja==this.ha};c.prototype.reverse=function(){var b=this.na;this.na=this.la;this.la=b;b=this.ja;this.ja=this.ha;this.ha=b;for(var b=1,c=this.description.Aa;b<c;b++)for(var e=this.description.Hd(b),d=0,f=a.pa.Wa(e);d<f;d++){var g=this.yd(0,e,d),E=this.yd(1,e,d);this.om(0,
e,d,E);this.om(1,e,d,g)}};c.prototype.fq=function(b,c,e){var d=b.D();switch(this.D()){case 322:if(322==d)return a.yb.xJ(this,b,c,e);throw a.g.wa();default:throw a.g.wa();}};c.prototype.wJ=function(b,c,e,d,f){var p=b.D();switch(this.D()){case 322:if(322==p)return a.yb.ov(this,b,c,e,d,f);throw a.g.wa();default:throw a.g.wa();}};c.prototype.kv=function(){return null};c.Xk=function(a,b){return b*(a.le.length-2)};c.prototype.Kb=function(b,c){if(void 0===c)return c=new a.b,this.Kb(b,c),c;a.vi.tP(this.na,
this.ja,this.la,this.ha,b,c)};c.prototype.Gd=function(){return null};c.prototype.TC=function(){return null};c.prototype.nt=function(){return null};c.prototype.mg=function(){return null};c.prototype.mD=function(){return null};c.prototype.Pf=function(){return null};c.prototype.rA=function(a,b){return void 0!==b?this.Ru(b)-this.Ru(a):this.Ru(a)};c.prototype.eo=function(){};c.prototype.xm=function(){return null};c.prototype.Bi=function(){};c.prototype.ld=function(){return null};c.prototype.xe=function(){return null};
c.prototype.Ru=function(){return null};c.prototype.AD=function(){return null};c.prototype.Fb=function(a,b){if(!b&&0!=this.fq(a,0,!1))return 0;b=1.7976931348623157E308;var c,e;c=this.Mb();e=a.Gd(c,!1);c.sub(a.Kb(e));c=c.length();c<b&&(b=c);c=this.oc();e=a.Gd(c,!1);c.sub(a.Kb(e));c=c.length();c<b&&(b=c);c=a.Mb();e=this.Gd(c,!1);c.sub(this.Kb(e));c=c.length();c<b&&(b=c);c=a.oc();e=this.Gd(c,!1);c.sub(this.Kb(e));c=c.length();c<b&&(b=c);return b};c.prototype.Rf=function(){return a.Hh.il(this,null)};return c}(a.T);
a.fA=b})(z||(z={}));new z.b;(function(a){(function(a){a[a.Unknown=-1]="Unknown";a[a.Not=0]="Not";a[a.Weak=1]="Weak";a[a.Strong=2]="Strong"})(a.tH||(a.tH={}));(function(a){a[a.DirtyIsKnownSimple=1]="DirtyIsKnownSimple";a[a.IsWeakSimple=2]="IsWeakSimple";a[a.IsStrongSimple=4]="IsStrongSimple";a[a.DirtyOGCFlags=8]="DirtyOGCFlags";a[a.DirtyVerifiedStreams=32]="DirtyVerifiedStreams";a[a.DirtyExactIntervals=64]="DirtyExactIntervals";a[a.DirtyLooseIntervals=128]="DirtyLooseIntervals";a[a.DirtyIntervals=
192]="DirtyIntervals";a[a.DirtyIsEnvelope=256]="DirtyIsEnvelope";a[a.DirtyLength2D=512]="DirtyLength2D";a[a.DirtyRingAreas2D=1024]="DirtyRingAreas2D";a[a.DirtyCoordinates=1993]="DirtyCoordinates";a[a.DirtyAllInternal=65535]="DirtyAllInternal";a[a.DirtyAll=16777215]="DirtyAll"})(a.cH||(a.cH={}));var b=function(b){function c(){b.call(this);this.El=65535;this.ta=0;this.rg=-1;this.pb=null}w(c,b);c.prototype.eo=function(){};c.prototype.qv=function(){};c.prototype.xv=function(){};c.prototype.F=function(){return this.ta};
c.prototype.s=function(){return this.sc()};c.prototype.sc=function(){return 0==this.ta};c.prototype.gj=function(a){return 0!=(this.El&a)};c.prototype.yf=function(a,b){this.El=b?this.El|a:this.El&~a};c.prototype.kc=function(){this.gj(32)&&this.FJ()};c.prototype.Su=function(){if(this.sc())throw a.g.ra("This operation was performed on an Empty Geometry.");};c.prototype.Sd=function(b,c){if(0>b||b>=this.ta)throw a.g.ra("index out of bounds");this.kc();c.Qf(this.description);c.s()&&c.ko();for(var e=0;e<
this.description.Aa;e++)for(var d=this.description.Fd(e),p=0,f=a.pa.Wa(d);p<f;p++){var A=this.Ba[e].Bh(f*b+p);c.setAttribute(d,p,A)}};c.prototype.Iu=function(b,c){this.kc();for(var e=c.description,d=0;d<e.Aa;d++)for(var p=e.Fd(d),f=a.pa.Wa(p),A=0;A<f;A++){var g=c.ld(p,A);this.setAttribute(p,b,A,g)}};c.prototype.w=function(b,c){if(0>b||b>=this.F())throw a.g.Uc();this.kc();this.Ba[0].ec(2*b,c)};c.prototype.Fa=function(b){var c=new a.b;this.w(b,c);return c};c.prototype.uc=function(a,b){this.Ba[0].ec(2*
a,b)};c.prototype.ic=function(b,c,e){if(0>b||b>=this.ta)throw a.g.Uc();this.kc();var d=this.Ba[0];void 0!==e?(d.write(2*b,c),d.write(2*b+1,e)):d.Rn(2*b,c);this.ce(1993)};c.prototype.Lw=function(b){if(0>b||b>=this.F())throw a.g.Uc();this.kc();var c=this.Ba[0],e=new a.ee;e.x=c.read(2*b);e.y=c.read(2*b+1);e.z=this.hasAttribute(1)?this.Ba[1].Bh(b):a.pa.ue(1);return e};c.prototype.Py=function(b,c){if(0>b||b>=this.F())throw a.g.Uc();this.Ne(1);this.kc();this.ce(1993);var e=this.Ba[0];e.write(2*b,c.x);e.write(2*
b+1,c.y);this.Ba[1].Uk(b,c.z)};c.prototype.ld=function(b,c,e){if(0>c||c>=this.ta)throw a.g.Uc();var d=a.pa.Wa(b);if(e>=d)throw a.g.Uc();this.kc();var p=this.description.zf(b);return 0<=p?this.Ba[p].Bh(c*d+e):a.pa.ue(b)};c.prototype.nC=function(a,b,c){return this.ld(a,b,c)};c.prototype.setAttribute=function(b,c,e,d){if(0>c||c>=this.ta)throw a.g.Uc();var p=a.pa.Wa(b);if(e>=p)throw a.g.Uc();this.Ne(b);this.kc();b=this.description.zf(b);this.ce(1993);this.Ba[b].Uk(c*p+e,d)};c.prototype.mc=function(a){this.Su();
this.Ne(a);this.kc();return this.Ba[this.description.zf(a)]};c.prototype.bm=function(b,c){if(null!=c&&a.pa.Qh(b)!=c.Qh())throw a.g.N();this.Ne(b);b=this.description.zf(b);null==this.Ba&&(this.Ba=a.Ac.ay(this.description.Aa));this.Ba[b]=c;this.ce(16777215)};c.prototype.nm=function(b){var c=null;if(null!=this.Ba)for(var e=a.Od.iu(b,this.description),c=[],d=0,p=b.Aa;d<p;d++)-1!=e[d]&&(c[d]=this.Ba[e[d]]);this.description=b;this.Ba=c;this.rg=-1;this.ce(16777215)};c.prototype.IA=function(b){this.ss(!0);
b instanceof a.i?this.R.o(b):this.R.Cn(b)};c.prototype.EJ=function(b){this.ss(!1);b instanceof a.i?this.R.o(b):this.R.Cn(b)};c.prototype.Fp=function(a){this.ss(!0);this.R.copyTo(a)};c.prototype.o=function(a){this.IA(a)};c.prototype.Cn=function(a){this.IA(a)};c.prototype.dd=function(a){this.EJ(a)};c.prototype.Ah=function(b,c){var e=new a.Nd;if(this.sc())return e.Ja(),e;this.ss(!0);return this.R.Ah(b,c)};c.prototype.hc=function(){var b=this.description.hc();if(!this.sc())for(var c=this.F(),e=0,d=this.description.Aa;e<
d;e++)b=this.Ba[e].jj(b,0,c*a.pa.Wa(this.description.Fd(e)));return b};c.prototype.lc=function(b){if(b==this)return!0;if(!(b instanceof c&&this.description.lc(b.description))||this.sc()!=b.sc())return!1;if(this.sc())return!0;var e=this.F();if(e!=b.F())return!1;for(var d=0;d<this.description.Aa;d++){var p=this.description.Hd(d),f=this.mc(p),g=b.mc(p);if(!f.lc(g,0,e*a.pa.Wa(p)))return!1}return!0};c.prototype.copyTo=function(b){if(b.D()!=this.D())throw a.g.N();this.tA(b)};c.prototype.tA=function(b){this.kc();
b.description=this.description;b.Ba=null;var c=this.description.Aa,e=null;if(null!=this.Ba)for(var e=[],d=0;d<c;d++)null!=this.Ba[d]&&(e[d]=this.Ba[d].Ip(this.F()*a.pa.Wa(this.description.Fd(d))));null!=this.R?(b.R=this.R.Pa(),this.R.copyTo(b.R)):b.R=null;b.ta=this.ta;b.El=this.El;b.Ba=e;try{this.eo(b)}catch(V){throw b.Ja(),a.g.BI();}};c.prototype.EA=function(){this.ta=0;this.rg=-1;this.Ba=null;this.ce(16777215)};c.prototype.ce=function(a){16777215==a&&(this.rg=-1,this.qv());this.El|=a;this.kJ();
this.qc()};c.prototype.ss=function(b){this.kc();if(this.gj(192))if(null==this.R?this.R=new a.Vj(this.description):this.R.Qf(this.description),this.s())this.R.Ja();else{this.wv(b);for(var c=1;c<this.description.Aa;c++)for(var e=this.description.Fd(c),d=a.pa.Wa(e),p=this.Ba[c],f=0;f<d;f++){var g=new a.Nd;g.Ja();for(var E=0;E<this.ta;E++){var k=p.Bh(E*d+f);g.Db(k)}this.R.setInterval(e,f,g)}b&&this.yf(192,!1)}};c.prototype.wv=function(){this.R.Ja();for(var b=this.Ba[0],c=new a.b,e=0;e<this.ta;e++)b.ec(2*
e,c),this.R.Db(c)};c.prototype.tm=function(b){b.Ja();for(var c=this.Ba[0],e=new a.b,d=0;d<this.ta;d++)c.ec(2*d,e),b.Db(e)};c.prototype.FJ=function(){if(this.rg<this.ta){null==this.Ba&&(this.Ba=a.Ac.ay(this.description.Aa));this.rg=2147483647;for(var b=0;b<this.description.Aa;b++){var c=this.description.Fd(b);if(null!=this.Ba[b]){var e=a.pa.Wa(c),d=a.I.truncate(this.Ba[b].size/e);d<this.ta&&(d=a.I.truncate(this.rg>this.ta+5?(5*this.ta+3)/4:this.ta),this.Ba[b].resize(d*e,a.pa.ue(c)));d<this.rg&&(this.rg=
d)}else this.Ba[b]=a.Ac.Tv(c,this.ta),this.rg=this.ta}}this.xv();this.yf(32,!1)};c.prototype.jo=function(b){if(0>b)throw a.g.N();b!=this.ta&&(this.ta=b,this.ce(65535))};c.prototype.rj=function(a){if(!this.gj(1)){if(!this.gj(2))return 0;if(this.TP>=a)return this.gj(8)?1:2}return-1};c.prototype.hg=function(b,c){this.TP=c;if(-1==b)this.yf(1,!0),this.yf(8,!0);else if(this.yf(1,!1),this.yf(8,!0),0==b)this.yf(2,!1),this.yf(4,!1);else if(1==b)this.yf(2,!0),this.yf(4,!1);else if(2==b)this.yf(2,!0),this.yf(4,
!0);else throw a.g.ra("internal error.");};c.prototype.kJ=function(){null!=this.pb&&(this.pb=null)};c.prototype.vJ=function(b,c,e,d){if(0>b||b>=this.ta)throw a.g.ra("index out of bounds");if(0>c||c>=this.ta)throw a.g.ra("index out of bounds");this.kc();d.Qf(this.description);d.s()&&d.ko();for(var p=0;p<this.description.Aa;p++)for(var f=this.description.Fd(p),A=0,g=a.pa.Wa(f);A<g;A++){var K=this.Ba[p].Bh(g*b+A),E=this.Ba[p].Bh(g*c+A);d.setAttribute(f,A,a.vi.ut(K,E,e))}};c.prototype.mv=function(a,b){var c=
this.Ba[0].f,e=c[2*a]-c[2*b],c=c[2*a+1]-c[2*b+1];return Math.sqrt(e*e+c*c)};c.prototype.bh=function(b,c){if(0>b||b>=this.ta)throw a.g.Uc();if(c.s())throw a.g.N();this.kc();for(var e=c.description,d=0;d<e.Aa;d++)for(var p=e.Hd(d),f=a.pa.Wa(p),A=0;A<f;A++){var g=c.ld(p,A);this.setAttribute(p,b,A,g)}};c.prototype.jv=function(){return null};c.prototype.dj=function(){return null};return c}(a.T);a.Wr=b})(z||(z={}));(function(a){var b=function(){function b(){this.cb=this.Qm=null;this.Ol=124234251;this.Ct=
!0;this.Ae=-1;this.cb=new a.Fc(7);this.Qm=null}b.prototype.Hn=function(a){this.Qm=a};b.prototype.lM=function(){this.Ct=!1};b.prototype.de=function(a){this.cb.de(a)};b.prototype.nq=function(a){var b=this.cb.be();this.mS(b);this.oS(a,b);return b};b.prototype.fM=function(a){this.cb.Jc(a)};b.prototype.addElement=function(a,b){var c;-1==b?(-1==this.Ae&&(this.Ae=this.nq(-1)),c=this.Ae):c=b;return this.MA(a,0,c)};b.prototype.PA=function(a){-1==this.Ae&&(this.Ae=this.nq(-1));return this.MA(a,1,this.Ae)};
b.prototype.qm=function(a){var b;-1==this.Ae&&(this.Ae=this.nq(-1));b=this.Ae;var c=this.cb.f;if(-1==b||-1==c[7*b])return a=this.cb.Pj([-1,-1,-1,a,this.ck(),-1,-1]),c=this.cb.f,c[7*b]=a,this.mo(-1,a,b,c),a;var e=-1==b?-1:c[7*b+2];a=this.cb.Pj([-1,-1,e,a,this.ck(),-1,-1]);c=this.cb.f;c[7*e+1]=a;this.Fv(a,c);-1===c[7*a+2]&&(c[7*b]=a);this.mo(-1,a,b,c);return a};b.prototype.vs=function(b,c,e,d){var p=-1;-1==p&&(-1==this.Ae&&(this.Ae=this.nq(-1)),p=this.Ae);var f=this.cb.f;if(-1==p||-1==f[7*p])return e=
this.cb.Pj([-1,-1,-1,e,this.ck(),-1,-1]),f=this.cb.f,f[7*p]=e,this.mo(-1,e,p,f),e;var A;d?(d=-1!=c?this.Qm.compare(this,e,c):-1,A=-1!=b?this.Qm.compare(this,e,b):1):(d=-1,A=1);if(0==d||0==A)return f[7*p+3]=0==d?c:b,-1;(-1!=c&&-1!=b?this.Ol>a.I.$x(this.Ol)>>1:-1!=c)?b=c:d=A;for(c=!0;;){if(0>d)if(A=f[7*b],-1!=A)b=A;else{d=b;e=this.cb.Pj([-1,-1,b,e,this.ck(),-1,-1]);f=this.cb.f;f[7*b]=e;break}else if(A=f[7*b+1],-1!=A)b=A;else{d=f[7*b+6];e=this.cb.Pj([-1,-1,b,e,this.ck(),-1,-1]);f=this.cb.f;f[7*b+1]=
e;break}c&&(d*=-1,c=!1)}this.Fv(e,f);-1===f[7*e+2]&&(f[7*p]=e);this.mo(d,e,p,f);return e};b.prototype.tC=function(){return this.xN(this.Ae)};b.prototype.kd=function(a,b){b=-1==b?this.Ae:b;this.Ct?this.eM(a,b):this.$S(a,b)};b.prototype.search=function(a,b){for(b=this.dt(b);-1!=b;){var c=this.Qm.compare(this,a,b);if(0==c)return b;b=0>c?this.ik(b):this.Jo(b)}return-1};b.prototype.GR=function(a){for(var b=this.dt(-1),c=-1;-1!=b;){var e=a.compare(this,b);if(0==e)return b;0>e?b=this.ik(b):(c=b,b=this.Jo(b))}return c};
b.prototype.sF=function(a){for(var b=this.dt(-1),c=-1;-1!=b;){var e=a.compare(this,b);if(0==e)return b;0>e?(c=b,b=this.ik(b)):b=this.Jo(b)}return c};b.prototype.da=function(a){return this.cb.O(a,3)};b.prototype.ik=function(a){return this.cb.O(a,0)};b.prototype.Jo=function(a){return this.cb.O(a,1)};b.prototype.getParent=function(a){return this.cb.O(a,2)};b.prototype.bb=function(a){return this.cb.O(a,6)};b.prototype.ge=function(a){return this.cb.O(a,5)};b.prototype.gc=function(a){return-1==a?this.gk(this.Ae):
this.gk(a)};b.prototype.tc=function(a){return-1==a?this.uq(this.Ae):this.uq(a)};b.prototype.hO=function(a){return-1==a?this.QC(this.Ae):this.QC(a)};b.prototype.Vi=function(a,b){this.By(a,b)};b.prototype.dt=function(a){return-1==a?this.MC(this.Ae):this.MC(a)};b.prototype.clear=function(){this.cb.Nh(!1);this.Ae=-1};b.prototype.size=function(a){return-1==a?this.OC(this.Ae):this.OC(a)};b.prototype.pK=function(a,b){for(var c=b[7*a],e=b[7*a+1],d=b[7*a+4];-1!=c||-1!=e;){var p=-1!=c?b[7*c+4]:2147483647,e=
-1!=e?b[7*e+4]:2147483647;if(d<=Math.min(p,e))break;p<=e?this.oF(c,b):this.nF(a,b);c=b[7*a];e=b[7*a+1]}};b.prototype.Fv=function(a,b){if(this.Ct)for(var c=b[7*a+4],e=b[7*a+2];-1!=e&&b[7*e+4]>c;)b[7*e]==a?this.oF(a,b):this.nF(e,b),e=b[7*a+2]};b.prototype.nF=function(a,b){var c=b[7*a+1],e;b[7*c+2]=b[7*a+2];b[7*a+2]=c;e=b[7*c];b[7*a+1]=e;-1!=e&&(b[7*e+2]=a);b[7*c]=a;e=b[7*c+2];-1!=e&&(b[7*e]==a?b[7*e]=c:b[7*e+1]=c)};b.prototype.oF=function(a,b){var c=b[7*a+2],e;b[7*a+2]=b[7*c+2];b[7*c+2]=a;e=b[7*a+1];
b[7*c]=e;-1!=e&&(b[7*e+2]=c);b[7*a+1]=c;e=b[7*a+2];-1!=e&&(b[7*e]===c?b[7*e]=a:b[7*e+1]=a)};b.prototype.Tj=function(a,b){this.cb.L(a,2,b)};b.prototype.Gy=function(a,b){this.cb.L(a,0,b)};b.prototype.Ky=function(a,b){this.cb.L(a,1,b)};b.prototype.Jy=function(a,b){this.cb.L(a,5,b)};b.prototype.Gu=function(a,b){this.cb.L(a,6,b)};b.prototype.VF=function(a,b){this.cb.L(b,0,a)};b.prototype.mS=function(a){this.cb.L(a,4,0)};b.prototype.oS=function(a,b){this.cb.L(b,5,a)};b.prototype.MC=function(a){return-1==
a?-1:this.cb.O(a,0)};b.prototype.gk=function(a){return-1==a?-1:this.cb.O(a,1)};b.prototype.uq=function(a){return-1==a?-1:this.cb.O(a,2)};b.prototype.xN=function(a){return-1==a?-1:this.cb.O(a,3)};b.prototype.OC=function(a){return-1==a?0:this.cb.O(a,4)};b.prototype.QC=function(a){return this.cb.O(a,5)};b.prototype.ou=function(a){return this.cb.Pj([-1,-1,-1,a,this.ck(),-1,-1])};b.prototype.bk=function(a){-1!=a&&this.cb.Jc(a)};b.prototype.ck=function(){this.Ol=a.I.$x(this.Ol);return this.Ol&1073741823};
b.prototype.MA=function(a,b,c){var e=this.cb.f;if(-1==c||-1==e[7*c])return a=this.cb.Pj([-1,-1,-1,a,this.ck(),-1,-1]),e=this.cb.f,e[7*c]=a,this.mo(-1,a,c,e),a;for(var d=-1==c?-1:e[7*c];;){var p=-1==b?1:this.Qm.compare(this,a,d);if(0>p)if(p=this.ik(d),-1!=p)d=p;else{b=d;a=this.cb.Pj([-1,-1,d,a,this.ck(),-1,-1]);e=this.cb.f;e[7*d]=a;break}else{if(1==b&&0==p)return e[7*c+3]=d,-1;p=e[7*d+1];if(-1!=p)d=p;else{b=e[7*d+6];a=this.cb.Pj([-1,-1,d,a,this.ck(),-1,-1]);e=this.cb.f;e[7*d+1]=a;break}}}this.Fv(a,
e);-1===e[7*a+2]&&(e[7*c]=a);this.mo(b,a,c,e);return a};b.prototype.mo=function(a,b,c,e){var d;-1!=a?(d=e[7*a+5],e[7*a+5]=b):d=-1==c?-1:e[7*c+2];e[7*b+5]=d;-1!=d&&(e[7*d+6]=b);e[7*b+6]=a;a==(-1==c?-1:e[7*c+1])&&(e[7*c+1]=b);-1==a&&(e[7*c+2]=b);e[7*c+4]=(-1==c?0:e[7*c+4])+1};b.prototype.ry=function(a,b){var c=this.cb.f,e=c[7*a+5];a=c[7*a+6];-1!=e?c[7*e+6]=a:c[7*b+1]=a;-1!=a?c[7*a+5]=e:c[7*b+2]=e;c[7*b+4]=-1===b?-1:c[7*b+4]-1};b.prototype.$S=function(b,c){this.ry(b,c);var e=this.ik(b),d=this.Jo(b),
p=this.getParent(b),f=b;if(-1!=e&&-1!=d){this.Ol=a.I.$x(this.Ol);var g;g=1073741823<this.Ol?this.bb(b):this.ge(b);var k=this.getParent(g)==b;this.cb.Pu(b,g,0);this.cb.Pu(b,g,1);this.cb.Pu(b,g,2);-1!=p?this.ik(p)==b?this.Gy(p,g):this.Ky(p,g):this.VF(g,c);k?(e==g?(this.Gy(g,b),this.Tj(d,g)):d==g&&(this.Ky(g,b),this.Tj(e,g)),this.Tj(b,g),p=g):(this.Tj(e,g),this.Tj(d,g),p=this.getParent(b),f=g);e=this.ik(b);d=this.Jo(b);-1!=e&&this.Tj(e,b);-1!=d&&this.Tj(d,b)}e=-1!=e?e:d;-1==p?this.VF(e,c):this.ik(p)==
f?this.Gy(p,e):this.Ky(p,e);-1!=e&&this.Tj(e,p);this.bk(b,c)};b.prototype.eM=function(a,b){var c=this.cb.f;c[7*a+4]=2147483647;var e=-1,d=-1,p=-1===b?-1:c[7*b],f=p==a;f&&(e=c[7*p],d=c[7*p+1],-1==e&&-1==d)?(this.ry(p,b),this.bk(p,b),c[7*b]=-1):(this.pK(a,c),p=c[7*a+2],-1!=p&&(c[7*p]==a?c[7*p]=-1:c[7*p+1]=-1),this.ry(a,b),this.bk(a,b),f&&(c[7*b]=-1==e||-1!=c[7*e+2]?d:e))};b.prototype.By=function(a,b){this.cb.L(a,3,b)};return b}();a.bj=b})(z||(z={}));(function(a){var b=function(){function b(a,b){void 0!==
a&&this.K(a,b)}b.prototype.K=function(a,b){this.qa=a;this.va=b;this.normalize()};b.prototype.normalize=function(){if(!isNaN(this.qa)){if(this.qa>this.va){var a=this.qa;this.qa=this.va;this.va=a}isNaN(this.va)&&this.Ja()}};b.prototype.Ja=function(){this.va=this.qa=NaN};b.prototype.s=function(){return isNaN(this.qa)};b.prototype.Db=function(a){"number"===typeof a?this.s()?this.va=this.qa=a:this.Oj(a):a.s()||(this.s()?(this.qa=a.qa,this.va=a.va):(this.qa>a.qa&&(this.qa=a.qa),this.va<a.va&&(this.va=a.va),
this.qa>this.va&&this.Ja()))};b.prototype.Oj=function(a){a<this.qa?this.qa=a:a>this.va&&(this.va=a)};b.prototype.contains=function(a){return"number"===typeof a?a>=this.qa&&a<=this.va:a.qa>=this.qa&&a.va<=this.va};b.prototype.Ga=function(a){this.s()||a.s()?this.Ja():(this.qa<a.qa&&(this.qa=a.qa),this.va>a.va&&(this.va=a.va),this.qa>this.va&&this.Ja())};b.prototype.P=function(a){this.s()||(this.qa-=a,this.va+=a,this.va<this.qa&&this.Ja())};b.prototype.lv=function(){return this.s()?2.220446049250313E-14:
2.220446049250313E-14*(Math.abs(this.qa)+Math.abs(this.va)+1)};b.prototype.yy=function(a,b){a>b?(this.qa=b,this.va=a):(this.qa=a,this.va=b)};b.prototype.Sy=function(b){return a.I.Kr(b,this.qa,this.va)};b.prototype.aa=function(){return this.va-this.qa};b.prototype.Af=function(){return.5*(this.qa+this.va)};b.prototype.lc=function(a){return a==this?!0:a instanceof b?this.s()&&a.s()?!0:this.qa!=a.qa||this.va!=a.va?!1:!0:!1};b.prototype.hc=function(){return a.I.Rh(a.I.Rh())};return b}();a.Nd=b})(z||(z=
{}));(function(a){var b=new a.Nd,c=new a.Nd,e=function(){return function(){this.Zd=null;this.Lf=-1;this.ib=new a.yb;this.ux=55555555;this.Et=this.Ft=!1;this.$h=new a.Nd;this.$h.yy(0,0)}}();a.XT=e;var d=function(){function d(b,c,d){this.a=b;this.Mj=NaN;this.mE=this.sp=0;this.nE=NaN;this.ka=c;this.tp=10*c;this.oE=this.pE=NaN;this.Zf=!1;this.Cl=this.mr=this.un=this.gr=this.fr=-1;this.lx=d;this.Rx=new e;this.vE=new e;a.I.truncate(3*b.pd/2)}d.prototype.$C=function(a,b,c,e){a.Zd=null===e?null:e[c[5*b]];
a.Et=null!=a.Zd;a.Et||(e=c[5*b+2],-1!==e&&this.a.gR(c[5*b],c[5*e],a.ib),a.Zd=a.ib,a.$h.yy(a.ib.na,a.ib.la),a.$h.va+=this.ka,a.ib.KE(),a.Ft=a.ib.ha==a.ib.ja,a.Ft||(a.ux=(a.ib.la-a.ib.na)/(a.ib.ha-a.ib.ja)))};d.prototype.tL=function(a,b){var c=a.fq(b,this.ka,!0);if(0!=c)return 2==c?this.aw():this.Oh();a.ht(B);a.uw(F);b.ht(G);b.uw(N);C.ma(this.sp,this.Mj);B.ub(G)&&this.Mj==B.y?0>F.compare(N)?C.J(F):C.J(N):B.ub(N)&&this.Mj==B.y?0>F.compare(G)?C.J(F):C.J(G):G.ub(F)&&this.Mj==G.y?0>B.compare(N)?C.J(B):
C.J(N):F.ub(N)&&this.Mj==F.y&&(0>B.compare(G)?C.J(B):C.J(G));return a.xe(C.y,C.x)<b.xe(C.y,C.x)?-1:1};d.prototype.rL=function(a,b){if(a.ib.ja==b.ib.ja&&a.ib.na==b.ib.na)return a.ib.ha==b.ib.ha&&a.ib.la==b.ib.la?this.lx?this.aw():0:this.HB(a,b);if(a.ib.ha==b.ib.ha&&a.ib.la==b.ib.la)return this.GB(a,b);var c=this.GB(a,b);a=this.HB(a,b);return 0>c&&0>a?-1:0<c&&0<a?1:this.Oh()};d.prototype.mL=function(a,b){if(a.la>b.la){if(b.la>b.na&&b.ha-b.ja<2*this.ka&&a.Kh(b.la,b.ha,this.ka))return this.Oh()}else if((b.ha-
b.ja)/(b.la-b.na)*(a.la-a.na)<this.tp&&b.Kh(a.la,a.ha,this.ka))return this.Oh();return 1};d.prototype.nL=function(a,b){if(a.na<b.na){if(b.la>b.na&&b.ha-b.ja<2*this.ka&&a.Kh(b.la,b.ha,this.ka))return this.Oh()}else if((b.ha-b.ja)/(b.la-b.na)*(a.na-a.la)<this.tp&&b.Kh(a.na,a.ja,this.ka))return this.Oh();return-1};d.prototype.oL=function(b,c){var e=new a.b;e.pc(c.oc(),c.Mb());e.Kp();e.normalize();var d=new a.b;d.pc(b.Mb(),c.Mb());var p=new a.b;p.pc(b.oc(),c.Mb());var d=d.ml(e),e=p.ml(e),p=Math.abs(d),
f=Math.abs(e);if(p<f){if(p<this.tp&&c.Kh(b.na,b.ja,this.ka))return this.Oh()}else if(f<this.tp&&c.Kh(b.la,b.ha,this.ka))return this.Oh();return 0>d&&0>e?-1:0<d&&0<e?1:this.Oh()};d.prototype.FB=function(a,b){return a.ja==b.ja&&a.na==b.na?this.mL(a,b):a.ha==b.ha&&a.la==b.la?this.nL(a,b):this.oL(a,b)};d.prototype.qL=function(a,b){return a.ha==b.ha&&a.la==b.la&&a.ja==b.ja&&a.na==b.na?this.lx?this.aw():0:this.Oh()};d.prototype.GB=function(a,b){var c=1;if(a.ib.ja<b.ib.ja){var c=-1,e=a;a=b;b=e}e=a.ib;a=
b.ib;var d=e.na-a.na;b=b.ux*(e.ja-a.ja);var p=this.tp;return d<b-p?-c:d>b+p?c:a.Kh(e.na,e.ja,this.ka)?this.Oh():d<b?-c:c};d.prototype.HB=function(a,b){var c=1;if(b.ib.ha<a.ib.ha){var c=-1,e=a;a=b;b=e}e=a.ib;a=b.ib;var d=e.la-a.na;b=b.ux*(e.ha-a.ja);var p=this.tp;return d<b-p?-c:d>b+p?c:a.Kh(e.la,e.ha,this.ka)?this.Oh():d<b?-c:c};d.prototype.aw=function(){this.Zf=!0;this.ei=new a.wd(5,this.un,this.mr);return-1};d.prototype.Oh=function(){this.Zf=!0;this.lx?this.ei=new a.wd(4,this.un,this.mr):this.mr=
this.un=this.gr=this.fr=-1;return-1};d.prototype.sL=function(a,e,d,p){if(this.Zf)return-1;var f=this.nE==this.Mj&&this.mE==this.sp,A;f&&a==this.fr?A=this.oE:(A=NaN,this.fr=-1);f&&e==this.gr?f=this.pE:(f=NaN,this.gr=-1);d.Zd.XE(b);p.Zd.XE(c);if(b.va<c.qa)return-1;if(c.va<b.qa)return 1;this.nE=this.Mj;this.mE=this.sp;isNaN(A)&&(this.fr=a,this.oE=A=a=d.Zd.xe(this.Mj,this.sp));isNaN(f)&&(this.gr=e,this.pE=f=a=p.Zd.xe(this.Mj,this.sp));return Math.abs(A-f)<=this.ka?this.tL(d.Zd,p.Zd):A<f?-1:A>f?1:0};d.prototype.lq=
function(){this.Zf=!1};d.prototype.rl=function(){return this.ei};d.prototype.XF=function(a,b){this.Mj=a;this.sp=b;this.mr=this.un=this.gr=this.fr=-1};d.prototype.compare=function(a,b,c){if(this.Zf)return-1;a=a.da(c);this.Cl=c;return this.JB(b,b,a,a)};d.prototype.JB=function(a,b,c,e){var d;this.un==b?d=this.Rx:(this.un=b,d=this.Rx,this.Rx.Lf=a,this.$C(d,b,this.a.cd.f,this.a.Ge));var p;null==p&&(this.mr=e,p=this.vE,this.vE.Lf=c,this.$C(p,e,this.a.cd.f,this.a.Ge));if(d.Et||p.Et)return this.sL(b,e,d,
p);if(d.$h.va<p.$h.qa)return-1;if(p.$h.va<d.$h.qa)return 1;a=d.Ft?1:0;a|=p.Ft?2:0;return 0==a?this.rL(d,p):1==a?this.FB(d.ib,p.ib):2==a?-1*this.FB(p.ib,d.ib):this.qL(d.ib,p.ib)};return d}();a.hA=d})(z||(z={}));(function(a){var b=function(){function b(b,c){this.a=b;this.ka=c;this.Zf=!1;this.un=-1;this.$h=new a.Nd;this.pp=new a.b;this.pp.Eh();this.Vd=new a.yb;this.Cl=-1;this.Cx=1.7976931348623157E308}b.prototype.lq=function(){this.Zf=!1;this.Cx=1.7976931348623157E308};b.prototype.bh=function(a){this.pp.J(a)};
b.prototype.compare=function(a,b){return this.KB(b,a.da(b))};b.prototype.KB=function(b,c){var e=null!=this.a.cc(c);e||(this.a.Oc(c,this.Vd),this.$h.yy(this.Vd.na,this.Vd.la));if(e)throw a.g.ra("not implemented");if(this.pp.x+this.ka<this.$h.qa)return-1;if(this.pp.x-this.ka>this.$h.va)return 1;if(this.Vd.ja==this.Vd.ha)return this.Cl=b,this.Zf=!0,0;this.Vd.KE();c=this.Vd.Mb();e=new a.b;e.pc(this.Vd.oc(),c);e.Kp();var d=new a.b;d.pc(this.pp,c);c=e.ml(d);c/=e.length();return c<10*-this.ka?-1:c>10*this.ka?
1:this.Vd.Eq(this.pp,this.ka)&&(e=Math.abs(c),e<this.Cx&&(this.Cl=b,this.Cx=e),this.Zf=!0,e<.25*this.ka)?0:0>c?-1:1};return b}();a.JI=b})(z||(z={}));(function(a){function b(a,b,c,e){c=new Float64Array(a.subarray(c,e));a.set(c,b)}var c=function(){function b(c){this.Sa=this.Xf=!1;this.f=[];var e=c;2>e&&(e=2);this.f=a.I.Lh(e,b.ob);this.size=c}b.Yc=function(a,c){b.ob=c;a=new b(a);b.ob=0;return a};b.lj=function(a){var c=new b(0);c.f=a.f.slice(0);c.size=a.size;return c};b.V=function(a,c){var e=new b(0);
e.size=a.size;e.size>c&&(e.size=c);e.f=a.f.slice(0,e.size);return e};b.prototype.xb=function(){};b.prototype.read=function(a){return this.f[a]};b.prototype.ec=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};b.prototype.get=function(a){return this.f[a]};b.prototype.write=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};b.prototype.set=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};b.prototype.Rn=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.add=function(a){this.resize(this.size+
1);this.f[this.size-1]=a};b.prototype.Ip=function(a){return b.V(this,a)};b.prototype.Bh=function(a){return this.read(a)};b.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(a.I.truncate(5*b/4)<this.f.length){var e=this.f.slice(0,b);this.f=e}}else if(b>this.f.length){a.I.truncate(64>b?Math.max(2*b,4):5*b/4);for(var e=this.f.slice(0),d=this.f.length;d<b;d++)e[d]=c;this.f=e}this.size=b};b.prototype.cf=
function(b){(null==this.f||b>this.f.length)&&this.resize(b);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};b.prototype.Uk=function(a,b){this.write(a,b)};b.prototype.jj=function(b,c,e){for(var d=this.size;c<d&&c<e;c++)b=a.I.Rh(this.read(c));return b};b.prototype.lc=function(a,c,e){if(null==a||!(a instanceof b))return!1;var d=this.size,p=a.size;if(e>d||e>p&&d!=p)return!1;for(e>d&&(e=d);c<e;c++)if(this.read(c)!=a.read(c))return!1;return!0};b.prototype.nk=
function(b,c,e,d,f,g,k){if(this.Sa)throw a.g.xa();if(!f&&(1>g||0!=d%g))throw a.g.N();var p=this.size-k;p<d&&this.resize(this.size+d-p);for(p=0;p<k-b;p++)this.f[b+d+p]=this.f[b+p];this.f==c.f&&b<e&&(e+=d);if(f)for(p=0;p<d;p++)this.f[p+b]=c.f[e+p];else for(f=d,k=0;k<d;k+=g)for(f-=g,p=0;p<g;p++)this.f[b+k+p]=c.f[e+f+p]};b.prototype.ul=function(b,c,e,d){if(this.Sa)throw a.g.xa();d-=b;for(var p=this.f.slice(b,b+d),f=0;f<d;f++)this.f[b+e+f]=p[f];for(d=0;d<e;d++)this.f[b+d]=c};b.prototype.lg=function(b,
c,e){if(this.Sa)throw a.g.xa();for(var d=this.f.slice(b,b+(e-b)),p=0;p<e-b;p++)this.f[p+b+2]=d[p];this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.km=function(b,c,e,d,f,g){if(0>b||0>c||0>d)throw a.g.N();if(!f&&(0>=g||0!=c%g))throw a.g.N();if(e.size<d+c)throw a.g.N();if(0!=c)if(this.size<c+b&&this.resize(c+b),e==this)this.xi(b,c,d,f,g);else if(f)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d++;else if(d=d+c-g,1==g)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d--;else for(f=0,c=a.I.truncate(c/g);f<c;f++){for(var p=0;p<g;p++)this.f[b+
p]=e.f[d+p];b+=g;d-=g}};b.prototype.oj=function(b,c,e){if(this.Sa)throw a.g.xa();if(b+c>this.size)throw a.g.xa();if(0<e-(b+c)){e-=b+c;for(var d=this.f.slice(b+c,b+e+c),p=0;p<e;p++)this.f[b+p]=d[p]}this.size-=c};b.prototype.Jp=function(b,c,e){if(this.Sa)throw a.g.xa();if(1>e||0!=c%e)throw a.g.xa();for(var d=c>>1,p=0;p<d;p+=e){c-=e;for(var f=0;f<e;f++){var A=this.f[b+p+f];this.f[b+p+f]=this.f[b+c+f];this.f[b+c+f]=A}}};b.prototype.dh=function(b,c,e){if(0>c||0>e||0>c||e+c>this.size)throw a.g.N();for(var d=
c;d<c+e;d++)this.f[d]=b};b.prototype.xi=function(b,c,e,d,f){if(!d||b!=e){for(var p=0;p<c;p++)this.f[b+p]=this.f[e+p];if(!d)for(e=b,b=b+c-f,d=0,c=a.I.truncate(c/2);d<c;d++){for(p=0;p<f;p++){var A=this.f[e+p];this.f[e+p]=this.f[b+p];this.f[b+p]=A}e+=f;b-=f}}};b.prototype.$p=function(b,c,e,d,f){if(0>b||0>c||0>d)throw a.g.N();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),f||(b+=c-1<<1),f=f?2:-2,c+=d;d<c;d++)this.f[b]=e[d].x,this.f[b+1]=e[d].y,b+=f};b.prototype.Hp=function(b,c,e,d,f){if(0>b||0>
c||0>d||this.size<c+b)throw a.g.N();if(f)for(f=0;f<c;f++)e[d+f]=this.f[b+f];else for(d=d+c-1;b<c;b++)e[d]=this.f[b],d--};b.prototype.clear=function(a){a?this.resize(0):this.cf(0)};b.prototype.xd=function(a,b,c){var e=this.f.slice(0,a),d=this.f.slice(b);a=this.f.slice(a,b).sort(c);this.f.length=0;this.f.push.apply(this.f,e.concat(a).concat(d))};b.prototype.Qh=function(){return 1};b.ob=0;return b}();a.qd=c;c=function(){function c(a){this.Sa=this.Xf=!1;this.f=null;var b=a;2>b&&(b=2);this.f=new Float64Array(b);
this.size=a}c.Yc=function(a,b){var e=new c(a),d=e.f;2>a&&(a=2);if(0!==b)for(var p=0;p<a;p++)d[p]=b;return e};c.lj=function(a){var b=new c(0);b.f=new Float64Array(a.f);b.size=a.size;return b};c.V=function(a,b){var e=new c(0);e.size=a.size;e.size>b&&(e.size=b);b=e.size;2>b&&(b=2);e.f=new Float64Array(b);e.f.set(a.f.length<=b?a.f:a.f.subarray(0,b),0);return e};c.prototype.xb=function(a){0>=a||(null==this.f?this.f=new Float64Array(a):a<=this.f.length||(0<this.f.length?(a=new Float64Array(a),a.set(this.f),
this.f=a):this.f=new Float64Array(a)))};c.prototype.read=function(a){return this.f[a]};c.prototype.ec=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};c.prototype.get=function(a){return this.f[a]};c.prototype.write=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};c.prototype.set=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};c.prototype.Rn=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c.x;this.f[b+1]=c.y};c.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};c.prototype.Ip=
function(a){return c.V(this,a)};c.prototype.Bh=function(a){return this.read(a)};c.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(30<this.f.length&&5*b/4<this.f.length){var e=new Float64Array(this.f,0,b);this.f=e}}else{b>this.f.length&&(e=a.I.truncate(64>b?Math.max(2*b,4):5*b/4),e=new Float64Array(e),e.set(this.f),this.f=e);for(var e=this.f,d=this.size;d<b;d++)e[d]=c}this.size=b};c.prototype.cf=
function(b){(null==this.f||b>this.f.length)&&this.resize(b);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Uk=function(a,b){this.write(a,b)};c.prototype.jj=function(b,c,e){for(var d=this.size;c<d&&c<e;c++)b=a.I.Rh(this.read(c));return b};c.prototype.lc=function(a,b,e){if(null==a||!(a instanceof c))return!1;var d=this.size,p=a.size;if(e>d||e>p&&d!=p)return!1;for(e>d&&(e=d);b<e;b++)if(this.read(b)!=a.read(b))return!1;return!0};c.prototype.nk=
function(c,e,d,f,g,k,h){if(this.Sa)throw a.g.xa();if(!g&&(1>k||0!=f%k))throw a.g.N();var p=this.size-h;p<f&&this.resize(this.size+f-p);b(this.f,c+f,c,c+(h-c));this.f==e.f&&c<d&&(d+=f);if(g)this.f.set(e.f.subarray(d,d+f),c);else for(g=f,h=0;h<f;h+=k)for(g-=k,p=0;p<k;p++)this.f[c+h+p]=e.f[d+g+p]};c.prototype.ul=function(c,e,d,f){if(this.Sa)throw a.g.xa();f-=c;b(this.f,c+f,c,c+f);for(f=0;f<d;f++)this.f[c+f]=e};c.prototype.lg=function(c,e,d){if(this.Sa)throw a.g.xa();b(this.f,c+2,c,c+(d-c));this.f[c]=
e.x;this.f[c+1]=e.y};c.prototype.km=function(b,c,e,d,f,g){if(0>b||0>c||0>d)throw a.g.N();if(!f&&(0>=g||0!=c%g))throw a.g.N();if(e.size<d+c)throw a.g.N();if(0!=c)if(this.size<c+b&&this.resize(c+b),e==this)this.xi(b,c,d,f,g);else if(f)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d++;else if(d=d+c-g,1==g)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d--;else for(f=0,c=a.I.truncate(c/g);f<c;f++){for(var p=0;p<g;p++)this.f[b+p]=e.f[d+p];b+=g;d-=g}};c.prototype.oj=function(c,e,d){if(this.Sa)throw a.g.xa();if(c+e>this.size)throw a.g.xa();
0<d-(c+e)&&b(this.f,c,c+e,c+(d-(c+e))+e);this.size-=e};c.prototype.Jp=function(b,c,e){if(this.Sa)throw a.g.xa();if(1>e||0!=c%e)throw a.g.xa();for(var d=c>>1,p=0;p<d;p+=e){c-=e;for(var f=0;f<e;f++){var A=this.f[b+p+f];this.f[b+p+f]=this.f[b+c+f];this.f[b+c+f]=A}}};c.prototype.dh=function(b,c,e){if(0>c||0>e||0>c||e+c>this.size)throw a.g.N();for(var d=c;d<c+e;d++)this.f[d]=b};c.prototype.xi=function(b,c,e,d,f){if(!d||b!=e)if(this.f.set(this.f.subarray(e,e+c),b),!d)for(e=b,b=b+c-f,d=0,c=a.I.truncate(c/
2);d<c;d++){for(var p=0;p<f;p++){var A=this.f[e+p];this.f[e+p]=this.f[b+p];this.f[b+p]=A}e+=f;b-=f}};c.prototype.$p=function(b,c,e,d,f){if(0>b||0>c||0>d)throw a.g.N();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),f||(b+=c-1<<1),f=f?2:-2,c+=d;d<c;d++)this.f[b]=e[d].x,this.f[b+1]=e[d].y,b+=f};c.prototype.Hp=function(b,c,e,d,f){if(0>b||0>c||0>d||this.size<c+b)throw a.g.N();if(f)for(f=0;f<c;f++)e[d+f]=this.f[b+f];else for(d=d+c-1;b<c;b++)e[d]=this.f[b],d--};c.prototype.clear=function(a){a?this.resize(0):
this.cf(0)};c.prototype.xd=function(a,b,c){Array.prototype.sort.call(this.f.subarray(a,b),c)};c.prototype.Qh=function(){return 1};return c}();a.QG=c})(z||(z={}));!0===z.ah.Sk&&!0===z.ah.it&&(z.qd=z.QG);(function(a){function b(a,b,c,e){c=new Int32Array(a.subarray(c,e));a.set(c,b)}a.tT=function(){return function(){this.random=1973}}();var c=function(){function b(c){this.Sa=this.Xf=!1;this.f=[];var e=c;2>e&&(e=2);this.f=this.f=a.I.Lh(e,b.ob);this.size=c}b.Yc=function(a,c){b.ob=c;a=new b(a);b.ob=0;return a};
b.lj=function(a){var c=new b(0);c.f=a.f.slice(0);c.size=a.size;return c};b.V=function(a,c){var e=new b(0);e.size=a.size;e.size>c&&(e.size=c);e.f=a.f.slice(0,e.size);return e};b.prototype.xb=function(){};b.prototype.read=function(a){return this.f[a]};b.prototype.ec=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};b.prototype.get=function(a){return this.f[a]};b.prototype.write=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};b.prototype.set=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};b.prototype.Rn=
function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};b.prototype.Ip=function(a){return b.V(this,a)};b.prototype.Bh=function(a){return this.read(a)};b.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(a.I.truncate(5*b/4)<this.f.length){var e=this.f.slice(0,b);this.f=e}}else if(b>this.f.length){a.I.truncate(64>
b?Math.max(2*b,4):5*b/4);for(var e=this.f.slice(0),d=this.f.length;d<b;d++)e[d]=c;this.f=e}this.size=b};b.prototype.cf=function(b){(null==this.f||b>this.f.length)&&this.resize(b);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};b.prototype.Uk=function(a,b){this.write(a,b)};b.prototype.jj=function(b,c,e){for(var d=this.size;c<d&&c<e;c++)b=a.I.kg(this.read(c),b);return b};b.prototype.lc=function(a,c,e){if(null==a||!(a instanceof b))return!1;var d=
this.size,p=a.size;if(e>d||e>p&&d!=p)return!1;for(e>d&&(e=d);c<e;c++)if(this.read(c)!=a.read(c))return!1;return!0};b.prototype.nk=function(b,c,e,d,f,g,k){if(this.Sa)throw a.g.xa();if(!f&&(1>g||0!=d%g))throw a.g.N();for(var p=0;p<k-b;p++)this.f[b+d+p]=this.f[b+p];this.f==c.f&&b<e&&(e+=d);if(f)for(p=0;p<d;p++)this.f[p+b]=c.f[e+p];else for(f=d,k=0;k<d;k+=g)for(f-=g,p=0;p<g;p++)this.f[b+k+p]=c.f[e+f+p]};b.prototype.ul=function(b,c,e,d){if(this.Sa)throw a.g.xa();d-=b;for(var p=this.f.slice(b,b+d),f=0;f<
d;f++)this.f[b+e+f]=p[f];for(d=0;d<e;d++)this.f[b+d]=c};b.prototype.lg=function(b,c,e){if(this.Sa)throw a.g.xa();for(var d=this.f.slice(b,b+(e-b)),p=0;p<e-b;p++)this.f[p+b+2]=d[p];this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.km=function(b,c,e,d,f,g){if(0>b||0>c||0>d)throw a.g.N();if(!f&&(0>=g||0!=c%g))throw a.g.N();if(e.size<d+c)throw a.g.N();if(0!=c)if(this.size<c+b&&this.resize(c+b),e==this)this.xi(b,c,d,f,g);else if(f)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d++;else if(d=d+c-g,1==g)for(f=0;f<c;f++)this.f[b]=
e.f[d],b++,d--;else for(f=0,c=a.I.truncate(c/g);f<c;f++){for(var p=0;p<g;p++)this.f[b+p]=e.f[d+p];b+=g;d-=g}};b.prototype.oj=function(b,c,e){if(this.Sa)throw a.g.xa();if(b+c>this.size)throw a.g.xa();if(0<e-(b+c)){e-=b+c;for(var d=this.f.slice(b+c,b+e+c),p=0;p<e;p++)this.f[b+p]=d[p]}this.size-=c};b.prototype.Jp=function(b,c,e){if(this.Sa)throw a.g.xa();if(1>e||0!=c%e)throw a.g.xa();for(var d=c>>1,p=0;p<d;p+=e){c-=e;for(var f=0;f<e;f++){var g=this.f[b+p+f];this.f[b+p+f]=this.f[b+c+f];this.f[b+c+f]=
g}}};b.prototype.dh=function(b,c,e){if(0>c||0>e||0>c||e+c>this.size)throw a.g.N();for(var d=c;d<c+e;d++)this.f[d]=b};b.prototype.xi=function(b,c,e,d,f){if(!d||b!=e){for(var p=0;p<c;p++)this.f[b+p]=this.f[e+p];if(!d)for(e=b,b=b+c-f,d=0,c=a.I.truncate(c/2);d<c;d++){for(p=0;p<f;p++){var g=this.f[e+p];this.f[e+p]=this.f[b+p];this.f[b+p]=g}e+=f;b-=f}}};b.prototype.$p=function(b,c,e,d,f){if(0>b||0>c||0>d)throw a.g.N();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),f||(b+=c-1<<1),f=f?2:-2,c+=d;d<
c;d++)this.f[b]=e[d].x,this.f[b+1]=e[d].y,b+=f};b.prototype.Hp=function(b,c,e,d,f){if(0>b||0>c||0>d||this.size<c+b)throw a.g.N();if(f)for(f=0;f<c;f++)e[d+f]=this.f[b+f];else for(d=d+c-1;b<c;b++)e[d]=this.f[b],d--};b.prototype.clear=function(a){a?this.resize(0):this.cf(0)};b.prototype.xd=function(a,b,c){var e=this.f.slice(0,a),d=this.f.slice(b);a=this.f.slice(a,b).sort(c);this.f.length=0;this.f.push.apply(this.f,e.concat(a).concat(d))};b.prototype.Qh=function(){return 2};b.prototype.tc=function(){return this.f[this.size-
1]};b.prototype.af=function(){this.resize(this.size-1)};b.prototype.JF=function(a){this.f[this.size-1]=a};b.prototype.QE=function(a){a<this.size-1&&(this.f[a]=this.f[this.size-1]);this.resize(this.size-1)};b.prototype.Qs=function(a){for(var b=0,c=this.size;b<c;b++)if(this.f[b]==a)return b;return-1};b.prototype.Nw=function(a){return 0<=this.Qs(a)};b.ob=0;return b}();a.ga=c;c=function(){function c(a){this.Sa=this.Xf=!1;this.f=null;var b=a;2>b&&(b=2);this.f=new Int32Array(b);this.size=a}c.Yc=function(a,
b){var e=new c(a),d=e.f;2>a&&(a=2);if(0!==b)for(var p=0;p<a;p++)d[p]=b;return e};c.lj=function(a){var b=new c(0);b.f=new Int32Array(a.f);b.size=a.size;return b};c.V=function(a,b){var e=new c(0);e.size=a.size;e.size>b&&(e.size=b);b=e.size;2>b&&(b=2);e.f=new Int32Array(b);e.f.set(a.f.length<=b?a.f:a.f.subarray(0,b),0);return e};c.prototype.xb=function(a){0>=a||(null==this.f?this.f=new Int32Array(a):a<=this.f.length||(0<this.f.length?(a=new Int32Array(a),a.set(this.f),this.f=a):this.f=new Int32Array(a)))};
c.prototype.read=function(a){return this.f[a]};c.prototype.ec=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};c.prototype.get=function(a){return this.f[a]};c.prototype.write=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};c.prototype.set=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};c.prototype.Rn=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c.x;this.f[b+1]=c.y};c.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};c.prototype.Ip=function(a){return c.V(this,a)};
c.prototype.Bh=function(a){return this.read(a)};c.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(30<this.f.length&&5*b/4<this.f.length){var e=new Int32Array(this.f,0,b);this.f=e}}else{b>this.f.length&&(e=a.I.truncate(64>b?Math.max(2*b,4):5*b/4),e=new Int32Array(e),e.set(this.f),this.f=e);for(var e=this.f,d=this.size;d<b;d++)e[d]=c}this.size=b};c.prototype.cf=function(b){(null==this.f||
b>this.f.length)&&this.resize(b);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Uk=function(a,b){this.write(a,b)};c.prototype.jj=function(b,c,e){for(var d=this.size;c<d&&c<e;c++)b=a.I.kg(this.read(c),b);return b};c.prototype.lc=function(a,b,e){if(null==a||!(a instanceof c))return!1;var d=this.size,p=a.size;if(e>d||e>p&&d!=p)return!1;for(e>d&&(e=d);b<e;b++)if(this.read(b)!=a.read(b))return!1;return!0};c.prototype.nk=function(c,e,
d,f,g,k,h){if(this.Sa)throw a.g.xa();if(!g&&(1>k||0!=f%k))throw a.g.N();b(this.f,c+f,c,c+(h-c));this.f==e.f&&c<d&&(d+=f);if(g)this.f.set(e.f.subarray(d,d+f),c);else for(g=f,h=0;h<f;h+=k){g-=k;for(var p=0;p<k;p++)this.f[c+h+p]=e.f[d+g+p]}};c.prototype.ul=function(c,e,d,f){if(this.Sa)throw a.g.xa();f-=c;b(this.f,c+f,c,c+f);for(f=0;f<d;f++)this.f[c+f]=e};c.prototype.lg=function(c,e,d){if(this.Sa)throw a.g.xa();b(this.f,c+2,c,c+(d-c));this.f[c]=e.x;this.f[c+1]=e.y};c.prototype.km=function(b,c,e,d,f,g){if(0>
b||0>c||0>d)throw a.g.N();if(!f&&(0>=g||0!=c%g))throw a.g.N();if(e.size<d+c)throw a.g.N();if(0!=c)if(this.size<c+b&&this.resize(c+b),e==this)this.xi(b,c,d,f,g);else if(f)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d++;else if(d=d+c-g,1==g)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d--;else for(f=0,c=a.I.truncate(c/g);f<c;f++){for(var p=0;p<g;p++)this.f[b+p]=e.f[d+p];b+=g;d-=g}};c.prototype.oj=function(c,e,d){if(this.Sa)throw a.g.xa();if(c+e>this.size)throw a.g.xa();0<d-(c+e)&&b(this.f,c,c+e,c+(d-(c+e))+e);this.size-=
e};c.prototype.Jp=function(b,c,e){if(this.Sa)throw a.g.xa();if(1>e||0!=c%e)throw a.g.xa();for(var d=c>>1,p=0;p<d;p+=e){c-=e;for(var f=0;f<e;f++){var g=this.f[b+p+f];this.f[b+p+f]=this.f[b+c+f];this.f[b+c+f]=g}}};c.prototype.dh=function(b,c,e){if(0>c||0>e||0>c||e+c>this.size)throw a.g.N();for(var d=c;d<c+e;d++)this.f[d]=b};c.prototype.xi=function(b,c,e,d,f){if(!d||b!=e)if(this.f.set(this.f.subarray(e,e+c),b),!d)for(e=b,b=b+c-f,d=0,c=a.I.truncate(c/2);d<c;d++){for(var p=0;p<f;p++){var g=this.f[e+p];
this.f[e+p]=this.f[b+p];this.f[b+p]=g}e+=f;b-=f}};c.prototype.$p=function(b,c,e,d,f){if(0>b||0>c||0>d)throw a.g.N();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),f||(b+=c-1<<1),f=f?2:-2,c+=d;d<c;d++)this.f[b]=e[d].x,this.f[b+1]=e[d].y,b+=f};c.prototype.Hp=function(b,c,e,d,f){if(0>b||0>c||0>d||this.size<c+b)throw a.g.N();if(f)for(f=0;f<c;f++)e[d+f]=this.f[b+f];else for(d=d+c-1;b<c;b++)e[d]=this.f[b],d--};c.prototype.clear=function(a){a?this.resize(0):this.cf(0)};c.prototype.xd=function(a,b,
e){10>b-a?c.$i(this.f,a,b,e):c.$g(this.f,a,b-1,e)};c.prototype.Qh=function(){return 2};c.prototype.tc=function(){return this.f[this.size-1]};c.prototype.af=function(){this.resize(this.size-1)};c.prototype.JF=function(a){this.f[this.size-1]=a};c.prototype.QE=function(a){a<this.size-1&&(this.f[a]=this.f[this.size-1]);this.resize(this.size-1)};c.prototype.Qs=function(a){for(var b=0,c=this.size;b<c;b++)if(this.f[b]==a)return b;return-1};c.prototype.Nw=function(a){return 0<=this.Qs(a)};c.$i=function(a,
b,c,e){for(var d=b;d<c;d++){for(var p=a[d],f=d-1;f>=b&&0<e(a[f],p);)a[f+1]=a[f],f--;a[f+1]=p}};c.Wf=function(a,b,c){var e=a[c];a[c]=a[b];a[b]=e};c.$g=function(a,b,e,d){if(!(b>=e))for(;;){if(9>e-b){c.$i(a,b,e+1,d);break}var p=a[b];c.Wf(a,b,e);for(var f=b,g=b;g<e;g++)0>=d(a[g],p)&&(c.Wf(a,f,g),f+=1);c.Wf(a,f,e);f-b<e-f?(c.$g(a,b,f-1,d),b=f+1):(c.$g(a,f+1,e,d),e=f-1)}};return c}();a.Xu=c})(z||(z={}));!0===z.ah.Sk&&(z.ga=z.Xu);(function(a){function b(a,b,c,e){c=new Int8Array(a.subarray(c,e));a.set(c,
b)}var c=function(){function b(c){this.Sa=this.Xf=!1;this.f=[];var e=c;2>e&&(e=2);this.f=a.I.Lh(e,b.ob);this.size=c}b.Yc=function(a,c){b.ob=c;a=new b(a);b.ob=0;return a};b.lj=function(a){var c=new b(0);c.f=a.f.slice(0);c.size=a.size;return c};b.V=function(a,c){var e=new b(0);e.size=a.size;e.size>c&&(e.size=c);e.f=a.f.slice(0,e.size);return e};b.prototype.xb=function(){};b.prototype.read=function(a){return this.f[a]};b.prototype.ec=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};b.prototype.get=function(a){return this.f[a]};
b.prototype.write=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};b.prototype.set=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};b.prototype.Rn=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};b.prototype.Ip=function(a){return b.V(this,a)};b.prototype.Bh=function(a){return this.read(a)};b.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");
if(b<=this.size){if(a.I.truncate(5*b/4)<this.f.length){var e=this.f.slice(0,b);this.f=e}}else if(b>this.f.length){a.I.truncate(64>b?Math.max(2*b,4):5*b/4);for(var e=this.f.slice(0),d=this.f.length;d<b;d++)e[d]=c;this.f=e}this.size=b};b.prototype.cf=function(b){(null==this.f||b>this.f.length)&&this.resize(b);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};b.prototype.Uk=function(a,b){this.write(a,b)};b.prototype.jj=function(b,c,e){for(var d=this.size;c<
d&&c<e;c++)b=a.I.kg(this.read(c),b);return b};b.prototype.lc=function(a,c,e){if(null==a||!(a instanceof b))return!1;var d=this.size,p=a.size;if(e>d||e>p&&d!=p)return!1;for(e>d&&(e=d);c<e;c++)if(this.read(c)!=a.read(c))return!1;return!0};b.prototype.nk=function(b,c,e,d,f,g,k){if(this.Sa)throw a.g.xa();if(!f&&(1>g||0!=d%g))throw a.g.N();for(var p=0;p<k-b;p++)this.f[b+d+p]=this.f[b+p];this.f==c.f&&b<e&&(e+=d);if(f)for(p=0;p<d;p++)this.f[p+b]=c.f[e+p];else for(f=d,k=0;k<d;k+=g)for(f-=g,p=0;p<g;p++)this.f[b+
k+p]=c.f[e+f+p]};b.prototype.ul=function(b,c,e,d){if(this.Sa)throw a.g.xa();d-=b;for(var p=this.f.slice(b,b+d),f=0;f<d;f++)this.f[b+e+f]=p[f];for(d=0;d<e;d++)this.f[b+d]=c};b.prototype.lg=function(b,c,e){if(this.Sa)throw a.g.xa();for(var d=this.f.slice(b,b+(e-b)),p=0;p<e-b;p++)this.f[p+b+2]=d[p];this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.km=function(b,c,e,d,f,g){if(0>b||0>c||0>d)throw a.g.N();if(!f&&(0>=g||0!=c%g))throw a.g.N();if(e.size<d+c)throw a.g.N();if(0!=c)if(this.size<c+b&&this.resize(c+b),
e==this)this.xi(b,c,d,f,g);else if(f)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d++;else if(d=d+c-g,1==g)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d--;else for(f=0,c=a.I.truncate(c/g);f<c;f++){for(var p=0;p<g;p++)this.f[b+p]=e.f[d+p];b+=g;d-=g}};b.prototype.oj=function(b,c,e){if(this.Sa)throw a.g.xa();if(b+c>this.size)throw a.g.xa();if(0<e-(b+c)){e-=b+c;for(var d=this.f.slice(b+c,b+e+c),p=0;p<e;p++)this.f[b+p]=d[p]}this.size-=c};b.prototype.Jp=function(b,c,e){if(this.Sa)throw a.g.xa();if(1>e||0!=c%e)throw a.g.xa();
for(var d=c>>1,p=0;p<d;p+=e){c-=e;for(var f=0;f<e;f++){var g=this.f[b+p+f];this.f[b+p+f]=this.f[b+c+f];this.f[b+c+f]=g}}};b.prototype.dh=function(b,c,e){if(0>c||0>e||0>c||e+c>this.size)throw a.g.N();for(var d=c;d<c+e;d++)this.f[d]=b};b.prototype.xi=function(b,c,e,d,f){if(!d||b!=e){for(var p=0;p<c;p++)this.f[b+p]=this.f[e+p];if(!d)for(e=b,b=b+c-f,d=0,c=a.I.truncate(c/2);d<c;d++){for(p=0;p<f;p++){var g=this.f[e+p];this.f[e+p]=this.f[b+p];this.f[b+p]=g}e+=f;b-=f}}};b.prototype.$p=function(b,c,e,d,f){if(0>
b||0>c||0>d)throw a.g.N();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),f||(b+=c-1<<1),f=f?2:-2,c+=d;d<c;d++)this.f[b]=e[d].x,this.f[b+1]=e[d].y,b+=f};b.prototype.Hp=function(b,c,e,d,f){if(0>b||0>c||0>d||this.size<c+b)throw a.g.N();if(f)for(f=0;f<c;f++)e[d+f]=this.f[b+f];else for(d=d+c-1;b<c;b++)e[d]=this.f[b],d--};b.prototype.clear=function(a){a?this.resize(0):this.cf(0)};b.prototype.xd=function(a,b,c){var e=this.f.slice(0,a),d=this.f.slice(b);a=this.f.slice(a,b).sort(c);this.f.length=0;
this.f.push.apply(this.f,e.concat(a).concat(d))};b.prototype.Qh=function(){return 1};b.prototype.xy=function(b,c){if(this.Sa)throw a.g.ra("invalid call. Attribute Stream is read only.");this.f[b]|=c};b.prototype.BB=function(b,c){if(this.Sa)throw a.g.ra("invalid call. Attribute Stream is read only.");this.f[b]&=~c};b.ob=0;return b}();a.Wk=c;c=function(){function c(a){this.f=null;var b=a;2>b&&(b=2);this.f=new Int8Array(b);this.size=a}c.Yc=function(a,b){var e=new c(a),d=e.f;2>a&&(a=2);if(0!==b)for(var p=
0;p<a;p++)d[p]=b;return e};c.lj=function(a){var b=new c(0);b.f=new Int8Array(a.f);b.size=a.size;return b};c.V=function(a,b){var e=new c(0);e.size=a.size;e.size>b&&(e.size=b);b=e.size;2>b&&(b=2);e.f=new Int8Array(b);e.f.set(a.f.length<=b?a.f:a.f.subarray(0,b),0);return e};c.prototype.xb=function(a){0>=a||(null==this.f?this.f=new Int8Array(a):a<=this.f.length||(0<this.f.length?(a=new Int8Array(a),a.set(this.f),this.f=a):this.f=new Int8Array(a)))};c.prototype.read=function(a){return this.f[a]};c.prototype.ec=
function(a,b){b.x=this.f[a];b.y=this.f[a+1]};c.prototype.get=function(a){return this.f[a]};c.prototype.write=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};c.prototype.set=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c};c.prototype.Rn=function(b,c){if(this.Sa)throw a.g.xa();this.f[b]=c.x;this.f[b+1]=c.y};c.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};c.prototype.Ip=function(a){return c.V(this,a)};c.prototype.Bh=function(a){return this.read(a)};c.prototype.resize=
function(b,c){void 0===c&&(c=0);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(30<this.f.length&&5*b/4<this.f.length){var e=new Int8Array(this.f,0,b);this.f=e}}else{b>this.f.length&&(e=a.I.truncate(64>b?Math.max(2*b,4):5*b/4),e=new Int8Array(e),e.set(this.f),this.f=e);for(var e=this.f,d=this.size;d<b;d++)e[d]=c}this.size=b};c.prototype.cf=function(b){(null==this.f||b>this.f.length)&&this.resize(b);if(this.Xf)throw a.g.ra("invalid call. Attribute Stream is locked and cannot be resized.");
this.size=b};c.prototype.Uk=function(a,b){this.write(a,b)};c.prototype.jj=function(b,c,e){for(var d=this.size;c<d&&c<e;c++)b=a.I.kg(this.read(c),b);return b};c.prototype.lc=function(a,b,e){if(null==a||!(a instanceof c))return!1;var d=this.size,p=a.size;if(e>d||e>p&&d!=p)return!1;for(e>d&&(e=d);b<e;b++)if(this.read(b)!=a.read(b))return!1;return!0};c.prototype.nk=function(c,e,d,f,g,k,h){if(this.Sa)throw a.g.xa();if(!g&&(1>k||0!=f%k))throw a.g.N();b(this.f,c+f,c,c+(h-c));this.f==e.f&&c<d&&(d+=f);if(g)this.f.set(e.f.subarray(d,
d+f),c);else for(g=f,h=0;h<f;h+=k){g-=k;for(var p=0;p<k;p++)this.f[c+h+p]=e.f[d+g+p]}};c.prototype.ul=function(c,e,d,f){if(this.Sa)throw a.g.xa();f-=c;b(this.f,c+f,c,c+f);for(f=0;f<d;f++)this.f[c+f]=e};c.prototype.lg=function(c,e,d){if(this.Sa)throw a.g.xa();b(this.f,c+2,c,c+(d-c));this.f[c]=e.x;this.f[c+1]=e.y};c.prototype.km=function(b,c,e,d,f,g){if(0>b||0>c||0>d)throw a.g.N();if(!f&&(0>=g||0!=c%g))throw a.g.N();if(e.size<d+c)throw a.g.N();if(0!=c)if(this.size<c+b&&this.resize(c+b),e==this)this.xi(b,
c,d,f,g);else if(f)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d++;else if(d=d+c-g,1==g)for(f=0;f<c;f++)this.f[b]=e.f[d],b++,d--;else for(f=0,c=a.I.truncate(c/g);f<c;f++){for(var p=0;p<g;p++)this.f[b+p]=e.f[d+p];b+=g;d-=g}};c.prototype.oj=function(c,e,d){if(this.Sa)throw a.g.xa();if(c+e>this.size)throw a.g.xa();0<d-(c+e)&&b(this.f,c,c+e,c+(d-(c+e))+e);this.size-=e};c.prototype.Jp=function(b,c,e){if(this.Sa)throw a.g.xa();if(1>e||0!=c%e)throw a.g.xa();for(var d=c>>1,p=0;p<d;p+=e){c-=e;for(var f=0;f<e;f++){var g=
this.f[b+p+f];this.f[b+p+f]=this.f[b+c+f];this.f[b+c+f]=g}}};c.prototype.dh=function(b,c,e){if(0>c||0>e||0>c||e+c>this.size)throw a.g.N();for(var d=c;d<c+e;d++)this.f[d]=b};c.prototype.xi=function(b,c,e,d,f){if(!d||b!=e)if(this.f.set(this.f.subarray(e,e+c),b),!d)for(e=b,b=b+c-f,d=0,c=a.I.truncate(c/2);d<c;d++){for(var p=0;p<f;p++){var g=this.f[e+p];this.f[e+p]=this.f[b+p];this.f[b+p]=g}e+=f;b-=f}};c.prototype.$p=function(b,c,e,d,f){if(0>b||0>c||0>d)throw a.g.N();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<
1)+b),f||(b+=c-1<<1),f=f?2:-2,c+=d;d<c;d++)this.f[b]=e[d].x,this.f[b+1]=e[d].y,b+=f};c.prototype.Hp=function(b,c,e,d,f){if(0>b||0>c||0>d||this.size<c+b)throw a.g.N();if(f)for(f=0;f<c;f++)e[d+f]=this.f[b+f];else for(d=d+c-1;b<c;b++)e[d]=this.f[b],d--};c.prototype.clear=function(a){a?this.resize(0):this.cf(0)};c.prototype.xd=function(a,b,c){b=this.f.subarray(a,b);Array.prototype.sort.call(b,c);this.f.set(b,a)};c.prototype.xy=function(b,c){if(this.Sa)throw a.g.ra("invalid call. Attribute Stream is read only.");
this.f[b]|=c};c.prototype.BB=function(b,c){if(this.Sa)throw a.g.ra("invalid call. Attribute Stream is read only.");this.f[b]&=~c};c.prototype.Qh=function(){return 1};return c}();a.Yu=c})(z||(z={}));!0===z.ah.Sk&&(z.Wk=z.Yu);(function(a){var b=function(){function b(){}b.to=function(b,c){return a.Wk.Yc(b,c)};b.kl=function(b,c){return a.qd.Yc(b,c)};b.Sv=function(b,c,e){switch(b){case 1:b=a.qd.Yc(c,e);break;case 2:b=a.ga.Yc(c,e);break;case 4:b=a.Wk.Yc(c,e);break;default:throw a.g.wa();}return b};b.Tv=
function(c,e){return b.Sv(a.pa.Qh(c),e*a.pa.Wa(c),a.pa.ue(c))};b.Dg=function(b,c){return a.ga.Yc(b,c)};b.ay=function(a){var b,c=[];for(b=0;b<a;b++)c.push(null);return c};return b}();a.Ac=b})(z||(z={}));(function(a){var b=function(){function b(){}b.to=function(b,c){return a.Yu.Yc(b,c)};b.kl=function(b,c){return a.qd.Yc(b,c)};b.Sv=function(b,c,e){switch(b){case 1:b=a.qd.Yc(c,e);break;case 2:b=a.Xu.Yc(c,e);break;case 4:b=a.Yu.Yc(c,e);break;default:throw a.g.wa();}return b};b.Tv=function(b,c){return a.Ac.Sv(a.pa.Qh(b),
c*a.pa.Wa(b),a.pa.ue(b))};b.Dg=function(b,c){return a.Xu.Yc(b,c)};b.ay=function(a){var b,c=[];for(b=0;b<a;b++)c.push(null);return c};return b}();a.RG=b})(z||(z={}));!0===z.ah.Sk&&(z.Ac=z.RG);(function(a){a.ca=function(){return function(a){void 0===a&&(a=0);this.l=a}}()})(z||(z={}));(function(a){var b=function(){function a(){}a.nb=function(b,c){return 0<=c?a.H(b):-a.H(b)};a.H=function(a){return 0>a?-a:a};a.Ih=function(a){return 3.552713678800501E-15>a};a.Xz=function(b,c,e){return a.H(b-c)<=e*(1+(a.H(b)+
a.H(c))/2)};a.S=function(b,c){return a.Xz(b,c,3.552713678800501E-15)};a.wI=function(b){return 3.552713678800501E-15>=a.H(b)};a.Vc=function(b){return a.wI(b)};return a}();a.j=b;var c=function(){function c(){}c.Sn=function(a,c){a=b.H(a);c=b.H(c);var e=0;0!=a+c&&(a>c?(e=c/a,e=a*Math.sqrt(1+e*e)):(e=a/c,e=c*Math.sqrt(1+e*e)));return e};c.Ep=function(a,e,d,f,g){for(var p=[0,0,0],A=[0,0,0],k=0;2>=k;k++)e[k]-=a[k],d[k]-=e[k];d=p[1]*A[2]-p[2]*A[1];e=p[2]*A[0]-p[0]*A[2];p=p[0]*A[1]-p[1]*A[0];a=-1*(d*a[0]+
e*a[1]+p*a[2]);f[0]=d;f[1]=e;f[2]=p;f[3]=a;A=c.jm(f);f[0]/=A;f[1]/=A;f[2]/=A;f[3]/=A;0!=g&&(A=b.Vc(p)?b.Vc(a)?b.nb(1,e):-b.nb(1,a):b.nb(1,p),A*=b.nb(1,g),f[0]*=A,f[1]*=A,f[2]*=A,f[3]*=A)};c.Uu=function(a,b,c){c[0]=a[1]*b[2]-b[1]*a[2];c[1]=a[2]*b[0]-b[2]*a[0];c[2]=a[0]*b[1]-b[0]*a[1]};c.Qr=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};c.jm=function(a){return c.Sn(c.Sn(a[0],a[1]),a[2])};c.wm=function(a,b,e,d,f,g){var p=c.n(1,a,b),A=Math.cos(b);d.l=(p+0)*A*Math.cos(e);f.l=(p+0)*A*Math.sin(e);g.l=
(p*(1-a)+0)*Math.sin(b)};c.JK=function(a,e,d,f,g,k,h){var p=c.Sn(e,d),A=1*Math.sqrt(1-a),n=A/1;if(b.S(p,0))k.l=0,g.l=b.nb(1.570796326794897,f),h.l=b.H(f)-A;else{k.l=Math.atan2(d,e);d=Math.atan2(1*f,A*p);k=Math.cos(d);var K=Math.sin(d);e=A*a/(1-a);a*=1;d=Math.atan2(f+e*K*K*K,p-a*k*k*k);3.141592653589793<b.H(d)&&(d=b.nb(3.141592653589793,d)-d);d=Math.atan(n*Math.tan(d));K=Math.sin(d);k=Math.cos(d);g.l=Math.atan2(f+e*K*K*K,p-a*k*k*k);1.570796326794897<b.H(g.l)&&(g.l=b.nb(3.141592653589793,g.l)-g.l);
d=Math.atan(n*Math.tan(g.l));K=Math.sin(d);k=Math.cos(d);h.l=(f-A*K)*Math.sin(g.l)+(p-1*k)*Math.cos(g.l)}};c.n=function(a,b,c){c=Math.sin(c);return a/Math.sqrt(1-b*c*c)};c.sr=function(a,b){return Math.atan2(Math.sin(b)*(1-a),Math.cos(b))};c.Si=function(a,b){return Math.atan2(Math.sin(b),Math.cos(b)*(1-a))};c.xn=function(a,e){if(b.Ih(a)||0==e||b.S(b.H(e),1.570796326794897))return e;var d,f,p,g,A,k,h,n,E;if(.006884661117170036>a){g=Math.sqrt(1-a);A=(1-g)/(1+g);k=A*A;h=A*k;n=A*h;d=A*n;E=A*d;f=A*E;p=
1.572916666666667*h-3.2578125*d+4.295068359375*f;g=2.142578125*n-6.071484375*E;a=3.129296875*d-11.249837239583334*f;var q=4.775276692708333*E,l=7.958636765252976*f,r=Math.cos(2*e);return e+Math.sin(2*e)*(1.5*A-.84375*h+.525390625*d-.2688395182291667*f-p+a-l+r*(2*(1.3125*k-1.71875*n+1.650146484375*E)-4*g+6*q+r*(4*p-12*a+24*l+r*(8*g-32*q+r*(16*a-80*l+r*(32*q+64*r*l))))))}g=1-a;A=a/2;k=b.H(e);h=k*c.Yr(a)/(1.570796326794897*g);n=9999;E=k;for(k=0;1E-16<n&&50>k;k++)f=c.Tk(a,E),d=(c.Lz(E,a)-A*Math.sin(2*
E)/f)/g-h,f=1/(f*f*f),p=d/f,d=E-p,n=b.H(p),E=d;return 0<=e?E:-E};c.nR=function(a,e){return b.Ih(e)?a:a*c.Yr(e)/1.570796326794897};c.W=function(a){a=c.Hz(a,6.283185307179586);return 0>a?a+6.283185307179586:3.141592653589793>b.H(a)||b.S(b.H(a),3.141592653589793)?a:a-6.283185307179586};c.Hz=function(a,b){return a-Math.floor(a/b)*b};c.gg=function(a,b){if(.006884661117170036>b){b=Math.sqrt(1-b);b=(1-b)/(1+b);var e=b*b,d=e*e;return a/(1+b)*(1+.25*e+.015625*d+.00390625*e*d)*1.570796326794897}return a*c.Yr(b)};
c.Dp=function(a,e){var d=b.nb(1,Math.sin(e));e=b.H(c.Hz(e,3.141592653589793));e=1.570796326794897>=e?e:3.141592653589793-e;var f;b.S(e,1.570796326794897)?f=e:f=Math.atan(Math.sqrt(1-a)*Math.tan(e));return f*d};c.q=function(a,b,e){if(.006884661117170036>b){b=Math.sqrt(1-b);b=(1-b)/(1+b);var d=b*b,f=b*d,p=b*f,g=b*p,A=b*g,k=b*A,h=-.7291666666666666*f+.2278645833333333*g+.03987630208333334*k,n=.615234375*p-.21533203125*A,K=-.54140625*g+.20302734375*k,E=.48876953125*A,q=-.4488699776785715*k,l=Math.cos(2*
e);return a/(1+b)*((1+.25*d+.015625*p+.00390625*A)*e+Math.sin(2*e)*(-1.5*b+.1875*f+.0234375*g+.00732421875*k-h+K-q+l*(2*(.9375*d-.234375*p-.03662109375*A)-4*n+6*E+l*(4*h-12*K+24*q+l*(8*n-32*E+l*(16*K-80*q+l*(32*E+64*l*q)))))))}return a*(c.Lz(e,b)-.5*b*Math.sin(2*e)/c.Tk(b,e))};c.Tk=function(a,b){b=Math.sin(b);return Math.sqrt(1-a*b*b)};c.Yr=function(a){return b.Xz(a,1,2.220446049250313E-16)?1:1>a?c.js(0,1-a)-a/3*c.hs(0,1-a):NaN};c.Lz=function(e,d){var f=b.nb(1,e);e=b.H(e);var p=Math.floor(e/1.570796326794897),
g;if(1<d)g=0==e?0:NaN;else if(b.Vc(p))g=c.sin(e),g=g*c.js(1-g*g,1-d*g*g)-d/3*g*g*g*c.hs(1-g*g,1-d*g*g);else{g=a.I.truncate(p%2);var A=c.Yr(d);0<g?(g=Math.sin(1.570796326794897*(p+1)-e),g=g*c.js(1-g*g,1-d*g*g)-d/3*g*g*g*c.hs(1-g*g,1-d*g*g),g=A*(p+1)-g):(g=Math.sin(e-1.570796326794897*p),g=g*c.js(1-g*g,1-d*g*g)-d/3*g*g*g*c.hs(1-g*g,1-d*g*g),g=A*p+g)}return g*f};c.sin=function(a){a=c.W(a);var e=b.nb(1,a);a=b.H(a);return b.S(a,3.141592653589793)?0:b.S(a,1.570796326794897)?1*e:Math.sin(a)*e};c.hs=function(a,
c){for(var e=1,d=0,f=1,p,g,A,k;;){p=.2*(a+c+3*e);g=(p-a)/p;A=(p-c)/p;k=(p-e)/p;if(1E-4>b.H(g)&&1E-4>b.H(A)&&1E-4>b.H(k))break;k=Math.sqrt(c);p=Math.sqrt(e);k=Math.sqrt(a)*(k+p)+k*p;d+=f/(p*(e+k));f*=.25;a=.25*(a+k);c=.25*(c+k);e=.25*(e+k)}a=g*A;e=k*k;c=a-e;e=a-6*e;g=e+c+c;return 3*d+f*(1+e*(-.2142857142857143+.10227272727272728*e-.1730769230769231*k*g)+k*(.1666666666666667*g+k*(-.4090909090909091*c+.1153846153846154*k*a)))/(p*Math.sqrt(p))};c.js=function(a,c){for(var e,d,f,p,g=1;;g=.25*(g+e)){e=(a+
c+g)/3;d=2-(e+a)/e;f=2-(e+c)/e;p=2-(e+g)/e;if(1E-4>b.H(d)&&1E-4>b.H(f)&&1E-4>b.H(p))break;e=Math.sqrt(c);d=Math.sqrt(g);e=Math.sqrt(a)*(e+d)+e*d;a=.25*(a+e);c=.25*(c+e)}a=d*f-p*p;c=d*f*p;return(1+(.04166666666666666*a-.1-.06818181818181818*c)*a+.07142857142857142*c)/Math.sqrt(e)};c.qu=function(a,c){if(b.Ih(a)||0==c||b.S(b.H(c),1.570796326794897))return c;var e,d,f;if(.006884661117170036>a){e=a*a;d=a*e;f=a*d;var p=a*f,g=a*p,A=a*g,k=-(.02708333333333333*d+.03430059523809524*f+.03149181547619048*p+.02634359154541446*
g+.02156896735835538*A),h=.007669890873015873*f+.01299603174603175*p+.0148051353064374*g+.01454454953803912*A,n=-(.002275545634920635*p+.004830845032667949*g+.006558395368616723*A),E=6.957236677288761E-4*g+.001775193002406544*A,q=-(2.17324089394402E-4*A),l=Math.cos(2*c);return c+Math.sin(2*c)*(-(.5*a+.2083333333333333*e+.09375*d+.04878472222222222*f+.02916666666666667*p+.01938905423280423*g+.01388255931712963*A)-k+n-q+l*(2*(.1041666666666667*e+.0875*d+.06050347222222222*f+.04151785714285714*p+.02958958540013228*
g+.02203667534722222*A)-4*h+6*E+l*(4*k-12*n+24*q+l*(8*h-32*E+l*(16*n-80*q+l*(32*E+64*l*q))))))}0==c||b.S(b.H(c),1.570796326794897)?e=c:(d=Math.sqrt(a),f=d*Math.sin(c),e=Math.tan(.7853981633974483+c/2)*Math.pow((1-f)/(1+f),d/2),e=2*Math.atan(e)-1.570796326794897);return e};c.$K=function(a,c){if(b.Ih(a)||0==c||b.S(b.H(c),1.570796326794897))return c;var e,d;if(.006884661117170036>a){l=a*a;n=a*l;E=a*n;e=a*E;q=a*e;d=a*q;var f=.05833333333333333*n+.07232142857142858*E+.05634300595238095*e+.0355325796406526*
q+.020235546186067*d,p=.02653149801587302*E+.04379960317460317*e+.0429211791776896*q+.03255384637546096*d,g=.01294022817460318*e+.02668104344536636*q+.03155651254609588*d,A=.00659454790965208*q+.0163075268674227*d,k=.003463473736911237*d,h=Math.cos(2*c);return c+Math.sin(2*c)*(.5*a+.2083333333333333*l+.08333333333333333*n+.03611111111111111*E+.01875*e+.01195601851851852*q+.008863673941798942*d-f+g-k+h*(2*(.1458333333333333*l+.1208333333333333*n+.07039930555555556*E+.03616071428571429*e+.01839451058201058*
q+.01017113095238095*d)-4*p+6*A+h*(4*f-12*g+24*k+h*(8*p-32*A+h*(16*g-80*k+h*(32*A+64*h*k))))))}for(var n=Math.sqrt(a),E=n/2,q=Math.tan(.7853981633974483+c/2),f=0,p=1,l=c;0!=p;l=d)if(e=n*Math.sin(l),d=q*Math.pow((1+e)/(1-e),E),d=2*Math.atan(d)-1.570796326794897,f++,b.S(d,l)||3E4<f)p=0;return l};return c}();a.u=c})(z||(z={}));(function(a){var b=function(){function b(){}b.Fb=function(b,c,e,d,f,g,k,h){if(null!=g||null!=k||null!=h){d=a.u.W(d);c=a.u.W(c);e=a.u.W(e);f=a.u.W(f);1.570796326794897<a.j.H(e)&&
(e=a.j.nb(3.141592653589793,e)-e,c=a.u.W(c+3.141592653589793));1.570796326794897<a.j.H(f)&&(f=a.j.nb(3.141592653589793,f)-f,d=a.u.W(d+3.141592653589793));var p=a.u.W(d-c);if(a.j.S(e,f)&&(a.j.S(c,d)||a.j.S(a.j.H(e),1.570796326794897)))null!=g&&(g.l=0),null!=k&&(k.l=0),null!=h&&(h.l=0);else{if(a.j.S(e,-f)){if(a.j.S(a.j.H(e),1.570796326794897)){null!=g&&(g.l=3.141592653589793*b);null!=k&&(k.l=0<e?a.u.W(3.141592653589793-a.u.W(d)):a.u.W(d));null!=h&&(h.l=0<e?a.u.W(d):a.u.W(3.141592653589793-a.u.W(d)));
return}if(a.j.S(a.j.H(p),3.141592653589793)){null!=g&&(g.l=3.141592653589793*b);null!=k&&(k.l=0);null!=h&&(h.l=0);return}}var A=1.570796326794897==a.j.H(e)?0:Math.cos(e),n=Math.sin(e),E=1.570796326794897==a.j.H(f)?0:Math.cos(f),K=Math.sin(f),q=1.570796326794897==a.j.H(p)?0:Math.cos(p),l=3.141592653589793==a.j.H(p)?0:Math.sin(p);if(null!=g){var U=Math.sin((f-e)/2),p=Math.sin(p/2);g.l=2*Math.asin(Math.sqrt(U*U+A*E*p*p))*b}null!=k&&(a.j.S(a.j.H(e),1.570796326794897)?k.l=0>e?d:a.u.W(3.141592653589793-
d):k.l=Math.atan2(E*l,A*K-n*E*q));null!=h&&(a.j.S(a.j.H(f),1.570796326794897)?h.l=0>f?c:a.u.W(3.141592653589793-c):(h.l=Math.atan2(A*l,K*A*q-E*n),h.l=a.u.W(h.l+3.141592653589793)))}}};b.gf=function(b,c,e,d,f,g,k){if(null!=g||null!=k){c=a.u.W(c);e=a.u.W(e);1.570796326794897<a.j.H(e)&&(e=a.j.nb(3.141592653589793,e)-e,c=a.u.W(c+3.141592653589793));a.j.S(a.j.H(e),1.570796326794897)&&(c=0);f=a.u.W(f);var p=a.j.S(a.j.H(f),1.570796326794897)?0:Math.cos(f),A=a.j.S(a.j.H(f),3.141592653589793)?0:Math.sin(f),
h=a.j.S(a.j.H(e),1.570796326794897)?0:Math.cos(e),n=Math.sin(e);b=d/b;d=a.j.S(a.j.H(b),1.570796326794897)?0:Math.cos(b);var E=a.j.S(a.j.H(b),3.141592653589793)?0:Math.sin(b),K=Math.asin(n*d+h*E*p);null!=k&&(k.l=K);null!=g&&(g.l=a.j.S(a.j.H(K),1.570796326794897)?a.j.S(e,-K)?0>K?f:a.u.W(3.141592653589793-f):c:a.j.S(a.j.H(e),1.570796326794897)&&a.j.S(b,3.141592653589793)?0>e?f:a.u.W(3.141592653589793-f):a.u.W(c+Math.atan2(E*A,h*d-n*E*p)))}};return b}();a.zg=b})(z||(z={}));(function(a){var b=function(){function b(){}
b.Fb=function(b,c,e,d,f,g,k,h,n){var p=new a.ca(0),A=new a.ca(0),E=[0,0,0],K=[0,0,0],q=[0,0,0],l=new a.ca(0),r=new a.ca(0),U=new a.ca(0),t=new a.ca(0),H=new a.ca(0);if(null!=k||null!=h||null!=n)if(a.j.Ih(c))a.zg.Fb(b,e,d,f,g,k,h,n);else{f=a.u.W(f);e=a.u.W(e);var V=a.u.W(f-e);if(a.j.S(d,g)&&(a.j.S(e,f)||a.j.S(a.j.H(d),1.570796326794897)))null!=k&&(k.l=0),null!=h&&(h.l=0),null!=n&&(n.l=0);else{if(a.j.S(d,-g)){if(a.j.S(a.j.H(d),1.570796326794897)){null!=k&&(k.l=2*a.u.gg(b,c));null!=h&&(h.l=0<d?a.u.W(3.141592653589793-
a.u.W(f)):a.u.W(f));null!=n&&(n.l=0<d?a.u.W(f):a.u.W(3.141592653589793-a.u.W(f)));return}a.j.S(a.j.H(V),3.141592653589793)&&(null!=k&&(k.l=2*a.u.gg(b,c)),null!=h&&(h.l=0),null!=n&&(n.l=0))}else if(a.j.S(a.j.H(d),1.570796326794897)||a.j.S(a.j.H(g),1.570796326794897))a.j.S(a.j.H(d),1.570796326794897)?e=f:f=e;var u=0,w;0>V&&(u=1,w=e,e=f,f=w,w=d,d=g,g=w);var V=a.u.sr(c,d),v=a.u.sr(c,g);if(null!=h||null!=n)a.zg.Fb(b,e,V,f,v,null,p,A),p=Math.atan2(Math.sin(p.l)*Math.cos(d-V),Math.cos(p.l)),A=Math.atan2(Math.sin(A.l)*
Math.cos(g-v),Math.cos(A.l)),0!=u&&(w=p,p=A,A=w),null!=h&&(h.l=p),null!=n&&(n.l=A);null!=k&&(a.u.wm(c,d,e,U,t,H),E[0]=U.l,E[1]=t.l,E[2]=H.l,a.u.wm(c,g,f,U,t,H),K[0]=U.l,K[1]=t.l,K[2]=H.l,q[0]=E[1]*K[2]-K[1]*E[2],q[1]=-(E[0]*K[2]-K[0]*E[2]),q[2]=E[0]*K[1]-K[0]*E[1],c=1-a.u.Tk(c,a.u.Dp(c,a.u.Si(c,Math.acos(q[2]/Math.sqrt(q[0]*q[0]+q[1]*q[1]+q[2]*q[2]))))),c*=2-c,h=Math.atan2(-q[1],-q[0]),q=a.u.W(h-1.570796326794897),h=a.u.W(h+1.570796326794897),q=a.j.H(a.u.W(e-q))<=a.j.H(a.u.W(e-h))?q:h,a.zg.Fb(1,q,
0,e,V,l,null,null),a.zg.Fb(1,q,0,f,v,r,null,null),3.141592653589793<l.l+r.l&&(q=a.u.W(q+3.141592653589793),a.zg.Fb(1,q,0,e,V,l,null,null),a.zg.Fb(1,q,0,f,v,r,null,null)),l.l*=a.j.nb(1,d),r.l*=a.j.nb(1,g),l.l=a.u.Si(c,l.l),r.l=a.u.Si(c,r.l),e=a.u.q(b,c,l.l),b=a.u.q(b,c,r.l),k.l=a.j.H(b-e))}}};b.gf=function(b,c,e,d,f,g,k,h){var p=0,A=new a.ca(0),n=new a.ca(0),E=[0,0,0],K=[0,0,0],q=new a.ca(0),l=new a.ca(0),r=new a.ca(0);if(null!=k||null!=h)if(a.j.Ih(c))a.zg.gf(b,e,d,f,g,k,h);else if(a.j.Vc(f))null!=
k&&(k.l=e),null!=h&&(h.l=d);else{g=a.u.W(g);0>f&&(f=a.j.H(f),g=a.u.W(g+3.141592653589793));e=a.u.W(e);d=a.u.W(d);1.570796326794897<a.j.H(d)&&(e=a.u.W(e+3.141592653589793),d=a.j.nb(3.141592653589793,d)-d);a.j.S(a.j.H(d),1.570796326794897)&&(e=0);var U;if(a.j.Vc(d))U=a.j.H(1.570796326794897-a.j.H(g)),U=a.u.Si(c,U),U=1-a.u.Tk(c,a.u.Dp(c,U)),U*=2-U,b=f/a.u.gg(b,U)*1.570796326794897,b=a.u.xn(U,b),b=a.u.sr(U,b),a.zg.gf(1,e,d,b,g,k,A),null!=h&&(p=A.l),null!=h&&(h.l=a.u.Si(c,p));else if(a.j.S(a.j.H(d),1.570796326794897))p=
a.u.gg(b,c),A=2*p,b=a.j.nb(1.570796326794897,d),g=0<b?a.u.W(3.141592653589793-g):g,d=p-f,a.j.H(d)<=p?null!=k&&(k.l=g):(d=Math.floor(f/A),0==a.I.truncate(d%2)?(null!=k&&(k.l=g),d=p-(f-d*A)):(null!=k&&(k.l=a.u.W(g+3.141592653589793)),d=p-((d+1)*A-f))),null!=h&&(h.l=a.u.xn(c,d/p*b));else{U=a.u.sr(c,d);g=Math.atan2(Math.sin(g),Math.cos(g)*Math.cos(d-U));var t=a.I.truncate(a.j.nb(1,U))*(1.570796326794897>=a.j.H(g)?1:-1);g=a.u.W(e+Math.atan(Math.tan(g)*-Math.sin(U)));a.zg.Fb(b,g,0,e,U,null,n,null);U=a.j.H(1.570796326794897-
a.j.H(n.l));U=a.u.Si(c,U);U=1-a.u.Tk(c,a.u.Dp(c,U));U*=2-U;a.u.wm(c,0,g,q,l,r);E[0]=q.l;E[1]=l.l;E[2]=r.l;a.u.wm(c,d,e,q,l,r);K[0]=q.l;K[1]=l.l;K[2]=r.l;d=Math.acos((E[0]*K[0]+E[1]*K[1]+E[2]*K[2])/Math.sqrt(K[0]*K[0]+K[1]*K[1]+K[2]*K[2]));d=a.u.Si(U,d);d=a.u.q(b,U,d)+f*t;f=0<d?n.l:a.u.W(n.l+3.141592653589793);b=a.j.H(d)/a.u.gg(b,U)*1.570796326794897;b=a.u.xn(U,b);b=a.u.sr(U,b);a.zg.gf(1,g,0,b,f,k,A);null!=h&&(p=A.l);null!=h&&(h.l=a.u.Si(c,p))}}};return b}();a.Xj=b})(z||(z={}));(function(a){var b=
function(){function b(){}b.Fb=function(b,c,e,d,f,g,k,h,n){var p=0,A=0,E=0;if(null!=k||null!=h||null!=n)if(a.j.Ih(c))a.zg.Fb(b,e,d,f,g,k,h,n);else{var K=a.u.W(f-e);if(a.j.S(d,g)&&(a.j.Vc(K)||a.j.S(a.j.H(d),1.570796326794897)))null!=k&&(k.l=0),null!=h&&(h.l=0),null!=n&&(n.l=0);else{if(a.j.S(d,-g)){if(a.j.S(a.j.H(d),1.570796326794897)){null!=k&&(k.l=2*a.u.gg(b,c));null!=h&&(h.l=0<d?a.u.W(3.141592653589793-a.u.W(f)):a.u.W(f));null!=n&&(n.l=0<d?a.u.W(f):a.u.W(3.141592653589793-a.u.W(f)));return}a.j.S(a.j.H(K),
3.141592653589793)&&(null!=k&&(k.l=2*a.u.gg(b,c)),null!=h&&(h.l=0),null!=n&&(n.l=0))}else{if(a.j.S(a.j.H(d),1.570796326794897)||a.j.S(a.j.H(g),1.570796326794897)){a.Xj.Fb(b,c,e,d,f,g,k,h,n);return}if(a.j.Vc(K)||a.j.S(a.j.H(K),3.141592653589793)){a.Xj.Fb(b,c,e,d,f,g,k,h,n);return}}var q=1-Math.sqrt(1-c),l=c/(1-c),r=b*(1-q);b=a.u.Dp(c,d);var U=a.u.Dp(c,g);c=1.570796326794897==a.j.H(b)?0:Math.cos(b);var t=Math.sin(b),H=1.570796326794897==a.j.H(U)?0:Math.cos(U),u=Math.sin(U),V=K,w=Math.cos(V),v=Math.sin(V),
x=1,X=0,m,y,z,ba,fa;do{m=V;y=Math.sqrt(Math.pow(H*v,2)+Math.pow(c*u-t*H*w,2));z=t*u+c*H*w;ba=Math.atan2(y,z);if(0==y){x=0;break}fa=c*H*v/y;p=Math.cos(Math.asin(fa));p*=p;A=z-2*t*u/p;1<a.j.H(A)&&(A=a.j.nb(1,A));E=A*A;V=q/16*p*(4+q*(4-3*p));V=K+(1-V)*q*fa*(ba+V*y*(A+V*z*(2*E-1)));w=Math.cos(V);v=Math.sin(V);X++;if(3.141592653589793<a.j.H(V)&&30<X){x=0;break}}while(5E3>=X&&!a.j.S(m,V));if(0!=x)l*=p,q=l*(256+l*(-128+l*(74-47*l)))/1024,null!=k&&(k.l=r*(1+l*(4096+l*(-768+l*(320-175*l)))/16384)*(ba-q*y*
(A+q/4*(z*(2*E-1)-q/6*A*(4*y*y-3)*(4*E-3))))),null!=h&&(a.j.S(a.j.H(d),1.570796326794897)?h.l=0>d?f:a.u.W(3.141592653589793-f):h.l=Math.atan2(H*v,c*u-t*H*w)),null!=n&&(a.j.S(a.j.H(g),1.570796326794897)?n.l=0>g?e:a.u.W(3.141592653589793-e):(n.l=Math.atan2(c*v,c*u*w-t*H),n.l=a.u.W(n.l+3.141592653589793)));else{V=a.j.nb(3.141592653589793,K);z=t*u-c*H;ba=Math.acos(z);y=Math.sin(ba);p=1;X=fa=0;do E=fa,p*=p,w=p*p,fa=q*p*(1+q+q*q),A=q*q*w*(1+2.25*q),x=q*q*q*w*p,w=1-.25*fa+.1875*A-.1953125*x,fa=.25*fa-.25*
A+.29296875*x,v=.03125*A-.05859375*x,x*=.00651041666666667,A=z-2*t*u/p,1<a.j.H(A)&&(A=a.j.nb(1,A)),p=Math.acos(A),z=Math.cos(2*p),m=Math.cos(3*p),fa=a.j.S(d,-g)?a.u.W(3.141592653589793-K)/(3.141592653589793*q*w):a.u.W(V-K)/(q*(w*ba+fa*y*A+v*Math.sin(2*ba)*z+x*Math.sin(3*ba)*m)),v=fa*y/(c*H),V=1.570796326794897<a.j.H(K)?a.j.nb(3.141592653589793,v)-Math.asin(v):Math.asin(v),w=Math.cos(V),y=Math.sqrt(Math.pow(H*v,2)+Math.pow(c*u-t*H*w,2)),ba=3.141592653589793-Math.asin(a.j.H(y)),z=Math.cos(ba),p=Math.cos(Math.asin(fa)),
X++;while(70>=X&&!a.j.S(E,fa));null!=k&&(p*=p,l*=p,w=1+l*(4096+l*(-768+l*(320-175*l)))/16384,a.j.S(d,-g)?k.l=3.141592653589793*r*w:(A=z-2*t*u/p,p=Math.acos(A),z=Math.cos(2*p),m=Math.cos(3*p),k.l=r*(w*ba+l*(-512+l*(128+l*(-60+35*l)))/2048*y*A+l*(-4+5*l)/6144*l*l*Math.sin(2*ba)*z+x*Math.sin(3*ba)*m+-7.62939453125E-5*l*l*l*l*Math.sin(4*ba)*Math.cos(4*p))));null!=h&&(a.j.Vc(d)&&a.j.Vc(g)?(p=Math.sqrt(1-fa*fa),h.l=Math.acos(p),0>K&&(h.l*=-1)):a.j.S(a.j.H(d),1.570796326794897)?h.l=0>d?f:a.u.W(3.141592653589793-
f):(k=fa/c,r=Math.sqrt(1-k*k),0>c*u-t*H*Math.cos(V)&&(r*=-1),h.l=Math.atan2(k,r),a.j.S(d,-g)&&a.j.H(a.u.W(e-f))>3.141592653589793*(1-q*Math.cos(d))&&(0<d&&1.570796326794897>a.j.H(h.l)||0>d&&1.570796326794897<a.j.H(h.l))&&(h.l=a.j.nb(3.141592653589793,h.l)-h.l)));if(null!=n)if(a.j.Vc(d)&&a.j.Vc(g))p=Math.sqrt(1-fa*fa),n.l=Math.acos(p),0<=K&&(n.l*=-1);else if(a.j.S(a.j.H(g),1.570796326794897))n.l=0>g?e:a.u.W(3.141592653589793-e);else if(K=fa/H,k=Math.sqrt(1-K*K),r=Math.sin(V/2),0>Math.sin(U-b)-2*c*
u*r*r&&(k*=-1),n.l=Math.atan2(K,k),n.l=a.u.W(n.l+3.141592653589793),a.j.S(d,-g)&&!a.j.Vc(d)&&!a.j.S(a.j.H(d),1.570796326794897)&&a.j.H(a.u.W(e-f))>3.141592653589793*(1-q*Math.cos(d))&&(null!=h?r=h.l:(k=fa/c,r=Math.sqrt(1-k*k),0>c*u-t*H*Math.cos(V)&&(r*=-1),r=Math.atan2(k,r),a.j.S(d,-g)&&a.j.H(a.u.W(e-f))>3.141592653589793*(1-q*Math.cos(d))&&(0<d&&1.570796326794897>a.j.H(r)||0>d&&1.570796326794897<a.j.H(r))&&(r=a.j.nb(3.141592653589793,r)-r)),1.570796326794897>=a.j.H(r)&&1.570796326794897<a.j.H(n.l)||
1.570796326794897<=a.j.H(r)&&1.570796326794897>a.j.H(n.l)))n.l=-1*a.u.W(n.l+3.141592653589793)}}}};b.gf=function(b,c,e,d,f,g,k,h){if(null!=k||null!=h)if(a.j.Ih(c))a.zg.gf(b,e,d,f,g,k,h);else if(g=a.u.W(g),a.j.S(a.j.H(d),1.570796326794897)||a.j.Vc(g)||a.j.S(a.j.H(g),3.141592653589793))a.Xj.gf(b,c,e,d,f,g,k,h);else{var p=1.570796326794897==a.j.H(g)?0:Math.cos(g),A=3.141592653589793==a.j.H(g)?0:Math.sin(g);a.j.S(a.j.H(d),1.570796326794897)&&(e=0);g=1-Math.sqrt(1-c);var n=a.u.Dp(c,d);d=1.570796326794897==
a.j.H(n)?0:Math.cos(n);var E=Math.sin(n),n=Math.atan2(Math.tan(n),p),K=d*A,q=K*K,l=1-q,r=c/(1-c)*l;c=r*(256+r*(-128+r*(74-47*r)))/1024;var U=c/4,t=c/6,H=f/(b*(1-g)*(1+r*(4096+r*(-768+r*(320-175*r)))/16384)),u=H,V;do{V=u;f=1.570796326794897==a.j.H(u)?0:Math.cos(u);var r=3.141592653589793==a.j.H(u)?0:Math.sin(u),w=r*r;b=Math.cos(2*n+u);u=b*b;u=c*r*(b+U*(f*(2*u-1)-t*b*(4*w-3)*(4*u-3)))+H}while(!a.j.S(V,u));f=1.570796326794897==a.j.H(u)?0:Math.cos(u);r=3.141592653589793==a.j.H(u)?0:Math.sin(u);null!=
k&&(A=Math.atan2(r*A,d*f-E*r*p),l=g/16*l*(4+g*(4-3*l)),b=Math.cos(2*n+u),k.l=a.u.W(e+(A-(1-l)*g*K*(u+l*r*(b+l*f*(2*b*b-1))))));null!=h&&(l=E*r-d*f*p,l=(1-g)*Math.sqrt(q+l*l),h.l=Math.atan2(E*f+d*r*p,l))}};return b}();a.cs=b})(z||(z={}));(function(a){var b=function(){function b(){}b.Fb=function(b,c,e,d,f,g,k,h,n){var p=a.u.W(f-e),A=a.j.S(a.j.H(d),1.570796326794897),E=a.j.S(a.j.H(g),1.570796326794897);if(a.j.S(d,g)&&(a.j.Vc(p)||A))null!=k&&(k.l=0),null!=h&&(h.l=0),null!=n&&(n.l=0);else{var K,q;a.j.Ih(c)?
(K=Math.sin(d),q=Math.sin(g),K=Math.sqrt((1+K)/(1-K)),q=Math.sqrt((1+q)/(1-q)),K=Math.log(q)-Math.log(K),K=Math.atan2(p,K),null!=k&&(k.l=a.j.S(d,g)?a.j.H(b*Math.cos(d)*p):a.j.H((b*g-b*d)/Math.cos(K)))):(q=a.u.qu(c,g),K=Math.sin(a.u.qu(c,d)),q=Math.sin(q),K=Math.sqrt((1+K)/(1-K)),q=Math.sqrt((1+q)/(1-q)),K=Math.log(q)-Math.log(K),K=Math.atan2(p,K),null!=k&&(a.j.S(d,g)?k.l=a.j.H(b*p*Math.cos(d)/a.u.Tk(c,d)):(p=a.u.q(b,c,d),b=a.u.q(b,c,g),k.l=a.j.H((b-p)/Math.cos(K)))));if(null!=h||null!=n)k=a.u.W(K+
3.141592653589793),A&&E||!A&&!E||(A?K=0>d?f:a.u.W(3.141592653589793-f):E&&(k=0>g?e:a.u.W(3.141592653589793-e))),null!=h&&(h.l=K),null!=n&&(n.l=k)}};b.gf=function(b,c,e,d,f,g,k,h){g=a.u.W(g);0>f&&(f=a.j.H(f),g=a.u.W(g+3.141592653589793));a.j.Ih(c)?a.j.S(a.j.H(d),1.570796326794897)?(e=0>d?g:a.u.W(3.141592653589793-g),g=f/b%6.283185307179586,3.141592653589793>=g?b=d-a.j.nb(g,d):(e=a.u.W(e+3.141592653589793),b=-d+a.j.nb(g-3.141592653589793,d))):a.j.S(a.j.H(g),1.570796326794897)?(e=a.u.W(e+a.j.nb(f,g)/
(b*Math.cos(d))),b=d):(b=d+f*Math.cos(g)/b,1.570796326794897<a.j.H(b)&&(b=1.570796326794897),a.j.S(a.j.H(b),1.570796326794897)&&(a.j.Vc(g)||a.j.S(a.j.H(g),3.141592653589793))||(1.570796316258184<a.j.H(b)&&(b=a.j.nb(1.570796316258184,b)),c=Math.sin(d),d=Math.sin(b),c=Math.sqrt((1+c)/(1-c)),d=Math.sqrt((1+d)/(1-d)),c=Math.log(d)-Math.log(c),e=a.u.W(e+Math.tan(g)*c))):a.j.S(a.j.H(d),1.570796326794897)?(e=0>d?g:a.u.W(3.141592653589793-g),g=f/a.u.nR(b,c),g%=6.283185307179586,3.141592653589793>=g?(b=d-
a.j.nb(g,d),b=a.u.xn(c,b)):(e=a.u.W(e+3.141592653589793),b=-d+a.j.nb(g-3.141592653589793,d),b=a.u.xn(c,b))):a.j.S(a.j.H(g),1.570796326794897)?(e=a.u.W(e+a.j.nb(f,g)*a.u.Tk(c,d)/(b*Math.cos(d))),b=d):(b=1.570796326794897*(f*Math.cos(g)+a.u.q(b,c,d))/a.u.gg(b,c),1.570796326794897<a.j.H(b)&&(b=a.j.nb(1.570796326794897,b)),b=a.u.xn(c,b),a.j.S(a.j.H(b),1.570796326794897)&&(a.j.Vc(g)||a.j.S(a.j.H(g),3.141592653589793))||(f=a.u.qu(c,d),d=a.u.qu(c,b),1.570796316258184<a.j.H(d)&&(d=a.j.nb(1.570796316258184,
b),b=a.u.$K(c,d)),c=Math.sin(f),d=Math.sin(d),c=Math.sqrt((1+c)/(1-c)),d=Math.sqrt((1+d)/(1-d)),c=Math.log(d)-Math.log(c),e=a.u.W(e+Math.tan(g)*c)));null!=k&&(k.l=e);null!=h&&(h.l=b)};return b}();a.Zz=b})(z||(z={}));(function(a){var b=function(){function b(){}b.gw=function(b,c,e,d,f,g,k){a.cs.Fb(b,c,e,d,f,g,null,k,null)};b.Ph=function(b,c,e,d,f,g,k,h){a.cs.gf(b,c,e,d,f,g,k,h)};b.Rd=function(b,c,e,d,f,g,k,h,n,q){switch(q){case 2:a.Xj.Fb(b,c,e,d,f,g,k,h,n);break;case 3:a.$z.Fb(b,c,e,d,f,g,k,h,n);break;
case 1:a.Zz.Fb(b,c,e,d,f,g,k,h,n);break;default:a.cs.Fb(b,c,e,d,f,g,k,h,n)}};b.dk=function(b,c,e,d,f,g,k,h,n){switch(n){case 2:a.Xj.gf(b,c,e,d,f,g,k,h);break;case 3:a.$z.gf(b,c,e,d,f,g,k,h);break;case 1:a.Zz.gf(b,c,e,d,f,g,k,h);break;default:a.cs.gf(b,c,e,d,f,g,k,h)}};return b}();a.zb=b})(z||(z={}));(function(a){var b=function(){function b(){}b.QS=function(c,e){var d=8;0>d&&(d=8);var f=[0,0,0,0],p=new a.b;p.J(e);p.scale(9102==a.Ya.Em(c).Se().Qc()?1:a.Ya.Em(c).Se().Dj/3.141592653589793*180);-180>p.x?
(p.x-=p.x%360,-180>p.x&&(p.x+=360)):180<p.x&&(p.x-=p.x%360,180<p.x&&(p.x-=360));90<p.y&&(p.y=90);-90>p.y&&(p.y=-90);c=5*d;e=(c+31)/32;for(var g=-180,k=180,h=c-1,n=e-1;0<=n;n--)for(var E=h-32*n,q=Math.min(32,c-32*n),l=1;l<q;l+=2){var r=.5*(k+g);p.x>=r?(f[n]|=1<<E,g=r):k=r;E-=2;h-=2}g=-90;k=90;h=c-2;for(n=e-1;0<=n;n--)for(E=h-32*n,q=Math.min(32,c-32*n),l=0;l<q;l+=2)r=.5*(k+g),p.y>=r?(f[n]|=1<<E,g=r):k=r,E-=2,h-=2;return b.XS(f,d,d)};b.XS=function(a,b,c){for(var e=[],d=0;d<b;d++)e[d]="";for(var f=d=
0,p=0;p<b;p++){var g=a[d]>>f&31,f=f+5;if(31<f){var A=37-f,g=g&(1<<A)-1,f=f-32;d++;g|=(a[d]&(1<<f)-1)<<A}e[b-1-p]="0123456789bcdefghjkmnpqrstuvwxyz".split("")[g]}if(c>b)for(p=0;p<c-b;p++)e.push("0");else c<b&&(e.length=c);return e.join("")};return b}();a.qH=b})(z||(z={}));(function(a){var b={gcstol:[0,1E-8,1,1.11111E-8,2,1.68845E-8,3,2.17661E-8,4,2.22508E-8,5,2.34848E-8,6,2.37811E-8,7,2.88455E-8,8,3.1456E-8,9,3.29779E-8,10,3.66789E-8,11,4.23597E-8,12,4.79463E-8,13,6.45223E-8,14,7.26274E-8,15,7.49945E-8,
16,7.52506E-8,17,7.97991E-8,18,9.66202E-8,19,9.79918E-8,20,9.89735E-8,21,1.02314E-7,22,1.08146E-7,23,2.29734E-7,24,2.42985E-7,25,2.7546E-7,26,3.37034E-7,27,4.30795E-7,28,5.20871E-7,29,5.50921E-7,30,6.74068E-7,31,6.86177E-7,32,7.25263E-7,33,7.44101E-7,34,7.74267E-7,35,9.62954E-7,36,1.06103E-6,37,1.14363E-6,38,1.16219E-6,39,1.36419E-6,40,1.36744E-6,41,1.43239E-6,42,1.73624E-6,43,1.84825E-6,44,1.90986E-6,45,1.97572E-6,46,2.12207E-6,47,2.72837E-6,48,3.1831E-6,49,3.58099E-6,50,3.81972E-6,51,4.09256E-6,
52,4.40737E-6,53,4.77465E-6,54,5.16178E-6,55,5.20871E-6,56,5.72958E-6,57,6.03113E-6,58,6.98729E-6,59,9.24125E-6,60,1.14592E-5],pcstol:[0,6.66667E-9,1,2E-8,2,4.97098E-5,3,.001,4,.00109362,5,.00328087,6,.00497101],newtoold:[2154,102110,2195,102200,2204,32036,2205,26979,2225,102641,2226,102642,2227,102643,2228,102644,2229,102645,2230,102646,2231,102653,2232,102654,2233,102655,2234,102656,2235,102657,2236,102658,2237,102659,2238,102660,2239,102666,2240,102667,2241,102668,2242,102669,2243,102670,2246,
102679,2247,102680,2248,102685,2249,102686,2250,102687,2254,102694,2255,102695,2257,102712,2258,102713,2259,102714,2260,102715,2261,102716,2262,102717,2263,102718,2264,102719,2267,102724,2268,102725,2271,102728,2272,102729,2274,102736,2275,102737,2276,102738,2277,102739,2278,102740,2279,102741,2283,102746,2284,102747,2285,102748,2286,102749,2287,102752,2288,102753,2289,102754,2312,23433,2326,102140,2395,2091,2396,2092,2397,2166,2398,2167,2399,2168,2759,102229,2760,102230,2761,102248,2762,102249,2763,
102250,2764,102251,2765,102252,2766,102241,2767,102242,2768,102243,2769,102244,2770,102245,2771,102246,2772,102253,2773,102254,2774,102255,2775,102256,2776,102257,2777,102258,2778,102259,2779,102260,2780,102266,2781,102267,2782,102261,2783,102262,2784,102263,2785,102264,2786,102265,2787,102268,2788,102269,2789,102270,2790,102271,2791,102272,2792,102273,2793,102274,2794,102275,2795,102276,2796,102277,2797,102278,2798,102279,2799,102280,2800,102281,2801,102282,2802,102283,2803,102284,2804,102285,2805,
102286,2806,102287,2807,102288,2808,102289,2809,102290,2810,102291,2811,102292,2812,102293,2813,102294,2814,102295,2815,102296,2816,102297,2817,102298,2818,102300,2819,102304,2820,102307,2821,102308,2822,102309,2823,102310,2824,102311,2825,102312,2826,102313,2827,102314,2828,102315,2829,102316,2830,102317,2831,102318,2832,102320,2833,102321,2834,102322,2835,102323,2836,102324,2837,102325,2838,102326,2839,102327,2840,102330,2841,102334,2842,102335,2843,102336,2844,102337,2845,102338,2846,102339,2847,
102340,2848,102341,2849,102342,2850,102343,2851,102344,2852,102345,2853,102346,2854,102347,2855,102348,2856,102349,2857,102350,2858,102351,2859,102352,2860,102353,2861,102354,2862,102355,2863,102356,2864,102357,2865,102358,2866,102361,2942,102167,2943,102169,2944,2139,2945,2140,2946,2141,2947,2142,2948,2143,2949,2144,2950,2145,2951,2146,2952,2147,2953,2036,2954,2291,2955,2153,2956,2152,2957,2151,2958,2150,2959,2149,2960,2037,2961,2038,2962,2148,2965,2244,2966,2245,3003,102091,3004,102092,3005,102190,
3060,2982,3067,102139,3072,102606,3074,102608,3075,102208,3077,102210,3078,102123,3080,102119,3081,102603,3082,102602,3083,102601,3088,65163,3089,102763,3090,102363,3092,102151,3093,102152,3094,102153,3095,102154,3096,102155,3097,102145,3098,102146,3099,102147,3100,102148,3101,102149,3102,2155,3107,102172,3110,102170,3111,102171,3119,2214,3158,102234,3159,102235,3160,102236,3336,2979,3338,102006,3346,2600,3370,102126,3371,102127,3372,102130,3373,102131,3400,102184,3401,102185,3404,3359,3407,3366,
3417,102675,3418,102676,3419,102677,3420,102678,3421,102707,3422,102708,3423,102709,3424,102711,3433,102651,3434,102652,3435,102671,3436,102672,3437,102710,3438,102730,3448,102095,3451,102681,3452,102682,3455,102735,3461,2063,3462,2064,3463,3073,3464,3076,3560,102742,3566,102743,3567,102744,3734,102722,3735,102723,3736,102755,3737,102756,3738,102757,3739,102758,3741,102205,3742,102206,3743,102207,3748,102211,3750,102202,3751,102203,3759,102663,3760,102463,3764,102112,3770,102090,3771,102180,3772,
102181,3773,102182,3775,102186,3776,102187,3777,102188,3800,102183,3801,102189,3812,102199,3814,102609,3815,102469,3819,104990,3821,104136,3824,104137,3825,102444,3826,102443,3827,102442,3828,102441,3857,102100,3889,104991,3906,104992,4048,103201,4049,103202,4050,103203,4051,103204,4056,103205,4057,103206,4058,103207,4059,103208,4060,103209,4061,103210,4062,103211,4063,103212,4071,103213,4082,103214,4083,103215,4093,103216,4094,103217,4095,103218,4096,103219,4167,104108,4169,37252,4171,104107,4189,
104110,4197,4234,4223,37223,4304,104304,4414,102201,4415,102762,4417,102764,4434,102765,4437,102647,4455,32029,4456,32018,4457,3454,4462,102439,4463,4466,4470,4469,4484,103794,4485,103795,4486,103796,4487,103797,4488,103798,4489,103799,4611,104104,4612,104111,4613,37255,4615,37247,4616,37250,4617,4140,4618,4291,4620,37211,4626,37235,4647,102362,4658,37204,4668,37201,4669,4126,4672,37217,4673,104125,4675,37220,4684,37232,4698,4631,4707,37213,4708,37231,4709,37212,4710,37238,4711,37214,4712,37237,4713,
37208,4714,37215,4715,37253,4716,37216,4717,37239,4719,37219,4722,37242,4724,37233,4725,37222,4727,37224,4728,37246,4729,37226,4730,37227,4731,37228,4732,37229,4733,37230,4734,37251,4735,37259,4736,37254,4739,37205,4758,104133,4760,37001,4762,104114,4826,102214,5013,104142,5014,102331,5015,102332,5016,102333,5173,102085,5174,102086,5175,102087,5176,102088,5177,102089,5178,102040,5179,102080,5185,102081,5186,102082,5187,102083,5188,102084,5221,102066,5246,104100,5247,102490,5324,104144,5325,102420,
5329,2934,5365,104143,5367,102305,5451,104132,5513,102065,5514,102067,5519,102111,5520,31461,5646,102745,5839,5388,5858,5532,5879,4474,21896,21891,21897,21892,21898,21893,21899,21894,26701,102124,26702,102125,26799,26747,26847,102683,26848,102684,26849,102691,26850,102692,26851,102693,26852,102704,26853,102750,26854,102751,26857,102466,26858,102467,26859,102468,26901,102128,26902,102129,27493,27492,29101,29100,29168,29118,29169,29119,29170,29120,29171,29121,29172,29122,29187,29177,29188,29178,29189,
29179,29190,29180,29191,29181,29192,29182,29193,29183,29194,29184,29195,29185,29902,29900,31279,31278,31281,31291,31282,31292,31283,31293,31284,31294,31285,31295,31286,31296,31287,31297,31466,31462,31467,31463,31468,31464,31469,31465,31986,31917,31987,31918,31988,31919,31989,31920,31990,31921,31991,31922,32064,32074,32065,32075,32066,32076,32067,32077],pcsid:[2066,6,2136,5,2155,5,2157,3,2158,3,2159,5,2160,5,2219,3,2220,3,2244,5,2245,5,2256,5,2265,5,2266,5,2269,5,2270,5,2273,5,2290,3,2291,3,2294,3,
2295,3,2313,3,2314,5,2964,5,2967,5,2968,5,2991,3,2992,5,2993,3,2994,5,3073,3,3076,3,3079,3,3091,5,3106,3,3108,3,3109,3,3141,3,3142,3,3167,2,3337,3,3347,3,3348,3,3359,5,3360,3,3361,5,3362,3,3363,5,3364,3,3365,5,3366,5,3402,3,3403,3,3405,3,3406,3,3439,3,3440,3,3447,3,3449,3,3450,3,3453,5,3454,5,3460,3,3479,5,3480,3,3481,5,3482,3,3483,5,3484,3,3485,5,3486,3,3487,5,3488,3,3489,3,3490,5,3491,3,3492,5,3493,3,3494,5,3495,3,3496,5,3497,3,3498,5,3499,3,3500,5,3501,3,3502,5,3503,3,3504,5,3505,3,3506,5,3507,
3,3508,5,3509,3,3510,5,3511,3,3512,5,3513,3,3514,3,3515,5,3516,3,3517,5,3518,3,3519,5,3520,3,3521,5,3522,3,3523,5,3524,3,3525,5,3526,3,3527,5,3528,3,3529,5,3530,3,3531,5,3532,3,3533,5,3534,3,3535,5,3536,3,3537,5,3538,3,3539,5,3540,3,3541,5,3542,3,3543,5,3544,3,3545,5,3546,3,3547,5,3548,3,3549,5,3550,3,3551,5,3552,3,3553,5,3582,5,3583,3,3584,5,3585,3,3586,5,3587,3,3588,5,3589,3,3590,5,3591,3,3592,3,3593,5,3598,5,3599,3,3600,5,3605,5,3606,3,3607,3,3608,5,3609,3,3610,5,3611,3,3612,5,3613,3,3614,5,3615,
3,3616,5,3617,3,3618,5,3619,3,3620,5,3621,3,3622,5,3623,3,3624,5,3625,3,3626,5,3627,3,3628,5,3629,3,3630,5,3631,3,3632,5,3633,3,3634,5,3635,3,3636,5,3640,5,3641,3,3642,5,3643,3,3644,5,3645,3,3646,5,3647,3,3648,5,3649,3,3650,5,3651,3,3652,5,3653,3,3654,5,3655,3,3656,5,3657,3,3658,5,3659,3,3660,5,3661,3,3662,5,3663,3,3664,5,3668,5,3669,3,3670,5,3671,3,3672,5,3673,3,3674,5,3675,3,3676,5,3677,5,3678,3,3679,5,3680,5,3681,3,3682,5,3683,5,3684,3,3685,3,3686,5,3687,3,3688,5,3689,3,3690,5,3691,3,3692,5,3696,
5,3697,3,3698,5,3699,3,3700,5,3740,3,3749,3,3783,3,3784,3,3793,3,3794,3,3802,3,3816,3,3829,3,3854,3,3920,3,3978,3,3979,3,3991,5,3992,5,4026,3,4037,3,4038,3,4217,5,4438,5,4439,5,4467,3,4471,3,4474,3,4559,3,4839,3,5018,3,5048,3,5167,3,5168,3,5223,3,5234,3,5235,3,5243,3,5266,3,5316,3,5320,3,5321,3,5330,3,5331,3,5337,3,5361,3,5362,3,5382,3,5383,3,5396,3,5456,3,5457,3,5469,3,5472,4,5490,3,5518,3,5523,3,5559,3,5588,5,5589,5,5596,3,5627,3,5629,3,5641,3,5643,3,5644,3,5654,5,5655,5,5659,3,5700,3,5825,3,5836,
3,5837,3,5842,3,5844,3,5880,3,5887,3,5890,3,20499,3,20538,3,20539,3,20790,3,20791,3,21291,3,21292,3,21500,3,21817,3,21818,3,22032,3,22033,3,22091,3,22092,3,22332,3,22391,3,22392,3,22700,3,22770,3,22780,3,22832,3,23090,3,23095,3,23239,3,23240,3,23433,3,23700,3,24047,3,24048,3,24100,5,24200,3,24305,3,24306,3,24382,4,24383,3,24500,3,24547,3,24548,3,24571,2,24600,3,25E3,3,25231,3,25884,3,25932,3,26237,3,26331,3,26332,3,26591,3,26592,3,26632,3,26692,3,26855,5,26856,5,27120,3,27200,3,27291,4,27292,4,27429,
3,27492,3,27500,3,27700,3,28232,3,28600,3,28991,3,28992,3,29100,3,29220,3,29221,3,29333,3,29635,3,29636,3,29701,3,29738,3,29739,3,29849,3,29850,3,29871,2,29872,5,29873,3,29900,3,29901,3,29903,3,30200,6,30339,3,30340,3,30591,3,30592,3,30791,3,30792,3,31028,3,31121,3,31154,3,31170,3,31171,3,31370,3,31528,3,31529,3,31600,3,31700,3,31838,3,31839,3,31901,3,32061,3,32062,3,32098,3,32099,5,32100,3,32104,3,32161,3,32766,3,53034,3,53048,3,53049,3,54034,3,65061,5,65062,5,65161,3,65163,3,102041,5,102064,4,102068,
1,102069,0,102217,5,102218,3,102219,5,102220,5,102378,5,102379,5,102380,3,102381,5,102589,5,102599,5,102600,5,102604,5,102605,3,102606,3,102647,3,102704,5,102705,5,102733,5,102761,5,102762,3,102763,5,102764,3,102765,3,102766,5,102970,5,102974,5,102993,3,102994,3,102995,5,102996,5,103015,3,103016,5,103017,3,103018,5,103025,3,103026,3,103027,5,103028,5,103035,3,103036,3,103037,5,103038,5,103039,3,103040,3,103041,5,103042,5,103043,3,103044,3,103045,5,103046,5,103047,3,103048,3,103049,5,103050,5,103051,
3,103052,5,103053,3,103054,5,103055,3,103056,5,103057,3,103058,3,103059,5,103060,5,103061,3,103062,3,103063,5,103064,5,103069,5,103070,3,103071,3,103072,5,103073,5,103086,3,103087,3,103088,5,103089,5,103094,5,103095,3,103096,5,103103,3,103104,5,103105,3,103106,5,103121,3,103122,5,103123,3,103124,3,103125,5,103126,5,103127,3,103128,3,103129,5,103130,5,103131,3,103132,3,103133,5,103134,5,103135,3,103136,3,103137,5,103138,5,103139,3,103140,5,103141,3,103142,5,103143,3,103144,5,103145,3,103146,5,103147,
3,103148,3,103149,5,103150,5,103151,3,103152,5,103172,3,103173,5,103174,3,103175,3,103176,5,103177,5,103178,3,103179,3,103180,5,103181,5,103182,3,103183,3,103184,5,103185,5,103228,3,103229,3,103230,5,103231,5,103250,3,103251,5,103252,3,103253,5,103260,3,103261,3,103262,5,103263,5,103270,3,103271,3,103272,5,103273,5,103274,3,103275,3,103276,5,103277,5,103278,3,103279,3,103280,5,103281,5,103282,3,103283,3,103284,5,103285,5,103286,3,103287,5,103288,3,103289,5,103290,3,103291,5,103292,3,103293,3,103294,
5,103295,5,103296,3,103297,3,103298,5,103299,5,103376,5,103377,3,103378,3,103379,5,103380,5,103393,3,103394,3,103395,5,103396,5,103472,3,103473,5,103474,3,103475,5,103482,3,103483,5,103484,3,103485,5,103500,3,103501,5,103502,3,103503,3,103504,5,103505,5,103506,3,103507,3,103508,5,103509,5,103510,3,103511,3,103512,5,103513,5,103514,3,103515,5,103516,3,103517,5,103518,3,103519,5,103520,3,103521,5,103522,3,103523,3,103524,5,103525,5,103526,3,103527,5,103561,5,103562,5,103563,3,103564,3,103565,5,103566,
5,103567,3,103568,3,103569,5,103570,5,103585,5,103695,5],pcsidc:[[2E3,2045,3],[2056,2065,3],[2067,2135,3],[2137,2153,3],[2161,2170,3],[2172,2193,3],[2196,2198,3],[2200,2203,3],[2206,2217,3],[2222,2224,5],[2251,2253,5],[2280,2282,5],[2308,2311,3],[2315,2325,3],[2327,2394,3],[2400,2462,3],[2523,2576,3],[2578,2693,3],[2695,2758,3],[2867,2888,5],[2891,2930,5],[2931,2941,3],[2969,2973,3],[2975,2982,3],[2984,2988,3],[2995,3002,3],[3006,3051,3],[3054,3059,3],[3061,3066,3],[3068,3071,3],[3084,3087,3],[3112,
3118,3],[3120,3138,3],[3146,3151,3],[3153,3157,3],[3161,3166,3],[3168,3172,3],[3174,3203,3],[3294,3313,3],[3315,3335,3],[3339,3345,3],[3350,3358,3],[3367,3369,3],[3374,3399,3],[3408,3416,3],[3425,3432,5],[3441,3446,5],[3456,3459,5],[3465,3478,3],[3554,3559,3],[3561,3565,5],[3568,3570,5],[3571,3581,3],[3594,3597,3],[3601,3604,3],[3637,3639,3],[3665,3667,3],[3693,3695,3],[3701,3727,3],[3728,3733,5],[3744,3747,3],[3753,3758,5],[3761,3763,3],[3765,3769,3],[3779,3781,3],[3788,3791,3],[3797,3799,3],[3832,
3841,3],[3844,3852,3],[3873,3885,3],[3890,3893,3],[3907,3912,3],[3942,3950,3],[3968,3970,3],[3973,3976,3],[3986,3989,3],[3994,3997,3],[4399,4413,5],[4418,4433,5],[4491,4554,3],[5069,5072,3],[5105,5130,3],[5180,5184,3],[5253,5259,3],[5269,5275,3],[5292,5311,3],[5343,5349,3],[5355,5357,3],[5387,5389,3],[5459,5463,3],[5479,5482,3],[5530,5539,3],[5550,5552,3],[5562,5583,3],[5623,5625,5],[5631,5639,3],[5649,5653,3],[5663,5680,3],[5682,5685,3],[5875,5877,3],[20002,20032,3],[20062,20092,3],[20135,20138,
3],[20248,20258,3],[20348,20358,3],[20436,20440,3],[20822,20824,3],[20934,20936,3],[21035,21037,3],[21095,21097,3],[21148,21150,3],[21413,21423,3],[21473,21483,3],[21780,21782,3],[21891,21894,3],[22171,22177,3],[22181,22187,3],[22191,22197,3],[22234,22236,3],[22521,22525,3],[22991,22994,3],[23028,23038,3],[23830,23853,3],[23866,23872,3],[23877,23884,3],[23886,23894,3],[23946,23948,3],[24311,24313,3],[24342,24347,3],[24370,24374,4],[24375,24381,3],[24718,24721,3],[24817,24821,3],[24877,24882,3],[24891,
24893,3],[25391,25395,3],[25828,25838,3],[26191,26195,3],[26391,26393,3],[26703,26722,3],[26729,26760,5],[26766,26798,5],[26860,26870,5],[26891,26899,3],[26903,26923,3],[26929,26946,3],[26948,26998,3],[27037,27040,3],[27205,27232,3],[27258,27260,3],[27391,27398,3],[27561,27564,3],[27571,27574,3],[27581,27584,3],[27591,27594,3],[28191,28193,3],[28348,28358,3],[28402,28432,3],[28462,28492,3],[29118,29122,3],[29177,29185,3],[30161,30179,3],[30491,30494,3],[30729,30732,3],[31251,31259,3],[31265,31268,
3],[31275,31278,3],[31288,31297,3],[31461,31465,3],[31491,31495,3],[31917,31922,3],[31965,31985,3],[31992,32E3,3],[32001,32003,5],[32005,32031,5],[32033,32060,5],[32074,32077,5],[32081,32086,3],[32107,32130,3],[32133,32158,3],[32164,32167,5],[32180,32199,3],[32201,32260,3],[32301,32360,3],[32601,32662,3],[32664,32667,5],[32701,32761,3],[53001,53004,3],[53008,53019,3],[53021,53032,3],[53042,53046,3],[54001,54004,3],[54008,54019,3],[54021,54032,3],[54042,54046,3],[54048,54053,3],[102001,102040,3],[102042,
102063,3],[102065,102067,3],[102070,102112,3],[102114,102117,3],[102118,102121,5],[102122,102208,3],[102210,102216,3],[102221,102300,3],[102304,102377,3],[102382,102388,3],[102389,102391,5],[102401,102444,3],[102450,102452,3],[102461,102468,5],[102469,102492,3],[102500,102519,5],[102530,102549,3],[102570,102588,3],[102590,102598,3],[102601,102603,3],[102608,102628,3],[102629,102646,5],[102648,102672,5],[102675,102700,5],[102701,102703,3],[102707,102730,5],[102735,102758,5],[102767,102798,3],[102962,
102969,3],[102971,102973,3],[102975,102989,3],[102990,102992,5],[102997,103002,3],[103003,103008,5],[103009,103011,3],[103012,103014,5],[103019,103021,3],[103022,103024,5],[103029,103031,3],[103032,103034,5],[103065,103068,3],[103074,103076,3],[103077,103079,5],[103080,103082,3],[103083,103085,5],[103090,103093,3],[103097,103099,3],[103100,103102,5],[103107,103109,3],[103110,103112,5],[103113,103116,3],[103117,103120,5],[103153,103157,3],[103158,103162,5],[103163,103165,3],[103166,103171,5],[103186,
103188,3],[103189,103191,5],[103192,103195,3],[103196,103199,5],[103200,103224,3],[103225,103227,5],[103232,103237,3],[103238,103243,5],[103244,103246,3],[103247,103249,5],[103254,103256,3],[103257,103259,5],[103264,103266,3],[103267,103269,5],[103300,103375,3],[103381,103383,3],[103384,103386,5],[103387,103389,3],[103390,103392,5],[103397,103399,3],[103400,103471,5],[103476,103478,3],[103479,103481,5],[103486,103488,3],[103489,103491,5],[103492,103495,3],[103496,103499,5],[103539,103543,3],[103544,
103548,5],[103549,103551,3],[103552,103557,5],[103558,103560,3],[103571,103573,3],[103574,103576,5],[103577,103580,3],[103581,103583,5],[103600,103694,3],[103700,103793,5],[103794,103799,3]],gcsid:[4042,0,4075,0,4081,0,4168,0,4170,0,4188,0,4261,1,4262,0,4263,0,4288,0,4289,0,4305,1,4322,0,4324,0,4326,0,4466,0,4469,0,4475,0,4483,0,4490,0,4555,0,4558,0,4614,0,4619,0,4657,0,4670,0,4671,0,4674,0,4682,0,4683,0,4718,0,4720,0,4721,0,4723,0,4726,0,4737,0,4738,0,4759,0,4761,0,4807,1,4808,0,4809,0,4816,1,4817,
0,4818,0,4819,1,4820,0,4821,1,4823,0,4824,0,4901,1,4902,1,4903,0,4904,0,5228,0,5229,0,5233,0,5252,0,5264,0,5340,0,5354,0,5360,0,5371,0,5373,0,5381,0,5393,0,5464,0,5467,0,5489,0,5524,0,5527,0,5546,0,5561,0,5593,0,5681,0,5886,0,37225,1,37235,0,37257,0,37259,0,37260,0,104020,0,104139,1,104140,1,104223,0,104286,0,104287,0,104304,0,104305,0,104896,0,104900,5,104901,0,104902,0,104903,9,104904,2,104905,2,104906,59,104907,54,104908,0,104909,58,104910,31,104911,56,104912,6,104913,50,104914,41,104915,10,104916,
3,104917,30,104918,8,104919,60,104920,53,104921,44,104922,48,104923,51,104924,38,104925,0,104926,49,104927,57,104928,21,104929,23,104930,35,104931,49,104932,27,104933,17,104934,13,104935,7,104936,56,104937,40,104938,28,104939,37,104940,15,104941,55,104942,22,104943,4,104944,0,104945,20,104946,42,104947,47,104948,52,104949,43,104950,46,104951,39,104952,24,104953,16,104954,50,104955,36,104956,33,104957,46,104958,14,104959,19,104960,0,104961,34,104962,32,104963,29,104964,45,104965,26,104966,25,104967,
41,104968,11,104969,12,104970,18],gcsidc:[[4001,4016,0],[4018,4025,0],[4027,4029,0],[4031,4036,0],[4044,4047,0],[4052,4054,0],[4120,4166,0],[4172,4176,0],[4178,4185,0],[4190,4196,0],[4198,4216,0],[4218,4222,0],[4224,4232,0],[4234,4260,0],[4265,4267,0],[4269,4286,0],[4291,4303,0],[4306,4319,0],[4600,4610,0],[4621,4625,0],[4627,4633,0],[4636,4639,0],[4641,4646,0],[4659,4667,0],[4676,4680,0],[4686,4697,0],[4699,4706,0],[4740,4757,0],[4763,4765,0],[4801,4806,0],[4810,4812,1],[4813,4815,0],[37001,37008,
0],[37201,37208,0],[37211,37224,0],[37226,37233,0],[37237,37243,0],[37245,37247,0],[37249,37255,0],[104100,104138,0],[104141,104145,0],[104256,104261,0],[104700,104786,0],[104990,104992,0]]},c={c:[[2E3,2045,9001],[2056,2065,9001],[2067,2135,9001],[2137,2153,9001],[2161,2170,9001],[2172,2193,9001],[2196,2198,9001],[2200,2203,9001],[2206,2217,9001],[2222,2224,9002],[2251,2253,9002],[2280,2282,9002],[2308,2311,9001],[2315,2325,9001],[2327,2394,9001],[2400,2462,9001],[2523,2576,9001],[2578,2693,9001],
[2695,2758,9001],[2867,2869,9002],[2870,2888,9003],[2891,2895,9003],[2896,2898,9002],[2902,2908,9003],[2915,2920,9003],[2921,2923,9002],[2924,2930,9003],[2931,2941,9001],[2969,2973,9001],[2975,2982,9001],[2984,2988,9001],[2995,3002,9001],[3006,3051,9001],[3054,3059,9001],[3061,3066,9001],[3068,3071,9001],[3084,3087,9001],[3112,3118,9001],[3120,3138,9001],[3146,3151,9001],[3153,3157,9001],[3161,3166,9001],[3168,3172,9001],[3174,3203,9001],[3294,3313,9001],[3315,3335,9001],[3339,3345,9001],[3350,3358,
9001],[3367,3369,9001],[3374,3399,9001],[3408,3416,9001],[3425,3432,9003],[3441,3446,9003],[3456,3459,9003],[3465,3478,9001],[3554,3559,9001],[3561,3565,9003],[3568,3570,9003],[3571,3581,9001],[3594,3597,9001],[3601,3604,9001],[3637,3639,9001],[3665,3667,9001],[3693,3695,9001],[3701,3727,9001],[3728,3733,9003],[3744,3747,9001],[3753,3758,9003],[3761,3763,9001],[3765,3769,9001],[3779,3781,9001],[3788,3791,9001],[3797,3799,9001],[3832,3841,9001],[3844,3852,9001],[3873,3885,9001],[3890,3893,9001],[3907,
3912,9001],[3942,3950,9001],[3968,3970,9001],[3973,3976,9001],[3986,3989,9001],[3994,3997,9001],[4001,4016,9102],[4018,4025,9102],[4027,4029,9102],[4031,4036,9102],[4044,4047,9102],[4052,4054,9102],[4120,4166,9102],[4172,4176,9102],[4178,4185,9102],[4190,4196,9102],[4198,4216,9102],[4218,4222,9102],[4224,4232,9102],[4234,4260,9102],[4265,4267,9102],[4269,4286,9102],[4291,4303,9102],[4306,4319,9102],[4399,4413,9003],[4418,4433,9003],[4491,4554,9001],[4600,4610,9102],[4621,4625,9102],[4627,4633,9102],
[4636,4639,9102],[4641,4646,9102],[4659,4667,9102],[4676,4680,9102],[4686,4697,9102],[4699,4706,9102],[4740,4757,9102],[4763,4765,9102],[4801,4806,9102],[4810,4812,9105],[4813,4815,9102],[5069,5072,9001],[5105,5130,9001],[5180,5184,9001],[5253,5259,9001],[5269,5275,9001],[5292,5311,9001],[5343,5349,9001],[5355,5357,9001],[5387,5389,9001],[5459,5463,9001],[5479,5482,9001],[5530,5539,9001],[5550,5552,9001],[5562,5583,9001],[5623,5625,9003],[5631,5639,9001],[5649,5653,9001],[5663,5680,9001],[5682,5685,
9001],[5875,5877,9001],[20002,20032,9001],[20062,20092,9001],[20135,20138,9001],[20248,20258,9001],[20348,20358,9001],[20436,20440,9001],[20822,20824,9001],[20934,20936,9001],[21035,21037,9001],[21095,21097,9001],[21148,21150,9001],[21413,21423,9001],[21473,21483,9001],[21780,21782,9001],[21891,21894,9001],[22171,22177,9001],[22181,22187,9001],[22191,22197,9001],[22234,22236,9001],[22521,22525,9001],[22991,22994,9001],[23028,23038,9001],[23830,23853,9001],[23866,23872,9001],[23877,23884,9001],[23886,
23894,9001],[23946,23948,9001],[24311,24313,9001],[24342,24347,9001],[24370,24374,9084],[24375,24381,9001],[24718,24721,9001],[24817,24821,9001],[24877,24882,9001],[24891,24893,9001],[25391,25395,9001],[25828,25838,9001],[26191,26195,9001],[26391,26393,9001],[26703,26722,9001],[26729,26760,9003],[26766,26798,9003],[26860,26870,9003],[26891,26899,9001],[26903,26923,9001],[26929,26946,9001],[26948,26998,9001],[27037,27040,9001],[27205,27232,9001],[27258,27260,9001],[27391,27398,9001],[27561,27564,9001],
[27571,27574,9001],[27581,27584,9001],[27591,27594,9001],[28191,28193,9001],[28348,28358,9001],[28402,28432,9001],[28462,28492,9001],[29118,29122,9001],[29177,29185,9001],[30161,30179,9001],[30491,30494,9001],[30729,30732,9001],[31251,31259,9001],[31265,31268,9001],[31275,31278,9001],[31288,31297,9001],[31461,31465,9001],[31491,31495,9001],[31917,31922,9001],[31965,31985,9001],[31992,32E3,9001],[32001,32003,9003],[32005,32031,9003],[32033,32060,9003],[32074,32077,9003],[32081,32086,9001],[32107,32130,
9001],[32133,32158,9001],[32164,32167,9003],[32180,32199,9001],[32201,32260,9001],[32301,32360,9001],[32601,32662,9001],[32664,32667,9003],[32701,32761,9001],[37001,37008,9102],[37201,37208,9102],[37211,37224,9102],[37226,37233,9102],[37237,37243,9102],[37245,37247,9102],[37249,37255,9102],[53001,53004,9001],[53008,53019,9001],[53021,53032,9001],[53042,53046,9001],[54001,54004,9001],[54008,54019,9001],[54021,54032,9001],[54042,54046,9001],[54048,54053,9001],[102001,102040,9001],[102042,102063,9001],
[102065,102067,9001],[102070,102112,9001],[102114,102117,9001],[102122,102208,9001],[102210,102216,9001],[102221,102300,9001],[102304,102377,9001],[102382,102388,9001],[102389,102391,9003],[102401,102444,9001],[102450,102452,9001],[102461,102468,9003],[102469,102492,9001],[102500,102519,9002],[102530,102549,9001],[102570,102588,9001],[102590,102598,9001],[102601,102603,9001],[102608,102628,9001],[102629,102646,9003],[102648,102672,9003],[102675,102700,9003],[102701,102703,9001],[102707,102730,9003],
[102735,102758,9003],[102767,102798,9001],[102962,102969,9001],[102971,102973,9001],[102975,102989,9001],[102990,102992,9002],[102997,103002,9001],[103003,103008,9003],[103009,103011,9001],[103012,103014,9003],[103019,103021,9001],[103022,103024,9003],[103029,103031,9001],[103032,103034,9003],[103065,103068,9001],[103074,103076,9001],[103077,103079,9002],[103080,103082,9001],[103083,103085,9003],[103090,103093,9001],[103097,103099,9001],[103100,103102,9003],[103107,103109,9001],[103110,103112,9003],
[103113,103116,9001],[103117,103120,9003],[103153,103157,9001],[103158,103162,9003],[103163,103165,9001],[103166,103168,9002],[103169,103171,9003],[103186,103188,9001],[103189,103191,9003],[103192,103195,9001],[103196,103199,9003],[103200,103224,9001],[103225,103227,9002],[103232,103237,9001],[103238,103243,9003],[103244,103246,9001],[103247,103249,9003],[103254,103256,9001],[103257,103259,9003],[103264,103266,9001],[103267,103269,9003],[103300,103375,9001],[103381,103383,9001],[103384,103386,9002],
[103387,103389,9001],[103390,103392,9003],[103397,103399,9001],[103400,103471,9003],[103476,103478,9001],[103479,103481,9003],[103486,103488,9001],[103489,103491,9003],[103492,103495,9001],[103496,103499,9003],[103539,103543,9001],[103544,103548,9003],[103549,103551,9001],[103552,103554,9002],[103555,103557,9003],[103558,103560,9001],[103571,103573,9001],[103574,103576,9003],[103577,103580,9001],[103581,103583,9003],[103600,103694,9001],[103700,103793,9003],[103794,103799,9001],[104100,104138,9102],
[104141,104145,9102],[104256,104261,9102],[104700,104786,9102],[104900,104970,9102],[104990,104992,9102]],nc:[2066,9039,2136,9094,2155,9003,2157,9001,2158,9001,2159,9094,2160,9094,2219,9001,2220,9001,2244,9003,2245,9003,2256,9002,2265,9002,2266,9002,2269,9002,2270,9002,2273,9002,2290,9001,2291,9001,2294,9001,2295,9001,2313,9001,2314,9005,2899,9003,2900,9003,2901,9002,2909,9002,2910,9002,2911,9003,2912,9003,2913,9002,2914,9002,2964,9003,2967,9003,2968,9003,2991,9001,2992,9002,2993,9001,2994,9002,3073,
9001,3076,9001,3079,9001,3091,9003,3106,9001,3108,9001,3109,9001,3141,9001,3142,9001,3167,9301,3337,9001,3347,9001,3348,9001,3359,9003,3360,9001,3361,9002,3362,9001,3363,9003,3364,9001,3365,9003,3366,9005,3402,9001,3403,9001,3405,9001,3406,9001,3439,9001,3440,9001,3447,9001,3449,9001,3450,9001,3453,9003,3454,9003,3460,9001,3479,9002,3480,9001,3481,9002,3482,9001,3483,9002,3484,9001,3485,9003,3486,9001,3487,9003,3488,9001,3489,9001,3490,9003,3491,9001,3492,9003,3493,9001,3494,9003,3495,9001,3496,9003,
3497,9001,3498,9003,3499,9001,3500,9003,3501,9001,3502,9003,3503,9001,3504,9003,3505,9001,3506,9003,3507,9001,3508,9003,3509,9001,3510,9003,3511,9001,3512,9003,3513,9001,3514,9001,3515,9003,3516,9001,3517,9003,3518,9001,3519,9003,3520,9001,3521,9003,3522,9001,3523,9003,3524,9001,3525,9003,3526,9001,3527,9003,3528,9001,3529,9003,3530,9001,3531,9003,3532,9001,3533,9003,3534,9001,3535,9003,3536,9001,3537,9003,3538,9001,3539,9003,3540,9001,3541,9003,3542,9001,3543,9003,3544,9001,3545,9003,3546,9001,3547,
9003,3548,9001,3549,9003,3550,9001,3551,9003,3552,9001,3553,9003,3582,9003,3583,9001,3584,9003,3585,9001,3586,9003,3587,9001,3588,9002,3589,9001,3590,9002,3591,9001,3592,9001,3593,9002,3598,9003,3599,9001,3600,9003,3605,9002,3606,9001,3607,9001,3608,9003,3609,9001,3610,9003,3611,9001,3612,9003,3613,9001,3614,9003,3615,9001,3616,9003,3617,9001,3618,9003,3619,9001,3620,9003,3621,9001,3622,9003,3623,9001,3624,9003,3625,9001,3626,9003,3627,9001,3628,9003,3629,9001,3630,9003,3631,9001,3632,9003,3633,9001,
3634,9002,3635,9001,3636,9002,3640,9003,3641,9001,3642,9003,3643,9001,3644,9002,3645,9001,3646,9002,3647,9001,3648,9002,3649,9001,3650,9003,3651,9001,3652,9003,3653,9001,3654,9003,3655,9001,3656,9002,3657,9001,3658,9003,3659,9001,3660,9003,3661,9001,3662,9003,3663,9001,3664,9003,3668,9003,3669,9001,3670,9003,3671,9001,3672,9003,3673,9001,3674,9003,3675,9001,3676,9002,3677,9003,3678,9001,3679,9002,3680,9003,3681,9001,3682,9002,3683,9003,3684,9001,3685,9001,3686,9003,3687,9001,3688,9003,3689,9001,3690,
9003,3691,9001,3692,9003,3696,9003,3697,9001,3698,9003,3699,9001,3700,9003,3740,9001,3749,9001,3783,9001,3784,9001,3793,9001,3794,9001,3802,9001,3816,9001,3829,9001,3854,9001,3920,9001,3978,9001,3979,9001,3991,9003,3992,9003,4026,9001,4037,9001,4038,9001,4042,9102,4075,9102,4081,9102,4168,9102,4170,9102,4188,9102,4217,9003,4261,9105,4262,9102,4263,9102,4288,9102,4289,9102,4305,9105,4322,9102,4324,9102,4326,9102,4438,9003,4439,9003,4466,9102,4467,9001,4469,9102,4471,9001,4474,9001,4475,9102,4483,9102,
4490,9102,4555,9102,4558,9102,4559,9001,4614,9102,4619,9102,4657,9102,4670,9102,4671,9102,4674,9102,4682,9102,4683,9102,4718,9102,4720,9102,4721,9102,4723,9102,4726,9102,4737,9102,4738,9102,4759,9102,4761,9102,4807,9105,4808,9102,4809,9102,4816,9105,4817,9102,4818,9102,4819,9105,4820,9102,4821,9105,4823,9102,4824,9102,4839,9001,4901,9105,4902,9105,4903,9102,4904,9102,5018,9001,5048,9001,5167,9001,5168,9001,5223,9001,5228,9102,5229,9102,5233,9102,5234,9001,5235,9001,5243,9001,5252,9102,5264,9102,5266,
9001,5316,9001,5320,9001,5321,9001,5330,9001,5331,9001,5337,9001,5340,9102,5354,9102,5360,9102,5361,9001,5362,9001,5371,9102,5373,9102,5381,9102,5382,9001,5383,9001,5393,9102,5396,9001,5456,9001,5457,9001,5464,9102,5467,9102,5469,9001,5472,9037,5489,9102,5490,9001,5518,9001,5523,9001,5524,9102,5527,9102,5546,9102,5559,9001,5561,9102,5588,9002,5589,9005,5593,9102,5596,9001,5627,9001,5629,9001,5641,9001,5643,9001,5644,9001,5654,9003,5655,9003,5659,9001,5681,9102,5700,9001,5825,9001,5836,9001,5837,9001,
5842,9001,5844,9001,5880,9001,5886,9102,5887,9001,5890,9001,20499,9001,20538,9001,20539,9001,20790,9001,20791,9001,21291,9001,21292,9001,21500,9001,21817,9001,21818,9001,22032,9001,22033,9001,22091,9001,22092,9001,22332,9001,22391,9001,22392,9001,22700,9001,22770,9001,22780,9001,22832,9001,23090,9001,23095,9001,23239,9001,23240,9001,23433,9001,23700,9001,24047,9001,24048,9001,24100,9005,24200,9001,24305,9001,24306,9001,24382,9084,24383,9001,24500,9001,24547,9001,24548,9001,24571,9062,24600,9001,25E3,
9001,25231,9001,25884,9001,25932,9001,26237,9001,26331,9001,26332,9001,26591,9001,26592,9001,26632,9001,26692,9001,26855,9003,26856,9003,27120,9001,27200,9001,27291,9040,27292,9040,27429,9001,27492,9001,27500,9001,27700,9001,28232,9001,28600,9001,28991,9001,28992,9001,29100,9001,29220,9001,29221,9001,29333,9001,29635,9001,29636,9001,29701,9001,29738,9001,29739,9001,29849,9001,29850,9001,29871,9042,29872,9041,29873,9001,29900,9001,29901,9001,29903,9001,30200,9039,30339,9001,30340,9001,30591,9001,30592,
9001,30791,9001,30792,9001,31028,9001,31121,9001,31154,9001,31170,9001,31171,9001,31370,9001,31528,9001,31529,9001,31600,9001,31700,9001,31838,9001,31839,9001,31901,9001,32061,9001,32062,9001,32098,9001,32099,9003,32100,9001,32104,9001,32161,9001,32766,9001,37225,9105,37235,9102,37257,9102,37259,9102,37260,9102,53034,9001,53048,9001,53049,9001,54034,9001,65061,9003,65062,9003,65161,9001,65163,9001,102041,9003,102064,9085,102068,109030,102069,109031,102118,9003,102119,9002,102120,9003,102121,9003,
102217,9003,102218,9001,102219,9003,102220,9003,102378,9002,102379,9002,102380,9001,102381,9002,102589,9003,102599,9003,102600,9003,102604,9003,102605,9001,102606,9001,102647,9001,102704,9003,102705,9003,102733,9003,102761,9003,102762,9001,102763,9003,102764,9001,102765,9001,102766,9003,102970,9002,102974,9003,102993,9001,102994,9001,102995,9003,102996,9003,103015,9001,103016,9003,103017,9001,103018,9003,103025,9001,103026,9001,103027,9003,103028,9003,103035,9001,103036,9001,103037,9003,103038,9003,
103039,9001,103040,9001,103041,9003,103042,9003,103043,9001,103044,9001,103045,9003,103046,9003,103047,9001,103048,9001,103049,9003,103050,9003,103051,9001,103052,9003,103053,9001,103054,9003,103055,9001,103056,9003,103057,9001,103058,9001,103059,9003,103060,9003,103061,9001,103062,9001,103063,9003,103064,9003,103069,9003,103070,9001,103071,9001,103072,9003,103073,9003,103086,9001,103087,9001,103088,9003,103089,9003,103094,9002,103095,9001,103096,9003,103103,9001,103104,9003,103105,9001,103106,9003,
103121,9001,103122,9003,103123,9001,103124,9001,103125,9002,103126,9002,103127,9001,103128,9001,103129,9003,103130,9003,103131,9001,103132,9001,103133,9003,103134,9003,103135,9001,103136,9001,103137,9002,103138,9002,103139,9001,103140,9003,103141,9001,103142,9003,103143,9001,103144,9003,103145,9001,103146,9002,103147,9001,103148,9001,103149,9003,103150,9003,103151,9001,103152,9003,103172,9001,103173,9003,103174,9001,103175,9001,103176,9003,103177,9003,103178,9001,103179,9001,103180,9003,103181,9003,
103182,9001,103183,9001,103184,9003,103185,9003,103228,9001,103229,9001,103230,9003,103231,9003,103250,9001,103251,9003,103252,9001,103253,9003,103260,9001,103261,9001,103262,9003,103263,9003,103270,9001,103271,9001,103272,9003,103273,9003,103274,9001,103275,9001,103276,9003,103277,9003,103278,9001,103279,9001,103280,9003,103281,9003,103282,9001,103283,9001,103284,9003,103285,9003,103286,9001,103287,9003,103288,9001,103289,9003,103290,9001,103291,9003,103292,9001,103293,9001,103294,9003,103295,9003,
103296,9001,103297,9001,103298,9003,103299,9003,103376,9003,103377,9001,103378,9001,103379,9003,103380,9003,103393,9001,103394,9001,103395,9003,103396,9003,103472,9001,103473,9002,103474,9001,103475,9003,103482,9001,103483,9003,103484,9001,103485,9003,103500,9001,103501,9003,103502,9001,103503,9001,103504,9002,103505,9002,103506,9001,103507,9001,103508,9003,103509,9003,103510,9001,103511,9001,103512,9003,103513,9003,103514,9001,103515,9003,103516,9001,103517,9003,103518,9001,103519,9003,103520,9001,
103521,9002,103522,9001,103523,9001,103524,9003,103525,9003,103526,9001,103527,9003,103561,9003,103562,9003,103563,9001,103564,9001,103565,9003,103566,9003,103567,9001,103568,9001,103569,9003,103570,9003,103585,9003,103695,9003,104020,9102,104139,9105,104140,9105,104223,9102,104286,9102,104287,9102,104304,9102,104305,9102,104896,9102]},e=function(){function a(){}a.cC=function(b){!1===a.ti&&a.bo();var c=a.NG(b);if(-1==c){var e=a.ks(b);e!=b&&(c=a.cC(e))}return c};a.NG=function(b){return void 0!==a.ds[b]?
a.ds[b]:-1};a.SM=function(b){!1===a.ti&&a.bo();var c=a.Fz(b);if(1E38==c){var e=a.ks(b);e!=b&&(c=a.Fz(e));if(1E38==c)return 1E-10}return c};a.WO=function(b){if(void 0!==a.Un[b])return!0;var c=a.ks(b);return c!=b&&void 0!==a.Un[c]?!0:!1};a.ZO=function(b){if(void 0!==a.Gh[b])return!0;var c=a.ks(b);return c!=b&&void 0!==a.Gh[c]?!0:!1};a.Fz=function(b){!1===a.ti&&a.bo();return void 0!==a.Un[b]?a.Un[b]:void 0!==a.Gh[b]?a.Gh[b]:1E38};a.oU=function(b){!1===a.ti&&a.bo();return void 0!==a.ew[b]?a.ew[b]:b};
a.ks=function(b){!1===a.ti&&a.bo();return void 0!==a.Mw[b]?a.Mw[b]:b};a.bo=function(){for(var e=b,d,f=0;f<e.pcsid.length;f+=2)a.Gh[e.pcsid[f]]=e.pcstol[2*e.pcsid[f+1]+1];for(f=0;f<e.pcsidc.length;f+=1){d=e.pcsidc[f];for(var p=d[0];p<=d[1];p++)a.Gh[p]=e.pcstol[2*d[2]+1]}for(f=0;f<e.gcsid.length;f+=2)a.Un[e.gcsid[f]]=e.gcstol[2*e.gcsid[f+1]+1];for(f=0;f<e.gcsidc.length;f+=1)for(d=e.gcsidc[f],p=d[0];p<=d[1];p++)a.Gh[p]=e.gcstol[2*d[2]+1];for(f=0;f<c.c.length;f+=1)for(d=c.c[f],p=d[0];p<=d[1];p++)a.ds[p]=
d[2];for(f=0;f<c.nc.length;f+=2)a.ds[c.nc[f]]=c.nc[f+1];c=null;for(f=0;f<e.newtoold.length;f+=2)a.ew[e.newtoold[f+1]]=e.newtoold[f],a.Mw[e.newtoold[f]]=e.newtoold[f+1];b=null;a.ti=!0};a.ti=!1;a.Un=[];a.Gh=[];a.ew=[];a.Mw=[];a.ds=[];return a}();a.ls=e})(z||(z={}));(function(a){function b(a){return 0===a.length?'""':'"'==a[0]||"."==a[0]||"0"<=a[0]&&"9">=a[0]?a:'"'+a.trim()+'"'}var c=[],e=function(){function e(){}e.UM=function(d){try{for(var f=0;f<c.length;f++)if(c[f].wkttext===d)return c[f].unit;for(var p,
g=f="",A=!1,k=0;k<d.length;k++){var h=d[k];!0===A?'"'==h?'"'==d[k+1]?f+=h:A=!1:f+=h:/[\s]/.test(h)||(","==h?(g=""!==f?g+(b(f)+","):g+",",f=""):")"==h||"]"==h?(g=""!==f?g+(b(f)+"]}"):g+"]}",f=""):"("==h||"["==h?(g+='{ "entity": "'+f.toUpperCase().trim()+'", "values":[',f=""):'"'==h?(A=!0,f=""):f+=h)}p=JSON.parse(g);var n=e.Dz(p);if(null===n)return null;p=null;for(h=0;h<n.values.length;h++)if("object"===typeof n.values[h]&&"UNIT"===n.values[h].entity){p=n.values[h];break}if(null===p)return null;var E=
a.Tb.EL("GEOGCS"===n.entity?1:0,p.values[1],p.values[2]);c.push({wkttext:d,unit:E});10<c.length&&c.shift();return E}catch(ea){return null}};e.Dz=function(a){if(null===a)return null;if("GEOGCS"===a.entity||"PROJCS"===a.entity)return a;for(var b=[],c=0;c<a.values.length;c++)if("object"===typeof a.values[c]&&void 0!==a.values[c].entity){if("GEOGCS"===a.values[c].entity||"PROJCS"==a.values[c].entity)return a.values[c];b.push(a.values[c])}for(a=0;a<b.length;a++)if(c=e.Dz(b[a]),null!==c)return c;return null};
e.TM=function(a){var b=-1;if(null!=a&&0<a.length){var c,e;c=a.indexOf("PROJCS");if(0<=c){var d=0;c=a.lastIndexOf("UNIT");if(0<=c&&(c=a.indexOf(",",c+4),0<c&&(c++,e=a.indexOf("]",c+1),0<e)))try{d=parseFloat(a.substring(c,e))}catch(fa){d=0}0<d&&(b=.001/d)}else if(c=a.indexOf("GEOGCS"),0<=c){var f=0,d=0;c=a.indexOf("SPHEROID",c+6);if(0<c&&(c=a.indexOf(",",c+8),0<c)){c++;e=a.indexOf(",",c+1);if(0<e)try{f=parseFloat(a.substring(c,e))}catch(fa){f=0}if(0<f&&(c=a.indexOf("UNIT",e+1),0<=c&&(c=a.indexOf(",",
c+4),0<c&&(c++,e=a.indexOf("]",c+1),0<e))))try{d=parseFloat(a.substring(c,e))}catch(fa){d=0}}0<f&&0<d&&(b=.001/(f*d))}}return b};return e}();a.mA=e})(z||(z={}));(function(a){(function(a){a[a.NONE=0]="NONE";a[a.LINEAR=1]="LINEAR";a[a.ANGULAR=2]="ANGULAR"})(a.BH||(a.BH={}));(function(a){a[a.enumFloat=0]="enumFloat";a[a.enumDouble=1]="enumDouble";a[a.enumInt32=2]="enumInt32";a[a.enumInt64=3]="enumInt64";a[a.enumInt8=4]="enumInt8";a[a.enumInt16=5]="enumInt16"})(a.oI||(a.oI={}));(function(a){a[a.POSITION=
0]="POSITION";a[a.Z=1]="Z";a[a.M=2]="M";a[a.ID=3]="ID";a[a.NORMAL=4]="NORMAL";a[a.TEXTURE1D=5]="TEXTURE1D";a[a.TEXTURE2D=6]="TEXTURE2D";a[a.TEXTURE3D=7]="TEXTURE3D";a[a.ID2=8]="ID2";a[a.MAXSEMANTICS=10]="MAXSEMANTICS"})(a.xf||(a.xf={}));var b=function(){function b(a,c){this.er=this.le=null;this.up=this.Aa=0;this.Wg=this.Jf=null;this.tk=0;if(void 0!==c){this.Aa=c.Aa;this.up=c.up;this.Jf=c.Jf.slice(0);this.Wg=c.Wg.slice(0);this.tk=c.tk;this.er=[];for(c=a=0;c<this.Aa;c++)this.er[c]=a,a+=b.Wa(this.Jf[c]);
this.up=a;this.le=[];for(c=0;c<this.Aa;c++){a=b.Wa(this.Hd(c));for(var e=b.ue(this.Hd(c)),d=0;d<a;d++)this.le[this.er[c]+d]=e}}else this.up=this.Aa=0}b.prototype.Hd=function(b){if(0>b||b>this.Aa)throw a.g.N();return this.Jf[b]};b.prototype.zf=function(a){return this.Wg[a]};b.JN=function(a){return b.ac[a]};b.Qh=function(a){return b.Cc[a]};b.ye=function(a){return b.Bd[a]};b.Gh=function(a){return b.ye(b.Qh(a))*b.Wa(a)};b.Wa=function(a){return b.ob[a]};b.Wf=function(a){return 2>a};b.ti=function(a){return b.Wf(b.Qh(a))};
b.prototype.hasAttribute=function(a){return 0<=this.Wg[a]};b.prototype.WC=function(){return this.hasAttribute(1)};b.ue=function(a){return b.V[a]};b.prototype.XN=function(a){return this.er[a]};b.nD=function(a,c){return b.V[a]===c};b.$g=function(b){if(4==b)return 2;if(8==b)return 3;throw a.g.N();};b.prototype.lc=function(a){return this===a};b.prototype.jj=function(){for(var b=a.I.kg(this.Jf[0]),c=1;c<this.Aa;c++)b=a.I.kg(this.Jf[c],b);return b};b.prototype.fj=function(a){return this.er[a]};b.prototype.hc=
function(){return this.tk};b.prototype.Fd=function(a){return this.Jf[a]};b.V=[0,0,NaN,0,0,0,0,0,0];b.ac=[1,1,1,0,2,1,1,1,0];b.Cc=[1,1,1,2,0,0,0,0,2];b.Bd=[4,8,4,8,1,2];b.ob=[2,1,1,1,3,1,2,3,2];return b}();a.pa=b})(z||(z={}));(function(a){function b(a,b,e,d){var f=a.jd,p=a.e+b+1;1===e?d=5<=f[p]:2===e?d=5<f[p]||5==f[p]&&(d||0>p||void 0!==f[p+1]||f[p-1]&1):3===e?d=d||void 0!==f[p]||0>p:(d=!1,0!==e&&c("!Big.RM!"));if(1>p||!f[0])d?(a.e=-b,a.jd=[1]):a.jd=[a.e=0];else{f.length=p--;if(d)for(;9<++f[p];)f[p]=
0,p--||(++a.e,f.unshift(1));for(p=f.length;!f[--p];f.pop());}}function c(a){a=Error(a);a.name="BigError";throw a;}var e=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,d=function(){function a(b){if(b instanceof a)this.Dd=b.Dd,this.e=b.e,this.jd=b.jd.slice();else{var d,f,p;0===b&&0>1/b?b="-0":e.test(b+="")||c(NaN);this.Dd="-"==b.charAt(0)?(b=b.slice(1),-1):1;-1<(d=b.indexOf("."))&&(b=b.replace(".",""));0<(f=b.search(/e/i))?(0>d&&(d=f),d+=+b.slice(f+1),b=b.substring(0,f)):0>d&&(d=b.length);for(f=0;"0"==b.charAt(f);f++);
if(f==(p=b.length))this.jd=[this.e=0];else{for(;"0"==b.charAt(--p););this.e=d-f-1;this.jd=[];for(d=0;f<=p;this.jd[d++]=+b.charAt(f++));}}}a.prototype.abs=function(){var b=new a(this);b.Dd=1;return b};a.prototype.DB=function(){var b=0,c=this.jd,e=(b=new a(b)).jd,d=this.Dd,f=b.Dd,p=this.e,g=b.e;if(!c[0]||!e[0])return c[0]?d:e[0]?-f:0;if(d!=f)return d;b=0>d;if(p!=g)return p>(g^b)?1:-1;d=-1;for(f=(p=c.length)<(g=e.length)?p:g;++d<f;)if(c[d]!=e[d])return c[d]>(e[d]^b)?1:-1;return p==g?0:p>(g^b)?1:-1};
a.prototype.VB=function(e){var d=this.jd,f=(e=new a(e)).jd,p=this.Dd==e.Dd?1:-1,g=a.Cc;(g!==~~g||0>g||1E6<g)&&c("!Big.DP!");if(!d[0]||!f[0])return d[0]==f[0]&&c(NaN),f[0]||c(p/0),new a(0*p);var A,k,h,n,E=f.slice(),q=A=f.length,K=d.length,l=d.slice(0,A),r=l.length,t=e,u=t.jd=[],H=0,w=g+(t.e=this.e-e.e)+1;t.Dd=p;p=0>w?0:w;for(E.unshift(0);r++<A;l.push(0));do{for(k=0;10>k;k++){if(A!=(r=l.length))h=A>r?1:-1;else for(n=-1,h=0;++n<A;)if(f[n]!=l[n]){h=f[n]>l[n]?1:-1;break}if(0>h){for(e=r==A?f:E;r;){if(l[--r]<
e[r]){for(n=r;n&&!l[--n];l[n]=9);--l[n];l[r]+=10}l[r]-=e[r]}for(;!l[0];l.shift());}else break}u[H++]=h?k:++k;l[0]&&h?l[r]=d[q]||0:l=[d[q]]}while((q++<K||void 0!==l[0])&&p--);u[0]||1==H||(u.shift(),t.e--);H>w&&b(t,g,a.ye,void 0!==l[0]);return t};a.prototype.nO=function(){return 0<this.DB()};a.prototype.vP=function(){return 0>this.DB()};a.prototype.nr=function(b){var c,e,d=this.Dd,f=(b=new a(b)).Dd;if(d!=f)return b.Dd=-f,this.NE(b);var p=this.jd.slice();e=this.e;var g=b.jd,A=b.e;if(!p[0]||!g[0])return g[0]?
(b.Dd=-f,b):new a(p[0]?this:0);if(d=e-A){(c=0>d)?(d=-d,e=p):(A=e,e=g);e.reverse();for(f=d;f--;e.push(0));e.reverse()}else for(e=((c=p.length<g.length)?p:g).length,d=f=0;f<e;f++)if(p[f]!=g[f]){c=p[f]<g[f];break}c&&(e=p,p=g,g=e,b.Dd=-b.Dd);if(0<(f=(e=g.length)-(c=p.length)))for(;f--;p[c++]=0);for(f=c;e>d;){if(p[--e]<g[e]){for(c=e;c&&!p[--c];p[c]=9);--p[c];p[e]+=10}p[e]-=g[e]}for(;0==p[--f];p.pop());for(;0==p[0];)p.shift(),--A;p[0]||(b.Dd=1,p=[A=0]);b.jd=p;b.e=A;return b};a.prototype.NE=function(b){var c,
e=this.Dd;c=(b=new a(b)).Dd;if(e!=c)return b.Dd=-c,this.nr(b);c=this.e;var d=this.jd,f=b.e,p=b.jd;if(!d[0]||!p[0])return p[0]?b:new a(d[0]?this:0*e);d=d.slice();if(e=c-f){0<e?(f=c,c=p):(e=-e,c=d);for(c.reverse();e--;c.push(0));c.reverse()}0>d.length-p.length&&(c=p,p=d,d=c);e=p.length;for(c=0;e;)c=(d[--e]=d[e]+p[e]+c)/10|0,d[e]%=10;c&&(d.unshift(c),++f);for(e=d.length;0==d[--e];d.pop());b.jd=d;b.e=f;return b};a.prototype.pow=function(b){var e=this,d=new a(1),f=d,p=0>b;(b!==~~b||-1E6>b||1E6<b)&&c("!pow!");
for(b=p?-b:b;;){b&1&&(f=f.Wp(e));b>>=1;if(!b)break;e=e.Wp(e)}return p?d.VB(f):f};a.prototype.round=function(e,d){var f=this;null==e?e=0:(e!==~~e||0>e||1E6<e)&&c("!round!");b(f=new a(f),e,null==d?a.ye:d);return f};a.prototype.sqrt=function(){var e,d,f;d=this.jd;e=this.Dd;f=this.e;var p=new a("0.5");if(!d[0])return new a(this);0>e&&c(NaN);e=Math.sqrt(this.toString());0==e||e==1/0?(e=d.join(""),e.length+f&1||(e+="0"),d=new a(Math.sqrt(e).toString()),d.e=((f+1)/2|0)-(0>f||f&1)):d=new a(e.toString());
e=d.e+(a.Cc+=4);do f=d,d=p.Wp(f.NE(this.VB(f)));while(f.jd.slice(0,e).join("")!==d.jd.slice(0,e).join(""));b(d,a.Cc-=4,a.ye);return d};a.prototype.Wp=function(b){var c,e=this.jd,d=(b=new a(b)).jd,f=e.length,p=d.length,g=this.e,A=b.e;b.Dd=this.Dd==b.Dd?1:-1;if(!e[0]||!d[0])return new a(0*b.Dd);b.e=g+A;f<p&&(c=e,e=d,d=c,A=f,f=p,p=A);for(c=Array(A=f+p);A--;c[A]=0);for(g=p;g--;){p=0;for(A=f+g;A>g;)p=c[A]+d[g]*e[A-g-1]+p,c[A--]=p%10,p=p/10|0;c[A]=(c[A]+p)%10}p&&++b.e;c[0]||c.shift();for(g=c.length;!c[--g];c.pop());
b.jd=c;return b};a.prototype.toString=function(){var a=this.e,b=this.jd.join(""),c=b.length;if(-7>=a||21<=a)b=b.charAt(0)+(1<c?"."+b.slice(1):"")+(0>a?"e":"e+")+a;else if(0>a){for(;++a;b="0"+b);b="0."+b}else if(0<a)if(++a>c)for(a-=c;a--;b+="0");else a<c&&(b=b.slice(0,a)+"."+b.slice(a));else 1<c&&(b=b.charAt(0)+"."+b.slice(1));return 0>this.Dd&&this.jd[0]?"-"+b:b};a.Cc=20;a.ye=1;return a}();a.Tn=d})(z||(z={}));(function(a){var b=function(){function b(a){this.$e=a}b.prototype.Zp=function(b,c,e){var d=
new a.b,f=new a.b,p=this.$e;e.xd(b,c,function(a,b){p.ec(2*a,d);p.ec(2*b,f);return d.compare(f)})};b.prototype.Mo=function(a){return this.$e.read(2*a+1)};return b}(),c=function(){function c(){}c.No=function(b){if(b.s())return!1;var e=b.D();return 1736==e?0==b.Mh()?!1:!0:1607==e?(e=[!1],c.qz(b,!0,e),e[0]):197==e||a.T.Lc(e)&&!b.kD()?!0:!1};c.il=function(b){var e=b.D();if(1736==e)return e=new a.Xa(b.description),b.s()||b.tA(e),e;if(1607==e)return c.qz(b,!1,null);if(197==e)return e=new a.Xa(b.description),
b.s()||e.Wc(b,!1),e;if(a.T.Lc(e)){e=new a.pe(b.description);if(!b.s()&&!b.kD()){var d=new a.Va;b.En(d);e.add(d);b.Bn(d);e.add(d)}return e}if(a.T.Km(e))return null;throw a.g.N();};c.qz=function(c,e,d){null!=d&&(d[0]=!1);var f=null;e||(f=new a.pe(c.description));if(!c.s()){var p=new a.ga(0);p.xb(2*c.ea());for(var g=0,A=c.ea();g<A;g++)if(0<c.Ha(g)&&!c.Oo(g)){var k=c.Ea(g);p.add(k);k=c.Dc(g)-1;p.add(k)}if(0<p.size){A=new a.Rr;g=c.mc(0);A.sort(p,0,p.size,new b(g));A=new a.b;g.ec(2*p.get(0),A);for(var k=
0,h=1,n=new a.Va,E=new a.b,q=1,K=p.size;q<K;q++)if(g.ec(2*p.get(q),E),E.ub(A))p.get(k)>p.get(q)?(p.set(k,2147483647),k=q):p.set(q,2147483647),h++;else{if(0==(h&1))p.set(k,2147483647);else if(e)return null!=d&&(d[0]=!0),null;A.J(E);k=q;h=1}if(0==(h&1))p.set(k,2147483647);else if(e)return null!=d&&(d[0]=!0),null;if(!e)for(p.xd(0,p.size,function(a,b){return a-b}),q=0,K=p.size;q<K&&2147483647!=p.get(q);q++)c.Sd(p.get(q),n),f.add(n)}}return e?null:f};return c}();a.Hh=c})(z||(z={}));(function(a){var b=
function(){function b(){this.lf=new a.ga(0);this.Lq=new a.ga(0);this.gE=1;this.Qq=NaN}b.prototype.sort=function(a,b,c,e){if(32>c-b)e.Zp(b,c,a);else{var d=!0;try{for(var f=Infinity,p=-Infinity,g=b;g<c;g++){var A=e.Mo(a.get(g));A<f&&(f=A);A>p&&(p=A)}if(this.reset(c-b,f,p,c-b)){for(g=b;g<c;g++){var k=a.get(g),A=e.Mo(k),h=this.oC(A);this.lf.set(h,this.lf.get(h)+1);this.Lq.write(g-b,k)}var n=this.lf.get(0);this.lf.set(0,0);for(var g=1,E=this.lf.size;g<E;g++){var q=this.lf.get(g);this.lf.set(g,n);n+=q}for(g=
b;g<c;g++){var k=this.Lq.read(g-b),A=e.Mo(k),h=this.oC(A),K=this.lf.get(h);a.set(K+b,k);this.lf.set(h,K+1)}d=!1}}catch(ua){this.lf.resize(0),this.Lq.resize(0)}if(d)e.Zp(b,c,a);else{g=c=0;for(E=this.lf.size;g<E;g++)d=c,c=this.lf.get(g),c>d&&e.Zp(b+d,b+c,a);100<this.lf.size&&(this.lf.resize(0),this.Lq.resize(0))}}};b.prototype.reset=function(a,c,e,d){if(2>a||e==c)return!1;a=Math.min(b.tI,a);this.lf.xb(a);this.lf.resize(a);this.lf.dh(0,0,this.lf.size);this.gE=c;this.Lq.resize(d);this.Qq=(e-c)/(a-1);
return!0};b.prototype.oC=function(b){return a.I.truncate((b-this.gE)/this.Qq)};b.tI=65536;return b}();a.Rr=b})(z||(z={}));(function(a){var b;(function(a){a[a.enum_line=1]="enum_line";a[a.enum_arc=2]="enum_arc";a[a.enum_dummy=4]="enum_dummy";a[a.enum_concave_dip=8]="enum_concave_dip";a[a.enum_connection=3]="enum_connection"})(b||(b={}));var c=function(){function b(){}b.Ks=function(c,e,d,f,p,g){var A=new b;A.Fl=new a.b;A.Ql=new a.b;A.Lt=new a.b;A.Fl.J(c);A.Ql.J(e);A.Lt.J(d);A.qn=f;A.Rg=p;A.Ug=g;return A};
b.Oa=function(c,e,d,f){var p=new b;p.Fl=new a.b;p.Ql=new a.b;p.Lt=new a.b;p.Fl.J(c);p.Ql.J(e);p.Lt.Eh();p.qn=4;p.Rg=d;p.Ug=f;return p};return b}(),e=function(){function b(a,b,c,e,d,f){this.It=null;this.ua=0;this.Ex=a;this.yE=this.wE=0;this.Da=b;this.Pi=c;this.Cj=e;this.mp=d;this.Yb=f}b.prototype.next=function(){for(var b=new a.Va;;){if(this.ua==this.Ex.F())return null;this.Ex.Sd(this.ua,b);this.ua++;if(!b.s())break}var c=!1;null==this.It&&(this.wE=b.lk(),this.yE=b.mk(),this.It=g.buffer(b,this.Da,
this.Pi,this.Cj,this.mp,this.Yb),c=!0);var e;this.ua<this.Ex.F()?(e=new a.Ka,this.It.copyTo(e)):e=this.It;if(!c){var c=new a.Bg,d=b.lk()-this.wE,b=b.mk()-this.yE;c.Nn(d,b);e.Oe(c)}return e};b.prototype.ya=function(){return 0};return b}(),d=function(){function b(a,b){this.Ma=a;this.ua=0;this.Yo=b}b.prototype.next=function(){var b=this.Ma.U;if(this.ua<b.ea()){var c=this.ua;this.ua++;if(!b.Oo(c))for(var e=b.Fa(b.Dc(c)-1);this.ua<b.ea();){var d=b.Fa(b.Ea(this.ua));if(b.Oo(this.ua))break;if(d!=e)break;
e=b.Fa(b.Dc(this.ua)-1);this.ua++}if(1==this.ua-c)return this.Ma.kB(this.Ma.U,c,this.Yo);e=new a.Xa(this.Ma.U.description);e.Zj(this.Ma.U,c,!0);for(c+=1;c<this.ua;c++)e.ys(this.Ma.U,c,0,b.ct(c),!1);return this.Ma.kB(e,0,this.Yo)}return null};b.prototype.ya=function(){return 0};return b}(),f=function(){function a(a){this.Ma=a;this.ua=0}a.prototype.next=function(){var a=this.Ma.U;if(this.ua<a.ea()){var b=this.ua;a.oo(this.ua);for(this.ua++;this.ua<a.ea()&&!(0<a.oo(this.ua));)this.ua++;return 0==b&&
this.ua==a.ea()?this.Ma.Gv(a,0,a.ea()):this.Ma.Gv(a,b,this.ua)}return null};a.prototype.ya=function(){return 0};return a}(),g=function(){function b(a){this.Vq=this.Tt=this.Wq=this.sd=null;this.Jd=[];this.Yb=a;this.hb=this.wt=this.OP=this.Da=this.vx=this.jr=this.ka=0;this.sx=this.Cj=-1;this.Yo=!0}b.buffer=function(c,e,d,f,p,g){if(null==c)throw a.g.N();if(0>f)throw a.g.N();if(c.s())return new a.Ka(c.description);var A=new a.i;c.dd(A);0<e&&A.P(e,e);g=new b(g);g.Pi=d;g.U=c;g.ka=a.Ia.zd(d,A,!0);g.jr=a.Ia.zd(null,
A,!0);g.Da=e;g.OP=c.D();0>=p&&(p=96);g.hb=Math.abs(g.Da);g.wt=0!=g.hb?1/g.hb:0;isNaN(f)||0==f?f=1E-5*g.hb:f>.5*g.hb&&(f=.5*g.hb);12>p&&(p=12);c=Math.abs(e)*(1-Math.cos(Math.PI/p));c>f?f=c:(c=Math.PI/Math.acos(1-f/Math.abs(e)),c<p-1&&(p=a.I.truncate(c),12>p&&(p=12,f=Math.abs(e)*(1-Math.cos(Math.PI/p)))));g.Cj=f;g.mp=p;g.vx=Math.min(g.jr,.25*f);return g.lB()};b.prototype.Ss=function(){if(null==this.sd)this.sd=[];else if(0!==this.sd.length)return;var b=this.pB(),b=a.I.truncate((b+3)/4),c=.5*Math.PI/
b;this.sx=c;for(var e=0;e<4*b;e++)this.sd.push(null);for(var d=Math.cos(c),c=Math.sin(c),f=a.b.Oa(0,1),e=0;e<b;e++)this.sd[e+0*b]=a.b.Oa(f.y,-f.x),this.sd[e+1*b]=a.b.Oa(-f.x,-f.y),this.sd[e+2*b]=a.b.Oa(-f.y,f.x),this.sd[e+3*b]=f,f=a.b.Oa(f.x,f.y),f.Er(d,c)};b.prototype.lB=function(){var b=this.U.D();if(a.T.Lc(b))return b=new a.Xa(this.U.description),b.Bc(this.U,!0),this.U=b,this.lB();if(this.Da<=this.ka)if(a.T.SO(b)){if(0>=this.Da&&(b=new a.i,this.U.o(b),b.aa()<=2*-this.Da||b.ba()<=2*this.Da))return new a.Ka(this.U.description)}else return new a.Ka(this.U.description);
switch(this.U.D()){case 33:return this.tK();case 550:return this.sK();case 1607:return this.vK();case 1736:return this.uK();case 197:return this.qK();default:throw a.g.wa();}};b.prototype.vK=function(){if(this.oD(this.U)){var b=new a.Va;this.U.Sd(0,b);var c=new a.i;this.U.o(c);b.ic(c.Af());return this.Es(b)}this.U=this.SQ(this.U);b=new d(this,this.Yo);return a.wi.local().$(b,this.Pi,this.Yb).next()};b.prototype.uK=function(){if(0==this.Da)return this.U;var b=a.as.local();this.Ss();this.U=b.$(this.U,
null,!1,this.Yb);if(0>this.Da){var c=this.U,c=this.Gv(c,0,c.ea());return b.$(c,this.Pi,!1,this.Yb)}if(this.oD(this.U))return b=new a.Va,this.U.Sd(0,b),c=new a.i,this.U.o(c),b.ic(c.Af()),this.Es(b);b=new f(this);return a.wi.local().$(b,this.Pi,this.Yb).next()};b.prototype.Gv=function(c,e,d){for(var f=new a.Ka(c.description);e<d;e++)if(!(1>c.Ha(e))){var p=c.oo(e),g=new a.i;c.Ti(e,g);if(0<this.Da)if(0<p)if(this.pD(c,e))p=new a.Va,c.Sd(c.Ea(e),p),p.ic(g.Af()),this.us(f,p);else{var A=p=new a.Xa(c.description),
A=a.Tr.sD(this.U,e)||2==this.sm(this.U,e,A,!0,1)?this.jB(c,e):this.rm(p);f.add(A,!1)}else{if(!(g.aa()+this.ka<=2*this.hb||g.ba()+this.ka<=2*this.hb||(A=p=new a.Xa(c.description),this.sm(this.U,e,A,!0,1),p.s()))){var k=new a.i;k.K(g);k.P(this.hb,this.hb);A.ws(k);A=this.rm(p);g=1;for(p=A.ea();g<p;g++)f.Zj(A,g,!0)}}else if(0<p){if(!(g.aa()+this.ka<=2*this.hb||g.ba()+this.ka<=2*this.hb||(A=p=new a.Xa(c.description),this.sm(this.U,e,A,!0,-1),p.s())))for(k=new a.i,A.dd(k),k.P(this.hb,this.hb),A.ws(k),A=
this.rm(p),g=1,p=A.ea();g<p;g++)f.Zj(A,g,!0)}else for(A=p=new a.Xa(c.description),this.sm(this.U,e,A,!0,-1),A=this.rm(p),g=0,p=A.ea();g<p;g++)f.Zj(A,g,!0)}if(0<this.Da)return 1<f.ea()?f=this.rm(f):b.Id(f);c=new a.i;f.dd(c);if(f.s())return b.Id(f);c.P(this.hb,this.hb);f.ws(c);f=this.rm(f);c=new a.Ka(f.description);g=1;for(p=f.ea();g<p;g++)c.Zj(f,g,!1);return b.Id(c)};b.prototype.tK=function(){return this.Es(this.U)};b.prototype.Es=function(b){var c=new a.Ka(this.U.description);this.us(c,b);return this.nS(c)};
b.prototype.sK=function(){var b=new e(this.U,this.Da,this.Pi,this.Cj,this.mp,this.Yb);return a.wi.local().$(b,this.Pi,this.Yb).next()};b.prototype.qK=function(){var b=new a.Ka(this.U.description);if(0>=this.Da){if(0==this.Da)b.Wc(this.U,!1);else{var c=new a.Vj;this.U.Fp(c);c.P(this.Da,this.Da);b.Wc(c,!1)}return b}b.Wc(this.U,!1);this.U=b;return this.jB(b,0)};b.prototype.jB=function(c,e){this.Ss();var d=new a.Ka(c.description),f=new a.b,p=new a.b,g=new a.b,A=new a.b,k=new a.b,h=new a.b,n=new a.b,q=
new a.b,E=c.Ha(e),K=c.Ea(e),l=0;for(e=c.Ha(e);l<e;l++){c.w(K+l,p);c.w(K+(l+1)%E,A);c.w(K+(l+2)%E,h);n.pc(A,p);if(0==n.length())throw a.g.wa();n.tt();n.normalize();n.scale(this.hb);f.add(n,p);g.add(n,A);0==l?d.Nr(f):d.Lm(f);d.Lm(g);q.pc(h,A);if(0==q.length())throw a.g.wa();q.tt();q.normalize();q.scale(this.hb);k.add(q,A);this.NA(d,A,g,k,!1)}return b.Id(d)};b.prototype.kB=function(b,c,e){this.Ss();if(1>b.Ha(c))return null;if(this.pD(b,c)&&0<this.Da){e=new a.Va;b.Sd(b.Ea(c),e);var d=new a.i;b.Ti(c,d);
e.ic(d.Af());return this.Es(e)}d=new a.Xa(b.description);if(b.Oo(c))this.sm(b,c,d,e,1),this.sm(b,c,d,e,-1);else{var f=new a.Xa(b.description);f.Zj(b,c,!1);f.ys(b,c,0,b.ct(c),!1);this.sm(f,0,d,e,1)}return this.rm(d)};b.prototype.rm=function(b){return a.Of.Qj(b,this.jr,!0,!0,this.Yb)};b.prototype.pB=function(){if(0==this.Cj)return this.mp;var b=1-this.Cj*Math.abs(this.wt),c;-1>b?c=4:c=2*Math.PI/Math.acos(b)+.5;4>c?c=4:c>this.mp&&(c=this.mp);return a.I.truncate(c)};b.prototype.NA=function(b,c,e,d,f){this.Ss();
var p=new a.b;p.pc(e,c);p.scale(this.wt);var g=new a.b;g.pc(d,c);g.scale(this.wt);p=Math.atan2(p.y,p.x)/this.sx;0>p&&(p=this.sd.length+p);p=this.sd.length-p;g=Math.atan2(g.y,g.x)/this.sx;0>g&&(g=this.sd.length+g);g=this.sd.length-g;g<p&&(g+=this.sd.length);var A=a.I.truncate(g),g=a.I.truncate(Math.ceil(p)),p=new a.b;p.J(this.sd[g%this.sd.length]);p.Fr(this.hb,c);var k=10*this.ka;p.sub(e);p.length()<k&&(g+=1);p.J(this.sd[A%this.sd.length]);p.Fr(this.hb,c);p.sub(d);p.length()<k&&--A;e=A-g;e++;A=0;for(g%=
this.sd.length;A<e;A++,g=(g+1)%this.sd.length)p.J(this.sd[g]),p.Fr(this.hb,c),b.Lm(p);f&&b.Lm(d)};b.prototype.sm=function(b,e,d,f,p){var g=new a.fd,A=g.QJ(b,e);g.xo(this.vx,!1,!1);if(2>g.F(A)){if(0>p)return 1;p=b;g=new a.Va;p.Sd(p.Ea(e),g);this.us(d,g);return 1}var k=g.Fa(g.Cb(g.Vb(A))),h=new a.Bg;h.Nn(-k.x,-k.y);g.Oe(h);if(f&&(this.MM(g,A,p),2>g.F(A))){if(0>p)return 1;p=b;g=new a.Va;p.Sd(p.Ea(e),g);this.us(d,g);return 1}this.Jd.length=0;var n=g.Vb(A);e=g.Cb(n);var q=1==p?g.Ua(e):g.X(e);b=1==p?g.X(e):
g.Ua(e);var E=!0;f=new a.b;for(var A=new a.b,K=new a.b,l=new a.b,r=new a.b,t=new a.b,U=new a.b,u=new a.b,w=new a.b,H=new a.b,v=this.hb,n=g.Ha(n),V=0;V<n;V++)g.w(b,A),E&&(g.w(e,f),g.w(q,K),u.pc(f,K),u.normalize(),H.zD(u),H.scale(v),l.add(H,f)),U.pc(A,f),U.normalize(),w.zD(U),w.scale(v),r.add(f,w),q=u.Ai(U),E=u.ml(U),0>q||0>E&&0==q?this.Jd.push(c.Ks(l,r,f,2,this.Jd.length+1,this.Jd.length-1)):l.ub(r)||(this.Jd.push(c.Oa(l,f,this.Jd.length+1,this.Jd.length-1,"dummy")),this.Jd.push(c.Oa(f,r,this.Jd.length+
1,this.Jd.length-1,"dummy"))),t.add(A,w),this.Jd.push(c.Ks(r,t,f,1,this.Jd.length+1,this.Jd.length-1)),l.J(t),H.J(w),K.J(f),f.J(A),u.J(U),q=e,e=b,E=!1,b=1==p?g.X(e):g.Ua(e);this.Jd[this.Jd.length-1].Rg=0;this.Jd[0].Ug=this.Jd.length-1;this.UQ(d);h.Nn(k.x,k.y);d.ZA(h,d.ea()-1);return 1};b.prototype.UQ=function(a){for(var b=this.aL(),c=!0,e=b+1,d=b;e!=b;d=e){var f=this.Jd[d],e=-1!=f.Rg?f.Rg:(d+1)%this.Jd.length;0!=f.qn&&(c&&a.Nr(f.Fl),2==f.qn?this.NA(a,f.Lt,f.Fl,f.Ql,!0):a.Lm(f.Ql),c=!1)}};b.prototype.aL=
function(){null==this.Vq&&(this.Vq=[null,null,null,null,null,null,null,null,null]);for(var b=0,c=0,e=this.Jd.length;c<e;){var d=this.Jd[c];if(0!=(d.qn&3)){b=c;break}c=d.Rg}e=b+1;for(c=b;e!=b;c=e){for(var d=this.Jd[c],e=d.Rg,f=1,p=null;e!=c;){p=this.Jd[e];if(0!=(p.qn&3))break;e=p.Rg;f++}1!=f&&1==(d.qn&p.qn)&&(null==this.Wq&&(this.Wq=new a.yb,this.Tt=new a.yb),this.Wq.ed(d.Fl),this.Wq.vd(d.Ql),this.Tt.ed(p.Fl),this.Tt.vd(p.Ql),1==this.Wq.Ga(this.Tt,this.Vq,null,null,this.jr)&&(d.Ql.J(this.Vq[0]),p.Fl.J(this.Vq[0]),
d.Rg=e,p.Ug=c))}return b};b.prototype.rt=function(b,c,e){var d=new a.b;d.pc(e,b);e=d.length();e=this.hb*this.hb-e*e*.25;if(0<e){e=Math.sqrt(e);d.normalize();d.Kp();var f=new a.b;f.pc(c,b);if(f.ml(d)+e>=this.hb)return!0}return!1};b.prototype.MM=function(b,c,e){for(var d=0;1>d;d++){var f=!1,p=b.Vb(c),g=b.Ha(p);if(0==g)break;var A=g;if(3>g)break;!b.vc(p)&&(A=g-1);for(var p=b.Cb(p),g=0<e?b.Ua(p):b.X(p),k=0<e?b.X(p):b.Ua(p),h=g,n=!0,q=new a.b,E=new a.b,K=new a.b,l=new a.b,r=new a.b,t=a.b.Oa(0,0),U=new a.b,
u=new a.b,w=new a.b,H=new a.b,v=this.hb,V=0,x=0;x<A;){b.w(k,E);n&&(b.w(p,q),b.w(g,K),h=g);u.pc(q,K);u.normalize();U.pc(E,q);U.normalize();if(h==k)break;var m=u.Ai(U),X=u.ml(U),y=!0;0>m||0>X&&0==m||!this.rt(K,q,E)||(t.J(E),y=!1,++V,f=!0);if(y){if(0<V)for(;;){m=0<e?b.Ua(h):b.X(h);if(m==p)break;b.w(m,l);if(this.rt(l,K,t))K.J(l),h=m,y=!1,++V;else{m!=k&&this.rt(l,K,E)&&this.rt(l,q,E)&&(K.J(l),h=m,y=!1,++V);break}}if(!y)continue;if(0<V){h=0<e?b.Ua(g):b.X(g);for(n=1;n<V;n++)y=0<e?b.Ua(h):b.X(h),b.vf(h,!0),
h=y;w.pc(q,K);V=w.length();V=v*v-V*V*.25;V=Math.sqrt(V);v-V>.5*this.Cj?(r.add(K,q),r.scale(.5),w.normalize(),w.Kp(),H.J(w),H.scale(v-V),r.add(H),b.Yi(g,r)):b.vf(g,!0);V=0}K.J(q);h=p}q.J(E);g=p;p=k;k=0<e?b.X(p):b.Ua(p);x++;n=!1}if(0<V){h=0<e?b.Ua(g):b.X(g);for(n=1;n<V;n++)y=0<e?b.Ua(h):b.X(h),b.vf(h,!0),h=y;r.add(K,q);r.scale(.5);w.pc(q,K);V=w.length();V=v*v-V*V*.25;V=Math.sqrt(V);w.normalize();w.Kp();H.J(w);H.scale(v-V);r.add(H);b.Yi(g,r)}b.xo(this.vx,!1,!1);if(!f)break}};b.prototype.pD=function(b,
c){if(1==b.Ha(c))return!0;var e=new a.i;b.Ti(c,e);return Math.max(e.aa(),e.ba())<.5*this.Cj?!0:!1};b.prototype.oD=function(b){var c=new a.i;b.o(c);return Math.max(c.aa(),c.ba())<.5*this.Cj?!0:!1};b.prototype.SQ=function(b){b=a.Sz.local().$(b,.25*this.Cj,!1,this.Yb);for(var c=0,e=0,d=b.ea();e<d;e++)c=Math.max(b.Ha(e),c);if(32>c)return this.Yo=!1,b;this.Yo=!0;return a.Of.Qj(b,this.jr,!1,!0,this.Yb)};b.prototype.us=function(b,c){c=c.w();if(null!=this.sd&&0!==this.sd.length){var e=new a.b;e.J(this.sd[0]);
e.Fr(this.hb,c);b.Nr(e);for(var d=1,f=this.sd.length;d<f;d++)e.J(this.sd[d]),e.Fr(this.hb,c),b.Lm(e)}else for(var d=this.pB(),e=a.I.truncate((d+3)/4),d=.5*Math.PI/e,f=Math.cos(d),p=Math.sin(d),g=new a.b,A=3;0<=A;A--)switch(g.ma(0,this.hb),A){case 0:for(d=0;d<e;d++)b.wj(g.x+c.x,g.y+c.y),g.Er(f,p);break;case 1:for(d=0;d<e;d++)b.wj(-g.y+c.x,g.x+c.y),g.Er(f,p);break;case 2:for(d=0;d<e;d++)b.wj(-g.x+c.x,-g.y+c.y),g.Er(f,p);break;default:for(b.Uy(g.y+c.x,-g.x+c.y),d=1;d<e;d++)g.Er(f,p),b.wj(g.y+c.x,-g.x+
c.y)}};b.Id=function(a){a.hg(1,0);return a};b.prototype.nS=function(a){a.hg(2,this.ka);a.hl();return a};return b}();a.UG=g})(z||(z={}));(function(a){var b=function(){function b(b){this.Qb=b;this.a=new a.fd;this.vg=new a.ga(0)}b.prototype.po=function(a,b,c){switch(b){case 0:if(a.v<c&&a.B<=c)break;else return a.v>=c?1:-1;case 1:if(a.C<c&&a.G<=c)break;else return a.C>=c?1:-1;case 2:if(a.v>=c&&a.B>c)break;else return a.B<=c?1:-1;case 3:if(!(a.C>=c&&a.G>c))return a.G<=c?1:-1}return 0};b.prototype.cL=function(a,
b){return 1736==a.D()?this.dL(a,b):this.eL(a)};b.prototype.dL=function(b,c){if(0==this.Qb.aa()||0==this.Qb.ba())return b.Pa();var e=new a.i;b.dd(e);this.U=this.a.Eb(b);var d=new a.i,f=new a.i,p=new a.b,g=new a.b,k=[0,0,0,0,0,0,0,0,0],h=[0,0,0,0,0,0,0,0,0];new a.Ag;var n=new a.yb,q=new a.ga(0);q.xb(Math.min(100,b.F()));for(var E=!1,l=0;!E&&4>l;l++){var r=!1,t=0!=(l&1),u=0;switch(l){case 0:u=this.Qb.v;r=e.v<=u&&e.B>=u;break;case 1:u=this.Qb.C;r=e.C<=u&&e.G>=u;break;case 2:u=this.Qb.B;r=e.v<=u&&e.B>=
u;break;case 3:u=this.Qb.G,r=e.C<=u&&e.G>=u}if(r)for(E=!0,r=this.a.Vb(this.U);-1!=r;){var w=-1,v=-1,H=this.a.Cb(r),x=H;do{var m=this.a.cc(x);null==m&&(m=n,this.a.w(x,p),m.ed(p),this.a.w(this.a.X(x),g),m.vd(g));m.o(d);var y=this.po(d,l,u),z=0,C=-1;if(-1==y){m=m.nt(t,u,k,h);0<m?z=this.a.Mr(x,h,m):z=0;for(var z=z+1,B=x,W=this.a.X(B),m=0;m<z;m++){this.a.w(B,p);this.a.w(W,g);C=this.a.cc(B);null==C&&(C=n,C.ed(p),C.vd(g));C.o(f);C=this.po(f,l,u);if(-1==C){if(t)C=Math.abs(p.y-u),F=Math.abs(g.y-u),C<F?(p.y=
u,this.a.Yi(B,p)):(g.y=u,this.a.Yi(W,g));else{var C=Math.abs(p.x-u),F=Math.abs(g.x-u);C<F?(p.x=u,this.a.Yi(B,p)):(g.x=u,this.a.Yi(W,g))}C=this.a.cc(B);null==C&&(C=n,C.ed(p),C.vd(g));C.o(f);C=this.po(f,l,u)}F=w;w=C;-1==v&&(v=w);if(0!=F||1!=w)1==F&&0==w||0!=F||0!=w||q.add(B);1==w&&(E=!1);C=B=W;W=this.a.X(W)}}if(0==z){F=w;w=y;-1==v&&(v=w);if(0!=F||1!=w)1==F&&0==w||0!=F||0!=w||q.add(x);1==w&&(E=!1);C=this.a.X(x)}x=C}while(x!=H);0==v&&0==w&&q.add(H);m=0;for(w=q.size;m<w;m++)v=q.get(m),this.a.vf(v,!1);
q.clear(!1);r=3>this.a.Ha(r)?this.a.Cr(r):this.a.bc(r)}}if(E)return b.Pa();this.AR();0<c&&this.gM(c);return this.a.hf(this.U)};b.prototype.eL=function(b){var c=new a.i,e=new a.i,d=[0,0,0,0,0,0,0,0,0],f=[0,0,0,0,0,0,0,0,0],g=new a.Ag,k=b,h=new a.i;b.dd(h);for(var n=0;4>n;n++){var q=!1,E=0!=(n&1),l=0;switch(n){case 0:l=this.Qb.v;q=h.v<=l&&h.B>=l;break;case 1:l=this.Qb.C;q=h.C<=l&&h.G>=l;break;case 2:l=this.Qb.B;q=h.v<=l&&h.B>=l;break;case 3:l=this.Qb.G,q=h.C<=l&&h.G>=l}if(q){q=k;k=b.Pa();q=q.Ca();q.Lk();
for(var r,t=new a.b;q.kb();)for(var u,w=!0;q.La();){var v=q.ia();v.o(c);var H=this.po(c,n,l);if(-1==H){if(H=v.nt(E,l,d,f),0<H){var x=0;r=v.Mb();for(var m=0;m<=H;m++)if(u=m<H?f[m]:1,x!=u){v.Bi(x,u,g);var y=g.get();y.ed(r);m<H&&(E?(t.x=d[m],t.y=l):(t.x=l,t.y=d[m]),y.vd(t));y.o(e);var z=this.po(e,n,l);if(-1==z){r=y.Mb();x=y.oc();if(E)z=Math.abs(r.y-l),C=Math.abs(x.y-l),z<C?(r.y=l,y.ed(r)):(x.y=l,y.vd(x));else{var z=Math.abs(r.x-l),C=Math.abs(x.x-l);z<C?(r.x=l,y.ed(r)):(x.x=l,y.vd(x))}y.o(e);z=this.po(e,
n,l)}r=y.oc();x=u;u=z;1==u?(k.Bc(y,w),w=!1):w=!0}}}else u=H,1==u?(k.Bc(v,w),w=!1):w=!0}}}return k};b.prototype.AR=function(){this.vn=-1;this.Nu(!1,this.Qb.v);this.Nu(!1,this.Qb.B);this.Nu(!0,this.Qb.C);this.Nu(!0,this.Qb.G);this.vg.resize(0);this.vg.xb(100);this.vn=this.a.re();for(var b=new a.b,c=this.a.Vb(this.U);-1!=c;c=this.a.bc(c))for(var e=this.a.Cb(c),d=0,f=this.a.Ha(c);d<f;d++,e=this.a.X(e))if(this.a.w(e,b),this.Qb.v==b.x||this.Qb.B==b.x||this.Qb.C==b.y||this.Qb.G==b.y)this.a.lb(e,this.vn,
this.vg.size),this.vg.add(e);this.zu(!1,this.Qb.v);this.zu(!1,this.Qb.B);this.zu(!0,this.Qb.C);this.zu(!0,this.Qb.G);this.WM()};b.prototype.gM=function(b){for(var c=new a.b,e=new a.b,d=a.I.Lh(2048,0),f=this.a.Vb(this.U);-1!=f;f=this.a.bc(f)){var g=this.a.Cb(f),k=g;do{var h=this.a.X(k);this.a.w(k,c);var n=-1;c.x==this.Qb.v?(this.a.w(h,e),e.x==this.Qb.v&&(n=1)):c.x==this.Qb.B&&(this.a.w(h,e),e.x==this.Qb.B&&(n=1));c.y==this.Qb.C?(this.a.w(h,e),e.y==this.Qb.C&&(n=0)):c.y==this.Qb.G&&(this.a.w(h,e),e.y==
this.Qb.G&&(n=0));if(-1!=n&&(n=a.b.Fb(c,e),n=a.I.truncate(Math.min(Math.ceil(n/b),2048)),!(1>=n))){for(var q=1;q<n;q++)d[q-1]=1*q/n;this.a.Mr(k,d,n-1)}k=h}while(k!=g)}};b.prototype.Nu=function(b,c){var e=this.a.re(),d=new a.b,f=new a.ga(0);f.xb(100);for(var p=this.a.Vb(this.U);-1!=p;p=this.a.bc(p))for(var g=this.a.Cb(p),k=0,h=this.a.Ha(p);k<h;k++){var n=this.a.X(g);this.a.w(g,d);if(b?d.y==c:d.x==c)if(this.a.w(n,d),b?d.y==c:d.x==c)1!=this.a.Ra(g,e)&&(f.add(g),this.a.lb(g,e,1)),1!=this.a.Ra(n,e)&&(f.add(n),
this.a.lb(n,e,1));g=n}this.a.bf(e);if(!(3>f.size)){var q=this;f.xd(0,f.size,function(a,b){return q.kj(a,b)});e=new a.b;p=new a.b;g=new a.b;p.Eh();for(var E=-1,k=new a.ga(0),h=new a.ga(0),n=this.a.re(),l=this.a.re(),r=0,t=f.size;r<t;r++){var u=f.get(r);this.a.w(u,d);if(!d.ub(p)){if(-1!=E){for(var w=E;w<r;w++){var E=f.get(w),v=this.a.X(E),u=this.a.Ua(E),H=!1;0>this.kj(E,v)&&(this.a.w(v,e),b?e.y==c:e.x==c)&&(k.add(E),H=!0,this.a.lb(E,l,1));0>this.kj(E,u)&&(this.a.w(u,e),b?e.y==c:e.x==c)&&(H||k.add(E),
this.a.lb(E,n,1))}w=0;for(H=k.size;w<H;w++){E=k.get(w);u=this.a.Ra(E,n);v=this.a.Ra(E,l);if(1==u){u=this.a.Ua(E);this.a.w(u,g);var x=[0];x[0]=0;if(!g.ub(d)){var m=a.b.Fb(p,g);x[0]=a.b.Fb(g,d)/m;0==x[0]?x[0]=2.220446049250313E-16:1==x[0]&&(x[0]=.9999999999999998);this.a.Mr(u,x,1);u=this.a.Ua(E);this.a.Yi(u,d);h.add(u);this.a.lb(u,n,1);this.a.lb(u,l,-1)}}1==v&&(v=this.a.X(E),this.a.w(v,g),x=[0],x[0]=0,g.ub(d)||(m=a.b.Fb(p,g),x[0]=a.b.Fb(p,d)/m,0==x[0]?x[0]=2.220446049250313E-16:1==x[0]&&(x[0]=.9999999999999998),
this.a.Mr(E,x,1),u=this.a.X(E),this.a.Yi(u,d),h.add(u),this.a.lb(u,n,-1),this.a.lb(u,l,1)))}E=k;k=h;h=E;h.clear(!1)}E=r;p.J(d)}}this.a.bf(n);this.a.bf(l)}};b.prototype.zu=function(b,c){var e=new a.b,d=new a.ga(0);d.xb(100);for(var f=this.a.re(),p=0,g=this.vg.size;p<g;p++){var k=this.vg.get(p);if(-1!=k){var h=this.a.X(k);this.a.w(k,e);if(b?e.y==c:e.x==c)if(this.a.w(h,e),b?e.y==c:e.x==c)-2!=this.a.Ra(k,f)&&(d.add(k),this.a.lb(k,f,-2)),-2!=this.a.Ra(h,f)&&(d.add(h),this.a.lb(h,f,-2))}}if(0!=d.size){var n=
this;d.xd(0,d.size,function(a,b){return n.kj(a,b)});p=0;for(g=d.size;p<g;p++){var q=d.get(p);this.a.lb(q,f,p)}k=new a.b;h=new a.b;h.Eh();for(var E=-1,p=0,g=d.size;p<g;p++)if(q=d.get(p),-1!=q&&(this.a.w(q,e),!e.ub(h))){if(-1!=E)for(;;){for(var q=!1,l=1<p-E?p-1:p,r=E;r<l;r++){var t=d.get(r);if(-1!=t){var u=-1,w=this.a.X(t);0>this.kj(t,w)&&(this.a.w(w,k),b?k.y==c:k.x==c)&&(u=w);var w=-1,v=this.a.Ua(t);0>this.kj(t,v)&&(this.a.w(v,k),b?k.y==c:k.x==c)&&(w=v);if(-1!=u&&-1!=w)this.no(t,d,f),this.a.vf(t,!1),
this.no(u,d,f),this.a.vf(u,!1),q=!0;else if(-1!=u||-1!=w){for(v=r+1;v<p;v++){var H=d.get(v);if(-1!=H){var x=this.a.X(H),m=-1;0>this.kj(H,x)&&(this.a.w(x,k),b?k.y==c:k.x==c)&&(m=x);var x=this.a.Ua(H),y=-1;0>this.kj(H,x)&&(this.a.w(x,k),b?k.y==c:k.x==c)&&(y=x);if(-1!=m&&-1!=y){this.no(H,d,f);this.a.vf(H,!1);this.no(m,d,f);this.a.vf(m,!1);q=!0;break}if(-1!=u&&-1!=y){this.dF(d,t,u,H,y,f);q=!0;break}else if(-1!=w&&-1!=m){this.dF(d,H,m,t,w,f);q=!0;break}}}if(q)break}}}if(!q)break}E=p;h.J(e)}}this.a.bf(f)};
b.prototype.no=function(a,b,c){c=this.a.Ra(a,c);b.set(c,-1);c=this.a.Ra(a,this.vn);this.vg.set(c,-1);b=this.a.rd(a);-1!=b&&this.a.Cb(b)==a&&(this.a.Dh(b,-1),this.a.Wi(b,-1))};b.prototype.dF=function(a,b,c,e,d,f){this.a.Sc(b,e);this.a.Tc(e,b);this.a.Tc(c,d);this.a.Sc(d,c);this.no(e,a,f);this.a.Ui(e,!1);this.no(d,a,f);this.a.Ui(d,!0)};b.prototype.WM=function(){for(var a=0,b=this.vg.size;a<b;a++){var c=this.vg.get(a);-1!=c&&this.a.im(c,-1)}for(var e=0,d=0,f=this.a.Vb(this.U);-1!=f;){var g=this.a.Cb(f);
if(-1==g||f!=this.a.rd(g)){var k=f,f=this.a.bc(f);this.a.Dh(k,-1);this.a.yu(k)}else{c=g;k=0;do this.a.im(c,f),k++,c=this.a.X(c);while(c!=g);2>=k?(c=this.a.Ra(g,this.vn),this.vg.set(c,-1),g=this.a.vf(g,!1),2==k&&(c=this.a.Ra(g,this.vn),this.vg.set(c,-1),this.a.vf(g,!1)),k=f,f=this.a.bc(f),this.a.Dh(k,-1),this.a.yu(k)):(this.a.Jr(f,!1),this.a.Wi(f,this.a.Ua(g)),this.a.hm(f,k),d+=k,e++,f=this.a.bc(f))}}a=0;for(b=this.vg.size;a<b;a++)if(c=this.vg.get(a),-1!=c&&(f=this.a.rd(c),-1==f)){f=this.a.Cf(this.U,
-1);k=0;g=c;do this.a.im(c,f),k++,c=this.a.X(c);while(c!=g);2>=k?(c=this.a.Ra(g,this.vn),this.vg.set(c,-1),g=this.a.vf(g,!1),2==k&&(c=this.a.Ra(g,this.vn),0<=c&&this.vg.set(c,-1),this.a.vf(g,!1)),k=f,this.a.Dh(k,-1),this.a.yu(k)):(this.a.Gn(f,!0),this.a.hm(f,k),this.a.Dh(f,g),this.a.Wi(f,this.a.Ua(g)),this.a.Jr(f,!1),d+=k,e++)}this.a.gm(this.U,e);this.a.Pk(this.U,d);a=0;for(b=this.a.$c;-1!=b;b=this.a.we(b))a+=this.a.F(b);this.a.ZF(a)};b.Xk=function(a,c,e){return(new b(c)).cL(a,e)};b.clip=function(c,
e,d,f){if(c.s())return c;if(e.s())return c.Pa();d=c.D();if(33==d)return f=c.w(),e.contains(f)?c:c.Pa();if(197==d)return f=new a.i,c.o(f),f.Ga(e)?(e=new a.Vj,c.copyTo(e),e.Cu(f),e):c.Pa();var p=new a.i;c.dd(p);if(e.contains(p))return c;if(!e.jc(p))return c.Pa();p=c.pb;if(null!=p&&(p=p.hi,null!=p)){p=p.Dn(e);if(1==p){if(1736!=d)throw a.g.wa();c=new a.Ka(c.description);c.ws(e);return c}if(0==p)return c.Pa()}switch(d){case 550:d=null;for(var p=c.F(),g=c.mc(0),A=0,k=0;k<p;k++)f=new a.b,g.ec(2*k,f),e.contains(f)||
(0==A&&(d=c.Pa()),A<k&&d.Pd(c,A,k),A=k+1);0<A&&d.Pd(c,A,p);return 0==A?c:d;case 1736:case 1607:return b.Xk(c,e,f);default:throw a.g.wa();}};b.prototype.kj=function(b,c){var e=new a.b;this.a.w(b,e);b=new a.b;this.a.w(c,b);return e.compare(b)};return b}();a.Ed=b})(z||(z={}));(function(a){var b=new a.b,c=function(){function b(b,c,e,d,f){this.Ml=new a.b;this.ln=new a.b;this.Ck=new a.b;this.a=b;this.Px=e;this.bn=d;this.Ml=c;this.vk=f;this.ln.Eh();this.Ck.Eh()}b.prototype.sB=function(b){this.a.w(b,this.ln);
b=a.I.truncate((this.ln.x-this.Ml.x)*this.bn+.5);var c=a.I.truncate((this.ln.y-this.Ml.y)*this.bn+.5);return e.XC(b,c)};b.prototype.vw=function(a){return this.a.Ra(a,this.vk)};return b}();a.wT=function(){return function(){}}();var e=function(){function e(){this.Ml=new a.b;this.Zo=[0,0,0,0];this.Kq=[0,0,0,0];this.en=this.vk=-1}e.zM=function(a,b){var c=new e;c.a=a;c.ka=b;c.Px=b*b;c.Kt=2*b;c.bn=1/c.Kt;return c.fL()};e.Vw=function(a,b,c,e,d){a-=c;b-=e;return a*a+b*b<=d};e.XC=function(b,c){return a.I.kg(c,
a.I.kg(b))};e.prototype.hL=function(c,d){this.a.uc(c,b);for(var f=(b.y-this.Ml.y)*this.bn,p=a.I.truncate((b.x-this.Ml.x)*this.bn),g=a.I.truncate(f),A=f=0;1>=A;A+=1)for(var k=0;1>=k;k+=1){var h=e.XC(p+A,g+k),n=this.uk.DN(h);-1!=n&&(this.Zo[f]=n,this.Kq[f]=h,f++)}for(p=f-1;1<=p;p--)for(n=this.Zo[p],g=p-1;0<=g;g--)if(n==this.Zo[g]){this.Kq[g]=-1;f--;p!=f&&(this.Kq[p]=this.Kq[f],this.Zo[p]=this.Zo[f]);break}for(g=0;g<f;g++)this.iL(c,this.Kq[g],b,this.Zo[g],d)};e.prototype.iL=function(b,c,d,f,p){for(var g=
new a.b;-1!=f;f=this.uk.SN(f)){var A=this.uk.da(f);b==A||-1!=c&&this.a.Ra(A,this.vk)!=c||(this.a.uc(A,g),e.Vw(d.x,d.y,g.x,g.y,this.Px)&&p.add(f))}};e.prototype.Tl=function(a,b,c){var e=this.a.Ra(a,this.en),d=this.a.Ra(b,this.en);-1==e&&(e=this.nd.jh(),this.nd.addElement(e,a),this.a.lb(a,this.en,e));-1==d?this.nd.addElement(e,b):this.nd.Qv(e,d);this.a.lb(b,this.en,-2);b=this.aQ(a,b);c&&(c=this.St.sB(a),this.a.lb(a,this.vk,c));return b};e.$P=function(b,c,d){b.lc(c);d=b;var f=new a.b;e.HH(b.w(),c.w(),
f);d.ic(f)};e.HH=function(a,b,c){var e=a.x;a.x!=b.x&&(e=(1*a.x+1*b.x)/2);var d=a.y;a.y!=b.y&&(d=(1*a.y+1*b.y)/2);c.ma(e,d)};e.prototype.aQ=function(b,c){var e=new a.b;this.a.w(b,e);var d=new a.b;this.a.w(c,d);var f=this.a.RC(b);c=this.a.RC(c);var p=f+c,g=0,A=e.x;e.x!=d.x&&(A=(e.x*f+d.x*c)/p,g++);var k=e.y;e.y!=d.y&&(k=(e.y*f+d.y*c)/p,g++);0<g&&this.a.ic(b,A,k);this.a.pS(b,p);return 0!=g};e.prototype.fL=function(){var b=this.a.pd,e=this.a.wC();this.Ml=e.yw();e=Math.max(e.ba(),e.aa())/2147483646;this.Kt<
e&&(this.Kt=e,this.bn=1/this.Kt);this.nd=new a.Ur;this.nd.Dr(a.I.truncate(this.a.pd/3+1));this.nd.$l(a.I.truncate(this.a.pd/3+1));this.vk=this.a.re();this.en=this.a.re();this.St=new c(this.a,this.Ml,this.Px,this.bn,this.vk);this.uk=new a.AH(a.I.truncate(4*b/3),this.St);this.uk.wR(this.a.pd);b=!1;for(e=this.a.$c;-1!=e;e=this.a.we(e))for(var d=this.a.Vb(e);-1!=d;d=this.a.bc(d))for(var f=this.a.Cb(d),p=0,g=this.a.Ha(d);p<g;p++){var k=this.St.sB(f);this.a.lb(f,this.vk,k);this.uk.addElement(f,k);f=this.a.X(f)}var h=
new a.ga(0);h.xb(10);for(e=this.a.$c;-1!=e;e=this.a.we(e))for(d=this.a.Vb(e);-1!=d;d=this.a.bc(d))for(f=this.a.Cb(d),p=0,g=this.a.Ha(d);p<g;p++){if(-2!=this.a.Ra(f,this.en))for(k=this.a.Ra(f,this.vk),this.uk.Jc(f,k);;){this.hL(f,h);if(0==h.size)break;for(var k=!1,n=0,q=h.size;n<q;n++){var E=h.get(n),l=this.uk.da(E);this.uk.kd(E);k=this.Tl(f,l,n+1==q)||k}b=b||k;h.clear(!1);if(!k)break}f=this.a.X(f)}b&&this.ZJ();this.St=this.uk=null;this.a.bf(this.vk);this.a.bf(this.en);return b};e.prototype.ZJ=function(){for(var b=
new a.b,c=this.nd.Wd;-1!=c;c=this.nd.Cw(c)){var e=this.nd.gc(c);this.a.w(this.nd.da(e),b);for(e=this.nd.bb(e);-1!=e;e=this.nd.bb(e))this.a.Yi(this.nd.da(e),b)}};return e}();a.Sr=e})(z||(z={}));(function(a){var b=Math.PI,c=2*Math.PI,e=Math.PI/2,d=function(){function a(){}a.yL=function(b,c){var e=new a;e.x=b;e.y=c;e.type=0;e.mh=0;return e};a.um=function(b){var c=new a;c.x=b.x;c.y=b.y;c.type=0;c.mh=0;return c};a.xL=function(b){var c=new a;c.x=b.x;c.y=b.y;c.type=b.type;c.mh=b.mh;return c};a.Ad=function(b,
c,e){var d=new a;d.x=b.x+c*Math.cos(e);d.y=b.y+c*Math.sin(e);d.type=b.type;d.mh=b.mh;return d};a.Js=function(b,c){var e=new a;e.x=.5*(b.x+c.x);e.y=.5*(b.y+c.y);e.type=b.type;e.mh=b.mh;return e};a.LB=function(b,c){var e=new a;e.x=b.x+.001*(c.x-b.x);e.y=b.y+.001*(c.y-b.y);e.type=b.type;e.mh=b.mh;return e};return a}(),f=function(){return function(){}}();(function(a){a[a.Round=0]="Round";a[a.Bevel=1]="Bevel";a[a.Miter=2]="Miter";a[a.Square=3]="Square"})(a.EH||(a.EH={}));var g=function(){function p(a){this.Kx=
this.Ib=this.dg=null;this.oe=a}p.$=function(b,c,e,d,f,g){if(null==b)throw a.g.N();if(1>b.fb())throw a.g.N();if(0==c||b.s())return b;g=new p(g);g.$m=b;g.Da=c;g.ka=f;g.bi=e;g.Dx=d;return g.hv()};p.prototype.hJ=function(){var b=this.$m,c=b.Mb(),e=b.oc(),d=new a.b;d.pc(e,c);d.normalize();d.tt();d.scale(this.Da);c.add(d);e.add(d);d=b.Pa();b.ed(c);b.vd(e);return d};p.prototype.gJ=function(){var b=this.$m;if(0<this.Da&&2!=this.bi){var c=new a.Ka;c.Wc(b,!1);this.$m=c;return this.hv()}b=new a.Vj(b.R);b.P(this.Da,
this.Da);return b};p.prototype.rF=function(a,b,c,e){return(b.x-a.x)*(e.x-c.x)+(b.y-a.y)*(e.y-c.y)};p.prototype.Ub=function(a,b){if(void 0===b)this.Ib.push(a),this.Xe++;else if(0==this.Xe)this.Ub(a);else{var c=this.eu,f,p;f=this.dg[0==b?c-1:b-1];p=this.dg[b];var g=this.rF(f,p,this.Ib[this.Xe-1],a);0<g?this.Ub(a):0>g&&(0<this.rF(f,p,p,this.Ib[this.Xe-1])?(p=this.dg[0==b?c-2:1==b?c-1:b-2],c=d.Ad(f,this.Da,Math.atan2(f.y-p.y,f.x-p.x)-e),this.Ib[this.Xe-1]=c,1==this.bi||2==this.bi?(c=d.Js(c,f),this.Ub(c),
c=d.Ad(f,this.Da,this.vt+e),f=d.Js(c,f),f.type|=256,this.Ub(f)):(c=d.Ad(f,this.Da,this.vt+e),c.type|=256),this.Ub(c),this.Ub(a,b)):(c=d.Ad(p,this.Da,this.vt+e),this.Ub(c),1==this.bi||2==this.bi?(c=d.Js(c,p),this.Ub(c),c=d.Ad(p,this.Da,this.gx-e),f=d.Js(c,p),f.type|=256,this.Ub(f)):(c=d.Ad(p,this.Da,this.gx-e),c.type|=256),this.Ub(c)))}};p.prototype.mB=function(){var f,p,g,A,k,h,n=this.eu;this.Xe=0;var q=.5*this.ka,E=0,l=0;for(f=0;f<n;f++){A=this.dg[f];k=0==f?this.dg[n-1]:this.dg[f-1];h=f==n-1?this.dg[0]:
this.dg[f+1];var K=k.x-A.x,r=k.y-A.y,t=h.x-A.x,u=h.y-A.y;p=Math.atan2(r,K);g=Math.atan2(u,t);this.vt=p;this.gx=g;0==f&&(E=p,l=g);K=K*u-t*r;r=g;g<p&&(g+=c);if(0<K*this.Da)1==this.bi||2==this.bi?(p=d.Ad(A,this.Da,p+e),this.Ub(p),p=d.LB(A,p),this.Ub(p),p=d.Ad(A,this.Da,g-e),A=d.LB(A,p),A.type|=256,this.Ub(A),this.Ub(p)):(K=.5*(g-p),K=this.Da/Math.abs(Math.sin(K)),p=d.Ad(A,K,.5*(p+g)),this.Ub(p,f));else if(0!=(A.type&512)){K=1-q/Math.abs(this.Da);k=1;h=0>this.Da?-b:b;-1<K&&1>K&&(r=2*Math.acos(K),.017453292519943295>
r&&(r=.017453292519943295),k=a.I.truncate(b/r+1.5),1<k&&(h/=k));r=p+e;p=d.Ad(A,this.Da,r);0==f&&(p.type|=1024);this.Ub(p,f);K=this.Da/Math.cos(h/2);r+=h/2;p=d.Ad(A,K,r);p.type|=1024;for(this.Ub(p);0<--k;)r+=h,p=d.Ad(A,K,r),p.type|=1024,this.Ub(p);p=d.Ad(A,this.Da,g-e);p.type|=1024;this.Ub(p)}else if(1==this.bi)p=d.Ad(A,this.Da,p+e),this.Ub(p,f),p=d.Ad(A,this.Da,g-e),this.Ub(p);else if(0==this.bi)for(K=1-q/Math.abs(this.Da),k=1,h=g-e-(p+e),-1<K&&1>K&&(r=2*Math.acos(K),.017453292519943295>r&&(r=.017453292519943295),
k=a.I.truncate(Math.abs(h)/r+1.5),1<k&&(h/=k)),K=this.Da/Math.cos(.5*h),r=p+e+.5*h,p=d.Ad(A,K,r),this.Ub(p,f);0<--k;)r+=h,p=d.Ad(A,K,r),this.Ub(p);else 2==this.bi?(K=k.x-A.x,r=k.y-A.y,t=h.x-A.x,u=h.y-A.y,k=(K*t+r*u)/Math.sqrt(K*K+r*r)/Math.sqrt(t*t+u*u),.99999999<k?(p=d.Ad(A,1.4142135623730951*this.Da,g-.25*b),this.Ub(p,f),p=d.Ad(A,1.4142135623730951*this.Da,g+.25*b),this.Ub(p)):(k=Math.abs(this.Da/Math.sin(.5*Math.acos(k))),h=Math.abs(this.Dx*this.Da),k>h?(K=.5*(g-p),K=this.Da/Math.abs(Math.sin(K)),
p=d.Ad(A,K,.5*(p+g)),g=a.b.Oa(p.x,p.y),p=a.b.Oa(A.x,A.y),A=new a.b,A.pc(g,p),g=new a.b,g.DR(h/A.length(),A,p),p=(k-h)*Math.abs(this.Da)/Math.sqrt(k*k-this.Da*this.Da),0<this.Da?A.tt():A.Kp(),A.scale(p/A.length()),p=new a.b,p.add(g,A),k=new a.b,k.pc(g,A),p=d.um(p),this.Ub(p,f),p=d.um(k),this.Ub(p)):(K=.5*(g-p),K=this.Da/Math.abs(Math.sin(K)),p=d.Ad(A,K,.5*(p+g)),this.Ub(p,f)))):(g=r,0<this.Da?(g>p&&(g-=c),k=p-g<e):(g<p&&(g+=c),k=g-p<e),k?(K=1.4142135623730951*this.Da,r=0>K?p+.25*b:p+.75*b,p=d.Ad(A,
K,r),this.Ub(p,f),r=0>K?g-.25*b:g-.75*b,p=d.Ad(A,K,r),this.Ub(p)):(K=.5*(g-p),K=this.Da/Math.abs(Math.sin(K)),g<p&&(g+=c),p=d.Ad(A,K,(p+g)/2),this.Ub(p,f)))}this.vt=E;this.gx=l;this.Ub(this.Ib[0],0);A=d.xL(this.Ib[this.Xe-1]);this.Ib[0]=A;return this.sR()};p.prototype.xs=function(b,c){if(!(2>c))for(var e=0;e<c;e++){var d=this.Ib[b+e];0!=e?this.Kx.Lm(a.b.Oa(d.x,d.y)):this.Kx.Nr(a.b.Oa(d.x,d.y))}};p.prototype.iJ=function(a,b,c){var e=a.Ea(b),f=a.Dc(b);this.Ib=[];this.Kx=c;if(a.vc(b)){for(b=a.Fa(e);a.Fa(f-
1).ub(b);)f--;if(2<=f-e){this.eu=f-e;this.dg=[];for(b=e;b<f;b++)this.dg.push(d.um(a.Fa(b)));this.mB()&&this.xs(0,this.Xe-1)}}else{for(b=a.Fa(e);e<f&&a.Fa(e+1).ub(b);)e++;for(b=a.Fa(f-1);e<f&&a.Fa(f-2).ub(b);)f--;if(2<=f-e){this.eu=2*(f-e)-2;this.dg=[];c=d.um(a.Fa(e));c.type|=1536;this.dg.push(c);for(b=e+1;b<f-1;b++)c=d.um(a.Fa(b)),this.dg.push(c);c=d.um(a.Fa(f-1));c.type|=512;this.dg.push(c);for(b=f-2;b>=e+1;b--)c=d.um(a.Fa(b)),c.type|=1024,this.dg.push(c);if(this.mB())if(2<=this.Ib.length){a=-1;
(f=0!=(this.Ib[this.Xe-1].type&1024))||(a=0);for(b=1;b<this.Xe;b++)(e=0!=(this.Ib[b].type&1024))?f||(f=b-1,1<f-a+1&&this.xs(a,f-a+1)):f&&(a=b-1),f=e;f||(f=this.Xe-1,1<f-a+1&&this.xs(a,f-a+1))}else a=0,f=this.Xe-1,0<=a&&1<=f-a&&this.xs(a,f-a+1)}}this.dg=null;this.eu=0;this.Ib=null;this.Xe=0};p.prototype.sR=function(){for(var a=!1,b=0;b<this.Xe;b++){var c=this.Ib[b];c.Rg=b+1;c.Ug=b-1;this.Ib[b]=c}c=this.Ib[0];c.Ug=this.Xe-2;this.Ib[0]=c;c=this.Ib[this.Xe-2];c.Rg=0;this.Ib[this.Xe-2]=c;for(b=c=0;b<this.Xe;b++)if(0!=
(this.Ib[c].type&256)){var e=this.$L(c);if(-1!=e)c=e;else{a=!0;break}}else c=this.Ib[c].Rg;if(a)return!1;this.vL(c);return!0};p.prototype.$L=function(a){for(var b=this.Xe-1,c=a,e,d,f=1;f<=b-2;f++){e=c=this.Ib[c].Rg;d=a;for(var p=1;p<=f;p++){d=this.Ib[d].Ug;if(0==(this.Ib[d].type&256)&&0==(this.Ib[e].type&256)){var g=this.oO(d,e);if(-1!=g)return g}e=this.Ib[e].Ug}}return-1};p.prototype.oO=function(b,c){var e,d,p,g;e=this.Ib[this.Ib[b].Ug];d=this.Ib[b];p=this.Ib[this.Ib[c].Ug];g=this.Ib[c];if(!this.HR(e,
d,p,g))return-1;var A=new f;return this.NM(e,d,p,g,A)&&!A.cB&&a.I.bG((d.x-e.x)*(g.y-p.y)-(d.y-e.y)*(g.x-p.x))!=a.I.bG(this.Da)?(e=this.Ib[b].Ug,A.Xl.type=d.type,A.Xl.Rg=c,A.Xl.Ug=e,this.Ib[b]=A.Xl,A.Xl=this.Ib[c],A.Xl.Ug=b,this.Ib[c]=A.Xl,c):-1};p.prototype.HR=function(a,b,c,e){return Math.max(a.x,b.x)>=Math.min(c.x,e.x)&&Math.max(c.x,e.x)>=Math.min(a.x,b.x)&&Math.max(a.y,b.y)>=Math.min(c.y,e.y)&&Math.max(c.y,e.y)>=Math.min(a.y,b.y)};p.prototype.NM=function(a,b,c,e,f){f.cB=!1;var p,g,A;p=(b.y-a.y)*
(e.x-c.x)-(b.x-a.x)*(e.y-c.y);g=(c.y-a.y)*(b.x-a.x)-(c.x-a.x)*(b.y-a.y);p=0==p?2:g/p;return 0<=p&&1>=p&&(A=p,p=(e.y-c.y)*(b.x-a.x)-(e.x-c.x)*(b.y-a.y),g=(a.y-c.y)*(e.x-c.x)-(a.x-c.x)*(e.y-c.y),p=0==p?2:g/p,0<=p&&1>=p)?(f.Xl=d.yL(a.x+p*(b.x-a.x),a.y+p*(b.y-a.y)),f.Xl.mh=c.mh+A*(e.mh-c.mh),0!=A&&1!=A||0!=p&&1!=p||(f.cB=!0),f.wU=p,f.xU=A,(0==A||1==A)&&0<p&&1>p||(0==p||1==p)&&0<A&&1>A?!1:!0):!1};p.prototype.vL=function(a){for(;this.Ib[a].Ug<a;)a=this.Ib[a].Ug;var b=0,c=a;do c=this.Ib[c],this.Ib[b]=c,
c=c.Rg,b++;while(c!=a);this.Ib[b]=this.Ib[0];this.Xe=b+1};p.prototype.qA=function(a){var b=this.$m,c=b.Ca();if(null!=c){c.Lk();for(var e=-1;c.kb();)e++,this.iJ(b,e,a)}};p.prototype.hv=function(){var b=this.$m.D();return 322==b?this.hJ():197==b?this.gJ():a.T.Lc(b)?(b=new a.Xa,b.Bc(this.$m,!0),this.$m=b,this.hv()):1607==b?(b=new a.Xa,this.qA(b),b):1736==b?(b=new a.Ka,this.qA(b),b):null};return p}();a.XG=g})(z||(z={}));(function(a){var b=function(){function a(a){this.xj=a}a.prototype.w=function(a,b){this.xj.a.w(a,
b)};a.prototype.kd=function(a){var b=this.xj.za.da(a);this.xj.za.kd(a,-1);this.xj.a.vf(b,!1)};return a}(),c=function(){function a(a){this.xj=a}a.prototype.w=function(a,b){this.xj.NP.w(a,b)};a.prototype.kd=function(a){this.xj.za.kd(a,-1)};return a}(),e=function(){function a(a){this.xj=a}a.prototype.w=function(a,b){b.J(this.xj.PP[a])};a.prototype.kd=function(a){this.xj.za.kd(a,-1)};return a}(),d=function(){function d(d){void 0===d?(this.za=new a.bj,this.za.de(20),this.a=new a.fd,this.FP=this.a.jg(550),
this.cr=this.a.Cf(this.FP,-1),this.oh=new b(this)):d instanceof Array?(this.za=new a.bj,this.za.de(20),this.PP=d,this.oh=new e(this)):(this.za=new a.bj,this.za.de(20),this.NP=d,this.oh=new c(this))}d.prototype.Eb=function(b){var c=b.D();if(a.Wr.Th(c))this.OJ(b);else if(a.al.Lc(c))this.SJ(b);else if(197==c)this.LJ(b);else if(33==c)this.RJ(b);else throw a.g.N("invalid shape type");};d.prototype.sN=function(){var b=new a.Va,c=this.za.gc(-1),e=new a.Ka(this.a.wp);this.a.Jk(this.za.da(c),b);e.df(b);for(c=
this.za.bb(c);-1!=c;c=this.za.bb(c))this.a.Jk(this.za.da(c),b),e.lineTo(b);return e};d.wL=function(b){var c=new d(b),e=b.F(),f=1,p=new a.b,g=new a.b,A=new a.b;for(b.w(0,p);;){b.w(f,g);if(!(g.Ww(p)&&f<e-1))break;f++}c.za.addElement(0,-1);c.za.qm(f);for(e=f+1;e<b.F();e++)b.w(e,A),f=c.cz(A),-1!=f&&c.za.Vi(f,e);A=new a.Va;f=c.za.gc(-1);e=new a.Ka(b.description);b.Sd(c.za.da(f),A);e.df(A);for(f=c.za.bb(f);-1!=f;f=c.za.bb(f))b.Sd(c.za.da(f),A),e.lineTo(A);return e};d.Oa=function(a,b,c){for(var e=new d(a),
f=1,p=a[0];a[f].Ww(p)&&f<b-1;)f++;e.za.addElement(0,-1);e.za.qm(f);for(f+=1;f<b;f++)p=e.cz(a[f]),-1!=p&&e.za.Vi(p,f);a=0;for(b=e.za.gc(-1);-1!=b;b=e.za.bb(b))c[a++]=e.za.da(b);return a};d.sD=function(b,c){var e=b.Ea(c),f=b.Dc(c);c=!b.vc(c)&&b.Oo(c);b=b.mc(0);e*=2;f*=2;c&&(f-=2);if(6>f-e)return!0;c=new a.b;var p=new a.b,g=new a.b;b.ec(e,c);b.ec(e+2,p);b.ec(e+4,g);var A=d.Bd(p,g,c);if(A.Dq()||!d.ac(A.value()))return!1;for(var k=a.b.Oa(p.x,p.y),h=new a.b,e=e+6;e<f;e+=2){h.J(p);p.J(g);b.ec(e,g);A=d.Bd(p,
g,c);if(A.Dq()||!d.ac(A.value()))return!1;A=d.Bd(k,g,c);if(A.Dq()||!d.ac(A.value()))return!1;A=d.Bd(p,g,h);if(A.Dq()||!d.ac(A.value()))return!1}return!0};d.prototype.OJ=function(b){for(var c=new a.Va,e=new a.b,d=0;d<b.F();d++){b.w(d,e);var f=this.hq(e);if(-1!=f){b.Sd(d,c);var p=this.a.Ub(this.cr,c);this.za.Vi(f,p)}}};d.prototype.LJ=function(b){for(var c=new a.Va,e=new a.b,d=0;4>d;d++){b.vu(d,e);var f=this.hq(e);if(-1!=f){b.uf(d,c);var p=this.a.Ub(this.cr,c);this.za.Vi(f,p)}}};d.prototype.SJ=function(b){var c=
new a.Va,e=b.Mb(),e=this.hq(e);if(-1!=e){b.En(c);var d=this.a.Ub(this.cr,c);this.za.Vi(e,d)}e=b.oc();e=this.hq(e);-1!=e&&(b.Bn(c),b=this.a.Ub(this.cr,c),this.za.Vi(e,b))};d.prototype.RJ=function(a){var b=a.w(),b=this.hq(b);-1!=b&&(a=this.a.Ub(this.cr,a),this.za.Vi(b,a))};d.prototype.hq=function(a){var b=-1;if(0==this.za.size(-1))return b=this.za.addElement(-4,-1);if(1==this.za.size(-1)){var c=this.a.Fa(this.za.da(this.za.gc(-1)));a.Ww(c)||(b=this.za.qm(-5));return b}return b=this.cz(a)};d.prototype.cz=
function(b){var c=-1,e=this.za.gc(-1),f=this.za.tc(-1),p=this.za.da(e),g=this.za.da(f),A=new a.b,k=new a.b;this.oh.w(p,A);this.oh.w(g,k);p=a.b.yn(k,b,A);if(d.ac(p))c=this.za.qm(-1),A=this.az(b,f,e),A!=e&&this.bz(b,e,this.za.ge(A));else if(d.ti(p)){for(var k=this.za.dt(-1),h=this.za.gc(-1),n=this.za.tc(-1),q,p=new a.b,g=new a.b;h!=this.za.ge(n);)q=this.za.da(k),this.oh.w(q,p),q=a.b.yn(p,b,A),d.ti(q)?(n=k,k=this.za.ik(k)):(h=k,k=this.za.Jo(k));k=n;A=h;q=this.za.da(k);h=this.za.da(A);this.oh.w(q,p);
this.oh.w(h,g);if(A==e||(p=a.b.yn(g,b,p),d.ac(p)))c=this.za.vs(A,k,-2,!1),this.bz(b,k,f),this.az(b,A,e)}else null==this.ib&&(this.ib=new a.yb),this.ib.ed(k),this.ib.vd(A),A=this.ib.Gd(b,!0),0>A?(A=this.za.ge(f),this.za.kd(f,-1),c=this.za.qm(-3),this.az(b,A,e)):1<A&&(A=this.za.bb(e),this.za.kd(e,-1),c=this.za.vs(-1,A,-3,!1),this.bz(b,A,f));return c};d.prototype.bz=function(b,c,e){if(c!=e){var f=this.za.da(c),p=this.za.bb(c),g=new a.b,A=new a.b;for(this.oh.w(f,g);c!=e&&2<this.za.size(-1);){this.oh.w(this.za.da(p),
A);f=a.b.yn(A,b,g);if(d.ac(f))break;f=c;c=p;g.J(A);p=this.za.bb(c);this.oh.kd(f)}}};d.prototype.az=function(b,c,e){if(c==e)return e;var f=this.za.da(c),p=this.za.ge(c),g=new a.b,A=new a.b;for(this.oh.w(f,g);c!=e&&2<this.za.size(-1);){this.oh.w(this.za.da(p),A);f=a.b.yn(g,b,A);if(d.ac(f))break;f=c;c=p;g.J(A);p=this.za.ge(c);this.oh.kd(f)}return c};d.Bd=function(b,c,e){var d=new a.$k;d.set(c.x);d.sub(b.x);var f=new a.$k;f.set(e.y);f.sub(b.y);var p=new a.$k;p.set(c.y);p.sub(b.y);c=new a.$k;c.set(e.x);
c.sub(b.x);d.Ap(f);p.Ap(c);d.sub(p);return d};d.ac=function(a){return 0>a};d.ti=function(a){return 0<a};d.ao=function(a){return 0==a};return d}();a.Tr=d})(z||(z={}));(function(a){var b=function(){function b(a){this.oe=this.a=null;this.WD=!0;this.oe=a}b.HE=function(b,c,e){b=a.Ia.As(b);return a.Sr.Vw(c.lk(),c.mk(),e.lk(),e.mk(),a.vi.Ty(b))};b.gL=function(b,c){var e=new a.Va;a.Sr.$P(b,c,e);return e};b.$=function(a,c,e,d){e=new b(e);e.a=a;e.ka=c;e.WD=d;return e.rJ()};b.prototype.lJ=function(b){return a.Sr.zM(this.a,
b)};b.prototype.oJ=function(b){return a.Zu.$(this.a,b,this.oe)};b.prototype.rJ=function(){for(var b=this.ka,c=a.Ia.As(b),b=a.Ia.UJ(b),e=1.00001*b,b=1.000001*b,d=!1,f=30<this.a.pd+10?1E3:(this.a.pd+10)*(this.a.pd+10),g=0,k=this.a.pO();;g++){if(g>f)throw a.g.ra("Internal Error: max number of iterations exceeded");var h=this.lJ(c),d=d||h;this.WD&&(h=0!=this.a.xo(c,!0,!1),d=d||h);h=!1;if(0==g||k||a.Zu.DE(!0,this.a,b,null,this.oe))h=this.oJ(e),d=d||h;if(!h)break}return d};return b}();a.aj=b})(z||(z={}));
(function(a){var b=function(){function b(a){this.Ld=this.zc=null;this.Yb=a;this.hx=!0}b.prototype.et=function(a,b){var c=this.a.cc(a);if(null==c){if(!this.a.Oc(a,b))return null;c=b}return c};b.prototype.LL=function(){var b=this.a.Gp(!1),c=!1,e=new a.yb,d=new a.yb,f=new a.i;f.Ja();var g=new a.i;g.Ja();for(var k=new a.Va,h=new a.gA,n=b.next();-1!=n;n=b.next()){var q=null,l=!1;if(!a.T.Km(this.a.Lb(b.mj))){q=this.et(n,e);if(null==q)continue;q.o(f);f.P(this.ka,this.ka);if(q.mg(this.ka))if(q.mg(0))l=!0,
q=null;else continue}var r=this.a.Gp(b),t=r.next();for(-1!=t&&(t=r.next());-1!=t;t=r.next()){var u=null,w=!1;if(!a.T.Km(this.a.Lb(r.mj))){u=this.et(t,d);if(null==u)continue;u.o(g);if(u.mg(this.ka))if(u.mg(0))w=!0,u=null;else continue}var v=0,H=0;if(null!=q&&null!=u)f.rD(g)&&(h.zn(q),h.zn(u),h.Ga(this.ka,!1),v=h.kk(0),H=h.kk(1),0<v+H&&(this.a.Tp(n,h,0,!0),this.a.Tp(t,h,1,!0)),h.clear());else if(null!=q){var x=new a.b;this.a.w(t,x);if(f.contains(x)){h.zn(q);this.a.Jk(t,k);h.Tw(this.ka,k,!1);v=h.kk(0);
if(0<v)if(this.a.Tp(n,h,0,!0),w){w=-1;for(x=this.a.X(t);-1!=x&&x!=t&&(u=this.et(x,d),w=x,null!=u&&u.mg(0));x=this.a.X(x));for(x=t;-1!=x&&(this.a.bh(x,h.nf),x!=w);x=this.a.X(x));}else this.a.bh(t,h.nf);h.clear()}}else if(null!=u){if(x=new a.b,this.a.w(n,x),g.P(this.ka,this.ka),g.contains(x)){h.zn(u);this.a.Jk(n,k);h.Tw(this.ka,k,!1);H=h.kk(0);if(0<H)if(this.a.Tp(t,h,0,!0),l){w=-1;for(x=this.a.X(n);-1!=x&&x!=n&&(u=this.et(x,d),w=x,null!=u&&u.mg(0));x=this.a.X(x));for(x=n;-1!=x&&(this.a.bh(x,h.nf),x!=
w);x=this.a.X(x));}else this.a.bh(n,h.nf);h.clear()}}else continue;if(0!=v+H){if(0!=v){q=this.a.cc(n);if(null==q){if(!this.a.Oc(n,e))continue;q=e;e.o(f)}else q.o(f);if(q.mg(this.ka))break}c=!0}}}return c};b.prototype.ML=function(){return this.HQ()};b.prototype.HQ=function(){return(new a.aA).GS(this.a,this.ka)};b.prototype.EE=function(){var b=!1,c,e;null==this.zc&&(this.zc=new a.bj);var d=new a.ga(0);d.xb(this.a.pd+1);for(var f=this.a.Gp(),g=f.next();-1!=g;g=f.next())d.add(g);this.a.Mu(d,d.size);d.add(-1);
f=this.a.re();g=this.a.re();this.Ld=new a.hA(this.a,this.ka,!this.hx);this.zc.Hn(this.Ld);var k=new a.ga(0),h=new a.ga(0),n=0;new a.b;var q=this.a.cd;this.a.wb.kc();for(var l=this.a.wb.Ba[0].f,r,t,u=d.get(n++);-1!=u;){t=q.O(u,0);r=l[2*t];t=l[2*t+1];var w=r,v=t;do{var H=q.O(u,2),x=q.O(u,1);-1!=H&&(c=q.O(H,0),e=l[2*c],c=l[2*c+1],0>(v<c?-1:v>c?1:w<e?-1:w>e?1:0)&&(h.add(u),h.add(H)));-1!=x&&(c=q.O(x,0),e=l[2*c],c=l[2*c+1],0>(v<c?-1:v>c?1:w<e?-1:w>e?1:0)&&(h.add(x),h.add(x)));e=this.a.Ra(u,f);-1!=e&&(k.add(e),
this.a.lb(u,f,-1));e=this.a.Ra(u,g);-1!=e&&(k.add(e),this.a.lb(u,g,-1));u=d.get(n++);-1!==u&&(v=q.O(u,0),w=l[2*v],v=l[2*v+1])}while(-1!=u&&w===r&&v===t);w=1==k.size&&2==h.size;e=v=-1;H=0;for(x=k.size;H<x;H++){c=k.get(H);var m=this.zc.ge(c);-1==m||k.Nw(m)||(v=m);c=this.zc.bb(c);-1==c||k.Nw(c)||(e=c);if(-1!=v&&-1!=e)break}this.Ld.XF(t,r);H=0;for(x=k.size;H<x;H++)c=k.get(H),this.zc.kd(c,-1);k.clear(!1);if(!w&&-1!=v&&-1!=e&&this.SK(v,e)){b=!0;this.ei=this.Ld.rl();break}H=0;for(x=h.size;H<x;H+=2){t=h.get(H);
r=h.get(H+1);w?(t=this.zc.vs(v,e,t,!0),w=!1):t=this.zc.addElement(t,-1);if(this.Ld.Zf){this.ei=this.Ld.rl();b=!0;break}-1==this.a.Ra(r,f)?this.a.lb(r,f,t):this.a.lb(r,g,t)}if(b)break;h.cf(0)}this.a.bf(f);this.a.bf(g);return b};b.prototype.SK=function(a,b){this.Ld.compare(this.zc,this.zc.da(a),b);a=this.Ld.Zf;this.Ld.lq();return a};b.Gh=function(b){for(var c=b.$c;-1!=c;c=b.we(c))if(a.T.Kc(b.Lb(c)))return!0;return!1};b.Yk=function(a,c,e,d){if(!b.Gh(a))return!1;c=new b(d);c.a=a;c.ka=e;if(15>a.pd)a=c.LL();
else return c.ML();return a};b.$=function(a,c,e){return b.Yk(a,a.wC(),c,e)};b.DE=function(c,e,d,f,g){if(!b.Gh(e))return!1;var p=new b(g);p.a=e;p.ka=d;p.hx=c;if(p.EE())return null!=f&&f.aq(p.ei),!0;var k=new a.Bg;k.Oy();e.Oe(k);p=new b(g);p.a=e;p.ka=d;p.hx=c;c=p.EE();k.Oy();e.Oe(k);return c?(null!=f&&f.aq(p.ei),!0):!1};return b}();a.Zu=b})(z||(z={}));(function(a){(function(a){a[a.Left=0]="Left";a[a.Right=1]="Right";a[a.Coincident=2]="Coincident";a[a.Undefined=3]="Undefined";a[a.Uncut=4]="Uncut"})(a.ZG||
(a.ZG={}));var b=function(){return function(a,b,c,e,d,f,p,g,k,h,n){this.U=a;this.cu=b;this.Yq=c;this.ag=e;this.Il=h;this.xk=n}}();a.yT=b;var c=function(){function b(a,b){this.jE=a;this.Zh=b}b.prototype.nJ=function(b,c){var e=new a.b;this.Zh.w(b,e);var d=new a.b;this.Zh.w(c,d);e=e.compare(d);if(0!=e)return e;e=this.Zh.Ra(b,this.jE);d=this.Zh.Ra(c,this.jE);return e<d?-1:e==d?0:1};return b}(),e=function(){return function(a,b,c,e,d,f,p,g,k){this.ag=a;this.Yq=b;this.Lx=c;this.sE=e;this.Wh=d;this.xk=f;
this.Il=p;this.tE=g;this.RP=k}}();a.xT=e;var d=function(){function d(){}d.YG=function(c,e,f,p,g,k){if(e.s())c=new b(e,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),g.push(c);else{var A=new a.fd;A.Eb(e);A.Eb(f);a.aj.$(A,p,k,!0);e=0;f=A.re();for(p=A.$c;-1!=p;p=A.we(p))for(k=A.Vb(p);-1!=k;k=A.bc(k))for(var h=A.Cb(k),n=0,q=A.Ha(k);n<q;h=A.X(h),n++)A.lb(h,f,e++);e=d.qM(f,A);d.CI(c,e,A,g)}};d.qM=function(b,e){for(var f=e.pd,p=new a.ga(0),g=e.$c;-1!=g;g=e.we(g))for(var k=e.Vb(g);-1!=k;k=e.bc(k))for(var A=
e.Cb(k),h=0,n=e.Ha(k);h<n;A=e.X(A),h++)p.add(A);var q=new c(b,e);p.xd(0,f,function(a,b){return q.nJ(a,b)});b=[];var E=[],l=e.re(),K=e.re(),g=e.$c,k=e.we(g),n=new a.b,r=new a.b,t=p.get(0),u=e.rd(t),w=e.Vf(u);e.w(t,n);for(var v=1,A=0;v<f-1;){for(var U=!1,h=v;h<f;h++)if(h!=A){var H=p.get(h),x=e.rd(H),m=e.Vf(x);e.w(H,r);if(n.ub(r))w==g&&m==k&&(U=d.SI(l,K,e,b,E,u,t,x,H));else break}if(U||A==v-1){U&&A==v-1&&v--;if(++A==f)break;t=p.get(A);u=e.rd(t);w=e.Vf(u);e.w(t,n)}U||(v=A+1)}f=[];for(g=e.$c;-1!=g;g=e.we(g))for(k=
e.Vb(g);-1!=k;k=e.bc(k))for(p=e.Cb(k),h=0,n=e.Ha(k);h<n;p=e.X(p),h++){A=e.Ra(p,K);if(0<=A)for(;A<E.length&&E[A].ag==p;)f.push(E[A++]);A=e.Ra(p,l);if(0<=A)for(;A<b.length&&b[A].ag==p;)f.push(b[A++])}e.bf(l);e.bf(K);return f};d.SI=function(a,b,c,e,f,p,g,k,A){var h=c.hk(p),n=c.hk(k),q=c.Cb(p),E=c.Cb(k),l=c.Ua(g),K=c.Ua(A),r=!1,t=!1,u=!1,w=!1;g!=q&&(A!=E&&(r=d.VI(a,c,e,p,l,k,K)),A!=n&&(t=d.YI(a,c,e,p,l,k,A)));g!=h&&(A!=E&&(u=d.aJ(b,c,f,p,g,k,K,q)),A!=n&&(w=d.dJ(b,c,f,p,g,k,A,q)));r&&t&&u?(a=e.length-
1,2==f[w?f.length-2:f.length-1].Wh&&(e[a-1]=e[a],--e.length)):r&&t&&w&&2==f[f.length-1].Wh&&(f=e[e.length-1],--e.length,c.Ra(f.ag,a)==e.length&&c.lb(f.ag,a,-1));return r||t||u||w};d.VI=function(b,c,d,f,p,g,k){var A,h;h=new a.yb;var n=new a.yb,q=[0,0],E=[0,0];A=c.cc(p);null==A&&(c.Oc(p,h),A=h);h=c.cc(k);null==h&&(c.Oc(k,n),h=n);A=A.Ga(h,null,q,E,0);2>A&&(f=new e(p,f,q[0],NaN,A,k,g,E[0],NaN),d.push(f),f=c.Ra(p,b),0>f&&c.lb(p,b,d.length-1));return!0};d.YI=function(b,c,d,f,p,g,k){var A,h;h=new a.yb;var n=
new a.yb,q=[0,0],E=[0,0];A=c.cc(p);null==A&&(c.Oc(p,h),A=h);h=c.cc(k);null==h&&(c.Oc(k,n),h=n);A=A.Ga(h,null,q,E,0);return 2>A?(f=new e(p,f,q[0],NaN,A,k,g,E[0],NaN),d.push(f),f=c.Ra(p,b),0>f&&c.lb(p,b,d.length-1),!0):!1};d.aJ=function(b,c,d,f,p,g,k,A){var h,n;n=new a.yb;var q=new a.yb,E=[0,0],l=[0,0];h=c.cc(p);null==h&&(c.Oc(p,n),h=n);n=c.cc(k);null==n&&(c.Oc(k,q),n=q);h=h.Ga(n,null,E,l,0);if(2==h)return f=new e(p,f,E[0],E[1],h,k,g,l[0],l[1]),d.push(f),f=c.Ra(p,b),0>f&&c.lb(p,b,d.length-1),!0;q=!1;
p==A&&(f=new e(p,f,E[0],NaN,h,k,g,l[0],NaN),d.push(f),f=c.Ra(p,b),0>f&&c.lb(p,b,d.length-1),q=!0);return q};d.dJ=function(b,c,d,f,p,g,k,A){var h,n;n=new a.yb;var q=new a.yb,E=[0,0],l=[0,0];h=c.cc(p);null==h&&(c.Oc(p,n),h=n);n=c.cc(k);null==n&&(c.Oc(k,q),n=q);h=h.Ga(n,null,E,l,0);if(2==h)return f=new e(p,f,E[0],E[1],h,k,g,l[0],l[1]),d.push(f),f=c.Ra(p,b),0>f&&c.lb(p,b,d.length-1),!0;q=!1;p==A&&(f=new e(p,f,E[0],NaN,h,k,g,l[0],NaN),d.push(f),f=c.Ra(p,b),0>f&&c.lb(p,b,d.length-1),q=!0);return q};d.CI=
function(c,e,f,p){var g,k=[];k[0]=new a.b;k[1]=new a.b;k[2]=new a.b;k[3]=new a.b;var A=new a.b,h=new a.b,n=new a.b,q=new a.b,E=null;null!=p&&(E=new a.Ag,E.mq());var l,K=0,r=null,t=new a.yb;new a.yb;for(var u=f.Vb(f.$c);-1!=u;u=f.bc(u)){var w,v=4,U=-1,H,x,m,V=-1,y,z,X,C,B=-1,W=-1,F=NaN;w=!0;var G=!1,N=!0,M=!0,R=!0,P=0;m=u;y=0;for(var Y=f.Cb(u),S=f.Ha(u),O=0;O<S;Y=f.X(Y),O++){l=f.cc(Y);if(null==l){if(!f.Oc(Y,t))continue;l=t}-1==V&&(V=Y);for(var Q=0;K<e.length&&Y==e[K].ag;){U=e[K].Yq;H=e[K].ag;x=e[K].Lx;
z=e[K].Il;X=e[K].xk;C=e[K].tE;if(2==e[K].Wh){if(G||(m=U,V=H,y=x,B=z,W=X,F=C,v=2,null!=p?r=new a.Xa:P=0,R=!1,M=!0),x=e[K].sE,C=e[K].RP,null!=p?(l.Bi(Q,e[K].sE,E),r.Bc(E.get(),M)):P++,Q=x,G=!0,M=w=!1,K+1==e.length||2!=e[K+1].Wh||e[K+1].ag==H&&e[K+1].Lx!=Q)null!=p?(g=new b(r,2,U,H,x,v,m,V,y,z,X,C,B,W,F),p.push(g)):null.add(P),m=U,V=H,y=x,B=z,W=X,F=C,v=2,G=w=!1,M=R=!0}else{var T=f.X(H);if(K<e.length-1&&e[K+1].ag==T&&e[K+1].xk==X&&2==e[K+1].Wh)x!=Q&&(R&&(null!=p?r=new a.Xa:P=0),w=0<K&&e[K-1].Yq==U?1==
v?0:0==v?1:3:3,null!=p?(l.Bi(Q,x,E),r.Bc(E.get(),M),g=new b(r,w,U,H,x,v,m,V,y,z,X,C,B,W,F),p.push(g)):(P++,null.add(P)),Q=x,m=U,V=H,y=x,B=z,W=X,F=C,v=w,w=N=!1,M=R=!0);else if(!d.KK(c,f,e,K,A,h)){d.KG(f,e,K,u,Y,n,q);var aa=!1,T=!1;g=!0;if(!(A.ub(n)||h.ub(n)||A.ub(q)||h.ub(q))){k[0].J(A);k[1].J(h);k[2].J(n);k[3].J(q);k.sort(a.b.cq);var ya=k[0],Aa=k[1],Ca=k[2],ta=k[3];ya.ub(A)?Aa.ub(h)?c?(T=aa=!0,g=!1):aa=!1:ta.ub(h)?c?g=T=aa=!0:aa=!1:(aa=!0,g=Aa.ub(n)):Aa.ub(A)?Ca.ub(h)?c?(T=aa=!0,g=!1):aa=!1:ya.ub(h)?
c?g=T=aa=!0:aa=!1:(aa=!0,g=Ca.ub(n)):Ca.ub(A)?ta.ub(h)?c?(T=aa=!0,g=!1):aa=!1:Aa.ub(h)?c?g=T=aa=!0:aa=!1:(aa=!0,g=ta.ub(n)):ya.ub(h)?c?(T=aa=!0,g=!1):aa=!1:Ca.ub(h)?c?g=T=aa=!0:aa=!1:(aa=!0,g=ya.ub(n))}if(aa){aa=Y==H;if(x!=Q||aa&&0==Q)R&&(null!=p?r=new a.Xa:P=0),null!=p?(l.Bi(Q,x,E),r.Bc(E.get(),M)):P++;if(g)if(1!=v){if(x!=Q||aa&&0==Q)null!=p?(g=new b(r,1,U,H,x,v,m,V,y,z,X,C,B,W,F),p.push(g)):null.add(P);if(!T)v=1;else if(K==e.length-2||e[K+2].Yq!=U)v=0}else{if(x!=Q||aa&&0==Q)null!=p?(g=new b(r,3,
U,H,x,v,m,V,y,z,X,C,B,W,F),p.push(g)):null.add(P);v=1}else if(0!=v){if(x!=Q||aa&&0==Q)null!=p?(g=new b(r,0,U,H,x,v,m,V,y,z,X,C,B,W,F),p.push(g)):null.add(P);if(!T)v=0;else if(K==e.length-2||e[K+2].Yq!=U)v=1}else{if(x!=Q||aa&&0==Q)null!=p?(g=new b(r,3,U,H,x,v,m,V,y,z,X,C,B,W,F),p.push(g)):null.add(P);v=0}if(x!=Q||aa&&0==Q)Q=x,m=U,V=H,y=x,B=z,W=X,F=C,w=N=!1,M=R=!0}}}K++}1!=Q&&(R&&(null!=p?r=new a.Xa:P=0),null!=p?(l.Bi(Q,1,E),r.Bc(E.get(),M)):P++,M=R=!1,N=!0)}N&&(x=1,H=f.hk(u),H=f.Ua(H),X=z=-1,C=NaN,
w?null!=p?(g=new b(r,4,U,H,x,v,m,V,y,z,X,C,B,W,F),p.push(g)):null.add(P):(w=1==v?0:0==v?1:3,null!=p?(g=new b(r,w,U,H,x,v,m,V,y,z,X,C,B,W,F),p.push(g)):null.add(P)))}};d.KK=function(b,c,e,f,p,g){var k=e[f].tE;if(1==k)return d.GJ(b,c,e,f,p,g);if(0==k)return d.dK(b,c,e,f,p,g);throw a.g.wa();};d.GJ=function(b,c,e,d,f,p){var g=new a.yb,k=e[d].ag,A=e[d].Il,h=e[d].xk,n=-1,q=-1,E=-1,l=-1;if(!b&&0<d)var r=e[d-1],n=r.ag,q=r.Il,E=r.xk,l=r.Wh;var K=-1,t=-1,u=-1,w=-1;d<e.length-1&&(r=e[d+1],K=r.ag,t=r.Il,u=r.xk,
w=r.Wh);var v=c.X(k),r=c.X(h);if(!b)return 0<d&&n==k&&q==A&&E==r&&2==l||d<e.length-1&&K==v&&t==A&&u==r&&2==w?(b=c.cc(h),null==b&&(c.Oc(h,g),b=g),p.J(b.Pf(1)),f.qr(p),p.normalize(),f.normalize(),!1):d<e.length-1&&K==k&&t==A&&u==r?(b=c.cc(h),null==b&&(c.Oc(h,g),b=g),f.J(b.Pf(1)),b=c.cc(r),null==b&&(c.Oc(r,g),b=g),p.J(b.Pf(0)),f.Bp(),p.normalize(),f.normalize(),!1):!0;if(d==e.length-1||K!=k||t!=A||u!=r||2==w)return b=c.cc(h),null==b&&(c.Oc(h,g),b=g),p.J(b.Pf(1)),f.qr(p),p.normalize(),f.normalize(),!1;
b=c.cc(h);null==b&&(c.Oc(h,g),b=g);f.J(b.Pf(1));b=c.cc(r);null==b&&(c.Oc(r,g),b=g);p.J(b.Pf(0));f.Bp();p.normalize();f.normalize();return!1};d.dK=function(b,c,e,d,f,p){var g=new a.yb,k=e[d].ag,A=e[d].Il,h=e[d].xk,n=-1,q=-1,E=-1,l=-1;if(!b&&d<e.length-1)var r=e[d+1],n=r.ag,q=r.Il,E=r.xk,l=r.Wh;var K=-1,t=-1,u=-1,r=-1;0<d&&(r=e[d-1],K=r.ag,t=r.Il,u=r.xk,r=r.Wh);var w=c.X(k),v=c.Ua(h);return b?0==d||K!=k||t!=A||u!=v||2==r?(b=c.cc(h),null==b&&(c.Oc(h,g),b=g),p.J(b.Pf(0)),f.qr(p),p.normalize(),f.normalize(),
!1):!0:0<d&&K==k&&t==A&&u==v&&2==r||d<e.length-1&&n==w&&q==A&&E==v&&2==l?(b=c.cc(h),null==b&&(c.Oc(h,g),b=g),p.J(b.Pf(0)),f.qr(p),p.normalize(),f.normalize(),!1):!0};d.KG=function(b,c,e,d,f,p,g){var k=new a.yb,A=b.cc(f);null==A&&(b.Oc(f,k),A=k);e=c[e];c=e.ag;e=e.Lx;f=b.X(c);if(1==e)p.J(A.Pf(1)),-1!=f&&f!=b.hk(d)?(A=b.cc(f),null==A&&(b.Oc(f,k),A=k),g.J(A.Pf(0)),A=b.cc(c),null==A&&b.Oc(c,k)):g.J(p),p.Bp(),g.normalize(),p.normalize();else if(0==e)g.J(A.Pf(e)),p.qr(g),g.normalize(),p.normalize();else throw a.g.wa();
};return d}();a.$G=d})(z||(z={}));(function(a){(function(a){a[a.Linear=0]="Linear";a[a.Angular=1]="Angular";a[a.Area=2]="Area"})(a.RI||(a.RI={}));var b=function(){function b(a,b,c){this.Nc=b;this.Dj=c;this.wx=a}b.PC=function(a){return 0!==a.Nc?null:-1===a.wx?new b(-1,2,a.Dj*a.Dj):b.Qd(g[a.wx])};b.Qd=function(a){a=f[a];return void 0===a?null:a};b.EL=function(a,c,e){var d=null;if(void 0!==e&&null!==e)try{"EPSG"===e.values[0]&&(d=b.Qd(parseInt(e.values[1])))}catch(ca){}null===d&&(d=new b(-1,a,c));return d};
b.prototype.Qc=function(){return this.wx};b.prototype.rC=function(b){if(b.Nc!=this.Nc)throw a.g.xa();return this.Dj/b.Dj};b.ih=function(a,b,c){return b.rC(c)*a};b.OB=function(a,b,c,e,d){c=c.rC(e);for(e=0;e<b;e++)d[e]=a[e]*c};return b}();a.Tb=b;for(var c=[109402,4046.8564224,109403,4046.87260987425,109463,100,109401,1E4,109461,225E8,109460,25E8,109451,1E-4,109444,404.68564224000005,109424,404.6849341289498,109428,404.68493792602754,109416,404.67838076760535,109420,404.68423895571647,109448,404.683871963536,
109411,404.6872609874253,109450,.01,109408,3.34450944,109405,.09290304,109430,.09290354800069446,109423,.0929028774400711,109427,.09290287831176021,109441,.09290349665192114,109407,.09290137299531805,109440,.09290286332673177,109431,.09290274144751023,109432,.09290207073852812,109433,.09290279616016,109434,.09290273520025,109419,.09290271785025629,109447,.0929026336004445,109406,.09290341161327487,109453,6.4516E-4,109454,6.451625806477421E-4,109414,1E6,109445,.04046856422400001,109425,.04046849341289498,
109429,.04046849379260275,109417,.04046783807676053,109421,.04046842389557164,109449,.0404683871963536,109412,.04046872609874253,109404,1,109410,1.000027193184865,109413,2589998.4703195216,109452,1E-6,109409,3429904,109458,3434290.937856,109457,3434528.1495040003,109464,1.244521604938272E-7,109455,25.292852640000003,109456,25.29295381171408,109459,2.89612324,109439,2589988.110336,109462,.7168473118308245,109442,.83612736,109422,.83612589696064,109426,.836125904805842,109415,.8361123569578626,109435,
.836124673027592,109436,.836118636646753,109437,.8361251654414399,109438,.83612461680225,109418,.8361244606523066,109446,.8361237024040001,109443,.8361307045194736],e=[9103,2.908882086657216E-4,9104,4.84813681109536E-6,9102,.0174532925199433,9106,.01570796326794897,9105,.01570796326794897,9109,1E-6,9114,9.817477042468104E-4,1031,4.84813681109536E-9,9112,1.570796326794897E-4,9101,1,9113,1.570796326794897E-6],d=[109031,15E4,109461,109030,5E4,109460,1033,.01,109451,9097,20.1168,109444,9052,20.1167824,
109424,9062,20.116782494375872,109428,9038,20.1166195164,109416,9042,20.116765121552632,109420,9301,20.116756,109448,9033,20.11684023368047,109411,109005,.1,109450,9014,1.8288,109408,9002,.3048,109405,9070,.3048008333333334,109430,9051,.3047997333333333,109423,9061,.3047997347632708,109427,9095,.3048007491,109441,9005,.3047972654,109407,9094,.3047997101815088,109440,9080,.3047995102481469,109431,9081,.30479841,109432,9082,.3047996,109433,9083,.3047995,109434,9041,.304799471538676,109419,9300,.3047993333333334,
109447,9003,.3048006096012192,109406,109008,.0254,109453,109009,.0254000508001016,109454,9036,1E3,109414,9098,.201168,109445,9053,.201167824,109425,9063,.2011678249437587,109429,9039,.201166195164,109417,9043,.2011676512155263,109421,9302,.20116756,109449,9034,.2011684023368047,109412,9001,1,109404,9031,1.0000135965,109410,9035,1609.3472186944375,109413,1025,.001,109452,9030,1852,109409,109013,1853.184,109458,109012,1853.248,109457,109016,3.527777777777778E-4,109464,109010,5.0292,109455,109011,5.029210058420118,
109456,109014,1.7018,109459,9093,1609.344,109439,109015,.8466683600033867,109462,9096,.9144,109442,9050,.9143992,109422,9060,.9143992042898124,109426,9037,.9143917962000001,109415,9084,.9143985307444408,109435,9085,.91439523,109436,9086,.9143988,109437,9087,.9143985,109438,9040,.9143984146160287,109418,9099,.914398,109446,109002,.9144018288036576,109443,109001,.9144,109442,109003,20.1168,109444,109004,.201168,109445,109006,.01,109451,109007,.001,109452],f=[],g=[],k=0;k<c.length;k+=2)f[c[k]]=new b(c[k],
2,c[k+1]);c=null;for(k=0;k<e.length;k+=2)f[e[k]]=new b(e[k],1,e[k+1]);e=null;for(k=0;k<d.length;k+=3)f[d[k]]=new b(d[k],0,d[k+1]),g[d[k]]=d[k+2];d=null})(z||(z={}));(function(a){var b=function(){function a(){}a.prototype.set=function(a,b){void 0!==b?(this.Lf=a,this.Og=b):"number"===typeof a?(this.Lf=a,this.Og=0):(this.Lf=a.Lf,this.Og=a.Og)};a.prototype.value=function(){return this.Lf};a.prototype.sub=function(a){if("number"===typeof a){var b=this.Lf-a;a=this.Og+2.220446049250313E-16*Math.abs(b)}else b=
this.Lf-a.Lf,a=this.Og+a.Og+2.220446049250313E-16*Math.abs(b);this.Lf=b;this.Og=a};a.prototype.Ap=function(a){var b=this.Lf*a.Lf;this.Og=this.Og*Math.abs(a.Lf)+a.Og*Math.abs(this.Lf)+this.Og*a.Og+2.220446049250313E-16*Math.abs(b);this.Lf=b};a.prototype.eP=function(){return Math.abs(this.Lf)<=this.Og};a.prototype.Dq=function(){return this.eP()&&0!=this.Og};return a}();a.$k=b})(z||(z={}));var C=new z.b,B=new z.b,F=new z.b,G=new z.b,N=new z.b;(function(a){var b;(function(a){a[a.closedPath=1]="closedPath";
a[a.exteriorPath=2]="exteriorPath";a[a.ringAreaValid=4]="ringAreaValid"})(b||(b={}));var c=function(){function b(a,b,c,e,d,f,g){void 0!==b?(this.ab=a,this.mj=b,this.$j=c,this.zh=e,this.ua=f,this.mx=g,this.Pt=d):(this.ab=a.ab,this.mj=a.mj,this.$j=a.$j,this.zh=a.zh,this.ua=a.ua,this.mx=a.mx,this.Pt=a.Pt);this.JD=!0}b.prototype.next=function(){return this.JD?(this.JD=!1,this.zh):-1!=this.zh?(this.zh=this.ab.X(this.zh),this.ua++,-1!=this.zh&&this.zh!=this.Pt?this.zh:this.cQ()):-1};b.prototype.cQ=function(){this.$j=
this.ab.bc(this.$j);for(this.ua=0;-1!=this.mj;){for(;-1!=this.$j;this.$j=this.ab.bc(this.$j))if(this.Pt=this.zh=this.ab.Cb(this.$j),-1!=this.zh)return this.zh;this.mj=this.ab.we(this.mj);if(-1==this.mj)break;if(!this.mx||a.T.Kc(this.ab.Lb(this.mj)))this.$j=this.ab.Vb(this.mj)}return-1};b.UL=function(a,c,e,d,f,g,k){return new b(a,c,e,d,f,g,k)};return b}();a.CT=c;b=function(){function b(){this.Zm=this.Al=this.Ej=this.Mc=this.Jj=this.jn=this.fi=this.Rc=this.sh=this.wg=this.Ge=this.wp=this.zp=this.wb=
this.Hk=null;this.Xt=this.$c=-1;this.pd=0;this.kx=!1;this.wp=this.zp=this.wb=null}b.prototype.Fi=function(a){return null!=this.Ge?this.Ge[a]:null};b.prototype.Fh=function(a,b){if(null==this.Ge){if(null==b)return;this.Ge=[];for(var c=0,e=this.wb.F();c<e;c++)this.Ge.push(null)}this.Ge[a]=b};b.prototype.Mn=function(a,b){this.Rc.L(a,1,b)};b.prototype.Ln=function(a,b){this.Rc.L(a,2,b)};b.prototype.Iy=function(a,b){this.Rc.L(a,6,b)};b.prototype.Ho=function(a){return this.Rc.O(a,6)};b.prototype.Hu=function(a,
b){this.Rc.L(a,7,b)};b.prototype.bt=function(a){return this.Rc.O(a,0)};b.prototype.MF=function(a,b){this.Mc.L(a,1,b)};b.prototype.QF=function(a,b){this.Mc.L(a,0,b)};b.prototype.xC=function(a){return this.Mc.O(a,7)};b.prototype.Jn=function(a,b){this.Mc.L(a,3,b)};b.prototype.Kn=function(a,b){this.Mc.L(a,4,b)};b.prototype.jQ=function(b){null==this.Mc&&(this.Mc=new a.Fc(8));var c=this.Mc.be();this.Mc.L(c,2,b);this.Mc.L(c,5,0);this.Mc.L(c,6,0);this.Mc.L(c,7,c);return c};b.prototype.bN=function(a){this.Mc.Jc(a)};
b.prototype.lQ=function(b){null==this.Rc&&(this.Rc=new a.Fc(8),this.cd=new a.Fc(5),this.fi=new a.qd(0),this.jn=new a.qd(0));var c=this.Rc.be();this.Rc.L(c,0,c);this.Rc.L(c,3,0);this.Rc.L(c,6,0);this.Hu(c,b);c>=this.fi.size&&(b=16>c?16:a.I.truncate(3*c/2),this.fi.resize(b),this.jn.resize(b));this.fi.set(c,0);this.jn.set(c,0);return c};b.prototype.iC=function(a){this.Rc.Jc(a)};b.prototype.dw=function(a){this.cd.Jc(a);this.pd--};b.prototype.mQ=function(b){null==this.Rc&&(this.Rc=new a.Fc(8),this.cd=
new a.Fc(5),this.fi=new a.qd(0),this.jn=new a.qd(0));var c=this.cd.be(),e=0<=b?b:c;this.cd.L(c,0,e);if(0>b){if(e>=this.wb.F()){b=16>e?16:a.I.truncate(3*e/2);this.wb.resize(b);if(null!=this.Ge)for(var d=0;d<b;d++)this.Ge.push(null);null!=this.wg&&this.wg.resize(b);this.zp=this.wb.mc(0)}this.wb.ic(e,-1E38,-1E38);null!=this.Ge&&(this.Ge[e]=null);null!=this.wg&&this.wg.write(e,1)}this.cd.L(c,4,2*e);this.pd++;return c};b.prototype.vl=function(a,b,c){var e=-1!=b?this.Ua(b):this.hk(a),d=-1!=e?this.X(e):
-1,f=this.mQ(null==c?this.pd:-1),p=this.gb(f);null!=c&&this.wb.Iu(p,c);this.im(f,a);this.Sc(f,d);this.Tc(f,e);-1!=d&&this.Tc(d,f);-1!=e&&this.Sc(e,f);c=this.vc(a);e=this.Cb(a);-1==b&&this.Wi(a,f);b==e&&this.Dh(a,f);c&&-1==d&&(this.Sc(f,f),this.Tc(f,f));this.hm(a,this.Ha(a)+1);a=this.Vf(a);this.Pk(a,this.F(a)+1);return f};b.prototype.Fo=function(){null==this.Zm&&(this.Zm=new a.Va(this.wb.description));return this.Zm};b.prototype.Pp=function(a,b){this.Mc.L(a,2,this.Mc.O(a,2)&-134217729||(1==b?134217728:
0))};b.prototype.Cm=function(a){return 0!=(this.Mc.O(a,2)&134217728)?1:0};b.prototype.MJ=function(a){var b=this.jg(a.D(),a.description);1736==a.D()&&this.Pp(b,a.Cm());this.WA(b,a);return b};b.prototype.NJ=function(a){var b=this.jg(a.D(),a.description);this.XA(b,a);return b};b.prototype.TQ=function(b,c){null==this.Rc&&(this.Rc=new a.Fc(8),this.cd=new a.Fc(5),this.fi=new a.qd(0),this.jn=new a.qd(0));this.Rc.de(this.Rc.Xc+b);this.cd.de(this.cd.Xc+c);this.fi.xb(this.fi.size+b);this.jn.xb(this.jn.size+
b)};b.prototype.WA=function(b,c){this.TQ(c.ea(),c.F());this.Hk.Pd(c,0,c.F());this.zp=this.wb.mc(0);for(var e=null!=this.Ge&&null!=c.Fe,d=0,f=c.ea();d<f;d++)if(!(2>c.Ha(d))){var p=this.Cf(b,-1);this.Gn(p,c.vc(d));for(var g=c.Ea(d),k=c.Dc(d);g<k;g++){var A=this.vl(p,-1,null);if(e)if(A=this.gb(A),0!=(c.NC(g)&1))this.Fh(A,null);else{var h=new a.Ag;c.cc(g,h,!0);this.Fh(A,h.get())}}}};b.prototype.XA=function(a,b){this.Hk.Pd(b,0,b.F());this.zp=this.wb.mc(0);a=this.Cf(a,-1);var c=0;for(b=b.F();c<b;c++)this.vl(a,
-1,null)};b.prototype.DS=function(b,c,e){var d=this.X(b);if(-1==d)throw a.g.wa();for(var f=this.Fo(),p=this.rd(b),g=0,k=c.kk(e);g<k;g++){var A=this.gb(b),h=this.X(b),n=c.Io(e,g);0==g&&(n.En(f),this.bh(b,f));322==n.D()?this.Fh(A,null):this.Fh(A,a.T.Yj(n));n.Bn(f);g<k-1?b=this.vl(p,h,f):this.bh(d,f)}};b.prototype.CS=function(b,c,e){var d=this.X(b);if(-1==d)throw a.g.wa();for(var f=this.Fo(),p=this.rd(b),g=0,k=c.kk(e);g<k;g++){var A=this.gb(b),h=this.X(b),n=c.Io(e,k-g-1);0==g&&(n.Bn(f),this.bh(b,f));
322==n.D()?this.Fh(A,null):this.Fh(A,a.T.Yj(n));n.En(f);g<k-1?b=this.vl(p,h,f):this.bh(d,f)}};b.prototype.wC=function(){var b=new a.i;b.Ja();for(var c=this.Gp(),e=new a.b,d=!0,f=c.next();-1!=f;f=c.next())this.w(f,e),d?b.Db(e.x,e.y):b.Oj(e.x,e.y),d=!1;return b};b.prototype.Eb=function(b){var c=b.D();if(a.T.Kc(c))return this.MJ(b);if(550==c)return this.NJ(b);throw a.g.wa();};b.prototype.YJ=function(b,c){var e=c.D();if(a.T.Kc(e))this.WA(b,c);else if(550==e)this.XA(b,c);else throw a.g.wa();};b.prototype.QJ=
function(b,c){var e=this.jg(1736,b.description);if(2>b.Ha(c))return e;this.Hk.Pd(b,b.Ea(c),b.Dc(c));this.zp=this.wb.mc(0);var d=this.Cf(e,-1);this.Gn(d,b.vc(c)||!0);var f=null!=this.Ge&&null!=b.Fe,p=b.Ea(c);for(c=b.Dc(c);p<c;p++){var g=this.vl(d,-1,null);if(f)if(g=this.gb(g),0!=(b.NC(p)&1))this.Fh(g,null);else{var k=new a.Ag;b.cc(p,k,!0);this.Fh(g,k.get())}}return e};b.prototype.hf=function(b){var c=this.Lb(b),e=a.sH.jg(c,this.Hk.description),d=this.F(b);if(0==d)return e;if(a.T.Kc(c)){for(var c=this.ea(b),
f=a.Ac.Dg(c+1),p=a.Ac.to(c+1,0),g=e.description,k=0,h=g.Aa;k<h;k++){for(var n=g.Hd(k),q=a.pa.Wa(n),l=a.Ac.Tv(n,d),E=this.wb.mc(n),r=0,t=0,u=0,w=this.Vb(b);-1!=w;w=this.bc(w)){var v=0;this.vc(w)&&(v|=1);this.VO(w)&&(v|=4);0!=v&&p.xy(t,v);var H=this.Ha(w);f.write(t++,u);u+=H;if(0==n)for(var H=E,x=l,m=new a.b,v=this.Cb(w);r<u;v=this.X(v),r++){var y=this.gb(v);H.ec(2*y,m);x.Rn(2*r,m)}else for(v=this.Cb(w);r<u;v=this.X(v),r++)for(y=this.gb(v),x=0;x<q;x++)m=E.Bh(y*q+x),l.Uk(r*q+x,m)}e.bm(n,l);f.write(c,
d)}e.NF(p);e.OF(f);e.ce(16777215)}else if(550==c){g=e.description;e.resize(d);k=0;for(h=g.Aa;k<h;k++){n=g.Hd(k);q=a.pa.Wa(n);l=e.mc(n);E=this.wb.mc(n);r=0;w=this.Vb(b);H=this.Ha(w);for(v=this.Cb(w);r<H;v=this.X(v),r++)for(y=this.gb(v),x=0;x<q;x++)m=E.Bh(y*q+x),l.Uk(r*q+x,m);e.bm(n,l)}e.ce(16777215)}return e};b.prototype.sy=function(a){for(var b=this.Vb(a);-1!=b;b=this.Cr(b));var b=this.aO(a),c=this.we(a);-1!=b?this.MF(b,c):this.$c=c;-1!=c?this.QF(c,b):this.Xt=b;this.bN(a)};b.prototype.jg=function(b,
c){return void 0===c?this.QB(b,a.Od.Tf()):this.QB(b,c)};b.prototype.QB=function(b,c){b=this.jQ(b);null==this.wb?this.wb=this.Hk=new a.pe(c):this.Hk.Ik(c);this.wp=this.Hk.description;this.kx=1<this.wp.Aa;-1==this.$c?this.$c=b:(this.QF(b,this.Xt),this.MF(this.Xt,b));return this.Xt=b};b.prototype.we=function(a){return this.Mc.O(a,1)};b.prototype.aO=function(a){return this.Mc.O(a,0)};b.prototype.Lb=function(a){return this.Mc.O(a,2)&2147483647};b.prototype.EF=function(b,c,e){c=this.Ej[c];b=this.xC(b);
b>=c.size&&c.resize(Math.max(a.I.truncate(1.25*b),16),-1);c.write(b,e)};b.prototype.yC=function(a,b){a=this.xC(a);b=this.Ej[b];return a<b.size?b.read(a):-1};b.prototype.RB=function(){null==this.Ej&&(this.Ej=[]);for(var b=0;b<this.Ej.length;b++)if(null==this.Ej[b])return this.Ej[b]=a.Ac.Dg(0),b;this.Ej.push(a.Ac.Dg(0));return this.Ej.length-1};b.prototype.tR=function(a){this.Ej[a]=null};b.prototype.Vb=function(a){return this.Mc.O(a,3)};b.prototype.Ys=function(a){return this.Mc.O(a,4)};b.prototype.F=
function(a){return this.Mc.O(a,5)};b.prototype.ea=function(a){return this.Mc.O(a,6)};b.prototype.xo=function(b,c,e){for(var d=0,f=this.$c;-1!=f;f=this.we(f)){var p=this.Lb(f);if(a.T.Kc(p)&&(!e||1736==p))for(var p=1736==this.Lb(f),g=this.Vb(f);-1!=g;){for(var k=0,A=this.Cb(g);k<a.I.truncate(this.Ha(g)/2);){var h=this.X(A);if(-1==h)break;var n=this.gb(A),q=this.Fi(n);null!=q?n=q.$b():(q=this.gb(h),n=this.wb.mv(n,q));n<=b?(0==n?0==d&&(d=-1):d=1,h!=this.hk(g)&&(this.Zy(h,A),this.vf(h,!0))):A=this.X(A);
k++}k=this.Cb(g);for(A=this.vc(g)?k:this.hk(g);0<this.Ha(g);)if(h=this.Ua(A),-1!=h){var l=this.gb(h),q=this.Fi(l);null!=q?n=q.$b():(n=this.gb(A),n=this.wb.mv(n,l));if(n<=b)0==n?0==d&&(d=-1):d=1,this.Zy(h,A),this.vf(h,!1),k==h&&(k=this.Cb(g));else if(A=this.Ua(A),A==k)break}else{this.vf(A,!0);0==d&&(d=-1);break}A=this.Ha(g);c&&(p?3>A:2>A)?(g=this.Cr(g),d=0<A?1:0==d?-1:d):g=this.bc(g)}}return d};b.prototype.Zy=function(a,b){var c=this.gb(a),e=this.gb(b);null!=this.wg&&(c=this.wg.read(c),this.wg.write(e,
c));if(null!=this.sh)for(e=0,c=this.sh.length;e<c;e++)if(null!=this.sh[e]){var d=this.Ra(a,e);-1!=d&&this.lb(b,e,d)}};b.prototype.Mr=function(b,c,e){var d=0,f=this.X(b);if(-1==f)throw a.g.wa();for(var p=this.gb(b),g=this.gb(f),k=this.Fi(p),A=null==k?this.wb.mv(p,g):k.$b(),h=0;h<e;h++){var n=c[h];if(0<n&&1>n){var q=n;null!=k&&(q=0<A?k.rA(n)/A:0);this.wb.vJ(p,g,q,this.Fo());var l=this.vl(this.rd(b),f,this.Fo());d++;if(null!=k){var E=k.xm(0,n),q=this.gb(this.Ua(l));this.Fh(q,E);this.Yi(l,E.oc());if(h==
e-1||1==c[h+1])n=k.xm(n,1),this.Fh(q,n)}}}return d};b.prototype.bh=function(a,b){var c=this.gb(a);this.wb.Iu(c,b);c=this.Fi(c);null!=c&&c.setStart(b);a=this.Ua(a);-1!=a&&(a=this.gb(a),null!=this.Fi(a)&&c.setEnd(b))};b.prototype.Jk=function(a,b){a=this.gb(a);this.wb.Sd(a,b)};b.prototype.Yi=function(a,b){this.ic(a,b.x,b.y)};b.prototype.ic=function(a,b,c){var e=this.gb(a);this.wb.ic(e,b,c);e=this.Fi(e);null!=e&&e.Ny(b,c);a=this.Ua(a);-1!=a&&(a=this.gb(a),null!=this.Fi(a)&&e.Ok(b,c))};b.prototype.w=function(a,
b){this.wb.w(this.cd.O(a,0),b)};b.prototype.uc=function(a,b){this.wb.Ba[0].ec(2*this.cd.O(a,0),b)};b.prototype.Fa=function(b){var c=new a.b;this.wb.w(this.cd.O(b,0),c);return c};b.prototype.SC=function(a,b){this.zp.ec(2*a,b)};b.prototype.ld=function(a,b,c){return this.wb.ld(a,this.gb(b),c)};b.prototype.setAttribute=function(a,b,c,e){this.wb.setAttribute(a,this.gb(b),c,e)};b.prototype.gb=function(a){return this.cd.O(a,0)};b.prototype.mk=function(b){var c=new a.b;this.w(b,c);return c.y};b.prototype.Cq=
function(a,b){a=this.gb(a);b=this.gb(b);var c=this.wb.Ba[0].f;return c[2*a]===c[2*b]&&c[2*a+1]===c[2*b+1]};b.prototype.pt=function(a,b){a=this.gb(a);var c=this.wb.Ba[0].f;return c[2*a]===b.x&&c[2*a+1]===b.y};b.prototype.pS=function(b,c){1>c&&(c=1);if(null==this.wg){if(1==c)return;this.wg=a.Ac.kl(this.wb.F(),1)}b=this.gb(b);b>=this.wg.size&&this.wg.resize(b+1,1);this.wg.write(b,c)};b.prototype.RC=function(a){a=this.gb(a);return null==this.wg||a>=this.wg.size?1:this.wg.read(a)};b.prototype.lb=function(a,
b,c){b=this.sh[b];a=this.gb(a);b.size<this.wb.F()&&b.resize(this.wb.F(),-1);b.write(a,c)};b.prototype.Ra=function(a,b){a=this.gb(a);b=this.sh[b];return a<b.size?b.read(a):-1};b.prototype.re=function(){null==this.sh&&(this.sh=[]);for(var b=0;b<this.sh.length;b++)if(null==this.sh[b])return this.sh[b]=a.Ac.Dg(0,-1),b;this.sh.push(a.Ac.Dg(0,-1));return this.sh.length-1};b.prototype.bf=function(a){this.sh[a]=null};b.prototype.cc=function(a){return null!=this.Ge?(a=this.gb(a),this.Ge[a]):null};b.prototype.Oc=
function(b,c){var e=this.cd.O(b,2);if(-1==e)return!1;if(this.kx){var d=new a.Va;this.Jk(b,d);c.setStart(d);this.Jk(e,d);c.setEnd(d)}else this.wb.uc(this.cd.O(b,0),C),c.gl(0,C),this.wb.uc(this.cd.O(e,0),C),c.gl(1,C);return!0};b.prototype.gR=function(b,c,e){if(this.kx){var d=new a.Va;this.Jk(b,d);e.setStart(d);this.Jk(c,d);e.setEnd(d)}else this.wb.uc(b,C),e.gl(0,C),this.wb.uc(c,C),e.gl(1,C)};b.prototype.Cf=function(b,c){var e;if(-1!=c){if(b!=this.Vf(c))throw a.g.wa();e=this.wq(c)}else e=this.Ys(b);
var d=this.lQ(b);-1!=c&&this.Mn(c,d);this.Ln(d,c);this.Mn(d,e);-1!=e?this.Ln(e,d):this.Jn(b,d);-1==c&&this.Kn(b,d);this.gm(b,this.ea(b)+1);return d};b.prototype.aD=function(a,b,c,e){a=this.Cf(a,-1);for(var d=0,f=b,p=!1;f==c&&(p=!0),this.im(f,a),d++,f=this.X(f),f!=b;);this.Gn(a,!0);this.hm(a,d);p&&(b=c);this.Dh(a,b);this.Wi(a,this.Ua(b));this.Jr(a,!1);null!=e&&(e[0]=p);return a};b.prototype.Cr=function(a){var b=this.wq(a),c=this.bc(a),e=this.Vf(a);-1!=b?this.Ln(b,c):this.Jn(e,c);-1!=c?this.Mn(c,b):
this.Kn(e,b);this.bL(a);this.gm(e,this.ea(e)-1);this.iC(a);return c};b.prototype.bL=function(a){var b=this.Cb(a);if(-1!=b){for(var c=0,e=this.Ha(a);c<e;c++){var d=b,b=this.X(b);this.dw(d)}b=this.Vf(a);this.Pk(b,this.F(b)-this.Ha(a))}this.hm(a,0)};b.prototype.bc=function(a){return this.Rc.O(a,2)};b.prototype.wq=function(a){return this.Rc.O(a,1)};b.prototype.Ha=function(a){return this.Rc.O(a,3)};b.prototype.vc=function(a){return 0!=(this.Ho(a)&1)};b.prototype.Gn=function(a,b){if(this.vc(a)!=b){if(0<
this.Ha(a)){var c=this.Cb(a),e=this.hk(a);b?(this.Sc(e,c),this.Tc(c,e)):(this.Sc(e,-1),this.Tc(c,-1));c=this.gb(e);this.Fh(c,null)}this.Iy(a,(this.Ho(a)|1)-1|(b?1:0))}};b.prototype.Vf=function(a){return this.Rc.O(a,7)};b.prototype.VO=function(a){return 0!=(this.Ho(a)&2)};b.prototype.Dy=function(a,b){this.Iy(a,(this.Ho(a)|2)-2|(b?2:0))};b.prototype.Gw=function(b){if(this.bP(b))return this.fi.get(this.bt(b));var c=new a.yb,e=this.Cb(b);if(-1==e)return 0;var d=new a.b;this.w(e,d);for(var f=0,p=0,g=this.Ha(b);p<
g;p++,e=this.X(e)){var k=this.cc(e);if(null==k){if(!this.Oc(e,c))continue;k=c}f+=k.kv(d.x,d.y)}this.Jr(b,!0);this.fi.set(this.bt(b),f);return f};b.prototype.Rp=function(a,b,c){b=this.Jj[b];a=this.bt(a);b.size<this.fi.size&&b.resize(this.fi.size,-1);b.write(a,c)};b.prototype.Ei=function(a,b){a=this.bt(a);b=this.Jj[b];return a<b.size?b.read(a):-1};b.prototype.Uv=function(){null==this.Jj&&(this.Jj=[]);for(var b=0;b<this.Jj.length;b++)if(null==this.Jj[b])return this.Jj[b]=a.Ac.Dg(0),b;this.Jj.push(a.Ac.Dg(0));
return this.Jj.length-1};b.prototype.ty=function(a){this.Jj[a]=null};b.prototype.bQ=function(b,c,e){if(-1==e)throw a.g.N();if(c!=e){var d=this.bc(e),f=this.wq(e),p=this.Vf(e);-1==f?this.Jn(p,d):this.Ln(f,d);-1==d?this.Kn(p,f):this.Mn(d,f);this.Pk(p,this.F(p)-this.Ha(e));this.gm(p,this.ea(p)-1);f=-1==c?this.Ys(b):this.wq(c);this.Mn(e,f);this.Ln(e,c);-1==c?this.Kn(b,e):this.Mn(c,e);-1==f?this.Jn(b,e):this.Ln(f,e);this.Pk(b,this.F(b)+this.Ha(e));this.gm(b,this.ea(b)+1);this.Hu(e,b)}};b.prototype.zi=
function(a,b){this.wb.Sd(this.gb(b),this.Fo());this.vl(a,-1,this.Fo())};b.prototype.vf=function(b,c){var e=this.rd(b),d=this.Ua(b),f=this.X(b);-1!=d&&this.Sc(d,f);var p=this.Ha(e);b==this.Cb(e)&&this.Dh(e,1<p?f:-1);-1!=f&&this.Tc(f,d);b==this.hk(e)&&this.Wi(e,1<p?d:-1);if(-1!=d&&-1!=f){var d=this.gb(d),g=this.gb(f);c?(c=this.Fi(d),null!=c&&(d=new a.b,this.wb.w(g,d),c.vd(d))):(g=this.gb(b),c=this.Fi(g),this.Fh(d,c),null!=c&&(d=this.wb.Fa(d),c.ed(d)))}this.hm(e,p-1);e=this.Vf(e);this.Pk(e,this.F(e)-
1);this.dw(b);return f};b.prototype.Cb=function(a){return this.Rc.O(a,4)};b.prototype.hk=function(a){return this.Rc.O(a,5)};b.prototype.X=function(a){return this.cd.O(a,2)};b.prototype.Ua=function(a){return this.cd.O(a,1)};b.prototype.rd=function(a){return this.cd.O(a,3)};b.prototype.Ub=function(a,b){return this.vl(a,-1,b)};b.prototype.Gp=function(b){if(void 0===b)return this.Gp(!1);if(b instanceof c)return new c(b);var e,d=-1,f=-1,p=-1,g=0,k=!1;for(e=this.$c;-1!=e;e=this.we(e))if(!b||a.T.Kc(this.Lb(e))){for(d=
this.Vb(e);-1!=d;d=this.bc(d))if(p=f=this.Cb(d),g=0,-1!=f){k=!0;break}if(k)break}return c.UL(this,e,d,f,p,g,b)};b.prototype.Oe=function(a){this.Hk.Oe(a);if(null!=this.Ge)for(var b=0,c=this.Ge.length;b<c;b++)null!=this.Ge[b]&&this.Ge[b].Oe(a)};b.prototype.Tp=function(a,b,c,e){e?this.DS(a,b,c):this.CS(a,b,c)};b.prototype.Tc=function(a,b){this.cd.L(a,1,b)};b.prototype.Sc=function(a,b){this.cd.L(a,2,b)};b.prototype.im=function(a,b){this.cd.L(a,3,b)};b.prototype.hm=function(a,b){this.Rc.L(a,3,b)};b.prototype.Dh=
function(a,b){this.Rc.L(a,4,b)};b.prototype.Wi=function(a,b){this.Rc.L(a,5,b)};b.prototype.gm=function(a,b){this.Mc.L(a,6,b)};b.prototype.Pk=function(a,b){this.Mc.L(a,5,b)};b.prototype.lF=function(a){var b=a;do{var c=this.X(b);this.Sc(b,this.Ua(b));this.Tc(b,c);b=c}while(b!=a)};b.prototype.ZF=function(a){this.pd=a};b.prototype.yu=function(a){var b=this.wq(a),c=this.bc(a),e=this.Vf(a);-1!=b?this.Ln(b,c):this.Jn(e,c);-1!=c?this.Mn(c,b):this.Kn(e,b);this.Dh(a,-1);this.Wi(a,-1);this.iC(a)};b.prototype.Ui=
function(b,c){var e=this.Ua(b),d=this.X(b);-1!=e&&this.Sc(e,d);-1!=d&&this.Tc(d,e);if(-1!=e&&-1!=d)if(e=this.gb(e),d=this.gb(d),c){if(c=this.Fi(e),null!=c){var f=new a.b;this.wb.w(d,f);c.vd(f)}}else d=this.gb(b),c=this.Fi(d),this.Fh(e,c),null!=c&&(f=new a.b,this.wb.w(e,f),c.ed(f));this.dw(b)};b.prototype.bP=function(a){return 0!=(this.Ho(a)&4)};b.prototype.Jr=function(a,b){this.Iy(a,(this.Ho(a)|4)-4|(b?4:0))};b.prototype.Mu=function(a,b){var c=this.cd.f;this.wb.kc();var e=this.wb.Ba[0].f;a.xd(0,b,
function(a,b){a=c[5*a];b=c[5*b];var d=e[2*a];a=e[2*a+1];var f=e[2*b];b=e[2*b+1];return a<b?-1:a>b?1:d<f?-1:d>f?1:0})};b.prototype.pO=function(){for(var b=this.$c;-1!=b;b=this.we(b))if(!a.T.Kc(this.Lb(b)))return!0;return!1};b.prototype.Vy=function(a,b){for(var c=this.Vb(a),e=this.Vb(b),d=this.Ys(a),f=this.Ys(b),p=this.Vb(a);-1!=p;p=this.bc(p))this.Hu(p,b);for(p=this.Vb(b);-1!=p;p=this.bc(p))this.Hu(p,a);this.Jn(a,e);this.Jn(b,c);this.Kn(a,f);this.Kn(b,d);c=this.F(a);e=this.ea(a);d=this.ea(b);this.Pk(a,
this.F(b));this.Pk(b,c);this.gm(a,d);this.gm(b,e);c=this.Mc.O(a,2);this.Mc.L(a,2,this.Mc.O(b,2));this.Mc.L(b,2,c)};return b}();a.fd=b})(z||(z={}));(function(a){var b=function(b){function c(c,e,d,f){b.call(this);this.R=new a.i;void 0===c?this.MB():"number"===typeof c?this.AL(c,e,d,f):c instanceof a.Va?void 0!==e?this.Ks(c,e,d):this.BL(c):c instanceof a.pa?void 0!==e?this.DL(c,e):this.CL(c):c instanceof a.i?this.zL(c):this.MB()}w(c,b);c.prototype.Ks=function(b,c,e){this.description=a.Od.Tf();this.R.Ja();
b.s()||this.sv(b,c,e)};c.prototype.zL=function(b){this.description=a.Od.Tf();this.R.K(b);this.R.normalize()};c.prototype.CL=function(b){if(null==b)throw a.g.N();this.description=b;this.R.Ja()};c.prototype.DL=function(b,c){if(null==b)throw a.g.N();this.description=b;this.R.K(c);this.R.normalize()};c.prototype.MB=function(){this.description=a.Od.Tf();this.R.Ja()};c.prototype.BL=function(b){this.description=a.Od.Tf();this.R.Ja();b.s()||this.sv(b)};c.prototype.AL=function(b,c,e,d){this.description=a.Od.Tf();
this.K(b,c,e,d)};c.prototype.K=function(a,b,c,e){this.qc();if("number"===typeof a)this.R.K(a,b,c,e);else for(this.Ja(),b=0,c=a.length;b<c;b++)this.Db(a[b])};c.prototype.Cu=function(b){this.qc();if(!b.dP())throw a.g.N();this.R.K(b)};c.prototype.Ja=function(){this.qc();this.R.Ja()};c.prototype.s=function(){return this.R.s()};c.prototype.aa=function(){return this.R.aa()};c.prototype.ba=function(){return this.R.ba()};c.prototype.lw=function(){return this.R.lw()};c.prototype.Vs=function(){return this.R.Vs()};
c.prototype.qq=function(){return this.R.Af()};c.prototype.Db=function(b){if(b instanceof a.b)this.qc(),this.R.Db(b);else if(b instanceof a.i)this.qc(),this.R.Db(b);else if(b instanceof a.Va){if(this.qc(),!b.sc()){var e=b.description;this.description!=e&&this.Ik(e);if(this.s())this.sv(b);else{this.R.Db(b.w());for(var d=1,f=e.Aa;d<f;d++)for(var p=e.Fd(d),g=a.pa.Wa(p),k=0;k<g;k++){var h=b.ld(p,k),n=this.Ah(p,k);n.Db(h);setInterval(p,k,n)}}}}else if(b instanceof c&&!b.s())for(e=b.description,e!=this.description&&
this.Ik(e),this.R.Db(b.R),d=1,f=e.Aa;d<f;d++)for(p=e.Hd(d),g=a.pa.Wa(p),k=0;k<g;k++)h=b.Ah(p,k),n=this.Ah(p,k),n.Db(h),setInterval(p,k,n)};c.prototype.sv=function(b,c,e){if(void 0!==c){this.R.K(b.w(),c,e);c=b.description;e=1;for(var d=c.Aa;e<d;e++)for(var f=c.Fd(e),p=a.pa.Wa(f),g=0;g<p;g++){var k=b.ld(f,g);this.setInterval(f,g,k,k)}}else for(this.R.K(b.fa[0],b.fa[1]),c=b.description,e=1,d=c.Aa;e<d;e++)for(f=c.Fd(e),p=a.pa.Wa(f),g=0;g<p;g++)k=b.ld(f,g),this.setInterval(f,g,k,k)};c.prototype.setInterval=
function(b,c,e,d){var f=null;"number"===typeof e?f=new a.Nd(e,d):f=e;this.qc();if(0==b)if(0==c)this.R.v=f.qa,this.R.B=f.va;else if(1==c)this.R.C=f.qa,this.R.G=f.va;else throw a.g.Uc();else this.DA(0,b,c,f.qa),this.DA(1,b,c,f.va)};c.prototype.P=function(a,b){this.qc();this.R.P(a,b)};c.prototype.Oe=function(b){if(b instanceof a.Bg)this.qc(),b.$y(this.R);else if(this.qc(),!this.R.s()){var c=new a.fH;this.Cn(c);c.UO()?c.Ja():b.$y(c)}};c.prototype.copyTo=function(b){if(b.D()!=this.D())throw a.g.N();b.qc();
b.description=this.description;b.R.K(this.R);b.fa=null;if(null!=this.fa){b.ns();for(var c=0;c<2*(this.description.le.length-2);c++)b.fa[c]=this.fa[c]}};c.prototype.Pa=function(){return new c(this.description)};c.prototype.Mh=function(){return this.R.rN()};c.prototype.$b=function(){return this.R.CC()};c.prototype.D=function(){return 197};c.prototype.fb=function(){return 2};c.prototype.Fp=function(a){this.copyTo(a)};c.prototype.o=function(a){a.v=this.R.v;a.C=this.R.C;a.B=this.R.B;a.G=this.R.G};c.prototype.Cn=
function(a){a.v=this.R.v;a.C=this.R.C;a.B=this.R.B;a.G=this.R.G;a.K(this.R.v,this.R.C,this.yd(0,1,0),this.R.B,this.R.G,this.yd(1,1,0))};c.prototype.Ah=function(b,c){var e=new a.Nd;e.K(this.yd(0,b,c),this.yd(1,b,c));return e};c.prototype.uf=function(b,c){c.Qf(this.description);var e=this.description.Aa-1;switch(b){case 0:for(b=0;b<e;b++)for(var d=this.description.Hd(b),f=a.pa.Wa(d),p=0;p<f;p++)c.setAttribute(d,p,this.yd(0,d,p));c.ic(this.R.v,this.R.C);break;case 1:for(b=0;b<e;b++)for(d=this.description.Hd(b),
f=a.pa.Wa(d),p=0;p<f;p++)c.setAttribute(d,p,this.yd(1,d,p));c.ic(this.R.v,this.R.G);break;case 2:for(b=0;b<e;b++)for(d=this.description.Hd(b),f=a.pa.Wa(d),p=0;p<f;p++)c.setAttribute(d,p,this.yd(0,d,p));c.ic(this.R.B,this.R.G);break;case 3:for(b=0;b<e;b++)for(d=this.description.Hd(b),f=a.pa.Wa(d),p=0;p<f;p++)c.setAttribute(d,p,this.yd(1,d,p));c.ic(this.R.B,this.R.C);break;default:throw a.g.Uc();}};c.prototype.vu=function(a,b){a=this.R.vu(a);b.ma(a.x,a.y)};c.prototype.zN=function(a,b){return b*(a.up-
2)};c.prototype.mC=function(b,c,e){if(this.R.s())throw a.g.ra("empty geometry");if(0==c)return 0!=b?0!=e?this.R.G:this.R.B:0!=e?this.R.C:this.R.v;if(e>=a.pa.Wa(c))throw a.g.N();var d=this.description.zf(c);this.ns();return 0<=d?this.fa[this.zN(this.description,b)+this.description.XN(d)-2+e]:a.pa.ue(c)};c.prototype.ns=function(){this.qc();if(null==this.fa&&2<this.description.le.length){this.fa=[];for(var b=c.V(this.description,0),e=c.V(this.description,1),d=0,f=1,g=this.description.Aa;f<g;f++)for(var k=
this.description.Hd(f),h=a.pa.Wa(k),k=a.pa.ue(k),n=0;n<h;n++)this.fa[b+d]=k,this.fa[e+d]=k,d++}};c.prototype.nm=function(b){if(null!=this.fa)if(2<b.le.length){for(var e=a.Od.iu(b,this.description),d=[],f=c.V(this.description,0),p=c.V(this.description,1),g=c.V(b,0),k=c.V(b,1),h=0,n=1,q=b.Aa;n<q;n++){var l=b.Hd(n),E=a.pa.Wa(l);if(-1==e[n])for(var r=a.pa.ue(l),l=0;l<E;l++)d[g+h]=r,d[k+h]=r,h++;else for(r=this.description.fj(e[n])-2,l=0;l<E;l++)d[g+h]=this.fa[f+r],d[k+h]=this.fa[p+r],h++,r++}this.fa=
d}else this.fa=null;this.description=b};c.prototype.yd=function(b,e,d){if(this.R.s())throw a.g.ra("This operation was performed on an Empty Geometry.");if(0==e)return 0!=b?0!=d?this.R.G:this.R.B:0!=d?this.R.C:this.R.v;if(d>=a.pa.Wa(e))throw a.g.Uc();var f=this.description.zf(e);return 0<=f?(this.ns(),this.fa[c.V(this.description,b)+this.description.fj(f)-2+d]):a.pa.ue(e)};c.prototype.DA=function(b,e,d,f){this.qc();if(0==e)0!=b?0!=d?this.R.G=f:this.R.B=f:0!=d?this.R.C=f:this.R.v=f;else{if(d>=a.pa.Wa(e))throw a.g.Uc();
if(!this.hasAttribute(e)){if(a.pa.nD(e,f))return;this.Ne(e)}e=this.description.zf(e);this.ns();this.fa[c.V(this.description,b)+this.description.fj(e)-2+d]=f}};c.V=function(a,b){return b*(a.le.length-2)};c.prototype.Ga=function(b){this.qc();var c=new a.i;b.o(c);return this.R.Ga(c)};c.prototype.jc=function(b){return b instanceof a.i?this.R.jc(b):this.R.jc(b.R)};c.prototype.offset=function(a,b){this.qc();this.R.offset(a,b)};c.prototype.normalize=function(){this.qc();this.R.normalize()};c.prototype.Af=
function(b){if(void 0!==b)if(b.Qf(this.description),this.s())b.Ja();else{for(var c=this.description.Aa,e=1;e<c;e++)for(var d=this.description.Hd(e),f=a.pa.Wa(d),p=0;p<f;p++){var g=.5*(this.mC(0,d,p)+this.mC(1,d,p));b.setAttribute(d,p,g)}b.ic(this.R.Af())}else{b=new a.Va(this.description);if(this.s())return b;c=this.description.Aa;for(e=1;e<c;e++)for(d=this.description.Fd(e),f=a.pa.Wa(d),p=0;p<f;p++)g=.5*(this.yd(0,d,p)+this.yd(1,d,p)),b.setAttribute(d,p,g);b.ic(this.R.lw(),this.R.Vs());return b}};
c.prototype.yw=function(){return new a.Va(this.R.yw())};c.prototype.contains=function(b){return b instanceof a.Va?b.s()?!1:this.R.contains(b.lk(),b.mk()):this.R.contains(b.R)};c.prototype.lc=function(a){if(a==this)return!0;if(!(a instanceof c)||this.description!=a.description)return!1;if(this.s())return a.s()?!0:!1;if(!this.R.lc(a.R))return!1;for(var b=0,e=2*(this.description.le.length-2);b<e;b++)if(this.fa[b]!=a.fa[b])return!1;return!0};c.prototype.hc=function(){var b=this.description.hc(),b=a.I.kg(b,
this.R.hc());if(!this.s()&&null!=this.fa)for(var c=0,e=2*(this.description.le.length-2);c<e;c++)b=a.I.kg(b,this.fa[c]);return b};c.prototype.Rf=function(){return a.Hh.il(this,null)};c.prototype.toString=function(){return this.s()?"Envelope: []":"Envelope: ["+this.R.v+", "+this.R.C+", "+this.R.B+", "+this.R.G+"]"};return c}(a.T);a.Vj=b})(z||(z={}));(function(a){var b=function(){function b(a,b,c,e){void 0===a?this.Ja():(this.v=a,this.C=b,this.B=c,this.G=e)}b.Oa=function(a,c,e,d){var f=new b;f.v=a;f.C=
c;f.B=e;f.G=d;return f};b.prototype.K=function(c,e,d,f){"number"===typeof c?void 0!==d?(this.v=c,this.C=e,this.B=d,this.G=f,this.normalize()):(this.v=c,this.C=e,this.B=c,this.G=e):c instanceof a.b?void 0!==e?(this.v=c.x-.5*e,this.B=this.v+e,this.C=c.y-.5*d,this.G=this.C+d,this.normalize()):(this.v=c.x,this.C=c.y,this.B=c.x,this.G=c.y):c instanceof b?this.K(c.v,c.C,c.B,c.G):c instanceof a.Nd&&(c.s()||e.s()?this.Ja():(this.v=c.qa,this.B=c.va,this.C=e.qa,this.G=e.va))};b.prototype.IN=function(a,c){var e=
new b;e.K(this.v,this.C,this.B,this.G);e.P(a,c);return e};b.prototype.Ey=function(a,b){if(void 0!==b)if(0==b)this.Ja();else{this.v=a[0].x;this.C=a[0].y;this.B=this.v;this.G=this.C;for(var c=1;c<b;c++){var e=a[c];e.x<this.v?this.v=e.x:e.x>this.B&&(this.B=e.x);e.y<this.C?this.C=e.y:e.y>this.G&&(this.G=e.y)}}else if(null==a||0==a.length)this.Ja();else for(e=a[0],this.K(e.x,e.y),c=1;c<a.length;c++)e=a[c],this.Oj(e.x,e.y)};b.prototype.Ja=function(){this.G=this.B=this.C=this.v=NaN};b.prototype.s=function(){return isNaN(this.v)};
b.prototype.Db=function(c,e){"number"===typeof c?this.s()?(this.v=c,this.C=e,this.B=c,this.G=e):(this.v>c?this.v=c:this.B<c&&(this.B=c),this.C>e?this.C=e:this.G<e&&(this.G=e)):c instanceof a.b?this.Db(c.x,c.y):c instanceof a.ee?this.Db(c.x,c.y):c instanceof b&&!c.s()&&(this.Db(c.v,c.C),this.Db(c.B,c.G))};b.prototype.Oj=function(a,b){this.v>a?this.v=a:this.B<a&&(this.B=a);this.C>b?this.C=b:this.G<b&&(this.G=b)};b.prototype.P=function(a,b){this.s()||(this.v-=a,this.B+=a,this.C-=b,this.G+=b,(this.v>
this.B||this.C>this.G)&&this.Ja())};b.prototype.scale=function(a){0>a&&this.Ja();this.s()||(this.v*=a,this.B*=a,this.C*=a,this.G*=a)};b.prototype.jc=function(a){return!this.s()&&!a.s()&&(this.v<=a.v?this.B>=a.v:a.B>=this.v)&&(this.C<=a.C?this.G>=a.C:a.G>=this.C)};b.prototype.rD=function(a){return(this.v<=a.v?this.B>=a.v:a.B>=this.v)&&(this.C<=a.C?this.G>=a.C:a.G>=this.C)};b.prototype.Ga=function(a){if(this.s()||a.s())return!1;a.v>this.v&&(this.v=a.v);a.B<this.B&&(this.B=a.B);a.C>this.C&&(this.C=a.C);
a.G<this.G&&(this.G=a.G);(a=this.v<=this.B&&this.C<=this.G)||this.Ja();return a};b.prototype.vu=function(b){switch(b){case 0:return a.b.Oa(this.v,this.C);case 1:return a.b.Oa(this.v,this.G);case 2:return a.b.Oa(this.B,this.G);case 3:return a.b.Oa(this.B,this.C);default:throw a.g.Uc();}};b.prototype.hy=function(b){if(null==b||4>b.length)throw a.g.N();null!=b[0]?b[0].ma(this.v,this.C):b[0]=a.b.Oa(this.v,this.C);null!=b[1]?b[1].ma(this.v,this.G):b[1]=a.b.Oa(this.v,this.G);null!=b[2]?b[2].ma(this.B,this.G):
b[2]=a.b.Oa(this.B,this.G);null!=b[3]?b[3].ma(this.B,this.C):b[3]=a.b.Oa(this.B,this.C)};b.prototype.rN=function(){return this.s()?0:this.aa()*this.ba()};b.prototype.CC=function(){return this.s()?0:2*(this.aa()+this.ba())};b.prototype.lw=function(){return(this.B+this.v)/2};b.prototype.Vs=function(){return(this.G+this.C)/2};b.prototype.aa=function(){return this.B-this.v};b.prototype.ba=function(){return this.G-this.C};b.prototype.move=function(a,b){this.s()||(this.v+=a,this.C+=b,this.B+=a,this.G+=
b)};b.prototype.offset=function(a,b){this.v+=a;this.B+=a;this.C+=b;this.G+=b};b.prototype.normalize=function(){if(!this.s()){var a=Math.min(this.v,this.B),b=Math.max(this.v,this.B);this.v=a;this.B=b;a=Math.min(this.C,this.G);b=Math.max(this.C,this.G);this.C=a;this.G=b}};b.prototype.Yl=function(a){a.ma(this.v,this.C)};b.prototype.YE=function(a){a.ma(this.B,this.C)};b.prototype.aF=function(a){a.ma(this.v,this.G)};b.prototype.Zl=function(a){a.ma(this.B,this.G)};b.prototype.dP=function(){return this.s()||
this.v<=this.B&&this.C<=this.G};b.prototype.Af=function(){return a.b.Oa((this.B+this.v)/2,(this.G+this.C)/2)};b.prototype.yw=function(){return a.b.Oa(this.v,this.C)};b.prototype.contains=function(c,e){if(void 0!==e)return c>=this.v&&c<=this.B&&e>=this.C&&e<=this.G;if(c instanceof a.Va)return this.contains(c.lk(),c.mk());if(c instanceof a.b)return this.contains(c.x,c.y);if(c instanceof b)return c.v>=this.v&&c.B<=this.B&&c.C>=this.C&&c.G<=this.G;throw a.g.N();};b.prototype.jl=function(c,e){if(void 0!==
e)return c>this.v&&c<this.B&&e>this.C&&e<this.G;if(c instanceof a.b)return this.jl(c.x,c.y);if(c instanceof b)return c.v>this.v&&c.B<this.B&&c.C>this.C&&c.G<this.G;throw a.g.N();};b.prototype.lc=function(a){return a==this?!0:a instanceof b?this.s()&&a.s()?!0:this.v!=a.v||this.C!=a.C||this.B!=a.B||this.G!=a.G?!1:!0:!1};b.prototype.hc=function(){var b=this.v,b=a.I.truncate(b^b>>>32),c=a.I.kg(b),b=this.B,b=a.I.truncate(b^b>>>32),c=a.I.kg(b,c),b=this.C,b=a.I.truncate(b^b>>>32),c=a.I.kg(b,c),b=this.G,
b=a.I.truncate(b^b>>>32);return c=a.I.kg(b,c)};b.prototype.vv=function(b){var c=new a.b;c.J(b);if(c.pv())return c;if(this.s())return c.FA(),c;c.x<this.v?c.x=this.v:c.x>this.B&&(c.x=this.B);c.y<this.C?c.y=this.C:c.y>this.G&&(c.y=this.G);if(!c.lc(b))return c;b=this.Af();(c.x<b.x?c.x-this.v:this.B-c.x)<(c.y<b.y?c.y-this.C:this.G-c.y)?c.x=c.x<b.x?this.v:this.B:c.y=c.y<b.y?this.C:this.G;return c};b.prototype.ms=function(a){if(this.s())return NaN;if(a.x==this.v)return a.y-this.C;var b=this.G-this.C,c=this.B-
this.v;return a.y==this.G?b+a.x-this.v:a.x==this.B?b+c+this.G-a.y:a.y==this.C?2*b+c+this.B-a.x:this.ms(this.vv(a))};b.prototype.vA=function(a){if(this.s())return-1;a=this.ms(a);var b=this.G-this.C,c=this.B-this.v;return a<b?0:(a-=b)<c?1:a-c<b?2:3};b.prototype.lv=function(){return this.s()?2.220446049250313E-14:2.220446049250313E-14*(Math.abs(this.v)+Math.abs(this.B)+Math.abs(this.C)+Math.abs(this.G)+1)};b.prototype.Nv=function(a,c){var e=this.ej(a),d=this.ej(c);if(0!=(e&d))return 0;if(0==(e|d))return 4;
var f=(0!=e?1:0)|(0!=d?2:0);do{var p=c.x-a.x,g=c.y-a.y;p>g?0!=(e&b.Cc)?(0!=(e&b.ob)?(a.y+=g*(this.v-a.x)/p,a.x=this.v):(a.y+=g*(this.B-a.x)/p,a.x=this.B),e=this.ej(a)):0!=(d&b.Cc)?(0!=(d&b.ob)?(c.y+=g*(this.v-c.x)/p,c.x=this.v):(c.y+=g*(this.B-c.x)/p,c.x=this.B),d=this.ej(c)):0!=e?(0!=(e&b.ac)?(a.x+=p*(this.C-a.y)/g,a.y=this.C):(a.x+=p*(this.G-a.y)/g,a.y=this.G),e=this.ej(a)):(0!=(d&b.ac)?(c.x+=p*(this.C-c.y)/g,c.y=this.C):(c.x+=p*(this.G-c.y)/g,c.y=this.G),d=this.ej(c)):0!=(e&b.Bd)?(0!=(e&b.ac)?
(a.x+=p*(this.C-a.y)/g,a.y=this.C):(a.x+=p*(this.G-a.y)/g,a.y=this.G),e=this.ej(a)):0!=(d&b.Bd)?(0!=(d&b.ac)?(c.x+=p*(this.C-c.y)/g,c.y=this.C):(c.x+=p*(this.G-c.y)/g,c.y=this.G),d=this.ej(c)):0!=e?(0!=(e&b.ob)?(a.y+=g*(this.v-a.x)/p,a.x=this.v):(a.y+=g*(this.B-a.x)/p,a.x=this.B),e=this.ej(a)):(0!=(d&b.ob)?(c.y+=g*(this.v-c.x)/p,c.x=this.v):(c.y+=g*(this.B-c.x)/p,c.x=this.B),d=this.ej(c));if(0!=(e&d))return 0}while(0!=(e|d));return f};b.prototype.ej=function(a){return(a.x<this.v?1:0)|(a.x>this.B?
1:0)<<1|(a.y<this.C?1:0)<<2|(a.y>this.G?1:0)<<3};b.prototype.mg=function(a){return!this.s()&&(this.aa()<=a||this.ba()<=a)};b.prototype.Fb=function(b){return b instanceof a.b?Math.sqrt(this.gG(b)):Math.sqrt(this.Ou(b))};b.prototype.Ou=function(a){var b=0,c=0,e;e=this.v-a.B;e>b&&(b=e);e=this.C-a.G;e>c&&(c=e);e=a.v-this.B;e>b&&(b=e);e=a.C-this.G;e>c&&(c=e);return b*b+c*c};b.prototype.gG=function(a){var b=0,c=0,e;e=this.v-a.x;e>b&&(b=e);e=this.C-a.y;e>c&&(c=e);e=a.x-this.B;e>b&&(b=e);e=a.y-this.G;e>c&&
(c=e);return b*b+c*c};b.prototype.wu=function(a){this.s()?a.Ja():a.K(this.v,this.B)};b.ob=1;b.ac=4;b.Cc=3;b.Bd=12;return b}();a.i=b})(z||(z={}));(function(a){var b;(function(a){a[a.initialize=0]="initialize";a[a.initializeRed=1]="initializeRed";a[a.initializeBlue=2]="initializeBlue";a[a.initializeRedBlue=3]="initializeRedBlue";a[a.sweep=4]="sweep";a[a.sweepBruteForce=5]="sweepBruteForce";a[a.sweepRedBlueBruteForce=6]="sweepRedBlueBruteForce";a[a.sweepRedBlue=7]="sweepRedBlue";a[a.sweepRed=8]="sweepRed";
a[a.sweepBlue=9]="sweepBlue";a[a.iterate=10]="iterate";a[a.iterateRed=11]="iterateRed";a[a.iterateBlue=12]="iterateBlue";a[a.iterateBruteForce=13]="iterateBruteForce";a[a.iterateRedBlueBruteForce=14]="iterateRedBlueBruteForce";a[a.resetRed=15]="resetRed";a[a.resetBlue=16]="resetBlue"})(b||(b={}));var c=function(){function a(a,b){this.th=a;this.KD=b}a.prototype.Zp=function(a,b,c){this.th.BS(c,a,b,this.KD)};a.prototype.Mo=function(a){return this.th.pq(a,this.KD)};return a}();b=function(){function b(){this.Vt=
this.cn=this.Ve=this.ad=null;this.fp=new a.i;this.Al=this.Mi=this.Ni=this.od=this.rf=this.ud=this.Nt=this.Wm=this.Zc=this.vb=null;this.Hb=-1;this.ka=0;this.Rj()}b.prototype.Vp=function(){this.Rj();this.At=!0;null==this.vb?(this.Wm=new a.ga(0),this.vb=[]):(this.Wm.cf(0),this.vb.length=0)};b.prototype.Wc=function(b,c){if(!this.At)throw a.g.xa();var e=new a.i;e.K(c);this.Wm.add(b);this.vb.push(e)};b.prototype.wo=function(){if(!this.At)throw a.g.xa();this.At=!1;null!=this.vb&&0<this.vb.length&&(this.Hb=
0,this.Ec=!1)};b.prototype.jG=function(){this.Rj();this.zt=!0;null==this.vb?(this.Wm=new a.ga(0),this.vb=[]):(this.Wm.cf(0),this.vb.length=0)};b.prototype.OA=function(b,c){if(!this.zt)throw a.g.xa();var e=new a.i;e.K(c);this.Wm.add(b);this.vb.push(e)};b.prototype.$B=function(){if(!this.zt)throw a.g.xa();this.zt=!1;null!=this.vb&&0<this.vb.length&&null!=this.Zc&&0<this.Zc.length&&(-1==this.Hb?this.Hb=3:2==this.Hb?this.Hb=3:3!=this.Hb&&(this.Hb=1),this.Ec=!1)};b.prototype.iG=function(){this.Rj();this.yt=
!0;null==this.Zc?(this.Nt=new a.ga(0),this.Zc=[]):(this.Nt.cf(0),this.Zc.length=0)};b.prototype.LA=function(b,c){if(!this.yt)throw a.g.xa();var e=new a.i;e.K(c);this.Nt.add(b);this.Zc.push(e)};b.prototype.ZB=function(){if(!this.yt)throw a.g.xa();this.yt=!1;null!=this.vb&&0<this.vb.length&&null!=this.Zc&&0<this.Zc.length&&(-1==this.Hb?this.Hb=3:1==this.Hb?this.Hb=3:3!=this.Hb&&(this.Hb=2),this.Ec=!1)};b.prototype.next=function(){if(this.Ec)return!1;for(var b=!0;b;)switch(this.Hb){case 0:b=this.Qw();
break;case 1:b=this.yO();break;case 2:b=this.vO();break;case 3:b=this.xO();break;case 4:b=this.LS();break;case 5:b=this.HS();break;case 6:b=this.IS();break;case 7:b=this.JS();break;case 8:b=this.Qu();break;case 9:b=this.Wy();break;case 10:b=this.$w();break;case 11:b=this.iP();break;case 12:b=this.fP();break;case 13:b=this.gP();break;case 14:b=this.hP();break;case 15:b=this.hF();break;case 16:b=this.gF();break;default:throw a.g.wa();}return this.Ec?!1:!0};b.prototype.YF=function(a){this.ka=a};b.prototype.Fw=
function(a){return this.vb[a]};b.prototype.jw=function(a){return this.Zc[a]};b.prototype.jk=function(a){return this.Wm.read(a)};b.prototype.ek=function(a){return this.Nt.read(a)};b.Cv=function(a){return 1==(a&1)};b.Yk=function(a){return 0==(a&1)};b.prototype.Rj=function(){this.At=this.yt=this.zt=!1;this.pf=this.qf=this.tg=this.ae=-1;this.Ec=!0};b.prototype.Qw=function(){this.mf=this.Ff=-1;if(10>this.vb.length)return this.ae=this.vb.length,this.Hb=5,!0;null==this.ad&&(this.ad=new a.bq(!0),this.cn=
this.ad.Re(),this.ud=new a.ga(0));this.ad.Vp();for(var b=0;b<this.vb.length;b++){var c=this.vb[b];this.ad.gq(c.v,c.B)}this.ad.wo();this.ud.xb(2*this.vb.length);this.ud.resize(0);for(b=0;b<2*this.vb.length;b++)this.ud.add(b);this.Lr(this.ud,2*this.vb.length,!0);this.ae=2*this.vb.length;this.Hb=4;return!0};b.prototype.yO=function(){this.mf=this.Ff=-1;if(10>this.vb.length||10>this.Zc.length)return this.ae=this.vb.length,this.Hb=6,!0;null==this.ad&&(this.ad=new a.bq(!0),this.cn=this.ad.Re(),this.ud=new a.ga(0));
this.ad.Vp();for(var b=0;b<this.vb.length;b++){var c=this.vb[b];this.ad.gq(c.v,c.B)}this.ad.wo();this.ud.xb(2*this.vb.length);this.ud.resize(0);for(b=0;b<2*this.vb.length;b++)this.ud.add(b);this.Lr(this.ud,this.ud.size,!0);this.ae=this.ud.size;-1!=this.qf&&(this.od.Fg(this.qf),this.Ni.resize(0),this.qf=-1);this.Hb=7;return this.gF()};b.prototype.vO=function(){this.mf=this.Ff=-1;if(10>this.vb.length||10>this.Zc.length)return this.ae=this.vb.length,this.Hb=6,!0;null==this.Ve&&(this.Ve=new a.bq(!0),
this.Vt=this.Ve.Re(),this.rf=new a.ga(0));this.Ve.Vp();for(var b=0;b<this.Zc.length;b++){var c=this.Zc[b];this.Ve.gq(c.v,c.B)}this.Ve.wo();this.rf.xb(2*this.Zc.length);this.rf.resize(0);for(b=0;b<2*this.Zc.length;b++)this.rf.add(b);this.Lr(this.rf,this.rf.size,!1);this.tg=this.rf.size;-1!=this.pf&&(this.od.Fg(this.pf),this.Mi.resize(0),this.pf=-1);this.Hb=7;return this.hF()};b.prototype.xO=function(){this.mf=this.Ff=-1;if(10>this.vb.length||10>this.Zc.length)return this.ae=this.vb.length,this.Hb=
6,!0;null==this.ad&&(this.ad=new a.bq(!0),this.cn=this.ad.Re(),this.ud=new a.ga(0));null==this.Ve&&(this.Ve=new a.bq(!0),this.Vt=this.Ve.Re(),this.rf=new a.ga(0));this.ad.Vp();for(var b=0;b<this.vb.length;b++){var c=this.vb[b];this.ad.gq(c.v,c.B)}this.ad.wo();this.Ve.Vp();for(b=0;b<this.Zc.length;b++)c=this.Zc[b],this.Ve.gq(c.v,c.B);this.Ve.wo();this.ud.xb(2*this.vb.length);this.rf.xb(2*this.Zc.length);this.ud.resize(0);this.rf.resize(0);for(b=0;b<2*this.vb.length;b++)this.ud.add(b);for(b=0;b<2*this.Zc.length;b++)this.rf.add(b);
this.Lr(this.ud,this.ud.size,!0);this.Lr(this.rf,this.rf.size,!1);this.ae=this.ud.size;this.tg=this.rf.size;-1!=this.qf&&(this.od.Fg(this.qf),this.Ni.resize(0),this.qf=-1);-1!=this.pf&&(this.od.Fg(this.pf),this.Mi.resize(0),this.pf=-1);this.Hb=7;return!0};b.prototype.LS=function(){var a=this.ud.get(--this.ae),c=a>>1;if(b.Yk(a))return this.ad.remove(c),0==this.ae?(this.mf=this.Ff=-1,this.Ec=!0,!1):!0;this.cn.uy(this.vb[c].v,this.vb[c].B,this.ka);this.Ff=c;this.Hb=10;return!0};b.prototype.HS=function(){if(-1==
--this.ae)return this.mf=this.Ff=-1,this.Ec=!0,!1;this.tg=this.Ff=this.ae;this.Hb=13;return!0};b.prototype.IS=function(){if(-1==--this.ae)return this.mf=this.Ff=-1,this.Ec=!0,!1;this.Ff=this.ae;this.tg=this.Zc.length;this.Hb=14;return!0};b.prototype.JS=function(){var a=this.ud.get(this.ae-1),c=this.rf.get(this.tg-1),e=this.pq(a,!0),d=this.pq(c,!1);return e>d?this.Qu():e<d?this.Wy():b.Cv(a)?this.Qu():b.Cv(c)?this.Wy():this.Qu()};b.prototype.Qu=function(){var c=this.ud.get(--this.ae),e=c>>1;if(b.Yk(c))return-1!=
this.qf&&-1!=this.Ni.get(e)?(this.od.Jc(this.qf,this.Ni.get(e)),this.Ni.set(e,-1)):this.ad.remove(e),0==this.ae?(this.mf=this.Ff=-1,this.Ec=!0,!1):!0;if(-1!=this.pf&&0<this.od.vq(this.pf))for(c=this.od.gc(this.pf);-1!=c;){var d=this.od.getData(c);this.Ve.lg(d);this.Mi.set(d,-1);d=this.od.bb(c);this.od.Jc(this.pf,c);c=d}0<this.Ve.size()?(this.Vt.uy(this.vb[e].v,this.vb[e].B,this.ka),this.Ff=e,this.Hb=12):(-1==this.qf&&(null==this.od&&(this.od=new a.$n),this.Ni=new a.ga(0),this.Ni.resize(this.vb.length,
-1),this.Ni.dh(-1,0,this.vb.length),this.qf=this.od.jh(1)),this.Ni.set(e,this.od.addElement(this.qf,e)),this.Hb=7);return!0};b.prototype.Wy=function(){var c=this.rf.get(--this.tg),e=c>>1;if(b.Yk(c))return-1!=this.pf&&-1!=this.Mi.get(e)?(this.od.Jc(this.pf,this.Mi.get(e)),this.Mi.set(e,-1)):this.Ve.remove(e),0==this.tg?(this.mf=this.Ff=-1,this.Ec=!0,!1):!0;if(-1!=this.qf&&0<this.od.vq(this.qf))for(c=this.od.gc(this.qf);-1!=c;){var d=this.od.getData(c);this.ad.lg(d);this.Ni.set(d,-1);d=this.od.bb(c);
this.od.Jc(this.qf,c);c=d}0<this.ad.size()?(this.cn.uy(this.Zc[e].v,this.Zc[e].B,this.ka),this.mf=e,this.Hb=11):(-1==this.pf&&(null==this.od&&(this.od=new a.$n),this.Mi=new a.ga(0),this.Mi.resize(this.Zc.length,-1),this.Mi.dh(-1,0,this.Zc.length),this.pf=this.od.jh(0)),this.Mi.set(e,this.od.addElement(this.pf,e)),this.Hb=7);return!0};b.prototype.$w=function(){this.mf=this.cn.next();if(-1!=this.mf)return!1;var a=this.ud.get(this.ae)>>1;this.ad.lg(a);this.Hb=4;return!0};b.prototype.iP=function(){this.Ff=
this.cn.next();if(-1!=this.Ff)return!1;this.mf=this.Ff=-1;var a=this.rf.get(this.tg)>>1;this.Ve.lg(a);this.Hb=7;return!0};b.prototype.fP=function(){this.mf=this.Vt.next();if(-1!=this.mf)return!1;var a=this.ud.get(this.ae)>>1;this.ad.lg(a);this.Hb=7;return!0};b.prototype.gP=function(){if(-1==--this.tg)return this.Hb=5,!0;this.fp.K(this.vb[this.ae]);var a=this.vb[this.tg];this.fp.P(this.ka,this.ka);return this.fp.jc(a)?(this.mf=this.tg,!1):!0};b.prototype.hP=function(){if(-1==--this.tg)return this.Hb=
6,!0;this.fp.K(this.vb[this.ae]);var a=this.Zc[this.tg];this.fp.P(this.ka,this.ka);return this.fp.jc(a)?(this.mf=this.tg,!1):!0};b.prototype.hF=function(){if(null==this.ad)return this.Ec=!0,!1;this.ae=this.ud.size;0<this.ad.size()&&this.ad.reset();-1!=this.qf&&(this.od.Fg(this.qf),this.Ni.resize(0),this.qf=-1);this.Ec=!1;return!0};b.prototype.gF=function(){if(null==this.Ve)return this.Ec=!0,!1;this.tg=this.rf.size;0<this.Ve.size()&&this.Ve.reset();-1!=this.pf&&(this.od.Fg(this.pf),this.Mi.resize(0),
this.pf=-1);this.Ec=!1;return!0};b.prototype.Lr=function(b,e,d){null==this.Al&&(this.Al=new a.Rr);d=new c(this,d);this.Al.sort(b,0,e,d)};b.prototype.BS=function(a,c,e,d){var f=this;a.xd(c,e,function(a,c){var e=f.pq(a,d),p=f.pq(c,d);return e<p||e==p&&b.Yk(a)&&b.Cv(c)?-1:1})};b.prototype.pq=function(a,c){var e=.5*this.ka;if(c)return c=this.vb[a>>1],e=b.Yk(a)?c.C-e:c.G+e;c=this.Zc[a>>1];return e=b.Yk(a)?c.C-e:c.G+e};return b}();a.sz=b})(z||(z={}));(function(a){var b=function(){function b(){}b.Oa=function(a,
c,e,d,f,g){var p=new b;p.v=a;p.C=c;p.Je=e;p.B=d;p.G=f;p.ig=g;return p};b.prototype.Ja=function(){this.Je=this.v=NaN};b.prototype.s=function(){return isNaN(this.v)};b.prototype.UO=function(){return isNaN(this.Je)};b.prototype.K=function(a,b,c,e,d,f){void 0!==e?"number"===typeof a?(this.v=a,this.C=b,this.Je=c,this.B=e,this.G=d,this.ig=f):(this.v=a.x-.5*b,this.B=this.v+b,this.C=a.y-.5*c,this.G=this.C+c,this.Je=a.z-.5*e,this.ig=this.Je+e):(this.v=a,this.C=b,this.Je=c,this.B=a,this.G=b,this.ig=c)};b.prototype.move=
function(a){this.v+=a.x;this.C+=a.y;this.Je+=a.z;this.B+=a.x;this.G+=a.y;this.ig+=a.z};b.prototype.copyTo=function(a){a.v=this.v;a.C=this.C;a.B=this.B;a.G=this.G};b.prototype.Oj=function(a,b,c){this.v>a?this.v=a:this.B<a&&(this.B=a);this.C>b?this.C=b:this.G<b&&(this.G=b);0==isNaN(this.Je)?this.Je>c?this.Je=c:this.ig<c&&(this.ig=c):this.ig=this.Je=c};b.prototype.Db=function(c,e,d,f,g,k){if("number"===typeof c)f?(this.Db(c,e,d),this.Db(f,g,k)):this.s()?(this.v=c,this.C=e,this.Je=d,this.B=c,this.G=e,
this.ig=d):this.Oj(c,e,d);else if(c instanceof a.ee)this.Db(c.x,c.y,c.z);else if(c instanceof b)c.s()||(this.Db(c.v,c.C,c.Je),this.Db(c.B,c.G,c.ig));else throw a.g.N();};b.prototype.Oa=function(a,b,c){a.s()||b.s()?this.Ja():(this.v=a.qa,this.B=a.va,this.C=b.qa,this.G=b.va,this.Je=c.qa,this.ig=c.va)};b.prototype.hy=function(b){if(null==b||8>b.length)throw a.g.N();b[0]=new a.ee(this.v,this.C,this.Je);b[1]=new a.ee(this.v,this.G,this.Je);b[2]=new a.ee(this.B,this.G,this.Je);b[3]=new a.ee(this.B,this.C,
this.Je);b[4]=new a.ee(this.v,this.C,this.ig);b[5]=new a.ee(this.v,this.G,this.ig);b[6]=new a.ee(this.B,this.G,this.ig);b[7]=new a.ee(this.B,this.C,this.ig)};b.prototype.Ey=function(a){if(null==a||0==a.length)this.Ja();else{var b=a[0];this.K(b.x,b.y,b.z);for(b=1;b<a.length;b++){var c=a[b];this.Oj(c.x,c.y,c.z)}}};return b}();a.fH=b})(z||(z={}));(function(a){(function(a){a.wa=function(){var a=Error();a.message="Internal Error";return a};a.qe=function(){var a=Error();a.message="Not Implemented";return a};
a.cj=function(){var a=Error();a.message="The input unit and the spatial reference unit are not of the same unit type.ie Linear vs.Angular";return a};a.xa=function(){var a=Error();a.message="Invalid Call";return a};a.N=function(a){var b=Error();b.message="Illegal Argument Exception";void 0!==a&&(b.message+=": "+a);return b};a.BI=function(){var a=Error();a.message="Runtime Exception.";return a};a.ra=function(a){var b=Error();b.message="Geometry Exception: "+a;return b};a.PG=function(){var a=Error();
a.message="Assert Failed Exception";return a};a.Uc=function(){var a=Error();a.message="IndexOutOfBoundsException";return a};a.aU=function(a){a.message="UserCancelException";return a}})(a.g||(a.g={}))})(z||(z={}));(function(a){var b=function(){function b(a,b){this.Ma=a;this.hE=b;this.kE=-1;this.rk=!1}b.prototype.next=function(){if(++this.kE==this.hE.F())return null;var b=this.hE.Fa(this.kE);b.scale(this.Ma.Rb);var c=new a.Ka;this.Ma.Iv(b,this.rk,c);return c};b.prototype.ya=function(){return 0};return b}(),
c=function(){function b(b,c,e){this.Ma=b;this.Zt=c;this.Om=!1;this.Um=e;this.Mt=[0];this.zj=[0];this.Qi=[0];this.Sq=[0];this.rk=!1;this.$o=new a.Ka;this.Bj=[]}b.prototype.next=function(){if(this.Om){this.Om=!1;this.bd.ia();var b=a.T.Yj(this.$o);return b=a.Of.Qj(b,this.Ma.jp,!0,!0,this.Ma.Yb)}null==this.bd&&(this.bd=this.Zt.Ca(),this.bd.kb(),null!=this.Um&&this.Um.lo());if(!this.bd.La()){if(!this.bd.kb())return null;null!=this.Um&&this.Um.lo()}b=null;this.zj[0]=0;this.Fx=this.Mt[0]=0;this.uh=NaN;this.Om=
!1;for(var c=this.Bj.length=0,d=new a.b,f=new a.b,p=[0];this.bd.La()&&8>this.Fx;){var g=this.bd.ia();d.J(g.Mb());f.J(g.oc());d.scale(this.Ma.Rb);f.scale(this.Ma.Rb);a.ui.Hs(d,f)?d.x=f.x:a.ui.Fs(d,f)&&(f.x=d.x);this.Bj.length=0;a.ui.kC(this.Ma.Gb,this.Ma.Xb,this.Ma.ke,d,f,this.Ma.Nx,this.Ma.hr,p,this.Qi,this.Sq,this.Bj,this.Mt);null!=this.Um&&(g=this.Bj.slice(0),this.Um.dD(this.Um.ea()-1,g,g.length-1));a.ui.Gs(d,f)?(this.$o.Ja(),this.Ma.Iv(d,this.rk,this.$o),this.Om=!0):(this.$o.Ja(),this.Om=this.Lv(p[0],
this.$o));if(this.Om){this.bd.oi();if(this.bd.Ow()){this.bd.oi();this.bd.ia();break}this.bd.yR();break}null==b&&(b=new a.Ka,b.lo());this.TA(b);c++}this.Mt[0]=0;if(0<c){for(p=this.bd.Jb();0<c;)this.bd.oi(),d.J(this.Zt.Fa(this.bd.Jb())),f.J(this.Zt.Fa(this.bd.Bm())),d.scale(this.Ma.Rb),f.scale(this.Ma.Rb),this.rk&&(a.ui.Hs(d,f)?d.x=f.x:a.ui.Fs(d,f)&&(f.x=d.x)),this.Bj.length=0,a.ui.kC(this.Ma.Gb,this.Ma.Xb,this.Ma.ke,f,d,this.Ma.Nx,this.Ma.hr,null,this.Qi,this.Sq,this.Bj,this.Mt),this.TA(b),c--;d.J(this.Zt.Fa(this.bd.Jb()));
d.scale(this.Ma.Rb);e.kq(this.Ma.Gb,this.Ma.Xb,this.Ma.Rb,this.Ma.hb,d,this.uh+1.570796326794897,this.uh+4.71238898038469,this.Ma.Sm,this.rk,this.zj,b,NaN,NaN);this.bd.Sb(p);this.bd.ia();c=a.Ia.Cg(null,b,!0);return b=a.Of.Qj(b,c,!0,!0,this.Ma.Yb)}this.Om=!1;this.bd.ia();b=a.T.Yj(this.$o);return b=a.Of.Qj(b,this.Ma.jp,!0,!0,this.Ma.Yb)};b.prototype.TA=function(b){var c=this.Bj[0],d,f=this.Qi[0]-1.570796326794897,p=this.Sq[0]+1.570796326794897,g;if(!isNaN(this.uh)){this.uh>=this.Qi[0]?(d=this.uh+1.570796326794897,
f=d+3.141592653589793-(this.uh-this.Qi[0])):(d=this.uh+1.570796326794897,f=d+3.141592653589793-(6.283185307179586-(this.Qi[0]-this.uh)));g=this.uh>=this.Qi[0]&&3.141592653589793>=this.uh-this.Qi[0]?!1:this.uh<this.Qi[0]&&3.141592653589793<=this.Qi[0]-this.uh?!1:!0;var k=!1;if(Math.abs(f-d)<=.5*this.Ma.Sm)if(g){var h=b.Fa(b.F()-2);h.scale(this.Ma.Rb);var n=new a.ca(0);a.zb.gw(this.Ma.Gb,this.Ma.Xb,c.x,c.y,h.x,h.y,n);for(h=n.l;h<=d;)h+=6.283185307179586;for(;h>d;)h-=6.283185307179586;h<f&&(k=!0)}else k=
!0;k?(b.eF(0,b.F()-1),this.rk||(c=new a.b,c.J(b.Fa(b.F()-1)),c.scale(this.Ma.Rb),-3.141592653589793>c.x-this.zj[0]?this.zj[0]-=6.283185307179586:3.141592653589793<c.x-this.zj[0]&&(this.zj[0]+=6.283185307179586)),g||(f=.5*(f+d))):(g?(d=new a.b,d.J(c),d.scale(1/this.Ma.Rb),b.kf(0,-1,d)):e.kq(this.Ma.Gb,this.Ma.Xb,this.Ma.Rb,this.Ma.hb,this.Bj[0],d,f,this.Ma.Sm,this.rk,this.zj,b,NaN,NaN),this.Fx+=1)}e.Hv(this.Ma.Gb,this.Ma.Xb,this.Ma.Rb,this.Ma.hb,this.Ma.ke,this.Bj,f,p,this.rk,this.zj,b);this.uh=this.Sq[0]};
b.prototype.Lv=function(a,b){return this.Ma.Lv(this.Bj,a,this.Qi[0],this.Sq[0],this.rk,b)};b.prototype.ya=function(){return 0};return b}(),e=function(){function e(){}e.buffer=function(b,c,d,f,p,g){if(null==b)throw a.g.N("Geometry::Geodesic_bufferer::buffer");if(b.s())return new a.Ka(b.description);var k=new e;k.sg=c;k.wc=a.Ya.Em(c);var h=a.Ya.ft(k.wc);k.Yb=g;k.Gb=a.Ya.Ts(k.wc);k.Xb=h*(2-h);k.Rb=k.wc.Se().Dj;k.ka=k.sg.xq();k.jp=k.wc.xq();k.hr=k.jp*k.Rb;k.ip=1.570796326794897/k.Rb;k.rU=3.141592653589793/
k.Rb;k.Uq=6.283185307179586/k.Rb;k.sU=k.Uq/6;k.Ix=0;k.qU=1.5707963267948966*k.Gb/k.Ix;4==d?(k.ke=2,k.Gt=!0):(k.ke=d,k.Gt=!1);k.Da=f;k.hb=Math.abs(f);isNaN(p)||.001>p?k.sS():k.Rm=p;d=b.D();a.T.Lc(d)?(d=new a.Xa(b.description),d.Bc(b,!0),b=d,d=1607):197==d&&(d=new a.i,b.o(d),d.aa()<=k.ka||d.ba()<=k.ka?(d=new a.Xa(b.description),d.Wc(b,!1),b=d,d=1607):(d=new a.Ka(b.description),d.Wc(b,!1),b=d,d=1736));k.tS();a.T.Km(d)||k.uS();if(k.hb<=.5*k.Rm)return 1736!=d?new a.Ka(b.description):k.Gt?b:a.ui.oq(b,k.sg,
k.ke,k.Nx,-1,g);if(0>k.Da&&1736!=d)return new a.Ka(b.description);k.Gt&&a.T.Kc(d)?(c=a.ui.oq(b,c,4,NaN,k.Rm,g),b=a.Ya.Wl(c,k.sg,k.wc)):b=a.Ya.Wl(b,k.sg,k.wc);b=a.gh.qo(b,k.wc);if(b.s())return new a.Ka(b.description);!k.Gt&&a.T.Kc(d)&&(b=a.ui.IE(k.Rb,b));b=e.PS(b,k.wc);switch(d){case 1736:c=k.yK(b);break;case 1607:c=k.zK(b);break;case 550:c=k.wK(b);break;case 33:c=k.xK(b);break;default:throw a.g.ra("corrupted_geometry");}k=a.Ya.Wl(c,k.wc,k.sg);k.Ik(b.description);return k};e.prototype.yK=function(b){var e=
new a.Ka;b=new c(this,b,e);b=a.wi.local().$(b,this.wc,this.Yb).next();b=a.Vn.nl(b,this.wc,2);var d=new a.Bg;d.scale(1/this.Rb,1/this.Rb);e.Oe(d);e=a.Vn.nl(e,this.wc,2);return 0<=this.Da?a.wi.local().$(e,b,this.wc,this.Yb):a.Zr.local().$(e,b,this.wc,this.Yb)};e.prototype.zK=function(b){b=new c(this,b,null);b=a.wi.local().$(b,this.wc,this.Yb).next();return b=a.Vn.nl(b,this.wc,2)};e.prototype.wK=function(c){c=new b(this,c);c=a.wi.local().$(c,this.wc,this.Yb).next();return c=a.Vn.nl(c,this.wc,2)};e.prototype.xK=
function(b){b=b.w();b.scale(this.Rb);var c=new a.Ka;this.Iv(b,!1,c);return c=a.Vn.nl(c,this.wc,2)};e.prototype.Lv=function(b,c,d,f,p,g){var k=b[0],h=b[b.length-1],n=k.y>h.y?k.y:h.y,A=a.u.q(this.Gb,this.Xb,k.y<h.y?k.y:h.y),n=a.u.q(this.Gb,this.Xb,n);if(.001<this.Ix-(A+c+this.hb)&&.001<this.Ix+(n-c-this.hb))return!1;c=d-1.570796326794897;d=f+1.570796326794897;var A=c-3.141592653589793,n=c+3.141592653589793,q=d+3.141592653589793,l=[NaN],r=[NaN],E=[NaN],t=[NaN];f=!1;e.wG(this.Gb,this.Xb,this.hb,k,c,A,
h,d,l,r);e.wG(this.Gb,this.Xb,this.hb,h,q,d,k,A,E,t);d<l[0]&&l[0]<q?f=!0:d<r[0]&&r[0]<q&&(f=!0);f||(A<E[0]&&E[0]<c?f=!0:A<t[0]&&t[0]<c&&(f=!0));if(!f&&p)return!1;for(var u=[],K=b.length-1;0<=K;K--)u.push(b[K]);g.Ja();g.lo();K=[0];e.Hv(this.Gb,this.Xb,this.Rb,this.hb,this.ke,b,c,d,p,K,g);e.kq(this.Gb,this.Xb,this.Rb,this.hb,h,d,q,this.Sm,p,K,g,l[0],r[0]);e.Hv(this.Gb,this.Xb,this.Rb,this.hb,this.ke,u,q,n,p,K,g);e.kq(this.Gb,this.Xb,this.Rb,this.hb,k,A,c,this.Sm,p,K,g,E[0],t[0]);b=!1;p||(b=this.zB(this.Rb,
g));return f||b};e.prototype.Iv=function(a,b,c){c.Ja();c.lo();e.kq(this.Gb,this.Xb,this.Rb,this.hb,a,-this.Sm,6.283185307179586,this.Sm,b,[0],c,NaN,NaN);b||this.zB(this.Rb,c)};e.prototype.zB=function(a,b){var c=this.XK(a,b);a=this.YK(a,b);return c||a};e.prototype.XK=function(b,c){var e=c.F(),d=!1,f=new a.i;c.o(f);if(!a.j.S(f.G*b,1.570796326794897)&&!a.j.S(f.C*b,-1.570796326794897))return!1;for(var p=new a.b,e=e-1;0<=e;e--)c.w(e,p),p.y==f.G&&a.j.S(p.y*b,1.570796326794897)?(d=!0,this.RE(p,e,c)):p.y==
f.C&&a.j.S(p.y*b,-1.570796326794897)&&(d=!0,this.RE(p,e,c));return d};e.prototype.YK=function(a,b){var c=b.Fa(0),e=b.Fa(b.F()-1);return 3.141592653589793<Math.abs(c.x-e.x)*a?(this.RQ(b),!0):this.WK(b)};e.prototype.WK=function(a){return 0>a.Mh()?(this.QQ(a),!0):!1};e.prototype.RE=function(b,c,e){var d=e.F(),f=0<c?c-1:d-1,d=e.Fa(c<d-1?c+1:0),f=e.Fa(f);if(!a.j.S(d.y,b.y)&&!a.j.S(d.x,b.x)){var p=new a.b;p.ma(d.x,b.y);e.ic(c,p)}a.j.S(f.y,b.y)||a.j.S(f.x,b.x)||(d=new a.b,d.ma(f.x,b.y),e.kf(0,c,d))};e.prototype.RQ=
function(b){var c=new a.Ka,e=new a.Ka,d=new a.Bg,f=b.Fa(0),p=b.Fa(b.F()-1),g=new a.b;f.x>p.x?(p=this.ip,d.Nn(-this.Uq,0)):(p=-this.ip,d.Nn(this.Uq,0));c.add(b,!1);b.Ja();e.add(c,!1);e.Oe(d);f=new a.i;e.o(f);f.P((this.Uq-f.aa())/2,0);f.C=-this.ip;f.G=this.ip;for(var k=0;k<e.F();k++)e.w(k,g),c.kf(0,-1,g);e.Oe(d);for(k=0;k<e.F();k++)e.w(k,g),c.kf(0,-1,g);e=c.Fa(0);d=c.Fa(c.F()-1);g.ma(d.x,p);c.kf(0,-1,g);g.ma(.5*(d.x+e.x),p);c.kf(0,-1,g);g.ma(e.x,p);c.kf(0,-1,g);c=a.gh.Rw(c,this.wc,2,f.v);c=a.gh.Rw(c,
this.wc,2,f.B);c=a.Ed.clip(c,f,this.jp,NaN);b.add(c,!1)};e.prototype.QQ=function(b){var c=new a.i;b.o(c);c.P((this.Uq-c.aa())/2,0);c.C=-this.ip;c.G=this.ip;b.lo();var e=new a.b;e.ma(c.v,c.C);b.kf(1,-1,e);e.ma(c.v,c.G);b.kf(1,-1,e);e.ma(.5*(c.v+c.B),c.G);b.kf(1,-1,e);e.ma(c.B,c.G);b.kf(1,-1,e);e.ma(c.B,c.C);b.kf(1,-1,e);e.ma(.5*(c.v+c.B),c.C);b.kf(1,-1,e)};e.Hv=function(b,c,d,f,p,g,k,h,n,q,l){var A=null;n||(A=new a.b,A.Eh(),0<l.F()&&(A.J(l.Fa(l.F()-1)),A.scale(d)));var r=new a.ca(0),E=new a.ca(0),
t=new a.ca(0),u=new a.b,K=new a.b,w=g[g.length-1];d=1/d;for(var v=0;v<g.length;v++){var x=g[v],H;0==v?H=k:v==g.length-1?H=h:(a.zb.Rd(b,c,w.x,w.y,x.x,x.y,null,null,r,p),H=r.l-1.570796326794897);a.zb.Ph(b,c,x.x,x.y,f,H,E,t);n?K.ma(E.l,t.l):(u.ma(E.l,t.l),e.Gz(x.x,u.x,A.x,q),K.ma(q[0]+u.x,u.y),A.J(K));K.scale(d);l.kf(0,-1,K)}};e.kq=function(b,c,d,f,p,g,k,h,n,q,l,r,E){if(!(k-g<h)){var A=new a.ca(0),t=new a.ca(0),u=new a.b,K=new a.b,w=null;n||(w=new a.b,w.Eh(),0<l.F()&&(w.J(l.Fa(l.F()-1)),w.scale(d)));
var v=a.I.truncate(Math.ceil(g/h)),x=v++*h;x==g&&(x=v++*h);for(d=1/d;x<k+h;){g<r&&r<x?(x=r,v--):g<E&&E<x&&(x=E,v--);if(x>=k)break;a.zb.Ph(b,c,p.x,p.y,f,x,A,t);n?K.ma(A.l,t.l):(u.ma(A.l,t.l),e.Gz(p.x,u.x,w.x,q),K.ma(q[0]+u.x,u.y),w.J(K));K.scale(d);l.kf(0,-1,K);g=x;x=v++*h}}};e.wG=function(b,c,e,d,f,p,g,k,h,n){var A=new a.b,q=new a.b,l=new a.ca(0),r=new a.ca(0);a.zb.Ph(b,c,d.x,d.y,e,f,l,r);A.ma(l.l,r.l);a.zb.Ph(b,c,d.x,d.y,e,p,l,r);q.ma(l.l,r.l);e=new a.ca(0);a.zb.gw(b,c,g.x,g.y,A.x,A.y,e);h[0]=e.l;
a.zb.gw(b,c,g.x,g.y,q.x,q.y,e);for(n[0]=e.l;h[0]<=n[0];)h[0]+=6.283185307179586;for(;h[0]>n[0];)h[0]-=6.283185307179586;for(;h[0]>=k;)h[0]-=6.283185307179586,n[0]-=6.283185307179586;for(;h[0]<k;)h[0]+=6.283185307179586,n[0]+=6.283185307179586};e.Gz=function(a,b,c,e){if(isNaN(c)){for(;3.141592653589793<e[0]+b-a;)e[0]-=6.283185307179586;for(;3.141592653589793<a-(e[0]+b);)e[0]+=6.283185307179586}else 3.141592653589793<e[0]+b-c?e[0]-=6.283185307179586:3.141592653589793<c-(e[0]+b)&&(e[0]+=6.283185307179586)};
e.PS=function(b,c){var e=b.D(),d;a.T.Kc(e)?d=b.ea():550==e?d=b.F():d=1;if(1==d)return b;var f=new a.ga(0);f.resize(d);for(var p=[],g=new a.i,k=0;k<d;k++){f.write(k,k);var h;a.T.Kc(e)?(b.Ti(k,g),h=g.Af()):h=b.Fa(k);h=a.qH.QS(c,h);p[k]=h}f.xd(0,f.size,function(a,b){return p[a]<p[b]?-1:p[a]>p[b]?1:0});g=b.Pa();for(k=0;k<d;k++)h=f.read(k),a.T.Kc(e)?g.Zj(b,h,!0):g.Pd(b,h,h+1);return g};e.prototype.tS=function(){var b=Math.min(3.141592653589793*this.Gb-this.hb,this.hb),b=Math.min(b,.39269908169872414*this.Gb),
c=new a.b;c.ma(0,10*this.Rb);var e=45*this.Rb,d=new a.ca(0),f=new a.ca(0),p=new a.ca(0),g=new a.ca(0),k=new a.ca(0),h=new a.ca(0),n=new a.ca(0),q=new a.ca(0),l=new a.b,r=new a.b,E=new a.b,t=new a.b;a.zb.Ph(this.Gb,this.Xb,c.x,c.y,b,0,d,f);l.ma(d.l,f.l);a.zb.Ph(this.Gb,this.Xb,c.x,c.y,b,e,p,g);r.ma(p.l,g.l);for(var d=new a.ca(0),f=new a.ca(0),u=new a.ca(0);;){a.zb.Ph(this.Gb,this.Xb,c.x,c.y,b,.5*(0+e),k,h);E.ma(k.l,h.l);a.zb.Rd(this.Gb,this.Xb,l.x,l.y,r.x,r.y,d,f,null,2);a.zb.dk(this.Gb,this.Xb,l.x,
l.y,.5*d.l,f.l,n,q,2);t.ma(n.l,q.l);a.zb.Rd(this.Gb,this.Xb,E.x,E.y,t.x,t.y,u,null,null,2);if(u.l<=this.Rm)break;e*=.9;a.zb.Ph(this.Gb,this.Xb,c.x,c.y,b,e,p,g);r.ma(p.l,g.l)}this.Sm=6.283185307179586/Math.ceil(6.283185307179586/(e-0))};e.prototype.uS=function(){var b=Math.min(3.141592653589793*this.Gb-this.hb,this.hb),b=Math.min(b,.39269908169872414*this.Gb),c=new a.b,e=new a.b;c.ma(0,10*this.Rb);e.ma(10*this.Rb,10*this.Rb);var d=new a.ca(0),f=new a.ca(0),p=new a.ca(0);a.zb.Rd(this.Gb,this.Xb,c.x,
c.y,e.x,e.y,p,d,f,this.ke);var g=new a.ca(0),k=new a.ca(0),h=new a.ca(0),n=new a.ca(0),q=new a.b,l=new a.ca(0),r=new a.ca(0),E=new a.ca(0),t=new a.ca(0),u=new a.ca(0),w=new a.ca(0),v=new a.ca(0),x=new a.ca(0),H=new a.ca(0),m=new a.b,y=new a.b,z=new a.b,C=new a.b,B=1,d=d.l,f=f.l+1.570796326794897,p=p.l;a.zb.Ph(this.Gb,this.Xb,c.x,c.y,b,d-1.570796326794897,r,E);m.ma(r.l,E.l);a.zb.Ph(this.Gb,this.Xb,e.x,e.y,b,f,t,u);y.ma(t.l,u.l);for(var r=new a.ca(0),E=new a.ca(0),f=new a.ca(0),F=new a.ca(0);;){a.zb.dk(this.Gb,
this.Xb,c.x,c.y,.5*(0+B)*p,d,g,k,this.ke);q.ma(g.l,k.l);a.zb.Rd(this.Gb,this.Xb,c.x,c.y,q.x,q.y,null,null,l,this.ke);a.zb.Ph(this.Gb,this.Xb,q.x,q.y,b,l.l+1.570796326794897,w,v);z.ma(w.l,v.l);a.zb.Rd(this.Gb,this.Xb,m.x,m.y,y.x,y.y,r,E,null,2);a.zb.dk(this.Gb,this.Xb,m.x,m.y,.5*r.l,E.l,x,H,2);C.ma(x.l,H.l);a.zb.Rd(this.Gb,this.Xb,z.x,z.y,C.x,C.y,f,null,null,2);if(f.l<=this.Rm)break;B*=.9;a.zb.dk(this.Gb,this.Xb,c.x,c.y,B*p,d,h,n,this.ke);e.ma(h.l,n.l);a.zb.Rd(this.Gb,this.Xb,c.x,c.y,e.x,e.y,null,
null,F,this.ke);a.zb.Ph(this.Gb,this.Xb,e.x,e.y,b,F.l+1.570796326794897,t,u);y.ma(t.l,u.l)}b=B*p;1E5<b&&(b=1E5);this.Nx=b};e.prototype.sS=function(){var a;a=5E4<this.hb?100:1E4<this.hb?10:1;500>this.hb/a&&(a=this.hb/500);.01>a&&(a=.01);this.Rm=a};return e}();a.pH=e})(z||(z={}));(function(a){var b=function(){function b(){}b.ac=function(b,c){var e=new a.b;e.J(c);b.push(e)};b.$i=function(a,b){a.add(b.x);a.add(b.y)};b.cx=function(a){a.cf(a.size-2)};b.cy=function(a,b){b.ma(a.get(a.size-2),a.get(a.size-
1))};b.oq=function(c,e,d,f,g,k){if(null==c)throw a.g.N();var p=c.D();if(c.s()||a.T.Km(p))return c;var h=new b;h.sg=e;h.wc=a.Ya.Em(e);var n=a.Ya.ft(h.wc);h.Yb=k;h.Gb=a.Ya.Ts(h.wc);h.Xb=n*(2-n);h.Rb=h.wc.Se().Dj;h.jp=h.wc.xq();h.hr=h.jp*h.Rb;h.Bx=f;h.Ax=g;h.ke=d;197==p?(d=new a.Ka(c.description),d.Wc(c,!1)):a.T.Lc(p)?(d=new a.Xa(c.description),d.Bc(c,!0)):d=c;if(4!=h.ke){e=0==h.sg.lc(h.wc)?a.Ya.Wl(d,h.sg,h.wc):a.gh.qo(d,h.wc);if(e.s())return e;e=b.IE(h.Rb,e);e=h.hw(e);e=a.Vn.nl(e,h.wc,h.ke);h=a.Ya.Wl(e,
h.wc,h.sg)}else{2==a.Nf.Am(e)?(c=a.Ya.TN(),e=a.$r.local().$(d,c,e,k),e==c&&(e=new a.Ka,c.copyTo(e))):e=a.gh.qo(d,h.wc);if(e.s())return e;h=h.wS(e)}return h};b.IE=function(c,e){var d=new a.i;e.dd(d);if(3.141592653589793>d.aa()*c)return e;for(var f=!1,d=e.Ca(),p=new a.b,g=new a.b;d.kb();)for(;d.La();){var k=d.ia();p.J(k.Mb());g.J(k.oc());p.scale(c);g.scale(c);if(3.141592653589793<Math.abs(p.x-g.x)){var h=b.Gs(p,g);if(!h){f=!0;break}if(6.283185307179586<Math.abs(p.x-g.x)){f=!0;break}}}if(!f)return e;
var f=e.Pa(),n=1<e.description.Aa,q=new a.b,l=new a.b,r=new a.b,t=new a.b,E=new a.Va;for(d.Lk();d.kb();)for(var u=NaN,w=[0];d.La();){k=d.ia();p.J(k.Mb());g.J(k.oc());p.scale(c);g.scale(c);isNaN(u)?(b.Bd(p.x,NaN,w),l.J(p)):l.J(r);u=l.x;if(h=b.Gs(p,g)){if(6.283185307179586<g.x-p.x)for(;6.283185307179586<g.x-p.x;)g.x-=6.283185307179586;if(-6.283185307179586>g.x-p.x)for(;-6.283185307179586>g.x-p.x;)g.x+=6.283185307179586;b.Bd(g.x,NaN,w);r.J(g)}else q.J(g),b.eK(q),b.Bd(q.x,u,w),r.ma(w[0]+q.x,q.y);.5>Math.abs(r.x-
g.x)&&r.J(g);n?(k.uu(0,E),t.J(l),t.scale(1/c),E.ic(t),(h=d.wl())?f.df(E):f.lineTo(E),d.Jm()&&!e.vc(d.Qa)&&(k.uu(1,E),t.J(r),t.scale(1/c),E.ic(t),f.lineTo(E))):((h=d.wl())&&f.Sw(),k=f.ea()-1,t.J(l),t.scale(1/c),f.kf(k,-1,t),d.Jm()&&!e.vc(d.Qa)&&(t.J(r),t.scale(1/c),f.kf(k,-1,t)))}return f};b.kC=function(c,e,d,f,g,k,h,n,q,l,r,t){var p=new a.b,A=new a.b,E=0<f.compare(g);b.Ez(E,f,g,p,A);b.Jz(c,e,d,p,A,k,NaN,h,n,q,l,null,r,t);E&&b.gy(q,l,null,r)};b.prototype.hw=function(c){var e=c.Pa(),d=c.Ca(),f=[],g=
null,k=null,h=1<c.description.Aa;h&&(g=new a.qd(0),k=new a.Ag);for(var n=[0],q=new a.b,l=new a.b,r=new a.b,t=new a.b;d.kb();)for(n[0]=0;d.La();){var E=d.ia();q.J(E.Mb());l.J(E.oc());q.scale(this.Rb);l.scale(this.Rb);var u=0<q.compare(l);b.Ez(u,q,l,r,t);f.length=0;null!=g&&g.cf(0);0<this.Bx?b.Jz(this.Gb,this.Xb,this.ke,r,t,this.Bx,this.Ax,this.hr,null,null,null,h?g:null,f,n):b.dH(this.Gb,this.Xb,this.ke,r,t,this.Ax,this.hr,h?g:null,f,n);u&&b.gy(null,null,h?g:null,f);f[0].J(E.Mb());f[f.length-1].J(E.oc());
for(var w=1;w<f.length-1;w++)f[w].scale(1/this.Rb);h?(u=b.Cz(u,E,k),b.oz(d.wl(),d.Jm()&&!c.vc(d.Qa),E,u,g,f,e)):b.mz(d.wl(),d.Jm()&&!c.vc(d.Qa),f,e)}return e};b.prototype.wS=function(c){var e=c.Pa(),d=c.Ca(),f=[],g=null,k=new a.Ag,h=1<c.description.Aa;for(h&&(g=new a.qd(0));d.kb();)for(;d.La();){var n=d.ia(),q=n.Mb(),l=n.oc(),q=0<q.compare(l),l=b.Cz(q,n,k);f.length=0;null!=g&&g.cf(0);b.FR(this.Gb,this.Xb,this.Rb,l,this.sg,this.Bx,this.Ax,h?g:null,f);q&&b.gy(null,null,h?g:null,f);h?b.oz(d.wl(),d.Jm()&&
!c.vc(d.Qa),n,l,g,f,e):b.mz(d.wl(),d.Jm()&&!c.vc(d.Qa),f,e)}return e};b.mz=function(a,b,c,e){a&&e.Sw();a=e.ea()-1;var d=c.slice(0);e.dD(a,d,d.length-1);b&&e.kf(a,-1,c[c.length-1])};b.oz=function(b,c,e,d,f,g,k){var p=new a.Va;e.En(p);b?k.df(p):k.lineTo(p);if(2<g.length){b=d.$b();for(var h=1;h<g.length-1;h++){var n=d.AD(f.get(h)*b);d.uu(n,p);p.ic(g[h]);k.lineTo(p)}}c&&(e.Bn(p),k.lineTo(p))};b.Jz=function(c,e,d,f,g,k,h,n,q,l,r,t,u,w){var p=new a.ca(0),A=new a.ca(0),E=new a.ca(0);a.zb.Rd(c,e,f.x,f.y,
g.x,g.y,E,p,A,d);var E=E.l,K=p=p.l,A=A.l;0>K&&(K+=6.283185307179586);0>A&&(A+=6.283185307179586);null!=q&&(q[0]=E);null!=l&&(l[0]=K);null!=r&&(r[0]=A);l=q=NaN;null!=t&&(l=a.u.gg(c,e),r=a.u.q(c,e,f.y),q=(l-r)/E,l=(l+r)/E);r=b.Hs(f,g);var A=b.Fs(f,g),K=r||A,v=b.wz(f,g,n),x=new a.ca(0),U=new a.ca(0),m=new a.b,H=new a.b,y=new a.b;b.Bd(f.x,NaN,w);var z=[w[0]];if(E<=k)b.ac(u,f),b.Bd(g.x,NaN,w),null!=t&&t.add(0),K?(r&&b.by(f,g,t,u),A&&b.Vx(f,g,t,u)):v?b.Xx(f,g,p,q,l,t,u):0<h&&(H.ma(f.x-z[0],f.y),m.ma(g.x-
w[0],g.y),b.yv(c,e,d,f,E,p,H,m,0,1,h,t,u,z)),b.ac(u,g);else{k=1+a.I.truncate(Math.ceil(E/k));var V=E/(k-1),C=new a.b,X=0;b.ac(u,f);C.J(f);H.ma(f.x-w[0],f.y);null!=t&&t.add(0);for(var B=1;B<k;B++){var F;B<k-1?(a.zb.dk(c,e,f.x,f.y,B*V,p,x,U,d),m.ma(x.l,U.l),b.Bd(m.x,C.x,w),y.ma(w[0]+m.x,m.y),F=B/(k-1)):(b.Bd(g.x,NaN,w),m.ma(g.x-w[0],g.y),y.J(g),F=1);K?(1==B&&r&&b.by(f,y,t,u),B==k-1&&A&&b.Vx(C,g,t,u)):v?b.uz(C,y,n)&&(f.x<g.x?C.x>y.x&&(w[0]+=6.283185307179586,y.ma(w[0]+m.x,m.y)):C.x<y.x&&(w[0]-=6.283185307179586,
y.ma(w[0]+m.x,m.y)),b.Xx(C,y,p,q,l,t,u)):0<h&&b.yv(c,e,d,f,E,p,H,m,X,F,h,t,u,z);b.ac(u,y);null!=t&&t.add(F);C.J(y);H.J(m);z[0]=w[0];X=F}}};b.dH=function(c,e,d,f,g,k,h,n,q,l){var p=new a.ca(0),A=new a.ca(0),r=new a.ca(0);a.zb.Rd(c,e,f.x,f.y,g.x,g.y,r,p,A,d);var A=r.l,p=p.l,t=r=NaN;if(null!=n)var t=a.u.gg(c,e),E=a.u.q(c,e,f.y),r=(t-E)/A,t=(t+E)/A;var E=b.Hs(f,g),u=b.Fs(f,g),w=E||u;h=b.wz(f,g,h);var K=b.Gs(f,g),K=w||h||K;b.Bd(f.x,NaN,l);var v=new a.b;b.ac(q,f);v.J(f);null!=n&&n.add(0);K?(w?(E&&b.by(f,
g,n,q),u&&b.Vx(f,g,n,q)):h&&b.Xx(f,g,p,r,t,n,q),b.Bd(g.x,NaN,l),b.ac(q,g)):A<=k?(b.Bd(g.x,NaN,l),b.ac(q,g)):(r=new a.b,h=new a.b,r.J(f),h.J(g),r.x-=l[0],h.x-=l[0],-3.141592653589793>h.x?h.x+=6.283185307179586:3.141592653589793<h.x&&(h.x-=6.283185307179586),b.yv(c,e,d,f,A,p,r,h,0,1,k,n,q,l),b.ac(q,g),b.Bd(g.x,NaN,l));null!=n&&n.add(1)};b.yv=function(c,e,d,f,g,k,h,n,q,l,r,t,u,w){var p=new a.b,A=new a.b;p.ma(h.x+w[0],h.y);new a.ca(0);new a.ca(0);new a.ca(0);new a.ca(0);var E=new a.ca(0),K=new a.ca(0),
v=new a.ca(0),x=new a.b,m=new a.b,H=new a.b,U=new a.b;x.J(h);m.J(n);h=new a.qd(0);n=new a.qd(0);b.$i(h,m);n.add(l);var y=new a.b,z=new a.yb,V=[];for(b.Kz(4,V);0<h.size;){for(var C=!1,X,B=NaN,F=0;3>F;F++)if(X=V[F]*l+(1-V[F])*q,a.zb.dk(c,e,f.x,f.y,X*g,k,E,K,d),H.ma(E.l,K.l),0==F&&(B=X,U.J(H)),b.mR(x,H,m,z),z.Kb(z.Gd(H,!0),y),a.zb.Rd(c,e,H.x,H.y,y.x,y.y,v,null,null,2),v.l>r){C=!0;break}C?(m.J(U),l=B,b.$i(h,m),n.add(l)):(b.cx(h),n.oj(n.size-1,1,n.size-1),0<h.size&&(b.Bd(m.x,p.x,w),A.ma(w[0]+m.x,m.y),
b.ac(u,A),p.J(A),null!=t&&t.add(l),x.J(m),q=l,b.cy(h,m),l=n.get(n.size-1)))}};b.FR=function(c,e,d,f,g,k,h,n,q){var p=new a.b,A=new a.b,l=new a.b,r=new a.b,t=new a.b,E=new a.b,u=new a.b,w=new a.b,K=new a.b,v=new a.b,x=new a.ca(0),m=new a.ca(0),H=new a.b,U=[[],[]],y=1==a.Nf.Am(g);g=g.Ko();var z=f.Mb(),V=f.oc();y?(E.ma(z.x*d,z.y*d),u.ma(V.x*d,V.y*d)):(U[0][0]=z.x,U[0][1]=z.y,U[1][0]=V.x,U[1][1]=V.y,a.Ya.tu(),E.x=U[0][0]*d,E.y=U[0][1]*d,u.x=U[1][0]*d,u.y=U[1][1]*d);var C=0,X=0,B=1,F=f.mD();p.J(z);A.J(V);
var V=new a.qd(0),W=new a.qd(0),G=new a.qd(0);b.$i(V,A);b.$i(W,u);G.add(B);b.ac(q,p);null!=n&&n.add(X);var ba=[],fa;fa=0<h?F?5:3:F?5:1;b.Kz(fa,ba);for(var N=new a.ca(0),M=new a.ca(0),R=new a.ca(0),P=new a.ca(0),Y=new a.ca(0),S=new a.ca(0),O=new a.ca(0);0<W.size;){var Q=!1,T,aa=NaN;a.zb.Rd(c,e,E.x,E.y,u.x,u.y,N,M,null,2);for(z=0;z<fa;z++){if(0==z){if(!F&&0>=h&&N.l<=k&&3.141592653589793>Math.abs(E.x-u.x))break;if(f.rA(X,B)<=g)break}T=ba[z]*B+(1-ba[z])*X;f.Kb(T,l);y?w.ma(l.x*d,l.y*d):(U[0][0]=l.x,U[0][1]=
l.y,a.Ya.tu(),w.x=U[0][0]*d,w.y=U[0][1]*d);if(0==z&&(aa=T,t.J(l),v.J(w),0<k&&(N.l>k||3.141592653589793<=Math.abs(E.x-u.x)))){Q=!0;break}if(F&&0<k){if(a.zb.Rd(c,e,E.x,E.y,w.x,w.y,R,null,null,2),R.l>k||3.141592653589793<=Math.abs(E.x-w.x)){Q=!0;break}}else if(0<h)if(F?(r.OO(p,A,ba[z]),y?K.ma(r.x*d,r.y*d):(U[0][0]=r.x,U[0][1]=r.y,a.Ya.tu(),K.x=U[0][0]*d,K.y=U[0][1]*d)):(r.J(l),K.J(w)),a.zb.Rd(c,e,E.x,E.y,K.x,K.y,P,null,null,2),P.l<=N.l){a.zb.dk(c,e,E.x,E.y,P.l,M.l,x,m,2);H.ma(x.l,m.l);a.zb.Rd(c,e,H.x,
H.y,w.x,w.y,Y,null,null,2);if(Y.l>h){Q=!0;break}if(F){a.zb.Rd(c,e,H.x,H.y,K.x,K.y,S,null,null,2);if(S.l>h){Q=!0;break}a.zb.Rd(c,e,K.x,K.y,w.x,w.y,O,null,null,2);if(O.l>h){Q=!0;break}}}else{Q=!0;break}}Q?(A.J(t),u.J(v),B=aa,b.$i(V,A),b.$i(W,u),G.add(B)):(b.cx(V),b.cx(W),G.oj(G.size-1,1,G.size-1),b.ac(q,A),C+=N.l,null!=n&&n.add(C),0<W.size&&(p.J(A),E.J(u),X=B,b.cy(V,A),b.cy(W,u),B=G.get(G.size-1)))}if(null!=n)for(c=1/C,z=0;z<n.size;z++)n.write(z,n.read(z)*c)};b.gy=function(a,b,c,e){e.reverse();null!=
c&&c.Jp(0,c.size,1);c=null!=a?a[0]:NaN;e=null!=b?b[0]:NaN;null!=a&&(a[0]=e);null!=b&&(b[0]=c)};b.Ez=function(a,b,c,e,d){a?(e.J(c),d.J(b)):(e.J(b),d.J(c))};b.Cz=function(a,b,c){if(!a)return b;c.create(b.D());b.copyTo(c.get());c.get().reverse();return c.get()};b.Bd=function(a,b,c){if(isNaN(b)){for(;3.141592653589793<c[0]-a;)c[0]-=6.283185307179586;for(;3.141592653589793<a-c[0];)c[0]+=6.283185307179586}else 3.141592653589793<c[0]+a-b?c[0]-=6.283185307179586:3.141592653589793<b-(c[0]+a)&&(c[0]+=6.283185307179586)};
b.mR=function(a,b,c,e){3.141592653589793>Math.abs(b.x-a.x)?(e.ed(a),3.141592653589793<=c.x-a.x?e.Ok(c.x-6.283185307179586,c.y):3.141592653589793<=a.x-c.x?e.Ok(c.x+6.283185307179586,c.y):e.Ok(c.x,c.y)):(e.ed(c),3.141592653589793<=a.x-c.x?e.Ok(a.x-6.283185307179586,a.y):3.141592653589793<=c.x-a.x?e.Ok(a.x+6.283185307179586,a.y):e.Ok(a.x,a.y))};b.Kz=function(a,b){for(var c=0;c<a;c++){var e=Math.ceil(c/2)/(a+1);0!=c%2&&(e=-e);b[c]=.5+e}};b.Hs=function(b,c){return a.j.S(b.y,1.570796326794897)&&!a.j.S(c.y,
1.570796326794897)||a.j.S(b.y,-1.570796326794897)&&!a.j.S(c.y,-1.570796326794897)?!0:!1};b.Fs=function(b,c){return a.j.S(c.y,1.570796326794897)&&!a.j.S(b.y,1.570796326794897)||a.j.S(c.y,-1.570796326794897)&&!a.j.S(b.y,-1.570796326794897)?!0:!1};b.wz=function(c,e,d){return!b.uz(c,e,d)||a.j.S(c.y,1.570796326794897)||a.j.S(c.y,-1.570796326794897)||a.j.S(e.y,1.570796326794897)||a.j.S(e.y,-1.570796326794897)?!1:!0};b.uz=function(a,b,c){return Math.abs(Math.abs(a.x-b.x)-3.141592653589793)<=c?!0:!1};b.Gs=
function(b,c){return a.j.S(b.y,1.570796326794897)&&a.j.S(c.y,1.570796326794897)||a.j.S(b.y,-1.570796326794897)&&a.j.S(c.y,-1.570796326794897)?!0:!1};b.by=function(c,e,d,f){if(0<c.y){var p=new a.b;p.ma(e.x,1.570796326794897)}else p=new a.b,p.ma(e.x,-1.570796326794897);a.j.S(c.x,p.x)||a.j.S(e.y,p.y)||(b.ac(f,p),null!=d&&d.add(0))};b.Vx=function(c,e,d,f){if(0<e.y){var p=new a.b;p.ma(c.x,1.570796326794897)}else p=new a.b,p.ma(c.x,-1.570796326794897);a.j.S(e.x,p.x)||a.j.S(c.y,p.y)||(b.ac(f,p),null!=d&&
d.add(1))};b.Xx=function(c,e,d,f,g,k,h){a.j.Vc(d)?(0<1.570796326794897-c.y&&(d=new a.b,d.ma(c.x,1.570796326794897),b.ac(h,d),null!=k&&k.add(f)),0<1.570796326794897-e.y&&(d=new a.b,d.ma(e.x,1.570796326794897),b.ac(h,d),null!=k&&k.add(f))):(0<1.570796326794897+c.y&&(d=new a.b,d.ma(c.x,-1.570796326794897),b.ac(h,d),null!=k&&k.add(g)),0<1.570796326794897+e.y&&(d=new a.b,d.ma(e.x,-1.570796326794897),b.ac(h,d),null!=k&&k.add(g)))};b.eK=function(a){if(-3.141592653589793>a.x)for(;-3.141592653589793>a.x;)a.x+=
6.283185307179586;if(3.141592653589793<a.x)for(;3.141592653589793<a.x;)a.x-=6.283185307179586};return b}();a.ui=b})(z||(z={}));(function(a){var b=function(){function b(){}b.nl=function(c,e,d){if(null==c||null==e||!a.Ya.Qo(e))throw a.g.N();if(c.s())return c;var f=c,p=f.D();if(a.T.Kc(p)){f=a.gh.qo(c,e);c=new a.i;f.o(c);for(var p=a.Ia.zd(e,c,!1),g=a.Ya.Fm(e),k=Math.floor((c.v-g.v)/g.aa())*g.aa()+g.v;k<c.B;)k>c.v+p&&k<c.B-p&&(f=a.gh.Rw(f,e,d,k)),k+=g.aa()}else{if(197==p)return c=new a.Ka(f.description),
c.Wc(f,!1),b.nl(c,e,d);if(a.T.Lc(p))return c=new a.Xa(f.description),c.Bc(f,!0),b.nl(c,e,d)}return b.VG(f,e)};b.VG=function(c,e){if(null==c||null==e||!a.Ya.Qo(e))throw a.g.N();if(c.s())return c;var d;d=c.D();197==d?(d=new a.Ka(c.description),d.Wc(c,!1)):a.T.Lc(d)?(d=new a.Xa(c.description),d.Bc(c,!0)):d=c;d=a.gh.qo(d,e);return d.s()?d:1==a.Nf.Am(e)?a.gh.aN(d,e,d!=c):b.SG(d,e,d!=c)};b.SG=function(b,c,e){if(!a.Ya.Qo(c))throw a.g.N();if(b.s())return b;var d=a.Ya.IC(c),f=0-180*d,d=360*d;2==a.Nf.Am(c)&&
(f=a.Ya.Fm(c),d=f.B,f=f.v,d-=f);return a.gh.gC(b,f,d,c,e)};return b}();a.Vn=b})(z||(z={}));(function(a){var b=function(){function b(){}b.OH=function(a,b){var c=Math.abs(a%b);return isNaN(c)||c==a||c<=Math.abs(b)/2?c:0>a?-1*(c-b):0<a?1*(c-b):0*(c-b)};b.H=function(a){return 0>a?-a:a};b.nb=function(a,c){return 0<=c?b.H(a):-b.H(a)};b.S=function(a,c){return a==c||b.H(a-c)<=b.bF*(1+(b.H(a)+b.H(c))/2)};b.Vc=function(a){return 0==a||b.H(a)<=b.bF};b.bs=function(a){a=b.OH(a,b.fv);return b.H(a)<=b.$g?a:0>a?
a+b.fv:a-b.fv};b.Yz=function(a,c){a.l=b.bs(a.l);c.l=b.bs(c.l);b.H(c.l)>b.Vr&&(a.l=b.bs(a.l+b.$g),c.l=b.nb(b.$g,c.l)-c.l)};b.gg=function(a,c){c=Math.sqrt(1-c);c=(1-c)/(1+c);var e=c*c;return a/(1+c)*(1+e*(.25+e*(.015625+1/256*e)))*b.Vr};b.pN=function(c,e,d,f,g){var p,k,h,n,A,q,l,r=0,t=q=0,u=0,E=0,w=0;A=0;var v,K,x;l=0;var m,H,U;x=new a.ca;p=new a.ca;if(null!=g)if(x.l=c,p.l=e,b.Yz(x,p),c=x.l,e=p.l,x.l=d,p.l=f,b.Yz(x,p),d=x.l,f=p.l,d=b.bs(d-c),b.S(e,f)&&(b.Vc(d)||b.S(b.H(e),b.Vr)))null!=g&&(g.l=0);else{if(b.S(e,
-f)){if(b.S(b.H(e),b.Vr)){null!=g&&(g.l=2*b.gg(6378137,.0066943799901413165));return}if(b.S(b.H(d),b.$g)){null!=g&&(g.l=2*b.gg(6378137,.0066943799901413165));return}}if(b.Vc(.0066943799901413165))E=Math.cos(e),w=Math.cos(f),null!=g&&(r=Math.sin((f-e)/2),q=Math.sin(d/2),l=2*Math.asin(Math.sqrt(r*r+E*w*q*q)),g.l=6378137*l);else{x=1-Math.sqrt(.9933056200098587);c=1-x;p=Math.atan(c*Math.tan(e));e=Math.sin(p);p=Math.cos(p);k=Math.atan(c*Math.tan(f));f=Math.sin(k);k=Math.cos(k);n=h=d;H=0;U=1;m=d;for(K=
!0;1==K;)H+=1,1==U&&(A=Math.sin(m),q=Math.cos(m),r=k*A,l=p*f-e*k*q,r=Math.sqrt(r*r+l*l),q=e*f+p*k*q,l=Math.atan2(r,q),t=1E-15>b.H(r)?p*k*A/b.nb(1E-15,r):p*k*A/r,u=1-t*t,E=1E-15>b.H(u)?q-e*f/b.nb(1E-15,u)*2:q-e*f/u*2,w=E*E,A=((-3*u+4)*x+4)*u*x/16),v=(1-A)*x*(l+A*r*(E+q*A*(2*w-1))),1==U?(m=d+v*t,1E-14>b.H(m-n)?K=!1:b.H(m)>b.$g?(U=2,m=b.$g,0>d&&(m=-m),t=0,u=1,h=n=2,l=b.$g-b.H(Math.atan(e/p)+Math.atan(f/k)),r=Math.sin(l),q=Math.cos(l),A=((-3*u+4)*x+4)*u*x/16,1E-14>b.H(t-h)?K=!1:(E=1E-15>b.H(u)?q-e*f/
b.nb(1E-15,u)*2:q-e*f/u*2,w=E*E)):(0>(m-n)*(n-h)&&5<H&&(m=(2*m+3*n+h)/6),h=n,n=m)):(t=(m-d)/v,0>(t-n)*(n-h)&&5<H&&(t=(2*t+3*n+h)/6),h=n,n=t,u=1-t*t,A=t*r/(p*k),q=-Math.sqrt(b.H(1-A*A)),m=Math.atan2(A,q),r=k*A,l=p*f-e*k*q,r=Math.sqrt(r*r+l*l),q=e*f+p*k*q,l=Math.atan2(r,q),A=((-3*u+4)*x+4)*u*x/16,1E-14>b.H(t-h)?K=!1:(E=1E-15>b.H(u)?q-e*f/b.nb(1E-15,u)*2:q-e*f/u*2,w=E*E));null!=g&&(t=Math.sqrt(1+(1/(c*c)-1)*u),t=(t-1)/(t+1),u=t*(1-.375*t*t),g.l=(1+t*t/4)/(1-t)*c*6378137*(l-u*r*(E+u/4*(q*(-1+2*w)-u/6*
E*(-3+4*r*r)*(-3+4*w)))))}}};b.$g=3.141592653589793;b.Vr=1.5707963267948966;b.fv=6.283185307179586;b.bF=3.552713678800501E-15;return b}();a.nH=b})(z||(z={}));(function(a){var b=function(){function a(){}a.prototype.uv=function(a){this.hi=a};a.prototype.GA=function(a){this.Ab=a};a.prototype.HA=function(a){this.nn=a};a.vB=function(a){return a.s()||1607!=a.D()&&1736!=a.D()?!1:!0};a.tB=function(a){return a.s()||1607!=a.D()&&1736!=a.D()||20>a.F()?!1:!0};a.uB=function(a){return a.s()||1607!=a.D()&&1736!=
a.D()||20>a.F()?!1:!0};return a}();a.Wj=b})(z||(z={}));(function(a){var b=function(){function b(){}b.FH=function(b){var c=new a.Ka;c.Uy(b.R.v,b.R.C);c.wj(b.R.v,b.R.G);c.wj(b.R.B,b.R.G);c.wj(b.R.B,b.R.C);return c};b.aT=function(b,c){var e=a.wi.local();b=new a.Pc(b);return e.$(b,c,null).next()};b.ll=function(b,c,e){return a.Zr.local().$(b,c,e,null)};b.On=function(b,c,e){return a.dv.local().$(b,c,e,null)};b.MS=function(b,c,e){var d=a.dv.local();b=new a.Pc(b);c=new a.Pc(c);e=d.$(b,c,e,null);for(d=[];null!=
(c=e.next());)d.push(c);return d};b.lc=function(b,c,e){return a.bl.local().$(3,b,c,e,null)};b.nM=function(b,c,e){return a.bl.local().$(4,b,c,e,null)};b.QO=function(b,c,e){var d=a.$r.local();b=new a.Pc(b);c=new a.Pc(c);e=d.$(b,c,e,null);for(d=[];null!=(c=e.next());)d.push(c);return d};b.kM=function(b,c,e){var d=a.Zr.local();b=new a.Pc(b);c=new a.Pc(c);e=d.$(b,c,e,null);for(d=[];null!=(c=e.next());)d.push(c);return d};b.Ga=function(b,c,e){return a.$r.local().$(b,c,e,null)};b.jT=function(b,c,e){return a.bl.local().$(2,
b,c,e,null)};b.contains=function(b,c,e){return a.bl.local().$(1,b,c,e,null)};b.VL=function(b,c,e){return a.bl.local().$(16,b,c,e,null)};b.touches=function(b,c,e){return a.bl.local().$(8,b,c,e,null)};b.tQ=function(b,c,e){return a.bl.local().$(32,b,c,e,null)};b.RO=function(b,c,e){return a.bl.local().$(1073741824,b,c,e,null)};b.py=function(b,c,e,d){return a.fI.local().$(b,c,e,d,null)};b.Fb=function(b,c,e,d){var f=null;if(null!=e){if(f=e.Se(),null!=d&&f.Qc()!=d.Qc()&&f.Nc!=d.Nc)throw a.g.cj();}else if(null!=
d)throw a.g.N();b=a.ZH.local().$(b,c,null);null!==f&&null!==d&&(b=a.Tb.ih(b,f,d));return b};b.clip=function(b,c,e){return a.SH.local().$(b,a.i.Oa(c.R.v,c.R.C,c.R.B,c.R.G),e,null)};b.xm=function(b,c,e){if(null==b||null==c)return null;b=a.UH.local().$(!0,b,c,e,null);for(c=[];null!=(e=b.next());)e.s()||c.push(e);return c.slice(0)};b.rK=function(c,e,d,f,g,k,h,n){if(!0===g)return b.VP(c,e,d,f,k,h,n);g=d;if(null!=e){if(h=e.Se(),null!=f&&h.Qc()!=f.Qc()){if(h.Nc!=f.Nc)throw a.g.cj();g=[];a.Tb.OB(d,d.length,
f,h,g)}}else if(null!=f)throw a.g.N();d=a.Oz.local();if(k){c=new a.Pc(c);e=d.$(c,e,g,k,null);for(c=[];null!=(k=e.next());)c.push(k);k=c.slice(0)}else for(k=[],f=0;f<c.length;f++)k[f]=d.$(c[f],e,g[f],null);return k};b.VP=function(b,c,e,d,f,g,k){if(null===c)throw a.g.N();if(null===d||void 0===d)d=4326!==c.Qc()?c.Se():a.Tb.Qd(9001);if(0!==d.Nc)throw a.g.N();a.Tb.OB(e,e.length,d,a.Tb.Qd(9001),e);d=a.Tz.local();if(f){b=new a.Pc(b);c=d.$(b,c,g,e,k,!1,f,null);for(e=[];null!=(g=c.next());)e.push(g);f=e.slice(0)}else{f=
[];for(var p=0;p<b.length;p++)f[p]=d.$(b[p],c,g,e[p],k,!1,null)}return f};b.buffer=function(b,c,e,d,f,g,k){var p=e;if(!1===f){if(null!=c){if(f=c.Se(),null!=d&&f.Qc()!=d.Qc()){if(f.Nc!=d.Nc)throw a.g.cj();p=a.Tb.ih(e,d,f)}}else if(null!=d)throw a.g.N();b=a.Oz.local().$(b,c,p,null)}else{if(null===c)throw a.g.N();if(null===d||void 0===d)d=4326!==c.Qc()?c.Se():a.Tb.Qd(9001);if(0!==d.Nc)throw a.g.N();p=a.Tb.ih(e,d,a.Tb.Qd(9001));b=a.Tz.local().$(b,c,g,p,k,!1,null)}return b};b.sQ=function(b,c,e,d,f,g,k){if(null!=
c){var p=c.Se();if(null!=k&&p.Qc()!=k.Qc()){if(p.Nc!=k.Nc)throw a.g.cj();e=a.Tb.ih(e,k,p)}}else if(null!=k)throw a.g.N();b=new a.Pc(b);c=a.Wz.local().$(b,c,e,d,f,g,null);for(e=[];null!=(d=c.next());)e.push(d);return e.slice(0)};b.offset=function(b,c,e,d,f,g,k){if(null!=c){var p=c.Se();if(null!=k&&p.Qc()!=k.Qc()){if(p.Nc!=k.Nc)throw a.g.cj();e=a.Tb.ih(e,k,p)}}else if(null!=k)throw a.g.N();return a.Wz.local().$(b,c,e,d,f,g,null)};b.JL=function(b){return a.Qz.local().$(b,null)};b.KL=function(b,c){var e=
a.Qz.local();b=new a.Pc(b);e=e.$(b,c,null);for(b=[];null!=(c=e.next());)b.push(c);return b};b.zw=function(b,c,e){return a.bv.local().zw(b,c,e)};b.Aw=function(b,c){return a.bv.local().Aw(b,c)};b.Bw=function(b,c,e,d){return a.bv.local().Bw(b,c,e,d)};b.Qy=function(b,c){return a.as.local().$(b,c,!1,null)};b.cP=function(b,c){return a.as.local().Ro(b,c,null)};b.fN=function(b,c,e,d,f){var g=a.Sz.local();if(null!=c){if(c=c.Se(),null!=f&&c.Qc()!=f.Qc()){if(c.Nc!=f.Nc)throw a.g.cj();e=a.Tb.ih(e,f,c)}}else if(null!=
f)throw a.g.N();return g.$(b,e,d,null)};b.oq=function(b,c,e,d){var f=a.WH.local();if(null!=c){if(c=c.Se(),null!=d&&c.Qc()!=d.Qc()){if(c.Nc!=d.Nc)throw a.g.cj();e=a.Tb.ih(e,d,c)}}else if(null!=d)throw a.g.N();return f.$(b,e,null)};b.fw=function(b,c,e,d,f){void 0===f&&(f=0);var g=a.aI.local();if(4==f)throw a.g.qe();if(0!==f)throw a.g.qe();if(null!=c){var p=c.Se();if(null!=d&&p.Qc()!=d.Qc()){if(p.Nc!=d.Nc)throw a.g.cj();e=a.Tb.ih(e,d,p)}}else if(null!=d)throw a.g.N();return g.$(b,e,c,f,null)};b.jN=function(c,
e,d,f){if(null===c)return 0;if(4==f)throw a.g.qe();if(0!==f)throw a.g.qe();if(197==c.D())c=b.FH(c);else if(1736!=c.D())return 0;f=a.Ya.Em(e);c=a.Ya.Wl(c,e,f);c=a.oH.kN([c])[0];if(null!==d){if(2!==d.Nc)throw a.g.N("Unit must be a area unit type");c=a.Tb.ih(c,a.Tb.Qd(109404),d)}return c};b.nN=function(b,c,e,d){b=a.cI.local().$(b,c,d,null);if(null!==e){if(0!==e.Nc)throw a.g.N("Unit must be a linear unit type");b=a.Tb.ih(b,a.Tb.Qd(9001),e)}return b};b.BQ=function(b,c,e){if(null===b)return 0;var d=null;
if(null!=c){d=c.Se();if(0==d.Nc&&(d=a.Tb.PC(d),null==d&&null!==e))throw a.g.N();if(null!=e&&d.Qc()!=e.Qc()&&d.Nc!=e.Nc)throw a.g.cj();}else if(null!=e)throw a.g.N();return 1736==b.D()||197==b.D()?(b=b.Mh(),null!==e?a.Tb.ih(b,d,e):b):0};b.CQ=function(b,c,e){if(null===b||b.s()||1>b.fb())return 0;var d=null;if(null!=c){if(d=c.Se(),null!=e&&d.Qc()!=e.Qc()&&d.Nc!=e.Nc)throw a.g.cj();}else if(null!=e)throw a.g.N();1736==b.D()||197==b.D()?c=b.Rf():a.T.Lc(b.D())?(c=new a.Xa(b.description),c.Bc(b,!0)):c=b;
b=0;c=c.Ca();for(var f=new a.b,g=new a.b;c.kb();)for(;c.La();){var p=c.ia();p.ht(f);p.uw(g);b+=a.b.Fb(f,g)}null!==d&&null!==e&&(b=a.Tb.ih(b,d,e));return b};b.YT=function(b,c){return a.Nf.mN(b,c)};b.IL=function(a){return void 0!==a.points?b.kH(a,void 0===a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM):void 0!==a.rings?b.Nz(a.rings,void 0===a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM,"P"):void 0!==a.paths?b.Nz(a.paths,void 0===a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM,"L"):void 0!==a.x?b.uH(a):void 0!==
a.xmin?b.hH(a):null};b.uH=function(b){if(null==b.x||"NaN"==b.x)return new a.Va;var c=new a.Va(b.x,b.y);void 0!==b.z&&null!==b.z&&c.rS(b.z);void 0!==b.m&&null!==b.m&&c.bS(b.m);return c};b.hH=function(b){if(null==b.xmin||"NaN"==b.xmin)return new a.Vj;var c=new a.Vj(b.xmin,b.ymin,b.xmax,b.ymax);void 0!==b.zmin&&null!==b.zmin&&c.setInterval(1,0,b.zmin,b.zmax);void 0!==b.mmin&&null!==b.mmin&&c.setInterval(2,0,b.mmin,b.mmax);return c};b.kH=function(b,c,e){var d=0,f=new a.pe,g=3*b.points.length;0!=g%2&&
g++;2>g&&(g=2);var p=a.I.truncate(3*b.points.length/2);4>p?p=4:16>p&&(p=16);for(var g=a.Ac.kl(g,0),k=a.Ac.kl(p),p=a.Ac.kl(p),h=0;h<b.points.length;h++)g.write(2*h,b.points[h][0]),g.write(2*h+1,b.points[h][1]),k.write(h,c||e?b.points[h][2]:NaN),p.write(h,e&&c?b.points[h][3]:NaN),d++;0!=d&&(f.resize(d),f.bm(0,g));c&&(f.Ne(1),f.bm(1,k));e&&(f.Ne(2),f.bm(2,0==c?k:p));f.ce(16777215);return f};b.Nz=function(b,c,e,d){var f,g=0,p=2;"P"==d?(f=new a.Ka,g=1,p=3):f=new a.Xa;for(var k=a.Ac.Dg(0),h=a.Ac.to(0),
n=0,q=0,A=[],l=[],r=0;r<b.length;r++){var t=b[r].length;A[r]=!1;if("P"===d&&b[r][0][0]===b[r][b[r].length-1][0]&&b[r][0][1]===b[r][b[r].length-1][1]){var u=0==e?!0:b[r][0][3]===b[r][b[r].length-1][3]||void 0===b[r][0][3]&&void 0===b[r][b[r].length-1][3];(0==c||b[r][0][2]===b[r][b[r].length-1][2]||void 0===b[r][0][2]&&void 0===b[r][b[r].length-1][2])&&u&&(A[r]=!0,--t)}t>=p?(l[r]=!1,q+=1,k.add(n),h.add(g),n+=t):l[r]=!0}d=3*n;0!=d%2&&d++;2>d&&(d=2);r=a.I.truncate(3*n/2);4>r?r=4:16>r&&(r=16);d=a.Ac.kl(d,
0);g=a.Ac.kl(r);p=a.Ac.kl(r);for(r=t=0;r<b.length;r++)if(!1===l[r])for(u=0;u<b[r].length;u++){var w=!1;u===b[r].length-1&&!0===A[r]&&(w=!0);w||(d.write(2*t,b[r][u][0]),d.write(2*t+1,b[r][u][1]),g.write(t,c||e?b[r][u][2]:NaN),p.write(t,e&&c?b[r][u][3]:NaN),t++)}0!=n&&(b=f,k.resize(q),h.resize(q),0<n&&(k.add(n),h.add(0)),b.bm(0,d),b.NF(h),b.OF(k));c&&(f.Ne(1),f.bm(1,g));e&&(f.Ne(2),f.bm(2,0==c?g:p));f.ce(16777215);return f};return b}();a.Pb=b})(z||(z={}));(function(a){var b=function(){function a(){}
a.Zk=function(a){var b=0,c=0,e=a.length,d=a[c],f;for(c;c<e-1;c++)f=a[c+1],b+=(f[0]-d[0])*(f[1]+d[1]),d=f;return 0<=b};a.rotate=function(b,c,e){c=c*Math.PI/180;var d=Math.cos(c),f=Math.sin(c);if(void 0!==b.paths){c={paths:[]};for(var g=0;g<b.paths.length;g++){for(var p=b.paths[g],k=[],h=0;h<p.length;h++){var n=p[h].slice(0);k.push(n);var q=d*(p[h][0]-e.x)-f*(p[h][1]-e.y)+e.x,A=f*(p[h][0]-e.x)+d*(p[h][1]-e.y)+e.y;n[0]=q;n[1]=A}c.paths.push(k)}return c}if(void 0!==b.rings){c={rings:[]};for(g=0;g<b.rings.length;g++){for(var p=
b.rings[g],k=[],l=a.Zk(p),h=0;h<p.length;h++)n=p[h].slice(0),k.push(n),q=d*(p[h][0]-e.x)-f*(p[h][1]-e.y)+e.x,A=f*(p[h][0]-e.x)+d*(p[h][1]-e.y)+e.y,n[0]=q,n[1]=A;a.Zk(k)!==l&&k.reverse();c.rings.push(k)}return c}if(void 0!==b.x)return c={x:d*(b.x-e.x)-f*(b.y-e.y)+e.x,y:f*(b.x-e.x)+d*(b.y-e.y)+e.y},void 0!==b.z&&(c.z=b.z),void 0!==b.m&&(c.m=b.m),c;if(void 0!==b.points){c={points:[]};b=b.points;for(h=0;h<b.length;h++)g=b[h].slice(0),g[0]=d*(b[h][0]-e.x)-f*(b[h][1]-e.y)+e.x,g[1]=f*(b[h][0]-e.x)+d*(b[h][1]-
e.y)+e.y,c.points.push(g);return c}return null};a.eC=function(b,c){var e,d;if(void 0!==b.paths){e={paths:[]};for(var f=0;f<b.paths.length;f++){for(var g=b.paths[f],p=[],k=0;k<g.length;k++){var h=g[k].slice(0);p.push(h);d=c.x-g[k][0];h[0]=g[k][0]+2*d}e.paths.push(p)}return e}if(void 0!==b.rings){e={rings:[]};for(f=0;f<b.rings.length;f++){for(var g=b.rings[f],n=a.Zk(g),p=[],k=0;k<g.length;k++)h=g[k].slice(0),p.push(h),d=c.x-g[k][0],h[0]=g[k][0]+2*d;a.Zk(p)!==n&&p.reverse();e.rings.push(p)}return e}if(void 0!==
b.x)return d=c.x-b.x,e={x:b.x+2*d,y:b.y},void 0!==b.z&&(e.z=b.z),void 0!==b.m&&(e.m=b.m),e;if(void 0!==b.points){e={points:[]};f=b.points;for(k=0;k<f.length;k++)g=f[k].slice(0),d=c.x-g[0],g[0]+=2*d,e.points.push(g);return e}return void 0!==b.xmin?(e={v:b.xmin,C:b.ymin,B:b.xmax,G:b.ymax},void 0!==b.zmin&&(e.zmin=b.zmin,e.zmax=b.zmax),void 0!==b.mmin&&(e.mmin=b.mmin,e.mmax=b.mmax),d=c.x-b.xmin,e.xmax=b.xmin+2*d,d=c.x-b.xmax,e.xmin=b.xmax+2*d,e):null};a.fC=function(b,c){var e,d;if(void 0!==b.paths){e=
{paths:[]};for(var f=0;f<b.paths.length;f++){for(var g=b.paths[f],p=[],k=0;k<g.length;k++){var h=g[k].slice(0);p.push(h);d=c.y-g[k][1];h[1]=g[k][1]+2*d}e.paths.push(p)}return e}if(void 0!==b.rings){e={rings:[]};for(f=0;f<b.rings.length;f++){for(var g=b.rings[f],n=a.Zk(g),p=[],k=0;k<g.length;k++)h=g[k].slice(0),p.push(h),d=c.y-g[k][1],h[1]=g[k][1]+2*d;a.Zk(p)!==n&&p.reverse();e.rings.push(p)}return e}if(void 0!==b.x)return d=c.y-b.y,e={y:b.y+2*d,x:b.x},void 0!==b.z&&(e.z=b.z),void 0!==b.m&&(e.m=b.m),
e;if(void 0!==b.points){e={points:[]};f=b.points;for(k=0;k<f.length;k++)g=f[k].slice(0),d=c.y-g[1],g[1]+=2*d,e.points.push(g);return e}return void 0!==b.xmin?(e={v:b.xmin,C:b.ymin,B:b.xmax,G:b.ymax},void 0!==b.zmin&&(e.zmin=b.zmin,e.zmax=b.zmax),void 0!==b.mmin&&(e.mmin=b.mmin,e.mmax=b.mmax),d=c.y-b.ymin,e.ymax=b.ymin+2*d,d=c.y-b.ymax,e.ymin=b.ymax+2*d,e):null};return a}();a.Wn=b})(z||(z={}));(function(a){var b=function(){function b(){}b.jg=function(b,c){null==c&&(c=a.Od.Tf());switch(b){case 33:return new a.Va(c);
case 322:return new a.yb(c);case 197:return new a.Vj(c);case 550:return new a.pe(c);case 1607:return new a.Xa(c);case 1736:return new a.Ka(c);default:throw a.g.ra("invalid argument.");}};return b}();a.sH=b})(z||(z={}));(function(a){var b=function(){function b(b,c){this.De=a.ga.Yc(b,-1);this.oa=new a.Ur;this.tk=c}b.prototype.wR=function(a){this.oa.Dr(Math.min(this.De.size,a));this.oa.$l(a)};b.prototype.addElement=function(b,c){if(void 0===c)return this.JJ(b);c=a.I.truncate(c%this.De.size);var e=this.De.get(c);
-1==e&&(e=this.oa.jh(),this.De.set(c,e));return this.oa.addElement(e,b)};b.prototype.JJ=function(b){var c=this.tk.vw(b),c=a.I.truncate(c%this.De.size),e=this.De.get(c);-1==e&&(e=this.oa.jh(),this.De.set(c,e));return this.oa.addElement(e,b)};b.prototype.Jc=function(b,c){if(void 0===c)this.dM(b);else{c=a.I.truncate(c%this.De.size);var e=this.De.get(c);if(-1==e)throw a.g.N();for(var d=this.oa.gc(e),f=-1;-1!=d;){var g=this.oa.bb(d);this.oa.da(d)==b?(this.oa.Jc(e,f,d),-1==this.oa.gc(e)&&(this.oa.Fg(e),
this.De.set(c,-1))):f=d;d=g}}};b.prototype.dM=function(b){var c=this.tk.vw(b),c=a.I.truncate(c%this.De.size),e=this.De.get(c);if(-1==e)throw a.g.N();for(var d=this.oa.gc(e),f=-1;-1!=d;){var g=this.oa.bb(d);this.oa.da(d)==b?(this.oa.Jc(e,f,d),-1==this.oa.gc(e)&&(this.oa.Fg(e),this.De.set(c,-1))):f=d;d=g}};b.prototype.DN=function(b){b=a.I.truncate(b%this.De.size);b=this.De.get(b);return-1==b?-1:this.oa.gc(b)};b.prototype.SN=function(a){return this.oa.bb(a)};b.prototype.kd=function(b){var c=this.tk.vw(this.da(b)),
c=a.I.truncate(c%this.De.size),e=this.De.get(c);if(-1==e)throw a.g.N();for(var d=this.oa.gc(e),f=-1;-1!=d;){if(d==b){this.oa.Jc(e,f,d);-1==this.oa.gc(e)&&(this.oa.Fg(e),this.De.set(c,-1));return}f=d;d=this.oa.bb(d)}throw a.g.N();};b.prototype.da=function(a){return this.oa.da(a)};b.prototype.clear=function(){this.De=a.ga.Yc(this.De.size,-1);this.oa.clear()};b.prototype.size=function(){return this.oa.HC()};return b}();a.AH=b})(z||(z={}));(function(a){var b=function(){function b(){this.ci=new a.Fc(3);
this.oa=new a.Fc(6);this.AP=!1;this.Wd=-1}b.prototype.bk=function(a){this.ci.Jc(a)};b.prototype.ou=function(){return this.ci.be()};b.prototype.Rs=function(a){this.oa.Jc(a)};b.prototype.Yx=function(){return this.oa.be()};b.prototype.Jy=function(a,b){this.ci.L(a,1,b)};b.prototype.Gu=function(a,b){this.ci.L(a,2,b)};b.prototype.aS=function(a,b){this.ci.L(a,3,b)};b.prototype.Hy=function(a,b){this.oa.L(a,4,b)};b.prototype.dS=function(a,b){this.oa.L(a,3,b)};b.prototype.RF=function(a,b){this.oa.L(a,2,b)};
b.prototype.jh=function(a){var b=this.Yx();this.oa.L(b,3,this.Wd);this.oa.L(b,4,0);this.oa.L(b,5,a);-1!=this.Wd&&this.RF(this.Wd,b);return this.Wd=b};b.prototype.Fg=function(a){this.CB(a);var b=this.oa.O(a,2),c=this.oa.O(a,3);-1!=b?this.dS(b,c):this.Wd=c;-1!=c&&this.RF(c,b);this.Rs(a);return c};b.prototype.Dr=function(a){this.oa.de(a)};b.prototype.DC=function(a){return this.oa.O(a,5)};b.prototype.$R=function(a,b){this.oa.L(a,5,b)};b.prototype.addElement=function(a,b){return this.AO(a,b)};b.prototype.AO=
function(a,b){var c=this.ou();this.Gu(c,-1);-1==this.oa.O(a,0)&&this.oa.L(a,0,c);var e=this.oa.O(a,1);this.Jy(c,e);-1!=e&&this.Gu(e,c);this.oa.L(a,1,c);this.setData(c,b);this.Hy(a,this.vq(a)+1);this.AP&&this.aS(c,a);return c};b.prototype.Jc=function(a,b){var c=this.ge(b),e=this.bb(b);-1!=c?this.Gu(c,e):this.oa.L(a,0,e);-1!=e?this.Jy(e,c):this.oa.L(a,1,c);this.bk(b);this.Hy(a,this.vq(a)-1);return e};b.prototype.$l=function(a){this.ci.de(a)};b.prototype.getData=function(a){return this.ci.O(a,0)};b.prototype.setData=
function(a,b){this.ci.L(a,0,b)};b.prototype.bb=function(a){return this.ci.O(a,2)};b.prototype.ge=function(a){return this.ci.O(a,1)};b.prototype.gc=function(a){return this.oa.O(a,0)};b.prototype.tc=function(a){return this.oa.O(a,1)};b.prototype.clear=function(){for(var a=this.Wd;-1!=a;)a=this.Fg(a)};b.prototype.CB=function(a){for(var b=this.tc(a);-1!=b;){var c=b,b=this.ge(c);this.bk(c)}this.oa.L(a,0,-1);this.oa.L(a,1,-1);this.Hy(a,0)};b.prototype.s=function(){return 0==this.ci.size};b.prototype.HC=
function(){return this.ci.size};b.prototype.vq=function(a){return this.oa.O(a,4)};b.prototype.Cw=function(a){return this.oa.O(a,3)};return b}();a.$n=b})(z||(z={}));(function(a){var b=function(){function b(b){void 0===b?(this.bg=new a.Fc(2),this.oa=new a.Fc(4),this.Wd=-1,this.Bt=!0):(this.bg=new a.Fc(2),this.oa=new a.Fc(b?4:2),this.Wd=-1,this.Bt=b)}b.prototype.bk=function(a){this.bg.Jc(a)};b.prototype.ou=function(){return this.bg.be()};b.prototype.Rs=function(a){this.oa.Jc(a)};b.prototype.Yx=function(){return this.oa.be()};
b.prototype.jh=function(){var a=this.Yx();this.Bt&&(this.oa.L(a,3,this.Wd),-1!=this.Wd&&this.oa.L(this.Wd,2,a),this.Wd=a);return a};b.prototype.Fg=function(a){for(var b=this.gc(a);-1!=b;){var c=b,b=this.bb(b);this.bk(c)}this.Bt&&(b=this.oa.O(a,2),c=this.oa.O(a,3),-1!=b?this.oa.L(b,3,c):this.Wd=c,-1!=c&&this.oa.L(c,2,b));this.Rs(a)};b.prototype.Dr=function(a){this.oa.de(a)};b.prototype.addElement=function(a,b){var c=this.oa.O(a,1),e=this.ou();-1!=c?this.bg.L(c,1,e):this.oa.L(a,0,e);this.oa.L(a,1,e);
this.bg.L(e,0,b);return e};b.prototype.$l=function(a){this.bg.de(a)};b.prototype.Jc=function(a,b,c){-1!=b?(this.bg.L(b,1,this.bg.O(c,1)),this.oa.O(a,1)==c&&this.oa.L(a,1,b)):(this.oa.L(a,0,this.bg.O(c,1)),this.oa.O(a,1)==c&&this.oa.L(a,1,-1));this.bk(c)};b.prototype.Qv=function(a,b){var c=this.oa.O(a,1),e=this.oa.O(b,0);-1!=e&&(-1!=c?this.bg.L(c,1,e):this.oa.L(a,0,e),this.oa.L(a,1,this.oa.O(b,1)));this.Bt&&(c=this.oa.O(b,2),e=this.oa.O(b,3),-1!=c?this.oa.L(c,3,e):this.Wd=e,-1!=e&&this.oa.L(e,2,c));
this.Rs(b)};b.prototype.da=function(a){return this.bg.O(a,0)};b.prototype.Vi=function(a,b){this.bg.L(a,0,b)};b.prototype.bb=function(a){return this.bg.O(a,1)};b.prototype.gc=function(a){return this.oa.O(a,0)};b.prototype.Dm=function(a){return this.da(this.gc(a))};b.prototype.clear=function(){this.bg.Nh(!0);this.oa.Nh(!0);this.Wd=-1};b.prototype.s=function(a){return void 0===a?0==this.bg.size:-1==this.oa.O(a,0)};b.prototype.HC=function(){return this.bg.size};b.prototype.Cw=function(a){return this.oa.O(a,
3)};return b}();a.Ur=b})(z||(z={}));(function(a){var b=function(){function b(){}b.kz=function(c,e,d,f,g,k,h){var p=new a.b;p.J(c);c=new a.b;c.J(e);g.vv(p);g.vv(c);e=g.ms(p);var n=g.ms(c);0==n&&(n=g.CC());if(p.x!=c.x&&(p.y!=c.y||p.y!=g.C&&p.y!=g.G)||n>e!=k){e=g.vA(p);var n=g.vA(c),q,A=k?1:3;do e=e+A&3,q=g.vu(e),0!=h&&(f=b.kz(p,q,d,f,g,k,h)),d[f++].ma(q.x,q.y),p=q;while((e&3)!=n);0!=h&&(f=b.kz(p,c,d,f,g,k,h))}else if(g=new a.b,g.ma(c.x-p.x,c.y-p.y),0!=h&&(h=a.I.truncate(g.yJ()/h),0<h))for(g.scale(1/
(h+1)),k=0;k<h;k++)p.add(g),d[f++].ma(p.x,p.y);return f};b.zd=function(a,b,c){b=b.lv();a=null!=a&&void 0!==a.Ko?a.Ko():0;c&&(b*=4,a*=1.1);return Math.max(a,b)};b.As=function(a){return 2*Math.sqrt(2)*a};b.UJ=function(a){return Math.sqrt(2)*a};b.Cg=function(c,e,d){var f=new a.i;e.o(f);return b.zd(c,f,d)};b.rB=function(a,b,c){b=b.Ah(1,0).lv();a=null!=a?a.Ko():0;c&&(b*=4,a*=1.1);return Math.max(a,b)};b.$T=function(b,c){var e=new a.i;b.dd(e);e.Db(c);return e};b.$s=function(b,c){var e=new a.i;b.dd(e);b=
new a.i;c.dd(b);e.Db(b);return e};b.fU=function(b,c){var e=b.HN(c),d=b.Ea(c),f=b.Dc(c),g=b.Fa(e);e==d?(f=b.Fa(f-1),e=b.Fa(d+1)):e==f-1?(f=b.Fa(e-1),e=b.Fa(d)):(f=b.Fa(e-1),e=b.Fa(e+1));g=a.b.yn(f,g,e);return 0==g?0<b.oo(c):-1==g};b.CK=function(b){var c=new a.i;b.dd(c);if(c.s())return null;var e=new a.co(c,8),d=-1,f=new a.i,g=!1;do for(var k=0,h=b.ea();k<h;k++)if(b.Ti(k,f),d=e.kt(k,f,d),-1==d){if(g)throw a.g.ra("internal error");b.tm(c,!1);g=!0;e.reset(c,8);break}else g=!1;while(g);return e};b.nB=
function(b){var c=new a.i;b.dd(c);for(var e=new a.co(c,8),d=-1,f=b.Ca(),g=new a.i,k=!1;f.kb();)for(;f.La();){var h=f.ia(),n=f.Jb();h.o(g);d=e.kt(n,g,d);if(-1==d){if(k)throw a.g.wa();b.tm(c,!1);k=!0;e.reset(c,8);f.Lk();break}}return e};b.ij=function(b,c){var e=new a.i;b.dd(e);for(var d=new a.co(e,8),f=-1,g=new a.i,p=b.Ca(),k=!1;p.kb();)for(;p.La();){var h=p.ia(),n=p.Jb();h.o(g);if(g.jc(c)&&(f=d.kt(n,g,f),-1==f)){if(k)throw a.g.ra("internal error.");b.tm(e,!1);k=!0;d.reset(e,8);p.Lk();break}}return d};
b.DT=function(b){var c=new a.i;b.dd(c);for(var e=new a.co(c,8),d=new a.b,f=new a.i,g=!1,k=0;k<b.F();k++)if(b.w(k,d),f.K(d),-1==e.lg(k,f)){if(g)throw a.g.wa();b.tm(c,!1);g=!0;e.reset(c,8);k=-1}return e};b.oB=function(b,c){for(var e=new a.co(c,8),d=new a.b,f=!1,g=new a.i,p=0;p<b.F();p++)if(b.w(p,d),c.contains(d)&&(g.K(d),-1==e.lg(p,g))){if(f)throw a.g.wa();f=!0;p=new a.i;b.tm(p,!1);e.reset(p,8);p=-1}return e};b.AN=function(b,c,e){var d=new a.i,f=new a.i;b.dd(d);c.dd(f);d.P(e,e);f.P(e,e);var g=new a.i;
g.K(d);g.Ga(f);b=b.Ca();c=c.Ca();var p=new a.sz;p.YF(e);var k=!1;for(p.jG();b.kb();)for(;b.La();)b.ia().o(d),d.jc(g)&&(k=!0,e=new a.i,e.K(d),p.OA(b.Jb(),e));p.$B();if(!k)return null;d=!1;for(p.iG();c.kb();)for(;c.La();)c.ia().o(f),f.jc(g)&&(d=!0,e=new a.i,e.K(f),p.LA(c.Jb(),e));p.ZB();return d?p:null};b.BN=function(b,c,e,d,f){var g=b.D(),p=c.D(),k=new a.i,h=new a.i;b.dd(k);c.dd(h);k.P(e,e);h.P(e,e);var n=new a.i;n.K(k);n.Ga(h);var q=new a.sz;q.YF(e);var A=!1;q.jG();var l=0;for(e=b.ea();l<e;l++)if(!d||
1736!=g||b.qt(l))b.Ti(l,k),k.jc(n)&&(A=!0,q.OA(l,k));q.$B();if(!A)return null;b=!1;q.iG();d=0;for(e=c.ea();d<e;d++)if(!f||1736!=p||c.qt(d))c.Ti(d,h),h.jc(n)&&(b=!0,q.LA(d,h));q.ZB();return b?q:null};b.hU=function(a,b){return 0<a.rj(b)};b.zT=function(b,c){var e=new a.i;b.hR(c,e);var e=new a.co(e,8),d=-1,f=new a.i;b=b.Ca();b.vy(c);if(b.kb())for(;b.La();){c=b.ia();var g=b.Jb();c.dd(f);d=e.kt(g,f,d);if(-1==d)throw a.g.ra("internal error");}return e};return b}();a.Ia=b})(z||(z={}));(function(a){var b=
function(){function a(a){this.Na=a}a.prototype.compare=function(a,b,c){a=a.da(c);c=this.Na.uj(b);var e=this.Na.uj(a);return c<e?-1:c==e?f.Po(b)&&f.st(a)?-1:f.Po(a)&&f.st(b)?1:0:1};return a}(),c=function(){function a(a){this.Na=a}a.prototype.Zp=function(a,b,c){this.Na.yS(c,a,b)};a.prototype.Mo=function(a){return this.Na.uj(a)};return a}(),e;(function(a){a[a.initialize=0]="initialize";a[a.pIn=1]="pIn";a[a.pL=2]="pL";a[a.pR=3]="pR";a[a.pT=4]="pT";a[a.right=5]="right";a[a.left=6]="left";a[a.all=7]="all"})(e||
(e={}));var d=function(){function b(){this.Na=null;this.gi=new a.Nd;this.ug=new a.ga(0);this.$f=[0,0]}b.prototype.Ch=function(a,b){this.gi.qa=a.qa-b;this.gi.va=a.va+b;this.ug.resize(0);this.Ud=0;this.$f[0]=0};b.prototype.uy=function(b,c,e){if(b>c)throw a.g.N();this.gi.qa=b-e;this.gi.va=c+e;this.ug.resize(0);this.Ud=0;this.$f[0]=0};b.prototype.Fn=function(a,b){this.gi.qa=a-b;this.gi.va=a+b;this.ug.resize(0);this.Ud=0;this.$f[0]=0};b.prototype.next=function(){if(!this.Na.Vo)throw a.g.xa();if(0>this.Ud)return-1;
for(var b=!0;b;)switch(this.$f[this.Ud]){case 1:b=this.uQ();break;case 2:b=this.vQ();break;case 3:b=this.wQ();break;case 4:b=this.xQ();break;case 5:b=this.BR();break;case 6:b=this.sP();break;case 7:b=this.XJ();break;case 0:b=this.Qw();break;default:throw a.g.wa();}return-1!=this.pg?this.Bo()>>1:-1};b.JT=function(a,c,e){var d=new b;d.Na=a;d.ug.xb(20);d.Ch(c,e);return d};b.KT=function(a,c,e){var d=new b;d.Na=a;d.ug.xb(20);d.Fn(c,e);return d};b.Oa=function(a){var c=new b;c.Na=a;c.ug.xb(20);c.Ud=-1;return c};
b.prototype.Qw=function(){this.pg=this.YD=this.di=this.yc=-1;if(null!=this.Na.Yd&&0<this.Na.Yd.size)return this.$f[0]=1,this.di=this.Na.Ze,!0;this.Ud=-1;return!1};b.prototype.uQ=function(){this.yc=this.di;if(-1==this.yc)return this.pg=this.Ud=-1,!1;var a=this.Na.Co(this.yc);if(this.gi.va<a)return a=this.Na.tj(this.yc),this.di=this.Na.Di(this.yc),-1!=a&&(this.vh=this.Na.gk(a),this.$f[++this.Ud]=6),!0;if(a<this.gi.qa)return a=this.Na.tj(this.yc),this.di=this.Na.sj(this.yc),-1!=a&&(this.vh=this.Na.uq(a),
this.$f[++this.Ud]=5),!0;this.$f[this.Ud]=2;this.YD=this.yc;a=this.Na.tj(this.yc);this.di=this.Na.Di(this.yc);-1!=a&&(this.vh=this.Na.gk(a),this.$f[++this.Ud]=7);return!0};b.prototype.vQ=function(){this.yc=this.di;if(-1==this.yc)return this.$f[this.Ud]=3,this.di=this.Na.sj(this.YD),!0;if(this.Na.Co(this.yc)<this.gi.qa){var a=this.Na.tj(this.yc);this.di=this.Na.sj(this.yc);-1!=a&&(this.vh=this.Na.uq(a),this.$f[++this.Ud]=5);return!0}a=this.Na.tj(this.yc);this.di=this.Na.Di(this.yc);-1!=a&&(this.vh=
this.Na.gk(a),this.$f[++this.Ud]=7);a=this.Na.sj(this.yc);-1!=a&&this.ug.add(a);return!0};b.prototype.wQ=function(){this.yc=this.di;if(-1==this.yc)return this.$f[this.Ud]=4,!0;if(this.gi.va<this.Na.Co(this.yc)){var a=this.Na.tj(this.yc);this.di=this.Na.Di(this.yc);-1!=a&&(this.vh=this.Na.gk(a),this.$f[++this.Ud]=6);return!0}a=this.Na.tj(this.yc);this.di=this.Na.sj(this.yc);-1!=a&&(this.vh=this.Na.gk(a),this.$f[++this.Ud]=7);a=this.Na.Di(this.yc);-1!=a&&this.ug.add(a);return!0};b.prototype.xQ=function(){if(0==
this.ug.size)return this.pg=this.Ud=-1,!1;this.yc=this.ug.get(this.ug.size-1);this.ug.resize(this.ug.size-1);var a=this.Na.tj(this.yc);-1!=a&&(this.vh=this.Na.gk(a),this.$f[++this.Ud]=7);-1!=this.Na.Di(this.yc)&&this.ug.add(this.Na.Di(this.yc));-1!=this.Na.sj(this.yc)&&this.ug.add(this.Na.sj(this.yc));return!0};b.prototype.sP=function(){this.pg=this.vh;if(-1!=this.pg&&f.Po(this.Bo())&&this.Na.uj(this.Bo())<=this.gi.va)return this.vh=this.GC(),!1;this.Ud--;return!0};b.prototype.BR=function(){this.pg=
this.vh;if(-1!=this.pg&&f.st(this.Bo())&&this.Na.uj(this.Bo())>=this.gi.qa)return this.vh=this.bO(),!1;this.Ud--;return!0};b.prototype.XJ=function(){this.pg=this.vh;if(-1!=this.pg&&f.Po(this.Bo()))return this.vh=this.GC(),!1;this.Ud--;return!0};b.prototype.GC=function(){return this.Na.Df?this.Na.If.bb(this.pg):this.Na.ki.bb(this.pg)};b.prototype.bO=function(){return this.Na.Df?this.Na.If.ge(this.pg):this.Na.ki.ge(this.pg)};b.prototype.Bo=function(){return this.Na.Df?this.Na.If.da(this.pg):this.Na.ki.getData(this.pg)};
return b}();a.IT=d;var f=function(){function e(a){this.Al=this.rh=this.If=this.ki=this.Hl=this.Ki=this.Yd=this.Li=null;this.Df=a;this.Vo=this.Dt=!1}e.prototype.Vp=function(){this.Rj(!0)};e.prototype.gq=function(b,c){if(!this.Dt)throw a.g.xa();this.Li.push(new a.Nd(b,c))};e.prototype.wo=function(){if(!this.Dt)throw a.g.ra("invalid call");this.Dt=!1;this.Vo=!0;this.Df||(this.BO(),this.Jt=this.Li.length)};e.prototype.lg=function(b){if(!this.Df||!this.Vo)throw a.g.N("invalid call");if(-1==this.Ze){var c=
this.Li.length;if(this.nx){var e=new a.ga(0);e.xb(2*c);this.$E(e);this.rh.xb(2*c);this.rh.resize(0);this.ZE(e);this.Hl.resize(c,-1);this.Hl.dh(-1,0,c);this.nx=!1}else this.Hl.dh(-1,0,c);this.Ze=this.Ms()}c=this.cD(b<<1,this.Ze);e=this.If.addElement((b<<1)+1,this.Hw(c));this.TF(c,e);this.Hl.set(b,c);this.Jt++};e.prototype.remove=function(b){if(!this.Df||!this.Vo)throw a.g.ra("invalid call");var c=this.Hl.get(b);if(-1==c)throw a.g.N("the interval does not exist in the interval tree");this.Hl.set(b,
-1);this.Jt--;var e=this.Hw(c),d;d=this.If.hO(e);this.If.kd(this.LN(c),e);this.If.kd(this.eO(c),e);b=this.If.size(e);0==b&&(this.If.fM(e),this.WF(d,-1));this.Ki.Jc(c);for(var e=this.JC(d),f=this.Di(d),g=this.sj(d),c=0;!(0<b||d==this.Ze||-1!=f&&-1!=g);)d==this.Di(e)?-1!=f?(this.Sj(e,f),this.Xi(f,e),this.Sj(d,-1)):-1!=g?(this.Sj(e,g),this.Xi(g,e),this.Uj(d,-1)):this.Sj(e,-1):-1!=f?(this.Uj(e,f),this.Xi(f,e),this.Sj(d,-1)):-1!=g?(this.Uj(e,g),this.Xi(g,e),this.Uj(d,-1)):this.Uj(e,-1),this.Xi(d,-1),c++,
d=e,e=this.tj(d),b=-1!=e?this.If.size(e):0,f=this.Di(d),g=this.sj(d),e=this.JC(d)};e.prototype.reset=function(){if(!this.Df||!this.Vo)throw a.g.N("invalid call");this.Rj(!1)};e.prototype.size=function(){return this.Jt};e.prototype.Re=function(){return d.Oa(this)};e.prototype.$E=function(a){for(var b=this.Li.length,c=0;c<2*b;c++)a.add(c);this.zS(a,2*b)};e.prototype.ZE=function(a){for(var b=NaN,c=0;c<a.size;c++){var e=a.get(c),d=this.uj(e);d!=b&&(this.rh.add(e),b=d)}};e.prototype.BO=function(){var b=
this.Li.length,c=new a.ga(0);c.xb(2*b);this.$E(c);this.rh.xb(2*b);this.rh.resize(0);this.ZE(c);this.Ki.de(b);this.ki.$l(2*b);var e=a.Ac.Dg(b);e.dh(-1,0,b);this.Ze=this.Ms();for(b=0;b<c.size;b++){var d=c.get(b),f=e.get(d>>1);-1!=f?this.TF(f,this.ki.addElement(this.Hw(f),d)):(f=this.cD(d,this.Ze),e.set(d>>1,f))}};e.prototype.cD=function(b,c){var e=c,d=c,f,g=-1,p=0,k=this.rh.size-1,h=0,n=b>>1,q=NaN,l=NaN;f=!0;for(var A=this.RN(n),n=this.ON(n);f;){p<k?(h=p+a.I.truncate((k-p)/2),-1==this.rw(e)&&this.CF(e,
this.rh.get(h),this.rh.get(h+1))):-1==this.rw(e)&&this.CF(e,this.rh.get(p),this.rh.get(p));var r=this.Co(e);if(n<r)-1!=c&&(c==e?(d=e,q=r,c=this.Di(e),-1!=c?l=this.Co(c):l=NaN):l>r&&(r<q?this.Sj(d,e):this.Uj(d,e),this.Uj(e,c),this.Df&&(this.Xi(e,d),this.Xi(c,e)),d=e,q=r,c=-1,l=NaN)),k=this.MN(e),-1==k&&(k=this.Ms(),this.YR(e,k)),e=k,k=h;else if(A>r)-1!=c&&(c==e?(d=e,q=r,c=this.sj(e),-1!=c?l=this.Co(c):l=NaN):l<r&&(r<q?this.Sj(d,e):this.Uj(d,e),this.Sj(e,c),this.Df&&(this.Xi(e,d),this.Xi(c,e)),d=e,
q=r,c=-1,l=NaN)),p=this.fO(e),-1==p&&(p=this.Ms(),this.iS(e,p)),e=p,p=h+1;else{f=this.tj(e);-1==f&&(f=this.TL(e),this.WF(e,f));var t=this.KJ(f,b),g=this.SL();this.lS(g,f);this.XR(g,t);e!=c&&(r<q?this.Sj(d,e):this.Uj(d,e),this.Df&&this.Xi(e,d),-1!=c&&(l<r?this.Sj(e,c):this.Uj(e,c),this.Df&&this.Xi(c,e)));f=!1}}return g};e.prototype.Ms=function(){return this.Yd.be()};e.prototype.TL=function(a){return this.Df?this.If.nq(a):this.ki.jh(a)};e.prototype.SL=function(){return this.Ki.be()};e.prototype.Rj=
function(c){c?(this.Dt=this.nx=!0,this.Vo=!1,null==this.rh?this.rh=a.Ac.Dg(0):this.rh.resize(0),null==this.Li?this.Li=[]:this.Li.length=0):this.nx=!1;this.Df?null==this.Hl?(this.Hl=a.Ac.Dg(0),this.If=new a.bj,this.If.Hn(new b(this))):this.If.clear():null==this.ki?this.ki=new a.$n:this.ki.clear();null==this.Yd?(this.Ki=new a.Fc(3),this.Yd=new a.Fc(this.Df?8:7)):(this.Ki.Nh(!1),this.Yd.Nh(!1));this.Ze=-1;this.Jt=0};e.prototype.CF=function(a,b,c){this.SR(a,b);this.TR(a,c)};e.prototype.Co=function(a){var b=
this.rw(a);if(-1==b)return NaN;b=this.uj(b);a=this.uj(this.wN(a));return b==a?b:.5*(b+a)};e.prototype.SR=function(a,b){this.Yd.L(a,0,b)};e.prototype.TR=function(a,b){this.Yd.L(a,1,b)};e.prototype.YR=function(a,b){this.Yd.L(a,3,b)};e.prototype.iS=function(a,b){this.Yd.L(a,4,b)};e.prototype.WF=function(a,b){this.Yd.L(a,2,b)};e.prototype.Sj=function(a,b){this.Yd.L(a,5,b)};e.prototype.Uj=function(a,b){this.Yd.L(a,6,b)};e.prototype.Xi=function(a,b){this.Yd.L(a,7,b)};e.prototype.lS=function(a,b){this.Ki.L(a,
0,b)};e.prototype.KJ=function(a,b){return this.Df?this.If.addElement(b,a):this.ki.addElement(a,b)};e.prototype.XR=function(a,b){this.Ki.L(a,1,b)};e.prototype.TF=function(a,b){this.Ki.L(a,2,b)};e.prototype.gk=function(a){return this.Df?this.If.gc(a):this.ki.gc(a)};e.prototype.uq=function(a){return this.Df?this.If.tc(a):this.ki.tc(a)};e.Po=function(a){return 0==(a&1)};e.st=function(a){return 1==(a&1)};e.prototype.rw=function(a){return this.Yd.O(a,0)};e.prototype.wN=function(a){return this.Yd.O(a,1)};
e.prototype.tj=function(a){return this.Yd.O(a,2)};e.prototype.MN=function(a){return this.Yd.O(a,3)};e.prototype.fO=function(a){return this.Yd.O(a,4)};e.prototype.Di=function(a){return this.Yd.O(a,5)};e.prototype.sj=function(a){return this.Yd.O(a,6)};e.prototype.JC=function(a){return this.Yd.O(a,7)};e.prototype.Hw=function(a){return this.Ki.O(a,0)};e.prototype.LN=function(a){return this.Ki.O(a,1)};e.prototype.eO=function(a){return this.Ki.O(a,2)};e.prototype.RN=function(a){return this.Li[a].qa};e.prototype.ON=
function(a){return this.Li[a].va};e.prototype.zS=function(b,e){null==this.Al&&(this.Al=new a.Rr);var d=new c(this);this.Al.sort(b,0,e,d)};e.prototype.yS=function(a,b,c){var d=this;a.xd(b,c,function(a,b){var c=d.uj(a),f=d.uj(b);return c<f||c==f&&e.Po(a)&&e.st(b)?-1:1})};e.prototype.uj=function(a){var b=this.Li[a>>1];return e.Po(a)?b.qa:b.va};return e}();a.bq=f})(z||(z={}));(function(a){var b=function(b){function c(c,e,d,f){b.call(this);void 0===c?this.description=a.Od.Tf():void 0===d?this.description=
c:(this.description=a.Od.Tf(),this.Ny(c,e),this.Ok(d,f))}w(c,b);c.prototype.D=function(){return 322};c.prototype.$b=function(){var a=this.na-this.la,b=this.ja-this.ha;return Math.sqrt(a*a+b*b)};c.prototype.mg=function(a){var b=this.na-this.la,c=this.ja-this.ha;return Math.sqrt(b*b+c*c)<=a};c.prototype.mD=function(){return!1};c.prototype.Pf=function(){var b=new a.b;b.pc(this.oc(),this.Mb());return b};c.prototype.Fp=function(b){b.Ja();b.Qf(this.description);var c=new a.i;this.o(c);b.Cu(c);for(var c=
1,e=this.description.Aa;c<e;c++)for(var d=this.description.Hd(c),f=a.pa.Wa(d);c<f;c++){var g=this.Ah(d,0);b.setInterval(d,0,g)}};c.prototype.o=function(a){a.K(this.na,this.ja,this.la,this.ha);a.normalize()};c.prototype.Cn=function(a){a.Ja();a.Db(this.na,this.ja,this.yd(0,1,0));a.Db(this.la,this.ha,this.yd(1,1,0))};c.prototype.Oe=function(b){if(b instanceof a.Bg){this.qc();var c=new a.b;c.x=this.na;c.y=this.ja;b.Zi(c,c);this.na=c.x;this.ja=c.y;c.x=this.la;c.y=this.ha;b.Zi(c,c);this.la=c.x;this.ha=
c.y}else this.qc(),c=new a.ee,c.x=this.na,c.y=this.ja,c.z=this.yd(0,1,0),c=b.Qn(c),this.na=c.x,this.ja=c.y,this.om(0,1,0,c.z),c.x=this.la,c.y=this.ha,c.z=this.yd(1,1,0),c=b.Qn(c),this.la=c.x,this.ha=c.y,this.om(1,1,0,c.z)};c.prototype.Pa=function(){return new c(this.description)};c.prototype.kv=function(a,b){return(this.la-a-(this.na-a))*(this.ha-b+(this.ja-b))*.5};c.prototype.Ru=function(a){return a*this.$b()};c.prototype.AD=function(a){return a/this.$b()};c.prototype.sC=function(b){return a.vi.ut(this.na,
this.la,b)};c.prototype.vN=function(b){return a.vi.ut(this.ja,this.ha,b)};c.prototype.xm=function(b,c){var e=new a.Ag;this.Bi(b,c,e);return e.get()};c.prototype.Bi=function(b,c,e){if(null==e)throw a.g.N();e.mq();e=e.get();e.Qf(this.description);var d=new a.b;this.Kb(b,d);e.Ny(d.x,d.y);this.Kb(c,d);e.Ok(d.x,d.y);for(var d=1,f=this.description.Aa;d<f;d++)for(var g=this.description.Fd(d),p=a.pa.Wa(g),k=0;k<p;k++){var h=this.ld(b,g,k);e.My(g,k,h);h=this.ld(c,g,k);e.Cy(g,k,h)}};c.prototype.ld=function(b,
c,e){if(0==c)return 0==e?this.Kb(b).x:this.Kb(b).y;switch(a.pa.JN(c)){case 0:return.5>b?this.gt(c,e):this.Ws(c,e);case 1:var d=this.gt(c,e);c=this.Ws(c,e);return a.vi.ut(d,c,b);case 2:throw a.g.ra("not implemented");}throw a.g.wa();};c.prototype.Gd=function(a,b){var c=this.la-this.na,e=this.ha-this.ja,d=c*c+e*e;if(0==d)return.5;c=((a.x-this.na)*c+(a.y-this.ja)*e)/d;b||(0>c?c=0:1<c&&(c=1));return c};c.prototype.nt=function(a,b,c,e){if(a){a=this.ha-this.ja;if(0==a)return b==this.ha?-1:0;b=(b-this.ja)/
a;if(0>b||1<b)return 0;null!=c&&(c[0]=this.sC(b))}else{a=this.la-this.na;if(0==a)return b==this.la?-1:0;b=(b-this.na)/a;if(0>b||1<b)return 0;null!=c&&(c[0]=this.vN(b))}null!=e&&(e[0]=b);return 1};c.prototype.xe=function(a,b){var c=this.ha-this.ja;if(0==c)return a==this.ha?b:NaN;c=(a-this.ja)/c;a=this.sC(c);1==c&&(a=this.la);return a};c.prototype.qs=function(a,b,c){return 0<=this.ho(a.x,a.y,b,c)};c.prototype.Kh=function(a,b,c){return 0<=this.ho(a,b,c,!0)};c.prototype.Eq=function(a,b){return this.qs(a,
b,!1)};c.prototype.KE=function(){if(this.ha<this.ja||this.ha==this.ja&&this.la<this.na){var a=this.na;this.na=this.la;this.la=a;a=this.ja;this.ja=this.ha;this.ha=a;for(var a=0,b=this.description.up-2;a<b;a++){var c=this.fa[a];this.fa[a]=this.fa[a+b];this.fa[a+b]=c}}};c.prototype.rs=function(b,c){b=a.b.Oa(b,c);b.sub(this.Mb());c=new a.b;c.pc(this.oc(),this.Mb());var e=c.Ai(b);b=8.881784197001252E-16*(Math.abs(c.x*b.y)+Math.abs(c.y*b.x));return e>b?-1:e<-b?1:0};c.prototype.ho=function(b,c,e,d){var f=
this.na,g=this.ja,p=b-f,k=c-g,p=Math.sqrt(p*p+k*k);if(p<=Math.max(e,6.661338147750939E-16*p))return d&&0==p?NaN:0;p=b-this.la;k=c-this.ha;p=Math.sqrt(p*p+k*k);if(p<=Math.max(e,6.661338147750939E-16*p))return d&&0==p?NaN:1;p=this.la-this.na;k=this.ha-this.ja;d=Math.sqrt(p*p+k*k);if(0<d){var h=1/d,p=p*h,k=k*h,n=b-f,q=c-g,l=n*p+q*k,A=1.7763568394002505E-15*(Math.abs(n*p)+Math.abs(q*k)),r=p,p=-k,k=r,A=Math.max(e,A);if(l<-A||l>d+A)return NaN;if(Math.abs(n*p+q*k)<=Math.max(e,1.7763568394002505E-15*(Math.abs(n*
p)+Math.abs(q*k)))&&(p=a.I.Kr(l*h,0,1),.5>=p?(k=this.na+(this.la-this.na)*p,d=this.ja+(this.ha-this.ja)*p):(k=this.la-(this.la-this.na)*(1-p),d=this.ha-(this.ha-this.ja)*(1-p)),a.b.Yv(k,d,b,c)<=e)){if(.5>p){if(a.b.Yv(k,d,f,g)<=e)return 0}else if(a.b.Yv(k,d,this.la,this.ha)<=e)return 1;return p}}return NaN};c.prototype.lc=function(a){return null==a?!1:a==this?!0:a.constructor!==this.constructor?!1:this.sJ(a)};c.prototype.AA=function(b,c,e){var d=e?this.na:this.la;e=e?this.ja:this.ha;var f=new a.b;
f.x=b.la-d;f.y=b.ha-e;return c.ml(f)>6.661338147750939E-16*c.uA(f)?(f.x=b.na-d,f.y=b.ja-e,c.ml(f)<=6.661338147750939E-16*c.uA(f)):!0};c.prototype.zA=function(b){var c=new a.b;c.x=this.la-this.na;c.y=this.ha-this.ja;if(!this.AA(b,c,!1))return!1;c.Bp();return this.AA(b,c,!0)?!0:!1};c.ye=function(a,b){var c=a.rs(b.na,b.ja),e=a.rs(b.la,b.ha);if(0>c&&0>e||0<c&&0<e)return!1;c=b.rs(a.na,a.ja);e=b.rs(a.la,a.ha);if(0>c&&0>e||0<c&&0<e)return!1;c=a.$b();e=b.$b();return c>e?a.zA(b):b.zA(a)};c.Id=function(b,c,
e){var d=a.b.Oa(NaN,NaN),f=b.la-b.na,g=b.ha-b.ja,p=c.la-c.na,k=c.ha-c.ja,h=p*g-f*k;if(0==h)return d;var n=8.881784197001252E-16*(Math.abs(p*g)+Math.abs(f*k)),q=c.na-b.na,l=c.ja-b.ja,A=p*l-q*k,r=A/h,t=Math.abs(h),p=(8.881784197001252E-16*(Math.abs(p*l)+Math.abs(q*k))*t+n*Math.abs(A))/(h*h)+2.220446049250313E-16*Math.abs(r);if(r<-p||r>1+p)return d;k=f*l-q*g;p=k/h;f=(8.881784197001252E-16*(Math.abs(f*l)+Math.abs(q*g))*t+n*Math.abs(k))/(h*h)+2.220446049250313E-16*Math.abs(p);if(p<-f||p>1+f)return d;r=
a.I.Kr(r,0,1);f=a.I.Kr(p,0,1);g=b.Kb(r);h=c.Kb(f);n=new a.b;n.pc(g,h);if(n.length()>e&&(n.add(g,h),n.scale(.5),r=b.Gd(n,!1),f=c.Gd(n,!1),b=b.Kb(r),c=c.Kb(f),b.sub(c),b.length()>e))return d;d.ma(r,f);return d};c.xJ=function(a,b,e,d){var f=0;if(a.na==b.na&&a.ja==b.ja||a.na==b.la&&a.ja==b.ha)if(f++,!d)return 1;if(a.la==b.na&&a.ha==b.ja||a.la==b.la&&a.ha==b.ha){f++;if(2==f)return 2;if(!d)return 1}return b.Kh(a.na,a.ja,e)||b.Kh(a.la,a.ha,e)||a.Kh(b.na,b.ja,e)||a.Kh(b.la,b.ha,e)?1:d&&0!=f?0:0==c.ye(a,b)?
0:1};c.ov=function(b,e,d,f,g,k){var p=0,h=b.ho(e.na,e.ja,k,!1),n=b.ho(e.la,e.ha,k,!1),q=e.ho(b.na,b.ja,k,!1),l=e.ho(b.la,b.ha,k,!1);isNaN(h)||(null!=f&&(f[p]=h),null!=g&&(g[p]=0),null!=d&&(d[p]=a.b.Oa(e.na,e.ja)),p++);isNaN(n)||(null!=f&&(f[p]=n),null!=g&&(g[p]=1),null!=d&&(d[p]=a.b.Oa(e.la,e.ha)),p++);2==p||isNaN(q)||0==h&&0==q||0==n&&1==q||(null!=f&&(f[p]=0),null!=g&&(g[p]=q),null!=d&&(d[p]=a.b.Oa(b.na,b.ja)),p++);2==p||isNaN(l)||1==h&&0==l||1==n&&1==l||(null!=f&&(f[p]=1),null!=g&&(g[p]=l),null!=
d&&(d[p]=a.b.Oa(e.la,e.ha)),p++);if(0<p)return 2==p&&null!=f&&f[0]>f[1]&&(b=f[0],f[0]=f[1],f[1]=b,null!=g&&(f=g[0],g[0]=g[1],g[1]=f),null!=d&&(g=a.b.Oa(d[0].x,d[0].y),d[0]=d[1],d[1]=g)),p;p=c.Id(b,e,k);if(isNaN(p.x))return 0;null!=d&&(d[0]=b.Kb(p.x));null!=f&&(f[0]=p.x);null!=g&&(g[0]=p.y);return 1};c.prototype.TC=function(){return 0};c.prototype.eo=function(){};c.prototype.toString=function(){return"Line: ["+this.na.toString()+", "+this.ja.toString()+", "+this.la.toString()+", "+this.ha.toString()+
"]"};return c}(a.fA);a.yb=b})(z||(z={}));(function(a){var b=function(){function a(){this.Gl=[];this.ua=-1}a.prototype.ya=function(){return this.ua};a.prototype.next=function(){if(null!=this.Gl&&0!=this.Gl.length){this.ua++;var a=this.Gl[0];1>=this.Gl.length?this.Gl=[]:this.Gl=this.Gl.slice(1);return a}return this.Gl=null};return a}();a.MT=b})(z||(z={}));(function(a){(function(a){a[a.enumFillRuleOddEven=0]="enumFillRuleOddEven";a[a.enumFillRuleWinding=1]="enumFillRuleWinding"})(a.qI||(a.qI={}));var b=
function(b){function c(c,e){b.call(this);this.Yf=!1;this.np=null;this.ap=this.bp=0;this.Uh=null;this.ng=!1;this.td=this.li=this.Fe=this.qb=this.jb=null;this.gp=this.Qa=this.cp=0;if(void 0===e)this.Yf=c,this.ng=!1,this.ta=this.ap=this.bp=this.cp=0,this.description=a.Od.Tf();else{if(null==e)throw a.g.N();this.Yf=c;this.ng=!1;this.ta=this.ap=this.bp=this.cp=0;this.description=e}this.Uh=null;this.Qa=0}w(c,b);c.prototype.Hm=function(){return 0<this.cp};c.prototype.nv=function(){this.qc();null==this.np?
this.np=new a.Va(this.description):this.np.Qf(this.description)};c.prototype.Uy=function(b,c){var e=new a.b;e.x=b;e.y=c;this.Nr(e)};c.prototype.Nr=function(a){this.nv();this.np.ic(a);this.ng=!0};c.prototype.df=function(b){if(b.s())throw a.g.N();this.Ik(b.description);this.nv();b.copyTo(this.np);this.ng=!0};c.prototype.iv=function(){var b=1;this.ng&&(this.nv(),null==this.jb?(this.jb=a.Ac.Dg(2),this.jb.write(0,0),this.qb=a.Ac.to(2,0)):(this.jb.resize(this.jb.size+1,0),this.qb.resize(this.qb.size+1,
0)),this.Yf&&this.qb.write(this.qb.size-2,1),b++);var c=this.ta;this.jb.write(this.jb.size-1,this.ta+b);this.jo(c+b);this.qb.write(this.jb.size-1,0);this.ng&&(this.Iu(c,this.np),this.ng=!1)};c.prototype.wj=function(a,b){this.iv();this.ic(this.ta-1,a,b)};c.prototype.Lm=function(a){this.iv();this.ic(this.ta-1,a)};c.prototype.lineTo=function(a){this.iv();this.Iu(this.ta-1,a)};c.prototype.ro=function(){var a;this.Su();void 0===a&&(this.ng=!1,a=this.ea()-1);var b=this.qb.read(a);this.qb.write(a,b|1);null!=
this.Fe&&(a=this.Dc(a)-1,this.Fe.write(a,1),this.li.write(a,-1))};c.$i=function(a){return c.Id[a]};c.prototype.vc=function(a){return 0!=(this.qb.read(a)&1)};c.prototype.Oo=function(a){if(this.vc(a))return!0;var b=this.Ea(a);a=this.Dc(a)-1;if(b>a)return!1;b=this.Fa(b);a=this.Fa(a);return b.ub(a)};c.prototype.yq=function(a){return 0!=(this.qb.read(a)&2)};c.prototype.Bc=function(b,c){this.Ik(b.description);if(322==b.D()){var e=new a.Va;if(c||this.s())b.En(e),this.df(e);b.Bn(e);this.lineTo(e)}else throw a.g.wa();
};c.prototype.ws=function(a){var b=0==this.ta;this.Uy(a.v,a.C);this.wj(a.v,a.G);this.wj(a.B,a.G);this.wj(a.B,a.C);this.ro();this.ng=!1;b&&this.yf(256,!1)};c.prototype.Wc=function(b,c){if(!b.s()){for(var e=0==this.ta,d=new a.Va(this.description),f=0;4>f;f++)b.uf(c?4-f-1:f,d),0==f?this.df(d):this.lineTo(d);this.ro();this.ng=!1;e&&!c&&this.yf(256,!1)}};c.prototype.add=function(a,b){for(var c=0;c<a.ea();c++)this.Zj(a,c,!b)};c.prototype.Zj=function(a,b,c){this.Cf(-1,a,b,c)};c.prototype.lo=function(){this.Sw()};
c.prototype.ys=function(b,c,e,d,f){f||0!=this.ea()||(f=!0);0>c&&(c=b.ea()-1);if(c>=b.ea()||0>e||0>d||d>b.ct(c))throw a.g.ra("index out of bounds");if(0!=d){var g=b.vc(c)&&e+d==b.ct(c);if(!g||1!=d){this.ng=!1;this.Ik(b.description);e=b.Ea(c)+e+1;f&&(d++,e--);g&&d--;g=this.ta;this.jo(this.ta+d);this.kc();if(f){if(0==d)return;this.jb.add(this.ta);f=b.qb.read(c);f&=-5;this.Yf&&(f|=1);this.qb.write(this.qb.size-1,f);this.qb.add(0)}else this.jb.write(this.qb.size-1,this.ta);f=0;for(var p=this.description.Aa;f<
p;f++){var k=this.description.Hd(f),h=a.pa.Wa(k),n=b.description.zf(k);0>n||null==b.Ba[n]?this.Ba[f].ul(h*g,a.pa.ue(k),d*h,h*g):this.Ba[f].nk(h*g,b.Ba[n],h*e,d*h,!0,h,h*g)}if(this.Hm())throw a.g.wa();if(b.yq(c))throw a.g.wa();this.ce(1993)}}};c.prototype.Cr=function(b){this.kc();var c=this.ea();0>b&&(b=c-1);if(b>=c)throw a.g.N();for(var e=this.Ea(b),d=this.Ha(b),f=0,g=this.description.Aa;f<g;f++)if(null!=this.Ba[f]){var p=a.pa.Wa(this.description.Fd(f));this.Ba[f].oj(p*e,p*d,p*this.ta)}for(e=b+1;e<=
c;e++)f=this.jb.read(e),this.jb.write(e-1,f-d);if(null==this.qb)for(e=b+1;e<=c;e++)b=this.qb.read(e),this.qb.write(e-1,b);this.jb.resize(c);this.qb.resize(c);this.ta-=d;this.rg-=d;this.ce(1993)};c.prototype.Cf=function(b,c,e,d){if(c==this)throw a.g.N();if(e>=c.ea())throw a.g.N();var f=this.ea();if(b>f)throw a.g.N();0>b&&(b=f);0>e&&(e=c.ea()-1);this.ng=!1;this.Ik(c.description);c.kc();var g=c.Ea(e),p=c.Ha(e),k=this.ta,h=c.vc(e)&&!d?1:0;this.jo(this.ta+p);this.kc();for(var n=b<f?this.Ea(b):k,q=0,l=
this.description.Aa;q<l;q++){var r=this.description.Fd(q),A=c.description.zf(r),t=a.pa.Wa(r);0<=A&&null!=c.Ba[A]?(0!=h&&this.Ba[q].nk(n*t,c.Ba[A],t*g,t,!0,t,t*k),this.Ba[q].nk((n+h)*t,c.Ba[A],t*(g+h),t*(p-h),d,t,t*(k+h))):this.Ba[q].ul(n*t,a.pa.ue(r),t*p,t*k)}this.jb.add(k+p);for(d=f;d>=b+1;d--)g=this.jb.read(d-1),this.jb.write(d,g+p);c.yq(e);this.qb.add(0);for(d=f-1;d>=b+1;d--)f=this.qb.read(d),f&=-5,this.qb.write(d+1,f);f=c.VN().read(e);f&=-5;this.Yf&&(f|=1);this.qb.write(b,f)};c.prototype.Sw=function(){var b=
-1,c=this.ea();if(b>c)throw a.g.N();0>b&&(b=c);this.ng=!1;this.kc();this.jb.add(this.ta);for(var e=c;e>=b+1;e--){var d=this.jb.read(e-1);this.jb.write(e,d+0)}this.qb.add(0);for(e=c-1;e>=b+1;e--)c=this.qb.read(e),c&=-5,this.qb.write(e+1,c);this.Yf&&this.qb.write(b,1)};c.prototype.dD=function(b,c,e){var d=-1;0>b&&(b=this.ea());if(b>this.ea()||d>this.Ha(b)||e>c.length)throw a.g.ra("index out of bounds");if(0!=e){b==this.ea()&&(this.jb.add(this.ta),this.Yf?this.qb.add(1):this.qb.add(0));0>d&&(d=this.Ha(b));
this.kc();var f=this.ta;this.jo(this.ta+e);this.kc();for(var g=0,p=this.description.Aa;g<p;g++){var k=this.description.Fd(g),h=a.pa.Wa(k);this.Ba[g].km(h*(this.Ea(b)+d+e),(f-this.Ea(b)-d)*h,this.Ba[g],h*(this.Ea(b)+d),!0,h);0==g?this.Ba[g].$p(h*(this.Ea(b)+d),e,c,0,!0):this.Ba[g].dh(a.pa.ue(k),(this.Ea(b)+d)*h,e*h)}this.Hm()&&(this.Fe.km(this.Ea(b)+d+e,f-this.Ea(b)-d,this.Fe,this.Ea(b)+d,!0,1),this.li.km(this.Ea(b)+d+e,f-this.Ea(b)-d,this.li,this.Ea(b)+d,!0,1),this.Fe.dh(1,this.Ea(b)+d,e),this.li.dh(-1,
this.Ea(b)+d,e));b+=1;for(c=this.ea();b<=c;b++)this.jb.write(b,this.jb.read(b)+e)}};c.prototype.kf=function(b,c,e){var d=this.ea();0>b&&(b=this.ea());if(b>=d||c>this.Ha(b))throw a.g.ra("index out of bounds");b==this.ea()&&(this.jb.add(this.ta),this.Yf?this.qb.add(1):this.qb.add(0));0>c&&(c=this.Ha(b));var f=this.ta;this.jo(this.ta+1);this.kc();var g=this.Ea(b);this.Ba[0].lg(2*(g+c),e,2*f);e=1;for(var p=this.description.Aa;e<p;e++){var k=this.description.Fd(e),h=a.pa.Wa(k);this.Ba[e].ul(h*(g+c),a.pa.ue(k),
h,h*f)}for(b+=1;b<=d;b++)this.jb.write(b,this.jb.read(b)+1)};c.prototype.eF=function(b,c){var e=this.ea();0>b&&(b=e-1);if(b>=e||c>=this.Ha(b))throw a.g.ra("index out of bounds");this.kc();var d=this.Ea(b);0>c&&(c=this.Ha(b)-1);d+=c;c=0;for(var f=this.description.Aa;c<f;c++)if(null!=this.Ba[c]){var g=a.pa.Wa(this.description.Fd(c));this.Ba[c].oj(g*d,g,g*this.ta)}for(;e>=b+1;e--)d=this.jb.read(e),this.jb.write(e,d-1);this.ta--;this.rg--;this.ce(1993)};c.prototype.Rf=function(){return a.Hh.il(this,null)};
c.prototype.Ja=function(){this.cp=0;this.ng=!1;this.td=this.Fe=this.li=this.qb=this.jb=null;this.EA()};c.prototype.Oe=function(b){b instanceof a.Bg?this.ZA(b,-1):this.$J(b)};c.prototype.ZA=function(b,c){if(!this.s()&&!b.XO()){this.kc();var e=this.Ba[0],d=new a.b,f=new a.b,g,p,k;for(0>c?(g=this.Hm(),p=0,k=this.ta):(g=this.yq(c),p=this.Ea(c),k=this.Dc(c));p<k;p++){d.x=e.read(2*p);d.y=e.read(2*p+1);if(g&&(c=this.li.read(p),0<=c))switch(this.Fe.read(p)&7){case 2:f.x=this.td.read(c);f.y=this.td.read(c+
1);b.Zi(f,f);this.td.write(c,f.x);this.td.write(c+1,f.y);f.x=this.td.read(c+3);f.y=this.td.read(c+4);b.Zi(f,f);this.td.write(c+3,f.x);this.td.write(c+4,f.y);break;case 4:throw a.g.wa();}b.Zi(d,d);e.write(2*p,d.x);e.write(2*p+1,d.y)}this.ce(1993)}};c.prototype.$J=function(b){if(!this.s()){this.Ne(1);this.kc();for(var c=this.Ba[0],e=this.Ba[1],d=new a.ee,f=new a.ee,g=this.Hm(),p=0;p<this.ta;p++){d.x=c.read(2*p);d.y=c.read(2*p+1);d.z=e.read(p);if(g){var k=this.li.read(p);if(0<=k)switch(this.Fe.read(p)&
7){case 2:f.x=this.td.read(k);f.y=this.td.read(k+1);f.z=this.td.read(k+2);f=b.Qn(f);this.td.write(k,f.x);this.td.write(k+1,f.y);this.td.write(k+1,f.z);f.x=this.td.read(k+3);f.y=this.td.read(k+4);f.z=this.td.read(k+5);f=b.Qn(f);this.td.write(k+3,f.x);this.td.write(k+4,f.y);this.td.write(k+5,f.z);break;case 4:throw a.g.wa();}}d=b.Qn(d);c.write(2*p,d.x);c.write(2*p+1,d.y);e.write(p,d.z)}this.ce(1993)}};c.prototype.xv=function(){null==this.jb&&(this.jb=a.Ac.Dg(1,0),this.qb=a.Ac.to(1,0));null!=this.Fe&&
(this.Fe.resize(this.rg,1),this.li.resize(this.rg,-1))};c.prototype.eo=function(b){b.ng=!1;b.cp=this.cp;b.gp=this.gp;null!=this.jb?b.jb=a.ga.lj(this.jb):b.jb=null;null!=this.qb?b.qb=a.Wk.lj(this.qb):b.qb=null;null!=this.li?b.li=a.ga.lj(this.li):b.li=null;null!=this.Fe?b.Fe=a.Wk.lj(this.Fe):b.Fe=null;null!=this.td?b.td=a.qd.lj(this.td):b.td=null;b.bp=this.bp;b.ap=this.ap;this.gj(1024)?b.Uh=null:b.Uh=this.Uh};c.prototype.$b=function(){if(!this.gj(512))return this.bp;for(var b=this.Ca(),c=new a.av(0);b.kb();)for(;b.La();)c.add(b.ia().$b());
this.bp=c.rl();this.yf(512,!1);return c.rl()};c.prototype.lc=function(a){if(a==this)return!0;if(!(a instanceof c&&b.prototype.lc.call(this,a)))return!1;var e=this.ea();return e!=a.ea()||null!=this.jb&&!this.jb.lc(a.jb,0,e+1)||this.gp!=a.gp||null!=this.qb&&!this.qb.lc(a.qb,0,e)?!1:b.prototype.lc.call(this,a)};c.prototype.Ca=function(){return new a.GI(this)};c.prototype.wv=function(a){b.prototype.wv.call(this,a);if(this.Hm())for(a=this.Ca();a.kb();)for(;a.La();)break};c.prototype.tm=function(a,c){b.prototype.tm.call(this,
a,c);if(this.Hm())for(a=this.Ca();a.kb();)for(;a.La();)break};c.prototype.qv=function(){null==this.jb||0==this.jb.size?this.ta=0:this.ta=this.jb.read(this.jb.size-1)};c.prototype.Mh=function(){if(!this.Yf)return 0;this.ts();return this.ap};c.prototype.qt=function(a){if(!this.Yf)return!1;if(!this.gj(8))return 0!=(this.qb.read(a)&4);this.ts();return 0<this.Uh.read(a)};c.prototype.oo=function(a){if(!this.Yf)return 0;this.ts();return this.Uh.read(a)};c.prototype.ts=function(){if(this.gj(1024)){var b=
this.ea();null==this.Uh?this.Uh=new a.qd(b):this.Uh.size!=b&&this.Uh.resize(b);for(var b=new a.av(0),c=new a.av(0),e=new a.b,d=0,f=this.Ca();f.kb();){c.reset();for(this.w(this.Ea(f.Qa),e);f.La();)c.add(f.ia().kv(e.x,e.y));b.add(c.rl());var g=d++;this.Uh.write(g,c.rl())}this.ap=b.rl();this.yf(1024,!1)}};c.prototype.hl=function(){if(this.gj(8)){this.ts();var b=this.ea();if(null==this.qb||this.qb.size<b)this.qb=a.Ac.to(b+1);for(var c=1,e=0;e<b;e++){var d=this.Uh.read(e);0==e&&(c=0<d?1:-1);0<d*c?this.qb.xy(e,
4):this.qb.BB(e,4)}this.yf(8,!1)}};c.prototype.Ew=function(b){var c=this.Qa,e=this.ea();if(0<=c&&c<e){if(b<this.Dc(c)){if(b>=this.Ea(c))return c;c--}else c++;if(0<=c&&c<e&&b>=this.Ea(c)&&b<this.Dc(c))return this.Qa=c}if(5>e){for(c=0;c<e;c++)if(b<this.Dc(c))return this.Qa=c;throw a.g.ra("corrupted geometry");}c=0;for(--e;e>c;){var d=c+(e-c>>1),f=this.Ea(d);if(b<f)e=d-1;else if(c=this.Dc(d),b>=c)c=d+1;else return this.Qa=d}return this.Qa=c};c.prototype.HN=function(b){var c=this.mc(0);this.WN();var e=
this.Dc(b),d=this.Ea(b);b=-1;var f=new a.b,g=new a.b;f.y=-Infinity;f.x=-Infinity;for(d+=0;d<e;d++)c.ec(2*d,g),-1==f.compare(g)&&(b=d,f.J(g));return b};c.prototype.Iw=function(){var a=this.F();if(!this.Yf)for(var a=a-this.ea(),b=0,c=this.ea();b<c;b++)this.vc(b)&&a++;return a};c.prototype.ct=function(a){var b=this.Ha(a);this.vc(a)||b--;return b};c.prototype.Pa=function(){return new c(this.Yf,this.description)};c.prototype.fb=function(){return this.Yf?2:1};c.prototype.D=function(){return this.Yf?1736:
1607};c.prototype.WN=function(){this.Su()};c.prototype.OF=function(a){this.jb=a;this.ce(16777215)};c.prototype.VN=function(){this.Su();return this.qb};c.prototype.NF=function(a){this.qb=a;this.ce(16777215)};c.prototype.ea=function(){return null!=this.jb?this.jb.size-1:0};c.prototype.Dc=function(a){return this.jb.read(a+1)};c.prototype.Ha=function(a){return this.jb.read(a+1)-this.jb.read(a)};c.prototype.Ea=function(a){return this.jb.read(a)};c.prototype.jv=function(b,c){null==this.pb&&(this.pb=new a.Wj);
c=a.dA.jR(c);var e=this.pb.hi;if(null!=e)if(e.Sx<b||c>e.cO())this.pb.uv(null);else return!0;e=a.dA.create(this,b,c);this.pb.uv(e);return!0};c.prototype.hc=function(){var a=b.prototype.hc.call(this);if(!this.sc()){var c=this.ea();null!=this.jb&&this.jb.jj(a,0,c+1);null!=this.qb&&this.qb.jj(a,0,c)}return a};c.prototype.NC=function(a){return null!=this.Fe?this.Fe.read(a):1};c.prototype.cc=function(b,c,e){var d=this.Ew(b);if(b==this.Dc(d)-1&&!this.vc(d))throw a.g.ra("index out of bounds");this.kc();var f=
this.Fe,g=1;null!=f&&(g=f.read(b)&7);switch(g){case 1:c.mq();break;case 2:throw a.g.wa();case 4:throw a.g.wa();default:throw a.g.wa();}c=c.get();e?c.Qf(a.Od.Tf()):c.Qf(this.description);d=b==this.Dc(d)-1&&this.vc(d)?this.Ea(d):b+1;f=new a.b;this.w(b,f);c.ed(f);this.w(d,f);c.vd(f);if(!e)for(e=1,f=this.description.Aa;e<f;e++)for(var g=this.description.Fd(e),p=a.pa.Wa(g),k=0;k<p;k++){var h=this.ld(g,b,k);c.My(g,k,h);h=this.ld(g,d,k);c.Cy(g,k,h)}};c.prototype.Ti=function(b,c){if(b>=this.ea())throw a.g.N();
if(this.s())c.Ja();else{if(this.yq(b))throw a.g.ra("not implemented");var e=this.mc(0),d=new a.b,f=new a.i;f.Ja();var g=this.Ea(b);for(b=this.Dc(b);g<b;g++)e.ec(2*g,d),f.Db(d);c.K(f)}};c.prototype.hR=function(b,c){if(b>=this.ea())throw a.g.N();if(this.s())c.Ja();else{if(this.yq(b))throw a.g.ra("not implemented");var e=this.mc(0),d=new a.b,f=new a.i;f.Ja();var g=this.Ea(b);for(b=this.Dc(b);g<b;g++)e.ec(2*g,d),f.Db(d);c.K(f)}};c.prototype.dj=function(b){null==this.pb&&(this.pb=new a.Wj);if(0==b||16>
this.F())return!1;b=a.Ia.nB(this);this.pb.GA(b);return!0};c.prototype.jJ=function(){null==this.pb&&(this.pb=new a.Wj);if(null!=this.pb.nn)return!0;this.pb.HA(null);var b=a.Ia.CK(this);this.pb.HA(b);return!0};c.prototype.Pp=function(a){this.gp=a};c.prototype.Cm=function(){return this.gp};c.Id=[0,0,6,0,8,0];return c}(a.Wr);a.al=b})(z||(z={}));(function(a){var b=function(b){function c(c){b.call(this);if(void 0!==c){if(null==c)throw a.g.N();this.description=c}else this.description=a.Od.Tf();this.ta=0}
w(c,b);c.prototype.Pa=function(){return new c(this.description)};c.prototype.add=function(a){this.resize(this.ta+1);this.bh(this.ta-1,a)};c.prototype.zs=function(b,c){this.resize(this.ta+1);var e=new a.b;e.ma(b,c);this.ic(this.ta-1,e)};c.prototype.Pd=function(b,c,e){e=0>e?b.F():e;if(0>c||c>b.F()||e<c)throw a.g.N();if(c!=e){this.Ik(b.description);e-=c;var d=this.ta;this.resize(this.ta+e);this.kc();for(var f=0,g=b.description.Aa;f<g;f++){var p=b.description.Fd(f),k=a.pa.Wa(p),h=this.mc(p),p=b.mc(p);
h.nk(d*k,p,c*k,e*k,!0,1,d*k)}}};c.prototype.eF=function(b){if(0>b||b>=this.F())throw a.g.ra("index out of bounds");this.kc();for(var c=0,e=this.description.Aa;c<e;c++)if(null!=this.Ba[c]){var d=a.pa.Wa(this.description.Fd(c));this.Ba[c].oj(d*b,d,d*this.ta)}this.ta--;this.rg--;this.ce(1993)};c.prototype.resize=function(a){this.jo(a)};c.prototype.eo=function(){};c.prototype.Ja=function(){b.prototype.EA.call(this)};c.prototype.Oe=function(b){if(b instanceof a.Bg){if(!this.s()){this.kc();for(var c=this.Ba[0],
e=new a.b,d=0;d<this.ta;d++)e.x=c.read(2*d),e.y=c.read(2*d+1),b.Zi(e,e),c.write(2*d,e.x),c.write(2*d+1,e.y);this.ce(1993)}}else if(!this.s()){this.kc();this.Ne(1);this.kc();for(var c=this.Ba[0],e=this.Ba[1],f=new a.ee,d=0;d<this.ta;d++){f.x=c.read(2*d);f.y=c.read(2*d+1);f.z=e.read(d);var g=b.Qn(f);c.write(2*d,g.x);c.write(2*d+1,g.y);e.write(d,g.z)}this.ce(1993)}};c.prototype.fb=function(){return 0};c.prototype.D=function(){return 550};c.prototype.Mh=function(){return 0};c.prototype.$b=function(){return 0};
c.prototype.lc=function(a){return a==this?!0:a instanceof c?b.prototype.lc.call(this,a):!1};c.prototype.fR=function(b,c){var e=this.ta,e=Math.min(e,c+1E3);if(0>c||c>=this.ta||e<c||1E3!=b.length)throw a.g.N();var d=this.mc(0),f=e-c,g=[];d.Hp(2*c,2*f,g,0,!0);for(d=0;d<f;d++)b[d]=a.b.Oa(g[2*d],g[2*d+1]);return e};c.prototype.qv=function(){};c.prototype.xv=function(){};c.prototype.jv=function(){return!1};c.prototype.dj=function(){return!1};c.prototype.Rf=function(){return null};return c}(a.Wr);a.pe=b})(z||
(z={}));(function(a){(function(a){a[a.NotDetermined=0]="NotDetermined";a[a.Structure=1]="Structure";a[a.DegenerateSegments=2]="DegenerateSegments";a[a.Clustering=3]="Clustering";a[a.Cracking=4]="Cracking";a[a.CrossOver=5]="CrossOver";a[a.RingOrientation=6]="RingOrientation";a[a.RingOrder=7]="RingOrder";a[a.OGCPolylineSelfTangency=8]="OGCPolylineSelfTangency";a[a.OGCPolygonSelfTangency=9]="OGCPolygonSelfTangency";a[a.OGCDisconnectedInterior=10]="OGCDisconnectedInterior"})(a.NH||(a.NH={}));var b=function(){function a(a,
b,c){void 0===a?(this.yh=0,this.Gk=this.Fk=-1):(this.yh=a,this.Fk=b,this.Gk=c)}a.prototype.aq=function(a){this.yh=a.yh;this.Fk=a.Fk;this.Gk=a.Gk};return a}();a.wd=b})(z||(z={}));(function(a){var b=function(){function b(){}b.WT=function(b){if(!1===b)throw a.g.PG();};b.bG=function(a){return isNaN(a)?NaN:0===a?a:0<a?1:-1};b.Lh=function(a,b){void 0===b&&(b=0);for(var c=[],e=0;e<a;e++)c[e]=b;return c};b.Ps=function(a,b){var c,e;void 0===c&&(c=0);for(void 0===e&&(e=a.length-1);c<=e;c++)a[c]=b};b.Kr=function(a,
b,c){return a<b?b:a>c?c:a};b.mU=function(){return 4};b.kg=function(a,b){var c=5381;void 0!==b?c=(b<<5)+b+(a&255):c=(c<<5)+c+(a&255);c=(c<<5)+c+(a>>8&255);c=(c<<5)+c+(a>>16&255);return(c<<5)+c+(a>>24&255)&2147483647};b.Rh=function(){throw Error("Not Implemented");};b.iU=function(){return-Infinity};b.kU=function(){return Infinity};b.bU=function(){return 2147483647};b.QT=function(){return 2.220446049250313E-16};b.ST=function(){return 1.7976931348623157E308};b.$x=function(a){return b.JH(a)+12345&2147483647};
b.FD=function(a){var c=32,e=a%b.gv|0,d=a/b.gv|0;if(0===(c&=63))return a;32>c?(a=e>>>c|d<<32-c,c=d>>c):(a=d>>c-32,c=0<=d?0:-1);return c*b.gv+(a>>>0)};b.JH=function(a){a|=0;return(1103495168*a|0)+(20077*a|0)|0};b.truncate=function(a){return 0>a?-1*Math.floor(Math.abs(a)):Math.floor(a)};b.aH=Math.pow(2,53)-1;b.UT=-b.aH;b.pF=65536;b.zU=16777216;b.gv=b.pF*b.pF;return b}();a.I=b})(z||(z={}));(function(a){(function(a){a[a.Project=0]="Project";a[a.Union=1]="Union";a[a.Difference=2]="Difference";a[a.Proximity2D=
3]="Proximity2D";a[a.Relate=4]="Relate";a[a.Equals=5]="Equals";a[a.Disjoint=6]="Disjoint";a[a.Intersects=7]="Intersects";a[a.Within=8]="Within";a[a.Contains=9]="Contains";a[a.Crosses=10]="Crosses";a[a.Touches=11]="Touches";a[a.Overlaps=12]="Overlaps";a[a.Buffer=13]="Buffer";a[a.Distance=14]="Distance";a[a.Intersection=15]="Intersection";a[a.Clip=16]="Clip";a[a.Cut=17]="Cut";a[a.DensifyByLength=18]="DensifyByLength";a[a.DensifyByAngle=19]="DensifyByAngle";a[a.LabelPoint=20]="LabelPoint";a[a.GeodesicBuffer=
21]="GeodesicBuffer";a[a.GeodeticDensifyByLength=22]="GeodeticDensifyByLength";a[a.ShapePreservingDensify=23]="ShapePreservingDensify";a[a.GeodeticLength=24]="GeodeticLength";a[a.GeodeticArea=25]="GeodeticArea";a[a.Simplify=26]="Simplify";a[a.SimplifyOGC=27]="SimplifyOGC";a[a.Offset=28]="Offset";a[a.Generalize=29]="Generalize";a[a.SymmetricDifference=30]="SymmetricDifference";a[a.ConvexHull=31]="ConvexHull";a[a.Boundary=32]="Boundary";a[a.SimpleRelation=33]="SimpleRelation"})(a.iI||(a.iI={}));var b=
function(){function b(){}b.prototype.D=function(){return null};b.NT=function(b){a.T.Th(b.D())&&(b=b.pb,null!=b&&(b.uv(null),b.GA(null)))};return b}();a.Me=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 13};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.$=function(b,c,e,d,f){return b instanceof a.T?(f=new a.Pc(b),this.$(f,c,[e],!1,d).next()):!0===d?(e=new a.Pz(b,c,e,!1,f),a.wi.local().$(e,c,f)):new a.Pz(b,
c,e,!1,f)};c.V=null;return c}(a.Me);a.Oz=b})(z||(z={}));(function(a){var b=function(){function b(b,c,e,d,f){this.ua=-1;this.ne=b;this.fx=c;this.Oq=e;this.BP=new a.i;this.BP.Ja();this.Vm=-1;this.Yb=f}b.prototype.next=function(){for(var a;null!=(a=this.ne.next());)return this.ua=this.ne.ya(),this.Vm+1<this.Oq.length&&this.Vm++,this.buffer(a,this.Oq[this.Vm]);return null};b.prototype.ya=function(){return this.ua};b.prototype.buffer=function(b,c){return a.UG.buffer(b,c,this.fx,NaN,96,this.Yb)};return b}();
a.Pz=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 16};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.$=function(b,c,e,d){return b instanceof a.T?(b=new a.Pc(b),this.$(b,c,e,d).next()):new a.TH(b,c,e,d)};c.V=null;return c}(a.Me);a.SH=b})(z||(z={}));(function(a){var b=function(){function b(b,c,e){this.ua=-1;if(null==b)throw a.g.N();this.R=c;this.wk=b;this.ka=a.Ia.zd(e,c,!1)}b.prototype.next=function(){var b;
return null!=(b=this.wk.next())?(this.ua=this.wk.ya(),a.Ed.clip(b,this.R,this.ka,0)):null};b.prototype.ya=function(){return this.ua};return b}();a.TH=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 31};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.$=function(b,c,e){return b instanceof a.T?a.Rz.qB(b):new a.Rz(c,b,e)};c.V=null;return c}(a.Me);a.Qz=b})(z||(z={}));(function(a){var b=function(){function b(b,
c,e){this.cE=new a.Tr;this.ua=-1;if(null==c)throw a.g.N();this.zP=b;this.Ec=!1;this.wk=c;this.Yb=e}b.prototype.next=function(){if(this.zP){if(!this.Ec){var a=this.GK(this.wk);this.Ec=!0;return a}return null}if(!this.Ec){a=this.wk.next();if(null!=a)return this.ua=this.wk.ya(),b.qB(a);this.Ec=!0}return null};b.prototype.ya=function(){return this.ua};b.prototype.GK=function(a){for(var b;null!=(b=a.next());)this.cE.Eb(b);return this.cE.sN()};b.qB=function(c){if(b.Gh(c))return c;var e=c.D();if(a.al.Lc(e))return e=
new a.Xa(c.description),e.Bc(c,!0),e;if(550==e&&2==c.F()){var d=new a.Va,e=new a.Xa(c.description);c.Sd(0,d);e.df(d);c.Sd(1,d);e.lineTo(d);return e}return a.Tr.wL(c)};b.Gh=function(b){if(b.s())return!0;var c=b.D();return 33==c||197==c?!0:a.al.Lc(c)?!1:550==c?1==b.F()?!0:!1:1607==c?1==b.ea()&&2>=b.F()?!0:!1:1!=b.ea()?!1:2>=b.F()?!0:a.Tr.sD(b,0)};return b}();a.Rz=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 17};c.local=function(){null===
c.V&&(c.V=new c);return c.V};c.prototype.$=function(b,c,e,d,f){return new a.VH(b,c,e,d,f)};c.V=null;return c}(a.Me);a.UH=b})(z||(z={}));(function(a){var b=function(){function b(b,c,e,d,f){this.Ef=null;if(null==c||null==e)throw a.g.ra("invalid argument");this.xP=b;this.rx=c;this.RD=e;b=a.Ia.$s(c,e);this.ka=a.Ia.zd(d,b,!0);this.QD=-1;this.oe=f}b.prototype.ya=function(){return 0};b.prototype.next=function(){this.gN();return++this.QD<this.Ef.length?this.Ef[this.QD]:null};b.prototype.gN=function(){if(null==
this.Ef)switch(this.Ef=[],this.rx.D()){case 1607:this.iN();break;case 1736:this.hN()}};b.prototype.iN=function(){var b=new a.Xa,c=new a.Xa,e=new a.Xa;this.Ef.push(b);this.Ef.push(c);var d=[];a.$G.YG(this.xP,this.rx,this.RD,this.ka,d,this.oe);for(var f=0;f<d.length;f++){var g=d[f];0==g.cu?b.add(g.U,!1):1==g.cu||2==g.cu?c.add(g.U,!1):3==g.cu?this.Ef.push(g.U):e.add(g.U,!1)}e.s()||b.s()&&c.s()&&!(3<=this.Ef.length)||this.Ef.push(e);b.s()&&c.s()&&3>this.Ef.length&&(this.Ef.length=0)};b.prototype.hN=function(){var b=
new a.ga(0),c=new a.fd,e=c.RB(),d=c.Eb(this.rx),f=c.Eb(this.RD),g=new a.Of;try{g.Np(c,this.ka,this.oe);g.xm(e,d,f,b);var k=c.hf(d),h=new a.Ka,n=new a.Ka;this.Ef.length=0;this.Ef.push(h);this.Ef.push(n);for(d=0;d<b.size;d++){var q,l=new a.fd,r=l.Eb(k),t=l.Eb(c.hf(b.get(d)));g.Mp(l,this.oe);var u=g.mt(r,t);q=l.hf(u);if(!q.s()){var w=c.yC(b.get(d),e);2==w?h.add(q,!1):1==w?n.add(q,!1):this.Ef.push(q);var v=new a.fd,r=v.Eb(k),t=v.Eb(c.hf(b.get(d)));g.Mp(v,this.oe);k=v.hf(g.ll(r,t))}}!k.s()&&0<b.size&&
this.Ef.push(k);h.s()&&n.s()&&(this.Ef.length=0)}finally{g.xg()}};return b}();a.VH=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 18};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.$=function(b,c,e){if(b instanceof a.T)return b=new a.Pc(b),this.$(b,c,e).next();if(0>=c)throw a.g.N();return new a.XH(b,c,e)};c.V=null;return c}(a.Me);a.WH=b})(z||(z={}));(function(a){var b=function(){function b(a,b){this.ua=
-1;this.ne=a;this.$q=b}b.prototype.ya=function(){return this.ua};b.prototype.next=function(){var a;return null!=(a=this.ne.next())?(this.ua=this.ne.ya(),this.hM(a)):null};b.prototype.hM=function(b){if(b.s()||1>b.fb())return b;var c=b.D();if(1736==c||1607==c)return this.Xv(b);if(a.T.Lc(c))return this.jM(b);if(197==c)return this.iM(b);throw a.g.wa();};b.prototype.jM=function(b){if(b.$b()<=this.$q)return b;var c=new a.Xa(b.description);c.Bc(b,!0);return this.Xv(c)};b.prototype.iM=function(b){var c=new a.Ka(b.description);
c.Wc(b,!1);var e=new a.i;b.o(e);b=e.ba();return e.aa()<=this.$q&&b<=this.$q?c:this.Xv(c)};b.prototype.Xv=function(b){for(var c=b.Pa(),e=b.Ca();e.kb();)for(var d=!0;e.La();){var f=e.ia();if(322!=f.D())throw a.g.ra("not implemented");var g=e.lD(),k=f.$b();if(k>this.$q){var h=Math.ceil(k/this.$q),k=new a.Va(b.description);d&&(f.En(k),c.df(k));for(var n=d=1/h,q=0,h=h-1;q<h;q++)f.uu(n,k),c.lineTo(k),n+=d;g?c.ro():(f.Bn(k),c.lineTo(k))}else g?c.ro():c.Bc(f,d);d=!1}return c};return b}();a.XH=b})(z||(z={}));
(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.D=function(){return 2};c.prototype.$=function(b,c,e,d){return b instanceof a.T?(b=new a.Pc(b),c=new a.Pc(c),this.$(b,c,e,d).next()):new a.YH(b,c,e,d)};c.ll=function(b,e,d,f){if(b.s()||e.s())return b;var g=b.fb(),p=e.fb();if(g>p)return b;var k=b.D(),h=e.D(),n=new a.i,q=new a.i,l=new a.i;b.o(n);e.o(q);l.K(n);l.Db(q);var l=a.Ia.zd(d,l,!1),r=l*Math.sqrt(2)*1.00001,
A=new a.i;A.K(n);A.P(r,r);if(!A.jc(q))return b;if(1==g&&2==p)return c.UI(b,e,h,d,f);if(33==k)switch(a.al.Lc(h)?(d=new a.Xa(e.description),d.Bc(e,!0)):d=e,h){case 1736:return c.kP(b,d,l);case 1607:return c.nP(b,d,l);case 550:return c.dN(b,d,l);case 197:return c.FM(b,d,l);case 33:return c.rO(b,d,l);default:throw a.g.N();}else if(550==k)switch(h){case 1736:return c.ZI(b,e,l);case 197:return c.TI(b,e,l);case 33:return c.WI(b,e,l)}return a.Of.ll(b,e,d,f)};c.kP=function(b,c,e){return 0==a.gd.uD(c,b,e)?
b:b.Pa()};c.nP=function(b,c,e){var d=b.w();c=c.Ca();for(var f=e*Math.sqrt(2)*1.00001,g=f*f,p=new a.i;c.kb();)for(;c.La();){var k=c.ia();k.o(p);p.P(f,f);if(p.contains(d)){if(k.Eq(d,e))return b.Pa();var h=k.Mb();if(a.b.Zb(d,h)<=g)return b.Pa();h=k.oc();if(a.b.Zb(d,h)<=g)return b.Pa()}}return b};c.dN=function(b,c,e){var d=c.mc(0);c=c.F();var f=b.w(),g=new a.b;e=e*Math.sqrt(2)*1.00001;e*=e;for(var p=0;p<c;p++)if(d.ec(2*p,g),a.b.Zb(g,f)<=e)return b.Pa();return b};c.FM=function(b,c,e){var d=new a.i;c.o(d);
d.P(e,e);c=b.w();return d.contains(c)?b.Pa():b};c.rO=function(b,c,e){e=e*Math.sqrt(2)*1.00001;e*=e;var d=b.w();c=c.w();return a.b.Zb(d,c)<=e?b.Pa():b};c.ZI=function(b,c,e){var d=new a.i;c.o(d);d.P(e,e);for(var f=b.F(),g=!1,p=[],k=0;k<f;k++)p[k]=!1;for(var h=new a.b,k=0;k<f;k++)b.w(k,h),d.contains(h)&&0!=a.gd.he(c,h,e)&&(g=!0,p[k]=!0);if(!g)return b;c=b.Pa();for(k=0;k<f;k++)p[k]||c.Pd(b,k,k+1);return c};c.TI=function(b,c,e){var d=new a.i;c.o(d);d.P(e,e);c=b.F();var f=!1;e=[];for(var g=0;g<c;g++)e[g]=
!1;for(var p=new a.b,g=0;g<c;g++)b.w(g,p),d.contains(p)&&(f=!0,e[g]=!0);if(!f)return b;d=b.Pa();for(g=0;g<c;g++)e[g]||d.Pd(b,g,g+1);return d};c.WI=function(b,c,e){var d=b.mc(0),f=b.F(),g=c.w(),p=new a.b,k=!1;c=[];for(var h=0;h<f;h++)c[h]=!1;h=e*Math.sqrt(2)*1.00001;e=h*h;for(h=0;h<f;h++)d.ec(2*h,p),a.b.Zb(p,g)<=e&&(k=!0,c[h]=!0);if(!k)return b;d=b.Pa();for(h=0;h<f;h++)c[h]||d.Pd(b,h,h+1);return d};c.UI=function(b,c,e,d,f){var g=new a.Vj;b.Fp(g);var p=new a.i;c.o(p);g.Db(p);g.P(.1*g.aa(),.1*g.ba());
p=new a.Ka;p.Wc(g,!1);1736==e?p.add(c,!0):p.Wc(c,!0);return a.$r.local().$(b,p,d,f)};c.V=null;return c}(a.Me);a.Zr=b})(z||(z={}));(function(a){var b=function(){function b(a,b,c,e){this.Fq=null==b;this.ua=-1;this.ne=a;this.fx=c;this.EP=b.next();this.Yb=e}b.prototype.next=function(){if(this.Fq)return null;var b;return null!=(b=this.ne.next())?(this.ua=this.ne.ya(),a.Zr.ll(b,this.EP,this.fx,this.Yb)):null};b.prototype.ya=function(){return this.ua};return b}();a.YH=b})(z||(z={}));(function(a){var b=function(){function b(b){this.oe=
b;this.Ii=new a.i;this.Ii.Ja();this.Ng=new a.i;this.Ng.Ja()}b.prototype.Pr=function(){var a;a=this.Ii.v;this.Ii.v=this.Ng.v;this.Ng.v=a;a=this.Ii.B;this.Ii.B=this.Ng.B;this.Ng.B=a;a=this.Ii.C;this.Ii.C=this.Ng.C;this.Ng.C=a;a=this.Ii.G;this.Ii.G=this.Ng.G;this.Ng.G=a};b.prototype.wM=function(b,c){var e=!this.Ii.jc(this.Ng);if(a.T.Kc(b.D())&&a.T.Kc(c.D())){if(b.F()>c.F())return this.gB(b,c,e);this.Pr();e=this.gB(c,b,e);this.Pr();return e}if(550==b.D()&&a.T.Kc(c.D()))return e=this.hB(c,b,e),this.Pr(),
e;if(550==c.D()&&a.T.Kc(b.D()))return this.hB(b,c,e);if(550==b.D()&&550==c.D()){if(b.F()>c.F())return this.iB(b,c);this.Pr();e=this.iB(c,b);this.Pr();return e}return 0};b.prototype.gB=function(b,c,e){var d=b.Ca(),f=c.Ca(),g=new a.i,p=new a.i,k=1.7976931348623157E308;if(!e&&this.iT(b,c,d,f))return 0;for(;d.kb();)for(;d.La();)if(b=d.ia(),b.o(g),!(g.Ou(this.Ng)>k)){for(;f.kb();)for(;f.La();)if(c=f.ia(),c.o(p),g.Ou(p)<k&&(c=b.Fb(c,e),c*=c,c<k)){if(0==c)return 0;k=c}f.Lk()}return Math.sqrt(k)};b.prototype.hB=
function(b,c,e){var d=b.Ca(),f=new a.i,g=1.7976931348623157E308,p=new a.b,k,h=c.F();for(e=!e&&1736==b.D();d.kb();)for(;d.La();){var n=d.ia();n.o(f);if(!(1<h&&f.Ou(this.Ng)>g)){for(var q=0;q<h;q++){c.w(q,p);if(e&&0!=a.gd.he(b,p,0))return 0;k=n.Gd(p,!1);p.sub(n.Kb(k));k=p.Up();if(k<g){if(0==k)return 0;g=k}}e=!1}}return Math.sqrt(g)};b.prototype.iB=function(b,c){for(var e=1.7976931348623157E308,d=new a.b,f=new a.b,g,p=b.F(),k=c.F(),h=0;h<p;h++)if(b.w(h,d),!(1<k&&this.Ng.gG(d)>e))for(var n=0;n<k;n++)if(c.w(n,
f),g=a.b.Zb(d,f),g<e){if(0==g)return 0;e=g}return Math.sqrt(e)};b.prototype.iT=function(b,c,e,d){if(1736==b.D()){for(;d.kb();)if(d.La()){var f=d.ia();if(0!=a.gd.he(b,f.oc(),0))return!0}d.Lk()}if(1736==c.D()){for(;e.kb();)if(e.La()&&(b=e.ia(),0!=a.gd.he(c,b.oc(),0)))return!0;e.Lk()}return!1};b.prototype.il=function(a,b){if(a.s()||b.s())return NaN;a.o(this.Ii);b.o(this.Ng);return this.wM(a,b)};return b}(),c=function(c){function e(){c.apply(this,arguments)}w(e,c);e.prototype.$=function(c,e,d){if(null==
c||null==e)throw a.g.N();if(c.s()||e.s())return NaN;var f,g;f=c.D();g=e.D();if(33==f){if(33==g)return a.b.Fb(c.w(),e.w());if(197==g)return d=new a.i,e.o(d),d.Fb(c.w());f=new a.pe;f.add(c);c=f}else if(197==f){if(197==g)return g=new a.i,c.o(g),d=new a.i,e.o(d),d.Fb(g);f=new a.Ka;f.Wc(c,!1);c=f}33==g?(g=new a.pe,g.add(e),e=g):197==g&&(g=new a.Ka,g.Wc(e,!1),e=g);return(new b(d)).il(c,e)};e.local=function(){null===e.V&&(e.V=new e);return e.V};e.prototype.D=function(){return 14};e.V=null;return e}(a.Me);
a.ZH=c})(z||(z={}));(function(a){var b=function(){function b(a,b,c,e){this.aE=a;this.fE=b;this.oe=e;this.HD=c}b.prototype.next=function(){var a=this.aE.next();return null==a?null:this.yz(a)};b.prototype.ya=function(){return this.aE.ya()};b.prototype.yz=function(b){var c=b.D();if(a.T.Km(c))return b;if(197==c)return c=new a.Ka(b.description),c.Wc(b,!1),this.yz(c);if(b.s())return b;if(null==b)throw a.g.wa();for(var c=b.Pa(),e=new a.yb,d=0,f=b.ea();d<f;d++)this.mH(b,d,c,e);return c};b.prototype.mH=function(b,
c,e,d){if(!(2>b.Ha(c))){var f=b.Ea(c),g=b.Dc(c)-1,p=b.mc(0),k=b.vc(c),h=new a.ga(0);h.xb(b.Ha(c)+1);var n=new a.ga(0);n.xb(b.Ha(c)+1);h.add(k?f:g);h.add(f);for(f=new a.b;1<h.size;){var q=h.tc();h.af();var l=h.tc();b.w(q,f);d.ed(f);b.w(l,f);d.vd(f);l=this.jH(d,f,p,q,l,g);0<=l?(h.add(l),h.add(q)):n.add(q)}k||n.add(h.get(0));if(n.size==h.size)e.Zj(b,c,!0);else if(2<=n.size&&(!this.HD||2!=n.size||!(k||a.b.Fb(b.Fa(n.get(0)),b.Fa(n.get(1)))<=this.fE))){c=new a.Va;d=0;for(g=n.size;d<g;d++)b.Sd(n.get(d),
c),0==d?e.df(c):e.lineTo(c);k&&(this.HD||2!=n.size||e.lineTo(c),e.ro())}}};b.prototype.jH=function(a,b,c,e,d,f){var g=d-1;d<=e&&(g=f);f=d=-1;for(e+=1;e<=g;e++){c.ec(2*e,b);var p=b.x,k=b.y;a.Kb(a.Gd(b,!1),b);b.x-=p;b.y-=k;p=b.length();p>this.fE&&p>f&&(d=e,f=p)}return d};return b}();a.$H=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 29};c.prototype.$=function(b,c,e,d){return b instanceof a.T?(b=new a.Pc(b),this.$(b,c,e,d).next()):
new a.$H(b,c,e,d)};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.V=null;return c}(a.Me);a.Sz=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 21};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.$=function(b,c,e,d,f,g,k,h){return b instanceof a.T?(h=new a.Pc(b),this.$(h,c,e,[d],f,g,!1,k).next()):!0===k?(e=new a.Uz(b,c,e,d,f,!1,!1,h),a.wi.local().$(e,c,h)):new a.Uz(b,c,e,d,f,!1,!1,h)};c.V=null;return c}(a.Me);
a.Tz=b})(z||(z={}));(function(a){var b=function(){function b(b,c,e,d,f,g,k,h){if(g)throw a.g.qe();if(null==c)throw a.g.N();this.ua=-1;this.Xq=b;this.cg=c;this.ke=e;this.Oq=d;this.Rm=f;this.Vm=-1;this.Yb=h;this.CP=new a.i;this.CP.Ja()}b.prototype.next=function(){for(var a;null!=(a=this.Xq.next());)return this.ua=this.Xq.ya(),this.Vm+1<this.Oq.length&&this.Vm++,this.oN(a,this.Oq[this.Vm]);return null};b.prototype.ya=function(){return this.ua};b.prototype.oN=function(b,c){return a.pH.buffer(b,this.cg,
this.ke,c,this.Rm,this.Yb)};return b}();a.Uz=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 24};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.$=function(b,c,e){if(null==c)throw a.g.N();if(b.s()||1>b.fb())return 0;if(4==e)throw a.g.qe();var d=a.Ya.Em(c),f=a.Ya.ft(d),g=a.Ya.Ts(d),f=f*(2-f),p=d.Se().Dj,k=b.D(),h;1736==k||197==k?h=b.Rf():a.T.Lc(k)?(h=new a.Xa(b.description),h.Bc(b,!0)):h=b;if(0==d.lc(c)){if(a.Ya.Qo(c)){h=
a.gh.qo(h,c);1607==k&&h==b&&(h=a.T.Yj(b));b=new a.Nd;a.Ya.Fm(c).wu(b);for(var k=0,n=h.F();k<n;k++){var q=h.Fa(k);q.x=a.gh.pu(q.x,b);h.ic(k,q)}}b=h.Pa();h=a.gh.ZQ(c,d,h,b)?b:a.Ya.Wl(h,c,d)}return this.yM(h,e,g,f,p)};c.prototype.yM=function(b,c,e,d,f){var g=new a.ca(0),p=0;for(b=b.Ca();b.kb();)for(;b.La();){var k=b.ia(),h=k.Mb(),k=k.oc();h.scale(f);k.scale(f);a.zb.Rd(e,d,h.x,h.y,k.x,k.y,g,null,null,c);p+=g.l}return p};c.V=null;return c}(a.Me);a.cI=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,
arguments)}w(c,b);c.prototype.D=function(){return 18};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.$=function(b,c,e,d,f){return b instanceof a.T?(b=new a.Pc(b),this.$(b,c,e,d,f).next()):new a.bI(b,e,d,c,-1,-1,f)};c.V=null;return c}(a.Me);a.aI=b})(z||(z={}));(function(a){var b=function(){function b(b,c,e,d,f,g){if(0<g)throw a.g.qe();if(4!=e&&0<f)throw a.g.qe();if(null==c)throw a.g.N();this.ua=-1;this.Xq=b;this.cg=c;this.ke=e;this.IP=d;this.HP=f}b.prototype.next=function(){for(var a;null!=
(a=this.Xq.next());)return this.ua=this.Xq.ya(),this.hw(a);return null};b.prototype.ya=function(){return this.ua};b.prototype.hw=function(b){return a.ui.oq(b,this.cg,this.ke,this.IP,this.HP,this.Yb)};return b}();a.bI=b})(z||(z={}));(function(a){(function(a){a[a.Unknown=0]="Unknown";a[a.Contains=1]="Contains";a[a.Within=2]="Within";a[a.Equals=3]="Equals";a[a.Disjoint=4]="Disjoint";a[a.Touches=8]="Touches";a[a.Crosses=16]="Crosses";a[a.Overlaps=32]="Overlaps";a[a.NoThisRelation=64]="NoThisRelation";
a[a.Intersects=1073741824]="Intersects";a[a.IntersectsOrDisjoint=1073741828]="IntersectsOrDisjoint"})(a.xH||(a.xH={}));var b=function(){function b(){}b.lU=function(c,e,d,f){if(e.s()||c.s())return 4;var g=c.D(),p=e.D(),k;a.T.Lc(g)&&(c=k=new a.Xa(c.description),k.Bc(c,!0));a.T.Lc(p)&&(e=k=new a.Xa(e.description),k.Bc(e,!0));switch(g){case 33:switch(p){case 33:return b.sO(c,e,d);case 197:return b.Id(b.BG(e,c,d));case 550:return b.Id(b.HG(e,c,d));case 1607:return b.Id(b.Az(e,c,d,f));case 1736:return b.Id(b.pz(e,
c,d))}throw a.g.wa();case 197:switch(p){case 33:return b.BG(c,e,d);case 197:return b.fK(c,e,d);case 550:return b.Id(b.DG(e,c,d,f));case 1607:return b.Id(b.vz(e,c));case 1736:return b.Id(b.lz(e,c))}throw a.g.wa();case 550:switch(p){case 33:return b.HG(c,e,d);case 197:return b.DG(c,e,d,f);case 550:return b.FG(c,e,d,f);case 1607:return b.Id(b.xz(e,c));case 1736:return b.Id(b.nz(e,c))}throw a.g.wa();case 1607:switch(p){case 33:return b.Az(c,e,d,f);case 197:return b.vz(c,e);case 550:return b.xz(c,e);case 1607:return b.iQ(c,
e);case 1736:return b.Id(b.rz(e,c))}throw a.g.wa();case 1736:switch(p){case 33:return b.pz(c,e,d);case 197:return b.lz(c,e);case 550:return b.nz(c,e);case 1607:return b.rz(c,e);case 1736:return b.oP(c,e)}throw a.g.wa();default:throw a.g.wa();}};b.sO=function(a,c,e){a=a.w();c=c.w();return b.jz(a,c,e)};b.jz=function(a,b,c){a.sub(b);return a.Up()<=c*c?3:4};b.BG=function(c,e,d){var f=new a.i;c.o(f);c=e.w();return b.ZL(f,c,d)};b.ZL=function(a,b,c){a.P(-c,-c);if(a.contains(b))return 1;a.P(c,c);return a.contains(b)?
8:4};b.uM=function(a,b,c){return b.contains(c)?1:a.contains(c)?8:4};b.fK=function(c,e,d){var f=new a.i;c.o(f);c=new a.i;e.o(c);return b.MK(f,c,d)};b.MK=function(a,b,c){var e=0;a.contains(b)&&(e|=1);b.contains(a)&&(e|=2);if(0!=e)return e;a.P(-c,-c);b.P(-c,-c);if(a.jc(b))return e=a,e.P(c,c),e=e.contains(b)?1:0,b.P(c,c),e|=b.contains(a)?2:0,0!=e?e:32;e=a;e.P(c,c);b.P(c,c);return e.jc(b)?8:4};b.HG=function(a,c,e){c=c.w();return b.JG(a,c,e)};b.JG=function(a,c,e){for(var d=0,f=a.F();d<f;d++){var g;g=a.Fa(d);
g=b.jz(g,c,e);if(4!=g)return 0!=(g&2)&&1!=f?1:g}return 4};b.DG=function(c,e,d,f){var g=new a.i;e.o(g);return b.eN(c,g,d,f)};b.eN=function(a,c,e,d){c.P(-e,-e);c.P(e,e);for(var f=e=0,g=a.F();f<g;f++){var p;p=a.Fa(f);p=b.Id(b.uM(c,c,p));if(4!=p&&(e|=p,4==d))return 1073741824}return 0==e?4:2==e?e:32};b.FG=function(a,c,e,d){for(var f=0,g=0,p=c.F();g<p;g++){var k;k=c.Fa(g);k=b.JG(a,k,e);if(4!=k&&(f++,4==d))return 1073741824}return 0<f?f==c.F()?3==d?(k=b.FG(c,a,e,1),1==k?3:0):1:32:0};b.Az=function(a,c,e,
d){c=c.w();return b.XP(a,c,e,d)};b.GM=function(a,b){var c=null;a=a.pb;null!=a&&(c=a.hi);if(null!=c){c=c.Kk(b.x,b.y);if(0==c)return 4;if(1==c)return 1}else return-1;return 0};b.XP=function(c,e,d,f){if(0==(f&1073741839))return 64;var g=b.GM(c,e);if(0<g)return g;d*=d;for(g=c.Ca();g.kb();){var p=g.Qa;if(!c.vc(p)){var k=c.Ha(p),p=c.Ea(p);if(0==k)continue;if(a.b.Zb(c.Fa(p),e)<=d||1<k&&a.b.Zb(c.Fa(p+k-1),e)<=d)return 8}if(8!=f)for(;g.La();)if(k=g.ia(),k=k.Kb(k.Gd(e,!1)),a.b.Zb(k,e)<=d)return 0!=(f&1073741828)?
1073741824:1}return 0!=(f&1073741828)?4:64};b.vz=function(c,e){var d=new a.i;e.o(d);return b.rP(c,d)};b.rP=function(a,c){a=b.ao(a,c);return 0<a?a:0};b.ao=function(a,b){a=a.pb;if(null!=a)a=a.hi;else return-1;if(null!=a){a=a.Dn(b);if(0==a)return 4;if(1==a)return 1}else return-1;return 0};b.xz=function(c,e){var d=new a.i;e.o(d);d=b.ao(c,d);return 0<d?d:0};b.fs=function(c,e){var d=new a.i;e.o(d);d=b.ao(c,d);return 0<d?d:-1==d&&(d=new a.i,c.o(d),d=b.ao(e,d),0<d)?b.Id(d):0};b.iQ=function(a,c){a=b.fs(a,
c);return 0<a?a:0};b.pz=function(a,c,e){c=c.w();return b.lP(a,c,e)};b.lP=function(b,c,e){b=a.gd.he(b,c,e);if(0==b)return 4;if(1==b)return 1;if(2==b)return 8;throw a.g.wa();};b.lz=function(c,e){var d=new a.i;e.o(d);return b.uO(c,d)};b.uO=function(a,c){a=b.ao(a,c);return 0<a?a:0};b.nz=function(a,c){a=b.fs(a,c);return 0<a?a:0};b.rz=function(a,c){a=b.fs(a,c);return 0<a?a:0};b.oP=function(a,c){a=b.fs(a,c);return 0<a?a:0};b.iR=function(b,c){var e=b.D(),d=c.D(),f;if(a.T.Th(e)&&(f=b.pb,null!=f&&(f=f.hi,null!=
f))){if(33==d){var g=c.w();f=f.Kk(g.x,g.y)}else g=new a.i,c.o(g),f=f.Dn(g);if(1==f)return 1;if(0==f)return 4}if(a.T.Th(d)&&(f=c.pb,null!=f&&(f=f.hi,null!=f))){33==e?(e=b.w(),f=f.Kk(e.x,e.y)):(e=new a.i,b.o(e),f=f.Dn(e));if(1==f)return 2;if(0==f)return 4}return 0};b.Id=function(a){0!=(a&1)&&(a=a&-2|2);0!=(a&2)&&(a=a&-3|1);return a};return b}();a.dI=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.D=
function(){return 15};c.prototype.$=function(b,c,e,d,f){return b instanceof a.T?(b=new a.Pc(b),c=new a.Pc(c),this.$(b,c,e,d,f).next()):void 0===f?new a.Vz(b,c,e,d,-1):new a.Vz(b,c,e,d,f)};c.V=null;return c}(a.Me);a.$r=b})(z||(z={}));(function(a){var b=function(){function b(b,c,e,d,f){this.Fq=null==c;this.ua=-1;this.ne=b;this.cg=e;this.Ce=c.next();this.Ji=this.Ce.D();this.Yb=d;this.Xh=f;if(-1!=this.Xh&&(0>=this.Xh||7<this.Xh))throw a.g.N("bad dimension mask");}b.prototype.next=function(){if(this.Fq)return null;
var a;if(null!=this.du){a=this.du.next();if(null!=a)return a;this.du=null}for(;null!=(a=this.ne.next());){this.ua=this.ne.ya();if(-1==this.Xh)return a=this.Ga(a);this.du=this.PO(a);return a=this.du.next()}return null};b.prototype.ya=function(){return this.ua};b.prototype.Ga=function(b){var c=this.uG(b);if(null!=c)return c;var c=a.Ia.$s(this.Ce,b),e=a.Ia.zd(this.cg,c,!0),c=new a.i;this.Ce.o(c);var d=new a.i;b.o(d);c.P(2*e,2*e);c.Ga(d);c.P(100*e,100*e);e=a.Ed.clip(this.Ce,c,0,0);b=a.Ed.clip(b,c,0,0);
return a.Of.mt(b,e,this.cg,this.Yb)};b.prototype.SE=function(b,c,e){var d=0;if(0!=(c&1))null==e[0]&&(e[0]=new a.pe(b)),d++;else for(var f=0;f<e.length-1;f++)e[f]=e[f+1];if(0!=(c&2))null==e[d]&&(e[d]=new a.Xa(b)),d++;else for(f=d;f<e.length-1;f++)e[f]=e[f+1];if(0!=(c&4))null==e[d]&&(e[d]=new a.Ka(b)),d++;else for(f=d;f<e.length-1;f++)e[f]=e[f+1];if(3!=d){b=[];for(f=0;f<d;f++)b[f]=e[f];return new a.Pc(b)}return new a.Pc(e)};b.prototype.PO=function(b){var c=this.uG(b);if(null!=c){var e=[null,null,null];
e[c.fb()]=c;return this.SE(b.description,this.Xh,e)}c=a.Ia.$s(this.Ce,b);e=a.Ia.zd(this.cg,c,!0);c=new a.i;this.Ce.o(c);c.P(2*e,2*e);var d=new a.i;b.o(d);c.Ga(d);c.P(100*e,100*e);e=a.Ed.clip(this.Ce,c,0,0);c=a.Ed.clip(b,c,0,0);e=a.Of.Uw(c,e,this.cg,this.Yb);return this.SE(b.description,this.Xh,e)};b.prototype.uG=function(c){var e=a.Ia.$s(c,this.Ce),d=a.Ia.zd(this.cg,e,!1),e=c.D(),f=c.s(),g=this.Ce.s(),g=f||g;if(!g){g=new a.i;c.o(g);var k=new a.i;this.Ce.o(k);k.P(2*d,2*d);g=!g.jc(k)}if(!g)if(k=a.dI.iR(this.Ce,
c),4==k)g=!0;else{if(0!=(k&2))return this.Ce;if(0!=(k&1))return c}if(g)return d=a.T.ve(e),g=a.T.ve(this.Ji),d<g?b.V(c,f):d>g?this.kF():0==d?550==e&&33==this.Ji?this.kF():b.V(c,f):b.V(c,f);if((-1==this.Xh||4==this.Xh)&&197==e&&197==this.Ji)return d=this.Ce,e=new a.i,c.o(e),f=new a.i,d.o(f),e.Ga(f),d=new a.Vj,c.copyTo(d),d.Cu(e),d;if(197==e&&0==a.T.ve(this.Ji)||197==this.Ji&&0==a.T.ve(e))return f=197==e?c:this.Ce,c=197==e?this.Ce:c,e=new a.i,f.o(e),a.Ed.clip(c,e,d,0);if(0==a.T.ve(e)&&0<a.T.ve(this.Ji)||
0<a.T.ve(e)&&0==a.T.ve(this.Ji)){d=a.Ia.Cg(this.cg,c,!1);if(550==e||33==e)return a.Of.jD(c,this.Ce,d);if(550==this.Ji||33==this.Ji)return a.Of.jD(this.Ce,c,d);throw a.g.wa();}return-1!=this.Xh&&2!=this.Xh||1607!=e||1736!=this.Ji?-1!=this.Xh&&2!=this.Xh||1736!=e||1607!=this.Ji?null:this.rG(this.Ce,c):this.rG(c,this.Ce)};b.prototype.rG=function(b,c){var e=b,d=c,f=a.Ia.Cg(this.cg,c,!1),g=new a.i;d.o(g);var p=new a.i;e.o(p);p.P(2*f,2*f);g.Ga(p);g.P(10*f,10*f);var e=b=a.Ed.clip(b,g,0,0),p=new a.ga(0),
k=-1,h=d.pb;if(null!=h){var n=h.hi;if(null!=n){k=0;p.xb(e.F()+e.ea());for(var q=new a.i,l=e.Ca();l.kb();)for(;l.La();){l.ia().o(q);var r=n.Dn(q);1==r?p.add(1):0==r?p.add(0):(p.add(-1),k++)}}}5<c.F()&&(d=c=a.Ed.clip(c,g,0,0),h=d.pb);0>k&&(k=e.Iw());g=e.F()+d.F();if(k*d.F()>Math.log(g)*g*4)return null;g=null;k=d.Ca();null!=h&&null!=h.Ab&&(g=h.Ab);null==g&&20<d.F()&&(g=a.Ia.nB(d));d=b.Pa();h=null;n=e.Ca();q=[0,0,0,0,0,0,0,0,0];l=new a.qd(0);r=new a.Ag;b=-1;for(var t=0,u=0,w=0<p.size,v=-1;n.kb();){var v=
n.Qa,x=0;b=-1;for(t=0;n.La();){var m=w?a.I.truncate(p.get(u)):-1;u++;var y=n.ia();if(0>m){if(null!=g)for(null==h?h=g.KN(y,f):h.Fn(y,f),m=h.next();-1!=m;m=h.next()){k.Sb(g.da(m));for(var m=k.ia(),E=y.Ga(m,null,q,null,f),m=0;m<E;m++)l.add(q[m])}else for(k.Lk();k.kb();)for(;k.La();)for(m=k.ia(),E=y.Ga(m,null,q,null,f),m=0;m<E;m++)l.add(q[m]);if(0<l.size){l.xd(0,l.size,function(a,b){return a-b});var z=0;l.add(1);for(var E=-1,m=0,H=l.size;m<H;m++){var C=l.get(m);if(C!=z){var B=!1;0!=z||1!=C?(y.Bi(z,C,
r),z=r.get()):(z=y,B=!0);if(2<=x){d.ys(e,v,b,t,3==x);if(1!=this.UA(c,z.Mb(),f)&&1!=this.VA(c,z,f))return null;d.Bc(z,!1);x=1;t=0}else switch(E=this.VA(c,z,f),E){case 1:B?2>x?(b=n.Jb()-e.Ea(v),t=1,x=0==x?3:2):t++:(d.Bc(z,0==x),x=1);break;case 0:x=0;b=-1;t=0;break;default:return null}z=C}}}else{m=this.UA(c,y.Mb(),f);if(0>m)return null;1==m?(2>x&&(b=n.Jb()-e.Ea(v),x=0==x?3:2),t++):(b=-1,t=0)}l.clear(!1)}else 0!=m&&1==m&&(0==x?(x=3,b=n.Jb()-e.Ea(v)):1==x?(x=2,b=n.Jb()-e.Ea(v)):t++)}2<=x&&(d.ys(e,v,b,
t,3==x),b=-1)}return d};b.prototype.UA=function(b,c,e){return a.ff.xl(b,c,e)};b.prototype.VA=function(b,c,e){var d=c.Mb();c=c.oc();var f=a.ff.xl(b,d,e),g=a.ff.xl(b,c,e);if(1==f&&0==g||0==f&&1==g)return-1;if(0==f||0==g)return 0;if(1==f||1==g)return 1;f=new a.b;f.add(d,c);f.scale(.5);b=a.ff.xl(b,f,e);return 0==b?0:1==b?1:-1};b.V=function(a,b){return b?a:a.Pa()};b.prototype.kF=function(){null==this.$D&&(this.$D=this.Ce.Pa());return this.$D};return b}();a.Vz=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,
arguments)}w(c,b);c.prototype.D=function(){return 28};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.$=function(b,c,e,d,f,g,k){return b instanceof a.T?(b=new a.Pc(b),this.$(b,c,e,d,f,g,k).next()):new a.eI(b,c,e,d,f,g,k)};c.V=null;return c}(a.Me);a.Wz=b})(z||(z={}));(function(a){var b=function(){function b(a,b,c,e,d,f,g){this.ua=-1;this.ne=a;this.Pi=b;this.Da=c;this.bi=e;this.Dx=d;this.XD=f;this.oe=g}b.prototype.next=function(){var a=this.ne.next();return null!=a?(this.ua=this.ne.ya(),
this.RH(a)):null};b.prototype.ya=function(){return this.ua};b.prototype.RH=function(b){var c;c=0>=this.XD?a.Ia.Cg(this.Pi,b,!1):this.XD;return a.XG.$(b,this.Da,this.bi,this.Dx,c,this.oe)};return b}();a.eI=b})(z||(z={}));(function(a){var b=function(){function b(){}b.prototype.reset=function(){this.Pg=this.Fj=-1;this.Hq=this.Uo=!1};b.prototype.QM=function(a,b,c){for(a.Sb(b,c);a.La();){var e=a.ia(),e=e.$b();if(0!=e)return a.Jb()}for(a.Sb(b,c);a.Ow();)if(e=a.oi(),e=e.$b(),0!=e)return a.Jb();return-1};
b.prototype.RM=function(a,b){for(a.Sb(b,-1);a.Ow();)if(0!=a.oi().$b())return a.Jb();return-1};b.prototype.PM=function(a,b){a.Sb(b,-1);for(a.ia();a.La();)if(0!=a.ia().$b())return a.Jb();return-1};b.prototype.OM=function(b,c,e,d){this.Fj=this.QM(c,e,d);if(-1!=this.Fj){c.Sb(this.Fj,-1);var f=c.ia(),g=f.Kb(f.Gd(b,!1));e=a.b.Zb(g,b);d=new a.b;d.J(g);d.sub(f.Mb());g=new a.b;g.J(b);g.sub(f.Mb());this.Uo=0>d.Ai(g);this.Pg=this.PM(c,this.Fj);if(-1!=this.Pg){c.Sb(this.Pg,-1);var f=c.ia(),p=f.Gd(b,!1),p=f.Kb(p),
k=a.b.Zb(p,b);k>e?this.Pg=-1:(d.J(p),d.sub(f.Mb()),g.J(b),g.sub(f.Mb()),this.Hq=0>d.Ai(g))}-1==this.Pg&&(this.Pg=this.RM(c,this.Fj),-1!=this.Pg&&(c.Sb(this.Pg,-1),f=c.ia(),p=f.Gd(b,!1),p=f.Kb(p),k=a.b.Zb(p,b),k>e?this.Pg=-1:(d.J(p),d.sub(f.Mb()),g.J(b),g.sub(f.Mb()),this.Hq=0>d.Ai(g),b=this.Fj,this.Fj=this.Pg,this.Pg=b,b=this.Uo,this.Uo=this.Hq,this.Hq=b)))}};b.prototype.FK=function(a,b,c,e,d){c=c.Ca();this.OM(a,c,e,d);if(-1!=this.Fj&&-1==this.Pg)return this.Uo;if(-1!=this.Fj&&-1!=this.Pg){if(this.Uo==
this.Hq)return this.Uo;c.Sb(this.Fj,-1);a=c.ia().Pf(1);c.Sb(this.Pg,-1);b=c.ia().Pf(0);return 0<=a.Ai(b)?!0:!1}return b};return b}(),c=function(c){function e(){c.apply(this,arguments)}w(e,c);e.local=function(){null===e.V&&(e.V=new e);return e.V};e.prototype.D=function(){return 3};e.prototype.zw=function(b,c,e,d){void 0===d&&(d=!1);if(b.s())return new a.dl;c=c.w();var f=b,g=b.D();197==g&&(f=new a.Ka,f.Wc(b,!1),g=1736);switch(g){case 33:return this.OE(f,c);case 550:return this.BE(f,c);case 1607:case 1736:return this.dQ(f,
c,e,d);default:throw a.g.ra("not implemented");}};e.prototype.Aw=function(b,c){if(b.s())return new a.dl;c=c.w();var e=b,d=b.D();197==d&&(e=new a.Ka,e.Wc(b,!1),d=1736);switch(d){case 33:return this.OE(e,c);case 550:case 1607:case 1736:return this.BE(e,c);default:throw a.g.ra("not implemented");}};e.prototype.Bw=function(b,c,e,d){if(0>d)throw a.g.N();if(b.s())return[];c=c.w();var f=b,g=b.D();197==g&&(f=new a.Ka,f.Wc(b,!1),g=1736);switch(g){case 33:return this.IQ(f,c,e,d);case 550:case 1607:case 1736:return this.gQ(f,
c,e,d);default:throw a.g.ra("not implemented");}};e.prototype.dQ=function(c,e,d,f){if(1736==c.D()&&d&&(d=new a.i,c.o(d),d=a.Ia.zd(null,d,!1),0!=(f?a.gd.he(c,e,0):a.gd.he(c,e,d)))){var g=new a.dl(e,0,0);f&&g.UF(!0);return g}for(var p=c.Ca(),g=new a.b,k=d=-1,h=1.7976931348623157E308,n=0;p.kb();)for(;p.La();){var q=p.ia(),q=q.Kb(q.Gd(e,!1)),l=a.b.Zb(q,e);l<h?(n=1,g=q,d=p.Jb(),k=p.Qa,h=l):l==h&&n++}g=new a.dl(g,d,Math.sqrt(h));f&&(p.Sb(d,k),q=p.ia(),f=0>a.b.yn(e,q.Mb(),q.oc()),1<n&&(n=new b,n.reset(),
f=n.FK(e,f,c,d,k)),g.UF(f));return g};e.prototype.OE=function(b,c){b=b.w();c=a.b.Fb(b,c);return new a.dl(b,0,c)};e.prototype.BE=function(b,c){var e=b.mc(0);b=b.F();for(var d=0,f=0,g=0,p=1.7976931348623157E308,k=0;k<b;k++){var h=new a.b;e.ec(2*k,h);var n=a.b.Zb(h,c);n<p&&(f=h.x,g=h.y,d=k,p=n)}e=new a.dl;e.tv(f,g,d,Math.sqrt(p));return e};e.prototype.IQ=function(b,c,e,d){if(0==d)return e=[];e*=e;b=b.w();c=a.b.Zb(b,c);c<=e?(e=[],d=new a.dl,d.tv(b.x,b.y,0,Math.sqrt(c)),e[0]=d):e=[];return e};e.prototype.gQ=
function(b,c,e,d){if(0==d)return d=[];var f=b.mc(0),g=b.F();b=[];var p=0;e*=e;for(var k=0;k<g;k++){var h=f.read(2*k),n=f.read(2*k+1),q=c.x-h,l=c.y-n,q=q*q+l*l;q<=e&&(l=new a.dl,l.tv(h,n,k,Math.sqrt(q)),p++,b.push(l))}c=b.length;b.sort(function(a,b){return a.Da<b.Da?-1:a.Da==b.Da?0:1});if(d>=c)return b.slice(0);b.length=d;return b.slice(0)};e.V=null;return e}(a.Me);a.bv=c})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 4};c.prototype.$=
function(b,c,e,d,f){return a.el.py(b,c,e,d,f)};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.V=null;return c}(a.Me);a.fI=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 33};c.prototype.$=function(b,c,e,d,f){return 1073741824===b?!a.hd.qy(c,e,d,4,f):a.hd.qy(c,e,d,b,f)};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.V=null;return c}(a.Me);a.bl=b})(z||(z={}));(function(a){var b=function(){function b(b,c,e,
d){this.oe=d;this.yP=e;this.ua=-1;if(null==b)throw a.g.N();this.wk=b;this.Pi=c}b.prototype.next=function(){var a;return null!=(a=this.wk.next())?(this.ua=this.wk.ya(),this.Qy(a)):null};b.prototype.ya=function(){return this.ua};b.prototype.Qy=function(b){if(null==b)throw a.g.N();return a.cv.cG(b,this.Pi,this.yP,this.oe)};return b}();a.gI=b})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 26};c.prototype.$=function(b,c,e,d){return b instanceof
a.T?(b=new a.Pc(b),this.$(b,c,e,d).next()):new a.gI(b,c,e,d)};c.prototype.Ro=function(b,c,e,d,f){return 0<(void 0!==d?a.cv.Ro(b,c,e,d,f):a.cv.Ro(b,c,!1,null,e))};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.V=null;return c}(a.Me);a.as=b})(z||(z={}));(function(a){var b=function(){function a(){this.hp=0}a.prototype.hS=function(a){this.hp&=-2;this.hp|=a?1:0};a.prototype.sl=function(){return 0!=(this.hp&1)};a.prototype.LC=function(){return this.sl()?0:1};return a}();a.AT=b;var c=function(){return function(){}}(),
e=function(){return function(a,b,c,e){this.x=a;this.y=b;this.Sh=c;this.yl=e}}(),d=function(){function a(a){this.me=a}a.prototype.compare=function(a,b,c){a=a.da(c);b=this.me.$e.read(2*b);a=this.me.$e.read(2*a);b-=a;return 0>b?-1:0<b?1:0};return a}(),f=function(){function a(a){this.me=a}a.prototype.compare=function(a,b,c){b=this.me.$a[b];a=this.me.$a[a.da(c)];var e=b.sl(),d=a.sl();c=b.Zd.xe(this.me.wn,0);var f=a.Zd.xe(this.me.wn,0);c==f&&(c=Math.min(e?b.Zd.ja:b.Zd.ha,d?a.Zd.ja:a.Zd.ha),e=.5*(c-this.me.wn)+
this.me.wn,e==this.me.wn&&(e=c),c=b.Zd.xe(e,0),f=a.Zd.xe(e,0));return c<f?-1:c>f?1:0};return a}(),g=function(){function b(b,c){this.VE=new a.b;this.parent=b;this.mO=c}b.prototype.Zp=function(a,b,c){var e=this.parent,d=this.mO;c.xd(a,b,function(a,b){return e.kj(a,b,d)})};b.prototype.Mo=function(a){a=this.parent.xh.get(a);this.parent.$e.ec(2*(a>>1),this.VE);return this.VE.y+(0!=(a&1)?this.parent.Ri:-this.parent.Ri)};return b}(),k=function(){function p(b,c,e,d,f){this.SD=b.description;this.U=b;this.sg=
c;this.Ri=a.Ia.Cg(this.sg,b,!1);this.pn=a.Ia.Cg(this.sg,b,!0);this.yx=e;this.wP=this.SD.Aa;this.$a=[];this.dn=[];this.Lg=new a.$n;this.Za=new a.bj;this.Kd=new a.wd;this.GD=this.pk=f}p.prototype.Yw=function(){this.GD=!0;return(!a.T.Kc(this.U.D())||this.yB()&&this.xB(!1))&&this.OK()?a.T.Kc(this.U.D())?this.RK()?1607==this.U.D()?this.TK()?2:0:this.UK()?this.VK():0:0:2:0};p.prototype.Yy=function(b,c){var e=this.$e.read(2*b);b=this.$e.read(2*b+1);var d=this.$e.read(2*c);c=this.$e.read(2*c+1);var f=!a.Sr.Vw(e,
b,d,c,this.Ri*this.Ri);return f?f:0==this.U.fb()?!1:e==d&&b==c};p.prototype.yB=function(){for(var b=this.U,c=b.Yf?3:2,e=0,d=b.ea();e<d;e++)if(b.Ha(e)<c)return this.Kd=new a.wd(1,e,0),!1;return!0};p.prototype.xB=function(b){for(var c=this.U,e=c.Ca(),d=c.hasAttribute(1),c=d?a.Ia.rB(this.sg,c,!1):0;e.kb();)for(;e.La();){var f=e.ia();if(!(f.$b()>this.Ri)){if(b&&d){var g=f.gt(1,0),f=f.gt(1,0);if(Math.abs(f-g)>c)continue}this.Kd=new a.wd(2,e.Jb(),-1);return!1}}return!0};p.prototype.OK=function(){var b=
this.U,c=null;a.T.Kc(this.U.D())&&(c=this.U);var e=(this.GD||this.pk)&&null!=c,f=b.F();this.$e=b.mc(0);this.xh=new a.ga(0);this.xh.xb(2*f);this.wh=new a.ga(0);this.wh.xb(2*f);e&&(null==this.Bk&&(this.Bk=new a.ga(0)),this.Bk.xb(f));for(var p=b=0;p<f;p++)if(this.xh.add(2*p),this.xh.add(2*p+1),this.wh.add(2*p),this.wh.add(2*p+1),e){for(;p>=c.Dc(b);)b++;this.Bk.add(b)}(new a.Rr).sort(this.wh,0,2*f,new g(this,e));this.Za.clear();this.Za.Hn(new d(this));this.Za.de(f);c=0;for(f*=2;c<f;c++)if(e=this.wh.get(c),
b=this.xh.get(e),e=b>>1,0==(b&1)){b=this.Za.addElement(e,-1);p=this.Za.ge(b);if(-1!=p&&!this.Yy(this.Za.da(p),e))return this.Kd=new a.wd(3,e,this.Za.da(p)),!1;var k=this.Za.bb(b);if(-1!=k&&!this.Yy(this.Za.da(k),e))return this.Kd=new a.wd(3,e,this.Za.da(k)),!1}else if(b=this.Za.search(e,-1),p=this.Za.ge(b),k=this.Za.bb(b),this.Za.kd(b,-1),-1!=p&&-1!=k&&!this.Yy(this.Za.da(p),this.Za.da(k)))return this.Kd=new a.wd(3,this.Za.da(p),this.Za.da(k)),!1;return!0};p.prototype.RK=function(){return 10>this.U.F()?
this.PK():this.QK()};p.prototype.QK=function(){var b=new a.fd;b.Eb(this.U);var c=new a.wd;return a.Zu.DE(!1,b,this.Ri,c,this.oe)?(c.Fk=b.gb(c.Fk),c.Gk=b.gb(c.Gk),this.Kd.aq(c),!1):!0};p.prototype.PK=function(){for(var b=this.U,c=b.Ca(),b=b.Ca();c.kb();)for(;c.La();){var e=c.ia();if(!c.Jm()||!c.YO()){b.xR(c);do for(;b.La();){var d=b.ia(),d=e.fq(d,this.Ri,!0);if(0!=d)return this.Kd=new a.wd(2==d?5:4,c.Jb(),b.Jb()),!1}while(b.kb())}}return!0};p.prototype.UK=function(){var b=this.U;this.$a.length=0;this.dn.length=
0;this.Hf=b.Ca();this.Hf.NR();var c=new a.ga(0);c.xb(10);for(var e=NaN,d=0,f=0,b=2*b.F();f<b;f++){var g=this.wh.get(f),g=this.xh.get(g);if(0==(g&1)){var g=g>>1,p=this.$e.read(2*g),k=this.$e.read(2*g+1);if(0!=c.size&&(p!=e||k!=d)){if(!this.TE(c))return!1;null!=c&&c.clear(!1)}c.add(g);e=p;d=k}}return this.TE(c)?!0:!1};p.prototype.TK=function(){for(var b=this.U,e=Array(b.ea()),d=0,f=b.ea();d<f;d++)e[d]=b.Oo(d);var f=new c,g,p,k,h=new a.b,d=this.wh.get(0),d=this.xh.get(d),n=d>>1;this.$e.ec(2*n,h);d=this.Bk.get(n);
g=e[d];p=b.Ea(d);k=b.Dc(d)-1;f.ak=n==p||n==k;f.Ev=this.pk?!g&&f.ak:f.ak;f.Sh=d;f.x=h.x;f.y=h.y;f.yl=n;for(var q=new c,l=1,r=this.wh.size;l<r;l++)if(d=this.wh.get(l),d=this.xh.get(d),0==(d&1)){n=d>>1;this.$e.ec(2*n,h);d=this.Bk.get(n);d!=f.Sh&&(g=e[d],p=b.Ea(d),k=b.Dc(d)-1);var t,u=n==p||n==k;t=this.pk?!g&&f.ak:f.ak;q.x=h.x;q.y=h.y;q.Sh=d;q.yl=n;q.Ev=t;q.ak=u;if(q.x==f.x&&q.y==f.y)if(this.pk){if(!q.Ev||!f.Ev)if(q.Sh!=f.Sh||!q.ak&&!f.ak)return this.Kd=new a.wd(8,q.yl,f.yl),!1}else if(!q.ak||!f.ak)return this.Kd=
new a.wd(5,q.yl,f.yl),!1;d=f;f=q;q=d}return!0};p.prototype.AB=function(){for(var b=this.U,c=[],d=-1,f=!1,g=0,p=b.ea();g<p;g++)b.qt(g)&&(f=!1,d++,g<p-1&&(b.qt(g+1)||(f=!0))),c[g]=f?d:-1;var f=new a.b,g=this.wh.get(0),g=this.xh.get(g),k=g>>1;this.$e.ec(2*k,f);for(var g=this.Bk.get(k),d=new e(f.x,f.y,g,k,c[g]),b=[],h=1,p=this.wh.size;h<p;h++)if(g=this.wh.get(h),g=this.xh.get(g),0==(g&1)){k=g>>1;this.$e.ec(2*k,f);g=this.Bk.get(k);g=new e(f.x,f.y,g,k,c[g]);if(g.x==d.x&&g.y==d.y){if(g.Sh==d.Sh)return this.Kd=
new a.wd(9,g.yl,d.yl),!1;0<=c[g.Sh]&&c[g.Sh]==c[d.Sh]&&(0!=b.length&&b[b.length-1]==d||b.push(d),b.push(g))}d=g}if(0==b.length)return!0;g=new a.$n(!0);a.I.Ps(c,-1);f=-1;h=new a.b;h.Eh();d=0;for(p=b.length;d<p;d++){k=b[d];if(k.x!=h.x||k.y!=h.y)f=g.jh(0),h.x=k.x,h.y=k.y;var n=c[k.Sh];-1==n&&(n=g.jh(2),c[k.Sh]=n);g.addElement(n,f);g.addElement(f,n)}p=new a.ga(0);p.xb(10);for(d=g.Wd;-1!=d;d=g.Cw(d))if(b=g.DC(d),0==(b&1)&&0!=(b&2)){b=-1;p.add(d);for(p.add(-1);0<p.size;){f=p.tc();p.af();h=p.tc();p.af();
k=g.DC(h);if(0!=(k&1)){b=0==(k&2)?f:h;break}g.$R(h,k|1);for(k=g.gc(h);-1!=k;k=g.bb(k))n=g.getData(k),n!=f&&(p.add(n),p.add(h))}if(-1!=b){g=-1;d=0;for(p=c.length;d<p;d++)if(c[d]==b){g=d;break}this.Kd=new a.wd(10,g,-1);return!1}}return!0};p.prototype.VK=function(){var b=this.U;if(0>=b.Mh())return this.Kd=new a.wd(6,1==b.ea()?1:-1,-1),0;if(1==b.ea())return this.pk&&!this.AB()?0:2;this.gn=a.ga.Yc(b.ea(),0);this.Hx=a.ga.Yc(b.ea(),-1);for(var c=-1,e=0,d=0,g=b.ea();d<g;d++){var p=b.oo(d);this.gn.write(d,
0>p?0:256);if(0<p)c=d,e=p;else{if(0==p)return this.Kd=new a.wd(6,d,-1),0;if(0>c||e<Math.abs(p))if(this.Kd=new a.wd(7,d,-1),this.pk)return 0;this.Hx.write(d,c)}}this.kr=b.ea();this.Ll=new a.ga(0);this.Ll.xb(10);g=b.F();this.wn=NaN;b=new a.ga(0);b.xb(10);this.yp=a.ga.Yc(g,-1);this.hu=a.ga.Yc(g,-1);null!=this.Hi?this.Hi.clear(!1):this.Hi=new a.ga(0);this.Hi.xb(10);this.Za.clear();this.Za.Hn(new f(this));c=0;for(g*=2;0<this.kr&&c<g;c++)if(e=this.wh.get(c),e=this.xh.get(e),0==(e&1)){e>>=1;d=this.$e.read(2*
e+1);if(d!=this.wn&&0!=b.size){if(!this.yr(b))return 0;null!=b&&b.clear(!1)}b.add(e);this.wn=d}return 0<this.kr&&!this.yr(b)?0:this.pk?0==this.Kd.yh&&this.AB()?2:0:0==this.Kd.yh?2:1};p.prototype.TE=function(b){if(1==b.size)return!0;for(var c=0,e=b.size;c<e;c++){var d=b.get(c);this.Hf.Sb(d);var f=this.Hf.oi();this.$a.push(this.Ls(f,d,this.Hf.Qa,!0));this.Hf.ia();f=this.Hf.ia();this.$a.push(this.Ls(f,d,this.Hf.Qa,!1))}var g=this;this.$a.sort(function(a,b){return g.sM(a,b)});d=this.Lg.Wd;-1==d&&(d=this.Lg.jh(0));
this.Lg.$l(this.$a.length);c=0;for(e=this.$a.length;c<e;c++)this.Lg.addElement(d,c);for(var c=!0,p=e=-1;c;){c=!1;f=this.Lg.gc(d);if(-1==f)break;for(var k=this.Lg.bb(f);-1!=k;){e=this.Lg.getData(f);p=this.Lg.getData(k);e=this.$a[e].tn;p=this.$a[p].tn;if(e==p)if(c=!0,this.Lg.Jc(d,f),f=this.Lg.ge(k),k=this.Lg.Jc(d,k),-1==k||-1==f)break;else continue;f=k;k=this.Lg.bb(f)}}c=this.Lg.vq(d);this.Lg.CB(d);if(0<c)return this.Kd=new a.wd(5,e,p),!1;c=0;for(e=b.size;c<e;c++)this.my(this.$a[c]);this.$a.length=
0;return!0};p.prototype.yr=function(b){for(var c=0,e=b.size;c<e;c++){var d=b.get(c),f=this.yp.read(d);if(-1!=f){var g=this.Za.da(f);this.Hi.add(g);this.Za.kd(f,-1);this.my(this.$a[g]);this.$a[g]=null;this.yp.write(d,-1)}f=this.hu.read(d);-1!=f&&(g=this.Za.da(f),this.Hi.add(g),this.Za.kd(f,-1),this.my(this.$a[g]),this.$a[g]=null,this.hu.write(d,-1))}c=0;for(e=b.size;c<e;c++){d=b.get(c);this.Hf.Sb(d);f=this.Hf.oi();if(f.ja>f.ha){var p=this.Hf.Jb(),k=this.Ls(f,d,this.Hf.Qa,!0);0<this.Hi.size?(g=this.Hi.tc(),
this.Hi.af(),this.$a[g]=k):(g=this.$a.length,this.$a.push(k));f=this.Za.addElement(g,-1);-1==this.yp.read(p)?this.yp.write(p,f):this.hu.write(p,f);0==(this.gn.read(this.Hf.Qa)&3)&&this.Ll.add(f)}this.Hf.ia();f=this.Hf.ia();f.ja<f.ha&&(p=this.Hf.Bm(),k=this.Ls(f,d,this.Hf.Qa,!1),0<this.Hi.size?(g=this.Hi.tc(),this.Hi.af(),this.$a[g]=k):(g=this.$a.length,this.$a.push(k)),f=this.Za.addElement(g,-1),-1==this.yp.read(p)?this.yp.write(p,f):this.hu.write(p,f),0==(this.gn.read(this.Hf.Qa)&3)&&this.Ll.add(f))}c=
0;for(e=this.Ll.size;c<e&&0<this.kr;c++)if(f=this.Ll.get(c),0==(this.gn.read(this.$a[this.Za.da(f)].Gx)&3)){b=-1;for(var d=this.Za.ge(f),h=f,k=null,g=-1,n=0;-1!=d;){g=this.Za.da(d);k=this.$a[g];g=k.Gx;n=this.gn.read(g);if(0!=(n&3))break;h=d;d=this.Za.ge(d)}-1==d?(p=1,d=h):(b=1==(n&3)?g:this.Hx.read(g),p=0!=k.LC()?0:1,d=this.Za.bb(d));do{g=this.Za.da(d);k=this.$a[g];g=k.Gx;h=this.gn.read(g);if(0==(h&3)){if(p!=k.LC())return this.Kd=new a.wd(6,g,-1),!1;n=0==p||k.sl()?2:1;h=h&252|n;this.gn.write(g,n);
if(2==n&&0==this.Kd.yh&&this.Hx.read(g)!=b&&(this.Kd=new a.wd(7,g,-1),this.pk))return!1;this.kr--;if(0==this.kr)return!0}1==(h&3)&&(b=g);h=d;d=this.Za.bb(d);p=0!=p?0:1}while(h!=f)}null!=this.Ll?this.Ll.clear(!1):this.Ll=new a.ga(0);return!0};p.prototype.Ls=function(b,c,e,d){if(322==b.D())b=this.PL(b);else throw a.g.wa();b.tn=c;b.Gx=e;b.hp=0;b.hS(d);return b};p.prototype.PL=function(c){var e;0<this.dn.length?(e=this.dn[this.dn.length-1],--this.dn.length,c.copyTo(e.Zd)):(e=new b,e.Zd=a.fA.Yj(c));return e};
p.prototype.my=function(a){322==a.Zd.D()&&this.dn.push(a)};p.prototype.eQ=function(){for(var b=this.U.F(),c=new a.ga(0),e=0;e<b;e++)c.add(e);var d=this;c.xd(0,b,function(a,b){return d.Is(a,b)});for(e=1;e<b;e++)if(0==this.Is(c.get(e-1),c.get(e)))return this.Kd=new a.wd(3,c.get(e-1),c.get(e)),0;return 2};p.prototype.NQ=function(){return this.yB()?this.xB(!0)?2:0:0};p.prototype.LQ=function(){return this.Yw()};p.prototype.fQ=function(){for(var b=this.U.F(),c=new a.ga(0),e=0;e<b;e++)c.add(e);var d=this;
c.xd(0,b,function(a,b){return d.uL(a,b)});var f=Array(b);a.I.Ps(f,!1);f[c.get(0)]=!0;for(e=1;e<b;e++){var g=c.get(e-1),p=c.get(e);0==this.Is(g,p)?f[p]=!1:f[p]=!0}for(var c=this.U.Pa(),g=this.U,p=0,k=1,e=0;e<b;e++)f[e]?k=e+1:(p<k&&c.Pd(g,p,k),p=e+1);p<k&&c.Pd(g,p,k);c.hg(2,this.pn);return c};p.prototype.OQ=function(){var b=this.U,c=b.Ca(),e=b.Ca(),d=this.U.Pa(),f=this.U,g=b.hasAttribute(1),p=g?a.Ia.rB(this.sg,b,!0):0,k=new a.ga(0),h=new a.ga(0);k.xb(a.I.truncate(b.F()/2+1));for(h.xb(a.I.truncate(b.F()/
2+1));c.kb();)if(e.kb(),!(2>b.Ha(c.Qa))){e.zR();for(var n,q,l=!0;c.La();){var r=c.ia(),t=e.oi();if(c.Jb()>e.Jb())break;l&&(k.add(c.Jb()),h.add(e.Bm()),l=!1);q=k.tc();var u=c.Bm();if(1<u-q){var A=new a.b;A.pc(b.Fa(q),b.Fa(u));n=A.length()}else n=r.$b();q=h.tc();u=e.Jb();1<u-q?(A=new a.b,A.pc(b.Fa(q),b.Fa(u)),q=A.length()):q=t.$b();n>this.pn?k.add(c.Bm()):g&&(n=b.ld(1,k.tc(),0),r=r.Ws(1,0),Math.abs(r-n)>p&&k.add(c.Bm()));q>this.pn?h.add(e.Jb()):g&&(n=b.ld(1,h.tc(),0),r=t.Ws(1,0),Math.abs(r-n)>p&&h.add(e.Jb()))}k.tc()<
h.tc()?k.size>h.size?k.af():h.af():(k.tc()!=h.tc()&&h.af(),h.af());if(2<=h.size+k.size){l=new a.Va;t=0;for(r=k.size;t<r;t++)f.Sd(k.get(t),l),0==t?d.df(l):d.lineTo(l);for(t=h.size-1;0<t;t--)f.Sd(h.get(t),l),d.lineTo(l);f.vc(c.Qa)?d.ro():0<h.size&&(f.Sd(h.get(0),l),d.lineTo(l))}null!=k&&k.clear(!1);null!=h&&h.clear(!1)}d.hg(2,this.pn);return d};p.prototype.MQ=function(){return this.xS()};p.prototype.xS=function(){if(1736==this.U.D()&&1==this.U.Cm())return a.Of.Qj(this.U,this.pn,!0,!1,this.oe);this.Zh=
new a.fd;this.Zh.Eb(this.U);0!=this.Zh.pd&&(1!=this.yx&&a.aj.$(this.Zh,this.pn,this.oe,!0),1736==this.U.D()&&a.mm.$(this.Zh,this.Zh.$c,this.yx,!1,this.oe));this.U=this.Zh.hf(this.Zh.$c);1736==this.U.D()&&(this.U.hl(),this.U.Pp(0));this.U.hg(2,this.pn);return this.U};p.ac=function(b,c,e){if(b.s())return 1;var d=b.D();if(33==d)return 1;if(197==d)return e=new a.i,b.o(e),e.mg(a.Ia.Cg(c,b,!1))?0:1;if(a.T.Lc(d))throw a.g.wa();if(!a.T.Th(d))throw a.g.wa();var d=a.Ia.Cg(c,b,!1),f=b.rj(d);e=e?-1:f;if(-1!=
e)return e;1==e&&(d=0);e=(new p(b,c,e,0,!1)).Yw();b.hg(e,d);return e};p.Ro=function(b,c,e,d,f){null!=d&&(d.yh=0,d.Fk=-1,d.Gk=-1);if(b.s())return 1;var g=b.D();if(33==g)return 1;var k=a.Ia.Cg(c,b,!1);if(197==g)return c=new a.i,b.o(c),c.mg(k)?(null!=d&&(d.yh=2,d.Fk=-1,d.Gk=-1),0):1;if(a.T.Lc(g))return k=new a.Xa(b.description),k.Bc(b,!0),p.Ro(k,c,e,d,f);f=b.rj(k);e=e?-1:f;if(-1!=e)return e;c=new p(b,c,e,0,!1);if(550==g)e=c.eQ();else if(1607==g)e=c.NQ();else if(1736==g)e=c.LQ();else throw a.g.wa();b.hg(e,
k);null!=d&&0==e&&d.aq(c.Kd);return e};p.ob=function(b,c,e,d,f){null!=d&&(d.yh=0,d.Fk=-1,d.Gk=-1);if(b.s())return 1;var g=b.D();if(33==g)return 1;var k=a.Ia.Cg(c,b,!1);if(197==g)return c=new a.i,b.o(c),c.mg(k)?(null!=d&&(d.yh=2,d.Fk=-1,d.Gk=-1),0):1;if(a.T.Lc(g))return g=new a.Xa(b.description),g.Bc(b,!0),p.Ro(g,c,e,d,f);b=new p(b,c,-1,0,!0);if(550==g||1607==g||1736==g)c=b.Yw();else throw a.g.wa();null!=d&&d.aq(b.Kd);return c};p.cG=function(b,c,e,d){if(b.s())return b;var f=b.D();if(33==f)return b;
var g=a.Ia.Cg(c,b,!1);if(197==f)return c=new a.i,b.o(c),c.mg(g)?b.Pa():b;if(a.T.Lc(f))return f=new a.Xa(b.description),f.Bc(b,!0),p.cG(f,c,e,d);d=b.rj(g);e=e?-1:d;if(2==e)return b;b=new p(b,c,e,0,!1);if(550==f)b=b.fQ();else if(1607==f)b=b.OQ();else if(1736==f)b=b.MQ();else throw a.g.wa();return b};p.Ry=function(b,c,e,d){if(b.s())return b;var f=b.D();if(33==f)return b;var g=a.Ia.Cg(c,b,!1);if(197==f)return c=new a.i,b.o(c),c.mg(g)?b.Pa():b;if(a.T.Lc(f))return g=new a.Xa(b.description),g.Bc(b,!0),p.Ry(g,
c,e,d);if(!a.T.Th(f))throw a.g.ra("OGC simplify is not implemented for this geometry type "+f);return a.Of.Ry(b,g,!1,d)};p.prototype.kj=function(b,c,e){if(b==c)return 0;b=this.xh.get(b);var d=this.xh.get(c);c=b>>1;var f=d>>1,g=new a.b,p=new a.b;this.$e.ec(2*c,g);g.y+=0!=(b&1)?this.Ri:-this.Ri;this.$e.ec(2*f,p);p.y+=0!=(d&1)?this.Ri:-this.Ri;b=g.compare(p);return 0==b&&e?(e=this.Bk.get(c)-this.Bk.get(f),0>e?-1:0<e?1:0):b};p.prototype.Is=function(b,c){if(b==c)return 0;var e=this.U,d=e.Fa(b),f=e.Fa(c);
if(d.x<f.x)return-1;if(d.x>f.x)return 1;if(d.y<f.y)return-1;if(d.y>f.y)return 1;for(d=1;d<this.wP;d++)for(var f=this.SD.Hd(d),g=a.pa.Wa(f),p=0;p<g;p++){var k=e.ld(f,b,p),h=e.ld(f,c,p);if(k<h)return-1;if(k>h)return 1}return 0};p.prototype.uL=function(a,b){var c=this.Is(a,b);return 0==c?a<b?-1:1:c};p.prototype.sM=function(a,b){if(a===b)return 0;var c=a.Zd.Pf(a.sl()?1:0);a.sl()&&c.Bp();a=b.Zd.Pf(b.sl()?1:0);b.sl()&&a.Bp();b=c.ps();var e=a.ps();return e==b?(b=c.Ai(a),Math.abs(b)<=8.881784197001252E-16*
(Math.abs(a.x*c.y)+Math.abs(a.y*c.x))&&(b--,b++),0>b?1:0<b?-1:0):b<e?-1:1};return p}();a.cv=k})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 30};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.prototype.$=function(b,c,e,d){return b instanceof a.T?(b=new a.Pc(b),c=new a.Pc(c),this.$(b,c,e,d).next()):new a.hI(b,c,e,d)};c.On=function(b,e,d,f){var g=b.fb(),p=e.fb();if(b.s()&&e.s())return g>p?b:e;if(b.s())return e;if(e.s())return b;
var k=new a.i,h=new a.i,n=new a.i;b.o(k);e.o(h);n.K(k);n.Db(h);k=a.Ia.zd(d,n,!1);h=b.D();n=e.D();return 33==h&&33==n?c.qP(b,e,k):h!=n?0<g||0<p?g>p?b:e:550==h?c.pA(b,e,k):c.pA(e,b,k):a.Of.On(b,e,d,f)};c.qP=function(b,c,e){e=e*Math.sqrt(2)*1.00001;e*=e;var d=b.w(),f=c.w(),g=new a.pe(b.description);a.b.Zb(d,f)>e&&(g.add(b),g.add(c));return g};c.pA=function(b,c,e){var d=b.mc(0),f=b.F(),g=c.w(),p=b.Pa();e=e*Math.sqrt(2)*1.00001;var k=new a.i;b.o(k);k.P(e,e);if(k.contains(g)){e*=e;for(var k=!1,h=[],n=0;n<
f;n++)h[n]=!1;for(n=0;n<f;n++){var q=d.read(2*n),l=d.read(2*n+1),q=q-g.x,l=l-g.y;q*q+l*l<=e&&(k=!0,h[n]=!0)}if(k)for(n=0;n<f;n++)h[n]||p.Pd(b,n,n+1);else p.Pd(b,0,f),p.add(c)}else p.Pd(b,0,f),p.add(c);return p};c.V=null;return c}(a.Me);a.dv=b})(z||(z={}));(function(a){var b=function(){function b(a,b,c,e){this.Fq=null==b;this.ua=-1;this.ne=a;this.cg=c;this.QP=b.next();this.Yb=e}b.prototype.next=function(){if(this.Fq)return null;var b;return null!=(b=this.ne.next())?(this.ua=this.ne.ya(),a.dv.On(b,
this.QP,this.cg,this.Yb)):null};b.prototype.ya=function(){return this.ua};return b}();a.hI=b})(z||(z={}));(function(a){var b=function(){function a(){}a.prototype.jt=function(){this.iw=null;this.Vu=-1;this.xG=!1};return a}(),c=function(){function a(){this.jq=0;this.Ci=[]}a.prototype.TJ=function(a){this.jq+=a.Vu;this.Ci.push(a)};a.prototype.PQ=function(){this.jq-=this.Ci[this.Ci.length-1].Vu;--this.Ci.length};a.prototype.Dv=function(){return this.Ci[this.Ci.length-1]};a.prototype.lc=function(a){return a===
this};return a}(),e=function(){function e(a,b,c){this.ua=-1;this.Ec=!1;this.bE=[!1,!1,!1,!1];this.ep=[0,0,0,0];this.ox=!1;this.Gj=-1;this.So=0;this.Tm=-1;this.rn=[];this.ne=a;this.cg=b;this.Yb=c}e.ac=function(a){var b=[],c;for(c in a)b.push(Number(c));b.sort(function(a,b){return a-b});return b};e.prototype.UC=function(b){var c=this.rn[b],d=e.ac(c)[0],f=c[d],g=f.Dv().iw,f=f.Dv().xG;delete c[d];f&&(g=a.as.local().$(g,this.cg,!1,this.Yb),0==b&&33==g.D()&&(b=new a.pe(g.description),g.s()||b.add(g),g=
b));return g};e.prototype.next=function(){if(this.Ec&&this.Tm==this.Gj)return null;for(;!this.FS(););if(-1==this.Gj)return null;if(this.ox){for(this.Tm++;;){if(this.Tm>this.Gj||0>this.Tm)throw a.g.wa();if(this.bE[this.Tm])break}this.ua++;return this.UC(this.Tm)}this.ua=0;this.Tm=this.Gj;return this.UC(this.Gj)};e.prototype.ya=function(){return this.ua};e.prototype.FS=function(){if(this.Ec)return!0;var b=null;null!=this.ne&&(b=this.ne.next(),null==b&&(this.Ec=!0,this.ne=null));if(null!=b){var c=b.fb();
this.bE[c]=!0;c>=this.Gj&&!this.ox&&(this.SA(c,!1,b),c>this.Gj&&!this.ox&&this.vR(c))}if(0<this.So)for(c=0;c<=this.Gj;c++)for(;1<this.ep[c];)if(b=this.jL(c),0!=b.length)b=a.Of.oM(b,this.cg,this.Yb),this.SA(c,!0,b);else break;return this.Ec};e.prototype.jL=function(a){for(var b=[],c=[],d=this.rn[a],f=e.ac(d),g=0;g<f.length;g++){var p=f[g],k=d[p];if(this.Ec||1E4<k.jq&&1<k.Ci.length){this.ep[a]-=k.Ci.length;for(this.So-=k.Ci.length;0<k.Ci.length;)b.push(k.Dv().iw),k.PQ();c.push(p)}}for(g=0;g<c.length;g++)delete d[c[g]];
return b};e.prototype.vR=function(a){for(var b=0;b<a;b++)this.rn[b]=[],this.So-=this.ep[b],this.ep[b]=0};e.prototype.SA=function(a,d,f){var g=new b;g.jt();g.iw=f;f=e.$g(f);g.Vu=f;f=e.Wf(f);if(a+1>this.rn.length)for(var p=0,k=Math.max(2,a+1);p<k;p++)this.rn.push([]);p=this.rn[a][f];void 0===p&&(p=new c,this.rn[a][f]=p);g.xG=d;p.TJ(g);this.ep[a]++;this.So++;this.Gj=Math.max(this.Gj,a)};e.Wf=function(b){return 0<b?a.I.truncate(Math.log(b)/Math.log(4)+.5):0};e.$g=function(b){var c=b.D();if(a.T.Th(c))return b.F();
if(33==c)return 1;if(197==c)return 4;if(a.T.Lc(c))return 2;throw a.g.wa();};return e}();a.jI=e})(z||(z={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}w(c,b);c.prototype.D=function(){return 1};c.prototype.$=function(b,c,e,d){return void 0===d?new a.jI(b,c,e):this.xM(b,c,e,d)};c.prototype.xM=function(b,c,e,d){b=new a.Pc([b,c]);return this.$(b,e,d).next()};c.local=function(){null===c.V&&(c.V=new c);return c.V};c.V=null;return c}(a.Me);a.wi=b})(z||(z={}));(function(a){var b;
(function(a){a[a.nextPath=0]="nextPath";a[a.nextSegment=1]="nextSegment";a[a.iterate=2]="iterate"})(b||(b={}));b=function(){function b(b,c,e,d){this.dr=new a.i;this.LP=b;this.MP=c;this.Wo=d;this.hn=-1;this.qk=!1;var f=b.pb;null!=f&&(f=d?f.nn:f.Ab,null!=f&&(this.Ec=!1,this.ka=e,this.Ab=f,this.au=this.Ab.Re(),this.Xo=this.qk=!0,this.Hb=0,d?this.hn=c.ea():this.bd=c.Ca()));this.qk||(f=c.pb,null!=f&&(f=d?f.nn:f.Ab,null!=f&&(this.Ec=!1,this.ka=e,this.Ab=f,this.au=this.Ab.Re(),this.qk=!0,this.Xo=!1,this.Hb=
0,d?this.hn=b.ea():this.bd=b.Ca())));this.qk||(this.th=d?a.Ia.BN(b,c,e,1<=b.rj(0),1<=c.rj(0)):a.Ia.AN(b,c,e))}b.prototype.next=function(){if(this.qk){if(this.Ec)return!1;for(var b=!0;b;)switch(this.Hb){case 0:b=this.nQ();break;case 1:b=this.oQ();break;case 2:b=this.$w();break;default:throw a.g.ra("internal error");}return this.Ec?!1:!0}return null==this.th?!1:this.th.next()};b.prototype.jk=function(){return this.qk?this.Xo?this.Ab.da(this.Rq):this.Wo?this.hn:this.bd.Jb():this.th.jk(this.th.Ff)};b.prototype.ek=
function(){return this.qk?this.Xo?this.Wo?this.hn:this.bd.Jb():this.Ab.da(this.Rq):this.th.ek(this.th.mf)};b.prototype.Fw=function(){if(!this.Wo)throw a.g.ra("internal error");return this.qk?this.Xo?this.Ab.uC(this.Rq):this.dr:this.th.Fw(this.th.Ff)};b.prototype.jw=function(){if(!this.Wo)throw a.g.ra("internal error");return this.qk?this.Xo?this.dr:this.Ab.uC(this.Rq):this.th.jw(this.th.mf)};b.prototype.nQ=function(){if(!this.Wo){if(!this.bd.kb())return this.Ec=!0,!1;this.Hb=1;return!0}if(-1==--this.hn)return this.Ec=
!0,!1;this.Xo?this.MP.Ti(this.hn,this.dr):this.LP.Ti(this.hn,this.dr);this.au.Ch(this.dr,this.ka);this.Hb=2;return!0};b.prototype.oQ=function(){if(!this.bd.La())return this.Hb=0,!0;var a=this.bd.ia();this.au.Fn(a,this.ka);this.Hb=2;return!0};b.prototype.$w=function(){this.Rq=this.au.next();return-1==this.Rq?(this.Hb=this.Wo?0:1,!0):!1};return b}();a.cl=b})(z||(z={}));(function(a){a=a.kI||(a.kI={});a[a.enumClosed=1]="enumClosed";a[a.enumHasNonlinearSegments=2]="enumHasNonlinearSegments";a[a.enumOGCStartPolygon=
4]="enumOGCStartPolygon";a[a.enumCalcMask=4]="enumCalcMask"})(z||(z={}));(function(a){var b=function(){function b(){}b.Fb=function(c,e,d,f,g,k,h,n,q){var p=[0,0,0],l=[0,0,0],r=[0,0,0],t=[0,0,0,0],u=new a.ca(0),w=new a.ca(0),A=new a.ca(0);if(null!=h||null!=n||null!=q)if(a.j.Ih(e))a.zg.Fb(c,d,f,g,k,h,n,q);else{g=a.u.W(g);d=a.u.W(d);var v=a.u.W(g-d);if(a.j.S(f,k)&&(a.j.S(d,g)||a.j.S(a.j.H(f),1.570796326794897)))null!=h&&(h.l=0),null!=n&&(n.l=0),null!=q&&(q.l=0);else{if(a.j.S(f,-k)){if(a.j.S(a.j.H(f),
1.570796326794897)){null!=h&&(h.l=2*a.u.gg(c,e));null!=n&&(n.l=0<f?a.u.W(3.141592653589793-a.u.W(g)):a.u.W(g));null!=q&&(q.l=0<f?a.u.W(g):a.u.W(3.141592653589793-a.u.W(g)));return}a.j.S(a.j.H(v),3.141592653589793)&&(null!=h&&(h.l=2*a.u.gg(c,e)),null!=n&&(n.l=0),null!=q&&(q.l=0))}else{if(a.j.S(a.j.H(f),1.570796326794897)||a.j.S(a.j.H(k),1.570796326794897)){a.Xj.Fb(c,e,d,f,g,k,h,n,q);return}if(a.j.S(d,g)||a.j.S(a.j.H(v),3.141592653589793)){a.Xj.Fb(c,e,d,f,g,k,h,n,q);return}if(a.j.Vc(f)){a.Xj.Fb(c,e,
d,f,g,k,h,n,q);return}}var x=Math.sqrt(1-e);g=a.u.W(g-d);d=0;a.u.wm(e,f,d,u,w,A);p[0]=u.l;p[1]=w.l;p[2]=A.l;a.u.wm(e,k,g,u,w,A);l[0]=u.l;l[1]=w.l;l[2]=A.l;r[0]=0;r[1]=0;r[2]=-1*e*a.u.n(1,e,f)*Math.sin(f);0>g?a.u.Ep(r,l,p,t,0):a.u.Ep(r,p,l,t,0);for(var w=[0,0,0],A=[0,0,0],m=[0,0,0],p=[0,0,0],u=[0,0,0],y=Math.acos(t[2]/1),K=1-e,z=Math.tan(y),E=1+z*z/K,C=2*r[2]*z/K,z=Math.sqrt(C*C-4*E*(r[2]*r[2]/K-1)),E=2*E,K=(-C+z)/E,C=(-C-z)/E,z=Math.tan(y),E=z*K+r[2],y=(K+C)/2,r=(E+(z*C+r[2]))/2,z=a.u.Sn(K-y,E-r),
K=r/x*1.570796326794897,C=0;100>C;C++){E=a.u.Tk(e,K);E=E*E/Math.cos(K)*(Math.sin(K)-r*E/(1*(1-e)));if(a.j.Vc(E))break;K-=E}var r=a.u.n(1,e,K)*Math.cos(K),r=Math.sqrt((r-y)*(r+y)),z=1-z/r,z=z*(2-z),E=a.u.jm(w),y=a.u.jm(A),K=a.u.jm(m),U=a.u.Qr(m,w),C=a.u.Qr(m,A);a.u.Uu(m,w,p);a.u.Uu(m,A,u);w=Math.acos(U/(K*E));A=Math.acos(C/(K*y));A*=a.j.nb(1,a.u.Qr(p,u));if(1.570796326794897<=a.j.H(w)&&1.570796326794897<=a.j.H(A)||3.141592653589793<a.j.H(w-A))w=(3.141592653589793-a.j.H(w))*a.j.nb(1,w),A=(3.141592653589793-
a.j.H(A))*a.j.nb(1,A);p=a.u.Si(z,A);u=a.u.q(r,z,a.u.Si(z,w));p=a.u.q(r,z,p);p=a.j.H(p-u)*c;w=new a.ca(0);A=new a.ca(0);m=t[1]/1;m*=-a.j.nb(1,v);u=Math.acos(m)*a.j.nb(1,v);b.gf(c,e,d,f,p,u,w,A);a.j.S(g,w.l)&&a.j.S(k,A.l)||(z=a.u.Sn(a.u.W(g-w.l),k-A.l),b.gf(c,e,d,f,p,a.u.W(u+3.141592653589793),w,A),E=a.u.Sn(a.u.W(g-w.l),k-A.l),E<z&&(u=a.u.W(u+3.141592653589793)));w=[0,0,0,0];A=[0,0,0,0];r=[0,0,0];z=[0,0,0];c=[0,0,0];d=[0,0,0];f=[0,0,0];m=[0,0,0];r[0]=0;r[1]=0;r[2]=x;z[0]=0;z[1]=0;z[2]=0;a.u.Ep(z,r,
l,w,0);a.j.Vc(k)?(c[0]=l[0],c[1]=l[1],c[2]=1,d[0]=1*Math.cos(g)-1*Math.sin(g),d[1]=1*Math.sin(g)+1*Math.cos(g)):(e=a.u.n(1,e,k)*Math.cos(k),c[0]=0,c[1]=0,l[2]+=Math.tan(1.570796326794897-a.j.H(k))*e*a.j.nb(1,k),d[0]=e*Math.cos(g)-e*Math.sin(g),d[1]=e*Math.sin(g)+e*Math.cos(g));d[2]=l[2];a.u.Ep(l,d,c,A,1);a.u.Uu(A,w,f);a.u.Uu(A,t,m);m=a.u.Qr(f,m)/(a.u.jm(f)*a.u.jm(m));m*=a.j.nb(1,v);g=Math.acos(m)*-a.j.nb(1,v);0<u&&0<g?g=a.u.W(g+3.141592653589793):0>u&&0>g&&(g=a.u.W(g+3.141592653589793));null!=h&&
(h.l=p);null!=n&&(n.l=u);null!=q&&(q.l=g)}}};b.gf=function(b,c,e,d,f,g,k,h){var p=[0,0,0],n=[0,0,0],q=[0,0,0],l=[0,0,0],r=[0,0,0],t=[0,0,0],u=[0,0,0],w=[0,0,0,0],A=new a.ca(0),v=new a.ca(0),x=new a.ca(0),m=new a.ca(0),y=new a.ca(0),K=new a.ca(0);if(null!=k&&null!=h)if(a.j.Ih(c))a.zg.gf(b,e,d,f,g,k,h);else if(a.j.Vc(f))null!=k&&(k.l=e),null!=h&&(h.l=d);else if(g=a.u.W(g),0>f&&(f=a.j.H(f),g=a.u.W(g+3.141592653589793)),e=a.u.W(e),d=a.u.W(d),1.570796326794897<a.j.H(d)&&(e=a.u.W(e+3.141592653589793),d=
a.j.nb(3.141592653589793,d)-d),a.j.S(a.j.H(d),1.570796326794897)||a.j.Vc(d)||a.j.Vc(g)||a.j.S(a.j.H(g),3.141592653589793))a.Xj.gf(b,c,e,d,f,g,k,h);else{var z=Math.sqrt(1-c);b=f/b;a.u.wm(c,d,0,m,y,K);p[0]=m.l;p[1]=y.l;p[2]=y.l;u[0]=0;u[1]=0;u[2]=-1*c*a.u.n(1,c,d)*Math.sin(d);m=a.u.n(1,c,d);y=a.u.W(1.570796326794897-g);K=Math.sin(y);f=Math.cos(d);d=Math.sin(d);r[0]=m*f-d*K;r[1]=Math.cos(y);r[2]=(1-c)*m*d+f*K;0>g?a.u.Ep(u,r,p,w,0):a.u.Ep(u,p,r,w,0);p=Math.acos(w[2]/1);w=Math.atan2(-w[1],-w[0]);d=1-c;
r=Math.tan(p);y=1+r*r/d;m=2*u[2]*r/d;r=Math.sqrt(m*m-4*y*(u[2]*u[2]/d-1));y*=2;d=(-m+r)/y;m=(-m-r)/y;r=Math.tan(p);y=r*d+u[2];p=(d+m)/2;u=(y+(r*m+u[2]))/2;r=a.u.Sn(d-p,y-u);z=u/z*1.570796326794897;for(d=0;100>d;d++){m=a.u.Tk(c,z);m=m*m/Math.cos(z)*(Math.sin(z)-u*m/(1*(1-c)));if(a.j.Vc(m))break;z-=m}z=a.u.n(1,c,z)*Math.cos(z);z=Math.sqrt((z-p)*(z+p));u=1-r/z;u*=2-u;t=Math.acos(a.u.Qr(t,n)/(a.u.jm(t)*a.u.jm(n)));t*=a.j.nb(1,n[0]);g=(a.u.q(z,u,a.u.Si(u,t))+b*a.j.nb(1,g))/a.u.gg(z,u);g=a.u.W(1.570796326794897*
g);g=a.u.xn(u,g);a.u.n(z,u,g);r=a.u.W(w+e);e=Math.cos(r);g=Math.sin(r);q[0]=l[0]*e+l[1]*-g;q[1]=l[0]*g+l[1]*e;q[2]=l[2];a.u.JK(c,q[0],q[1],q[2],x,v,A);null!=k&&(k.l=v.l);null!=h&&(h.l=x.l)}};return b}();a.$z=b})(z||(z={}));(function(a){var b=function(){function b(b){this.Na=null;this.Ar=new a.b;this.Br=new a.b;this.a=b}b.prototype.compare=function(a,b,c){this.a.uc(b,this.Ar);this.a.uc(a.da(c),this.Br);return this.Ar.compare(this.Br)};return b}(),c=function(){function b(b){this.nf=new a.b;this.ln=
new a.b;this.a=b}b.prototype.bh=function(a){this.nf.J(a)};b.prototype.compare=function(a,b){this.a.uc(a.da(b),this.ln);return this.nf.compare(this.ln)};return b}(),e=function(a){function b(b){a.call(this,b.a,b.ka,!1);this.ab=b}w(b,a);b.prototype.compare=function(a,b,c){if(this.Zf)return-1;var e=this.ab.Cd.Dm(this.ab.lh(b));a=a.da(c);var d=this.ab.Cd.Dm(this.ab.lh(a));this.Cl=c;return this.JB(b,e,a,d)};return b}(a.hA),d=function(a){function b(b){a.call(this,b.a,b.ka);this.ab=b}w(b,a);b.prototype.compare=
function(a,b){if(this.Zf)return-1;a=this.ab.Cd.Dm(this.ab.lh(a.da(b)));this.Cl=b;return this.KB(b,a)};return b}(a.JI),f=function(){function f(){this.zc=this.Ue=this.Zm=this.Cd=this.Kg=this.nd=this.$a=this.a=null;this.og=!1;this.Xg=this.Kl=this.Vd=this.Lj=this.Mg=this.Hj=this.sf=this.Ld=null;this.Yg=this.rp=this.Tx=this.ka=0;this.Ht=this.Nm=!1;this.mn=new a.b;this.Ck=new a.b;this.$a=new a.Fc(8);this.nd=new a.Fc(5);this.Kg=new a.Ur;this.Cd=new a.Ur;this.og=!1;this.Xg=new a.b;this.Xg.ma(0,0);this.ka=
0;this.Yg=-1;this.Nm=!1;this.a=null;this.Ue=new a.bj;this.zc=new a.bj;this.Mg=new a.ga(0);this.Lj=new a.gA;this.sf=new a.ga(0);this.Hj=new a.ga(0);this.Zm=new a.Va}f.prototype.GS=function(b,c){var e=new a.Bg;e.Oy();b.Oe(e);this.Op(b);this.Nm=!1;this.ka=c;this.Tx=c*c;c=this.Xy();b.Oe(e);c||(this.JM(),c||this.Xy());-1!=this.Yg&&(this.a.bf(this.Yg),this.Yg=-1);this.a=null;return this.Nm};f.prototype.KS=function(a,b){this.Op(a);this.Nm=!1;this.ka=b;this.Tx=b*b;this.og=!1;this.Xy();this.og||(this.og=1==
a.xo(b,!0,!1));-1!=this.Yg&&(this.a.bf(this.Yg),this.Yg=-1);this.a=null};f.prototype.Uf=function(a,b){return this.$a.O(a,0+b)};f.prototype.zy=function(a,b,c){this.$a.L(a,0+b,c)};f.prototype.lh=function(a){return this.$a.O(a,2)};f.prototype.UR=function(a,b){this.$a.L(a,2,b)};f.prototype.FC=function(a,b){return this.$a.O(a,3+b)};f.prototype.Eo=function(a){return this.$a.O(a,7)};f.prototype.Nk=function(a,b){this.$a.L(a,7,b)};f.prototype.Go=function(a,b){return this.$a.O(a,3+this.Do(a,b))};f.prototype.Qp=
function(a,b,c){this.$a.L(a,3+this.Do(a,b),c)};f.prototype.ZN=function(a,b){return this.$a.O(a,5+this.Do(a,b))};f.prototype.Sp=function(a,b,c){this.$a.L(a,5+this.Do(a,b),c)};f.prototype.rq=function(a){return this.nd.O(a,0)};f.prototype.RR=function(a,b){this.nd.L(a,0,b)};f.prototype.ow=function(a){return this.nd.O(a,4)};f.prototype.Lp=function(a,b){this.nd.L(a,4,b)};f.prototype.fk=function(a){return this.nd.O(a,1)};f.prototype.dm=function(a,b){this.nd.L(a,1,b)};f.prototype.nw=function(a){return this.nd.O(a,
3)};f.prototype.Hr=function(a,b){this.nd.L(a,3,b)};f.prototype.Ul=function(a){var b=this.nd.be(),c=this.Kg.jh();this.RR(b,c);-1!=a?(this.Kg.addElement(c,a),this.a.lb(a,this.Yg,b),this.Lp(b,this.a.gb(a))):this.Lp(b,-1);return b};f.prototype.aM=function(a){this.nd.Jc(a)};f.prototype.QA=function(a,b){this.Kg.addElement(this.rq(a),b);this.a.lb(b,this.Yg,a)};f.prototype.rr=function(a){var b=this.$a.be(),c=this.Cd.jh();this.UR(b,c);-1!=a&&this.Cd.addElement(c,a);return b};f.prototype.RA=function(a,b){this.Cd.addElement(this.lh(a),
b)};f.prototype.Ns=function(a){this.$a.Jc(a);a=this.Mg.Qs(a);0<=a&&this.Mg.QE(a)};f.prototype.yi=function(b,c){if(-1==this.Uf(b,0))this.zy(b,0,c);else if(-1==this.Uf(b,1))this.zy(b,1,c);else throw a.g.wa();this.Av(b,c)};f.prototype.Av=function(a,b){var c=this.fk(b);if(-1!=c){var e=this.Go(c,b);this.Sp(e,b,a);this.Qp(a,b,e);this.Qp(c,b,a);this.Sp(a,b,c)}else this.Sp(a,b,a),this.Qp(a,b,a),this.dm(b,a)};f.prototype.Do=function(a,b){return this.Uf(a,0)==b?0:1};f.prototype.Tl=function(a,b){var c=this.nw(b);
-1!=c&&(this.Ue.kd(c,-1),this.Hr(b,-1));var e,c=this.fk(b);if(-1!=c){var d=e=c,f;do{f=!1;var g=this.Do(e,b),p=this.FC(e,g);if(this.Uf(e,g+1&1)==a){this.Os(e);this.Cd.Fg(this.lh(e));this.Ns(e);if(e==p){c=-1;break}c==e&&(c=this.fk(b),d=p,f=!0)}e=p}while(e!=d||f);if(-1!=c){do g=this.Do(e,b),p=this.FC(e,g),this.zy(e,g,a),e=p;while(e!=d);e=this.fk(a);-1!=e?(d=this.Go(e,a),f=this.Go(c,a),d==e?(this.dm(a,c),this.Av(e,a),this.dm(a,e)):f==c&&this.Av(c,a),this.Qp(c,a,d),this.Sp(d,a,c),this.Qp(e,a,f),this.Sp(f,
a,e)):this.dm(a,c)}}c=this.rq(a);e=this.rq(b);for(d=this.Kg.gc(e);-1!=d;d=this.Kg.bb(d))this.a.lb(this.Kg.da(d),this.Yg,a);this.Kg.Qv(c,e);this.aM(b)};f.prototype.YP=function(a,b){var c=this.Uf(a,0),e=this.Uf(a,1),d=this.Uf(b,0),f=this.Uf(b,1);this.Cd.Qv(this.lh(a),this.lh(b));b==this.fk(c)&&this.dm(c,a);b==this.fk(e)&&this.dm(e,a);this.Os(b);this.Ns(b);c==d&&e==f||e==d&&c==f||(this.zm(c,this.mn),this.zm(d,this.Ck),this.mn.ub(this.Ck)?(c!=d&&this.Tl(c,d),e!=f&&this.Tl(e,f)):(e!=d&&this.Tl(e,d),c!=
f&&this.Tl(c,f)))};f.prototype.Os=function(a){var b=this.Uf(a,1);this.SB(a,this.Uf(a,0));this.SB(a,b)};f.prototype.SB=function(a,b){var c=this.Go(a,b),e=this.ZN(a,b),d=this.fk(b);c!=a?(this.Qp(e,b,c),this.Sp(c,b,e),d==a&&this.dm(b,c)):this.dm(b,-1)};f.prototype.YA=function(a,b,c){var e=this.Cd.gc(a),d=this.Cd.da(e);a=this.se(d);var f=this.se(this.a.X(d));this.a.Tp(d,b,c,!0);for(e=this.Cd.bb(e);-1!=e;e=this.Cd.bb(e)){var d=this.Cd.da(e),g=this.se(d)==a;this.a.Tp(d,b,c,g)}e=b.Io(c,0).Mb();b=b.Io(c,
b.kk(c)-1).oc();this.yG(a,e);this.yG(f,b)};f.prototype.PB=function(a,b,c){var e=this.lh(a),d=this.Uf(a,0),f=this.Uf(a,1),g=this.rr(-1);this.Mg.add(g);this.Nk(g,-3);this.sf.add(g);this.yi(g,d);a=1;for(b=b.kk(c);a<b;a++)c=this.Ul(-1),this.Hj.add(c),this.sf.add(c),this.yi(g,c),g=this.rr(-1),this.Mg.add(g),this.Nk(g,-3),this.sf.add(g),this.yi(g,c);this.yi(g,f);for(e=this.Cd.gc(e);-1!=e;e=this.Cd.bb(e))if(f=this.Cd.da(e),this.se(f)==d){a=0;do 0<a&&(g=this.sf.get(a-1),this.QA(g,f),-1==this.ow(g)&&this.Lp(g,
this.a.gb(f))),g=this.sf.get(a),a+=2,this.RA(g,f),f=this.a.X(f);while(a<this.sf.size)}else{a=this.sf.size-1;do a<this.sf.size-2&&(g=this.sf.get(a+1),this.QA(g,f),0>this.ow(g)&&this.Lp(g,this.a.gb(f))),g=this.sf.get(a),a-=2,this.RA(g,f),f=this.a.X(f);while(0<=a)}this.sf.clear(!1)};f.prototype.se=function(a){return this.a.Ra(a,this.Yg)};f.prototype.UE=function(b,c,e){var d=this.Uf(c,0),f=new a.b;this.zm(d,f);var g=new a.b,p=this.Uf(c,1);this.zm(p,g);var k=e.kk(b),h=e.Io(b,0),n=new a.b;h.ht(n);if(!f.ub(n)){if(!this.og){var q=
f.compare(this.Xg),n=n.compare(this.Xg);0>q*n&&(this.og=!0)}this.lC(d,this.sf);this.Hj.add(d)}!this.og&&1<k&&(q=f.compare(g),h=h.oc(),f.compare(h)!=q||h.compare(g)!=q?this.og=!0:0>h.compare(this.Xg)&&(this.og=!0));h=e.Io(b,k-1);b=h.oc();g.ub(b)||(this.og||(q=g.compare(this.Xg),n=b.compare(this.Xg),0>q*n&&(this.og=!0)),this.lC(p,this.sf),this.Hj.add(p));this.sf.add(c);g=0;for(p=this.sf.size;g<p;g++)b=this.sf.get(g),e=this.Eo(b),a.Fc.Zw(e)&&(this.zc.kd(e,-1),this.Nk(b,-1)),b!=c&&-3!=this.Eo(b)&&(this.Mg.add(b),
this.Nk(b,-3));this.sf.clear(!1)};f.prototype.NK=function(a,b){this.Ld.compare(this.zc,this.zc.da(a),b);this.Ld.Zf&&(this.Ld.lq(),this.dC(a,b))};f.prototype.dC=function(b,c){this.Nm=!0;b=this.zc.da(b);c=this.zc.da(c);var e,d;d=this.Cd.Dm(this.lh(b));var f=this.Cd.Dm(this.lh(c));e=this.a.cc(d);null==e&&(null==this.Vd&&(this.Vd=new a.yb),this.a.Oc(d,this.Vd),e=this.Vd);d=this.a.cc(f);null==d&&(null==this.Kl&&(this.Kl=new a.yb),this.a.Oc(f,this.Kl),d=this.Kl);this.Lj.zn(e);this.Lj.zn(d);this.Lj.Ga(this.ka,
!0)&&(this.og=!0);this.fG(b,c,-1,this.Lj);this.Lj.clear()};f.prototype.VM=function(b,c){this.Nm=!0;c=this.zc.da(c);var e,d=this.Cd.Dm(this.lh(c));e=this.a.cc(d);null==e&&(null==this.Vd&&(this.Vd=new a.yb),this.a.Oc(d,this.Vd),e=this.Vd);d=this.qC(b);this.Lj.zn(e);this.a.Jk(d,this.Zm);this.Lj.Tw(this.ka,this.Zm,!0);this.fG(c,-1,b,this.Lj);this.Lj.clear()};f.prototype.DO=function(){if(0!=this.Mg.size)for(;0!=this.Mg.size;){if(this.Mg.size>Math.max(100,this.a.pd)){this.Mg.clear(!1);this.og=!0;break}var a=
this.Mg.tc();this.Mg.af();this.Nk(a,-1);-1!=this.TO(a)&&this.CO(a);this.Mm=!1}};f.prototype.CO=function(a){var b;this.Mm?(b=this.zc.vs(this.lE,this.iE,a,!0),this.Mm=!1):b=this.zc.PA(a);-1==b?this.YP(this.zc.da(this.zc.tC()),a):(this.Nk(a,b),this.Ld.Zf&&(this.Ld.lq(),this.dC(this.Ld.Cl,b)))};f.prototype.TO=function(b){var c=this.Uf(b,0);b=this.Uf(b,1);this.zm(c,this.mn);this.zm(b,this.Ck);if(a.b.Zb(this.mn,this.Ck)<=this.Tx)return this.og=!0,-1;var e=this.mn.compare(this.Xg),d=this.Ck.compare(this.Xg);
return 0>=e&&0<d?b:0>=d&&0<e?c:-1};f.prototype.HM=function(){var b=new a.ga(0);b.xb(this.a.pd);for(var c=this.a.Gp(),e=c.next();-1!=e;e=c.next())-1!=this.a.Ra(e,this.Yg)&&b.add(e);this.a.Mu(b,b.size);this.IM(b)};f.prototype.IM=function(c){this.Ue.clear();this.Ue.de(c.size);this.Ue.Hn(new b(this.a));var e=new a.b;e.Eh();for(var d=-1,f=new a.b,g=0,p=c.size;g<p;g++){var k=c.get(g);this.a.uc(k,f);f.ub(e)?(k=this.a.Ra(k,this.Yg),this.Tl(d,k)):(d=this.se(k),this.a.uc(k,e),k=this.Ue.qm(k),this.Hr(d,k))}};
f.prototype.JM=function(){var b=new a.ga(0);b.xb(this.a.pd);for(var c=this.Ue.gc(-1);-1!=c;c=this.Ue.bb(c))b.add(this.Ue.da(c));this.Ue.clear();this.a.Mu(b,b.size);for(var c=0,e=b.size;c<e;c++){var d=b.get(c),f=this.se(d),d=this.Ue.qm(d);this.Hr(f,d)}};f.prototype.lC=function(b,c){var e=this.fk(b);if(-1!=e){var d=e;do a.Fc.Zw(this.Eo(d))&&c.add(d),d=this.Go(d,b);while(d!=e)}};f.prototype.yG=function(a,b){for(a=this.Kg.gc(this.rq(a));-1!=a;a=this.Kg.bb(a))this.a.Yi(this.Kg.da(a),b)};f.prototype.fG=
function(a,b,c,e){this.Os(a);-1!=b&&this.Os(b);this.UE(0,a,e);-1!=b&&this.UE(1,b,e);-1!=c&&(e.nf.w(this.mn),this.zm(c,this.Ck),this.Ck.ub(this.mn)||this.Hj.add(c));c=0;for(var d=this.Hj.size;c<d;c++){var f=this.Hj.get(c),g=this.nw(f);-1!=g&&(this.Ue.kd(g,-1),this.Hr(f,-1))}c=this.lh(a);d=-1!=b?this.lh(b):-1;this.YA(c,e,0);-1!=b&&this.YA(d,e,1);this.PB(a,e,0);-1!=b&&this.PB(b,e,1);this.Cd.Fg(c);this.Ns(a);-1!=b&&(this.Cd.Fg(d),this.Ns(b));c=0;for(d=this.Hj.size;c<d;c++)f=this.Hj.get(c),f==this.rp&&
(this.Ht=!0),g=this.nw(f),-1==g&&(g=this.Ue.PA(this.qC(f)),-1==g?(a=this.se(this.Ue.da(this.Ue.tC())),this.Tl(a,f)):this.Hr(f,g));this.Hj.clear(!1)};f.prototype.zm=function(a,b){this.a.SC(this.ow(a),b)};f.prototype.qC=function(a){return this.Kg.Dm(this.rq(a))};f.prototype.Xy=function(){this.Ht=!1;this.rp=-1;null==this.Ld&&(this.zc.Ct=!1,this.Ld=new e(this),this.zc.Qm=this.Ld);var b=new a.ga(0),f=null,g=null,p=0;this.iE=this.lE=-1;this.Mm=!1;for(var k=this.Ue.gc(-1);-1!=k;){p++;this.Mm=!1;var h=this.Ue.da(k);
this.rp=this.se(h);this.a.uc(h,this.Xg);this.Ld.XF(this.Xg.y,this.Xg.x);var n,q=this.fk(this.rp);n=-1==q;if(!n){h=q;do{var l=this.Eo(h);-1==l?(this.Mg.add(h),this.Nk(h,-3)):-3!=l&&b.add(l);h=this.Go(h,this.rp)}while(h!=q)}if(0<b.size){this.Mm=1==b.size&&1==this.Mg.size;n=0;for(q=b.size;n<q;n++)h=this.zc.da(b.get(n)),this.Nk(h,-2);var r=-2,t=-2;n=0;for(q=b.size;n<q;n++){l=b.get(n);if(-2==r){var u=this.zc.ge(l);-1!=u?(h=this.zc.da(u),h=this.Eo(h),-2!=h&&(r=u)):r=-1}-2==t&&(l=this.zc.bb(l),-1!=l?(h=
this.zc.da(l),h=this.Eo(h),-2!=h&&(t=l)):t=-1);if(-2!=r&&-2!=t)break}n=0;for(q=b.size;n<q;n++)l=b.get(n),h=this.zc.da(l),this.zc.kd(l,-1),this.Nk(h,-1);b.clear(!1);this.lE=-1!=r?r:-1;this.iE=-1!=t?t:-1;-1!=r&&-1!=t?this.Mm||this.NK(r,t):-1==r&&-1==t&&(this.Mm=!1)}else n&&(null==f&&(f=new d(this)),f.bh(this.Xg),this.zc.sF(f),f.Zf&&(f.lq(),this.VM(this.rp,f.Cl)));this.DO();this.Ht?(this.Ht=!1,null==g&&(g=new c(this.a)),g.bh(this.Xg),k=this.Ue.sF(g)):k=this.Ue.bb(k)}return this.Nm};f.prototype.Op=function(b){this.a=
b;this.Yg=this.a.re();this.$a.de(b.pd+32);this.nd.de(b.pd);this.Kg.Dr(b.pd);this.Kg.$l(b.pd);this.Cd.Dr(b.pd+32);this.Cd.$l(b.pd+32);for(b=this.a.$c;-1!=b;b=this.a.we(b))if(a.T.Kc(this.a.Lb(b)))for(k=this.a.Vb(b);-1!=k;k=this.a.bc(k)){var c=this.a.Ha(k),e=this.a.Cb(k),d=this.Ul(e),f=this.rr(e);this.yi(f,d);h=this.a.X(e);e=0;for(c-=2;e<c;e++){var g=this.a.X(h),p=this.Ul(h);this.yi(f,p);f=this.rr(h);this.yi(f,p);h=g}this.a.vc(k)?(p=this.Ul(h),this.yi(f,p),f=this.rr(h),this.yi(f,p),this.yi(f,d)):(p=
this.Ul(h),this.yi(f,p))}else for(var k=this.a.Vb(b);-1!=k;k=this.a.bc(k))for(var h=this.a.Cb(k),d=0,c=this.a.Ha(k);d<c;d++)this.Ul(h),h=this.a.X(h);this.HM()};return f}();a.aA=f})(z||(z={}));(function(a){var b=function(b){function c(c,e,d){b.call(this);if(void 0!==c)if(void 0!==d){this.description=a.Od.Tf();var f=new a.ee;f.K(c,e,d);this.Py(f)}else if(void 0!==e)this.description=a.Od.Tf(),this.ic(c,e);else if(c instanceof a.pa)this.description=c;else if(c instanceof a.b)this.description=a.Od.Tf(),
this.ic(c);else throw a.g.N();else this.description=a.Od.Tf()}w(c,b);c.prototype.w=function(b){if(void 0!==b){if(this.sc())throw a.g.ra("This operation should not be performed on an empty geometry.");b.ma(this.fa[0],this.fa[1])}else{if(this.sc())throw a.g.ra("This operation should not be performed on an empty geometry.");b=new a.b;b.ma(this.fa[0],this.fa[1]);return b}};c.prototype.ic=function(a,b){"number"===typeof a?(this.qc(),null==this.fa&&this.ko(),this.fa[0]=a,this.fa[1]=b):(this.qc(),this.ic(a.x,
a.y))};c.prototype.Lw=function(){if(this.sc())throw a.g.ra("This operation should not be performed on an empty geometry.");var b=new a.ee;b.x=this.fa[0];b.y=this.fa[1];this.description.WC()?b.z=this.fa[2]:b.z=a.pa.ue(1);return b};c.prototype.Py=function(b){this.qc();var c=this.hasAttribute(1);c||a.pa.nD(1,b.z)||(this.Ne(1),c=!0);null==this.fa&&this.ko();this.fa[0]=b.x;this.fa[1]=b.y;c&&(this.fa[2]=b.z)};c.prototype.lk=function(){if(this.sc())throw a.g.ra("This operation should not be performed on an empty geometry.");
return this.fa[0]};c.prototype.qS=function(a){this.setAttribute(0,0,a)};c.prototype.mk=function(){if(this.sc())throw a.g.ra("This operation should not be performed on an empty geometry.");return this.fa[1]};c.prototype.$F=function(a){this.setAttribute(0,1,a)};c.prototype.lO=function(){return this.ld(1,0)};c.prototype.rS=function(a){this.setAttribute(1,0,a)};c.prototype.NN=function(){return this.ld(2,0)};c.prototype.bS=function(a){this.setAttribute(2,0,a)};c.prototype.Qc=function(){return this.nC(3,
0)};c.prototype.ld=function(b,c){var e=this.description.zf(b);return 0<=e?this.fa[this.description.fj(e)+c]:a.pa.ue(b)};c.prototype.nC=function(b,c){var e=this.description.zf(b);return 0<=e?this.fa[this.description.fj(e)+c]:a.pa.ue(b)};c.prototype.setAttribute=function(a,b,c){this.qc();var e=this.description.zf(a);0>e&&(this.Ne(a),e=this.description.zf(a));null==this.fa&&this.ko();this.fa[this.description.fj(e)+b]=c};c.prototype.D=function(){return 33};c.prototype.fb=function(){return 0};c.prototype.Ja=
function(){this.qc();null!=this.fa&&(this.fa[0]=NaN,this.fa[1]=NaN)};c.prototype.nm=function(b){if(null!=this.fa){for(var c=a.Od.iu(b,this.description),e=[],d=0,f=0,g=b.Aa;f<g;f++){var p=b.Hd(f),k=a.pa.Wa(p);if(-1==c[f])for(var h=a.pa.ue(p),p=0;p<k;p++)e[d]=h,d++;else for(h=this.description.fj(c[f]),p=0;p<k;p++)e[d]=this.fa[h],d++,h++}this.fa=e}this.description=b};c.prototype.ko=function(){this.iF(this.description.le.length);c.ob(this.description.le,this.fa,this.description.le.length);this.fa[0]=
NaN;this.fa[1]=NaN};c.prototype.Oe=function(b){if(b instanceof a.Bg){if(!this.sc()){var c=this.w();b.Zi(c,c);this.ic(c)}}else this.sc()||(this.Ne(1),c=this.Lw(),this.Py(b.Qn(c)))};c.prototype.copyTo=function(b){if(33!=b.D())throw a.g.N();b.qc();null==this.fa?(b.Ja(),b.fa=null,b.Qf(this.description)):(b.Qf(this.description),b.iF(this.description.le.length),c.ob(this.fa,b.fa,this.description.le.length))};c.prototype.Pa=function(){return new c(this.description)};c.prototype.s=function(){return this.sc()};
c.prototype.sc=function(){return null==this.fa||isNaN(this.fa[0])||isNaN(this.fa[1])};c.prototype.Fp=function(a){a.Ja();this.description!=a.description&&a.Qf(this.description);a.Db(this)};c.prototype.o=function(a){this.sc()?a.Ja():(a.v=this.fa[0],a.C=this.fa[1],a.B=this.fa[0],a.G=this.fa[1])};c.prototype.Cn=function(a){if(this.sc())a.Ja();else{var b=this.Lw();a.v=b.x;a.C=b.y;a.Je=b.z;a.B=b.x;a.G=b.y;a.ig=b.z}};c.prototype.Ah=function(b,c){var e=new a.Nd;if(this.sc())return e.Ja(),e;b=this.ld(b,c);
e.qa=b;e.va=b;return e};c.prototype.iF=function(b){if(null==this.fa)this.fa=a.I.Lh(b);else if(this.fa.length<b){for(var c=this.fa.slice(0),e=this.fa.length;e<b;e++)c[e]=0;this.fa=c}};c.ob=function(a,b,c){if(0<c)for(c=0;c<a.length;c++)b[c]=a[c]};c.prototype.lc=function(a){if(a==this)return!0;if(!(a instanceof c)||this.description!=a.description)return!1;if(this.sc())return a.sc()?!0:!1;for(var b=0,e=this.description.le.length;b<e;b++)if(this.fa[b]!=a.fa[b])return!1;return!0};c.prototype.hc=function(){var b=
this.description.hc();if(!this.sc())for(var c=0,e=this.description.le.length;c<e;c++)var d=this.fa[c],d=a.I.truncate(d^d>>>32),b=a.I.kg(d,b);return b};c.prototype.Rf=function(){return null};return c}(a.T);a.Va=b})(z||(z={}));(function(a){var b=function(){function a(a,b,c){void 0!==a&&(this.x=a,this.y=b,this.z=c)}a.Oa=function(b,c,e){var d=new a;d.x=b;d.y=c;d.z=e;return d};a.prototype.K=function(a,b,c){this.x=a;this.y=b;this.z=c};a.prototype.Lu=function(){this.z=this.y=this.x=0};a.prototype.normalize=
function(){var a=this.length();0==a&&(this.x/=a,this.y/=a,this.z/=a)};a.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};a.prototype.sub=function(b){return new a(this.x-b.x,this.y-b.y,this.z-b.z)};a.prototype.Ap=function(b){return new a(this.x*b,this.y*b,this.z*b)};a.prototype.FA=function(){this.x=NaN};a.prototype.pv=function(){return isNaN(this.x)};return a}();a.ee=b})(z||(z={}));(function(a){var b=function(){function b(a,b,c){this.gu=this.Yt=null;this.Gf=
b;this.KP=b.y-c;this.JP=b.y+c;this.xp=0;this.ix=a;this.ka=c;this.UP=c*c;this.jx=0!=c;this.xt=!1}b.prototype.result=function(){return 0!=this.xp?1:0};b.prototype.DJ=function(b){b=b.Kb(b.Gd(this.Gf,!1));return a.b.Zb(b,this.Gf)<=this.UP?!0:!1};b.prototype.WB=function(a){if(!this.jx&&(this.ix&&this.Gf.ub(a.Mb())||this.Gf.ub(a.oc())))this.xt=!0;else if(a.ja==this.Gf.y&&a.ja==a.ha){if(this.ix&&!this.jx){var b=Math.max(a.na,a.la);this.Gf.x>Math.min(a.na,a.la)&&this.Gf.x<b&&(this.xt=!0)}}else{var c=!1,b=
Math.max(a.na,a.la);this.Gf.x>b?c=!0:this.Gf.x>=Math.min(a.na,a.la)&&(c=0<a.nt(!0,this.Gf.y,this.gu,null)&&this.gu[0]<=this.Gf.x);if(c){if(this.Gf.y==a.Mb().y){if(this.Gf.y<a.oc().y)return}else if(this.Gf.y==a.oc().y&&this.Gf.y<a.Mb().y)return;this.xp=this.ix?this.xp^1:this.xp+(a.Mb().y>a.oc().y?1:-1)}}};b.prototype.zr=function(a){var b=a.Ah(0,1);if(b.qa>this.JP||b.va<this.KP)return!1;if(this.jx&&this.DJ(a))return!0;if(b.qa>this.Gf.y||b.va<this.Gf.y)return!1;null==this.Yt&&(this.Yt=[null,null,null,
null,null]);null==this.gu&&(this.gu=[0,0,0]);b=a.TC(this.Yt);if(0<b)for(a=0;a<b;a++){var c=this.Yt[a].get();this.WB(c);if(this.xt)return!0}else if(this.WB(a),this.xt)return!0;return!1};b.V=function(a,c,e){c=new b(0==a.Cm(),c,e);for(a=a.Ca();a.kb();)for(;a.La();)if(e=a.ia(),c.zr(e))return-1;return c.result()};b.Bd=function(c,e,d,f){var g=new a.i;c.dd(g);g.P(f,f);var k=new b(0==c.Cm(),d,f);c=c.Ca();var p=new a.i;p.K(g);p.B=d.x+f;p.C=d.y-f;p.G=d.y+f;d=e.xw(p,f);for(f=d.next();-1!=f;f=d.next())if(c.Sb(e.da(f)),
c.La()&&(f=c.ia(),k.zr(f)))return-1;return k.result()};b.xl=function(c,e,d){if(c.s())return 0;var f=new a.i;c.dd(f);f.P(d,d);if(!f.contains(e))return 0;f=c.pb;if(null!=f){var g=f.hi;if(null!=g){g=g.Kk(e.x,e.y);if(1==g)return 1;if(0==g)return 0}f=f.Ab;if(null!=f)return b.Bd(c,f,e,d)}return b.V(c,e,d)};b.aP=function(c,e,d,f){if(c.s())return 0;var g=new a.i;c.dd(g);g.P(f,f);if(!g.contains(e,d))return 0;g=c.pb;if(null!=g&&(g=g.hi,null!=g)){g=g.Kk(e,d);if(1==g)return 1;if(0==g)return 0}return b.V(c,a.b.Oa(e,
d),f)};b.$O=function(a,c,e){return c.s()?0:b.xl(a,c.w(),e)};b.vD=function(c,e,d,f,g){var k=new a.i;c.dd(k);k.P(f,f);if(!k.contains(d))return 0;var p=new b(!0,d,f);if(null!=g){var h=new a.i;h.K(k);h.B=d.x+f;h.C=d.y-f;h.G=d.y+f;c=c.Ca();f=g.xw(h,f);for(h=f.next();-1!=h;h=f.next())if(c.Sb(g.da(h),e),c.La()&&c.Qa==e&&(h=c.ia(),p.zr(h)))return-1}else if(c=c.Ca(),c.vy(e),c.kb())for(;c.La();)if(h=c.ia(),p.zr(h))return-1;return p.result()};b.tD=function(c,e,d){var f=new a.i;c.dd(f);f.P(d,d);if(!f.contains(e))return 0;
e=new b(!1,e,d);for(d=c.Ca();d.kb();)if(!(0>c.oo(d.Qa))){for(e.xp=0;d.La();)if(f=d.ia(),e.zr(f))return-1;if(0!=e.xp)return 1}return e.result()};b.$i=function(c,e,d,f,g){var k=c.Ca();k.vy(e);if(!k.kb()||!k.La())throw a.g.ra("corrupted geometry");for(e=2;2==e&&k.La();)e=k.ia().Kb(.5),e=b.vD(c,d,e,f,g);if(2==e)throw a.g.ra("internal error");return 1==e?!0:!1};b.An=function(a,b){a=a.F();return 16>a?!1:2*a+Math.log(a)/Math.log(2)*1*b<1*a*b};return b}();a.ff=b})(z||(z={}));(function(a){var b=function(a){function b(b){a.call(this,
!0,b)}w(b,a);b.prototype.Pa=function(){return new b(this.description)};b.prototype.fb=function(){return 2};b.prototype.D=function(){return 1736};return b}(a.al);a.Ka=b})(z||(z={}));(function(a){(function(a){a[a.PiPOutside=0]="PiPOutside";a[a.PiPInside=1]="PiPInside";a[a.PiPBoundary=2]="PiPBoundary"})(a.pI||(a.pI={}));var b=function(){function b(){}b.uD=function(b,c,e){b=a.ff.$O(b,c,e);return 0==b?0:1==b?1:2};b.he=function(b,c,e){b=a.ff.xl(b,c,e);return 0==b?0:1==b?1:2};b.CH=function(b,c,e,d){b=a.ff.aP(b,
c,e,d);return 0==b?0:1==b?1:2};b.gU=function(b,c,e,d){return 0==a.ff.vD(b,c,e,d,null)?0:1};b.tD=function(b,c,e){return 0==a.ff.tD(b,c,e)?0:1};b.ZS=function(c,e,d,f,g){if(e.length<d||g.length<d)throw a.g.N();for(var k=0;k<d;k++)g[k]=b.he(c,e[k],f)};b.eT=function(c,e,d,f,g){if(e.length/2<d||g.length<d)throw a.g.N();for(var k=0;k<d;k++)g[k]=b.CH(c,e[2*k],e[2*k+1],f)};b.nG=function(c,e,d,f,g){if(1736==c.D())b.ZS(c,e,d,f,g);else if(197==c.D()){var k=new a.i;c.o(k);b.jP(k,e,d,f,g)}else throw a.g.ra("invalid_call");
};b.nU=function(c,e,d,f,g){if(1736==c.D())b.eT(c,e,d,f,g);else if(197==c.D()){var k=new a.i;c.o(k);b.mP(k,e,d,f,g)}else throw a.g.xa();};b.jP=function(b,c,e,d,f){if(c.length<e||f.length<e)throw a.g.N();if(b.s())for(d=0;d<e;d++)f[d]=0;else for(b.P(.5*-d,.5*-d),b.P(.5*d,.5*d),d=0;d<e;d++)b.contains(c[d])?f[d]=1:b.contains(c[d])?f[d]=2:f[d]=0};b.mP=function(b,c,e,d,f){if(c.length/2<e||f.length<e)throw a.g.N();if(b.s())for(d=0;d<e;d++)f[d]=0;else for(b.P(.5*-d,.5*-d),b.P(.5*d,.5*d),d=0;d<e;d++)b.contains(c[2*
d],c[2*d+1])?f[d]=1:b.contains(c[2*d],c[2*d+1])?f[d]=2:f[d]=0};b.lT=function(a,b,c,e,d){for(var f=0;f<c;f++)d[f]=a.Eq(b[f],e)?2:0};b.hT=function(a,b,c,e,d){var f=a.pb,g=null;null!=f&&(g=f.hi);for(var f=c,k=0;k<c;k++)if(d[k]=1,null!=g){var p=b[k];0==g.Kk(p.x,p.y)&&(d[k]=0,f--)}if(0!=f)for(a=a.Ca();a.kb()&&0!=f;)for(;a.La()&&0!=f;)for(g=a.ia(),k=0;k<c&&0!=f;k++)1==d[k]&&g.Eq(b[k],e)&&(d[k]=2,f--);for(k=0;k<c;k++)1==d[k]&&(d[k]=0)};b.oG=function(c,e,d,f,g){var k=c.D();if(1607==k)b.hT(c,e,d,f,g);else if(a.T.Lc(k))b.lT(c,
e,d,f,g);else throw a.g.ra("Invalid call.");};return b}();a.gd=b})(z||(z={}));(function(a){var b=function(a){function b(b,c){2==arguments.length?(a.call(this,!1,b.description),this.df(b),this.lineTo(c)):a.call(this,!1,b)}w(b,a);b.prototype.Pa=function(){return new b(this.description)};b.prototype.fb=function(){return 1};b.prototype.D=function(){return 1607};return b}(a.al);a.Xa=b})(z||(z={}));(function(a){var b=function(){function a(){}a.GT=function(){};return a}();a.RT=b})(z||(z={}));(function(a){var b=
function(){function b(){}b.Rv=function(a){return a*b.rQ};b.aG=function(a,c){return b.cR(c-a)};b.kR=function(b){if(-360<=b&&720>b)return 0>b?b+=360:360<=b&&(b-=360),b;b=a.vi.gH(b);0>b&&(b+=360);return b};b.cR=function(a){a=b.kR(a);180<a&&(a-=360);return a};b.OT=.0174532925199433;b.rQ=57.29577951308232;return b}(),c=function(){function c(){}c.qo=function(b,c){var e=new a.i;b.o(e);var d=a.Ya.Fm(c),f=new a.i;f.K(d);f.v=e.v;f.B=e.B;f.P(.01*f.ba(),0);d=a.Ia.zd(c,e,!1);return f.contains(e)?b:a.Ed.clip(b,
f,d,0)};c.Rw=function(b,e,d,f){if(!a.Ya.Qo(e))throw a.g.N();var g=a.Ia.Cg(e,b,!1),k=a.Ya.Fm(e),p=a.Ya.Em(e),h=p.Se().Dj,n=a.Ya.ft(p),p=a.Ya.Ts(p),n=n*(2-n),q=new a.Nd;k.wu(q);var l=[[0,0],[0,0]];2==a.Nf.Am(e)?(l[0][0]=c.pu(f,q),l[0][1]=k.Vs(),a.Ya.tu(),k=l[0][0]*h):k=f*h;var r=new a.ca,t=new a.fd;b=t.Eb(b);for(var u=[0],w=new a.b,v=new a.b,A=new a.b,x=new a.b,m=new a.b,y=new a.b,z=t.Vb(b);-1!=z;z=t.bc(z)){var K=t.Cb(z);t.w(K,A);for(var E=!1,C=K=t.X(K);-1!=C;C=t.X(C)){if(C==K){if(E)break;E=!0}t.w(C,
x);if((g<f-A.x&&x.x-f>g||g<f-x.x&&A.x-f>g||g<-x.y&&A.y>g)&&!(Math.abs(A.x-x.x)>=.5*q.aa())&&(2==a.Nf.Am(e)?(l[0][0]=c.pu(A.x,q),l[0][1]=A.y,l[1][0]=c.pu(x.x,q),l[1][1]=x.y,a.Ya.YQ(),m.x=l[0][0]*h,m.y=l[0][1]*h,y.x=l[1][0]*h,y.y=l[1][1]*h):(m.x=A.x*h,m.y=A.y*h,y.x=x.x*h,y.y=x.y*h),y.x=6.283185307179586*(x.x-A.x)/q.aa()+m.x,v.x=k,v.y=c.yH(p,n,m,y,k,d),!isNaN(v.y))){a.zb.Rd(p,n,m.x,m.y,y.x,y.y,r,null,null,d);var B=r.l;a.zb.Rd(p,n,m.x,m.y,v.x,v.y,r,null,null,d);var H=r.l;2==a.Nf.Am(e)?(l[0][0]=v.x/h,
l[0][1]=v.y/h,a.Ya.qN(),w.y=l[0][1],w.x=f):(w.x=f,w.y=v.y/h);u[0]=0<B?a.I.Kr(H/B,0,1):.5;0!=u[0]&&1!=u[0]&&(B=t.Ua(C),t.Mr(B,u,1),t.ic(t.X(B),w.x,w.y))}A.J(x)}}return t.hf(b)};c.aN=function(b,e,d){if(b.s())return b;var f=a.Ya.IC(e);return c.gC(b,0-180*f,360*f,e,d)};c.yH=function(b,e,d,f,g,k){if(3.141592653589793<=Math.abs(d.x-f.x)||!c.Jv(d.x,f.x,g))return NaN;var p;d.x>f.x?p=f:(p=d,d=f);f=new a.ca(0);var h=new a.ca(0),n=new a.ca(0);a.zb.Rd(b,e,p.x,p.y,d.x,d.y,h,f,null,k);var q=h.l,l=0,r=1,t=new a.b;
for(t.J(p);q*(r-l)>1E-12*b;){var u=.5*(l+r);a.zb.dk(b,e,p.x,p.y,q*u,f.l,h,n,k);t.x=h.l;t.y=n.l;if(t.x==g)break;if(c.Jv(p.x,t.x,g))r=u;else if(c.Jv(d.x,t.x,g))l=u;else return NaN}return t.y};c.Jv=function(a,c,e){a=b.Rv(a);c=b.aG(a,b.Rv(c));e=b.aG(a,b.Rv(e));return 0==e||0<c&&0<e&&e<=c||0>c&&0>e&&e>=c?!0:!1};c.pu=function(a,b){var c=b.va-b.qa;return b.Sy(a-Math.floor((a-b.qa)/c)*c)};c.eU=function(b,c,e,d){var f=new a.Nd;f.K(c,e);e=d.aa();b=Math.floor((b-c)/e)*e+b;for(f=f.Af();Math.abs(b-f)>Math.abs(b+
e-f);)b+=e;return b};c.cU=function(b,c,e,d,f){var g;e.y>d.y?g=d:(g=e,e=d);d=new a.Nd;d.K(g.y,e.y);if(!d.contains(0)||3.141592653589793<=Math.abs(g.x-e.x))return NaN;if(g.x==e.x)return g.x;var k=new a.ca(0),p=new a.ca(0),h=new a.ca(0);a.zb.Rd(b,c,g.x,g.y,e.x,e.y,p,k,null,f);var n=p.l,q=0,l=1,r=new a.b;for(r.J(g);n*(l-q)>1E-12*b;){var t=.5*(q+l);a.zb.dk(b,c,g.x,g.y,n*t,k.l,p,h,f);r.x=p.l;r.y=h.l;d.K(g.y,r.y);if(0==r.y)break;if(d.contains(0))l=t;else if(d.K(e.y,r.y),d.contains(0))q=t;else return NaN}return r.x};
c.gC=function(b,c,e,d,f){var g=new a.i;b.o(g);if(g.s())return b;var k=new a.Nd;g.wu(k);var p=new a.Nd;p.K(c,c+e);if(p.contains(k)&&p.va!=k.va)return b;var h=new a.i;h.K(g);var n=b.D();if(33==n){h=f?b:b.vm();g=h.lk();if(g<p.qa||g>=p.va||g==p.va)g+=Math.ceil((p.qa-g)/e)*e,g=p.Sy(g),h.qS(g);return h}if(550==n){h=f?b:b.vm();d=h.mc(0);n=2*h.F();b=!1;for(f=0;f<n;f+=2)if(g=d.read(f),g<p.qa||g>=p.va||g==p.va)b=!0,g+=Math.ceil((p.qa-g)/e)*e,g=p.Sy(g),d.write(f,g);b&&h.ce(1993);return h}if(p.contains(k))return b;
if(197==n)return e=f?b:b.vm(),g.Ga(h),e.Cu(g),e;var q=.1*Math.max(g.ba(),g.aa());h.P(0,q);p=b;b=d.Ko();f=a.wi.local();for(var l=new a.Bg,r=0;;){var t=Math.floor((k.qa-c)/e),u=Math.ceil((k.va-c)/e);if(3<u-t){t=Math.floor(.5*(u+t));h.v=g.v-q;h.B=c+e*t;var w=a.Ed.clip(p,h,b,0);h.v=h.B;h.B=g.B+q;var v=a.Ed.clip(p,h,b,0);l.Nn((t-u)*e,0);v.Oe(l);1736==n?p=f.$(w,v,d,null):(p=w,p.add(v,!1));p.o(g);g.wu(k);r++}else break}h.v=c;h.B=c+e;c=new a.i;c.K(h);c.P(b,0);c=Math.floor((g.v-h.v)/e)*e;0!=c?(h.move(c,0),
l.Nn(-c,0)):l.IF();c=1607==n?new a.Xa(p.description):new a.Ka(p.description);k=new a.i;for(q=new a.i;g.B>h.v;){r=a.Ed.clip(p,h,b,0);r.o(q);if(1607==n?!r.s()&&(q.aa()>b||q.ba()>b):!r.s()&&(1736!=n||q.aa()>b))r.Oe(l),r.o(q),c.o(k),k.P(b,b),k.jc(q)&&1736==n?c=f.$(c,r,d,null):c.add(r,!1);h.move(e,0);l.shift(-e,0)}return c};c.ZQ=function(b,c,e,d){var f=new a.pe(e.description);f.Pd(e,0,-1);var f=a.Ya.Wl(f,b,c),g=e.F();d.Ja();if(!a.Ya.Qo(b)||g!=f.F())return!1;var k=new a.i;e.o(k);var p=new a.i;f.o(p);k=
k.aa();p=p.aa();if(0!=k&&0!=p){if(p/=k,b=a.Ya.Fm(c).aa()/a.Ya.Fm(b).aa(),1E-10<Math.abs(p/b-1))return!1}else if(0!=k||0!=p)return!1;d.add(e,!1);for(e=0;e<g;e++)b=f.Fa(e),d.ic(e,b);return!0};c.dU=function(){throw a.g.qe();};return c}();a.gh=c})(z||(z={}));(function(a){(function(a){a[a.rightSide=1]="rightSide"})(a.sI||(a.sI={}));var b=function(){function b(b,c,e){this.Nq=new a.b;void 0===b?this.tn=-1:(this.Nq.J(b),this.tn=c,this.Da=e,this.Ut=0)}b.prototype.UF=function(a){this.Ut=a?this.Ut|1:this.Ut&
-2};b.prototype.s=function(){return 0>this.tn};b.prototype.pw=function(){if(this.s())throw a.g.ra("invalid call");return new a.Va(this.Nq.x,this.Nq.y)};b.prototype.gb=function(){if(this.s())throw a.g.ra("invalid call");return this.tn};b.prototype.sw=function(){if(this.s())throw a.g.ra("invalid call");return this.Da};b.prototype.Xw=function(){return 0!=(this.Ut&1)};b.prototype.tv=function(a,b,c,e){this.Nq.x=a;this.Nq.y=b;this.tn=c;this.Da=e};return b}();a.dl=b})(z||(z={}));(function(a){var b=function(){function b(){}
b.prototype.Fn=function(b,c){this.Vg.resize(0);this.ai.length=0;this.Aj=-1;b.dd(this.Kj);this.Kj.P(c,c);this.Kj.jc(this.Ab.Qb)?((this.Iq=a.T.Lc(b.D()))?(this.rE=b.Mb(),this.qE=b.oc(),this.ka=c):this.ka=NaN,this.Vg.add(this.Ab.Ze),this.ai.push(this.Ab.Qb),this.ar=this.Ab.sq(this.Ab.Ze)):this.ar=-1};b.prototype.Ch=function(a,b){this.Vg.resize(0);this.ai.length=0;this.Aj=-1;this.Kj.K(a);this.Kj.P(b,b);this.ka=NaN;this.Kj.jc(this.Ab.Qb)?(this.Vg.add(this.Ab.Ze),this.ai.push(this.Ab.Qb),this.ar=this.Ab.sq(this.Ab.Ze),
this.Iq=!1):this.ar=-1};b.prototype.next=function(){if(0==this.Vg.size)return-1;this.Aj=this.ar;var b=null,e=null,d,f=null,g=null;this.Iq&&(b=new a.b,e=new a.b,f=new a.i);for(var k=!1;!k;){for(;-1!=this.Aj;){d=this.Ab.kw(this.Ab.Us(this.Aj));if(d.jc(this.Kj))if(this.Iq){if(b.J(this.rE),e.J(this.qE),f.K(d),f.P(this.ka,this.ka),0<f.Nv(b,e)){k=!0;break}}else{k=!0;break}this.Aj=this.Ab.at(this.Aj)}if(-1==this.Aj){d=this.Vg.tc();var h=this.ai[this.ai.length-1];null==g&&(g=[],g[0]=new a.i,g[1]=new a.i,
g[2]=new a.i,g[3]=new a.i);c.BF(h,g);this.Vg.af();--this.ai.length;for(h=0;4>h;h++){var n=this.Ab.zo(d,h);if(-1!=n&&0<this.Ab.gO(n)&&g[h].jc(this.Kj))if(this.Iq){if(b.J(this.rE),e.J(this.qE),f.K(g[h]),f.P(this.ka,this.ka),0<f.Nv(b,e)){var q=new a.i;q.K(g[h]);this.Vg.add(n);this.ai.push(q)}}else q=new a.i,q.K(g[h]),this.Vg.add(n),this.ai.push(q)}if(0==this.Vg.size)return-1;this.Aj=this.Ab.sq(this.Vg.get(this.Vg.size-1))}}this.ar=this.Ab.at(this.Aj);return this.Aj};b.HL=function(c,e,d){var f=new b;
f.Ab=c;f.Kj=new a.i;f.Vg=new a.ga(0);f.ai=[];f.Fn(e,d);return f};b.GL=function(c,e,d){var f=new b;f.Ab=c;f.Kj=new a.i;f.Vg=new a.ga(0);f.ai=[];f.Ch(e,d);return f};b.FL=function(c){var e=new b;e.Ab=c;e.Kj=new a.i;e.Vg=new a.ga(0);e.ai=[];return e};return b}();a.TT=b;var c=function(){function c(b,c){this.Ye=new a.Fc(11);this.qh=new a.Fc(5);this.Jq=[];this.Rt=new a.ga(0);this.Qb=new a.i;this.Rj(b,c)}c.prototype.reset=function(a,b){this.Ye.Nh(!1);this.qh.Nh(!1);this.Jq.length=0;this.Rt.clear(!1);this.Rj(a,
b)};c.prototype.lg=function(a,b){return this.lt(a,b,0,this.Qb,this.Ze,!1,-1)};c.prototype.kt=function(a,b,c){c=-1==c?this.Ze:this.KC(c);var e=this.ba(c),d=this.CN(c);return this.lt(a,b,e,d,c,!1,-1)};c.prototype.da=function(a){return this.yN(a)};c.prototype.uC=function(a){return this.kw(this.Us(a))};c.prototype.ba=function(a){return this.Xs(a)};c.prototype.CN=function(b){var c=new a.i;c.K(this.Qb);var e=this.Xs(b);b=this.EC(b);for(var d=0;d<2*e;d+=2){var f=a.I.truncate(3&b>>d);0==f?(c.v=.5*(c.v+c.B),
c.C=.5*(c.C+c.G)):1==f?(c.B=.5*(c.v+c.B),c.C=.5*(c.C+c.G)):(2==f?c.B=.5*(c.v+c.B):c.v=.5*(c.v+c.B),c.G=.5*(c.C+c.G))}return c};c.prototype.gO=function(a){return this.Kw(a)};c.prototype.KN=function(a,c){return b.HL(this,a,c)};c.prototype.xw=function(a,c){return b.GL(this,a,c)};c.prototype.Re=function(){return b.FL(this)};c.prototype.Rj=function(b,c){if(0>c||32<2*c)throw a.g.N("invalid height");this.GP=c;this.Qb.K(b);this.Ze=this.Ye.be();this.Ku(this.Ze,0);this.Eu(this.Ze,0);this.LF(this.Ze,0);this.HF(this.Ze,
0)};c.prototype.lt=function(b,e,d,f,g,k,h){if(!f.contains(e))return 0==d?-1:this.lt(b,e,0,this.Qb,this.Ze,k,h);if(!k)for(var p=g;-1!=p;p=this.UN(p))this.Ku(p,this.Kw(p)+1);p=new a.i;p.K(f);f=g;var n=[];n[0]=new a.i;n[1]=new a.i;n[2]=new a.i;for(n[3]=new a.i;d<this.GP&&this.IK(f);d++){c.BF(p,n);for(var q=!1,l=0;4>l;l++)if(n[l].contains(e)){var q=!0,r=this.zo(f,l);-1==r&&(r=this.OL(f,l));this.Ku(r,this.Kw(r)+1);f=r;p.K(n[l]);break}if(!q)break}return this.zO(b,e,d,p,f,k,g,h)};c.prototype.zO=function(a,
b,c,e,d,f,g,k){var p=this.AC(d);if(f){if(d==g)return k;this.mM(k);f=k}else f=this.QL(),this.By(f,a),this.IR(this.Us(f),b);this.gS(f,d);-1!=p?(this.Ju(f,p),this.Fu(p,f)):this.DF(d,f);this.Fy(d,f);this.Eu(d,this.Zs(d)+1);this.HK(d)&&this.$M(c,e,d);return f};c.prototype.mM=function(a){var b=this.KC(a),c=this.AC(b),e=this.$N(a),d=this.at(a);this.sq(b)==a?(-1!=d?this.Ju(d,-1):this.Fy(b,-1),this.DF(b,d)):c==a?(this.Fu(e,-1),this.Fy(b,e)):(this.Ju(d,e),this.Fu(e,d));this.Ju(a,-1);this.Fu(a,-1);this.Eu(b,
this.Zs(b)-1)};c.BF=function(a,b){var c=.5*(a.v+a.B),e=.5*(a.C+a.G);b[0].K(c,e,a.B,a.G);b[1].K(a.v,e,c,a.G);b[2].K(a.v,a.C,c,e);b[3].K(c,a.C,a.B,e)};c.prototype.HK=function(a){return 8==this.Zs(a)&&!this.VC(a)};c.prototype.$M=function(a,b,c){var e,d,f=this.sq(c);do d=this.Us(f),e=this.qh.O(f,0),d=this.kw(d),this.lt(e,d,a,b,c,!0,f),f=e=this.at(f);while(-1!=f)};c.prototype.IK=function(a){return 8<=this.Zs(a)||this.VC(a)};c.prototype.VC=function(a){return-1!=this.zo(a,0)||-1!=this.zo(a,1)||-1!=this.zo(a,
2)||-1!=this.zo(a,3)};c.prototype.OL=function(a,b){var c=this.Ye.be();this.MR(a,b,c);this.Ku(c,0);this.Eu(c,0);this.Tj(c,a);this.HF(c,this.Xs(a)+1);this.LF(c,b<<2*this.Xs(a)|this.EC(a));return c};c.prototype.QL=function(){var b=this.qh.be(),c;0<this.Rt.size?(c=this.Rt.tc(),this.Rt.af()):(c=this.Jq.length,this.Jq.push(new a.i));this.JR(b,c);return b};c.prototype.zo=function(a,b){return this.Ye.O(a,b)};c.prototype.MR=function(a,b,c){this.Ye.L(a,b,c)};c.prototype.sq=function(a){return this.Ye.O(a,4)};
c.prototype.DF=function(a,b){this.Ye.L(a,4,b)};c.prototype.AC=function(a){return this.Ye.O(a,5)};c.prototype.Fy=function(a,b){this.Ye.L(a,5,b)};c.prototype.EC=function(a){return this.Ye.O(a,6)};c.prototype.LF=function(a,b){this.Ye.L(a,6,b)};c.prototype.Zs=function(a){return this.Ye.O(a,7)};c.prototype.Kw=function(a){return this.Ye.O(a,8)};c.prototype.Eu=function(a,b){this.Ye.L(a,7,b)};c.prototype.Ku=function(a,b){this.Ye.L(a,8,b)};c.prototype.UN=function(a){return this.Ye.O(a,9)};c.prototype.Tj=function(a,
b){this.Ye.L(a,9,b)};c.prototype.Xs=function(a){return this.Ye.O(a,10)};c.prototype.HF=function(a,b){this.Ye.L(a,10,b)};c.prototype.yN=function(a){return this.qh.O(a,0)};c.prototype.By=function(a,b){this.qh.L(a,0,b)};c.prototype.$N=function(a){return this.qh.O(a,1)};c.prototype.at=function(a){return this.qh.O(a,2)};c.prototype.Ju=function(a,b){this.qh.L(a,1,b)};c.prototype.Fu=function(a,b){this.qh.L(a,2,b)};c.prototype.KC=function(a){return this.qh.O(a,3)};c.prototype.gS=function(a,b){this.qh.L(a,
3,b)};c.prototype.Us=function(a){return this.qh.O(a,4)};c.prototype.JR=function(a,b){this.qh.L(a,4,b)};c.prototype.kw=function(a){return this.Jq[a]};c.prototype.IR=function(a,b){this.Jq[a].K(b)};return c}();a.co=c})(z||(z={}));(function(a){(function(a){a[a.Outside=0]="Outside";a[a.Inside=1]="Inside";a[a.Border=2]="Border"})(a.wH||(a.wH={}));var b=function(){function a(a,b){this.Hg=null;this.SP=b;this.Hg=a}a.prototype.Bu=function(a,b){this.PD!=b&&a.flush();this.PD=b};a.prototype.XB=function(a,b){for(var c=
0;c<b;)for(var e=a[c++],d=a[c++],f=a[c++]*this.SP;e<d;e++)this.Hg[f+(e>>4)]|=this.PD<<2*(e&15)};return a}();a.VT=b;var c=function(){function c(a,b,c){this.Hg=null;this.Qx=this.Sx=this.zE=this.xE=this.Qq=this.VD=this.tf=this.Pl=0;this.ii=this.Nj=this.sk=null;this.jt(a,b,c)}c.create=function(b,e,d){if(!c.Cc(b))throw a.g.N();return c.Id(b,e,d)};c.ti=function(b,e,d){if(!c.Cc(b))throw a.g.N();return c.ye(b,e,d)};c.jR=function(b){switch(b){case 0:b=1024;break;case 1:b=16384;break;case 2:b=262144;break;
default:throw a.g.ra("Internal Error");}return b};c.Cc=function(a){return a.s()||1607!=a.D()&&1736!=a.D()?!1:!0};c.prototype.KM=function(b,c){c=c.Ca();for(var e=new a.b,d=new a.b;c.kb();)for(;c.La();){var f=c.ia();if(322!=f.D())throw a.g.ra("Internal Error");b.Zi(f.Mb(),e);b.Zi(f.oc(),d);this.ii.zv(e.x,e.y,d.x,d.y)}this.ii.fF(a.ev.$u)};c.prototype.LM=function(){throw a.g.ra("Internal Error");};c.prototype.cw=function(b,c){for(var e=1;4>e;e++)b.zv(c[e-1].x,c[e-1].y,c[e].x,c[e].y);b.zv(c[3].x,c[3].y,
c[0].x,c[0].y);this.ii.fF(a.ev.$u)};c.prototype.kG=function(b,c,e){for(var d=[null,null,null,null],f=0;f<d.length;f++)d[f]=new a.b;c=c.Ca();e=this.Nj.TS(e)+1.5;for(var f=new a.b,g=new a.b,k=new a.b,p=new a.b,h=new a.b,n=new a.i,q=new a.b;c.kb();){var l=!1,r=!0;for(q.ma(0,0);c.La();){var t=c.ia();p.x=t.na;p.y=t.ja;h.x=t.la;h.y=t.ha;n.Ja();n.Db(p.x,p.y);n.Oj(h.x,h.y);if(this.sk.rD(n)){this.Nj.Zi(h,h);r?(this.Nj.Zi(p,p),q.J(p),r=!1):p.J(q);f.pc(h,p);var t=f.length(),u=.5>t;0==t?f.ma(1,0):(u||q.J(h),
f.scale(e/t),g.ma(-f.y,f.x),k.ma(f.y,-f.x),p.sub(f),h.add(f),d[0].add(p,g),d[1].add(p,k),d[2].add(h,k),d[3].add(h,g),u?l=!0:this.cw(b,d))}else l&&(this.cw(b,d),l=!1),r=!0}l&&this.cw(b,d)}};c.prototype.fz=function(b){return a.I.truncate(b*this.VD+this.xE)};c.prototype.gz=function(b){return a.I.truncate(b*this.Qq+this.zE)};c.Id=function(a,b,e){return new c(a,b,e)};c.ye=function(a,b,e){return new c(a,b,e)};c.prototype.jt=function(c,e,d){this.tf=Math.max(a.I.truncate(2*Math.sqrt(d)+.5),64);this.Pl=a.I.truncate((2*
this.tf+31)/32);this.sk=new a.i;this.Sx=e;d=0;for(var f=this.tf,g=this.Pl;8<=f;)d+=f*g,f=a.I.truncate(f/2),g=a.I.truncate((2*f+31)/32);this.Hg=a.I.Lh(d,0);this.ii=new a.ev;d=new b(this.Hg,this.Pl,this);this.ii.vS(this.tf,this.tf,d);c.o(this.sk);this.sk.P(e,e);var f=new a.i,g=a.i.Oa(1,1,this.tf-2,this.tf-2),k=e*g.aa();e*=g.ba();f.K(this.sk.Af(),Math.max(k,this.sk.aa()),Math.max(e,this.sk.ba()));this.Qx=this.Sx;this.Nj=new a.Bg;this.Nj.wO(f,g);new a.Bg;switch(c.D()){case 550:d.Bu(this.ii,2);this.LM();
break;case 1607:d.Bu(this.ii,2);this.kG(this.ii,c,this.Qx);break;case 1736:d.Bu(this.ii,1),this.KM(this.Nj,c),d.Bu(this.ii,2),this.kG(this.ii,c,this.Qx)}this.VD=this.Nj.mb;this.Qq=this.Nj.eb;this.xE=this.Nj.Nb;this.zE=this.Nj.Ob;this.BK()};c.prototype.BK=function(){this.ii.flush();for(var b=0,c=this.tf*this.Pl,e=this.tf,d=a.I.truncate(this.tf/2),f=this.Pl,g=a.I.truncate((2*d+31)/32);8<e;){for(e=0;e<d;e++)for(var k=2*e,h=2*e+1,n=0;n<d;n++){var q=2*n,l=2*n+1,r=q>>4,q=2*(q&15),t=l>>4,l=2*(l&15),u=this.Hg[b+
f*k+r]>>q&3,u=u|this.Hg[b+f*k+t]>>l&3,u=u|this.Hg[b+f*h+r]>>q&3,u=u|this.Hg[b+f*h+t]>>l&3;this.Hg[c+g*e+(n>>4)]|=u<<2*(n&15)}e=d;f=g;b=c;d=a.I.truncate(e/2);g=a.I.truncate((2*d+31)/32);c=b+f*e}};c.prototype.Kk=function(a,b){if(!this.sk.contains(a,b))return 0;a=this.fz(a);b=this.gz(b);if(0>a||a>=this.tf||0>b||b>=this.tf)return 0;a=this.Hg[this.Pl*b+(a>>4)]>>2*(a&15)&3;return 0==a?0:1==a?1:2};c.prototype.Dn=function(b){if(!b.Ga(this.sk))return 0;var c=this.fz(b.v),e=this.fz(b.B),d=this.gz(b.C);b=this.gz(b.G);
0>c&&(c=0);0>d&&(d=0);e>=this.tf&&(e=this.tf-1);b>=this.tf&&(b=this.tf-1);if(c>e||d>b)return 0;for(var f=Math.max(e-c,1)*Math.max(b-d,1),g=0,k=this.Pl,h=this.tf,p=0;;){if(32>f||16>h){for(f=d;f<=b;f++)for(var n=c;n<=e;n++)if(p=this.Hg[g+k*f+(n>>4)]>>2*(n&15)&3,1<p)return 2;if(0==p)return 0;if(1==p)return 1}g+=k*h;h=a.I.truncate(h/2);k=a.I.truncate((2*h+31)/32);c=a.I.truncate(c/2);d=a.I.truncate(d/2);e=a.I.truncate(e/2);b=a.I.truncate(b/2);f=Math.max(e-c,1)*Math.max(b-d,1)}};c.prototype.cO=function(){return this.tf*
this.Pl};return c}();a.dA=c})(z||(z={}));(function(a){(function(a){a[a.contains=1]="contains";a[a.within=2]="within";a[a.equals=3]="equals";a[a.disjoint=4]="disjoint";a[a.touches=8]="touches";a[a.crosses=16]="crosses";a[a.overlaps=32]="overlaps";a[a.unknown=0]="unknown";a[a.intersects=1073741824]="intersects"})(a.zI||(a.zI={}));var b=function(){function a(){}a.Oa=function(b,c,e,d,f,g,k,h){var p=new a;p.Wt=b;p.Jl=c;p.Oi=e;p.ji=d;p.dE=f;p.tU=g;p.uU=k;p.vU=h;return p};return a}(),c=function(){function b(){}
b.vT=function(c,e,d){if(!b.pQ(c))return!1;var f=a.Ia.Cg(e,c,!1);e=!1;a.Wj.vB(c)&&(e=e||c.jv(f,d));f=c.D();1736!=f&&1607!=f||!a.Wj.tB(c)||0==d||(e=e||c.dj(d));1736!=f&&1607!=f||!a.Wj.uB(c)||0==d||(e=e||c.jJ());return e};b.pQ=function(b){return a.Wj.vB(b)||a.Wj.tB(b)||a.Wj.uB(b)};return b}();a.rT=c;c=function(){function c(){this.Tg=[]}c.qy=function(b,e,d,f,g){var k=b.D(),h=e.D();if(197==k){if(197==h)return c.AQ(b,e,d,f);if(33==h)return 2==f?f=1:1==f&&(f=2),c.Iz(e,b,d,f)}else if(33==k){if(197==h)return c.Iz(b,
e,d,f);if(33==h)return c.eR(b,e,d,f)}if(b.s()||e.s())return 4==f?!0:!1;var p=new a.i;b.o(p);var n=new a.i;e.o(n);var q=new a.i;q.K(p);q.Db(n);d=a.Ia.zd(d,q,!1);if(c.nj(p,n,d))return 4==f?!0:!1;p=!1;a.al.Lc(k)&&(k=new a.Xa(b.description),k.Bc(b,!0),b=k,k=1607);a.al.Lc(h)&&(h=new a.Xa(e.description),h.Bc(e,!0),e=h,h=1607);if(197!=k&&197!=h){if(b.fb()<e.fb()||33==k&&550==h)2==f?f=1:1==f&&(f=2)}else 1736!=k&&197!=h&&(2==f?f=1:1==f&&(f=2));switch(k){case 1736:switch(h){case 1736:p=c.vr(b,e,d,f,g);break;
case 1607:p=c.Vl(b,e,d,f,g);break;case 33:p=c.ur(b,e,d,f,g);break;case 550:p=c.tr(b,e,d,f,g);break;case 197:p=c.xD(b,e,d,f,g)}break;case 1607:switch(h){case 1736:p=c.Vl(e,b,d,f,g);break;case 1607:p=c.ey(b,e,d,f,g);break;case 33:p=c.xr(b,e,d,f,g);break;case 550:p=c.wr(b,e,d,f,g);break;case 197:p=c.WE(b,e,d,f)}break;case 33:switch(h){case 1736:p=c.ur(e,b,d,f,g);break;case 1607:p=c.xr(e,b,d,f,g);break;case 550:p=c.pr(e,b,d,f,g)}break;case 550:switch(h){case 1736:p=c.tr(e,b,d,f,g);break;case 1607:p=c.wr(e,
b,d,f,g);break;case 550:p=c.Wx(b,e,d,f,g);break;case 33:p=c.pr(b,e,d,f,g);break;case 197:p=c.oA(b,e,d,f)}break;case 197:switch(h){case 1736:p=c.xD(e,b,d,f,g);break;case 1607:p=c.WE(e,b,d,f);break;case 550:p=c.oA(e,b,d,f)}}return p};c.AQ=function(b,e,d,f){if(b.s()||e.s())return 4==f?!0:!1;var g=new a.i,k=new a.i,h=new a.i;b.o(g);e.o(k);h.K(g);h.Db(k);b=a.Ia.zd(d,h,!1);switch(f){case 4:return c.nj(g,k,b);case 2:return c.Bz(k,g,b);case 1:return c.Bz(g,k,b);case 3:return c.ye(g,k,b);case 8:return c.kT(g,
k,b);case 32:return c.fT(g,k,b);case 16:return c.cT(g,k,b)}return!1};c.Iz=function(b,e,d,f){if(b.s()||e.s())return 4==f?!0:!1;b=b.w();var g=new a.i,k=new a.i;e.o(g);k.K(b);k.Db(g);e=a.Ia.zd(d,k,!1);switch(f){case 4:return c.ru(b,g,e);case 2:return c.bx(b,g,e);case 1:return c.YL(b,g,e);case 3:return c.KA(b,g,e);case 8:return c.ax(b,g,e)}return!1};c.eR=function(b,e,d,f){if(b.s()||e.s())return 4==f?!0:!1;b=b.w();e=e.w();var g=new a.i;g.K(b);g.Db(e);d=a.Ia.zd(d,g,!1);switch(f){case 4:return c.rM(b,e,
d);case 2:return c.hz(e,b,d);case 1:return c.hz(b,e,d);case 3:return c.dB(b,e,d)}return!1};c.vr=function(a,b,e,d,f){switch(d){case 4:return c.dT(a,b,e);case 2:return c.su(b,a,e,f);case 1:return c.su(a,b,e,f);case 3:return c.TG(a,b,e);case 8:return c.vH(a,b,e);case 32:return c.bH(a,b,e,f)}return!1};c.Vl=function(a,b,e,d,f){switch(d){case 4:return c.gT(a,b,e);case 1:return c.dy(a,b,e,f);case 8:return c.zH(a,b,e,f);case 16:return c.lR(a,b,e)}return!1};c.ur=function(a,b,e,d){switch(d){case 4:return c.YS(a,
b,e);case 1:return c.qQ(a,b,e);case 8:return c.lH(a,b,e)}return!1};c.tr=function(a,b,e,d){switch(d){case 4:return c.OS(a,b,e);case 1:return c.hQ(a,b,e);case 8:return c.iH(a,b,e);case 16:return c.dR(a,b,e)}return!1};c.xD=function(a,b,e,d,f){if(c.ER(a,b,e))return 4==d?!0:!1;if(4==d)return!1;switch(d){case 2:return c.DH(a,b,e);case 1:return c.WP(a,b,e);case 3:return c.OG(a,b,e);case 8:return c.eH(a,b,e,f);case 32:return c.WG(a,b,e,f);case 16:return c.zQ(a,b,e,f)}return!1};c.ey=function(a,b,e,d){switch(d){case 4:return c.EI(a,
b,e);case 2:return c.JE(b,a,e);case 1:return c.JE(a,b,e);case 3:return c.QI(a,b,e);case 8:return c.cF(a,b,e);case 32:return c.$I(a,b,e);case 16:return c.LE(a,b,e)}return!1};c.xr=function(a,b,e,d){switch(d){case 4:return c.yI(a,b,e);case 1:return c.KH(a,b,e);case 8:return c.MG(a,b,e)}return!1};c.wr=function(a,b,e,d){switch(d){case 4:return c.vI(a,b,e);case 1:return c.IH(a,b,e);case 8:return c.fJ(a,b,e);case 16:return c.QH(a,b,e)}return!1};c.WE=function(a,b,e,d){if(c.nI(a,b,e))return 4==d?!0:!1;if(4==
d)return!1;switch(d){case 2:return c.WJ(a,b,e);case 1:return c.GH(a,b,e);case 3:return c.MI(a,b,e);case 8:return c.cJ(a,b,e);case 32:return c.XI(a,b,e);case 16:return c.MH(a,b,e)}return!1};c.Wx=function(a,b,e,d){switch(d){case 4:return c.xI(a,b,e);case 2:return c.kA(b,a,e);case 1:return c.kA(a,b,e);case 3:return c.LI(a,b,e);case 32:return c.bJ(a,b,e)}return!1};c.pr=function(a,b,e,d){switch(d){case 4:return c.lA(a,b,e);case 2:return c.HJ(a,b,e);case 1:return c.PH(a,b,e);case 3:return c.mu(a,b,e)}return!1};
c.oA=function(a,b,e,d){switch(d){case 4:return c.uI(a,b,e);case 2:return c.LG(a,b,e);case 1:return c.LH(a,b,e);case 3:return c.DI(a,b,e);case 8:return c.eJ(a,b,e);case 16:return c.mI(a,b,e)}return!1};c.TG=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);if(!c.ye(f,g,d))return!1;f=c.fc(b,e,!1);if(4==f||1==f||2==f)return!1;if(c.jA(b,e,d))return!0;f=b.$b();g=e.$b();return Math.abs(f-g)>4*Math.max(b.F(),e.F())*d?!1:c.Vv(b,e,d,!0)};c.dT=function(a,b,e){var d=c.fc(a,b,!0);return 4==d?!0:1==d||2==d||
1073741824==d?!1:c.ZC(a,b,e)};c.vH=function(a,b,e){var d=c.fc(a,b,!1);return 4==d||1==d||2==d?!1:c.AE(a,b,e,null)};c.bH=function(a,b,e,d){var f=c.fc(a,b,!1);return 4==f||1==f||2==f?!1:c.wD(a,b,e,d)};c.su=function(b,e,d,f){var g=new a.i,k=new a.i;b.o(g);e.o(k);if(!c.rc(g,k,d))return!1;g=c.fc(b,e,!1);return 4==g||2==g?!1:1==g?!0:c.bC(b,e,d,f)};c.gT=function(a,b,e){var d=c.fc(a,b,!0);return 4==d?!0:1==d||1073741824==d?!1:c.ZC(a,b,e)};c.zH=function(a,b,e,d){var f=c.fc(a,b,!1);return 4==f||1==f?!1:c.CE(a,
b,e,d)};c.lR=function(a,b,e){var d=c.fc(a,b,!1);return 4==d||1==d?!1:c.YC(a,b,e,null)};c.dy=function(b,e,d,f){var g=new a.i,k=new a.i;b.o(g);e.o(k);if(!c.rc(g,k,d))return!1;g=c.fc(b,e,!1);return 4==g?!1:1==g?!0:c.jC(b,e,d,f)};c.YS=function(b,c,e){return 0==a.gd.uD(b,c,e)?!0:!1};c.lH=function(a,b,e){b=b.w();return c.yD(a,b,e)};c.qQ=function(a,b,e){b=b.w();return c.YB(a,b,e)};c.OS=function(b,e,d){var f=c.fc(b,e,!1);if(4==f)return!0;if(1==f)return!1;f=new a.i;b.o(f);f.P(d,d);for(var g=new a.b,k=0;k<
e.F();k++)if(e.w(k,g),f.contains(g)){var h=a.gd.he(b,g,d);if(1==h||2==h)return!1}return!0};c.iH=function(b,c,e){var d=this.fc(b,c,!1);if(4==d||1==d)return!1;d=new a.i;b.o(d);d.P(e,e);var f,g=!1,k;k=b;for(var h=!1,p=0;p<c.F();p++){f=c.Fa(p);if(d.contains(f))if(f=a.gd.he(k,f,e),2==f)g=!0;else if(1==f)return!1;h||(!a.ff.An(b,c.F()-1)||null!=b.pb&&null!=b.pb.Ab?k=b:(k=new a.Ka,b.copyTo(k),k.dj(1)),h=!0)}return g?!0:!1};c.dR=function(b,c,e){var d=this.fc(b,c,!1);if(4==d||1==d)return!1;var f=new a.i,d=
new a.i,g=new a.i;b.o(f);c.o(g);d.K(f);d.P(e,e);var g=f=!1,k,h;h=b;for(var p=!1,n=0;n<c.F();n++){k=c.Fa(n);d.contains(k)?(k=a.gd.he(h,k,e),0==k?g=!0:1==k&&(f=!0)):g=!0;if(f&&g)return!0;p||(!a.ff.An(b,c.F()-1)||null!=b.pb&&null!=b.pb.Ab?h=b:(h=new a.Ka,b.copyTo(h),h.dj(1)),p=!0)}return!1};c.hQ=function(b,c,e){var d=new a.i,f=new a.i;b.o(d);c.o(f);if(!this.rc(d,f,e))return!1;f=this.fc(b,c,!1);if(4==f)return!1;if(1==f)return!0;var f=!1,g,k;k=b;for(var h=!1,p=0;p<c.F();p++){g=c.Fa(p);if(!d.contains(g))return!1;
g=a.gd.he(k,g,e);if(1==g)f=!0;else if(0==g)return!1;h||(!a.ff.An(b,c.F()-1)||null!=b.pb&&null!=b.pb.Ab?k=b:(k=new a.Ka,b.copyTo(k),k.dj(1)),h=!0)}return f};c.OG=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);if(!c.ye(f,g,d))return!1;f=new a.Ka;f.Wc(e,!1);return c.Vv(b,f,d,!0)};c.ER=function(b,e,d){var f=c.fc(b,e,!1);if(4==f)return!0;if(1==f||2==f)return!1;var g=new a.i,f=new a.i;b.o(g);e.o(f);if(c.rc(f,g,d))return!1;g=new a.b;f.Yl(g);e=a.gd.he(b,g,d);if(0!=e)return!1;f.YE(g);e=a.gd.he(b,g,
d);if(0!=e)return!1;f.Zl(g);e=a.gd.he(b,g,d);if(0!=e)return!1;f.aF(g);e=a.gd.he(b,g,d);if(0!=e)return!1;e=b.mc(0);g=new a.i;g.K(f);g.P(d,d);for(var k=0,h=b.F();k<h;k++){var p=e.read(2*k),n=e.read(2*k+1);if(g.contains(p,n))return!1}return!c.cA(b,f,d)};c.eH=function(b,e,d,f){var g=c.fc(b,e,!1);if(4==g||1==g||2==g)return!1;var g=new a.i,k=new a.i;b.o(g);e.o(k);if(c.rc(k,g,d))return!1;if(k.aa()<=d&&k.ba()<=d)return e=e.qq(),c.yD(b,e,d);if(k.aa()<=d||k.ba()<=d)return g=new a.Xa,k=new a.Va,e.uf(0,k),g.df(k),
e.uf(2,k),g.lineTo(k),c.CE(b,g,d,f);g=new a.Ka;g.Wc(e,!1);return c.AE(b,g,d,f)};c.WG=function(b,e,d,f){var g=c.fc(b,e,!1);if(4==g||1==g||2==g)return!1;var g=new a.i,k=new a.i;b.o(g);e.o(k);if(c.rc(k,g,d)||k.aa()<=d||k.ba()<=d)return!1;g=new a.Ka;g.Wc(e,!1);return c.wD(b,g,d,f)};c.DH=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);return c.rc(g,f,d)};c.WP=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);if(!c.rc(f,g,d))return!1;f=c.fc(b,e,!1);if(4==f||2==f)return!1;if(1==f)return!0;if(g.aa()<=
d&&g.ba()<=d)return e=e.qq(),c.YB(b,e,d);if(g.aa()<=d||g.ba()<=d)return g=new a.Xa,f=new a.Va,e.uf(0,f),g.df(f),e.uf(2,f),g.lineTo(f),c.jC(b,g,d,null);g=new a.Ka;g.Wc(e,!1);return c.bC(b,g,d,null)};c.zQ=function(b,e,d,f){var g=new a.i,k=new a.i;b.o(g);e.o(k);if(c.rc(k,g,d)||k.ba()>d&&k.aa()>d||k.ba()<=d&&k.aa()<=d)return!1;g=new a.Xa;k=new a.Va;e.uf(0,k);g.df(k);e.uf(2,k);g.lineTo(k);return c.YC(b,g,d,f)};c.QI=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);return c.ye(f,g,d)&&4!=c.fc(b,e,!1)?
c.jA(b,e,d)?!0:c.Vv(b,e,d,!1):!1};c.EI=function(b,c,e){return 4==this.fc(b,c,!1)?!0:(new a.cl(b,c,e,!0)).next()?!this.ED(b,c,e):!1};c.cF=function(b,e,d){if(4==c.fc(b,e,!1))return!1;var f=new a.qd(0);if(0!=c.Zv(b,e,d,f))return!1;for(var g=new a.pe,k=0;k<f.size;k+=2){var h=f.read(k),p=f.read(k+1);g.zs(h,p)}b=b.Rf();e=e.Rf();b.Pd(e,0,e.F());return c.lu(b,g,d)};c.LE=function(b,e,d){if(4==c.fc(b,e,!1))return!1;var f=new a.qd(0);if(0!=c.Zv(b,e,d,f))return!1;for(var g=new a.pe,k=0;k<f.size;k+=2){var h=f.read(k),
p=f.read(k+1);g.zs(h,p)}b=b.Rf();e=e.Rf();b.Pd(e,0,e.F());return!c.lu(b,g,d)};c.$I=function(a,b,e){return 4==c.fc(a,b,!1)?!1:c.iA(a,b,e)};c.JE=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);return c.rc(f,g,d)&&4!=c.fc(b,e,!1)?c.Wf(e,b,d,!1):!1};c.yI=function(a,b,e){if(4==c.fc(a,b,!1))return!0;b=b.w();return!c.ex(a,b,e)};c.MG=function(a,b,e){if(4==c.fc(a,b,!1))return!1;b=b.w();return c.bw(a,b,e)};c.KH=function(a,b,e){if(4==c.fc(a,b,!1))return!1;b=b.w();return c.bA(a,b,e)};c.vI=function(a,b,
e){return 4==c.fc(a,b,!1)?!0:!c.eA(a,b,e,!1)};c.fJ=function(b,c,e){if(4==this.fc(b,c,!1))return!1;var d=b.Ca(),f=new a.i,g=new a.i,k=new a.i;b.o(f);c.o(g);f.P(e,e);g.P(e,e);k.K(f);k.Ga(g);var h,p,f=null;h=b.pb;null!=h?(p=h.Ab,f=h.nn,null==p&&(p=h=a.Ia.ij(b,k))):p=h=a.Ia.ij(b,k);var n=p.Re(),q=null;null!=f&&(q=f.Re());var l=new a.b,r=new a.b,t=!1,u=e*e,f=new a.Wk(c.F());for(h=0;h<c.F();h++)f.write(h,0);for(h=0;h<c.F();h++)if(c.w(h,l),k.contains(l))if(g.K(l.x,l.y,l.x,l.y),null==q||(q.Ch(g,e),-1!=q.next())){n.Ch(g,
e);for(var w=n.next();-1!=w;w=n.next())if(d.Sb(p.da(w)),w=d.ia(),w.Kb(w.Gd(l,!1),r),a.b.Zb(l,r)<=u){f.write(h,1);t=!0;break}}if(!t)return!1;b=b.Rf();d=new a.pe;g=new a.b;for(h=0;h<c.F();h++)0!=f.read(h)&&(c.w(h,g),d.zs(g.x,g.y));return this.lu(b,d,e)};c.QH=function(b,c,e){if(4==this.fc(b,c,!1))return!1;var d=b.Ca(),f=new a.i,g=new a.i,k=new a.i;b.o(f);c.o(g);f.P(e,e);g.P(e,e);k.K(f);k.Ga(g);var h,p,f=null;h=b.pb;null!=h?(p=h.Ab,f=h.nn,null==p&&(p=h=a.Ia.ij(b,k))):p=h=a.Ia.ij(b,k);var n=p.Re(),q=null;
null!=f&&(q=f.Re());var l=new a.b,r=new a.b,t=!1,u=!1,w=e*e,f=new a.Wk(c.F());for(h=0;h<c.F();h++)f.write(h,0);for(h=0;h<c.F();h++)if(c.w(h,l),k.contains(l))if(g.K(l.x,l.y,l.x,l.y),null!=q&&(q.Ch(g,e),-1==q.next()))u=!0;else{n.Ch(g,e);for(var v=!1,x=n.next();-1!=x;x=n.next())if(d.Sb(p.da(x)),x=d.ia(),x.Kb(x.Gd(l,!1),r),a.b.Zb(l,r)<=w){f.write(h,1);v=t=!0;break}v||(u=!0)}else u=!0;if(!t||!u)return!1;b=b.Rf();d=new a.pe;g=new a.b;for(h=0;h<c.F();h++)0!=f.read(h)&&(c.w(h,g),d.zs(g.x,g.y));return!this.lu(b,
d,e)};c.IH=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);if(!c.rc(f,g,d)||4==c.fc(b,e,!1)||!c.eA(b,e,d,!0))return!1;b=b.Rf();return!c.nA(b,e,d)};c.MI=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);return g.ba()>d&&g.aa()>d?!1:c.ye(f,g,d)};c.nI=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);return c.rc(g,f,d)?!1:!c.cA(b,g,d)};c.cJ=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);if(g.ba()<=d&&g.aa()<=d)return g=e.qq(),c.bw(b,g,d);if(g.ba()<=d||g.aa()<=d)return g=new a.Xa,
f=new a.Va,e.uf(0,f),g.df(f),e.uf(2,f),g.lineTo(f),c.cF(b,g,d);b=b.Ca();e=new a.i;f=new a.i;e.K(g);f.K(g);e.P(-d,-d);f.P(d,d);for(var g=!1,k=new a.i,h=new a.i;b.kb();)for(;b.La();){b.ia().o(k);h.K(e);h.Ga(k);if(!h.s()&&(h.ba()>d||h.aa()>d))return!1;h.K(f);h.Ga(k);h.s()||(g=!0)}return g};c.XI=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);if(c.rc(f,g,d)||c.rc(g,f,d)||c.rc(g,f,d)||g.ba()>d&&g.aa()>d||g.ba()<=d&&g.aa()<=d)return!1;f=new a.Xa;g=new a.Va;e.uf(0,g);f.df(g);e.uf(2,g);f.lineTo(g);
return c.iA(b,f,d)};c.WJ=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);if(!c.rc(g,f,d)||g.ba()<=d&&g.aa()<=d)return!1;if(g.ba()<=d||g.aa()<=d)return c.rc(g,f,d);b=b.Ca();e=new a.i;e.K(g);e.P(-d,-d);for(var g=!1,f=new a.i,k=new a.i;b.kb();)for(;b.La();)b.ia().o(f),e.jl(f)?g=!0:(k.K(e),k.Ga(f),!k.s()&&(k.ba()>d||k.aa()>d)&&(g=!0));return g};c.GH=function(b,e,d){var f=new a.i,g=new a.i;e.o(g);b.o(f);if(!c.rc(f,g,d)||g.ba()>d&&g.aa()>d)return!1;if(g.ba()<=d&&g.aa()<=d)return e=e.qq(),c.bA(b,e,
d);f=new a.Xa;g=new a.Va;e.uf(0,g);f.df(g);e.uf(2,g);f.lineTo(g);return c.Wf(f,b,d,!1)};c.MH=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);if(c.rc(g,f,d)||g.ba()<=d&&g.aa()<=d)return!1;if(g.ba()<=d||g.aa()<=d)return f=new a.Xa,g=new a.Va,e.uf(0,g),f.df(g),e.uf(2,g),f.lineTo(g),c.LE(b,f,d);b=b.Ca();e=new a.i;f=new a.i;f.K(g);e.K(g);f.P(-d,-d);e.P(d,d);for(var k=g=!1,h=new a.i,p=new a.i;b.kb();)for(;b.La();)if(b.ia().o(h),k||e.contains(h)||(k=!0),g||(p.K(f),p.Ga(h),!p.s()&&(p.ba()>d||p.aa()>
d)&&(g=!0)),g&&k)return!0;return!1};c.LI=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);return c.ye(f,g,d)?c.OI(b,e,d)?!0:c.Pw(b,e,d,!1,!0,!1):!1};c.xI=function(a,b,e){return!c.nA(a,b,e)};c.bJ=function(a,b,e){return c.Pw(a,b,e,!1,!1,!0)};c.kA=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);return c.rc(f,g,d)?c.Pw(e,b,d,!0,!1,!1):!1};c.lu=function(b,c,e){e*=e;for(var d=new a.b,f=new a.b,g=0;g<c.F();g++){c.w(g,f);for(var k=!1,h=0;h<b.F();h++)if(b.w(h,d),a.b.Zb(d,f)<=e){k=!0;break}if(!k)return!1}return!0};
c.mu=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);return c.ye(f,g,d)};c.lA=function(a,b,e){b=b.w();return c.or(a,b,e)};c.HJ=function(a,b,e){return c.mu(a,b,e)};c.PH=function(a,b,e){return!c.lA(a,b,e)};c.DI=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);return g.ba()>d||g.aa()>d?!1:c.ye(f,g,d)};c.uI=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);if(c.rc(g,f,d))return!1;e=new a.i;e.K(g);e.P(d,d);d=new a.b;for(g=0;g<b.F();g++)if(b.w(g,d),e.contains(d))return!1;return!0};c.eJ=function(b,
c,e){var d=new a.i,f=new a.i,g=new a.i;c.o(d);if(d.ba()<=e&&d.aa()<=e)return!1;if(d.ba()<=e||d.aa()<=e){c=new a.b;var k=!1;f.K(d);g.K(d);f.P(e,e);d.ba()>e?g.P(0,-e):g.P(-e,0);for(var h=0;h<b.F();h++)if(b.w(h,c),f.contains(c)){if(d.ba()>e){if(c.y>g.C&&c.y<g.G)return!1}else if(c.x>g.v&&c.x<g.B)return!1;k=!0}return k}f.K(d);g.K(d);f.P(e,e);g.P(-e,-e);c=new a.b;k=!1;for(h=0;h<b.F();h++)if(b.w(h,c),f.contains(c)){if(g.jl(c))return!1;k=!0}return k};c.LG=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);
if(!c.rc(g,f,d))return!1;if(g.ba()<=d&&g.aa()<=d)return c.ye(f,g,d);if(g.ba()<=d||g.aa()<=d){e=!1;var f=new a.i,k=new a.i;f.K(g);k.K(g);g.ba()>d?f.P(0,-d):f.P(-d,0);k.P(d,d);for(var h=new a.b,p=0;p<b.F();p++){b.w(p,h);if(!k.contains(h))return!1;g.ba()>d?h.y>f.C&&h.y<f.G&&(e=!0):h.x>f.v&&h.x<f.B&&(e=!0)}return e}e=!1;f=new a.i;k=new a.i;f.K(g);k.K(g);f.P(-d,-d);k.P(d,d);h=new a.b;for(p=0;p<b.F();p++){b.w(p,h);if(!k.contains(h))return!1;f.jl(h)&&(e=!0)}return e};c.LH=function(b,e,d){var f=new a.i,g=
new a.i;b.o(f);e.o(g);if(!c.rc(f,g,d)||g.ba()>d||g.aa()>d)return!1;e=e.qq();return!c.or(b,e,d)};c.mI=function(b,e,d){var f=new a.i,g=new a.i;b.o(f);e.o(g);if(c.rc(g,f,d)||g.ba()<=d&&g.aa()<=d)return!1;if(g.ba()<=d||g.aa()<=d){e=new a.i;f=new a.i;e.K(g);g.ba()>d?e.P(0,-d):e.P(-d,0);f.K(g);f.P(d,d);for(var k=new a.b,h=!1,p=!1,n=0;n<b.F();n++)if(b.w(n,k),h||(g.ba()>d?k.y>e.C&&k.y<e.G&&(h=!0):k.x>e.v&&k.x<e.B&&(h=!0)),p||f.contains(k)||(p=!0),h&&p)return!0;return!1}e=new a.i;f=new a.i;e.K(g);e.P(-d,-d);
f.K(g);f.P(d,d);k=new a.b;p=h=!1;for(n=0;n<b.F();n++)if(b.w(n,k),!h&&e.jl(k)&&(h=!0),p||f.contains(k)||(p=!0),h&&p)return!0;return!1};c.dB=function(b,c,e){return a.b.Zb(b,c)<=e*e?!0:!1};c.rM=function(b,c,e){return a.b.Zb(b,c)>e*e?!0:!1};c.hz=function(a,b,e){return c.dB(a,b,e)};c.KA=function(b,e,d){var f=new a.i;f.K(b);return c.ye(f,e,d)};c.ru=function(b,c,e){var d=new a.i;d.K(c);d.P(e,e);return!d.contains(b)};c.ax=function(b,c,e){if(c.ba()<=e&&c.aa()<=e)return!1;var d=new a.i,f=new a.i;d.K(c);d.P(e,
e);if(!d.contains(b))return!1;if(c.ba()<=e||c.aa()<=e){f.K(c);c.ba()>e?f.P(0,-e):f.P(-e,0);if(c.ba()>e){if(b.y>f.C&&b.y<f.G)return!1}else if(b.x>f.v&&b.x<f.B)return!1;return!0}f.K(c);f.P(-e,-e);return f.jl(b)?!1:!0};c.bx=function(b,c,e){if(c.ba()<=e&&c.aa()<=e)return!0;if(c.ba()<=e||c.aa()<=e){var d=new a.i;d.K(c);c.ba()>e?d.P(0,-e):d.P(-e,0);var f=!1;c.ba()>e?b.y>d.C&&b.y<d.G&&(f=!0):b.x>d.v&&b.x<d.B&&(f=!0);return f}d=new a.i;d.K(c);d.P(-e,-e);return d.jl(b)};c.YL=function(a,b,e){return c.KA(a,
b,e)};c.ye=function(a,b,e){return c.rc(a,b,e)&&c.rc(b,a,e)};c.nj=function(b,c,e){var d=new a.i;d.K(c);d.P(e,e);return!b.jc(d)};c.kT=function(b,e,d){if(b.ba()<=d&&b.aa()<=d){var f=b.Af();return c.ax(f,e,d)}if(e.ba()<=d&&e.aa()<=d)return f=e.Af(),c.ax(f,b,d);b.ba()>d&&b.aa()>d&&(e.ba()<=d||e.aa()<=d)?f=e:(f=b,b=e);if(f.ba()<=d||f.aa()<=d){if(b.ba()<=d||b.aa()<=d){e=new a.yb;var g=new a.yb,k=[0,0],h=[0,0],p=new a.b;f.Yl(p);e.ed(p);f.Zl(p);e.vd(p);b.Yl(p);g.ed(p);b.Zl(p);g.vd(p);e.Ga(g,null,k,h,d);return 1!=
e.Ga(g,null,null,null,d)?!1:0==k[0]||1==k[1]||0==h[0]||1==h[1]}e=new a.i;g=new a.i;e.K(b);e.P(-d,-d);g.K(e);g.Ga(f);return!g.s()&&(g.ba()>d||g.aa()>d)?!1:!0}b.P(d,d);g=new a.i;g.K(f);g.Ga(b);return g.s()||!g.s()&&g.ba()>d&&g.aa()>d?!1:!0};c.fT=function(b,e,d){if(c.rc(b,e,d)||c.rc(e,b,d)||b.ba()<=d&&b.aa()<=d||e.ba()<=d&&e.aa()<=d)return!1;if(b.ba()<=d||b.aa()<=d){if(e.ba()>d&&e.aa()>d)return!1;var f=new a.yb,g=new a.yb,k=[0,0],h=[0,0],p=new a.b;b.Yl(p);f.ed(p);b.Zl(p);f.vd(p);e.Yl(p);g.ed(p);e.Zl(p);
g.vd(p);f.Ga(g,null,k,h,d);return 2!=f.Ga(g,null,null,null,d)?!1:(0<k[0]||1>k[1])&&(0<h[0]||1>h[1])}if(e.ba()<=d||e.aa()<=d)return!1;f=new a.i;f.K(b);f.Ga(e);return f.s()||f.ba()<=d||f.aa()<=d?!1:!0};c.Bz=function(b,e,d){if(!c.rc(b,e,d))return!1;if(b.ba()<=d&&b.aa()<=d)return b=b.Af(),c.bx(b,e,d);if(e.ba()<=d&&e.aa()<=d)return e=e.Af(),c.bx(e,b,d);if(b.ba()<=d||b.aa()<=d)return c.rc(b,e,d);if(e.ba()<=d||e.aa()<=d){var f=new a.i;f.K(b);f.P(-d,-d);if(f.jl(e))return!0;b=new a.i;b.K(f);b.Ga(e);return b.s()||
b.ba()<=d&&b.aa()<=d?!1:!0}return c.rc(b,e,d)};c.cT=function(b,e,d){if(c.rc(b,e,d)||c.rc(e,b,d)||b.ba()<=d&&b.aa()<=d||e.ba()<=d&&e.aa()<=d||e.ba()>d&&e.aa()>d&&b.ba()>d&&b.aa()>d)return!1;var f;b.ba()>d&&b.aa()>d?f=e:(f=b,b=e);if(b.ba()>d&&b.aa()>d){e=new a.i;var g=new a.i;g.K(b);g.P(-d,-d);e.K(g);e.Ga(f);return e.s()||e.ba()<=d&&e.aa()<=d?!1:!0}e=new a.yb;var g=new a.yb,k=[0,0],h=[0,0],p=new a.b;f.Yl(p);e.ed(p);f.Zl(p);e.vd(p);b.Yl(p);g.ed(p);b.Zl(p);g.vd(p);e.Ga(g,null,k,h,d);return 1!=e.Ga(g,
null,null,null,d)?!1:0<k[0]&&1>k[1]&&0<h[0]&&1>h[1]};c.ZC=function(b,c,e){var d,f,g=new a.i,k=new a.i,h=new a.cl(b,c,e,!0);if(!h.next())return!0;if(this.ED(b,c,e))return!1;var p;p=b;var n;n=null;1736==c.D()&&(n=c);var q=!1,l=!1;do{d=h.jk();f=h.ek();f=c.Fa(c.Ea(f));g.K(h.Fw());g.P(e,e);if(g.contains(f)&&(f=a.gd.he(p,f,0),0!=f)||1736==c.D()&&(d=b.Fa(b.Ea(d)),k.K(h.jw()),k.P(e,e),k.contains(d)&&(f=a.gd.he(n,d,0),0!=f)))return!1;q||(!a.ff.An(b,c.ea()-1)||null!=b.pb&&null!=b.pb.Ab?p=b:(p=new a.Ka,b.copyTo(p),
p.dj(1)),q=!0);1736!=c.D()||l||(l=c,!a.ff.An(l,b.ea()-1)||null!=c.pb&&null!=c.pb.Ab?n=c:(n=new a.Ka,l.copyTo(n),n.dj(1)),l=!0)}while(h.next());return!0};c.rc=function(b,c,e){var d=new a.i;d.K(b);d.P(e,e);return d.contains(c)};c.lm=function(b,c,e){var d=new a.i;d.K(c);d.P(e,e);c=new a.b;b.Yl(c);if(!d.contains(c))return!0;b.YE(c);if(!d.contains(c))return!0;b.aF(c);if(!d.contains(c))return!0;b.Zl(c);return d.contains(c)?!1:!0};c.jA=function(b,c,e){if(b.ea()!=c.ea()||b.F()!=c.F())return!1;var d=new a.b,
f=new a.b,g=!0;e*=e;for(var k=0;k<b.ea();k++){if(b.Dc(k)!=c.Dc(k)){g=!1;break}for(var h=b.Ea(k);h<c.Dc(k);h++)if(b.w(h,d),c.w(h,f),a.b.Zb(d,f)>e){g=!1;break}if(!g)break}return g?!0:!1};c.OI=function(b,c,e){if(b.F()!=c.F())return!1;var d=new a.b,f=new a.b,g=!0;e*=e;for(var k=0;k<b.F();k++)if(b.w(k,d),c.w(k,f),a.b.Zb(d,f)>e){g=!1;break}return g?!0:!1};c.Pw=function(b,c,e,d,f,g){var k=!1,h;b.F()>c.F()?(d&&(d=!1,k=!0),h=c):(h=b,b=c);c=null;if(f||g||k){c=new a.Wk(b.F());for(var p=0;p<b.F();p++)c.write(p,
0)}var p=new a.i,n=new a.i,q=new a.i;h.o(p);b.o(n);p.P(e,e);n.P(e,e);q.K(p);q.Ga(n);for(var n=new a.b,l=new a.b,r=!0,t=a.Ia.oB(b,q),u=t.Re(),w=e*e,v=0;v<h.F();v++)if(h.w(v,n),q.contains(n)){var x=!1;p.K(n.x,n.y,n.x,n.y);u.Ch(p,e);for(var m=u.next();-1!=m&&!(m=t.da(m),b.w(m,l),a.b.Zb(n,l)<=w&&((f||g||k)&&c.write(m,1),x=!0,d));m=u.next());if(!x&&(r=!1,f||d))return!1}else{if(f||d)return!1;r=!1}if(g&&r)return!1;if(d)return!0;for(p=0;p<b.F();p++)if(1==c.read(p)){if(g)return!0}else if(f||k)return!1;return g?
!1:!0};c.nA=function(b,c,e){var d;b.F()>c.F()?d=c:(d=b,b=c);c=new a.i;var f=new a.i,g=new a.i;d.o(c);b.o(f);c.P(e,e);f.P(e,e);g.K(c);g.Ga(f);for(var f=new a.b,k=new a.b,h=e*e,p=a.Ia.oB(b,g),n=p.Re(),q=0;q<d.F();q++)if(d.w(q,f),g.contains(f)){c.K(f.x,f.y,f.x,f.y);n.Ch(c,e);for(var l=n.next();-1!=l;l=n.next())if(b.w(p.da(l),k),a.b.Zb(f,k)<=h)return!0}return!1};c.Vv=function(a,b,e,d){return c.Wf(a,b,e,d)&&c.Wf(b,a,e,d)};c.Wf=function(e,d,f,g){function k(a,b){return r.IB(a,b)}var h=!0,p=[0,0],n=[0,0],
q=0,l=new a.ga(0),r=new c,t,u=new a.i,w=new a.i,v=new a.i;e.o(u);d.o(w);u.P(f,f);w.P(f,f);v.K(u);v.Ga(w);e=e.Ca();var w=d.Ca(),x=null,m=x=null,A=d.pb;null!=A?(x=A.Ab,m=A.nn,null==x&&(x=a.Ia.ij(d,v))):x=a.Ia.ij(d,v);d=x.Re();A=null;for(null!=m&&(A=m.Re());e.kb();)for(;e.La();){var y=!1,z=e.ia();z.o(u);if(!u.jc(v))return!1;if(null!=A&&(A.Ch(u,f),-1==A.next()))return h=!1;m=z.$b();d.Fn(z,f);for(t=d.next();-1!=t;t=d.next()){w.Sb(x.da(t));t=w.ia();var C=z.Ga(t,null,p,n,f);if(2==C&&(!g||n[0]<=n[1])){var C=
p[0],B=p[1],E=n[0],K=n[1];if(C*m<=f&&(1-B)*m<=f){y=!0;q=0;l.resize(0);r.Tg.length=0;for(var F=e.Jb(),E=!0;E;){if(e.La()){z=e.ia();m=z.$b();C=z.Ga(t,null,p,n,f);if(2==C&&(!g||n[0]<=n[1])&&(C=p[0],B=p[1],C*m<=f&&(1-B)*m<=f)){F=e.Jb();continue}if(w.La()&&(t=w.ia(),C=z.Ga(t,null,p,n,f),2==C&&(!g||n[0]<=n[1])&&(C=p[0],B=p[1],C*m<=f&&(1-B)*m<=f))){F=e.Jb();continue}}E=!1}F!=e.Jb()&&(e.Sb(F),e.ia());break}else F=e.Jb(),t=b.Oa(F,e.Qa,C,B,w.Jb(),w.Qa,E,K),r.Tg.push(t),l.add(l.size)}}if(!y){if(q==r.Tg.length)return!1;
1<l.size-q&&l.xd(q,l.size,k);for(y=0;q<r.Tg.length;q++)if(t=r.Tg[l.get(q)],!(t.Oi<y&&t.ji<y)){if(m*(t.Oi-y)>f)return!1;y=t.ji;if(m*(1-y)<=f||1==y)break}if(m*(1-y)>f)return!1;q=0;l.resize(0);r.Tg.length=0}}return h};c.iA=function(b,e,d){if(1>c.Zv(b,e,d,null))return!1;var f=new a.i,g=new a.i;b.o(f);e.o(g);var k=c.lm(f,g,d),f=c.lm(g,f,d);return k&&f?!0:k&&!f?!c.Wf(e,b,d,!1):f&&!k?!c.Wf(b,e,d,!1):!c.Wf(b,e,d,!1)&&!c.Wf(e,b,d,!1)};c.Zv=function(e,d,f,g){function k(a,b){return w.IB(a,b)}var h,n;e.Iw()>
d.Iw()?(h=d,n=e):(h=e,n=d);e=h.Ca();d=n.Ca();var p=[0,0],q=[0,0],l=-1,r=0,t,u=new a.ga(0),w=new c,v,x=new a.i,m=new a.i,A=new a.i;h.o(x);n.o(m);x.P(f,f);m.P(f,f);A.K(x);A.Ga(m);h=null;null!=g&&(h=new a.b);t=m=m=null;var y=n.pb;null!=y?(m=y.Ab,t=y.nn,null==m&&(m=a.Ia.ij(n,A))):m=a.Ia.ij(n,A);n=m.Re();y=null;for(null!=t&&(y=t.Re());e.kb();)for(t=0;e.La();){var z=e.ia();z.o(x);if(x.jc(A)&&(null==y||(y.Ch(x,f),-1!=y.next()))){var C=z.$b();n.Fn(z,f);for(var B=n.next();-1!=B;B=n.next()){var E=m.da(B);d.Sb(E);
v=d.ia();var F=v.$b(),K=z.Ga(v,null,p,q,f);if(0<K){var B=p[0],l=q[0],G=2==K?p[1]:NaN,H=2==K?q[1]:NaN;if(2==K){if(C*(G-B)>f)return l=1;var N=C*(G-B);if(d.La()){v=d.ia();K=z.Ga(v,null,p,null,f);if(2==K){var K=p[0],U=p[1],K=C*(U-K);if(N+K>f)return l=1}d.Sb(E);d.ia()}if(!d.wl()){d.oi();v=d.oi();K=z.Ga(v,null,p,null,f);if(2==K&&(K=p[0],U=p[1],K=C*(U-K),N+K>f))return l=1;d.Sb(E);d.ia()}if(e.La()){E=e.Jb();z=e.ia();K=z.Ga(v,null,p,null,f);if(2==K&&(K=p[0],U=p[1],K=C*(U-K),N+K>f))return l=1;e.Sb(E);e.ia()}if(!e.wl()){E=
e.Jb();e.oi();z=e.oi();K=z.Ga(v,null,p,null,f);if(2==K&&(K=p[0],U=p[1],K=F*(U-K),N+K>f))return l=1;e.Sb(E);e.ia()}v=b.Oa(e.Jb(),e.Qa,B,G,d.Jb(),d.Qa,l,H);w.Tg.push(v);u.add(u.size)}l=0;null!=g&&(z.Kb(B,h),g.add(h.x),g.add(h.y))}}if(r<w.Tg.length){u.xd(r,u.size,k);z=0;for(B=w.Tg[u.get(r)].Jl;r<w.Tg.length;r++)if(v=w.Tg[u.get(r)],!(v.Oi<z&&v.ji<z))if(C*(v.Oi-z)>f)t=C*(v.ji-v.Oi),z=v.ji,B=v.Jl;else{v.Jl!=B?(t=C*(v.ji-v.Oi),B=v.Jl):t+=C*(v.ji-v.Oi);if(t>f)return l=1;z=v.ji;if(1==z)break}C*(1-z)>f&&(t=
0);r=0;u.resize(0);w.Tg.length=0}}}return l};c.ED=function(b,c,e){var d=b.Ca(),f=c.Ca();for(b=new a.cl(b,c,e,!1);b.next();){c=b.jk();var g=b.ek();d.Sb(c);f.Sb(g);c=d.ia();if(0<f.ia().Ga(c,null,null,null,e))return!0}return!1};c.eA=function(b,c,e,d){var f=b.Ca(),g=new a.i,k=new a.i,h=new a.i;b.o(g);c.o(k);g.P(e,e);g.contains(k);k.P(e,e);h.K(g);h.Ga(k);g=b.pb;null!=g?(g=g.Ab,null==g&&(g=a.Ia.ij(b,h))):g=a.Ia.ij(b,h);b=g.Re();for(var n=new a.b,p=new a.b,q=e*e,l=0;l<c.F();l++)if(c.w(l,n),h.contains(n)){k.K(n.x,
n.y,n.x,n.y);b.Ch(k,e);for(var r=!1,t=b.next();-1!=t;t=b.next())if(f.Sb(g.da(t)),t=f.ia(),t.Kb(t.Gd(n,!1),p),a.b.Zb(p,n)<=q){r=!0;break}if(d){if(!r)return!1}else if(r)return!0}return d?!0:!1};c.ex=function(b,c,e){var d=new a.b,f=e*e,g=b.Ca();b=b.pb;if(null!=b&&(b=b.Ab,null!=b)){var k=new a.i;k.K(c);e=b.xw(k,e);for(k=e.next();-1!=k;k=e.next())if(g.Sb(b.da(k)),g.La()){var k=g.ia(),h=k.Gd(c,!1);k.Kb(h,d);if(a.b.Zb(c,d)<=f)return!0}return!1}for(b=new a.i;g.kb();)for(;g.La();)if(k=g.ia(),k.o(b),b.P(e,
e),b.contains(c)&&(h=k.Gd(c,!1),k.Kb(h,d),a.b.Zb(c,d)<=f))return!0;return!1};c.bA=function(a,b,e){return c.ex(a,b,e)&&!c.bw(a,b,e)};c.bw=function(a,b,e){a=a.Rf();return!c.or(a,b,e)};c.cA=function(b,c,e){if(b.Hm()){var d=new a.yb(c.v,c.C,c.v,c.G),f=new a.yb(c.v,c.G,c.B,c.G),g=new a.yb(c.B,c.G,c.B,c.C);c=new a.yb(c.B,c.C,c.v,c.C);for(b=b.Ca();b.kb();)for(;b.La();){var k=b.ia();if(k.jc(d,e)||k.jc(f,e)||k.jc(g,e)||k.jc(c,e))return!0}}else{d=new a.i;d.K(c);d.P(e,e);e=b.mc(0);f=new a.b;g=new a.b;c=new a.b;
for(var k=new a.b,h=0,n=b.ea();h<n;h++)for(var p=!0,q=b.Ea(h),l=b.Dc(h);q<l;q++)if(p)e.ec(2*q,g),p=!1;else{e.ec(2*q,f);c.J(g);k.J(f);if(0!=d.Nv(c,k))return!0;g.J(f)}}return!1};c.fc=function(b,e,d){var f=b.D(),g=e.D();if(a.T.Th(f)){var k=b.pb;if(null!=k&&(k=k.hi,null!=k))if(33==g){var h=e.w(),h=k.Kk(h.x,h.y);if(1==h)return 1;if(0==h)return 4}else{h=new a.i;e.o(h);h=k.Dn(h);if(1==h)return 1;if(0==h)return 4;if(d&&a.T.Th(g)&&c.zz(e,k))return 1073741824}}if(a.T.Th(g)&&(k=e.pb,null!=k&&(k=k.hi,null!=k)))if(33==
f){b=b.w();h=k.Kk(b.x,b.y);if(1==h)return 2;if(0==h)return 4}else{e=new a.i;b.o(e);h=k.Dn(e);if(1==h)return 2;if(0==h)return 4;if(d&&a.T.Th(f)&&c.zz(b,k))return 1073741824}return 0};c.zz=function(b,c){for(var e=b.F(),d=new a.b,f=0;f<e;f++)if(b.w(f,d),1==c.Kk(d.x,d.y))return!0;return!1};c.AE=function(b,c,e,d){for(var f=1<=b.rj(0)&&1<=c.rj(0),g=b.Ca(),k=c.Ca(),h=[0,0],n=[0,0],p=new a.cl(b,c,e,!1),q=!1;p.next();){var l=p.jk(),r=p.ek();g.Sb(l);k.Sb(r);l=g.ia();r=k.ia().Ga(l,null,n,h,e);if(2==r){q=h[0];
r=h[1];l=l.$b();if(f&&(r-q)*l>e)return!1;q=!0}else if(0!=r){q=h[0];l=n[0];if(0<q&&1>q&&0<l&&1>l)return!1;q=!0}}if(!q)return!1;g=new a.i;k=new a.i;f=new a.i;b.o(g);c.o(k);g.P(1E3*e,1E3*e);k.P(1E3*e,1E3*e);f.K(g);f.Ga(k);return 10<b.F()&&(b=a.Ed.clip(b,f,e,0),b.s())||10<c.F()&&(c=a.Ed.clip(c,f,e,0),c.s())?!1:a.el.vr(b,c,e,"F********",d)};c.wD=function(b,e,d,f){var g=1<=b.rj(0)&&1<=e.rj(0),k=new a.i,h=new a.i,n=new a.i;b.o(k);e.o(h);for(var p=!1,q=c.lm(k,h,d),l=c.lm(h,k,d),r=b.Ca(),t=e.Ca(),u=[0,0],
w=[0,0],v=new a.cl(b,e,d,!1);v.next();){var x=v.jk(),m=v.ek();r.Sb(x);t.Sb(m);m=r.ia();x=t.ia().Ga(m,null,w,u,d);if(2==x){var x=u[0],A=u[1],m=m.$b();if(g&&(A-x)*m>d&&(p=!0,q&&l))return!0}else if(0!=x&&(x=u[0],m=w[0],0<x&&1>x&&0<m&&1>m))return!0}g=new a.i;r=new a.i;g.K(k);g.P(1E3*d,1E3*d);r.K(h);r.P(1E3*d,1E3*d);n.K(g);n.Ga(r);k="";k=p?k+"**":k+"T*";if(q){if(10<e.F()&&(e=a.Ed.clip(e,n,d,0),e.s()))return!1;k+="****"}else k+="T***";if(l){if(10<b.F()&&(b=a.Ed.clip(b,n,d,0),b.s()))return!1;k+="***"}else k+=
"T**";return a.el.vr(b,e,d,k.toString(),f)};c.bC=function(b,e,d,f){var g=[!1],k=c.wB(b,e,d,g);if(g[0])return k;g=new a.i;e.o(g);g.P(1E3*d,1E3*d);return 10<b.F()&&(b=a.Ed.clip(b,g,d,0),b.s())?!1:a.el.su(b,e,d,f)};c.wB=function(b,c,e,d){d[0]=!1;for(var f=b.Ca(),g=c.Ca(),k=[0,0],h=[0,0],n=new a.cl(b,c,e,!1),p=!1;n.next();){var q=n.jk(),l=n.ek();f.Sb(q,-1);g.Sb(l,-1);q=f.ia();q=g.ia().Ga(q,null,h,k,e);if(0!=q&&(p=!0,1==q&&(q=k[0],l=h[0],0<q&&1>q&&0<l&&1>l)))return d[0]=!0,!1}if(!p){d[0]=!0;k=new a.i;
b.o(k);k.P(e,e);n=b;p=!1;h=new a.i;d=0;for(f=c.ea();d<f;d++)if(0<c.Ha(d)){c.Ti(d,h);if(k.jc(h)){if(g=c.Fa(c.Ea(d)),g=a.ff.xl(n,g,0),0==g)return!1}else return!1;p||(!a.ff.An(b,c.ea()-1)||null!=b.pb&&null!=b.pb.Ab?n=b:(g=new a.Ka,b.copyTo(g),g.dj(1),n=g),p=!0)}if(1==b.ea()||1607==c.D())return!0;k=new a.i;c.o(k);k.P(e,e);h=c;n=!1;e=new a.i;d=0;for(f=b.ea();d<f;d++)if(0<b.Ha(d)){b.Ti(d,e);if(k.jc(e)&&(g=b.Fa(b.Ea(d)),g=a.ff.xl(h,g,0),1==g))return!1;n||(!a.ff.An(c,b.ea()-1)||null!=c.pb&&null!=c.pb.Ab?
h=c:(g=new a.Ka,c.copyTo(g),g.dj(1),h=g),n=!0)}return!0}return!1};c.CE=function(b,c,e,d){for(var f=b.Ca(),g=c.Ca(),k=[0,0],h=[0,0],n=new a.cl(b,c,e,!1),p=!1;n.next();){var q=n.jk(),l=n.ek();f.Sb(q);g.Sb(l);q=f.ia();q=g.ia().Ga(q,null,h,k,e);if(2==q)p=!0;else if(0!=q){p=k[0];q=h[0];if(0<p&&1>p&&0<q&&1>q)return!1;p=!0}}if(!p)return!1;g=new a.i;k=new a.i;f=new a.i;b.o(g);c.o(k);g.P(1E3*e,1E3*e);k.P(1E3*e,1E3*e);f.K(g);f.Ga(k);return 10<b.F()&&(b=a.Ed.clip(b,f,e,0),b.s())||10<c.F()&&(c=a.Ed.clip(c,f,
e,0),c.s())?!1:a.el.Vl(b,c,e,"F********",d)};c.YC=function(b,e,d,f){for(var g=b.Ca(),k=e.Ca(),h=[0,0],n=[0,0],p=new a.cl(b,e,d,!1),q=!1;p.next();){var l=p.jk(),r=p.ek();g.Sb(l);k.Sb(r);l=g.ia();l=k.ia().Ga(l,null,n,h,d);if(2==l)q=!0;else if(0!=l){q=h[0];l=n[0];if(0<q&&1>q&&0<l&&1>l)return!0;q=!0}}if(!q)return!1;k=new a.i;h=new a.i;n=new a.i;p=new a.i;g=new a.i;b.o(k);e.o(h);return c.lm(h,k,d)?(n.K(k),n.P(1E3*d,1E3*d),p.K(h),p.P(1E3*d,1E3*d),g.K(n),g.Ga(p),10<b.F()&&(b=a.Ed.clip(b,g,d,0),b.s())||10<
e.F()&&(e=a.Ed.clip(e,g,d,0),e.s())?!1:d=a.el.Vl(b,e,d,"T********",f)):d=a.el.Vl(b,e,d,"T*****T**",f)};c.jC=function(b,e,d,f){var g=[!1],k=c.wB(b,e,d,g);if(g[0])return k;g=new a.i;e.o(g);g.P(1E3*d,1E3*d);return 10<b.F()&&(b=a.Ed.clip(b,g,d,0),b.s())?!1:a.el.dy(b,e,d,f)};c.YB=function(b,c,e){return 1==a.gd.he(b,c,e)?!0:!1};c.yD=function(b,c,e){return 2==a.gd.he(b,c,e)?!0:!1};c.or=function(b,c,e){var d=new a.b;e*=e;for(var f=0;f<b.F();f++)if(b.w(f,d),a.b.Zb(d,c)<=e)return!1;return!0};c.prototype.IB=
function(a,b){a=this.Tg[a];b=this.Tg[b];return a.Jl<b.Jl||a.Jl==b.Jl&&(a.Wt<b.Wt||a.Wt==b.Wt&&(a.Oi<b.Oi||a.Oi==b.Oi&&(a.ji<b.ji||a.ji==b.ji&&a.dE<b.dE)))?-1:1};return c}();a.hd=c})(z||(z={}));(function(a){var b;(function(a){a[a.InteriorInterior=0]="InteriorInterior";a[a.InteriorBoundary=1]="InteriorBoundary";a[a.InteriorExterior=2]="InteriorExterior";a[a.BoundaryInterior=3]="BoundaryInterior";a[a.BoundaryBoundary=4]="BoundaryBoundary";a[a.BoundaryExterior=5]="BoundaryExterior";a[a.ExteriorInterior=
6]="ExteriorInterior";a[a.ExteriorBoundary=7]="ExteriorBoundary";a[a.ExteriorExterior=8]="ExteriorExterior"})(b||(b={}));var c;(function(a){a[a.AreaAreaPredicates=0]="AreaAreaPredicates";a[a.AreaLinePredicates=1]="AreaLinePredicates";a[a.LineLinePredicates=2]="LineLinePredicates";a[a.AreaPointPredicates=3]="AreaPointPredicates";a[a.LinePointPredicates=4]="LinePointPredicates";a[a.PointPointPredicates=5]="PointPointPredicates"})(c||(c={}));b=function(){function b(){this.Xd=0;this.h=new a.gs;this.A=
[0,0,0,0,0,0,0,0,0];this.Ta=[0,0,0,0,0,0,0,0,0];this.Y=[!1,!1,!1,!1,!1,!1,!1,!1,!1];this.Nl=this.$t=-1}b.py=function(b,c,e,d,f){if(9!=d.length)throw a.g.ra("relation string length has to be 9 characters");for(var g=0;9>g;g++){var k=d.charAt(g);if("*"!=k&&"T"!=k&&"F"!=k&&"0"!=k&&"1"!=k&&"2"!=k)throw a.g.ra("relation string");}g=this.YN(d,b.fb(),c.fb());if(0!=g)return a.hd.qy(b,c,e,g,f);g=new a.i;b.o(g);k=new a.i;c.o(k);var h=new a.i;h.K(g);h.Db(k);e=a.Ia.zd(e,h,!1);b=this.NB(b,e);c=this.NB(c,e);if(b.s()||
c.s())return this.rR(b,c,d);g=c.D();k=!1;switch(b.D()){case 1736:switch(g){case 1736:k=this.vr(b,c,e,d,f);break;case 1607:k=this.Vl(b,c,e,d,f);break;case 33:k=this.ur(b,c,e,d,f);break;case 550:k=this.tr(b,c,e,d,f)}break;case 1607:switch(g){case 1736:k=this.Vl(c,b,e,this.Lo(d),f);break;case 1607:k=this.ey(b,c,e,d,f);break;case 33:k=this.xr(b,c,e,d,f);break;case 550:k=this.wr(b,c,e,d,f)}break;case 33:switch(g){case 1736:k=this.ur(c,b,e,this.Lo(d),f);break;case 1607:k=this.xr(c,b,e,this.Lo(d),f);break;
case 33:k=this.KQ(b,c,e,d);break;case 550:k=this.pr(c,b,e,this.Lo(d),f)}break;case 550:switch(g){case 1736:k=this.tr(c,b,e,this.Lo(d),f);break;case 1607:k=this.wr(c,b,e,this.Lo(d),f);break;case 550:k=this.Wx(b,c,e,d,f);break;case 33:k=this.pr(b,c,e,d,f)}break;default:k=!1}return k};b.vr=function(c,e,d,f,g){var k=new b;k.pi();k.si(f);k.vF();var h=new a.i,n=new a.i;c.o(h);e.o(n);f=!1;a.hd.nj(h,n,d)&&(k.Bs(c,e),f=!0);f||(h=a.hd.fc(c,e,!1),4==h?(k.Bs(c,e),f=!0):1==h?(k.Bv(e),f=!0):2==h&&(k.$A(c),f=!0));
f||(f=new a.fd,c=f.Eb(c),e=f.Eb(e),k.In(f,d,g),k.so(c,e),k.h.xg());return b.Mf(k.A,k.Hc)};b.su=function(c,e,d,f){var g=new b;g.pi();g.si("T*****F**");g.vF();var k=new a.i,h=new a.i;c.o(k);e.o(h);var n=!1;a.hd.nj(k,h,d)&&(g.Bs(c,e),n=!0);n||(k=a.hd.fc(c,e,!1),4==k?(g.Bs(c,e),n=!0):1==k?(g.Bv(e),n=!0):2==k&&(g.$A(c),n=!0));if(n)return k=this.Mf(g.A,g.Hc);n=new a.fd;c=n.Eb(c);k=n.Eb(e);a.aj.$(n,d,f,!1);d=n.hf(k).Rf();n.xo(0,!0,!0);a.mm.$(n,c,-1,!1,f);if(0==n.F(c))return!1;a.mm.$(n,k,-1,!1,f);g.Op(n,
f);e=0==n.F(k);if(!e&&(g.so(c,k),g.h.xg(),k=this.Mf(g.A,g.Hc),!k))return k;c=n.hf(c);n=new a.fd;c=n.Eb(c);k=n.Eb(d);g.Op(n,f);g.Xd=0;g.pi();g.si(e?"T*****F**":"******F**");g.wy();g.so(c,k);g.h.xg();return k=this.Mf(g.A,g.Hc)};b.Vl=function(c,e,d,f,g){var k=new b;k.pi();k.si(f);k.wy();var h=new a.i,n=new a.i;c.o(h);e.o(n);f=!1;a.hd.nj(h,n,d)&&(k.Cs(c,e),f=!0);f||(h=a.hd.fc(c,e,!1),4==h?(k.Cs(c,e),f=!0):1==h&&(k.aB(e),f=!0));f||(f=new a.fd,c=f.Eb(c),e=f.Eb(e),k.In(f,d,g),k.Jg=k.h.uo(),b.es(e,k.h,k.Jg),
k.so(c,e),k.h.vo(k.Jg),k.h.xg());return b.Mf(k.A,k.Hc)};b.dy=function(c,e,d,f){var g=new b;g.pi();g.si("T*****F**");g.wy();var k=new a.i,h=new a.i;c.o(k);e.o(h);var n=!1;a.hd.nj(k,h,d)&&(g.Cs(c,e),n=!0);n||(k=a.hd.fc(c,e,!1),4==k?(g.Cs(c,e),n=!0):1==k&&(g.aB(e),n=!0));if(n)return d=this.Mf(g.A,g.Hc);n=new a.fd;c=n.Eb(c);e=n.Eb(e);g.In(n,d,f);if(0==n.F(c))return!1;g.so(c,e);g.h.xg();return d=this.Mf(g.A,g.Hc)};b.tr=function(c,e,d,f,g){var k=new b;k.pi();k.si(f);k.wF();var h=new a.i,n=new a.i;c.o(h);
e.o(n);f=!1;a.hd.nj(h,n,d)&&(k.Ds(c),f=!0);f||(h=a.hd.fc(c,e,!1),4==h?(k.Ds(c),f=!0):1==h&&(k.cK(),f=!0));f||(f=new a.fd,c=f.Eb(c),e=f.Eb(e),k.In(f,d,g),k.Pv(c,e),k.h.xg());return b.Mf(k.A,k.Hc)};b.ey=function(c,e,d,f,g){var k=new b;k.pi();k.si(f);k.ZR();f=new a.i;var h=new a.i;c.o(f);e.o(h);var n=!1;a.hd.nj(f,h,d)&&(k.CD(c,e),n=!0);n||4!=a.hd.fc(c,e,!1)||(k.CD(c,e),n=!0);n||(f=new a.fd,c=f.Eb(c),e=f.Eb(e),k.In(f,d,g),k.ph=k.h.uo(),k.Jg=k.h.uo(),b.es(c,k.h,k.ph),b.es(e,k.h,k.Jg),k.so(c,e),k.h.vo(k.ph),
k.h.vo(k.Jg),k.h.xg());return b.Mf(k.A,k.Hc)};b.wr=function(c,e,d,f,g){var k=new b;k.pi();k.si(f);k.KF();f=new a.i;var h=new a.i;c.o(f);e.o(h);var n=!1;a.hd.nj(f,h,d)&&(k.dx(c),n=!0);n||4!=a.hd.fc(c,e,!1)||(k.dx(c),n=!0);n||(f=new a.fd,c=f.Eb(c),e=f.Eb(e),k.In(f,d,g),k.ph=k.h.uo(),b.es(c,k.h,k.ph),k.Pv(c,e),k.h.vo(k.ph),k.h.xg());return b.Mf(k.A,k.Hc)};b.Wx=function(c,e,d,f,g){var k=new b;k.pi();k.si(f);k.PF();f=new a.i;var h=new a.i;c.o(f);e.o(h);var n=!1;a.hd.nj(f,h,d)&&(k.PE(),n=!0);n||(f=new a.fd,
c=f.Eb(c),e=f.Eb(e),k.In(f,d,g),k.Pv(c,e),k.h.xg());return b.Mf(k.A,k.Hc)};b.ur=function(c,e,d,f){var g=new b;g.pi();g.si(f);g.wF();var k=new a.i;c.o(k);e=e.w();var h=!1;a.hd.ru(e,k,d)&&(g.Ds(c),h=!0);h||(d=a.gd.he(c,e,d),1==d?(g.A[0]=0,g.A[2]=2,g.A[3]=-1,g.A[5]=1,g.A[6]=-1):2==d?(g.A[6]=-1,0!=c.Mh()?(g.A[0]=-1,g.A[3]=0,g.A[2]=2,g.A[5]=1):(g.A[0]=0,g.A[3]=-1,g.A[5]=-1,d=new a.i,c.o(d),g.A[2]=0==d.ba()&&0==d.aa()?-1:1)):g.Ds(c));return this.Mf(g.A,f)};b.xr=function(c,e,d,f,g){var k=new b;k.pi();k.si(f);
k.KF();var h=new a.i;c.o(h);f=e.w();var n=!1;a.hd.ru(f,h,d)&&(k.dx(c),n=!0);if(!n){var h=null,p=n=!1;if(k.Y[0]||k.Y[6])a.hd.ex(c,f,d)?(k.Y[0]&&(h=a.Hh.il(c,g),p=!a.hd.or(h,f,d),n=!0,k.A[0]=p?-1:0),k.A[6]=-1):(k.A[0]=-1,k.A[6]=0);k.Y[3]&&(null!=h&&h.s()?k.A[3]=-1:(n||(null==h&&(h=a.Hh.il(c,g)),p=!a.hd.or(h,f,d),n=!0),k.A[3]=p?0:-1));k.Y[5]&&(null!=h&&h.s()?k.A[5]=-1:n&&!p?k.A[5]=0:(null==h&&(h=a.Hh.il(c,g)),g=a.hd.mu(h,e,d),k.A[5]=g?-1:0));k.Y[2]&&(0!=c.$b()?k.A[2]=1:(g=new a.pe(c.description),g.Pd(c,
0,c.F()),c=a.hd.mu(g,e,d),k.A[2]=c?-1:0))}return this.Mf(k.A,k.Hc)};b.pr=function(c,e,d,f){var g=new b;g.pi();g.si(f);g.PF();var k=new a.i;c.o(k);e=e.w();var h=!1;a.hd.ru(e,k,d)&&(g.PE(),h=!0);if(!h){k=!1;h=!0;d*=d;for(var n=0;n<c.F();n++){var p=c.Fa(n);a.b.Zb(p,e)<=d?k=!0:h=!1;if(k&&!h)break}k?(g.A[0]=0,g.A[2]=h?-1:0,g.A[6]=-1):(g.A[0]=-1,g.A[2]=0,g.A[6]=0)}return b.Mf(g.A,f)};b.KQ=function(c,e,d,f){c=c.w();e=e.w();for(var g=[],k=0;9>k;k++)g[k]=-1;a.b.Zb(c,e)<=d*d?g[0]=0:(g[2]=0,g[6]=0);g[8]=2;return b.Mf(g,
f)};b.Mf=function(a,b){for(var c=0;9>c;c++)switch(b.charAt(c)){case "T":if(-1==a[c])return!1;break;case "F":if(-1!=a[c])return!1;break;case "0":if(0!=a[c])return!1;break;case "1":if(1!=a[c])return!1;break;case "2":if(2!=a[c])return!1}return!0};b.rR=function(b,c,e){var d=[-1,-1,-1,-1,-1,-1,-1,-1,-1];if(b.s()&&c.s()){for(var f=0;9>f;f++)d[f]=-1;return this.Mf(d,e)}f=!1;b.s()&&(b=c,f=!0);d[0]=-1;d[1]=-1;d[3]=-1;d[4]=-1;d[6]=-1;d[7]=-1;d[8]=2;c=b.D();a.T.Kc(c)?1736==c?0!=b.Mh()?(d[2]=2,d[5]=1):(d[5]=
-1,c=new a.i,b.o(c),d[2]=0==c.ba()&&0==c.aa()?0:1):(c=0!=b.$b(),d[2]=c?1:0,d[5]=a.Hh.No(b)?0:-1):(d[2]=0,d[5]=-1);f&&this.qG(d);return this.Mf(d,e)};b.YN=function(a,c,e){return b.mT(a)?3:b.NS(a)?4:b.nT(a,c,e)?8:b.CR(a,c,e)?16:b.yQ(a)?1:b.LK(a,c,e)?32:0};b.mT=function(a){return"T"==a.charAt(0)&&"*"==a.charAt(1)&&"F"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"F"==a.charAt(5)&&"F"==a.charAt(6)&&"F"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.NS=function(a){return"F"==a.charAt(0)&&"F"==a.charAt(1)&&
"*"==a.charAt(2)&&"F"==a.charAt(3)&&"F"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.nT=function(a,b,c){if(0==b&&0==c)return!1;if(2!=b||2!=c)if("F"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"T"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)||1==b&&1==c&&"F"==a.charAt(0)&&"T"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&
"*"==a.charAt(8))return!0;return 0!=c&&"F"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"T"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.CR=function(a,b,c){return b>c?"T"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1:1==b&&1==c&&"0"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&
"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.yQ=function(a){return"T"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"F"==a.charAt(6)&&"F"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.LK=function(a,b,c){if(b==c){if(1!=b)return"T"==a.charAt(0)&&"*"==a.charAt(1)&&"T"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1;if("1"==a.charAt(0)&&
"*"==a.charAt(1)&&"T"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8))return!0}return!1};b.es=function(a,b,c){a=b.ya(a);for(var e=b.Be;-1!=e;e=b.Bf(e))if(0!=(b.md(e)&a)){var d=b.te(e);if(-1==d)b.fm(e,c,0);else{var f=d,g=0;do 0!=(b.Gg(f)&a)&&g++,f=b.Wb(b.sa(f));while(f!=d);b.fm(e,c,g)}}};b.Lo=function(a){var b;b=""+a.charAt(0);b+=a.charAt(3);b+=a.charAt(6);b+=a.charAt(1);b+=a.charAt(4);b+=a.charAt(7);b+=a.charAt(2);b+=a.charAt(5);
return b+=a.charAt(8)};b.prototype.pi=function(){for(var a=0;9>a;a++)this.A[a]=-2,this.Ta[a]=-2};b.qG=function(a){var b=a[1],c=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[5]=a[7];a[3]=b;a[6]=c;a[7]=e};b.prototype.si=function(a){this.Hc=a;for(a=0;9>a;a++)"*"!=this.Hc.charAt(a)?(this.Y[a]=!0,this.Xd++):this.Y[a]=!1};b.prototype.SF=function(){for(var a=0;9>a;a++)this.Y[a]&&-2==this.A[a]&&(this.A[a]=-1,this.Y[a]=!1)};b.prototype.dc=function(a){if(-2==this.A[a])return!1;if(-1==this.A[a])return this.Y[a]=!1,this.Xd--,
!0;if("T"!=this.Hc.charAt(a)&&"F"!=this.Hc.charAt(a)){if(this.A[a]<this.Ta[a])return!1;this.Y[a]=!1;this.Xd--;return!0}this.Y[a]=!1;this.Xd--;return!0};b.prototype.vF=function(){this.$t=0;this.Ta[0]=2;this.Ta[1]=1;this.Ta[2]=2;this.Ta[3]=1;this.Ta[4]=1;this.Ta[5]=1;this.Ta[6]=2;this.Ta[7]=1;this.Ta[8]=2;this.Y[8]&&(this.A[8]=2,this.Y[8]=!1,this.Xd--)};b.prototype.wy=function(){this.$t=1;this.Nl=3;this.Ta[0]=1;this.Ta[1]=0;this.Ta[2]=2;this.Ta[3]=1;this.Ta[4]=0;this.Ta[5]=1;this.Ta[6]=1;this.Ta[7]=
0;this.Ta[8]=2;this.Y[8]&&(this.A[8]=2,this.Y[8]=!1,this.Xd--)};b.prototype.ZR=function(){this.$t=2;this.Nl=4;this.Ta[0]=1;this.Ta[1]=0;this.Ta[2]=1;this.Ta[3]=0;this.Ta[4]=0;this.Ta[5]=0;this.Ta[6]=1;this.Ta[7]=0;this.Ta[8]=2;this.Y[8]&&(this.A[8]=2,this.Y[8]=!1,this.Xd--)};b.prototype.wF=function(){this.Nl=3;this.Ta[0]=0;this.Ta[1]=-1;this.Ta[2]=2;this.Ta[3]=0;this.Ta[4]=-1;this.Ta[5]=1;this.Ta[6]=0;this.Ta[7]=-1;this.Ta[8]=2;this.Y[1]&&(this.A[1]=-1,this.Y[1]=!1,this.Xd--);this.Y[4]&&(this.A[4]=
-1,this.Y[4]=!1,this.Xd--);this.Y[7]&&(this.A[7]=-1,this.Y[7]=!1,this.Xd--);this.Y[8]&&(this.A[8]=2,this.Y[8]=!1,this.Xd--)};b.prototype.KF=function(){this.Nl=4;this.Ta[0]=0;this.Ta[1]=-1;this.Ta[2]=1;this.Ta[3]=0;this.Ta[4]=-1;this.Ta[5]=0;this.Ta[6]=0;this.Ta[7]=-1;this.Ta[8]=2;this.Y[1]&&(this.A[1]=-1,this.Y[1]=!1,this.Xd--);this.Y[4]&&(this.A[4]=-1,this.Y[4]=!1,this.Xd--);this.Y[7]&&(this.A[7]=-1,this.Y[7]=!1,this.Xd--);this.Y[8]&&(this.A[8]=2,this.Y[8]=!1,this.Xd--)};b.prototype.PF=function(){this.Nl=
5;this.Ta[0]=0;this.Ta[1]=-1;this.Ta[2]=0;this.Ta[3]=-1;this.Ta[4]=-1;this.Ta[5]=-1;this.Ta[6]=0;this.Ta[7]=-1;this.Ta[8]=2;this.Y[1]&&(this.A[1]=-1,this.Y[1]=!1,this.Xd--);this.Y[3]&&(this.A[3]=-1,this.Y[3]=!1,this.Xd--);this.Y[4]&&(this.A[4]=-1,this.Y[4]=!1,this.Xd--);this.Y[5]&&(this.A[5]=-1,this.Y[5]=!1,this.Xd--);this.Y[7]&&(this.A[7]=-1,this.Y[7]=!1,this.Xd--);this.Y[8]&&(this.A[8]=2,this.Y[8]=!1,this.Xd--)};b.prototype.aK=function(a,b,c){var e=!0;this.Y[0]&&(this.HO(a,b,c),e=e&&this.dc(0));
this.Y[1]&&(this.eD(a,b,1),e=e&&this.dc(1));this.Y[2]&&(this.fD(a,b,c,2),e=e&&this.dc(2));this.Y[3]&&(this.eD(a,c,3),e=e&&this.dc(3));this.Y[4]&&(this.gK(a,b,c),e=e&&this.dc(4));this.Y[5]&&(this.eB(a,c,5),e=e&&this.dc(5));this.Y[6]&&(this.fD(a,c,b,6),e=e&&this.dc(6));this.Y[7]&&(this.eB(a,b,7),e=e&&this.dc(7));return e};b.prototype.Bs=function(a,b){this.A[0]=-1;this.A[1]=-1;this.A[3]=-1;this.A[4]=-1;this.iq(a,this.Y[2]?2:-1,this.Hc.charAt(2),this.Y[5]?5:-1,this.Hc.charAt(5));this.iq(b,this.Y[6]?6:
-1,this.Hc.charAt(6),this.Y[7]?7:-1,this.Hc.charAt(7))};b.prototype.iq=function(b,c,e,d,f){if(-1!=c||-1!=d)("T"!=e&&"F"!=e&&-1!=c||"T"!=f&&"F"!=f&&-1!=d?0!=b.Mh():1)?(-1!=c&&(this.A[c]=2),-1!=d&&(this.A[d]=1)):(-1!=d&&(this.A[d]=-1),-1!=c&&(e=new a.i,b.o(e),this.A[c]=0==e.ba()&&0==e.aa()?0:1))};b.prototype.Bv=function(a){this.A[2]=2;this.A[3]=-1;this.A[4]=-1;this.A[5]=1;this.A[6]=-1;this.A[7]=-1;this.iq(a,this.Y[0]?0:-1,this.Hc.charAt(0),this.Y[1]?1:-1,this.Hc.charAt(1))};b.prototype.$A=function(a){this.Bv(a);
b.qG(this.A)};b.prototype.Cs=function(b,c){this.A[0]=-1;this.A[1]=-1;this.A[3]=-1;this.A[4]=-1;if(this.Y[6]){var e=this.Hc.charAt(6),e="T"!=e&&"F"!=e?0!=c.$b():!0;this.A[6]=e?1:0}this.Y[7]&&(e=a.Hh.No(c),this.A[7]=e?0:-1);this.iq(b,this.Y[2]?2:-1,this.Hc.charAt(2),this.Y[5]?5:-1,this.Hc.charAt(5))};b.prototype.aB=function(b){if(this.Y[0]){var c=this.Hc.charAt(0),c="T"!=c&&"F"!=c?0!=b.$b():!0;this.A[0]=c?1:0}this.Y[1]&&(b=a.Hh.No(b),this.A[1]=b?0:-1);this.A[2]=2;this.A[3]=-1;this.A[4]=-1;this.A[5]=
1;this.A[6]=-1;this.A[7]=-1};b.prototype.Ds=function(a){this.A[0]=-1;this.A[3]=-1;this.A[6]=0;this.iq(a,this.Y[2]?2:-1,this.Hc.charAt(2),this.Y[5]?5:-1,this.Hc.charAt(5))};b.prototype.cK=function(){this.A[0]=0;this.A[2]=2;this.A[3]=-1;this.A[5]=1;this.A[6]=-1};b.prototype.CD=function(b,c){this.A[0]=-1;this.A[1]=-1;this.A[3]=-1;this.A[4]=-1;if(this.Y[2]){var e=this.Hc.charAt(2),e="T"!=e&&"F"!=e?0!=b.$b():!0;this.A[2]=e?1:0}this.Y[5]&&(e=a.Hh.No(b),this.A[5]=e?0:-1);this.Y[6]&&(e=this.Hc.charAt(6),
e="T"!=e&&"F"!=e?0!=c.$b():!0,this.A[6]=e?1:0);this.Y[7]&&(e=a.Hh.No(c),this.A[7]=e?0:-1)};b.prototype.dx=function(b){this.A[0]=-1;this.A[3]=-1;if(this.Y[2]){var c=this.Hc.charAt(2),c="T"!=c&&"F"!=c?0!=b.$b():!0;this.A[2]=c?1:0}this.Y[5]&&(b=a.Hh.No(b),this.A[5]=b?0:-1);this.A[6]=0};b.prototype.PE=function(){this.A[0]=-1;this.A[2]=0;this.A[6]=0};b.prototype.bK=function(a,b,c){var e=!0;this.Y[0]&&(this.IO(a,b),e=e&&this.dc(0));this.Y[1]&&(this.EO(a,b,c,this.Jg),e=e&&this.dc(1));this.Y[2]&&(this.FO(a,
b),e=e&&this.dc(2));this.Y[3]&&(this.kK(a,b,c,this.Jg),e=e&&this.dc(3));this.Y[4]&&(this.hK(a,b,c,this.Jg),e=e&&this.dc(4));this.Y[5]&&(this.iK(a,b,c),e=e&&this.dc(5));this.Y[6]&&(this.BM(a,b),e=e&&this.dc(6));this.Y[7]&&(this.AM(a,b,c,this.Jg),e=e&&this.dc(7));return e};b.prototype.uP=function(a,b,c){var e=!0;this.Y[0]&&(this.LO(a,b,c,this.ph,this.Jg),e=e&&this.dc(0));this.Y[1]&&(this.gD(a,b,c,this.ph,this.Jg,1),e=e&&this.dc(1));this.Y[2]&&(this.hD(a,b,c,2),e=e&&this.dc(2));this.Y[3]&&(this.gD(a,
c,b,this.Jg,this.ph,3),e=e&&this.dc(3));this.Y[4]&&(this.mK(a,b,c,this.ph,this.Jg),e=e&&this.dc(4));this.Y[5]&&(this.fB(a,c,this.ph,5),e=e&&this.dc(5));this.Y[6]&&(this.hD(a,c,b,6),e=e&&this.dc(6));this.Y[7]&&(this.fB(a,b,this.Jg,7),e=e&&this.dc(7));return e};b.prototype.bB=function(a,b,c){var e=!0;this.Y[0]&&(this.JO(a,b),e=e&&this.dc(0));this.Y[2]&&(this.GO(a,b),e=e&&this.dc(2));this.Y[3]&&(this.lK(a,b,c),e=e&&this.dc(3));this.Y[5]&&(this.jK(a,b),e=e&&this.dc(5));this.Y[6]&&(this.CM(a,b),e=e&&this.dc(6));
return e};b.prototype.DD=function(a,b,c){var e=!0;this.Y[0]&&(this.MO(a,b,c,this.ph),e=e&&this.dc(0));this.Y[2]&&(this.KO(a,c),e=e&&this.dc(2));this.Y[3]&&(this.oK(a,b,c,this.ph),e=e&&this.dc(3));this.Y[5]&&(this.nK(a,b,c,this.ph),e=e&&this.dc(5));this.Y[6]&&(this.DM(a,b,c),e=e&&this.dc(6));return e};b.prototype.JQ=function(a,b,c){var e=!0;this.Y[0]&&(this.NO(a,b,c),e=e&&this.dc(0));this.Y[2]&&(this.iD(a,b,c,2),e=e&&this.dc(2));this.Y[6]&&(this.iD(a,c,b,6),e=e&&this.dc(6));return e};b.prototype.HO=
function(a,b,c){2!=this.A[0]&&(a=this.h.Qe(a),0!=(a&b)&&0!=(a&c)&&(this.A[0]=2))};b.prototype.eD=function(a,b,c){if(1!=this.A[c]){var e=this.h.Qe(this.h.sa(a));0!=(this.h.Qe(a)&b)&&0!=(e&b)&&(this.A[c]=1)}};b.prototype.fD=function(a,b,c,e){2!=this.A[e]&&(a=this.h.Qe(a),0!=(a&b)&&0==(a&c)&&(this.A[e]=2))};b.prototype.gK=function(a,b,c){if(1!=this.A[4]){var e=this.h.Gg(a);0!=(e&b)&&0!=(e&c)?this.A[4]=1:0!=this.A[4]&&1!=this.h.tb(this.h.fe(this.h.sa(a)),this.ni)&&(a=this.h.md(this.h.jf(a)),0!=(a&b)&&
0!=(a&c)&&(this.A[4]=0))}};b.prototype.eB=function(a,b,c){if(1!=this.A[c]){var e=this.h.Qe(this.h.sa(a));0==(this.h.Qe(a)&b)&&0==(e&b)&&(this.A[c]=1)}};b.prototype.IO=function(a,b){if(1!=this.A[0]){var c=this.h.Qe(this.h.sa(a));0!=(this.h.Qe(a)&b)&&0!=(c&b)&&(this.A[0]=1)}};b.prototype.EO=function(a,b,c,e){if(0!=this.A[1]&&1!=this.h.tb(this.h.fe(this.h.sa(a)),this.ni)){var d=this.h.jf(a),f=this.h.md(d);0==(f&b)&&0!=(this.h.Qe(a)&b)&&(a=this.h.Sf(d,e),0!=(f&c)&&0!=a%2&&(this.A[1]=0))}};b.prototype.FO=
function(a,b){2!=this.A[2]&&0!=(this.h.Gg(a)&b)&&(this.A[2]=2)};b.prototype.kK=function(a,b,c,e){if(1!=this.A[3]){var d=this.h.Gg(a);0!=(d&b)&&0!=(d&c)?this.A[3]=1:0!=this.A[3]&&1!=this.h.tb(this.h.fe(this.h.sa(a)),this.ni)&&(d=this.h.jf(a),a=this.h.md(d),0!=(a&b)&&(b=this.h.Sf(d,e),0!=(a&c)&&0==b%2&&(this.A[3]=0)))}};b.prototype.hK=function(a,b,c,e){if(0!=this.A[4]&&1!=this.h.tb(this.h.fe(this.h.sa(a)),this.ni)){var d=this.h.jf(a);a=this.h.md(d);0!=(a&b)&&(b=this.h.Sf(d,e),0!=(a&c)&&0!=b%2&&(this.A[4]=
0))}};b.prototype.iK=function(a,b,c){1!=this.A[5]&&(a=this.h.Gg(a),0!=(a&b)&&0==(a&c)&&(this.A[5]=1))};b.prototype.BM=function(a,b){if(1!=this.A[6]){var c=this.h.Qe(this.h.sa(a));0==(this.h.Qe(a)&b)&&0==(c&b)&&(this.A[6]=1)}};b.prototype.AM=function(a,b,c,e){if(0!=this.A[7]&&1!=this.h.tb(this.h.fe(this.h.sa(a)),this.ni)){var d=this.h.jf(a),f=this.h.md(d);0==(f&b)&&0==(this.h.Qe(a)&b)&&(a=this.h.Sf(d,e),0!=(f&c)&&0!=a%2&&(this.A[7]=0))}};b.prototype.LO=function(a,b,c,e,d){if(1!=this.A[0]){var f=this.h.Gg(a);
0!=(f&b)&&0!=(f&c)?this.A[0]=1:0!=this.A[0]&&1!=this.h.tb(this.h.fe(this.h.sa(a)),this.ni)&&(a=this.h.jf(a),f=this.h.md(a),0!=(f&b)&&0!=(f&c)&&(b=this.h.Sf(a,e),d=this.h.Sf(a,d),0==b%2&&0==d%2&&(this.A[0]=0)))}};b.prototype.gD=function(a,b,c,e,d,f){if(0!=this.A[f]&&1!=this.h.tb(this.h.fe(this.h.sa(a)),this.ni)){a=this.h.jf(a);var g=this.h.md(a);0!=(g&b)&&0!=(g&c)&&(b=this.h.Sf(a,e),d=this.h.Sf(a,d),0==b%2&&0!=d%2&&(this.A[f]=0))}};b.prototype.hD=function(a,b,c,e){1!=this.A[e]&&(a=this.h.Gg(a),0!=
(a&b)&&0==(a&c)&&(this.A[e]=1))};b.prototype.mK=function(a,b,c,e,d){if(0!=this.A[4]&&1!=this.h.tb(this.h.fe(this.h.sa(a)),this.ni)){a=this.h.jf(a);var f=this.h.md(a);0!=(f&b)&&0!=(f&c)&&(b=this.h.Sf(a,e),d=this.h.Sf(a,d),0!=b%2&&0!=d%2&&(this.A[4]=0))}};b.prototype.fB=function(a,b,c,e){0!=this.A[e]&&1!=this.h.tb(this.h.fe(this.h.sa(a)),this.ni)&&(a=this.h.jf(a),0==(this.h.md(a)&b)&&0!=this.h.Sf(a,c)%2&&(this.A[e]=0))};b.prototype.JO=function(a,b){0!=this.A[0]&&0==(this.h.md(a)&b)&&0!=(this.h.pj(this.h.mw(a))&
b)&&(this.A[0]=0)};b.prototype.GO=function(a,b){2!=this.A[2]&&0!=(this.h.md(a)&b)&&(this.A[2]=2)};b.prototype.lK=function(a,b,c){0!=this.A[3]&&(a=this.h.md(a),0!=(a&b)&&0!=(a&c)&&(this.A[3]=0))};b.prototype.jK=function(a,b){1!=this.A[5]&&0!=(this.h.md(a)&b)&&(this.A[5]=1)};b.prototype.CM=function(a,b){0!=this.A[6]&&0==(this.h.md(a)&b)&&0==(this.h.pj(this.h.mw(a))&b)&&(this.A[6]=0)};b.prototype.MO=function(a,b,c,e){if(0!=this.A[0]){var d=this.h.md(a);0!=(d&b)&&0!=(d&c)&&0==this.h.Sf(a,e)%2&&(this.A[0]=
0)}};b.prototype.KO=function(a,b){1!=this.A[2]&&(-1!=this.h.te(a)?this.A[2]=1:0!=this.A[2]&&0==(this.h.md(a)&b)&&(this.A[2]=0))};b.prototype.oK=function(a,b,c,e){if(0!=this.A[3]){var d=this.h.md(a);0!=(d&b)&&0!=(d&c)&&0!=this.h.Sf(a,e)%2&&(this.A[3]=0)}};b.prototype.nK=function(a,b,c,e){if(0!=this.A[5]){var d=this.h.md(a);0!=(d&b)&&0==(d&c)&&0!=this.h.Sf(a,e)%2&&(this.A[5]=0)}};b.prototype.DM=function(a,b,c){0!=this.A[6]&&(a=this.h.md(a),0==(a&b)&&0!=(a&c)&&(this.A[6]=0))};b.prototype.NO=function(a,
b,c){0!=this.A[0]&&(a=this.h.md(a),0!=(a&b)&&0!=(a&c)&&(this.A[0]=0))};b.prototype.iD=function(a,b,c,e){0!=this.A[e]&&(a=this.h.md(a),0!=(a&b)&&0==(a&c)&&(this.A[e]=0))};b.prototype.so=function(b,c){var e=!1;b=this.h.ya(b);c=this.h.ya(c);this.ni=this.h.Eg();for(var d=this.h.Be;-1!=d;d=this.h.Bf(d)){var f=this.h.te(d);if(-1==f){if(-1!=this.Nl)switch(this.Nl){case 3:e=this.bB(d,b,c);break;case 4:e=this.DD(d,b,c);break;default:throw a.g.ra("internal error");}}else{var g=f;do{var k=g;if(1!=this.h.tb(k,
this.ni)){do{switch(this.$t){case 0:e=this.aK(k,b,c);break;case 1:e=this.bK(k,b,c);break;case 2:e=this.uP(k,b,c);break;default:throw a.g.ra("internal error");}if(e)break;this.h.Bb(k,this.ni,1);k=this.h.Wb(k)}while(k!=g&&!e)}if(e)break;g=this.h.Wb(this.h.sa(k))}while(g!=f);if(e)break}}e||this.SF();this.h.kh(this.ni)};b.prototype.Pv=function(b,c){var e=!1;b=this.h.ya(b);c=this.h.ya(c);for(var d=this.h.Be;-1!=d;d=this.h.Bf(d)){switch(this.Nl){case 3:e=this.bB(d,b,c);break;case 4:e=this.DD(d,b,c);break;
case 5:e=this.JQ(d,b,c);break;default:throw a.g.wa();}if(e)break}e||this.SF()};b.prototype.Op=function(a,b){this.h.Mp(a,b)};b.prototype.In=function(a,b,c){this.tM(a,b,c);this.Op(a,c)};b.prototype.tM=function(b,c,e){a.aj.$(b,c,e,!1);b.xo(0,!0,!0);for(c=b.$c;-1!=c;c=b.we(c))1736==b.Lb(c)&&a.mm.$(b,c,-1,!1,e)};b.NB=function(b,c){var e=b.D();if(a.T.Lc(e))return e=new a.Xa(b.description),e.Bc(b,!0),e;if(197==e){e=new a.i;b.o(e);if(e.ba()<=c&&e.aa()<=c)return e=new a.Va(b.description),b.Af(e),e;if(e.ba()<=
c||e.aa()<=c)return e=new a.Xa(b.description),c=new a.Va,b.uf(0,c),e.df(c),b.uf(2,c),e.lineTo(c),e;e=new a.Ka(b.description);e.Wc(b,!1);return e}return b};return b}();a.el=b})(z||(z={}));(function(a){var b=function(){function b(b){this.Dl=new a.ga(0);this.Ot=new a.ga(0);this.Ar=new a.b;this.Br=new a.b;this.a=b;this.Tq=-1}b.prototype.cc=function(a){return this.a.cc(this.Jw(a))};b.prototype.ot=function(a){var b=this.tw(a);a=this.vC(a);if(this.a.Ua(b)==a){var c=b,b=a;a=c}this.a.uc(b,this.Ar);this.a.uc(a,
this.Br);return this.Ar.y<this.Br.y};b.prototype.Jw=function(a){var b=this.tw(a);a=this.vC(a);return this.a.X(b)==a?b:a};b.prototype.tw=function(a){return this.Dl.get(a)};b.prototype.vC=function(a){return this.Ot.get(a)};b.prototype.hC=function(a){this.Dl.set(a,this.Tq);this.Tq=a};b.prototype.GE=function(b){if(-1!=this.Tq){var c=this.Tq;this.Tq=this.Dl.get(c);this.Dl.set(c,b);this.Ot.set(c,this.a.X(b));return c}null==this.Dl&&(this.Dl=new a.ga(0),this.Ot=new a.ga(0));c=this.Dl.size;this.Dl.add(b);
this.Ot.add(this.a.X(b));return c};b.prototype.Dw=function(a){return this.a.rd(this.tw(a))};return b}();a.BT=b;var c=function(){function b(b){this.me=b;this.Vd=new a.yb;this.Kl=new a.yb;this.eE=0;this.on=null;this.zx=-1}b.prototype.compare=function(a,b,c){c=a.da(c);var e=this.me.$a,d;this.zx==b?d=this.eE:(this.on=e.cc(b),null==this.on?(a=e.a,a.Oc(e.Jw(b),this.Vd),this.on=this.Vd,d=this.Vd.xe(this.me.Zg,0)):d=this.on.xe(this.me.Zg,0),this.eE=d,this.zx=b);a=e.cc(c);var f;null==a?(a=e.a,a.Oc(e.Jw(c),
this.Kl),a=this.Kl,f=this.Kl.xe(this.me.Zg,0)):f=a.xe(this.me.Zg,0);d==f&&(b=e.ot(b),c=e.ot(c),c=Math.min(b?this.on.ha:this.on.ja,c?a.ha:a.ja),b=.5*(c+this.me.Zg),b==this.me.Zg&&(b=c),d=this.on.xe(b,0),f=a.xe(b,0));return d<f?-1:d>f?1:0};b.prototype.reset=function(){this.zx=-1};return b}(),e=function(){function e(){this.Rl=this.Dk=null;this.Za=new a.bj;this.Za.lM();this.Ld=new c(this);this.Za.Hn(this.Ld)}e.prototype.XM=function(){var b=!1;this.Qt&&(b=this.YM());if(1==this.a.ea(this.U)){var c=this.a.Vb(this.U),
b=this.a.Gw(c);this.a.Dy(c,!0);return 0>b?(b=this.a.Cb(c),this.a.lF(b),this.a.Wi(c,this.a.Ua(b)),!0):!1}this.Ak=this.a.Uv();this.kn=this.a.Uv();for(c=this.a.Vb(this.U);-1!=c;c=this.a.bc(c))this.a.Rp(c,this.Ak,0),this.a.Rp(c,this.kn,-1);c=new a.ga(0);this.Zg=NaN;var e=new a.b;this.lr=this.a.ea(this.U);this.fn=this.a.re();this.br=this.a.re();for(var d=this.Dk.gc(this.Dk.Wd);-1!=d;d=this.Dk.bb(d)){var f=this.Dk.getData(d);this.a.uc(f,e);e.y!=this.Zg&&0!=c.size&&(b=this.yr(c)||b,this.Ld.reset(),c.clear(!1));
c.add(f);this.Zg=e.y;if(0==this.lr)break}0<this.lr&&(b=this.yr(c)||b,c.clear(!1));this.a.bf(this.fn);this.a.bf(this.br);for(c=this.a.Vb(this.U);-1!=c;)if(3==this.a.Ei(c,this.Ak)){this.a.Dy(c,!0);e=c;for(c=this.a.Ei(c,this.kn);-1!=c;)d=this.a.Ei(c,this.kn),this.a.bQ(this.U,this.a.bc(e),c),e=c,c=d;c=this.a.bc(e)}else this.a.Dy(c,!1),c=this.a.bc(c);this.a.ty(this.Ak);this.a.ty(this.kn);return b};e.prototype.yr=function(a){return this.WQ(a)};e.prototype.WQ=function(c){var e=!1;null==this.$a&&(this.$a=
new b(this.a));null==this.Rl?(this.Rl=new a.ga(0),this.Rl.xb(16)):this.Rl.clear(!1);this.VQ(c);for(var d=0,f=c.size;d<f;d++){var g=c.get(d);-1!=g&&this.bD(g,-1)}for(d=0;d<this.Rl.size&&0<this.lr;d++)if(c=this.Rl.get(d),g=this.$a.Dw(this.Za.da(c)),f=-1,0==this.a.Ei(g,this.Ak)){for(var g=this.Za.ge(c),k=c,h;-1!=g;){var n=this.Za.da(g),p=this.$a.Dw(n),q=this.a.Ei(p,this.Ak);if(0!=q){f=p;break}k=g;g=this.Za.ge(g)}-1==g?(h=!0,g=k):(n=this.Za.da(g),h=this.$a.ot(n),g=this.Za.bb(g),h=!h);do{n=this.Za.da(g);
p=this.$a.Dw(n);q=this.a.Ei(p,this.Ak);if(0==q&&(h!=this.$a.ot(n)&&(e=this.a.Cb(p),this.a.lF(e),this.a.Wi(p,this.a.Ua(e)),e=!0),this.a.Rp(p,this.Ak,h?3:2),h||(k=this.a.Ei(f,this.kn),this.a.Rp(f,this.kn,p),this.a.Rp(p,this.kn,k)),this.lr--,0==this.lr))return e;f=p;k=g;g=this.Za.bb(g);h=!h}while(k!=c)}return e};e.prototype.VQ=function(a){for(var b=0,c=a.size;b<c;b++){var e=a.get(b),d=this.a.Ra(e,this.fn),f=this.a.Ra(e,this.br);if(-1!=d){var g=this.Za.da(d);this.$a.hC(g);this.a.lb(e,this.fn,-1)}-1!=
f&&(g=this.Za.da(f),this.$a.hC(g),this.a.lb(e,this.br,-1));g=-1;-1!=d&&-1!=f?(this.Za.kd(d,-1),this.Za.kd(f,-1),a.set(b,-1)):g=-1!=d?d:f;-1!=g&&(this.bD(e,g)||this.Za.kd(g,-1),a.set(b,-1))}};e.prototype.bD=function(b,c){var e=new a.b,d=new a.b;this.a.uc(b,e);var f=this.a.X(b);this.a.uc(f,d);var g=!1;if(e.y<d.y){var g=!0,k=this.$a.GE(b),h;-1==c?h=this.Za.addElement(k,-1):(h=c,this.Za.Vi(h,k));k=this.a.Ra(f,this.fn);-1==k?this.a.lb(f,this.fn,h):this.a.lb(f,this.br,h);f=this.a.rd(b);0==this.a.Ei(f,this.Ak)&&
this.Rl.add(h)}f=this.a.Ua(b);this.a.uc(f,d);e.y<d.y&&(g=!0,k=this.$a.GE(f),-1==c?h=this.Za.addElement(k,-1):(h=c,this.Za.Vi(h,k)),k=this.a.Ra(f,this.fn),-1==k?this.a.lb(f,this.fn,h):this.a.lb(f,this.br,h),f=this.a.rd(b),0==this.a.Ei(f,this.Ak)&&this.Rl.add(h));return g};e.$=function(a,b,c,d){var f=new e;f.a=a;f.U=b;f.Dk=c;f.Qt=d;return f.XM()};e.prototype.YM=function(){var b=new a.ga(0),c=new a.ga(0),e=-1,d=-1,f=new a.b;f.Eh();for(var g=-1,k=-1,h=-1,n=new a.b,p=this.Dk.gc(this.Dk.Wd);-1!=p;p=this.Dk.bb(p)){var q=
this.Dk.getData(p);this.a.uc(q,n);var l=this.a.rd(q);f.ub(n)&&k==l?(-1==d&&(e=this.a.Uv(),d=this.a.re()),-1==h&&(h=c.size,this.a.lb(g,d,h),c.add(1),-1==this.a.Ei(l,e)&&(this.a.Rp(l,e,g),b.add(l))),this.a.lb(q,d,h),c.JF(c.tc()+1)):(h=-1,f.J(n));g=q;k=l}if(0==b.size)return!1;f=new a.ga(0);g=new a.ga(0);k=0;for(h=b.size;k<h;k++){var l=b.get(k),r=this.a.Ei(l,e),q=this.a.Ra(r,d);f.clear(!1);g.clear(!1);f.add(r);g.add(q);for(q=this.a.X(r);q!=r;q=this.a.X(q)){var t=q,n=this.a.Ra(t,d);if(-1!=n)if(0==g.size)g.add(n),
f.add(t);else if(g.tc()==n){var p=f.tc(),u=this.a.X(p),r=this.a.X(t);this.a.Sc(p,r);this.a.Tc(r,p);this.a.Sc(t,u);this.a.Tc(u,t);t=[!1];u=this.a.aD(this.U,u,this.a.Cb(l),t);this.a.lb(q,d,-1);t[0]&&this.a.Dh(l,r);q=this.a.Ha(l);r=this.a.Ha(u);q-=r;this.a.hm(l,q);c.set(n,c.get(n)-1);1==c.get(n)&&(c.set(n,0),g.af(),f.af());q=r=p}else f.add(q),g.add(n)}}this.a.ty(e);this.a.bf(d);return!0};return e}();a.AI=e})(z||(z={}));(function(a){var b=function(){function b(){}b.prototype.Ag=function(){this.Mx=this.ib=
null};b.prototype.get=function(){return this.Mx};b.prototype.set=function(b){this.Mx=b;if(null!=b)throw 322==b.D()&&(this.ib=b),a.g.wa();};b.prototype.create=function(b){if(322==b)this.mq();else throw a.g.ra("Not Implemented");};b.prototype.mq=function(){null==this.ib&&(this.ib=new a.yb);this.Mx=this.ib};return b}();a.Ag=b})(z||(z={}));(function(a){a=a.FI||(a.FI={});a[a.enumLineSeg=1]="enumLineSeg";a[a.enumBezierSeg=2]="enumBezierSeg";a[a.enumArcSeg=4]="enumArcSeg";a[a.enumNonlinearSegmentMask=6]=
"enumNonlinearSegmentMask";a[a.enumSegmentMask=7]="enumSegmentMask";a[a.enumDensified=8]="enumDensified"})(z||(z={}));(function(a){var b=function(){return function(a){this.ri=a;this.dz=this.ez=1;this.ky=this.jy=this.ly=0}}(),c=function(){function c(){this.op=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.Ij=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.nf=new a.Va;this.ka=this.fu=0;this.an=[];this.ir=[];this.bu=[];this.qp=[];this.Jx=[]}c.prototype.ny=function(a){if(null!=a){for(var b=0,c=a.length;b<c;b++)this.oR(a[b]);
a.length=0}};c.prototype.oR=function(a){a.ri=null;this.qp.push(a)};c.prototype.nu=function(a){if(0===this.qp.length)var c=new b(a);else c=this.qp[this.qp.length-1],c.ri=a,--this.qp.length;return c};c.prototype.dO=function(a,b){return 0==a?this.ir[b]:this.bu[b]};c.prototype.Zx=function(){this.fu>=this.Jx.length&&this.Jx.push(new a.Ag);var b=this.Jx[this.fu];this.fu++;return b};c.prototype.clear=function(){this.ny(this.an);this.ny(this.ir);this.ny(this.bu);this.fu=0};c.prototype.zn=function(a){this.an.push(this.nu(a))};
c.prototype.kk=function(a){return 0==a?this.ir.length:this.bu.length};c.prototype.Io=function(a,b){return this.dO(a,b).ri};c.prototype.Ga=function(b,c){if(2!=this.an.length)throw a.g.wa();this.ka=b;var e=a.vi.Ty(.01*b),d=!1,f=this.an[0],g=this.an[1];if(c||0!=(f.ri.fq(g.ri,b,!0)&5)){if(322==f.ri.D()&&(c=f.ri,322==g.ri.D())){var k=g.ri,h=a.yb.ov(c,k,null,this.op,this.Ij,b);if(0==h)throw a.yb.ov(c,k,null,this.op,this.Ij,b),a.g.wa();b=Array(9);a.I.Ps(b,null);for(var n=0;n<h;n++){var p=this.op[n],q=this.Ij[n],
l=f.ky,r=1;0==p?(l=f.ly,r=f.ez):1==p&&(l=f.jy,r=f.dz);var t=g.ky,u=1;0==q?(t=g.ly,u=g.ez):1==q&&(t=g.jy,u=g.dz);var w=new a.b;l==t?(l=new a.b,c.Kb(p,l),p=new a.b,k.Kb(q,p),q=r+u,u/=q,a.vi.BD(l,p,u,w),a.b.Zb(w,l)+a.b.Zb(w,p)>e&&(d=!0)):l>t?(c.Kb(p,w),p=new a.b,k.Kb(q,p),a.b.Zb(w,p)>e&&(d=!0)):(k.Kb(q,w),l=new a.b,c.Kb(p,l),a.b.Zb(w,l)>e&&(d=!0));b[n]=w}f=0;g=-1;for(n=0;n<=h;n++)u=n<h?this.op[n]:1,u!=f&&(e=this.Zx(),c.Bi(f,u,e),-1!=g&&e.get().ed(b[g]),n!=h&&e.get().vd(b[n]),f=u,this.ir.push(this.nu(e.get()))),
g=n;c=[0,0,0,0,0,0,0,0,0];for(n=0;n<h;n++)c[n]=n;1<h&&this.Ij[0]>this.Ij[1]&&(u=this.Ij[0],this.Ij[0]=this.Ij[1],this.Ij[1]=u,n=c[0],c[0]=c[1],c[1]=n);f=0;g=-1;for(n=0;n<=h;n++)u=n<h?this.Ij[n]:1,u!=f&&(e=this.Zx(),k.Bi(f,u,e),-1!=g&&(f=c[g],e.get().ed(b[f])),n!=h&&(f=c[n],e.get().vd(b[f])),f=u,this.bu.push(this.nu(e.get()))),g=n;return d}throw a.g.wa();}return!1};c.prototype.Tw=function(b,c,e){c.copyTo(this.nf);if(1!=this.an.length)throw a.g.wa();this.ka=b;var d=this.an[0];if(e||d.ri.qs(c.w(),b,
!0))if(322==d.ri.D()){b=d.ri;var f=b.Gd(c.w(),!1);this.op[0]=f;var g=d.ky;e=1;0==f?(g=d.ly,e=d.ez):1==f&&(g=d.jy,e=d.dz);d=new a.b;0==g?(g=new a.b,b.Kb(f,g),c=c.w(),a.vi.BD(g,c,1/(e+1),d)):0<g?(d=new a.b,b.Kb(f,d)):d=c.w();e=0;f=-1;for(g=0;1>=g;g++){c=1>g?this.op[g]:1;if(c!=e){var k=this.Zx();b.Bi(e,c,k);-1!=f&&k.get().ed(d);1!=g&&k.get().vd(d);e=c;this.ir.push(this.nu(k.get()))}f=g}this.nf.ic(d)}else throw a.g.wa();};return c}();a.gA=c})(z||(z={}));(function(a){var b=function(){function b(b){this.Pq=
this.yj=this.ib=null;this.zk=this.Ee=this.Gc=this.ze=this.Sg=this.Qa=0;this.ab=null;this.zl=!1;this.ze=-1;this.Sg=this.Gc=0;this.Qa=-1;this.ab=b;this.Ee=this.eq(this.Sg);this.zl=!1;this.yj=null;this.zk=-1;this.Pq=new a.b}b.Yn=function(c,e){if(0>e||e>=c.F())throw a.g.Uc();var d=new b(c),f=c.Ew(e);d.Gc=e-c.Ea(f);d.Sg=f+1;d.Qa=f;d.Ee=d.eq(d.Qa);d.zk=d.ab.Ea(d.Qa);return d};b.Un=function(c,e,d){if(0>e||e>=c.ea()||0>d)throw a.g.Uc();var f=c.vc(e)?0:1;if(d>=c.Ha(e)-f)throw a.g.Uc();c=new b(c);c.ze=-1;c.Gc=
d;c.Qa=e;c.Sg=c.Gc+1;c.Ee=c.eq(c.Sg);c.zk=c.ab.Ea(c.Qa);return c};b.prototype.xR=function(b){if(this.ab!=b.ab)throw a.g.xa();this.ze=b.ze;this.Gc=b.Gc;this.Qa=b.Qa;this.Sg=b.Sg;this.Ee=b.Ee;this.zl=b.zl;this.zk=b.zk;this.yj=null};b.prototype.ia=function(){this.ze!=this.Gc&&this.JA();if(this.zl)this.Gc=(this.Gc+1)%this.Ee;else{if(this.Gc==this.Ee)throw a.g.Uc();this.Gc++}return this.yj};b.prototype.oi=function(){if(this.zl)this.Gc=(this.Ee+this.Gc-1)%this.Ee;else{if(0==this.Gc)throw a.g.Uc();this.Gc--}this.Gc!=
this.ze&&this.JA();return this.yj};b.prototype.yR=function(){this.ze=-1;this.Gc=0};b.prototype.zR=function(){this.Gc=this.Ee;this.ze=-1};b.prototype.Sb=function(a,b){void 0===b&&(b=-1);if(0<=this.Qa&&this.Qa<this.ab.ea()){var c=this.uJ();if(a>=c&&a<this.ab.Dc(this.Qa)){this.ze=-1;this.Gc=a-c;return}}c=0<=b&&b<this.ab.ea()&&a>=this.ab.Ea(b)&&a<this.ab.Dc(b)?b:this.ab.Ew(a);this.Sg=c+1;this.Qa=c;this.ze=-1;this.Gc=a-this.ab.Ea(c);this.Ee=this.eq(c);this.zk=this.ab.Ea(this.Qa)};b.prototype.kb=function(){this.Qa=
this.Sg;if(this.Qa>=this.ab.ea())return!1;this.ze=-1;this.Gc=0;this.Ee=this.eq(this.Qa);this.zk=this.ab.Ea(this.Qa);this.Sg++;return!0};b.prototype.Lk=function(){this.Ee=this.Gc=this.ze=-1;this.Sg=0;this.zk=this.Qa=-1};b.prototype.vy=function(b){if(0>b)throw a.g.Uc();this.Sg=b;this.zk=this.Ee=this.Gc=this.ze=this.Qa=-1};b.prototype.eq=function(a){if(this.ab.sc())return 0;var b=1;this.ab.vc(a)&&(b=0);return this.ab.Ha(a)-b};b.prototype.lD=function(){return this.ze==this.Ee-1&&this.ab.vc(this.Qa)};
b.prototype.NR=function(){this.zl=!0};b.prototype.Jb=function(){return this.ab.jb.f[this.Qa]+this.ze};b.prototype.uJ=function(){return this.ab.Ea(this.Qa)};b.prototype.Bm=function(){return this.lD()?this.ab.Ea(this.Qa):this.Jb()+1};b.prototype.wl=function(){return 0==this.ze};b.prototype.Jm=function(){return this.ze==this.Ee-1};b.prototype.La=function(){return this.Gc<this.Ee};b.prototype.Ow=function(){return 0<this.Gc};b.prototype.vm=function(){var a=new b(this.ab);a.ze=this.ze;a.Gc=this.Gc;a.Ee=
this.Ee;a.Qa=this.Qa;a.Sg=this.Sg;a.ab=this.ab;a.zl=this.zl;return a};b.prototype.JA=function(){if(0>this.Gc||this.Gc>=this.Ee)throw a.g.Uc();this.ze=this.Gc;var b=this.Jb();this.ab.kc();var c=this.ab.Fe,e=1;null!=c&&(e=c.read(b)&7);c=this.ab.description;switch(e){case 1:null==this.ib&&(this.ib=new a.yb);this.yj=this.ib;break;case 2:throw a.g.ra("internal error");case 4:throw a.g.wa();default:throw a.g.wa();}this.yj.Qf(c);e=this.Bm();this.ab.uc(b,this.Pq);this.yj.ed(this.Pq);this.ab.uc(e,this.Pq);
this.yj.vd(this.Pq);for(var d=1,f=c.Aa;d<f;d++)for(var g=c.Hd(d),k=a.pa.Wa(g),h=0;h<k;h++){var n=this.ab.ld(g,b,h);this.yj.My(g,h,n);n=this.ab.ld(g,e,h);this.yj.Cy(g,h,n)}};b.prototype.YO=function(){return this.Qa==this.ab.ea()-1};return b}();a.GI=b})(z||(z={}));(function(a){var b=function(){function b(b){b instanceof a.T?(this.ZD=b,this.ua=-1,this.Wh=1):(this.DP=b.slice(0),this.ua=-1,this.Wh=b.length)}b.prototype.ya=function(){return this.ua};b.prototype.next=function(){return this.ua<this.Wh-1?
(this.ua++,null!=this.ZD?this.ZD:this.DP[this.ua]):null};return b}();a.Pc=b})(z||(z={}));(function(a){var b=function(){return function(){this.next=null}}(),c=function(){function c(){this.Cp=this.ju=this.ku=this.vj=this.eh=0;this.aC=!1;this.eG=0;this.am=this.wf=this.Vk=this.hh=null;this.Mk=0;this.Kv=null;this.vj=this.eh=-1}c.prototype.vS=function(b,c,e){this.eh=b;this.vj=c;this.hh=this.Vk=null;this.Cp=0;this.Kv=e;null==this.am&&(this.am=a.I.Lh(384,0));this.hG()};c.prototype.aa=function(){return this.eh};
c.prototype.ba=function(){return this.vj};c.prototype.flush=function(){0<this.Mk&&(this.Kv.XB(this.am,this.Mk),this.Mk=0)};c.prototype.hG=function(){if(0<this.Cp){for(var a=0;a<this.vj;a++){for(var b=this.Vk[a];null!=b;){var c=b,b=b.next;c.next=null}this.Vk[a]=null}this.hh=null}this.ku=this.vj;this.ju=-1;this.Cp=0};c.prototype.fF=function(a){this.aC=a==c.$u;for(a=this.ku;a<=this.ju;a++)this.VJ(),this.PJ(a),this.vM();this.hG()};c.prototype.zv=function(c,e,d,f){if(e!=f){var g=1;e>f&&(g=c,c=d,d=g,g=
e,e=f,f=g,g=-1);if(!(0>f||e>=this.vj)){0>c&&0>d?d=c=-1:c>=this.eh&&d>=this.eh&&(d=c=this.eh);var k=(d-c)/(f-e);f>this.vj&&(f=this.vj,d=k*(f-e)+c);0>e&&(c=k*(0-e)+c,e=0);var h=Math.max(this.eh+1,8388607);-8388607>c?(e=(0-c)/k+e,c=0):c>h&&(e=(this.eh-c)/k+e,c=this.eh);-8388607>d?f=(0-c)/k+e:d>h&&(f=(this.eh-c)/k+e);e=a.I.truncate(e);f=a.I.truncate(f);e!=f&&(d=new b,d.x=a.I.truncate(4294967296*c),d.y=e,d.G=f,d.pM=a.I.truncate(4294967296*k),d.dir=g,null==this.Vk&&(this.Vk=a.I.Lh(this.vj,null)),d.next=
this.Vk[d.y],this.Vk[d.y]=d,d.y<this.ku&&(this.ku=d.y),d.G>this.ju&&(this.ju=d.G),this.Cp++)}}};c.prototype.VJ=function(){if(null!=this.hh){for(var a=!1,b=null,c=this.hh;null!=c;)if(c.y++,c.y==c.G){var e=c,c=c.next;null!=b?b.next=c:this.hh=c;e.next=null}else c.x+=c.pM,null!=b&&b.x>c.x&&(a=!0),b=c,c=c.next;a&&(this.hh=this.dG(this.hh))}};c.prototype.PJ=function(a){if(!(a>=this.vj)){var b=this.Vk[a];if(null!=b){this.Vk[a]=null;b=this.dG(b);this.Cp-=this.eG;a=this.hh;for(var c=!0,e=b,d=null;null!=a&&
null!=e;)a.x>e.x?(c&&(this.hh=e),c=e.next,e.next=a,null!=d&&(d.next=e),d=e,e=c):(c=a.next,a.next=e,null!=d&&(d.next=a),d=a,a=c),c=!1;null==this.hh&&(this.hh=b)}}};c.Mz=function(a,b){return 0>a?0:a>b?b:a};c.prototype.vM=function(){if(null!=this.hh)for(var b=0,e=this.hh,d=a.I.truncate(a.I.FD(e.x)),f=e.next;null!=f;f=f.next)if(b=this.aC?b^1:b+f.dir,f.x>e.x){var g=a.I.truncate(a.I.FD(f.x));0!=b&&(e=c.Mz(d,this.eh),d=c.Mz(g,this.eh),d>e&&e<this.eh&&(this.am[this.Mk++]=e,this.am[this.Mk++]=d,this.am[this.Mk++]=
f.y,this.Mk==this.am.length&&(this.Kv.XB(this.am,this.Mk),this.Mk=0)));e=f;d=g}};c.prototype.dG=function(b){for(var e=0,d=b;null!=d;d=d.next)e++;this.eG=e;if(1==e)return b;null==this.wf?this.wf=a.I.Lh(Math.max(e,16),null):this.wf.length<e&&(this.wf=a.I.Lh(Math.max(e,2*this.wf.length),null));for(var f=0,d=b;null!=d;d=d.next)this.wf[f++]=d;2==e?this.wf[0].x>this.wf[1].x&&(b=this.wf[0],this.wf[0]=this.wf[1],this.wf[1]=b):c.pP(this.wf,e,function(a,b){return a==b?0:a.x<b.x?-1:a.x>b.x?1:0});b=this.wf[0];
this.wf[0]=null;d=b;for(f=1;f<e;f++)d.next=this.wf[f],d=this.wf[f],this.wf[f]=null;d.next=null;return b};c.pP=function(a,b,c){if(b==a.length)a.sort(c);else{var e=a.slice(0,0),d=a.slice(b);b=a.slice(0,b).sort(c);a.length=0;a.push.apply(a,e.concat(b).concat(d))}};c.$u=0;c.sT=1;return c}();a.ev=c})(z||(z={}));(function(a){var b=function(){function b(){}b.prototype.Jh=function(a,b){var c=this.a.Ra(a,this.vp);this.yk==c&&(this.yk=this.$d.bb(this.yk));this.Xm==c&&(this.Xm=this.$d.bb(this.Xm));this.$d.Jc(this.Ox,
c);this.hj(a);if(b&&(c=this.a.rd(a),-1!=c&&this.a.Cb(c)==a)){b=this.a.X(a);if(b!=a){var e=this.a.rd(b);if(e==c){this.a.Dh(c,b);return}b=this.a.Ua(a);if(b!=a&&(e=this.a.rd(b),e==c)){this.a.Dh(c,b);return}}this.a.Dh(c,-1);this.a.Wi(c,-1)}};b.prototype.yA=function(){for(var b=!1,c=0,e=new a.b;;){c++;null==this.nh?(this.nh=new a.ga(0),this.Mq=new a.ga(0),this.ie=new a.ga(0)):(this.nh.clear(!1),this.Mq.clear(!1),this.ie.clear(!1));for(var d=this.Xm,f=0,g=!0;d!=this.yk;){var k=this.$d.getData(d),h=new a.b;
this.a.uc(k,h);g&&(this.a.uc(k,e),g=!1);var h=this.a.Ua(k),n=this.a.X(k);-559038737!=this.a.Ra(h,this.fg)&&(this.nh.add(h),this.a.lb(h,this.fg,-559038737),this.Mq.add(k),this.ie.add(f++));-559038737!=this.a.Ra(n,this.fg)&&(this.nh.add(n),this.a.lb(n,this.fg,-559038737),this.Mq.add(k),this.ie.add(f++));d=this.$d.bb(d)}if(2>this.nh.size)break;var q=this;this.ie.xd(0,this.ie.size,function(a,b){return q.mJ(a,b)});d=0;for(f=this.ie.size;d<f;d++)g=this.ie.get(d),g=this.nh.get(g),this.a.lb(g,this.fg,d),
h=new a.b,this.a.uc(g,h);h=this.zJ(e);d=0;for(f=this.ie.size;d<f;d++)g=this.ie.get(d),-1!=g&&(g=this.nh.get(g),this.a.lb(g,this.fg,-1));if(h)b=!0;else break}return b};b.prototype.zJ=function(a){for(var b=!1,c=!0;c;){var c=!1,e=0;-1==this.ie.get(e)&&(e=this.fl(e));for(var d=this.fl(e),f=0,g=this.ie.size;f<g&&-1!=e&&-1!=d&&e!=d;f++){var k=this.ie.get(e),d=this.ie.get(d),k=this.nh.get(k),d=this.nh.get(d),h=this.a.X(k);this.a.pt(h,a)||(h=this.a.Ua(k));var n=this.a.X(d);this.a.pt(n,a)||(n=this.a.Ua(d));
var q=this.os(h,k),l=this.os(n,d),r=q?this.a.Ua(h):this.a.X(h),t=l?this.a.Ua(n):this.a.X(n),u=!1;this.io(h)?u=!0:this.io(n)?u=!0:this.io(k)?u=!0:this.io(d)?u=!0:this.io(r)?u=!0:this.io(t)&&(u=!0);!u&&this.a.Cq(k,d)&&(u=!0,this.BA(q,l,h,k,n,d));!u&&this.a.Cq(r,t)&&(u=!0,this.BA(!q,!l,h,r,n,t));u&&(b=!0);c=c||u;e=this.fl(e);d=this.fl(e)}}if(!b)for(e=0,-1==this.ie.get(e)&&(e=this.fl(e)),d=this.fl(e),f=0,g=this.ie.size;f<g&&-1!=e&&-1!=d&&e!=d;f++)k=this.ie.get(e),d=this.ie.get(d),k=this.nh.get(k),d=this.nh.get(d),
h=this.a.X(k),this.a.pt(h,a)||(h=this.a.Ua(k)),n=this.a.X(d),this.a.pt(n,a)||(n=this.a.Ua(d)),q=this.os(h,k),l=this.os(n,d),r=q?this.a.Ua(h):this.a.X(h),t=l?this.a.Ua(n):this.a.X(n),this.qJ(q,l,k,h,r,d,n,t)&&(b=!0),e=this.fl(e),d=this.fl(e);return b};b.prototype.CJ=function(){1736==this.a.Lb(this.U)&&1==this.a.Cm(this.U)&&(new a.Of).DQ(this.Qt,this.a,this.U,this.oe);var b=!1,c=!0;this.fg=this.vp=-1;var e=this.a.F(this.U),d=new a.ga(0);d.xb(e);for(var f=this.a.Vb(this.U);-1!=f;f=this.a.bc(f))for(var g=
this.a.Cb(f),k=0,h=this.a.Ha(f);k<h;k++)d.add(g),g=this.a.X(g);var n=this.a.cd.f,q=this.a.cd.Ic;this.a.wb.kc();var l=this.a.wb.Ba[0].f;d.xd(0,e,function(a,b){var c=n[q*a],e=n[q*b],d=l[2*c],c=l[2*c+1],f=l[2*e],e=l[2*e+1],d=c<e?-1:c>e?1:d<f?-1:d>f?1:0;0==d&&(d=n[q*a+3],e=n[q*b+3],d=d<e?-1:d==e?0:1);return d});this.vp=this.a.re();this.$d=new a.$n;this.Ox=this.$d.jh(0);this.$d.$l(e);for(f=0;f<e;f++)g=d.get(f),k=this.$d.addElement(this.Ox,g),this.a.lb(g,this.vp,k);this.fg=this.a.re();this.yk=-1;for(this.sA()&&
(b=!0);c;){c=!1;e=0;d=!1;do{d=!1;this.Xm=-1;for(var h=0,f=new a.b,k=new a.b,r=this.$d.gc(this.Ox);-1!=r;)g=this.$d.getData(r),-1!=this.Xm?(this.a.uc(g,k),f.ub(k))?h++:(f.J(k),this.yk=r,0<h&&(g=this.yA())&&(d=!0,-1!=this.yk&&(g=this.$d.getData(this.yk),this.a.uc(g,f))),this.Xm=r=this.yk,h=0):(this.Xm=r,this.a.uc(this.$d.getData(r),f),h=0),-1!=r&&(r=this.$d.bb(r));this.yk=-1;0<h&&(g=this.yA())&&(d=!0);if(10<e++)throw a.g.wa();d&&this.tJ();this.sA()&&(d=!0);c=c||d&&!1;b=b||d}while(d)}this.a.bf(this.vp);
this.a.bf(this.fg);return b=a.AI.$(this.a,this.U,this.$d,this.Qt)||b};b.prototype.os=function(a,b){return this.a.X(b)==a?!1:!0};b.prototype.qJ=function(a,b,c,e,d,f,g,k){if(e==g)return this.hj(c),this.hj(f),!1;var h=this.a.Ra(c,this.fg),n=this.a.Ra(d,this.fg),q=this.a.Ra(f,this.fg),p=this.a.Ra(k,this.fg);c=[0,0,0,0,0,0,0,0];var l=[0,0,0,0];c[0]=0;l[0]=h;c[1]=0;l[1]=n;c[2]=1;l[2]=q;c[3]=1;l[3]=p;for(h=1;4>h;h++){n=l[h];q=c[h];for(p=h-1;0<=p&&l[p]>n;)l[p+1]=l[p],c[p+1]=c[p],p--;l[p+1]=n;c[p+1]=q}l=0;
0!=c[0]&&(l|=1);0!=c[1]&&(l|=2);0!=c[2]&&(l|=4);0!=c[3]&&(l|=8);if(5!=l&&10!=l)return!1;a==b?a?(this.a.Sc(k,e),this.a.Tc(e,k),this.a.Sc(d,g),this.a.Tc(g,d)):(this.a.Tc(k,e),this.a.Sc(e,k),this.a.Tc(d,g),this.a.Sc(g,d)):a?(this.a.Tc(e,f),this.a.Sc(f,e),this.a.Tc(g,d),this.a.Sc(d,g)):(this.a.Sc(e,f),this.a.Tc(f,e),this.a.Sc(g,d),this.a.Tc(d,g));return!0};b.prototype.BA=function(a,b,c,e,d,f){this.pU?this.BJ():this.AJ(a,b,c,e,d,f)};b.prototype.BJ=function(){throw a.g.ra("not implemented.");};b.prototype.AJ=
function(a,b,c,e,d,f){if(a!=b)a?(this.a.Sc(c,d),this.a.Tc(d,c),this.a.Sc(f,e),this.a.Tc(e,f),this.pm(d,c),this.Jh(d,!0),this.a.Ui(d,!0),this.hj(c),this.pm(f,e),this.Jh(f,!0),this.a.Ui(f,!1)):(this.a.Sc(d,c),this.a.Tc(c,d),this.a.Sc(e,f),this.a.Tc(f,e),this.pm(d,c),this.Jh(d,!0),this.a.Ui(d,!1),this.hj(c),this.pm(f,e),this.Jh(f,!0),this.a.Ui(f,!0)),this.hj(e);else{var g=a?c:e,k=b?d:f;a=a?e:c;b=b?f:d;d=!1;this.a.Sc(g,k);this.a.Sc(k,g);this.a.Tc(a,b);this.a.Tc(b,a);for(f=b;f!=k;)c=this.a.Ua(f),e=this.a.X(f),
this.a.Tc(f,e),this.a.Sc(f,c),d=d||f==g,f=e;d||(c=this.a.Ua(k),e=this.a.X(k),this.a.Tc(k,e),this.a.Sc(k,c));this.pm(k,g);this.Jh(k,!0);this.a.Ui(k,!1);this.hj(g);this.pm(b,a);this.Jh(b,!0);this.a.Ui(b,!1);this.hj(a)}};b.prototype.sA=function(){for(var a=!1,b=this.a.Vb(this.U);-1!=b;){for(var c=this.a.Cb(b),e=0,d=this.a.Ha(b);e<d&&1<d;){var f=this.a.Ua(c),g=this.a.X(c);this.a.Cq(f,g)?(a=!0,this.Jh(c,!1),this.a.vf(c,!0),this.Jh(g,!1),this.a.vf(g,!0),c=f,e=0,d=this.a.Ha(b)):(c=g,e++)}if(2>this.a.Ha(b)){a=
this.a.Cb(b);e=0;for(d=this.a.Ha(b);e<d;e++)this.Jh(a,!1),a=this.a.X(a);b=this.a.Cr(b);a=!0}else b=this.a.bc(b)}return a};b.prototype.io=function(a){for(var b=!1;;){var c=this.a.X(a),e=this.a.Ua(a);if(c==a)return this.Jh(a,!0),this.a.Ui(a,!1),!0;if(!this.a.Cq(c,e))break;b=!0;this.hj(e);this.hj(c);this.Jh(a,!0);this.a.Ui(a,!1);this.pm(c,e);this.Jh(c,!0);this.a.Ui(c,!0);if(c==e)break;a=e}return b};b.prototype.tJ=function(){for(var a=0,b=this.$d.gc(this.$d.Wd);-1!=b;b=this.$d.bb(b)){var c=this.$d.getData(b);
this.a.im(c,-1)}for(var e=0,d=this.a.Vb(this.U);-1!=d;)if(b=this.a.Cb(d),-1==b||-1!=this.a.rd(b))c=d,d=this.a.bc(d),this.a.yu(c);else{this.a.im(b,d);for(var f=1,c=this.a.X(b);c!=b;c=this.a.X(c))this.a.im(c,d),f++;this.a.Jr(d,!1);this.a.hm(d,f);this.a.Wi(d,this.a.Ua(b));e+=f;a++;d=this.a.bc(d)}for(b=this.$d.gc(this.$d.Wd);-1!=b;b=this.$d.bb(b))c=this.$d.getData(b),-1==this.a.rd(c)&&(d=this.a.aD(this.U,c,c,null),e+=this.a.Ha(d),a++);this.a.gm(this.U,a);this.a.Pk(this.U,e);a=0;for(e=this.a.$c;-1!=e;e=
this.a.we(e))a+=this.a.F(e);this.a.ZF(a)};b.prototype.fl=function(a){for(var b=0,c=this.ie.size-1;b<c;b++)if(a=(a+1)%this.ie.size,-1!=this.ie.get(a))return a;return-1};b.prototype.pm=function(a,b){var c=this.a.Ra(b,this.vp),e=this.a.Ra(b,this.fg);this.a.Zy(a,b);this.a.lb(b,this.vp,c);this.a.lb(b,this.fg,e)};b.prototype.hj=function(a){var b=this.a.Ra(a,this.fg);-1!=b&&(this.ie.set(b,-1),this.a.lb(a,this.fg,-1))};b.$=function(a,c,e,d,f){var g=new b;g.a=a;g.U=c;g.yx=e;g.Qt=d;g.oe=f;return g.CJ()};b.prototype.mJ=
function(b,c){var e=this.nh.get(b),d=new a.b;this.a.uc(e,d);var e=new a.b,f=this.nh.get(c);this.a.uc(f,e);if(d.ub(e))return 0;b=this.Mq.get(b);f=new a.b;this.a.uc(b,f);c=this.Mq.get(c);b=new a.b;this.a.uc(c,b);c=new a.b;c.pc(d,f);d=new a.b;d.pc(e,b);return a.b.cq(c,d)};return b}();a.mm=b})(z||(z={}));(function(a){(function(a){a[a.Local=0]="Local";a[a.Geographic=1]="Geographic";a[a.Projected=2]="Projected";a[a.Unknown=3]="Unknown"})(a.HI||(a.HI={}));(function(a){a[a.Integer32=0]="Integer32";a[a.Integer64=
1]="Integer64";a[a.FloatingPoint=2]="FloatingPoint"})(a.rI||(a.rI={}));var b=function(){function b(){this.fo="";this.mi=0;this.Sl=null}b.prototype.Qc=function(){return this.mi};b.prototype.Ko=function(){var b=.001;0!=this.mi?b=a.ls.SM(this.mi):null!=this.Sl&&(b=a.mA.TM(this.Sl));return b};b.prototype.Se=function(){if(0!=this.mi)return a.Tb.Qd(a.ls.cC(this.mi));if(null!=this.Sl)return a.mA.UM(this.Sl)};b.Am=function(b){if(0!=b.mi){if(!0===a.ls.WO(b.mi))return 1;if(!0===a.ls.ZO(b.mi))return 2}return 3};
b.create=function(c){if(0>=c)throw a.g.N("Invalid or unsupported wkid: "+c);var e=new b;e.mi=c;return e};b.NL=function(c){if(null==c||0==c.length)throw a.g.N("Cannot create SpatialReference from null or empty text.");var e=new b;e.Sl=c;return e};b.prototype.lc=function(a){return this==a?!0:null==a||this.constructor!=a.constructor||this.mi!=a.mi||0==this.mi&&this.Sl!==a.Sl?!1:!0};b.mN=function(b,c){var e=Math.PI/180,d=new a.ca;a.nH.pN(b.w().x*e,b.w().y*e,c.w().x*e,c.w().y*e,d);return d.l};b.prototype.toString=
function(){return"[ tol: "+this.xq()+"; wkid: "+this.Qc()+"; wkt: "+this.Sl+"]"};b.prototype.hc=function(){if(""!==this.fo)return this.fo;var a=this.toString();if(Array.prototype.reduce)return this.fo="S"+a.split("").reduce(function(a,b){a=(a<<5)-a+b.charCodeAt(0);return a&a},0);var b=0;if(0===a.length)return"";for(var c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return this.fo="S"+b};b.prototype.xq=function(){return this.Ko()};b.jU=!0;b.ET=2147483645;b.FT=9007199254740990;return b}();a.Nf=
b})(z||(z={}));(function(a){function b(a,b){89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);b*=.017453292519943;return[111319.49079327169*a,3189068.5*Math.log((1+Math.sin(b))/(1-Math.sin(b)))]}function c(a,b,c){a=a/6378137*57.29577951308232;return c?[a,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]:[a-360*Math.floor((a+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]}function e(b,c){var e=b.vm();if(33===b.D()){var d=c(e.lk(),e.mk());
e.ic(d[0],d[1])}else if(197===b.D())d=c(b.R.v,b.R.C,!0),b=c(b.R.B,b.R.G,!0),e.K(d[0],d[1],b[0],b[1]);else for(d=new a.b,b=0;b<e.F();b++){e.w(b,d);var f=c(d.x,d.y,!0);d.ma(f[0],f[1]);e.ic(b,d)}return e}function d(a){return e(a,c)}function f(a){return e(a,b)}var g=function(){function b(){}b.Xr=function(b){var c=Math.PI/180,e=Math.sin(b.y*c);return a.b.Oa(6378137*b.x*c,3167719.6636462314*(e/(1-.006694379990197414*e*e)-6.111035746609262*Math.log((1-.0818191908429643*e)/(1+.0818191908429643*e))))};b.Wu=
function(b,c,e,d){var f=1/298.257223563,g=Math.sin(e);e=Math.cos(e);var k=(1-f)*Math.tan(b);b=1/Math.sqrt(1+k*k);for(var h=k*b,n=Math.atan2(k,e),k=b*g*b*g,q=1-k,p=2.7233160610754688E11*q/4.040829998466145E13,l=1+p/16384*(4096+p*(-768+p*(320-175*p))),r=p/1024*(256+p*(-128+p*(74-47*p))),p=d/(6356752.31424518*l),t=2*Math.PI,u,w,v,x;1E-12<Math.abs(p-t);)v=Math.cos(2*n+p),u=Math.sin(p),w=Math.cos(p),x=r*u*(v+r/4*(w*(-1+2*v*v)-r/6*v*(-3+4*u*u)*(-3+4*v*v))),t=p,p=d/(6356752.31424518*l)+x;d=h*u-b*w*e;q=f/
16*q*(4+f*(4-3*q));return a.b.Oa((c+(Math.atan2(u*g,b*w-h*u*e)-(1-q)*f*Math.sqrt(k)*(p+q*u*(v+q*w*(-1+2*v*v)))))/(Math.PI/180),Math.atan2(h*w+b*u*e,(1-f)*Math.sqrt(k+d*d))/(Math.PI/180))};b.cN=function(a,b,c,e){var d=1/298.257223563,f=e-b,g=Math.atan((1-d)*Math.tan(a)),k=Math.atan((1-d)*Math.tan(c)),h=Math.sin(g),g=Math.cos(g),n=Math.sin(k),k=Math.cos(k),q=f,p,l=1E3,r,t,u,w,v,x,m;do{u=Math.sin(q);w=Math.cos(q);t=Math.sqrt(k*u*k*u+(g*n-h*k*w)*(g*n-h*k*w));if(0===t)return 0;w=h*n+g*k*w;v=Math.atan2(t,
w);x=g*k*u/t;r=1-x*x;u=w-2*h*n/r;isNaN(u)&&(u=0);m=d/16*r*(4+d*(4-3*r));p=q;q=f+(1-m)*d*x*(v+m*t*(u+m*w*(-1+2*u*u)))}while(1E-12<Math.abs(q-p)&&0<--l);if(0===l)return h=e-b,{azimuth:Math.atan2(Math.sin(h)*Math.cos(c),Math.cos(a)*Math.sin(c)-Math.sin(a)*Math.cos(c)*Math.cos(h)),geodesicDistance:6371009*Math.acos(Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos(e-b))};a=2.7233160610754688E11*r/4.040829998466145E13;b=a/1024*(256+a*(-128+a*(74-47*a)));return{azimuth:Math.atan2(k*Math.sin(q),g*
n-h*k*Math.cos(q)),lN:6356752.31424518*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(v-b*t*(u+b/4*(w*(-1+2*u*u)-b/6*u*(-3+4*t*t)*(-3+4*u*u)))),yU:Math.atan2(g*Math.sin(q),g*n*Math.cos(q)-h*k)}};b.oT=function(b){var c=b.hasAttribute(1),e=b.hasAttribute(2),d=[],f=b.ea(),g=null,k=null;c&&(g=b.mc(1));e&&(k=b.mc(2));for(var h=new a.b,n=0;n<f;n++){for(var q=b.Ea(n),p=b.Ha(n),l=0,r=0,t=NaN,u=NaN,w=NaN,v=NaN,x=b.vc(n),m=[],y=q;y<q+p;y++){b.w(y,h);var v=w=NaN,z=[h.x,h.y];c&&(w=g.get(y),z.push(w));e&&(f=k.get(y),
z.push(v));y==q&&x&&(l=h.x,r=h.y,t=w,u=v);m.push(z)}!x||l==h.x&&r==h.y&&(!c||isNaN(t)&&isNaN(w)||t==w)&&(!e||isNaN(u)&&isNaN(v)||u==v)||m.push(m[0].slice(0));d.push(m)}return d};b.fw=function(a,c){a=b.oT(a);var e=Math.PI/180;637.100877151506>c&&(c=637.100877151506);for(var d=[],f=0;f<a.length;f++){var g=a[f],k;d.push(k=[]);k.push([g[0][0],g[0][1]]);var h,n,q,p,l,r;h=g[0][0]*e;n=g[0][1]*e;for(l=0;l<g.length-1;l++)if(q=g[l+1][0]*e,p=g[l+1][1]*e,h!==q||n!==p){p=b.cN(n,h,p,q);q=p.azimuth;p=p.lN;var t=
p/c;if(1<t){for(r=1;r<=t-1;r++){var u=b.Wu(n,h,q,r*c);k.push([u.x,u.y])}r=b.Wu(n,h,q,(p+Math.floor(t-1)*c)/2);k.push([r.x,r.y])}n=b.Wu(n,h,q,p);k.push([n.x,n.y]);h=n.x*e;n=n.y*e}}return{mF:d}};b.kN=function(c){for(var e=[],d=0;d<c.length;d++){var f=c[d],f=b.fw(f,1E4);e.push(f)}c=[];for(var g,k,h=0;h<e.length;h++){for(var f=e[h],n=0,d=0;d<f.mF.length;d++){var q=f.mF[d];g=b.Xr(a.b.Oa(q[0][0],q[0][1]));k=b.Xr(a.b.Oa(q[q.length-1][0],q[q.length-1][1]));var p=k.x*g.y-g.x*k.y,l;for(l=0;l<q.length-1;l++)g=
b.Xr(a.b.Oa(q[l+1][0],q[l+1][1])),k=b.Xr(a.b.Oa(q[l][0],q[l][1])),p+=k.x*g.y-g.x*k.y;p/=4046.87;n+=p}c.push(n/-2*4046.85642)}return c};return b}();a.oH=g;g=function(){function b(){}b.oy=function(a,c,e,d,f,g,k){b.AG[a.hc()]=c;0==isNaN(e)&&(b.CG[a.hc()]=e);0==isNaN(d)&&(b.iz[a.hc()]=d);0==isNaN(f)&&(b.lG[a.hc()]=f);b.EG[a.hc()]=g;null!==k&&(b.GG[a.hc()]=k)};b.xu=function(a,c,e){b.IG[a.hc()+"-"+c.hc()]=e};b.Em=function(c){c=b.AG[c.hc()];if(void 0==c)throw a.g.qe();return c};b.IC=function(c){c=b.CG[c.hc()];
if(void 0==c)throw a.g.qe();return c};b.ft=function(c){c=b.iz[c.hc()];if(void 0==c)throw a.g.qe();return c};b.Ts=function(c){c=b.lG[c.hc()];if(void 0==c)throw a.g.qe();return c};b.Fm=function(c){c=b.GG[c.hc()];if(void 0==c)throw a.g.qe();return a.i.Oa(c[0],c[1],c[2],c[3])};b.Qo=function(c){c=b.EG[c.hc()];if(void 0==c)throw a.g.qe();return c};b.Wl=function(c,e,d){if(e.lc(d))return c;var f=b.IG[e.hc()+"-"+d.hc()];if(void 0!==f)return f(c,e,d);throw a.g.qe();};b.tu=function(){throw a.g.qe();};b.qN=function(){throw a.g.qe();
};b.YQ=function(){throw a.g.qe();};b.TN=function(){throw a.g.qe();};b.qR=function(){var b=a.Nf.create(102100),c=a.Nf.create(3857),e=a.Nf.create(4326);a.Ya.oy(b,e,NaN,NaN,NaN,!1,null);a.Ya.oy(e,e,1,.0033528106647474805,6378137,!0,[-180,-90,180,90]);a.Ya.oy(c,e,NaN,NaN,NaN,!1,null);a.Ya.xu(b,e,d);a.Ya.xu(e,b,f);a.Ya.xu(c,e,d);a.Ya.xu(e,c,f)};b.AG=[];b.CG=[];b.iz=[];b.lG=[];b.EG=[];b.GG=[];b.IG=[];return b}();a.Ya=g})(z||(z={}));z.Ya.qR();(function(a){var b=function(){function b(a){this.f=null;this.qg=
-1;this.Xc=this.size=this.We=0;this.Ic=a}b.prototype.Jc=function(a){a<this.We?(this.f[a*this.Ic]=this.qg,this.qg=a):this.We--;this.size--};b.prototype.O=function(a,b){return this.f[a*this.Ic+b]};b.prototype.L=function(a,b,c){this.f[a*this.Ic+b]=c};b.prototype.be=function(){var b=this.qg;if(-1==b){if(this.We==this.Xc){b=0!=this.Xc?a.I.truncate(3*(this.Xc+1)/2):1;2147483647<b&&(b=2147483647);if(b==this.Xc)throw a.g.Uc();this.Gm(b)}b=this.We;this.We++}else this.qg=this.f[b*this.Ic];this.size++;for(var c=
b*this.Ic+this.Ic,e=b*this.Ic;e<c;e++)this.f[e]=-1;return b};b.prototype.Pj=function(b){var c=this.qg;if(-1==c){if(this.We==this.Xc){c=0!=this.Xc?a.I.truncate(3*(this.Xc+1)/2):1;2147483647<c&&(c=2147483647);if(c==this.Xc)throw a.g.Uc();this.Gm(c)}c=this.We;this.We++}else this.qg=this.f[c*this.Ic];this.size++;for(var e=c*this.Ic,d=this.Ic,f=0;f<d;f++)this.f[e+f]=b[f];return c};b.prototype.Nh=function(a){this.qg=-1;this.size=this.We=0;a&&(this.f=null,this.Xc=0)};b.prototype.de=function(a){a>this.Xc&&
this.Gm(a)};b.prototype.Pu=function(a,b,c){var e=this.f[this.Ic*b+c];this.f[this.Ic*b+c]=this.f[this.Ic*a+c];this.f[this.Ic*a+c]=e};b.Zk=function(){return-2};b.lm=function(){return-3};b.Zw=function(a){return 0<=a};b.prototype.Gm=function(a){null==this.f&&(this.f=[]);this.Xc=a};return b}();a.Fc=b;b=function(){function b(a){this.f=new Int32Array(0);this.qg=-1;this.Xc=this.size=this.We=0;this.Ic=a}b.prototype.Jc=function(a){a<this.We?(this.f[a*this.Ic]=this.qg,this.qg=a):this.We--;this.size--};b.prototype.O=
function(a,b){return this.f[a*this.Ic+b]};b.prototype.L=function(a,b,c){this.f[a*this.Ic+b]=c};b.prototype.be=function(){var b=this.qg;if(-1==b){if(this.We==this.Xc){b=0!=this.Xc?a.I.truncate(3*(this.Xc+1)/2):1;2147483647<b&&(b=2147483647);if(b==this.Xc)throw a.g.Uc();this.Gm(b)}b=this.We;this.We++}else this.qg=this.f[b*this.Ic];this.size++;for(var c=b*this.Ic;c<b*this.Ic+this.Ic;c++)this.f[c]=-1;return b};b.prototype.Pj=function(b){var c=this.qg;if(-1==c){if(this.We==this.Xc){c=0!=this.Xc?a.I.truncate(3*
(this.Xc+1)/2):1;2147483647<c&&(c=2147483647);if(c==this.Xc)throw a.g.Uc();this.Gm(c)}c=this.We;this.We++}else this.qg=this.f[c*this.Ic];this.size++;for(var e=c*this.Ic,d=0;d<b.length;d++)this.f[e+d]=b[d];return c};b.prototype.Nh=function(a){this.qg=-1;this.size=this.We=0;a&&(this.f=null,this.Xc=0)};b.prototype.de=function(a){a>this.Xc&&this.Gm(a)};b.prototype.Pu=function(a,b,c){var e=this.f[this.Ic*b+c];this.f[this.Ic*b+c]=this.f[this.Ic*a+c];this.f[this.Ic*a+c]=e};b.Zk=function(){return-2};b.lm=
function(){return-3};b.Zw=function(a){return 0<=a};b.prototype.Gm=function(a){null==this.f&&(this.f=new Int32Array(0));var b=new Int32Array(this.Ic*a);b.set(this.f,0);this.f=b;this.Xc=a};return b}();a.II=b;!0===a.ah.Sk&&(a.Fc=a.II)})(z||(z={}));(function(a){var b;(function(a){a[a.enumInputModeBuildGraph=0]="enumInputModeBuildGraph";a[a.enumInputModeSimplifyAlternate=4]="enumInputModeSimplifyAlternate";a[a.enumInputModeSimplifyWinding=5]="enumInputModeSimplifyWinding";a[a.enumInputModeIsSimplePolygon=
7]="enumInputModeIsSimplePolygon"})(b||(b={}));var c=function(){function b(b){this.me=b;this.Zg=NaN;this.LD=new a.Ag;this.MD=new a.Ag;this.Aq=new a.Nd;this.Bq=new a.Nd}b.prototype.compare=function(a,b,c){a=a.da(c);this.me.iy(b,this.LD);this.me.iy(a,this.MD);b=this.LD.get();a=this.MD.get();this.Aq.K(b.na,b.la);this.Bq.K(a.na,a.la);if(this.Aq.va<this.Bq.qa)return-1;if(this.Aq.qa>this.Bq.va)return 1;c=b.ja==b.ha;var e=a.ja==a.ha;if(c||e){if(c&&e)return 0;if(b.ja==a.ja&&b.na==a.na)return c?1:-1;if(b.ha==
a.ha&&b.la==a.la)return c?-1:1}c=b.xe(this.Zg,this.Aq.qa);e=a.xe(this.Zg,this.Bq.qa);c==e&&(c=Math.min(b.ha,a.ha),e=.5*(c+this.Zg),e==this.Zg&&(e=c),c=b.xe(e,this.Aq.qa),e=a.xe(e,this.Bq.qa));return c<e?-1:c>e?1:0};b.prototype.$F=function(a){this.Zg=a};return b}(),e=function(){function b(b){this.ab=b;this.uE=new a.Ag;this.nf=new a.b;this.xx=new a.Nd}b.prototype.eS=function(a){this.nf.J(a)};b.prototype.compare=function(a,b){this.ab.iy(a.da(b),this.uE);a=this.uE.get();this.xx.K(a.na,a.la);if(this.nf.x<
this.xx.qa)return-1;if(this.nf.x>this.xx.va)return 1;a=a.xe(this.nf.y,this.nf.x);return this.nf.x<a?-1:this.nf.x>a?1:0};return b}();b=function(){function b(){this.OD=this.Vh=this.Yh=this.px=this.Pm=this.je=this.xc=this.Ig=this.Td=null;this.sn=this.eg=-1;this.ND=!0;this.tx=!1;this.qx=NaN;this.ei=new a.wd;this.EK=2147483647;this.DK=a.I.truncate(-2147483648);this.Kf=this.Md=this.Ek=this.lp=this.Bl=this.kp=this.Zq=this.Be=-1;this.ta=0}b.prototype.Mv=function(a){this.qx=a};b.prototype.Ul=function(){null==
this.Td&&(this.Td=new a.Fc(8));var b=this.Td.be();this.Td.L(b,1,0);return b};b.prototype.kQ=function(){null==this.xc&&(this.xc=new a.Fc(8));var b=this.xc.be();this.xc.L(b,2,0);this.xc.L(b,3,0);var c=this.xc.be();this.xc.L(c,2,0);this.xc.L(c,3,0);this.GF(b,c);this.GF(c,b);return b};b.prototype.FE=function(){null==this.je&&(this.je=new a.Fc(8));var b=this.je.be();this.je.L(b,2,0);return b};b.prototype.QR=function(a,b){this.Td.L(a,7,b)};b.prototype.em=function(a,b){this.Td.L(a,2,b)};b.prototype.PR=function(a,
b){this.Td.L(a,1,b)};b.prototype.fS=function(a,b){this.Td.L(a,3,b)};b.prototype.cS=function(a,b){this.Td.L(a,4,b)};b.prototype.Lp=function(a,b){this.Td.L(a,5,b)};b.prototype.uN=function(a){return this.Td.O(a,5)};b.prototype.OR=function(a,b){this.Td.L(a,6,b)};b.prototype.IJ=function(a,b){this.OR(b,a)};b.prototype.FF=function(a,b){this.xc.L(a,1,b)};b.prototype.GF=function(a,b){this.xc.L(a,4,b)};b.prototype.Rk=function(a,b){this.xc.L(a,5,b)};b.prototype.Qk=function(a,b){this.xc.L(a,6,b)};b.prototype.VR=
function(a,b){this.xc.L(a,2,b)};b.prototype.Du=function(a,b){this.xc.L(a,3,b)};b.prototype.zC=function(a){return this.xc.O(a,3)};b.prototype.Ir=function(a,b){this.xc.L(a,7,b)};b.prototype.zG=function(a,b){if(-1!=this.ql(a))for(b=b?-1:a,a=this.ql(a);-1!=a;a=this.zq(a))this.a.lb(this.Gi(a),this.lp,b)};b.prototype.Tu=function(a,b){-1!=a&&(this.zG(a,b),this.zG(this.sa(a),b))};b.prototype.Gr=function(a,b){this.je.L(a,1,b)};b.prototype.yg=function(a,b){this.je.L(a,2,b)};b.prototype.cm=function(a,b){this.je.L(a,
3,b);this.LR(a,this.tN(b));this.KR(b,a)};b.prototype.KR=function(a,b){this.je.L(a,4,b)};b.prototype.LR=function(a,b){this.je.L(a,5,b)};b.prototype.AF=function(a,b){this.je.L(a,6,b)};b.prototype.yF=function(a,b){this.je.L(a,7,b)};b.prototype.xF=function(a,b){this.Pm.write(a,b)};b.prototype.zF=function(a,b){this.px.write(a,b)};b.prototype.bT=function(b){var c=0,e=0,d=this.pC(b),f=new a.b,g=new a.b,k=new a.b;this.tq(d,f);g.J(f);var h=d;do this.pl(h,k),e+=a.b.Fb(g,k),this.Pe(this.sa(h))!=b&&(c+=(k.x-
f.x-(g.x-f.x))*(k.y-f.y+(g.y-f.y))*.5),g.J(k),h=this.Wb(h);while(h!=d);this.Pm.write(b,c);this.px.write(b,e)};b.prototype.GQ=function(b){var d=new c(this),f=new a.bj;f.de(a.I.truncate(this.ta/2));f.Hn(d);for(var g=new a.ga(0),k=this.Eg(),h=null,n=0,q=new a.b,l=this.Be;-1!=l;l=this.Bf(l)){n++;var p=this.te(l);if(-1!=p){g.cf(0);if(!this.VS(f,k,g,p)){this.w(l,q);d.$F(q.y);var r=p;do{var t=this.tb(r,k);-1!=t&&(f.kd(t,-1),this.Bb(r,k,-2));r=this.Wb(this.sa(r))}while(p!=r);r=p;do t=this.tb(r,k),-1==t&&
(t=f.addElement(r,-1),g.add(t)),r=this.Wb(this.sa(r));while(p!=r)}for(p=g.size-1;0<=p;p--)t=g.get(p),r=f.da(t),this.Bb(this.sa(r),k,t),this.FQ(f,t,b)}else-1==this.mw(l)&&(null==h&&(h=new e(this)),this.w(l,q),h.eS(q),r=f.GR(h),p=this.Ek,-1!=r&&(t=f.da(r),this.Pe(t)==this.Pe(this.sa(t))&&(t=this.BC(f,r)),-1!=t&&(p=this.Pe(t))),this.IJ(p,l))}this.kh(k)};b.prototype.FQ=function(a,b,c){var e=a.da(b),d=this.Pe(e);if(-1==this.ym(d)){var f=this.BC(a,b),g=this.sa(e),k=this.Pe(g);this.yo(d);this.yo(k);var h=
this.ym(d),n=this.ym(k);-1==f&&-1==h&&(k==d?(this.cm(k,this.Ek),h=n=this.Ek):(-1==n&&(this.cm(k,this.Ek),n=this.Ek),this.cm(d,k),h=k));if(-1!=f){var q=this.Pe(f);-1==n&&(0>=this.yo(q)?(n=this.ym(q),this.cm(k,n)):(this.cm(k,q),n=q),k==d&&(h=n))}-1==h&&this.WS(d,k);0==c?this.aR(a,b,e,f,d,k):5==c?this.bR(a,b,e,g,d,k):4==c&&this.$Q(e,f,d,k)}};b.prototype.aR=function(a,b,c,e,d,f){var g=this.pj(d);if(-1!=e){var k=this.pj(f),h=this.pj(this.Pe(e));e=g&k&h;h^=h&this.Gg(c);h|=e;0!=h&&(this.yg(f,k|h),this.yg(d,
h|g),g=g||h)}for(b=a.bb(b);-1!=b;b=a.bb(b)){e=a.da(b);c=this.Pe(this.sa(e));d=this.pj(c);f=this.Gg(e);k=this.Pe(e);h=this.pj(k);e=d&h&g;g^=g&f;g|=e;if(0==g)break;this.yg(c,d|g);this.yg(k,h|g)}};b.prototype.bR=function(b,c,e,d,f,g){if(f!=g){e=this.tb(e,this.Kf);e+=this.tb(d,this.Kf);d=0;var k=new a.ga(0),h=new a.ga(0);h.add(0);for(var n=b.gc(-1);n!=c;n=b.bb(n)){var q=b.da(n),l=this.sa(q),p=this.Pe(q),r=this.Pe(l);if(p!=r){q=this.tb(q,this.Kf);q+=this.tb(l,this.Kf);d+=q;l=!1;0!=k.size&&k.tc()==r&&(h.af(),
k.af(),l=!0);if(-1==this.ym(r))throw a.g.wa();l&&this.ym(r)==p||(h.add(d),k.add(p))}}d+=e;0!=k.size&&k.tc()==g&&(h.af(),k.af());0!=d?0==h.tc()&&(b=this.a.$c,b=this.ya(b),this.yg(f,b)):0!=h.tc()&&(b=this.a.$c,b=this.ya(b),this.yg(f,b))}};b.prototype.$Q=function(a,b,c,e){var d=this.ya(this.a.$c);if(-1==b)this.yg(e,this.sn),a=this.tb(a,this.eg),0!=(a&1)?this.yg(c,d):this.yg(c,this.sn);else{var f=this.pj(e);0==f&&(f=this.pj(this.Pe(b)),this.yg(e,f));a=this.tb(a,this.eg);0!=(a&1)?this.yg(c,f==d?this.sn:
d):this.yg(c,f)}};b.prototype.VS=function(a,b,c,e){var d=e,f=-1,g=-1,k=0;do{if(2==k)return!1;var h=this.tb(d,b);if(-1!=h){if(-1!=f)return!1;f=h}else{if(-1!=g)return!1;g=d}k++;d=this.Wb(this.sa(d))}while(e!=d);if(-1==g||-1==f)return!1;this.Bb(a.da(f),b,-2);a.Vi(f,g);c.add(f);return!0};b.prototype.WS=function(a,b){var c=this.yo(a);if(0!=c){var e=this.yo(b);0<c&&0>e?this.cm(a,b):0>c&&0<e?this.cm(a,b):(c=this.ym(b),-1!=c&&this.cm(a,c))}};b.prototype.RL=function(b,c){this.lp=this.a.re();for(var e=0,d=
c.size;e<d;e++){var f=c.get(e),g=this.a.Ra(f,this.Bl),k=this.a.Vf(this.a.rd(f)),h=this.a.Lb(k);if(a.T.Kc(h)){var n=this.a.X(f);if(-1!=n){var q=this.a.Ra(n,this.Bl);if(g!=q){var l=this.kQ(),p=this.sa(l),r=this.Ig.be();this.Ig.L(r,0,f);this.Ig.L(r,1,-1);this.Ir(l,r);this.FF(l,g);r=this.te(g);-1==r?(this.em(g,l),this.Rk(l,p),this.Qk(p,l)):(g=this.fe(r),this.Rk(r,p),this.Qk(p,r),this.Qk(g,l),this.Rk(l,g));this.FF(p,q);g=this.te(q);-1==g?(this.em(q,p),this.Qk(l,p),this.Rk(p,l)):(q=this.fe(g),this.Rk(g,
l),this.Qk(l,g),this.Qk(q,p),this.Rk(p,q));k=this.ya(k);0==b?(this.Bb(p,this.Md,0),this.Bb(l,this.Md,1736==h?k:0)):5==b?(q=new a.b,this.a.w(f,q),f=new a.b,this.a.w(n,f),g=n=0,0>q.compare(f)?n=1:g=-1,this.Bb(p,this.Md,0),this.Bb(l,this.Md,0),this.Bb(l,this.Kf,n),this.Bb(p,this.Kf,g)):7==b?(this.Bb(p,this.Md,this.sn),this.Bb(l,this.Md,1736==h?k:0)):4==b&&(this.Bb(p,this.Md,0),this.Bb(l,this.Md,0),this.Bb(l,this.eg,1),this.Bb(p,this.eg,1));h=1736==h?this.DK:0;this.Du(l,k|h);this.Du(p,k|h)}}}}};b.prototype.ZP=
function(a,b){var c=this.ql(b);if(-1!=c){var e=this.ql(a);this.Ig.L(c,1,e);this.Ir(a,c);this.Ir(b,-1)}a=this.sa(a);b=this.sa(b);c=this.ql(b);-1!=c&&(e=this.ql(a),this.Ig.L(c,1,e),this.Ir(a,c),this.Ir(b,-1))};b.prototype.AS=function(b){function c(a,b){return d.lL(a,b)}var e=new a.ga(0);e.xb(10);for(var d=this,f=this.Be;-1!=f;f=this.Bf(f)){e.clear(!1);var g=this.te(f);if(-1!=g){var k=g;do e.add(k),k=this.Wb(this.sa(k));while(k!=g);if(1<e.size){k=!0;if(2<e.size)e.xd(0,e.size,c),e.add(e.get(0));else if(0<
this.kL(e.get(0),e.get(1))){var h=e.get(0);e.set(0,e.get(1));e.set(1,h)}else k=!1;for(var n=h=e.get(0),q=this.jf(n),l=this.sa(n),p=-1,r=1,t=e.size;r<t;r++){var u=e.get(r),w=this.sa(u),v=this.qj(w);if(v==q&&u!=n){if(0==b)p=this.zC(n)|this.zC(u),this.Du(n,p),this.Du(l,p),this.Bb(n,this.Md,this.tb(n,this.Md)|this.tb(u,this.Md)),this.Bb(l,this.Md,this.tb(l,this.Md)|this.tb(w,this.Md));else if(-1!=this.Kf)p=this.tb(n,this.Kf)+this.tb(u,this.Kf),w=this.tb(l,this.Kf)+this.tb(w,this.Kf),this.Bb(n,this.Kf,
p),this.Bb(l,this.Kf,w);else{if(7==b){this.ei=new a.wd(5,f,-1);return}-1!=this.eg&&(p=this.tb(n,this.eg)+this.tb(u,this.eg),w=this.tb(l,this.eg)+this.tb(w,this.eg),this.Bb(n,this.eg,p),this.Bb(l,this.eg,w))}this.ZP(n,u);this.Wv(u);p=n;e.set(r,-1);u==h&&(e.set(0,-1),h=-1)}else this.Tu(p,!1),p=-1,n=u,q=v,l=w}this.Tu(p,!1);p=-1;if(k){h=-1;r=0;for(t=e.size;r<t;r++)if(u=e.get(r),-1!=u)if(-1==h)n=h=u,q=this.jf(n),l=this.sa(n);else if(u!=n&&(w=this.sa(u),v=this.qj(w),this.Qk(l,u),this.Rk(u,l),n=u,q=v,l=
w,7==b&&(this.tb(u,this.Md)|this.tb(this.fe(u),this.Md))==(this.sn|1))){this.ei=new a.wd(5,f,-1);return}this.em(f,h)}else{h=-1;r=0;for(t=e.size;r<t;r++)if(u=e.get(r),-1!=u){h=u;break}g!=h&&this.em(f,h)}}}}};b.prototype.AK=function(){for(var b=-1,c=this.Eg(),e=this.Be;-1!=e;e=this.Bf(e)){var d=this.te(e);if(-1!=d){var f=d;do{if(1!=this.tb(f,c)){var g=this.FE();this.Gr(g,f);this.yF(g,b);-1!=b&&this.AF(b,g);var b=g,k=0,h=f;do k|=this.tb(h,this.Md),this.VR(h,g),this.Bb(h,c,1),h=this.Wb(h);while(h!=f);
this.yg(g,k)}f=this.Wb(this.sa(f))}while(f!=d)}}g=this.FE();this.Gr(g,-1);this.yF(g,b);-1!=b&&this.AF(b,g);this.Ek=g;this.Pm=a.qd.Yc(this.je.size,NaN);this.px=a.qd.Yc(this.je.size,NaN);this.xF(this.Ek,Infinity);this.zF(this.Ek,Infinity);this.kh(c)};b.prototype.EN=function(a,b,c){b=-1!=b?b:this.te(a);if(-1==b)return-1;for(a=b;;){if(1!=this.tb(b,c))return b;b=this.Wb(this.sa(b));if(b==a)return-1}};b.prototype.uR=function(){for(var a=this.Eg(),b=this.Be;-1!=b;b=this.Bf(b))for(var c=-1;;){var e=this.EN(b,
c,a);if(-1==e)break;for(var c=this.Wb(this.sa(e)),d=e;;){var f=this.Wb(d),g=this.fe(d),k=this.sa(d);if(g==k){this.bM(d);if(c==d||c==k)c=-1;if(d==e||g==e){e=f;if(d==e||g==e)break;d=f;continue}}else this.Bb(d,a,1);d=f;if(d==e)break}}};b.prototype.Ay=function(b,c,e,d){this.xg();this.ND=d;this.a=b;this.kp=this.a.RB();b=new a.ga(0);b.xb(null!=e?this.a.F(e.get(0)):this.a.pd);var f=0,g=1,k=null!=e?e.get(0):this.a.$c;for(d=1;-1!=k;){this.a.EF(k,this.kp,g);for(var g=g<<1,h=this.a.Vb(k);-1!=h;h=this.a.bc(h))for(var n=
this.a.Cb(h),q=0,l=this.a.Ha(h);q<l;q++)b.add(n),n=this.a.X(n);a.T.Km(this.a.Lb(k))||(f+=this.a.ea(k));null!=e?(k=d<e.size?e.get(d):-1,d++):k=this.a.we(k)}this.sn=g;this.ta=b.size;this.a.Mu(b,this.ta);null==this.Ig&&(this.Ig=new a.Fc(2),this.Td=new a.Fc(8),this.xc=new a.Fc(8),this.je=new a.Fc(8));this.Ig.de(this.ta);this.Td.de(this.ta+10);this.xc.de(2*this.ta+32);this.je.de(Math.max(32,f));this.Bl=this.a.re();e=new a.b;d=0;f=new a.b;e.Eh();for(g=0;g<=this.ta;g++)if(g<this.ta?(n=b.get(g),this.a.w(n,
f)):f.Eh(),!e.ub(f)){if(d<g){n=this.Ul();for(l=q=-1;d<g;d++)l=b.get(d),this.a.lb(l,this.Bl,n),k=this.Ig.be(),this.Ig.L(k,0,l),this.Ig.L(k,1,q),q=k,h=this.a.rd(l),k=this.a.Vf(h),k=this.ya(k),this.PR(n,this.md(n)|k);this.QR(n,q);this.Lp(n,this.a.gb(l));-1!=this.Zq&&this.cS(this.Zq,n);this.fS(n,this.Zq);this.Zq=n;-1==this.Be&&(this.Be=n)}d=g;e.J(f)}this.Md=this.Eg();5==c&&(this.Kf=this.Eg());4==c&&(this.eg=this.Eg());this.RL(c,b);0==this.ei.yh&&(this.AS(c),0==this.ei.yh&&(isNaN(this.qx)||this.ZK()?(this.AK(),
0==this.ei.yh&&(this.kh(this.Md),this.Md=-1,this.ND&&this.GQ(c))):this.tx=!0))};b.prototype.Wv=function(a){var b=this.Wb(a),c=this.fe(a),e=this.sa(a),d=this.Wb(e),f=this.fe(e);b!=e&&(this.Qk(f,b),this.Rk(b,f));c!=e&&(this.Qk(c,d),this.Rk(d,c));c=this.qj(a);this.te(c)==a&&(d!=a?this.em(c,d):this.em(c,-1));d=this.qj(e);this.te(d)==e&&(b!=e?this.em(d,b):this.em(d,-1));this.xc.Jc(a);this.xc.Jc(e)};b.prototype.BC=function(a,b){for(;;)if(b=a.ge(b),-1!=b){var c=a.da(b);if(this.Pe(c)!=this.Pe(this.sa(c)))return c}else return-1};
b.prototype.Mp=function(a,b,c){void 0===c&&(c=!0);this.Ay(a,0,null,c)};b.prototype.tF=function(b,c){var e=new a.ga(0);e.add(c);this.Ay(b,4,e,1736==b.Lb(c))};b.prototype.uF=function(b,c){var e=new a.ga(0);e.add(c);this.Ay(b,5,e,!0)};b.prototype.xg=function(){null!=this.a&&(-1!=this.kp&&(this.a.tR(this.kp),this.kp=-1),-1!=this.Bl&&(this.a.bf(this.Bl),this.Bl=-1),-1!=this.lp&&(this.a.bf(this.lp),this.lp=-1),-1!=this.Md&&(this.kh(this.Md),this.Md=-1),-1!=this.Kf&&(this.kh(this.Kf),this.Kf=-1),-1!=this.eg&&
(this.kh(this.eg),this.eg=-1),this.a=null,this.Td.Nh(!0),this.Ig.Nh(!0),this.Zq=this.Be=-1,null!=this.xc&&this.xc.Nh(!0),null!=this.Yh&&(this.Yh.length=0),null!=this.Vh&&(this.Vh.length=0),null!=this.OD&&(this.OD.length=0),null!=this.je&&this.je.Nh(!0),this.Ek=-1,this.Pm=null)};b.prototype.te=function(a){return this.Td.O(a,2)};b.prototype.w=function(a,b){this.a.SC(this.uN(a),b)};b.prototype.md=function(a){return this.Td.O(a,1)};b.prototype.Bf=function(a){return this.Td.O(a,4)};b.prototype.mw=function(a){return this.Td.O(a,
6)};b.prototype.ol=function(a){return this.Td.O(a,7)};b.prototype.zq=function(a){return this.Ig.O(a,1)};b.prototype.Gi=function(a){return this.Ig.O(a,0)};b.prototype.Sf=function(a,b){b=this.Vh[b];return b.size<=a?-1:b.read(a)};b.prototype.fm=function(a,b,c){b=this.Vh[b];b.size<=a&&b.resize(this.Td.size,-1);b.write(a,c)};b.prototype.uo=function(){null==this.Vh&&(this.Vh=[]);for(var b=a.ga.Yc(this.Td.Xc,-1),c=0,e=this.Vh.length;c<e;c++)if(null==this.Vh[c])return this.Vh[c]=b,c;this.Vh.push(b);return this.Vh.length-
1};b.prototype.vo=function(a){this.Vh[a]=null};b.prototype.qj=function(a){return this.xc.O(a,1)};b.prototype.jf=function(a){return this.qj(this.sa(a))};b.prototype.sa=function(a){return this.xc.O(a,4)};b.prototype.fe=function(a){return this.xc.O(a,5)};b.prototype.Wb=function(a){return this.xc.O(a,6)};b.prototype.Pe=function(a){return this.xc.O(a,2)};b.prototype.Qe=function(a){return this.pj(this.xc.O(a,2))};b.prototype.ql=function(a){return this.xc.O(a,7)};b.prototype.tq=function(a,b){this.w(this.qj(a),
b)};b.prototype.pl=function(a,b){this.w(this.jf(a),b)};b.prototype.Gg=function(a){return this.xc.O(a,3)&this.EK};b.prototype.tb=function(a,b){b=this.Yh[b];return b.size<=a?-1:b.read(a)};b.prototype.Bb=function(a,b,c){b=this.Yh[b];b.size<=a&&b.resize(this.xc.size,-1);b.write(a,c)};b.prototype.Eg=function(){null==this.Yh&&(this.Yh=[]);for(var b=a.ga.Yc(this.xc.Xc,-1),c=0,e=this.Yh.length;c<e;c++)if(null==this.Yh[c])return this.Yh[c]=b,c;this.Yh.push(b);return this.Yh.length-1};b.prototype.kh=function(a){this.Yh[a]=
null};b.prototype.bM=function(a){var b=this.Pe(a),c=this.Wb(a);c==this.sa(a)&&(c=this.Wb(c),c==a&&(c=-1));this.pC(b)==a&&this.Gr(b,c);c=this.Pm.read(b);isNaN(c)||(this.xF(b,NaN),this.zF(b,NaN));this.Tu(a,!0);this.Wv(a)};b.prototype.cM=function(a){for(var b=0,c=a.size;b<c;b++){var e=a.get(b),d=this.Pe(this.sa(e));this.Gr(this.Pe(e),-1);this.Gr(d,-1);this.Tu(e,!0);this.Wv(e)}};b.prototype.pC=function(a){return this.je.O(a,1)};b.prototype.pj=function(a){return this.je.O(a,2)};b.prototype.ym=function(a){return this.je.O(a,
3)};b.prototype.tN=function(a){return this.je.O(a,4)};b.prototype.yo=function(a){var b=this.Pm.read(a);isNaN(b)&&(this.bT(a),b=this.Pm.read(a));return b};b.prototype.ya=function(a){return this.a.yC(a,this.kp)};b.prototype.se=function(a){return this.a.Ra(a,this.Bl)};b.prototype.GN=function(a){return this.a.Ra(a,this.lp)};b.prototype.FN=function(a,b){var c=this.te(a);if(-1==c)return-1;var e=c,d=-1,f=-1;do{if(this.jf(e)==b)return e;if(-1==d){d=this.te(b);if(-1==d)break;f=d}if(this.jf(f)==a)return e=
this.sa(f);e=this.Wb(this.sa(e));f=this.Wb(this.sa(f))}while(e!=c&&f!=d);return-1};b.prototype.iy=function(b,c){c.mq();c=c.get();var e=new a.b;this.tq(b,e);c.ed(e);this.pl(b,e);c.vd(e)};b.prototype.lL=function(b,c){if(b==c)return 0;var e=new a.b;this.pl(b,e);var d=new a.b;this.pl(c,d);if(e.ub(d))return 0;c=new a.b;this.tq(b,c);b=new a.b;b.pc(e,c);e=new a.b;e.pc(d,c);return a.b.cq(b,e)};b.prototype.kL=function(b,c){if(b==c)return 0;var e=new a.b;this.pl(b,e);var d=new a.b;this.pl(c,d);if(e.ub(d))return 0;
c=new a.b;this.tq(b,c);b=new a.b;b.pc(e,c);e=new a.b;e.pc(d,c);return 0<=e.y&&0<b.y?a.b.cq(b,e):0};b.prototype.ZK=function(){for(var b=a.vi.Ty(this.qx),c=new a.b,e=new a.b,d=new a.b,f=new a.b,g=new a.b,k=this.Be;-1!=k;k=this.Bf(k)){var h=this.te(k);if(-1!=h){var n=h;this.tq(n,c);this.pl(n,e);g.pc(e,c);var q=g.Up();do{var l=n,n=this.Wb(this.sa(n));if(n!=l){this.pl(n,d);f.pc(d,c);var l=f.Up(),p=f.Ai(g);if(p*p/(l*q)*Math.min(l,q)<=b)return!1;g.J(f);q=l;e.J(d)}}while(n!=h)}}return!0};return b}();a.gs=
b})(z||(z={}));(function(a){var b=function(){function b(){this.h=null;this.TD=new a.b;this.UD=new a.b;this.Qg=null;this.Gq=!1;this.Ym=-1}b.prototype.Te=function(a){return a<this.Qg.length?this.Qg[a]:!1};b.prototype.xm=function(b,c,e,d){var f=a.T.ve(this.h.a.Lb(e));if(2==a.T.ve(this.h.a.Lb(c))&&1==f)this.WL(b,c,e,d);else throw a.g.wa();};b.prototype.Mp=function(b,c){null==this.h&&(this.h=new a.gs);this.h.Mp(b,c)};b.prototype.Np=function(b,c,e){a.aj.$(b,c,e,!0);for(c=b.$c;-1!=c;c=b.we(c))1736==b.Lb(c)&&
a.mm.$(b,c,-1,this.Gq,e);this.Mp(b,e)};b.prototype.EB=function(a,b,c,e,d){var f=this.h.a;if(1736==f.Lb(a))for(a=f.Vb(a);-1!=a;a=f.bc(a)){var g=f.Cb(a);this.h.se(g);this.h.se(f.X(g));var k=this.h.GN(g);if(-1!=k){var h=this.h.tb(k,c);if(1!=h&&2!=h)if(this.Te(this.h.Qe(k))){this.h.Bb(k,c,1);var h=f.Cf(b,-1),n=k,q=this.h.se(g),l=1;do{var p=this.tl(g,d);f.zi(h,p);-1!=e&&this.h.fm(q,e,1);this.h.Bb(n,c,1);var n=this.h.Wb(n),r;do p=1==l?f.X(g):f.Ua(g),r=-1!=p?this.h.se(p):-1;while(r==q);var t=this.h.qj(n);
if(t!=r){do p=1==l?f.Ua(g):f.X(g),r=-1!=p?this.h.se(p):-1;while(r==q);t!=r?(r=t,p=this.h.Gi(this.h.ol(r))):l=-l}q=r;g=p}while(n!=k);f.Gn(h,!0)}else this.h.Bb(k,c,2)}}};b.prototype.UB=function(){for(var b=this.h.Eg(),c=new a.ga(0),e=this.h.Be;-1!=e;e=this.h.Bf(e)){var d=this.h.te(e),f=d;if(-1!=d){do{if(1!=this.h.tb(f,b)){var g=this.h.sa(f);this.h.Bb(g,b,1);this.h.Bb(f,b,1);this.Te(this.h.Qe(f))&&this.Te(this.h.Qe(g))&&c.add(f)}f=this.h.Wb(this.h.sa(f))}while(f!=d)}}this.h.kh(b);this.h.cM(c)};b.prototype.tl=
function(a,b){return-1==b?a:this.kO(a,b)};b.prototype.kO=function(a,b){var c=this.h.a,e,d,f=this.h.ol(this.h.se(a));do{e=this.h.Gi(f);d=c.Vf(c.rd(e));if(d==b)return e;f=this.h.zq(f)}while(-1!=f);return a};b.prototype.Xp=function(b,c,e){this.UB();var d=this.h.a,f=d.jg(1736),g=this.h.Eg();this.pG(b,c,f,e,g,-1);this.h.kh(g);a.mm.$(d,f,1,this.Gq,null);return f};b.prototype.pG=function(a,b,c,e,d,f){this.EB(a,c,d,f,e);-1!=b&&this.EB(b,c,d,f,e);a=this.h.a;for(b=this.h.Be;-1!=b;b=this.h.Bf(b)){var g=this.h.te(b);
if(-1!=g){var k=g;do{var h=this.h.tb(k,d);if(1!=h&&2!=h)if(this.Te(this.h.Qe(k))){var h=a.Cf(c,-1),n=k;do{var q=this.h.ql(n);-1!=q?q=this.h.Gi(q):(q=this.h.Gi(this.h.ql(this.h.sa(n))),q=this.h.a.X(q));q=this.tl(q,e);a.zi(h,q);this.h.Bb(n,d,1);-1!=f&&(q=this.h.se(q),this.h.fm(q,f,1));n=this.h.Wb(n)}while(n!=k);a.Gn(h,!0)}else this.h.Bb(k,d,2);k=this.h.Wb(this.h.sa(k))}while(k!=g)}}};b.prototype.RS=function(b,c,e){var d=this.h.a,f=d.jg(1736),g=d.jg(1607),k=d.jg(550);this.UB();var h=-1,n=this.h.Eg(),
q=this.h.uo();this.pG(b,c,f,e,n,q);for(b=this.h.Be;-1!=b;b=this.h.Bf(b))if(c=this.h.te(b),-1!=c){var l=c;do{var p=this.h.tb(l,n),r=this.h.tb(this.h.sa(l),n),p=p|r;if(2==p)if(p=this.h.Gg(l),this.Te(p)){var t=d.Cf(g,-1),u=l,p=this.Au(b,d),p=this.tl(p,e);d.zi(t,p);this.h.fm(b,q,1);do{p=this.h.jf(u);r=this.Au(p,d);r=this.tl(r,e);d.zi(t,r);this.h.Bb(u,n,1);this.h.Bb(this.h.sa(u),n,1);this.h.fm(p,q,1);u=this.h.Wb(u);p=this.h.tb(u,n);r=this.h.tb(this.h.sa(u),n);p|=r;if(2!=p)break;p=this.h.Gg(u);if(!this.Te(p)){this.h.Bb(u,
n,1);this.h.Bb(this.h.sa(u),n,1);break}}while(u!=l)}else this.h.Bb(l,n,1),this.h.Bb(this.h.sa(l),n,1);l=this.h.Wb(this.h.sa(l))}while(l!=c)}for(b=this.h.Be;-1!=b;b=this.h.Bf(b))p=this.h.Sf(b,q),1!=p&&(p=this.h.md(b),this.Te(p)&&(-1==h&&(h=d.Cf(k,-1)),c=this.h.ol(b),-1!=c&&(c=this.h.Gi(c),p=this.tl(c,e),d.zi(h,p))));this.h.vo(q);this.h.kh(n);a.mm.$(d,f,1,this.Gq,null);e=[];e[0]=k;e[1]=g;e[2]=f;return e};b.prototype.Au=function(a,b){var c=-1;for(a=this.h.ol(a);-1!=a;a=this.h.zq(a)){var e=this.h.Gi(a);
-1==c&&(c=e);var d=this.h.ya(b.Vf(b.rd(e)));if(this.Te(d)){c=e;break}}return c};b.prototype.fy=function(b,c){for(var e=this.h.qj(c),d=this.h.jf(c),f=0,g=0,k=this.h.ol(e);-1!=k;k=this.h.zq(k)){var h=this.h.Gi(k),n=b.rd(h),q=this.h.ya(b.Vf(n)),l=b.X(h),p=b.Ua(h),n=b.Cb(n);n==h&&(this.Ym=c);-1!=l&&this.h.se(l)==d?(f++,this.Te(q)&&(n==l&&(this.Ym=this.h.Wb(c)),g++)):-1!=p&&this.h.se(p)==d&&(f--,this.Te(q)&&(n==p&&(this.Ym=this.h.Wb(c)),g--))}this.h.w(e,this.TD);this.h.w(d,this.UD);e=a.b.Fb(this.TD,this.UD);
return(0!=g?g:f)*e};b.prototype.Ao=function(a){return this.h.Gg(a)|this.h.Qe(a)|this.h.Qe(this.h.sa(a))};b.prototype.sG=function(a){for(var b=this.h.sa(this.h.fe(a)),c=-1;b!=a;){if(this.Te(this.Ao(b))){if(-1!=c)return-1;c=b}b=this.h.sa(this.h.fe(b))}return-1!=c?this.h.sa(c):-1};b.prototype.tG=function(a){for(var b=this.h.sa(this.h.Wb(a)),c=-1;b!=a;){if(this.Te(this.Ao(b))){if(-1!=c)return-1;c=b}b=this.h.sa(this.h.Wb(b))}return-1!=c?this.h.sa(c):-1};b.prototype.jF=function(b,c,e,d,f){var g=this.h.a,
k=b,h=this.h.sa(k);this.h.Bb(k,e,1);this.h.Bb(h,e,1);var n=this.fy(g,k);this.Ym=-1;for(var q=k,l=-1,p=!1,r=1;;){var t=this.h.fe(k);if(t==h)break;h=this.h.Wb(h);if(this.h.sa(t)!=h)if(k=this.sG(k),-1==k)break;else p=!0,h=this.h.sa(k);else k=t;if(k==b){l=b;break}t=this.Ao(k);if(!this.Te(t))break;this.h.Bb(k,e,1);this.h.Bb(h,e,1);q=k;n+=this.fy(g,k);r++}if(-1==l)for(k=b,h=this.h.sa(k),l=k;;){b=this.h.Wb(k);if(b==h)break;h=this.h.fe(h);if(this.h.sa(b)!=h)if(k=this.tG(k),-1==k){p=!0;break}else h=this.h.sa(k);
else k=b;t=this.Ao(k);if(!this.Te(t))break;this.h.Bb(k,e,1);this.h.Bb(h,e,1);l=k;n+=this.fy(g,k);r++}else if(-1!=this.Ym&&(q=this.Ym,l=this.h.fe(this.Ym),this.h.sa(l)!=this.h.Wb(this.h.sa(q))&&(l=this.sG(q),-1==l)))throw a.g.wa();0<=n||(k=l,l=this.h.sa(q),q=this.h.sa(k));e=g.Cf(c,-1);k=q;q=this.h.qj(q);p=this.h.jf(l)==q&&p;n=this.Au(q,g);n=this.tl(n,f);g.zi(e,n);-1!=d&&this.h.fm(q,d,1);q=0;for(r=p?a.I.truncate((r+1)/2):-1;;){b=this.h.jf(k);n=this.Au(b,g);n=this.tl(n,f);g.zi(e,n);q++;-1!=d&&this.h.fm(b,
d,1);p&&q==r&&(e=g.Cf(c,-1),g.zi(e,n));if(k==l)break;b=this.h.Wb(k);if(this.h.fe(this.h.sa(k))!=this.h.sa(b)){if(k=this.tG(k),-1==k)throw a.g.wa();}else k=b}};b.prototype.Yp=function(a){for(var b=this.h.a.jg(1607),c=this.h.Eg(),e=this.h.Be;-1!=e;e=this.h.Bf(e)){var d=this.h.te(e),f=d;do 1!=this.h.tb(f,c)&&this.Te(this.Ao(f))&&this.jF(f,b,c,-1,a),f=this.h.Wb(this.h.sa(f));while(f!=d)}this.h.kh(c);return b};b.prototype.SS=function(a){for(var b=this.h.a,c=b.jg(1607),e=b.jg(550),d=this.h.Eg(),f=this.h.uo(),
g=-1,k=this.h.Be;-1!=k;k=this.h.Bf(k)){var h=this.h.te(k),n=h;do{var q=this.h.tb(n,d);1!=q&&(q=this.Ao(n),this.Te(q)&&this.jF(n,c,d,f,a));n=this.h.Wb(this.h.sa(n))}while(n!=h)}for(k=this.h.Be;-1!=k;k=this.h.Bf(k))q=this.h.Sf(k,f),1!=q&&(q=this.h.md(k),this.Te(q)&&(-1==g&&(g=b.Cf(e,-1)),h=this.h.ol(k),-1!=h&&(h=this.h.Gi(h),h=this.tl(h,a),b.zi(g,h))));this.h.kh(d);this.h.vo(f);a=[];a[0]=e;a[1]=c;return a};b.prototype.Pn=function(){for(var a=this.h.a,b=a.jg(550),c=a.Cf(b,-1),e=this.h.Be;-1!=e;e=this.h.Bf(e))if(this.Te(this.h.md(e))){for(var d=
-1,f=this.h.ol(e);-1!=f;f=this.h.zq(f)){var g=this.h.Gi(f);-1==d&&(d=g);var k=this.h.ya(a.Vf(a.rd(g)));if(this.Te(k)){d=g;break}}a.zi(c,d)}return b};b.prototype.Im=function(a){this.Qg=[];for(var b=0;b<a;b++)this.Qg[b]=!1};b.qF=function(b,c,e,d){var f=b.Pa(),g=Array(1E3);a.I.Ps(g,null);var k=a.I.Lh(1E3,0),h=b.F(),n=!0,q=2==c.fb();if(1!=c.fb()&&2!=c.fb())throw a.g.wa();for(var l=0;l<h;){var p=a.I.truncate(b.fR(g,l)-l);q?a.gd.nG(c,g,p,e,k):a.gd.oG(c,g,p,e,k);for(var r=0,t=0;t<p;t++){var u=0==k[t];d||
(u=!u);u&&(n&&(n=!1,f.Pd(b,0,l)),r!=t&&f.Pd(b,l+r,l+t),r=t+1)}n||r==p||f.Pd(b,l+r,l+p);l+=p}return n?b:f};b.jD=function(c,e,d){return c instanceof a.pe?b.qF(c,e,d,!0):e instanceof a.Va?c.s()||e.s()?c.Pa():a.aj.HE(d,c,e)?a.aj.gL(c,e):c.Pa():b.mG(c,e,d,!0)};b.mt=function(c,e,d,f){var g=new a.i;c.o(g);var k=new a.i;e.o(k);var h=new a.i;h.K(g);h.Db(k);d=a.Ia.zd(d,h,!0);h=new a.i;h.K(k);k=a.Ia.As(d);h.P(k,k);if(!g.jc(h)){if(c.fb()<=e.fb())return b.Cc(b.ob(c.Pa()),c,"\x26");if(c.fb()>e.fb())return b.Cc(b.ob(e.Pa()),
c,"\x26")}k=new b;g=new a.fd;h=g.Eb(b.ob(c));e=g.Eb(b.ob(e));k.Np(g,d,f);f=k.mt(h,e);c=b.Cc(g.hf(f),c,"\x26");a.T.Kc(c.D())&&(c.hg(2,d),1736==c.D()&&c.hl());return c};b.mG=function(b,c,e,d){if(b.s())return b.Pa();if(c.s())return d?b.Pa():null;var f=[null],g=[0],k=2==c.fb();if(1!=c.fb()&&2!=c.fb())throw a.g.wa();f[0]=b.w();k?a.gd.nG(c,f,1,e,g):a.gd.oG(c,f,1,e,g);c=0==g[0];d||(c=!c);return c?b.Pa():b};b.PT=function(c,e,d){return c instanceof a.pe?b.qF(c,e,d,!1):e instanceof a.Va?c.s()?c.Pa():e.s()?
c:a.aj.HE(d,c,e)?c.Pa():c:b.mG(c,e,d,!1)};b.prototype.ME=function(b,c,e,d,f){if(b.s())return b;var g=new a.fd;b=g.Eb(b);return this.Qj(g,b,c,e,d,f)};b.prototype.EQ=function(b,c,e,d,f,g){if(f&&550!=b.Lb(c)){var k=new a.aA;k.KS(b,e);k.og?(a.aj.$(b,e,g,!0),f=!1):this.h.Mv(e)}else a.aj.$(b,e,g,!0),f=!1;d&&550!=b.Lb(c)?this.h.uF(b,c):this.h.tF(b,c);if(this.h.tx)return this.h.xg(),this.h=null,this.Qj(b,c,e,d,!1,g);this.h.Mv(NaN);g=this.h.ya(c);this.Im(g+1);this.Qg[g]=!0;if(1736==b.Lb(c)||d&&550!=b.Lb(c))return b.Pp(c,
0),c=this.Xp(c,-1,-1),b=b.hf(c),b.Pp(0),f?b.hg(1,0):(b.hg(2,e),b.hl()),b;if(1607==b.Lb(c))return c=this.Yp(-1),b=b.hf(c),f||b.hg(2,e),b;if(550==b.Lb(c))return c=this.Pn(),b=b.hf(c),f||b.hg(2,e),b;throw a.g.wa();};b.prototype.Qj=function(b,c,e,d,f,g){this.h=new a.gs;try{return this.EQ(b,c,e,d,f,g)}finally{this.h.xg()}};b.Qj=function(a,c,e,d,f){return(new b).ME(a,c,e,d,f)};b.prototype.DQ=function(b,c,e){this.Gq=b;this.h=new a.gs;b=c.Cm(e);var d=c.Lb(e);1!=b||550==d?this.h.tF(c,e):this.h.uF(c,e);if(!this.h.tx)if(this.h.Mv(NaN),
d=this.h.ya(e),this.Im(d+1),this.Qg[d]=!0,1736==c.Lb(e)||1==b&&550!=c.Lb(e))c.Pp(e,0),b=this.Xp(e,-1,-1),c.Vy(b,e),c.sy(b);else if(1607==c.Lb(e))b=this.Yp(-1),c.Vy(b,e),c.sy(b);else if(550==c.Lb(e))b=this.Pn(),c.Vy(b,e),c.sy(b);else throw a.g.ra("internal error");};b.Ry=function(a,c,e,d){var f=new b;f.Gq=!0;return f.ME(a,c,!1,e,d)};b.prototype.ll=function(b,c){var e=a.T.ve(this.h.a.Lb(b)),d=a.T.ve(this.h.a.Lb(c));if(e>d)return b;var f=this.h.ya(b),g=this.h.ya(c);this.Im((f|g)+1);this.Qg[this.h.ya(b)]=
!0;if(2==e&&2==d)return this.Xp(b,c,-1);if(1==e&&2==d||1==e&&1==d)return this.Yp(-1);if(0==e)return this.Pn();throw a.g.wa();};b.prototype.TB=function(b,c){var e=a.T.ve(this.h.a.Lb(b)),d=a.T.ve(this.h.a.Lb(c));if(e>d)return b;if(e<d)return c;var f=this.h.ya(b),g=this.h.ya(c);this.Im((f|g)+1);this.Qg[this.h.ya(b)]=!0;this.Qg[this.h.ya(c)]=!0;this.Qg[this.h.ya(b)|this.h.ya(c)]=!0;if(2==e&&2==d)return this.Xp(b,c,-1);if(1==e&&1==d)return this.Yp(-1);if(0==e&&0==d)return this.Pn();throw a.g.wa();};b.prototype.mt=
function(b,c){var e=a.T.ve(this.h.a.Lb(b)),d=a.T.ve(this.h.a.Lb(c)),f=this.h.ya(b),g=this.h.ya(c);this.Im((f|g)+1);this.Qg[this.h.ya(b)|this.h.ya(c)]=!0;f=-1;1<this.h.a.wp.Aa&&(f=b);if(2==e&&2==d)return this.Xp(b,c,f);if(1==e&&0<d||1==d&&0<e)return this.Yp(f);if(0==e||0==d)return this.Pn();throw a.g.wa();};b.prototype.Uw=function(b,c){var e=a.T.ve(this.h.a.Lb(b)),d=a.T.ve(this.h.a.Lb(c)),f=this.h.ya(b),g=this.h.ya(c);this.Im((f|g)+1);this.Qg[this.h.ya(b)|this.h.ya(c)]=!0;f=-1;1<this.h.a.wp.Aa&&(f=
b);if(2==e&&2==d)return this.RS(b,c,f);if(1==e&&0<d||1==d&&0<e)return this.SS(f);if(0==e||0==d)return e=[],e[0]=this.Pn(),e;throw a.g.wa();};b.prototype.On=function(b,c){var e=a.T.ve(this.h.a.Lb(b)),d=a.T.ve(this.h.a.Lb(c)),f=this.h.ya(b),g=this.h.ya(c);this.Im((f|g)+1);this.Qg[this.h.ya(b)]=!0;this.Qg[this.h.ya(c)]=!0;if(2==e&&2==d)return this.Xp(b,c,-1);if(1==e&&1==d)return this.Yp(-1);if(0==e&&0==d)return this.Pn();throw a.g.wa();};b.ob=function(b){var c=b.D();return 197==c?(c=new a.Ka(b.description),
b.s()||c.Wc(b,!1),c):33==c?(c=new a.pe(b.description),b.s()||c.add(b),c):322==c?(c=new a.Xa(b.description),b.s()||c.Bc(b,!0),c):b};b.Cc=function(b,c,e){var d=b.D();return 197==d?(c=new a.Ka(b.description),b.s()||c.Wc(b,!1),c):33!=d||"|"!=e&&"^"!=e?322==d?(c=new a.Xa(b.description),b.s()||c.Bc(b,!0),c):33==d&&"-"==e&&33==c.D()||550==d&&"\x26"==e&&33==c.D()?(c=new a.Va(b.description),b.s()||b.Sd(0,c),c):b:(c=new a.pe(b.description),b.s()||c.add(b),c)};b.ll=function(c,e,d,f){if(c.s()||e.s()||c.fb()>
e.fb())return b.Cc(b.ob(c),c,"-");var g=new a.i;c.o(g);var k=new a.i;e.o(k);if(!g.jc(k))return b.Cc(b.ob(c),c,"-");var h=new a.i;h.K(g);h.Db(k);d=a.Ia.zd(d,h,!0);k=new b;g=new a.fd;h=g.Eb(b.ob(c));e=g.Eb(b.ob(e));k.Np(g,d,f);f=k.ll(h,e);f=g.hf(f);c=b.Cc(f,c,"-");a.T.Kc(c.D())&&(c.hg(2,d),1736==c.D()&&c.hl());return c};b.TB=function(c,e,d,f){if(c.fb()>e.fb())return b.Cc(b.ob(c),c,"|");if(c.fb()<e.fb()||c.s())return b.Cc(b.ob(e),c,"|");if(e.s())return b.Cc(b.ob(c),c,"|");var g=new a.i;c.o(g);var k=
new a.i;e.o(k);var h=new a.i;h.K(g);h.Db(k);d=a.Ia.zd(d,h,!0);if(!g.jc(k.IN(d,d)))switch(c=b.ob(c),e=b.ob(e),c.D()){case 550:return c=a.T.Yj(c),c.Pd(e,0,-1),c;case 1607:return c=a.T.Yj(c),c.add(e,!1),c;case 1736:return c=a.T.Yj(c),c.add(e,!1),c;default:throw a.g.wa();}k=new b;g=new a.fd;h=g.Eb(b.ob(c));e=g.Eb(b.ob(e));k.Np(g,d,f);e=k.TB(h,e);c=b.Cc(g.hf(e),c,"|");a.T.Kc(c.D())&&(c.hg(2,d),1736==c.D()&&c.hl());return c};b.oM=function(c,e,d){if(2>c.length)throw a.g.N("not enough geometries to dissolve");
for(var f=0,g=0,k=c.length;g<k;g++)f=Math.max(c[g].fb(),f);var h=new a.i;h.Ja();for(var n=new a.fd,q=-1,l=0,p=-1,g=0,k=c.length;g<k;g++)if(c[g].fb()==f)if(c[g].s())-1==p&&(p=g);else{p=g;-1==q?q=n.Eb(b.ob(c[g])):n.YJ(q,b.ob(c[g]));var r=new a.i;c[g].dd(r);h.Db(r);l++}if(2>l)return b.ob(c[p]);c=2==f;e=a.Ia.zd(0==f?e:null,h,!0);return(new b).Qj(n,q,e,c,!0,d)};b.Uw=function(c,e,d,f){var g=[null,null,null],k=new a.i;c.o(k);var h=new a.i;e.o(h);var n=new a.i;n.K(k);n.Db(h);d=a.Ia.zd(d,n,!0);n=new a.i;n.K(h);
h=a.Ia.As(d);n.P(h,h);if(!k.jc(n)){if(c.fb()<=e.fb())return c=b.Cc(b.ob(c.Pa()),c,"\x26"),g[c.fb()]=c,g;if(c.fb()>e.fb())return c=b.Cc(b.ob(e.Pa()),c,"\x26"),g[c.fb()]=c,g}h=new b;k=new a.fd;n=k.Eb(b.ob(c));e=k.Eb(b.ob(e));h.Np(k,d,f);f=h.Uw(n,e);for(e=0;e<f.length;e++)h=b.Cc(k.hf(f[e]),c,"\x26"),a.T.Kc(h.D())&&(h.hg(2,d),1736==h.D()&&h.hl()),g[h.fb()]=h;return g};b.On=function(c,e,d,f){if(c.fb()>e.fb())return b.Cc(b.ob(c),c,"^");if(c.fb()<e.fb()||c.s())return b.Cc(b.ob(e),c,"^");if(e.s())return b.Cc(b.ob(c),
c,"^");var g=new a.i;c.o(g);var k=new a.i;e.o(k);var h=new a.i;h.K(g);h.Db(k);d=a.Ia.zd(d,h,!0);k=new b;g=new a.fd;h=g.Eb(b.ob(c));e=g.Eb(b.ob(e));k.Np(g,d,f);f=k.On(h,e);c=b.Cc(g.hf(f),c,"^");a.T.Kc(c.D())&&(c.hg(2,d),1736==c.D()&&c.hl());return c};b.uT=function(b,c,e){c=c.D();e=e.D();return 550==b.D()&&(33==c||33==e)&&1>=b.F()?(e=new a.Va(b.description),b.s()||b.Sd(0,e),e):b};b.prototype.ZM=function(a,b){var c=this.h.a;a=c.Cf(a,-1);for(var e=b.size,d=0;d<e;d++){var f=b.get(d);c.zi(a,f)}c.Gn(a,!0)};
b.prototype.WR=function(a,b){for(var c=this.h.a,e=c.$c;-1!=e;e=c.we(e))if(e==b)for(var d=c.Vb(e);-1!=d;d=c.bc(d)){var f=c.Cb(d);if(-1!=f)for(var g=c.X(f);-1!=g;){var f=this.h.se(f),k=this.h.se(g),f=this.h.FN(f,k);-1!=f&&(k=this.h.sa(f),this.h.Bb(f,a,1),this.h.Bb(k,a,2));f=g;g=c.X(f)}}};b.prototype.XQ=function(b,c,e,d){e=this.h.ya(e);d=this.h.ya(d);var f=new a.ga(0);f.xb(256);for(var g=this.h.a,k=this.h.Eg(),h=this.h.Be;-1!=h;h=this.h.Bf(h)){var n=this.h.te(h);if(-1!=n){var q=n;do{if(1!=this.h.tb(q,
k)){var l=q,p=q,r=!1,t=0;do{this.h.Bb(l,k,1);if(!r){var u=this.h.Gg(l);0!=(u&d)&&0!=(this.h.Qe(l)&e)&&(p=l,r=!0)}r&&(f.add(this.h.Gi(this.h.ol(this.h.qj(l)))),-1!=b&&(u=this.h.Gg(l),0!=(u&d)&&(u=this.h.tb(l,b),t|=u)));l=this.h.Wb(l)}while(l!=p);r&&0<this.h.yo(this.h.Pe(p))&&(l=g.jg(1736),this.ZM(l,f),-1!=c&&g.EF(l,c,t));f.clear(!1)}q=this.h.Wb(this.h.sa(q))}while(q!=n)}}this.h.kh(k)};b.prototype.WL=function(a,b,c,e){this.h.uR();var d=-1;-1!=a&&(d=this.h.Eg(),this.WR(d,c));this.XQ(d,a,b,c);var f=this.h.a;
a=0;for(d=f.$c;-1!=d;d=f.we(d))d!=b&&d!=c&&(e.add(d),a++);e.xd(0,a,function(a,b){a=f.Gw(f.Vb(a));b=f.Gw(f.Vb(b));return a<b?-1:a==b?0:1})};b.prototype.xg=function(){null!=this.h&&(this.h.xg(),this.h=null)};return b}();a.Of=b})(z||(z={}));(function(a){var b=function(){function b(a){void 0!==a?this.Ly(a):this.IF()}b.prototype.Lu=function(){this.Ob=this.Nb=this.sb=this.rb=this.eb=this.mb=0};b.prototype.lc=function(a){return this==a?!0:a instanceof b?this.mb==a.mb&&this.rb==a.rb&&this.Nb==a.Nb&&this.sb==
a.sb&&this.eb==a.eb&&this.Ob==a.Ob:!1};b.prototype.hc=function(){a.I.Rh();a.I.Rh();a.I.Rh();a.I.Rh();a.I.Rh();return a.I.Rh()};b.prototype.Zi=function(a,b){var c=this.sb*a.x+this.eb*a.y+this.Ob;b.x=this.mb*a.x+this.rb*a.y+this.Nb;b.y=c};b.prototype.multiply=function(a){b.multiply(this,a,this)};b.multiply=function(a,b,c){var e,d,f,g,k;e=a.mb*b.mb+a.sb*b.rb;d=a.rb*b.mb+a.eb*b.rb;f=a.Nb*b.mb+a.Ob*b.rb+b.Nb;g=a.mb*b.sb+a.sb*b.eb;k=a.rb*b.sb+a.eb*b.eb;a=a.Nb*b.sb+a.Ob*b.eb+b.Ob;c.mb=e;c.rb=d;c.Nb=f;c.sb=
g;c.eb=k;c.Ob=a};b.prototype.vm=function(){var a=new b;a.mb=this.mb;a.rb=this.rb;a.Nb=this.Nb;a.sb=this.sb;a.eb=this.eb;a.Ob=this.Ob;return a};b.prototype.$y=function(b){if(!b.s()){for(var c=[],e=0;4>e;e++)c[e]=new a.b;b.hy(c);this.US(c,c);b.Ey(c,4)}};b.prototype.US=function(b,c){for(var e=0;e<b.length;e++){var d=new a.b,f=b[e];d.x=this.mb*f.x+this.rb*f.y+this.Nb;d.y=this.sb*f.x+this.eb*f.y+this.Ob;c[e]=d}};b.prototype.wO=function(a,b){a.s()||b.s()||0==a.aa()||0==a.ba()?this.Lu():(this.rb=this.sb=
0,this.mb=b.aa()/a.aa(),this.eb=b.ba()/a.ba(),this.Nb=b.v-a.v*this.mb,this.Ob=b.C-a.C*this.eb)};b.prototype.TS=function(b){var c=new a.b,e=new a.b;c.ma(this.mb,this.sb);e.ma(this.rb,this.eb);c.sub(c);var d=.5*c.Up();c.ma(this.mb,this.sb);e.ma(this.rb,this.eb);c.add(e);c=.5*c.Up();return b*(d>c?Math.sqrt(d):Math.sqrt(c))};b.prototype.IF=function(){this.mb=1;this.sb=this.Nb=this.rb=0;this.eb=1;this.Ob=0};b.prototype.XO=function(){return 1==this.mb&&1==this.eb&&0==this.rb&&0==this.Nb&&0==this.sb&&0==
this.Ob};b.prototype.mg=function(a){return Math.abs(this.mb*this.eb-this.sb*this.rb)<=2*a*(Math.abs(this.mb*this.eb)+Math.abs(this.sb*this.rb))};b.prototype.Nn=function(a,b){this.mb=1;this.rb=0;this.Nb=a;this.sb=0;this.eb=1;this.Ob=b};b.prototype.Ly=function(a,b){void 0!==b?(this.mb=a,this.sb=this.Nb=this.rb=0,this.eb=b,this.Ob=0):this.Ly(a,a)};b.prototype.Oy=function(){this.mb=0;this.rb=1;this.Nb=0;this.sb=1;this.Ob=this.eb=0};b.prototype.jS=function(a){this.kS(Math.cos(a),Math.sin(a))};b.prototype.kS=
function(a,b){this.mb=a;this.rb=-b;this.Nb=0;this.sb=b;this.eb=a;this.Ob=0};b.prototype.shift=function(a,b){this.Nb+=a;this.Ob+=b};b.prototype.scale=function(a,b){this.mb*=a;this.rb*=a;this.Nb*=a;this.sb*=b;this.eb*=b;this.Ob*=b};b.prototype.rotate=function(a){var c=new b;c.jS(a);this.multiply(c)};b.prototype.inverse=function(a){if(void 0!==a){var b=this.mb*this.eb-this.rb*this.sb;0==b?a.Lu():(b=1/b,a.Nb=(this.rb*this.Ob-this.Nb*this.eb)*b,a.Ob=(this.Nb*this.sb-this.mb*this.Ob)*b,a.mb=this.eb*b,a.rb=
-this.rb*b,a.sb=-this.sb*b,a.eb=this.mb*b)}else this.inverse(this)};return b}();a.Bg=b})(z||(z={}));(function(a){var b=function(){function b(){}b.prototype.Lu=function(){this.fh=this.Ob=this.Nb=this.Le=this.Ie=this.He=this.Ke=this.eb=this.rb=this.ef=this.sb=this.mb=0};b.prototype.Ly=function(a,b,c){this.mb=a;this.rb=this.ef=this.sb=0;this.eb=b;this.Ie=this.He=this.Ke=0;this.Le=c;this.fh=this.Ob=this.Nb=0};b.prototype.$y=function(b){if(b.s())return b;for(var c=new a.ee[8],e=0;8>e;e++)c[e]=new a.ee;
b.hy(c);this.transform(c,8,c);b.Ey(c);return b};b.prototype.transform=function(b,c,e){for(var d=0;d<c;d++){var f=new a.ee,g=b[d];f.x=this.mb*g.x+this.rb*g.y+this.He*g.z+this.Nb;f.y=this.sb*g.x+this.eb*g.y+this.Ie*g.z+this.Ob;f.z=this.ef*g.x+this.Ke*g.y+this.Le*g.z+this.fh;e[d]=f}};b.prototype.Qn=function(b){var c=new a.ee;c.x=this.mb*b.x+this.rb*b.y+this.He*b.z+this.Nb;c.y=this.sb*b.x+this.eb*b.y+this.Ie*b.z+this.Ob;c.z=this.ef*b.x+this.Ke*b.y+this.Le*b.z+this.fh;return c};b.prototype.Ap=function(a){b.multiply(this,
a,this)};b.multiply=function(a,b,c){var e,d,f,g,k,h,n,q,l,r,p;e=a.mb*b.mb+a.sb*b.rb+a.ef*b.He;d=a.mb*b.sb+a.sb*b.eb+a.ef*b.Ie;f=a.mb*b.ef+a.sb*b.Ke+a.ef*b.Le;g=a.rb*b.mb+a.eb*b.rb+a.Ke*b.He;k=a.rb*b.sb+a.eb*b.eb+a.Ke*b.Ie;h=a.rb*b.ef+a.eb*b.Ke+a.Ke*b.Le;n=a.He*b.mb+a.Ie*b.rb+a.Le*b.He;q=a.He*b.sb+a.Ie*b.eb+a.Le*b.Ie;l=a.He*b.ef+a.Ie*b.Ke+a.Le*b.Le;r=a.Nb*b.mb+a.Ob*b.rb+a.fh*b.He+b.Nb;p=a.Nb*b.sb+a.Ob*b.eb+a.fh*b.Ie+b.Ob;a=a.Nb*b.ef+a.Ob*b.Ke+a.fh*b.Le+b.fh;c.mb=e;c.sb=d;c.ef=f;c.rb=g;c.eb=k;c.Ke=
h;c.He=n;c.Ie=q;c.Le=l;c.Nb=r;c.Ob=p;c.fh=a};b.inverse=function(b,c){var e=b.mb*(b.eb*b.Le-b.Ke*b.Ie)-b.sb*(b.rb*b.Le-b.Ke*b.He)+b.ef*(b.rb*b.Ie-b.eb*b.He);if(0!=e){var d,f,g,k,h,n,q,l,r,p;l=1/e;e=(b.eb*b.Le-b.Ke*b.Ie)*l;g=-(b.rb*b.Le-b.Ke*b.He)*l;n=(b.rb*b.Ie-b.eb*b.He)*l;d=-(b.sb*b.Le-b.Ie*b.ef)*l;k=(b.mb*b.Le-b.ef*b.He)*l;q=-(b.mb*b.Ie-b.sb*b.He)*l;f=(b.sb*b.Ke-b.ef*b.eb)*l;h=-(b.mb*b.Ke-b.ef*b.rb)*l;l*=b.mb*b.eb-b.sb*b.rb;r=-(b.Nb*e+b.Ob*g+b.fh*n);p=-(b.Nb*d+b.Ob*k+b.fh*q);b=-(b.Nb*f+b.Ob*h+b.fh*
l);c.mb=e;c.sb=d;c.ef=f;c.rb=g;c.eb=k;c.Ke=h;c.He=n;c.Ie=q;c.Le=l;c.Nb=r;c.Ob=p;c.fh=b}else throw a.g.ra("math singularity");};b.prototype.vm=function(){var a=new b;a.mb=this.mb;a.sb=this.sb;a.ef=this.ef;a.rb=this.rb;a.eb=this.eb;a.Ke=this.Ke;a.He=this.He;a.Ie=this.Ie;a.Le=this.Le;a.Nb=this.Nb;a.Ob=this.Ob;a.fh=this.fh;return a};return b}();a.ZT=b})(z||(z={}));(function(a){var b=function(b){function e(a){if(void 0!==a)b.call(this,a.hc(),a);else{b.call(this);this.Jf=[];this.Jf[0]=0;this.Aa=1;this.Wg=
[];for(a=0;10>a;a++)this.Wg[a]=-1;this.Wg[this.Jf[0]]=0}this.To=!0}w(e,b);e.prototype.Ne=function(a){this.hasAttribute(a)||(this.Wg[a]=0,this.xA())};e.prototype.removeAttribute=function(b){if(0==b)throw a.g.N("Position attribue cannot be removed");this.hasAttribute(b)&&(this.Wg[b]=-1,this.xA())};e.prototype.reset=function(){this.Jf[0]=0;this.Aa=1;for(var a=0;a<this.Wg.length;a++)this.Wg[a]=-1;this.Wg[this.Jf[0]]=0;this.To=!0};e.prototype.qw=function(){return c.ww().add(this)};e.Tf=function(){return c.ww().iO()};
e.Zn=function(){return c.ww().jO()};e.prototype.pJ=function(){var b=this.hc();return new a.pa(b,this)};e.prototype.xA=function(){for(var a=this.Aa=0,b=0;10>a;a++)0<=this.Wg[a]&&(this.Jf[b]=a,this.Wg[a]=b,b++,this.Aa++);this.To=!0};e.prototype.hc=function(){this.To&&(this.tk=this.jj(),this.To=!1);return this.tk};e.prototype.lc=function(a){if(null==a)return!1;if(a==this)return!0;if(!(a instanceof e)||a.Aa!=this.Aa)return!1;for(var b=0;b<this.Aa;b++)if(this.Jf[b]!=a.Jf[b])return!1;return this.To!=a.To?
!1:!0};e.prototype.qD=function(a){if(a.Aa!=this.Aa)return!1;for(var b=0;b<this.Aa;b++)if(this.Jf[b]!=a.Jf[b])return!1;return!0};e.iu=function(a,b){for(var c=[],e=0;e<a.Aa;e++)c[e]=-1;for(var e=0,d=a.Aa;e<d;e++)c[e]=b.zf(a.Hd(e));return c};e.PN=function(a,b){a=new e(a);a.Ne(b);return a.qw()};e.QN=function(a,b){for(var c=null,d=0;10>d;d++)!a.hasAttribute(d)&&b.hasAttribute(d)&&(null==c&&(c=new e(a)),c.Ne(d));return null!=c?c.qw():a};e.bo=function(a,b){a=new e(a);a.removeAttribute(b);return a.qw()};
return e}(a.pa);a.Od=b;var c=function(){function a(){this.map=[];var a=new b;this.add(a);a=new b;a.Ne(1);this.add(a)}a.ww=function(){return a.lI};a.prototype.iO=function(){return a.Yn};a.prototype.jO=function(){return a.Zn};a.prototype.add=function(b){var c=b.hc();if(null!=a.Yn&&a.Yn.hc()==c&&b.qD(a.Yn))return a.Yn;if(null!=a.Zn&&a.Zn.hc()==c&&b.qD(a.Zn))return a.Zn;var e=null;void 0!==this.map[c]&&(e=this.map[c]);null==e&&(e=b.pJ(),1==e.Aa?a.Yn=e:2==e.Aa&&1==e.Hd(1)?a.Zn=e:this.map[c]=e);return e};
a.lI=new a;return a}()})(z||(z={}));var M=0==h.version.indexOf("4."),R;(function(a){a[a.Linear=0]="Linear";a[a.Angular=1]="Angular";a[a.Area=2]="Area";a[a.LinearOrAngular=3]="LinearOrAngular"})(R||(R={}));var P={feet:9002,kilometers:9036,meters:9001,miles:9035,"nautical-miles":9030,yards:9096},Q={acres:109402,ares:109463,hectares:109401,"square-feet":109405,"square-kilometers":109414,"square-meters":109404,"square-miles":109413,"square-yards":109442},T={degrees:9102,radians:9101};void 0===d.prototype.getCacheValue&&
e.extend(d,{cache:null,getCacheValue:function(a){if(null===this.cache||void 0===this.cache)this.cache={};return this.cache[a]},setCacheValue:function(a,b){if(null===this.cache||void 0===this.cache)this.cache={};this.cache[a]=b}});var O=z.Nf.create(4326),S=z.Nf.create(102100);return function(){function a(){}a.extendedSpatialReferenceInfo=function(a){if(null===a)return null;a=x(a);var b=a.Se();return{tolerance:a.xq(),unitType:null==b?-1:b.Nc,unitID:null==b?-1:b.Qc(),unitBaseFactor:null==b?0:b.Dj,unitSquareDerivative:null==
b?0:z.Tb.PC(b).Qc()}};a.clip=function(a,b){if(null===a)return null;b=z.Pb.clip(y(a),y(b),n(a));return u(b,a.spatialReference)};a.cut=function(a,b){b=y(b);b=z.Pb.xm(y(a),b,n(a));for(var c=[],e=0;e<b.length;e++)c.push(u(b[e],a.spatialReference));return c};a.contains=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z.Pb.contains(y(a),y(b),n(a))};a.crosses=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z.Pb.VL(y(a),y(b),n(a))};
a.distance=function(a,b,c){if(null===a||null===b)throw Error("Illegal Argument Exception");return z.Pb.Fb(y(a),y(b),n(a),z.Tb.Qd(t(c,3)))};a.equals=function(a,b){return null===a&&null!==b||null===b&&null!==a?!1:z.Pb.lc(y(a),y(b),n(a))};a.intersects=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z.Pb.RO(y(a),y(b),n(a))};a.touches=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z.Pb.touches(y(a),y(b),n(a))};a.within=function(a,
b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z.Pb.jT(y(a),y(b),n(a))};a.disjoint=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z.Pb.nM(y(a),y(b),n(a))};a.overlaps=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z.Pb.tQ(y(a),y(b),n(a))};a.relate=function(a,b,c){if(null===a||null===b)throw Error("Illegal Argument Exception");return z.Pb.py(y(a),y(b),n(a),c)};a.isSimple=function(a){if(null===a)throw Error("Illegal Argument Exception");
return z.Pb.cP(y(a),n(a))};a.simplify=function(a){if(null===a)throw Error("Illegal Argument Exception");var b=z.Pb.Qy(y(a),n(a));return u(b,a.spatialReference)};a.convexHull=function(b,c){void 0===c&&(c=!1);if(null===b)throw Error("Illegal Argument Exception");return b instanceof d?(c=z.Pb.JL(y(b),n(b)),u(c,b.spatialReference)):a.NI(b,c)};a.NI=function(a,b){for(var c=[],e=0;e<a.length;e++)c.push(y(a[e]));c=z.Pb.KL(c,b);for(e=0;e<c.length;e++)c[e]=u(c[e],a[0].spatialReference);return c};a.difference=
function(b,c){if(null===b||null===c)throw Error("Illegal Argument Exception");return b instanceof d?(c=z.Pb.ll(y(b),y(c),n(b)),u(c,b.spatialReference)):a.XL(b,c)};a.XL=function(a,b){for(var c=[],e=0;e<a.length;e++)c.push(y(a[e]));c=z.Pb.kM(c,y(b),n(b));for(e=0;e<c.length;e++)c[e]=u(c[e],b.spatialReference);return c};a.symmetricDifference=function(b,c){if(null===b||null===c)throw Error("Illegal Argument Exception");return b instanceof d?(c=z.Pb.On(y(b),y(c),n(b)),u(c,b.spatialReference)):a.tO(b,c)};
a.tO=function(a,b){for(var c=[],e=0;e<a.length;e++)c.push(y(a[e]));c=z.Pb.MS(c,y(b),n(b));for(e=0;e<c.length;e++)c[e]=u(c[e],b.spatialReference);return c};a.intersect=function(b,c){if(null===b||null===c)throw Error("Illegal Argument Exception");return b instanceof d?(c=z.Pb.Ga(y(b),y(c),n(b)),u(c,b.spatialReference)):a.EM(b,c)};a.EM=function(a,b){for(var c=[],e=0;e<a.length;e++)c.push(y(a[e]));c=z.Pb.QO(c,y(b),n(b));for(e=0;e<c.length;e++)c[e]=u(c[e],b.spatialReference);return c};a.union=function(a,
b){void 0===b&&(b=null);if(null===a)return null;a instanceof d&&(a=[a],null!==b&&a.push(b));if(0===a.length)return null;b=[];for(var c=0;c<a.length;c++)b.push(y(a[c]));return u(z.Pb.aT(b,n(a[0])),a[0].spatialReference)};a.offset=function(b,c,e,f,g,k){var h=0;if(null!=f&&void 0!=f)switch(f){case "round":h=0;break;case "bevel":h=1;break;case "miter":h=2;break;case "square":h=3}return b instanceof d?(c=z.Pb.offset(y(b),n(b),c,h,g,k,z.Tb.Qd(t(e,3))),u(c,b.spatialReference)):a.qO(b,c,e,h,g,k)};a.qO=function(a,
b,c,e,d,f){if(null===a)return null;if(0===a.length)return[];for(var g=[],k=0;k<a.length;k++)g.push(y(a[k]));b=z.Pb.sQ(g,n(a[0]),b,e,d,f,z.Tb.Qd(t(c,3)));for(k=0;k<b.length;k++)b[k]=u(b[k],a[0].spatialReference);return b};a.buffer=function(b,c,e,f){void 0===f&&(f=!1);if(b instanceof d)return c=z.Pb.buffer(y(b),n(b),c,z.Tb.Qd(t(e,3)),!1,0,NaN),u(c,b.spatialReference);if("[object Array]"!==Object.prototype.toString.call(c)){for(var g=[],k=0;k<b.length;k++)g.push(c);c=g}if(c.length!=b.length){if(0==c.length)throw Error("Illegal Argument Exception");
for(var g=[],h=0,k=0;k<b.length;k++)void 0===c[k]?g.push(h):(g.push(c[k]),h=c[k]);c=g}return a.vG(b,c,e,!1,f,"geodesic",NaN)};a.geodesicBuffer=function(b,c,e,f,g,k){if(b instanceof d)return void 0===g&&(g=NaN),c=z.Pb.buffer(y(b),n(b),c,z.Tb.Qd(t(e,0)),!0,r(f),g),u(c,b.spatialReference);if("[object Array]"!==Object.prototype.toString.call(c)){for(var h=[],q=0;q<b.length;q++)h.push(c);c=h}if(c.length!=b.length){if(0==c.length)throw Error("Illegal Argument Exception");for(var h=[],l=0,q=0;q<b.length;q++)void 0===
c[q]?h.push(l):(h.push(c[q]),l=c[q]);c=h}return a.vG(b,c,e,!0,f,g,k)};a.vG=function(a,b,c,e,d,f,g){if(null===a)return null;if(0===a.length)return[];void 0===g&&(g=NaN);for(var k=[],h=0;h<a.length;h++)k.push(y(a[h]));b=z.Pb.rK(k,n(a[0]),b,z.Tb.Qd(t(c,0)),e,d,r(f),g);for(h=0;h<b.length;h++)b[h]=u(b[h],a[0].spatialReference);return b};a.nearestCoordinate=function(a,b,c){void 0===c&&(c=!0);b=z.Pb.zw(y(a),y(b),c);return{coordinate:u(b.pw(),a.spatialReference),distance:b.sw(),isRightSide:b.Xw(),vertexIndex:b.gb(),
isEmpty:b.s()}};a.nearestVertex=function(a,b){b=z.Pb.Aw(y(a),y(b));return{coordinate:u(b.pw(),a.spatialReference),distance:b.sw(),isRightSide:b.Xw(),vertexIndex:b.gb(),isEmpty:b.s()}};a.nearestVertices=function(a,b,c,e){b=y(b);c=z.Pb.Bw(y(a),b,c,e);e=[];for(b=0;b<c.length;b++)!1===c[b].s()&&e.push({coordinate:u(c[b].pw(),a.spatialReference),distance:c[b].sw(),isRightSide:c[b].Xw(),vertexIndex:c[b].gb(),isEmpty:c[b].s()});return e};a.generalize=function(a,b,c,e){b=z.Pb.fN(y(a),n(a),b,c,z.Tb.Qd(t(e,
3)));return u(b,a.spatialReference)};a.densify=function(a,b,c){b=z.Pb.oq(y(a),n(a),b,z.Tb.Qd(t(c,3)));return u(b,a.spatialReference)};a.geodesicDensify=function(a,b,c,e){void 0===e&&(e=0);b=z.Pb.fw(y(a),n(a),b,z.Tb.Qd(t(c,3)),e);return u(b,a.spatialReference)};a.rotate=function(a,b,e){if(void 0===e||null===e)switch(a.type){case "point":e=a;break;case "extent":e=M?a.get("center"):a.getCenter();break;default:e=M?a.get("extent").get("center"):a.getExtent().getCenter()}b=M?z.Wn.rotate(a.toJSON(),b,e.toJSON()):
z.Wn.rotate(a.toJson(),b,e.toJson());M?(b=q(b),b.set("spatialReference",a.spatialReference)):(b=c(b),b.setSpatialReference(a.spatialReference));return b};a.flipHorizontal=function(a,b){if(void 0===b||null===b)switch(a.type){case "point":b=a;break;case "extent":b=M?a.get("center"):a.getCenter();break;default:b=M?a.get("extent").get("center"):a.getExtent().getCenter()}b=M?z.Wn.eC(a.toJSON(),b.toJSON()):z.Wn.eC(a.toJson(),b.toJson());M?(b=q(b),b.set("spatialReference",a.spatialReference)):(b=c(b),b.setSpatialReference(a.spatialReference));
return b};a.flipVertical=function(a,b){if(void 0===b||null===b)switch(a.type){case "point":b=a;break;case "extent":b=M?a.get("center"):a.getCenter();break;default:b=M?a.get("extent").get("center"):a.getExtent().getCenter()}b=M?z.Wn.fC(a.toJSON(),b.toJSON()):z.Wn.fC(a.toJson(),b.toJson());M?(b=q(b),b.set("spatialReference",a.spatialReference)):(b=c(b),b.setSpatialReference(a.spatialReference));return b};a.planarArea=function(a,b){if(null===a)throw Error("Illegal Argument Exception");return z.Pb.BQ(y(a),
n(a),z.Tb.Qd(t(b,2)))};a.planarLength=function(a,b){if(null===a)throw Error("Illegal Argument Exception");return z.Pb.CQ(y(a),n(a),z.Tb.Qd(t(b,3)))};a.geodesicArea=function(a,b,c){if(null===a)throw Error("Illegal Argument Exception");return z.Pb.jN(y(a),n(a),z.Tb.Qd(t(b,2)),r(c))};a.geodesicLength=function(a,b,c){if(null===a)throw Error("Illegal Argument Exception");return z.Pb.nN(y(a),n(a),z.Tb.Qd(t(b,0)),r(c))};return a}()})},"esri/widgets/support/AnchorElementViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/watchUtils ../../core/Accessor ../../core/Evented ../../core/HandleRegistry ../../core/watchUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e){return function(c){function f(){var b=c.call(this)||this;return b._anchorHandles=new a,b.location=null,b.screenLocation=null,b.screenLocationEnabled=!1,b.view=null,b._anchorHandles.add([e.watch(b,"screenLocationEnabled,location,view.size",function(){return b._updateScreenPointAndHandle()}),e.watch(b,"view, view.ready",function(){return b._wireUpView()})]),b}return h(f,c),f.prototype.destroy=function(){this.view=null;this._anchorHandles&&this._anchorHandles.destroy();
this._viewpointHandle=this._anchorHandles=null},f.prototype._wireUpView=function(){var a=this;this._anchorHandles.remove("view");this._viewpointHandle=null;if(this.get("view.ready")){this._setScreenLocation();var b=this.view,b=g.pausable(b,"3d"===b.type?"camera":"viewpoint",function(){return a._viewpointChange()});this._anchorHandles.add(b,"view");this._viewpointHandle=b;this._toggleWatchingViewpoint()}},f.prototype._viewpointChange=function(){this._setScreenLocation();this.emit("view-change")},f.prototype._updateScreenPointAndHandle=
function(){this._setScreenLocation();this._toggleWatchingViewpoint()},f.prototype._toggleWatchingViewpoint=function(){var a=this._viewpointHandle,b=this.location,c=this.screenLocationEnabled;a&&(b&&c?a.resume():a.pause())},f.prototype._setScreenLocation=function(){var a=this.location,b=this.view,c=this.screenLocationEnabled,e=this.get("view.ready"),a=c&&a&&e?b.toScreen(a):null;this._set("screenLocation",a)},d([b.property()],f.prototype,"location",void 0),d([b.property({readOnly:!0})],f.prototype,
"screenLocation",void 0),d([b.property()],f.prototype,"screenLocationEnabled",void 0),d([b.property()],f.prototype,"view",void 0),f=d([b.subclass("esri.widgets.support.AnchorElementViewModel")],f)}(b.declared(k,f))})},"esri/widgets/Popup/nls/Popup":function(){define({root:{zoom:"Zoom to",next:"Next feature",previous:"Previous feature",close:"Close",dock:"Dock",undock:"Undock",menu:"Menu",untitled:"Untitled",pageText:"{index} of {total}",selectedFeature:"Selected feature",selectedFeatures:"{total} results",
loading:"Loading",collapse:"Collapse",expand:"Expand"},ar:1,bs:1,cs:1,da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lv:1,lt:1,nl:1,nb:1,pl:1,"pt-br":1,"pt-pt":1,ro:1,ru:1,sl:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"esri/widgets/Spinner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./support/widget ../core/accessorSupport/decorators ./Widget ../core/promiseUtils ../core/watchUtils ./support/AnchorElementViewModel".split(" "),
function(m,l,h,d,b,g,k,f,a,e){return function(c){function k(a){a=c.call(this)||this;return a._animationDelay=500,a._animationPromise=null,a.location=null,a.view=null,a.visible=!1,a.viewModel=new e,a}return h(k,c),k.prototype.postInitialize=function(){var b=this;this.own([a.watch(this,"visible",function(a){return b._visibleChange(a)})])},k.prototype.destroy=function(){this._cancelAnimationPromise()},k.prototype.show=function(a){var b=this,c=a.location;a=a.promise;c&&(this.viewModel.location=c);this.visible=
!0;a&&a.always(function(){return b.hide()})},k.prototype.hide=function(){this.visible=!1},k.prototype.render=function(){var a=this.visible,c=!!this.viewModel.screenLocation,a=(e={},e["esri-spinner--start"]=a&&c,e["esri-spinner--finish"]=!a&&c,e),e=this._getPositionStyles();return b.tsx("div",{"class":"esri-spinner",classes:a,styles:e});var e},k.prototype._cancelAnimationPromise=function(){this._animationPromise&&(this._animationPromise.cancel(),this._animationPromise=null)},k.prototype._visibleChange=
function(a){var b=this;return a?void(this.viewModel.screenLocationEnabled=!0):(this._cancelAnimationPromise(),void(this._animationPromise=f.after(this._animationDelay).then(function(){b.viewModel.screenLocationEnabled=!1;b._animationPromise=null})))},k.prototype._getPositionStyles=function(){var a=this.viewModel.screenLocation;return a?{left:a.x+"px",top:a.y+"px"}:{}},d([g.aliasOf("viewModel.location")],k.prototype,"location",void 0),d([g.aliasOf("viewModel.view")],k.prototype,"view",void 0),d([g.property(),
b.renderable()],k.prototype,"visible",void 0),d([g.property({type:e}),b.renderable(["viewModel.screenLocation","viewModel.screenLocationEnabled"])],k.prototype,"viewModel",void 0),k=d([g.subclass("esri.widgets.Spinner")],k)}(g.declared(k))})},"esri/views/PopupManager":function(){define("require ../core/promiseUtils dojo/_base/array dojo/on dojo/Deferred dojo/promise/all ../layers/support/layerUtils ../geometry/support/scaleUtils ../geometry/Extent ../tasks/support/Query ../layers/GroupLayer ../core/Accessor".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){var t;return q.createSubclass({declaredClass:"esri.views.PopupManager",properties:{map:{dependsOn:["view.map"],readOnly:!0}},constructor:function(){this._featureLayersCache={}},destroy:function(){this._featureLayersCache={};this.view=null},_clickHandle:null,_featureLayersCache:null,enabled:!1,_enabledSetter:function(a){this._clickHandle&&(a?this._clickHandle.resume():this._clickHandle.pause());this._set("enabled",a)},_mapGetter:function(){return this.get("view.map")||
null},view:null,_viewSetter:function(a){this._clickHandle&&(this._clickHandle.remove(),this._clickHandle=null);a&&(this._clickHandle=d.pausable(a,"click",this._clickHandler.bind(this)),this.enabled||this._clickHandle.pause());this._set("view",a)},getMapLayer:function(a){var b;if(a&&(b=a.findLayerById())&&(a=b.id,this._featureLayersCache[a])){var c=a.lastIndexOf("_");-1<c&&(a=a.substring(0,c),b=this.map.findLayerById(a))}return b},_closePopup:function(){var a=this.get("view.popup");a&&(a.clear(),a.close())},
_showPopup:function(d,g,k){function q(a){return t.allLayerViews.find(function(b){return b.layer===a})}function r(a){if(null==a)return!1;var b=q(a);return null==b?!1:a.loaded&&!b.suspended&&(a.popupEnabled&&a.popupTemplate||"graphics"===a.type||"geo-rss"===a.type||"map-notes"===a.type||"kml"===a.type||b.getPopupData)}function n(a){return(a=q(a))&&a.hasDraped}var t=this.view;d=t.popup;var u=this,v=[],m="3d"===t.type;h.forEach(this.map.layers.toArray(),function(a){a.isInstanceOf(c)?h.forEach(a.layers.toArray(),
function(a){!r(a)||m&&!n(a)||v.push(a)}):!r(a)||m&&!n(a)||v.push(a)});0<t.graphics.length&&v.push(t.graphics);if((k&&t.graphics.includes(k)?!k.popupTemplate:k&&!r(k.layer))&&(k=null),!v.length&&!k)return void u._closePopup();var F=[],G=!!k,N=u._calculateClickTolerance(v);if(!g)return void u._closePopup();var M=1;"2d"===t.type&&(M=t.state.resolution);var R=t.basemapTerrain;R&&R.overlayManager&&(M=R.overlayManager.overlayPixelSizeInMapUnits(g));N*=M;R&&!R.spatialReference.equals(t.spatialReference)&&
(N*=f.getMetersPerUnitForSR(R.spatialReference)/f.getMetersPerUnitForSR(t.spatialReference));var R=g.clone().offset(-N,-N),N=g.clone().offset(N,N),P=new a(Math.min(R.x,N.x),Math.min(R.y,N.y),Math.max(R.x,N.x),Math.max(R.y,N.y),t.spatialReference),R=function(a){var b;if("imagery"===a.type){b=new e;b.geometry=g;var c=q(a),d={rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0};d.layerView=c;b=a.queryVisibleRasters(b,d).then(function(a){return G=G||0<a.length,a})}else if("csv"===a.type||
"scene"===a.type||!u._featureLayersCache[a.id]&&"function"!=typeof a.queryFeatures){if("map-image"===a.type||"wms"===a.type)return c=q(a),c.getPopupData(P);var f,h=[];"esri.core.Collection\x3cesri.Graphic\x3e"===a.declaredClass?(d=a,f=!0):"graphics"===a.type?(d=a.graphics,f=!0):(c=q(a),d=c&&c.loadedGraphics,f=!1);d&&(h=d.filter(function(a){return a&&(!f||a.popupTemplate)&&a.visible&&P.intersects(a.geometry)}).toArray());0<h.length&&(G=!0,b="scene"===a.type?u._fetchSceneAttributes(a,h):l.resolve(h))}else c=
a.createQuery(),c.geometry=P,b=a.queryFeatures(c).then(function(b){b=b.features;if(k&&k.layer===a&&a.objectIdField){var c=a.objectIdField,e=k.attributes[c];b=b.filter(function(a){return a.attributes[c]!==e})}if(!k&&"function"==typeof q(a).getGraphics3DGraphics){var d=[],f=q(a).getGraphics3DGraphics(),g;for(g in f)d.push(f[g].graphic.attributes[a.objectIdField]);b=b.filter(function(b){return-1!==d.indexOf(b.attributes[a.objectIdField])})}return G=G||0<b.length,b});return b};if(m&&!k||!m)var F=v.map(R).filter(function(a){return!!a}),
Q=function(a){return a.reduce(function(a,b){return a.concat(b.items?Q(b.items):b)},[])},F=Q(F);k&&(k.layer&&"scene"===k.layer.type?F.unshift(this._fetchSceneAttributes(k.layer,[k])):k.popupTemplate&&(R=new b,F.unshift(R.resolve([k]))));return h.some(F,function(a){return!a.isFulfilled()})||G?void(F.length&&d.open({promises:F,location:g})):void u._closePopup()},_fetchSceneAttributes:function(a,b){return this.view.whenLayerView(a).then(function(c){var e=this._getOutFields(a.popupTemplate),d=b.map(function(a){return c.whenGraphicAttributes(a,
e).otherwise(function(){return a})});return l.eachAlways(d)}.bind(this)).then(function(a){return a.map(function(a){return a.value})})},_getSubLayerFeatureLayers:function(a,c){var e=c||new b,f=[];c=a.length;var q=Math.floor(this.view.extent.width/this.view.width),n=this.view.scale,l=!1,r=this,u=0;a:for(;c>u;u++){var B=a[u],F=B.dynamicLayerInfos||B.layerInfos;if(F){var G=null;B._params&&(B._params.layers||B._params.dynamicLayers)&&(G=B.visibleLayers);for(var G=k._getVisibleLayers(F,G),N=k._getLayersForScale(n,
F),M=F.length,R=0;M>R;R++){var P=F[R],Q=P.id,T=B.popupTemplates[Q];if(!P.subLayerIds&&T&&T.popupTemplate&&-1<h.indexOf(G,Q)&&-1<h.indexOf(N,Q)){if(!t){l=!0;break a}var O=B.id+"_"+Q,S=this._featureLayersCache[O];S&&S.loadError||(S||((S=T.layerUrl)||(S=P.source?this._getLayerUrl(B.url,"/dynamicLayer"):this._getLayerUrl(B.url,Q)),S=new t(S,{id:O,drawMode:!1,mode:t.MODE_SELECTION,outFields:this._getOutFields(T.popupTemplate),resourceInfo:T.resourceInfo,source:P.source}),this._featureLayersCache[O]=S),
S.setDefinitionExpression(B.layerDefinitions&&B.layerDefinitions[Q]),S.setGDBVersion(B.gdbVersion),S.popupTemplate=T.popupTemplate,S.setMaxAllowableOffset(q),S.setUseMapTime(!!B.useMapTime),B.layerDrawingOptions&&B.layerDrawingOptions[Q]&&B.layerDrawingOptions[Q].renderer&&S.setRenderer(B.layerDrawingOptions[Q].renderer),f.push(S))}}}}if(l){var H=new b;m(["../layers/FeatureLayer"],function(a){t=a;H.resolve()});H.then(function(){r._getSubLayerFeatureLayers(a,e)})}else{var Y=[];h.forEach(f,function(a){if(!a.loaded){var c=
new b;d.once(a,"load, error",function(){c.resolve()});Y.push(c.promise)}});Y.length?g(Y).then(function(){f=h.filter(f,function(a){return!a.loadError&&a.isVisibleAtScale(n)});e.resolve(f)}):(f=h.filter(f,function(a){return a.isVisibleAtScale(n)}),e.resolve(f))}return e.promise},_getLayerUrl:function(a,b){var c=a.indexOf("?");return-1===c?a+"/"+b:a.substring(0,c)+"/"+b+a.substring(c)},_getOutFields:function(a){var b=["*"];if("esri.PopupTemplate"===a.declaredClass){var c=null==a.content||Array.isArray(a.content)&&
a.content.every(function(a){return"attachments"===a.type||"fields"===a.type&&null==a.fieldInfos||"text"===a.type&&-1===a.text.indexOf("{")});a.fieldInfos&&!a.expressionInfos&&c&&(b=[],h.forEach(a.fieldInfos,function(a){var c=a.fieldName&&a.fieldName.toLowerCase();c&&"shape"!==c&&0!==c.indexOf("relationships/")&&b.push(a.fieldName)}))}return b},_calculateClickTolerance:function(a){var b=6;return h.forEach(a,function(a){if(a=a.renderer)"simple"===a.type?((a=a.symbol)&&a.xoffset&&(b=Math.max(b,Math.abs(a.xoffset))),
a&&a.yoffset&&(b=Math.max(b,Math.abs(a.yoffset)))):"unique-value"!==a.type&&"class-breaks"!==a.type||h.forEach(a.uniqueValueInfos||a.classBreakInfos,function(a){(a=a.symbol)&&a.xoffset&&(b=Math.max(b,Math.abs(a.xoffset)));a&&a.yoffset&&(b=Math.max(b,Math.abs(a.yoffset)))})}),b},_clickHandler:function(a){function b(a){return e.allLayerViews.find(function(b){return b.layer===a})}var e=this.view,d=e.popup,f=e.map,g=a.screenPoint,k=this;if(0===a.button&&d&&e.ready){var h="3d"===e.type,q=f.allLayers.some(function(a){if(a.isInstanceOf(c))a=
!1;else{var e;null==a?e=!1:(e=b(a),e=null==e?!1:a.loaded&&!e.suspended&&(a.popupEnabled&&a.popupTemplate||"graphics"===a.type||e.getPopupData));!(e=!e)&&(e=h)&&(a=b(a),e=!(a&&a.hasDraped));a=e?!1:!0}return a});return null!=g?void this.view.hitTest(g.x,g.y).then(function(b){q||0<b.results.length?0<b.results.length?(b=b.results[0],k._showPopup(a,b.mapPoint,b.graphic)):k._showPopup(a,a.mapPoint,null):k._closePopup()}):void k._showPopup(a,a.mapPoint)}}})})},"esri/layers/support/layerUtils":function(){define(["dojo/_base/array"],
function(m){return{_serializeLayerDefinitions:function(l){var h=[],d=!1,b=/[:;]/;if(l&&(m.forEach(l,function(g,f){g&&(h.push([f,g]),!d&&b.test(g)&&(d=!0))}),0<h.length)){var g;return d?(g={},m.forEach(h,function(b){g[b[0]]=b[1]}),g=JSON.stringify(g)):(g=[],m.forEach(h,function(b){g.push(b[0]+":"+b[1])}),g=g.join(";")),g}return null},_serializeTimeOptions:function(l,h){if(l){var d=[];return m.forEach(l,function(b,g){b&&(b=b.toJSON(),h&&-1!==m.indexOf(h,g)&&(b.useTime=!1),d.push('"'+g+'":'+JSON.stringify(b)))}),
d.length?"{"+d.join(",")+"}":void 0}},_getVisibleLayers:function(l,h){var d,b,g=[];if(!l)return g;if(h)for(g=h.concat(),b=0;b<l.length;b++)h=l[b],d=m.indexOf(l,h.id),h.subLayerIds&&-1<d&&(g.splice(d,1),g=g.concat(h.subLayerIds));else g=this._getDefaultVisibleLayers(l);return g},_getDefaultVisibleLayers:function(l){var h,d=[];if(!l)return d;for(h=0;h<l.length;h++)0<=l[h].parentLayerId&&-1===m.indexOf(d,l[h].parentLayerId)&&m.some(l,function(b){return b.id===l[h].parentLayerId})||l[h].defaultVisibility&&
d.push(l[h].id);return d},_getLayersForScale:function(l,h){var d=[];if(0<l&&h){var b;for(b=0;b<h.length;b++)if(!(0<=h[b].parentLayerId&&-1===m.indexOf(d,h[b].parentLayerId)&&m.some(h,function(a){return a.id===h[b].parentLayerId}))&&0<=h[b].id){var g=!0,k=h[b].maxScale,f=h[b].minScale;(0<k||0<f)&&(0<k&&0<f?g=l>=k&&f>=l:0<k?g=l>=k:0<f&&(g=f>=l));g&&d.push(h[b].id)}}return d}}})},"esri/layers/GroupLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Layer ../core/MultiOriginJSONSupport ./mixins/PortalLayer ./mixins/OperationalLayer ../support/LayersMixin ../core/accessorSupport/utils ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){return function(a){function b(b){b=a.call(this)||this;return b._visibilityHandles={},b.fullExtent=void 0,b.operationalLayerType="GroupLayer",b.spatialReference=void 0,b.type="group",b._visibilityWatcher=b._visibilityWatcher.bind(b),b}return h(b,a),b.prototype.initialize=function(){this._enforceVisibility(this.visibilityMode,this.visible);this.watch("visible",this._visibleWatcher.bind(this),!0)},b.prototype._writeLayers=function(a,b,c,e){var d=[];return a?(a.forEach(function(a){a.write&&
(a=a.write(null,e))&&a.layerType&&d.push(a)}),void(b.layers=d)):d},Object.defineProperty(b.prototype,"visibilityMode",{set:function(a){var b=this._get("visibilityMode")!==a;this._set("visibilityMode",a);b&&this._enforceVisibility(a,this.visible)},enumerable:!0,configurable:!0}),b.prototype.load=function(){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]})),this.when()},b.prototype.layerAdded=function(a,b){a.visible&&"exclusive"===
this.visibilityMode?this._turnOffOtherLayers(a):"inherited"===this.visibilityMode&&(a.visible=this.visible);this._visibilityHandles[a.uid]=a.watch("visible",this._visibilityWatcher,!0)},b.prototype.layerRemoved=function(a,b){(b=this._visibilityHandles[a.uid])&&(b.remove(),delete this._visibilityHandles[a.uid]);this._enforceVisibility(this.visibilityMode,this.visible)},b.prototype._turnOffOtherLayers=function(a){this.layers.forEach(function(b){b!==a&&(b.visible=!1)})},b.prototype._enforceVisibility=
function(a,b){if(e.getProperties(this).initialized){var c=this.layers,d=c.find(function(a){return a.visible});switch(a){case "exclusive":c.length&&!d&&(d=c.getItemAt(0),d.visible=!0);this._turnOffOtherLayers(d);break;case "inherited":c.forEach(function(a){a.visible=b})}}},b.prototype._visibleWatcher=function(a){"inherited"===this.visibilityMode&&this.layers.forEach(function(b){b.visible=a})},b.prototype._visibilityWatcher=function(a,b,c,e){switch(this.visibilityMode){case "exclusive":a?this._turnOffOtherLayers(e):
this._isAnyLayerVisible()||(e.visible=!0);break;case "inherited":e.visible=this.visible}},b.prototype._isAnyLayerVisible=function(){return this.layers.some(function(a){return a.visible})},d([c.shared({"2d":"../views/layers/GroupLayerView","3d":"../views/layers/GroupLayerView"})],b.prototype,"viewModulePaths",void 0),d([c.property()],b.prototype,"fullExtent",void 0),d([c.property({json:{read:!1,write:{ignoreOrigin:!0}}})],b.prototype,"layers",void 0),d([c.writer("layers")],b.prototype,"_writeLayers",
null),d([c.property()],b.prototype,"operationalLayerType",void 0),d([c.property({json:{write:!1}})],b.prototype,"portalItem",void 0),d([c.property()],b.prototype,"spatialReference",void 0),d([c.property({json:{read:!1},readOnly:!0,value:"group"})],b.prototype,"type",void 0),d([c.property({json:{read:!1,write:!1}})],b.prototype,"url",void 0),d([c.property({type:String,value:"independent",json:{write:!0}})],b.prototype,"visibilityMode",null),b=d([c.subclass("esri.layers.GroupLayer")],b)}(c.declared(b,
a,g,f,k))})},"esri/views/overlay/ViewOverlay":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/dom ../../core/Accessor ../../core/accessorSupport/decorators ../../core/Collection ../../widgets/libs/maquette/maquette".split(" "),function(m,l,h,d,b,g,k,f,a){return function(e){function c(){var b=null!==e&&e.apply(this,arguments)||this;return b.items=new f,b._callbacks=new Map,b._projector=a.createProjector(),b}return h(c,e),Object.defineProperty(c.prototype,
"needsRender",{get:function(){return 0<this.items.length},enumerable:!0,configurable:!0}),c.prototype.initialize=function(){var a=this,c=document.createElement("div");c.className="esri-overlay-surface";b.setSelectable(c,!1);this._set("surface",c);this._itemsChangeHandle=this.items.on("change",function(b){b.added.map(function(b){var c=function(){return b.render()};a._callbacks.set(b,c);a._projector.append(a.surface,c)});b.removed.map(function(b){var c=a._projector.detach(a._callbacks.get(b));a.surface.removeChild(c.domNode);
a._callbacks["delete"](b)})})},c.prototype.addItem=function(a){this.items.add(a)},c.prototype.removeItem=function(a){this.items.remove(a)},c.prototype.destroy=function(){this.items.removeAll();this._itemsChangeHandle.remove();this._projector=this._callbacks=null},c.prototype.render=function(){this._projector.renderNow()},d([k.property({type:HTMLDivElement})],c.prototype,"surface",void 0),d([k.property({type:f})],c.prototype,"items",void 0),d([k.property({readOnly:!0,dependsOn:["items.length"]})],
c.prototype,"needsRender",null),c=d([k.subclass("esri.views.overlay.ViewOverlay")],c)}(k.declared(g))})},"esri/views/ui/DefaultUI":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/watchUtils ./UI ./Component ../../widgets/Attribution ../../widgets/Compass ../../widgets/Zoom ../../widgets/NavigationToggle dojo/dom-geometry".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t){return function(k){function l(a){a=
k.call(this)||this;return a._defaultPositionLookup=null,a.components=[],a}return h(l,k),l.prototype.initialize=function(){this._handles.add([g.init(this,"components",this._componentsWatcher.bind(this)),g.init(this,"view",this._updateViewAwareWidgets.bind(this))])},l.prototype._findComponentPosition=function(a){if(!this._defaultPositionLookup){var b=t.isBodyLtr();this._defaultPositionLookup={attribution:"manual",compass:b?"top-left":"top-right","navigation-toggle":b?"top-left":"top-right",zoom:b?"top-left":
"top-right"}}return this._defaultPositionLookup[a]},l.prototype._removeComponents=function(a){var b=this;a.forEach(function(a){(a=b.find(a))&&(b.remove(a),a.destroy())})},l.prototype._updateViewAwareWidgets=function(a){var b=this;this.components.forEach(function(c){(c=(c=b.find(c))&&c.widget)&&void 0!==c.view&&c.set("view",a)})},l.prototype._componentsWatcher=function(a,b){this._removeComponents(b);this._addComponents(a)},l.prototype._addComponents=function(a){var b=this;this.initialized&&a.forEach(function(a){return b.add(b._createComponent(a),
b._findComponentPosition(a))})},l.prototype._createComponent=function(a){var b=this._createWidget(a);return b?new f({id:a,node:b}):void 0},l.prototype._createWidget=function(a){return"attribution"===a?this._createAttribution():"compass"===a?this._createCompass():"navigation-toggle"===a?this._createNavigationToggle():"zoom"===a?this._createZoom():void 0},l.prototype._createAttribution=function(){return new a({view:this.view})},l.prototype._createCompass=function(){return new e({view:this.view})},l.prototype._createNavigationToggle=
function(){return new q({view:this.view})},l.prototype._createZoom=function(){return new c({view:this.view})},d([b.property()],l.prototype,"components",void 0),l=d([b.subclass("esri.views.ui.DefaultUI")],l)}(b.declared(k))})},"esri/views/ui/UI":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Component ../../core/Accessor ../../core/Evented ../../core/HandleRegistry ../../core/watchUtils dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-style".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){function u(a){return"object"!=typeof a||a&&a.isInstanceOf&&a.isInstanceOf(g)||!("component"in a||"index"in a||"position"in a)?null:a}var v={left:0,top:0,bottom:0,right:0},x={bottom:30,top:15,right:15,left:15};return function(f){function k(){var b=f.call(this)||this;return b._cornerNameToContainerLookup={},b._positionNameToContainerLookup={},b._components=[],b._handles=new a,b.padding=x,b.view=null,b._initContainers(),b}return h(k,f),k.prototype.initialize=function(){this._handles.add([e.init(this,
"view.padding, container",this._applyViewPadding.bind(this)),e.init(this,"padding",this._applyUIPadding.bind(this))])},k.prototype.destroy=function(){this.container=null;this._components.forEach(function(a){a.destroy()});this._components.length=0;this._handles.destroy()},Object.defineProperty(k.prototype,"container",{set:function(a){var b=this._get("container");a!==b&&(a&&(q.add(a,"esri-ui"),this._attachContainers(a)),b&&(q.remove(b,"esri-ui"),r.set(b,{top:"",bottom:"",left:"",right:""}),t.empty(b)),
this._set("container",a))},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"height",{get:function(){var a=this.get("view.height")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.top+b.bottom),0)},enumerable:!0,configurable:!0}),k.prototype.castPadding=function(a){return"number"==typeof a?{bottom:a,top:a,right:a,left:a}:c.mixin({},x,a)},Object.defineProperty(k.prototype,"width",{get:function(){var a=this.get("view.width")||0;if(0===a)return a;var b=this._getViewPadding();
return Math.max(a-(b.left+b.right),0)},enumerable:!0,configurable:!0}),k.prototype.add=function(a,b){var c,e=this;if(Array.isArray(a))return void a.forEach(function(a){return e.add(a,b)});var d=u(a);d&&(c=d.index,b=d.position,a=d.component);b&&"object"==typeof b&&(c=b.index,b=b.position);!a||b&&!this._isValidPosition(b)||(!!a&&a.isInstanceOf&&a.isInstanceOf(g)||(a=new g({node:a})),this._place({component:a,position:b,index:c}),this._components.push(a))},k.prototype.remove=function(a){if(a){if(Array.isArray(a))return a.map(this.remove,
this);if(a=this.find(a)){var b=this._components.indexOf(a);return a.node.parentNode&&a.node.parentNode.removeChild(a.node),this._components.splice(b,1)[0]}}},k.prototype.empty=function(a){var b=this;return Array.isArray(a)?a.map(function(a){return b.empty(a)}).reduce(function(a,b){return a.concat(b)}):(a=a||"manual","manual"===a)?Array.prototype.slice.call(this._manualContainer.children).filter(function(a){return!q.contains(a,"esri-ui-corner")}).map(function(a){return b.remove(a)}):this._isValidPosition(a)?
Array.prototype.slice.call(this._cornerNameToContainerLookup[a].children).map(this.remove,this):void 0},k.prototype.move=function(a,b){var c=this;if(Array.isArray(a)&&a.forEach(function(a){return c.move(a,b)}),a){var e,d=u(a)||u(b);(d&&(e=d.index,b=d.position,a=d.component||a),!b||this._isValidPosition(b))&&(a=this.remove(a))&&this.add(a,{position:b,index:e})}},k.prototype.find=function(a){return a?a&&a.isInstanceOf&&a.isInstanceOf(g)?this._findByComponent(a):"string"==typeof a?this._findById(a):
this._findByNode(a.domNode||a):null},k.prototype._getViewPadding=function(){return this.get("view.padding")||v},k.prototype._attachContainers=function(a){t.place(this._manualContainer,a);t.place(this._innerContainer,a)},k.prototype._initContainers=function(){var a=t.create("div",{className:"esri-ui-inner-container esri-ui-corner-container"}),b=t.create("div",{className:"esri-ui-inner-container esri-ui-manual-container"}),e=t.create("div",{className:"esri-ui-top-left esri-ui-corner"},a),d=t.create("div",
{className:"esri-ui-top-right esri-ui-corner"},a),f=t.create("div",{className:"esri-ui-bottom-left esri-ui-corner"},a),g=t.create("div",{className:"esri-ui-bottom-right esri-ui-corner"},a);this._innerContainer=a;this._manualContainer=b;this._cornerNameToContainerLookup={"top-left":e,"top-right":d,"bottom-left":f,"bottom-right":g};this._positionNameToContainerLookup=c.mixin({manual:b},this._cornerNameToContainerLookup)},k.prototype._isValidPosition=function(a){return!!this._positionNameToContainerLookup[a]},
k.prototype._place=function(a){var b,c=a.component,e=a.index;a=this._positionNameToContainerLookup[a.position||"manual"];return-1<e?(b=Array.prototype.slice.call(a.children),0===e?void this._placeComponent(c,a,"first"):e>=b.length?void this._placeComponent(c,a,"last"):void this._placeComponent(c,b[e],"before")):void this._placeComponent(c,a,"last")},k.prototype._placeComponent=function(a,b,c){var e=a.widget;e&&!e._started&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&
"function"==typeof e.postCreate&&"function"==typeof e.startup&&a.widget.startup();t.place(a.node,b,c)},k.prototype._applyViewPadding=function(){var a=this.container;a&&r.set(a,this._toPxPosition(this._getViewPadding()))},k.prototype._applyUIPadding=function(){this._innerContainer&&r.set(this._innerContainer,this._toPxPosition(this.padding))},k.prototype._toPxPosition=function(a){return{top:this._toPxUnit(a.top),left:this._toPxUnit(a.left),right:this._toPxUnit(a.right),bottom:this._toPxUnit(a.bottom)}},
k.prototype._toPxUnit=function(a){return 0===a?0:a+"px"},k.prototype._findByComponent=function(a){var b,c=null;return this._components.some(function(e){return b=e===a,b&&(c=e),b}),c},k.prototype._findById=function(a){var b,c=null;return this._components.some(function(e){return b=e.id===a,b&&(c=e),b}),c},k.prototype._findByNode=function(a){var b,c=null;return this._components.some(function(e){return b=e.node===a,b&&(c=e),b}),c},d([b.property()],k.prototype,"container",null),d([b.property({dependsOn:["view.height"]})],
k.prototype,"height",null),d([b.property()],k.prototype,"padding",void 0),d([b.cast("padding")],k.prototype,"castPadding",null),d([b.property()],k.prototype,"view",void 0),d([b.property({dependsOn:["view.width"]})],k.prototype,"width",null),k=d([b.subclass("esri.views.ui.UI")],k)}(b.declared(k,f))})},"esri/views/ui/Component":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor dojo/dom dojo/dom-class".split(" "),
function(m,l,h,d,b,g,k,f){return function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;return b.widget=null,b}return h(e,a),e.prototype.destroy=function(){this.widget&&this.widget.destroy();this.node=null},Object.defineProperty(e.prototype,"id",{get:function(){return this._get("id")||this.get("node.id")},set:function(a){this._set("id",a)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"node",{set:function(a){var b=this._get("node");a!==b&&(a&&f.add(a,"esri-component"),
b&&f.remove(b,"esri-component"),this._set("node",a))},enumerable:!0,configurable:!0}),e.prototype.castNode=function(a){return a?"string"==typeof a||a&&"nodeType"in a?(this._set("widget",null),k.byId(a)):(a&&"function"==typeof a.render&&!a.domNode&&(a.domNode=document.createElement("div")),this._set("widget",a),a.domNode):(this._set("widget",null),null)},d([b.property()],e.prototype,"id",null),d([b.property()],e.prototype,"node",null),d([b.cast("node")],e.prototype,"castNode",null),d([b.property({readOnly:!0})],
e.prototype,"widget",void 0),e=d([b.subclass("esri.views.ui.Component")],e)}(b.declared(g))})},"esri/widgets/Attribution":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./Attribution/AttributionViewModel ../core/watchUtils".split(" "),function(m,l,h,d,b,g,k,f,a){return function(e){function c(a){a=e.call(this)||this;return a._isOpen=!1,a._attributionTextOverflowed=!1,a._prevSourceNodeHeight=
0,a.itemDelimiter=" | ",a.view=null,a.viewModel=new f,a}return h(c,e),c.prototype.postInitialize=function(){var b=this;this.own(a.on(this,"viewModel.items","change",function(){return b.scheduleRender()}))},Object.defineProperty(c.prototype,"attributionText",{get:function(){return this.viewModel.items.map(function(a){return a.text}).join(this.itemDelimiter)},enumerable:!0,configurable:!0}),c.prototype.render=function(){var a=(b={},b["esri-attribution--open"]=this._isOpen,b);return g.tsx("div",{bind:this,
"class":"esri-attribution esri-widget",classes:a,onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),g.tsx("div",{"class":"esri-attribution__powered-by"},"Powered by ",g.tsx("a",{target:"_blank",href:"http://www.esri.com/","class":"esri-attribution__link"},"Esri")));var b},c.prototype._renderSourcesNode=function(){var a=this._isOpen,b=this._isInteractive(),c=this.attributionText,a=(e={},e["esri-attribution__sources--open"]=a,e["esri-interactive"]=b,e);return g.tsx("div",
{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,"class":"esri-attribution__sources",classes:a,innerHTML:c,role:b?"button":void 0,tabIndex:b?0:-1});var e},c.prototype._afterSourcesNodeCreate=function(a){this._prevSourceNodeHeight=a.clientWidth},c.prototype._afterSourcesNodeUpdate=function(a){var b=!1,c=a.clientHeight;a=a.scrollWidth>=a.clientWidth;var e=this._attributionTextOverflowed!==a;if(this._attributionTextOverflowed=a,e&&(b=!0),this._isOpen)a=c<this._prevSourceNodeHeight,
this._prevSourceNodeHeight=c,a&&(this._isOpen=!1,b=!0);b&&this.scheduleRender()},c.prototype._toggleState=function(){this._isInteractive()&&(this._isOpen=!this._isOpen)},c.prototype._isInteractive=function(){return this._isOpen||this._attributionTextOverflowed},d([b.property({dependsOn:["viewModel.items.length","itemDelimiter"],readOnly:!0}),g.renderable()],c.prototype,"attributionText",null),d([b.property(),g.renderable()],c.prototype,"itemDelimiter",void 0),d([b.aliasOf("viewModel.view")],c.prototype,
"view",void 0),d([b.property({type:f}),g.renderable(["state","view.size"])],c.prototype,"viewModel",void 0),d([g.accessibleHandler()],c.prototype,"_toggleState",null),c=d([b.subclass("esri.widgets.Attribution")],c)}(b.declared(k))})},"esri/widgets/Attribution/AttributionViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../geometry/support/webMercatorUtils ../../core/HandleRegistry ../../core/Accessor ../../core/lang ../../core/watchUtils ../../core/Collection ../../geometry/Extent".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){return function(f){function l(a){a=f.call(this,a)||this;return a._handles=new k,a._pendingAttributionItemsByLayerId={},a._attributionDataByLayerId={},a.items=new c,a.view=null,a._updateAttributionItems=a._updateAttributionItems.bind(a),a}return h(l,f),l.prototype.initialize=function(){this._handles.add(e.init(this,"view",this._viewWatcher))},l.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null},Object.defineProperty(l.prototype,"state",
{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0}),l.prototype._viewWatcher=function(a){var b=this,c=this._handles;c&&c.remove();a&&(c.add([a.allLayerViews.on("change",function(a){b._addLayerViews(a.added);0<a.removed.length&&(a.removed.forEach(function(a){c.remove(a.uid)}),b._updateAttributionItems())}),e.init(a,"stationary",this._updateAttributionItems)]),this._addLayerViews(a.allLayerViews))},l.prototype._addLayerViews=function(a){var b=this;a.forEach(function(a){b._handles.has(a.uid)||
b._handles.add(e.init(a,"suspended",b._updateAttributionItems),a.uid)})},l.prototype._updateAttributionItems=function(){var a=this,b=[];this._getActiveLayerViews().forEach(function(c){var e=c.layer;if(!e.hasAttributionData){var d=e.get("copyright");if(!d)return;c=a._findItem(b,d);return void(c?a._updateItemSource(c,e):b.push({text:d,layers:[e]}))}if(e&&e.tileInfo){var f=a._attributionDataByLayerId;if(f[e.uid]){d=a._getDynamicAttribution(f[e.uid],a.view,e);if(!d)return;c=a._findItem(b,d);return void(c?
a._updateItemSource(c,e):b.push({text:d,layers:[e]}))}var g=a._pendingAttributionItemsByLayerId;a._inProgress(g[e.uid])||(g[e.uid]=e.fetchAttributionData().then(function(b){b=a._createContributionIndex(b,a._isBingLayer(e));delete g[e.uid];f[e.uid]=b;a._updateAttributionItems()}))}});this._itemsChanged(this.items,b)&&(this.items.removeAll(),this.items.addMany(b))},l.prototype._itemsChanged=function(a,b){return a.length!==b.length||a.some(function(a,c){return a.text!==b[c].text})},l.prototype._inProgress=
function(a){return a&&!a.isFulfilled()},l.prototype._getActiveLayerViews=function(){return this.get("view.allLayerViews").filter(function(a){return!a.suspended&&a.get("layer.attributionVisible")})},l.prototype._findItem=function(a,b){var c;return a.some(function(a){var e=a.text===b;return e&&(c=a),e}),c},l.prototype._updateItemSource=function(a,b){-1===a.layers.indexOf(b)&&a.layers.push(b)},l.prototype._isBingLayer=function(a){return-1!==a.declaredClass.toLowerCase().indexOf("vetiledlayer")},l.prototype._createContributionIndex=
function(b,c){b=b.contributors;var e={};return b?(b.forEach(function(b,d){var f=b.coverageAreas;f&&f.forEach(function(f){var k=f.bbox,h=f.zoomMin-(c&&f.zoomMin?1:0),n=f.zoomMax-(c&&f.zoomMax?1:0);b={extent:g.geographicToWebMercator(new q({xmin:k[1],ymin:k[0],xmax:k[3],ymax:k[2]})),attribution:b.attribution||"",score:a.isDefined(f.score)?f.score:100,id:d};for(f=h;n>=f;f++)e[f]=e[f]||[],e[f].push(b)})}),e.maxKey=Math.max.apply(null,Object.keys(e)),e):e},l.prototype._getDynamicAttribution=function(b,
c,e){var d=c.extent;c=e.tileInfo.scaleToZoom(c.scale);if(c=Math.min(b.maxKey,Math.round(c)),!d||!a.isDefined(c)||-1>=c)return"";b=b[c];var f=d.center.clone().normalize(),g={};return b.filter(function(a){var b=!g[a.id]&&a.extent.contains(f);return b&&(g[a.id]=!0),b}).sort(function(a,b){return b.score-a.score||a.objectId-b.objectId}).map(function(a){return a.attribution}).join(", ")},d([b.property({readOnly:!0,type:c})],l.prototype,"items",void 0),d([b.property({dependsOn:["view.ready"],readOnly:!0})],
l.prototype,"state",null),d([b.property()],l.prototype,"view",void 0),l=d([b.subclass("esri.widgets.Attribution.AttributionViewModel")],l)}(b.declared(f))})},"esri/widgets/Compass":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./Compass/CompassViewModel dojo/i18n!./Compass/nls/Compass".split(" "),function(m,l,h,d,b,g,k,f,a){return function(e){function c(a){a=e.call(this)||this;
return a.activeMode=null,a.modes=null,a.view=null,a.viewModel=new f,a}return h(c,e),c.prototype.reset=function(){},c.prototype.render=function(){var b=this.viewModel.orientation,c=this.viewModel.state,e="disabled"===c,d="compass"===("rotation"===c?"rotation":"compass"),c=(f={},f["esri-disabled"]=e,f["esri-compass--active"]="device-orientation"===this.viewModel.activeMode,f["esri-interactive"]=!e,f),f=(k={},k["esri-icon-compass"]=d,k["esri-icon-dial"]=!d,k);return g.tsx("div",{bind:this,"class":"esri-compass esri-widget-button esri-widget",
classes:c,onclick:this._start,onkeydown:this._start,role:"button",tabIndex:e?-1:0,"aria-label":a.reset,title:a.reset},g.tsx("span",{"aria-hidden":"true","class":"esri-compass__icon",classes:f,styles:this._toRotationTransform(b)}),g.tsx("span",{"class":"esri-icon-font-fallback-text"},a.reset));var f,k},c.prototype._start=function(){var a=this.viewModel;a.nextMode();a.startMode()},c.prototype._toRotationTransform=function(a){return{transform:"rotateZ("+a.z+"deg)"}},d([b.aliasOf("viewModel.activeMode")],
c.prototype,"activeMode",void 0),d([b.aliasOf("viewModel.modes")],c.prototype,"modes",void 0),d([b.aliasOf("viewModel.view")],c.prototype,"view",void 0),d([b.property({type:f}),g.renderable(["viewModel.orientation","viewModel.state"])],c.prototype,"viewModel",void 0),d([b.aliasOf("viewModel.reset")],c.prototype,"reset",null),d([g.accessibleHandler()],c.prototype,"_start",null),c=d([b.subclass("esri.widgets.Compass")],c)}(b.declared(k))})},"esri/widgets/Compass/CompassViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/HandleRegistry ../../core/Logger ../../core/promiseUtils ../../core/watchUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e){var c=f.getLogger("esri.widgets.CompassViewModel");return function(f){function g(a){a=f.call(this,a)||this;return a._handles=new k,a.canUseHeading=!1,a.orientation={x:0,y:0,z:0},a.view=null,a._updateForCamera=a._updateForCamera.bind(a),a._updateForRotation=a._updateForRotation.bind(a),a._updateRotationWatcher=a._updateRotationWatcher.bind(a),a._updateViewHeading=a._updateViewHeading.bind(a),a._checkHeadingSupport=a._checkHeadingSupport.bind(a),a._canUseHeading(),a}return h(g,
f),g.prototype.initialize=function(){this._handles.add(e.init(this,"view",this._updateRotationWatcher))},g.prototype.destroy=function(){this._removeCheckHeadingListener();this._removeOrientationListener();this._handles.destroy();this.view=this._handles=null},Object.defineProperty(g.prototype,"activeMode",{get:function(){var a=this._get("activeMode");return a?a:(a=this.modes)?a[0]:"none"},set:function(a){this.stopMode();this._set("activeMode",a);void 0===a&&this._clearOverride("activeMode")},enumerable:!0,
configurable:!0}),Object.defineProperty(g.prototype,"canShowNorth",{get:function(){var a=this.get("view.spatialReference");return a&&(a.isWebMercator||a.isWGS84)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"modes",{get:function(){return this._get("modes")||["reset"]},set:function(a){this._set("modes",a);void 0===a&&this._clearOverride("modes")},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"state",{get:function(){return this.get("view.ready")?this.canShowNorth?
"compass":"rotation":"disabled"},enumerable:!0,configurable:!0}),g.prototype.previousMode=function(){var a=this.activeMode,b=this.modes;2>b.length||(a=b.indexOf(a),this._paginateMode(a-1))},g.prototype.nextMode=function(){var a=this.activeMode,b=this.modes;2>b.length||(a=b.indexOf(a),this._paginateMode(a+1))},g.prototype.startMode=function(){var a=this.activeMode;"reset"===a&&this.reset();"device-orientation"===a&&(this._removeOrientationListener(),this._addOrientationListener())},g.prototype.stopMode=
function(){"device-orientation"===this.activeMode&&this._removeOrientationListener()},g.prototype.reset=function(){if(this.get("view.ready")){var a={};"2d"===this.view.type?a.rotation=0:a.heading=0;this.view.goTo(a)}},g.prototype._supportsDeviceOrientation=function(){return"DeviceOrientationEvent"in window},g.prototype._paginateMode=function(a){var b=this.modes;this.activeMode=b[(a+b.length)%b.length]},g.prototype._getHeading=function(a){return a.webkitCompassHeading},g.prototype._removeCheckHeadingListener=
function(){this._supportsDeviceOrientation()&&window.removeEventListener("deviceorientation",this._checkHeadingSupport)},g.prototype._checkHeadingSupport=function(a){"number"==typeof this._getHeading(a)&&this._set("canUseHeading",!0);this._removeCheckHeadingListener()},g.prototype._canUseHeading=function(){var b=this;this._supportsDeviceOrientation()&&(window.addEventListener("deviceorientation",this._checkHeadingSupport),a.after(500).then(function(){b._removeCheckHeadingListener()}))},g.prototype._updateViewHeading=
function(a){var b=this.view;a=this._getHeading(a);"number"!=typeof a||0>a||360<a||!b||("3d"===b.type&&b.goTo({heading:a}),"2d"===b.type&&(b.rotation=a))},g.prototype._removeOrientationListener=function(){this.canUseHeading&&window.removeEventListener("deviceorientation",this._updateViewHeading)},g.prototype._addOrientationListener=function(){var a=this.canShowNorth;return this.canUseHeading?a?void window.addEventListener("deviceorientation",this._updateViewHeading):void c.warn("device-orientation mode requires 'canShowNorth' to be true"):
void c.warn("The deviceorientation event is not supported in this browser")},g.prototype._updateForRotation=function(a){void 0!==a&&null!==a&&(this.orientation={z:a})},g.prototype._updateForCamera=function(a){a&&(this.orientation={x:0,y:0,z:-a.heading})},g.prototype._updateRotationWatcher=function(a){this._handles.removeAll();a&&("2d"===a.type?this._handles.add(e.init(this,"view.rotation",this._updateForRotation)):this._handles.add(e.init(this,"view.camera",this._updateForCamera)))},d([b.property({dependsOn:["modes"]})],
g.prototype,"activeMode",null),d([b.property({dependsOn:["view.spatialReference.isWebMercator","view.spatialReference.wkid"],readOnly:!0})],g.prototype,"canShowNorth",null),d([b.property({readOnly:!0})],g.prototype,"canUseHeading",void 0),d([b.property({dependsOn:["canUseHeading"]})],g.prototype,"modes",null),d([b.property()],g.prototype,"orientation",void 0),d([b.property({dependsOn:["view.ready","canShowNorth"],readOnly:!0})],g.prototype,"state",null),d([b.property()],g.prototype,"view",void 0),
d([b.property()],g.prototype,"previousMode",null),d([b.property()],g.prototype,"nextMode",null),d([b.property()],g.prototype,"startMode",null),d([b.property()],g.prototype,"stopMode",null),d([b.property()],g.prototype,"reset",null),g=d([b.subclass("esri.widgets.CompassViewModel")],g)}(b.declared(g))})},"esri/widgets/Compass/nls/Compass":function(){define({root:{reset:"Reset compass orientation"},ar:1,bs:1,cs:1,da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lv:1,lt:1,nl:1,nb:1,
pl:1,"pt-br":1,"pt-pt":1,ro:1,ru:1,sl:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"esri/widgets/Zoom":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./Zoom/IconButton ./Zoom/ZoomViewModel dojo/i18n!./Zoom/nls/Zoom".split(" "),function(m,l,h,d,b,g,k,f,a,e){return function(c){function k(b){b=c.call(this)||this;return b.view=null,b.viewModel=new a,b}return h(k,c),k.prototype.postInitialize=
function(){this._zoomInButton=new f({action:this.zoomIn,iconClass:"esri-icon-plus",title:e.zoomIn});this._zoomOutButton=new f({action:this.zoomOut,iconClass:"esri-icon-minus",title:e.zoomOut})},Object.defineProperty(k.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0}),k.prototype.render=function(){var a=this.viewModel,b=(c={},c["esri-zoom--horizontal"]="horizontal"===this.layout,c);return this._zoomInButton.enabled="ready"===
a.state&&a.canZoomIn,this._zoomOutButton.enabled="ready"===a.state&&a.canZoomOut,g.tsx("div",{"class":"esri-zoom esri-widget",classes:b},this._zoomInButton.render(),this._zoomOutButton.render());var c},k.prototype.zoomIn=function(){},k.prototype.zoomOut=function(){},d([b.property({value:"vertical"}),g.renderable()],k.prototype,"layout",null),d([b.aliasOf("viewModel.view"),g.renderable()],k.prototype,"view",void 0),d([b.property({type:a}),g.renderable(["viewModel.canZoomIn","viewModel.canZoomOut",
"viewModel.state"])],k.prototype,"viewModel",void 0),d([b.aliasOf("viewModel.zoomIn")],k.prototype,"zoomIn",null),d([b.aliasOf("viewModel.zoomOut")],k.prototype,"zoomOut",null),k=d([b.subclass("esri.widgets.Zoom")],k)}(b.declared(k))})},"esri/widgets/Zoom/IconButton":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../support/widget ../Widget".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(){var a=
null!==f&&f.apply(this,arguments)||this;return a.enabled=!0,a.iconClass="",a.title="",a}return h(a,f),a.prototype.render=function(){var a=this.enabled?0:-1,b=(d={},d["esri-disabled"]=!this.enabled,d["esri-interactive"]=this.enabled,d),d=(f={},f[this.iconClass]=!!this.iconClass,f);return g.tsx("div",{bind:this,"class":"esri-widget-button esri-widget",classes:b,onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:a,title:this.title},g.tsx("span",{"aria-hidden":"true",role:"presentation",
"class":"esri-icon",classes:d}),g.tsx("span",{"class":"esri-icon-font-fallback-text"},this.title));var d,f},a.prototype._triggerAction=function(){this.action.call(this)},d([b.property()],a.prototype,"action",void 0),d([b.property(),g.renderable()],a.prototype,"enabled",void 0),d([b.property(),g.renderable()],a.prototype,"iconClass",void 0),d([b.property(),g.renderable()],a.prototype,"title",void 0),d([g.accessibleHandler()],a.prototype,"_triggerAction",null),a=d([b.subclass("esri.widgets.IconButton")],
a)}(b.declared(k))})},"esri/widgets/Zoom/ZoomViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./ZoomConditions3D ./ZoomConditions2D ../../core/Accessor".split(" "),function(m,l,h,d,b,g,k,f){return function(a){function e(b){b=a.call(this,b)||this;return b.canZoomIn=null,b.canZoomOut=null,b.zoomIn=b.zoomIn.bind(b),b.zoomOut=b.zoomOut.bind(b),b}return h(e,a),e.prototype.destroy=function(){this.view=
null},Object.defineProperty(e.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"view",{set:function(a){a?"2d"===a.type?this._zoomConditions=new k({view:a}):"3d"===a.type&&(this._zoomConditions=new g):this._zoomConditions=null;this._set("view",a)},enumerable:!0,configurable:!0}),e.prototype.zoomIn=function(){this.canZoomIn&&this._zoomToFactor(.5)},e.prototype.zoomOut=function(){this.canZoomOut&&this._zoomToFactor(2)},
e.prototype._zoomToFactor=function(a){if("ready"===this.state){var b=this.view;"3d"===this.view.type?b.goTo({zoomFactor:1/a}):b.goTo({scale:this.get("view.scale")*a})}},d([b.property()],e.prototype,"_zoomConditions",void 0),d([b.property({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],e.prototype,"canZoomIn",void 0),d([b.property({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],e.prototype,"canZoomOut",void 0),d([b.property({dependsOn:["view.ready"],readOnly:!0})],e.prototype,"state",null),
d([b.property()],e.prototype,"view",null),d([b.property()],e.prototype,"zoomIn",null),d([b.property()],e.prototype,"zoomOut",null),e=d([b.subclass("esri.widgets.Zoom.ZoomViewModel")],e)}(b.declared(f))})},"esri/widgets/Zoom/ZoomConditions3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor".split(" "),function(m,l,h,d,b,g){return function(g){function f(){var a=null!==g&&g.apply(this,
arguments)||this;return a.canZoomIn=!0,a.canZoomOut=!0,a}return h(f,g),d([b.property({readOnly:!0})],f.prototype,"canZoomIn",void 0),d([b.property({readOnly:!0})],f.prototype,"canZoomOut",void 0),f=d([b.subclass("esri.widgets.Zoom.ZoomConditions3D")],f)}(b.declared(g))})},"esri/widgets/Zoom/ZoomConditions2D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor".split(" "),function(m,
l,h,d,b,g){return function(g){function f(){return null!==g&&g.apply(this,arguments)||this}return h(f,g),Object.defineProperty(f.prototype,"canZoomIn",{get:function(){var a=this.get("view.scale"),b=this.get("view.constraints.effectiveMaxScale");return 0===b||a>b},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"canZoomOut",{get:function(){var a=this.get("view.scale"),b=this.get("view.constraints.effectiveMinScale");return 0===b||b>a},enumerable:!0,configurable:!0}),d([b.property({dependsOn:["view.ready",
"view.scale"],readOnly:!0})],f.prototype,"canZoomIn",null),d([b.property({dependsOn:["view.ready","view.scale"],readOnly:!0})],f.prototype,"canZoomOut",null),d([b.property()],f.prototype,"view",void 0),f=d([b.subclass("esri.widgets.Zoom.ZoomConditions2D")],f)}(b.declared(g))})},"esri/widgets/Zoom/nls/Zoom":function(){define({root:{zoomIn:"Zoom In",zoomOut:"Zoom Out"},ar:1,bs:1,cs:1,da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lv:1,lt:1,nl:1,nb:1,pl:1,"pt-br":1,"pt-pt":1,ro:1,
ru:1,sl:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"esri/widgets/NavigationToggle":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./NavigationToggle/NavigationToggleViewModel dojo/i18n!./NavigationToggle/nls/NavigationToggle".split(" "),function(m,l,h,d,b,g,k,f,a){return function(e){function c(a){a=e.call(this)||this;return a.view=null,a.viewModel=new f,a}return h(c,
e),Object.defineProperty(c.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0}),c.prototype.toggle=function(){},c.prototype.render=function(){var b="disabled"===this.get("viewModel.state"),c="pan"===this.get("viewModel.navigationMode"),e=(d={},d["esri-disabled"]=b,d["esri-navigation-toggle--horizontal"]="horizontal"===this.layout,d),d=(f={},f["esri-navigation-toggle__button--active"]=c,f),c=(k={},k["esri-navigation-toggle__button--active"]=
!c,k);return g.tsx("div",{bind:this,"class":"esri-navigation-toggle esri-widget",classes:e,onclick:this._toggle,onkeydown:this._toggle,tabIndex:b?-1:0,"aria-label":a.toggle,title:a.toggle},g.tsx("div",{"class":g.join("esri-navigation-toggle__button esri-widget-button","esri-navigation-toggle__button--pan"),classes:d},g.tsx("span",{"class":"esri-icon-pan"})),g.tsx("div",{"class":g.join("esri-navigation-toggle__button esri-widget-button","esri-navigation-toggle__button--rotate"),classes:c},g.tsx("span",
{"class":"esri-icon-rotate"})));var d,f,k},c.prototype._toggle=function(){this.toggle()},d([b.property({value:"vertical"}),g.renderable()],c.prototype,"layout",null),d([b.aliasOf("viewModel.view"),g.renderable()],c.prototype,"view",void 0),d([b.property({type:f}),g.renderable(["viewModel.state","viewModel.navigationMode"])],c.prototype,"viewModel",void 0),d([b.aliasOf("viewModel.toggle")],c.prototype,"toggle",null),d([g.accessibleHandler()],c.prototype,"_toggle",null),c=d([b.subclass("esri.widgets.NavigationToggle")],
c)}(b.declared(k))})},"esri/widgets/NavigationToggle/NavigationToggleViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/watchUtils ../../core/Accessor ../../core/HandleRegistry".split(" "),function(m,l,h,d,b,g,k,f){return function(a){function e(b){b=a.call(this,b)||this;return b._handles=new f,b.navigationMode="pan",b.view=null,b.toggle=b.toggle.bind(b),b}return h(e,a),e.prototype.initialize=
function(){this._handles.add(g.when(this,"view.inputManager",this._setNavigationMode.bind(this)))},e.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null},Object.defineProperty(e.prototype,"state",{get:function(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"},enumerable:!0,configurable:!0}),e.prototype.toggle=function(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())},e.prototype._setNavigationMode=
function(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate"},d([b.property({dependsOn:["view.ready"],readOnly:!0})],e.prototype,"state",null),d([b.property()],e.prototype,"navigationMode",void 0),d([b.property()],e.prototype,"view",void 0),d([b.property()],e.prototype,"toggle",null),e=d([b.subclass("esri.widgets.NavigationToggleViewModel")],e)}(b.declared(k))})},"esri/widgets/NavigationToggle/nls/NavigationToggle":function(){define({root:{toggle:"Toggle to pan or rotate in 3D"},
ar:1,bs:1,cs:1,da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lv:1,lt:1,nl:1,nb:1,pl:1,"pt-br":1,"pt-pt":1,ro:1,ru:1,sl:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"esri/views/ui/2d/DefaultUI2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI dojo/_base/lang".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(){return f.call(this)||
this}return h(a,f),a.prototype.getDefaults=function(){return k.mixin(this.inherited(arguments),{components:["attribution","zoom"]})},a=d([b.subclass("esri.views.ui.2d.DefaultUI2D")],a)}(b.declared(g))})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/promiseUtils ../../../core/Scheduler ../FrameBudget ./DOMContainer ./StageGL ./Container".split(" "),function(m,l,h,d,b,g,k,f,a){function e(b){if(b instanceof f)return b;if(b instanceof
a){var c=0;for(b=b.children;c<b.length;c++){var d=e(b[c]);if(d)return d}}return null}return function(a){function c(c){var e=a.call(this)||this;return e.element=c,e._budget=new g,e._renderParameters={budget:e._budget,state:e.state,devicePixelRatio:window.devicePixelRatio,stationary:!1},e._renderRequested=!1,e._taskHandle=b.addFrameTask({render:function(){return e.renderFrame()}}),e._stationary=!0,e.attached=!0,e._taskHandle.pause(),e}return h(c,a),c.prototype.destroy=function(){this.removeAllChildren();
this.renderFrame();this._taskHandle.remove();this._taskHandle=null},Object.defineProperty(c.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a;this.requestRender()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"stationary",{get:function(){return this._stationary},set:function(a){this._stationary!==a&&(this._stationary=a,this.requestRender())},enumerable:!0,configurable:!0}),c.prototype.start=function(){this._taskHandle.resume()},c.prototype.stop=
function(){this._taskHandle.isPaused()||this._taskHandle.pause()},c.prototype.requestRender=function(){this._renderRequested=!0;this._taskHandle&&this._taskHandle.isPaused()&&this._taskHandle.resume()},c.prototype.takeScreenshot=function(a){var b=e(this);return b?b.takeScreenshot(a):d.reject("Could not find an object capable of capturing screenshot!")},c.prototype.renderFrame=function(){this._renderRequested&&(this._renderRequested=!1,this._renderParameters.state=this._state,this._renderParameters.stationary=
this.stationary,this._renderParameters.devicePixelRatio=window.devicePixelRatio,this.processRender(this._renderParameters));this._renderRequested||this._taskHandle.pause()},c}(k)})},"esri/views/2d/engine/DOMContainer":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./Container"],function(m,l,h,d){return function(b){function d(){return null!==b&&b.apply(this,arguments)||this}return h(d,b),d.prototype.createElement=function(){var b=document.createElement("div");return b.setAttribute("class",
"esri-display-object"),b},d.prototype.setElement=function(b){this.element=b},d.prototype.doRender=function(d){var f=this.element.style;return this.visible?(f.display="block",d.opacity=this.opacity,b.prototype.doRender.call(this,d),void 0):void(f.display="none")},d.prototype.prepareChildrenRenderParameters=function(b){return b},d.prototype.attachChild=function(b,d){var a=b.element;return a||(a=b.createElement(),b.setElement(a)),b.attach(d)},d.prototype.detachChild=function(b,d){b.detach(d);this.element.contains(b.element)&&
this.element.removeChild(b.element);b.setElement(null)},d.prototype.renderChildren=function(d){for(var f=this.children,a=this.element.childNodes,e=0,c=f.length,g=0;c>g;g++)if(f[g].attached){var k=f[g].element;a[e]!==k&&(null!=a[e+1]?this.element.insertBefore(k,a[e]):this.element.appendChild(k));e+=1}b.prototype.renderChildren.call(this,d)},d}(d)})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(m,l,h,d){var b;
!function(b){b[b.BEFORE=0]="BEFORE";b[b.ATTACHING=1]="ATTACHING";b[b.DETACHING=2]="DETACHING";b[b.RENDERING=3]="RENDERING";b[b.AFTER=4]="AFTER";b[b.DONE=5]="DONE"}(b||(b={}));return function(d){function g(){var f=null!==d&&d.apply(this,arguments)||this;return f._childrenSet=new Set,f._childrenToAttach=[],f._childrenToDetach=[],f._renderPhase=b.DONE,f.children=[],f}return h(g,d),Object.defineProperty(g.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),
g.prototype.detach=function(b){var a=this.children;b=this.prepareChildrenRenderParameters(b);for(var e=a.length,c=0;e>c;c++){var d=a[c];d.attached&&(this.detachChild(d,b),d.attached=!1,d.parent=null)}},g.prototype.doRender=function(d){var a=this.prepareChildrenRenderParameters(d);this._renderPhase=b.BEFORE;this.beforeRenderChildren(d,a);this._renderPhase=b.ATTACHING;this.attachChildren(a)||this.requestRender();this._renderPhase=b.DETACHING;for(var e=this._childrenToDetach;0<e.length;){var c=e.shift();
this.detachChild(c,a);c.attached=!1;c.parent=null}this._renderPhase=b.RENDERING;this.renderChildren(a);this._renderPhase=b.AFTER;this.afterRenderChildren(d,a);this._renderPhase=b.DONE},g.prototype.addChild=function(b){return this.addChildAt(b,this.children.length)},g.prototype.addChildAt=function(d,a){if((void 0===a&&(a=this.numChildren),!d)||this.contains(d))return d;var e=d.parent;e&&e!==this&&e.removeChild(d);a>=this.numChildren?this.children.push(d):this.children.splice(a,0,d);this._childrenSet.add(d);
a=this._childrenToDetach.indexOf(d);return-1<a&&this._childrenToDetach.splice(a,1),this._childrenToAttach.push(d),this._renderPhase>=b.RENDERING&&this.requestRender(),d},g.prototype.contains=function(b){return this._childrenSet.has(b)},g.prototype.getChildIndex=function(b){return this.children.indexOf(b)},g.prototype.getChildAt=function(b){return 0>b||b>this.children.length?null:this.children[b]},g.prototype.removeAllChildren=function(){for(var b=this.numChildren;b--;)this.removeChildAt(0)},g.prototype.removeChild=
function(b){return this.contains(b)?this.removeChildAt(this.getChildIndex(b)):b},g.prototype.removeChildAt=function(d){if(0>d||d>=this.children.length)return null;d=this.children.splice(d,1)[0];this._childrenSet["delete"](d);if(d.attached)this._childrenToDetach.push(d),this._renderPhase>=b.RENDERING&&this.requestRender();else{var a=this._childrenToAttach.indexOf(d);-1<a&&this._childrenToAttach.splice(a,1)}return d},g.prototype.requestChildRender=function(d){d&&d.parent===this&&this._renderPhase>=
b.RENDERING&&this.requestRender()},g.prototype.setChildIndex=function(d,a){var e=this.getChildIndex(d);-1<e&&(this.children.splice(e,1),this.children.splice(a,0,d),this._renderPhase>=b.RENDERING&&this.requestRender())},g.prototype.sortChildren=function(d){return this._renderPhase>b.RENDERING&&this.requestRender(),this.children.sort(d)},g.prototype.attachChildren=function(b){var a=this._childrenToAttach;if(0===a.length)return!0;for(var e=0===a.length;!e;)e=a.shift(),this.attachChild(e,b)&&(e.attached=
!0,e.parent=this),e=0===a.length;return 0===a.length},g.prototype.renderChildren=function(b){for(var a=this.children,e=a.length,c=0;e>c;c++){var d=a[c];d.attached&&this.renderChild(d,b)}},g.prototype.beforeRenderChildren=function(b,a){},g.prototype.attachChild=function(b,a){return b.attach(a)},g.prototype.detachChild=function(b,a){b.detach(a)},g.prototype.renderChild=function(b,a){b.processRender(a)},g.prototype.afterRenderChildren=function(b,a){},g}(d)})},"esri/views/2d/engine/StageGL":function(){define("require exports ../../../core/tsSupport/extendsHelper ../libs/gl-matrix/common ../libs/gl-matrix/vec2 ../libs/gl-matrix/mat2d ./webgl/BitBlitRenderer ../../support/screenshotUtils ../../../core/promiseUtils ../../webgl/RenderingContext ../../webgl/FramebufferObject ../../webgl/webgl-utils ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ./webgl/painter/WGLPainter ./Container ./webgl/shaders/glShaderSnippets".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y){function n(a){return{budget:a.budget,state:a.state,devicePixelRatio:a.devicePixelRatio,stationary:a.stationary}}var w={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"};return function(l){function x(){var a=null!==l&&l.apply(this,arguments)||this;return a._clipData=new Float32Array(8),a._upperLeft=b.create(),a._upperRight=b.create(),a._lowerLeft=b.create(),a._lowerRight=b.create(),a._mat2=g.create(),a._clipRendererInitialized=!1,a}return h(x,l),Object.defineProperty(x.prototype,
"glPainter",{get:function(){return this._painter},enumerable:!0,configurable:!0}),x.prototype.createElement=function(){var a=document.createElement("canvas");return a.setAttribute("class","esri-display-object"),a},x.prototype.setElement=function(a){this.element=a},x.prototype.attach=function(a){if(this.attached)return!0;this._resizeCanvas(a);var b=q.setupWebGL(this.element,{alpha:!0,antialias:!1,depth:!0,stencil:!0});return this._renderingContext=new e(b[0]),this.attached=!0,this._cachedRenderParams=
n(a),this._painter||(this._painter=new v,this._painter.initialize(this._renderingContext)),l.prototype.attach.call(this,a)},x.prototype.detach=function(a){l.prototype.detach.call(this,a);this._renderingContext&&(this._renderingContext.dispose(),this._renderingContext=null);this._cachedRenderParams=null},x.prototype.beforeRenderChildren=function(a,e){var f=a.state,k=this._painter;if(k){e=this._renderingContext;e.enforceState();k.update(f,a.devicePixelRatio);if(!(f.spatialReference&&(f.spatialReference._isWrappable?
f.spatialReference._isWrappable():f.spatialReference.isWrappable)))return void(this._clipFrame=!1);var h=f.width,k=f.height,n=f.rotation,h=Math.round(h*a.devicePixelRatio),k=Math.round(k*a.devicePixelRatio),q=d.toRadian(n),l=Math.abs(Math.cos(q)),r=Math.abs(Math.sin(q)),t=Math.round(f.worldScreenWidth);if(t>=Math.round(h*l+k*r))return void(this._clipFrame=!1);this._clipFBO&&this._clipFBO.width===h&&this._clipFBO.height===k||(this._clipFBO=new c(e,{colorTarget:0,depthStencilTarget:3,width:h,height:k}));
var u=.5*h,w=.5*k,f=1/h,v=1/k;a=.5*t*a.devicePixelRatio;var x=.5*(h*r+k*l),h=this._upperLeft,l=this._upperRight,r=this._lowerLeft,t=this._lowerRight;b.set(h,-a,-x);b.set(l,a,-x);b.set(r,-a,x);b.set(t,a,x);g.identity(this._mat2);g.translate(this._mat2,this._mat2,[u,w]);0!==n&&g.rotate(this._mat2,this._mat2,q);b.transformMat2d(h,h,this._mat2);b.transformMat2d(l,l,this._mat2);b.transformMat2d(r,r,this._mat2);b.transformMat2d(t,t,this._mat2);n=this._clipData;n.set([2*r[0]*f-1,2*(k-r[1])*v-1,2*t[0]*f-
1,2*(k-t[1])*v-1,2*h[0]*f-1,2*(k-h[1])*v-1,2*l[0]*f-1,2*(k-l[1])*v-1]);this._clipRendererInitialized||this._initializeClipRenderer(e);this._clipVBO.setData(n);this._boundFBO=e.getBoundFramebufferObject();e.bindFramebuffer(this._clipFBO);e.setDepthWriteEnabled(!0);e.setStencilWriteMask(255);e.setClearColor(0,0,0,0);e.setClearDepth(1);e.setClearStencil(0);e.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT|e.gl.STENCIL_BUFFER_BIT);e.setDepthWriteEnabled(!1);this._clipFrame=!0}},x.prototype.afterRenderChildren=
function(a,b){this._clipFrame&&this._clipRendererInitialized&&(a=this._renderingContext,a.bindFramebuffer(this._boundFBO),this._boundFBO=null,a.bindVAO(this._clipVAO),a.bindProgram(this._clipStencilProgram),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!1),a.setStencilOp(7680,7680,7681),a.setStencilWriteMask(255),a.setStencilFunction(519,1,255),a.drawElements(4,6,5123,0),a.bindVAO(),a.setColorMask(!0,!0,!0,!0),a.setBlendingEnabled(!0),
a.setStencilFunction(514,1,255),this._blitRenderer.render(a,this._clipFBO.colorTexture,9728,1),a.setStencilTestEnabled(!1))},x.prototype.doRender=function(a){var b=this.element.style;return this.visible?(b.display="block",b.opacity=""+this.opacity,this._resizeCanvas(a),l.prototype.doRender.call(this,a),void(this._cachedRenderParams=n(a))):void(b.display="none")},x.prototype.takeScreenshot=function(b){void 0===b&&(b={});var e=b.pixelRatio||1;this._cachedRenderParams.devicePixelRatio=e;var d=Math.round(e*
this._cachedRenderParams.state.width),g=Math.round(e*this._cachedRenderParams.state.height),k=0,h=0,n=d,q=g,l=d,r=g,l=b.area;(l&&(k=Math.round(e*l.x),h=Math.round(e*l.y),n=Math.round(e*l.width),q=Math.round(e*l.height)),void 0!==b.width&&void 0!==b.height)?(l=b.width/b.height,q*l<n?(l*=q,k+=Math.floor((n-l)/2),n=Math.floor(l)):(l=n/l,h+=Math.floor((q-l)/2),q=Math.floor(l)),l=b.width,r=b.height):(l=n,r=q);e=document.createElement("canvas");e.width=l;e.height=r;var t=e.getContext("2d"),u=new Uint8Array(n*
q*4),v=this._renderingContext,x=c.create(v,{colorTarget:1,depthStencilTarget:3,width:d,height:g});v.bindFramebuffer(x);v.setViewport(0,0,d,g);this._cachedRenderParams.budget&&this._cachedRenderParams.budget.reset(Number.MAX_VALUE);var m=this._cachedRenderParams,p=this._renderingContext.gl;if(this._renderingContext.setClearColor(0,0,0,0),this._renderingContext.setClearDepth(1),this._renderingContext.setClearStencil(0),this._renderingContext.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT|p.STENCIL_BUFFER_BIT),
m.context=this._renderingContext,this.beforeRenderChildren(m,m),void 0!==b.rotation&&null!==b.rotation){var p=m.state,y=p.clone();y.viewpoint.rotation=b.rotation;m.state=y;this.renderChildren(m);m.state=p}else this.renderChildren(m);this.afterRenderChildren(m,m);x.readPixels(k,g-(h+q),n,q,6408,5121,u);v.bindFramebuffer();v=t.getImageData(0,0,l,r);if(0!==k||0!==h||n!==d||q!==g||l!==d||r!==g)f.resampleHermite(u,n,q,v.data,l,r,!0);else{h=q-1;q=0;x=4*n;for(y=p=k=g=d=n=m=void 0;h>q;){p=q*x;y=h*x;for(m=
0;x>m;m+=4)n=u[p+m],d=u[p+m+1],g=u[p+m+2],k=u[p+m+3],u[p+m]=u[y+m],u[p+m+1]=u[y+m+1],u[p+m+2]=u[y+m+2],u[p+m+3]=u[y+m+3],u[y+m]=n,u[y+m+1]=d,u[y+m+2]=g,u[y+m+3]=k;q++;h--}n=v.data;d=u.length;for(h=0;d>h;h++)n[h]=u[h]}u=v.data;q=u.length;for(h=0;q>h;h+=4)k=u[h+3],0<k&&(g=k/255,n=Math.floor(u[h+0]/g),d=Math.floor(u[h+1]/g),g=Math.floor(u[h+2]/g),u[h+0]=255>=n?n:255,u[h+1]=255>=d?d:255,u[h+2]=255>=g?g:255);t.putImageData(v,0,0);t=w[b.format?b.format.toLowerCase():"png"];u=1;void 0!==b.quality&&(u=b.quality/
100);b=e.toDataURL(t,u);return a.resolve({dataURL:b,x:0,y:0,width:l,height:r})},x.prototype.prepareChildrenRenderParameters=function(a){if(!this.attached||!this._renderingContext)return null;a=n(a);var b=this._renderingContext,c=b.gl;return b.setDepthWriteEnabled(!0),b.setStencilWriteMask(255),b.setClearColor(0,0,0,0),b.setClearDepth(1),b.setClearStencil(0),b.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT),b.setViewport(0,0,this.element.width,this.element.height),b.setDepthWriteEnabled(!1),
a.context=b,a},x.prototype.attachChild=function(a,b){return a.attach(b)},x.prototype.detachChild=function(a,b){return a.detach(b)},x.prototype.renderChild=function(a,b){return a.processRender(b)},x.prototype._resizeCanvas=function(a){var b=this.element,c=b.style,e=a.state,d=a.devicePixelRatio;a=Math.round(e.width*d);d=Math.round(e.height*d);(b.width!==a||b.height!==d)&&(b.width=a,b.height=d);c.width=e.width+"px";c.height=e.height+"px"},x.prototype._initializeClipRenderer=function(a){if(this._clipRendererInitialized)return!0;
this._blitRenderer=new k;var b={a_pos:0},c=new t(a,y.stencilVS,y.stencilFS,b);if(!c)return!1;var e=u.createVertex(a,35040,32),d=new Uint16Array([0,1,2,2,1,3]),d=u.createIndex(a,35044,d);a=new r(a,b,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:e},d);return this._clipStencilProgram=c,this._clipVBO=e,this._clipVAO=a,this._clipRendererInitialized=!0,!0},x}(x)})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ./shaders/glShaderSnippets".split(" "),
function(m,l,h,d,b,g){return function(){function k(){this._initialized=!1}return k.prototype.render=function(b,a,e,c){b&&(this._initialized||this._initialize(b),b.setBlendFunctionSeparate(1,771,1,771),b.bindVAO(this._vertexArrayObject),b.bindProgram(this._program),a.setSamplingMode(e),b.bindTexture(a,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",c),b.drawArrays(5,0,4),b.bindVAO())},k.prototype._initialize=function(f){if(this._initialized)return!0;var a={a_pos:0,a_tex:1},
e=new h(f,g.bitblitVS,g.bitblitFS,a);if(!e)return!1;var c=new Int8Array(16);c[0]=-1;c[1]=-1;c[2]=0;c[3]=0;c[4]=1;c[5]=-1;c[6]=1;c[7]=0;c[8]=-1;c[9]=1;c[10]=0;c[11]=1;c[12]=1;c[13]=1;c[14]=1;c[15]=1;f=new d(f,a,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:b.createVertex(f,35044,c)});return this._program=e,this._vertexArrayObject=f,this._initialized=!0,!0},k}()})},"esri/views/2d/engine/webgl/shaders/glShaderSnippets":function(){define("require exports ../../../../webgl/ShaderSnippets dojo/text!./bitblit.vs.glsl dojo/text!./bitblit.fs.glsl dojo/text!./stencil.vs.glsl dojo/text!./stencil.fs.glsl dojo/text!./background.vs.glsl dojo/text!./background.fs.glsl dojo/text!./tileInfo.vs.glsl dojo/text!./tileInfo.fs.glsl".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){function q(a,b){t+='\x3csnippet name\x3d"'+a+'"\x3e\x3c![CDATA[';t+=b;t+="]]\x3e\x3c/snippet\x3e"}var t="",t=t+'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e',t=t+"\x3csnippets\x3e";q("bitblitVS",d);q("bitblitFS",b);q("stencilVS",g);q("stencilFS",k);q("backgroundVS",f);q("backgroundFS",a);q("tileInfoVS",e);q("tileInfoFS",c);t+="\x3c/snippets\x3e";m=new h;return h.parse(t,m),m})},"esri/views/support/screenshotUtils":function(){define(["require","exports","dojo/_base/lang"],
function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.adjustScreenshotSettings=function(d,b){d=h.mixin({format:"png",quality:100},d||{});var g,k;d.includePadding?(g=b.width,k=b.height):(g=b.width-b.padding.left-b.padding.right,k=b.height-b.padding.top-b.padding.bottom);var f=g/k;return void 0!==d.width&&void 0===d.height?d.height=d.width/f:void 0!==d.height&&void 0===d.width&&(d.width=f*d.height),void 0!==d.height&&(d.height=Math.floor(d.height)),void 0!==d.width&&(d.width=Math.floor(d.width)),
d.area||d.includePadding||(d.area={x:b.padding.left,y:b.padding.top,width:g,height:k}),d};l.resampleHermite=function(d,b,g,k,f,a,e){void 0===e&&(e=!0);var c=b/f;g/=a;for(var h=Math.ceil(c/2),l=Math.ceil(g/2),r=0;a>r;r++)for(var u=0;f>u;u++){for(var v=4*(u+(e?a-r-1:r)*f),x=0,m=0,n=0,w=0,z=0,C=0,B=0,F=(r+.5)*g,G=Math.floor(r*g);(r+1)*g>G;G++)for(var N=Math.abs(F-(G+.5))/l,M=(u+.5)*c,N=N*N,R=Math.floor(u*c);(u+1)*c>R;R++){var P=Math.abs(M-(R+.5))/h,Q=Math.sqrt(N+P*P);-1<=Q&&1>=Q&&(x=2*Q*Q*Q-3*Q*Q+1,
0<x&&(P=4*(R+G*b),B+=x*d[P+3],n+=x,255>d[P+3]&&(x=x*d[P+3]/250),w+=x*d[P],z+=x*d[P+1],C+=x*d[P+2],m+=x))}k[v]=w/m;k[v+1]=z/m;k[v+2]=C/m;k[v+3]=B/n}}})},"esri/views/webgl/RenderingContext":function(){define(["require","exports","./enums","./Extensions"],function(m,l,h,d){return function(){function b(b,k){this.gl=null;this._extensions=void 0;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,
modeAlpha:32774};this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=
0;this._stencilWriteMask=1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._lineWidth=1;this._clearColor={r:0,g:0,b:0,a:0};this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this.gl=b;this._extensions=new d(b,k);k=b.getParameter(b.VIEWPORT);this._viewport={x:k[0],y:k[1],width:k[2],height:k[3]};k=this.extensions.textureFilterAnisotropic;this._parameters={versionString:b.getParameter(b.VERSION),
maxVertexTextureImageUnits:b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:b.getParameter(b.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:k?b.getParameter(k.MAX_TEXTURE_MAX_ANISOTROPY_EXT):void 0,maxTextureImageUnits:b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS)};this.enforceState()}return Object.defineProperty(b.prototype,"extensions",{get:function(){return this._extensions},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},
enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"parameters",{get:function(){return this._parameters},enumerable:!0,configurable:!0}),b.prototype.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);this.unbindBuffer(34963);this._textureUnitMap={};this.gl=null},b.prototype.setBlendingEnabled=function(b){this._blendEnabled!==b&&(!0===b?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=b)},b.prototype.setBlendColor=function(b,d,f,a){(b!==this._blendColorState.r||
d!==this._blendColorState.g||f!==this._blendColorState.b||a!==this._blendColorState.a)&&(this.gl.blendColor(b,d,f,a),this._blendColorState.r=b,this._blendColorState.g=d,this._blendColorState.b=f,this._blendColorState.a=a)},b.prototype.setBlendFunction=function(b,d){(b!==this._blendFunctionState.srcRGB||d!==this._blendFunctionState.dstRGB)&&(this.gl.blendFunc(b,d),this._blendFunctionState.srcRGB=b,this._blendFunctionState.srcAlpha=b,this._blendFunctionState.dstRGB=d,this._blendFunctionState.dstAlpha=
d)},b.prototype.setBlendFunctionSeparate=function(b,d,f,a){(this._blendFunctionState.srcRGB!==b||this._blendFunctionState.srcAlpha!==f||this._blendFunctionState.dstRGB!==d||this._blendFunctionState.dstAlpha!==a)&&(this.gl.blendFuncSeparate(b,d,f,a),this._blendFunctionState.srcRGB=b,this._blendFunctionState.srcAlpha=f,this._blendFunctionState.dstRGB=d,this._blendFunctionState.dstAlpha=a)},b.prototype.setBlendEquation=function(b){this._blendEquationState.mode!==b&&(this.gl.blendEquation(b),this._blendEquationState.mode=
b,this._blendEquationState.modeAlpha=b)},b.prototype.setBlendEquationSeparate=function(b,d){(this._blendEquationState.mode!==b||this._blendEquationState.modeAlpha!==d)&&(this.gl.blendEquationSeparate(b,d),this._blendEquationState.mode=b,this._blendEquationState.modeAlpha=d)},b.prototype.setColorMask=function(b,d,f,a){(this._colorMaskState.r!==b||this._colorMaskState.g!==d||this._colorMaskState.b!==f||this._colorMaskState.a!==a)&&(this.gl.colorMask(b,d,f,a),this._colorMaskState.r=b,this._colorMaskState.g=
d,this._colorMaskState.b=f,this._colorMaskState.a=a)},b.prototype.setClearColor=function(b,d,f,a){(this._clearColor.r!==b||this._clearColor.g!==d||this._clearColor.b!==f||this._clearColor.a!==a)&&(this.gl.clearColor(b,d,f,a),this._clearColor.r=b,this._clearColor.g=d,this._clearColor.b=f,this._clearColor.a=a)},b.prototype.setFaceCullingEnabled=function(b){this._polygonCullingEnabled!==b&&(!0===b?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=b)},b.prototype.setPolygonOffsetFillEnabled=
function(b){this._polygonOffsetFillEnabled!==b&&(!0===b?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=b)},b.prototype.setPolygonOffset=function(b,d){this._polygonOffset[0]===b&&this._polygonOffset[1]===d||(this._polygonOffset[0]=b,this._polygonOffset[1]=d,this.gl.polygonOffset(b,d))},b.prototype.setCullFace=function(b){this._cullFace!==b&&(this.gl.cullFace(b),this._cullFace=b)},b.prototype.setFrontFace=function(b){this._frontFace!==
b&&(this.gl.frontFace(b),this._frontFace=b)},b.prototype.setScissorTestEnabled=function(b){this._scissorTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=b)},b.prototype.setScissorRect=function(b,d,f,a){(this._scissorRect.x!==b||this._scissorRect.y!==d||this._scissorRect.width!==f||this._scissorRect.height!==a)&&(this.gl.scissor(b,d,f,a),this._scissorRect.x=b,this._scissorRect.y=d,this._scissorRect.width=f,this._scissorRect.height=
a)},b.prototype.setDepthTestEnabled=function(b){this._depthTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=b)},b.prototype.setClearDepth=function(b){this._clearDepth!==b&&(this.gl.clearDepth(b),this._clearDepth=b)},b.prototype.setDepthFunction=function(b){this._depthFunction!==b&&(this.gl.depthFunc(b),this._depthFunction=b)},b.prototype.setDepthWriteEnabled=function(b){this._depthWriteEnabled!==b&&(this.gl.depthMask(b),this._depthWriteEnabled=
b)},b.prototype.setDepthRange=function(b,d){(this._depthRange.zNear!==b||this._depthRange.zFar!==d)&&(this.gl.depthRange(b,d),this._depthRange.zNear=b,this._depthRange.zFar=d)},b.prototype.setStencilTestEnabled=function(b){this._stencilTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=b)},b.prototype.setClearStencil=function(b){b!==this._clearStencil&&(this.gl.clearStencil(b),this._clearStencil=b)},b.prototype.setStencilFunction=
function(b,d,f){(this._stencilFunction.func!==b||this._stencilFunction.ref!==d||this._stencilFunction.mask!==f)&&(this.gl.stencilFunc(b,d,f),this._stencilFunction.face=1032,this._stencilFunction.func=b,this._stencilFunction.ref=d,this._stencilFunction.mask=f)},b.prototype.setStencilFunctionSeparate=function(b,d,f,a){(this._stencilFunction.face!==b||this._stencilFunction.func!==d||this._stencilFunction.ref!==f||this._stencilFunction.mask!==a)&&(this.gl.stencilFuncSeparate(b,d,f,a),this._stencilFunction.face=
b,this._stencilFunction.func=d,this._stencilFunction.ref=f,this._stencilFunction.mask=a)},b.prototype.setStencilWriteMask=function(b){this._stencilWriteMask!==b&&(this.gl.stencilMask(b),this._stencilWriteMask=b)},b.prototype.setStencilOp=function(b,d,f){(this._stencilOperation.fail!==b||this._stencilOperation.zFail!==d||this._stencilOperation.zPass!==f)&&(this.gl.stencilOp(b,d,f),this._stencilOperation.face=1032,this._stencilOperation.fail=b,this._stencilOperation.zFail=d,this._stencilOperation.zPass=
f)},b.prototype.setStencilOpSeparate=function(b,d,f,a){(this._stencilOperation.face!==b||this._stencilOperation.fail!==d||this._stencilOperation.zFail!==f||this._stencilOperation.zPass!==a)&&(this.gl.stencilOpSeparate(b,d,f,a),this._stencilOperation.face=b,this._stencilOperation.face=b,this._stencilOperation.fail=d,this._stencilOperation.zFail=f,this._stencilOperation.zPass=a)},b.prototype.setLineWidth=function(b){var d=this._lineWidth;return this._lineWidth!==b&&(this.gl.lineWidth(b),this._lineWidth=
b),d},b.prototype.setActiveTexture=function(b){var d=this._activeTextureUnit;return 0<=b&&b!==this._activeTextureUnit&&(this.gl.activeTexture(h.BASE_TEXTURE_UNIT+b),this._activeTextureUnit=b),d},b.prototype.clear=function(b){b&&this.gl.clear(b)},b.prototype.drawArrays=function(b,d,f){this.gl.drawArrays(b,d,f)},b.prototype.drawElements=function(b,d,f,a){return 5123===f?void this.gl.drawElements(b,d,f,a):void(5125===f&&this._extensions.elementIndexUint?this.gl.drawElements(b,d,f,a):console.warn("Data type is uint however extension OES_Element_index_unit is not supported therefore this draw call cannot be made"))},
b.prototype.drawArraysInstanced=function(b,d,f,a){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawArraysInstancedANGLE(b,d,f,a):console.error("Extension ANGLE_instanced_arrays isn't supported!")},b.prototype.drawElementsInstanced=function(b,d,f,a,e){this._extensions.angleInstancedArrays?5125!==f||this._extensions.elementIndexUint?this._extensions.angleInstancedArrays.drawElementsInstancedANGLE(b,d,f,a,e):console.error("Extension OES_Element_index_unit is not supported!"):
console.error("Extension ANGLE_instanced_arrays isn't supported!")},b.prototype.setViewport=function(b,d,f,a){var e=this._viewport;e.x===b&&e.y===d&&e.width===f&&e.height===a||(e.x=b,e.y=d,e.width=f,e.height=a,this.gl.viewport(b,d,f,a))},b.prototype.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}},b.prototype.bindProgram=function(b){return b?void(this._activeShaderProgram!==b&&(b.initialize(),this.gl.useProgram(b.glName),
this._activeShaderProgram=b)):(this.gl.useProgram(null),void(this._activeShaderProgram=null))},b.prototype.bindTexture=function(d,k){void 0===k&&(k=0);-1===b._MAX_TEXTURE_IMAGE_UNITS&&(b._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(k>=b._MAX_TEXTURE_IMAGE_UNITS||0>k)&&console.error("Input texture unit is out of range of available units!");var f=this._textureUnitMap[k];return this.setActiveTexture(k),null==d||null==d.glName?(null!=f&&(this.gl.bindTexture(f.descriptor.target,
null),f.setBoundToUnit(k,!1)),void(this._textureUnitMap[k]=null)):f&&f.id===d.id?void d.applyChanges():(this.gl.bindTexture(d.descriptor.target,d.glName),d.setBoundToUnit(k,!0),d.applyChanges(),void(this._textureUnitMap[k]=d))},b.prototype.bindFramebuffer=function(b){return b?void(this._activeFramebuffer!==b&&(b.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b.glName),this._activeFramebuffer=b)):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),void(this._activeFramebuffer=null))},b.prototype.bindBuffer=
function(d){d&&(34962===d.bufferType?this._activeVertexBuffer=b._bindBuffer(this.gl,d,d.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,d,d.bufferType,this._activeIndexBuffer))},b.prototype.unbindBuffer=function(d){34962===d?this._activeVertexBuffer=b._bindBuffer(this.gl,null,d,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,null,d,this._activeIndexBuffer)},b.prototype.bindVAO=function(b){return b?void(this._activeVertexArrayObject&&this._activeVertexArrayObject.id===
b.id||(b.bind(),this._activeVertexArrayObject=b)):void(this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null))},b.prototype.getBoundTexture=function(b){return this._textureUnitMap[b]},b.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer},b.prototype.getBoundVAO=function(){return this._activeVertexArrayObject},b.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);
this.unbindBuffer(34963);for(var b=0;b<this.parameters.maxTextureImageUnits;b++)this.bindTexture(null,b);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);
this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)},b.prototype.enforceState=function(){var b=this.gl,d=this._extensions.vao;d&&d.bindVertexArrayOES(null);for(var f=0;f<this.parameters.maxVertexAttributes;f++)b.disableVertexAttribArray(f);
if(this._activeVertexBuffer?b.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):b.bindBuffer(34962,null),this._activeIndexBuffer?b.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):b.bindBuffer(34963,null),d&&this._activeVertexArrayObject)(d=this._activeVertexArrayObject)&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null),this.bindVAO(d);b.bindFramebuffer(b.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:
null);b.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);b.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);!0===this._blendEnabled?b.enable(this.gl.BLEND):b.disable(this.gl.BLEND);b.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);b.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);
b.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);b.clearDepth(this._clearDepth);b.clearStencil(this._clearStencil);b.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);b.cullFace(this._cullFace);b.depthFunc(this._depthFunction);b.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST);b.depthMask(this._depthWriteEnabled);b.frontFace(this._frontFace);
b.lineWidth(this._lineWidth);!0===this._polygonCullingEnabled?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE);b.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL);b.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?b.enable(b.SCISSOR_TEST):b.disable(b.SCISSOR_TEST);b.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,
this._stencilFunction.mask);b.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST);b.stencilMask(this._stencilWriteMask);for(d=0;d<this.parameters.maxTextureImageUnits;d++)b.activeTexture(h.BASE_TEXTURE_UNIT+d),b.bindTexture(3553,null),(f=this._textureUnitMap[d])&&b.bindTexture(f.descriptor.target,f.glName);b.activeTexture(h.BASE_TEXTURE_UNIT+
this._activeTextureUnit);b.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)},b._bindBuffer=function(b,d,f,a){return d?a===d?a:(b.bindBuffer(f,d.glName),d):(b.bindBuffer(f,null),null)},b._MAX_TEXTURE_IMAGE_UNITS=-1,b}()})},"esri/views/webgl/enums":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.BASE_TEXTURE_UNIT=33984})},"esri/views/webgl/Extensions":function(){define(["require","exports"],function(m,l){return function(){function h(d,
b){if(this._vaoInit=!1,this._angleInstancedArraysInit=!1,this._standardDerivativesInit=!1,this._elementIndexUintInit=!1,this._depthTextureInit=!1,this._textureFilterAnisotropicInit=!1,this._shaderTextureLODInit=!1,this._compressedTextureS3TCInit=!1,this._disjointTimerQueryInit=!1,this._textureFloatInit=!1,this._textureFloatLinearInit=!1,this._colorBufferFloatInit=!1,this._gl=d,b&&b.disabledExtensions)d=b.disabledExtensions,d.vao&&(this._vao=null,this._vaoInit=!0),d.angleInstancedArrays&&(this._angleInstancedArrays=
null,this._angleInstancedArraysInit=!0),d.standardDerivatives&&(this._standardDerivatives=null,this._standardDerivativesInit=!0),d.elementIndexUint&&(this._elementIndexUint=null,this._elementIndexUintInit=!0),d.depthTexture&&(this._depthTexture=null,this._depthTextureInit=!0),d.textureFilterAnisotropic&&(this._textureFilterAnisotropic=null,this._textureFilterAnisotropicInit=!0),d.compressedTextureS3TC&&(this._compressedTextureS3TC=null,this._compressedTextureS3TCInit=!0),d.shaderTextureLOD&&(this._shaderTextureLOD=
null,this._shaderTextureLODInit=!0),d.disjointTimerQuery&&(this._disjointTimerQuery=null,this._disjointTimerQueryInit=!0),d.textureFloat&&(this._textureFloat=null,this._textureFloatInit=!0),d.textureFloatLinear&&(this._textureFloatLinear=null,this._textureFloatLinearInit=!0),d.colorBufferFloat&&(this._colorBufferFloat=null,this._colorBufferFloatInit=!0)}return Object.defineProperty(h.prototype,"vao",{get:function(){return this._vaoInit||(this._vao=this._gl.getExtension("OES_vertex_array_object")||
this._gl.getExtension("MOZ_OES_vertex_array_object")||this._gl.getExtension("WEBKIT_OES_vertex_array_object"),this._vaoInit=!0),this._vao},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"angleInstancedArrays",{get:function(){return this._angleInstancedArraysInit||(this._angleInstancedArrays=this._gl.getExtension("ANGLE_instanced_arrays"),this._angleInstancedArraysInit=!0),this._angleInstancedArrays},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"standardDerivatives",
{get:function(){return this._standardDerivativesInit||(this._standardDerivatives=this._gl.getExtension("OES_standard_derivatives"),this._standardDerivativesInit=!0),this._standardDerivatives},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"elementIndexUint",{get:function(){return this._elementIndexUintInit||(this._elementIndexUint=this._gl.getExtension("OES_element_index_uint"),this._elementIndexUintInit=!0),this._elementIndexUint},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,
"depthTexture",{get:function(){return this._depthTextureInit||(this._depthTexture=this._gl.getExtension("WEBGL_depth_texture")||this._gl.getExtension("MOZ_WEBGL_depth_texture")||this._gl.getExtension("WEBKIT_WEBGL_depth_texture"),this._depthTextureInit=!0),this._depthTexture},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"textureFilterAnisotropic",{get:function(){return this._textureFilterAnisotropicInit||(this._textureFilterAnisotropic=this._gl.getExtension("EXT_texture_filter_anisotropic")||
this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this._textureFilterAnisotropicInit=!0),this._textureFilterAnisotropic},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"shaderTextureLOD",{get:function(){return this._shaderTextureLODInit||(this._shaderTextureLOD=this._gl.getExtension("EXT_shader_texture_lod"),this._shaderTextureLODInit=!0),this._shaderTextureLOD},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,
"compressedTextureS3TC",{get:function(){return this._compressedTextureS3TCInit||(this._compressedTextureS3TC=this._gl.getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTextureS3TCInit=!0),this._compressedTextureS3TC},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"disjointTimerQuery",{get:function(){return this._disjointTimerQueryInit||(this._disjointTimerQuery=this._gl.getExtension("EXT_disjoint_timer_query"),this._disjointTimerQueryInit=!0),this._disjointTimerQuery},
enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"textureFloat",{get:function(){return this._textureFloatInit||(this._textureFloat=this._gl.getExtension("OES_texture_float"),this._textureFloatInit=!0),this._textureFloat},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"textureFloatLinear",{get:function(){return this._textureFloatLinearInit||(this._textureFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._textureFloatLinearInit=!0),this._textureFloatLinear},
enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"colorBufferFloat",{get:function(){return this._colorBufferFloatInit||(this._colorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this._colorBufferFloatInit=!0),this._colorBufferFloat},enumerable:!0,configurable:!0}),h}()})},"esri/views/webgl/webgl-utils":function(){define([],function(){var m=function(l,h){for(var d=["webgl","experimental-webgl","webkit-3d","moz-webgl"],b=null,g=0;g<d.length;++g){try{b=l.getContext(d[g],
h)}catch(k){}if(b)break}return b};return{create3DContext:m,setupWebGL:function(l,h){function d(b){var d=l.parentNode;d&&(d.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+b+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}return window.WebGLRenderingContext?(h=m(l,h))?[h]:(d('It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),
[null,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e']):(d('This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),[null,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'])},detectWebGL:function(){var l;
try{l=window.WebGLRenderingContext}catch(d){l=[!1,0]}var h;try{h=m(document.createElement("canvas"))}catch(d){h=[!1,1]}l?h?(l=h,l=[!0,{VERSION:l.getParameter(l.VERSION),SHADING_LANGUAGE_VERSION:l.getParameter(l.SHADING_LANGUAGE_VERSION),VENDOR:l.getParameter(l.VENDOR),RENDERER:l.getParameter(l.RENDERER),EXTENSIONS:l.getSupportedExtensions(),MAX_TEXTURE_SIZE:l.getParameter(l.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:l.getParameter(l.MAX_RENDERBUFFER_SIZE),MAX_VERTEX_TEXTURE_IMAGE_UNITS:l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]):
l=[!1,1]:l=[!1,0];return l}}})},"esri/views/2d/engine/webgl/painter/WGLPainter":function(){define("require exports dojo/has ../../../../../core/libs/gl-matrix/mat4 ../../../../webgl/FramebufferObject ../Dispatcher ../GeometryUtils ../MaterialManager ../enums ./WGLTextPainter ./WGLIconPainter ./WGLFillPainter ./WGLLinePainter ./WGLBackgroundPainter ./TileInfoRenderer ./WGLHighlightPainter ./WGLHeatmapPainter ../Utils".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y){var n=new Uint8Array(4*
y.C_HITTEST_SEARCH_SIZE*y.C_HITTEST_SEARCH_SIZE),w=new Uint32Array(n.buffer),z=new g;return function(){function g(){this._textPainter=new e;this._iconPainter=new c;this._fillPainter=new q;this._linePainter=new t;this._backgroundPainter=new r;this._hlPainter=new v;this._heatmapPainter=new x;this._extrudeMatrix=new Float32Array(16);this._extrudeNoRotationMatrix=new Float32Array(16);this._extrudeRotateVector=new Float32Array([0,0,1]);this._extrudeScaleVector=new Float32Array([1,1,1]);this._state={rotation:0,
width:0,height:0};this._cachedRotation=this._cachedHeight=this._cachedWidth=0;this._materialManager=new f}return g.prototype.initialize=function(a){this._materialManager.initialize(a)},g.prototype.update=function(a,b){this._state=a;(this._state.width!==this._cachedWidth||this._state.height!==this._cachedHeight||this._state.rotation!==this._cachedRotation)&&(this._extrudeScaleVector[0]=2/a.width,this._extrudeScaleVector[1]=-2/a.height,d.identity(this._extrudeMatrix),d.rotate(this._extrudeMatrix,this._extrudeMatrix,
-a.rotation*k.C_DEG_TO_RAD,this._extrudeRotateVector),d.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),d.transpose(this._extrudeMatrix,this._extrudeMatrix),d.identity(this._extrudeNoRotationMatrix),d.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),d.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation)},
g.prototype.setHighlightOptions=function(a){this._hlPainter.setHighlightOptions(a)},g.prototype.drawHeatmap=function(b,c,e,d){var f=this;if(this._heatmapPainter.bindHeatmapSurface(b,c.displayWidth*d,c.displayHeight*d),this._drawClippingRects(b,c.children),b.setBlendingEnabled(!0),b.setStencilWriteMask(0),b.setBlendFunctionSeparate(1,1,1,0),b.setStencilTestEnabled(!0),c.wglRendererInfo.symbolLevels.forEach(function(g){c.children.forEach(function(k){z.replayList(b,k.displayList,g,f,k,c.textureManager,
c.wglRendererInfo,a.WGLDrawPhase.GEOMETRY,e,d,!1)})}),b.setStencilTestEnabled(!1),this._heatmapPainter.drawHeatmap(b,c.wglRendererInfo,.75),h("esri-feature-tiles-debug")){this._tileInforenderer||(this._tileInforenderer=new u);for(var g=this._tileInforenderer,k=0,n=c.children;k<n.length;k++){var q=n[k];q.attached&&q.visible&&g.render(b,q)}}},g.prototype.draw=function(b,c,e,d,f){var g=this;if(this._drawClippingRects(b,c.children),b.setBlendingEnabled(!0),b.setStencilWriteMask(0),b.setBlendFunctionSeparate(1,
771,1,771),b.setStencilTestEnabled(!0),c.wglRendererInfo.symbolLevels.forEach(function(k){c.children.forEach(function(h){h.displayList&&!h.displayList.empty&&z.replayList(b,h.displayList,k,g,h,c.textureManager,c.wglRendererInfo,a.WGLDrawPhase.GEOMETRY,e,d,f)})}),b.setStencilTestEnabled(!1),h("esri-feature-tiles-debug")){this._tileInforenderer||(this._tileInforenderer=new u);for(var k=this._tileInforenderer,n=0,q=c.children;n<q.length;n++){var l=q[n];l.attached&&l.visible&&k.render(b,l)}}},g.prototype.highlight=
function(b,c,e,d){var f=this,g=b.getViewport();this._hlPainter.setup(b,g.width,g.height);this._hlPainter.startMaskDraw(b);this._drawClippingRects(b,c.children);b.setBlendingEnabled(!0);b.setStencilWriteMask(0);b.setBlendFunctionSeparate(1,771,1,771);b.setStencilTestEnabled(!0);c.wglRendererInfo.symbolLevels.forEach(function(g){c.children.forEach(function(k){k.hlDisplayList&&!k.hlDisplayList.empty&&z.replayList(b,k.hlDisplayList,g,f,k,c.textureManager,c.wglRendererInfo,a.WGLDrawPhase.HIGHLIGHT,e,d,
!1)})});this._hlPainter.draw(b)},g.prototype.hitTest=function(c,e,d,f,g){var k=this,h=y.C_HITTEST_SEARCH_SIZE,q=[0,0],l=[0,0];e=c.state;e.toMap(q,[0,0]);e.toMap(l,[h,h]);var r=f.children.filter(function(a){return!(q[0]>a.bounds[2]||l[0]<a.bounds[0]||q[1]<a.bounds[1]||l[1]>a.bounds[3])});if(0===r.length)return[];var t=c.context;this._hittestFBO||(this._hittestFBO=b.create(t,{colorTarget:0,depthStencilTarget:3,width:h,height:h}));e=t.getViewport();d=t.getBoundFramebufferObject();t.bindFramebuffer(this._hittestFBO);
t.setViewport(0,0,h,h);var u=t.gl;t.setClearColor(1,1,1,1);t.clear(u.COLOR_BUFFER_BIT);this._drawClippingRects(t,r);t.setBlendingEnabled(!1);t.setStencilWriteMask(0);t.setStencilTestEnabled(!0);f.wglRendererInfo.symbolLevels.forEach(function(b){r.forEach(function(e){e.displayList&&!e.displayList.empty&&z.replayList(t,e.displayList,b,k,e,f.textureManager,f.wglRendererInfo,a.WGLDrawPhase.HITTEST,g,c.devicePixelRatio,!1)})});t.setStencilTestEnabled(!1);t.setBlendingEnabled(!0);this._hittestFBO.readPixels(0,
0,h,h,6408,5121,n);for(var h=h*h,u=new Set,v=0;h>v;v++){var x=w[v];4294967295!==x&&u.add(x)}t.bindFramebuffer(d);t.setViewport(e.x,e.y,e.width,e.height);var m=[];return u.forEach(function(a){m.push(a)}),m},g.prototype.drawFill=function(a,b,c,e,d,f,g,k,h,n,q){this._fillPainter.draw(a,b,c,d,f,g,k,h,n,q,this._materialManager,e)},g.prototype.drawLine=function(a,b,c,e,d,f,g,k,h,n){this._linePainter.draw(a,b,c,d,f,g,k,h,n,this._materialManager,e,this._extrudeMatrix)},g.prototype.drawIcon=function(a,b,c,
e,d,f,g,k){this._iconPainter.draw(a,b,c,d,f,g,k,this._materialManager,e,this._extrudeMatrix,this._extrudeNoRotationMatrix)},g.prototype.drawText=function(a,b,c,e,d,f,g,k){this._textPainter.draw(a,b,c,d,f,g,k,this._materialManager,e,this._extrudeMatrix,this._extrudeNoRotationMatrix)},g.prototype._drawClippingRects=function(a,b){if(0!==b.length){a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,
7681);a.setClearStencil(0);a.clear(a.gl.STENCIL_BUFFER_BIT);a.setStencilWriteMask(255);for(var c,e=b.length,d=e,f=0;e>f;f++)c=b[f],c.stencilRef=d,a.setStencilFunctionSeparate(1032,519,d,255),d--,this._backgroundPainter.draw(a,c);a.setColorMask(!0,!0,!0,!0)}},g}()})},"esri/views/2d/engine/webgl/Dispatcher":function(){define(["require","exports","./enums"],function(m,l,h){return function(){function d(){}return d.prototype.replayList=function(b,d,k,f,a,e,c,h,l,r,u){var g=this;d=d.symbolLevels;d.length<=
k||(k=d[k])&&(b.setStencilTestEnabled(!0),b.setStencilFunction(514,a.stencilRef,255),k.zLevels.forEach(function(d){d=d.geometryDPInfo;d.fill&&g._draw(b,d.fill,f,a,e,c,l,r,h,u);d.line&&g._draw(b,d.line,f,a,e,c,l,r,h,u);d.marker&&g._draw(b,d.marker,f,a,e,c,l,r,h,u);d.text&&g._draw(b,d.text,f,a,e,c,l,r,h,u)}))},d.prototype._draw=function(b,d,k,f,a,e,c,q,l,r){d.forEach(function(d){switch(d.geometryType){case h.WGLGeometryType.FILL:k.drawFill(b,d.materialInfo,f,a,e,l,c,q,r,d.indexFrom,d.indexCount);break;
case h.WGLGeometryType.LINE:k.drawLine(b,d.materialInfo,f,a,e,l,c,q,d.indexFrom,d.indexCount);break;case h.WGLGeometryType.MARKER:k.drawIcon(b,d.materialInfo,f,a,e,l,d.indexFrom,d.indexCount);break;case h.WGLGeometryType.TEXT:k.drawText(b,d.materialInfo,f,a,e,l,d.indexFrom,d.indexCount)}})},d}()})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});!function(h){h[h.FILL=0]="FILL";h[h.LINE=1]="LINE";h[h.MARKER=2]=
"MARKER";h[h.TEXT=3]="TEXT";h[h.UNKNOWN=4]="UNKNOWN"}(l.WGLGeometryType||(l.WGLGeometryType={}));!function(h){h[h.SUCCEEDED=0]="SUCCEEDED";h[h.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"}(l.WGLGeometryTransactionStatus||(l.WGLGeometryTransactionStatus={}));!function(h){h[h.GEOMETRY=1]="GEOMETRY";h[h.TEXT=2]="TEXT";h[h.HITTEST=3]="HITTEST";h[h.HIGHLIGHT=4]="HIGHLIGHT"}(l.WGLDrawPhase||(l.WGLDrawPhase={}));!function(h){h[h.NONE=0]="NONE";h[h.OPACITY=1]="OPACITY";h[h.COLOR=2]="COLOR";h[h.ROTATION=
4]="ROTATION";h[h.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";h[h.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";h[h.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";h[h.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}(l.WGLVVFlag||(l.WGLVVFlag={}))})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(m,l){function h(b,d){return b%=d,0<=b?b:b+d}Object.defineProperty(l,"__esModule",{value:!0});l.C_INFINITY=Number.POSITIVE_INFINITY;l.C_PI=Math.PI;l.C_2PI=2*l.C_PI;l.C_PI_BY_2=l.C_PI/2;l.C_RAD_TO_256=
128/l.C_PI;l.C_256_TO_RAD=l.C_PI/128;l.C_DEG_TO_256=256/360;l.C_DEG_TO_RAD=l.C_PI/180;l.C_SQRT2=1.414213562;l.C_SQRT2_INV=1/l.C_SQRT2;var d=1/Math.LN2;l.positiveMod=h;l.radToByte=function(b){return h(b*l.C_RAD_TO_256,256)};l.degToByte=function(b){return h(b*l.C_DEG_TO_256,256)};l.log2=function(b){return Math.log(b)*d};l.sqr=function(b){return b*b};l.clamp=function(b,d,k){return Math.min(Math.max(b,d),k)};l.interpolate=function(b,d,k){return b*(1-k)+d*k};l.between=function(b,d,k){return b>=d&&k>=b||
b>=k&&d>=b}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports ../../../webgl/ShaderVariations ./shaders/textShaderSnippets ./shaders/iconShaderSnippets ./shaders/fillShaderSnippets ./shaders/lineShaderSnippets ./MaterialInfoUtils ./enums".split(" "),function(m,l,h,d,b,g,k,f,a){return function(){function e(){this._programRep=new Map;this.isInitialize=!1}return e.prototype.initialize=function(a){if(!this.isInitialize){var c=new h("text",["textVS","textFS"],[],d,a);c.addDefine("ID",
"ID",[!1,!1],"ID");c.addDefine("HIGHLIGHT","HIGHLIGHT",[!1,!1],"HIGHLIGHT");c.addDefine("SDF","SDF",[!1,!1],"SDF");c.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!1,!1],"VV_SIZE_MIN_MAX_VALUE");c.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!1,!1],"VV_SIZE_SCALE_STOPS");c.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!1,!1],"VV_SIZE_FIELD_STOPS");c.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!1,!1],"VV_SIZE_UNIT_VALUE");c.addDefine("VV_COLOR","VV_COLOR",[!1,
!1],"VV_COLOR");c.addDefine("VV_ROTATION","VV_ROTATION",[!1,!1],"VV_ROTATION");c.addDefine("VV_OPACITY","VV_OPACITY",[!1,!1],"VV_OPACITY");c.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");c.addDefine("PATTERN","PATTERN",[!1,!1],"PATTERN");c.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");var e=new h("icon",["iconVS","iconFS"],[],b,a);e.addDefine("ID","ID",[!0,!0],"ID");e.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT");e.addDefine("SDF","SDF",[!0,!0],"SDF");
e.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!0,!1],"VV_SIZE_MIN_MAX_VALUE");e.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!0,!1],"VV_SIZE_SCALE_STOPS");e.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!0,!1],"VV_SIZE_FIELD_STOPS");e.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!0,!1],"VV_SIZE_UNIT_VALUE");e.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");e.addDefine("VV_ROTATION","VV_ROTATION",[!0,!1],"VV_ROTATION");e.addDefine("VV_OPACITY","VV_OPACITY",
[!0,!1],"VV_OPACITY");e.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");e.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN");e.addDefine("HEATMAP","HEATMAP",[!0,!0],"HEATMAP");var f=new h("fill",["fillVS","fillFS"],[],g,a);f.addDefine("ID","ID",[!0,!0],"ID");f.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT");f.addDefine("SDF","SDF",[!1,!1],"SDF");f.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!1,!1],"VV_SIZE_MIN_MAX_VALUE");f.addDefine("VV_SIZE_SCALE_STOPS",
"VV_SIZE_SCALE_STOPS",[!1,!1],"VV_SIZE_SCALE_STOPS");f.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!1,!1],"VV_SIZE_FIELD_STOPS");f.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!1,!1],"VV_SIZE_UNIT_VALUE");f.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");f.addDefine("VV_ROTATION","VV_ROTATION",[!1,!1],"VV_ROTATION");f.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY");f.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");f.addDefine("PATTERN",
"PATTERN",[!0,!0],"PATTERN");f.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");a=new h("line",["lineVS","lineFS"],[],k,a);a.addDefine("ID","ID",[!0,!0],"ID");a.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT");a.addDefine("SDF","SDF",[!0,!0],"SDF");a.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!0,!1],"VV_SIZE_MIN_MAX_VALUE");a.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!0,!1],"VV_SIZE_SCALE_STOPS");a.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!0,!1],"VV_SIZE_FIELD_STOPS");
a.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!0,!1],"VV_SIZE_UNIT_VALUE");a.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");a.addDefine("VV_ROTATION","VV_ROTATION",[!0,!1],"VV_ROTATION");a.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY");a.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");a.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN");a.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");this._textShaderVariations=c;this._fillShaderVariations=f;
this._iconShaderVariations=e;this._lineShaderVariations=a;this.isInitialize=!0}},e.prototype.getProgram=function(b,e,d){if(b|=e===a.WGLDrawPhase.HITTEST?4:0,b|=e===a.WGLDrawPhase.HIGHLIGHT?8:0,this._programRep[b])return this._programRep[b];if(!this._iconShaderVariations||!this._fillShaderVariations||!this._lineShaderVariations)return null;var c;e=f.getMaterialVariations(b);switch(e.geometryType){case a.WGLGeometryType.MARKER:c=this._iconShaderVariations.getProgram(e.variations,null,null,d);break;
case a.WGLGeometryType.TEXT:c=this._textShaderVariations.getProgram(e.variations,null,null,d);break;case a.WGLGeometryType.FILL:c=this._fillShaderVariations.getProgram(e.variations,null,null,d);break;case a.WGLGeometryType.LINE:c=this._lineShaderVariations.getProgram(e.variations,null,null,d)}return c&&(this._programRep[b]=c),c},e}()})},"esri/views/2d/engine/webgl/shaders/textShaderSnippets":function(){define(["require","exports","../../../../webgl/ShaderSnippets","dojo/text!./textShaders.xml"],function(m,
l,h,d){m=new h;return h.parse(d,m),m})},"esri/views/2d/engine/webgl/shaders/iconShaderSnippets":function(){define(["require","exports","../../../../webgl/ShaderSnippets","dojo/text!./iconShaders.xml"],function(m,l,h,d){m=new h;return h.parse(d,m),m})},"esri/views/2d/engine/webgl/shaders/fillShaderSnippets":function(){define(["require","exports","../../../../webgl/ShaderSnippets","dojo/text!./fillShaders.xml"],function(m,l,h,d){m=new h;return h.parse(d,m),m})},"esri/views/2d/engine/webgl/shaders/lineShaderSnippets":function(){define(["require",
"exports","../../../../webgl/ShaderSnippets","dojo/text!./lineShaders.xml"],function(m,l,h,d){m=new h;return h.parse(d,m),m})},"esri/views/2d/engine/webgl/MaterialInfoUtils":function(){define(["require","exports","./MaterialKeyInfo","./enums","./MaterialInfo"],function(m,l,h,d,b){function g(b){var a=[];return a[0]=b.sdf?!0:!1,a[1]=b.vvSizeMinMaxValue?!0:!1,a[2]=b.vvSizeScaleStops?!0:!1,a[3]=b.vvSizeFieldStops?!0:!1,a[4]=b.vvSizeUnitValue?!0:!1,a[5]=b.vvColor?!0:!1,a[6]=b.vvRotation?!0:!1,a[7]=b.vvOpacity?
!0:!1,a[8]=b.visibility?!0:!1,a[9]=b.pattern?!0:!1,a[10]=b.heatmap?!0:!1,a.reduce(function(a,b,d){return b&&(a|=1<<d+2),a},0)}function k(b){if(b.geometryType===d.WGLGeometryType.UNKNOWN)return-1;var a=g(b)<<2;return b.geometryType+a}Object.defineProperty(l,"__esModule",{value:!0});l.createTextMaterialInfo=function(f,a){var e=b.pool.acquire(),c=h.pool.acquire();return c.geometryType=d.WGLGeometryType.TEXT,c.sdf=!0,c.pattern=!1,c.visibility=!0,c.heatmap=!1,e.texBindingInfo.push({unit:2,pageId:f.page,
semantic:"u_texture"}),0===a?c.vvOpacity=c.vvSizeMinMaxValue=c.vvSizeScaleStops=c.vvSizeFieldStops=c.vvSizeUnitValue=c.vvColor=c.vvRotation=!1:(c.vvOpacity=0!==(a&d.WGLVVFlag.OPACITY),c.vvSizeMinMaxValue=0!==(a&d.WGLVVFlag.SIZE_MINMAX_VALUE),c.vvSizeScaleStops=0!==(a&d.WGLVVFlag.SIZE_SCALE_STOPS),c.vvSizeFieldStops=0!==(a&d.WGLVVFlag.SIZE_FIELD_STOPS),c.vvSizeUnitValue=0!==(a&d.WGLVVFlag.SIZE_UNIT_VALUE),c.vvColor=0!==(a&d.WGLVVFlag.COLOR),c.vvRotation=0!==(a&d.WGLVVFlag.ROTATION)),e.materialKey=
k(c),e.materialKeyInfo=c,e};l.createMaterialInfo=function(f,a,e,c){var g=b.pool.acquire(),l=h.pool.acquire();l.geometryType=e;a=a.spriteMosaicItem;return a?(l.sdf=a.sdf,l.pattern=!0,g.texBindingInfo.push({unit:1,pageId:a.page,semantic:"u_texture"})):(l.sdf=!1,l.pattern=!1),0===c?l.vvOpacity=l.vvSizeMinMaxValue=l.vvSizeScaleStops=l.vvSizeFieldStops=l.vvSizeUnitValue=l.vvColor=l.vvRotation=!1:(l.vvOpacity=0!==(c&d.WGLVVFlag.OPACITY),l.vvSizeMinMaxValue=0!==(c&d.WGLVVFlag.SIZE_MINMAX_VALUE),l.vvSizeScaleStops=
0!==(c&d.WGLVVFlag.SIZE_SCALE_STOPS),l.vvSizeFieldStops=0!==(c&d.WGLVVFlag.SIZE_FIELD_STOPS),l.vvSizeUnitValue=0!==(c&d.WGLVVFlag.SIZE_UNIT_VALUE),l.vvColor=0!==(c&d.WGLVVFlag.COLOR),l.vvRotation=0!==(c&d.WGLVVFlag.ROTATION)),l.visibility=!1,l.heatmap=null!=f.heatmapInfo,g.materialKey=k(l),g.materialKeyInfo=l,g};l.getMaterialKey=k;l.updateMaterialVariations=function(b,a){return b.geometryType=3&a,a>>=2,b.sdf=0!==(4&a),b.vvSizeMinMaxValue=0!==(8&a),b.vvSizeScaleStops=0!==(16&a),b.vvSizeFieldStops=
0!==(32&a),b.vvSizeUnitValue=0!==(64&a),b.vvColor=0!==(128&a),b.vvRotation=0!==(256&a),b.vvOpacity=0!==(512&a),b.visibility=0!==(1024&a),b.pattern=0!==(2048&a),b.heatmap=0!==(4096&a),b};l.getMaterialVariations=function(b){var a=3&b;b>>=2;return{geometryType:a,variations:[0!==(1&b),0!==(2&b),0!==(4&b),0!==(8&b),0!==(16&b),0!==(32&b),0!==(64&b),0!==(128&b),0!==(256&b),0!==(512&b),0!==(1024&b),0!==(2048&b),0!==(4096&b)]}}})},"esri/views/2d/engine/webgl/MaterialKeyInfo":function(){define(["require","exports",
"../../../../core/ObjectPool","./enums"],function(m,l,h,d){return function(){function b(){this.heatmap=this.pattern=this.visibility=this.vvOpacity=this.vvRotation=this.vvColor=this.vvSizeUnitValue=this.vvSizeFieldStops=this.vvSizeScaleStops=this.vvSizeMinMaxValue=this.sdf=!1}return b.prototype.copy=function(b){this.geometryType=b.geometryType;this.sdf=b.sdf;this.vvSizeMinMaxValue=b.vvSizeMinMaxValue;this.vvSizeScaleStops=b.vvSizeScaleStops;this.vvSizeFieldStops=b.vvSizeFieldStops;this.vvSizeUnitValue=
b.vvSizeUnitValue;this.vvColor=b.vvColor;this.vvRotation=b.vvRotation;this.vvOpacity=b.vvOpacity;this.visibility=b.visibility;this.pattern=b.pattern;this.heatmap=b.heatmap},b.prototype.release=function(){this.geometryType=d.WGLGeometryType.UNKNOWN;this.heatmap=this.pattern=this.visibility=this.vvOpacity=this.vvRotation=this.vvColor=this.vvSizeUnitValue=this.vvSizeFieldStops=this.vvSizeScaleStops=this.vvSizeMinMaxValue=this.sdf=!1},b.pool=new h(b),b}()})},"esri/views/2d/engine/webgl/MaterialInfo":function(){define("require exports ../../../../core/ObjectPool ./MaterialKeyInfo ./MaterialInfoUtils ./Utils".split(" "),
function(m,l,h,d,b,g){return function(){function k(){this.texBindingInfo=[];this.materialParams=[]}return k.prototype.release=function(){this.materialKey=null;this.texBindingInfo.length=0;this.materialParams.length=0;this.materialKeyInfo&&d.pool.release(this.materialKeyInfo)},k.prototype.copy=function(b){var a=this;b.materialParams.forEach(function(b,c){a.materialParams[c]={name:b.name,value:b.value}});b.texBindingInfo.forEach(function(b,c){a.texBindingInfo[c]={unit:b.unit,pageId:b.pageId,semantic:b.semantic}});
this.materialKeyInfo&&(d.pool.release(this.materialKeyInfo),this.materialKeyInfo=null);b.materialKeyInfo&&(this.materialKeyInfo=d.pool.acquire(),this.materialKeyInfo.copy(b.materialKeyInfo));this.materialKey=b.materialKey},k.serialize=function(b,a,e){var c=0;return c+=g.serializeInteger(b.materialKey,a,e+c),c+=k._serializeTexBindingInfo(b.texBindingInfo,a,e+c),c+=k._serializeMaterialParams(b.materialParams,a,e+c)},k.deserialize=function(f,a,e){var c=0;f.materialInfo=k.pool.acquire();var h={n:0};return c+=
g.deserializeInteger(h,a,e+c),f.materialInfo.materialKey=h.n,c+=k._deserializeTexBindingInfo(f.materialInfo.texBindingInfo,a,e+c),c+=k._deserializeMaterialParams(f.materialInfo.materialParams,a,e+c),f.materialInfo.materialKeyInfo=d.pool.acquire(),b.updateMaterialVariations(f.materialInfo.materialKeyInfo,f.materialInfo.materialKey),c},k._serializeTexBindingInfo=function(b,a,e){for(var c=0,d=b.length,c=c+g.serializeInteger(d,a,e+c),f=0;d>f;++f)a&&(a[e+c]=b[f].unit),++c,c+=g.serializeInteger(b[f].pageId,
a,e+c),c+=g.serializeString(b[f].semantic,a,e+c);return c},k._serializeMaterialParams=function(b,a,e){for(var c=0,d=b.length,c=c+g.serializeInteger(d,a,e+c),f=0;d>f;++f)c+=g.serializeString(b[f].name,a,e+c),c+=g.serializeUniform(b[f].value,a,e+c);return c},k._deserializeTexBindingInfo=function(b,a,e){var c=0,d={n:void 0},c=c+g.deserializeInteger(d,a,e+c);b.length=d.n;for(var f={n:void 0},k={s:void 0},h=0;h<d.n;++h)b[h]={unit:void 0,pageId:void 0,semantic:void 0},b[h].unit=a[e+c],++c,c+=g.deserializeInteger(f,
a,e+c),b[h].pageId=f.n,c+=g.deserializeString(k,a,e+c),b[h].semantic=k.s;return c},k._deserializeMaterialParams=function(b,a,e){var c=0,d={n:void 0},c=c+g.deserializeInteger(d,a,e+c);b.length=d.n;for(var f={s:void 0},k={n:void 0},h=0;h<d.n;++h)b[h]={name:void 0,value:void 0},c+=g.deserializeString(f,a,e+c),b[h].name=f.s,c+=g.deserializeUniform(k,a,e+c),b[h].value=k.n;return c},k.pool=new h(k),k}()})},"esri/views/2d/engine/webgl/Utils":function(){define(["require","exports","./enums"],function(m,l,
h){function d(a){for(var b={},c=0;c<a.length;c++){var e=a[c];b[e.name]=e.strideInBytes}return b}function b(a){switch(a){case "esriSMS":return"simple-marker";case "esriPMS":return"picture-marker";case "esriSLS":return"simple-line";case "esriPLS":return"picture-line";case "esriSFS":return"simple-fill";case "esriPFS":return"picture-fill";case "esriTS":return"text"}return a}function g(a){if(a=b(a.type)){switch(a){case "simple-marker":case "picture-marker":return!0;case "CIMPointSymbol":return!0}return!1}}
function k(a){if(a=b(a.type)){switch(a){case "simple-fill":case "picture-fill":return!0;case "CIMPolygonSymbol":return!0}return!1}}function f(a){if(a=b(a.type)){switch(a){case "simple-line":case "picture-line":return!0;case "CIMLineSymbol":return!0}return!1}}function a(a){if(a=b(a.type)){switch(a){case "text":return!0;case "CIMTextSymbol":return!0}return!1}}function e(a){return a&&a.length||0}function c(a,b,c){var e=0;do{var d=a%128;a-=d;a/=128;0<a&&(d+=128);b&&(b[c+e]=d);++e}while(0<a);return e}
function q(a,b,c){for(var e=0,d=0,f=!0,g=1;f;){var k=b[c+e];++e;128<=k?(k-=128,f=!0):f=!1;d+=k*g;g*=128}return a.n=d,e}function t(a,b,c){void 0===b&&(b=0);void 0===c&&(c=!1);var e=a[b+3];return a[b+0]*=e,a[b+1]*=e,a[b+2]*=e,c||(a[b+3]*=255),a}function r(a){return"string"==typeof a}Object.defineProperty(l,"__esModule",{value:!0});l.C_HITTEST_SEARCH_SIZE=4;l.C_TILE_SIZE=512;l.C_VBO_GEOMETRY="geometry";l.C_VBO_PERINSTANCE="per_instance";l.C_VBO_PERINSTANCE_VV="per_instance_vv";l.C_VBO_VISIBILITY="visibility";
l.C_ICON_VERTEX_DEF=[{name:l.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}];l.C_ICON_VERTEX_DEF_VV=[{name:l.C_VBO_GEOMETRY,strideInBytes:40,divisor:0}];l.C_ICON_HEATMAP=[{name:l.C_VBO_GEOMETRY,strideInBytes:28,divisor:0}];l.C_FILL_VERTEX_DEF=[{name:l.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}];l.C_FILL_VERTEX_DEF_VV=[{name:l.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];l.C_LINE_VERTEX_DEF=[{name:l.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];l.C_LINE_VERTEX_DEF_VV=[{name:l.C_VBO_GEOMETRY,strideInBytes:44,
divisor:0}];l.C_TEXT_VERTEX_DEF=[{name:l.C_VBO_GEOMETRY,strideInBytes:20,divisor:0},{name:l.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}];l.C_TEXT_VERTEX_DEF_VV=[{name:l.C_VBO_GEOMETRY,strideInBytes:40,divisor:0},{name:l.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}];l.C_ICON_STRIDE_SPEC=d(l.C_ICON_VERTEX_DEF);l.C_ICON_STRIDE_SPEC_VV=d(l.C_ICON_VERTEX_DEF_VV);l.C_ICON_STRIDE_SPEC_HEATMAP=d(l.C_ICON_HEATMAP);l.C_FILL_STRIDE_SPEC=d(l.C_FILL_VERTEX_DEF);l.C_FILL_STRIDE_SPEC_VV=d(l.C_FILL_VERTEX_DEF_VV);
l.C_LINE_STRIDE_SPEC=d(l.C_LINE_VERTEX_DEF);l.C_LINE_STRIDE_SPEC_VV=d(l.C_LINE_VERTEX_DEF_VV);l.C_TEXT_STRIDE_SPEC=d(l.C_TEXT_VERTEX_DEF);l.C_TEXT_STRIDE_SPEC_VV=d(l.C_TEXT_VERTEX_DEF_VV);l.getStrides=function(a,b,c){switch(void 0===c&&(c=!1),a){case h.WGLGeometryType.MARKER:return b?l.C_ICON_STRIDE_SPEC_VV:c?l.C_ICON_STRIDE_SPEC_HEATMAP:l.C_ICON_STRIDE_SPEC;case h.WGLGeometryType.FILL:return b?l.C_FILL_STRIDE_SPEC_VV:l.C_FILL_STRIDE_SPEC;case h.WGLGeometryType.LINE:return b?l.C_LINE_STRIDE_SPEC_VV:
l.C_LINE_STRIDE_SPEC;case h.WGLGeometryType.TEXT:return b?l.C_TEXT_STRIDE_SPEC_VV:l.C_TEXT_STRIDE_SPEC}return null};l.getSymbolGeometryType=function(b){return g(b)?h.WGLGeometryType.MARKER:f(b)?h.WGLGeometryType.LINE:k(b)?h.WGLGeometryType.FILL:a(b)?h.WGLGeometryType.TEXT:h.WGLGeometryType.UNKNOWN};l.normalizeSymbolType=b;l.isMarkerSymbol=g;l.isFillSymbol=k;l.isLineSymbol=f;l.isPictureSymbol=function(a){if(a=b(a.type))switch(a){case "picture-marker":case "picture-line":case "picture-fill":return!0}return!1};
l.isTextSymbol=a;l.isSameUniformValue=function(a,b){return!1};l.isSameMaterialInfo=function(a,b){if(a.materialKey!==b.materialKey||e(a.texBindingInfo)!==e(b.texBindingInfo)||e(a.materialParams)!==e(b.materialParams))return!1;for(var c=a.texBindingInfo.length,d=0;c>d;++d){var f=a.texBindingInfo[d],g=b.texBindingInfo[d];if(f.unit!==g.unit||f.pageId!==g.pageId||f.semantic!==g.semantic)return!1}a=a.materialParams.length;for(d=0;a>d;)return!1;return!0};l.i1616to32=function(a,b){return 65535&a|b<<16};l.i8888to32=
function(a,b,c,e){return 255&a|(255&b)<<8|(255&c)<<16|e<<24};l.i8816to32=function(a,b,c){return 255&a|(255&b)<<8|c<<16};l.numTo32=function(a){return 0|a};l.serializeInteger=c;l.deserializeInteger=q;l.serializeString=function(a,b,c){for(var e=0,d=a.length,f=0;d>f;++f)b&&(b[c+e]=a.charCodeAt(f)),++e;return b&&(b[c+e]=0),++e,e};l.deserializeString=function(a,b,c){var e=0;a.s="";for(var d=!0;d;){var f=b[c+e];++e;0!==f?a.s+=String.fromCharCode(f):d=!1}return e};l.serializeUniform=function(a,b,e){return c(a,
b,e)};l.deserializeUniform=function(a,b,c){return q(a,b,c)};l.premultiplyAlpha=t;l.copyAndPremultiply=function(a){a=Array.isArray(a)?[a[0],a[1],a[2],a[3]]:[a.r,a.g,a.b,a.a];return t(a),a};l.nextHighestPowerOfTwo=function(a){return a--,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,a++,a};l.isDefined=function(a){return null!==a&&void 0!==a};l.isNumber=function(a){return"number"==typeof a};l.isString=r;l.isStringOrNull=function(a){return null==a||r(a)};l.lerp=function(a,b,c){return a+(b-a)*c};l.multimapAdd=
function(a,b,c){var e;a.has(b)?e=a.get(b):(e=new Set,a.set(b,e));e.add(c)};l.multimapRemove=function(a,b,c){if(a.has(b)){var e=a.get(b);e["delete"](c);0===e.size&&a["delete"](b)}}})},"esri/views/2d/engine/webgl/painter/WGLTextPainter":function(){define(["require","exports","../../../../webgl/VertexArrayObject","../Utils"],function(m,l,h,d){return function(){function b(){this._attributeLocations={a_pos:0,a_id:1,a_color:2,a_vertexOffset:3,a_texFontSize:4,a_visible:5};this._attributeLocationsVV={a_pos:0,
a_id:1,a_color:2,a_vertexOffset:3,a_texFontSize:4,a_visible:5,a_vv:6};this._vertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:20,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:20,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:12,stride:20,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:20,normalized:!1,divisor:0}],
visibility:[{name:"a_visible",count:1,type:5120,offset:0,stride:1,normalized:!1,divisor:0}]};this._vertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:36,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:36,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:36,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:12,stride:36,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:36,
normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:20,stride:36,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5120,offset:0,stride:1,normalized:!1,divisor:0}]};this._glyphsTextureSize=new Float32Array(2)}return b.prototype.draw=function(b,d,f,a,e,c,h,l,r,u,v){if(f.canDisplay){var g=d.materialKeyInfo,k=g.vvSizeMinMaxValue||g.vvSizeScaleStops||g.vvSizeFieldStops||g.vvSizeUnitValue||g.vvColor||g.vvRotation||g.vvOpacity;if(e=l.getProgram(d.materialKey,e,k?this._attributeLocationsVV:
this._attributeLocations))b.bindProgram(e),k=this._getVAO(b,f,k),b.bindVAO(k),d=d.texBindingInfo[0],r.bindGlyphsPage(b,d.pageId,d.unit),e.setUniform1i(d.semantic,d.unit),r=r.glyphs,this._glyphsTextureSize[0]=r.width/4,this._glyphsTextureSize[1]=r.height/4,u=a.vvMaterialParameters.vvRotationEnabled&&"geographic"===a.vvMaterialParameters.vvRotationType?u:v,e.setUniformMatrix4fv("u_transformMatrix",f.tileTransform.transform),e.setUniformMatrix4fv("u_extrudeMatrix",u),e.setUniform2fv("u_normalized_origin",
f.tileTransform.displayCoord),e.setUniform2fv("u_mosaicSize",this._glyphsTextureSize),e.setUniform1f("u_pixelRatio",1),e.setUniform1f("u_opacity",1),g.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeInfo",a.vvSizeMinMaxValue),g.vvSizeScaleStops,g.vvSizeFieldStops,g.vvSizeUnitValue,g.vvColor&&(e.setUniform1fv("u_vvColorValues",a.vvColorValues),e.setUniform4fv("u_vvColors",a.vvColors)),g.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),e.setUniform1fv("u_vvOpacities",a.vvOpacities)),b.drawElements(4,
h,5125,4*c),b.bindVAO(null)}},b.prototype._getVAO=function(b,k,f){if(k.textGeometry.vao)return k.textGeometry.vao;var a=k.textGeometry.vertexBufferMap[d.C_VBO_GEOMETRY],e=k.textGeometry.vertexBufferMap[d.C_VBO_VISIBILITY],c=k.textGeometry.indexBuffer;return a&&c?(f?k.textGeometry.vao=new h(b,this._attributeLocationsVV,this._vertexAttributeLayoutVV,{geometry:a,visibility:e},c):k.textGeometry.vao=new h(b,this._attributeLocations,this._vertexAttributeLayout,{geometry:a,visibility:e},c),k.textGeometry.vao):
null},b}()})},"esri/views/2d/engine/webgl/painter/WGLIconPainter":function(){define(["require","exports","../../../../webgl/VertexArrayObject","../../../../webgl/Texture","../Utils"],function(m,l,h,d,b){return function(){function g(){this._iconAttributeLocations={a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,a_sizeAndOutlineWidth:5};this._iconAttributeLocationsVV={a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,a_sizeAndOutlineWidth:5,a_vv:6};this._iconAttributeLocationsHeatmap=
{a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,a_sizeAndOutlineWidth:5,a_weight:6};this._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:24,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,
offset:16,stride:24,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}]};this._iconVertexAttributesWithVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:40,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:40,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:40,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:40,normalized:!0,divisor:0},
{name:"a_outlineColor",count:4,type:5121,offset:16,stride:40,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:40,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:24,stride:40,normalized:!1,divisor:0}]};this._iconVertexAttributesWithHeatmap={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:28,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:28,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,
offset:8,stride:28,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:28,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:28,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:28,normalized:!1,divisor:0},{name:"a_weight",count:1,type:5126,offset:24,stride:28,normalized:!1,divisor:0}]};this._spritesTextureSize=new Float32Array(2)}return g.prototype.draw=function(b,f,a,e,c,g,h,l,u,v,x){if(a.canDisplay){var k=
f.materialKeyInfo,n=k.heatmap,q=k.vvSizeMinMaxValue||k.vvSizeScaleStops||k.vvSizeFieldStops||k.vvSizeUnitValue||k.vvColor||k.vvRotation||k.vvOpacity;if(c=l.getProgram(f.materialKey,c,q?this._iconAttributeLocationsVV:this._iconAttributeLocations)){b.bindProgram(c);q=this._getVAO(b,a,q,n);if(b.bindVAO(q),n){u=e.heatmapParameters;if(u.intensityKernel&&!u.refreshIntensityKernel)u=u.intensityKernel;else{u.intensityKernel&&(u.intensityKernel.dispose(),u.intensityKernel=null);l=u.radius;f=u.kernelSize;for(var r=
u.blurRadius,t=l*l,n=[],q=-1;++q<f;)n[q]=Math.exp(-Math.pow(q-r,2)/(2*t))/(l/2*Math.sqrt(2*Math.PI));for(var m=[],F=0;f>F;F++)for(r=n[F],q=0;f>q;q++)t=F*f+q,l=n[q],m[4*t+0]=r*l,m[4*t+1]=0,m[4*t+2]=0,m[4*t+3]=1;f=new d(b,{target:3553,pixelFormat:6408,internalFormat:34836,dataType:5126,samplingMode:b.extensions.textureFloatLinear?9729:9728,wrapMode:33071,width:f,height:f},new Float32Array(m));u=(u.intensityKernel=f,u.refreshIntensityKernel=!1,f)}b.bindTexture(u,1);c.setUniform1i("u_texture",1);this._spritesTextureSize[0]=
Math.round(e.heatmapParameters.radius);this._spritesTextureSize[1]=Math.round(e.heatmapParameters.radius)}else n=f.texBindingInfo[0],f=n.pageId,u.bindSpritePage(b,f,n.unit),c.setUniform1i(n.semantic,n.unit),u=u.sprites,this._spritesTextureSize[0]=u.getWidth(f)/4,this._spritesTextureSize[1]=u.getHeight(f)/4;v=e.vvMaterialParameters.vvRotationEnabled&&"geographic"===e.vvMaterialParameters.vvRotationType?v:x;c.setUniformMatrix4fv("u_transformMatrix",a.tileTransform.transform);c.setUniformMatrix4fv("u_extrudeMatrix",
v);c.setUniform2fv("u_normalized_origin",a.tileTransform.displayCoord);c.setUniform2fv("u_mosaicSize",this._spritesTextureSize);c.setUniform1f("u_opacity",1);k.vvSizeMinMaxValue&&c.setUniform4fv("u_vvSizeMinMaxValue",e.vvSizeMinMaxValue);k.vvSizeScaleStops&&c.setUniform1f("u_vvSizeScaleStopsValue",e.vvSizeScaleStopsValue);k.vvSizeFieldStops&&(c.setUniform1fv("u_vvSizeFieldStopsValues",e.vvSizeFieldStopsValues),c.setUniform1fv("u_vvSizeFieldStopsSizes",e.vvSizeFieldStopsSizes));k.vvSizeUnitValue&&
c.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",e.vvSizeUnitValueToPixelsRatio);k.vvColor&&(c.setUniform1fv("u_vvColorValues",e.vvColorValues),c.setUniform4fv("u_vvColors",e.vvColors));k.vvOpacity&&(c.setUniform1fv("u_vvOpacityValues",e.vvOpacityValues),c.setUniform1fv("u_vvOpacities",e.vvOpacities));b.drawElements(4,h,5125,4*g);b.bindVAO(null)}}},g.prototype._getVAO=function(d,f,a,e){if(f.iconGeometry.vao)return f.iconGeometry.vao;var c=f.iconGeometry.vertexBufferMap[b.C_VBO_GEOMETRY],g=f.iconGeometry.indexBuffer;
return c&&g?(a?f.iconGeometry.vao=new h(d,this._iconAttributeLocationsVV,this._iconVertexAttributesWithVV,{geometry:c},g):e?f.iconGeometry.vao=new h(d,this._iconAttributeLocationsHeatmap,this._iconVertexAttributesWithHeatmap,{geometry:c},g):f.iconGeometry.vao=new h(d,this._iconAttributeLocations,this._iconVertexAttributes,{geometry:c},g),f.iconGeometry.vao):null},g}()})},"esri/views/2d/engine/webgl/painter/WGLFillPainter":function(){define(["require","exports","../../../../webgl/VertexArrayObject",
"../Utils"],function(m,l,h,d){return function(){function b(){this._isInitialized=!1;this._fillAttributeLocations={a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4};this._fillAttributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4,a_vv:5};this._spritesTextureSize=new Float32Array(2)}return b.prototype.draw=function(b,k,f,a,e,c,h,l,r,u,v,x){if(f.canDisplay){this._initialize();var g=k.materialKeyInfo,n=g.vvColor||g.vvOpacity;if(e=v.getProgram(k.materialKey,e,n?this._fillAttributeLocationsVV:this._fillAttributeLocations)){b.bindProgram(e);
n=this._getVAO(b,f,n);if(b.bindVAO(n),0<k.texBindingInfo.length)k=k.texBindingInfo[0],n=k.pageId,v=x.sprites,this._spritesTextureSize[0]=v.getWidth(n),this._spritesTextureSize[1]=v.getHeight(n),e.setUniform1f("u_zoomFactor",f.coordRange/d.C_TILE_SIZE/Math.pow(2,c-f.key.level)/h),x.bindSpritePage(b,n,k.unit,l?9728:9729),e.setUniform1i(k.semantic,k.unit),e.setUniform2fv("u_mosaicSize",this._spritesTextureSize);e.setUniformMatrix4fv("u_transformMatrix",f.tileTransform.transform);e.setUniform2fv("u_normalized_origin",
f.tileTransform.displayCoord);e.setUniform1f("u_opacity",1);g.vvColor&&(e.setUniform1fv("u_vvColorValues",a.vvColorValues),e.setUniform4fv("u_vvColors",a.vvColors));g.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),e.setUniform1fv("u_vvOpacities",a.vvOpacities));b.drawElements(4,u,5125,4*r);b.bindVAO(null)}}},b.prototype._initialize=function(){if(this._isInitialized)return!0;this._fillVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,
divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}]};this._fillVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,
divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_vv",count:2,type:5126,offset:24,stride:32,normalized:!1,divisor:0}]};this._isInitialized=!0},b.prototype._getVAO=function(b,k,f){if(k.fillGeometry.vao)return k.fillGeometry.vao;var a=k.fillGeometry.vertexBufferMap[d.C_VBO_GEOMETRY],e=k.fillGeometry.indexBuffer;
return a&&e?(f?k.fillGeometry.vao=new h(b,this._fillAttributeLocationsVV,this._fillVertexAttributeLayoutVV,{geometry:a},e):k.fillGeometry.vao=new h(b,this._fillAttributeLocations,this._fillVertexAttributeLayout,{geometry:a},e),k.fillGeometry.vao):null},b}()})},"esri/views/2d/engine/webgl/painter/WGLLinePainter":function(){define(["require","exports","../../../../webgl/VertexArrayObject","../Utils"],function(m,l,h,d){return function(){function b(){this._lineAttributeLocations={a_pos:0,a_id:1,a_color:2,
a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6};this._lineAttributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6,a_vv:7};this._lineVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},
{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:32,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:32,normalized:!1,divisor:0}]};this._lineVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:44,normalized:!1,divisor:0},{name:"a_id",count:4,
type:5121,offset:4,stride:44,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:44,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:44,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:44,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:44,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:44,normalized:!1,divisor:0},{name:"a_vv",
count:3,type:5126,offset:32,stride:44,normalized:!1,divisor:0}]};this._spritesTextureSize=new Float32Array(2)}return b.prototype.draw=function(b,k,f,a,e,c,h,l,r,u,v,x){var g=k.materialKeyInfo,n=g.vvSizeMinMaxValue||g.vvSizeScaleStops||g.vvSizeFieldStops||g.vvSizeUnitValue||g.vvColor||g.vvOpacity;if(e=u.getProgram(k.materialKey,e,n?this._lineAttributeLocationsVV:this._lineAttributeLocations)){b.bindProgram(e);n=this._getVAO(b,f,n);b.bindVAO(n);n=1/h;if(0<k.texBindingInfo.length){k=k.texBindingInfo[0];
u=k.pageId;var q=v.sprites;this._spritesTextureSize[0]=q.getWidth(u);this._spritesTextureSize[1]=q.getHeight(u);v.bindSpritePage(b,u,k.unit);e.setUniform1i(k.semantic,k.unit);e.setUniform2fv("u_mosaicSize",this._spritesTextureSize);e.setUniform1f("u_zoomFactor",Math.pow(2,c-f.key.level)/h);e.setUniform1f("u_tileCoordRatio",d.C_TILE_SIZE/f.coordRange)}e.setUniformMatrix4fv("u_transformMatrix",f.tileTransform.transform);e.setUniformMatrix4fv("u_extrudeMatrix",x);e.setUniform2fv("u_normalized_origin",
f.tileTransform.displayCoord);e.setUniform1f("u_opacity",1);e.setUniform1f("u_blur",0+n);e.setUniform1f("u_antialiasing",n);g.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue);g.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue);g.vvSizeFieldStops&&(e.setUniform1fv("u_vvSizeFieldStopsValues",a.vvSizeFieldStopsValues),e.setUniform1fv("u_vvSizeFieldStopsSizes",a.vvSizeFieldStopsSizes));g.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",
a.vvSizeUnitValueToPixelsRatio);g.vvColor&&(e.setUniform1fv("u_vvColorValues",a.vvColorValues),e.setUniform4fv("u_vvColors",a.vvColors));g.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),e.setUniform1fv("u_vvOpacities",a.vvOpacities));b.setFaceCullingEnabled(!0);b.setFrontFace(2305);b.setCullFace(1029);b.drawElements(4,r,5125,4*l);b.setFaceCullingEnabled(!1);b.bindVAO(null)}},b.prototype._getVAO=function(b,k,f){if(k.lineGeometry.vao)return k.lineGeometry.vao;var a=k.lineGeometry.vertexBufferMap[d.C_VBO_GEOMETRY],
e=k.lineGeometry.indexBuffer;return a&&e?(f?k.lineGeometry.vao=new h(b,this._lineAttributeLocationsVV,this._lineVertexAttributeLayoutVV,{geometry:a},e):k.lineGeometry.vao=new h(b,this._lineAttributeLocations,this._lineVertexAttributeLayout,{geometry:a},e),k.lineGeometry.vao):null},b}()})},"esri/views/2d/engine/webgl/painter/WGLBackgroundPainter":function(){define("require exports ../../../../../core/libs/gl-matrix/vec4 ../../../../webgl/Program ../../../../webgl/VertexArrayObject ../../../../webgl/BufferObject ../shaders/glShaderSnippets".split(" "),
function(m,l,h,d,b,g,k){return function(){function f(){this._color=h.create();this._initialized=!1;this._color.set([1,0,0,1])}return f.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)},f.prototype.draw=function(a,b,c){this._initialized||this._initialize(a);c&&(this._color[0]=c[0],this._color[1]=c[1],this._color[2]=c[2],this._color[3]=c[3]);
a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);this._solidProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);this._solidProgram.setUniform1f("u_coord_range",b.coordRange);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()},f.prototype._initialize=function(a){if(this._initialized)return!0;
var e={a_pos:0},c=new d(a,k.backgroundVS,k.backgroundFS,e);if(!c)return!1;var f=new Int8Array([0,0,1,0,0,1,1,1]),f=g.createVertex(a,35044,f);a=new b(a,e,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:f});return this._solidProgram=c,this._solidVertexArrayObject=a,this._initialized=!0,!0},f}()})},"esri/views/2d/engine/webgl/painter/TileInfoRenderer":function(){define("require exports ../../../../webgl/Program ../../../../webgl/VertexArrayObject ../../../../webgl/BufferObject ../../../../webgl/Texture ../GeometryUtils ../shaders/glShaderSnippets".split(" "),
function(m,l,h,d,b,g,k,f){return function(){function a(){this._initialized=!1;this._maxWidth=0;this._color=new Float32Array([1,0,0,1])}return a.prototype.render=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);this._outlineProgram.setUniform1f("u_coord_range",
b.coordRange);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.setLineWidth(2);a.drawArrays(3,0,4);a.bindVAO();var c=this._getTexture(a,b);c&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",
0),this._tileInfoProgram.setUniform1f("u_coord_ratio",b.coordRange/512),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())},a.prototype._initialize=function(a){if(this._initialized)return!0;var c={a_pos:0},e=new h(a,f.backgroundVS,f.backgroundFS,c),g=new h(a,f.tileInfoVS,f.tileInfoFS,c),k={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},l=
new Int8Array([0,0,1,0,1,1,0,1]),l=b.createVertex(a,35044,l),l=new d(a,c,k,{geometry:l}),v=new Int8Array([0,0,1,0,0,1,1,1]),v=b.createVertex(a,35044,v);a=new d(a,c,k,{geometry:v});return this._outlineProgram=e,this._tileInfoProgram=g,this._outlineVertexArrayObject=l,this._tileInfoVertexArrayObject=a,this._initialized=!0,!0},a.prototype._getTexture=function(a,b){if(b.texture)return b.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width",
"256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var c=b.key.id,e=this._canvas.getContext("2d");e.font="24px sans-serif";e.textAlign="left";e.textBaseline="middle";var d=e.measureText(c),d=Math.pow(2,Math.ceil(k.log2(d.width+2)));d>this._maxWidth&&(this._maxWidth=d);return e.clearRect(0,0,this._maxWidth,32),e.fillStyle="blue",e.fillText(c,0,16),b.texture=new g(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas),b.texture},
a}()})},"esri/views/2d/engine/webgl/painter/WGLHighlightPainter":function(){define(["require","exports","dojo/has","./highlight/HighlightRenderer","./highlight/HighlightSurfaces"],function(m,l,h,d,b){return function(){function g(){this._hlRenderer=new d;this._hlSurfaces=new b;this._height=this._width=void 0}return g.prototype.setup=function(b,d,a){this._width=d;this._height=a;d=Math.round(.7*d);a=Math.round(.7*a);this._hlRenderer.setup(b,d,a);this._hlSurfaces.setup(b,d,a)},g.prototype.setHighlightOptions=
function(b){this._hlRenderer.setHighlightOptions({fillColor:b.fillColor,outlineColor:b.outlineColor,outlineWidth:.7*b.outlineWidth,outerHaloWidth:.7*b.outerHaloWidth,innerHaloWidth:.7*b.innerHaloWidth,outlinePosition:.7*b.outlinePosition})},g.prototype.startMaskDraw=function(b){b.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);b.setClearColor(0,0,0,0);b.setClearStencil(0);b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.STENCIL_BUFFER_BIT);b.setViewport(0,0,.7*this._width,.7*this._height)},g.prototype.draw=function(b){b.setStencilTestEnabled(!1);
b.setBlendingEnabled(!1);b.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(b,this._hlSurfaces.sharedBlur1Tex);h("esri-feature-highlight-debug")?(b.bindFramebuffer(null),b.clear(b.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(b,this._hlSurfaces.sharedBlur2Tex)):(b.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),b.setClearColor(0,0,0,0),b.clear(b.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(b,this._hlSurfaces.sharedBlur2Tex),
b.setBlendingEnabled(!0),b.bindFramebuffer(null),b.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(b,this._hlSurfaces.sharedBlur1Tex))},g}()})},"esri/views/2d/engine/webgl/painter/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl/BufferObject ../../../../../webgl/VertexArrayObject ../../../../../webgl/Texture ../../../../../webgl/enums ../../../../../webgl/ShaderVariations ../../shaders/hlShaderSnippets".split(" "),function(m,l,h,d,b,g,
k,f){var a=[void 0,void 0,void 0,1],e=[3,4],c=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],q=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return function(){function g(){this._height=this._width=void 0;this._highlightOptions={fillColor:[.2,.6,.9,.75],outlineColor:[.2,.6,.9,.9],outlinePosition:0,outlineWidth:3.4,innerHaloWidth:2,outerHaloWidth:3.3};this._resources=null}return g.prototype._initialize=function(c,g,q){this._width=g;this._height=q;g=new h(c,34962,35044,(new Int8Array([-128,-128,0,0,127,-128,255,0,-128,127,0,
255,127,127,255,255])).buffer);q=new d(c,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!0},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!0}]},{geometry:g});var l=(new k("hl",["texturedVS","highlightFS"],[],f,c,{a_position:0,a_texcoord:1})).getProgram([]),r=(new k("hl",["texturedVS","blurFS"],[],f,c,{a_position:0,a_texcoord:1})).getProgram([]);l.setUniform1i("u_texture",e[0]);l.setUniform1i("u_shade",e[1]);l.setUniform4fv("u_sigmas",
a);r.setUniform1i("u_texture",e[0]);r.setUniform4fv("u_sigmas",a);c=new b(c,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:256,height:1,samplingMode:9728});this._resources={quadGeometry:g,quadVAO:q,highlightProgram:l,blurProgram:r,shadeTex:c}},g.prototype.setHighlightOptions=function(b){function c(a,b,c){q[0]=(1-c)*a[0]+c*b[0];q[1]=(1-c)*a[1]+c*b[1];q[2]=(1-c)*a[2]+c*b[2];q[3]=(1-c)*a[3]+c*b[3]}if(this._highlightOptions=b,this._resources){var e=b.outlinePosition-b.outlineWidth/2-
b.outerHaloWidth,d=b.outlinePosition-b.outlineWidth/2,f=b.outlinePosition+b.outlineWidth/2,g=b.outlinePosition+b.outlineWidth/2+b.innerHaloWidth,k=Math.sqrt(Math.PI/2)*a[3],h=Math.abs(e)>k?Math.round(10*(Math.abs(e)-k))/10:0,k=Math.abs(g)>k?Math.round(10*(Math.abs(g)-k))/10:0;h&&!k?console.warn("The outer rim of the highlight is "+h+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!h&&k?console.warn("The inner rim of the highlight is "+
k+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):h&&k&&console.warn("The highlight is "+Math.max(h,k)+"px away from the edge of the feature; consider reducing some width values.");for(var k=new Uint8Array(1024),q=[void 0,void 0,void 0,void 0],l=0;256>l;++l)h=e+l/255*(g-e),e>h?(k[4*l+0]=0,k[4*l+1]=0,k[4*l+2]=0,k[4*l+3]=0):d>h?c([0,0,0,0],b.outlineColor,(h-e)/(d-e)):f>h?(q[0]=b.outlineColor[0],q[1]=b.outlineColor[1],
q[2]=b.outlineColor[2],q[3]=b.outlineColor[3]):g>h?c(b.outlineColor,b.fillColor,(h-f)/(g-f)):(k[4*l+0]=b.fillColor[0],k[4*l+1]=b.fillColor[1],k[4*l+2]=b.fillColor[2],k[4*l+3]=b.fillColor[3]),k[4*l+0]=255*q[0]*q[3],k[4*l+1]=255*q[1]*q[3],k[4*l+2]=255*q[2]*q[3],k[4*l+3]=255*q[3];this._resources.highlightProgram.setUniform2fv("u_minMaxDistance",[e,g]);this._resources.shadeTex.updateData(0,0,0,256,1,k)}},g.prototype.setup=function(a,b,c){this._resources?(this._width=b,this._height=c):(this._initialize(a,
b,c),this.setHighlightOptions(this._highlightOptions))},g.prototype._teardown=function(){this._resources.quadGeometry.dispose();this._resources.quadVAO.dispose();this._resources.highlightProgram.dispose();this._resources.blurProgram.dispose();this._resources.shadeTex.dispose();this._resources=null},g.prototype.dispose=function(){this._resources&&this._teardown()},g.prototype.preBlur=function(a,b){a.bindTexture(b,e[0]);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",c);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()},g.prototype.finalBlur=function(a,b){a.bindTexture(b,e[0]);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",q);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()},g.prototype.renderHighlight=
function(a,b){a.bindTexture(b,e[0]);a.bindTexture(this._resources.shadeTex,e[1]);a.bindProgram(this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()},g}()})},"esri/views/2d/engine/webgl/shaders/hlShaderSnippets":function(){define(["require","exports","../../../../webgl/ShaderSnippets","dojo/text!./hlShaders.xml"],function(m,l,h,d){m=new h;return h.parse(d,m),m})},"esri/views/2d/engine/webgl/painter/highlight/HighlightSurfaces":function(){define(["require",
"exports","../../../../../webgl/FramebufferObject","../../../../../webgl/Texture"],function(m,l,h,d){function b(b,k,f){k=new d(b,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:k,height:f,samplingMode:9729});b=h.createWithAttachments(b,k,{colorTarget:0,depthStencilTarget:2});return[k,b]}return function(){function d(){this._height=this._width=void 0;this._resources=null}return d.prototype._initialize=function(d,f,a){this._width=f;this._height=a;var e=b(d,f,a),c=e[0],e=e[1];d=b(d,f,
a);this._resources={sharedBlur1Tex:c,sharedBlur1Fbo:e,sharedBlur2Tex:d[0],sharedBlur2Fbo:d[1]}},d.prototype.setup=function(b,d,a){!this._resources||this._width===d&&this._height===a||this._teardown();this._resources||this._initialize(b,d,a)},d.prototype._teardown=function(){this._resources.sharedBlur1Tex.dispose();this._resources.sharedBlur1Fbo.dispose();this._resources.sharedBlur2Tex.dispose();this._resources.sharedBlur2Fbo.dispose();this._resources=null},d.prototype.dispose=function(){this._resources&&
this._teardown()},Object.defineProperty(d.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},
enumerable:!0,configurable:!0}),d}()})},"esri/views/2d/engine/webgl/painter/WGLHeatmapPainter":function(){define("require exports ../../../../webgl/Program ../../../../webgl/VertexArrayObject ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/FramebufferObject dojo/text!../shaders/heatmap.vs.glsl dojo/text!../shaders/heatmap.fs.glsl".split(" "),function(m,l,h,d,b,g,k,f,a){return function(){function e(){this._initWGLExtensions=this._initialized=!1}return e.prototype.bindHeatmapSurface=
function(a,b,e){if(!this._initWGLExtensions){var c=a.extensions;if(!c.textureFloatLinear||!c.colorBufferFloat)throw Error("Required WebGL extensions needed for the heatmap drawing are not available!");this._initWGLExtensions=!0}b=Math.round(b/4);e=Math.round(e/4);this._intensityFBO&&this._intensityFBO.width===b&&this._intensityFBO.height===e||(this._intensityFBO&&this._intensityFBO.dispose(),c=new g(a,{target:3553,internalFormat:34836,pixelFormat:6408,dataType:5126,samplingMode:a.extensions.textureFloatLinear?
9729:9728,wrapMode:33071,width:b,height:e}),this._intensityFBO=k.createWithAttachments(a,c,{colorTarget:0,depthStencilTarget:3,width:b,height:e,multisampled:!1}));this._boundFBO=a.getBoundFramebufferObject();a.bindFramebuffer(this._intensityFBO);this._prevVP=a.getViewport();a.setViewport(0,0,b,e);a.setStencilWriteMask(255);a.setClearColor(0,0,0,0);a.setClearStencil(0);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.STENCIL_BUFFER_BIT)},e.prototype.drawHeatmap=function(a,b,e){a.bindFramebuffer(this._boundFBO);
this._boundFBO=null;a.setViewport(this._prevVP.x,this._prevVP.y,this._prevVP.width,this._prevVP.height);this._initialized||(this._initialized=this._initialize(a));a.setBlendFunctionSeparate(1,771,1,771);a.setBlendingEnabled(!0);a.bindVAO(this._vertexArrayObject);a.bindProgram(this._program);a.bindTexture(this._intensityFBO.colorTexture,2);this._program.setUniform1i("u_texture",2);this._program.setUniform1f("u_opacity",e);b=b.heatmapParameters;this._updateGradient(a,b);this._program.setUniform2f("u_minmax",
b.minPixelIntensity,b.maxPixelIntensity);a.setActiveTexture(5);a.bindTexture(this._gradientTex,5);this._program.setUniform1i("u_gradient",5);a.drawArrays(5,0,4);a.bindVAO()},e.prototype._initialize=function(c){if(this._initialized)return!0;var e={a_pos:0,a_tex:1},g=new h(c,f,a,e);if(!g)return!1;var k=new Int8Array(16);k[0]=-1;k[1]=-1;k[2]=0;k[3]=0;k[4]=1;k[5]=-1;k[6]=1;k[7]=0;k[8]=-1;k[9]=1;k[10]=0;k[11]=1;k[12]=1;k[13]=1;k[14]=1;k[15]=1;c=new d(c,e,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,
stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:b.createVertex(c,35044,k)});return this._program=g,this._vertexArrayObject=c,this._initialized=!0,!0},e.prototype._updateGradient=function(a,b){if(!this._gradientTex||b.color.refreshColorRamp){this._gradientTex&&(this._gradientTex.dispose(),this._gradientTex=null);this._gradientTex=new g(a,{target:3553,internalFormat:6408,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,
width:1,height:512});a=document.createElement("CANVAS");a.width=1;a.height=512;for(var c=a.getContext("2d"),e=b.color,d=[],f=0;f<e.values.length;++f)d.push({ratio:e.values[f],color:"rgba("+Math.floor(255*e.colors[4*f+0])+", "+Math.floor(255*e.colors[4*f+1])+", "+Math.floor(255*e.colors[4*f+2])+", "+e.colors[4*f+3]+")"});e=c.createLinearGradient(0,0,0,512);for(f=0;f<d.length;f++){var k=d[f];e.addColorStop(k.ratio,k.color)}c.fillStyle=e;c.fillRect(0,0,1,512);this._gradientTex.setData(a);b.color.refreshColorRamp=
!1}},e}()})},"esri/views/2d/layers/support/GraphicsView2D":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Collection ../../../../core/HandleRegistry ../../../../core/promiseUtils ../../../../Graphic ../../../layers/GraphicsView ../../engine/graphics/GFXSurface ../../engine/graphics/GFXGroup ../../engine/graphics/GFXObject".split(" "),function(m,l,h,d,b,g,k,f,a,
e,c,q,t){return function(e){function l(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var d=e.apply(this,a)||this;return d._frontGroup=new q,d._handles=new k,d._objects=new Map,d.container=new c,d.container.addChild(d._frontGroup),d.watch("graphics",function(){return d._reset()},!0),d}return h(l,e),l.prototype.hitTest=function(a,b){if(!this.view||!this.view.position)return null;a+=this.view.position[0]-window.pageXOffset;b+=this.view.position[1]-window.pageYOffset;return(a=this.container.hitTest(a,
b))?f.resolve(a.graphic):null},l.prototype._reset=function(){var a=this;this._handles.remove("graphics");this._objects.forEach(function(b,c){a._frontGroup.removeChild(b)});this._objects.clear();this.graphics&&(this.graphics.forEach(this._add,this),this._handles.add(this.graphics.on("change",function(b){return a._graphicsChangeHandler(b)}),"graphics"))},l.prototype._add=function(a){if(!this._objects.has(a)){var b=new t;b.graphic=a;b.renderingInfo={symbol:a.symbol};this._objects.set(a,b);this._frontGroup.addChild(b)}},
l.prototype._remove=function(a){var b=this._objects.get(a);b&&(this._objects["delete"](a),this._frontGroup.removeChild(b))},l.prototype._graphicsChangeHandler=function(a){for(var b=a.removed,c=0,e=a.added;c<e.length;c++)a=e[c],this._add(a);for(c=0;c<b.length;c++)a=b[c],this._remove(a)},d([b.cast(g.ofType(a))],l.prototype,"graphics",void 0),d([b.property()],l.prototype,"view",void 0),l=d([b.subclass("esri.views.2d.layers.support.GraphicsView2D")],l)}(b.declared(e))})},"esri/views/layers/GraphicsView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Collection ../../Graphic".split(" "),
function(m,l,h,d,b,g,k,f){return function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;return b.graphics=null,b.renderer=null,b.view=null,b}return h(e,a),d([b.property({type:k.ofType(f)})],e.prototype,"graphics",void 0),d([b.property()],e.prototype,"renderer",void 0),d([b.property()],e.prototype,"view",void 0),e=d([b.subclass("esri.views.layers.GraphicsView")],e)}(b.declared(g))})},"esri/views/2d/engine/graphics/GFXSurface":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../libs/gl-matrix/mat2d ../../libs/gl-matrix/common ../../libs/gfx ../../viewpointUtils ../Container ./Projector ../cssUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){var q=b.identity(b.create());return function(a){function l(){var c=null!==a&&a.apply(this,arguments)||this;return c._transform=b.create(),c._projector=new e,c._prevStateId=null,c}return h(l,a),l.prototype.createElement=function(){var a=document.createElement("div");return a.setAttribute("class","esri-display-object"),a},l.prototype.setElement=function(a){this.surface&&(this.surface.destroy(),this.surface=null);(this.element=a)&&(this.surface=k.createSurface(this.element,
400,400))},l.prototype.doRender=function(e){var d=this.element.style;if(!this.visible)return void(d.display="none");d.display="block";d.opacity=""+e.opacity;var k=this._transform,h=e.state,n=this._prevStateId!==h.id;if(this.renderRequested||n){if(e.stationary)n&&(this._prevStateId=h.id),f.getMatrix(k,h.center,h.size,h.resolution,g.toRadian(h.rotation),1),this.surface.setDimensions(h.size[0],h.size[1]),this._projector.update(k,h.resolution),this.children.forEach(function(a){a.g&&a.g.setTransform(q)}),
a.prototype.doRender.call(this,e);else{var l=b.invert(b.create(),k);b.multiply(l,h.transform,l);this.children.forEach(function(a){a.g&&a.g.setTransform(l)})}c.clip(d,h.clipRect);d.transform=c.cssMatrix3d(b.fromRotation(b.create(),g.toRadian(h.rotation)));this.surface.rawNode.style.transform=c.cssMatrix(b.fromRotation(b.create(),g.toRadian(-h.rotation)))}},l.prototype.hitTest=function(a,b){if(!this.attached)return null;var c=this.surface.rawNode,c=c.parentElement||c.parentNode;c.style.zIndex="9000";
a=document.elementFromPoint(a,b);return(a=(c.style.zIndex="",a))&&a.gfxObject||null},l.prototype.prepareChildrenRenderParameters=function(a){return d({},a,{projector:this._projector,surface:this.surface})},l.prototype.beforeRenderChildren=function(a,b){this.surface.openBatch()},l.prototype.attachChild=function(a,b){return a.attach(b)},l.prototype.detachChild=function(a,b){return a.detach()},l.prototype.renderChild=function(a,b){return a.processRender(b)},l.prototype.afterRenderChildren=function(a,
b){this.surface.closeBatch()},l}(a)})},"esri/views/2d/libs/gfx":function(){define("require exports ./gfx/svg ./gfx/Circle ./gfx/Group ./gfx/Path ./gfx/Image ./gfx/Rect ./gfx/Shape ./gfx/Surface ./gfx/Text".split(" "),function(m,l,h,d,b,g,k,f,a,e,c){Object.defineProperty(l,"__esModule",{value:!0});l.createSurface=h.createSurface;l.Circle=d["default"];l.Group=b["default"];l.Path=g["default"];l.Image=k["default"];l.Rect=f["default"];l.Shape=a["default"];l.Surface=e["default"];l.Text=c["default"]})},
"esri/views/2d/libs/gfx/svg":function(){define(["require","exports","dojo/dom","./Surface"],function(m,l,h,d){function b(b,d){return document.createElementNS?document.createElementNS(b,d):document.createElement(d)}Object.defineProperty(l,"__esModule",{value:!0});l.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};l.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,
1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};l._createElementNS=b;l._setAttributeNS=function(b,d,f,a){return b.setAttributeNS?b.setAttributeNS(d,f,a):b.setAttribute(f,a)};l._createTextNode=function(b){return document.createTextNode(b)};l._createFragment=function(){return document.createDocumentFragment()};l.getRef=function(b){return b&&"none"!==b?b.match(/^url\(#.+\)$/)?h.byId(b.slice(5,-1)):b.match(/^#dojoUnique\d+$/)?h.byId(b.slice(1)):null:null};l.createSurface=function(g,k,f){var a=
new d["default"];a.rawNode=b(l.xmlns.svg,"svg");a.rawNode.setAttribute("overflow","hidden");k&&a.rawNode.setAttribute("width",0>k?0:k);f&&a.rawNode.setAttribute("height",0>f?0:f);k=b(l.xmlns.svg,"defs");return a.rawNode.appendChild(k),a.defNode=k,a._parent=h.byId(g),a._parent.appendChild(a.rawNode),a}})},"esri/views/2d/libs/gfx/Surface":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/has dojo/_base/array dojo/dom-construct dojox/gfx/_base ./svg ./Container ./Circle ./Group ./Path ./Image ./Rect ./Text".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){Object.defineProperty(l,"__esModule",{value:!0});var v=navigator.userAgent,x=534<function(){var a=/WebKit\/(\d*)/.exec(v);return a?parseInt(a[1],10):0}();m=function(a){function n(){var b=null!==a&&a.apply(this,arguments)||this;return b.rawNode=null,b._parent=null,b._nodes=[],b._events=[],b}return h(n,a),n.prototype.destroy=function(){if(b.forEach(this._nodes,g.destroy),this._nodes=[],b.forEach(this._events,function(a){a&&a.remove()}),this._events=[],this.rawNode=
null,d("ie"))for(;this._parent.lastChild;)g.destroy(this._parent.lastChild);else this._parent.innerHTML="";this.defNode=this._parent=null},n.prototype.setDimensions=function(a,b){if(!this.rawNode)return this;a=0>a?0:a;b=0>b?0:b;return this.rawNode.setAttribute("width",a),this.rawNode.setAttribute("height",b),x&&(this.rawNode.style.width=a,this.rawNode.style.height=b),this},n.prototype.getDimensions=function(){return this.rawNode?{width:k.normalizedLength(this.rawNode.getAttribute("width")),height:k.normalizedLength(this.rawNode.getAttribute("height"))}:
null},n.prototype.getEventSource=function(){return this.rawNode},n.prototype._getRealMatrix=function(){return null},n.prototype.createShape=function(a){switch(a.type){case k.defaultPath.type:return this.createPath(a);case k.defaultRect.type:return this.createRect(a);case k.defaultCircle.type:return this.createCircle(a);case k.defaultImage.type:return this.createImage(a);case k.defaultText.type:return this.createText(a)}return console.error("[gfx] unknown shape",a),null},n.prototype.createGroup=function(){return this.createObject(c["default"])},
n.prototype.createRect=function(a){return this.createObject(r["default"],a)},n.prototype.createCircle=function(a){return this.createObject(e["default"],a)},n.prototype.createImage=function(a){return this.createObject(t["default"],a)},n.prototype.createText=function(a){return this.createObject(u["default"],a)},n.prototype.createPath=function(a){return this.createObject(q["default"],a)},n.prototype.createObject=function(a,b){if(!this.rawNode)return null;var c=new a;a=f._createElementNS(f.xmlns.svg,
a.nodeType);return c.setRawNode(a),c.setShape(b),this.add(c),c},n}(a["default"]);l["default"]=m})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),function(m,l,h,d,b,g,k,f,a){var e=l.getObject("dojox.gfx",!0),c=e._base={};e._hasClass=function(a,b){return(a=a.getAttribute("className"))&&0<=(" "+a+" ").indexOf(" "+b+" ")};e._addClass=function(a,b){var c=
a.getAttribute("className")||"";(!c||0>(" "+c+" ").indexOf(" "+b+" "))&&a.setAttribute("className",c+(c?" ":"")+b)};e._removeClass=function(a,b){var c=a.getAttribute("className");c&&a.setAttribute("className",c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};c._getFontMeasurements=function(){var a={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c,e;d("ie")&&(e=b.doc.documentElement.style.fontSize||"",e||(b.doc.documentElement.style.fontSize=
"100%"));var g=f.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},b.body());for(c in a)g.style.fontSize=c,a[c]=16*Math.round(12*g.offsetHeight/16)/12/1E3;d("ie")&&(b.doc.documentElement.style.fontSize=e);b.body().removeChild(g);return a};var q=null;c._getCachedFontMeasurements=function(a){if(a||!q)q=c._getFontMeasurements();return q};var t=null,r={};c._getTextBox=function(c,
e,d){var g,k,h=arguments.length,l;t||(t=f.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},b.body()));g=t;g.className="";k=g.style;k.borderWidth="0";k.margin="0";k.padding="0";k.outline="0";if(1<h&&e)for(l in e)l in r||(k[l]=e[l]);2<h&&d&&(g.className=d);g.innerHTML=c;g.getBoundingClientRect?(k=g.getBoundingClientRect(),k={l:k.left,t:k.top,w:k.width||k.right-k.left,h:k.height||k.bottom-k.top}):k=a.getMarginBox(g);g.innerHTML="";return k};c._computeTextLocation=
function(a,b,c,e){var d={};switch(a.align){case "end":d.x=a.x-b;break;case "middle":d.x=a.x-b/2;break;default:d.x=a.x}d.y=a.y-c*(e?.75:1);return d};c._computeTextBoundingBox=function(a){if(!e._base._isRendered(a))return{x:0,y:0,width:0,height:0};var b;b=a.getShape();var d=a.getFont()||e.defaultFont;a=a.getTextWidth();d=e.normalizedLength(d.size);b=c._computeTextLocation(b,a,d,!0);return{x:b.x,y:b.y,width:a,height:d}};c._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==
a};var u=0;c._getUniqueId=function(){var a;do a=m._scopeName+"xUnique"+ ++u;while(k.byId(a));return a};c._fixMsTouchAction=function(a){a.rawNode.style.touchAction="none"};l.mixin(e,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,
y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},
{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(b){var c=a[b];if(c)return new c;c=a[b]=new Function;c.prototype=e["default"+b];return new c}}(),normalizeColor:function(a){return a instanceof h?a:new h(a)},normalizeParameters:function(a,b){var c;if(b){var e={};for(c in a)c in b&&!(c in e)&&(a[c]=b[c])}return a},
makeParameters:function(a,b){var c=null;if(!b)return l.delegate(a);var e={};for(c in a)c in e||(e[c]=l.clone(c in b?b[c]:a[c]));return e},formatNumber:function(a,b){var c=a.toString();if(0<=c.indexOf("e"))c=a.toFixed(4);else{var e=c.indexOf(".");0<=e&&5<c.length-e&&(c=a.toFixed(4))}return 0>a?c:b?" "+c:c},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var b=e.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=a[0];
b.variant=a[1];b.weight=a[2];var c=a[3].indexOf("/");b.size=0>c?a[3]:a[3].substring(0,c);var d=4;0>c&&("/"==a[4]?d=6:"/"==a[4].charAt(0)&&(d=5));d<a.length&&(b.family=a.slice(d).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return e._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*e.px_in_pt()},px2pt:function(a){return a/e.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var b=e.px_in_pt(),c=parseFloat(a);switch(a.slice(-2)){case "px":return c;
case "pt":return c*b;case "in":return 72*c*b;case "pc":return 12*c*b;case "mm":return c*e.mm_in_pt*b;case "cm":return c*e.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,b){return a&&b&&a===b},switchTo:function(a){var b="string"==typeof a?e[a]:a;b&&(g.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),
function(a){e[a]=b[a]}),"string"==typeof a?e.renderer=a:g.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return e.renderer=e[a]&&e[a].Surface===e.Surface?a:null}))}});return e})},"esri/views/2d/libs/gfx/Container":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojox/gfx/matrix ./Shape ./svg".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function f(){var a=null!==b&&b.apply(this,arguments)||this;
return a.children=[],a._batch=0,a}return h(f,b),f.prototype.openBatch=function(){return this._batch||(this.fragment=g._createFragment()),++this._batch,this},f.prototype.closeBatch=function(){return this._batch=0<this._batch?--this._batch:0,this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),this.fragment=null),this},f.prototype.add=function(a){if(this===a.getParent())return this;this.fragment?this.fragment.appendChild(a.rawNode):this.rawNode.appendChild(a.rawNode);var b=a.getParent();
return b&&b.remove(a,!0),this.children.push(a),a._setParent(this,this._getRealMatrix()),this},f.prototype.remove=function(a,b){if(void 0===b&&(b=!1),this!==a.getParent())return this;this.rawNode===a.rawNode.parentNode&&this.rawNode.removeChild(a.rawNode);this.fragment&&this.fragment===a.rawNode.parentNode&&this.fragment.removeChild(a.rawNode);for(var c=0;c<this.children.length;++c)if(this.children[c]===a){b||(a.parent=null,a.parentMatrix=null);this.children.splice(c,1);break}return this},f.prototype.clear=
function(a){void 0===a&&(a=!1);for(var b=this.rawNode;b.lastChild;)b.removeChild(b.lastChild);var c=this.defNode;if(c){for(;c.lastChild;)c.removeChild(c.lastChild);b.appendChild(c)}for(c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();return this.children=[],this},f.prototype.getBoundingBox=function(){if(!this.children)return null;var a=null;return this.children.forEach(function(b){var c=b.getBoundingBox();c&&((b=b.getTransform())&&(c=d.multiplyRectangle(b,
c)),a?(a.x=Math.min(a.x,c.x),a.y=Math.min(a.y,c.y),a.endX=Math.max(a.endX,c.x+c.width),a.endY=Math.max(a.endY,c.y+c.height)):a={x:c.x,y:c.y,endX:c.x+c.width,endY:c.y+c.height,width:0,height:0})}),a&&(a.width=a.endX-a.x,a.height=a.endY-a.y),a},f.prototype._moveChildToFront=function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]===a){this.children.splice(b,1);this.children.push(a);break}return this},f.prototype._moveChildToBack=function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]===
a){this.children.splice(b,1);this.children.unshift(a);break}return this},f}(b["default"]);l["default"]=m})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(m,l){var h=m.matrix={},d={};h._degToRad=function(b){return d[b]||(d[b]=Math.PI*b/180)};h._radToDeg=function(b){return b/Math.PI*180};h.Matrix2D=function(b){if(b)if("number"==typeof b)this.xx=this.yy=b;else if(b instanceof Array){if(0<b.length){for(var d=h.normalize(b[0]),k=1;k<b.length;++k){var f=d,a=h.normalize(b[k]),
d=new h.Matrix2D;d.xx=f.xx*a.xx+f.xy*a.yx;d.xy=f.xx*a.xy+f.xy*a.yy;d.yx=f.yx*a.xx+f.yy*a.yx;d.yy=f.yx*a.xy+f.yy*a.yy;d.dx=f.xx*a.dx+f.xy*a.dy+f.dx;d.dy=f.yx*a.dx+f.yy*a.dy+f.dy}l.mixin(this,d)}}else l.mixin(this,b)};l.extend(h.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});l.mixin(h,{identity:new h.Matrix2D,flipX:new h.Matrix2D({xx:-1}),flipY:new h.Matrix2D({yy:-1}),flipXY:new h.Matrix2D({xx:-1,yy:-1}),translate:function(b,d){return 1<arguments.length?new h.Matrix2D({dx:b,dy:d}):new h.Matrix2D({dx:b.x,
dy:b.y})},scale:function(b,d){return 1<arguments.length?new h.Matrix2D({xx:b,yy:d}):"number"==typeof b?new h.Matrix2D({xx:b,yy:b}):new h.Matrix2D({xx:b.x,yy:b.y})},rotate:function(b){var d=Math.cos(b);b=Math.sin(b);return new h.Matrix2D({xx:d,xy:-b,yx:b,yy:d})},rotateg:function(b){return h.rotate(h._degToRad(b))},skewX:function(b){return new h.Matrix2D({xy:Math.tan(b)})},skewXg:function(b){return h.skewX(h._degToRad(b))},skewY:function(b){return new h.Matrix2D({yx:Math.tan(b)})},skewYg:function(b){return h.skewY(h._degToRad(b))},
reflect:function(b,d){1==arguments.length&&(d=b.y,b=b.x);var g=b*b,f=d*d,a=g+f,e=2*b*d/a;return new h.Matrix2D({xx:2*g/a-1,xy:e,yx:e,yy:2*f/a-1})},project:function(b,d){1==arguments.length&&(d=b.y,b=b.x);var g=b*b,f=d*d,a=g+f,e=b*d/a;return new h.Matrix2D({xx:g/a,xy:e,yx:e,yy:f/a})},normalize:function(b){return b instanceof h.Matrix2D?b:new h.Matrix2D(b)},isIdentity:function(b){return 1==b.xx&&0==b.xy&&0==b.yx&&1==b.yy&&0==b.dx&&0==b.dy},clone:function(b){var d=new h.Matrix2D,k;for(k in b)"number"==
typeof b[k]&&"number"==typeof d[k]&&d[k]!=b[k]&&(d[k]=b[k]);return d},invert:function(b){b=h.normalize(b);var d=b.xx*b.yy-b.xy*b.yx;return b=new h.Matrix2D({xx:b.yy/d,xy:-b.xy/d,yx:-b.yx/d,yy:b.xx/d,dx:(b.xy*b.dy-b.yy*b.dx)/d,dy:(b.yx*b.dx-b.xx*b.dy)/d})},_multiplyPoint:function(b,d,k){return{x:b.xx*d+b.xy*k+b.dx,y:b.yx*d+b.yy*k+b.dy}},multiplyPoint:function(b,d,k){b=h.normalize(b);return"number"==typeof d&&"number"==typeof k?h._multiplyPoint(b,d,k):h._multiplyPoint(b,d.x,d.y)},multiplyRectangle:function(b,
d){var g=h.normalize(b);d=d||{x:0,y:0,width:0,height:0};if(h.isIdentity(g))return{x:d.x,y:d.y,width:d.width,height:d.height};b=h.multiplyPoint(g,d.x,d.y);var f=h.multiplyPoint(g,d.x,d.y+d.height),a=h.multiplyPoint(g,d.x+d.width,d.y);d=h.multiplyPoint(g,d.x+d.width,d.y+d.height);var g=Math.min(b.x,f.x,a.x,d.x),e=Math.min(b.y,f.y,a.y,d.y);return{x:g,y:e,width:Math.max(b.x,f.x,a.x,d.x)-g,height:Math.max(b.y,f.y,a.y,d.y)-e}},multiply:function(b){for(var d=h.normalize(b),k=1;k<arguments.length;++k){var f=
d,a=h.normalize(arguments[k]),d=new h.Matrix2D;d.xx=f.xx*a.xx+f.xy*a.yx;d.xy=f.xx*a.xy+f.xy*a.yy;d.yx=f.yx*a.xx+f.yy*a.yx;d.yy=f.yx*a.xy+f.yy*a.yy;d.dx=f.xx*a.dx+f.xy*a.dy+f.dx;d.dy=f.yx*a.dx+f.yy*a.dy+f.dy}return d},_sandwich:function(b,d,k){return h.multiply(h.translate(d,k),b,h.translate(-d,-k))},scaleAt:function(b,d,k,f){switch(arguments.length){case 4:return h._sandwich(h.scale(b,d),k,f);case 3:return"number"==typeof k?h._sandwich(h.scale(b),d,k):h._sandwich(h.scale(b,d),k.x,k.y)}return h._sandwich(h.scale(b),
d.x,d.y)},rotateAt:function(b,d,k){return 2<arguments.length?h._sandwich(h.rotate(b),d,k):h._sandwich(h.rotate(b),d.x,d.y)},rotategAt:function(b,d,k){return 2<arguments.length?h._sandwich(h.rotateg(b),d,k):h._sandwich(h.rotateg(b),d.x,d.y)},skewXAt:function(b,d,k){return 2<arguments.length?h._sandwich(h.skewX(b),d,k):h._sandwich(h.skewX(b),d.x,d.y)},skewXgAt:function(b,d,k){return 2<arguments.length?h._sandwich(h.skewXg(b),d,k):h._sandwich(h.skewXg(b),d.x,d.y)},skewYAt:function(b,d,k){return 2<arguments.length?
h._sandwich(h.skewY(b),d,k):h._sandwich(h.skewY(b),d.x,d.y)},skewYgAt:function(b,d,k){return 2<arguments.length?h._sandwich(h.skewYg(b),d,k):h._sandwich(h.skewYg(b),d.x,d.y)}});m.Matrix2D=h.Matrix2D;return h})},"esri/views/2d/libs/gfx/Shape":function(){define("require exports dojox/gfx/_base dojo/_base/lang dojo/_base/Color dojo/dom dojo/dom-attr ./svg ./Surface ../gl-matrix/mat2d".split(" "),function(m,l,h,d,b,g,k,f,a,e){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function c(){this.parentMatrix=
this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null}return c.prototype.destroy=function(){if(this.fillStyle&&"type"in this.fillStyle){var a=this.rawNode.getAttribute("fill");(a=f.getRef(a))&&a.parentNode.removeChild(a)}this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},c.prototype.getNode=function(){return this.rawNode},c.prototype.getShape=function(){return this.shape},c.prototype.getTransform=function(){return this.matrix},
c.prototype.getFill=function(){return this.fillStyle},c.prototype.getStroke=function(){return this.strokeStyle},c.prototype.getParent=function(){return this.parent},c.prototype.getBoundingBox=function(){return this.bbox},c.prototype.setTransform=function(a){return this.matrix=this.matrix?e.copy(this.matrix,a):e.clone(a),this._applyTransform()},c.prototype.setFill=function(a){if(!a)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;
var b;if("object"==typeof a&&"type"in a){switch(a.type){case "linear":b=h.makeParameters(h.defaultLinearGradient,a);a=this._setFillObject(b,"linearGradient");a.setAttribute("x1",b.x1.toFixed(8));a.setAttribute("y1",b.y1.toFixed(8));a.setAttribute("x2",b.x2.toFixed(8));a.setAttribute("y2",b.y2.toFixed(8));break;case "radial":b=h.makeParameters(h.defaultRadialGradient,a);a=this._setFillObject(b,"radialGradient");a.setAttribute("cx",b.cx.toFixed(8));a.setAttribute("cy",b.cy.toFixed(8));a.setAttribute("r",
b.r.toFixed(8));break;case "pattern":b=h.makeParameters(h.defaultPattern,a),a=this._setFillObject(b,"pattern"),a.setAttribute("x",b.x.toFixed(8)),a.setAttribute("y",b.y.toFixed(8)),a.setAttribute("width",b.width.toFixed(8)),a.setAttribute("height",b.height.toFixed(8))}return this.fillStyle=b,this}return b=h.normalizeColor(a),this.fillStyle=b,this.rawNode.setAttribute("fill",b.toCss()),this.rawNode.setAttribute("fill-opacity",b.a),this.rawNode.setAttribute("fill-rule","evenodd"),this},c.prototype.setStroke=
function(a){var c=this.rawNode;if(!a)return this.strokeStyle=null,c.setAttribute("stroke","none"),c.setAttribute("stroke-opacity",0),this;("string"==typeof a||d.isArray(a)||a instanceof b)&&(a={color:a});a=this.strokeStyle=h.makeParameters(h.defaultStroke,a);if(a.color=h.normalizeColor(a.color),a){var e=0>a.width?0:a.width;c.setAttribute("stroke",a.color.toCss());c.setAttribute("stroke-opacity",a.color.a);c.setAttribute("stroke-width",e);c.setAttribute("stroke-linecap",a.cap);"number"==typeof a.join?
(c.setAttribute("stroke-linejoin","miter"),c.setAttribute("stroke-miterlimit",a.join)):c.setAttribute("stroke-linejoin",a.join);var g=a.style.toLowerCase();if(g in f.dasharray&&(g=f.dasharray[g]),g instanceof Array){for(var g=d._toArray(g),k=0;k<g.length;++k)g[k]*=e;if("butt"!==a.cap){for(k=0;k<g.length;k+=2)g[k]-=e,1>g[k]&&(g[k]=1);for(k=1;k<g.length;k+=2)g[k]+=e}g=g.join(",")}c.setAttribute("stroke-dasharray",g);c.setAttribute("dojoGfxStrokeStyle",a.style)}return this},c.prototype._getParentSurface=
function(){for(var b=this.parent;b&&!(b instanceof a["default"]);b=b.parent);return b},c.prototype._setFillObject=function(a,b){var c=f.xmlns.svg;this.fillStyle=a;var e=this._getParentSurface().defNode,d=this.rawNode.getAttribute("fill"),g=f.getRef(d);if(g)if(d=g,d.tagName.toLowerCase()!==b.toLowerCase())g=d.id,d.parentNode.removeChild(d),d=f._createElementNS(c,b),d.setAttribute("id",g),e.appendChild(d);else for(;d.childNodes.length;)d.removeChild(d.lastChild);else d=f._createElementNS(c,b),d.setAttribute("id",
h._base._getUniqueId()),e.appendChild(d);if("pattern"===b)d.setAttribute("patternUnits","userSpaceOnUse"),c=f._createElementNS(c,"image"),c.setAttribute("x",0),c.setAttribute("y",0),c.setAttribute("width",(0>a.width?0:a.width).toFixed(8)),c.setAttribute("height",(0>a.height?0:a.height).toFixed(8)),f._setAttributeNS(c,f.xmlns.xlink,"xlink:href",a.src),d.appendChild(c);else for(d.setAttribute("gradientUnits","userSpaceOnUse"),b=0;b<a.colors.length;++b){var e=a.colors[b],g=f._createElementNS(c,"stop"),
k=e.color=h.normalizeColor(e.color);g.setAttribute("offset",e.offset.toFixed(8));g.setAttribute("stop-color",k.toCss());g.setAttribute("stop-opacity",k.a);d.appendChild(g)}return this.rawNode.setAttribute("fill","url(#"+d.getAttribute("id")+")"),this.rawNode.removeAttribute("fill-opacity"),this.rawNode.setAttribute("fill-rule","evenodd"),d},c.prototype._applyTransform=function(){var a=this.matrix;return a?this.rawNode.setAttribute("transform","matrix("+a[0].toFixed(8)+","+a[1].toFixed(8)+","+a[2].toFixed(8)+
","+a[3].toFixed(8)+","+a[4].toFixed(8)+","+a[5].toFixed(8)+")"):this.rawNode.removeAttribute("transform"),this},c.prototype.setRawNode=function(a){a=this.rawNode=a;"image"!==this.shape.type&&a.setAttribute("fill","none");a.setAttribute("fill-opacity",0);a.setAttribute("stroke","none");a.setAttribute("stroke-opacity",0);a.setAttribute("stroke-width",1);a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-linejoin","miter");a.setAttribute("stroke-miterlimit",4);a.__gfxObject__=this},c.prototype.setShape=
function(a){this.shape=h.makeParameters(this.shape,a);for(var b in this.shape)"type"!==b&&(a=this.shape[b],"width"!==b&&"height"!==b||(a=0>a?0:a),this.rawNode.setAttribute(b,a));return this.bbox=null,this},c.prototype._moveToFront=function(){return this.rawNode.parentNode.appendChild(this.rawNode),this},c.prototype._moveToBack=function(){return this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild),this},c.prototype._removeClipNode=function(){var a,b=k.get(this.rawNode,
"clip-path");return b&&(a=g.byId(b.match(/gfx_clip[\d]+/)[0]),a&&a.parentNode.removeChild(a)),a},c.prototype.moveToFront=function(){var a=this.getParent();return a&&(a._moveChildToFront(this),this._moveToFront()),this},c.prototype.moveToBack=function(){var a=this.getParent();return a&&(a._moveChildToBack(this),this._moveToBack()),this},c.prototype.removeShape=function(a){return this.parent&&this.parent.remove(this,a),this},c.prototype._setParent=function(a,b){return this.parent=a,this._updateParentMatrix(b)},
c.prototype._updateParentMatrix=function(a){return this.parentMatrix=a?e.clone(a):null,this._applyTransform()},c.prototype._getRealMatrix=function(){for(var a=e.clone(this.matrix||e.create()),b=this.parent;b;)b.matrix&&a&&e.multiply(a,b.matrix,a),b=b.parent;return a},c}();l["default"]=m})},"esri/views/2d/libs/gfx/Circle":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","./Shape","dojox/gfx/_base"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});
m=function(d){function g(f){var a=d.call(this)||this;return a.shape=b.getDefault("Circle"),a.rawNode=f,a}return h(g,d),g.prototype.getBoundingBox=function(){if(!this.bbox){var b=this.shape;this.bbox={x:b.cx-b.r,y:b.cy-b.r,width:2*b.r,height:2*b.r}}return this.bbox},g.nodeType="circle",g}(d["default"]);l["default"]=m})},"esri/views/2d/libs/gfx/Group":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./Container dojox/gfx/_base ./svg ./Circle ./Path ./Image ./Rect ./Text".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){Object.defineProperty(l,"__esModule",{value:!0});m=function(d){function l(){return null!==d&&d.apply(this,arguments)||this}return h(l,d),l.prototype.setRawNode=function(a){this.rawNode=a;this.rawNode.__gfxObject__=this},l.prototype.destroy=function(){d.prototype.clear.call(this,!0);d.prototype.destroy.call(this)},l.prototype.createShape=function(a){switch(a.type){case b.defaultPath.type:return this.createPath(a);case b.defaultRect.type:return this.createRect(a);case b.defaultCircle.type:return this.createCircle(a);
case b.defaultImage.type:return this.createImage(a);case b.defaultText.type:return this.createText(a)}return console.error("[gfx] unknown shape",a),null},l.prototype.createGroup=function(){return this.createObject(l)},l.prototype.createRect=function(a){return this.createObject(e["default"],a)},l.prototype.createCircle=function(a){return this.createObject(k["default"],a)},l.prototype.createImage=function(b){return this.createObject(a["default"],b)},l.prototype.createText=function(a){return this.createObject(c["default"],
a)},l.prototype.createPath=function(a){return this.createObject(f["default"],a)},l.prototype.createObject=function(a,b){if(!this.rawNode)return null;var c=new a;a=g._createElementNS(g.xmlns.svg,a.nodeType);return c.setRawNode(a),c.setShape(b),this.add(c),c},l.nodeType="g",l}(d["default"]);l["default"]=m})},"esri/views/2d/libs/gfx/Path":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang dojox/gfx/_base dojox/gfx/matrix ./Shape".split(" "),function(m,l,h,d,b,
g,k){Object.defineProperty(l,"__esModule",{value:!0});m=function(f){function a(a){var c=f.call(this)||this;return c.segments=[],c.tbbox=null,c.absolute=!0,c.last={},c.segmented=!1,c._validSegments={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},c._2PI=2*Math.PI,c.rawNode=a,c.shape=d.clone(b.defaultPath),c}return h(a,f),a.prototype.setAbsoluteMode=function(a){return this._confirmSegmented(),this.absolute="string"==typeof a?"absolute"===a:a,this},a.prototype.getAbsoluteMode=function(){return this._confirmSegmented(),
this.absolute},a.prototype.getBoundingBox=function(){return this._confirmSegmented(),this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},a.prototype._getRealBBox=function(){if(this._confirmSegmented(),this.tbbox)return this.tbbox;var a=this.bbox,b=this._getRealMatrix();this.bbox=null;for(var d=this.segments.length,f=0;d>f;++f)this._updateWithSegment(this.segments[f],b);b=this.bbox;return this.bbox=a,this.tbbox=b?[{x:b.l,y:b.t},
{x:b.r,y:b.t},{x:b.r,y:b.b},{x:b.l,y:b.b}]:null,this.tbbox},a.prototype.getLastPosition=function(){return this._confirmSegmented(),"x"in this.last?this.last:null},a.prototype._applyTransform=function(){return this.tbbox=null,f.prototype._applyTransform.call(this),this},a.prototype._updateBBox=function(a,b,d){d&&(b=g.multiplyPoint(d,a,b),a=b.x,b=b.y);this.bbox&&"l"in this.bbox?(this.bbox.l>a&&(this.bbox.l=a),this.bbox.r<a&&(this.bbox.r=a),this.bbox.t>b&&(this.bbox.t=b),this.bbox.b<b&&(this.bbox.b=
b)):this.bbox={l:a,b:b,r:a,t:b}},a.prototype._updateWithSegment=function(a,c){var e,d=a.args,f=d.length;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(e=0;f>e;e+=2)this._updateBBox(d[e],d[e+1],c);this.last.x=d[f-2];this.last.y=d[f-1];this.absolute=!0;break;case "H":for(e=0;f>e;++e)this._updateBBox(d[e],this.last.y,c);this.last.x=d[f-1];this.absolute=!0;break;case "V":for(e=0;f>e;++e)this._updateBBox(this.last.x,d[e],c);this.last.y=d[f-1];this.absolute=!0;break;case "m":e=
0;"x"in this.last||(this._updateBBox(this.last.x=d[0],this.last.y=d[1],c),e=2);for(;f>e;e+=2)this._updateBBox(this.last.x+=d[e],this.last.y+=d[e+1],c);this.absolute=!1;break;case "l":case "t":for(e=0;f>e;e+=2)this._updateBBox(this.last.x+=d[e],this.last.y+=d[e+1],c);this.absolute=!1;break;case "h":for(e=0;f>e;++e)this._updateBBox(this.last.x+=d[e],this.last.y,c);this.absolute=!1;break;case "v":for(e=0;f>e;++e)this._updateBBox(this.last.x,this.last.y+=d[e],c);this.absolute=!1;break;case "c":for(e=
0;f>e;e+=6)this._updateBBox(this.last.x+d[e],this.last.y+d[e+1],c),this._updateBBox(this.last.x+d[e+2],this.last.y+d[e+3],c),this._updateBBox(this.last.x+=d[e+4],this.last.y+=d[e+5],c);this.absolute=!1;break;case "s":case "q":for(e=0;f>e;e+=4)this._updateBBox(this.last.x+d[e],this.last.y+d[e+1],c),this._updateBBox(this.last.x+=d[e+2],this.last.y+=d[e+3],c);this.absolute=!1;break;case "A":for(e=0;f>e;e+=7)this._updateBBox(d[e+5],d[e+6],c);this.last.x=d[f-2];this.last.y=d[f-1];this.absolute=!0;break;
case "a":for(e=0;f>e;e+=7)this._updateBBox(this.last.x+=d[e+5],this.last.y+=d[e+6],c);this.absolute=!1}a=[a.action];for(e=0;f>e;++e)a.push(b.formatNumber(d[e],!0));if("string"==typeof this.shape.path)this.shape.path+=a.join("");else for(e=0,f=a.length;f>e;++e)this.shape.path.push(a[e]);"string"==typeof this.shape.path&&this.rawNode.setAttribute("d",this.shape.path)},a.prototype._pushSegment=function(a,b){this.tbbox=null;var c,e=this._validSegments[a.toLowerCase()];"number"==typeof e&&(e?b.length>=
e&&(c={action:a,args:b.slice(0,b.length-b.length%e)},this.segments.push(c),this._updateWithSegment(c)):(c={action:a,args:[]},this.segments.push(c),this._updateWithSegment(c)))},a.prototype._collectArgs=function(a,b){for(var c=0;c<b.length;++c){var e=b[c];"boolean"==typeof e?a.push(e?1:0):"number"==typeof e?a.push(e):e instanceof Array?this._collectArgs(a,e):"x"in e&&"y"in e&&a.push(e.x,e.y)}},a.prototype._confirmSegmented=function(){if(!this.segmented){var a=this.shape.path;this.shape.path=[];this._setPath(a);
this.shape.path=this.shape.path.join("");this.segmented=!0}},a.prototype._setPath=function(a){a=d.isArray(a)?a:a.match(b.pathSvgRegExp);if(this.segments=[],this.absolute=!0,this.bbox={},this.last={},a){for(var c="",e=[],f=a.length,g=0;f>g;++g){var k=a[g],h=parseFloat(k);isNaN(h)?(c&&this._pushSegment(c,e),e=[],c=k):e.push(h)}this._pushSegment(c,e)}},a.prototype.setShape=function(a){return f.prototype.setShape.call(this,"string"==typeof a?{path:a}:a),this.segmented=!1,this.segments=[],this.shape.path?
this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d"),this},a.nodeType="path",a}(k["default"]);l["default"]=m})},"esri/views/2d/libs/gfx/Image":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojox/gfx/_base ./Shape ./svg".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function f(a){var e=b.call(this)||this;return e.shape=d.getDefault("Image"),e.rawNode=a,e}return h(f,b),f.prototype.setShape=function(a){this.shape=
d.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;for(var b in this.shape)if("type"!==b&&"src"!==b){var c=this.shape[b];"width"!==b&&"height"!==b||(c=0>c?0:c);a.setAttribute(b,c)}return a.setAttribute("preserveAspectRatio","none"),g._setAttributeNS(a,g.xmlns.xlink,"xlink:href",this.shape.src),a.__gfxObject__=this,this},f.prototype.getBoundingBox=function(){return this.shape},f.prototype.setStroke=function(){return this},f.prototype.setFill=function(){return this},f.nodeType="image",f}(b["default"]);
l["default"]=m})},"esri/views/2d/libs/gfx/Rect":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","dojox/gfx/_base","./Shape"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function g(f){var a=b.call(this)||this;return a.shape=d.getDefault("Rect"),a.rawNode=f,a}return h(g,b),g.prototype.getBoundingBox=function(){return this.shape},g.prototype.setShape=function(b){this.shape=d.makeParameters(this.shape,b);this.bbox=null;for(var a in this.shape)"type"!==
a&&"r"!==a&&(b=this.shape[a],"width"!==a&&"height"!==a||(b=0>b?0:b),this.rawNode.setAttribute(a,b));return null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r)),this},g.nodeType="rect",g}(b["default"]);l["default"]=m})},"esri/views/2d/libs/gfx/Text":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/has dojox/gfx/_base ./Shape ./svg".split(" "),function(m,l,h,d,b,g,k){Object.defineProperty(l,"__esModule",{value:!0});
m=d("android");var f=d("chrome")||m&&4<=m?"auto":"optimizeLegibility";d=function(a){function e(c){var e=a.call(this)||this;return e.fontStyle=null,e.shape=b.getDefault("Text"),e.rawNode=c,e}return h(e,a),e.prototype.getFont=function(){return this.fontStyle},e.prototype.setFont=function(a){return this.fontStyle="string"==typeof a?b.splitFontString(a):b.makeParameters(b.defaultFont,a),this._setFont(),this},e.prototype._setFont=function(){var a=this.fontStyle;this.rawNode.setAttribute("font-style",a.style);
this.rawNode.setAttribute("font-weight",a.weight);this.rawNode.setAttribute("font-size",a.size);this.rawNode.setAttribute("font-family",a.family)},e.prototype.setShape=function(a){this.shape=b.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;var c=this.shape;return a.setAttribute("x",c.x),a.setAttribute("y",c.y),a.setAttribute("text-anchor",c.align),a.setAttribute("text-decoration",c.decoration),a.setAttribute("rotate",c.rotated?90:0),a.setAttribute("kerning",c.kerning?"auto":0),a.setAttribute("text-rendering",
f),a.firstChild?a.firstChild.nodeValue=c.text:a.appendChild(k._createTextNode(c.text)),this},e.prototype.getTextWidth=function(){var a=this.rawNode,b=a.parentNode,a=a.cloneNode(!0);a.style.visibility="hidden";var e=0,d=a.firstChild.nodeValue;if(b.appendChild(a),""!==d)for(;!e;)e=a.getBBox?parseInt(a.getBBox().width,10):68;return b.removeChild(a),e},e.prototype.getBoundingBox=function(){var a=null;if(this.getShape().text)try{a=this.rawNode.getBBox()}catch(q){a={x:0,y:0,width:0,height:0}}return a},
e.nodeType="text",e}(g["default"]);l["default"]=d})},"esri/views/2d/engine/graphics/Projector":function(){define(["require","exports"],function(m,l){function h(d,f,a,e,c){void 0===e&&(e=0);void 0===c&&(c=d.length);for(var k,l=d[e],r=d[c-1],u=0,v=0,m=e+1;c-1>m;m++){var y=d[m];k=y[0];var y=y[1],n=l[0],w=l[1],z=r[0],C=r[1];n===z?k=b(k-n):(z=(C-w)/(z-n),k=b(z*k-y+(w-z*n))/g(z*z+1));k>u&&(v=m,u=k)}u>f?(h(d,f,a,e,v+1),h(d,f,a,v,c)):(a(l[0],l[1]),a(r[0],r[1]))}var d=Math.round,b=Math.abs,g=Math.sqrt;return function(){function b(){this._transform=
null}return b.prototype.update=function(b,a){this._transform=b;this._resolution=a},b.prototype.toScreenPoint=function(b,a,e){return this.transformPoint(a.x+e*this._resolution,a.y,function(a,e){b.x=a;b.y=e}),b},b.prototype.toScreenPath=function(b,a){var e=this,c=null!=b.paths;b=c?b.paths:b.rings;var d="",f=function(b,c){b+=a*e._resolution;e.transformPoint(b,c,function(a,b){isNaN(a)||isNaN(b)||(d+=a,d+=",",d+=b,d+=" ")})};if(b)for(var g=b.length,k=0;g>k;k++)d+="M ",h(b[k],this._resolution,f),c||(d+=
"Z ");return d},b.prototype.transformPoint=function(b,a,e){var c=this._transform,f=c[1],g=c[3],k=c[5];e(d(c[0]*b+c[2]*a+c[4]),d(f*b+g*a+k))},b}()})},"esri/views/2d/engine/cssUtils":function(){define(["require","exports","dojo/has"],function(m,l,h){function d(a){return"matrix3d(\n                    "+a[0].toFixed(10)+", "+a[1].toFixed(10)+", 0, 0,\n                    "+a[2].toFixed(10)+", "+a[3].toFixed(10)+", 0, 0,\n                    0, 0, 1, 0,\n                    "+Math.round(a[4]).toFixed(10)+
", "+Math.round(a[5]).toFixed(10)+", 0, 1\n                  )"}function b(a){return"translate("+Math.round(a[0])+"px, "+Math.round(a[1])+"px)"}function g(a){return"rotateZ( "+a+" deg)"}Object.defineProperty(l,"__esModule",{value:!0});m=h("ff");var k=h("ie"),f=h("webkit");h=h("opera");var a=f&&"-webkit-transform"||m&&"-moz-transform"||h&&"-o-transform"||k&&"-ms-transform"||"transform";l.clip=function(a,b){b?a.clip="rect( "+b.top+"px, "+b.right+"px, "+b.bottom+"px, "+b.left+"px)":a.clip=""};l.setTransform=
function(e,c){var f=null;2===c.length&&(f=b(c));6===c.length&&(f=d(c));e.transform=e[a]=f};l.setOrigin=function(a,b){a.transformOrigin=b[0]+"px "+b[1]+"px 0"};l.cssMatrix=function(a){return"matrix(\n                  "+a[0].toFixed(10)+", "+a[1].toFixed(10)+",\n                  "+a[2].toFixed(10)+", "+a[3].toFixed(10)+",\n                  "+a[4]+", "+a[5]+"\n                )"};l.cssMatrix3d=d;l.translate=b;l.rotate=function(a){return g(a.toFixed(3))};l.rotateZ=g})},"esri/views/2d/engine/graphics/GFXGroup":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","dojo/_base/lang","../Container"],function(m,l,h,d,b){return function(b){function g(){return null!==b&&b.apply(this,arguments)||this}return h(g,b),g.prototype.attach=function(d){return this.g=d.surface.createGroup(),b.prototype.attach.call(this,d)},g.prototype.detach=function(d){b.prototype.detach.call(this,d);this.g.destroy();this.g=null},g.prototype.prepareChildrenRenderParameters=function(b){return d.mixin({},b,{surface:this.g})},g.prototype.detachChild=
function(b,a){return b.detach(a)},g.prototype.attachChild=function(b,a){return b.attach(a)},g.prototype.renderChild=function(b,a){return b.processRender(a)},g}(b)})},"esri/views/2d/engine/graphics/GFXObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../geometry ../../../../geometry/support/webMercatorUtils ../../../../geometry/support/spatialReferenceUtils ../DisplayObject ./gfxUtils".split(" "),function(m,l,h,d,b,g,k,f){var a=new Set,e=[];return function(c){function k(){var a=
null!==c&&c.apply(this,arguments)||this;return a._prevStateId=null,a.visible=!0,a}return h(k,c),Object.defineProperty(k.prototype,"graphic",{get:function(){return this._graphic},set:function(a){this._geometry=(this._graphic=a)&&a.geometry||null;this._projected=null;this.requestRender()},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"geometry",{get:function(){return this._geometry},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"isPolygonMarkerSymbol",{get:function(){var a=
this.renderingInfo.symbol.type,b=this.geometry;return b&&"polygon"===b.type&&("simple-marker"===a||"picture-marker"===a||"text"===a)},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"renderingInfo",{get:function(){return this._renderingInfo},set:function(a){this._renderingInfo=a;this.requestRender()},enumerable:!0,configurable:!0}),k.prototype.detach=function(){this._removeShape();this._drawInfo=this._projected=null},k.prototype.doRender=function(a){var b=a.surface,c=a.state,e=a.projector,
d=this._prevStateId!==c.id;if(this.renderRequested||d){d&&a.stationary&&(this._prevStateId=c.id);d=this.visible&&this._projectGeometry(this.geometry,a.state.spatialReference);a=this._getScreenOffsets([],a.state);if(f.isShapeInvalid(this.renderingInfo.symbol,this._shape)&&this._removeShape(),!a.length)return void this._removeShape();var g=this._shape,k=d.type;(!g||this._showRedraw(a,c))&&("point"===k?(g=f.drawPoint(e,b,d,g,this.renderingInfo,c.rotation,a),f.stylePoint(g,this.renderingInfo)):"multipoint"===
k?(g=f.drawMarkers(e,b,d,g,this.renderingInfo,c.rotation,a),f.styleMarkers(g,this.renderingInfo)):(g=f.drawShape(e,b,d,g,a),f.styleShape(g,this.renderingInfo)),this._shape=g,g.getNode().gfxObject=this)}},k.prototype._getScreenOffsets=function(b,c){var d=c.clippedExtent,f=this._projected.outExtent,k=c.spatialReference;if(b.length=0,!f)return b;if(k.isWrappable){var k=g.getInfo(k),h=f.cache._partwise,d=d._getParts(k);if(e.length=0,h&&h.length)for(f=0;f<h.length;f++)e.push.apply(e,h[f]._getParts(k));
else e.push.apply(e,f._getParts(k));c=c.worldScreenWidth;b.length=0;a.clear();f=e.length;for(k=0;f>k;k++)for(var n=e[k],h=n.extent,n=n.frameIds,l=n.length,q=d.length,r=0;q>r;r++){var t=d[r];if(t.extent.intersects(h))for(var m=l,G=0;m>G;G++){var N=(t.frameIds[0]-n[G])*c;a.has(N)||(b.push(N),a.add(N))}}b.sort()}else d.intersects(f)&&b.push(0);return b},k.prototype._projectGeometry=function(a,c){var e=this._projected;a=this.isPolygonMarkerSymbol?a.centroid:a;return e&&e.inGeometry===a&&e.outSpatialReference===
c?e.outGeometry:a&&a.spatialReference.equals(c)?(this._projected={inGeometry:a,outGeometry:a,outSpatialReference:c,outExtent:this._getExtent(a)},this._projected.outGeometry):b.canProject(a,c)?(this._projected={inGeometry:a,outGeometry:b.project(a,c),outSpatialReference:c,outExtent:this._getExtent(a)},this._projected.outGeometry):(this._projected={inGeometry:a,outGeometry:null,outSpatialReference:c,outExtent:null},this._projected.outGeometry)},k.prototype._getExtent=function(a){var b=a.extent;if(!b){var c=
b=void 0;"esri.geometry.Point"===a.declaredClass?(b=a.x,c=a.y):"esri.geometry.Multipoint"===a.declaredClass&&(b=a.points[0][0],c=a.points[0][1]);b=new d.Extent(b,c,b,c,a.spatialReference)}return b},k.prototype._removeShape=function(){var a=this._shape;a&&(a.removeShape(),a.getNode().gfxObject=null,a.destroy());this._shape=this._drawInfo=null},k.prototype._showRedraw=function(a,b){return!0},k}(k)})},"esri/views/2d/engine/graphics/gfxUtils":function(){define("require exports dojo/_base/lang ../../libs/gl-matrix/mat2d ../../libs/gl-matrix/mat2dExtras ../../../../core/screenUtils ../../../../geometry/Polygon ../../../../symbols/SimpleMarkerSymbol ../../../../symbols/support/gfxUtils ../../../../Color".split(" "),
function(m,l,h,d,b,g,k,f,a,e){function c(a,b){return b.toRgba?(a[0]=b.r,a[1]=b.g,a[2]=b.b,a[3]=b.a):(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]),a}function q(a,b,c){return null!=c&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=c),a}function t(a,b,c){var e=b[0]/b[1];return a[0]=a[1]=1,isNaN(c)||(1<e?(a[0]=c/b[0],a[1]=c/e/b[1]):(a[1]=c/b[1],a[0]=c*e/b[0])),a}function r(c,e,k,h,n,l,q){var r,m,z=n.symbol;k=c.toScreenPoint(C,k,q[0]);q=[k.x,k.y];c=k.x;k=k.y;var F=n.heading,G=n.size&&n.size[0];d.identity(B);"number"==
typeof G&&(m=isFinite(G)&&G);m=(G=m&&isFinite(m)&&!isNaN(m))?g.pt2px(m):NaN;l&&b.rotategAt(B,B,l,q);F&&b.rotategAt(B,B,F,q);var p;l=g.pt2px(z.xoffset);F=g.pt2px(z.yoffset);0===l&&0===F||(p=[l,-F]);l=null;0!==z.angle&&(l=d.create(),b.rotategAt(l,l,z.angle,q));var A;if("simple-marker"===z.type)switch(r=z.style,n=Math.round,m=G?m:g.pt2px(z.size),G=void 0,r){case f.STYLE_SQUARE:case f.STYLE_CROSS:case f.STYLE_X:case f.STYLE_DIAMOND:G=isNaN(m)?16:.5*m;r=x(e,h,w(r,c,k,n(c-G),n(c+G),n(k-G),n(k+G)));break;
case f.STYLE_PATH:r=A=x(e,h,z.path);A=A.getBoundingBox();m=t(d.create(),[A.width,A.height],m);1===m[0]&&1===m[3]||b.scaleAt(B,B,m,q);A=[-(A.x+.5*A.width)+c,-(A.y+.5*A.height)+k];break;default:G=isNaN(m)?16:.5*m,r=v(e,h,{cx:c,cy:k,r:G})}else if("picture-marker"===z.type){q=r=null;var F=g.pt2px(z.width),N=g.pt2px(z.height);G?(q=m,r=F/N*q):(r=F,q=N);p&&(null!=p[0]&&(p[0]=p[0]/F*r),null!=p[1]&&(p[1]=p[1]/N*q));r=u(e,h,{x:c-.5*r,y:k-.5*q,width:r,height:q,src:z.url});(m=r.getNode())&&(null!=n.opacity?m.setAttribute("opacity",
n.opacity.toString()):m.setAttribute("opacity","1"))}else"text"===z.type&&((n=z.font&&z.font.clone())&&(n.size=G?m:g.pt2px(n.size)),r=y(e,h,{type:"text",text:z.text,x:c,y:k,align:a.getSVGAlign(z),decoration:z.decoration||n&&n.decoration,rotated:z.rotated,kerning:z.kerning}),n&&r.setFont(n),m=r.getNode(),e=a.getSVGBaseline(z),z=a.getSVGBaselineShift(z),m&&(m.setAttribute("dominant-baseline",e),z&&m.setAttribute("baseline-shift",z)));return p&&d.translate(B,B,p),l&&d.multiply(B,B,l),A&&d.translate(B,
B,A),r.setTransform(B),r}function u(a,b,c){return b?b.setShape(c):a.createImage(c)}function v(a,b,c){return b?b.setShape(c):a.createCircle(c)}function x(a,b,c){c=Array.isArray(c)?c.join(" "):c;return b?b.setShape(c):a.createPath(c)}function y(a,b,c){return b?b.setShape(c):a.createText(c)}function n(a,b){b=b&&b.shape&&b.shape.type;var c=a&&a.type;a=a&&a.style;return c&&(a=F[c]||a),G[a]&&(a="path"),!(!b||!a||b===a)}function w(a,b,c,e,d,g,k,h){switch(a){case f.STYLE_SQUARE:return["M",e+","+g,d+","+g,
d+","+k,e+","+k,"Z"];case f.STYLE_CROSS:return["M",b+","+g,b+","+k,"M",e+","+c,d+","+c];case f.STYLE_X:return["M",e+","+g,d+","+k,"M",e+","+k,d+","+g];case f.STYLE_DIAMOND:return["M",b+","+g,d+","+c,b+","+k,e+","+c,"Z"];case f.STYLE_TARGET:return["M",e+","+g,d+","+g,d+","+k,e+","+k,e+","+g,"M",e-h+","+c,e+","+c,"M",b+","+(g-h),b+","+g,"M",d+h+","+c,d+","+c,"M",b+","+(k+h),b+","+k]}}function z(b,e){var d=e.symbol;if("picture-marker"!==d.type){var g=a.getFill(d);if("simple-marker"===d.type){var k=d.style,
n=(d=a.getStroke(d))&&d.color,k=k===f.STYLE_X||k===f.STYLE_CROSS,l=e.opacity;(e=e.color||c([0,0,0,0],k?n:g))&&null!=l&&(e=q([0,0,0,0],e,l));e&&(k?e!==n&&(d=d?h.mixin({},d):{},d.color=e):e!==g&&(g=e));b.setFill(g).setStroke(d)}else"text"===d.type&&(l=e.opacity,(e=e.color||c([0,0,0,0],g))&&null!=l&&(e=q([0,0,0,0],e,l)),e&&e!==g&&(g=e),b.setFill(g))}}Object.defineProperty(l,"__esModule",{value:!0});l.getScalingVector=t;var C={x:0,y:0},B=d.create();l.drawPoint=r;l.drawMarkers=function(a,b,c,e,d,f,g){var k=
d.symbol;c=c.points;b=e||b.createGroup();e=[0];b.children[0]&&n(k,b.children[0])&&b.clear();for(var h=0,l=c.length,k=0;l>k;k++)for(var q=c[k],t=g.length,p=0;t>p;p++)e[0]=g[p],b.add(r(a,b,{x:q[0],y:q[1]},b.children[h++],d,f,e));a=b.children.length;if(c.length*g.length<a)for(g=c.length*g.length,k=a-1;k>=g;k--)b.children[k].removeShape();return b};l.drawShape=function(a,b,c,e,d){var f=[];if("extent"===c.type&&(c=k.fromExtent(c)),"polyline"===c.type||"polygon"===c.type){for(var g=d.length,h=0;g>h;h++)f=
f.concat(a.toScreenPath(c,d[h]));e=x(b,e,f)}return e};l.drawRect=function(a,b,c){return b?b.setShape(c):a.createRect(c)};l.drawImage=u;l.drawCircle=v;l.drawPath=x;l.drawText=y;var F={"picture-marker":"image","picture-fill":"path","simple-fill":"path","simple-line":"path",text:"text"},G={square:1,cross:1,x:1,diamond:1,target:1};l.isShapeInvalid=n;l.smsToPath=w;l.stylePoint=z;l.styleMarkers=function(a,b){for(var c=a.children.length,e=0;c>e;e++)z(a.children[e],b)};l.styleShape=function(b,d){var f,k=
d.symbol,n=d.size,l=d.color,r=d.opacity,t=d.outlineSize;d=a.getStroke(k);var u=a.getFill(k),w=!1;"simple-line"===k.type?(w=!0,f="none"!==k.style):f=k.outline&&"none"!==k.outline.style;var v,m,p;if(null!=n||null!=t)n=n&&isFinite(n[0])&&n[0],t=w?null:t,null==n&&null==t||(p=g.pt2px(t||n));n="picture-fill"===k.type;!l&&null==r||n||(w?(v=l||d&&d.color&&c([0,0,0,0],d.color),v&&null!=r&&(v=q(v,v,r))):u&&(m=l||c([0,0,0,0],u),m&&null!=r&&(m=q(m,m,r))));!f||null==p&&!v?b.setStroke(d):b.setStroke(h.mixin({},
d,null!=p?{width:p}:null,v&&{color:v}));f=l&&new e(l)||k.color;u&&"pattern"===u.type&&f&&!n?a.getPatternUrlWithColor(u.src,f.toCss(!0)).then(function(a){u.src=a;b.setFill(u)}):b.setFill(m||u);b.rawNode.setAttribute("vector-effect","non-scaling-stroke")}})},"esri/views/2d/libs/gl-matrix/mat2dExtras":function(){define(["require","exports","./mat2d","./vec2","./common"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});var g=function(){var b=h.create(),f=d.create();return function(a,
e,c){return h.fromTranslation(b,c),h.multiply(a,b,e),d.negate(f,c),h.translate(a,a,f),a}}();l.rotategAt=function(){var d=h.create();return function(f,a,e,c){return h.fromRotation(d,b.toRadian(e)),g(d,d,c),h.multiply(f,d,a),f}}();l.scaleAt=function(){var b=h.create();return function(d,a,e,c){return h.fromScaling(b,e),g(b,b,c),h.multiply(d,b,a),d}}()})},"esri/symbols/support/gfxUtils":function(){define("require exports dojo/_base/lang dojox/gfx/_base ../../Color ../../core/screenUtils ../../request ../../core/promiseUtils ../../core/LRUMap".split(" "),
function(m,l,h,d,b,g,k,f,a){function e(a){if(!a)return null;var b,d=a.constructor,f=g.pt2px(a.width);switch(a.type){case q:case c:case r:b=e(a.outline);break;case t:a.style!==d.STYLE_NULL&&0!==f&&(b={color:a.color,style:n(a.style),width:f,cap:a.cap,join:a.join===d.JOIN_MITER?g.pt2px(a.miterLimit):a.join});break;default:b=null}return b}Object.defineProperty(l,"__esModule",{value:!0});var c="picture-fill",q="simple-fill",t="simple-line",r="simple-marker",u=m.toUrl("../../symbols/patterns/"),v={left:"start",
center:"middle",right:"end",justify:"start"},x={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},y=new a(1E3);l.getSVGAlign=function(a){return a=(a=a.horizontalAlignment)&&v[a.toLowerCase()]||"middle"};l.getSVGBaseline=function(a){return(a=a.verticalAlignment)&&x[a.toLowerCase()]||"alphabetic"};l.getSVGBaselineShift=function(a){return"bottom"===a.verticalAlignment?"super":null};l.getFill=function(a){var b=a.style,e=null;if(a){var f=a.constructor;switch(a.type){case r:b!==
f.STYLE_CROSS&&b!==f.STYLE_X&&(e=a.color);break;case q:b===f.STYLE_SOLID?e=a.color:b!==f.STYLE_NULL&&(e=h.mixin({},d.defaultPattern,{src:u+b+".png",width:8,height:8}));break;case c:e=h.mixin({},d.defaultPattern,{src:a.url,width:g.pt2px(a.width)*a.xscale,height:g.pt2px(a.height)*a.yscale,x:g.pt2px(a.xoffset),y:g.pt2px(a.yoffset)});break;case "text":e=a.color}}return e};l.getPatternUrlWithColor=function(a,b){var c=a+"-"+b;return y.has(c)?f.resolve(y.get(c)):k(a,{responseType:"image",allowImageDataAccess:!0}).then(function(a){a=
a.data;var e=a.naturalWidth,d=a.naturalHeight,f=document.createElement("canvas");f.width=e;f.height=d;var g=f.getContext("2d");g.fillStyle=b;g.fillRect(0,0,e,d);g.globalCompositeOperation="destination-in";g.drawImage(a,0,0);a=f.toDataURL();return y.set(c,a),a})};l.getStroke=e;var n=function(){var a={};return function(b){if(a[b])return a[b];var c=b.replace(/-/g,"");return a[b]=c,c}}();l.defaultThematicColor=new b([128,128,128])})},"esri/views/2d/input/MapViewInputManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/watchUtils ../../../core/Accessor ../../../core/HandleRegistry ../../../core/accessorSupport/decorators ../../input/InputManager ../../input/BrowserEventSource ../../input/ViewEvents ../../input/handlers/PreventContextMenu ../input/handlers/DoubleClickZoom ../input/handlers/DragPan ../input/handlers/DragRotate ../input/handlers/KeyPan ../input/handlers/KeyZoom ../input/handlers/KeyRotate ../input/handlers/MouseWheelZoom ../input/handlers/PinchAction".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w){var z={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},C={zoomIn:["\x3d","+"],zoomOut:["-","_"]},B={dragRotate:"Alt",clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"};return function(g){function l(){var a=null!==g&&g.apply(this,arguments)||this;return a._handles=new k,a}return h(l,g),l.prototype.initialize=function(){var a=this;this.viewEvents=new c.ViewEvents(this.view);
this._handles.add([b.whenNot(this.view,"ready",function(){return a._disconnect()}),b.when(this.view,"ready",function(){return a._connect()})])},l.prototype.destroy=function(){this._handles&&(this._handles.removeAll(),this._handles=null);this._disconnect();this.viewEvents.destroy();this.viewEvents=null},l.prototype._disconnect=function(){this._inputManager&&(this.viewEvents.disconnect(),this._source.destroy(),this._inputManager.destroy(),this._source=null,this._inputManager=null)},l.prototype._connect=
function(){var b=new e.BrowserEventSource(this.view.surface),c=new a.InputManager(b);c.installHandlers("prevent-context-menu",[new q.PreventContextMenu]);c.installHandlers("navigation",[new w.PinchRotateAndZoom(this.view),new n.MouseWheelZoom(this.view),new t.DoubleClickZoom(this.view),new r.DragPan(this.view,"primary"),new v.KeyPan(this.view,z),new x.KeyZoom(this.view,C),new y.KeyRotate(this.view,B),new u.DragRotate(this.view,"secondary"),new t.DoubleClickZoom(this.view,["Ctrl"]),new u.DragRotate(this.view,
"primary",[B.dragRotate])]);this.viewEvents.connect(c);this._source=b;this._inputManager=c},d([f.property()],l.prototype,"view",void 0),l=d([f.subclass("esri.views.2d.input.MapViewInputManager")],l)}(f.declared(g))})},"esri/views/input/InputManager":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/now dojo/has ./keys ./recognizers ../../core/Logger ./handlers/LatestPointerType".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){Object.defineProperty(l,"__esModule",{value:!0});var t=c.getLogger("esri.views.input.InputManager");m=function(c){function g(b,e){b=c.call(this)||this;return b._pointerCaptures=new Map,b._nameToGroup={},b._handlers=[],b._currentPropagation=null,b._sourceEvents=new Set,b._keyModifiers=new Set,b._activeKeyModifiers=new Set,b.primaryKey=a.primaryKey,b.latestPointerType="mouse",b._installRecognizers(),b}return h(g,c),g.prototype.normalizeCtorArgs=function(a,b){return this._browserEvents=
a,this._browserEvents.onEventReceived=this._onEventReceived.bind(this),this._recognizers=b,this._recognizers||(this._recognizers=e.defaults.map(function(a){return new a})),{}},g.prototype.destroy=function(){for(var a=0,b=Object.keys(this._nameToGroup);a<b.length;a++)this.uninstallHandlers(b[a])},g.prototype.installHandlers=function(a,b){var c=this;if(this._nameToGroup[a])return void t.error("There is already an InputHandler group registered under the name `"+a+"`");if(0===b.length)return void t.error("Can't register a group of zero handlers");
var e={name:a,handlers:b.map(function(a,b){return{handler:a,active:!0,removed:!1,priorityIndex:0,eventCallback:null,uninstallCallback:null}})};this._nameToGroup[a]=e;a=function(a){var b=e.handlers[a];d._handlers.push(b);b.handler.onInstall({updateDependencies:function(){c.updateDependencies()},emit:function(a,e,d,f){c._emitInputEvent(b.priorityIndex,a,e,d,f)},setPointerCapture:function(a,d){c._setPointerCapture(e,b,a,d)},setEventCallback:function(a){b.eventCallback=a},setUninstallCallback:function(a){b.uninstallCallback=
a}})};var d=this;for(b=e.handlers.length-1;0<=b;b--)a(b);this.updateDependencies()},g.prototype.uninstallHandlers=function(a){var b=this._nameToGroup[a];return b?(b.handlers.forEach(function(a){a.removed=!0;a.uninstallCallback()}),delete this._nameToGroup[a],void(this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers())):void t.error("There is no InputHandler group registered under the name `"+a+"`")},g.prototype.hasHandlers=function(a){return void 0!==
this._nameToGroup[a]},g.prototype.updateDependencies=function(){var b=new Set,c=new Set;this._handlersPriority=[];for(var e=this._handlers.length-1;0<=e;e--){var d=this._handlers[e];d.priorityIndex=e;this._handlersPriority.push(d)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(e=this._handlersPriority.length-1;0<=e;e--){d=this._handlersPriority[e];d.priorityIndex=e;var f=d.handler.hasSideEffects;if(!f)for(var g=0,k=d.handler.outgoingEventTypes;g<k.length;g++)if(b.has(k[g])){f=
!0;break}if(f)for(g=0,k=d.handler.incomingEventMatches;g<k.length;g++){var h=k[g];b.add(h.eventType);for(var l=0,h=h.keyModifiers;l<h.length;l++){var q=h[l];a.isSystemModifier(q)||c.add(q)}}d.active=f}this._sourceEvents=b;this._keyModifiers=c;0<this._pointerCaptures.size&&this._sourceEvents.add("pointer-capture-lost");0<this._keyModifiers.size&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up"));this._browserEvents&&(this._browserEvents.activeEvents=this._sourceEvents)},g.prototype._setLatestPointerType=
function(a){this._set("latestPointerType",a)},g.prototype._onEventReceived=function(a,b){if("pointer-capture-lost"===a)this._pointerCaptures["delete"](b["native"].pointerId);this._updateKeyModifiers(a,b);this._emitInputEventFromSource(a,b,b["native"].timestamp)},g.prototype._updateKeyModifiers=function(a,b){var c=this;if(b){var e=!1,d=function(){if(!e){var a=new Set;c._activeKeyModifiers.forEach(function(b){a.add(b)});c._activeKeyModifiers=a;e=!0}},f=function(a,b){b&&!c._activeKeyModifiers.has(a)?
(d(),c._activeKeyModifiers.add(a)):!b&&c._activeKeyModifiers.has(a)&&(d(),c._activeKeyModifiers["delete"](a))};if("key-down"===a||"key-up"===a){var g=b.key;this._keyModifiers.has(g)&&f(g,"key-down"===a)}a=b["native"];f("Alt",!(!a||!a.altKey));f("Ctrl",!(!a||!a.ctrlKey));f("Shift",!(!a||!a.shiftKey));f("Meta",!(!a||!a.metaKey));f("Primary",this._activeKeyModifiers.has(this.primaryKey))}},g.prototype._installRecognizers=function(){var a=this;this._latestPointerTypeHandler=new q.LatestPointerType(function(b){return a._setLatestPointerType(b)});
0<this._recognizers.length&&this.installHandlers("default",this._recognizers);this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler])},g.prototype.allowPointerCapture=function(a){return 2!==a.button?!0:!(f("mac")&&f("chrome"))},g.prototype._setPointerCapture=function(a,b,c,e){a=a.name+"-"+b.priorityIndex;b=this._pointerCaptures.get(c.pointerId)||new Set;this._pointerCaptures.set(c.pointerId,b);e&&this.allowPointerCapture(c)?(b.add(a),1===b.size&&this._browserEvents&&this._browserEvents.setPointerCapture(c,
!0)):!e&&b.has(a)&&(b["delete"](a),0===b.size&&(this._pointerCaptures["delete"](c.pointerId),this._browserEvents&&this._browserEvents.setPointerCapture(c,!1)))},g.prototype._garbageCollectRemovedHandlers=function(){this._handlers=this._handlers.filter(function(a){return!a.removed});this.updateDependencies()},g.prototype._emitInputEventFromSource=function(a,b,c){this._emitInputEvent(0,a,b,c)},g.prototype._emitInputEvent=function(a,b,c,e,d){e=void 0!==e?e:this._currentPropagation?this._currentPropagation.timestamp:
k();b=new r(b,c,e,d||this._activeKeyModifiers);return this._currentPropagation?void this._currentPropagation.addedEvents.push(b):void this._doNewPropagation(a,b)},g.prototype._doNewPropagation=function(a,b){for(a=this._currentPropagation={events:[b],addedEvents:[],currentHandler:this._handlersPriority[a],needsHandlerGarbageCollect:!1,timestamp:b.timestamp};a.currentHandler;){if(a.currentHandler.removed)a.needsHandlerGarbageCollect=!0;else{b=a.events;var c=[];a.addedEvents=[];for(var e=0;e<b.length;e++){var d=
b[e];a.currentHandler.active&&a.currentHandler.eventCallback(d);d.shouldStopPropagation()||c.push(d)}a.events=c.concat(a.addedEvents)}a.currentHandler=this._handlersPriority[a.currentHandler.priorityIndex+1]}a.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers();this._currentPropagation=null},g.prototype._compareHandlerPriority=function(a,b){if(a.handler.hasSideEffects!==b.handler.hasSideEffects)return a.handler.hasSideEffects?1:-1;for(var c=0,e=a.handler.incomingEventMatches;c<e.length;c++)for(var d=
e[c],f=function(a){if(d.eventType!==a.eventType)return"continue";var b=d.keyModifiers.filter(function(b){return-1!==a.keyModifiers.indexOf(b)});return b.length===d.keyModifiers.length!==(b.length===a.keyModifiers.length)?{value:d.keyModifiers.length>a.keyModifiers.length?-1:1}:void 0},g=0,k=b.handler.incomingEventMatches;g<k.length;g++){var h=f(k[g]);if("object"==typeof h)return h.value}return a.priorityIndex>b.priorityIndex?-1:1},g.prototype._sortHandlersPriority=function(a){for(var b=[],c=0;c<a.length;c++){for(var e=
a[c],d=0;d<b.length&&0<=this._compareHandlerPriority(e,b[d]);)d++;b.splice(d,0,e)}return b},d([b.property({readOnly:!0})],g.prototype,"latestPointerType",void 0),g=d([b.subclass("esri.views.input.InputManager")],g)}(b.declared(g));l.InputManager=m;var r=function(){function a(a,b,c,e){this.type=a;this.data=b;this.timestamp=c;this.modifiers=e;this._stopPropagation=!1}return a.prototype.stopPropagation=function(){this._stopPropagation=!0},a.prototype.shouldStopPropagation=function(){return this._stopPropagation},
a}()})},"esri/views/input/keys":function(){define(["require","exports","../../core/sniff"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.primaryKey=h("mac")?"Meta":"Ctrl";var d={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(m=48;58>m;m++)d[m]=String.fromCharCode(m);for(m=1;25>m;m++)d[111+m]="F"+m;for(m=65;91>m;m++)d[m]=[String.fromCharCode(m+32),
String.fromCharCode(m)];var b={Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Esc:"Escape"};l.eventKey=function(g){if(void 0!==g.key)return b[g.key]||g.key;var k=d[g.keyCode];return Array.isArray(k)?g.shiftKey?k[1]:k[0]:k};l.isSystemModifier=function(b){switch(b){case "Ctrl":case "Alt":case "Shift":case "Meta":case "Primary":return!0}}})},"esri/views/input/recognizers":function(){define("require exports ./recognizers/Drag ./recognizers/PointerClickHoldAndDrag ./recognizers/SingleAndDoubleClick ./recognizers/VerticalTwoFingerDrag".split(" "),
function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});l.defaults=[d.PointerClickHoldAndDrag,b.SingleAndDoubleClick,h.Drag,g.VerticalTwoFingerDrag]})},"esri/views/input/recognizers/Drag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler","./support"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(d){function g(){var b=d.call(this,!1)||this;return b._startStateModifiers=new Set,b._activePointers=[],b._activePointerMap=
new Map,b._isDragging=!1,b._drag=b.registerOutgoing("drag"),b.registerIncoming("pointer-drag",b._handlePointerDrag.bind(b)),b.registerIncoming("pointer-down",b._handlePointerDown.bind(b)),b.registerIncoming("pointer-up",b._handlePointerUpAndPointerLost.bind(b)),b.registerIncoming("pointer-capture-lost",b._handlePointerUpAndPointerLost.bind(b)),b}return h(g,d),g.prototype._createPayload=function(b,a){return{action:b,pointers:this._activePointers.map(function(a){return a.data}),startState:this._startState,
previousState:this._previousState,currentState:a}},g.prototype._fitCircleLSQ=function(){var d=this._activePointers.map(function(a){return a.data.currentEvent});return b.fitCircleLSQ(d)},g.prototype._createDragState=function(b){for(var a=this._fitCircleLSQ(),e=0,c=0,d=this._activePointers;c<d.length;c++){for(var f=d[c],g=this._pointerAngle(f,a),g=g-f.lastAngle;g>Math.PI;)g-=2*Math.PI;for(;g<-Math.PI;)g+=2*Math.PI;g=f.lastAngle+g;f.lastAngle=g;e+=g-f.initialAngle}return e/=this._activePointers.length,
{angle:e,radius:a.radius,center:a.center,timestamp:b}},g.prototype._updateMultiPointer=function(b,a){var e=b.startEvent["native"].pointerId,c=this._activePointerMap.get(e),d=!c;d?(c={data:null,initialAngle:0,lastAngle:0},this._activePointers.push(c),this._activePointerMap.set(e,c),c.data={startEvent:b.startEvent,previousEvent:b.previousEvent,currentEvent:b.currentEvent},b=this._fitCircleLSQ(),c.initialAngle=this._pointerAngle(c,b),c.lastAngle=c.initialAngle):c.data={startEvent:c.data.startEvent,previousEvent:b.previousEvent,
currentEvent:b.currentEvent};return d&&this._isDragging&&this._updateInitialAngles(a),c},g.prototype._pointerAngle=function(b,a){b=b.data.currentEvent;return Math.atan2(b.y-a.center.y,b.x-a.center.x)},g.prototype._updateInitialAngles=function(b){b=this._createDragState(b);for(var a=0,e=this._activePointers;a<e.length;a++){var c=e[a];c.initialAngle=this._pointerAngle(c,b)}},g.prototype._emitStart=function(b){this._updateInitialAngles(b.timestamp);var a=this._createDragState(b.timestamp);this._previousState=
this._startState=a;this._startStateModifiers=b.modifiers;this._isDragging=!0;for(var e=0,c=this._activePointers;e<c.length;e++){var d=c[e];d.data={previousEvent:d.data.currentEvent,startEvent:d.data.currentEvent,currentEvent:d.data.currentEvent}}this._drag.emit(this._createPayload("start",a),b.timestamp)},g.prototype._emitUpdate=function(b){b=this._createDragState(b.timestamp);this._drag.emit(this._createPayload("update",b),void 0,this._startStateModifiers);this._previousState=b},g.prototype._emitEnd=
function(b){b=this._createDragState(b);this._drag.emit(this._createPayload("end",b),void 0,this._startStateModifiers);this._startState=this._previousState=null;this._isDragging=!1},g.prototype._handlePointerDown=function(b){var a=b.data;this._isDragging&&this._emitEnd(b.timestamp);this._updateMultiPointer({startEvent:a,previousEvent:a,currentEvent:a},b.timestamp)},g.prototype._removeMultiPointer=function(b,a){var e=this,c=b["native"].pointerId,d=this._activePointerMap.get(c);if(d){var f=function(){e._activePointerMap["delete"](c);
var b=e._activePointers.indexOf(d);e._activePointers.splice(b,1);e._isDragging&&e._updateInitialAngles(a)};this._isDragging?(this._updateMultiPointer({startEvent:d.data.startEvent,previousEvent:d.data.currentEvent,currentEvent:b},a),this._emitEnd(a),f()):f()}},g.prototype._handlePointerUpAndPointerLost=function(b){this._removeMultiPointer(b.data,b.timestamp)},g.prototype._handlePointerDrag=function(b){var a=b.data;switch(a.action){case "start":this._isDragging||this._emitStart(b);break;case "update":this._isDragging||
this._emitStart(b),this._updateMultiPointer(a,b.timestamp),this._emitUpdate(b)}},g}(d.InputHandler);l.Drag=m})},"esri/views/input/InputHandler":function(){define(["require","exports","./EventMatch","../../core/Logger"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});var b=d.getLogger("esri.views.input.InputHandler");m=function(){function d(a){this._manager=null;this._incoming={};this._outgoing={};this._outgoingEventTypes=this._incomingEventTypes=this._incomingEventMatches=null;
this._hasSideEffects=a}return Object.defineProperty(d.prototype,"incomingEventMatches",{get:function(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(var a in this._incoming)for(var b=0,c=this._incoming[a];b<c.length;b++)this._incomingEventMatches.push(c[b].match)}return this._incomingEventMatches},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"incomingEventTypes",{get:function(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(function(a){return a.eventType})),
this._incomingEventTypes},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"outgoingEventTypes",{get:function(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"hasSideEffects",{get:function(){return this._hasSideEffects},enumerable:!0,configurable:!0}),d.prototype.onInstall=function(a){var e=this;return this._manager?void b.error("This InputHandler has already been registered with an InputManager"):
(a.setEventCallback(function(a){return e._handleEvent(a)}),a.setUninstallCallback(function(){return e._onUninstall()}),void(this._manager=a))},d.prototype.onUninstall=function(){},d.prototype.registerIncoming=function(a,b,c){var e,d=this;"function"==typeof b?(c=b,e=[]):e=b||[];a="string"==typeof a?new h.EventMatch(a,e):a;var f=function(){d._incomingEventTypes=null;d._incomingEventMatches=null};b=function(a){var b=d._incoming[a.match.eventType];b&&(a=b.indexOf(a),b.splice(a,1),f(),d._manager&&d._manager.updateDependencies())};
c=new g(a,c,{onPause:b,onRemove:b,onResume:function(a){var b=d._incoming[a.match.eventType];b&&-1===b.indexOf(a)&&(b.push(a),f(),d._manager&&d._manager.updateDependencies())}});b=this._incoming[a.eventType];return b||(b=[],this._incoming[a.eventType]=b),b.push(c),f(),this._manager&&this._manager.updateDependencies(),c},d.prototype.registerOutgoing=function(a){var b=this;if(this._outgoing[a])throw Error("There is already a callback registered for this outgoing InputEvent: "+a);var c=new k(a,{onEmit:function(a,
c,e,d){b._manager.emit(a.eventType,c,e,d)},onRemove:function(a){delete b._outgoing[a.eventType];b._manager.updateDependencies()}});return this._outgoing[a]=c,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),c},d.prototype.startCapturingPointer=function(a){this._manager.setPointerCapture(a,!0)},d.prototype.stopCapturingPointer=function(a){this._manager.setPointerCapture(a,!1)},d.prototype._onUninstall=function(){return this._manager?(this.onUninstall(),void(this._manager=
null)):void b.error("This InputHandler is not registered with an InputManager")},d.prototype._handleEvent=function(a){var b=this._incoming[a.type];if(b)for(var c=0;c<b.length;c++){var d=b[c];if(d.match.matches(a)&&(d.callback(a),a.shouldStopPropagation()))break}},d}();l.InputHandler=m;var g=function(){function b(a,b,c){this.match=a;this._callback=b;this._handler=c}return b.prototype.pause=function(){this._handler.onPause(this)},b.prototype.resume=function(){this._handler.onResume(this)},b.prototype.remove=
function(){this._handler.onRemove(this)},Object.defineProperty(b.prototype,"callback",{get:function(){return this._callback},enumerable:!0,configurable:!0}),b}(),k=function(){function b(a,b){this.eventType=a;this._removed=!1;this._handler=b}return b.prototype.emit=function(a,b,c){this._removed||this._handler.onEmit(this,a,b,c)},b.prototype.remove=function(){this._removed=!0;this._handler.onRemove(this)},b}()})},"esri/views/input/EventMatch":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,
"__esModule",{value:!0});m=function(){function h(d,b){void 0===b&&(b=[]);this.eventType=d;this.keyModifiers=b}return h.prototype.matches=function(d){if(d.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;d=d.modifiers;for(var b=0,g=this.keyModifiers;b<g.length;b++)if(!d.has(g[b]))return!1;return!0},h}();l.EventMatch=m})},"esri/views/input/recognizers/support":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.manhattanDistance=
function(h,d){return Math.abs(d.x-h.x)+Math.abs(d.y-h.y)};l.euclideanDistance=function(h,d){var b=d.x-h.x;h=d.y-h.y;return Math.sqrt(b*b+h*h)};l.fitCircleLSQ=function(h,d){if(d?(d.radius=0,d.center.x=0,d.center.y=0):d={radius:0,center:{x:0,y:0}},0===h.length)return d;if(1===h.length)return d.center.x=h[0].x,d.center.y=h[0].y,d;if(2===h.length){var b=h[0];h=h[1];var g=[h.x-b.x,h.y-b.y],k=g[0],g=g[1];return d.radius=Math.sqrt(k*k+g*g)/2,d.center.x=(b.x+h.x)/2,d.center.y=(b.y+h.y)/2,d}for(var f=0,a=
0,e=0;e<h.length;e++)f+=h[e].x,a+=h[e].y;for(var f=f/h.length,a=a/h.length,c=h.map(function(a){return a.x-f}),l=h.map(function(b){return b.y-a}),t=b=d=0,r=0,u=k=0,e=g=0;e<c.length;e++){var v=c[e],m=l[e],y=v*v,n=m*m;d+=y;b+=n;t+=v*m;r+=y*v;k+=n*m;u+=v*n;g+=m*y}e=d;c=t;l=b;r=.5*(r+u);k=.5*(k+g);g=e*l-t*c;u=(r*l-k*c)/g;k=(e*k-t*r)/g;return{radius:Math.sqrt(u*u+k*k+(d+b)/h.length),center:{x:u+f,y:k+a}}}})},"esri/views/input/recognizers/PointerClickHoldAndDrag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper",
"../InputHandler","./support"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});l.DefaultParameters={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilTouchDrag:6,holdDelay:500};m=function(d){function g(b,a,e,c){void 0===b&&(b=l.DefaultParameters.maximumClickDelay);void 0===a&&(a=l.DefaultParameters.movementUntilMouseDrag);void 0===e&&(e=l.DefaultParameters.movementUntilTouchDrag);void 0===c&&(c=l.DefaultParameters.holdDelay);var f=d.call(this,!1)||this;return f.maximumClickDelay=
b,f.movementUntilMouseDrag=a,f.movementUntilTouchDrag=e,f.holdDelay=c,f._pointerState=new Map,f._modifiers=new Set,f._pointerDrag=f.registerOutgoing("pointer-drag"),f._pointerClick=f.registerOutgoing("pointer-click"),f._pointerHold=f.registerOutgoing("hold"),f.registerIncoming("pointer-down",f._handlePointerDown.bind(f)),f.registerIncoming("pointer-up",f._handlePointerUpOrLost.bind(f)),f.registerIncoming("pointer-capture-lost",f._handlePointerUpOrLost.bind(f)),f._moveHandle=f.registerIncoming("pointer-move",
f._handlePointerMove.bind(f)),f._moveHandle.pause(),f}return h(g,d),g.prototype.onUninstall=function(){this._pointerState.forEach(function(b){0!==b.holdTimeout&&(clearTimeout(b.holdTimeout),b.holdTimeout=0)});d.prototype.onUninstall.call(this)},g.prototype._handlePointerDown=function(b){var a=this,e=b.data,c=e["native"].pointerId,d=0;0===this._pointerState.size&&(d=setTimeout(function(){var e=a._pointerState.get(c);e&&(e.isDragging||(a._pointerHold.emit(e.previousEvent,void 0,b.modifiers),e.holdEmitted=
!0),e.holdTimeout=0)},this.holdDelay));1===this._pointerState.size&&this._pointerState.forEach(function(a){0!==a.holdTimeout&&(clearTimeout(a.holdTimeout),a.holdTimeout=0)});this._pointerState.set(c,{startEvent:e,previousEvent:e,startTimestamp:b.timestamp,isDragging:!1,downButton:e["native"].button,holdTimeout:d});this.startCapturingPointer(e["native"]);this._moveHandle.resume()},g.prototype._createPointerDragData=function(b,a,e){return{action:b,startEvent:a.startEvent,previousEvent:a.previousEvent,
currentEvent:e}},g.prototype._handlePointerMove=function(d){var a=d.data,e=this._pointerState.get(a["native"].pointerId);e&&(e.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",e,a),void 0,this._modifiers):b.euclideanDistance(a,e.startEvent)>("touch"===a["native"].pointerType?this.movementUntilTouchDrag:this.movementUntilMouseDrag)&&(e.isDragging=!0,e.previousEvent=e.startEvent,this._modifiers=d.modifiers,0!==e.holdTimeout&&clearTimeout(e.holdTimeout),this._pointerDrag.emit(this._createPointerDragData("start",
e,e.startEvent),e.startTimestamp),this._pointerDrag.emit(this._createPointerDragData("update",e,a))),e.previousEvent=a)},g.prototype._handlePointerUpOrLost=function(b){var a=b.data,e=a["native"].pointerId,c=this._pointerState.get(e);c&&((0!==c.holdTimeout&&clearTimeout(c.holdTimeout),c.isDragging)?this._pointerDrag.emit(this._createPointerDragData("end",c,a),void 0,this._modifiers):c.downButton===a["native"].button&&b.timestamp-c.startTimestamp<=this.maximumClickDelay&&!c.holdEmitted&&this._pointerClick.emit(a),
this._pointerState["delete"](e),this.stopCapturingPointer(a["native"]),0===this._pointerState.size&&this._moveHandle.pause())},g}(d.InputHandler);l.PointerClickHoldAndDrag=m})},"esri/views/input/recognizers/SingleAndDoubleClick":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler","./support"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});l.DefaultParameters={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,
maximumDoubleTouchDistance:35};m=function(d){function g(b,a,e,c){void 0===b&&(b=l.DefaultParameters.maximumDoubleClickDelay);void 0===a&&(a=l.DefaultParameters.maximumDoubleClickDistance);void 0===e&&(e=l.DefaultParameters.maximumDoubleTouchDelay);void 0===c&&(c=l.DefaultParameters.maximumDoubleTouchDistance);var f=d.call(this,!1)||this;return f.maximumDoubleClickDelay=b,f.maximumDoubleClickDistance=a,f.maximumDoubleTouchDelay=e,f.maximumDoubleTouchDistance=c,f._pointerState=new Map,f._click=f.registerOutgoing("click"),
f._doubleClick=f.registerOutgoing("double-click"),f._firstClick=f.registerOutgoing("first-click"),f.registerIncoming("pointer-click",f._handlePointerClick.bind(f)),f}return h(g,d),g.prototype.onUninstall=function(){this._pointerState.forEach(function(b){0!==b.doubleClickTimeout&&(clearTimeout(b.doubleClickTimeout),b.doubleClickTimeout=0)})},g.prototype._pointerId=function(b){b=b["native"];return"mouse"===b.pointerType?b.pointerId+":"+b.button:""+b.pointerType},g.prototype._handlePointerClick=function(d){var a=
d.data,e=this._pointerId(a),c=this._pointerState.get(e);if(c){clearTimeout(c.doubleClickTimeout);c.doubleClickTimeout=0;var f="touch"===a["native"].pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;b.manhattanDistance(c.event.data,a)>f?(this._doubleClickTimeoutExceeded(e),this._startClick(d)):(this._doubleClick.emit(a,void 0,c.event.modifiers),this._pointerState["delete"](e))}else this._startClick(d)},g.prototype._startClick=function(b){var a=this,e=b.data,c=this._pointerId(b.data);
this._pointerState.set(c,{event:b,doubleClickTimeout:setTimeout(function(){return a._doubleClickTimeoutExceeded(c)},"touch"===e["native"].pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)});this._firstClick.emit(b.data,void 0,b.modifiers)},g.prototype._doubleClickTimeoutExceeded=function(b){var a=this._pointerState.get(b);this._click.emit(a.event.data,void 0,a.event.modifiers);a.doubleClickTimeout=0;this._pointerState["delete"](b)},g}(d.InputHandler);l.SingleAndDoubleClick=m})},
"esri/views/input/recognizers/VerticalTwoFingerDrag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d,f){void 0===d&&(d=20);void 0===f&&(f=40);var a=b.call(this,!1)||this;return a._threshold=d,a._maxDelta=f,a._failed=!1,a._active=!1,a._vertical=a.registerOutgoing("vertical-two-finger-drag"),a._artificalDragEnd=a.registerOutgoing("drag"),a.registerIncoming("drag",
a._handleDrag.bind(a)),a}return h(d,b),Object.defineProperty(d.prototype,"failed",{get:function(){return this._failed},enumerable:!0,configurable:!0}),d.prototype._handleDrag=function(b){if(2===b.data.pointers.length)switch(b.data.action){case "start":this._handleDragStart(b);break;case "update":this._handleDragUpdate(b);break;case "end":this._handleDragEnd(b)}},d.prototype._handleDragStart=function(b){this._failed=!1},d.prototype._handleDragUpdate=function(b){this._failed||(this._active?(this._vertical.emit({delta:b.data.currentState.center.y-
this._thresholdReachedCenter.y,action:"update"}),b.stopPropagation()):(this._failed=!this._checkDeltaConstraint(b.data),this._failed||this._checkThresholdReached(b.data)&&(this._active=!0,this._thresholdReachedCenter=b.data.currentState.center,this._artificalDragEnd.emit({action:"end",currentState:b.data.currentState,previousState:b.data.previousState,startState:b.data.startState,pointers:b.data.pointers}),this._vertical.emit({delta:b.data.currentState.center.y-this._thresholdReachedCenter.y,action:"begin"}),
b.stopPropagation())))},d.prototype._handleDragEnd=function(b){this._active&&(this._vertical.emit({delta:b.data.currentState.center.y-this._thresholdReachedCenter.y,action:"end"}),b.stopPropagation());this._active=!1},d.prototype._checkDeltaConstraint=function(b){var d=Math.abs(b.pointers[0].startEvent.x-b.pointers[1].startEvent.x),a=Math.abs(b.pointers[0].startEvent.y-b.pointers[1].startEvent.y),e=Math.abs(b.pointers[0].currentEvent.y-b.pointers[1].currentEvent.y),c=Math.abs(b.pointers[0].currentEvent.x-
b.pointers[1].currentEvent.x);return Math.abs(b.currentState.center.x-b.startState.center.x)<this._threshold&&Math.abs(c-d)<=this._maxDelta&&Math.abs(e-a)<=this._maxDelta},d.prototype._checkThresholdReached=function(b){return Math.min(Math.abs(b.pointers[0].currentEvent.y-b.pointers[0].startEvent.y),Math.abs(b.pointers[1].currentEvent.y-b.pointers[1].startEvent.y),Math.abs(b.currentState.center.y-b.startState.center.y))>=this._threshold},d}(d.InputHandler);l.VerticalTwoFingerDrag=m})},"esri/views/input/handlers/LatestPointerType":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d){var f=b.call(this,!0)||this;return f._onChange=d,f._value="mouse",f.registerIncoming("pointer-down",function(a){f._setValue("touch"===a.data["native"].pointerType?"touch":"mouse")}),f._moveHandler=f.registerIncoming("pointer-move",function(a){f._setValue("touch"===a.data["native"].pointerType?"touch":"mouse")}),f._moveHandler.pause(),f}
return h(d,b),d.prototype._setValue=function(b){b!==this._value&&("touch"===b?this._moveHandler.resume():this._moveHandler.pause(),this._value=b,this._onChange(b))},d}(d.InputHandler);l.LatestPointerType=m})},"esri/views/input/BrowserEventSource":function(){define(["require","exports","./keys","../../core/libs/pep/pep","dojo/sniff"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});var g=b("trident"),k=b("edge"),f=b("chrome"),a=b("ff"),e=b("safari");m=function(){function b(a){this._active=
{};this._activePointerCaptures=new Set;this._keyDownState=new Set;this._element=a;d.applyLocal(a);a.getAttribute("tabindex")||a.setAttribute("tabindex","0");this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost};
this._initialCssTouchAction=a.style.touchAction;a.style.touchAction="none"}return b.prototype.destroy=function(){var a=this;this.activeEvents=this._callback=null;this._activePointerCaptures.forEach(function(b){a._element.releasePointerCapture(b)});this._activePointerCaptures=null;this._element.style.touchAction=this._initialCssTouchAction},Object.defineProperty(b.prototype,"onEventReceived",{set:function(a){this._callback=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"activeEvents",
{set:function(a){var b=this,e;for(e in this._active)a&&a.has(e)||(this._element.removeEventListener(c[e],this._active[e]),delete this._active[e]);a&&a.forEach(function(a){if(!b._active[a]&&c[a]){var e=(b._eventHandlers[a]||b._handleDefault).bind(b,a);b._element.addEventListener(c[a],e);b._active[a]=e}})},enumerable:!0,configurable:!0}),b.prototype.setPointerCapture=function(a,b){b?(this._element.setPointerCapture(a.pointerId),this._activePointerCaptures.add(a.pointerId)):(this._element.releasePointerCapture(a.pointerId),
this._activePointerCaptures["delete"](a.pointerId))},b.prototype._updateNormalizedPointerLikeEvent=function(a,b){var c=this._element.getBoundingClientRect();return b.x=a.clientX-Math.round(c.left),b.y=a.clientY-Math.round(c.top),b},b.prototype._handleKey=function(a,b){var c=h.eventKey(b);c&&"key-up"===a&&this._keyDownState["delete"](c);b={"native":b,key:c,repeat:c&&this._keyDownState.has(c)};c&&"key-down"===a&&this._keyDownState.add(b.key);this._callback(a,b)},b.prototype._handlePointer=function(a,
b){b=this._updateNormalizedPointerLikeEvent(b,{"native":b,x:0,y:0});this._callback(a,b)},b.prototype._handlePointerPreventDefault=function(a,b){var c=this._updateNormalizedPointerLikeEvent(b,{"native":b,x:0,y:0});b.preventDefault();this._callback(a,c)},b.prototype._handleMouseWheel=function(b,c){c.preventDefault();var d=c.deltaY;switch(c.deltaMode){case 0:(g||k)&&(d=d/document.documentElement.clientHeight*600);break;case 1:d*=30;break;case 2:d*=900}g||k?d*=.7:f||e?d*=.6:a&&(d*=1.375);var h=Math.abs(d);
100<h&&(d=d/h*200/(1+Math.exp(-.02*(h-100))));c=this._updateNormalizedPointerLikeEvent(c,{"native":c,x:0,y:0,deltaY:d});this._callback(b,c)},b.prototype._handlePointerCaptureLost=function(a,b){this._activePointerCaptures["delete"](b.pointerId);this._handleDefault(a,b)},b.prototype._handleDefault=function(a,b){var c={"native":b};b.preventDefault();this._callback(a,c)},b}();l.BrowserEventSource=m;var c={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove",
"mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave"}})},"esri/core/libs/pep/pep":function(){define([],function(){function m(a,b){b=b||Object.create(null);var d=document.createEvent("Event");d.initEvent(a,b.bubbles||!1,b.cancelable||!1);for(var f=2;f<e.length;f++)a=e[f],d[a]=b[a]||c[f];d.buttons=b.buttons||0;a=0;return a=b.pressure?b.pressure:d.buttons?
.5:0,d.x=d.clientX,d.y=d.clientY,d.pointerId=b.pointerId||0,d.width=b.width||0,d.height=b.height||0,d.pressure=a,d.tiltX=b.tiltX||0,d.tiltY=b.tiltY||0,d.pointerType=b.pointerType||"",d.hwTimestamp=b.hwTimestamp||0,d.isPrimary=b.isPrimary||!1,d}function l(){this.array=[];this.size=0}function h(a,b,c,e){this.addCallback=a.bind(e);this.removeCallback=b.bind(e);this.changedCallback=c.bind(e);B&&(this.observer=new B(this.mutationWatcher.bind(this)))}function d(a){return"body /shadow-deep/ "+b(a)}function b(a){return'[touch-action\x3d"'+
a+'"]'}function g(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; touch-action-delay: none; }"}function k(){if(M){G.forEach(function(a){String(a)===a?(N+=b(a)+g(a)+"\n",R&&(N+=d(a)+g(a)+"\n")):(N+=a.selectors.map(b)+g(a.rule)+"\n",R&&(N+=a.selectors.map(d)+g(a.rule)+"\n"))});var a=document.createElement("style");a.textContent=N;document.head.appendChild(a)}}function f(a){if(!x.pointermap.has(a))throw a=Error("InvalidPointerId"),a.name="InvalidPointerId",a;}function a(a){if(!a.ownerDocument.contains(a))throw a=
Error("InvalidStateError"),a.name="InvalidStateError",a;}var e="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),c=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],q=window.Map&&window.Map.prototype.forEach?Map:l;l.prototype={set:function(a,b){return void 0===b?this["delete"](a):(this.has(a)||this.size++,void(this.array[a]=b))},has:function(a){return void 0!==this.array[a]},"delete":function(a){this.has(a)&&
(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.size=this.array.length=0},forEach:function(a,b){return this.array.forEach(function(c,e){a.call(b,c,e,this)},this)}};var t="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),r=[!1,!1,null,
null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],u={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},v="undefined"!=typeof SVGElementInstance,x={pointermap:new q,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b.events;c&&(c.forEach(function(a){b[a]&&(this.eventMap[a]=b[a].bind(b))},this),this.eventSources[a]=b,this.eventSourceList.push(b))},register:function(a){for(var b,
c=this.eventSourceList.length,e=0;c>e&&(b=this.eventSourceList[e]);e++)b.register.call(b,a)},unregister:function(a){for(var b,c=this.eventSourceList.length,e=0;c>e&&(b=this.eventSourceList[e]);e++)b.unregister.call(b,a)},contains:function(a,b){try{return a.contains(b)}catch(ca){return!1}},down:function(a){a.bubbles=!0;this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0;this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0;this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=
!1;this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1;this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0;this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0;this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0;this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a);this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a);this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type;(b=this.eventMap&&
this.eventMap[b])&&b(a);a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(a,b){this.captureInfo[b.pointerId]&&(b.relatedTarget=null);a=new m(a,b);return b.preventDefault&&(a.preventDefault=b.preventDefault),a._target=a._target||b.target,
a},fireEvent:function(a,b){a=this.makeEvent(a,b);return this.dispatchEvent(a)},cloneEvent:function(a){for(var b,c=Object.create(null),e=0;e<t.length;e++)b=t[e],c[b]=a[b]||r[e],!v||"target"!==b&&"relatedTarget"!==b||c[b]instanceof SVGElementInstance&&(c[b]=c[b].correspondingUseElement);return a.preventDefault&&(c.preventDefault=function(){a.preventDefault()}),c},getTarget:function(a){var b=this.captureInfo[a.pointerId];return b?a._target!==b&&a.type in u?void 0:b:a._target},propagate:function(a,b,
c){for(var e=a.target,d=[];!e.contains(a.relatedTarget)&&e!==document;)d.push(e),e=e.parentNode;c&&d.reverse();d.forEach(function(c){a.target=c;b.call(this,a)},this)},setCapture:function(a,b){this.captureInfo[a]&&this.releaseCapture(a);this.captureInfo[a]=b;var c=new m("gotpointercapture");c.pointerId=a;this.implicitRelease=this.releaseCapture.bind(this,a);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);c._target=b;this.asyncDispatchEvent(c)},
releaseCapture:function(a){var b=this.captureInfo[a];if(b){var c=new m("lostpointercapture");c.pointerId=a;this.captureInfo[a]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);c._target=b;this.asyncDispatchEvent(c)}},dispatchEvent:function(a){var b=this.getTarget(a);return b?b.dispatchEvent(a):void 0},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};x.boundHandler=x.eventHandler.bind(x);
var y={shadow:function(a){return a?a.shadowRoot||a.webkitShadowRoot:void 0},canTarget:function(a){return a&&!!a.elementFromPoint},targetingShadow:function(a){a=this.shadow(a);return this.canTarget(a)?a:void 0},olderShadow:function(a){var b=a.olderShadowRoot;b||(a=a.querySelector("shadow"))&&(b=a.olderShadowRoot);return b},allShadows:function(a){var b=[];for(a=this.shadow(a);a;)b.push(a),a=this.olderShadow(a);return b},searchRoot:function(a,b,c){if(a){var e,d=a.elementFromPoint(b,c);for(e=this.targetingShadow(d);e;){if(a=
e.elementFromPoint(b,c))return e=this.targetingShadow(a),this.searchRoot(e,b,c)||a;e=this.olderShadow(e)}return d}},owner:function(a){for(;a.parentNode;)a=a.parentNode;return a.nodeType!==Node.DOCUMENT_NODE&&a.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(a=document),a},findTarget:function(a){var b=a.clientX,c=a.clientY;a=this.owner(a.target);return a.elementFromPoint(b,c)||(a=document),this.searchRoot(a,b,c)}},n=Array.prototype.forEach.call.bind(Array.prototype.forEach),w=Array.prototype.map.call.bind(Array.prototype.map),
z=Array.prototype.slice.call.bind(Array.prototype.slice),C=Array.prototype.filter.call.bind(Array.prototype.filter),B=window.MutationObserver||window.WebKitMutationObserver,F={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};h.prototype={watchSubtree:function(a){this.observer&&y.canTarget(a)&&this.observer.observe(a,F)},enableOnSubtree:function(a){this.watchSubtree(a);a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},
installNewSubtree:function(a){n(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll("[touch-action]"):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(z(b))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},
isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){var b=w(a,this.findElements,this);return b.push(C(a,this.isElement)),b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){"childList"===a.type?(this.flattenMutationTree(a.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(a.removedNodes).forEach(this.removeElement,this)):"attributes"===a.type&&this.elementChanged(a.target,
a.oldValue)}};var G=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],N="",M=window.PointerEvent||window.MSPointerEvent,R=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,P=x.pointermap,Q=[1,4,2,8,16],T=!1;try{T=1===(new MouseEvent("test",{buttons:1})).buttons}catch(fa){}var O,S={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){x.listen(a,this.events)},unregister:function(a){x.unlisten(a,
this.events)},lastTouches:[],isEventSimulatedFromTouch:function(a){var b,c=this.lastTouches,e=a.clientX;a=a.clientY;for(var d=0,f=c.length;f>d&&(b=c[d]);d++){var g=Math.abs(a-b.y);if(25>=Math.abs(e-b.x)&&25>=g)return!0}},prepareEvent:function(a){var b=x.cloneEvent(a),c=b.preventDefault;return b.preventDefault=function(){a.preventDefault();c()},b.pointerId=this.POINTER_ID,b.isPrimary=!0,b.pointerType=this.POINTER_TYPE,b},prepareButtonsForMove:function(a,b){var c=P.get(this.POINTER_ID);0!==b.which&&
c?a.buttons=c.buttons:a.buttons=0;b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=P.get(this.POINTER_ID),c=this.prepareEvent(a);T||(c.buttons=Q[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons);P.set(this.POINTER_ID,a);b&&0!==b.buttons?x.move(c):x.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);T||this.prepareButtonsForMove(b,a);b.button=-1;P.set(this.POINTER_ID,a);x.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=
P.get(this.POINTER_ID),c=this.prepareEvent(a);if(!T){var e=Q[c.button];c.buttons=b?b.buttons&~e:0;a.buttons=c.buttons}P.set(this.POINTER_ID,a);c.buttons&=~Q[c.button];0===c.buttons?x.up(c):x.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);T||this.prepareButtonsForMove(b,a);b.button=-1;P.set(this.POINTER_ID,a);x.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);T||this.prepareButtonsForMove(b,a);b.button=
-1;x.leaveOut(b)}},cancel:function(a){a=this.prepareEvent(a);x.cancel(a);this.deactivateMouse()},deactivateMouse:function(){P["delete"](this.POINTER_ID)}},H=x.captureInfo,Y=y.findTarget.bind(y),W=y.allShadows.bind(y),E=x.pointermap,p={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){O.enableOnSubtree(a)},unregister:function(a){},elementAdded:function(a){var b=a.getAttribute("touch-action"),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,x.listen(a,this.events),
W(a).forEach(function(a){a._scrollType=c;x.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0;x.unlisten(a,this.events);W(a).forEach(function(a){a._scrollType=void 0;x.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute("touch-action"),e=this.touchActionToScrollType(c);b=this.touchActionToScrollType(b);e&&b?(a._scrollType=e,W(a).forEach(function(a){a._scrollType=e},this)):b?this.elementRemoved(a):e&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",
XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=this.scrollTypes;return"none"===a?"none":a===b.XSCROLLER?"X":a===b.YSCROLLER?"Y":b.SCROLLER.exec(a)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){(0===E.size||1===E.size&&E.has(1))&&(this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=!1,this.cancelResetClickCount())},
removePrimaryPointer:function(a){a.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(a,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;return("touchstart"===a||"touchmove"===a)&&(b=1),b},touchToPointer:function(a){var b=this.currentTouchEvent,c=x.cloneEvent(a),e=c.pointerId=
a.identifier+2;c.target=H[e]||Y(c);c.bubbles=!0;c.cancelable=!0;c.detail=this.clickCount;c.button=0;c.buttons=this.typeToButtons(b.type);c.width=a.radiusX||a.webkitRadiusX||0;c.height=a.radiusY||a.webkitRadiusY||0;c.pressure=a.force||a.webkitForce||.5;c.isPrimary=this.isPrimaryTouch(a);c.pointerType=this.POINTER_TYPE;c.altKey=b.altKey;c.ctrlKey=b.ctrlKey;c.metaKey=b.metaKey;c.shiftKey=b.shiftKey;var d=this;return c.preventDefault=function(){d.scrolling=!1;d.firstXY=null;b.preventDefault()},c},processTouches:function(a,
b){var c=a.changedTouches;this.currentTouchEvent=a;for(var e=0;e<c.length;e++)a=c[e],b.call(this,this.touchToPointer(a))},shouldScroll:function(a){if(this.firstXY){var b;b=a.currentTarget._scrollType;if("none"===b)b=!1;else if("XY"===b)b=!0;else{a=a.changedTouches[0];var c="Y"===b?"X":"Y";b=Math.abs(a["client"+b]-this.firstXY[b])>=Math.abs(a["client"+c]-this.firstXY[c])}return this.firstXY=null,b}},findTouch:function(a,b){for(var c,e=0,d=a.length;d>e&&(c=a[e]);e++)if(c.identifier===b)return!0},vacuumTouches:function(a){var b=
a.touches;if(E.size>=b.length){var c=[];E.forEach(function(a,e){1===e||this.findTouch(b,e-2)||c.push(a.out)},this);c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a);this.setPrimaryTouch(a.changedTouches[0]);this.dedupSynthMouse(a);this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){E.set(a.pointerId,{target:a.target,out:a,outTarget:a.target});x.enterOver(a);x.down(a)},touchmove:function(a){this.scrolling||(this.shouldScroll(a)?
(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=E.get(a.pointerId);if(b){var c=b.out,e=b.outTarget;x.move(a);c&&e!==a.target&&(c.relatedTarget=a.target,a.relatedTarget=e,c.target=e,a.target?(x.leaveOut(c),x.enterOver(a)):(a.target=e,a.relatedTarget=null,this.cancelOut(a)));b.out=a;b.outTarget=a.target}},touchend:function(a){this.dedupSynthMouse(a);this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||
(x.up(a),x.leaveOut(a));this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){x.cancel(a);x.leaveOut(a);this.cleanUpPointer(a)},cleanUpPointer:function(a){E["delete"](a.pointerId);this.removePrimaryPointer(a)},dedupSynthMouse:function(a){var b=S.lastTouches;a=a.changedTouches[0];this.isPrimaryTouch(a)&&(a={x:a.clientX,y:a.clientY},b.push(a),b=function(a,b){b=a.indexOf(b);-1<b&&a.splice(b,1)}.bind(null,b,a),setTimeout(b,2500))}};O=new h(p.elementAdded,
p.elementRemoved,p.elementChanged,p);var A,K,U=x.pointermap,V=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,X={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(a){x.listen(a,this.events)},unregister:function(a){x.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;return V&&(b=x.cloneEvent(a),
b.pointerType=this.POINTER_TYPES[a.pointerType]),b},cleanup:function(a){U["delete"](a)},MSPointerDown:function(a){U.set(a.pointerId,a);a=this.prepareEvent(a);x.down(a)},MSPointerMove:function(a){a=this.prepareEvent(a);x.move(a)},MSPointerUp:function(a){var b=this.prepareEvent(a);x.up(b);this.cleanup(a.pointerId)},MSPointerOut:function(a){a=this.prepareEvent(a);x.leaveOut(a)},MSPointerOver:function(a){a=this.prepareEvent(a);x.enterOver(a)},MSPointerCancel:function(a){var b=this.prepareEvent(a);x.cancel(b);
this.cleanup(a.pointerId)},MSLostPointerCapture:function(a){a=x.makeEvent("lostpointercapture",a);x.dispatchEvent(a)},MSGotPointerCapture:function(a){a=x.makeEvent("gotpointercapture",a);x.dispatchEvent(a)}};window.navigator.msPointerEnabled?(A=function(b){f(b);a(this);0!==x.pointermap.get(b).buttons&&this.msSetPointerCapture(b)},K=function(a){f(a);this.msReleasePointerCapture(a)}):(A=function(b){f(b);a(this);0!==x.pointermap.get(b).buttons&&x.setCapture(b,this)},K=function(a){f(a);x.releaseCapture(a,
this)});var ba=window.PointerEvent||window.MSPointerEvent;return{dispatcher:x,Installer:h,PointerEvent:m,PointerMap:q,targetFinding:y,applyGlobal:function(){k();window.PointerEvent||((window.PointerEvent=m,window.navigator.msPointerEnabled)?(Object.defineProperty(window.navigator,"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),x.registerSource("ms",X)):(x.registerSource("mouse",S),void 0!==window.ontouchstart&&x.registerSource("touch",p)),x.register(document));window.Element&&
!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:A},releasePointerCapture:{value:K}})},applyLocal:function(a){ba||(window.PointerEvent||(window.navigator.msPointerEnabled?x.registerSource("ms",X):(x.registerSource("mouse",S),void 0!==window.ontouchstart&&x.registerSource("touch",p)),x.register(document)),window.Element&&!Element.prototype.setPointerCapture&&(a.setPointerCapture=A.bind(a),a.releasePointerCapture=K.bind(a)),a.getAttribute("touch-action")||
a.setAttribute("touch-action","none"))}}})},"esri/views/input/ViewEvents":function(){define(["require","exports","../../core/tsSupport/extendsHelper","./InputHandler","../../geometry/ScreenPoint"],function(m,l,h,d,b){function g(b){return!!a[b]}function k(a){for(var b=0;b<a.length;b++)if(!g(a[b]))return!1;return!0}Object.defineProperty(l,"__esModule",{value:!0});var f,a={click:!0,"double-click":!0,hold:!0,drag:!0,"key-down":!0,"key-up":!0,"pointer-down":!0,"pointer-move":!0,"pointer-up":!0,"mouse-wheel":!0,
"pointer-enter":!0,"pointer-leave":!0};!function(a){a[a.Left=0]="Left";a[a.Middle=1]="Middle";a[a.Right=2]="Right"}(f||(f={}));m=function(){function a(a){this.handlers=new Map;this.counter=0;this.view=a;this.inputManager=null}return a.prototype.connect=function(a){var b=this;a&&this.disconnect();this.inputManager=a;this.handlers.forEach(function(a,c){return b.inputManager.installHandlers(c,[a])})},a.prototype.disconnect=function(){var a=this;this.inputManager&&this.handlers.forEach(function(b,c){return a.inputManager.uninstallHandlers(c)});
this.inputManager=null},a.prototype.destroy=function(){this.disconnect();this.handlers.clear();this.view=null},a.prototype.register=function(a,b,c){var d=this;a=Array.isArray(a)?a:a.split(",");if(!k(a))return a.some(g)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;var f=Array.isArray(b)?b:[];c=Array.isArray(b)?c:b;var h=this.createUniqueGroupName();b=new e(this.view,a,f,c);return this.handlers.set(h,b),this.inputManager&&this.inputManager.installHandlers(h,
[b]),{remove:function(){return d.removeHandler(h)}}},a.prototype.removeHandler=function(a){this.handlers.has(a)&&this.handlers["delete"](a);this.inputManager&&this.inputManager.uninstallHandlers(a)},a.prototype.createUniqueGroupName=function(){return this.counter+=1,"viewEvents_"+this.counter},a}();l.ViewEvents=m;var e=function(a){function c(b,c,e,d){var f=a.call(this,!0)||this;f.view=b;for(b=0;b<c.length;b++)switch(c[b]){case "click":f.registerIncoming("click",e,function(a){return d(f.wrapClick(a))});
break;case "double-click":f.registerIncoming("double-click",e,function(a){return d(f.wrapDoubleClick(a))});break;case "hold":f.registerIncoming("hold",e,function(a){return d(f.wrapHold(a))});break;case "drag":f.registerIncoming("drag",e,function(a){return d(f.wrapDrag(a))});break;case "key-down":f.registerIncoming("key-down",e,function(a){return d(f.wrapKeyDown(a))});break;case "key-up":f.registerIncoming("key-up",e,function(a){return d(f.wrapKeyUp(a))});break;case "pointer-down":f.registerIncoming("pointer-down",
e,function(a){return d(f.wrapPointer(a,"pointer-down"))});break;case "pointer-move":f.registerIncoming("pointer-move",e,function(a){return d(f.wrapPointer(a,"pointer-move"))});break;case "pointer-up":f.registerIncoming("pointer-up",e,function(a){return d(f.wrapPointer(a,"pointer-up"))});break;case "mouse-wheel":f.registerIncoming("mouse-wheel",e,function(a){return d(f.wrapMouseWheel(a))});break;case "pointer-enter":f.registerIncoming("pointer-enter",e,function(a){return d(f.wrapPointer(a,"pointer-enter"))});
break;case "pointer-leave":f.registerIncoming("pointer-leave",e,function(a){return d(f.wrapPointer(a,"pointer-leave"))})}return f}return h(c,a),c.prototype.wrapClick=function(a){var c=a.data.x,e=a.data.y;return{type:"click",button:"touch"===a.data["native"].pointerType?0:a.data["native"].button,x:c,y:e,"native":a.data["native"],timestamp:a.timestamp,screenPoint:new b(c,e),mapPoint:this.view.toMap(c,e),stopPropagation:function(){return a.stopPropagation()}}},c.prototype.wrapDoubleClick=function(a){var b=
a.data.x,c=a.data.y;return{type:"double-click",button:"touch"===a.data["native"].pointerType?0:a.data["native"].button,x:b,y:c,"native":a.data["native"],timestamp:a.timestamp,mapPoint:this.view.toMap(b,c),stopPropagation:function(){return a.stopPropagation()}}},c.prototype.wrapHold=function(a){var b=a.data.x,c=a.data.y;return{type:"hold",button:"touch"===a.data["native"].pointerType?0:a.data["native"].button,x:b,y:c,"native":a.data["native"],timestamp:a.timestamp,mapPoint:this.view.toMap(b,c),stopPropagation:function(){return a.stopPropagation()}}},
c.prototype.wrapDrag=function(a){return{type:"drag",action:a.data.action,x:a.data.currentState.center.x,y:a.data.currentState.center.y,origin:{x:a.data.startState.center.x,y:a.data.startState.center.y},"native":a.data.pointers[0].currentEvent["native"],timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}},c.prototype.wrapKeyDown=function(a){return{type:"key-down",key:a.data.key,repeat:a.data.repeat,"native":a.data["native"],timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}},
c.prototype.wrapKeyUp=function(a){return{type:"key-up",key:a.data.key,"native":a.data["native"],timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}},c.prototype.wrapPointer=function(a,b){return{type:b,x:a.data.x,y:a.data.y,pointerId:a.data["native"].pointerId,pointerType:a.data["native"].pointerType,"native":a.data["native"],timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}},c.prototype.wrapMouseWheel=function(a){return{type:"mouse-wheel",x:a.data.x,
y:a.data.y,deltaY:a.data.deltaY,"native":a.data["native"],timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}},c}(d.InputHandler)})},"esri/views/input/handlers/PreventContextMenu":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(){var d=b.call(this,!0)||this;return d.registerIncoming("context-menu",function(b){b.data["native"].preventDefault()}),
d}return h(d,b),d}(d.InputHandler);l.PreventContextMenu=m;l["default"]=m})},"esri/views/2d/input/handlers/DoubleClickZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(d){function g(b,a){var e=d.call(this,!0)||this;return e.view=b,e.registerIncoming("double-click",a,function(b){return e._handleDoubleClick(b,a)}),e}return h(g,
d),g.prototype._handleDoubleClick=function(d,a){b.eventMatchesPointerType(d.data["native"],"primary")&&(d.stopPropagation(),a?this.view.navigation.zoomOut([d.data.x,d.data.y]):this.view.navigation.zoomIn([d.data.x,d.data.y]))},g}(d.InputHandler);l.DoubleClickZoom=m})},"esri/views/input/handlers/support":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.eventMatchesPointerType=function(h,d){switch(d){case "primary":return"touch"===h.pointerType||
0===h.button;case "secondary":return"touch"!==h.pointerType&&2===h.button;case "tertiary":return"touch"!==h.pointerType&&1===h.button}};l.eventMatchesMousePointerType=function(h,d){if("touch"===h.pointerType)return!1;switch(d){case "primary":return 0===h.button;case "secondary":return 2===h.button;case "tertiary":return 1===h.button}}})},"esri/views/2d/input/handlers/DragPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],
function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(d){function g(b,a,e){var c=d.call(this,!0)||this;return c.view=b,c.pointerType=a,c.registerIncoming("drag",e,function(a){return c._handleDrag(a)}),c.registerIncoming("pointer-down",function(a){return c.stopMomentumNavigation()}),c}return h(g,d),g.prototype._handleDrag=function(d){var a=d.data,e=this.view.navigation;if(1<a.pointers.length||e.pinch.zoomMomentum||e.pinch.rotateMomentum)return void this.stopMomentumNavigation();
if(b.eventMatchesPointerType(a.pointers[0].startEvent["native"],this.pointerType)){e=e.pan;switch(a.action){case "start":e.begin(this.view,a);break;case "update":e.update(this.view,a);break;case "end":e.end(this.view,a)}d.stopPropagation()}},g.prototype.stopMomentumNavigation=function(){this.view.navigation.pan.stopMomentumNavigation()},g}(d.InputHandler);l.DragPan=m})},"esri/views/2d/input/handlers/DragRotate":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler",
"../../../input/handlers/support"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(d){function g(b,a,e){var c=d.call(this,!0)||this;return c.view=b,c.pointerType=a,c.registerIncoming("drag",e,function(a){return c._handleDrag(a)}),c}return h(g,d),g.prototype._handleDrag=function(d){var a=d.data;if(!(1<a.pointers.length)&&b.eventMatchesPointerType(a.pointers[0].startEvent["native"],this.pointerType)){var e=this.view.navigation.rotate;switch(a.action){case "start":e.begin(this.view,
a);break;case "update":e.update(this.view,a);break;case "end":e.end(this.view,a)}d.stopPropagation()}},g}(d.InputHandler);l.DragRotate=m})},"esri/views/2d/input/handlers/KeyPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d,f,a){var e=b.call(this,!0)||this;return e.view=d,e.keys=f,e._keyMap=(c={},c[f.left]="left",c[f.right]="right",c[f.up]=
"up",c[f.down]="down",c),e.registerIncoming("key-down",a,function(a){return e._handleKeyDown(a)}),e.registerIncoming("key-up",a,function(a){return e._handleKeyUp(a)}),e;var c}return h(d,b),d.prototype._handleKeyDown=function(b){b.data.repeat||this._handleKey(b,!0)},d.prototype._handleKeyUp=function(b){this._handleKey(b,!1)},d.prototype._handleKey=function(b,d){var a=this._keyMap[b.data.key];if(null!=a){if(d)switch(a){case "left":this.view.navigation.continousPanLeft();break;case "right":this.view.navigation.continousPanRight();
break;case "up":this.view.navigation.continousPanUp();break;case "down":this.view.navigation.continousPanDown()}else this.view.navigation.stop();b.stopPropagation()}},d}(d.InputHandler);l.KeyPan=m})},"esri/views/2d/input/handlers/KeyZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});var b;!function(b){b[b.IN=0]="IN";b[b.OUT=1]="OUT"}(b||(b={}));m=function(d){function g(f,
a,e){var c=d.call(this,!0)||this;return c.view=f,c.keys=a,c._keysToZoomAction={},c.registerIncoming("key-down",e,function(a){return c._handleKeyDown(a)}),a.zoomIn.forEach(function(a){return c._keysToZoomAction[a]=b.IN}),a.zoomOut.forEach(function(a){return c._keysToZoomAction[a]=b.OUT}),c}return h(g,d),g.prototype._handleKeyDown=function(b){this._handleKey(b)},g.prototype._handleKey=function(d){var a=d.modifiers;0<a.size&&!a.has("Shift")||(a=this._keysToZoomAction[d.data.key],a===b.IN?(this.view.navigation.zoomIn(),
d.stopPropagation()):a===b.OUT&&(this.view.navigation.zoomOut(),d.stopPropagation()))},g}(d.InputHandler);l.KeyZoom=m})},"esri/views/2d/input/handlers/KeyRotate":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d,f,a){var e=b.call(this,!0)||this;return e.view=d,e.keys=f,e._keyToDirection=(c={},c[f.clockwiseOption1]="clockwise",c[f.clockwiseOption2]=
"clockwise",c[f.counterClockwiseOption1]="counterClockwise",c[f.counterClockwiseOption2]="counterClockwise",c[f.resetOption1]="reset",c[f.resetOption2]="reset",c),e.registerIncoming("key-down",a,function(a){return e._handleKeyDown(a)}),e.registerIncoming("key-up",a,function(a){return e._handleKeyUp(a)}),e;var c}return h(d,b),d.prototype._handleKeyDown=function(b){b.data.repeat||this._handleKey(b,!0)},d.prototype._handleKeyUp=function(b){this._handleKey(b,!1)},d.prototype._handleKey=function(b,d){var a=
b.modifiers;0<a.size&&!a.has("Shift")||!this.view.constraints.rotationEnabled||(a=this._keyToDirection[b.data.key])&&(d?"clockwise"===a?this.view.navigation.continousRotateClockwise():"counterClockwise"===a?this.view.navigation.continousRotateCounterclockwise():this.view.navigation.resetRotation():this.view.navigation.stop(),b.stopPropagation())},d}(d.InputHandler);l.KeyRotate=m})},"esri/views/2d/input/handlers/MouseWheelZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper",
"../../../input/InputHandler"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d,f){var a=b.call(this,!0)||this;return a.view=d,a._canZoom=!0,a.registerIncoming("mouse-wheel",f,function(b){return a._handleMouseWheel(b)}),a}return h(d,b),d.prototype._handleMouseWheel=function(b){var d=this;if(this._canZoom){var a=b.data;(a=this.view.navigation.zoom(1/Math.pow(.6,1/60*a.deltaY),[a.x,a.y]))&&(this._canZoom=!1,a.always(function(){d._canZoom=!0}));b.stopPropagation()}},
d}(d.InputHandler);l.MouseWheelZoom=m})},"esri/views/2d/input/handlers/PinchAction":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d){var f=b.call(this,!0)||this;return f.view=d,f.registerIncoming("drag",function(a){return f._handleDrag(a)}),f.registerIncoming("pointer-down",function(a){return f.stopMomentumNavigation()}),f}return h(d,b),d.prototype._handleDrag=
function(b){var d=b.data;if(!(2>d.pointers.length)){var a=this.view.navigation.pinch;switch(d.action){case "start":a.begin(this.view,d);break;case "update":a.update(this.view,d);break;case "end":a.end(this.view,d)}b.stopPropagation()}},d.prototype.stopMomentumNavigation=function(){this.view.navigation.pinch.stopMomentumNavigation()},d}(d.InputHandler);l.PinchRotateAndZoom=m})},"esri/views/2d/navigation/MapViewNavigation":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../Viewpoint ../../../geometry/Point ./actions/Pan ./actions/Rotate ./actions/Pinch ./ZoomBox ../viewpointUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){var r=new k({targetGeometry:new f}),u=[0,0];return function(f){function g(a){a=f.call(this)||this;return a.animationManager=null,a}return h(g,f),g.prototype.initialize=function(){this.pan=new a({navigation:this});this.rotate=new e({navigation:this});this.pinch=new c({navigation:this});this.zoomBox=new q({view:this.view,navigation:this})},g.prototype.destroy=function(){this.zoomBox.destroy();this.animationManager=this.zoomBox=null},g.prototype.begin=function(){this._set("interacting",
!0)},g.prototype.end=function(){this._set("interacting",!1)},g.prototype.zoom=function(a,b){return void 0===b&&(b=this._getDefaultAnchor()),this.stop(),this.begin(),this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs?1>a?this.zoomIn(b):this.zoomOut(b):void this.setViewpoint(b,a,0)},g.prototype.zoomIn=function(a){void 0===a&&(a=this._getDefaultAnchor());this.begin();var b=this.view,c=b.scale,e=b.constraints.snapToNextScale(c);a=b.goTo(this._scaleAndRotateViewpoint(r,a,e/c,0));return this.end(),
a},g.prototype.zoomOut=function(a){void 0===a&&(a=this._getDefaultAnchor());this.begin();var b=this.view,c=b.scale,e=b.constraints.snapToPreviousScale(c);a=b.goTo(this._scaleAndRotateViewpoint(r,a,e/c,0));return this.end(),a},g.prototype.setViewpoint=function(a,b,c){this.begin();this.view.state.viewpoint=this._scaleAndRotateViewpoint(r,a,b,c);this.end()},g.prototype.animateViewpoint=function(a,b,c){return this.view.goTo(this._scaleAndRotateViewpoint(r,a,b,c))},g.prototype.continousRotateClockwise=
function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){t.rotateBy(a,a,-1)})},g.prototype.continousRotateCounterclockwise=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){t.rotateBy(a,a,1)})},g.prototype.resetRotation=function(){this.view.rotation=0},g.prototype.continousPanLeft=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){t.translateBy(a,a,[-10,0])})},g.prototype.continousPanRight=
function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){t.translateBy(a,a,[10,0])})},g.prototype.continousPanUp=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){t.translateBy(a,a,[0,10])})},g.prototype.continousPanDown=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){t.translateBy(a,a,[0,-10])})},g.prototype.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();
this.end()},g.prototype._getDefaultAnchor=function(){var a=this.view.size;return u[0]=.5*a[0],u[1]=.5*a[1],u},g.prototype._scaleAndRotateViewpoint=function(a,b,c,e){var d=this.view,f=d.size,g=d.padding,k=d.constraints,h=d.viewpoint,n=d.scale*c,d=k.canZoomInTo(n),k=k.canZoomOutTo(n);return 1>c&&!d||1<c&&!k?h:t.padAndScaleAndRotateBy(a,h,c,e,b,f,g)},d([b.property()],g.prototype,"animationManager",void 0),d([b.property({type:Boolean,readOnly:!0})],g.prototype,"interacting",void 0),d([b.property()],g.prototype,
"pan",void 0),d([b.property()],g.prototype,"pinch",void 0),d([b.property()],g.prototype,"rotate",void 0),d([b.property()],g.prototype,"view",void 0),d([b.property()],g.prototype,"zoomBox",void 0),g=d([b.subclass("esri.views.2d.navigation.MapViewNavigation")],g)}(b.declared(g))})},"esri/views/2d/navigation/actions/Pan":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Accessor ../../viewpointUtils ../../../navigation/Momentum ../../../3d/lib/glMatrix".split(" "),
function(m,l,h,d,b,g,k,f,a){return function(e){function c(a){var b=e.call(this)||this;return b.animationTime=0,b.momentumEstimator=new f.ScreenspaceMomentumEstimator(.05,600,6,.92),b.momentum=null,b.momentumVelocityX=0,b.momentumVelocityY=0,b.momentumFinished=!1,b.viewpoint=k.create(),b.watch("momentumFinished",function(a){a&&b.navigation.stop()}),b}return h(c,e),c.prototype.begin=function(a,b){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(b)},c.prototype.update=function(a,
b){this.addToEstimator(b);var c=b.pointers[0];b=c.currentEvent.x;var e=c.currentEvent.y;b=(c=c.previousEvent)?c.x-b:-b;e=c?e-c.y:e;a.viewpoint=k.translateBy(this.viewpoint,a.viewpoint,[b||0,e||0])},c.prototype.end=function(a,b){this.addToEstimator(b);this.momentum=this.momentumEstimator.evaluateMomentum();this.animationTime=0;this.momentum&&(this.momentumVelocityX=(this.momentum.dataNewest[0]-this.momentum.dataOldest[0])/this.momentum.dataTimeDelta,this.momentumVelocityY=(this.momentum.dataNewest[1]-
this.momentum.dataOldest[1])/this.momentum.dataTimeDelta,this.onAnimationUpdate(a));this.navigation.end()},c.prototype.addToEstimator=function(b){var c=b.pointers[0],e=c.currentEvent.x,c=c.currentEvent.y;this.momentumEstimator.add(e,c,a.vec3.createFrom(e,c,0),.001*b.currentState.timestamp)},c.prototype.onAnimationUpdate=function(a){var b=this;this.navigation.animationManager.animateContinous(a.viewpoint,function(c,e){b.momentumFinished=!b.momentum||b.momentum.isFinished(b.animationTime);e*=.001;if(!b.momentumFinished){var d=
b.momentum.velocityFactor(b.animationTime);a.viewpoint=k.translateBy(c,c,[-(d*b.momentumVelocityX*e),d*b.momentumVelocityY*e])}b.animationTime+=e})},c.prototype.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())},d([b.property()],c.prototype,"momentumFinished",void 0),d([b.property()],c.prototype,"viewpoint",void 0),d([b.property()],c.prototype,"navigation",void 0),c=d([b.subclass("esri.views.2d.navigation.actions.Pan")],c)}(b.declared(g))})},
"esri/views/navigation/Momentum":function(){define(["require","exports","../../core/tsSupport/extendsHelper","./ValueHistory","../3d/lib/glMatrix"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});var g=function(){function a(a,b,e){this._initialVelocity=a;this._stopVelocity=b;this._friction=e;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}return Object.defineProperty(a.prototype,"duration",{get:function(){return this._duration},
enumerable:!0,configurable:!0}),a.prototype.isFinished=function(a){return a>this.duration},Object.defineProperty(a.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0}),a.prototype.value=function(a){a=Math.min(a,this.duration);var b=1-this._friction;return this._initialVelocity*(Math.pow(b,a)-1)/Math.log(b)},a.prototype.valueDelta=function(a,b){var c=this.value(a);return this.value(a+b)-c},a}();l.Momentum=g;m=function(){function a(a,b,e,f){void 0===a&&(a=.05);
this._minimumInitialVelocity=b;this._stopVelocity=e;this._friction=f;this._history=new d.ValueHistory(1E3*a)}return a.prototype.add=function(a,b){void 0!==b&&(b*=1E3);this._history.add(a,b)},a.prototype.reset=function(){this._history.reset()},Object.defineProperty(a.prototype,"stopVelocity",{get:function(){return this._stopVelocity},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0}),a.prototype.evaluateMomentum=
function(){var a=this._evaluateVelocity();return null!==a?new g(a,this._stopVelocity,this._friction):null},a.prototype._evaluateVelocity=function(){var a=this._history,b=a.oldest,a=a.newest;if(b&&a){var e=(a.timeStamp-b.timeStamp)/1E3;if(0<e&&(b=(a.value-b.value)/e,Math.abs(b)>=this._minimumInitialVelocity))return b}return null},a}();l.MomentumEstimator=m;var k=function(a){function b(b,c,e){return a.call(this,b,c,e)||this}return h(b,a),b.prototype.value=function(b){b=a.prototype.value.call(this,b);
return Math.exp(b)},b.prototype.valueDelta=function(b,c){var e=a.prototype.value.call(this,b);b=a.prototype.value.call(this,b+c);return Math.exp(b-e)},b}(g);l.ZoomMomentum=k;var f=function(a){function b(b,c,e,d){return void 0===b&&(b=.05),void 0===c&&(c=4),void 0===e&&(e=.01),void 0===d&&(d=.95),a.call(this,b,c,e,d)||this}return h(b,a),b.prototype.add=function(b,c){a.prototype.add.call(this,Math.log(b),c)},b.prototype.evaluateMomentum=function(){var a=this._evaluateVelocity();return null!==a?new k(a,
this.stopVelocity,this.friction):null},b}(m);l.ZoomMomentumEstimator=f;m=function(a){function b(b,c,e,d){return void 0===b&&(b=.05),void 0===c&&(c=4),void 0===e&&(e=.01),void 0===d&&(d=.95),a.call(this,b,c,e,d)||this}return h(b,a),b.prototype.add=function(b,c){var e=this._history.newest;if(e){e=e.value;for(b-=e;b>Math.PI;)b-=2*Math.PI;for(;b<-Math.PI;)b+=2*Math.PI;b=e+b}a.prototype.add.call(this,b,c)},b}(m);l.RotationMomentumEstimator=m;var a=function(a){function b(b,c,e,d,f,g){b=a.call(this,b,c,
e)||this;return b.dataOldest=d,b.dataNewest=f,b.dataTimeDelta=g,b}return h(b,a),b.prototype.velocityFactor=function(a){return a=Math.min(a,this.duration),Math.pow(1-this.friction,a)},b.prototype.valueFromInitialVelocity=function(a,b){b=Math.min(b,this.duration);var c=1-this.friction;return a*(Math.pow(c,b)-1)/Math.log(c)},b}(g);l.ScreenspaceMomentum=a;m=function(){function e(a,b,e,f){void 0===a&&(a=.05);this._minimumInitialVelocity=b;this._stopVelocity=e;this._friction=f;this._entryPool=[];this._history=
new d.ValueHistory(1E3*a)}return e.prototype.add=function(a,e,d,f){void 0!==f&&(f*=1E3);var c;0!==this._entryPool.length?(c=this._entryPool.pop(),c.x=a,c.y=e,b.vec3d.set(d,c.data)):c={x:a,y:e,data:b.vec3d.create(d)};this._history.add(c,f)},e.prototype.reset=function(){for(var a=0,b=this._history.values;a<b.length;a++)this._entryPool.push(b[a].value);this._history.reset()},Object.defineProperty(e.prototype,"stopVelocity",{get:function(){return this._stopVelocity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,
"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0}),e.prototype.evaluateMomentum=function(){var b=this._evaluateVelocity(),e=this._history.oldest,d=this._history.newest;return null!==b?new a(b,this._stopVelocity,this._friction,e.value.data,d.value.data,.001*(d.timeStamp-e.timeStamp)):null},e.prototype._evaluateVelocity=function(){var a=this._history,b=a.oldest,e=a.newest;if(b&&e&&(a=.001*(e.timeStamp-b.timeStamp),0<a)){var d=e.value.x-b.value.x,b=e.value.y-b.value.y,
b=Math.sqrt(d*d+b*b)/a;if(Math.abs(b)>=this._minimumInitialVelocity)return b}return null},e}();l.ScreenspaceMomentumEstimator=m})},"esri/views/navigation/ValueHistory":function(){define(["require","exports","../../core/now"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function d(b){this._maximumAge=b;this._values=[]}return Object.defineProperty(d.prototype,"values",{get:function(){return this._values},enumerable:!0,configurable:!0}),d.prototype.reset=function(){this._values=
[]},d.prototype.add=function(b,d){d=void 0!==d?d:h();this._values.push({value:b,timeStamp:d});this._cleanup(d)},Object.defineProperty(d.prototype,"newest",{get:function(){var b=this._values.length;return 0<b?this._values[b-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"oldest",{get:function(){return 0<this._values.length?this._values[0]:void 0},enumerable:!0,configurable:!0}),d.prototype._cleanup=function(b){for(;0<this._values.length&&this._values[0].timeStamp+this._maximumAge<
b;)this._values.shift()},d}();l.ValueHistory=m})},"esri/views/2d/navigation/actions/Rotate":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Accessor ../../viewpointUtils ../../libs/gl-matrix/vec2".split(" "),function(m,l,h,d,b,g,k,f){return function(a){function e(b){b=a.call(this)||this;return b.animationTime=0,b.viewpoint=k.create(),b}return h(e,a),e.prototype.begin=
function(a,b){this.navigation.begin()},e.prototype.update=function(a,b){var c=b.pointers[0];b=f.create();f.set(b,c.currentEvent.x+a.padding.left-a.padding.right,a.height-c.currentEvent.y+a.padding.top-a.padding.bottom);var c=c.previousEvent,e=f.create();f.set(e,c.x+a.padding.left-a.padding.right,a.height-c.y+a.padding.top-a.padding.bottom);b=k.angleBetween([a.state.paddedScreenCenter[0]+a.padding.left-a.padding.right,a.state.paddedScreenCenter[1]],b,e);a.viewpoint=k.rotateBy(this.viewpoint,a.content.viewpoint,
b)},e.prototype.end=function(a,b){this.navigation.end()},d([b.property()],e.prototype,"viewpoint",void 0),d([b.property()],e.prototype,"navigation",void 0),e=d([b.subclass("esri.views.2d.actions.Rotate")],e)}(b.declared(g))})},"esri/views/2d/navigation/actions/Pinch":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Accessor ../../viewpointUtils ../../../navigation/Momentum ../../libs/gl-matrix/vec2".split(" "),
function(m,l,h,d,b,g,k,f,a){return function(e){function c(a){var b=e.call(this,a)||this;return b.animationTime=0,b.momentumFinished=!1,b.rotateMomentumEstimator=new f.RotationMomentumEstimator(.05,6,.15,.95),b.rotateMomentum=null,b.rotationDirection=1,b.zoomMomentumEstimator=new f.ZoomMomentumEstimator(.05),b.zoomMomentum=null,b.zoomDirection=1,b.viewpoint=k.create(),b.watch("momentumFinished",function(a){a&&b.navigation.stop()}),b}return h(c,e),c.prototype.begin=function(a,b){this.navigation.begin();
this.rotateMomentumEstimator.reset();this.zoomMomentumEstimator.reset();this.addToRotateEstimator(b,0);this.addToZoomEstimator(b,b.startState.radius/b.currentState.radius)},c.prototype.update=function(a,b){var c=b.currentState,e=c.angle,d=c.radius,c=c.center,f=b.previousState,g=f.radius,k=f.angle,f=b.startState.radius/d;g&&(d/=g,e=180*(e-k)/Math.PI,this.rotationDirection=0<=e?1:-1,this.zoomDirection=1<=d?1:-1,a.constraints.rotationEnabled||(e=0),this.addToRotateEstimator(b,e),this.addToZoomEstimator(b,
f),this.center=c,this.navigation.setViewpoint([c.x,c.y],1/d,e))},c.prototype.end=function(a,b){this.addToRotateEstimator(b,0);this.addToZoomEstimator(b,b.startState.radius/b.currentState.radius);this.rotateMomentum=this.rotateMomentumEstimator.evaluateMomentum();this.zoomMomentum=this.zoomMomentumEstimator.evaluateMomentum();this.animationTime=0;(this.rotateMomentum||this.zoomMomentum)&&this.onAnimationUpdate(a);this.navigation.end()},c.prototype.addToRotateEstimator=function(a,b){this.rotateMomentumEstimator.add(b,
.001*a.currentState.timestamp)},c.prototype.addToZoomEstimator=function(a,b){this.zoomMomentumEstimator.add(b,.001*a.currentState.timestamp)},c.prototype.canZoomIn=function(a){var b=a.scale;a=a.constraints.effectiveMaxScale;return 0===a||b>a},c.prototype.canZoomOut=function(a){var b=a.scale;a=a.constraints.effectiveMinScale;return 0===a||a>b},c.prototype.onAnimationUpdate=function(b){var c=this;this.navigation.animationManager.animateContinous(b.viewpoint,function(e,d){var f=!c.canZoomIn(b)&&1<c.zoomDirection||
!c.canZoomOut(b)&&1>c.zoomDirection;c.momentumFinished=!c.rotateMomentum||c.rotateMomentum.isFinished(c.animationTime)||f;d*=.001;if(c.notifyChange("momentumFinished"),!c.momentumFinished){var f=Math.abs(c.rotateMomentum.valueDelta(c.animationTime,d))*c.rotationDirection*2,g=c.zoomMomentum?Math.abs(c.zoomMomentum.valueDelta(c.animationTime,d)):1,h=a.create(),n=a.create();a.set(h,c.center.x,c.center.y);k.getPaddingScreenTranslation(n,b.size,b.padding);a.add(h,h,n);k.scaleAndRotateBy(e,b.viewpoint,
g,f,h,b.size)}c.animationTime+=d})},c.prototype.stopMomentumNavigation=function(){(this.rotateMomentum||this.zoomMomentum)&&(this.rotateMomentum&&(this.rotateMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this.zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop())},d([b.property()],c.prototype,"momentumFinished",void 0),d([b.property()],c.prototype,"viewpoint",void 0),d([b.property()],c.prototype,"navigation",void 0),c=d([b.subclass("esri.views.2d.navigation.actions.Pinch")],
c)}(b.declared(g))})},"esri/views/2d/navigation/ZoomBox":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),function(m,l,h,d,b,g){return function(g){function f(a){a=g.call(this,a)||this;return a._container=null,a._overlay=null,a._backgroundShape=null,a._boxShape=null,a._box={x:0,y:0,width:0,height:0},a._redraw=a._redraw.bind(a),a}return h(f,g),f.prototype.destroy=
function(){this.view=null},Object.defineProperty(f.prototype,"view",{set:function(a){var b=this;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._destroyOverlay();this._set("view",a);a&&(a.on("drag",["Shift"],function(a){return b._handleDrag(a,1)}),a.on("drag",["Shift","Ctrl"],function(a){return b._handleDrag(a,-1)}))},enumerable:!0,configurable:!0}),f.prototype._start=function(a,b,c,d){this._createContainer();this._createOverlay();this.navigation.begin()},f.prototype._update=
function(a,b,c,d){this._box.x=a;this._box.y=b;this._box.width=c;this._box.height=d;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))},f.prototype._end=function(a,b,c,d,f){var e=this.view;a=e.toMap(a+.5*c,b+.5*d);c=Math.max(c/e.width,d/e.height);-1===f&&(c=1/c);this._destroyOverlay();this.navigation.end();e.goTo({center:a,scale:e.scale*c})},f.prototype._updateBox=function(a,b,c,d){var e=this._boxShape;e.setAttributeNS(null,"x",""+a);e.setAttributeNS(null,"y",""+b);e.setAttributeNS(null,
"width",""+c);e.setAttributeNS(null,"height",""+d);e.setAttributeNS(null,"class","esri-zoom-box__outline")},f.prototype._updateBackground=function(a,b,c,d){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(a,b,c,d,this.view.width,this.view.height))},f.prototype._createContainer=function(){var a=document.createElement("div");a.className="esri-zoom-box__container";this.view.root.appendChild(a);this._container=a},f.prototype._createOverlay=function(){var a=this.view.width,b=this.view.height,
c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttributeNS(null,"d","M 0 0 L "+a+" 0 L "+a+" "+b+" L 0 "+b+" Z");c.setAttributeNS(null,"class","esri-zoom-box__overlay-background");a=document.createElementNS("http://www.w3.org/2000/svg","rect");b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");b.setAttributeNS(null,"class","esri-zoom-box__overlay");b.appendChild(c);b.appendChild(a);
this._container.appendChild(b);this._backgroundShape=c;this._boxShape=a;this._overlay=b},f.prototype._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null},f.prototype._toSVGPath=function(a,b,c,d,f,g){c=a+c;d=b+d;return"M 0 0 L "+f+" 0 L "+f+" "+g+" L 0 "+g+" ZM "+a+" "+b+" L "+a+" "+d+" L "+c+" "+d+" L "+c+" "+b+" Z"},f.prototype._handleDrag=function(a,
b){var c,e,d,f,g=a.x,k=a.y,h=a.origin.x,l=a.origin.y;switch(g>h?(c=h,d=g-h):(c=g,d=h-g),k>l?(e=l,f=k-l):(e=k,f=l-k),a.action){case "start":this._start(c,e,d,f);break;case "update":this._update(c,e,d,f);break;case "end":this._end(c,e,d,f,b)}a.stopPropagation()},f.prototype._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var a=this._box,b=a.x,c=a.y,d=a.width,a=a.height;this._updateBox(b,c,d,a);this._updateBackground(b,c,d,a);this._rafId=requestAnimationFrame(this._redraw)}},d([b.property()],
f.prototype,"navigation",void 0),d([b.property()],f.prototype,"view",null),f=d([b.subclass("esri.views.2d.navigation.ZoomBox")],f)}(b.declared(g))})},"esri/views/2d/support/HighlightOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../Color".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;
return a.color=new k([0,255,255]),a.haloOpacity=1,a.fillOpacity=.5,a}return h(a,f),d([b.property({type:k})],a.prototype,"color",void 0),d([b.property()],a.prototype,"haloOpacity",void 0),d([b.property()],a.prototype,"fillOpacity",void 0),a=d([b.subclass("esri.views.2d.support.HighlightOptions")],a)}(b.declared(g))})},"esri/views/BreakpointsOwner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/accessorSupport/decorators ../core/watchUtils ./DOMContainer ../core/Accessor ../core/ArrayPool ../core/HandleRegistry dojo/dom-class".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){var t={widthBreakpoint:{getValue:function(a){var b=a.viewSize[0];a=a.breakpoints;var c=this.values;return b<=a.xsmall?c.xsmall:b<=a.small?c.small:b<=a.medium?c.medium:b<=a.large?c.large:c.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",
medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},
heightBreakpoint:{getValue:function(a){var b=a.viewSize[1];a=a.breakpoints;var c=this.values;return b<=a.xsmall?c.xsmall:b<=a.small?c.small:b<=a.medium?c.medium:b<=a.large?c.large:c.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",
medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},
orientation:{getValue:function(a){a=a.viewSize;var b=this.values;return a[1]>=a[0]?b.portrait:b.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},r={xsmall:544,small:768,medium:992,large:1200};return function(a){function f(){var b=null!==a&&a.apply(this,arguments)||this;return b._breakpointsHandles=new c,b.breakpoints=r,b.orientation=null,b.widthBreakpoint=null,b.heightBreakpoint=
null,b}return h(f,a),f.prototype.initialize=function(){this._breakpointsHandles.add([k.init(this,["breakpoints","size"],this._updateClassNames)])},f.prototype.destroy=function(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null)},f.prototype._updateClassNames=function(){if(this.container){var a,b,c,d=e.acquire(),f=e.acquire(),g=!1;for(a in t)b=this[a],c=t[a].getValue({viewSize:this.size,breakpoints:this.breakpoints}),b!==c&&(g=!0,this[a]=
c,f.push(t[a].valueToClassName[b]),d.push(t[a].valueToClassName[c]));g&&(this._applyClassNameChanges(d,f),e.release(d),e.release(f))}},f.prototype._applyClassNameChanges=function(a,b){var c=this.container;c&&(q.remove(c,b),q.add(c,a))},f.prototype._removeActiveClassNames=function(){var a=this.container;if(a)for(var b in t)q.remove(a,t[b].valueToClassName[this[b]])},d([g.property({set:function(a){var c=this._get("breakpoints");if(a!==c){c=(c=a)&&c.xsmall<c.small&&c.small<c.medium&&c.medium<c.large;
if(!c){var e=JSON.stringify(r,null,2);console.warn("provided breakpoints are not valid, using defaults:"+e)}a=c?a:r;this._set("breakpoints",b({},a))}}})],f.prototype,"breakpoints",void 0),d([g.property()],f.prototype,"orientation",void 0),d([g.property()],f.prototype,"widthBreakpoint",void 0),d([g.property()],f.prototype,"heightBreakpoint",void 0),f=d([g.subclass("esri.views.BreakpointsOwner")],f)}(g.declared(a,f))})},"esri/views/2d/layers/GraphicsLayerView2D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ./LayerView2D ./support/GraphicsView2D".split(" "),
function(m,l,h,d,b,g,k){return function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;return a.graphicsView=new k,a.container=a.graphicsView.container,a}return h(a,f),a.prototype.hitTest=function(a,b){return this.graphicsView.hitTest(a,b)},a.prototype.attach=function(){var a=this;this.layer.createGraphicsController({layerView:this}).then(function(b){a.graphicsView.view=a.view;a.graphicsView.graphics=b.graphics})},a.prototype.detach=function(){this.graphicsView.graphics=null},a.prototype.update=
function(a){},a.prototype.moveStart=function(){},a.prototype.viewChange=function(){},a.prototype.moveEnd=function(){},a=d([b.subclass("esri.views.2d.layers.GraphicsLayerView2D")],a)}(b.declared(g))})},"esri/views/2d/layers/LayerView2D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/watchUtils ../../layers/LayerView".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(){var a=
null!==f&&f.apply(this,arguments)||this;return a.attached=!1,a.moving=!1,a.updateRequested=!1,a}return h(a,f),a.prototype.initialize=function(){var a=this;this.when(function(){a.requestUpdate()});g.init(this,"suspended",function(b){a.container.visible=!b;!b&&a.updateRequested&&a.view.requestLayerViewUpdate(a)},!0);g.init(this,"fullOpacity",function(b){a.container.opacity=b},!0);var b=function(){this.notifyChange("rendering")}.bind(this);this.container.on("post-render",b);this.container.on("will-render",
b)},a.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach());this.updateRequested=!1;this.layer=null},Object.defineProperty(a.prototype,"rendering",{get:function(){return this.isRendering()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0}),a.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=
!0,this.suspended||this.view.requestLayerViewUpdate(this))},a.prototype.processUpdate=function(a){return this.isFulfilled()&&!this.isResolved()?void(this.updateRequested=!1):(this._set("updateParameters",a),void(this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(a))))},a.prototype.isUpdating=function(){return!1},a.prototype.isRendering=function(){return this.attached&&(this.moving||this.container.renderRequested)},a.prototype.canResume=function(){var a=this.inherited(arguments),
b=this.layer;if(a&&null!=b.minScale&&null!=b.minScale){var a=this.view.scale,d=b.minScale,b=b.maxScale,f=!d,g=!b;!f&&d>=a&&(f=!0);!g&&a>=b&&(g=!0);a=f&&g}return a},d([b.property()],a.prototype,"attached",void 0),d([b.property()],a.prototype,"container",void 0),d([b.property()],a.prototype,"moving",void 0),d([b.property({dependsOn:["moving"]})],a.prototype,"rendering",null),d([b.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],a.prototype,"suspended",void 0),d([b.property({readOnly:!0})],
a.prototype,"updateParameters",void 0),d([b.property()],a.prototype,"updateRequested",void 0),d([b.property({dependsOn:["updateRequested","attached"]})],a.prototype,"updating",null),d([b.property()],a.prototype,"view",void 0),a=d([b.subclass("esri.views.2d.layers.LayerView2D")],a)}(b.declared(k))})},"esri/views/2d/layers/FeatureLayerView2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/has ../../../core/accessorSupport/decorators ../../../core/Collection ../../../core/Error ../../../core/HandleRegistry ../../../core/promiseUtils ../../../core/requireUtils ../../../Graphic ../../../layers/graphics/QueryEngine ./LayerView2D ../../layers/RefreshableLayerView ./support/FeaturesView2D ../engine/DOMContainer".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x){function y(a){return a&&a.update}return function(n){function l(){var b=null!==n&&n.apply(this,arguments)||this;return b._handles=new a,b.container=new x,b}return h(l,n),l.prototype.highlight=function(a,b){var c,e=this;b=this.featuresView;return a instanceof q?c=[a.getAttribute(this.layer.objectIdField)]:"number"==typeof a?c=[a]:k.isCollection(a)?c=a.map(function(a){return a.getAttribute(e.layer.objectIdField)}).toArray():Array.isArray(a)&&0<a.length&&(c=
"number"==typeof a[0]?a:a.map(function(a){return a.getAttribute(e.layer.objectIdField)})),c&&c.length&&b&&b.highlight?b.highlight(c):{remove:function(){}}},l.prototype.queryGraphics=function(){return this._queryEngine?this._queryEngine.queryFeatures():this._rejectQuery()},l.prototype.queryFeatures=function(a){return this._queryEngine?this._queryEngine.queryFeatures(a):this._rejectQuery()},l.prototype.queryObjectIds=function(a){return this._queryEngine?this._queryEngine.queryObjectIds(a):this._rejectQuery()},
l.prototype.queryFeatureCount=function(a){return this._queryEngine?this._queryEngine.queryFeatureCount(a):this._rejectQuery()},l.prototype.queryExtent=function(a){return this._queryEngine?this._queryEngine.queryExtent(a):this._rejectQuery()},l.prototype.hitTest=function(a,b){return this.suspended||!this.featuresView?e.resolve():this.featuresView.hitTest(a,b)},l.prototype.update=function(a){y(this.controller)?this.controller.update(a):y(this.featuresView)&&this.featuresView.update(a)},l.prototype.attach=
function(){var a=this;this._canUseWebGL()?c.when(m,["./support/FeatureLayerView2DWebGL"]).then(function(b){b=b[0];if(a.attached)return(new b({layer:a.layer,view:a.view})).when()}).then(function(b){a.featuresView=b;a.container.addChild(b.container);b.attached=!0;b.attach()}):this.layer.createGraphicsController({layerView:this}).then(function(b){if(a.attached){a._set("controller",b);a.requestUpdate();var c=new v;c.mapView=a.view;c.graphics=b.graphics;c.layer=a.layer;c.renderer=a.layer.renderer;a.featuresView=
c;a._handles.add(a.layer.watch("renderer",function(){c.renderer=a.layer.renderer}));a._queryEngine=new t;a._queryEngine.features=b.graphics;a._queryEngine.objectIdField=a.layer.objectIdField;a.container.addChild(c.container)}})},l.prototype.detach=function(){this.container.removeAllChildren();this._handles.removeAll();this.featuresView&&(this.featuresView.destroy(),this.featuresView=null);this.controller&&(this.controller.destroy&&this.controller.destroy(),this._set("controller",null))},l.prototype.moveStart=
function(){this.requestUpdate()},l.prototype.viewChange=function(){this.requestUpdate()},l.prototype.moveEnd=function(){this.requestUpdate()},l.prototype.doRefresh=function(){if(!this.updateRequested&&!this.suspended){var a;if(a=this.controller)a=(a=this.controller.activeController)&&a.refresh;a&&this.controller.activeController.refresh()}},l.prototype.isUpdating=function(){return null==this.featuresView||!0===this.get("controller.updating")||this.featuresView.updateRequested||y(this.featuresView)&&
this.featuresView.isUpdating()},l.prototype._canUseWebGL=function(){return b("esri-featurelayer-webgl")&&b("esri-webgl")&&this._isRendererWebGLCompatible()&&(this.layer.capabilities.query.supportsQuantization&&("polygon"!==this.layer.geometryType||this.layer.capabilities.query.supportsCentroid)||this.layer.source&&"esri.layers.graphics.sources.CSVSource"===this.layer.source.declaredClass)},l.prototype._isRendererWebGLCompatible=function(){var a=this.layer.renderer;return a?-1===["simple","class-breaks",
"unique-value"].indexOf(a.type)?!1:!0:!1},l.prototype._rejectQuery=function(){return e.reject(new f("FeatureLayerView2D","Not ready to execute query"))},d([g.property({readOnly:!0})],l.prototype,"controller",void 0),d([g.property()],l.prototype,"featuresView",void 0),d([g.property({dependsOn:["controller.updating","featuresView","featuresView.updating"]})],l.prototype,"updating",void 0),l=d([g.subclass("esri.views.2d.layers.FeatureLayerView2D")],l)}(g.declared(r,u))})},"esri/layers/graphics/QueryEngine":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Error ../../core/promiseUtils ../../geometry/support/graphicsUtils".split(" "),
function(m,l,h,d,b,g,k,f,a){return function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;return a.features=null,a.objectIdField=null,a}return h(c,e),c.prototype.queryFeatures=function(a){if(this.features)if(a)if(this._isSupportedQuery(a)){var b=this._createFilters(a);a=b.length?this._executeQuery(a,b):this._rejectQuery("Invalid query")}else a=this._rejectQuery("Unsupported query");else a=this._returnAllFeatures();else a=this._rejectQuery("Engine not initialized");return a},c.prototype.queryObjectIds=
function(a){return this.objectIdField?this.queryFeatures(a).then(this._getObjectIds.bind(this)):this._rejectQuery("Unsupported query")},c.prototype.queryFeatureCount=function(a){return this.queryFeatures(a).then(function(a){return a.length})},c.prototype.queryExtent=function(a){var b=this;return this.queryFeatures(a).then(function(a){return{count:a.length,extent:b._getExtent(a)}})},c.prototype._returnAllFeatures=function(){return f.resolve(this.features.toArray())},c.prototype._executeQuery=function(a,
b){var c=this,e=this.features.filter(function(e){return b.every(function(b){return b.call(c,e,a)})});return f.resolve(e.toArray())},c.prototype._isSupportedQuery=function(a){var b=!0;return(null!=a.distance||null!=a.geometryPrecision||a.groupByFieldsForStatistics&&a.groupByFieldsForStatistics.length||null!=a.maxAllowableOffset||a.multipatchOption||null!=a.num||a.orderByFields&&a.orderByFields.length||a.outFields&&a.outFields.length||a.outSpatialReference||a.outStatistics&&a.outStatistics.length||
a.pixelSize||a.quantizationParameters||a.relationParameter||a.returnDistinctValues||null!=a.start||a.text||a.timeExtent||a.where||a.objectIds&&a.objectIds.length&&!this.objectIdField)&&(b=!1),b},c.prototype._createFilters=function(a){var b=[];return a.objectIds&&a.objectIds.length&&b.push(this._createObjectIdFilter()),a.geometry&&"extent"===a.geometry.type&&"intersects"===a.spatialRelationship&&b.push(this._createExtentFilter()),b},c.prototype._createExtentFilter=function(){return function(a,b){a=
a.geometry;b=b.geometry;return a&&b.intersects(a)}},c.prototype._createObjectIdFilter=function(){var a=this;return function(b,c){b=b.attributes;return-1<c.objectIds.indexOf(b&&b[a.objectIdField])}},c.prototype._rejectQuery=function(a){return f.reject(new k(this.declaredClass,a))},c.prototype._getObjectIds=function(a){var b=this.objectIdField,c=[];return a.forEach(function(a){a=(a=a.attributes)&&a[b];null!=a&&c.push(a)}),c},c.prototype._getExtent=function(b){return b.length?a.graphicsExtent(b):null},
d([b.property()],c.prototype,"features",void 0),d([b.property()],c.prototype,"objectIdField",void 0),c=d([b.subclass("esri.layers.graphics.QueryEngine")],c)}(b.declared(g))})},"esri/views/layers/RefreshableLayerView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor".split(" "),function(m,l,h,d,b,g){return function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;return a.refreshTimestamp=
null,a}return h(f,g),f.prototype.refresh=function(a){void 0===a&&(a=Date.now());this._set("refreshTimestamp",a);this.doRefresh&&this.doRefresh()},d([b.property()],f.prototype,"layer",void 0),d([b.aliasOf("layer.refreshInterval")],f.prototype,"refreshInterval",void 0),d([b.property({readOnly:!0})],f.prototype,"refreshTimestamp",void 0),f=d([b.subclass("esri.layers.mixins.RefreshableLayerView")],f)}(b.declared(g))})},"esri/views/2d/layers/support/FeaturesView2D":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Collection ../../../../core/HandleRegistry ../../../../core/promiseUtils ../../../../core/Logger ../../../../renderers/support/renderingInfoUtils ../../../../Graphic ../../../layers/GraphicsView ../../engine/graphics/GFXSurface ../../engine/graphics/GFXGroup ../../engine/graphics/GFXObject ../../../../symbols/Symbol3D".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){var x=a.getLogger("esri.views.2d.layers.support.FeaturesView2D");return function(a){function n(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];var e=a.apply(this,b)||this;return e._handles=new k,e._backgroundGroup=new r,e._frontGroup=new r,e._frontObjects=new Map,e._backgroundObjects=new Map,e._scale=0,e.container=new t,e.layer=null,e.container.addChild(e._backgroundGroup),e.container.addChild(e._frontGroup),e.watch("graphics",function(){return e._reset()}),
e.watch("renderer",function(){return e._resymbolize()}),e.watch("mapView.scale, mapView.stationary",function(){return e._applyScale()}),e}return h(n,a),n.prototype.destroy=function(){this.renderer=this.graphics=null},n.prototype.hitTest=function(a,b){a+=this.mapView.position[0]-window.pageXOffset;b+=this.mapView.position[1]-window.pageYOffset;return(a=this.container.hitTest(a,b))?f.resolve(a.graphic):f.resolve()},n.prototype._reset=function(){var a=this;this._handles.remove("graphics");this.graphics&&
(this.graphics.forEach(this._add,this),this._handles.add(this.graphics.on("change",function(b){return a._graphicsChangeHandler(b)}),"graphics"))},n.prototype._applyScale=function(){var a=this.get("mapView.scale"),b=this.get("mapView.stationary");a!==this._scale&&b&&(this._scale=a,this._resymbolize())},n.prototype._resymbolize=function(){var a=this;this.graphics&&this.graphics.forEach(function(b){return a._resymbolizeGraphic(b)})},n.prototype._add=function(a){if(!this._frontObjects.has(a)){var b=e.getRenderingInfo(a,
{renderer:this.renderer,viewingMode:"map",scale:this.mapView.state.scale,resolution:this.mapView.state.resolution,spatialReference:this.mapView.spatialReference});if(b){if(b.symbol instanceof v)return void x.error("3D symbols are not supported with MapView");var c=new u;c.graphic=a;c.renderingInfo=b;this._frontObjects.set(a,c);this._frontGroup.addChild(c);var d=b.renderer&&b.renderer.backgroundFillSymbol;d&&c.isPolygonMarkerSymbol&&(c=new u,c.graphic=a,null!=b.outlineSize?c.renderingInfo={symbol:d,
size:[b.outlineSize,b.outlineSize,b.outlineSize]}:c.renderingInfo={symbol:d},this._backgroundObjects.set(a,c),this._backgroundGroup.addChild(c))}}},n.prototype._remove=function(a){var b=this._frontObjects.get(a);b&&(this._frontObjects["delete"](a),this._frontGroup.removeChild(b),this._backgroundObjects.has(a))&&(b=this._backgroundObjects.get(a),this._backgroundObjects["delete"](a),this._backgroundGroup.removeChild(b))},n.prototype._resymbolizeGraphic=function(a){if(this._frontObjects.has(a)){var b=
e.getRenderingInfo(a,{renderer:this.renderer,viewingMode:"map",scale:this.mapView.state.scale,resolution:this.mapView.state.resolution,spatialReference:this.mapView.spatialReference});if(b){if(b.symbol instanceof v)return void x.error("3D symbols are not supported with MapView");var c=this._frontObjects.get(a);c&&(c.renderingInfo=b);var d=b.renderer&&b.renderer.backgroundFillSymbol,f=this._backgroundObjects.get(a);d&&c.isPolygonMarkerSymbol?(f||(f=new u,f.graphic=a,this._backgroundObjects.set(a,f),
this._backgroundGroup.addChild(f)),null!=b.outlineSize?f.renderingInfo={symbol:d,size:[b.outlineSize,b.outlineSize,b.outlineSize]}:f.renderingInfo={symbol:d}):!d&&f&&(this._backgroundObjects["delete"](a),this._backgroundGroup.removeChild(f))}}},n.prototype._graphicsChangeHandler=function(a){for(var b=a.removed,c=0,e=a.added;c<e.length;c++)a=e[c],this._add(a);for(c=0;c<b.length;c++)a=b[c],this._remove(a)},d([b.property()],n.prototype,"container",void 0),d([b.property(),b.cast(g.ofType(c))],n.prototype,
"graphics",void 0),d([b.property()],n.prototype,"layer",void 0),d([b.property()],n.prototype,"mapView",void 0),n=d([b.subclass("esri.views.2d.layers.support.FeaturesView2D")],n)}(b.declared(q))})},"esri/renderers/support/renderingInfoUtils":function(){define(["require","exports"],function(m,l){function h(b,d){if(!b||b.symbol)return null;d=d.renderer;return b&&d&&d.getObservationRenderer?d.getObservationRenderer(b):d}function d(b,d){if(b.symbol)return b.symbol;var g=h(b,d);return g&&g.getSymbol(b,
d)}Object.defineProperty(l,"__esModule",{value:!0});l.getRenderer=h;l.getSymbol=d;l.getRenderingInfo=function(b,g){var k=h(b,g),f=d(b,g);if(!f)return null;f={renderer:k,symbol:f};if(k){if(k.colorInfo&&(f.color=k.getColor(b).toRgba()),k.sizeInfo){var a=k.getSize(b);f.size=[a,a,a]}if(k.visualVariables){b=k.getVisualVariableValues(b,g);a=["proportional","proportional","proportional"];for(g=0;g<b.length;g++){var e=b[g],k=e.variable,c=e.value;"color"===k.type?f.color=c.toRgba():"size"===k.type?"outline"===
k.target?f.outlineSize=c:(e=k.axis,k=k.useSymbolValue?"symbolValue":c,"width"===e?a[0]=k:"depth"===e?a[1]=k:"height"===e?a[2]=k:"width-and-depth"===e?a[0]=a[1]=k:a[0]=a[1]=a[2]=k):"opacity"===k.type?f.opacity=c:"rotation"===k.type&&"tilt"===k.axis?f.tilt=c:"rotation"===k.type&&"roll"===k.axis?f.roll=c:"rotation"===k.type&&(f.heading=c)}(isFinite(a[0])||isFinite(a[1])||isFinite(a[2]))&&(f.size=a)}}return f}})},"esri/views/2d/layers/TiledLayerView2D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/ObjectPool ../../../core/Error ../../../core/promiseUtils ./LayerView2D ../tiling/TileInfoView ../tiling/TileKey ../tiling/TileQueue ../tiling/TileStrategy ../engine/Bitmap ../engine/BitmapSource ../engine/BitmapContainer ../engine/Canvas2DContainer ../engine/Tiled ../../layers/RefreshableLayerView".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n){var w=function(a){function b(b){b=a.call(this,b)||this;return b.key=new c(0,0,0,0),b}return h(b,a),b.prototype.acquire=function(a){},b.prototype.release=function(){this.key.set(0,0,0,0)},b.pool=new g(b,!0),b}(y(r));return function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;return b._tileStrategy=null,b._tileInfoView=null,b._fetchQueue=null,b._tileRequests=new Map,b.container=new x,b.layer=null,b}return h(c,a),c.prototype.initialize=
function(){var a,b=this.layer.tileInfo;(b=b&&b.spatialReference)||(a=new k("layerview:tiling-information-missing","The layer doesn't provide tiling information",{layer:this.layer}));b.equals(this.view.spatialReference)||(a=new k("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}));a&&this.addResolvingPromise(f.reject(a))},c.prototype.hitTest=function(a,b){return null},c.prototype.update=function(a){this._fetchQueue.pause();
this._fetchQueue.state=a.state;this._tileStrategy.update(a);this._fetchQueue.resume();this.notifyChange("updating")},c.prototype.attach=function(){var a=this;this._tileContainer=new v;this.container.addChild(this._tileContainer);this._tileInfoView=new e(this.layer.tileInfo,this.layer.fullExtent);this._fetchQueue=new q({tileInfoView:this._tileInfoView,process:function(b){return a.fetchTile(b)}});this._tileStrategy=new t({cachePolicy:"keep",acquireTile:function(b){return a.acquireTile(b)},releaseTile:function(b){return a.releaseTile(b)},
tileInfoView:this._tileInfoView})},c.prototype.detach=function(){this._tileStrategy.destroy();this._fetchQueue.clear();this.container.removeChild(this._tileContainer);this._fetchQueue=this._tileStrategy=this._tileInfoView=this._tileContainer=null},c.prototype.moveStart=function(){this.requestUpdate()},c.prototype.viewChange=function(){this.requestUpdate()},c.prototype.moveEnd=function(){this.requestUpdate()},c.prototype.doRefresh=function(){var a=this;this.updateRequested||this.suspended||(this._fetchQueue.reset(),
this._tileStrategy.tiles.forEach(function(b){return a._enqueueTileFetch(b)}),this.notifyChange("updating"))},c.prototype.isUpdating=function(){var a=!0;return this._tileRequests.forEach(function(b){a=a&&b.isFulfilled()}),!a},c.prototype.getTileBounds=function(a,b){return this._tileStrategy.tileInfoView.getTileBounds(a,b)},c.prototype.getTileCoords=function(a,b){return this._tileStrategy.tileInfoView.getTileCoords(a,b)},c.prototype.getTileResolution=function(a){return this._tileStrategy.tileInfoView.getTileResolution(a)},
c.prototype.acquireTile=function(a){var b=w.pool.acquire();return b.key.set(a),this._tileInfoView.getTileCoords(b.coords,b.key),b.resolution=this._tileInfoView.getTileResolution(b.key),c=this._tileInfoView.tileInfo.size,b.width=c[0],b.height=c[1],this._enqueueTileFetch(b),this.requestUpdate(),b;var c},c.prototype.releaseTile=function(a){var b=this,c=this._tileRequests.get(a);c&&!c.isFulfilled()&&c.cancel();this._tileRequests["delete"](a);this._tileContainer.removeChild(a);a.once("detach",function(){w.pool.release(a);
b.requestUpdate()});this.requestUpdate()},c.prototype.fetchTile=function(a){var b=this,c=this.layer.tilemapCache;if(c){var e=a.level,d=a.row,f=a.col;return c.fetchAvailabilityUpsample(e,d,f,a).then(function(){return b._fetchImage(a)}).otherwise(function(){return a.level=e,a.row=d,a.col=f,b._fetchImage(a)})}return this._fetchImage(a)},c.prototype._enqueueTileFetch=function(a){var b=this;if(!this._fetchQueue.has(a.key)){var c=this._fetchQueue.push(a.key).then(function(c){a.source=c;a.once("attach",
function(){return b.requestUpdate()});b._tileContainer.addChild(a);b.requestUpdate()});this._tileRequests.set(a,c)}},c.prototype._fetchImage=function(a){var b=this;return this.layer.fetchTile(a.level,a.row,a.col,{timestamp:this.refreshTimestamp}).then(function(c){c=u.pool.acquire(c);return c.coords=b.getTileCoords(c.coords,a),c.resolution=b.getTileResolution(a),c})},c=d([b.subclass("esri.views.2d.layers.TiledLayerView2D")],c)}(b.declared(a,n))})},"esri/views/2d/tiling/TileInfoView":function(){define("require exports ./LODInfo ./TileKey ./TileSpan ./TileCoverage".split(" "),
function(m,l,h,d,b,g){var k=function(){function a(a,b,d,f,g,k,h,l){this.x=a;this.ymin=b;this.ymax=d;this.invM=f;this.leftAdjust=g;this.rightAdjust=k;this.leftBound=h;this.rightBound=l}return a.create=function(b,c){b[1]>c[1]&&(h=[c,b],b=h[0],c=h[1]);h=b[0];b=b[1];var e=c[0];c=c[1];var d=e-h,f=c-b,f=0!==f?d/f:0,g=(Math.ceil(b)-b)*f,k=(Math.floor(b)-b)*f;return new a(h,Math.floor(b),Math.ceil(c),f,0>d?g:k,0>d?k:g,0>d?e:h,0>d?h:e);var h},a.prototype.incrRow=function(){this.x+=this.invM},a.prototype.getLeftCol=
function(){return Math.max(this.x+this.leftAdjust,this.leftBound)},a.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)},a}(),f=[[0,0],[0,0],[0,0],[0,0]];return function(){function a(a,b){var c=this;this.tileInfo=a;this.fullExtent=b;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var e=a.lods.slice();e.sort(function(a,b){return b.scale-a.scale});var d=this._lodInfos=e.map(function(c){return h.create(a,c,b)});e.forEach(function(a,
b){c._infoByLevel[a.level]=d[b];c._infoByScale[a.scale]=d[b];c.scales[b]=a.scale},this);this._wrap=a.isWrappable}return a.prototype.getTileBounds=function(a,b){var c=this._infoByLevel[b.level];return c?c.getTileBounds(a,b):a},a.prototype.getTileCoords=function(a,b){var c=this._infoByLevel[b.level];return c?c.getTileCoords(a,b):a},a.prototype.getTileCoverage=function(a){var c,e,d,h=this.getClosestInfoForScale(a.scale),l=g.pool.acquire(h),v=this._wrap;c=+(1/0);var m=-(1/0),y=l.spans;f[0][0]=f[0][1]=
f[1][1]=f[3][0]=0;f[1][0]=f[2][0]=a.size[0];f[2][1]=f[3][1]=a.size[1];for(var n=0;n<f.length;n++){var w=f[n];a.toMap(w,w);w[0]=h.getColumnForX(w[0]);w[1]=h.getRowForY(w[1])}a=[];w=3;for(n=0;4>n;n++){if(f[n][1]!==f[w][1]){var z=k.create(f[n],f[w]);c=Math.min(z.ymin,c);m=Math.max(z.ymax,m);void 0===a[z.ymin]&&(a[z.ymin]=[]);a[z.ymin].push(z)}w=n}if(null==c||null==m||100<m-c)return null;for(w=[];m>c;){null!=a[c]&&(w=w.concat(a[c]));e=+(1/0);d=-(1/0);for(n=w.length-1;0<=n;n--)z=w[n],e=Math.min(e,z.getLeftCol()),
d=Math.max(d,z.getRightCol());if(e=Math.floor(e),d=Math.floor(d),c>=h.first[1]&&c<=h.last[1])if(v)if(h.size[0]<h.worldSize[0])for(z=Math.floor(d/h.worldSize[0]),n=Math.floor(e/h.worldSize[0]);z>=n;n++)y.push(new b(c,Math.max(h.getFirstColumnForWorld(n),e),Math.min(h.getLastColumnForWorld(n),d)));else y.push(new b(c,e,d));else e>h.last[0]||d<h.first[0]||(e=Math.max(e,h.first[0]),d=Math.min(d,h.last[0]),y.push(new b(c,e,d)));c+=1;for(n=w.length-1;0<=n;n--)z=w[n],z.ymax>=c?z.incrRow():w.splice(n,1)}return l},
a.prototype.getTileIdAtParent=function(a,b){b=d.pool.acquire(b);var c=this._infoByLevel[b.level];if(a.resolution<c.resolution)throw Error("Cannot calculate parent tile. destination LOD's resolution "+a.resolution+" is not a parent resolution of "+c.resolution);return a.resolution===c.resolution?b.id:d.getId(a.level,Math.floor(b.row*c.resolution/a.resolution+.01),Math.floor(b.col*c.resolution/a.resolution+.01),b.world)},a.prototype.getTileParentId=function(a){a=d.pool.acquire(a);var b=this._lodInfos.indexOf(this._infoByLevel[a.level])-
1;if(0>b)return d.pool.release(a),null;b=this.getTileIdAtParent(this._lodInfos[b],a);return d.pool.release(a),b},a.prototype.getTileResolution=function(a){return(a=this._infoByLevel[a.level])?a.resolution:-1},a.prototype.getTileScale=function(a){return(a=this._infoByLevel[a.level])?a.scale:-1},a.prototype.intersects=function(a,b){var c=d.pool.acquire(b);b=this._infoByLevel[c.level];var e=a.lodInfo;if(e.resolution>b.resolution){var f=d.pool.acquire(this.getTileIdAtParent(e,c)),g=e.denormalizeCol(f.col,
f.world);b=a.spans.some(function(a){return a.row===f.row&&a.colFrom<=g&&a.colTo>=g});return d.pool.release(c),d.pool.release(f),b}if(e.resolution<b.resolution){var k=a.spans.reduce(function(a,b){return a[0]=Math.min(a[0],b.row),a[1]=Math.max(a[1],b.row),a[2]=Math.min(a[2],b.colFrom),a[3]=Math.max(a[3],b.colTo),a},[+(1/0),-(1/0),+(1/0),-(1/0)]);a=k[0];var h=k[1],l=k[2],k=k[3],n=b.denormalizeCol(c.col,c.world),w=e.getColumnForX(b.getXForColumn(n)),m=e.getRowForY(b.getYForRow(c.row)),n=e.getColumnForX(b.getXForColumn(n+
1))-1;b=e.getRowForY(b.getYForRow(c.row+1))-1;return d.pool.release(c),!(w>k||l>n||m>h||a>b)}var C=e.denormalizeCol(c.col,c.world);b=a.spans.some(function(a){return a.row===c.row&&a.colFrom<=C&&a.colTo>=C});return d.pool.release(c),b},a.prototype.getClosestInfoForScale=function(a){var b=this.scales;return this._infoByScale[a]?this._infoByScale[a]:(a=b.reduce(function(b,c,e,d){return Math.abs(c-a)<Math.abs(b-a)?c:b},b[0]),this._infoByScale[a])},a}()})},"esri/views/2d/tiling/LODInfo":function(){define(["require",
"exports","./TileKey","../../../geometry/support/spatialReferenceUtils"],function(m,l,h,d){function b(b,d,f){return b[0]=d,b[1]=f,b}return function(){function g(b,d,a,e,c,g,h,l,u,v,m,y){this.level=b;this.resolution=d;this.scale=a;this.origin=e;this.first=c;this.last=g;this.size=h;this.norm=l;this.worldStart=u;this.worldEnd=v;this.worldSize=m;this.wrap=y}return g.create=function(k,f,a){var e=d.getInfo(k.spatialReference),c=[k.origin.x,k.origin.y],h=[k.size[0]*f.resolution,k.size[1]*f.resolution],l=
[-(1/0),-(1/0)],r=[+(1/0),+(1/0)],u=[+(1/0),+(1/0)];a&&(b(l,Math.max(0,Math.floor((a.xmin-c[0])/h[0])),Math.max(0,Math.floor((c[1]-a.ymax)/h[1]))),b(r,Math.max(0,Math.floor((a.xmax-c[0])/h[0])),Math.max(0,Math.floor((c[1]-a.ymin)/h[1]))),b(u,r[0]-l[0]+1,r[1]-l[1]+1));var v,m,y,n;return k.isWrappable?(v=[Math.ceil(Math.round(2*e.origin[1]/f.resolution)/k.size[0]),u[1]],m=[Math.floor((e.origin[0]-c[0])/h[0]),l[1]],y=[v[0]+m[0]-1,r[1]],n=!0):(m=l,y=r,v=u,n=!1),new g(f.level,f.resolution,f.scale,c,l,
r,u,h,m,y,v,n)},g.prototype.normalizeCol=function(b){if(!this.wrap)return b;var d=this.worldSize[0];return 0>b?d-1-Math.abs((b+1)%d):b%d},g.prototype.denormalizeCol=function(b,d){return this.wrap?this.worldSize[0]*d+b:b},g.prototype.getWorldForColumn=function(b){return this.wrap?Math.floor(b/this.worldSize[0]):0},g.prototype.getFirstColumnForWorld=function(b){return b*this.worldSize[0]+this.first[0]},g.prototype.getLastColumnForWorld=function(b){return b*this.worldSize[0]+this.first[0]+this.size[0]-
1},g.prototype.getColumnForX=function(b){return(b-this.origin[0])/this.norm[0]},g.prototype.getXForColumn=function(b){return this.origin[0]+b*this.norm[0]},g.prototype.getRowForY=function(b){return(this.origin[1]-b)/this.norm[1]},g.prototype.getYForRow=function(b){return this.origin[1]-b*this.norm[1]},g.prototype.getTileBounds=function(b,d){d=h.pool.acquire(d);var a=this.denormalizeCol(d.col,d.world),e=d.row,c=this.getXForColumn(a),f=this.getYForRow(e+1),a=this.getXForColumn(a+1),e=this.getYForRow(e);
return b[0]=c,b[1]=f,b[2]=a,b[3]=e,h.pool.release(d),b},g.prototype.getTileCoords=function(d,f){f=h.pool.acquire(f);return b(d,this.getXForColumn(this.denormalizeCol(f.col,f.world)),this.getYForRow(f.row)),h.pool.release(f),d},g}()})},"esri/views/2d/tiling/TileSpan":function(){define(["require","exports","../../../core/ObjectPool"],function(m,l,h){return function(){function d(b,d,k){this.row=b;this.colFrom=d;this.colTo=k}return d.pool=new h(d,!0),d}()})},"esri/views/2d/tiling/TileCoverage":function(){define(["require",
"exports","../../../core/ObjectPool","../../../core/ArrayPool","./TileSpan"],function(m,l,h,d,b){return function(){function g(b){this.lodInfo=b;this.spans=d.acquire()}return g.prototype.release=function(){for(var g=0,f=this.spans;g<f.length;g++)b.pool.release(f[g]);d.release(this.spans)},g.prototype.forEach=function(b,d){var a=this.spans,e=this.lodInfo,c=e.level;if(0!==a.length)for(var f=0;f<a.length;f++)for(var g=a[f],k=g.row,h=g.colTo,g=g.colFrom;h>=g;g++)b.call(d,c,k,e.normalizeCol(g),e.getWorldForColumn(g))},
g.pool=new h(g,!0),g}()})},"esri/views/2d/tiling/TileQueue":function(){define(["require","exports","../../../core/QueueProcessor"],function(m,l,h){function d(b,a){return b.length=0,a.forEach(function(a){return b.push(a)}),b}var b=new Set,g=[],k=new Map;return function(){function f(a){var b=this;this.tileInfoView=a.tileInfoView;this._queue=new h({concurrency:a.concurrency||6,process:a.process,peeker:function(a){return b._peek(a)}})}return Object.defineProperty(f.prototype,"length",{get:function(){return this._queue.length},
enumerable:!0,configurable:!0}),f.prototype.clear=function(){this._queue.clear()},f.prototype.find=function(a,b){return this._queue.find(a)},f.prototype.has=function(a){return this._queue.has(a)},f.prototype.pause=function(){return this._queue.pause()},f.prototype.push=function(a){return this._queue.push(a)},f.prototype.reset=function(){return this._queue.reset()},f.prototype.resume=function(){return this._queue.resume()},f.prototype._peek=function(a){var e=this;if(!this.state)return a[0];var c=this.tileInfoView,
f=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY;a.forEach(function(a){var c=e.tileInfoView.getTileScale(a);k.has(c)||(k.set(c,[]),f=Math.max(c,f),h=Math.min(c,h));k.get(c).push(a);b.add(c)});var l=this.state.scale;k.has(l)||(d(g,b),g.sort(),l=g.reduce(function(a,b,c,e){return Math.abs(b-l)<Math.abs(a-l)?b:a},g[0]));l=Math.min(l,f);l=Math.max(l,h);a=k.get(l);var u=c.getClosestInfoForScale(l),v=u.getColumnForX(this.state.center[0]),m=u.getRowForY(this.state.center[1]);return a.sort(function(a,
b){var c=u.denormalizeCol(a.col,a.world),e=u.denormalizeCol(b.col,b.world);return Math.sqrt((v-c)*(v-c)+(m-a.row)*(m-a.row))-Math.sqrt((v-e)*(v-e)+(m-b.row)*(m-b.row))}),b.clear(),k.clear(),a[0]},f}()})},"esri/core/QueueProcessor":function(){define(["require","exports","dojo/Deferred","./Queue"],function(m,l,h,d){var b={};return function(){function g(b){this._apiPromises=new Map;this._resolvingPromises=new Map;this._isPaused=!1;this.concurrency=1;b.concurrency&&(this.concurrency=b.concurrency);this._queue=
new d(b.peeker?{peeker:b.peeker}:void 0);this.process=b.process}return Object.defineProperty(g.prototype,"length",{get:function(){return this._resolvingPromises.size+this._queue.length},enumerable:!0,configurable:!0}),g.prototype.clear=function(){this._queue.clear();var b=[];this._resolvingPromises.forEach(function(d){return b.push(d)});this._resolvingPromises.clear();b.forEach(function(b){return b.cancel()});b.length=0;this._apiPromises.forEach(function(d){return b.push(d)});this._apiPromises.clear();
b.forEach(function(b){return b.cancel()})},g.prototype.find=function(b,d){var a=this,e=void 0;return this._apiPromises.forEach(function(c,f){b.call(d,f)&&(e=a._apiPromises.get(f).promise)}),e},g.prototype.has=function(b){return this._apiPromises.has(b)},g.prototype.pause=function(){this._isPaused=!0},g.prototype.push=function(b){var d=this;if(this._apiPromises.has(b))return this._apiPromises.get(b).promise;var a=new h(function(a){d._resolvingPromises.has(b)?d._resolvingPromises.get(b).cancel(a):(d._remove(b),
d._scheduleNext())});return this._add(b,a),this._scheduleNext(),a.promise},g.prototype.reset=function(){var d=[];this._resolvingPromises.forEach(function(b){return d.push(b)});this._resolvingPromises.clear();d.forEach(function(d){return d.cancel(b)})},g.prototype.resume=function(){this._isPaused=!1;this._scheduleNext()},g.prototype._scheduleNext=function(){this._isPaused||this._next()},g.prototype._next=function(){this._resolvingPromises.size!==this.concurrency&&this._process(this._queue.pop())},
g.prototype._process=function(d){var f=this;if(null!=d){var a=this._apiPromises.get(d),e=this.process(d);e&&"function"==typeof e.then?(this._resolvingPromises.set(d,e),e.then(function(b){a.resolve(b);f._remove(d);f._scheduleNext()},function(c){c===b?f._process(d):(a.reject(c),f._remove(d),f._scheduleNext())})):(a.resolve(e),this._remove(d));this._scheduleNext()}},g.prototype._add=function(b,d){this._apiPromises.set(b,d);this._queue.push(b)},g.prototype._remove=function(b){this._queue.remove(b);this._apiPromises["delete"](b);
this._resolvingPromises["delete"](b)},g}()})},"esri/core/Queue":function(){define(["require","exports"],function(m,l){return function(){function h(d){this._items=[];this._itemSet=new Set;this._peeker=function(b){return b[0]};this._length=0;d&&d.peeker&&(this._peeker=d.peeker)}return Object.defineProperty(h.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),h.prototype.clear=function(){this._itemSet.clear();this._length=this._items.length=0},h.prototype.peek=function(){return 0!==
this._length?this._peeker(this._items):void 0},h.prototype.push=function(d){this.contains(d)||this._add(d)},h.prototype.contains=function(d){return 0<this._length&&this._itemSet.has(d)},h.prototype.pop=function(){if(0!==this._length){var d=this.peek();return this._remove(d),d}},h.prototype.remove=function(d){this.contains(d)&&this._remove(d)},h.prototype._add=function(d){this._items.push(d);this._itemSet.add(d);this._length++},h.prototype._remove=function(d){this._itemSet["delete"](d);this._items.splice(this._items.indexOf(d),
1);this._length--},h}()})},"esri/views/2d/tiling/TileStrategy":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./TileKey"],function(m,l,h,d){var b=new d(0,0,0,0),g=new Map,k=[],f=[];return function(){function a(a){this._previousResolution=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.tileIndex=new Map;this.tiles=[];this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;a.cachePolicy&&(this.cachePolicy=a.cachePolicy)}return a.prototype.destroy=
function(){this.tileIndex.clear()},a.prototype.update=function(a){var c=this,e=this.tileIndex,d=this.tileInfoView.getTileCoverage(a.state);if(d){var h=d.spans,l=d.lodInfo,v=l.level,m=a.state.resolution,y=!a.stationary&&m>this._previousResolution;this._previousResolution=m;e.forEach(function(a){return a.visible=!0});this.tiles.length=0;g.clear();var n=0,w=0;if(0<h.length)for(var z=0;z<h.length;z++){a=h[z];for(var C=a.row,B=a.colTo,F=a.colFrom;B>=F;F++)n++,a=b.set(v,C,l.normalizeCol(F),l.getWorldForColumn(F)).id,
e.has(a)?(m=e.get(a),m.attached?(g.set(a,m),w++):m.attached||y||this._addParentTile(a,g)):(m=this.acquireTile(b),this.tileIndex.set(a,m),y||this._addParentTile(a,g))}var G=w===n;f.length=0;k.length=0;e.forEach(function(a,e){if(b.set(e),!g.has(e)){var h=c.tileInfoView.intersects(d,b);!h||!y&&G?"purge"===c.cachePolicy?k.push(e):(b.level>v||!h)&&k.push(e):a.attached?f.push(e):y&&k.push(e)}});for(h=0;h<f.length;h++)a=f[h],(m=e.get(a))&&m.attached&&g.set(a,m);for(h=0;h<k.length;h++)a=k[h],m=e.get(a),this.releaseTile(m),
e["delete"](a);g.forEach(function(a){return c.tiles.push(a)});e.forEach(function(a){g.has(a.key.id)||(a.visible=!1)});f.length=0;k.length=0;g.clear()}},a.prototype.clear=function(){var a=this,b=this.tileIndex;b.forEach(function(b){a.releaseTile(b)});b.clear()},a.prototype._addParentTile=function(a,b){for(var c=null;a=this.tileInfoView.getTileParentId(a),a;)if(this.tileIndex.has(a)&&(c=this.tileIndex.get(a),c&&c.attached)){b.has(c.key.id)||b.set(c.key.id,c);break}},a}()})},"esri/views/2d/engine/Bitmap":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(m,l,h,d){var b=[0,0];return function(d){function g(b){var a=d.call(this)||this;return a.source=b,a.coords=[0,0],a.resolution=0,a.rotation=0,a.width=0,a.height=0,a}return h(g,d),g.prototype.doRender=function(b){this.source&&this.source.ready&&null!=b.context&&this.renderCanvas2D(b)},g.prototype.renderCanvas2D=function(d){var a=this.source,e=d.context,c=d.state;d=c.rotation;var f=this.resolution/c.resolution*c.pixelRatio;
if(!(.05>f)){e.save();var g=c.toScreen(b,this.coords),c=g[0],g=g[1];(.99<f&&1.01>f?e.translate(Math.round(c),Math.round(g)):(e.translate(c,g),e.scale(f,f)),d)&&e.rotate(d*Math.PI/180);a.rotation&&(e.translate(.5*this.width,.5*this.height),e.rotate(-a.rotation*Math.PI/180),e.translate(.5*-this.width,.5*-this.height));d=(this.coords[0]-a.coords[0])/a.resolution;f=-(this.coords[1]-a.coords[1])/a.resolution;c=this.resolution/a.resolution*a.width;g=this.resolution/a.resolution*a.height;e.clearRect(0,0,
this.width,this.height);a.draw(e,Math.round(d),Math.round(f),Math.round(c),Math.round(g),0,0,this.width,this.height);e.restore()}},g}(d)})},"esri/views/2d/engine/BitmapSource":function(){define(["require","exports","../../../core/ObjectPool"],function(m,l,h){return function(){function d(b){this.coords=[0,0];this._height=0;this.pixelRatio=1;this._width=this.rotation=this.resolution=0;this.data=b}return d.prototype.release=function(){this.data=null},Object.defineProperty(d.prototype,"data",{get:function(){return this._data},
set:function(b){this._data=b;this._width=this._height=0;b&&(b instanceof HTMLImageElement?(this._width=b.naturalWidth,this._height=b.naturalHeight):0<b.width&&0<b.height&&(this._width=b.width,this._height=b.height))},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"ready",{get:function(){return 0<this._width},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,
"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),d.prototype.draw=function(b,d,k,f,a,e,c,h,l){this.ready&&f&&a&&h&&l&&b.drawImage(this._data,d,k,f,a,e,c,h,l)},d.pool=new h(d,!0),d}()})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Container ../ViewState ../viewStateUtils".split(" "),function(m,l,h,d,b,g,k){var f=[0,0];return function(a){function b(){var b=null!==a&&
a.apply(this,arguments)||this;return b._childrenCanvas=null,b._childrenRenderParameters={budget:null,context:null,devicePixelRatio:1,state:new g,stationary:!0},b}return h(b,a),b.prototype.attach=function(b){return this._childrenCanvas||(this._childrenCanvas=document.createElement("canvas"),this._childrenRenderParameters.context=this._childrenCanvas.getContext("2d")),a.prototype.attach.call(this,b)},b.prototype.detach=function(b){a.prototype.detach.call(this,b);this._childrenCanvas=null;this._childrenRenderParameters.context=
null},b.prototype.doRender=function(b){this.visible&&a.prototype.doRender.call(this,b)},b.prototype.prepareChildrenRenderParameters=function(a){var b=this._childrenCanvas,c=this._childrenRenderParameters,e=a.state,d=e.pixelRatio,g=c.state;g.copy(e);var h=k.getOuterSize(f,e),e=h[0],h=h[1];return e*=d,h*=d,g.size=f,g.viewpoint.rotation=0,b.width!==e||b.height!==h?(b.width=e,b.height=h):c.context.clearRect(0,0,e,h),c.budget=a.budget,c.devicePixelRatio=a.devicePixelRatio,c},b.prototype.beforeRenderChildren=
function(a,b){this.sortChildren(function(a,b){return b.resolution-a.resolution})},b.prototype.afterRenderChildren=function(a,b){var c=a.context;a=a.state;var e=b.context;b=b.state;0===a.rotation?c.drawImage(e.canvas,0,0):(c.save(),c.translate(.5*a.width,.5*a.height),c.rotate(a.rotation*Math.PI/180),c.translate(.5*-a.width,.5*-a.height),c.drawImage(e.canvas,.5*(a.width-b.width),.5*(a.height-b.height)),c.restore())},b}(b)})},"esri/views/2d/viewStateUtils":function(){define(["require","exports"],function(m,
l){Object.defineProperty(l,"__esModule",{value:!0});var h=Math.PI/180;l.snapToPixel=function(d,b,g){var k=g.resolution;g=g.size;return d[0]=k*(Math.round(b[0]/k)+g[0]%2*.5),d[1]=k*(Math.round(b[1]/k)+g[1]%2*.5),d};l.getOuterSize=function(d,b){var g=b.rotation*h,k=Math.abs(Math.cos(g)),g=Math.abs(Math.sin(g)),f=b.size;b=f[0];f=f[1];return d[0]=Math.round(f*g+b*k),d[1]=Math.round(f*k+b*g),d};l.getBBox=function(d,b,g,k){var f=b[0];b=b[1];var a=k[0];k=k[1];g*=.5;return d[0]=f-g*a,d[1]=b-g*k,d[2]=f+g*
a,d[3]=b+g*k,d};l.bboxIntersects=function(d,b){var g=d[1],k=d[2],f=d[3],a=b[0],e=b[1],c=b[3];return!(d[0]>b[2]||a>k||g>c||e>f)}})},"esri/views/2d/engine/Canvas2DContainer":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../ViewState","./Container"],function(m,l,h,d,b){return function(b){function g(){var f=null!==b&&b.apply(this,arguments)||this;return f._childrenRenderParameters={budget:null,context:null,devicePixelRatio:1,state:new d,stationary:!0},f.hidpi=!1,f}return h(g,
b),g.prototype.createElement=function(){var b=document.createElement("canvas");return b.setAttribute("class","esri-display-object"),b},g.prototype.setElement=function(b){this.element=b},g.prototype.doRender=function(d){var a=this.element,e=a.style;if(!this.visible)return void(e.display="none");var c=d.state,f=d.devicePixelRatio,g=c.width,c=c.height;a.width=g*(this.hidpi?f:1);a.height=c*(this.hidpi?f:1);e.display="block";e.opacity=""+this.opacity;e.width=g+"px";e.height=c+"px";b.prototype.doRender.call(this,
d)},g.prototype.prepareChildrenRenderParameters=function(b){var a=this._childrenRenderParameters;return a.budget=b.budget,a.context=this.element.getContext("2d"),a.devicePixelRatio=b.devicePixelRatio,a.state.copy(b.state),a.state.pixelRatio=this.hidpi?b.devicePixelRatio:1,a.stationary=b.stationary,a},g.prototype.beforeRenderChildren=function(b,a){b=a.context;var e=a.state;if(b.save(),e.spatialReference.isWrappable){var c=e.width;a=e.height;var d=e.pixelRatio,f=this.hidpi?d:1,d=e.rotation*Math.PI/
180,g=Math.round(c*f*Math.abs(Math.cos(d))+a*f*Math.abs(Math.sin(d))),e=e.worldScreenWidth*f;g>e&&(c=c*f*.5,a=a*f*.5,d&&(b.translate(c,a),b.rotate(d),b.translate(-c,-a)),b.beginPath(),b.rect(c-.5*e,a-.5*g,e,g),b.closePath(),d&&(b.translate(c,a),b.rotate(-d),b.translate(-c,-a)),b.clip("evenodd"))}},g.prototype.afterRenderChildren=function(b,a){a.context.restore()},g.prototype.renderChild=function(b,a){a.context.save();b.processRender(a);a.context.restore()},g}(b)})},"esri/views/2d/engine/Tiled":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","./Evented"],function(m,l,h,d){return function(b){b=function(b){function d(){for(var d=0;d<arguments.length;d++);return b.call(this)||this}return h(d,b),d}(b);return d.EventedMixin(b)}})},"esri/identity/IdentityManager":function(){define(["./IdentityManagerDialog","../kernel","./OAuthSignInHandler","../core/declare"],function(m,l,h,d){m=new m;return l.id=d.safeMixin(m,h),l.id})},"esri/identity/IdentityManagerDialog":function(){define("dojo/_base/kernel ../core/declare dojo/Deferred dojo/_base/lang dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ../kernel ../core/lang ../core/Error ../core/domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/identity dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){return l([r],{declaredClass:"esri.identity.IdentityManager",constructor:function(a){d.mixin(this,a)},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e{info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e{invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e{lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e{lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e{lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e{lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
signIn:function(a,e,d){this._nls||(this._nls=u);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.emit("dialog-create"));var f=this._loginDialog,g=d&&d.error,k=d&&d.token,l=new h(function(){f.onCancel()});return f.open?(a=new c("identity-manager:busy","BUSY"),l.reject(a),l.promise):(q.hide(f.errMsg_),g&&g.details&&403==g.details.httpStatus&&k&&(b.set(f.errMsg_,"innerHTML",this._nls.forbidden),q.show(f.errMsg_)),f.dfd_=l,f.serverInfo_=e,f.resUrl_=a,f.admin_=d&&d.isAdmin,
b.set(f.resLink_,{title:a,innerHTML:"("+(this.getResourceName(a)||this._nls.lblItem)+")"}),b.set(f.serverLink_,{title:e.server,innerHTML:(-1!==e.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":e.server)+" "}),f.txtPwd_.set("value",""),f.show(),l.promise)},_createLoginDialog:function(){var d=this._nls,h=e.substitute(d,this._dialogContent),h=e.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},
h),l=new f({title:d.title,content:h,"class":" esri-widget esriSignInDialog esriIdentityDialog",style:"width: 18em;",esriIdMgr_:this,onShow:function(){this.domNode.classList.add("esriIdentityDialog--visible")},onHide:function(){this.domNode.classList.remove("esriIdentityDialog--visible")},keypressed_:function(a){a.charOrCode===g.ENTER&&this.execute_()},execute_:function(){var c=this.txtUser_.get("value"),g=this.txtPwd_.get("value"),k=this.dfd_,h=this;if(this.form_.validate()&&c&&g){this.btnSubmit_.set("label",
d.lblSigning);var l=a.id.findCredential(h.resUrl_,c),r=function(a){h.btnSubmit_.set("label",d.lblOk);h.btnSubmit_.set("disabled",!1);q.hide(h.errMsg_);h.hide();f._DialogLevelManager.hide(h);var b=h.serverInfo_;h.dfd_=h.serverInfo_=h.generateDfd_=h.resUrl_=null;var g,n,r,u=l;a&&(g=a.token,n=e.isDefined(a.expires)?Number(a.expires):null,r=!!a.ssl,u?(u.userId=c,u.token=g,u.expires=n,u.validity=a.validity,u.ssl=r,u.creationTime=(new Date).getTime()):u=new t({userId:c,server:b.server,token:g,expires:n,
ssl:r,isAdmin:h.admin_,validity:a.validity}));k.resolve(u)};if(l&&!l._enqueued)return void r();h.btnSubmit_.set("disabled",!0);h.generateDfd_=a.id.generateToken(this.serverInfo_,{username:c,password:g},{isAdmin:this.admin_}).then(r).then(null,function(a){h.btnSubmit_.set("disabled",!1);h.generateDfd_=null;h.btnSubmit_.set("label",d.lblOk);b.set(h.errMsg_,"innerHTML",a&&a.details&&a.details.httpStatus?d.invalidUser:d.noAuthService);q.show(h.errMsg_)})}},cancel_:function(){l.generateDfd_&&l.generateDfd_.cancel();
var a=l.dfd_,b=l.resUrl_,e=l.serverInfo_;l.btnSubmit_.set("disabled",!1);l.dfd_=l.serverInfo_=l.generateDfd_=l.resUrl_=null;q.hide(l.errMsg_);f._DialogLevelManager.hide(l);l.esriIdMgr_.emit("dialog-cancel",{resourceUrl:b,serverInfo:e});b=new c("identity-manager:user-aborted","ABORTED");a.reject(b)}}),h=l.domNode;return l.form_=k.byNode(m.query(".esriIdForm",h)[0]),l.txtUser_=k.byNode(m.query(".esriIdUser",h)[0]),l.txtPwd_=k.byNode(m.query(".esriIdPwd",h)[0]),l.btnSubmit_=k.byNode(m.query(".esriIdSubmit",
h)[0]),l.btnCancel_=k.byNode(m.query(".esriIdCancel",h)[0]),l.resLink_=m.query(".resLink",h)[0],l.serverLink_=m.query(".serverLink",h)[0],l.errMsg_=m.query(".esriErrorMsg",h)[0],l.connect(l.txtUser_,"onKeyPress",l.keypressed_),l.connect(l.txtPwd_,"onKeyPress",l.keypressed_),l.connect(l.btnSubmit_,"onClick",l.execute_),l.connect(l.btnCancel_,"onClick",l.onCancel),l.connect(l,"onCancel",l.cancel_),l}})})},"dijit/registry":function(){define(["dojo/_base/array","dojo/_base/window","./main"],function(m,
l,h){var d={},b={},g={length:0,add:function(d){if(b[d.id])throw Error("Tried to register widget with id\x3d\x3d"+d.id+" but that id is already registered");b[d.id]=d;this.length++},remove:function(d){b[d]&&(delete b[d],this.length--)},byId:function(d){return"string"==typeof d?b[d]:d},byNode:function(d){return b[d.getAttribute("widgetId")]},toArray:function(){var d=[],f;for(f in b)d.push(b[f]);return d},getUniqueId:function(g){var f;do f=g+"_"+(g in d?++d[g]:d[g]=0);while(b[f]);return"dijit"==h._scopeName?
f:h._scopeName+"_"+f},findWidgets:function(d,f){function a(c){for(c=c.firstChild;c;c=c.nextSibling)if(1==c.nodeType){var d=c.getAttribute("widgetId");d?(d=b[d])&&e.push(d):c!==f&&a(c)}}var e=[];a(d);return e},_destroyAll:function(){h._curFocus=null;h._prevFocus=null;h._activeStack=[];m.forEach(g.findWidgets(l.body()),function(b){b._destroyed||(b.destroyRecursive?b.destroyRecursive():b.destroy&&b.destroy())})},getEnclosingWidget:function(d){for(;d;){var f=1==d.nodeType&&d.getAttribute("widgetId");
if(f)return b[f];d=d.parentNode}return null},_hash:b};return h.registry=g})},"dijit/main":function(){define(["dojo/_base/kernel"],function(m){return m.dijit})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/touch dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P,Q,T){function O(){}var S=new b;S.resolve(!0);C=d("dijit._DialogBase"+(v("dojo-bidi")?"_NoBidi":""),[F,N,M,G],{templateString:T,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:C.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=c.getLocalization("dijit","common");t.mixin(this,a);this.inherited(arguments)},postCreate:function(){a.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);h.after(this,"onExecute",t.hitch(this,"hide"),!0);h.after(this,"onCancel",t.hitch(this,"hide"),!0);r(this.closeButtonNode,
x.press,function(a){a.stopPropagation()});this._modalconnects=[]},onLoad:function(){this.resize();this._position();this.autofocus&&Y.isTop(this)&&(this._getFocusItems(),z.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();z.focus(this._firstFocusItem)},_endDrag:function(){var a=f.position(this.domNode),b=y.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var a=
this.domNode;this.titleBar&&this.draggable?(this._moveable=new (6==v("ie")?w:n)(a,{handle:this.titleBar}),h.after(this._moveable,"onMoveStop",t.hitch(this,"_endDrag"),!0)):k.add(a,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":l.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:t.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!k.contains(this.ownerDocumentBody,"dojoMove")){var b=
this.domNode,c=y.getBox(this.ownerDocument),e=this._relativePosition,d=f.position(b);a.set(b,{left:Math.floor(c.l+(e?Math.min(e.x,c.w-d.w):(c.w-d.w)/2))+"px",top:Math.floor(c.t+(e?Math.min(e.y,c.h-d.h):(c.h-d.h)/2))+"px"})}},_onKey:function(a){if(a.keyCode==q.TAB){this._getFocusItems();var b=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(z.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b!=this._lastFocusItem||
a.shiftKey||(z.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}else this.closable&&a.keyCode==q.ESCAPE&&(this.onCancel(),a.stopPropagation(),a.preventDefault())},show:function(){if(this.open)return S.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),Y.hide(this));var c=y.get(this.ownerDocument);this._modalconnects.push(r(c,"scroll",t.hitch(this,"resize",null)));this._modalconnects.push(r(this.domNode,
"keydown",t.hitch(this,"_onKey")));a.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();var d;this._fadeInDeferred=new b(t.hitch(this,function(){d.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,O);c=this._fadeInDeferred.promise;d=e.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:t.hitch(this,function(){Y.show(this,this.underlayAttrs)}),onEnd:t.hitch(this,function(){this.autofocus&&Y.isTop(this)&&(this._getFocusItems(),
z.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return c},hide:function(){if(!this._alreadyInitialized||!this.open)return S.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new b(t.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,O);this._fadeOutDeferred.then(t.hitch(this,"onHide"));var c=this._fadeOutDeferred.promise;a=e.fadeOut({node:this.domNode,duration:this.duration,
onEnd:t.hitch(this,function(){this.domNode.style.display="none";Y.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var d;d=this._modalconnects.pop();)d.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return c},resize:function(b){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!b){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),l.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(b){b&&a.set(b,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var c=y.getBox(this.ownerDocument);c.w*=this.maxRatio;c.h*=this.maxRatio;var e=f.position(this.domNode);e.w>=c.w||e.h>=c.h?(b={w:Math.min(e.w,c.w),h:Math.min(e.h,c.h)},this._shrunk=!0):this._shrunk=!1}if(b){f.setMarginBox(this.domNode,
b);c=[];this.titleBar&&c.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&c.push({domNode:this.actionBarNode,region:"bottom"});e={domNode:this.containerNode,region:"center"};c.push(e);var d=Q.marginBox2contentBox(this.domNode,b);Q.layoutChildren(this.domNode,d,c);this._singleChild?(c=Q.marginBox2contentBox(this.containerNode,e),this._singleChild.resize({w:c.w,h:c.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();v("touch")||b||this._position()}},
_layoutChildren:function(){l.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();Y.hide(this);this.inherited(arguments)}});v("dojo-bidi")&&(C=d("dijit._DialogBase",C,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},
_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var H=d("dijit.Dialog",[P,C],{});H._DialogBase=C;var Y=H._DialogLevelManager={_beginZIndex:950,show:function(b,c){W[W.length-1].focus=z.curNode;var e=W[W.length-1].dialog?W[W.length-1].zIndex+2:H._DialogLevelManager._beginZIndex;a.set(b.domNode,"zIndex",e);R.show(c,e-1);W.push({dialog:b,underlayAttrs:c,zIndex:e})},hide:function(a){if(W[W.length-1].dialog==a){W.pop();var b=W[W.length-
1];1==W.length?R.hide():R.show(b.underlayAttrs,b.zIndex-1);if(a.refocus&&(a=b.focus,!b.dialog||a&&g.isDescendant(a,b.dialog.domNode)||(b.dialog._getFocusItems(),a=b.dialog._firstFocusItem),a))try{a.focus()}catch(A){}}else b=l.indexOf(l.map(W,function(a){return a.dialog}),a),-1!=b&&W.splice(b,1)},isTop:function(a){return W[W.length-1].dialog==a}},W=H._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];z.watch("curNode",function(a,b,c){a=W[W.length-1].dialog;if(c&&a&&!a._fadeOutDeferred&&c.ownerDocument==
a.ownerDocument){do if(c==a.domNode||k.contains(c,"dijitPopup"))return;while(c=c.parentNode);a.focus()}});v("dijit-legacy-requires")&&u(0,function(){m(["dijit/TooltipDialog"])});return H})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),function(m,l,h,d,b,g,k,f,a,e){function c(a,b,c){return c?function(a,b){return g(a,c,b)}:u?function(c,e){var d=g(c,b,function(a){e.call(this,a);G=(new Date).getTime()}),
f=g(c,a,function(a){(!G||(new Date).getTime()>G+1E3)&&e.call(this,a)});return{remove:function(){d.remove();f.remove()}}}:function(b,c){return g(b,a,c)}}function q(a){do if(void 0!==a.dojoClick)return a;while(a=a.parentNode)}function t(a,b,c){if(!f.isRight(a)){var k=q(a.target);if(x=!a.target.disabled&&k&&k.dojoClick)if(n=(y="useTarget"==x)?k:a.target,y&&a.preventDefault(),w=a.changedTouches?a.changedTouches[0].pageX-e.global.pageXOffset:a.clientX,z=a.changedTouches?a.changedTouches[0].pageY-e.global.pageYOffset:
a.clientY,C=("object"==typeof x?x.x:"number"==typeof x?x:0)||4,B=("object"==typeof x?x.y:"number"==typeof x?x:0)||4,!v){a=function(a){e.doc.addEventListener(a,function(b){var c=b.target;x&&!b._dojo_click&&(new Date).getTime()<=F+1E3&&("INPUT"!=c.tagName||!d.contains(c,"dijitOffScreen"))&&(b.stopPropagation(),b.stopImmediatePropagation&&b.stopImmediatePropagation(),"click"==a&&("INPUT"!=c.tagName||"radio"==c.type&&(d.contains(c,"dijitCheckBoxInput")||d.contains(c,"mblRadioButton"))||"checkbox"==c.type&&
(d.contains(c,"dijitCheckBoxInput")||d.contains(c,"mblCheckBox")))&&"TEXTAREA"!=c.tagName&&"AUDIO"!=c.tagName&&"VIDEO"!=c.tagName&&b.preventDefault())},!0)};var l=function(a){x=y?h.isDescendant(e.doc.elementFromPoint(a.changedTouches?a.changedTouches[0].pageX-e.global.pageXOffset:a.clientX,a.changedTouches?a.changedTouches[0].pageY-e.global.pageYOffset:a.clientY),n):x&&(a.changedTouches?a.changedTouches[0].target:a.target)==n&&Math.abs((a.changedTouches?a.changedTouches[0].pageX-e.global.pageXOffset:
a.clientX)-w)<=C&&Math.abs((a.changedTouches?a.changedTouches[0].pageY-e.global.pageYOffset:a.clientY)-z)<=B};v=!0;e.doc.addEventListener(b,function(a){f.isRight(a)||(l(a),y&&a.preventDefault())},!0);e.doc.addEventListener(c,function(a){if(!f.isRight(a)&&(l(a),x)){var b=function(b){var c=document.createEvent("MouseEvents");c._dojo_click=!0;c.initMouseEvent(b,!0,!0,a.view,a.detail,e.screenX,e.screenY,e.clientX,e.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null);return c};F=(new Date).getTime();
var c=y?n:a.target;"LABEL"===c.tagName&&(c=h.byId(c.getAttribute("for"))||c);var e=a.changedTouches?a.changedTouches[0]:a,d=b("mousedown"),k=b("mouseup"),q=b("click");setTimeout(function(){g.emit(c,"mousedown",d);g.emit(c,"mouseup",k);g.emit(c,"click",q);F=(new Date).getTime()},0)}},!0);a("click");a("mousedown");a("mouseup")}}}k("ios");var r=function(){var a={},b;for(b in{down:1,move:1,up:1,cancel:1,over:1,out:1})a[b]="pointer"+b;return a}(),u=k("touch-events"),v,x,y=!1,n,w,z,C,B,F,G;k("touch")&&
a(function(){e.doc.addEventListener(r.down,function(a){t(a,r.move,r.up)},!0)});l={press:c("mousedown","touchstart",r.down),move:c("mousemove","dojotouchmove",r.move),release:c("mouseup","dojotouchend",r.up),cancel:c(f.leave,"touchcancel",r.cancel),over:c("mouseover","dojotouchover",r.over),out:c("mouseout","dojotouchout",r.out),enter:f._eventHandler(c("mouseover","dojotouchover",r.over)),leave:f._eventHandler(c("mouseout","dojotouchout",r.out))};return m.touch=l})},"dojo/window":function(){define("./_base/lang ./sniff ./_base/window ./dom ./dom-geometry ./dom-style ./dom-construct".split(" "),
function(m,l,h,d,b,g,k){l.add("rtl-adjust-position-for-verticalScrollBar",function(a,e){a=h.body(e);e=k.create("div",{style:{overflow:"scroll",overflowX:"visible",direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},a,"last");var c=k.create("div",{style:{overflow:"hidden",direction:"ltr"}},e,"last"),d=0!=b.position(c).x;e.removeChild(c);a.removeChild(e);return d});l.add("position-fixed-support",function(a,e){a=h.body(e);e=k.create("span",{style:{visibility:"hidden",
position:"fixed",left:"1px",top:"1px"}},a,"last");var c=k.create("span",{style:{position:"fixed",left:"0",top:"0"}},e,"last"),d=b.position(c).x!=b.position(e).x;e.removeChild(c);a.removeChild(e);return d});var f={getBox:function(a){a=a||h.doc;var e="BackCompat"==a.compatMode?h.body(a):a.documentElement,c=b.docScroll(a);if(l("touch")){var d=f.get(a);a=d.innerWidth||e.clientWidth;e=d.innerHeight||e.clientHeight}else a=e.clientWidth,e=e.clientHeight;return{l:c.x,t:c.y,w:a,h:e}},get:function(a){if(l("ie")&&
f!==document.parentWindow){a.parentWindow.execScript("document._parentWindow \x3d window;","Javascript");var b=a._parentWindow;a._parentWindow=null;return b}return a.parentWindow||a.defaultView},scrollIntoView:function(a,e){try{a=d.byId(a);var c=a.ownerDocument||h.doc,f=h.body(c),k=c.documentElement||f.parentNode,r=l("ie")||0,u=l("webkit");if(a!=f&&a!=k){var v="BackCompat"==c.compatMode,m=Math.min(f.clientWidth||k.clientWidth,k.clientWidth||f.clientWidth),y=Math.min(f.clientHeight||k.clientHeight,
k.clientHeight||f.clientHeight),c=u||v?f:k,n=e||b.position(a),w=a.parentNode;e=function(a){return 6>=r||7==r&&v?!1:l("position-fixed-support")&&"fixed"==g.get(a,"position").toLowerCase()};var z=this,u=function(a,b,c){"BODY"==a.tagName||"HTML"==a.tagName?z.get(a.ownerDocument).scrollBy(b,c):(b&&(a.scrollLeft+=b),c&&(a.scrollTop+=c))};if(!e(a))for(;w;){w==f&&(w=c);var C=b.position(w),B=e(w),F="rtl"==g.getComputedStyle(w).direction.toLowerCase();if(w==c)C.w=m,C.h=y,c==k&&r&&F&&(C.x+=c.offsetWidth-C.w),
C.x=0,C.y=0;else{var G=b.getPadBorderExtents(w);C.w-=G.w;C.h-=G.h;C.x+=G.l;C.y+=G.t;var N=w.clientWidth,M=C.w-N;0<N&&0<M&&(F&&l("rtl-adjust-position-for-verticalScrollBar")&&(C.x+=M),C.w=N);N=w.clientHeight;M=C.h-N;0<N&&0<M&&(C.h=N)}B&&(0>C.y&&(C.h+=C.y,C.y=0),0>C.x&&(C.w+=C.x,C.x=0),C.y+C.h>y&&(C.h=y-C.y),C.x+C.w>m&&(C.w=m-C.x));var R=n.x-C.x,P=n.y-C.y,Q=R+n.w-C.w,T=P+n.h-C.h,O,S;0<Q*R&&(w.scrollLeft||w==c||w.scrollWidth>w.offsetHeight)&&(O=Math[0>R?"max":"min"](R,Q),F&&8==r&&!v&&(O=-O),S=w.scrollLeft,
u(w,O,0),O=w.scrollLeft-S,n.x-=O);0<T*P&&(w.scrollTop||w==c||w.scrollHeight>w.offsetHeight)&&(O=Math.ceil(Math[0>P?"max":"min"](P,T)),S=w.scrollTop,u(w,0,O),O=w.scrollTop-S,n.y-=O);w=w!=c&&!B&&w.parentNode}}}catch(H){console.error("scrollIntoView: "+H),a.scrollIntoView(!1)}}};m.setObject("dojo.window",f);return f})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../has ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){var r,u=function(){},u=function(a,b){"touchAction"in document.body.style?r="touchAction":"msTouchAction"in document.body.style&&(r="msTouchAction");u=function(a,b){a.style[r]=b};u(a,b)};return l("dojo.dnd.Moveable",[g],{handle:"",delay:0,skip:!1,constructor:function(a,b){this.node=d.byId(a);u(this.node,"none");b||(b={});this.handle=b.handle?d.byId(b.handle):null;this.handle||(this.handle=this.node);this.delay=0<b.delay?b.delay:0;this.skip=b.skip;this.mover=b.mover?
b.mover:q;this.events=[f(this.handle,e.press,h.hitch(this,"onMouseDown")),f(this.handle,"dragstart",h.hitch(this,"onSelectStart")),f(this.handle,"selectstart",h.hitch(this,"onSelectStart"))]},markupFactory:function(a,b,c){return new c(b,a)},destroy:function(){m.forEach(this.events,function(a){a.remove()});u(this.node,"");this.events=this.node=this.handle=null},onMouseDown:function(a){if(!this.skip||!c.isFormElement(a)){if(this.delay)this.events.push(f(this.handle,e.move,h.hitch(this,"onMouseMove")),
f(this.handle.ownerDocument,e.release,h.hitch(this,"onMouseUp"))),this._lastX=a.pageX,this._lastY=a.pageY;else this.onDragDetected(a);a.stopPropagation();a.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);a.stopPropagation();a.preventDefault()},onMouseUp:function(a){for(var b=0;2>b;++b)this.events.pop().remove();a.stopPropagation();a.preventDefault()},onSelectStart:function(a){this.skip&&
c.isFormElement(a)||(a.stopPropagation(),a.preventDefault())},onDragDetected:function(a){new this.mover(this.node,a,this)},onMoveStart:function(c){a.publish("/dnd/move/start",c);b.add(t.body(),"dojoMove");b.add(this.node,"dojoMoveItem")},onMoveStop:function(c){a.publish("/dnd/move/stop",c);b.remove(t.body(),"dojoMove");b.remove(this.node,"dojoMoveItem")},onFirstMove:function(){},onMove:function(a,b){this.onMoving(a,b);var c=a.node.style;c.left=b.l+"px";c.top=b.t+"px";this.onMoved(a,b)},onMoving:function(){},
onMoved:function(){}})})},"dojo/dnd/common":function(){define(["../sniff","../_base/kernel","../_base/lang","../dom"],function(m,l,h,d){var b=h.getObject("dojo.dnd",!0);b.getCopyKeyState=function(b){return b.metaKey};b._uniqueId=0;b.getUniqueId=function(){var g;do g=l._scopeName+"Unique"+ ++b._uniqueId;while(d.byId(g));return g};b._empty={};b.isFormElement=function(b){b=b.target;3==b.nodeType&&(b=b.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+b.tagName.toLowerCase()+
" ")};return b})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t){return l("dojo.dnd.Mover",[a],{constructor:function(a,b,d){function f(a){a.preventDefault();a.stopPropagation()}this.node=g.byId(a);this.marginBox={l:b.pageX,t:b.pageY};this.mouseButton=b.button;b=this.host=d;a=a.ownerDocument;this.events=[e(a,
c.move,h.hitch(this,"onFirstMove")),e(a,c.move,h.hitch(this,"onMouseMove")),e(a,c.release,h.hitch(this,"onMouseUp")),e(a,"dragstart",f),e(a.body,"selectstart",f)];t.autoScrollStart(a);if(b&&b.onMoveStart)b.onMoveStart(this)},onMouseMove:function(a){t.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){(d("webkit")&&2==this.mouseButton?0==a.button:this.mouseButton==a.button)&&this.destroy();a.preventDefault();
a.stopPropagation()},onFirstMove:function(a){var c=this.node.style,e,d=this.host;switch(c.position){case "relative":case "absolute":e=Math.round(parseFloat(c.left))||0;c=Math.round(parseFloat(c.top))||0;break;default:c.position="absolute";c=k.getMarginBox(this.node);e=b.doc.body;var g=f.getComputedStyle(e),h=k.getMarginBox(e,g),g=k.getContentBox(e,g);e=c.l-(g.l-h.l);c=c.t-(g.t-h.t)}this.marginBox.l=e-this.marginBox.l;this.marginBox.t=c-this.marginBox.t;if(d&&d.onFirstMove)d.onFirstMove(this,a);this.events.shift().remove()},
destroy:function(){m.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),function(m,l,h,d,b,g){var k={};m.setObject("dojo.dnd.autoscroll",k);k.getViewport=g.getBox;k.V_TRIGGER_AUTOSCROLL=32;k.H_TRIGGER_AUTOSCROLL=32;k.V_AUTOSCROLL_VALUE=16;k.H_AUTOSCROLL_VALUE=16;var f,a=h.doc,e=
Infinity,c=Infinity;k.autoScrollStart=function(b){a=b;f=g.getBox(a);b=h.body(a).parentNode;e=Math.max(b.scrollHeight-f.h,0);c=Math.max(b.scrollWidth-f.w,0)};k.autoScroll=function(b){var d=f||g.getBox(a),l=h.body(a).parentNode,q=0,m=0;b.clientX<k.H_TRIGGER_AUTOSCROLL?q=-k.H_AUTOSCROLL_VALUE:b.clientX>d.w-k.H_TRIGGER_AUTOSCROLL&&(q=Math.min(k.H_AUTOSCROLL_VALUE,c-l.scrollLeft));b.clientY<k.V_TRIGGER_AUTOSCROLL?m=-k.V_AUTOSCROLL_VALUE:b.clientY>d.h-k.V_TRIGGER_AUTOSCROLL&&(m=Math.min(k.V_AUTOSCROLL_VALUE,
e-l.scrollTop));window.scrollBy(q,m)};k._validNodes={div:1,p:1,td:1};k._validOverflow={auto:1,scroll:1};k.autoScrollNodes=function(a){for(var c,e,f,g,q,m=0,n=0,w=a.target;w;){if(1==w.nodeType&&w.tagName.toLowerCase()in k._validNodes){f=b.getComputedStyle(w);q=f.overflowX.toLowerCase()in k._validOverflow;g=f.overflowY.toLowerCase()in k._validOverflow;if(q||g)c=d.getContentBox(w,f),e=d.position(w,!0);if(q){f=Math.min(k.H_TRIGGER_AUTOSCROLL,c.w/2);q=a.pageX-e.x;if(l("webkit")||l("opera"))q+=h.body().scrollLeft;
m=0;0<q&&q<c.w&&(q<f?m=-f:q>c.w-f&&(m=f),w.scrollLeft+=m)}if(g){g=Math.min(k.V_TRIGGER_AUTOSCROLL,c.h/2);f=a.pageY-e.y;if(l("webkit")||l("opera"))f+=h.body().scrollTop;n=0;0<f&&f<c.h&&(f<g?n=-g:f>c.h-g&&(n=g),w.scrollTop+=n)}if(m||n)return}try{w=w.parentNode}catch(z){w=null}}k.autoScroll(a)};return k})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(m,l){var h=l.prototype.onMove;return m("dojo.dnd.TimedMoveable",l,{timeout:40,constructor:function(d,b){b||(b=
{});b.timeout&&"number"==typeof b.timeout&&0<=b.timeout&&(this.timeout=b.timeout)},onMoveStop:function(d){d._timer&&(clearTimeout(d._timer),h.call(this,d,d._leftTop));l.prototype.onMoveStop.apply(this,arguments)},onMove:function(d,b){d._leftTop=b;if(!d._timer){var g=this;d._timer=setTimeout(function(){d._timer=null;h.call(g,d,d._leftTop)},this.timeout)}}})})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x){var y,n,w=new (l([q,k],{curNode:null,activeStack:[],constructor:function(){var a=f.hitch(this,function(a){h.isDescendant(this.curNode,a)&&this.set("curNode",null);h.isDescendant(this.prevNode,a)&&this.set("prevNode",null)});m.before(g,"empty",a);m.before(g,"destroy",a)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(b,c){var e=this,d=b.document&&b.document.body;if(d){var f=a(b.document,"pointerdown",function(a){a&&
a.target&&null==a.target.parentNode||e._onTouchNode(c||a.target,"mouse")}),g=a(d,"focusin",function(a){if(a.target.tagName){var b=a.target.tagName.toLowerCase();"#document"!=b&&"body"!=b&&(u.isFocusable(a.target)?e._onFocusNode(c||a.target):e._onTouchNode(c||a.target))}}),k=a(d,"focusout",function(a){e._onBlurNode(c||a.target)});return{remove:function(){f.remove();g.remove();k.remove();d=f=g=k=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<y+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),
this._clearFocusTimer=setTimeout(f.hitch(this,function(){this.set("prevNode",this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<n+100||(this._clearActiveWidgetsTimer=setTimeout(f.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,c){n=(new Date).getTime();this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);b.contains(a,
"dijitPopup")&&(a=a.firstChild);var e=[];try{for(;a;){var f=d.get(a,"dijitPopupParent");if(f)a=v.byId(f).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===t.body())break;a=r.get(a.ownerDocument).frameElement}else{var g=a.getAttribute&&a.getAttribute("widgetId"),k=g&&v.byId(g);!k||"mouse"==c&&k.get("disabled")||e.unshift(g);a=a.parentNode}}}catch(R){}this._setStack(e,c)},_onFocusNode:function(a){a&&9!=a.nodeType&&(y=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),
delete this._clearFocusTimer),this._onTouchNode(a),a!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,b){var c=this.activeStack,e=c.length-1,d=a.length-1;if(a[d]!=c[e]){this.set("activeStack",a);var f;for(f=e;0<=f&&c[f]!=a[f];f--)if(e=v.byId(c[f]))e._hasBeenBlurred=!0,e.set("focused",!1),e._focusManager==this&&e._onBlur(b),this.emit("widget-blur",e,b);for(f++;f<=d;f++)if(e=v.byId(a[f]))e.set("focused",!0),e._focusManager==this&&e._onFocus(b),this.emit("widget-focus",
e,b)}},focus:function(a){if(a)try{a.focus()}catch(B){}}}));e(function(){var b=w.registerWin(r.get(document));c("ie")&&a(window,"unload",function(){b&&(b.remove(),b=null)})});x.focus=function(a){w.focus(a)};for(var z in w)/^_/.test(z)||(x.focus[z]="function"==typeof w[z]?f.hitch(w,z):w[z]);w.watch(function(a,b,c){x.focus[a]=c});return w})},"dojo/Stateful":function(){define(["./_base/declare","./_base/lang","./_base/array","./when"],function(m,l,h,d){return m("dojo.Stateful",null,{_attrPairNames:{},
_getAttrNames:function(b){var d=this._attrPairNames;return d[b]?d[b]:d[b]={s:"_"+b+"Setter",g:"_"+b+"Getter"}},postscript:function(b){b&&this.set(b)},_get:function(b,d){return"function"===typeof this[d.g]?this[d.g]():this[b]},get:function(b){return this._get(b,this._getAttrNames(b))},set:function(b,g){if("object"===typeof b){for(var k in b)b.hasOwnProperty(k)&&"_watchCallbacks"!=k&&this.set(k,b[k]);return this}k=this._getAttrNames(b);var f=this._get(b,k);k=this[k.s];var a;"function"===typeof k?a=
k.apply(this,Array.prototype.slice.call(arguments,1)):this[b]=g;if(this._watchCallbacks){var e=this;d(a,function(){e._watchCallbacks(b,f,g)})}return this},_changeAttrValue:function(b,d){var g=this.get(b);this[b]=d;this._watchCallbacks&&this._watchCallbacks(b,g,d);return this},watch:function(b,d){var g=this._watchCallbacks;if(!g)var f=this,g=this._watchCallbacks=function(a,b,d,k){var c=function(c){if(c){c=c.slice();for(var e=0,g=c.length;e<g;e++)c[e].call(f,a,b,d)}};c(g["_"+a]);k||c(g["*"])};d||"function"!==
typeof b?b="_"+b:(d=b,b="*");var a=g[b];"object"!==typeof a&&(a=g[b]=[]);a.push(d);b={};b.unwatch=b.remove=function(){var b=h.indexOf(a,d);-1<b&&a.splice(b,1)};return b}})})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),function(m,l,h,d,b,g,k){var f={_isElementShown:function(a){var b=d.get(a);return"hidden"!=b.visibility&&"collapsed"!=b.visibility&&"none"!=b.display&&"hidden"!=h.get(a,"type")},hasDefaultTabStop:function(a){switch(a.nodeName.toLowerCase()){case "a":return h.has(a,
"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var b;try{var c=a.contentDocument;if("designMode"in c&&"on"==c.designMode)return!0;b=c.body}catch(q){try{b=a.contentWindow.document.body}catch(t){return!1}}return b&&("true"==b.contentEditable||b.firstChild&&"true"==b.firstChild.contentEditable);default:return"true"==a.contentEditable}},effectiveTabIndex:function(a){if(!h.get(a,"disabled"))return h.has(a,"tabIndex")?+h.get(a,"tabIndex"):
f.hasDefaultTabStop(a)?0:void 0},isTabNavigable:function(a){return 0<=f.effectiveTabIndex(a)},isFocusable:function(a){return-1<=f.effectiveTabIndex(a)},_getTabNavigable:function(a){function b(a){return a&&"input"==a.tagName.toLowerCase()&&a.type&&"radio"==a.type.toLowerCase()&&a.name&&a.name.toLowerCase()}function c(a){return y[b(a)]||a}var d,k,l,u,m,x,y={},n=f._isElementShown,w=f.effectiveTabIndex,z=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(!(1!=a.nodeType||9>=g("ie")&&"HTML"!==a.scopeName)&&
n(a)){var c=w(a);if(0<=c){if(0==c)d||(d=a),k=a;else if(0<c){if(!l||c<u)u=c,l=a;if(!m||c>=x)x=c,m=a}c=b(a);h.get(a,"checked")&&c&&(y[c]=a)}"SELECT"!=a.nodeName.toUpperCase()&&z(a)}};n(a)&&z(a);return{first:c(d),last:c(k),lowest:c(l),highest:c(m)}},getFirstInTabbingOrder:function(a,b){a=f._getTabNavigable(l.byId(a,b));return a.lowest?a.lowest:a.first},getLastInTabbingOrder:function(a,b){a=f._getTabNavigable(l.byId(a,b));return a.last?a.last:a.highest}};b.mixin(k,f);return f})},"dijit/_base/manager":function(){define(["dojo/_base/array",
"dojo/_base/config","dojo/_base/lang","../registry","../main"],function(m,l,h,d,b){var g={};m.forEach("byId getUniqueId findWidgets _destroyAll byNode getEnclosingWidget".split(" "),function(b){g[b]=d[b]});h.mixin(g,{defaultDuration:l.defaultDuration||200});h.mixin(b,g);return b})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){function r(){}function u(a){return function(b,c,e,d){return b&&"string"==typeof c&&b[c]==r?b.on(c.substring(2).toLowerCase(),k.hitch(e,d)):a.apply(h,arguments)}}m.around(h,"connect",u);g.connect&&m.around(g,"connect",u);m=d("dijit._Widget",[c,q,t],{onClick:r,onDblClick:r,onKeyDown:r,onKeyPress:r,onKeyUp:r,onMouseDown:r,onMouseMove:r,onMouseOut:r,onMouseOver:r,onMouseLeave:r,onMouseEnter:r,onMouseUp:r,constructor:function(a){this._toConnect={};for(var b in a)this[b]===
r&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=a[b],delete a[b])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,this._toConnect[a]);delete this._toConnect},on:function(a,b){return this[this._onMap(a)]===r?h.connect(this.domNode,a.toLowerCase(),this,b):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,b){g.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.",
"","2.0");this.set(a,b)},attr:function(a,b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){g.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?f("[widgetId]",this.containerNode).map(e.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});b("dijit-legacy-requires")&&a(0,function(){require(["dijit/_base"])});
return m})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B){function F(a){return function(b){f[b?
"set":"remove"](this.domNode,a,b);this._set(a,b)}}t.add("dijit-legacy-requires",!r.isAsync);t.add("dojo-bidi",!1);t("dijit-legacy-requires")&&x(0,function(){m(["dijit/_base/manager"])});var G={};d=g("dijit._WidgetBase",[y,z],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:F("lang"),dir:"",_setDirAttr:F("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",
a)},attributeMap:{},_blankGif:d.blankGif||m.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var b=a.prototype,c=a._setterAttrs=[],a=a._onMap={},e;for(e in b.attributeMap)c.push(e);for(e in b)/^on/.test(e)&&(a[e.substring(2).toLowerCase()]=e),/^_set[A-Z](.*)Attr$/.test(e)&&(e=e.charAt(4).toLowerCase()+e.substr(5,e.length-9),b.attributeMap&&e in b.attributeMap||c.push(e))}},postscript:function(a,b){this.create(a,b)},create:function(a,b){this._introspect();
this.srcNodeRef=k.byId(b);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,u.mixin(this,a));this.postMixInProperties();this.id||(this.id=B.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=w.body(this.ownerDocument);B.add(this);
this.buildRendering();var c;this.domNode&&(this._applyAttributes(),(a=this.srcNodeRef)&&a.parentNode&&this.domNode!==a&&(a.parentNode.replaceChild(this.domNode,a),c=!0),this.domNode.setAttribute("widgetId",this.id));this.postCreate();c&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},b;for(b in this.params||{})a[b]=this._get(b);l.forEach(this.constructor._setterAttrs,function(b){if(!(b in a)){var c=this._get(b);c&&this.set(b,c)}},this);for(b in a)this.set(b,a[b])},postMixInProperties:function(){},
buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var b=this.baseClass.split(" ");this.isLeftToRight()||(b=b.concat(l.map(b,function(a){return a+"Rtl"})));a.add(this.domNode,b)}},postCreate:function(){},startup:function(){this._started||(this._started=!0,l.forEach(this.getChildren(),function(a){a._started||a._destroyed||!u.isFunction(a.startup)||(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=
!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function b(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.uninitialize();l.forEach(this._connects,u.hitch(this,"disconnect"));l.forEach(this._supportingWidgets,b);this.domNode&&l.forEach(B.findWidgets(this.domNode,this.containerNode),b);this.destroyRendering(a);B.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);
this.domNode&&(a?f.remove(this.domNode,"widgetId"):e.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||e.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){l.forEach(this.getChildren(),function(b){b.destroyRecursive&&b.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var b=this.domNode;u.isObject(a)?q.set(b,a):b.style.cssText=b.style.cssText?b.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(b,c,e){e=3<=
arguments.length?e:this.attributeMap[b];l.forEach(u.isArray(e)?e:[e],function(e){var d=this[e.node||e||"domNode"];switch(e.type||"attribute"){case "attribute":u.isFunction(c)&&(c=u.hitch(this,c));e=e.attribute?e.attribute:/^on[A-Z][a-zA-Z]*$/.test(b)?b.toLowerCase():b;d.tagName?f.set(d,e,c):d.set(e,c);break;case "innerText":d.innerHTML="";d.appendChild(this.ownerDocument.createTextNode(c));break;case "innerHTML":d.innerHTML=c;break;case "class":a.replace(d,c,this[b]);break;case "toggleClass":a.toggle(d,
e.className||b,c)}},this)},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this._get(a)},set:function(a,b){if("object"===typeof a){for(var c in a)this.set(c,a[c]);return this}c=this._getAttrNames(a);var e=this[c.s];if(u.isFunction(e))var d=e.apply(this,Array.prototype.slice.call(arguments,1));else{var e=this.focusNode&&!u.isFunction(this.focusNode)?"focusNode":"domNode",f=this[e]&&this[e].tagName,g;if((g=f)&&!(g=G[f])){g=this[e];var k={},h;for(h in g)k[h.toLowerCase()]=!0;
g=G[f]=k}h=g;c=a in this.attributeMap?this.attributeMap[a]:c.s in this?this[c.s]:h&&c.l in h&&"function"!=typeof b||/^aria-|^data-|^role$/.test(a)?e:null;null!=c&&this._attrToDom(a,b,c);this._set(a,b)}return d||this},_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var c=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});return b[a]={n:a+"Node",s:"_set"+c+"Attr",g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(a,b){var c=
this[a];this[a]=b;!this._created||c===b||c!==c&&b!==b||(this._watchCallbacks&&this._watchCallbacks(a,c,b),this.emit("attrmodified-"+a,{detail:{prevValue:c,newValue:b}}))},_get:function(a){return this[a]},emit:function(a,b,c){b=b||{};void 0===b.bubbles&&(b.bubbles=!0);void 0===b.cancelable&&(b.cancelable=!0);b.detail||(b.detail={});b.detail.widget=this;var e,d=this["on"+a];d&&(e=d.apply(this,c?c:[b]));this._started&&!this._beingDestroyed&&v.emit(this.domNode,a.toLowerCase(),b);return e},on:function(a,
b){var c=this._onMap(a);return c?h.after(this,c,b,!0):this.own(v(this.domNode,a,b))[0]},_onMap:function(a){var b=this.constructor,c=b._onMap;if(!c){var c=b._onMap={},e;for(e in b.prototype)/^on/.test(e)&&(c[e.replace(/^on/,"").toLowerCase()]=e)}return c["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?B.findWidgets(this.containerNode):[]},getParent:function(){return B.getEnclosingWidget(this.domNode.parentNode)},
connect:function(a,c,e){return this.own(b.connect(a,c,this,e))[0]},disconnect:function(a){a.remove()},subscribe:function(a,b){return this.own(n.subscribe(a,u.hitch(this,b)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():c.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=q.get(this.domNode,"display")},placeAt:function(a,b){var c=!a.tagName&&B.byId(a);!c||!c.addChild||b&&"number"!==typeof b?(a=c&&"domNode"in
c?c.containerNode&&!/after|before|replace/.test(b||"")?c.containerNode:c.domNode:k.byId(a,this.ownerDocument),e.place(this.domNode,a,b),!this._started&&(this.getParent()||{})._started&&this.startup()):c.addChild(this,b);return this},defer:function(a,b){var c=setTimeout(u.hitch(this,function(){c&&(c=null,this._destroyed||u.hitch(this,a)())}),b||0);return{remove:function(){c&&(clearTimeout(c),c=null);return null}}}});t("dojo-bidi")&&d.extend(C);return d})},"dijit/Destroyable":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare"],function(m,l,h){return h("dijit.Destroyable",null,{destroy:function(d){this._destroyed=!0},own:function(){var d=["destroyRecursive","destroy","remove"];m.forEach(arguments,function(b){function g(){f.remove();m.forEach(a,function(a){a.remove()})}var k,f=l.before(this,"destroy",function(a){b[k](a)}),a=[];b.then?(k="cancel",b.then(g,g)):m.forEach(d,function(e){"function"===typeof b[e]&&(k||(k=e),a.push(l.after(b,e,g,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),
function(m,l,h,d,b,g){m=d("dijit._OnDijitClickMixin",null,{connect:function(b,d,a){return this.inherited(arguments,[b,"ondijitclick"==d?g:d,a])}});m.a11yclick=g;return m})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(m,l,h,d){function b(b){if((b.keyCode===m.ENTER||b.keyCode===m.SPACE)&&!/input|button|textarea/i.test(b.target.nodeName))for(b=b.target;b;b=b.parentNode)if(b.dojoClick)return!0}var g;h(document,"keydown",function(d){b(d)?(g=d.target,d.preventDefault()):
g=null});h(document,"keyup",function(d){b(d)&&d.target==g&&(g=null,h.emit(d.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:d.ctrlKey,shiftKey:d.shiftKey,metaKey:d.metaKey,altKey:d.altKey,_origType:d.type}))});var k=function(b,a){b.dojoClick=!0;return h(b,"click",a)};k.click=k;k.press=function(b,a){var e=h(b,d.press,function(b){("mousedown"!=b.type||l.isLeft(b))&&a(b)}),c=h(b,"keydown",function(b){b.keyCode!==m.ENTER&&b.keyCode!==m.SPACE||a(b)});return{remove:function(){e.remove();c.remove()}}};
k.release=function(b,a){var e=h(b,d.release,function(b){("mouseup"!=b.type||l.isLeft(b))&&a(b)}),c=h(b,"keyup",function(b){b.keyCode!==m.ENTER&&b.keyCode!==m.SPACE||a(b)});return{remove:function(){e.remove();c.remove()}}};k.move=d.move;return k})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(m,l,h,d){d.extend(l,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});
return h("dijit._FocusMixin",null,{_focusManager:m})})},"dojo/uacss":function(){define(["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],function(m,l,h,d,b){var g=b.doc.documentElement;b=d("ie");var k=d("opera"),f=Math.floor,a=m.boxModel.replace(/-/,""),k={dj_quirks:0,dj_opera:k,dj_khtml:0,dj_webkit:d("webkit"),dj_safari:d("safari"),dj_chrome:d("chrome"),dj_edge:1,dj_gecko:1,dj_ios:d("ios"),dj_android:0};b&&(k.dj_ie=!0,k["dj_ie"+f(b)]=!0,k.dj_iequirks=0);k["dj_ff"+f(1)]=!0;
k["dj_"+a]=!0;var e="",c;for(c in k)k[c]&&(e+=c+" ");g.className=l.trim(g.className+" "+e);h(function(){if(!m.isBodyLtr()){var a="dj_rtl dijitRtl "+e.replace(/ /g,"-rtl ");g.className=l.trim(g.className+" "+a+"dj_rtl dijitRtl "+e.replace(/ /g,"-rtl "))}});return d})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(m,l,h,d){h(function(){l("highcontrast")&&m.add(d.body(),"dijit_a11y")});return l})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(m,l,h,d,b,g,k){b.add("highcontrast",function(){var f=k.doc.createElement("div");try{f.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(l.blankGif||m.toUrl("./resources/blank.gif"))+'");';k.body().appendChild(f);var a=d.getComputedStyle(f),e=a.backgroundImage;return a.borderTopColor==a.borderRightColor||e&&("none"==e||"url(invalid-url:)"==e)}catch(c){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+
c.toString()),!1}finally{8>=b("ie")?f.outerHTML="":k.body().removeChild(f)}});g(function(){b("highcontrast")&&h.add(k.body(),"dj_a11y")});return b})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(m,l,h,d,b,g,k,f){var a=l("dijit._TemplatedMixin",f,{templateString:null,templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(a){var b=this.declaredClass,
e=this;return k.substitute(a,this,function(a,c){"!"==c.charAt(0)&&(a=d.getObject(c.substr(1),!1,e));if("undefined"==typeof a)throw Error(b+" template:"+c);return null==a?"":"!"==c.charAt(0)?a:this._escapeValue(""+a)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||(this.templateString=m(this.templatePath,{sanitize:!0}));
var b=a.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),c;if(d.isString(b)){if(c=h.toDom(this._stringRepl(b),this.ownerDocument),1!=c.nodeType)throw Error("Invalid template: "+b);}else c=b.cloneNode(!0);this.domNode=c}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(a){var b=this.containerNode;if(a&&b)for(;a.hasChildNodes();)b.appendChild(a.firstChild)}});a._templateCache={};a.getCachedTemplate=function(b,
c,d){var e=a._templateCache,f=b,g=e[f];if(g){try{if(!g.ownerDocument||g.ownerDocument==(d||document))return g}catch(v){}h.destroy(g)}b=k.trim(b);if(c||b.match(/\$\{([^\}]+)\}/g))return e[f]=b;c=h.toDom(b,d);if(1!=c.nodeType)throw Error("Invalid template: "+b);return e[f]=c};g("ie")&&b(window,"unload",function(){var b=a._templateCache,c;for(c in b){var d=b[c];"object"==typeof d&&h.destroy(d);delete b[c]}});return a})},"dojo/cache":function(){define(["./_base/kernel","./text"],function(m){return m.cache})},
"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(m,l,h,d,b,g,k,f,a){var e=b.delegate(f,{mouseenter:g.enter,mouseleave:g.leave,keypress:h._keypress}),c;h=d("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);this._beforeFillContent()},
_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=b.nextSibling}},_processTemplateNode:function(a,c,e){var d=!0,f=this.attachScope||this,g=c(a,"dojoAttachPoint")||c(a,"data-dojo-attach-point");if(g)for(var k=g.split(/\s*,\s*/);g=k.shift();)b.isArray(f[g])?
f[g].push(a):f[g]=a,d="containerNode"!=g,this._attachPoints.push(g);if(c=c(a,"dojoAttachEvent")||c(a,"data-dojo-attach-event"))for(g=c.split(/\s*,\s*/),k=b.trim;c=g.shift();)if(c){var h=null;-1!=c.indexOf(":")?(h=c.split(":"),c=k(h[0]),h=k(h[1])):c=k(c);h||(h=c);this._attachEvents.push(e(a,c,b.hitch(f,h)))}return d},_attach:function(a,b,d){b=b.replace(/^on/,"").toLowerCase();b="dijitclick"==b?c||(c=m("./a11yclick")):e[b]||b;return k(a,b,d)},_detachTemplateNodes:function(){var a=this.attachScope||
this;l.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];l.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});b.extend(a,{dojoAttachEvent:"",dojoAttachPoint:""});return h})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){l=l("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);m.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,g.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(a){b=b.concat(m.map(b,function(b){return b+a}),"dijit"+a)}var b=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var c="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(c);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var c=this.stateNode||this.domNode,e={};m.forEach(c.className.split(" "),function(a){e[a]=!0});"_stateClasses"in this&&m.forEach(this._stateClasses,function(a){delete e[a]});m.forEach(b,
function(a){e[a]=!0});var d=[],f;for(f in e)d.push(f);c.className=d.join(" ");this._stateClasses=b},_subnodeCssMouseEvent:function(a,b,c){function e(c){d.toggle(a,b+"Active",c)}if(!this.disabled&&!this.readOnly)switch(c.type){case "mouseover":case "MSPointerOver":case "pointerover":d.toggle(a,b+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":d.toggle(a,b+"Hover",!1);e(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":e(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":e(!1);break;case "focus":case "focusin":d.toggle(a,b+"Focused",!0);break;case "blur":case "focusout":d.toggle(a,b+"Focused",!1)}},_trackMouseState:function(a,b){a._cssState=b}});f(function(){function b(a,b,c){if(!c||!h.isDescendant(c,b))for(;b&&b!=c;b=b.parentNode)if(b._cssState){var e=q.getEnclosingWidget(b);e&&(b==e.domNode?e._cssMouseEvent(a):e._subnodeCssMouseEvent(b,b._cssState,a))}}var d=e.body(),f;k(d,
a.over,function(a){b(a,a.target,a.relatedTarget)});k(d,a.out,function(a){b(a,a.target,a.relatedTarget)});k(d,c.press,function(a){f=a.target;b(a,f)});k(d,c.release,function(a){b(a,f);f=null});k(d,"focusin, focusout",function(a){var b=a.target;if(b._cssState&&!b.getAttribute("widgetId")){var c=q.getEnclosingWidget(b);c&&c._subnodeCssMouseEvent(b,b._cssState,a)}})});return l})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(m,l,h,d,b,g){return l("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(b){var d=[];m.forEach(b||this.getChildren(),function(a){"value"in a?d.push(a):d=d.concat(this._getDescendantFormWidgets(a.getChildren()))},this);return d},reset:function(){m.forEach(this._getDescendantFormWidgets(),function(b){b.reset&&b.reset()})},validate:function(){var b=!1;return m.every(m.map(this._getDescendantFormWidgets(),function(d){d._hasBeenBlurred=!0;var a=d.disabled||!d.validate||
d.validate();a||b||(g.scrollIntoView(d.containerNode||d.domNode),d.focus(),b=!0);return a}),function(b){return b})},setValues:function(b){h.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",b)},_setValueAttr:function(b){var f={};m.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(f[a.name]||(f[a.name]=[])).push(a)});for(var a in f)if(f.hasOwnProperty(a)){var e=f[a],c=d.getObject(a,!1,b);void 0!==c&&(c=[].concat(c),
"boolean"==typeof e[0].checked?m.forEach(e,function(a){a.set("value",-1!=m.indexOf(c,a._get("value")))}):e[0].multiple?e[0].set("value",c):m.forEach(e,function(a,b){a.set("value",c[b])}))}},getValues:function(){h.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var b={};m.forEach(this._getDescendantFormWidgets(),function(f){var a=f.name;if(a&&!f.disabled){var e=f.get("value");"boolean"==typeof f.checked?
/Radio/.test(f.declaredClass)?!1!==e?d.setObject(a,e,b):(e=d.getObject(a,!1,b),void 0===e&&d.setObject(a,null,b)):(f=d.getObject(a,!1,b),f||(f=[],d.setObject(a,f,b)),!1!==e&&f.push(e)):(f=d.getObject(a,!1,b),"undefined"!=typeof f?d.isArray(f)?f.push(e):d.setObject(a,[f,e],b):d.setObject(a,e,b))}});return b},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var b=m.map(this._descendants,function(b){return b.get("state")||""});return 0<=m.indexOf(b,"Error")?
"Error":0<=m.indexOf(b,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(b){this._descendants=this._getDescendantFormWidgets();m.forEach(this._descendants,function(b){b._started||b.startup()});b||this._onChildChange()},_onChildChange:function(b){b&&"state"!=b&&"disabled"!=b||this._set("state",this._getState());b&&"value"!=b&&"disabled"!=b&&"checked"!=b||(this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10))},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var d=this;this.own(b(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(b){b.target!=d.domNode&&d._onChildChange(b.type.replace("attrmodified-",""))}));this.watch("state",function(b,a,e){this.onValidStateChange(""==e)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(m,l){return m("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var h=l._getTabNavigable(this.domNode);this._firstFocusItem=h.lowest||h.first||this.closeButtonNode||this.domNode;this._lastFocusItem=h.last||h.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){var t=m("dijit.DialogUnderlay",[f,a],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(a){d.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(g(this.domNode,"keydown",l.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,b=this.domNode.style;b.display="none";var c=k.getBox(this.ownerDocument);b.top=c.t+"px";b.left=c.l+"px";a.width=c.w+"px";a.height=c.h+"px";b.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new e(this.domNode);var a=k.get(this.ownerDocument);this._modalConnects=[c.on("resize",l.hitch(this,"layout")),g(a,"scroll",
l.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});t.show=function(a,c){var e=t._singleton;!e||e._destroyed?e=q._underlay=t._singleton=new t(a):a&&e.set(a);b.set(e.domNode,"zIndex",c);e.open||e.show()};t.hide=function(){var a=
t._singleton;a&&!a._destroyed&&a.hide()};return t})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(m,l,h,d,b,g,k,f){f.add("config-bgIframe",(f("ie")||0)&&!/IEMobile\/10\.0/.test(navigator.userAgent));var a=new function(){var a=[];this.pop=function(){var c;a.length?(c=a.pop(),c.style.display=""):(9>f("ie")?(c=h.dojoBlankHtmlUrl||m.toUrl("dojo/resources/blank.html")||'javascript:""',
c=document.createElement("\x3ciframe src\x3d'"+c+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e")):(c=d.create("iframe"),c.src='javascript:""',c.className="dijitBackgroundIframe",c.setAttribute("role","presentation"),b.set(c,"opacity",.1)),c.tabIndex=-1);return c};this.push=function(b){b.style.display="none";a.push(b)}};l.BackgroundIframe=function(e){if(!e.id)throw Error("no id");if(f("config-bgIframe")){var c=this.iframe=
a.pop();e.appendChild(c);7>f("ie")?(this.resize(e),this._conn=k(e,"resize",g.hitch(this,"resize",e))):b.set(c,{width:"100%",height:"100%"})}};g.extend(l.BackgroundIframe,{resize:function(a){this.iframe&&b.set(this.iframe,{width:a.offsetWidth+"px",height:a.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),a.push(this.iframe),delete this.iframe)}});return l.BackgroundIframe})},"dijit/Viewport":function(){define(["dojo/Evented",
"dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(m,l,h,d,b){var g=new m,k;h(function(){var f=b.getBox();g._rlh=l(window,"resize",function(){var a=b.getBox();if(f.h!=a.h||f.w!=a.w)f=a,g.emit("resize")});if(8==d("ie")){var a=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=a&&(a=screen.deviceXDPI,g.emit("resize"))},500)}d("ios")&&(l(document,"focusin",function(a){k=a.target}),l(document,"focusout",function(a){k=null}))});g.getEffectiveBox=function(f){f=b.getBox(f);var a=k&&
k.tagName&&k.tagName.toLowerCase();d("ios")&&k&&!k.readOnly&&("textarea"==a||"input"==a&&/^(color|email|number|password|search|tel|text|url)$/.test(k.type))&&(f.h*=0==orientation||180==orientation?.66:.4,a=k.getBoundingClientRect(),f.h=Math.max(f.h,a.top+a.height));return f};return g})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){return a("dijit.layout.ContentPane",[h,d,b],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:m._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,b,c){var e=new c(a,b);return!e.href&&e._contentSetter&&e._contentSetter.parseDeferred&&!e._contentSetter.parseDeferred.isFulfilled()?e._contentSetter.parseDeferred.then(function(){return e}):e},create:function(a,b){if(!(a&&a.template||!b||"href"in a||"content"in a)){b=c.byId(b);for(var e=b.ownerDocument.createDocumentFragment();b.firstChild;)e.appendChild(b.firstChild);
a=l.delegate(a,{content:e})}this.inherited(arguments,[a,b])},postMixInProperties:function(){this.inherited(arguments);var a=u.getLocalization("dijit","loading",this.lang);this.loadingMessage=g.substitute(this.loadingMessage,a);this.errorMessage=g.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&f.forEach(this._contentSetter.parseResults,
function(a){a._started||a._destroyed||!l.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},_startChildren:function(){f.forEach(this.getChildren(),function(a){a._started||a._destroyed||!l.isFunction(a.startup)||(a.startup(),a._started=!0)});this._contentSetter&&f.forEach(this._contentSetter.parseResults,function(a){a._started||a._destroyed||!l.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},setHref:function(a){m.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new e(l.hitch(this,"cancel"));this.onLoadDeferred.then(l.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){m.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new e(l.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(l.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new e(l.hitch(this,"cancel"));this.onLoadDeferred.then(l.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,b={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
l.isObject(this.ioArgs)&&l.mixin(b,this.ioArgs);var c=this._xhrDfd=(this.ioMethod||r.get)(b),e;c.then(function(b){e=b;try{return a._isDownloaded=!0,a._setContent(b,!1)}catch(C){a._onError("Content",C)}},function(b){c.canceled||a._onError("Download",b);delete a._xhrDfd;return b}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return e});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(y){console.error("Error "+this.widgetId+
" running custom onLoad code: "+y.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(x){console.error("Error "+this.widgetId+" running custom onUnload code: "+x.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var b=this._contentSetter;f.forEach(this.getChildren(),function(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a);b._destroyed=!0});b&&(f.forEach(b.parseResults,function(b){b._destroyed||(b.destroyRecursive?
b.destroyRecursive(a):b.destroy&&b.destroy(a),b._destroyed=!0)}),delete b.parseResults);a||t.empty(this.containerNode);delete this._singleChild},_setContent:function(a,b){a=this.preprocessContent(a);this.destroyDescendants();var c=this._contentSetter;c&&c instanceof k._ContentSetter||(c=this._contentSetter=new k._ContentSetter({node:this.containerNode,_onError:l.hitch(this,this._onError),onContentError:l.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(B){console.error("Fatal "+
this.id+" could not change content due to "+B.message,B)}})}));var e=l.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),e=c.set(l.isObject(a)&&a.domNode?a.domNode:a,e),d=this;return v(e&&e.then?e:c.parseDeferred,function(){delete d._contentSetterParams;b||(d._started&&(d._startChildren(),d._scheduleLayout()),d._onLoadHandler(a))})},
preprocessContent:function(a){return a},_onError:function(a,b,c){this.onLoadDeferred.reject(b);a=this["on"+a+"Error"].call(this,b);c?console.error(c,b):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],
function(m,l,h,d){return l("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(b,d){var g=this.containerNode;if(0<d){for(g=g.firstChild;0<d;)1==g.nodeType&&d--,g=g.nextSibling;g?d="before":(g=this.containerNode,d="last")}h.place(b.domNode,g,d);this._started&&!b._started&&b.startup()},removeChild:function(b){"number"==typeof b&&(b=this.getChildren()[b]);b&&(b=b.domNode)&&b.parentNode&&b.parentNode.removeChild(b)},
hasChildren:function(){return 0<this.getChildren().length},_getSiblingOfChild:function(b,d){var g=this.getChildren();b=m.indexOf(g,b);return g[b+d]},getIndexOfChild:function(b){return m.indexOf(this.getChildren(),b)}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),function(m,l,h,d,b,g,k,f,a,e){return l("dijit.layout._ContentPaneResizeMixin",
null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var b=this.getParent();this._childOfLayoutWidget=b&&b.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(a.on("resize",g.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var a=[],b=!1;k("\x3e *",this.containerNode).some(function(c){var e=f.byNode(c);e&&e.resize?a.push(e):!/script|link|style/i.test(c.nodeName)&&
c.offsetHeight&&(b=!0)});this._singleChild=1!=a.length||b?null:a[0];h.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(a,b){this._resizeCalled=!0;this._scheduleLayout(a,b)},_scheduleLayout:function(a,b){this._isShown()?this._layout(a,b):(this._needLayout=!0,this._changeSize=a,this._resultSize=b)},_layout:function(a,b){delete this._needLayout;this._wasShown||!1===this.open||this._onShow();a&&d.setMarginBox(this.domNode,a);var c=this.containerNode;c===this.domNode?
(b=b||{},g.mixin(b,a||{}),"h"in b&&"w"in b||(b=g.mixin(d.getMarginBox(c),b)),this._contentBox=e.marginBox2contentBox(c,b)):this._contentBox=d.getContentBox(c);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var a=this._contentBox||d.getContentBox(this.containerNode);this._singleChild.resize({w:a.w,h:a.h})}else for(var a=this.getChildren(),b,e=0;b=a[e++];)b.resize&&b.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&
"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var a=this.domNode,b=this.domNode.parentNode;return"none"!=a.style.display&&"hidden"!=a.style.visibility&&!h.contains(a,"dijitHidden")&&b&&b.style&&"none"!=b.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],
function(m,l,h,d,b){function g(a){return a.substring(0,1).toUpperCase()+a.substring(1)}function k(a,e){var c=a.resize?a.resize(e):h.setMarginBox(a.domNode,e);c?b.mixin(a,c):(b.mixin(a,h.getMarginBox(a.domNode)),b.mixin(a,e))}var f={marginBox2contentBox:function(a,b){var c=d.getComputedStyle(a),e=h.getMarginExtents(a,c),f=h.getPadBorderExtents(a,c);return{l:d.toPixelValue(a,c.paddingLeft),t:d.toPixelValue(a,c.paddingTop),w:b.w-(e.w+f.w),h:b.h-(e.h+f.h)}},layoutChildren:function(a,e,c,d,f){e=b.mixin({},
e);l.add(a,"dijitLayoutContainer");c=m.filter(c,function(a){return"center"!=a.region&&"client"!=a.layoutAlign}).concat(m.filter(c,function(a){return"center"==a.region||"client"==a.layoutAlign}));m.forEach(c,function(a){var b=a.domNode,c=a.region||a.layoutAlign;if(!c)throw Error("No region setting for "+a.id);var h=b.style;h.left=e.l+"px";h.top=e.t+"px";h.position="absolute";l.add(b,"dijitAlign"+g(c));b={};d&&d==a.id&&(b["top"==a.region||"bottom"==a.region?"h":"w"]=f);"leading"==c&&(c=a.isLeftToRight()?
"left":"right");"trailing"==c&&(c=a.isLeftToRight()?"right":"left");"top"==c||"bottom"==c?(b.w=e.w,k(a,b),e.h-=a.h,"top"==c?e.t+=a.h:h.top=e.t+e.h+"px"):"left"==c||"right"==c?(b.h=e.h,k(a,b),e.w-=a.w,"left"==c?e.l+=a.w:h.left=e.l+e.w+"px"):"client"!=c&&"center"!=c||k(a,e)})}};b.setObject("dijit.layout.utils",f);return f})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),function(m,l,h,d,b,g,k){var f=0,a={_secureForInnerHtml:function(a){return a.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,
"")},_emptyNode:g.empty,_setNodeContent:function(a,b){g.empty(a);if(b)if("number"==typeof b&&(b=b.toString()),"string"==typeof b&&(b=g.toDom(b,a.ownerDocument)),!b.nodeType&&l.isArrayLike(b))for(var c=b.length,e=0;e<b.length;e=c==b.length?e+1:0)g.place(b[e],a,"last");else g.place(b,a,"last");return a},_ContentSetter:d("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:m._scopeName,startup:!0,constructor:function(a,c){l.mixin(this,
a||{});c=this.node=b.byId(this.node||c);this.id||(this.id=["Setter",c?c.id||c.tagName:"",f++].join("_"))},set:function(a,b){void 0!==a&&(this.content=a);"number"==typeof a&&(a=a.toString());b&&this._mixin(b);this.onBegin();this.setContent();return(a=this.onEnd())&&a.then?a:this.node},setContent:function(){var b=this.node;if(!b)throw Error(this.declaredClass+": setContent given no node");try{b=a._setNodeContent(b,this.content)}catch(q){var c=this.onContentError(q);try{b.innerHTML=c}catch(t){console.error("Fatal "+
this.declaredClass+".setContent could not change content due to "+t.message,t)}}this.node=b},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(h.forEach(this.parseResults,function(a){a.destroy&&a.destroy()}),delete this.parseResults);g.empty(this.node)},onBegin:function(){var b=this.content;if(l.isString(b)&&(this.cleanContent&&(b=a._secureForInnerHtml(b)),this.extractContent)){var c=
b.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);c&&(b=c[1])}this.empty();this.content=b;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(a){return"Error occurred setting content: "+a},onExecError:function(a){return"Error occurred executing scripts: "+a},_mixin:function(a){var b={},e;for(e in a)e in b||(this[e]=a[e])},_parse:function(){var a=
this.node;try{var b={};h.forEach(["dir","lang","textDir"],function(a){this[a]&&(b[a]=this[a])},this);var d=this;this.parseDeferred=k.parse({rootNode:a,noStart:!this.startup,inherited:b,scope:this.parserScope}).then(function(a){return d.parseResults=a},function(a){d._onError("Content",a,"Error parsing in _ContentSetter#"+this.id)})}catch(t){this._onError("Content",t,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(b,c,d){b=this["on"+b+"Error"].call(this,c);d?console.error(d,c):b&&a._setNodeContent(this.node,
b,!0)}}),set:function(b,c,d){void 0==c&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),c="");"number"==typeof c&&(c=c.toString());return d?(new a._ContentSetter(l.mixin(d,{content:c,node:b}))).set():a._setNodeContent(b,c,!0)}};l.setObject("dojo.html",a);return a})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){function x(a){return eval("("+a+")")}function y(a){var b=a._nameCaseMap,c=a.prototype;if(!b||b._extendCnt<w){var b=a._nameCaseMap={},e;for(e in c)"_"!==e.charAt(0)&&(b[e.toLowerCase()]=e);b._extendCnt=w}return b}function n(a,b){b||(b=m);var c=b._dojoParserCtorMap||(b._dojoParserCtorMap={}),e=a.join();if(!c[e]){for(var d=[],f=0,g=a.length;f<g;f++){var k=a[f];d[d.length]=c[k]=c[k]||h.getObject(k)||~k.indexOf("/")&&b(k)}a=d.shift();c[e]=d.length?a.createSubclass?
a.createSubclass(d):a.extend.apply(a,d):a}return c[e]}new Date("X");var w=0;a.after(h,"extend",function(){w++},!0);t={_clearCache:function(){w++;_ctorMap={}},_functionFromScript:function(a,b){var c="",e="",f=a.getAttribute(b+"args")||a.getAttribute("args");b=a.getAttribute("with");f=(f||"").split(/\s*,\s*/);b&&b.length&&d.forEach(b.split(/\s*,\s*/),function(a){c+="with("+a+"){";e+="}"});return new Function(f,c+a.innerHTML+e)},instantiate:function(a,b,c){b=b||{};c=c||{};var e=(c.scope||l._scopeName)+
"Type",f="data-"+(c.scope||l._scopeName)+"-",g=f+"type",k=f+"mixins",h=[];d.forEach(a,function(a){var c=e in b?b[e]:a.getAttribute(g)||a.getAttribute(e);if(c){var d=a.getAttribute(k),c=d?[c].concat(d.split(/\s*,\s*/)):[c];h.push({node:a,types:c})}});return this._instantiate(h,b,c)},_instantiate:function(a,b,c,f){function g(a){b._started||c.noStart||d.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=d.map(a,function(a){var e=a.ctor||n(a.types,c.contextRequire);
if(!e)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(e,a.node,b,c,a.scripts,a.inherited)},this);return f?e(a).then(g):g(a)},construct:function(b,e,d,g,k,n){function q(b){F&&h.setObject(F,b);for(C=0;C<A.length;C++)a[A[C].advice||"after"](b,A[C].method,h.hitch(b,A[C].func),!0);for(C=0;C<K.length;C++)K[C].call(b);for(C=0;C<U.length;C++)b.watch(U[C].prop,U[C].func);for(C=0;C<V.length;C++)u(b,V[C].event,V[C].func);return b}var w=b&&b.prototype;g=g||{};var t=
{};g.defaults&&h.mixin(t,g.defaults);n&&h.mixin(t,n);var m;m=e.attributes;var v=g.scope||l._scopeName;n="data-"+v+"-";var z={};"dojo"!==v&&(z[n+"props"]="data-dojo-props",z[n+"type"]="data-dojo-type",z[n+"mixins"]="data-dojo-mixins",z[v+"type"]="dojotype",z[n+"id"]="data-dojo-id");for(var C=0,B,v=[],F,G;B=m[C++];){var N=B.name,p=N.toLowerCase();B=B.value;switch(z[p]||p){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":G=B;break;case "data-dojo-id":case "jsid":F=
B;break;case "data-dojo-attach-point":case "dojoattachpoint":t.dojoAttachPoint=B;break;case "data-dojo-attach-event":case "dojoattachevent":t.dojoAttachEvent=B;break;case "class":t["class"]=e.className;break;case "style":t.style=e.style&&e.style.cssText;break;default:if(N in w||(N=y(b)[p]||N),N in w)switch(typeof w[N]){case "string":t[N]=B;break;case "number":t[N]=B.length?Number(B):NaN;break;case "boolean":t[N]="false"!=B.toLowerCase();break;case "function":""===B||-1!=B.search(/[^\w\.]+/i)?t[N]=
new Function(B):t[N]=h.getObject(B,!1)||new Function(B);v.push(N);break;default:p=w[N],t[N]=p&&"length"in p?B?B.split(/\s*,\s*/):[]:p instanceof Date?""==B?new Date(""):"now"==B?new Date:c.fromISOString(B):p instanceof f?l.baseUrl+B:x(B)}else t[N]=B}}for(m=0;m<v.length;m++)z=v[m].toLowerCase(),e.removeAttribute(z),e[z]=null;if(G)try{G=x.call(g.propsThis,"{"+G+"}"),h.mixin(t,G)}catch(X){throw Error(X.toString()+" in data-dojo-props\x3d'"+G+"'");}h.mixin(t,d);k||(k=b&&(b._noScript||w._noScript)?[]:
r("\x3e script[type^\x3d'dojo/']",e));var A=[],K=[],U=[],V=[];if(k)for(C=0;C<k.length;C++)z=k[C],e.removeChild(z),d=z.getAttribute(n+"event")||z.getAttribute("event"),g=z.getAttribute(n+"prop"),G=z.getAttribute(n+"method"),v=z.getAttribute(n+"advice"),m=z.getAttribute("type"),z=this._functionFromScript(z,n),d?"dojo/connect"==m?A.push({method:d,func:z}):"dojo/on"==m?V.push({event:d,func:z}):t[d]=z:"dojo/aspect"==m?A.push({method:G,advice:v,func:z}):"dojo/watch"==m?U.push({prop:g,func:z}):K.push(z);
b=(k=b.markupFactory||w.markupFactory)?k(t,e,b):new b(t,e);return b.then?b.then(q):q(b)},scan:function(a,b){function c(a){if(!a.inherited){a.inherited={};var b=a.node,e=c(a.parent),b={dir:b.getAttribute("dir")||e.dir,lang:b.getAttribute("lang")||e.lang,textDir:b.getAttribute(u)||e.textDir},d;for(d in b)b[d]&&(a.inherited[d]=b[d])}return a.inherited}var e=[],f=[],g={},k=(b.scope||l._scopeName)+"Type",h="data-"+(b.scope||l._scopeName)+"-",r=h+"type",u=h+"textdir",h=h+"mixins",w=a.firstChild,t=b.inherited;
if(!t){var v=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&v(a.parentNode,b)},t={dir:v(a,"dir"),lang:v(a,"lang"),textDir:v(a,u)},x;for(x in t)t[x]||delete t[x]}x={inherited:t};for(var z,y;;)if(w)if(1!=w.nodeType)w=w.nextSibling;else if(z&&"script"==w.nodeName.toLowerCase())(t=w.getAttribute("type"))&&/^dojo\/\w/i.test(t)&&z.push(w),w=w.nextSibling;else if(y)w=w.nextSibling;else if(t=w.getAttribute(r)||w.getAttribute(k),a=w.firstChild,t||a&&(3!=a.nodeType||a.nextSibling)){y=
null;if(t){var C=w.getAttribute(h);z=C?[t].concat(C.split(/\s*,\s*/)):[t];try{y=n(z,b.contextRequire)}catch(A){}y||d.forEach(z,function(a){~a.indexOf("/")&&!g[a]&&(g[a]=!0,f[f.length]=a)});C=y&&!y.prototype._noScript?[]:null;x={types:z,ctor:y,parent:x,node:w,scripts:C};x.inherited=c(x);e.push(x)}else x={node:w,scripts:z,parent:x};z=C;y=w.stopParser||y&&y.prototype.stopParser&&!b.template;w=a}else w=w.nextSibling;else{if(!x||!x.node)break;w=x.node.nextSibling;y=!1;x=x.parent;z=x.scripts}var p=new q;
f.length?(b.contextRequire||m)(f,function(){p.resolve(d.filter(e,function(a){if(!a.ctor)try{a.ctor=n(a.types,b.contextRequire)}catch(V){}for(var c=a.parent;c&&!c.types;)c=c.parent;var e=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(e&&e.stopParser&&!b.template);a.instantiate=!c||c.instantiate&&c.instantiateChildren;return a.instantiate}))}):p.resolve(e);return p.promise},_require:function(a,b){a=x("{"+a.innerHTML+"}");var c=[],e=[],d=new q;b=b&&b.contextRequire||m;for(var f in a)c.push(f),e.push(a[f]);
b(e,function(){for(var a=0;a<c.length;a++)h.setObject(c[a],arguments[a]);d.resolve(arguments)});return d.promise},_scanAmd:function(a,b){var c=new q,e=c.promise;c.resolve(!0);var d=this;r("script[type\x3d'dojo/require']",a).forEach(function(a){e=e.then(function(){return d._require(a,b)});a.parentNode.removeChild(a)});return e},parse:function(a,b){!a||"string"==typeof a||"nodeType"in a||(b=a,a=b.rootNode);var c=a?g.byId(a):k.body();b=b||{};var e=b.template?{template:!0}:{},d=[],f=this;a=this._scanAmd(c,
b).then(function(){return f.scan(c,b)}).then(function(a){return f._instantiate(a,e,b,!0)}).then(function(a){return d=d.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});h.mixin(d,a);return d}};l.parser=t;b.parseOnLoad&&v(100,t,"parse");return t})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(m,l){var h={};m.setObject("dojo.date.stamp",h);h.fromISOString=function(d,b){h._isoRegExp||(h._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);
var g=h._isoRegExp.exec(d);d=null;if(g){g.shift();g[1]&&g[1]--;g[6]&&(g[6]*=1E3);b&&(b=new Date(b),l.forEach(l.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(a){return b["get"+a]()}),function(a,b){g[b]=g[b]||a}));d=new Date(g[0]||1970,g[1]||0,g[2]||1,g[3]||0,g[4]||0,g[5]||0,g[6]||0);100>g[0]&&d.setFullYear(g[0]||1970);var k=0,f=g[7]&&g[7].charAt(0);"Z"!=f&&(k=60*(g[8]||0)+(Number(g[9])||0),"-"!=f&&(k*=-1));f&&(k-=d.getTimezoneOffset());k&&d.setTime(d.getTime()+6E4*
k)}return d};h.toISOString=function(d,b){var g=function(a){return 10>a?"0"+a:a};b=b||{};var k=[],f=b.zulu?"getUTC":"get",a="";"time"!=b.selector&&(a=d[f+"FullYear"](),a=["0000".substr((a+"").length)+a,g(d[f+"Month"]()+1),g(d[f+"Date"]())].join("-"));k.push(a);"date"!=b.selector&&(a=[g(d[f+"Hours"]()),g(d[f+"Minutes"]()),g(d[f+"Seconds"]())].join(":"),f=d[f+"Milliseconds"](),b.milliseconds&&(a+="."+(100>f?"0":"")+g(f)),b.zulu?a+="Z":"time"!=b.selector&&(d=d.getTimezoneOffset(),b=Math.abs(d),a+=(0<
d?"-":"+")+g(Math.floor(b/60))+":"+g(b%60)),k.push(a));return k.join("T")};return h})},"dijit/nls/loading":function(){define({root:{loadingState:"Loading...",errorState:"Sorry, an error occurred"},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,hi:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"dijit/nls/common":function(){define({root:{buttonOk:"OK",
buttonCancel:"Cancel",buttonSave:"Save",itemClose:"Close"},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,hi:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"esri/core/domUtils":function(){define(["dojo/on","dojo/dom-style","dojo/has"],function(m,l,h){var d={show:function(b){(b=d.getNode(b))&&(b.style.display="block")},getNode:function(b){return b&&
b.domNode||b},hide:function(b){(b=d.getNode(b))&&(b.style.display="none")},toggle:function(b){(b=d.getNode(b))&&(b.style.display="none"===b.style.display?"block":"none")},documentBox:8>=h("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(b){if(b=this.getNode(b)){var d=0,k=0,f=0,a=0,e=0,c=0;return[m(b,"touchstart",function(g){d=g.touches[0].screenX;k=g.touches[0].screenY;f=b.scrollWidth;a=b.scrollHeight;
e=b.clientWidth;c=b.clientHeight}),m(b,"touchmove",function(g){g.preventDefault();var h=b.firstChild;h instanceof Text&&(h=b.childNodes[1]);var q=h._currentX||0,u=h._currentY||0,q=q+(g.touches[0].screenX-d);0<q?q=0:0>q&&Math.abs(q)+e>f&&(q=-1*(f-e));h._currentX=q;u+=g.touches[0].screenY-k;0<u?u=0:0>u&&Math.abs(u)+c>a&&(u=-1*(a-c));h._currentY=u;l.set(h,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+q+"px, "+u+"px)"});d=g.touches[0].screenX;k=g.touches[0].screenY})]}}};
return d})},"esri/identity/Credential":function(){define(["./IdentityManagerBase"],function(m){return m.Credential})},"esri/identity/IdentityManagerBase":function(){define("../core/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/Deferred dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ../kernel ../config ../core/lang ./ServerInfo ../core/urlUtils ../core/deferredUtils ../core/Accessor ../request ../core/Error ../core/Evented ./OAuthCredential ./OAuthInfo".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C){var B,F={},G=function(a){var b=(new g(a.owningSystemUrl)).host;a=(new g(a.server)).host;var c=/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},N=function(a,b){return!!(G(a)&&b&&d.some(b,function(b){return b.test(a.server)}))};m=m(w,{declaredClass:"esri.identity.IdentityManagerBase",constructor:function(){this._portalConfig=h.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=
[];this._getOAuthHash()},defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},
{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/gi,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer|SceneServer)).*/gi,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(a){var b=this.serverInfos;b?(a=d.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=b.concat(a)):
this.serverInfos=a;d.forEach(a,function(a){if(a.owningSystemUrl&&this._portals.push(a.owningSystemUrl),a.hasPortal){this._portals.push(a.server);var b=q.request.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);u.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,""));u.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var b=this.oAuthInfos;b?(a=d.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=b.concat(a)):
this.oAuthInfos=a},registerToken:function(a){a=h.mixin({},a);var b,c=this._sanitizeUrl(a.server),e=this.findServerInfo(c),d=this._isServerRsrc(c),f=!0;e||(e=new r,e.server=this._getServerInstanceRoot(c),d?e.hasServer=!0:(e.tokenServiceUrl=this._getTokenSvcUrl(c),e.hasPortal=!0),this.registerServers([e]));(b=this._findCredential(c))?(delete a.server,h.mixin(b,a),f=!1):(b=new B({userId:a.userId,server:e.server,token:a.token,expires:a.expires,ssl:a.ssl,scope:d?"server":"portal"}),b.resources=[c],this.credentials.push(b));
b.emitTokenChange(!1);f||b.refreshServerTokens()},toJSON:function(){return t.fixJson({serverInfos:d.map(this.serverInfos,function(a){return a.toJSON()}),oAuthInfos:d.map(this.oAuthInfos,function(a){return a.toJSON()}),credentials:d.map(this.credentials,function(a){return a.toJSON()})})},initialize:function(a){if(a){h.isString(a)&&(a=JSON.parse(a));var b=a.serverInfos,c=a.oAuthInfos;a=a.credentials;if(b){var e=[];d.forEach(b,function(a){a.server&&a.tokenServiceUrl&&e.push(a.declaredClass?a:new r(a))});
e.length&&this.registerServers(e)}if(c){var f=[];d.forEach(c,function(a){a.appId&&f.push(a.declaredClass?a:new C(a))});f.length&&this.registerOAuthInfos(f)}a&&d.forEach(a,function(a){a.server&&a.token&&a.expires&&a.expires>(new Date).getTime()&&(a=a.declaredClass?a:new B(a),a.emitTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(a){var b;return a=this._sanitizeUrl(a),d.some(this.serverInfos,function(c){return this._hasSameServerInstance(c.server,a)&&(b=c),!!b},this),b},findOAuthInfo:function(a){var b;
return a=this._sanitizeUrl(a),d.some(this.oAuthInfos,function(c){return this._hasSameServerInstance(c.portalUrl,a)&&(b=c),!!b},this),b},findCredential:function(a,b){var c,e;return a=this._sanitizeUrl(a),e=this._isServerRsrc(a)?"server":"portal",b?d.some(this.credentials,function(d){return this._hasSameServerInstance(d.server,a)&&b===d.userId&&d.scope===e&&(c=d),!!c},this):d.some(this.credentials,function(b){return this._hasSameServerInstance(b.server,a)&&-1!==this._getIdenticalSvcIdx(a,b)&&b.scope===
e&&(c=b),!!c},this),c},getCredential:function(a,b){var c,e,d=!0;t.isDefined(b)&&(h.isObject(b)?(c=!!b.token,e=b.error,d=!1!==b.prompt):c=b);a=this._sanitizeUrl(a);var g,k=v.makeDeferredCancellingPending(),l=this._isAdminResource(a),q=c&&this._doPortalSignIn(a)?this._getEsriAuthCookie():null;if((c=c?this.findCredential(a):null)&&e&&498===e.code)c.destroy(),q&&q.token===b.token&&f("esri_auth",null,{expires:-1,path:"/",domain:document.domain});else if(q||c)return g=new n("identity-manager:not-authorized",
"You are currently signed in as: '"+(q&&q.email||c&&c.userId)+"'. You do not have access to this resource: "+a,{error:e}),k.reject(g),k.promise;if(e=this._findCredential(a,b))return k.resolve(e),k.promise;if(e=this.findServerInfo(a))!e.hasServer&&this._isServerRsrc(a)&&(e._restInfoPms=this._getTokenSvcUrl(a),e.hasServer=!0);else{q=this._getTokenSvcUrl(a);if(!q)return g=new n("identity-manager:unknown-resource","Unknown resource - could not find token service endpoint."),k.reject(g),k.promise;e=new r;
e.server=this._getServerInstanceRoot(a);h.isString(q)?(e.tokenServiceUrl=q,e.hasPortal=!0):(e._restInfoPms=q,e.hasServer=!0);this.registerServers([e])}return d&&e.hasPortal&&void 0===e._selfReq&&!this._findOAuthInfo(a)&&(e._selfReq={owningTenant:b&&b.owningTenant,selfDfd:this._getPortalSelf(e.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),a)}),this._enqueue(a,e,b,k,l)},getResourceName:function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,
"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(a,b,e){var d,f,k,l,q,r,w,t,p=this._rePortalTokenSvc.test(a.tokenServiceUrl),m=new g(window.location.href.toLowerCase()),v=this._getEsriAuthCookie(),x=!b,z=a.shortLivedTokenValidity;b&&(t=c.id.tokenValidity||z||c.id.defaultTokenValidity,t>z&&0<z&&(t=z));e&&(d=e.isAdmin,f=e.serverUrl,k=e.token,r=e.ssl,a.customParameters=
e.customParameters);d?l=a.adminTokenServiceUrl:(l=a.tokenServiceUrl,q=new g(l.toLowerCase()),v&&(w=v.auth_tier,w=w&&w.toLowerCase()),("web"===w||a.webTierAuth)&&e&&e.serverUrl&&!r&&"http"===m.scheme&&(u.hasSameOrigin(m.uri,l,!0)||"https"===q.scheme&&m.host===q.host&&"7080"===m.port&&"7443"===q.port)&&(l=l.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),x&&p&&(l=l.replace(/\/rest/i,"")));e=h.mixin({query:h.mixin({request:"getToken",username:b&&b.username,password:b&&b.password,serverUrl:f,token:k,
expiration:t,referer:d||p?window.location.host:null,client:d?"referer":null,f:"json"},a.customParameters),method:x?"auto":"post",authMode:"anonymous",useProxy:this._useProxy(a,e),responseType:"json",callbackParamName:x?"callback":void 0},e&&e.ioArgs);p||(e.withCredentials=!1);return y(l,e).then(function(c){c=c.data;if(!c||!c.token)return new n("identity-manager:authentication-failed","Unable to generate token");var e=a.server;return F[e]||(F[e]={}),b&&(F[e][b.username]=b.password),c.validity=t,c})},
isBusy:function(){return!!this._busy},checkSignInStatus:function(a){return this.getCredential(a,{prompt:!1}).then(function(a){return a.token?y(a.server+("portal"===a.scope?"/sharing/rest":"/rest/services"),{query:{f:"json",token:a.token},callbackParamName:"callback",authMode:"anonymous"}).then(function(){return a}).otherwise(function(b){if(498===b.code)throw a.destroy(),b=Error("User is not signed in."),b.code="IdentityManagerBase.6",b.log=!!l.isDebug,b;return a}):a})},setRedirectionHandler:function(a){this._redirectFunc=
a},setProtocolErrorHandler:function(a){this._protocolFunc=a},signIn:function(){},oAuthSignIn:function(){},destroyCredentials:function(){if(this.credentials){var a=this.credentials.slice();d.forEach(a,function(a){a.destroy()})}this.emit("credentials-destroy")},_getOAuthHash:function(){var b=window.location.hash;if(b){"#"===b.charAt(0)&&(b=b.substring(1));var b=a.queryToObject(b),c=!1;b.access_token&&b.expires_in&&b.state&&b.hasOwnProperty("username")?(b.state=JSON.parse(b.state),this._oAuthHash=b,
c=!0):b.error&&b.error_description&&(console.log("IdentityManager OAuth Error: ",b.error," - ",b.error_description),"access_denied"===b.error&&(c=!0));c&&(!k("ie")||8<k("ie"))&&(window.location.hash="")}},_findCredential:function(a,b){var c,e,f,g,k=-1,h=b&&b.token;b=b&&b.resource;var n=this._isServerRsrc(a)?"server":"portal",l=d.filter(this.credentials,function(b){return this._hasSameServerInstance(b.server,a)&&b.scope===n},this);if(a=b||a,l.length)if(1===l.length){if(c=l[0],g=this.findServerInfo(c.server),
e=g&&g.owningSystemUrl,f=e&&this.findCredential(e,c.userId),k=this._getIdenticalSvcIdx(a,c),!h)return-1===k&&c.resources.push(a),this._addResource(a,f),c;-1!==k&&(c.resources.splice(k,1),this._removeResource(a,f))}else{var q,p;if(d.some(l,function(b){return p=this._getIdenticalSvcIdx(a,b),-1!==p?(q=b,g=this.findServerInfo(q.server),e=g&&g.owningSystemUrl,f=e&&this.findCredential(e,q.userId),k=p,!0):!1},this),h)q&&(q.resources.splice(k,1),this._removeResource(a,f));else if(q)return this._addResource(a,
f),q}},_findOAuthInfo:function(a){var b=this.findOAuthInfo(a);return b||d.some(this.oAuthInfos,function(c){return this._isIdProvider(c.portalUrl,a)&&(b=c),!!b},this),b},_addResource:function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)},_removeResource:function(a,b){var c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))},_useProxy:function(a,b){return b&&b.isAdmin&&!u.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&
10.1==a.currentVersion&&!u.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new g(a);return a.scheme+"://"+a.host+(t.isDefined(a.port)?":"+a.port:"")},_getServerInstanceRoot:function(a){var b=a.toLowerCase(),c=b.indexOf(this._agsRest);return-1===c&&this._isAdminResource(a)&&(c=b.indexOf("/admin")),-1===c&&(c=b.indexOf("/sharing")),-1===c&&"/"===b.substr(-1)&&(c=b.length-1),-1<c?a.substring(0,c):a},_hasSameServerInstance:function(a,b){return"/"===a.substr(-1)&&(a=a.slice(0,
-1)),a=a.toLowerCase(),b=this._getServerInstanceRoot(b).toLowerCase(),a=a.substr(a.indexOf(":")),b=b.substr(b.indexOf(":")),a===b},_sanitizeUrl:function(a){a=u.normalize(h.trim(a));var b=(q.request.proxyUrl||"").toLowerCase(),c=b?a.toLowerCase().indexOf(b+"?"):-1;return-1!==c&&(a=a.substring(c+b.length+1)),u.urlToObject(a).path},_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||
this._isAdminResource(a)},_isIdenticalService:function(a,b){var c;this._isRESTService(a)&&this._isRESTService(b)?(a=this._getSuffix(a).toLowerCase(),b=this._getSuffix(b).toLowerCase(),(c=a===b,c)||(c=/(.*)\/(MapServer|FeatureServer).*/gi,c=a.replace(c,"$1")===b.replace(c,"$1"))):this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:this._isServerRsrc(a)||this._isServerRsrc(b)||!this._isPortalDomain(a)||(c=!0);return c},_isPortalDomain:function(a){a=a.toLowerCase();var b=(new g(a)).authority,c=this._portalConfig,
e=-1!==b.indexOf(this._agolSuffix);(!e&&c&&(e=this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),a)),e)||(this._arcgisUrl||(c=h.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new g(c)).authority),this._arcgisUrl&&(e=this._arcgisUrl.toLowerCase()===b));return e||(e=d.some(this._portals,function(b){return this._hasSameServerInstance(b,a)},this)),e=e||this._agsPortal.test(a)},_isIdProvider:function(a,b){var c=-1,e=-1;d.forEach(this._gwDomains,function(d,f){-1===c&&d.regex.test(a)&&
(c=f);-1===e&&d.regex.test(b)&&(e=f)});var f=!1;if(-1<c&&-1<e&&(0===c||4===c?(0===e||4===e)&&(f=!0):1===c?(1===e||2===e)&&(f=!0):2===c?2===e&&(f=!0):3===c&&3===e&&(f=!0)),!f){var g=this.findServerInfo(b),k=g&&g.owningSystemUrl;k&&G(g)&&this._isPortalDomain(k)&&this._isIdProvider(a,k)&&(f=!0)}return f},_isPublic:function(a){return a=this._sanitizeUrl(a),d.some(this._publicUrls,function(b){return b.test(a)})},_getIdenticalSvcIdx:function(a,b){var c=-1;return d.some(b.resources,function(b,e){return this._isIdenticalService(a,
b)?(c=e,!0):!1},this),c},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(a){var b,c,e,f=this._isRESTService(a);if(f||this._isAdminResource(a))return e=a.toLowerCase().indexOf(f?this._agsRest:"/admin/"),b=a.substring(0,e)+"/admin/generateToken",a=a.substring(0,e)+"/rest/info",c=y(a,{query:{f:"json"},responseType:"json",callbackParamName:"callback"}).then(function(a){return a.data}),{adminUrl:b,promise:c};if(this._isPortalDomain(a)){var k=
"";if(d.some(this._gwDomains,function(b){return b.regex.test(a)&&(k=b.tokenServiceUrl),!!k}),k||d.some(this._portals,function(b){return this._hasSameServerInstance(b,a)&&(k=b+this._gwTokenUrl),!!k},this),k||(e=a.toLowerCase().indexOf("/sharing"),-1!==e&&(k=a.substring(0,e)+this._gwTokenUrl)),k||(k=this._getOrigin(a)+this._gwTokenUrl),k)b=(new g(a)).port,/^http:\/\//i.test(a)&&"7080"===b&&(k=k.replace(/:7080/i,":7443")),k=k.replace(/http:/i,"https:");return k}return-1!==a.toLowerCase().indexOf("premium.arcgisonline.com")?
"https://premium.arcgisonline.com/server/tokens":void 0},_getPortalSelf:function(a,b){return"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),y(a,{query:{f:"json"},responseType:"json",callbackParamName:"callback",crossOrigin:!1,authMode:"anonymous"}).then(function(a){return a.data})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},_getEsriAuthCookie:function(){var a=
null;if(f.isSupported()){var b,c=this._getAllCookies("esri_auth");for(b=0;b<c.length;b++){var e=JSON.parse(c[b]);if(e.portalApp){a=e;break}}}a&&(b=null,a.expires&&("number"==typeof a.expires?b=a.expires:"string"==typeof a.expires&&(b=Date.parse(a.expires)),isNaN(b)&&(b=null),a.expires=b),b&&b<Date.now()&&(a=null));return a},_getAllCookies:function(a){var b=[],c=document.cookie.match(new RegExp("(?:^|; )"+e.escapeString(a)+"\x3d([^;]*)","g"));if(c)for(a=0;a<c.length;a++){var d=c[a],f=d.indexOf("\x3d");
-1<f&&(d=d.substring(f+1),b.push(decodeURIComponent(d)))}return b},_doPortalSignIn:function(a){if(f.isSupported()){var b=this._getEsriAuthCookie(),c=this._portalConfig,e=window.location.href,d=this.findServerInfo(a);if(this.useSignInPage&&(c||this._isPortalDomain(e)||b)&&(d?d.hasPortal||d.owningSystemUrl&&this._isPortalDomain(d.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(e,a)||c&&(this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),a)||this._isIdProvider(c.restBaseUrl,
a))||u.hasSameOrigin(e,a,!0)))return!0}return!1},_checkProtocol:function(a,b,c,e){var d=!0;e=e?b.adminTokenServiceUrl:b.tokenServiceUrl;0!==h.trim(e).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||q.request.useCors&&(u.canUseXhr(e)||u.canUseXhr(u.getProxyUrl(!0).path))||(d=this._protocolFunc?!!this._protocolFunc({resourceUrl:a,serverInfo:b}):!1)||(a=new n("identity-manager:aborted","Aborted the Sign-In process to avoid sending password over insecure connection."),
c(a));return d},_enqueue:function(a,b,c,e,d,f){return e||(e=v.makeDeferredCancellingPending()),e.resUrl_=a,e.sinfo_=b,e.options_=c,e.admin_=d,e.refresh_=f,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(e)):this._xoReqs.push(e):this._doSignIn(e),e.promise},_doSignIn:function(a){this._busy=a;var b=this,c=function(c){var e=a.options_&&a.options_.resource,f=a.resUrl_,
g=a.refresh_,k=!1;-1===d.indexOf(b.credentials,c)&&(g&&-1!==d.indexOf(b.credentials,g)?(g.userId=c.userId,g.token=c.token,g.expires=c.expires,g.validity=c.validity,g.ssl=c.ssl,g.creationTime=c.creationTime,k=!0,c=g):b.credentials.push(c));c.resources||(c.resources=[]);c.resources.push(e||f);c.scope=b._isServerRsrc(f)?"server":"portal";c.emitTokenChange();var e=b._soReqs,h={};b._soReqs=[];d.forEach(e,function(a){if(!this._isIdenticalService(f,a.resUrl_)){var b=this._getSuffix(a.resUrl_);h[b]||(h[b]=
!0,c.resources.push(a.resUrl_))}},b);a.resolve(c);d.forEach(e,function(a){this._hasSameServerInstance(this._getServerInstanceRoot(f),a.resUrl_)?a.resolve(c):this._soReqs.push(a)},b);b._busy=a.resUrl_=a.sinfo_=a.refresh_=null;k||b.emit("credential-create",{credential:c});b._soReqs.length?b._doSignIn(b._soReqs.shift()):b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},e=function(c){a.reject(c);b._busy=a.resUrl_=a.sinfo_=a.refresh_=null;b._soReqs.length?b._doSignIn(b._soReqs.shift()):b._xoReqs.length&&
b._doSignIn(b._xoReqs.shift())},f=function(d,f,g,k){var h,l;h=a.sinfo_;var p=!a.options_||!1!==a.options_.prompt,q=h.hasPortal&&b._findOAuthInfo(a.resUrl_);if(b._doPortalSignIn(a.resUrl_)){d=b._getEsriAuthCookie();q=b._portalConfig;if(d)return h.webTierAuth||"web"===(d.auth_tier&&d.auth_tier.toLowerCase())&&(h.webTierAuth=!0),void c(new B({userId:d.email,server:h.server,token:d.token,expires:d.expires}));if(p)return p="",d=window.location.href,p=b.signInPage?b.signInPage:q?q.baseUrl+q.signin:b._isIdProvider(d,
a.resUrl_)?b._getOrigin(d)+"/home/signin.html":h.tokenServiceUrl.replace(b._rePortalTokenSvc,"")+"/home/signin.html",p=p.replace(/http:/i,"https:"),q&&!1===q.useSSL&&(p=p.replace(/https:/i,"http:")),void(0===d.toLowerCase().replace("https","http").indexOf(p.toLowerCase().replace("https","http"))?(l=new n("identity-manager:unexpected-error","Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+a.resUrl_),e(l)):b._redirectFunc?b._redirectFunc({signInPage:p,
returnUrlParamName:"returnUrl",returnUrl:d,resourceUrl:a.resUrl_,serverInfo:h}):window.location=p+"?returnUrl\x3d"+window.escape(d));l=new n("identity-manager:not-authenticated","User is not signed in.");e(l)}else d?c(new B({userId:d,server:h.server,token:g,expires:t.isDefined(k)?Number(k):null,ssl:!!f})):q?(d=q._oAuthCred,d||(f=new z(q,window.localStorage),g=new z(q,window.sessionStorage),f.isValid()&&g.isValid()?f.expires>g.expires?(d=f,g.destroy()):(d=g,f.destroy()):d=f.isValid()?f:g,q._oAuthCred=
d),d.isValid()?c(new B({userId:d.userId,server:h.server,token:d.token,expires:d.expires,ssl:d.ssl,_oAuthCred:d})):b._oAuthHash&&b._oAuthHash.state.portalUrl===q.portalUrl?(l=b._oAuthHash,h=new B({userId:l.username,server:h.server,token:l.access_token,expires:(new Date).getTime()+1E3*Number(l.expires_in),ssl:"true"===l.ssl,oAuthState:l.state,_oAuthCred:d}),d.storage=l.persist?window.localStorage:window.sessionStorage,d.token=h.token,d.expires=h.expires,d.userId=h.userId,d.ssl=h.ssl,d.save(),b._oAuthHash=
null,c(h)):p?a._pendingDfd=b.oAuthSignIn(a.resUrl_,h,q,a.options_).then(c,e):(l=new n("identity-manager:not-authenticated","User is not signed in."),e(l))):p?b._checkProtocol(a.resUrl_,h,e,a.admin_)&&(l=a.options_,a.admin_&&(l=l||{},l.isAdmin=!0),a._pendingDfd=b.signIn(a.resUrl_,h,l).then(c,e)):(l=new n("identity-manager:not-authenticated","User is not signed in."),e(l))},g=function(){var f,g,k,h,n=a.sinfo_,l=n.owningSystemUrl,q=a.options_;(q&&(f=q.token,g=q.error,k=q.prompt),h=b._findCredential(l,
{token:f,resource:a.resUrl_}),!h&&G(n)&&d.some(b.credentials,function(a){return this._isIdProvider(l,a.server)&&(h=a),!!h},b),h)?(f=b.findCredential(a.resUrl_,h.userId))?c(f):N(n,b._legacyFed)?(f=h.toJSON(),f.server=n.server,f.resources=null,c(new B(f))):(a._pendingDfd=b.generateToken(b.findServerInfo(h.server),null,{serverUrl:a.resUrl_,token:h.token,ssl:h.ssl})).then(function(b){c(new B({userId:h.userId,server:n.server,token:b.token,expires:t.isDefined(b.expires)?Number(b.expires):null,ssl:!!b.ssl,
isAdmin:a.admin_,validity:b.validity}))},e):(b._busy=null,f&&(a.options_.token=null),(a._pendingDfd=b.getCredential(l.replace(/\/?$/,"/sharing"),{resource:a.resUrl_,owningTenant:n.owningTenant,token:f,error:g,prompt:k})).then(function(c){b._enqueue(a.resUrl_,a.sinfo_,a.options_,a,a.admin_)},function(a){e(a)}))},k=a.sinfo_.owningSystemUrl,l=this._isServerRsrc(a.resUrl_),q=a.sinfo_._restInfoPms;q?q.promise.then(function(c){var e=a.sinfo_;e.adminTokenServiceUrl=e._restInfoPms.adminUrl;e._restInfoPms=
null;e.tokenServiceUrl=h.getObject("authInfo.tokenServicesUrl",!1,c)||h.getObject("authInfo.tokenServiceUrl",!1,c)||h.getObject("tokenServiceUrl",!1,c);e.shortLivedTokenValidity=h.getObject("authInfo.shortLivedTokenValidity",!1,c);e.currentVersion=c.currentVersion;e.owningTenant=c.owningTenant;(c=e.owningSystemUrl=c.owningSystemUrl)&&b._portals.push(c);l&&c?g():f()},function(){a.sinfo_._restInfoPms=null;var b=new n("identity-manager:server-identification-failed","Unknown resource - could not find token service endpoint.");
e(b)}):l&&k?g():a.sinfo_._selfReq?a.sinfo_._selfReq.selfDfd.then(function(c){var e,d,f,g,k={};return c&&(e=c.user&&c.user.username,k.username=e,k.allSSL=c.allSSL,d=c.supportsOAuth,f=c.currentVersion,"multitenant"===c.portalMode&&(g=c.customBaseUrl)),a.sinfo_.webTierAuth=!!e,e&&b.normalizeWebTierAuth?b.generateToken(a.sinfo_,null,{ssl:k.allSSL}).always(function(a){return k.portalToken=a&&a.token,k.tokenExpiration=a&&a.expires,k}):!e&&d&&4.4<=parseFloat(f)&&!b._doPortalSignIn(a.resUrl_)?b._generateOAuthInfo({portalUrl:a.sinfo_.server,
customBaseUrl:g,owningTenant:a.sinfo_._selfReq.owningTenant}).always(function(){return k}):k}).always(function(b){a.sinfo_._selfReq=null;b?f(b.username,b.allSSL,b.portalToken,b.tokenExpiration):f()}):f()},_generateOAuthInfo:function(a){var c,e,d=this,f=a.portalUrl,g=a.customBaseUrl,k=a.owningTenant;if(a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){e=window.location.href;var h=e.indexOf("?");-1<h&&(e=e.slice(0,h));h=e.search(/\/(apps|home)\//);e=-1<h?e.slice(0,
h):null}return a&&e?(this._hasTestedIfAppIsOnPortal=!0,c=y(e+"/sharing/rest",{query:{f:"json"},responseType:"json"}).then(function(){d.defaultOAuthInfo=new C({appId:"arcgisonline",popup:!0,popupCallbackUrl:e+"/home/oauth-callback.html"})})):(c=new b,c.resolve(),c=c.promise),c.then(function(){return d.defaultOAuthInfo?(f=f.replace(/^http:/i,"https:"),y(f+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:k,client_id:d.defaultOAuthInfo.appId,redirect_uri:u.makeAbsolute(d.defaultOAuthInfo.popupCallbackUrl),
f:"json"},responseType:"json",callbackParamName:"callback"}).then(function(a){if(a.data.valid){var b=d.defaultOAuthInfo.clone();a.data.urlKey&&g?b.portalUrl="https://"+a.data.urlKey+"."+g:b.portalUrl=f;d.oAuthInfos.push(b)}})):void 0})}});return B=x.createSubclass([w],{declaredClass:"esri.identity.Credential",constructor:function(a){a&&a._oAuthCred&&(this._oAuthCred=a._oAuthCred)},initialize:function(){this.resources=this.resources||[];t.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},
_oAuthCred:null,properties:{creationTime:{},expires:{},isAdmin:{},oAuthState:{},resources:{},scope:{},server:{},ssl:{},token:{},tokenRefreshBuffer:2,userId:{},validity:{}},refreshToken:function(){var a,b,e=this,f=this.resources&&this.resources[0],g=c.id.findServerInfo(this.server),k=g&&g.owningSystemUrl,h=!!k&&"server"===this.scope,n=h&&N(g,c.id._legacyFed),l=h&&c.id.findServerInfo(k),q=g.webTierAuth,r=q&&c.id.normalizeWebTierAuth,p=F[this.server],p=p&&p[this.userId],u={username:this.userId,password:p};
if((!q||r)&&(h&&!l&&d.some(c.id.serverInfos,function(a){return c.id._isIdProvider(k,a.server)&&(l=a),!!l}),a=l&&c.id.findCredential(l.server,this.userId),!h||a)){if(n)return void a.refreshToken();if(h)b={serverUrl:f,token:a&&a.token,ssl:a&&a.ssl};else if(r)u=null,b={ssl:this.ssl};else{if(!p){var w;return f&&(f=c.id._sanitizeUrl(f),this._enqueued=1,w=c.id._enqueue(f,g,null,null,this.isAdmin,this),w.then(function(){e._enqueued=0;e.refreshServerTokens()}).then(null,function(){e._enqueued=0})),w}this.isAdmin&&
(b={isAdmin:!0})}return c.id.generateToken(h?l:g,h?null:u,b).then(function(a){e.token=a.token;e.expires=t.isDefined(a.expires)?Number(a.expires):null;e.creationTime=(new Date).getTime();e.validity=a.validity;e.emitTokenChange();e.refreshServerTokens()}).then(null,function(){})}},refreshServerTokens:function(){"portal"===this.scope&&d.forEach(c.id.credentials,function(a){var b=c.id.findServerInfo(a.server),e=b&&b.owningSystemUrl;a!==this&&a.userId===this.userId&&e&&"server"===a.scope&&(c.id._hasSameServerInstance(this.server,
e)||c.id._isIdProvider(e,this.server))&&(N(b,c.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.emitTokenChange()):a.refreshToken())},this)},emitTokenChange:function(a){clearTimeout(this._refreshTimer);var b=this.server&&c.id.findServerInfo(this.server),e=(b=b&&b.owningSystemUrl)&&c.id.findServerInfo(b);!1!==a&&(!b||"portal"===this.scope||e&&e.webTierAuth&&!c.id.normalizeWebTierAuth)&&(t.isDefined(this.expires)||t.isDefined(this.validity))&&
this._startRefreshTimer();this.emit("token-change")},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var a=d.indexOf(c.id.credentials,this);-1<a&&c.id.credentials.splice(a,1);this.emitTokenChange();this.emit("destroy")},toJSON:function(){var a=t.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,
isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;return b&&0<b.length&&(a.resources=b.slice()),a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var a=6E4*this.tokenRefreshBuffer,b=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>b&&(b=0);this._refreshTimer=setTimeout(h.hitch(this,this.refreshToken),b>a?b-a:b)}}),m.Credential=B,m})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(m,
l){m.cookie=function(h,d,b){var g=document.cookie,k;if(1==arguments.length)k=(k=g.match(new RegExp("(?:^|; )"+l.escapeString(h)+"\x3d([^;]*)")))?decodeURIComponent(k[1]):void 0;else{b=b||{};g=b.expires;if("number"==typeof g){var f=new Date;f.setTime(f.getTime()+864E5*g);g=b.expires=f}g&&g.toUTCString&&(b.expires=g.toUTCString());d=encodeURIComponent(d);var g=h+"\x3d"+d,a;for(a in b)g+="; "+a,f=b[a],!0!==f&&(g+="\x3d"+f);document.cookie=g}return k};m.cookie.isSupported=function(){"cookieEnabled"in
navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return m.cookie})},"esri/identity/ServerInfo":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/JSONSupport".split(" "),function(m,l,h,d,b,g){return function(g){function f(a){a=g.call(this)||
this;return a.adminTokenServiceUrl=null,a.currentVersion=null,a.hasPortal=null,a.hasServer=null,a.owningSystemUrl=null,a.owningTenant=null,a.server=null,a.shortLivedTokenValidity=null,a.tokenServiceUrl=null,a.webTierAuth=null,a}return h(f,g),d([b.property({json:{write:!0}})],f.prototype,"adminTokenServiceUrl",void 0),d([b.property({json:{write:!0}})],f.prototype,"currentVersion",void 0),d([b.property({json:{write:!0}})],f.prototype,"hasPortal",void 0),d([b.property({json:{write:!0}})],f.prototype,
"hasServer",void 0),d([b.property({json:{write:!0}})],f.prototype,"owningSystemUrl",void 0),d([b.property({json:{write:!0}})],f.prototype,"owningTenant",void 0),d([b.property({json:{write:!0}})],f.prototype,"server",void 0),d([b.property({json:{write:!0}})],f.prototype,"shortLivedTokenValidity",void 0),d([b.property({json:{write:!0}})],f.prototype,"tokenServiceUrl",void 0),d([b.property({json:{write:!0}})],f.prototype,"webTierAuth",void 0),f=d([b.subclass("esri.identity.ServerInfo")],f)}(b.declared(g))})},
"esri/identity/OAuthCredential":function(){define(["../core/declare"],function(m){return m(null,{declaredClass:"esri.identity.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(l,h){this.oAuthInfo=l;this.storage=h;this._init()},isValid:function(){var l=!1;if(this.oAuthInfo&&this.token&&this.userId){var h=(new Date).getTime();this.expires>h&&(this.expires-h)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(l=!0)}return l},save:function(){if(this.storage){var l=
this._load(),h=this.oAuthInfo;if(h&&h.authNamespace&&h.portalUrl){var d=l[h.authNamespace];d||(d=l[h.authNamespace]={});d[h.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(l))}catch(b){console.log(b)}}}},destroy:function(){var l=this._load(),h=this.oAuthInfo;if(h&&h.authNamespace&&h.portalUrl&&this.storage){var d=l[h.authNamespace];if(d){delete d[h.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(l))}catch(b){console.log(b)}}}h&&
(h._oAuthCred=null,this.oAuthInfo=null)},_init:function(){var l=this._load(),h=this.oAuthInfo;h&&h.authNamespace&&h.portalUrl&&(l=l[h.authNamespace])&&(l=l[h.portalUrl],l&&(this.expires=l.expires,this.ssl=l.ssl,this.token=l.token,this.userId=l.userId))},_load:function(){var l={};if(this.storage){var h=this.storage.getItem("esriJSAPIOAuth");if(h)try{l=JSON.parse(h)}catch(d){console.log(d)}}return l}})})},"esri/identity/OAuthInfo":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/JSONSupport".split(" "),
function(m,l,h,d,b,g){return function(g){function f(a){a=g.call(this)||this;return a._oAuthCred=null,a.appId=null,a.authNamespace="/",a.expiration=20160,a.forceLogin=!1,a.locale=null,a.minTimeUntilExpiration=30,a.popup=!1,a.popupCallbackUrl="oauth-callback.html",a.popupWindowFeatures="height\x3d490,width\x3d800,resizable,scrollbars,status",a.portalUrl="https://www.arcgis.com",a}return h(f,g),a=f,f.prototype.clone=function(){return a.fromJSON(this.toJSON())},d([b.property({json:{write:!0}})],f.prototype,
"appId",void 0),d([b.property({json:{write:!0}})],f.prototype,"authNamespace",void 0),d([b.property({json:{write:!0}})],f.prototype,"expiration",void 0),d([b.property({json:{write:!0}})],f.prototype,"forceLogin",void 0),d([b.property({json:{write:!0}})],f.prototype,"locale",void 0),d([b.property({json:{write:!0}})],f.prototype,"minTimeUntilExpiration",void 0),d([b.property({json:{write:!0}})],f.prototype,"popup",void 0),d([b.property({json:{write:!0}})],f.prototype,"popupCallbackUrl",void 0),d([b.property({json:{write:!0}})],
f.prototype,"popupWindowFeatures",void 0),d([b.property({json:{write:!0}})],f.prototype,"portalUrl",void 0),f=a=d([b.subclass("esri.identity.OAuthInfo")],f);var a}(b.declared(g))})},"esri/identity/nls/identity":function(){define({root:{lblItem:"item",title:"Sign In",info:"Please sign in to access the item on {server} {resource}",oAuthInfo:"Please sign in to continue.",lblUser:"Username:",lblPwd:"Password:",lblOk:"OK",lblSigning:"Signing in...",lblCancel:"Cancel",errorMsg:"Invalid username/password. Please try again.",
invalidUser:"The username or password you entered is incorrect.",forbidden:"The username and password are valid, but you don't have access to this resource.",noAuthService:"Unable to access the authentication service."},ar:1,bs:1,cs:1,da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,he:1,hr:1,hi:1,id:1,it:1,ja:1,ko:1,lv:1,lt:1,nl:1,nb:1,pl:1,"pt-br":1,"pt-pt":1,ro:1,ru:1,sl:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),
function(m,l,h,d,b,g,k,f,a,e){d("dijit-legacy-requires")&&k(0,function(){m(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});k=l("dijit.form.Button"+(d("dojo-bidi")?"_NoBidi":""),[f,a],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:e,_setValueAttr:"valueNode",_setNameAttr:function(a){this.valueNode&&this.valueNode.setAttribute("name",a)},postCreate:function(){this.inherited(arguments);
this._setLabelFromContainer()},_setLabelFromContainer:function(){this.containerNode&&!this.label&&(this.label=g.trim(this.containerNode.innerHTML),this.onLabelSet())},_setShowLabelAttr:function(a){this.containerNode&&h.toggle(this.containerNode,"dijitDisplayNone",!a);this._set("showLabel",a)},setLabel:function(a){b.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},onLabelSet:function(){this.inherited(arguments);this.showLabel||
"title"in this.params||(this.titleNode.title=g.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});d("dojo-bidi")&&(k=l("dijit.form.Button",k,{onLabelSet:function(){this.inherited(arguments);this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this._setLabelAttr(this.label))}}));return k})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),
function(m,l,h,d,b,g,k,f){l("dijit-legacy-requires")&&d(0,function(){require(["dijit/form/_FormValueWidget"])});return m("dijit.form._FormWidget",[b,k,g,f],{setDisabled:function(a){h.deprecated("setDisabled("+a+") is deprecated. Use set('disabled',"+a+") instead.","","2.0");this.set("disabled",a)},setValue:function(a){h.deprecated("dijit.form._FormWidget:setValue("+a+") is deprecated.  Use set('value',"+a+") instead.","","2.0");this.set("value",a)},getValue:function(){h.deprecated(this.declaredClass+
"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),function(m,l,h,d,b,g,k,f,a,e){return l("dijit.form._FormWidgetMixin",
null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(a){this._set("disabled",a);/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)?h.set(this.focusNode,"disabled",a):this.focusNode.setAttribute("aria-disabled",a?"true":"false");this.valueNode&&h.set(this.valueNode,"disabled",a);a?(this._set("hovering",!1),
this._set("active",!1),a="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",m.forEach(b.isArray(a)?a:[a],function(a){a=this[a];f("webkit")||e.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(c){if("mouse"==c&&this.isFocusable())var e=this.own(k(this.focusNode,"focus",function(){d.remove();e.remove()}))[0],d=this.own(k(this.ownerDocumentBody,
"pointerup",b.hitch(this,function(a){d.remove();e.remove();this.focused&&("touchend"==a.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){a.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=d.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(c){}},compare:function(a,b){return"number"==typeof a&&"number"==typeof b?isNaN(a)&&
isNaN(b)?0:a-b:a>b?1:a<b?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(a,b){void 0!=this._lastValueReported||null!==b&&this._onChangeActive||(this._resetValue=this._lastValueReported=a);this._pendingOnChange=this._pendingOnChange||typeof a!=typeof this._lastValueReported||0!=this.compare(a,this._lastValueReported);(this.intermediateChanges||b||void 0===b)&&this._pendingOnChange&&(this._lastValueReported=a,this._pendingOnChange=!1,this._onChangeActive&&(this._onChangeHandle&&
this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(a)})))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],function(m,l,h,d){var b=m("dijit.form._ButtonMixin"+(h("dojo-bidi")?
"_NoBidi":""),null,{label:"",type:"button",__onClick:function(b){b.stopPropagation();b.preventDefault();this.disabled||this.valueNode.click(b);return!1},_onClick:function(b){if(this.disabled)return b.stopPropagation(),b.preventDefault(),!1;!1===this.onClick(b)&&b.preventDefault();var g=b.defaultPrevented;if(!g&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var f=this.domNode;f.parentNode;f=f.parentNode){var a=d.byNode(f);if(a&&"function"==typeof a._onSubmit){a._onSubmit(b);b.preventDefault();
g=!0;break}}return!g},postCreate:function(){this.inherited(arguments);l.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(b){this._set("label",b);(this.containerNode||this.focusNode).innerHTML=b;this.onLabelSet()},onLabelSet:function(){}});h("dojo-bidi")&&(b=m("dijit.form._ButtonMixin",b,{onLabelSet:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));return b})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),
function(m,l,h,d,b,g,k,f){return m("dijit.form.Form",[b,g,k,f],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(a){l.set(this.domNode,
"encType",a);d("ie")&&(this.domNode.encoding=a);this._set("encType",a)},reset:function(a){var b={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:a?a.target:this.domNode,target:a?a.target:this.domNode};!1!==this.onReset(b)&&b.returnValue&&this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(a){this.reset(a);a.stopPropagation();a.preventDefault();return!1},_onSubmit:function(a){var b=this.constructor.prototype;if(this.execute!=
b.execute||this.onExecute!=b.onExecute)h.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(a)&&(a.stopPropagation(),a.preventDefault())},onSubmit:function(){return this.isValid()},submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),
function(m,l,h,d,b,g,k){var f=m("dijit.form.ValidationTextBox",b,{templateString:k,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(a,b){b!=f.prototype[a]&&(l.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+a+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",b))},_setRegExpGenAttr:function(a){this._deprecateRegExp("regExpGen",
a);this._set("regExpGen",this._computeRegexp)},_setRegExpAttr:function(a){this._deprecateRegExp("regExp",a)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},validator:function(a,b){return(new RegExp("^(?:"+this._computeRegexp(b)+")"+(this.required?"":"?")+"$")).test(a)&&(!this.required||!this._isEmpty(a))&&(this._isEmpty(a)||void 0!==this.parse(a,b))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,
this.get("constraints"))},_isEmpty:function(a){return(this.trim?/^\s*$/:/^$/).test(a)},getErrorMessage:function(){var a="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:this.invalidMessage?this.invalidMessage:this.promptMessage,b="$_unset_$"==this.missingMessage?this.messages.missingMessage:this.missingMessage?this.missingMessage:a;return this.required&&this._isEmpty(this.textbox.value)?b:a},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(a){var b=
"",c=this.disabled||this.isValid(a);c&&(this._maskValidSubsetError=!0);var d=this._isEmpty(this.textbox.value),f=!c&&a&&this._isValidSubset();this._set("state",c?"":((!this._hasBeenBlurred||a)&&d||f)&&(this._maskValidSubsetError||f&&!this._hasBeenBlurred&&a)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=a&&f,b=this.getErrorMessage(a)):"Incomplete"==this.state?(b=this.getPromptMessage(a),this._maskValidSubsetError=
!this._hasBeenBlurred||a):d&&(b=this.getPromptMessage(a));this.set("message",b);return c},displayMessage:function(a){a&&this.focused?g.show(a,this.domNode,this.tooltipPosition,!this.isLeftToRight()):g.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(a){this.constraints=h.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(a){!a.locale&&
this.lang&&(a.locale=this.lang);this._set("constraints",a);this._refreshState()},_setPatternAttr:function(a){this._set("pattern",a);this._refreshState()},_computeRegexp:function(a){var b=this.pattern;"function"==typeof b&&(b=b.call(this,a));if(b!=this._lastRegExp){var c="";this._lastRegExp=b;".*"!=b&&b.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":c+=a;break;case ")":c+="|$)";break;default:c+=
"(?:"+a+"|$)"}});try{"".search(c)}catch(q){c=this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+c+")$"}return b},postMixInProperties:function(){this.inherited(arguments);this.messages=d.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",
a);this._refreshState()},_setMessageAttr:function(a){this._set("message",a);this.displayMessage(a)},reset:function(){this._maskValidSubsetError=!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){g.hide(this.domNode);this.inherited(arguments)}});return f})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){f=m("dijit.form.TextBox"+(k("dojo-bidi")?"_NoBidi":""),[f,a],{templateString:e,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:k("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||
("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>k("ie")&&this.defer(function(){try{var a=h.getComputedStyle(this.domNode);if(a){var b=a.fontFamily;if(b){var c=this.domNode.getElementsByTagName("INPUT");if(c)for(a=0;a<c.length;a++)c[a].style.fontFamily=b}}}catch(u){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||
(this._attachPoints.push("_phspan"),this._phspan=l.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after"),this.own(g(this._phspan,"mousedown",function(a){a.preventDefault()}),g(this._phspan,"touchend, pointerup, MSPointerUp",b.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&
(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},_setValueAttr:function(a,b,c){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){d.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){d.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",
a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),this._updatePlaceHolder(),this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){this.disabled||this.readOnly||(this.inherited(arguments),this._updatePlaceHolder())}});9>k("ie")&&(f.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},c._setSelectionRange=a._setSelectionRange=function(a,b,c){a.createTextRange&&
(a=a.createTextRange(),a.collapse(!0),a.moveStart("character",-99999),a.moveStart("character",b),a.moveEnd("character",c-b),a.select())});k("dojo-bidi")&&(f=m("dijit.form.TextBox",f,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return f})},"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(m,l,h,d){return m("dijit.form._FormValueWidget",[h,d],{_layoutHackIE7:function(){if(7==
l("ie"))for(var b=this.domNode,d=b.parentNode,k=b.firstChild||b,f=k.style.filter,a=this;d&&0==d.clientHeight;)(function(){var b=a.connect(d,"onscroll",function(){a.disconnect(b);k.style.filter=(new Date).getMilliseconds();a.defer(function(){k.style.filter=f})})})(),d=d.parentNode}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(m,l,h,d,b,g){return m("dijit.form._FormValueMixin",g,{readOnly:!1,
_setReadOnlyAttr:function(b){l.set(this.focusNode,"readOnly",b);this._set("readOnly",b)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(b,d){this._handleOnChange(b,d)},_handleOnChange:function(b,d){this._set("value",b);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},
"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/sniff dojo/keys dojo/_base/lang dojo/on ../main".split(" "),function(m,l,h,d,b,g,k,f){var a=l("dijit.form._TextBoxMixin"+(d("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(a,b,d){var c;void 0!==a&&(c=this.filter(a),
"string"!=typeof d&&(d=null===c||"number"==typeof c&&isNaN(c)?"":this.filter(this.format(c,this.constraints)),0!=this.compare(c,this.filter(this.parse(d,this.constraints)))&&(d=null)));null==d||"number"==typeof d&&isNaN(d)||this.textbox.value==d||(this.textbox.value=d,this._set("displayedValue",this.get("displayedValue")));this.inherited(arguments,[c,b])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(a){null==a?a="":"string"!=
typeof a&&(a=String(a));this.textbox.value=a;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},format:function(a){return null==a?"":a.toString?a.toString():a},parse:function(a){return a},_refreshState:function(){},onInput:function(){},_onInput:function(a){this._lastInputEventValue=this.textbox.value;this._processInput(this._lastInputProducingEvent||a);delete this._lastInputProducingEvent;this.intermediateChanges&&this._handleOnChange(this.get("value"),
!1)},_processInput:function(){this._refreshState();this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);this.own(k(this.textbox,"keydown, keypress, paste, cut, compositionend",g.hitch(this,function(a){var c;if("keydown"==a.type&&229!=a.keyCode){c=a.keyCode;switch(c){case b.SHIFT:case b.ALT:case b.CTRL:case b.META:case b.CAPS_LOCK:case b.NUM_LOCK:case b.SCROLL_LOCK:return}if(!a.ctrlKey&&!a.metaKey&&
!a.altKey){switch(c){case b.NUMPAD_0:case b.NUMPAD_1:case b.NUMPAD_2:case b.NUMPAD_3:case b.NUMPAD_4:case b.NUMPAD_5:case b.NUMPAD_6:case b.NUMPAD_7:case b.NUMPAD_8:case b.NUMPAD_9:case b.NUMPAD_MULTIPLY:case b.NUMPAD_PLUS:case b.NUMPAD_ENTER:case b.NUMPAD_MINUS:case b.NUMPAD_PERIOD:case b.NUMPAD_DIVIDE:return}if(65<=c&&90>=c||48<=c&&57>=c||c==b.SPACE)return;c=!1;for(var e in b)if(b[e]===a.keyCode){c=!0;break}if(!c)return}}(c=32<=a.charCode?String.fromCharCode(a.charCode):a.charCode)||(c=65<=a.keyCode&&
90>=a.keyCode||48<=a.keyCode&&57>=a.keyCode||a.keyCode==b.SPACE?String.fromCharCode(a.keyCode):a.keyCode);c||(c=229);if("keypress"==a.type){if("string"!=typeof c)return;if("a"<=c&&"z">=c||"A"<=c&&"Z">=c||"0"<=c&&"9">=c||" "===c)if(a.ctrlKey||a.metaKey||a.altKey)return}var f={faux:!0},h;for(h in a)/^(layer[XY]|returnValue|keyLocation)$/.test(h)||(e=a[h],"function"!=typeof e&&"undefined"!=typeof e&&(f[h]=e));g.mixin(f,{charOrCode:c,_wasConsumed:!1,preventDefault:function(){f._wasConsumed=!0;a.preventDefault()},
stopPropagation:function(){a.stopPropagation()}});this._lastInputProducingEvent=f;!1===this.onInput(f)&&(f.preventDefault(),f.stopPropagation());if(!f._wasConsumed&&9>=d("ie"))switch(a.keyCode){case b.TAB:case b.ESCAPE:case b.DOWN_ARROW:case b.UP_ARROW:case b.LEFT_ARROW:case b.RIGHT_ARROW:break;default:a.keyCode==b.ENTER&&"textarea"!=this.textbox.tagName.toLowerCase()||this.defer(function(){this.textbox.value!==this._lastInputEventValue&&k.emit(this.textbox,"input",{bubbles:!0})})}})),k(this.textbox,
"input",g.hitch(this,"_onInput")),k(this.domNode,"keypress",function(a){a.stopPropagation()}))},_blankValue:"",filter:function(a){if(null===a)return this._blankValue;if("string"!=typeof a)return a;this.trim&&(a=g.trim(a));this.uppercase&&(a=a.toUpperCase());this.lowercase&&(a=a.toLowerCase());this.propercase&&(a=a.replace(/[^\s]+/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}));return a},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(a){this.disabled||
(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(b){this.disabled||this.readOnly||(this.selectOnClick&&"mouse"==b&&(this._selectOnClickHandle=k.once(this.domNode,"mouseup, touchend",g.hitch(this,function(b){this._isTextSelected()||a.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=
null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value="";this.inherited(arguments)}});d("dojo-bidi")&&(a=l("dijit.form._TextBoxMixin",a,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));a._setSelectionRange=f._setSelectionRange=function(a,b,
d){a.setSelectionRange&&a.setSelectionRange(b,d)};a.selectInputText=f.selectInputText=function(b,c,d){b=h.byId(b);isNaN(c)&&(c=0);isNaN(d)&&(d=b.value?b.value.length:0);try{b.focus(),a._setSelectionRange(b,c,d)}catch(t){}};return a})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y){function n(){}var w=l("dijit._MasterTooltip",[r,u],{duration:q.defaultDuration,templateString:x,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new v(this.domNode);this.fadeIn=h.fadeIn({node:this.domNode,duration:this.duration,onEnd:f.hitch(this,"_onShow")});this.fadeOut=h.fadeOut({node:this.domNode,duration:this.duration,onEnd:f.hitch(this,"_onHide")})},show:function(a,b,c,e,d,g,h){if(!this.aroundNode||this.aroundNode!==
b||this.containerNode.innerHTML!=a)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{this.containerNode.innerHTML=a;d&&this.set("textDir",d);this.containerNode.align=e?"right":"left";var l=t.around(this.domNode,b,c&&c.length?c:z.defaultPosition,!e,f.hitch(this,"orient")),q=l.aroundNodePos;"M"==l.corner.charAt(0)&&"M"==l.aroundCorner.charAt(0)?(this.connectorNode.style.top=q.y+(q.h-this.connectorNode.offsetHeight>>1)-l.y+"px",this.connectorNode.style.left=""):"M"==l.corner.charAt(1)&&
"M"==l.aroundCorner.charAt(1)?this.connectorNode.style.left=q.x+(q.w-this.connectorNode.offsetWidth>>1)-l.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");k.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=g||n;this.onMouseLeave=h||n}},orient:function(a,b,e,d,f){this.connectorNode.style.top="";var k=d.h;d=d.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove",
"BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[b+"-"+e];this.domNode.style.width="auto";var h=g.position(this.domNode);c("ie")&&(h.w+=2);g.setMarginBox(this.domNode,{w:Math.min(Math.max(d,1),h.w)});"B"==e.charAt(0)&&"B"==b.charAt(0)?(a=g.position(a),b=this.connectorNode.offsetHeight,
a.h>k?(this.connectorNode.style.top=k-(f.h+b>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(f.h/2-b/2,0),a.h-b)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,h.w-d)},_onShow:function(){c("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=!1,this.aroundNode=
null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=n},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});c("dojo-bidi")&&w.extend({_setAutoTextDir:function(a){this.applyTextDir(a);m.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=this.textDir}});y.showTooltip=
function(a,b,c,e,d,f,g){c&&(c=m.map(c,function(a){return{after:"after-centered",before:"before-centered"}[a]||a}));z._masterTT||(y._masterTT=z._masterTT=new w);return z._masterTT.show(a,b,c,e,d,f,g)};y.hideTooltip=function(a){return z._masterTT&&z._masterTT.hide(a)};var z=l("dijit.Tooltip",r,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(b){m.forEach(this._connections||[],function(a){m.forEach(a,function(a){a.remove()})},this);this._connectIds=
m.filter(f.isArrayLike(b)?b:b?[b]:[],function(a){return d.byId(a,this.ownerDocument)},this);this._connections=m.map(this._connectIds,function(b){b=d.byId(b,this.ownerDocument);var c=this.selector,g=c?function(a){return e.selector(c,a)}:function(a){return a},k=this;return[e(b,g(a.enter),function(){k._onHover(this)}),e(b,g("focusin"),function(){k._onHover(this)}),e(b,g(a.leave),f.hitch(k,"_onUnHover")),e(b,g("focusout"),f.hitch(k,"set","state","DORMANT"))]},this);this._set("connectId",b)},addTarget:function(a){a=
a.id||a;-1==m.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=m.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);b.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;m.forEach(f.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||this.domNode.innerHTML},
state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(z.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state","SHOWING")},
this.showDelay));break;case "SHOWING":var b=this.getContent(this._connectNode);if(!b){this.set("state","DORMANT");return}z.show(b,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,f.hitch(this,"set","state","SHOWING"),f.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&a!=this._connectNode&&
this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state","HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");m.forEach(this._connections||[],function(a){m.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});z._MasterTooltip=w;z.show=
y.showTooltip;z.hide=y.hideTooltip;z.defaultPosition=["after-centered","before-centered"];return z})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),function(m,l,h,d,b,g,k){function f(a,c,d,f){var e=g.getEffectiveBox(a.ownerDocument);a.parentNode&&"body"==String(a.parentNode.tagName).toLowerCase()||b.body(a.ownerDocument).appendChild(a);var k=null;m.some(c,function(b){var c=b.corner,g=b.pos,h=0,q=
{w:{L:e.l+e.w-g.x,R:g.x-e.l,M:e.w}[c.charAt(1)],h:{T:e.t+e.h-g.y,B:g.y-e.t,M:e.h}[c.charAt(0)]},r=a.style;r.left=r.right="auto";d&&(h=d(a,b.aroundCorner,c,q,f),h="undefined"==typeof h?0:h);var u=a.style,t=u.display,m=u.visibility;"none"==u.display&&(u.visibility="hidden",u.display="");r=l.position(a);u.display=t;u.visibility=m;t={L:g.x,R:g.x-r.w,M:Math.max(e.l,Math.min(e.l+e.w,g.x+(r.w>>1))-r.w)}[c.charAt(1)];m={T:g.y,B:g.y-r.h,M:Math.max(e.t,Math.min(e.t+e.h,g.y+(r.h>>1))-r.h)}[c.charAt(0)];g=Math.max(e.l,
t);u=Math.max(e.t,m);t=Math.min(e.l+e.w,t+r.w)-g;m=Math.min(e.t+e.h,m+r.h)-u;h+=r.w-t+(r.h-m);if(null==k||h<k.overflow)k={corner:c,aroundCorner:b.aroundCorner,x:g,y:u,w:t,h:m,overflow:h,spaceAvailable:q};return!h});k.overflow&&d&&d(a,k.aroundCorner,k.corner,k.spaceAvailable,f);c=k.y;var q=k.x,t=b.body(a.ownerDocument);/relative|absolute/.test(h.get(t,"position"))&&(c-=h.get(t,"marginTop"),q-=h.get(t,"marginLeft"));t=a.style;t.top=c+"px";t.left=q+"px";t.right="auto";return k}var a={TL:"BR",TR:"BL",
BL:"TR",BR:"TL"};return k.place={at:function(b,c,d,g,k){d=m.map(d,function(b){var e={corner:b,aroundCorner:a[b],pos:{x:c.x,y:c.y}};g&&(e.pos.x+="L"==b.charAt(1)?g.x:-g.x,e.pos.y+="T"==b.charAt(0)?g.y:-g.y);return e});return f(b,d,k)},around:function(a,b,g,k,r){function c(a,b){N.push({aroundCorner:a,corner:b,pos:{x:{L:C,R:C+F,M:C+(F>>1)}[a.charAt(1)],y:{T:B,B:B+G,M:B+(G>>1)}[a.charAt(0)]}})}var e;if("string"==typeof b||"offsetWidth"in b||"ownerSVGElement"in b){if(e=l.position(b,!0),/^(above|below)/.test(g[0])){var q=
l.getBorderExtents(b),t=b.firstChild?l.getBorderExtents(b.firstChild):{t:0,l:0,b:0,r:0},n=l.getBorderExtents(a),w=a.firstChild?l.getBorderExtents(a.firstChild):{t:0,l:0,b:0,r:0};e.y+=Math.min(q.t+t.t,n.t+w.t);e.h-=Math.min(q.t+t.t,n.t+w.t)+Math.min(q.b+t.b,n.b+w.b)}}else e=b;if(b.parentNode)for(q="absolute"==h.getComputedStyle(b).position,b=b.parentNode;b&&1==b.nodeType&&"BODY"!=b.nodeName;){t=l.position(b,!0);n=h.getComputedStyle(b);/relative|absolute/.test(n.position)&&(q=!1);if(!q&&/hidden|auto|scroll/.test(n.overflow)){var w=
Math.min(e.y+e.h,t.y+t.h),z=Math.min(e.x+e.w,t.x+t.w);e.x=Math.max(e.x,t.x);e.y=Math.max(e.y,t.y);e.h=w-e.y;e.w=z-e.x}"absolute"==n.position&&(q=!0);b=b.parentNode}var C=e.x,B=e.y,F="w"in e?e.w:e.w=e.width,G="h"in e?e.h:(d.deprecated("place.around: dijit/place.__Rectangle: { x:"+C+", y:"+B+", height:"+e.height+", width:"+F+" } has been deprecated.  Please use { x:"+C+", y:"+B+", h:"+e.height+", w:"+F+" }","","2.0"),e.h=e.height),N=[];m.forEach(g,function(a){var b=k;switch(a){case "above-centered":c("TM",
"BM");break;case "below-centered":c("BM","TM");break;case "after-centered":b=!b;case "before-centered":c(b?"ML":"MR",b?"MR":"ML");break;case "after":b=!b;case "before":c(b?"TL":"TR",b?"TR":"TL");c(b?"BL":"BR",b?"BR":"BL");break;case "below-alt":b=!b;case "below":c(b?"BL":"BR",b?"TL":"TR");c(b?"BR":"BL",b?"TR":"TL");break;case "above-alt":b=!b;case "above":c(b?"TL":"TR",b?"BL":"BR");c(b?"TR":"TL",b?"BR":"BL");break;default:c(a.aroundCorner,a.corner)}});a=f(a,N,r,{w:F,h:G});a.aroundNodePos=e;return a}}})},
"dijit/form/nls/validate":function(){define({root:{invalidMessage:"The value entered is not valid.",missingMessage:"This value is required.",rangeMessage:"This value is out of range."},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,hi:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"esri/identity/OAuthSignInHandler":function(){define("./Credential ../core/domUtils ../core/lang ../core/Error ../core/urlUtils dijit/Dialog dijit/registry dojo/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/identity dojo/io-query dojo/sniff dijit/form/Button dojo/query".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e{oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e{invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e{lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e{lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,b,d,g){var k=this._oAuthDfd=new f;k.resUrl_=a;k.sinfo_=b;k.oinfo_=d;var h=!g||!1!==g.oAuthPopupConfirmation;if(!d.popup||!h)return this._doOAuthSignIn(a,b,d),k.promise;this._nls||(this._nls=c);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());a=this.oAuthDialog;b=g&&g.error;g=g&&g.token;return l.hide(a.errMsg_),b&&b.details&&403==b.details.httpStatus&&g&&(e.set(a.errMsg_,"innerHTML",this._nls.forbidden),
l.show(a.errMsg_)),a.show(),k.promise},setOAuthResponseHash:function(a){var b=this._oAuthDfd;if(this._oAuthDfd=null,b&&a)if(clearInterval(this._oAuthIntervalId),"#"===a.charAt(0)&&(a=a.substring(1)),a=q.queryToObject(a),a.error){var c="access_denied"===a.error;a=new d(c?"identity-manager:user-aborted":"identity-manager:authentication-failed",c?"ABORTED":"OAuth: "+a.error+" - "+a.error_description);b.reject(a)}else{var c=b.oinfo_._oAuthCred,e=new m({userId:a.username,server:b.sinfo_.server,token:a.access_token,
expires:(new Date).getTime()+1E3*Number(a.expires_in),ssl:"true"===a.ssl,_oAuthCred:c});c.storage=a.persist?window.localStorage:window.sessionStorage;c.token=e.token;c.expires=e.expires;c.userId=e.userId;c.ssl=e.ssl;c.save();b.resolve(e)}},_createOAuthDialog:function(){var b=this._nls,c=h.substitute(b,this._oAuthDialogContent),e=new g({title:b.title,content:c,"class":"esri-widget esriOAuthSignInDialog esriIdentityDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=e.esriIdMgr_._oAuthDfd;
e.hide_();e.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=e.esriIdMgr_._oAuthDfd;e.esriIdMgr_._oAuthDfd=null;e.hide_();var b=new d("identity-manager:user-aborted","ABORTED");a.reject(b)},hide_:function(){l.hide(e.errMsg_);e.hide();g._DialogLevelManager.hide(e)}}),b=e.domNode;return e.btnSubmit_=k.byNode(a.query(".esriIdSubmit",b)[0]),e.btnCancel_=k.byNode(a.query(".esriIdCancel",b)[0]),e.errMsg_=a.query(".esriErrorMsg",b)[0],e.connect(e.btnSubmit_,"onClick",e.execute_),
e.connect(e.btnCancel_,"onClick",e.onCancel),e.connect(e,"onCancel",e.cancel_),e},_doOAuthSignIn:function(a,c,e){var f=this,g={client_id:e.appId,response_type:"token",state:JSON.stringify({portalUrl:e.portalUrl}),expiration:e.expiration,locale:e.locale,redirect_uri:e.popup?b.makeAbsolute(e.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};e.forceLogin&&(g.force_login=!0);var k=e.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",h=k+"?"+q.objectToQuery(g);if(e.popup){var l;
(7===t("ie")?(l=window.open(e.popupCallbackUrl,"esriJSAPIOAuth",e.popupWindowFeatures),l.location=h):l=window.open(h,"esriJSAPIOAuth",e.popupWindowFeatures),l)?(l.focus(),this._oAuthDfd.oAuthWin_=l,this._oAuthIntervalId=setInterval(function(){if(l.closed){clearInterval(f._oAuthIntervalId);var a=f._oAuthDfd;if(a){var b=new d("identity-manager:user-aborted","ABORTED");a.reject(b)}}},500)):(a=new d("identity-manager:popup-blocked","ABORTED"),this._oAuthDfd.reject(a))}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:g,
authorizeUrl:k,resourceUrl:a,serverInfo:c,oAuthInfo:e}):window.location=h}}})},"esri/views/SceneView":function(){define("../core/accessorSupport/watch dojo/_base/kernel dojo/dom dojo/Deferred dojo/when ./View ./BreakpointsOwner ./DOMContainer ./ViewAnimation ../geometry/HeightModelInfo ../geometry/SpatialReference ../geometry/support/scaleUtils ../geometry/support/webMercatorUtils ../Camera ../Graphic ../geometry/Point ../geometry/Extent ../geometry/ScreenPoint ../Viewpoint ../core/Scheduler ../core/sniff ../core/watchUtils ../core/promiseUtils ../core/Error ../core/Logger ../core/HandleRegistry ../webscene/Environment ./support/screenshotUtils ./support/WebGLRequirements ./3d/state/ViewState ./3d/state/ViewStateManager ./3d/environment/SceneViewEnvironment ./3d/environment/SceneViewEnvironmentManager ./3d/constraints/Constraints ./3d/input/SceneInputManager ./3d/lib/glMatrix ./3d/support/projectionUtils ./3d/webgl-engine/Stage ./3d/webgl-engine/lib/Selector ./3d/support/CombinedElevationProvider ./3d/support/HighlightOptions ./3d/support/RenderCoordsHelper ./3d/support/MapCoordsHelper ./3d/support/ResourceController ./3d/support/DisplayQualityProfile ./3d/support/QualitySettings ./3d/support/SharedSymbolResources ./3d/support/pointsOfInterest/PointsOfInterest ./3d/support/debugFlags ./3d/terrain/TerrainSurface ./3d/terrain/terrainUtils ./3d/layers/graphics/Deconflictor ./3d/layers/GraphicsView3D ./ui/3d/DefaultUI3D".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P,Q,T,O,S,H,Y,W,E,p,A,K,U,V,X,ba,fa,ha,ca,ea,ja,na,za,ua,wa,da){ca=ca["default"];T=T["default"];H=H["default"];var ra=G.getLogger("esri.views.SceneView");Q=Q.ViewState;var ga=W.vec3d,pa=ga.create(),J={point:new v(0,0,0),retval:null};ea=ea["default"];return f.createSubclass([g,k],{declaredClass:"esri.views.SceneView",properties:{activeTool:{value:null,set:function(a){if(a&&!this.ready)return void ra.error("#activeTool\x3d","cannot set active tool while view is not ready");
var b=this._get("activeTool");a!==b&&(b&&b.deactivate(this.inputManager._inputManager),this._set("activeTool",a),a&&a.activate(this.inputManager._inputManager))}},animation:{type:a,readOnly:!0,aliasOf:"state.animation"},basemapTerrain:{readOnly:!0,value:null},elevationProvider:{readOnly:!0,value:null},camera:{type:r,aliasOf:"stateManager.camera"},canvas:{readOnly:!0,value:null},center:{type:v,aliasOf:"stateManager.center"},clippingArea:{type:x,dependsOn:["map.clippingArea","map.clippingEnabled","viewingMode"],
get:function(){if("global"===this.viewingMode)return null;if(this._userClippingArea)return this._userClippingArea;var a=this.get("map.clippingEnabled"),b=this.get("map.clippingArea");return a&&b?b instanceof x?t.canProject(b.spatialReference,this.spatialReference)?(b=t.project(b,this.spatialReference),this._clippingArea&&b&&this._clippingArea.equals(b)?this._clippingArea:(this._clippingArea=b,b)):(ra.error("#clippingArea","setting clippingArea with incompatible SpatialReference"),this._clippingArea):
(ra.error("#clippingArea","only clippingArea geometries of type Extent are supported"),this._clippingArea):(this._clippingArea=null,null)},set:function(a){this.ready&&"global"===this.viewingMode&&a?ra.error("#clippingArea\x3d","Clipping area is only supported in local viewingMode"):(this._userClippingArea=a,this.notifyChange("clippingArea"))}},constraints:{type:H,value:null},dataExtent:{dependsOn:["basemapTerrain.extent","clippingArea","map"],readOnly:!0,get:function(){function a(a){a&&(a=t.project(a,
e))&&(d&&(a=a.intersection(d)),a&&b.push(a))}var b=[],e=this.spatialReference||c.WGS84,d=this.clippingArea;d&&(d=t.project(d,e));var f=this._get("basemapTerrain");return(f&&f.spatialReference&&a(new x({xmin:f.extent[0],ymin:f.extent[1],zmin:0,xmax:f.extent[2],ymax:f.extent[3],zmax:0,spatialReference:f.spatialReference})),this.map&&this.map.allLayers.forEach(function(b){a(b.fullExtent)}),0<b.length)?(f=b.reduce(function(a,b){return a.union(b)}),f.hasZ?(f.zmin=Math.min(0,f.zmin),f.zmax=Math.max(0,f.zmax)):
(f.zmin=0,f.zmax=0),f):new x({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0,spatialReference:e})}},environment:{value:null,set:function(a){return a!==this._defaults.environment&&(this._externallySet.environment=!0),a?void(a instanceof O?this._set("environment",a):a instanceof M?this.environment.lighting=a.lighting:a.declaredClass?this._set("environment",a):this._set("environment",new O(a))):void this._set("environment",new O)}},environmentManager:{},extent:{type:x,aliasOf:"stateManager.extent"},frustum:{aliasOf:"stateManager.frustum"},
fullOpacity:1,groundExtent:{dependsOn:["basemapTerrain.extent"],readOnly:!0,get:function(){var a=this._get("basemapTerrain");if(a&&a.spatialReference){var b=a.extent;return new x({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:a.spatialReference})}return new x({spatialReference:this.spatialReference||c.WGS84})}},initialExtentRequired:{dependsOn:["stateManager.hasInitialView"],get:function(){return!this.stateManager.hasInitialView}},interacting:{dependsOn:["state.interacting"],readOnly:!0,
get:function(){return!!this.state&&this.state.interacting}},map:{value:null},mapCoordsHelper:{},padding:{aliasOf:"stateManager.padding"},pointsOfInterest:ea,screenSizePerspectiveEnabled:!0,state:{readOnly:!0,value:null},stateManager:{readOnly:!0},inputManager:{},qualityProfile:{set:function(a){fa.isValidProfile(a)&&(fa.apply(a,this),this._set("qualityProfile",a))}},qualitySettings:{type:ha},ready:{dependsOn:["viewingMode"]},renderCoordsHelper:{},resolution:{dependsOn:["scale","spatialReference"],
readOnly:!0,get:function(){return null!=this.spatialReference?q.getResolutionForScale(this.scale,this.spatialReference):0}},scale:{aliasOf:"stateManager.scale"},spatialReference:{dependsOn:["map.initialViewProperties.spatialReference","defaultsFromMap.isSpatialReferenceDone"]},spatialReferenceWarningDelay:1E3,isHeightModelInfoRequired:!0,type:"3d",ui:{type:da},updating:{},updatingPercentage:0,viewingMode:{dependsOn:["map.initialViewProperties.viewingMode","spatialReference"],get:function(){var a=
this.get("map.initialViewProperties.viewingMode"),b=this.spatialReference;return a||(a=!b||b.isWebMercator||b.isWGS84?"global":"local"),a},set:function(a){this._internallyReady?ra.error("#viewingMode","viewingMode cannot be set once view is ready"):0<=["local","global"].indexOf(a)?this._override("viewingMode",a):void 0===a&&this._clearOverride("viewingMode")}},viewpoint:{type:n,aliasOf:"stateManager.viewpoint"},zoom:{aliasOf:"stateManager.zoom"},highlightOptions:{type:U}},getDefaults:function(a){var b=
this.inherited(arguments);return b.constraints||a.constraints||(b.constraints=new H),b.environment||a.environment||(this._defaults.environment=new O,b.environment=this._defaults.environment),b.qualitySettings=new ha,b.qualityProfile=fa.getDefaultProfile(),b.highlightOptions=new U,b},constructor:function(){C.when(this,"ready",this._viewReadyHandler.bind(this));this._internallyReady=!1;this._initialProps={};this._initialDefaultSpatialReference=this._gotoTask=this._userClippingArea=null;this.inputManager=
new Y({view:this});this.stateManager=new T({view:this});this._clippingArea=this._constraints=null;this._defaults={};this._externallySet={};this.resourceController=new ba(this);this.deconflictor=new ua(this);this._evaluateUpdating=this._evaluateUpdating.bind(this);this._layerViewsUpdatingHandles={};this._stageHandles=new N;this.watch("map",function(a){a&&a.load&&a.load()})},initialize:function(){this.environmentManager=new S({view:this});this._updateUpdatingMonitorsHandle=this.allLayerViews.on("change",
this._updateUpdatingMonitors.bind(this));this._updateUpdatingMonitors({added:this.allLayerViews.toArray(),removed:[],moved:[]});C.whenNot(this,"ready",this._viewUnreadyHandler.bind(this));var a;C.init(this.defaultsFromMap,"isSpatialReferenceDone",function(b){var c=!!(this.map&&0<this.map.allLayers.length);b&&!this.spatialReference&&c||!a?b&&!this.spatialReference&&c&&!a&&(a=B.after(this.spatialReferenceWarningDelay),a.then(function(){ra.warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})):
(a.cancel(),a=null)}.bind(this));C.init(this.qualitySettings,"gpuMemoryLimit",function(a){this.resourceController&&this.resourceController.setMaxGpuMemory(a)}.bind(this))},destroy:function(){this.activeTool=null;m.dispatchTarget(this);this.environmentManager.destroy();this._disposeGraphicsView();this._updateUpdatingMonitorsHandle.remove();this._updateUpdatingMonitorsHandle=null;this._stageHandles.remove();this.inputManager&&(this.inputManager.destroy(),this.inputManager=null)},destroyLayerViews:function(){for(var a in this._layerViewsUpdatingHandles)this._layerViewsUpdatingHandles[a].remove();
this._layerViewsUpdatingHandles={};this.stateManager.deinit();this._disposeSurface();this.inherited(arguments);this._stage&&(this._stage.dispose(),this._stage=null,this._stageHandles.remove());this._setCanvas(null);this.deconflictor.destroy();this.deconflictor=null;this.resourceController.destroy();this.resourceController=null},on:function(a,b,c){var e=this.inputManager.viewEvents.register(a,b,c);return e?e:this.inherited(arguments)},toMap:function(a,b,c){if(!this.ready)return ra.error("#toMap()",
"Scene view cannot be used before it is ready"),null;a=this._normalizePointArgs(a,b,void 0,c);b=this._stage.pick([a.point.x,this.height-a.point.y]).getMinResult();return this._computeMapPointFromIntersectionResult(b,a.retval)},toScreen:function(a,b,c,e){if(!this.ready)return ra.error("#toScreen()","Scene view cannot be used before it is ready"),null;a=this._normalizePointArgs(a,b,c,e);return E.pointToVector(a.point,pa,this.renderSpatialReference),this.engineToScreen(pa,a.retval)},pixelSizeAt:function(a,
b,c){if(!this.ready)return ra.error("#pixelSizeAt()","Scene view cannot be used before it is ready"),null;if("esri.geometry.ScreenPoint"===a.declaredClass){if(!this._stage.pick([a.x,this.height-a.y]).getMinResult().getIntersectionPoint(pa))return 0}else a=this._normalizePointArgs(a,b,c,void 0),E.pointToVector(a.point,pa,this.renderSpatialReference);return this.state.camera.computePixelSizeAt(pa)},hitTest:function(a,c){if(!this.ready)return ra.error("#hitTest()","Scene view cannot be used before it is ready"),
null;var e;a=this._normalizePointArgs(a,c,void 0,void 0);var d=[a.point.x,this.height-a.point.y],f=this._stage.pick(d,null,!0);a=f.getMinResult();var g=this._computeMapPointFromIntersectionResult(a);switch(a.targetType){case "None":e=null;break;case "StageObject":e=this._getGraphicFromStageObject(a.target,a.triangleNr);break;case "StagePoint":e=this._getGraphicFromStagePoint(a.target)}return b(e).otherwise(function(){return null}).then(function(a){var b=[];(a||g)&&b.push({mapPoint:g,graphic:a});a=
{screenPoint:d,results:b};return ja.SCENEVIEW_HITTEST_RETURN_SELECTOR&&(a.selector=f),a})},goTo:function(a,b){return this.stateManager.goTo(a,b)},animateTo:function(a,b){return l.deprecated(this.declaredClass+".animateTo is deprecated. Use .goTo instead.","","4.0"),this.goTo(a,b)},takeScreenshot:function(a){if(!this.ready)return void ra.error("#takeScreenshot()","Scene view cannot be used before it is ready");a=R.adjustScreenshotSettings(a,this);var b=new d;return this._stage.requestScreenCapture(a,
function(a){w.schedule(function(){b.resolve(a)})}),b.promise},engineToScreen:function(a,b){var c=ga.create();this.state.camera.projectPoint(a,c);a=c[0];var e=this.height-c[1],c=c[2];return b?(b.x=a,b.y=e,b.z=c,b):new y({x:a,y:e,z:c})},getDefaultSpatialReference:function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||this.get("defaultsFromMap.isSpatialReferenceDone")&&this._initialDefaultSpatialReference||null},validate:function(){var a=
P.check();return z("safari")&&9>z("safari")&&(a=new F("sceneview:browser-not-supported","This browser is not supported by SceneView (Safari \x3c 9)",{type:"safari",requiredVersion:9,detectedVersion:z("safari")})),a?(ra.warn("#validate()",a.message),B.reject(a)):B.resolve()},isSpatialReferenceSupported:function(a,b){var c=a.isGeographic,e=a.isWebMercator,d=a.isWGS84,f="local"===this.viewingMode,g=!(!this._isOverridden("viewingMode")&&!this.get("map.initialViewProperties.viewingMode"));if(g){if(f&&
c||!f&&!e&&!d)return!1}else if(c&&!d)return!1;if(b)if(za.isTiledLayer(b)){if(g?c=za.getTiledLayerInfo(b,a,this.viewingMode):(c=za.getTiledLayerInfo(b,a,"global"),null==c.tileInfo&&(c=za.getTiledLayerInfo(b,a,"local"))),null==c.tileInfo)return!1}else if((d||e)&&!f)return null==this._initialDefaultSpatialReference&&(this._initialDefaultSpatialReference=a),g||this._internallyReady||(this.viewingMode="global"),!1;return!0},has:function(a){return this._stage.has(a)},flushDisplayModifications:function(){this._stage.processDirty()},
getDrawingOrder:function(a){return this.allLayerViews.findIndex(function(b){return b.layer&&b.layer.uid===a})},getViewForGraphic:function(a){return a.layer?this.allLayerViews.find(function(b){return b.layer===a.layer}):this._graphicsView},whenViewForGraphic:function(a){return a.layer?this.whenLayerView(a.layer):B.resolve(this._graphicsView)},renderSpatialReference:null,_graphicsView:null,_surfaceReadyWatchHandle:null,_stageHandles:null,_computeMapPointFromIntersectionResult:function(a,b){if(a.getIntersectionPoint(pa)){b=
this._computeMapPointFromVec3d(pa,b);var c=this._get("basemapTerrain");"terrain"===a.intersector&&c&&(a=c.getElevation(b),null!==a&&(b.z=a));return b}return null},_computeMapPointFromVec3d:function(a,b){var e=this.spatialReference||c.WGS84;return E.vectorToVector(a,this.renderSpatialReference,a,e)||(e=c.WGS84,E.vectorToVector(a,this.renderSpatialReference,a,e)),b?(b.x=a[0],b.y=a[1],b.z=a[2],b.spatialReference=e):b=new v(a,e),b},_getGraphicFromStageObject:function(a,b){var c=a.getMetadata();if(null!=
c&&null!=c.layerUid){if(c.layerUid===this._graphicsView.mockLayerId)return this._graphicsView.getGraphicsFromStageObject(a,b);if(c=this.map.findLayerByUid(c.layerUid))return this.whenLayerView(c).then(function(c){return c&&null!=c.getGraphicsFromStageObject&&!c.suspended?c.getGraphicsFromStageObject(a,b):void 0})}return null},_getGraphicFromStagePoint:function(a){var b=this._computeMapPointFromVec3d(a.point),b=new u(b);a=a.metadata.layerUid;return null!=a&&(b.layer=this.map.findLayerByUid(a)),b},
_viewingModeToManifold:function(a){return{local:"planar",global:"spherical"}[a]},_initBasemapTerrain:function(a){this._disposeBasemapTerrain();this._set("basemapTerrain",new na(this,this._viewingModeToManifold(a)));this._set("elevationProvider",new K({view:this}));this.elevationProvider.register("ground",this.basemapTerrain)},_initGlobe:function(a){this._initCoordinateSystem();this._initState();this._stage.setViewParams({backgroundColor:[0,0,0,0],maxFarNearRatio:0,frustumCullingEnabled:!1});this._initBasemapTerrain(a);
this.pointsOfInterest=new ea({view:this});this._initStateManager()},_initCoordinateSystem:function(){if(this.spatialReference){var a=this.spatialReference;this.mapCoordsHelper&&this.mapCoordsHelper.spatialReference.equals(a)||(this.mapCoordsHelper=new X(this.map,a));var b=this.renderCoordsHelper?this.renderCoordsHelper.unitInMeters:1,c="global"===this.viewingMode,a=c?E.SphericalECEFSpatialReference:a;a!==this.renderSpatialReference&&(this.renderSpatialReference=a,this.renderCoordsHelper=V.createRenderCoordsHelper(c?
"global":"local",a),this._stage&&this._stage.setIntersectTolerance(A.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters),this._constraints)&&this._constraints.scale(b/this.renderCoordsHelper.unitInMeters)}else this.renderSpatialReference=this.renderCoordsHelper=this.mapCoordsHelper=null},_cameraAlmostEquals:function(a,b){return 1E-5>Math.abs(a.tilt-b.tilt)&&1E-5>Math.abs(a.heading-b.heading)&&1E-5>Math.abs(a.fov-b.fov)&&a.position.equals(b.position)},_evaluateUpdating:function(){var a=0,b=0,c=
!1;this.allLayerViews.forEach(function(e){e.updating&&(c=!0,e=e.updatingPercentage,null!=e&&(++b,a+=e))});this._graphicsView&&this._graphicsView.updating&&(c=!0);c!==this.updating&&(this.updating=c);0!==b?a/=b:a=c?100:0;this.updatingPercentage!==a&&(this.updatingPercentage=a)},_updateUpdatingMonitors:function(a){for(var b=0;b<a.removed.length;b++){var c=a.removed[b],e=this._layerViewsUpdatingHandles[c.uid];e&&(delete this._layerViewsUpdatingHandles[c.uid],c.destroyed||e.remove())}for(b=0;b<a.added.length;b++)c=
a.added[b],c.destroyed||(e=c.watch(["updating","updatingPercentage"],this._evaluateUpdating),this._layerViewsUpdatingHandles[c.uid]=e);this._evaluateUpdating()},_pickRay:function(a,b,c,e,d,f,g){return this._stage?this._stage.pickRay(a,b,c,e,d,f,g):null},_pickRayWithBeginPoint:function(a,b,c,e,d){return this._stage?this._stage.pickRayWithBeginPoint(a,b,c,e,d):null},_removeHandles:function(a){for(var b=0;b<a.length;b++){var c=a[b];this[c]&&(this[c].remove(),this[c]=null)}},_setCanvas:function(a){a!==
this._get("canvas")&&this._set("canvas",a)},_disposeSurface:function(){this._removeHandles(["_stageFrameTask","_updateDrawingOrderHandle","onViewExtentUpdateHandle","_mapLayersChangeHandle"]);this.pointsOfInterest&&(this.pointsOfInterest.destroy(),this.pointsOfInterest=null);this._disposeBasemapTerrain();this._setNavigation(null);this.environmentManager&&this.environmentManager.disposeRendering()},_disposeBasemapTerrain:function(){var a=this._get("basemapTerrain");a&&(a.destroy(),this._set("basemapTerrain",
null))},_disposeNavigation:function(){var a=this._get("navigation");a&&(a.destroy(),this._set("navigation",null))},_setNavigation:function(a){this._get("navigation")!==a&&(this._disposeNavigation(),this._set("navigation",a))},_initStage:function(){var a={};a.deactivatedWebGLExtensions=this.deactivatedWebGLExtensions;a.viewingMode=this.viewingMode;this.renderCanvas&&(a.canvas=this.renderCanvas);this._stage=new p(this.viewingMode,h.byId(this.surface),a);this._stage.selectionState=!1;this._stageHandles.add(C.init(this.qualitySettings,
"antialiasingEnabled",function(){this._stage.setRenderParams({antialiasingEnabled:this.qualitySettings.antialiasingEnabled})}.bind(this)));this._stageHandles.add(C.watch(this,this.highlightOptions.keys().map(function(a){return"highlightOptions."+a}),function(){this._stage.setRenderParams({defaultHighlightOptions:U.toEngineOptions(this.highlightOptions)})}.bind(this)));this._stageHandles.add(C.init(this,"highlightOptions",function(){this._stage.setRenderParams({defaultHighlightOptions:U.toEngineOptions(this.highlightOptions)})}.bind(this)));
this.renderCoordsHelper&&this._stage.setIntersectTolerance(A.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters);this._setCanvas(this._stage.getCanvas());this._stageFrameTask=w.addFrameTask(this._stage.getFrameTask())},_initSurface:function(){this._initStage();this._initGlobe(this.viewingMode);this.sharedSymbolResources=new ca({stage:this._stage,viewingMode:this.viewingMode,resourceController:this.resourceController,pointsOfInterest:this.pointsOfInterest,viewState:this.state})},_initGraphicsView:function(){this._surfaceReadyWatchHandle=
C.whenTrueOnce(this,"basemapTerrain.ready",function(){this._graphicsView=new wa({view:this,graphics:this.graphics});this._surfaceReadyWatchHandle=null;this._layerViewsUpdatingHandles[this._graphicsView.mockLayerId]=C.init(this._graphicsView,"updating",this._evaluateUpdating)}.bind(this))},_disposeGraphicsView:function(){if(this._surfaceReadyWatchHandle&&(this._surfaceReadyWatchHandle.remove(),this._surfaceReadyWatchHandle=null),this._graphicsView){var a=this._graphicsView.mockLayerId;this._layerViewsUpdatingHandles[a].remove();
delete this._layerViewsUpdatingHandles[a];this._graphicsView.destroy();this._graphicsView=null}},_normalizePointArgs:function(a,b,e,d,f){f=f||J;var g=f.point;return g.spatialReference=void 0,"object"==typeof a?(g.x=a.x,g.y=a.y,g.z=a.z,a.spatialReference&&(g.spatialReference=a.spatialReference),f.retval=b):(g.x=a,g.y=b,"number"!=typeof e&&void 0!==e?(g.z=void 0,f.retval=e):(g.z=e,f.retval=d)),g.spatialReference||(g.spatialReference=this.spatialReference||c.WGS84),f},_initState:function(){this._set("state",
new Q({viewingMode:this.viewingMode,spatialReference:this.spatialReference}))},_initStateManager:function(){this.stateManager.init()},_viewReadyHandler:function(a,b){b||(("global"===this.viewingMode&&(this._clippingArea=null),this._internallyReady=!0,this._initSurface(),this._initGraphicsView(),this._externallySet.environment)||(a=this.get("map.initialViewProperties.environment"))&&(this.environment=a),this._updateDrawingOrderHandle=this.allLayerViews.on("change",this._updateDrawingOrder.bind(this)),
this._updateDrawingOrder({added:this.allLayerViews.toArray(),removed:[],moved:[]}),this.environmentManager.updateReadyChange(!0))},_viewUnreadyHandler:function(a,b){b&&(this.activeTool&&(this.activeTool.deactivate(this.inputManager._inputManager),this._set("activeTool",null)),this._initialDefaultSpatialReference=null,this.environmentManager.updateReadyChange(!1),this._disposeGraphicsView(),this._internallyReady=!1,this.stateManager.deinit(),this._disposeSurface(),this.state.destroy(),this._set("state",
null),this.sharedSymbolResources&&(this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null),this._stage&&(this._stage.dispose(),this._stage=null,this._stageHandles.remove()),this._setCanvas(null))},_heightModelInfoGetter:function(){var a=this.getDefaultHeightModelInfo();return null!=a?e.deriveUnitFromSR(a,this.spatialReference):null},_isIncompatibleSpatialReference:function(a){return a&&!a.equals(this.spatialReference)&&!t.canProject(a,this.spatialReference)},_updateDrawingOrder:function(){var a=
this.allLayerViews.length-1;this.allLayerViews.forEach(function(b,c){null!=b.drawingOrder&&(b.drawingOrder=a-c)},this)},_mapSetter:function(a){a!==this._get("map")&&(this._mapLayersChangeHandle&&(this._mapLayersChangeHandle.remove(),this._mapLayersChangeHandle=null),a&&(this._mapLayersChangeHandle=a.allLayers.on("change",this.notifyChange.bind(this,"dataExtent"))),this.inherited(arguments))}})})},"esri/webscene/Environment":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators ./Lighting".split(" "),
function(m,l,h,d,b,g,k){return function(b){function a(a){a=b.call(this,a)||this;return a.lighting=new k,a}return h(a,b),e=a,a.prototype.clone=function(){return new e({lighting:k.prototype.clone.call(this.lighting)})},a.sanitizeJSON=function(a){return{lighting:a.lighting?k.sanitizeJSON(a.lighting):(new k).toJSON()}},d([g.property({type:k,json:{write:!0}})],a.prototype,"lighting",void 0),a=e=d([g.subclass("esri.webscene.Environment")],a);var e}(g.declared(b))})},"esri/webscene/Lighting":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g){return function(b){function f(a){a=b.call(this,a)||this;return a.date=null,a.directShadowsEnabled=!1,a.displayUTCOffset=null,a}return h(f,b),a=f,f.prototype.readDate=function(a,b){return null!=b.datetime&&new Date(b.datetime)||null},f.prototype.writeDate=function(a,b,d){b[d]=a.getTime()},f.prototype.readDirectShadowsEnabled=function(a,b){return!!b.directShadows},f.prototype.writedirectShadowsEnabled=function(a,b,d){a&&(b[d]=a)},f.prototype.writeDisplayUTCOffset=function(a,b){null!=
a&&(b.displayUTCOffset=a)},f.prototype.clone=function(){return new a({date:null!=this.date?new Date(this.date.getTime()):null,directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null})},f.sanitizeJSON=function(a){var b={datetime:a.datetime};return void 0!==a.directShadows&&(b.directShadows=!!a.directShadows),void 0!==a.displayUTCOffset&&(b.displayUTCOffset=a.displayUTCOffset),b},d([g.property({type:Date,json:{type:Number,write:{target:"datetime"}}})],
f.prototype,"date",void 0),d([g.reader("date",["datetime"])],f.prototype,"readDate",null),d([g.writer("date")],f.prototype,"writeDate",null),d([g.property({type:Boolean,json:{write:{target:"directShadows"}}})],f.prototype,"directShadowsEnabled",void 0),d([g.reader("directShadowsEnabled",["directShadows"])],f.prototype,"readDirectShadowsEnabled",null),d([g.writer("directShadowsEnabled")],f.prototype,"writedirectShadowsEnabled",null),d([g.property({type:Number,json:{write:!0}})],f.prototype,"displayUTCOffset",
void 0),d([g.writer("displayUTCOffset")],f.prototype,"writeDisplayUTCOffset",null),f=a=d([g.subclass("esri.webscene.Lighting")],f);var a}(g.declared(b))})},"esri/views/support/WebGLRequirements":function(){define(["require","exports","../../core/Error","../../core/sniff"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.check=function(){var b=null;return d("esri-webgl")?d("esri-webgl-major-performance-caveat")?b=new h("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check if your GPU is blacklisted."):
d("esri-webgl-high-precision-fragment")?d("esri-webgl-vertex-shader-samplers")?d("esri-webgl-element-index-uint")||(b=new h("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.")):b=new h("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):b=new h("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):b=new h("webgl:required",
"WebGL is required but not supported."),b}})},"esri/views/3d/state/ViewState":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../views/ViewAnimation ../support/PropertiesPool ../support/Evented ../support/earthUtils ./Constraints ../webgl-engine/lib/Camera ../lib/glMatrix ./controllers/CameraController ./controllers/AnimationController".split(" "),function(m,
l,h,d,b,g,k,f,a,e,c,q,t,r,u){Object.defineProperty(l,"__esModule",{value:!0});m=function(g){function n(b){b=g.call(this,b)||this;return b.propertiesPool=new f["default"]({camera:q},b),b.events=new a.Evented,b.updateQueue=new y,b.processingUpdates=!1,b}return h(n,g),n.prototype.destroy=function(){this.propertiesPool&&(this.propertiesPool.destroy(),this.propertiesPool=null)},n.prototype.normalizeCtorArgs=function(a){return{camera:this.createInitialCamera(a.viewingMode),mode:a.viewingMode,spatialReference:a.spatialReference,
constraints:new c["default"]({mode:a.viewingMode})}},Object.defineProperty(n.prototype,"animation",{get:function(){return this.cameraController instanceof u.AnimationController?this.cameraController.viewAnimation:null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"camera",{get:function(){return this._get("camera")},set:function(a){a!==v&&v.copyFrom(a);v.markViewDirty();v.computeUp(this.mode);x.camera=v;this.events.emit("before-camera-change",x);(a=this._get("camera"))&&a.equivalent(v)||
this._set("camera",this.propertiesPool.get("camera").copyFrom(v))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isGlobal",{get:function(){return!this.isLocal},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLocal",{get:function(){return"local"===this.mode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"interacting",{get:function(){return!!this.cameraController&&this.cameraController.isInteractive},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,
"cameraController",{get:function(){return this._get("cameraController")},set:function(a){var b=this;return this.stopActiveCameraController()?(a&&(a.watch("state",function(c){c!==r.State.Finished&&c!==r.State.Stopped||(b.updateCamera(function(b){a.onControllerEnd(b)}),b._set("cameraController",null))},!0),a.onControllerStart(this.camera)),void this._set("cameraController",a)):void(a&&(a.state=r.State.Rejected))},enumerable:!0,configurable:!0}),n.prototype.switchCameraController=function(a){return this.cameraController=
a,a.state!==r.State.Rejected},n.prototype.stopActiveCameraController=function(){return this.cameraController&&!this.cameraController.stopController()?!1:!0},n.prototype.cameraChanged=function(){this.updateCamera(function(){})},n.prototype.updateCamera=function(a){this.updateQueue.enqueue(a);this.processingUpdates||this.processUpdateQueue()},n.prototype.processUpdateQueue=function(){if(0!==this.updateQueue.length&&!this.processingUpdates){this.processingUpdates=!0;var a=this.updateQueue.dequeue();
v.copyFrom(this._get("camera"));a(v);this.camera=v;this.processingUpdates=!1;this.processUpdateQueue()}},n.prototype.createInitialCamera=function(a){return"global"===a?new q(t.vec3d.createFrom(4*e.earthRadius,0,0),t.vec3d.createFrom(e.earthRadius,0,0),t.vec3d.createFrom(0,0,1)):new q(t.vec3d.createFrom(0,0,100),t.vec3d.createFrom(0,0,0),t.vec3d.createFrom(0,1,0))},d([b.property({readOnly:!0,type:k,dependsOn:["cameraController"]})],n.prototype,"animation",null),d([b.property({type:q})],n.prototype,
"camera",null),d([b.property({constructOnly:!0})],n.prototype,"constraints",void 0),d([b.property({readOnly:!0})],n.prototype,"events",void 0),d([b.property({readOnly:!0,dependsOn:["isLocal"]})],n.prototype,"isGlobal",null),d([b.property({readOnly:!0,dependsOn:["mode"]})],n.prototype,"isLocal",null),d([b.property({constructOnly:!0})],n.prototype,"mode",void 0),d([b.property({constructOnly:!0})],n.prototype,"spatialReference",void 0),d([b.property({readOnly:!0,dependsOn:["cameraController"]})],n.prototype,
"interacting",null),d([b.property()],n.prototype,"cameraController",null),n=d([b.subclass()],n)}(b.declared(g));l.ViewState=m;var v=new q,x={camera:null},y=function(){function a(){this.data=[];this.length=this.ptr=0}return a.prototype.enqueue=function(a){this.data.push(a);this.length++},a.prototype.dequeue=function(){if(0===this.length)return null;var a=this.data[this.ptr++];return this.length--,0===this.length&&(this.data.length=0,this.ptr=0),a},a}();l["default"]=m})},"esri/views/3d/support/PropertiesPool":function(){define(["require",
"exports","../../../core/ObjectPool","../../../core/accessorSupport/watch"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function b(b,k){var f=this;this.owner=k;this.properties={};this.afterDispatchHandle=null;for(var a in b)k=new h(b[a],null,null,2,2),this.properties[a]={pool:k,acquired:[]};this.afterDispatchHandle=d.afterDispatch(function(){return f.release()})}return b.prototype.destroy=function(){this.afterDispatchHandle&&(this.afterDispatchHandle.remove(),this.afterDispatchHandle=
null);this.owner=null},b.prototype.get=function(b){var d=this.owner._get(b);b=this.properties[b];var f=b.pool.acquire();for(b.acquired.push(f);f===d;)b.acquired.push(f),f=b.pool.acquire();return f},b.prototype.release=function(){for(var b in this.properties){for(var k=this.properties[b],f=0,a=0,e=k.acquired;a<e.length;a++){var c=e[a];d.isValueInUse(c)?k.acquired[f++]=c:k.pool.release(c)}k.acquired.length=f}},b}();l.PropertiesPool=m;l["default"]=m})},"esri/views/3d/support/Evented":function(){define(["require",
"exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function h(){this._listeners={}}return h.prototype.hasEventListener=function(d){return null!=this._listeners[d]&&0<this._listeners[d].size},h.prototype.on=function(d,b){var g=this;null==this._listeners[d]&&(this._listeners[d]=new Map);var k={};return this._listeners[d].set(k,b),{remove:function(){return g._listeners[d]["delete"](k)}}},h.prototype.emit=function(d,b){null!=this._listeners[d]&&this._listeners[d].forEach(function(d){return d(b)})},
h}();l.Evented=m})},"esri/views/3d/state/Constraints":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/Logger ../support/earthUtils ../support/mathUtils".split(" "),function(m,l,h,d,b,g,k,f,a){Object.defineProperty(l,"__esModule",{value:!0});var e=k.getLogger("esri.views.3d.state.Constraints");m=function(f){function g(a){a=f.call(this)||this;return a.collision=
new q,a.distance=1/0,a.minimumPoiDistance=4,a}return h(g,f),Object.defineProperty(g.prototype,"altitude",{get:function(){return"local"===this.mode?null:this._get("altitude")||null},set:function(a){return"local"===this.mode?void e.warn("Altitude constraint is ignored in local scenes"):void this._set("altitude",a)},enumerable:!0,configurable:!0}),g.prototype.clampAltitude=function(b){return this.altitude?a.clamp(b,this.altitude.min,this.altitude.max):b},g.prototype.clampTilt=function(b,c){if(!this.tilt)return c;
b=this.tilt(b);return a.clamp(c,b.min,b.max)},g.prototype.clampDistance=function(a){return Math.min(a,this.distance)},g.prototype.createDefaultTilt=function(){return"local"===this.mode?this.createDefaultTiltLocal():this.createDefaultTiltGlobal()},g.prototype.createConstantMaxTilt=function(a){return function(b,e){return void 0===e&&(e=c),e.min=l.TiltDefault.min,e.max=a,e}},g.prototype.createDefaultTiltLocal=function(){var b=a.makePiecewiseLinearFunction([[4E3,l.TiltDefault.max],[1E4,a.deg2rad(88)],
[6E6,a.deg2rad(88)]]);return function(a,e){return void 0===e&&(e=c),e.min=l.TiltDefault.min,e.max=b(a),e}},g.prototype.createDefaultTiltGlobal=function(){var b=a.makePiecewiseLinearFunction([[4E3,l.TiltDefault.max],[5E4,a.deg2rad(88)],[6E6,a.deg2rad(88)],[2E7,l.TiltDefault.min]]);return function(a,e){return void 0===e&&(e=c),e.min=l.TiltDefault.min,e.max=b(a),e}},d([b.property()],g.prototype,"altitude",null),d([b.property({readOnly:!0})],g.prototype,"collision",void 0),d([b.property()],g.prototype,
"distance",void 0),d([b.property({readOnly:!0})],g.prototype,"minimumPoiDistance",void 0),d([b.property()],g.prototype,"tilt",void 0),d([b.property({constructOnly:!0})],g.prototype,"mode",void 0),g=d([b.subclass("esri.views.3d.state.Constraints")],g)}(b.declared(g));l.Constraints=m;l.AltitudeDefault={min:-f.earthRadius,max:4*f.earthRadius};l.TiltDefault={min:a.deg2rad(.5),max:a.deg2rad(179.5)};var c={min:0,max:0},q=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;return b.enabled=
!0,b.elevationMargin=5,b}return h(c,a),d([b.property({type:Boolean})],c.prototype,"enabled",void 0),d([b.property({type:Number})],c.prototype,"elevationMargin",void 0),c=d([b.subclass("esri.views.3d.state.Constraints.CollisionConstraint")],c)}(b.declared(g));l["default"]=m})},"esri/views/3d/webgl-engine/lib/Camera":function(){define(["require","exports","./Util","./gl-matrix"],function(m,l,h,d){function b(a,b){var c=b[0]-a[0],e=b[1]-a[1],d=b[2]-a[2];a=b[3]-a[3];return c*c+e*e+d*d+a*a}function g(a,
b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}function k(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]}var f=d.vec3d,a=d.vec4d,e=d.mat4d;m=function(){function d(b,c,d){this._viewUp=f.create();this._viewForward=f.create();this._viewRight=f.create();this._viewport=a.create();this._padding=a.create();this._fov=55/180*Math.PI;this._near=0;this._far=1E3;this._viewDirty=!0;this._viewMatrix=e.create();this._projectionDirty=!0;this._projectionMatrix=e.create();this._viewInverseTransposeMatrixDirty=
!0;this._viewInverseTransposeMatrix=e.create();this._frustumPlanesDirty=!0;this._frustumPlanes=[a.create(),a.create(),a.create(),a.create(),a.create(),a.create()];this._fullViewport=null;this.aboveGround=!0;this._eye=f.create(b);this._center=f.create(c);void 0!==d?this._up=f.create(d):this._up=f.create([0,0,1]);this._padding=a.create()}return Object.defineProperty(d.prototype,"eye",{get:function(){return this._eye},set:function(a){this._compareAndSetView(a,this._eye)},enumerable:!0,configurable:!0}),
Object.defineProperty(d.prototype,"center",{get:function(){return this._center},set:function(a){this._compareAndSetView(a,this._center)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"up",{get:function(){return this._up},set:function(a){this._compareAndSetView(a,this._up)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"viewMatrix",{get:function(){return this._ensureViewClean(),this._viewMatrix},set:function(a){e.set(a,this._viewMatrix);this._viewDirty=!1;this._frustumPlanesDirty=
this._viewInverseTransposeMatrixDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"viewForward",{get:function(){return this._ensureViewClean(),this._viewForward},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"viewUp",{get:function(){return this._ensureViewClean(),this._viewUp},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"viewRight",{get:function(){return this._ensureViewClean(),this._viewRight},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,
"near",{get:function(){return this._near},set:function(a){this._near!==a&&(this._near=a,this._projectionDirty=!0,this._frustumPlanesDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"far",{get:function(){return this._far},set:function(a){this._far!==a&&(this._far=a,this._projectionDirty=!0,this._frustumPlanesDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"viewport",{get:function(){return this._viewport},set:function(a){this.x=a[0];this.y=a[1];
this.width=a[2];this.height=a[3]},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"x",{get:function(){return this._viewport[0]},set:function(a){a+=this._padding[3];this._viewport[0]!==a&&(this._viewport[0]=a,this._projectionDirty=!0,this._frustumPlanesDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"y",{get:function(){return this._viewport[1]},set:function(a){a+=this._padding[2];this._viewport[1]!==a&&(this._viewport[1]=a,this._projectionDirty=!0,this._frustumPlanesDirty=
!0)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"width",{get:function(){return this._viewport[2]},set:function(a){this._viewport[2]!==a&&(this._viewport[2]=a,this._projectionDirty=!0,this._frustumPlanesDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this._viewport[3]},set:function(a){this._viewport[3]!==a&&(this._viewport[3]=a,this._projectionDirty=!0,this._frustumPlanesDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,
"fullWidth",{get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},set:function(a){this.width=a-(this._padding[1]+this._padding[3])},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"fullHeight",{get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},set:function(a){this.height=a-(this._padding[0]+this._padding[2])},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"fullViewport",{get:function(){return this._fullViewport||(this._fullViewport=
a.create()),this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"aspect",{get:function(){return this.width/this.height},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"padding",{get:function(){return this._padding},set:function(b){(this._padding[0]!==b[0]||this._padding[1]!==
b[1]||this._padding[2]!==b[2]||this._padding[3]!==b[3])&&(this._viewport[0]+=b[3]-this._padding[3],this._viewport[1]+=b[2]-this._padding[2],this._viewport[2]-=b[1]+b[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=b[0]+b[2]-(this._padding[0]+this._padding[2]),a.set(b,this._padding),this._projectionDirty=!0,this._frustumPlanesDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"projectionMatrix",{get:function(){if(this._projectionDirty){var a=this.width,b=this.height,
c=this.near*Math.tan(this.fovY/2),d=c*this.aspect;e.frustum(-d*(1+2*this._padding[3]/a),d*(1+2*this._padding[1]/a),-c*(1+2*this._padding[2]/b),c*(1+2*this._padding[0]/b),this.near,this.far,this._projectionMatrix);this._projectionDirty=!1}return this._projectionMatrix},set:function(a){e.set(a,this._projectionMatrix);this._projectionDirty=!1;this._frustumPlanesDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"fov",{get:function(){return this._fov},set:function(a){this._fov=
a;this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"fovX",{get:function(){return h.fovd2fovx(this._fov,this.width,this.height)},set:function(a){this._fov=h.fovx2fovd(a,this.width,this.height);this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"fovY",{get:function(){return h.fovd2fovy(this._fov,this.width,this.height)},set:function(a){this._fov=h.fovy2fovd(a,this.width,
this.height);this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"distance",{get:function(){return f.dist(this._center,this._eye)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"frustumPoints",{get:function(){return this.computeFrustumPoints()},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"frustumPlanes",{get:function(){return this._frustumPlanesDirty&&(this._frustumPlanes=this._computeFrustumPlanes(this._frustumPlanes),
this._frustumPlanesDirty=!1),this._frustumPlanes},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"viewInverseTransposeMatrix",{get:function(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(this._viewInverseTransposeMatrix||(this._viewInverseTransposeMatrix=e.create()),e.inverse(this.viewMatrix,this._viewInverseTransposeMatrix),e.transpose(this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix},enumerable:!0,
configurable:!0}),Object.defineProperty(d.prototype,"perPixelRatio",{get:function(){return Math.tan(this.fovX/2)/this.width},enumerable:!0,configurable:!0}),d.prototype.copyFrom=function(b){return f.set(b._eye,this._eye),f.set(b._center,this._center),f.set(b._up,this._up),a.set(b._viewport,this._viewport),a.set(b._padding,this._padding),this._near=b._near,this._far=b._far,this._fov=b._fov,this.aboveGround=b.aboveGround,b._viewDirty?this._viewDirty=!0:(e.set(b._viewMatrix,this._viewMatrix),f.set(b._viewRight,
this._viewRight),f.set(b._viewUp,this._viewUp),f.set(b._viewForward,this._viewForward),this._viewDirty=!1),b._projectionDirty?this._projectionDirty=!0:(e.set(b._projectionMatrix,this._projectionMatrix),this._projectionDirty=!1),b._frustumPlanesDirty?this._frustumPlanesDirty=!0:(b.copyFrustumPlanes(this._frustumPlanes),this._frustumPlanesDirty=!1),b._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(this._viewInverseTransposeMatrix?e.set(b._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix):
this._viewInverseTransposeMatrix=e.create(b._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),b._fullViewport?this._fullViewport?a.set(b._fullViewport,this._fullViewport):this._fullViewport=a.create(b._fullViewport):this._fullViewport=null,this},d.prototype.copyViewFrom=function(a){this.eye=a.eye;this.center=a.center;this.up=a.up},d.prototype.copy=function(){var a=new d;return a.copyFrom(this),a},d.prototype.equivalent=function(a){return g(this._eye,a._eye)&&g(this._center,a._center)&&
g(this._up,a._up)&&k(this._viewport,a._viewport)&&k(this._padding,a._padding)&&this._near===a._near&&this._far===a._far&&this._fov===a._fov},d.prototype.almostEquals=function(a,c,e){void 0===e&&(e=!1);var d;c=f.dist(this._eye,this._center)*(c||5E-4);c*=c;return e?(f.direction(a._center,a._eye,t),f.direction(this._center,this._eye,r),d=1E-10):(f.set(a._center,t),f.set(this._center,r),d=c),f.dist2(a._eye,this._eye)<c&&f.dist2(t,r)<d&&.001>Math.abs(a._fov-this._fov)&&.5>b(a._padding,this._padding)&&
.5>b(a._viewport,this._viewport)},d.prototype.markViewDirty=function(){this._frustumPlanesDirty=this._viewDirty=!0},d.prototype.computePixelSizeAt=function(a){return this.computePixelSizeAtDist(f.dist(a,this._eye))},d.prototype.computePixelSizeAtDist=function(a){return 2*a*Math.tan(this.fovX/2)/this.width},d.prototype.computeDistanceFromRadius=function(a,b){return a/Math.tan(Math.min(this.fovX,this.fovY)/(2*(b||1)))},d.prototype.copyFrustumPlanes=function(b){if(!b){b=Array(6);for(var c=0;6>c;++c)b[c]=
a.create()}for(var e=this.frustumPlanes,c=0;6>c;c++)a.set(e[c],b[c]);return b},d.prototype.computeFrustumPoints=function(a){if(!a){a=Array(8);for(var b=0;8>b;++b)a[b]=f.create()}return h.matrix2frustum(this.viewMatrix,this.projectionMatrix,a),a},d.prototype.setGLViewport=function(a){var b=this.viewport,c=this.padding;a.setViewport(b[0]-c[3],b[1]-c[2],b[2]+c[1]+c[3],b[3]+c[0]+c[2])},d.prototype.applyProjection=function(a,b,d){void 0===d&&(d=!1);a!==c&&f.set(a,c);c[3]=1;d&&(b[2]=-c[2]);e.multiplyVec4(this.projectionMatrix,
c);f.scale(c,1/Math.abs(c[3]));a=this.fullViewport;return b[0]=h.lerp(0,a[0]+a[2],.5+.5*c[0]),b[1]=h.lerp(0,a[1]+a[3],.5+.5*c[1]),d||(b[2]=.5*(c[2]+1)),b},d.prototype.projectPoint=function(a,b,d){return void 0===d&&(d=!1),e.multiplyVec3(this.viewMatrix,a,c),this.applyProjection(c,b,d)},d.prototype.unprojectPoint=function(a,b,d){if(void 0===d&&(d=!1),d)return console.error("Camera.unprojectPoint() not yet implemented for linear Z"),null;if(e.multiply(this.projectionMatrix,this.viewMatrix,q),!e.inverse(q))return null;
d=this.fullViewport;return c[0]=2*(a[0]-d[0])/d[2]-1,c[1]=2*(a[1]-d[1])/d[3]-1,c[2]=2*a[2]-1,c[3]=1,e.multiplyVec4(q,c),0===c[3]?null:(b[0]=c[0]/c[3],b[1]=c[1]/c[3],b[2]=c[2]/c[3],b)},d.prototype.computeUp=function(a){"global"===a?this.computeUpGlobal():this.computeUpLocal()},d.prototype.computeUpGlobal=function(){f.subtract(this.center,this.eye,t);var a=f.length(this.center);1>a?(f.set3(0,0,1,this.up),this.markViewDirty()):Math.abs(f.dot(t,this.center))>.9999*f.length(t)*a||(f.cross(t,this.center,
this.up),f.cross(this.up,t,this.up),f.normalize(this.up),this.markViewDirty())},d.prototype.computeUpLocal=function(){f.direction(this.center,this.eye,t);.9999>=Math.abs(t[2])&&(f.scale(t,t[2]),f.set3(-t[0],-t[1],1-t[2],this.up),f.normalize(this.up),this.markViewDirty())},d.prototype._compareAndSetView=function(a,b){g(a,b)||(f.set(a,b),this._viewDirty=!0,this._frustumPlanesDirty=!0)},d.prototype._computeFrustumPlanes=function(b){if(!b){b=Array(6);for(var c=0;6>c;++c)b[c]=a.create()}return h.matrix2frustumPlanes(this.viewMatrix,
this.projectionMatrix,b),b},d.prototype._ensureViewClean=function(){this._viewDirty&&(e.lookAt(this._eye,this._center,this._up,this._viewMatrix),f.set3(-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10],this._viewForward),f.set3(this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9],this._viewUp),f.set3(this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8],this._viewRight),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)},d}();var c=a.create(),q=e.create(),t=f.create(),
r=f.create();return m})},"esri/views/3d/webgl-engine/lib/Util":function(){define(["require","exports","./gl-matrix"],function(m,l,h){function d(a,b){if(!a)throw a=Error("dummy"),a.stack&&console.log(a.stack),new O(b);}function b(a,b,c){return b>a?b:a>c?c:a}function g(a){return a/180*Math.PI}function k(a){return 180*a/Math.PI}function f(a,b,c){h.mat4d.multiply(b,a,t);h.mat4d.inverse(t);for(a=0;8>a;++a)h.mat4d.multiplyVec4(t,r[a],u),h.vec3d.set3(u[0]/u[3],u[1]/u[3],u[2]/u[3],c[a])}function a(a,b,c,
e){h.vec3d.subtract(a,b,x);h.vec3d.subtract(c,b,y);h.vec3d.cross(y,x,e);h.vec3d.normalize(e);e[3]=-h.vec3d.dot(e,a)}function e(a,b,c,e){var d=6378137/Math.sqrt(1-l.ECCENTRICITY_SQUARED*Math.pow(Math.sin(a),2)),f=Math.cos(a);e[0]=(d+c)*Math.cos(b)*f;e[1]=(d*(1-l.ECCENTRICITY_SQUARED)+c)*Math.sin(a);e[2]=-(d+c)*Math.sin(b)*f}function c(a){for(var b in a)return b}function q(a,b){a[12]=b[0];a[13]=b[1];a[14]=b[2]}Object.defineProperty(l,"__esModule",{value:!0});var t=h.mat4d.create(),r=[h.vec4d.createFrom(-1,
-1,-1,1),h.vec4d.createFrom(1,-1,-1,1),h.vec4d.createFrom(1,1,-1,1),h.vec4d.createFrom(-1,1,-1,1),h.vec4d.createFrom(-1,-1,1,1),h.vec4d.createFrom(1,-1,1,1),h.vec4d.createFrom(1,1,1,1),h.vec4d.createFrom(-1,1,1,1)],u=h.vec4d.create(),v=[h.vec3d.create(),h.vec3d.create(),h.vec3d.create(),h.vec3d.create(),h.vec3d.create(),h.vec3d.create(),h.vec3d.create(),h.vec3d.create()],x=h.vec3d.create(),y=h.vec3d.create(),n=h.vec3d.create(),w=h.vec3d.create(),z=h.vec3d.create(),C=h.vec3d.create(),B=h.vec3d.create(),
F=h.vec3d.create(),G=h.vec3d.create(),N=h.vec3d.create(),M=h.vec3d.create(),R=h.vec3d.create(),P=h.vec3d.create(),Q=h.vec3d.create(),T=h.vec3d.createFrom(0,0,0),O=function(){function a(a){this.message=a}return a.prototype.toString=function(){return"AssertException: "+this.message},a}();l.AssertException=O;l.EARTH_RADIUS=6378137;l.METER2FEET=3.28084;l.ECCENTRICITY_SQUARED=.0066943799901414;l.VertexAttrConstants={POSITION:"position",NORMAL:"normal",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",
SYMBOLCOLOR:"symbolColor",SIZE:"size",REGION:"region"};l.assert=d;l.verify=function(a,b){a||(console.log("Verify failed: "+b),console.log(Error("dummy").stack))};l.createQuadVertexUvBuffer=function(a){void 0===a&&(a=Float32Array);a=new a(20);return a[0]=-1,a[1]=-1,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=-1,a[7]=0,a[8]=1,a[9]=0,a[10]=-1,a[11]=1,a[12]=0,a[13]=0,a[14]=1,a[15]=1,a[16]=1,a[17]=0,a[18]=1,a[19]=1,a};l.isPowerOfTwo=function(a){return 0===(a&a-1)};l.lerp=function(a,b,c){return a+(b-a)*c};l.clamp=
b;l.fallbackIfUndefined=function(a,b){return void 0===a?b:a};l.hex2rgb=function(a){a=Math.floor(a);return[(a>>16&255)/255,(a>>8&255)/255,(255&a)/255]};l.rgb2hex=function(a){var c=b(Math.round(255*a[0]),0,255),e=b(Math.round(255*a[1]),0,255);a=b(Math.round(255*a[2]),0,255);return"0x"+((c<<16)+(e<<8)+a).toString(16)};l.dec2hex=function(a){a=a.toString(16);return"00000000".substr(0,8-a.length)+a};l.deg2rad=g;l.rad2deg=k;l.azimuthElevationAngle2Direction=function(a,b){a=1.5*Math.PI-a;b=.5*Math.PI-b;return[Math.cos(a)*
Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b)]};l.rayPlane=function(a,b,c,e){var d=h.vec3d.dot(c,b);if(0===d)return!1;c=-(h.vec3d.dot(c,a)+c[3])/d;return h.vec3d.add(a,h.vec3d.scale(b,c,e),e),!0};l.raySphere=function(a,b,c,e,d){c=c||T;var f=h.vec3d.subtract(a,c,x);c=h.vec3d.dot(b,b);var g=2*h.vec3d.dot(b,f);e=h.vec3d.dot(f,f)-e*e;e=g*g-4*c*e;if(0>e)return!1;f=Math.sqrt(e);e=(-g-f)/(2*c);c=(-g+f)/(2*c);return(0>e||e>c&&0<c)&&(e=c),0<e?(h.vec3d.add(a,h.vec3d.scale(b,e,Q),d),!0):!1};l.rayTriangle3D=
function(a,b,c,e,d,f,g,k,n){void 0===n&&(n=h.vec3d.create());var l=e[g]-c[f],p=e[g+1]-c[f+1],q=e[g+2]-c[f+2];e=d[k]-c[f];g=d[k+1]-c[f+1];d=d[k+2]-c[f+2];var r=b[1]*d-g*b[2],w=b[2]*e-d*b[0],u=b[0]*g-e*b[1];k=l*r+p*w+q*u;if(-1E-5<k&&1E-5>k)return!1;k=1/k;var t=a[0]-c[f],m=a[1]-c[f+1];a=a[2]-c[f+2];if(n[1]=k*(t*r+m*w+a*u),0>n[1]||1<n[1])return!1;c=m*q-p*a;a=a*l-q*t;l=t*p-l*m;return n[2]=k*(b[0]*c+b[1]*a+b[2]*l),0>n[2]||1<n[1]+n[2]?!1:(n[0]=k*(e*c+g*a+d*l),!0)};l.rayBoxTest=function(a,b,c,e){var d,f=
(c[0]-a[0])/b[0],g=(e[0]-a[0])/b[0];f>g&&(d=f,f=g,g=d);var k=(c[1]-a[1])/b[1],h=(e[1]-a[1])/b[1];if(k>h&&(d=k,k=h,h=d),f>h||k>g)return!1;k>f&&(f=k);g>h&&(g=h);c=(c[2]-a[2])/b[2];a=(e[2]-a[2])/b[2];return c>a&&(d=c,c=a,a=d),f>a||c>g?!1:(g>a&&(g=a),0>g?!1:!0)};l.rayRay2D=function(a,b,c,e,d,f){void 0===f&&(f=h.vec2d.create());var g=(e[d]-c[d])*(b[0]-a[0])-(e[0]-c[0])*(b[d]-a[d]);if(0===g)return!1;c=((e[0]-c[0])*(a[d]-c[d])-(e[d]-c[d])*(a[0]-c[0]))/g;return f[0]=a[0]+c*(b[0]-a[0]),f[1]=a[d]+c*(b[d]-a[d]),
!0};l.matrix2frustum=f;l.matrix2frustumPlanes=function(b,c,e,d){void 0===d&&(d=e,e=v);f(b,c,e);a(e[4],e[0],e[3],d[0]);a(e[1],e[5],e[6],d[1]);a(e[4],e[5],e[1],d[2]);a(e[3],e[2],e[6],d[3]);a(e[0],e[1],e[2],d[4]);a(e[5],e[4],e[7],d[5])};l.point2plane=a;l.project=function(a,b,c,e,f){f||(f=a);u[0]=a[0];u[1]=a[1];u[2]=a[2];u[3]=1;h.mat4d.multiplyVec4(b,u);2<f.length&&(f[2]=-u[2]);h.mat4d.multiplyVec4(c,u);d(0!==u[3]);f[0]=u[0]/u[3];f[1]=u[1]/u[3];f[2]=u[2]/u[3];f[0]=(.5*f[0]+.5)*e[2]+e[0];f[1]=(.5*f[1]+
.5)*e[3]+e[1]};l.geodeticToGeocentricLatidude=function(a){return Math.atan((1-l.ECCENTRICITY_SQUARED)*Math.tan(a))};l.latLon2positionWGS84Ellipsoid=e;l.pos2latLon=function(a,c){var e=h.vec3d.length(a);c[0]=Math.asin(b(a[1]/e,-1,1));c[1]=(0>a[2]?1:-1)*Math.acos(b(a[0]/(Math.cos(c[0])*e),-1,1));c[0]=k(c[0]);c[1]=k(c[1]);c[2]=e};l.pos2latLonWGS84Ellipsoid=function(a,b){var c=a[0],e=-a[2],d=a[1],f=Math.sqrt(Math.pow(6378137,2)*(1-l.ECCENTRICITY_SQUARED));a=Math.sqrt(Math.pow(c,2)+Math.pow(e,2));var g=
Math.atan2(6378137*d,f*a),c=Math.atan2(e,c),e=Math.atan2(d+Math.pow(Math.sqrt((Math.pow(6378137,2)-Math.pow(f,2))/Math.pow(f,2)),2)*f*Math.pow(Math.sin(g),3),a-6378137*l.ECCENTRICITY_SQUARED*Math.pow(Math.cos(g),3));a=a/Math.cos(e)-6378137/Math.sqrt(1-l.ECCENTRICITY_SQUARED*Math.pow(Math.sin(e),2))+l.EARTH_RADIUS;b[0]=e;b[1]=c;b[2]=a};l.computeGlobeTransformation=function(a,b,c){var d=g(a[0]);a=g(a[1]);return e(d,a,b,n),h.mat4d.translate(c,n),h.mat4d.rotateY(c,.5*Math.PI+a),h.mat4d.rotateX(c,.5*Math.PI-
d),c};l.readUInt16=function(a,b){return a[b]+(a[b+1]<<8)};l.readUInt32=function(a,b){return a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24)};l.setIfDefined=function(a,b,c){void 0!==b[a]&&(c[a]=b[a])};l.array2object=function(a,b){var c={};if(void 0!==b)for(var e=0;e<a.length;e++){var d=a[e];c[b(d)]=d}else for(b=0;b<a.length;b++)d=a[b],c[d]=d;return c};l.object2array=function(a){var b=[],c;for(c in a)b.push(a[c]);return b};l.mergeObjects=function(a,b,c){if(void 0===c&&(c={}),c!==a)for(var e in a)c[e]=a[e];
if(c!==b)for(var d in b)c[d]=b[d];return c};l.subtractObjects=function(a,b){var c={},e;for(e in a)void 0===b[e]&&(c[e]=a[e]);return c};l.intersectObjects=function(a,b){var c={},e;for(e in a)void 0!==b[e]&&(c[e]=a[e]);return c};l.getFirstObjectKey=c;l.getFirstObjectValue=function(a){return a[c(a)]};l.objectEmpty=function(a){for(var b in a)return!1;return!0};l.arraysEqual=function(a,b){if(a.length!==b.length)return!1;for(var c=0,e=a.length;e>c;++c)if(a[c]!==b[c])return!1;return!0};l.arrayRemove=function(a,
b){var c=a.indexOf(b);return-1!==c?(a[c]=a[a.length-1],a.pop(),b):null};l.byteBuffer2base64image=function(a,b,c,e,f){var g=4*b;d(a.length===g*c,"buffer length must match image resolution");var k=document.createElement("canvas");k.width=b;k.height=c;var h=k.getContext("2d");b=h.getImageData(0,0,b,c);for(var n=b.data,l=0;c>l;++l)for(var q=l*g,r=(c-1-l)*g,w=0;g>w;++w)n[q++]=a[r++];return h.putImageData(b,0,0),k.toDataURL(e,f)};l.cround=function(a){return Math.round(100*a)/100};l.logWithBase=function(a,
b){return Math.log(a)/Math.log(b)};l.setMatrixTranslation=q;l.setMatrixTranslation3=function(a,b,c,e){a[12]=b;a[13]=c;a[14]=e};l.getMatrixTranslation=function(a,b){return void 0===b&&(b=h.vec3d.create()),b[0]=a[12],b[1]=a[13],b[2]=a[14],b};l.createTranslationMatrix=function(a,b){return a=h.mat4d.identity(a),q(a,b),a};l.fovx2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/b)};l.fovy2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/c)};l.fovx2fovd=function(a,b,c){return 2*Math.atan(Math.sqrt(b*
b+c*c)*Math.tan(.5*a)/b)};l.fovy2fovd=function(a,b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/c)};l.fovd2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};l.fovd2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};l.nextHighestPowerOfTwo=function(a){--a;for(var b=1;32>b;b<<=1)a|=a>>b;return a+1};l.nextHighestPowerOfTen=function(a){return Math.pow(10,Math.ceil(Math.LOG10E*Math.log(a)))};l.lineSegmentLineSegmentDistance3D=function(a,
c,e,d){var f,g,k,n,l,q;if((w[0]=a[0]-e[0],w[1]=a[1]-e[1],w[2]=a[2]-e[2],z[0]=d[0]-e[0],z[1]=d[1]-e[1],z[2]=d[2]-e[2],1E-4>Math.abs(z[0])&&1E-4>Math.abs(z[1])&&1E-4>Math.abs(z[2]))||(C[0]=c[0]-a[0],C[1]=c[1]-a[1],C[2]=c[2]-a[2],1E-4>Math.abs(C[0])&&1E-4>Math.abs(C[1])&&1E-4>Math.abs(C[2]))||(f=w[0]*z[0]+w[1]*z[1]+w[2]*z[2],g=z[0]*C[0]+z[1]*C[1]+z[2]*C[2],k=w[0]*C[0]+w[1]*C[1]+w[2]*C[2],n=z[0]*z[0]+z[1]*z[1]+z[2]*z[2],l=C[0]*C[0]+C[1]*C[1]+C[2]*C[2],q=l*n-g*g,1E-4>Math.abs(q)))return[!1];c=b((f*g-k*
n)/q,0,1);f=b((f+g*c)/n,0,1);B[0]=a[0]+c*C[0];B[1]=a[1]+c*C[1];B[2]=a[2]+c*C[2];F[0]=e[0]+f*z[0];F[1]=e[1]+f*z[1];F[2]=e[2]+f*z[2];return[!0,h.vec3d.dist(B,F),B,F]};l.pointLineSegmentDistance2D=function(a,c,e){R[0]=c[0]-a[0];R[1]=c[1]-a[1];R[2]=0;P[0]=e[0]-a[0];P[1]=e[1]-a[1];P[2]=0;Q[0]=e[0];Q[1]=e[1];Q[2]=0;c=h.vec3d.dot(P,R);e=h.vec3d.length(R);c=b(c/(e*e),0,1);M[0]=R[0]*c;M[1]=R[1]*c;G[0]=a[0]+M[0];G[1]=a[1]+M[1];h.vec3d.subtract(Q,G,N);a=h.vec3d.length(N);c=h.vec3d.length(P);e=h.vec3d.length(R);
var d=h.vec3d.length(M);return(d>c||d>e)&&(a=Number.MAX_VALUE),a};m=function(){var a=window.performance||{};if(a.now)return function(){return a.now()};if(a.webkitNow)return function(){return a.webkitNow()};if(a.mozNow)return function(){return a.mozNow()};if(a.msNow)return function(){return a.msNow()};if(a.oNow)return function(){return a.oNow()};var b;return b=a.timing&&a.timing.navigationStart?a.timing.navigationStart:Date.now(),function(){return Date.now()-b}}();l.performance={now:m}})},"esri/views/3d/webgl-engine/lib/gl-matrix":function(){define([],
function(){var m={};return function(l,h){h(l,!0);h(l,!1)}(m,function(l,h){var d={};!function(){if("undefined"!=typeof Float32Array){var a=new Float32Array(1),b=new Int32Array(a.buffer);d.invsqrt=function(c){a[0]=c;b[0]=1597463007-(b[0]>>1);var e=a[0];return e*(1.5-.5*c*e*e)}}else d.invsqrt=function(a){return 1/Math.sqrt(a)}}();var b=Array;"undefined"!=typeof Float32Array&&(b=h?Float32Array:Array);var g={create:function(a){var c=new b(3);return a?(c[0]=a[0],c[1]=a[1],c[2]=a[2]):c[0]=c[1]=c[2]=0,c},
createFrom:function(a,c,e){var d=new b(3);return d[0]=a,d[1]=c,d[2]=e,d},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b},set3:function(a,b,c,e){return e[0]=a,e[1]=b,e[2]=c,e},add:function(a,b,c){return c&&a!==c?(c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c):(a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a)},subtract:function(a,b,c){return c&&a!==c?(c[0]=a[0]-b[0],c[1]=a[1]-b[1],c[2]=a[2]-b[2],c):(a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a)},multiply:function(a,b,c){return c&&a!==c?(c[0]=a[0]*b[0],c[1]=a[1]*
b[1],c[2]=a[2]*b[2],c):(a[0]*=b[0],a[1]*=b[1],a[2]*=b[2],a)},max:function(a,b,c){return c[0]=Math.max(a[0],b[0]),c[1]=Math.max(a[1],b[1]),c[2]=Math.max(a[2],b[2]),c},min:function(a,b,c){return c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.min(a[2],b[2]),c},negate:function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b},scale:function(a,b,c){return c&&a!==c?(c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c):(a[0]*=b,a[1]*=b,a[2]*=b,a)},normalize:function(a,b){b||(b=a);var c=a[0],e=a[1];
a=a[2];var d=Math.sqrt(c*c+e*e+a*a);return d?1===d?(b[0]=c,b[1]=e,b[2]=a,b):(d=1/d,b[0]=c*d,b[1]=e*d,b[2]=a*d,b):(b[0]=0,b[1]=0,b[2]=0,b)},cross:function(a,b,c){c||(c=a);var e=a[0],d=a[1];a=a[2];var f=b[0],g=b[1];b=b[2];return c[0]=d*b-a*g,c[1]=a*f-e*b,c[2]=e*g-d*f,c},length:function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)},length2:function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var e=
a[0]-b[0],d=a[1]-b[1];a=a[2]-b[2];return(b=Math.sqrt(e*e+d*d+a*a))?(b=1/b,c[0]=e*b,c[1]=d*b,c[2]=a*b,c):(c[0]=0,c[1]=0,c[2]=0,c)},lerp:function(a,b,c,e){return e||(e=a),e[0]=a[0]+c*(b[0]-a[0]),e[1]=a[1]+c*(b[1]-a[1]),e[2]=a[2]+c*(b[2]-a[2]),e},dist:function(a,b){var c=b[0]-a[0],e=b[1]-a[1];a=b[2]-a[2];return Math.sqrt(c*c+e*e+a*a)},dist2:function(a,b){var c=b[0]-a[0],e=b[1]-a[1];a=b[2]-a[2];return c*c+e*e+a*a}},k=null,f=new b(4);g.unproject=function(a,b,c,e,d){d||(d=a);k||(k=u.create());var g=k;return f[0]=
2*(a[0]-e[0])/e[2]-1,f[1]=2*(a[1]-e[1])/e[3]-1,f[2]=2*a[2]-1,f[3]=1,u.multiply(c,b,g),u.inverse(g)?(u.multiplyVec4(g,f),0===f[3]?null:(d[0]=f[0]/f[3],d[1]=f[1]/f[3],d[2]=f[2]/f[3],d)):null};var a=g.createFrom(1,0,0),e=g.createFrom(0,1,0),c=g.createFrom(0,0,1);g.rotationTo=function(b,d,f){f||(f=m.create());var k=g.dot(b,d),h=g.create();if(1<=k)m.set(x,f);else if(-.999999>k)g.cross(a,b,h),1E-6>h.length&&g.cross(e,b,h),1E-6>h.length&&g.cross(c,b,h),g.normalize(h),m.fromAxisAngle(h,Math.PI,f);else{var k=
Math.sqrt(2*(1+k)),n=1/k;g.cross(b,d,h);f[0]=h[0]*n;f[1]=h[1]*n;f[2]=h[2]*n;f[3]=.5*k;m.normalize(f)}return 1<f[3]?f[3]=1:-1>f[3]&&(f[3]=-1),f};var q=g.create(),t=g.create();g.project=function(a,b,c,e){e||(e=a);g.direction(b,c,q);g.subtract(a,b,t);a=g.dot(q,t);g.scale(q,a,e);g.add(e,b,e)};g.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var r={create:function(a){var c=new b(9);return a?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8]):c[0]=c[1]=c[2]=
c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=0,c},createFrom:function(a,c,e,d,f,g,k,h,l){var n=new b(9);return n[0]=a,n[1]=c,n[2]=e,n[3]=d,n[4]=f,n[5]=g,n[6]=k,n[7]=h,n[8]=l,n},determinant:function(a){var b=a[3],c=a[4],e=a[5],d=a[6],f=a[7],g=a[8];return a[0]*(g*c-e*f)+a[1]*(-g*b+e*d)+a[2]*(f*b-c*d)},inverse:function(a,b){var c,e=a[0],d=a[1],f=a[2],g=a[3],k=a[4],h=a[5],n=a[6],l=a[7];a=a[8];var q=a*k-h*l,u=-a*g+h*n,t=l*g-k*n,m=e*q+d*u+f*t;return m?(c=1/m,b||(b=r.create()),b[0]=q*c,b[1]=(-a*d+f*l)*c,b[2]=(h*d-f*k)*
c,b[3]=u*c,b[4]=(a*e-f*n)*c,b[5]=(-h*e+f*g)*c,b[6]=t*c,b[7]=(-l*e+d*n)*c,b[8]=(k*e-d*g)*c,b):null},multiply:function(a,b,c){c||(c=a);var e=a[0],d=a[1],f=a[2],g=a[3],k=a[4],h=a[5],n=a[6],l=a[7];a=a[8];var q=b[0],r=b[1],u=b[2],t=b[3],m=b[4],w=b[5],v=b[6],x=b[7];b=b[8];return c[0]=q*e+r*g+u*n,c[1]=q*d+r*k+u*l,c[2]=q*f+r*h+u*a,c[3]=t*e+m*g+w*n,c[4]=t*d+m*k+w*l,c[5]=t*f+m*h+w*a,c[6]=v*e+x*g+b*n,c[7]=v*d+x*k+b*l,c[8]=v*f+x*h+b*a,c},multiplyVec2:function(a,b,c){c||(c=b);var e=b[0];b=b[1];return c[0]=e*a[0]+
b*a[3]+a[6],c[1]=e*a[1]+b*a[4]+a[7],c},multiplyVec3:function(a,b,c){c||(c=b);var e=b[0],d=b[1];b=b[2];return c[0]=e*a[0]+d*a[3]+b*a[6],c[1]=e*a[1]+d*a[4]+b*a[7],c[2]=e*a[2]+d*a[5]+b*a[8],c},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},identity:function(a){return a||(a=r.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},transpose:function(a,b){if(!b||a===b){b=a[1];var c=a[2],e=a[5];return a[1]=a[3],a[2]=
a[6],a[3]=b,a[5]=a[7],a[6]=c,a[7]=e,a}return b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8],b},toMat4:function(a,b){return b||(b=u.create()),b[15]=1,b[14]=0,b[13]=0,b[12]=0,b[11]=0,b[10]=a[8],b[9]=a[7],b[8]=a[6],b[7]=0,b[6]=a[5],b[5]=a[4],b[4]=a[3],b[3]=0,b[2]=a[2],b[1]=a[1],b[0]=a[0],b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},u={create:function(a){var c=new b(16);return 4===arguments.length?
(c[0]=arguments[0],c[1]=arguments[1],c[2]=arguments[2],c[3]=arguments[3],c[4]=arguments[4],c[5]=arguments[5],c[6]=arguments[6],c[7]=arguments[7],c[8]=arguments[8],c[9]=arguments[9],c[10]=arguments[10],c[11]=arguments[11],c[12]=arguments[12],c[13]=arguments[13],c[14]=arguments[14],c[15]=arguments[15]):a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c},createFrom:function(a,
c,e,d,f,g,k,h,l,q,r,u,t,m,v,x){var n=new b(16);return n[0]=a,n[1]=c,n[2]=e,n[3]=d,n[4]=f,n[5]=g,n[6]=k,n[7]=h,n[8]=l,n[9]=q,n[10]=r,n[11]=u,n[12]=t,n[13]=m,n[14]=v,n[15]=x,n},createFromMatrixRowMajor:function(a){var c=new b(16);return c[0]=a[0],c[4]=a[1],c[8]=a[2],c[12]=a[3],c[1]=a[4],c[5]=a[5],c[9]=a[6],c[13]=a[7],c[2]=a[8],c[6]=a[9],c[10]=a[10],c[14]=a[11],c[3]=a[12],c[7]=a[13],c[11]=a[14],c[15]=a[15],c},createFromMatrix:function(a){var c=new b(16);return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],
c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},setRowMajor:function(a,b){return b[0]=a[0],b[4]=a[1],b[8]=a[2],b[12]=a[3],b[1]=a[4],b[5]=a[5],b[9]=a[6],b[13]=a[7],b[2]=a[8],b[6]=a[9],b[10]=a[10],b[14]=a[11],b[3]=a[12],
b[7]=a[13],b[11]=a[14],b[15]=a[15],b},identity:function(a){return a||(a=u.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},transpose:function(a,b){if(!b||a===b){b=a[1];var c=a[2],e=a[3],d=a[6],f=a[7],g=a[11];return a[1]=a[4],a[2]=a[8],a[3]=a[12],a[4]=b,a[6]=a[9],a[7]=a[13],a[8]=c,a[9]=d,a[11]=a[14],a[12]=e,a[13]=f,a[14]=g,a}return b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=
a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15],b},determinant:function(a){var b=a[0],c=a[1],e=a[2],d=a[3],f=a[4],g=a[5],k=a[6],h=a[7],n=a[8],l=a[9],q=a[10],r=a[11],u=a[12],t=a[13],m=a[14];a=a[15];return u*l*k*d-n*t*k*d-u*g*q*d+f*t*q*d+n*g*m*d-f*l*m*d-u*l*e*h+n*t*e*h+u*c*q*h-b*t*q*h-n*c*m*h+b*l*m*h+u*g*e*r-f*t*e*r-u*c*k*r+b*t*k*r+f*c*m*r-b*g*m*r-n*g*e*a+f*l*e*a+n*c*k*a-b*l*k*a-f*c*q*a+b*g*q*a},inverse:function(a,b){b||(b=a);var c,e=a[0],d=a[1],f=a[2],g=a[3],k=
a[4],h=a[5],n=a[6],l=a[7],q=a[8],r=a[9],u=a[10],t=a[11],m=a[12],w=a[13],v=a[14];a=a[15];var x=e*h-d*k,p=e*n-f*k,y=e*l-g*k,K=d*n-f*h,U=d*l-g*h,V=f*l-g*n,X=q*w-r*m,ba=q*v-u*m,fa=q*a-t*m,ha=r*v-u*w,ca=r*a-t*w,ea=u*a-t*v,ja=x*ea-p*ca+y*ha+K*fa-U*ba+V*X;return ja?(c=1/ja,b[0]=(h*ea-n*ca+l*ha)*c,b[1]=(-d*ea+f*ca-g*ha)*c,b[2]=(w*V-v*U+a*K)*c,b[3]=(-r*V+u*U-t*K)*c,b[4]=(-k*ea+n*fa-l*ba)*c,b[5]=(e*ea-f*fa+g*ba)*c,b[6]=(-m*V+v*y-a*p)*c,b[7]=(q*V-u*y+t*p)*c,b[8]=(k*ca-h*fa+l*X)*c,b[9]=(-e*ca+d*fa-g*X)*c,b[10]=
(m*U-w*y+a*x)*c,b[11]=(-q*U+r*y-t*x)*c,b[12]=(-k*ha+h*ba-n*X)*c,b[13]=(e*ha-d*ba+f*X)*c,b[14]=(-m*K+w*p-v*x)*c,b[15]=(q*K-r*p+u*x)*c,b):null},toRotationMat:function(a,b){return b||(b=u.create()),b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},toMat3:function(a,b){return b||(b=r.create()),b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[4],b[4]=a[5],b[5]=a[6],b[6]=a[8],b[7]=a[9],b[8]=a[10],b},toInverseMat3:function(a,
b){var c,e=a[0],d=a[1],f=a[2],g=a[4],k=a[5],h=a[6],n=a[8],l=a[9];a=a[10];var q=a*k-h*l,u=-a*g+h*n,t=l*g-k*n,m=e*q+d*u+f*t;return m?(c=1/m,b||(b=r.create()),b[0]=q*c,b[1]=(-a*d+f*l)*c,b[2]=(h*d-f*k)*c,b[3]=u*c,b[4]=(a*e-f*n)*c,b[5]=(-h*e+f*g)*c,b[6]=t*c,b[7]=(-l*e+d*n)*c,b[8]=(k*e-d*g)*c,b):null},multiply:function(a,b,c){c||(c=a);var e=a[0],d=a[1],f=a[2],g=a[3],k=a[4],h=a[5],n=a[6],l=a[7],q=a[8],r=a[9],u=a[10],t=a[11],m=a[12],w=a[13],v=a[14];a=a[15];var x=b[0],p=b[1],y=b[2],z=b[3],U=b[4],V=b[5],X=
b[6],ba=b[7],fa=b[8],ha=b[9],ca=b[10],ea=b[11],ja=b[12],na=b[13],za=b[14];b=b[15];return c[0]=x*e+p*k+y*q+z*m,c[1]=x*d+p*h+y*r+z*w,c[2]=x*f+p*n+y*u+z*v,c[3]=x*g+p*l+y*t+z*a,c[4]=U*e+V*k+X*q+ba*m,c[5]=U*d+V*h+X*r+ba*w,c[6]=U*f+V*n+X*u+ba*v,c[7]=U*g+V*l+X*t+ba*a,c[8]=fa*e+ha*k+ca*q+ea*m,c[9]=fa*d+ha*h+ca*r+ea*w,c[10]=fa*f+ha*n+ca*u+ea*v,c[11]=fa*g+ha*l+ca*t+ea*a,c[12]=ja*e+na*k+za*q+b*m,c[13]=ja*d+na*h+za*r+b*w,c[14]=ja*f+na*n+za*u+b*v,c[15]=ja*g+na*l+za*t+b*a,c},multiplyVec3:function(a,b,c){c||(c=
b);var e=b[0],d=b[1];b=b[2];return c[0]=a[0]*e+a[4]*d+a[8]*b+a[12],c[1]=a[1]*e+a[5]*d+a[9]*b+a[13],c[2]=a[2]*e+a[6]*d+a[10]*b+a[14],c},multiplyVec4:function(a,b,c){c||(c=b);var e=b[0],d=b[1],f=b[2];b=b[3];return c[0]=a[0]*e+a[4]*d+a[8]*f+a[12]*b,c[1]=a[1]*e+a[5]*d+a[9]*f+a[13]*b,c[2]=a[2]*e+a[6]*d+a[10]*f+a[14]*b,c[3]=a[3]*e+a[7]*d+a[11]*f+a[15]*b,c},translate:function(a,b,c){var e,d,f,g,k,h,l,n,q,r,u,t,m=b[0],w=b[1];b=b[2];return c&&a!==c?(e=a[0],d=a[1],f=a[2],g=a[3],k=a[4],h=a[5],l=a[6],n=a[7],
q=a[8],r=a[9],u=a[10],t=a[11],c[0]=e,c[1]=d,c[2]=f,c[3]=g,c[4]=k,c[5]=h,c[6]=l,c[7]=n,c[8]=q,c[9]=r,c[10]=u,c[11]=t,c[12]=e*m+k*w+q*b+a[12],c[13]=d*m+h*w+r*b+a[13],c[14]=f*m+l*w+u*b+a[14],c[15]=g*m+n*w+t*b+a[15],c):(a[12]=a[0]*m+a[4]*w+a[8]*b+a[12],a[13]=a[1]*m+a[5]*w+a[9]*b+a[13],a[14]=a[2]*m+a[6]*w+a[10]*b+a[14],a[15]=a[3]*m+a[7]*w+a[11]*b+a[15],a)},scale:function(a,b,c){var e=b[0],d=b[1];b=b[2];return c&&a!==c?(c[0]=a[0]*e,c[1]=a[1]*e,c[2]=a[2]*e,c[3]=a[3]*e,c[4]=a[4]*d,c[5]=a[5]*d,c[6]=a[6]*d,
c[7]=a[7]*d,c[8]=a[8]*b,c[9]=a[9]*b,c[10]=a[10]*b,c[11]=a[11]*b,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c):(a[0]*=e,a[1]*=e,a[2]*=e,a[3]*=e,a[4]*=d,a[5]*=d,a[6]*=d,a[7]*=d,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a)},maxScale:function(a){return Math.max(Math.max(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8]),Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])),Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))},rotate:function(a,b,c,e){var d,f,g,k,h,l,n,q,r,u,t,m,w,v,x,p,y,z,C,V,X,ba,fa,ha,ca=c[0],ea=c[1];c=c[2];var ja=
Math.sqrt(ca*ca+ea*ea+c*c);return ja?(1!==ja&&(ja=1/ja,ca*=ja,ea*=ja,c*=ja),d=Math.sin(b),f=Math.cos(b),g=1-f,k=a[0],h=a[1],l=a[2],n=a[3],q=a[4],r=a[5],u=a[6],t=a[7],m=a[8],w=a[9],v=a[10],x=a[11],p=ca*ca*g+f,y=ea*ca*g+c*d,z=c*ca*g-ea*d,C=ca*ea*g-c*d,V=ea*ea*g+f,X=c*ea*g+ca*d,ba=ca*c*g+ea*d,fa=ea*c*g-ca*d,ha=c*c*g+f,e?a!==e&&(e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]):e=a,e[0]=k*p+q*y+m*z,e[1]=h*p+r*y+w*z,e[2]=l*p+u*y+v*z,e[3]=n*p+t*y+x*z,e[4]=k*C+q*V+m*X,e[5]=h*C+r*V+w*X,e[6]=l*C+u*V+v*X,e[7]=
n*C+t*V+x*X,e[8]=k*ba+q*fa+m*ha,e[9]=h*ba+r*fa+w*ha,e[10]=l*ba+u*fa+v*ha,e[11]=n*ba+t*fa+x*ha,e):null},rotateX:function(a,b,c){var e=Math.sin(b);b=Math.cos(b);var d=a[4],f=a[5],g=a[6],k=a[7],h=a[8],l=a[9],n=a[10],q=a[11];return c?a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[4]=d*b+h*e,c[5]=f*b+l*e,c[6]=g*b+n*e,c[7]=k*b+q*e,c[8]=d*-e+h*b,c[9]=f*-e+l*b,c[10]=g*-e+n*b,c[11]=k*-e+q*b,c},rotateY:function(a,b,c){var e=Math.sin(b);b=Math.cos(b);var d=
a[0],f=a[1],g=a[2],k=a[3],h=a[8],l=a[9],n=a[10],q=a[11];return c?a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[0]=d*b+h*-e,c[1]=f*b+l*-e,c[2]=g*b+n*-e,c[3]=k*b+q*-e,c[8]=d*e+h*b,c[9]=f*e+l*b,c[10]=g*e+n*b,c[11]=k*e+q*b,c},rotateZ:function(a,b,c){var e=Math.sin(b);b=Math.cos(b);var d=a[0],f=a[1],g=a[2],k=a[3],h=a[4],l=a[5],n=a[6],q=a[7];return c?a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):
c=a,c[0]=d*b+h*e,c[1]=f*b+l*e,c[2]=g*b+n*e,c[3]=k*b+q*e,c[4]=d*-e+h*b,c[5]=f*-e+l*b,c[6]=g*-e+n*b,c[7]=k*-e+q*b,c},frustum:function(a,b,c,e,d,f,g){g||(g=u.create());var k=b-a,h=e-c,l=f-d;return g[0]=2*d/k,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2*d/h,g[6]=0,g[7]=0,g[8]=(b+a)/k,g[9]=(e+c)/h,g[10]=-(f+d)/l,g[11]=-1,g[12]=0,g[13]=0,g[14]=-(f*d*2)/l,g[15]=0,g},perspective:function(a,b,c,e,d){a=c*Math.tan(a*Math.PI/360);b*=a;return u.frustum(-b,b,-a,a,c,e,d)},ortho:function(a,b,c,e,d,f,g){g||(g=u.create());var k=
b-a,h=e-c,l=f-d;return g[0]=2/k,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2/h,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=-2/l,g[11]=0,g[12]=-(a+b)/k,g[13]=-(e+c)/h,g[14]=-(f+d)/l,g[15]=1,g},lookAt:function(a,b,c,e){e||(e=u.create());var d,f,g,k,h,l,n,q,r,t,m=a[0],w=a[1];a=a[2];var v=c[0],x=c[1];c=c[2];var y=b[0],p=b[1];b=b[2];return m===y&&w===p&&a===b?u.identity(e):(n=m-y,q=w-p,r=a-b,t=1/Math.sqrt(n*n+q*q+r*r),n*=t,q*=t,r*=t,d=x*r-c*q,f=c*n-v*r,g=v*q-x*n,t=Math.sqrt(d*d+f*f+g*g),t?(t=1/t,d*=t,f*=t,g*=t):(d=0,f=0,
g=0),k=q*g-r*f,h=r*d-n*g,l=n*f-q*d,t=Math.sqrt(k*k+h*h+l*l),t?(t=1/t,k*=t,h*=t,l*=t):(k=0,h=0,l=0),e[0]=d,e[1]=k,e[2]=n,e[3]=0,e[4]=f,e[5]=h,e[6]=q,e[7]=0,e[8]=g,e[9]=l,e[10]=r,e[11]=0,e[12]=-(d*m+f*w+g*a),e[13]=-(k*m+h*w+l*a),e[14]=-(n*m+q*w+r*a),e[15]=1,e)},fromRotationTranslation:function(a,b,c){c||(c=u.create());var e=a[0],d=a[1],f=a[2],g=a[3],k=e+e,h=d+d,l=f+f;a=e*k;var n=e*h,e=e*l,q=d*h,d=d*l,f=f*l,k=g*k,h=g*h,g=g*l;return c[0]=1-(q+f),c[1]=n+g,c[2]=e-h,c[3]=0,c[4]=n-g,c[5]=1-(a+f),c[6]=d+k,
c[7]=0,c[8]=e+h,c[9]=d-k,c[10]=1-(a+q),c[11]=0,c[12]=b[0],c[13]=b[1],c[14]=b[2],c[15]=1,c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},m={create:function(a){var c=new b(4);return a?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3]):c[0]=c[1]=c[2]=c[3]=0,c},createFrom:function(a,c,e,d){var f=new b(4);return f[0]=a,f[1]=c,f[2]=e,f[3]=d,f},set:function(a,b){return b[0]=
a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},identity:function(a){return a||(a=m.create()),a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}},x=m.identity();m.calculateW=function(a,b){var c=a[0],e=a[1],d=a[2];return b&&a!==b?(b[0]=c,b[1]=e,b[2]=d,b[3]=-Math.sqrt(Math.abs(1-c*c-e*e-d*d)),b):(a[3]=-Math.sqrt(Math.abs(1-c*c-e*e-d*d)),a)};m.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};m.inverse=function(a,b){var c=a[0],e=a[1],d=a[2],f=a[3],c=(c=c*c+e*e+d*d+f*f)?1/c:0;return b&&a!==b?(b[0]=-a[0]*c,b[1]=-a[1]*
c,b[2]=-a[2]*c,b[3]=a[3]*c,b):(a[0]*=-c,a[1]*=-c,a[2]*=-c,a[3]*=c,a)};m.conjugate=function(a,b){return b&&a!==b?(b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b[3]=a[3],b):(a[0]*=-1,a[1]*=-1,a[2]*=-1,a)};m.length=function(a){var b=a[0],c=a[1],e=a[2];a=a[3];return Math.sqrt(b*b+c*c+e*e+a*a)};m.normalize=function(a,b){b||(b=a);var c=a[0],e=a[1],d=a[2];a=a[3];var f=Math.sqrt(c*c+e*e+d*d+a*a);return 0===f?(b[0]=0,b[1]=0,b[2]=0,b[3]=0,b):(f=1/f,b[0]=c*f,b[1]=e*f,b[2]=d*f,b[3]=a*f,b)};m.add=function(a,b,c){return c&&
a!==c?(c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c[3]=a[3]+b[3],c):(a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a[3]+=b[3],a)};m.multiply=function(a,b,c){c||(c=a);var e=a[0],d=a[1],f=a[2];a=a[3];var g=b[0],k=b[1],h=b[2];b=b[3];return c[0]=e*b+a*g+d*h-f*k,c[1]=d*b+a*k+f*g-e*h,c[2]=f*b+a*h+e*k-d*g,c[3]=a*b-e*g-d*k-f*h,c};m.multiplyVec3=function(a,b,c){c||(c=b);var e=b[0],d=b[1],f=b[2];b=a[0];var g=a[1],k=a[2];a=a[3];var h=a*e+g*f-k*d,l=a*d+k*e-b*f,n=a*f+b*d-g*e,e=-b*e-g*d-k*f;return c[0]=h*a+e*-b+l*-k-n*-g,
c[1]=l*a+e*-g+n*-b-h*-k,c[2]=n*a+e*-k+h*-g-l*-b,c};m.scale=function(a,b,c){return c&&a!==c?(c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c[3]=a[3]*b,c):(a[0]*=b,a[1]*=b,a[2]*=b,a[3]*=b,a)};m.toMat3=function(a,b){b||(b=r.create());var c=a[0],e=a[1],d=a[2],f=a[3],g=c+c,k=e+e,h=d+d;a=c*g;var l=c*k,c=c*h,n=e*k,e=e*h,d=d*h,g=f*g,k=f*k,f=f*h;return b[0]=1-(n+d),b[1]=l+f,b[2]=c-k,b[3]=l-f,b[4]=1-(a+d),b[5]=e+g,b[6]=c+k,b[7]=e-g,b[8]=1-(a+n),b};m.toMat4=function(a,b){b||(b=u.create());var c=a[0],e=a[1],d=a[2],f=a[3],
g=c+c,k=e+e,h=d+d;a=c*g;var l=c*k,c=c*h,n=e*k,e=e*h,d=d*h,g=f*g,k=f*k,f=f*h;return b[0]=1-(n+d),b[1]=l+f,b[2]=c-k,b[3]=0,b[4]=l-f,b[5]=1-(a+d),b[6]=e+g,b[7]=0,b[8]=c+k,b[9]=e-g,b[10]=1-(a+n),b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b};m.slerp=function(a,b,c,e){e||(e=a);var d,f,g,k,h=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3];return 1<=Math.abs(h)?(e!==a&&(e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3]),e):(d=Math.acos(h),f=Math.sqrt(1-h*h),.001>Math.abs(f)?(e[0]=.5*a[0]+.5*b[0],e[1]=.5*a[1]+.5*b[1],e[2]=.5*
a[2]+.5*b[2],e[3]=.5*a[3]+.5*b[3],e):(g=Math.sin((1-c)*d)/f,k=Math.sin(c*d)/f,e[0]=a[0]*g+b[0]*k,e[1]=a[1]*g+b[1]*k,e[2]=a[2]*g+b[2]*k,e[3]=a[3]*g+b[3]*k,e))};m.fromRotationMatrix=function(a,b){b||(b=m.create());var c,e=a[0]+a[4]+a[8];if(0<e)c=Math.sqrt(e+1),b[3]=.5*c,c=.5/c,b[0]=(a[7]-a[5])*c,b[1]=(a[2]-a[6])*c,b[2]=(a[3]-a[1])*c;else{c=m.fromRotationMatrix.s_iNext=m.fromRotationMatrix.s_iNext||[1,2,0];e=0;a[4]>a[0]&&(e=1);a[8]>a[3*e+e]&&(e=2);var d=c[e],f=c[d];c=Math.sqrt(a[3*e+e]-a[3*d+d]-a[3*
f+f]+1);b[e]=.5*c;c=.5/c;b[3]=(a[3*f+d]-a[3*d+f])*c;b[d]=(a[3*d+e]+a[3*e+d])*c;b[f]=(a[3*f+e]+a[3*e+f])*c}return b};r.toQuat4=m.fromRotationMatrix;(function(){var a=r.create();m.fromAxes=function(b,c,e,d){return a[0]=c[0],a[3]=c[1],a[6]=c[2],a[1]=e[0],a[4]=e[1],a[7]=e[2],a[2]=b[0],a[5]=b[1],a[8]=b[2],m.fromRotationMatrix(a,d)}})();m.identity=function(a){return a||(a=m.create()),a[0]=0,a[1]=0,a[2]=0,a[3]=1,a};m.fromAngleAxis=function(a,b,c){c||(c=m.create());a*=.5;var e=Math.sin(a);return c[3]=Math.cos(a),
c[0]=e*b[0],c[1]=e*b[1],c[2]=e*b[2],c};m.toAngleAxis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=d.invsqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};m.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var y={create:function(a){var c=new b(4);return a?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3]):c[0]=c[1]=c[2]=c[3]=0,c},createFrom:function(a,c,e,d){var f=new b(4);return f[0]=a,f[1]=c,f[2]=e,f[3]=d,f},set:function(a,
b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},identity:function(a){return a||(a=y.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},transpose:function(a,b){return b&&a!==b?(b[0]=a[0],b[1]=a[2],b[2]=a[1],b[3]=a[3],b):(b=a[1],a[1]=a[2],a[2]=b,a)},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},inverse:function(a,b){b||(b=a);var c=a[0],e=a[1],d=a[2];a=a[3];var f=c*a-d*e;return f?(f=1/f,b[0]=a*f,b[1]=-e*f,b[2]=-d*f,b[3]=c*f,b):null},multiply:function(a,b,c){c||(c=a);var e=a[0],d=a[1],f=a[2];a=a[3];
return c[0]=e*b[0]+d*b[2],c[1]=e*b[1]+d*b[3],c[2]=f*b[0]+a*b[2],c[3]=f*b[1]+a*b[3],c},rotate:function(a,b,c){c||(c=a);var e=a[0],d=a[1],f=a[2];a=a[3];var g=Math.sin(b);b=Math.cos(b);return c[0]=e*b+d*g,c[1]=e*-g+d*b,c[2]=f*b+a*g,c[3]=f*-g+a*b,c},multiplyVec2:function(a,b,c){c||(c=b);var e=b[0];b=b[1];return c[0]=e*a[0]+b*a[1],c[1]=e*a[2]+b*a[3],c},scale:function(a,b,c){c||(c=a);var e=a[1],d=a[2],f=a[3],g=b[0];b=b[1];return c[0]=a[0]*g,c[1]=e*b,c[2]=d*g,c[3]=f*b,c},str:function(a){return"["+a[0]+", "+
a[1]+", "+a[2]+", "+a[3]+"]"}};h=h?"":"d";l["glMath"+h]=d;l["vec2"+h]={create:function(a){var c=new b(2);return a?(c[0]=a[0],c[1]=a[1]):(c[0]=0,c[1]=0),c},createFrom:function(a,c){var e=new b(2);return e[0]=a,e[1]=c,e},add:function(a,b,c){return c||(c=b),c[0]=a[0]+b[0],c[1]=a[1]+b[1],c},subtract:function(a,b,c){return c||(c=b),c[0]=a[0]-b[0],c[1]=a[1]-b[1],c},multiply:function(a,b,c){return c||(c=b),c[0]=a[0]*b[0],c[1]=a[1]*b[1],c},divide:function(a,b,c){return c||(c=b),c[0]=a[0]/b[0],c[1]=a[1]/b[1],
c},scale:function(a,b,c){return c||(c=a),c[0]=a[0]*b,c[1]=a[1]*b,c},dist:function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)},dist2:function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*c+a*a},set:function(a,b){return b[0]=a[0],b[1]=a[1],b},set2:function(a,b,c){return c[0]=a,c[1]=b,c},negate:function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b},normalize:function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1];return 0<c?(c=Math.sqrt(c),b[0]=a[0]/c,b[1]=a[1]/c):b[0]=b[1]=0,b},cross:function(a,
b,c){a=a[0]*b[1]-a[1]*b[0];return c?(c[0]=c[1]=0,c[2]=a,c):a},length:function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]},direction:function(a,b,c){c||(c=a);var e=a[0]-b[0];a=a[1]-b[1];return(b=e*e+a*a)?(b=1/Math.sqrt(b),c[0]=e*b,c[1]=a*b,c):(c[0]=0,c[1]=0,c[2]=0,c)},lerp:function(a,b,c,e){return e||(e=a),e[0]=a[0]+c*(b[0]-a[0]),e[1]=a[1]+c*(b[1]-a[1]),e},str:function(a){return"["+a[0]+", "+a[1]+"]"}};l["vec3"+h]=g;l["vec4"+h]={create:function(a){var c=
new b(4);return a?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3]):(c[0]=0,c[1]=0,c[2]=0,c[3]=0),c},createFrom:function(a,c,e,d){var f=new b(4);return f[0]=a,f[1]=c,f[2]=e,f[3]=d,f},add:function(a,b,c){return c||(c=b),c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c[3]=a[3]+b[3],c},subtract:function(a,b,c){return c||(c=b),c[0]=a[0]-b[0],c[1]=a[1]-b[1],c[2]=a[2]-b[2],c[3]=a[3]-b[3],c},multiply:function(a,b,c){return c||(c=b),c[0]=a[0]*b[0],c[1]=a[1]*b[1],c[2]=a[2]*b[2],c[3]=a[3]*b[3],c},divide:function(a,b,
c){return c||(c=b),c[0]=a[0]/b[0],c[1]=a[1]/b[1],c[2]=a[2]/b[2],c[3]=a[3]/b[3],c},scale:function(a,b,c){return c||(c=a),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c[3]=a[3]*b,c},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},set:function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},set4:function(a,b,c,e,d){return d[0]=a,d[1]=b,d[2]=c,d[3]=e,d},negate:function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b[3]=-a[3],b},lerp:function(a,b,c,e){return e||(e=a),e[0]=a[0]+
c*(b[0]-a[0]),e[1]=a[1]+c*(b[1]-a[1]),e[2]=a[2]+c*(b[2]-a[2]),e[3]=a[3]+c*(b[3]-a[3]),e},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};l["mat2"+h]=y;l["mat3"+h]=r;l["mat4"+h]=u;l["quat4"+h]=m}),m})},"esri/views/3d/state/controllers/CameraController":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Accessor".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,
"__esModule",{value:!0});var k;!function(b){b.Ready="ready";b.Rejected="rejected";b.Running="running";b.Stopped="stopped";b.Finished="finished"}(k=l.State||(l.State={}));m=function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;return a.state=k.Ready,a}return h(a,f),Object.defineProperty(a.prototype,"active",{get:function(){return this.state===k.Running},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isInteractive",{get:function(){return!1},enumerable:!0,configurable:!0}),
Object.defineProperty(a.prototype,"canStop",{get:function(){return!1},enumerable:!0,configurable:!0}),a.prototype.stopController=function(){return this.canStop?(this.state=k.Stopped,!0):!1},a.prototype.finishController=function(){this.state=k.Finished},a.prototype.onControllerStart=function(a){this.state=k.Running},a.prototype.onControllerEnd=function(a){},a.prototype.stepController=function(a,b){},Object.defineProperty(a.prototype,"steppingFinished",{get:function(){return!1},enumerable:!0,configurable:!0}),
d([b.property({readOnly:!0,dependsOn:["state"]})],a.prototype,"active",null),d([b.property()],a.prototype,"state",void 0),a=d([b.subclass()],a)}(b.declared(g));l.CameraController=m})},"esri/views/3d/state/controllers/AnimationController":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../ViewAnimation","./CameraController"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(g){function k(b){void 0===b&&(b=new d);var a=g.call(this)||
this;return a.viewAnimation=b,a}return h(k,g),Object.defineProperty(k.prototype,"canStop",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"asyncResult",{get:function(){return this._asyncResult},set:function(d){this._asyncResult&&this._asyncResult.reject();this._asyncResult=d;(this.state===b.State.Finished||this.state===b.State.Stopped)&&(this._asyncResult=null,this.state===b.State.Finished?d.resolve():d.reject())},enumerable:!0,configurable:!0}),k.prototype.onControllerStart=
function(d){var a=this;g.prototype.onControllerStart.call(this,d);this.viewAnimation&&this.viewAnimation.when(function(){a.state!==b.State.Ready&&a.state!==b.State.Running||a.finish()},function(){a.state!==b.State.Ready&&a.state!==b.State.Running||(a.state=b.State.Stopped)})},k.prototype.onControllerEnd=function(d){this.viewAnimation&&(this.viewAnimation.done||(this.state===b.State.Finished?this.viewAnimation.finish():this.state===b.State.Stopped&&this.viewAnimation.stop()));this._asyncResult&&(this.state===
b.State.Finished?this._asyncResult.resolve():this._asyncResult.reject());g.prototype.onControllerEnd.call(this,d)},k.prototype.finish=function(){this.finishController()},k}(b.CameraController);l.AnimationController=m})},"esri/views/3d/state/ViewStateManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators dojo/_base/lang ../../../Camera ../../../Viewpoint ../../../core/Accessor ../../../core/Logger ../../../core/HandleRegistry ../../../core/watchUtils ../../../core/Error ../../../core/promiseUtils ../../../geometry/Point ../../../geometry/Extent ../../../geometry/ScreenPoint ../../../geometry/support/webMercatorUtils ../../animation/easing ./controllers/PointToPointAnimationController ../support/PropertiesPool ../support/cameraUtils ../support/viewpointUtils ../camera/intersectionUtils ../camera/constraintUtils ./Frustum ./ConstraintsManager ./controllers/SurfaceCollisionCorrectionController ../lib/glMatrix ../webgl-engine/lib/Camera ./helpers/PickingHelper".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P,Q,T){Object.defineProperty(l,"__esModule",{value:!0});var O=e.getLogger("esri.views.3d.state.ViewStateManager");m=function(a){function e(b){b=a.call(this)||this;return b.propertiesPool=new z["default"]({frustum:N["default"]},b),b.handles=new c,b.cameraSetByUser=!1,b.internalSetOrder=[],b.immediateGoToPromise=null,b.animatedGoToPromise=null,b.ready=!1,b}return h(e,a),Object.defineProperty(e.prototype,"camera",{get:function(){return this.ready?
C.internalToExternal(this.view,this.view.state.camera):this._get("camera")},set:function(a){this.updatePropertyBeforeReady("camera",a)||this.setStateCamera(C.externalToInternal(this.view,a),{applyConstraints:!1})||O.error("#camera\x3d","Invalid camera",a)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this.ready?this.view.pointsOfInterest.centerOnContent.location:this._get("center")},set:function(a){return this.updatePropertyBeforeReady("center",
a)?void 0:a?this.isCompatible(a)?void(this.setStateCamera(this.centerToCamera(a),{applyConstraints:!0})?this.view.pointsOfInterest.centerOnContent.forceUpdate():O.error("#center\x3d","Invalid center",a)):void O.error("#center\x3d","Center has an incompatible spatial reference (center: "+(a.spatialReference?a.spatialReference.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",a):void O.error("#center\x3d","Center may not be null or undefined")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,
"extent",{get:function(){return this.ready?C.toExtent(this.view,null,null,null,W):this._get("extent")},set:function(a){return this.updatePropertyBeforeReady("extent",a)?void 0:a?this.isCompatible(a)?void(this.setStateCamera(this.extentToCamera(a),{applyConstraints:!0})||O.error("#extent\x3d","Invalid extent",a)):void O.error("#extent\x3d","Extent has an incompatible spatial reference (extent: "+(a.spatialReference?a.spatialReference.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",a):void O.error("#extent\x3d",
"Extent may not be null or undefined")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frustum",{get:function(){var a=this.propertiesPool.get("frustum");return a.update(this.view.state.camera),a},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasInitialView",{get:function(){return!!this.view.get("map.initialViewProperties.viewpoint")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){if(!this.ready)return this._get("scale");
var a=this.view.pointsOfInterest.centerOnContent;return C.distanceToScale(this.view,a.distance,a.location.latitude)},set:function(a){this.updatePropertyBeforeReady("scale",a)||this.setStateCamera(this.scaleToCamera(a),{applyConstraints:!0})||O.error("#scale\x3d","Invalid scale",a)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){if(!this.ready)return this._get("padding");var a=this.view.state.camera.padding;return{top:a[0],right:a[1],bottom:a[2],left:a[3]}},
set:function(a){this.updatePropertyBeforeReady("padding",a)||(a?P.vec4d.set4(a.top||0,a.right||0,a.bottom||0,a.left||0,p):P.vec4d.set4(0,0,0,0,p),this.view.state.updateCamera(function(a){a.padding=p}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"screenCenter",{get:function(){var a=this.padding;return new x((this.view.width-(a.left+a.right))/2+a.left,(this.view.height-(a.top+a.bottom))/2+a.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewpoint",{get:function(){return this.ready?
B.fromCamera(this.view,this.camera):this._get("viewpoint")},set:function(a){if(!this.updatePropertyBeforeReady("viewpoint",a)){if(!a)return void O.error("#viewpoint\x3d","Viewpoint may not be null or undefined");if(!this.isCompatible(a)){var b=a.camera?a.camera.position:a.targetGeometry,b=b&&b.spatialReference;return void O.error("#viewpoint\x3d","Viewpoint has an incompatible spatial reference (viewpoint: "+(b?b.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",a)}this.setStateCamera(this.viewpointToCamera(a),
{applyConstraints:!a.camera})||O.error("#viewpoint\x3d","Invalid viewpoint",a)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoom",{get:function(){return this.ready?C.scaleToZoom(this.view,this.scale):this._get("zoom")},set:function(a){this.updatePropertyBeforeReady("zoom",a)||this.setStateCamera(this.zoomToCamera(a),{applyConstraints:!0})||O.error("#zoom\x3d","Invalid zoom",a)},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){var a=this;this.pickingHelper=
new T.PickingHelper(this.view);this.handles.add(this.view.watch("state.camera",function(b){return a.cameraChangedSync(b)},!0),q.on(this.view,"state.events","before-camera-change",function(b){return a.beforeCameraChangeHandle(b.camera)}));this.handles.add(this.view.on("resize",function(b){return a.handleResize(b.width,b.height)}));this.handles.add(this.view.watch("state.cameraController",function(){a.cameraSetByUser=!0;a.handles.remove(A);a.cancelImmediateGoTo()}));this.handles.add(q.on(this.view,
"pointsOfInterest.events","camera-parameters-changed",function(){return a.notifyChange("scale")}))},e.prototype.destroy=function(){this.handles&&(this.handles.destroy(),this.handles=null);this.propertiesPool&&(this.propertiesPool.destroy(),this.propertiesPool=null)},e.prototype.init=function(){var a=this;this.constraintsManager=new M["default"]({view:this.view});this.handleResize(this.view.width,this.view.height);var b=this.getInitialProperties();this.cameraSetByUser=!1;this._set("ready",!0);for(var c=
0;c<b.length;c++){var e=b[c];this.set(e.name,e.value)}this.cameraSetByUser||((b=this.view.get("map.initialViewProperties.viewpoint")||this.view.initialExtent)&&this.isCompatible(b)?this.setInitialView(b):"local"===this.view.state.mode&&this.handles.add(q.whenOnce(this.view.basemapTerrain,"ready",function(){a.handles.remove(A);a.setInitialView(a.view.groundExtent)}),A))},e.prototype.deinit=function(){this.ready&&(this._override("padding",this.padding),this.cancelImmediateGoTo(),this.cancelAnimatedGoTo(),
this._set("ready",!1),this._clearOverride("hasInitialView"),this.internalSetOrder.length=0,this.cameraSetByUser=!1,this.handles.remove(A),this.constraintsManager&&(this.constraintsManager.destroy(),this.constraintsManager=null))},e.prototype.goTo=function(a,b){return b=g.mixin({animate:!0},b),b.animate?this.goToAnimated(a,b):this.goToImmediate(a,b)},e.prototype.debugSetCameraOnContent=function(){this.setStateCamera(F.cameraOnContentAlongViewDirection(this.view),{applyConstraints:!1})},e.prototype.step=
function(a){var b=this.view.state,c=b&&this.view.state.cameraController;c&&(b.updateCamera(function(b){c.stepController(a,b)}),c.steppingFinished&&c.finishController())},e.prototype.cancelImmediateGoTo=function(){var a=this.immediateGoToPromise;a&&(this.immediateGoToPromise=null,a.cancel())},e.prototype.cancelAnimatedGoTo=function(){var a=this.animatedGoToPromise;a&&(this.animatedGoToPromise=null,a.cancel())},e.prototype.getInitialProperties=function(){for(var a=this,b=new Set,c=[],e=0,d=H;e<d.length;e++){var f=
d[e],g=f.propertyName,f=f.overrides,k=b.has(g),h=this._isOverridden(g);!k&&h&&c.push({name:g,value:this._get(g)});this._clearOverride(g);(k||h)&&f.forEach(function(a){return b.add(a)})}return c.sort(function(b,c){b=a.internalSetOrder.indexOf(b.name);c=a.internalSetOrder.indexOf(c.name);return c>b?-1:b>c?1:0})},e.prototype.setInitialView=function(a){if(a&&!this.cameraSetByUser){var b,c={applyConstraints:!0};a instanceof k?(b=a,c.applyConstraints=!1):a instanceof f?a.targetGeometry instanceof v?b=C.fromExtent(this.view,
a.targetGeometry,0,.5,{noReset:!0}):(a.camera&&(c.applyConstraints=!1),b=B.toCamera(this.view,a)):b=C.fromExtent(this.view,a,0,.5,{noReset:!0});this.setStateCamera(C.externalToInternal(this.view,b),c)}},e.prototype.updatePropertyBeforeReady=function(a,b){if(this.ready)return!1;this._override(a,b);var c=this.internalSetOrder.indexOf(a);return-1!==c&&(this.internalSetOrder=this.internalSetOrder.splice(c,1)),b&&(this.internalSetOrder.push(a),-1!==S.indexOf(a)&&this._override("hasInitialView",!0)),!0},
e.prototype.isCompatible=function(a){return a?a instanceof f?a.camera?this.isCompatible(a.camera):this.isCompatible(a.targetGeometry):a instanceof k?this.isCompatible(a.position):a.spatialReference&&y.canProject(a.spatialReference,this.view.spatialReference):!1},e.prototype.getPreservingHeadingTilt=function(a){return void 0===a&&(a=Y),this.cameraSetByUser?(a.heading=this.camera.heading,a.tilt=this.camera.tilt):(a.heading=0,a.tilt=.5),a},e.prototype.centerPointAtDistanceToCamera=function(a,b,c){void 0===
c&&(c=E);var e=this.getPreservingHeadingTilt();return(a=C.eyeHeadingTiltForCenterPointAtDistance(this.view,e.heading,e.tilt,a,b))?(c.copyFrom(this.view.state.camera),c.eye=a.eye,c.center=a.center,c.up=a.up,c):null},e.prototype.centerToCamera=function(a){var b=this.view.pointsOfInterest.centerOnContent;b.forceUpdate();return this.centerPointAtDistanceToCamera(a,b.distance)},e.prototype.extentToCamera=function(a){var b=this.getPreservingHeadingTilt();return(a=C.fromExtent(this.view,a,b.heading,b.tilt,
W))?C.externalToInternal(this.view,a):void 0},e.prototype.scaleToCamera=function(a){var b=this.view.pointsOfInterest.centerOnContent;b.forceUpdate();var c=b.renderLocation;a=C.scaleToDistance(this.view,a,b.location.latitude);return this.centerPointAtDistanceToCamera(c,a)},e.prototype.zoomToCamera=function(a){return this.scaleToCamera(C.zoomToScale(this.view,a))},e.prototype.viewpointToCamera=function(a){return(a=B.toCamera(this.view,a))?C.externalToInternal(this.view,a):null},e.prototype.setStateCamera=
function(a,b){var c=this;return a&&this.view.state.stopActiveCameraController()?(this.cameraSetByUser=!0,this.cancelImmediateGoTo(),this.view.state.updateCamera(function(e){e.copyFrom(a);b.applyConstraints&&G.applyAll(c.view,e)}),b.applyConstraints||(this.view.state.cameraController=new R.SurfaceCollisionCorrectionController({view:this.view,desiredCamera:a})),!0):!1},e.prototype.handleResize=function(a,b){var c=this.view.canvas;if(c&&(c.width!==a||c.height!==b)&&(c.width=a,c.height=b),this.view.state)c=
this.view.state.camera,(c.fullWidth!==a||c.fullHeight!==b)&&(E.copyFrom(c),E.fullWidth=a,E.fullHeight=b,this.view.state.camera=E)},e.prototype.beforeCameraChangeHandle=function(a){this.updateCameraAboveGround(a)},e.prototype.cameraChangedSync=function(a){a&&this.view._stage&&this.view._stage.setCamera(a)},e.prototype.updateCameraAboveGround=function(a){var b=this.view.basemapTerrain,c=this.view.renderCoordsHelper.getAltitude(a.eye),b=b&&b.spatialReference?F.surfaceElevationBelowEye(this.view,a):0;
a.aboveGround=c>=b},e.prototype.createGoToCamera=function(a){var b=this;return q.whenOnce(this,"ready",null,!0).then(function(){return B.create(b.view,a)}).then(function(c){var e=!!(a instanceof f&&a.camera||a instanceof k),d=c.camera;if(!b.isCompatible(d))throw c=(c=d.position)&&c.spatialReference,new t("goto:incompatible-spatialreference","Resulting camera has an incompatible spatial reference (camera: "+(c?c.wkid:"none")+", view: "+b.view.spatialReference.wkid+")",{camera:d});d=C.externalToInternal(b.view,
d);if(!d)throw new t("goto:invalid-camera","Resulting camera is invalid");return{viewpoint:c,camera:d,isFullySpecified:e}})},e.prototype.cancellableGoTo=function(a){var b,c=this;return r.create(function(c,e){b={resolve:c,reject:e};a.asyncResult=b},function(){c.view.state.cameraController===a&&a.active&&a.asyncResult===b&&a.stopController()})},e.prototype.goToImmediate=function(a,b){var c=this;this.cancelAnimatedGoTo();this.cancelImmediateGoTo();var e=this.createGoToCamera(a).then(function(a){c.immediateGoToPromise===
e&&(c.immediateGoToPromise=null);c.setStateCamera(a.camera,{applyConstraints:!a.isFullySpecified})})["catch"](function(a){c.immediateGoToPromise===e&&(c.immediateGoToPromise=null);throw a instanceof t&&a.message&&O.error("#goTo()","Failed to create camera from target, "+a.message[0].toLowerCase()+a.message.slice(1)),a;});return this.immediateGoToPromise=e,e},e.prototype.goToAnimatedBeforeReady=function(a,b){var c=this;this.cancelAnimatedGoTo();var e=q.whenOnce(this.view,"ready").then(function(){if(e===
c.animatedGoToPromise)return c.animatedGoToPromise=null,c.goToAnimated(a,b);throw new t("view:goto-cancelled","Cancelled");});return this.animatedGoToPromise=e,e},e.prototype.goToAnimated=function(a,b){var c=this;if(this.cancelAnimatedGoTo(),!this.ready)return this.goToAnimatedBeforeReady(a,b);var e,d=this.view.state.cameraController;e=d instanceof w.PointToPointAnimationController&&d.active?d:new w.PointToPointAnimationController(this.view.state,this.pickingHelper);this.cancelAnimatedGoTo();var f=
e.viewAnimation;a=this.createGoToCamera(a);var g=a.then(function(a){return a.viewpoint});if(f.update(g),e!==d&&!this.view.state.switchCameraController(e))return f.stop(),O.error("#goTo()","Cannot start an animation while interacting"),r.reject(new t("view:goto-cannot-interrupt","Cannot start an animation while interacting"));var k=f.target,h=function(){return c.view.state.cameraController===e&&e.viewAnimation.target===k&&e.active};return a.then(function(a){var d=a.viewpoint,g=a.camera;a=a.isFullySpecified;
if(h()){e.viewAnimation.update(d);k=e.viewAnimation.target;var l;return a?(l=new R.SurfaceCollisionCorrectionController({view:c.view,desiredCamera:g}),G.applySurfaceCollision(c.view,g,1)):G.applyAll(c.view,g),e.begin(g,c.internalAnimateOptions(b)),f.when().then(function(){l&&e.viewAnimation.target===k&&(c.view.state.cameraController=l)})}}).otherwise(function(a){if(a instanceof t&&a.message&&O.error("#goTo()","Failed to create camera from target, "+a.message[0].toLowerCase()+a.message.slice(1)),h())throw c.view.state.cameraController.stopController(),
a;}),this.cancellableGoTo(e)},e.prototype.internalAnimateOptions=function(a){var b={};return a&&(null!=a.speedFactor&&(b.speedFactor=a.speedFactor),null!=a.duration&&(b.duration=a.duration/1E3),null!=a.maxDuration&&(b.maxDuration=a.maxDuration/1E3),null!=a.easing&&("string"==typeof a.easing?b.easing=n.named[a.easing]:b.easing=a.easing)),b},d([b.property({type:k,dependsOn:["view.state.camera","ready"]})],e.prototype,"camera",null),d([b.property({type:u,dependsOn:["view.pointsOfInterest.centerOnContent.location",
"ready"]})],e.prototype,"center",null),d([b.property({type:v,dependsOn:["view.state.camera","ready"]})],e.prototype,"extent",null),d([b.property({readOnly:!0,dependsOn:["view.state.camera","ready"]})],e.prototype,"frustum",null),d([b.property({readOnly:!0,dependsOn:["view.map.initialViewProperties.viewpoint"]})],e.prototype,"hasInitialView",null),d([b.property({readOnly:!0,type:Boolean})],e.prototype,"ready",void 0),d([b.property({dependsOn:["view.pointsOfInterest.centerOnContent.distance","ready"],
type:Number})],e.prototype,"scale",null),d([b.property({dependsOn:["view.state.camera","ready"]})],e.prototype,"padding",null),d([b.property({readOnly:!0,dependsOn:["view.width","view.height","padding"]})],e.prototype,"screenCenter",null),d([b.property({constructOnly:!0})],e.prototype,"view",void 0),d([b.property({type:f,dependsOn:["camera","ready"]})],e.prototype,"viewpoint",null),d([b.property({type:Number,dependsOn:["scale"]})],e.prototype,"zoom",null),e=d([b.subclass("esri.views.3d.state.ViewStateManager")],
e)}(b.declared(a));l.ViewStateManager=m;var S="camera viewpoint extent scale center zoom".split(" "),H=[{propertyName:"camera",overrides:["viewpoint"]},{propertyName:"viewpoint",overrides:["extent"]},{propertyName:"extent",overrides:["center","scale"]},{propertyName:"scale",overrides:["zoom"]},{propertyName:"center",overrides:[]},{propertyName:"zoom",overrides:[]},{propertyName:"padding",overrides:[]}],Y={heading:0,tilt:0},W=new k,E=new Q,p=P.vec4d.create(),A="pending-initial-view";l["default"]=m})},
"esri/views/animation/easing":function(){define(["require","exports"],function(m,l){function h(b){return b}function d(b){var d=2*(b-Math.sqrt((b-1)*b)),f=d/2/b;return function(a){return f>a?b*a*a:d*a-d+1}}function b(b,d){return function(f){return d>f?d*b(f/d):1-b((1-f)/(1-d))*(1-d)}}Object.defineProperty(l,"__esModule",{value:!0});l.linear=h;l.inQuad=function(b){return b*b};l.outQuad=function(b){return 1-l.inQuad(1-b)};l.inOutQuad=function(b){return.5>b?l.inQuad(2*b)/2:(l.outQuad(2*(b-.5))+1)/2};
l.inCubic=function(b){return b*b*b};l.outCubic=function(b){return 1-l.inCubic(1-b)};l.inOutCubic=function(b){return.5>b?l.inCubic(2*b)/2:(l.outCubic(2*(b-.5))+1)/2};l.inQuart=function(b){return b*b*b*b};l.outQuart=function(b){return 1-l.inQuart(1-b)};l.inOutQuart=function(b){return.5>b?l.inQuart(2*b)/2:(l.outQuart(2*(b-.5))+1)/2};l.inQuint=function(b){return b*b*b*b*b};l.outQuint=function(b){return 1-l.inQuint(1-b)};l.inOutQuint=function(b){return.5>b?l.inQuint(2*b)/2:(l.outQuint(2*(b-.5))+1)/2};
l.inSine=function(b){return-Math.cos(b*Math.PI/2)+1};l.outSine=function(b){return 1-l.inSine(1-b)};l.inOutSine=function(b){return.5>b?l.inSine(2*b)/2:(l.outSine(2*(b-.5))+1)/2};l.inExpo=function(b){return Math.pow(2,10*(b-1))};l.outExpo=function(b){return 1-l.inExpo(1-b)};l.inOutExpo=function(b){return.5>b?l.inExpo(2*b)/2:(l.outExpo(2*(b-.5))+1)/2};l.inCirc=function(b){return-(Math.sqrt(1-b*b)-1)};l.outCirc=function(b){return 1-l.inCirc(1-b)};l.inOutCirc=function(b){return.5>b?l.inCirc(2*b)/2:(l.outCirc(2*
(b-.5))+1)/2};l.inCoastQuad=b(d(1),1);l.outCoastQuad=b(d(1),0);l.inOutCoastQuad=b(d(1),.5);l.inCoastCubic=b(d(2),1);l.outCoastCubic=b(d(2),0);l.inOutCoastCubic=b(d(2),.5);l.inCoastQuart=b(d(3),1);l.outCoastQuart=b(d(3),0);l.inOutCoastQuart=b(d(3),.5);l.inCoastQuint=b(d(4),1);l.outCoastQuint=b(d(4),0);l.inOutCoastQuint=b(d(4),.5);l.named={linear:h,"in-quad":l.inQuad,"out-quad":l.outQuad,"in-out-quad":l.inOutQuad,"in-cubic":l.inCubic,"out-cubic":l.outCubic,"in-out-cubic":l.inOutCubic,"in-quart":l.inQuart,
"out-quart":l.outQuart,"in-out-quart":l.inOutQuart,"in-quint":l.inQuint,"out-quint":l.outQuint,"in-out-quint":l.inOutQuint,"in-sine":l.inSine,"out-sine":l.outSine,"in-out-sine":l.inOutSine,"in-expo":l.inExpo,"out-expo":l.outExpo,"in-out-expo":l.inOutExpo,"in-circ":l.inCirc,"out-circ":l.outCirc,"in-out-circ":l.inOutCirc}})},"esri/views/3d/state/controllers/PointToPointAnimationController":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./AnimationController ../../webgl-engine/lib/Camera ../../lib/glMatrix ../../animation/pointToPoint/Animation".split(" "),
function(m,l,h,d,b,g,k){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function c(a,c,e){e=b.call(this,e)||this;return e.viewState=a,e.pickingHelper=c,e.hasTarget=!1,e.animation=new k["default"](e.viewState.mode),e}return h(c,b),c.prototype.begin=function(b,c){this.hasTarget=!0;c=this.animationSettings(c);f.copyFrom(this.viewState.camera);this.pickingHelper.pickRaySegment(f.eye,f.center,a)&&(f.center=a);this.animation.update(f,b,c);this.animation.finished&&this.finish()},c.prototype.finish=
function(){this.animation.currentTime=this.animation.time;b.prototype.finish.call(this)},Object.defineProperty(c.prototype,"steppingFinished",{get:function(){return this.hasTarget&&this.animation.finished},enumerable:!0,configurable:!0}),c.prototype.stepController=function(a,c){b.prototype.stepController.call(this,a,c);this.hasTarget&&this.animation.step(a,c)},c.prototype.onControllerEnd=function(a){this.hasTarget&&(this.animation.cameraAt(this.animation.currentTime/this.animation.time,a),this.animation.currentTime=
this.animation.time);b.prototype.onControllerEnd.call(this,a)},c.prototype.animationSettings=function(a){return void 0===a&&(a={}),{apex:{maximumDistance:this.viewState.constraints.clampAltitude(1/0)/6,ascensionFactor:void 0,descensionFactor:void 0},speedFactor:a.speedFactor,duration:a.duration,maxDuration:a.maxDuration,easing:a.easing}},c}(d.AnimationController);l.PointToPointAnimationController=m;var f=new b,a=g.vec3d.create()})},"esri/views/3d/animation/pointToPoint/Animation":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../animation/pointToPoint/Animation ./Camera ../../lib/glMatrix ../../webgl-engine/lib/Camera".split(" "),
function(m,l,h,d,b,g,k){Object.defineProperty(l,"__esModule",{value:!0});var f=g.vec3d,a=f.create();m=function(){function e(a){this.currentTime=0;this.animation=new d.Animation(function(){return new b["default"](a)});this._current=new b["default"](a)}return Object.defineProperty(e.prototype,"finished",{get:function(){return this.currentTime>=this.animation.time},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return this.animation.time},enumerable:!0,configurable:!0}),
e.prototype.update=function(b,e,d){var c=this.animation.definition.source,g=this.animation.definition.target,k=f.subtract(e.center,b.center,a),h=f.length(k);1E-5<=h?(k[0]/=h,k[1]/=h,k[2]/=h):(k[0]=0,k[1]=1,k[0]=0);f.set(k,c.lookAtDirection);f.set(k,g.lookAtDirection);c.copyFromRenderCamera(b);g.copyFromRenderCamera(e);this._current.copyFrom(c);this.animation.update(c,g,d);this.currentTime=0;b.almostEquals(e,5E-4,!0)&&(this.currentTime=this.animation.time)},e.prototype.cameraAt=function(a,b){a=this.animation.cameraAt(a,
this._current);return b||(b=new k),a.copyToRenderCamera(b),b},e.prototype.step=function(a,b){return this.finished||(this.currentTime+=a,this.currentTime>=this.time&&(this.currentTime=this.time)),this.cameraAt(this.currentTime/this.time,b)},e}();l.Animation=m;l["default"]=m})},"esri/views/animation/pointToPoint/Animation":function(){define("require exports ../easing ./Definition ./Settings ./apex/Path".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});var k={zoom:0,
pan:0,rotate:0};m=function(){function f(a){this.createCamera=a;this.time=0;this.definition=new d.Definition(a);this.path=new g.Path}return f.prototype.update=function(a,b,c){this.definition.update(a,b,c);this.path.update(this.definition,c);this.time=this._applyTimeSettings(this.path.time,c);this.settings=c},f.prototype.cameraAt=function(a,b){b||(b=this.createCamera());a=Math.min(Math.max(0,a),1);a=this.settings.easing?this.normalizedEasing(this.settings.easing,a,1E3*this.time):1<=this.time?this.normalizedEasing(h.inOutCoastQuad,
a):this.normalizedEasing(h.outExpo,a);a=this.path.interpolateComponentsAt(a,k);return b.interpolate(this.definition.source,this.definition.target,a),b},f.prototype.normalizedEasing=function(a,b,c){c=a(0);var e=a(1);return(a(b)-c)/(e-c)},f.prototype._applyTimeSettings=function(a,e){var c=null!=e.speedFactor?e.speedFactor:1;null!=e.duration?a=e.duration:null!=e.speedFactor&&(a/=c);return a=Math.min(Math.max(null!=e.minDuration?e.minDuration:b.defaultSettings.minDuration/c,a),null!=e.maxDuration?e.maxDuration:
b.defaultSettings.maxDuration/c)},f}();l.Animation=m;l["default"]=m})},"esri/views/animation/pointToPoint/Definition":function(){define(["require","exports","./Settings"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function d(b){this.createCamera=b;this.compared={sourceZoom:0,targetZoom:0,pan:0,rotate:0};this.settings={desiredScreenFlow:h.defaultSettings.desiredScreenFlow};this.source=b();this.target=b()}return d.prototype.clone=function(){var b=new d(this.createCamera);
return b.copyFrom(this),b},d.prototype.copyFrom=function(b){this.update(b.source,b.target,b.settings)},d.prototype.update=function(b,d,k){this.source!==b&&this.source.copyFrom(b);this.target!==d&&this.target.copyFrom(d);this.settings.desiredScreenFlow=null!=k.desiredScreenFlow?k.desiredScreenFlow:h.defaultSettings.desiredScreenFlow;this.compared=this.source.compareTo(this.target,this.compared);this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size;this.halfWindowSize=this.target.size/
2},d.prototype.halfWindowPanAtZoom=function(b){b=this.target.pixelsPerPanAtZoom(b);return this.halfWindowSize/b},Object.defineProperty(d.prototype,"hasZoom",{get:function(){return 1E-5<Math.abs(this.compared.sourceZoom-this.compared.targetZoom)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"hasPan",{get:function(){return 1E-9<this.compared.pan},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"hasRotate",{get:function(){return 1E-9<this.compared.rotate},enumerable:!0,
configurable:!0}),d}();l.Definition=m;l["default"]=m})},"esri/views/animation/pointToPoint/Settings":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.defaultSettings={desiredScreenFlow:2,minDuration:.5,maxDuration:8}})},"esri/views/animation/pointToPoint/apex/Path":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../easing ../Path ../Segment ./planning".split(" "),function(m,l,h,d,b,g,k){Object.defineProperty(l,
"__esModule",{value:!0});m=function(b){function a(a,c){var e=b.call(this)||this;return e._preallocSegments=[new g["default"],new g["default"],new g["default"]],e.update(a,c),e}return h(a,b),a.prototype.update=function(a,b){if(a){this.definition?this.definition.copyFrom(a):this.definition=a.clone();var c=null;b&&b.apex&&(c=k.optimalDistance(a,b.apex));this.segments.length=0;this._descensionSegment=this._ascensionSegment=null;null==c?this._updateWithoutApex():this._updateWithApex(c,b.apex)}},a.prototype.segmentInterpolateComponentsAt=
function(a,b,f){return f=a.interpolateComponentsAt(b,f),a===this._ascensionSegment?f.zoom=d.outQuad(f.zoom):a===this._descensionSegment&&(f.zoom=d.inQuad(f.zoom)),f},a.prototype._updateWithApex=function(a,b){var c=this._preallocSegments,e=c[0],d=c[1],c=c[2],f=null!=b.ascensionFactor?b.ascensionFactor:.5;b=Math.min(1-f,null!=b.ascensionFactor?b.descensionFactor:.5);var g=1-f-b;e.definition?e.definition.copyFrom(this.definition):e.definition=this.definition.clone();e.definition.compared.targetZoom=
a;e.definition.compared.pan=this.definition.compared.pan*f;e.definition.compared.rotate=this.definition.compared.rotate*f;e.update();this._ascensionSegment=e;this.segments.push(e);0<g&&(d.definition?d.definition.copyFrom(this.definition):d.definition=this.definition.clone(),d.definition.copyFrom(this.definition),d.definition.compared.sourceZoom=a,d.definition.compared.targetZoom=a,d.definition.compared.pan=this.definition.compared.pan*g,d.definition.compared.rotate=this.definition.compared.rotate*
g,d.update(),this.segments.push(d));c.definition?c.definition.copyFrom(this.definition):c.definition=this.definition.clone();c.definition.compared.sourceZoom=a;c.definition.compared.pan=this.definition.compared.pan*b;c.definition.compared.rotate=this.definition.compared.rotate*b;c.update();this._descensionSegment=c;this.segments.push(c)},a.prototype._updateWithoutApex=function(){var a=this._preallocSegments[0];a.update(this.definition);this.segments.push(a)},a}(b["default"]);l.Path=m;l["default"]=
m})},"esri/views/animation/pointToPoint/Path":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function h(){this.segments=[]}return Object.defineProperty(h.prototype,"time",{get:function(){return this.segments.reduce(function(d,b){return d+b.time},0)},enumerable:!0,configurable:!0}),h.prototype.interpolateComponentsAt=function(d,b){d=Math.min(Math.max(d,0),1);d*=this.time;for(var g=0,k=0,f=this.definition,a=0;a<this.segments.length;a++){var e=
this.segments[a],c=e.definition;if(d<=e.time||a===this.segments.length-1)return b=this.segmentInterpolateComponentsAt(e,d/e.time,b),f.hasPan?b.pan=(g+c.compared.pan*b.pan)/f.compared.pan:b.pan=1,f.hasRotate?b.rotate=(k+c.compared.rotate*b.rotate)/f.compared.rotate:b.rotate=1,d=b.zoom*(c.compared.targetZoom-c.compared.sourceZoom)+c.compared.sourceZoom,g=this.segments[0].definition.compared.sourceZoom,k=this.segments[this.segments.length-1].definition.compared.targetZoom,f.hasZoom?b.zoom=(d-g)/(k-g):
b.zoom=1,b;d-=e.time;g+=c.compared.pan;k+=c.compared.rotate}},h.prototype.segmentInterpolateComponentsAt=function(d,b,g){return d.interpolateComponentsAt(b,g)},h}();l.Path=m;l["default"]=m})},"esri/views/animation/pointToPoint/Segment":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function h(d){d&&this.update(d)}return h.prototype.update=function(d){d&&(this.definition?this.definition.copyFrom(d):this.definition=d.clone());this._updatePrecomputedVariables();
this._updatePixelFlow()},h.prototype._updatePrecomputedVariables=function(){var d=this.definition,b=d.compared,g=b.sourceZoom,k=b.targetZoom;this._sl=g>k?1:-1;this._panPixelsAtSource=b.pan*d.source.pixelsPerPanAtZoom(g);d=(d.source.pixelsPerRotateAtZoom(g)+d.target.pixelsPerRotateAtZoom(k))/2;this._rotatePixels=b.rotate*d},h.prototype._updatePixelFlow=function(){var d,b,g=this.definition.compared.sourceZoom,k=this.definition.compared.targetZoom,f=this.definition.hasZoom,a=this.definition.hasPan,e=
this.definition.hasRotate;d=a&&f?(k/g-1)/(-1/(this._sl*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource):0;b=f&&e?Math.log(g/k)/Math.LN2*this._sl*this.definition.halfWindowSize/this._rotatePixels:0;this._rotatePixelFlow=this._panPixelFlow=this._zoomPixelFlow=0;g=this.definition.desiredPixelFlow;f&&a&&e?(k=d+b+d*b,this._zoomPixelFlow=d*b/k*g,this._panPixelFlow=b/k*g,this._rotatePixelFlow=d/k*g):f&&a?(k=1+d,this._zoomPixelFlow=d/k*g,this._panPixelFlow=1/k*g):f&&e?(k=1+b,this._zoomPixelFlow=
b/k*g,this._rotatePixelFlow=1/k*g):a&&e?(d=this._panPixelsAtSource/this._rotatePixels,k=1+d,this._panPixelFlow=d/k*g,this._rotatePixelFlow=1/k*g):a?this._panPixelFlow=g:f?this._zoomPixelFlow=g:e&&(this._rotatePixelFlow=g);e?this.time=this.rotateTime:f?this.time=this.zoomTime:a?this.time=this.panTime:this.time=0},Object.defineProperty(h.prototype,"zoomTime",{get:function(){return this.definition.hasZoom?Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2*this._sl*
this.definition.halfWindowSize/this._zoomPixelFlow:0},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"panTime",{get:function(){if(this.definition.hasPan){if(this.definition.hasZoom){var d=-1/(this._sl*this.definition.halfWindowSize)*Math.LN2;return Math.log(this._zoomPixelFlow/this._panPixelFlow*this._panPixelsAtSource*d+1)/(d*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"rotateTime",
{get:function(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0},enumerable:!0,configurable:!0}),h.prototype._interpolateComponentsZoom=function(d){if(this.definition.hasZoom){var b=this.definition.compared.sourceZoom,g=this.definition.compared.targetZoom;return(b*Math.pow(b/g,-d)-b)/(g-b)}return d},h.prototype._interpolateComponentsPan=function(d){if(this.definition.hasPan&&this.definition.hasZoom){var b=-1/(this._sl*this.definition.halfWindowSize)*this._zoomPixelFlow;
return 1/this._panPixelsAtSource*this._panPixelFlow*(Math.pow(2,b*d*this.time)-1)/(b*Math.LN2)}return d},h.prototype._interpolateComponentsRotate=function(d){return d},h.prototype.interpolateComponentsAt=function(d,b){d=Math.min(Math.max(d,0),1);var g=this._interpolateComponentsZoom(d),k=this._interpolateComponentsPan(d);d=this._interpolateComponentsRotate(d);return b?(b.zoom=g,b.pan=k,b.rotate=d):b={zoom:g,pan:k,rotate:d},b},h}();l.Segment=m;l["default"]=m})},"esri/views/animation/pointToPoint/apex/planning":function(){define(["require",
"exports","./functions"],function(m,l,h){function d(b,d){var g=Math.max(b.compared.sourceZoom,b.compared.targetZoom);b=b.source.zoomAtPixelsPerPan(b.desiredPixelFlow/b.compared.pan)/2;return g>b?null!=d.maximumDistance?g+(d.maximumDistance-g)/2:1.5*g:d.maximumDistance?Math.min(d.maximumDistance,b):b}Object.defineProperty(l,"__esModule",{value:!0});l.optimalDistance=function(b,g){var k=d(b,g),f={ascensionFactor:null!=g.ascensionFactor?g.ascensionFactor:.5,descensionFactor:null!=g.descensionFactor?
g.descensionFactor:.5},a=0===f.ascensionFactor,e=0===f.descensionFactor,c=a?h.tAscensionZoomOnly:h.tAscensionZoomPan,l=a?h.dtAscensionZoomOnly:h.dtAscensionZoomPan,t=a?h.ddtAscensionZoomOnly:h.ddtAscensionZoomPan,r=e?h.tDescensionZoomOnly:h.tDescensionZoomPan,u=e?h.dtDescensionZoomOnly:h.dtDescensionZoomPan,m=e?h.ddtDescensionZoomOnly:h.ddtDescensionZoomPan,a=function(a){return c(b,f,a)+h.tPanion(b,f,a)+r(b,f,a)},e=function(a){return l(b,f,a)+h.dtPanion(b,f,a)+u(b,f,a)},x=function(a){return t(b,f,
a)+h.ddtPanion(b,f,a)+m(b,f,a)},y=a(k),n=h.tBaseLine(b),w=g.maximumIterations||20,z=null!=g.maximumDistance?g.maximumDistance:1/0;for(g=0;w>g;g++){var C=(e(k)+1E-6)/x(k);if(isNaN(C)||k>=z&&0>C){if(!isFinite(z))return null;k=z;y=a(k);break}if(k-=C,k<b.compared.sourceZoom||k<b.compared.targetZoom)return null;C=a(k);if(.005>=Math.abs(C-y)/y)break;y=C}return y>.7*n?null:k<b.compared.sourceZoom||k<b.compared.targetZoom?null:k}})},"esri/views/animation/pointToPoint/apex/functions":function(){define(["require",
"exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.tAscensionZoomPan=function(h,d,b){var g=h.halfWindowPanAtZoom(b-h.compared.sourceZoom);return-h.halfWindowSize*(d.ascensionFactor*Math.LN2*h.compared.pan+g)*Math.log(h.compared.sourceZoom/b)/(h.desiredPixelFlow*Math.LN2*g)};l.dtAscensionZoomPan=function(h,d,b){var g=1/b,k=Math.log(h.compared.sourceZoom*g),f=1/h.desiredPixelFlow,a=1/Math.LN2;b-=h.compared.sourceZoom;var e=1/b;d=(d.ascensionFactor*Math.LN2*h.compared.pan+h.halfWindowPanAtZoom(b))/
h.halfWindowPanAtZoom(1);return h.halfWindowSize*g*f*a*e*d-h.halfWindowSize*k*f*a*e+h.halfWindowSize*k*f*a*d/(b*b)};l.ddtAscensionZoomPan=function(h,d,b){var g=b-h.compared.sourceZoom,k=1/g,f=1/b,a=Math.log(h.compared.sourceZoom*f);d=(d.ascensionFactor*Math.LN2*h.compared.pan+h.halfWindowPanAtZoom(g))/h.halfWindowPanAtZoom(1);return h.halfWindowSize*k*(-2*k*f*d+2*k*a+2*f-2*a*d/(g*g)-d/(b*b))/(h.desiredPixelFlow*Math.LN2)};l.tAscensionZoomOnly=function(h,d,b){return-h.halfWindowSize*Math.log(h.compared.sourceZoom/
b)/(h.desiredPixelFlow*Math.LN2)};l.dtAscensionZoomOnly=function(h,d,b){return h.halfWindowSize/(b*h.desiredPixelFlow*Math.LN2)};l.ddtAscensionZoomOnly=function(h,d,b){return-h.halfWindowSize/(b*b*h.desiredPixelFlow*Math.LN2)};l.tPanion=function(h,d,b){return-h.compared.pan*h.halfWindowSize*(d.ascensionFactor+d.descensionFactor-1)/(h.desiredPixelFlow*h.halfWindowPanAtZoom(b))};l.dtPanion=function(h,d,b){return h.compared.pan*h.halfWindowSize*(d.ascensionFactor+d.descensionFactor-1)/(h.desiredPixelFlow*
h.halfWindowPanAtZoom(b*b))};l.ddtPanion=function(h,d,b){return-2*h.compared.pan*h.halfWindowSize*(d.ascensionFactor+d.descensionFactor-1)/(h.desiredPixelFlow*h.halfWindowPanAtZoom(b*b*b))};l.tDescensionZoomPan=function(h,d,b){return h.halfWindowSize*(-h.halfWindowPanAtZoom(b)-d.descensionFactor*Math.LN2*h.compared.pan+h.halfWindowPanAtZoom(h.compared.targetZoom))*Math.log(b/h.compared.targetZoom)/(h.desiredPixelFlow*Math.LN2*h.halfWindowPanAtZoom(-b+h.compared.targetZoom))};l.dtDescensionZoomPan=
function(h,d,b){var g=Math.log(b/h.compared.targetZoom),k=1/h.desiredPixelFlow,f=1/Math.LN2,a=-b+h.compared.targetZoom,e=1/a;d=(-h.halfWindowPanAtZoom(b)-d.descensionFactor*Math.LN2*h.compared.pan+h.halfWindowPanAtZoom(h.compared.targetZoom))/h.halfWindowPanAtZoom(1);return-h.halfWindowSize*g*k*f*e+h.halfWindowSize*g*k*f*d/(a*a)+h.halfWindowSize*k*f*e*d/b};l.ddtDescensionZoomPan=function(h,d,b){var g=b-h.compared.targetZoom,k=1/g,f=1/b,a=Math.log(b/h.compared.targetZoom);d=(h.halfWindowPanAtZoom(b)+
d.descensionFactor*Math.LN2*h.compared.pan-h.halfWindowPanAtZoom(h.compared.targetZoom))/h.halfWindowPanAtZoom(1);return h.halfWindowSize*k*(-2*k*f*d-2*k*a+2*f+2*a*d/(g*g)-d/(b*b))/(h.desiredPixelFlow*Math.LN2)};l.tDescensionZoomOnly=function(h,d,b){return h.halfWindowSize*Math.log(b/h.compared.targetZoom)/(h.desiredPixelFlow*Math.LN2)};l.dtDescensionZoomOnly=function(h,d,b){return h.halfWindowSize/(b*h.desiredPixelFlow*Math.LN2)};l.ddtDescensionZoomOnly=function(h,d,b){return-h.halfWindowSize/(b*
b*h.desiredPixelFlow*Math.LN2)};l.tBaseLine=function(h){var d=Math.LN2*h.compared.pan,b=h.halfWindowPanAtZoom(h.compared.sourceZoom-h.compared.targetZoom),g=h.halfWindowSize*Math.log(h.compared.sourceZoom/h.compared.targetZoom)/(h.desiredPixelFlow*Math.LN2*b);return h.compared.sourceZoom<=h.compared.targetZoom?g*(d-b):g*(d+b)}})},"esri/views/3d/animation/pointToPoint/Camera":function(){define(["require","exports","../../lib/glMatrix","../../support/mathUtils"],function(m,l,h,d){Object.defineProperty(l,
"__esModule",{value:!0});var b=d.angle,g=d.lerp,k=d.slerpOrLerp,f=h.vec3d,a=h.mat3d,e=f.create(),c=f.create(),q=f.create(),t=f.create(),r=f.create(),u=f.create(),v=f.createFrom(0,0,1),x=f.createFrom(0,1,0),y=f.createFrom(1,0,0),n=a.create();m=function(){function d(a){void 0===a&&(a="global");this.viewingMode=a;this.center=f.create();this.distance=this.yaw=this.pitch=0;this.lookAtDirection=f.create(x)}return d.prototype.pixelsPerPanAtZoom=function(a){return this.size/2/(this._zoomToPanScale*a)},d.prototype.zoomAtPixelsPerPan=
function(a){return this.size/2/(this._zoomToPanScale*a)},d.prototype.pixelsPerRotateAtZoom=function(a){return this.size/2/Math.max(Math.cos(Math.abs(this.pitch)),.5)},d.prototype.compareTo=function(a,c){if(c||(c={pan:0,rotate:0,sourceZoom:0,targetZoom:0}),"global"===this.viewingMode){var e=f.length(this.center),d=f.length(a.center),e=(e+d)/2;c.pan=b(this.center,a.center)*e}else c.pan=f.dist(this.center,a.center);e=Math.abs(a.yaw-this.yaw);e>=Math.PI&&(e=2*Math.PI-e);return c.rotate=Math.max(e,Math.abs(a.pitch-
this.pitch)),c.sourceZoom=this.distance,c.targetZoom=a.distance,c},d.prototype.interpolate=function(a,b,c){"global"===this.viewingMode?k(a.center,b.center,c.pan,this.center,w):f.lerp(a.center,b.center,c.pan,this.center);this.distance=g(a.distance,b.distance,c.zoom);this.pitch=g(a.pitch,b.pitch,c.rotate);a=a.yaw;b=b.yaw;Math.abs(b-a)>=Math.PI&&(a+=2*(b>a?1:-1)*Math.PI);this.yaw=g(a,b,c.rotate)},d.prototype.copyFrom=function(a){f.set(a.center,this.center);this.pitch=a.pitch;this.yaw=a.yaw;this.distance=
a.distance;f.set(a.lookAtDirection,this.lookAtDirection);this.size=a.size;this.copyFromCommon(a);this.viewingMode=a.viewingMode},d.prototype.copyFromRenderCamera=function(b){var c=this._lookAtOrientation(b.center,n);f.set(b.center,this.center);a.multiplyVec3(c,f.subtract(b.center,b.eye,t));a.multiplyVec3(c,b.up,r);this.distance=f.length(t);t[0]/=this.distance;t[1]/=this.distance;t[2]/=this.distance;this.pitch=this._eyeUpToPitch(t,r);this.yaw=this._eyeUpToYaw(t,r);this.size=Math.sqrt(b.width*b.width+
b.height*b.height);this.copyFromCommon(b)},d.prototype.copyFromCommon=function(a){this.fov=a.fov;this._zoomToPanScale=Math.atan(.5*this.fov)},d.prototype.copyToRenderCamera=function(b){var c=this._lookAtOrientation(this.center,n);a.transpose(c);this._axisAngleVec3(y,this.pitch-Math.PI/2,x,t);this._axisAngleVec3(v,this.yaw,t);this._axisAngleVec3(y,this.pitch-Math.PI/2,v,r);this._axisAngleVec3(v,this.yaw,r);f.scale(t,this.distance);a.multiplyVec3(c,t);a.multiplyVec3(c,r);b.center=this.center;b.eye=
f.subtract(this.center,t,t);b.up=r},d.prototype._axisAngleVec3=function(a,b,d,g){void 0===g&&(g=d);var k=Math.cos(b);b=Math.sin(b);return f.scale(d,k,e),f.scale(f.cross(a,d,c),b),f.scale(a,(1-k)*f.dot(a,d),q),f.add(f.add(e,c,g),q,g)},d.prototype._lookAtOrientation=function(b,d){return this._upAtLookAt(b,q),f.normalize(f.cross(this.lookAtDirection,q,e)),0===e[0]&&0===e[1]&&0===e[2]&&f.set(y,e),f.normalize(f.cross(q,e,c)),d||(d=a.create()),d[0]=e[0],d[1]=c[0],d[2]=q[0],d[3]=e[1],d[4]=c[1],d[5]=q[1],
d[6]=e[2],d[7]=c[2],d[8]=q[2],d},d.prototype._upAtLookAt=function(a,b){return"local"===this.viewingMode?f.set(v,b):f.normalize(a,b)},d.prototype._eyeUpToPitch=function(a,c){return Math.PI-b(v,a)},d.prototype._eyeUpToYaw=function(a,e){return.5>Math.abs(e[2])?(f.set(e,u),0<a[2]&&f.scale(u,-1)):f.set(a,u),b(y,f.normalize(f.cross(u,v,c)),v)},d}();var w=1E-4;l["default"]=m})},"esri/views/3d/support/cameraUtils":function(){define("require exports dojo/_base/lang ../../../geometry/SpatialReference ../../../config ../../../geometry/Point ../../../geometry/support/webMercatorUtils ../../../Camera ../webgl-engine/lib/Camera ../lib/glMatrix ./mathUtils ./earthUtils ./projectionUtils ./cameraUtilsPlanar ./cameraUtilsSpherical ../camera/intersectionUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){function x(a){return"global"===a.viewingMode?u:r}function y(a,b,k){var h=a.renderSpatialReference,l=e.vec3d.set(b.viewForward,Q),l=C(a,b.eye,l,b.up,T);a=a.spatialReference||d.WGS84;return t.vectorToVector(b.eye,h,R,a)||(a=d.WGS84,t.vectorToVector(b.eye,h,R,a)),k?(k.position.x=R[0],k.position.y=R[1],k.position.z=R[2],k.position.spatialReference=a,k.heading=l.heading,k.tilt=l.tilt,k.fov=c.rad2deg(b.fov),k):new f(new g(R,a),l.heading,l.tilt,c.rad2deg(b.fov))}
function n(a,e,d){var f=a.state.camera,g=f.fovX,f=f.width/2;"global"===a.viewingMode&&null!=d&&(e*=Math.cos(c.deg2rad(d)));e/=a.renderCoordsHelper.unitInMeters;return f/(b.screenDPI*F/e)/Math.tan(g/2)}function w(a,e,d){var f=a.state.camera;e=b.screenDPI*F/(f.width/2/(e*Math.tan(f.fovX/2)));return"global"===a.viewingMode&&(e/=Math.cos(c.deg2rad(d))),e*=a.renderCoordsHelper.unitInMeters}function z(a,b,c,e,g,k){var h=a.renderSpatialReference;b=B(a,e.heading,e.tilt,b,c,g);return(a=t.vectorToPoint(b.eye,
h,a.spatialReference||d.WGS84))?k?(k.position=a,k.heading=b.heading,k.tilt=b.tilt,k.fov=e.fov,k):new f(a,b.heading,b.tilt,e.fov):null}function C(a,b,c,e,d){return x(a).directionToHeadingTilt(b,c,e,d)}function B(a,b,c,f,k,l){var n=e.vec3d.create(),p=a.renderSpatialReference;if(f)if(f instanceof g){var q=f;if(t.pointToVector(q,n,a.renderSpatialReference),null==q.z&&null!=a.basemapTerrain)q=a.basemapTerrain.getElevation(q),null!=q&&a.renderCoordsHelper.setAltitude(q,n)}else f&&e.vec3d.set(f,n);else e.vec3d.set(a.state.camera.center,
n);f&&f instanceof g||(f=t.vectorToPoint(n,p,a.spatialReference||d.WGS84));k=Math.max(k,a.state.constraints.minimumPoiDistance);p=c;c=k;if(!(q=l&&l.noReset))var q=f,r=a.engineToScreen(a.state.camera.center),u=a.toScreen(q),q=r.x-u.x,r=r.y-u.y,u=a.pointsOfInterest.centerOnSurfaceFrequent.distance,u=Math.log(Math.max(c,u)/Math.min(c,u))/Math.LN2,q=!(Math.sqrt(q*q+r*r)>G*Math.max(a.width,a.height)||u>N&&c>M);q?(p=x(a).eyeTiltToLookAtTilt(n,c,p),p=a.state.constraints.clampTilt(c,p),p=x(a).lookAtTiltToEyeTilt(n,
c,p)):(b=0,p=a.state.constraints.tilt(c).min);c=p;p=x(a).eyeForCenterWithHeadingTilt;b=p(n,k,b,c);n={eye:b.eye,up:b.up,center:n,heading:b.heading,tilt:b.tilt};if(b=!(l&&l.noReset||"global"!==a.viewingMode))b=a.renderCoordsHelper.fromRenderCoords(n.eye,O,a.spatialReference)?a.basemapTerrain&&(a.basemapTerrain.getElevation(O)||0)>O.z-1:!1;return b?(n=a.state.constraints.tilt(k).min,B(a,0,n,f,k,h.mixin({},l,{noReset:!0}))):n}Object.defineProperty(l,"__esModule",{value:!0});var F=39.37,G=5,N=8,M=8E5,
R=e.vec3d.create(),P=e.vec3d.create(),Q=e.vec3d.create(),T={heading:0,tilt:0},O=new g,S=new c.Cyclical(-2.0037508342788905E7,2.0037508342788905E7);l.externalToInternal=function(a,b){var d=a.renderSpatialReference,f=x(a).headingTiltToDirectionUp,g=e.vec3d.create();return t.pointToVector(b.position,g,d)?(d=f(g,b.heading,b.tilt),e.vec3d.add(d.direction,g),a=v.cameraOnContentAlongViewDirection(a,g,d.direction,d.up),a.fov=c.deg2rad(b.fov),a):null};l.internalToExternal=y;l.scaleToDistance=n;l.distanceToScale=
w;l.fromCenterScale=function(a,b,c,e,d,f){c=n(a,c,b.latitude);return z(a,b,c,e,d,f)};l.fromCenterDistance=z;l.directionToHeadingTilt=C;l.eyeHeadingTiltForCenterPointAtDistance=B;l.fromExtent=function(a,b,c,e,h,l){var n;h instanceof f?(l=h,n={noReset:!1}):n=h;var p,r="global"===a.viewingMode;h=a.renderSpatialReference;var u=a.spatialReference||d.WGS84,m=d.WebMercator,v=b.spatialReference||m,x=0;null!=b.zmax&&null!=b.zmin&&(p=(b.zmax+b.zmin)/2,x=b.zmax-b.zmin);if(r){var r=new g(b.xmin,b.ymin,v),w=new g(b.xmax,
b.ymax,v);if(r=k.project(r,m),w=k.project(w,m),null===r||null===w)return;b=new g(S.center(r.x,w.x),(w.y+r.y)/2,m);null!=p&&(b.z=p);p=q.getGreatCircleSpanAt(b,r,w);m=p.lon;v=p.lat;S.diff(r.x,w.x)>S.range/2&&(m+=q.halfEarthCircumference);m=Math.min(m,q.halfEarthCircumference);v=Math.min(v,q.halfEarthCircumference)}else k.canProject(b,u)&&(b=k.project(b,u)),m=b.xmax-b.xmin,v=b.ymax-b.ymin,b=new g({x:b.xmin+.5*m,y:b.ymin+.5*v,z:p,spatialReference:u});p=a.state.camera;c=B(a,c,e,b,Math.max(1/Math.tan(p.fovX/
2)*m*.5,1/Math.tan(p.fovY/2)*v*.5,1/Math.tan(p.fov/2)*x*.5)/1,n);return(e=t.vectorToPoint(c.eye,h,u))?(l||(l=new f),l.position=e,l.heading=c.heading,l.tilt=c.tilt,l.fov=a.camera.fov,l):null};l.toExtent=function(a,b,c,e,f){var g,k=a.renderSpatialReference;if(b||(c||(c=a.state.camera),b=y(a,c,f)),c)g=t.vectorToPoint(c.center,k,a.spatialReference||d.WGS84),f=c.distance;else{if(g=a.toMap(a.screenCenter),!g)return null;f=q.computeCarthesianDistance(b.position,g)}c||(c=a.state.camera);b=2*f*Math.tan(c.fovX/
2)*1;c=2*f*Math.tan(c.fovY/2)*1;return"global"===a.viewingMode?u.toExtent(a,g,b,c,e):r.toExtent(a,g,b,c,e)};l.scaleToZoom=function(a,b){return(a=a.basemapTerrain&&a.basemapTerrain.tilingScheme)?a.levelAtScale(b):void 0};l.zoomToScale=function(a,b){return(a=a.basemapTerrain&&a.basemapTerrain.tilingScheme)?a.scaleAtLevel(b):void 0};l.computeScale=function(b,c,f){var g=b.renderSpatialReference;c||(c=b.state.camera);var k,h,l=d.WGS84;return c instanceof a?(t.vectorToVector(c.center,g,P,l),k=P[1],h=c.distance):
(k=c.position.latitude,t.pointToVector(c.position,R,g),t.pointToVector(f,P,g),h=e.vec3d.dist(R,P)),w(b,h,k)}})},"esri/views/3d/support/cameraUtilsPlanar":function(){define("require exports ../../../geometry/Extent ./mathUtils ./projectionUtils ./cameraUtilsInternal ../lib/glMatrix".split(" "),function(m,l,h,d,b,g,k){function f(b,f,g){b=k.vec3d.create();var h=k.vec3d.create();return k.mat4d.identity(c),k.mat4d.rotateZ(c,-d.deg2rad(f)),k.mat4d.rotateX(c,d.deg2rad(g)),k.mat4d.multiplyVec3(c,e,b),k.vec3d.scale(b,
-1),k.mat4d.multiplyVec3(c,a,h),{direction:b,up:h}}Object.defineProperty(l,"__esModule",{value:!0});var a=k.vec3d.createFrom(0,1,0),e=k.vec3d.createFrom(0,0,1),c=k.mat4d.create(),q=k.vec3d.create(),t=k.vec3d.create();l.headingTiltToDirectionUp=f;l.directionToHeadingTilt=function(b,c,d,f){return g.directionToHeadingTilt(c,d,f,e,a)};l.eyeForCenterWithHeadingTilt=function(a,b,c,e){var d=f(a,c,e);a=k.vec3d.add(k.vec3d.scale(d.direction,-b,k.vec3d.create()),a);return{up:d.up,eye:a,heading:c,tilt:e}};l.lookAtTiltToEyeTilt=
function(a,b,c){return d.rad2deg(c)};l.eyeTiltToLookAtTilt=function(a,b,c){return d.deg2rad(c)};l.toExtent=function(a,c,e,d,f){var g=a.renderSpatialReference;a=a.map&&a.spatialReference||c.spatialReference;return b.pointToVector(c,q,g),b.pointToVector(c,t,g),q[0]-=e/2,t[0]+=e/2,q[1]-=d/2,t[1]+=d/2,b.vectorToVector(q,g,q,a),b.vectorToVector(t,g,t,a),f?(f.xmin=q[0],f.ymin=q[1],f.xmax=t[0],f.ymax=t[1],f.spatialReference=a):f=new h(q[0],q[1],t[0],t[1],a),f}})},"esri/views/3d/support/cameraUtilsInternal":function(){define(["require",
"exports","./mathUtils","../lib/glMatrix"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});var b=d.vec3d.create(),g=d.vec3d.create();l.directionToHeadingTilt=function(k,f,a,e,c){var l=b;d.vec3d.normalize(k,l);var t=d.vec3d.dot(l,e),r=0<t,t=Math.abs(t);.99<t&&(t=Math.abs(d.vec3d.dot(f,e)),.99>t?(d.vec3d.set(f,l),r&&d.vec3d.scale(l,-1)):l=null);f=0;l&&(d.vec3d.scale(e,d.vec3d.dot(e,l),g),d.vec3d.subtract(l,g),f=d.vec3d.dot(l,c)/(d.vec3d.length(l)*d.vec3d.length(c)),d.vec3d.cross(l,
c,g),f=(0<d.vec3d.dot(g,e)?1:-1)*h.rad2deg(h.acos(f)));k=h.rad2deg(h.acos(-d.vec3d.dot(e,k)/d.vec3d.length(k)));return a?(a.heading=f,a.tilt=k,a):{heading:f,tilt:k}}})},"esri/views/3d/support/cameraUtilsSpherical":function(){define("require exports ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/support/webMercatorUtils ./mathUtils ./earthUtils ./cameraUtilsInternal ../lib/glMatrix".split(" "),function(m,l,h,d,b,g,k,f,a){function e(b,c,e){var d=a.vec3d.create(),f=a.vec3d.create();
return a.vec3d.cross(b,t,x),0===a.vec3d.dot(x,x)&&a.vec3d.cross(b,r,x),a.mat4d.identity(v),a.mat4d.rotate(v,-g.deg2rad(c),b),a.mat4d.rotate(v,-g.deg2rad(e),x),a.vec3d.cross(x,b,f),a.vec3d.normalize(f),a.mat4d.multiplyVec3(v,f),a.vec3d.normalize(b,d),a.mat4d.multiplyVec3(v,a.vec3d.negate(d)),{direction:d,up:f}}function c(a){var b=a[1];a[1]=-a[2];a[2]=b}function q(a,b){b=e(b,a.heading,a.tilt);return a.up=b.up,a}Object.defineProperty(l,"__esModule",{value:!0});var t=a.vec3d.createFrom(0,0,1),r=a.vec3d.normalize(a.vec3d.createFrom(1,
1,1)),u=new g.Cyclical(-180,180),v=a.mat4d.create(),x=a.vec3d.create(),y=a.vec3d.create();l.headingTiltToDirectionUp=e;l.directionToHeadingTilt=function(b,c,e,d){var g=x;return a.vec3d.normalize(b,g),a.vec3d.cross(g,t,y),0===a.vec3d.dot(y,y)&&a.vec3d.cross(g,r,y),a.vec3d.cross(y,g,y),f.directionToHeadingTilt(c,e,d,g,y)};l.eyeForCenterWithHeadingTilt=function(b,e,d,f){var k={eye:a.vec3d.create(),up:null,tilt:f,heading:d},h=x;h[0]=b[0];h[1]=b[2];h[2]=-b[1];var l;d=g.deg2rad(d);l=g.deg2rad(f);f=Math.sin(d);
d=Math.cos(d);var n=Math.sin(l),r=Math.cos(l),u=a.vec3d.length(h);if(1E-8>Math.abs(l))l=e+u;else{var t=u/n,m=g.asin(e/t);l=t*Math.sin(Math.PI-l-m)}var t=n*e,r=r*e,m=d*t,v=l-r,w=v*v,y=e*e*n*n,n=d*d*y,y=f*f*y,z=h[1]*v,C=n*(n+w-h[1]*h[1]);if(0>C)return a.vec3d.scale(h,l/u,k.eye),k.tilt=0,k;var W=Math.sqrt(C),C=n+w;if(z=0<d?-W+z:W+z,1E-8>Math.abs(C))return 1E-8>u?(k.eye[0]=0,k.eye[1]=0,k.eye[2]=e):a.vec3d.scale(h,l/u,k.eye),k.tilt=0,c(k.eye),q(k,b);k.eye[1]=z/C;C=k.eye[1]*k.eye[1];e=1-C;z=Math.sqrt(e);
m=n*C+y-2*m*k.eye[1]*z*v+e*w;return 1E-8>Math.abs(m)?(a.vec3d.scale(h,l/u,k.eye),k.tilt=0,c(k.eye),q(k,b)):(k.eye[0]=(e*(l*h[0]-r*h[0])-t*z*(h[0]*k.eye[1]*d+h[2]*f))/m,k.eye[2]=(e*(l*h[2]-r*h[2])-t*z*(h[2]*k.eye[1]*d-h[0]*f))/m,a.vec3d.scale(k.eye,l),c(k.eye),q(k,b))};l.lookAtTiltToEyeTilt=function(b,c,e){b=a.vec3d.length(b);c=g.asin(c/(Math.sqrt(c*c+b*b-2*c*b*Math.cos(Math.PI-e))/Math.sin(e)));return g.rad2deg(e-c)};l.eyeTiltToLookAtTilt=function(b,c,e){e=g.deg2rad(e);b=a.vec3d.length(b);return g.asin(c/
(b/Math.sin(e)))+e};l.toExtent=function(a,c,e,f,l){function n(a){var b=Math.PI/2;return a=g.cyclical2PI.normalize(a,-b),a>b&&(a=Math.PI-a),a}var q,r,t=c.latitude;c=c.longitude;var m=k.getLonDeltaForDistance(c,t,e)/2;e=c-m;c+=m;var m=g.deg2rad(t),t=k.earthRadius,m=(1+Math.sin(m))/(1-Math.sin(m)),v=(m+1)*Math.tan(f/t/2);if(q=1.5*Math.PI-2*Math.atan(.5*(v+Math.sqrt(4*m+v*v))),r=q+f/t,q=n(q),r=n(r),q>r)q=r=q;if(q=Math.max(g.rad2deg(q),-90),r=Math.min(g.rad2deg(r),90),c=u.monotonic(e,c),180<c-e)f=(c-e-
180)/2,e+=f,c-=f;return l?(l.xmin=e,l.ymin=q,l.xmax=c,l.ymax=r,l.spatialReference=h.WGS84):l=new d(e,q,c,r,h.WGS84),a.spatialReference&&a.spatialReference.isWebMercator&&b.geographicToWebMercator(l,!1,l),l}})},"esri/views/3d/camera/intersectionUtils":function(){define("require exports ../../../geometry/Point ../lib/glMatrix ../support/aaBoundingRect ../support/earthUtils ../webgl-engine/lib/Selector".split(" "),function(m,l,h,d,b,g,k){function f(b,c,e,f){void 0===f&&(f=d.vec3d.create());var h=a[b.viewingMode];
h||(h=new k(b.viewingMode),h.enableBackfacesTerrain=!b.state.isGlobal,h.enableInvisibleTerrain=!0,a[b.viewingMode]=h);b._stage.pickRay(c,e,null,null,null,null,h);if((h=h.getMinResult())&&h.getIntersectionPoint(f))return f;h=d.vec3d.direction(e,c,t);if(!b.renderCoordsHelper.intersectManifold(c,h,0,f))if("global"===b.viewingMode){b=f;var h=d.vec3d.dot(c,c),l=g.earthRadius*g.earthRadius,h=h>l?Math.sqrt(h-l)/3:1;d.vec3d.subtract(e,c,b);d.vec3d.scale(b,h/d.vec3d.length(b),b);d.vec3d.add(b,c)}else e!==
f&&d.vec3d.set(e,f);return f}Object.defineProperty(l,"__esModule",{value:!0});l.eyeWithinExtent=function(a,c,d,f){return a.renderCoordsHelper.fromRenderCoords(c.eye,e,f)&&b.containsPoint(d,e)};l.surfaceElevationBelowEye=function(a,b){return a.renderCoordsHelper.fromRenderCoords(b.eye,q,a.basemapTerrain.spatialReference)?a.basemapTerrain.getElevation(q)||0:0};l.cameraOnContentAlongViewDirection=function(a,b,e,g){var k=a.state.camera.copy();b&&(k.eye=b);e&&(k.center=e);g&&(k.up=g);f(a,k.eye,k.center,
c);e=a.state.constraints;g=e.minimumPoiDistance;d.vec3d.dist2(k.eye,c)<g&&(b=e.collision.enabled,d.vec3d.set(k.viewForward,t),d.vec3d.scale(t,g),b?d.vec3d.subtract(c,t,k.eye):d.vec3d.add(k.eye,t,c),a=a.renderCoordsHelper,g=a.getAltitude(k.eye),e=e.collision.elevationMargin,b&&e>g&&(d.vec3d.subtract(c,k.eye,t),a.setAltitude(e,k.eye),d.vec3d.add(k.eye,t,c)));return k.center=c,k};l.contentAlongViewDirection=f;var a={},e=d.vec3d.create(),c=d.vec3d.create(),q=new h,t=d.vec3d.create()})},"esri/views/3d/webgl-engine/lib/Selector":function(){define("require exports dojo/has ./PerformanceTimer ./gl-matrix ./Object3D".split(" "),
function(m,l,h,d,b,g){var k=b.vec3d.create(),f=b.vec3d.create(),a=h("dojo-debug-messages");m=function(){function g(f,g,k,h,l,q,n,m){void 0===m&&(m=!1);this.dir=b.vec3d.create();this.normalDir=null;this.minResult=new e;this.maxResult=new e;this.transform=b.mat4d.create();this._transformInverse=new c({value:this.transform},b.mat4d.inverse,b.mat4d.create);this._transformInverseTranspose=new c(this._transformInverse,b.mat4d.transpose,b.mat4d.create);this._transformTranspose=new c({value:this.transform},
b.mat4d.transpose,b.mat4d.create);this._transformInverseRotation=new c({value:this.transform},b.mat4d.toInverseMat3,b.mat3d.create);this.enableTerrain=this.enableHUDSelection=!0;this.enableInvisibleTerrain=!1;this.enableBackfacesTerrain=!0;this.performanceInfo={queryDuration:0,numObjectsTested:0};this.viewingMode=f||"global";this.intersectObject=this.intersectObject.bind(this);a&&(this.timer=new d(1));this.init(g,k,h,l,q,n,m)}return g.prototype.init=function(c,e,d,f,g,k,h){if(e&&d&&b.vec3d.subtract(d,
e,this.dir),this.minResult.init(e,d),this.maxResult.init(e,d),this.numObjectsTested=0,this.point=f,this.camera=g,this.isSelection=h,this.layers=c,this.p0=e,this.p1=d,this.hudResults=[],null==k&&(k=1E-5),this.tolerance=k,this.layers){a&&this.timer.start();for(c=0;c<this.layers.length;++c)if(e=this.layers[c],d=e.getSpatialQueryAccelerator?e.getSpatialQueryAccelerator():void 0)d.forEachAlongRay(this.p0,this.dir,this.intersectObject);else for(e=e.getObjects(),d=0;d<e.length;++d)this.intersectObject(e[d]);
a&&(this.timer.stop(),this.performanceInfo.queryDuration=this.timer.getLast(),this.performanceInfo.numObjectsTested=this.numObjectsTested)}},Object.defineProperty(g.prototype,"transformInverse",{get:function(){return this._transformInverse.value},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"transformInverseTranspose",{get:function(){return this._transformInverseTranspose.value},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"transformInverseRotation",{get:function(){return this._transformInverseRotation.value},
enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"transformTranspose",{get:function(){return this._transformTranspose.value},enumerable:!0,configurable:!0}),g.prototype.getDirection=function(){return this.normalDir||(this.normalDir=b.vec3d.create(),b.vec3d.normalize(this.dir,this.normalDir)),this.normalDir},g.prototype.intersectObject=function(a){var c=this;this.numObjectsTested++;for(var d,g=a.getId(),h=a.getGeometryRecords(),l=a.objectTransformation,n=0;n<h.length;n++){var q=h[n],
t=q.geometry,m=q.materials,B=q.instanceParameters;d=t.getId();b.mat4d.set(l,this.transform);b.mat4d.multiply(this.transform,q.getShaderTransformation());this._transformInverse.invalidate();this._transformInverseTranspose.invalidate();this._transformTranspose.invalidate();this._transformInverseRotation.invalidate();b.mat4d.multiplyVec3(this.transformInverse,this.p0,k);b.mat4d.multiplyVec3(this.transformInverse,this.p1,f);m[0].intersect(t,B,this.transform,this,k,f,function(b,f,k,h,l,n){0<=b&&(l?(l=
new e,l.init(c.p0,c.p1),l.set(a,g,b,f,h,n,d,k),c.hudResults.push(l)):((null==c.minResult.priority||h>=c.minResult.priority)&&(null==c.minResult.dist||b<c.minResult.dist)&&c.minResult.set(a,g,b,f,h,null,d,k),(null==c.maxResult.priority||h>=c.maxResult.priority)&&(null==c.maxResult.dist||b>c.maxResult.dist)&&c.maxResult.set(a,g,b,f,h,null,d,k)))},q.customTransformation)}},g.prototype.getMinResult=function(){return this.minResult},g.prototype.getMaxResult=function(){return this.maxResult},g.prototype.getHudResults=
function(){return this.hudResults},g.DEFAULT_TOLERANCE=1E-5,g}();var e=function(){function a(a,c){this.normal=b.vec3d.create();this.init(a,c)}return a.prototype.getIntersectionPoint=function(a){return null==this.dist?!1:(b.vec3d.lerp(this.p0,this.p1,this.dist,a),!0)},a.prototype.set=function(a,c,e,d,f,k,h,l){this.dist=e;b.vec3d.set(d,this.normal);a?this.targetType=a instanceof g?"StageObject":"StagePoint":this.targetType="None";this.target=a;this.name=c;this.priority=f;this.center=k?b.vec3d.create(k):
null;this.geometryId=h;this.triangleNr=l},a.prototype.copyFrom=function(a){this.p0=a.p0;this.p1=a.p1;this.dist=a.dist;this.targetType=a.targetType;this.target=a.target;this.name=a.name;this.priority=a.priority;this.center=a.center?b.vec3d.create(a.center):null;this.geometryId=a.geometryId;this.triangleNr=a.triangleNr;this.intersector=a.intersector;b.vec3d.set(a.normal,this.normal)},a.prototype.setIntersector=function(a){this.intersector=a},a.prototype.init=function(a,b){this.dist=void 0;this.targetType=
"None";this.priority=this.name=this.target=void 0;this.triangleNr=this.geometryId=this.center=null;this.intersector="stage";this.p0=a;this.p1=b},a}(),c=function(){function a(a,b,c){this.original=a;this.update=b;this.dirty=!0;this.transform=c()}return a.prototype.invalidate=function(){this.dirty=!0},Object.defineProperty(a.prototype,"value",{get:function(){return this.dirty&&(this.update(this.original.value,this.transform),this.dirty=!1),this.transform},enumerable:!0,configurable:!0}),a}();return m})},
"esri/views/3d/webgl-engine/lib/PerformanceTimer":function(){define(["require","exports","./Util"],function(m,l,h){return function(){function d(b){this._filterSampleIndex=0;this._lastTime=NaN;this._numMeasurements=this._totalTime=0;this._filterSamples=Array(b);this.reset();this._filterSize=b}return d.prototype.reset=function(){for(var b=this._filterSampleIndex=0;b<this._filterSize;b++)this._filterSamples[b]=NaN},d.prototype.start=function(){this._tsStart=h.performance.now()},d.prototype.stop=function(){return this._lastTime=
h.performance.now()-this._tsStart,this._totalTime+=this._lastTime,this._numMeasurements++,this._filterSize&&(this._filterSamples[this._filterSampleIndex]=this._lastTime,this._filterSampleIndex=(this._filterSampleIndex+1)%this._filterSize),this._lastTime},d.prototype.getLast=function(){return this._lastTime},d.prototype.getLastFiltered=function(){for(var b=0,d=0;d<this._filterSamples.length;d++)b+=this._filterSamples[d];return b/this._filterSamples.length},d.prototype.getAverage=function(){return this._totalTime/
this._numMeasurements},d.prototype.getTotal=function(){return this._totalTime},d.prototype.getNumMeasurements=function(){return this._numMeasurements},d}()})},"esri/views/3d/webgl-engine/lib/Object3D":function(){define("require exports ./IdGen ./Util ./gl-matrix ./ComponentUtils ./HighlightUtils ./ModelContentType ./GeometryRecord".split(" "),function(m,l,h,d,b,g,k,f,a){var e=d.assert,c=b.mat4d,q=b.vec3d,t=c.identity();m=function(){function b(a){void 0===a&&(a={});this._bvObjectSpace=new r;this._bvWorldSpace=
new r;this._bvDirty=!0;this._hasVolatileTransformation=!1;this.id=b._idGen.gen(a.idHint);this.name=a.name;this.castShadow=null!=a.castShadow?a.castShadow:!0;this.metadata=a.metadata;this.objectTransformation=c.identity();this._initializeGeometryRecords(a.geometries,a.materials,a.transformations)}return b.prototype._initializeGeometryRecords=function(b,d,f){if(!Array.isArray(b))return this.geometryRecords=[],void(this.geometries=[]);e(d.length===b.length,"Object3D: materials don't match geometries");
e(f.length===b.length,"Object3D: transformations don't match geometries");this.geometryRecords=Array(b.length);this.geometries=b.slice();for(var g=0;g<b.length;g++)e(Array.isArray(d[g]),"Object3D: materials parameter must be array of array"),this.geometryRecords[g]=new a(b[g],d[g].slice(),c.create(f[g]),{});this._hasVolatileTransformation=!1},b.prototype.getId=function(){return this.id},Object.defineProperty(b.prototype,"parentLayer",{get:function(){return this._parentLayer},set:function(a){e(null==
this._parentLayer||null==a,"Object3D can only be added to a single Layer");this._parentLayer=a},enumerable:!0,configurable:!0}),b.prototype.getParentLayer=function(){return this.parentLayer},b.prototype.addParentLayer=function(a){this.parentLayer=a},b.prototype.removeParentLayer=function(a){this.parentLayer=null},b.prototype.getNumGeometryRecords=function(){return this.geometryRecords.length},b.prototype.getFirstGeometryIndex=function(a){a=this.geometries.indexOf(a);return e(-1<a,"Object3D.getFirstGeometryIndex: geometry not found"),
a},b.prototype.findGeometryRecords=function(a){for(var b=[],c=0;c<this.geometries.length;c++)this.geometries[c]===a&&b.push(this.geometryRecords[c]);return b},b.prototype.getGeometryRecord=function(a){return e(0<=a&&a<this.geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range"),this.geometryRecords[a]},b.prototype.getGeometryRecords=function(){return this.geometryRecords},b.prototype.addGeometry=function(b,d,f,g,k,h){void 0===f&&(f=t);e(Array.isArray(d),"Object3D.addGeometry: materials must be array");
this.geometries.push(b);b=new a(b,d.slice(),c.create(f),g||{},k,h);return this.geometryRecords.push(b),this._hasVolatileTransformation=this.geometryRecords.some(function(a){return!!a.customTransformation}),this._notifyDirty("objGeometryAdded",b),this._invalidateBoundingVolume(),b},b.prototype.hasGeometry=function(a){return-1<this.geometries.indexOf(a)},b.prototype.removeGeometry=function(a){var b=this.geometryRecords.splice(a,1)[0];return this._hasVolatileTransformation=this.geometryRecords.some(function(a){return!!a.customTransformation}),
this.geometries.splice(a,1),this._notifyDirty("objGeometryRemoved",b),this._invalidateBoundingVolume(),b},b.prototype.removeAllGeometries=function(){for(;0<this.getNumGeometryRecords();)this.removeGeometry(0)},b.prototype.geometryVertexAttrsUpdated=function(a){this._notifyDirty("vertexAttrsUpdated",this.geometryRecords[a]);this._invalidateBoundingVolume()},b.prototype.geometryColorAttrsUpdated=function(a){this._notifyDirty("colorAttrsUpdated",this.geometryRecords[a])},b.prototype.isAllHidden=function(){for(var a=
0,b=this.geometryRecords;a<b.length;a++){var c=b[a],e=c.instanceParameters.componentVisibilities,c=c.geometry.getData().componentOffsets;if(!g.isAllHidden(e,c))return!1}return!0},b.prototype.isAllVisible=function(){for(var a=0,b=this.geometryRecords;a<b.length;a++){var c=b[a],e=c.instanceParameters.componentVisibilities,c=c.geometry.getData().componentOffsets;if(!g.isAllVisible(e,c))return!1}return!0},b.prototype.hasComponents=function(){for(var a=!1,b=0;b<this.geometries.length&&!(a=this.geometries[b].getData(),
a=g.hasComponents(a.componentOffsets));b++);return a},b.prototype.setComponentVisibility=function(a,b,c){var e=a.instanceParameters.componentVisibilities,d=a.geometry.getData().componentOffsets;b=g.updateVisibility(e,d,b,c);a.instanceParameters.componentVisibilities=b;this._notifyDirty("componentVisibilityChanged",a)},b.prototype.getComponentVisibility=function(a,b){return g.getVisibility(a.instanceParameters.componentVisibilities,b)},b.prototype.hideAllComponents=function(){for(var a=0,b=this.geometryRecords;a<
b.length;a++){var c=b[a],e=g.hideAllComponents(c.instanceParameters.componentVisibilities);c.instanceParameters.componentVisibilities=e}this._notifyDirty("componentVisibilityChanged")},b.prototype.unhideAllComponents=function(){for(var a=0,b=this.geometryRecords;a<b.length;a++){var c=b[a],e=g.unhideAllComponents(c.instanceParameters.componentVisibilities);c.instanceParameters.componentVisibilities=e}this._notifyDirty("componentVisibilityChanged")},b.prototype._setComponentHighlight=function(a,b,c,
e){b=g.addHighlight(a.instanceParameters.componentHighlights,b,c,e);a.instanceParameters.componentHighlights=b},b.prototype.setComponentHighlight=function(a,b,c){var e=k.generateHighlightId();return this._setComponentHighlight(a,b,c,e),this._notifyDirty("componentHighlightChanged"),e},b.prototype.highlightAllComponents=function(a){for(var b=k.generateHighlightId(),c=0,e=this.geometryRecords;c<e.length;c++)this._setComponentHighlight(e[c],null,a,b);return this._notifyDirty("componentHighlightChanged"),
b},b.prototype.removeHighlights=function(a){for(var b=0,c=this.geometryRecords;b<c.length;b++){var e=c[b].instanceParameters,d=g.removeHighlight(e.componentHighlights,a);e.componentHighlights=d}this._notifyDirty("componentHighlightChanged")},b.prototype.getComponentFromTriangleNr=function(a,b){e(0<=a&&a<this.geometryRecords.length,"Object3d.getComponentFromTriangleNr: index out of range");a=this.geometryRecords[a].geometry.getData().componentOffsets;return g.componentFind(a,3*b)},b.prototype.setGeometryTransformation=
function(b,d){e(0<=b&&b<this.geometryRecords.length,"Object3d.setGeometryTransformation: index out of range");var f=this.geometryRecords[b];d=new a(f.geometry,f.materials,c.create(d),f.instanceParameters);this.geometryRecords[b]=d;this._notifyDirty("objGeometryReplaced",[f,d]);this._invalidateBoundingVolume()},b.prototype.getObjectTransformation=function(){return c.create(this.objectTransformation)},b.prototype.setObjectTransformation=function(a){c.set(a,this.objectTransformation);this._invalidateBoundingVolume();
this._notifyDirty("objTransformation")},b.prototype.getCombinedStaticTransformation=function(a,b){return b=b||c.create(),c.multiply(this.objectTransformation,a.getStaticTransformation(),b),b},b.prototype.getCombinedShaderTransformation=function(a,b){return b=b||c.create(),c.multiply(this.objectTransformation,a.getShaderTransformation(),b),b},b.prototype.hasVolativeTransformation=function(){return this._hasVolatileTransformation},b.prototype.getCastShadow=function(){return this.castShadow},b.prototype.setCastShadow=
function(a){this.castShadow=a},b.prototype.getMetadata=function(){return this.metadata},b.prototype.getName=function(){return this.name},b.prototype.getBBMin=function(a){return this._validateBoundingVolume(),a?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin},b.prototype.getBBMax=function(a){return this._validateBoundingVolume(),a?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax},b.prototype.getCenter=function(a){return this._validateBoundingVolume(),a?this._bvObjectSpace.center:this._bvWorldSpace.center},
b.prototype.getBSRadius=function(a){return this._validateBoundingVolume(),a?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius},b.prototype._validateBoundingVolume=function(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init();this._bvWorldSpace.init();for(var a=0;a<this.geometryRecords.length;++a){var b=this.geometries[a],e=this.geometryRecords[a],b=b.getBoundingInfo();this._calculateTransformedBoundingVolume(b,this._bvObjectSpace,e.getShaderTransformation());this._calculateTransformedBoundingVolume(b,
this._bvWorldSpace,this.getCombinedShaderTransformation(e))}q.lerp(this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5,this._bvObjectSpace.center);q.lerp(this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5,this._bvWorldSpace.center);for(var e=q.create(),d=q.create(),f=this._getScaleFactor(this.objectTransformation),a=0;a<this.geometryRecords.length;++a){var b=this.geometries[a],g=this.geometryRecords[a].getShaderTransformation(),k=this._getScaleFactor(g),b=b.getBoundingInfo();c.multiplyVec3(g,
b.getCenter(),e);g=q.dist(e,this._bvObjectSpace.center);b=b.getBSRadius()*k;this._bvObjectSpace.bsRadius=Math.max(this._bvObjectSpace.bsRadius,g+b);c.multiplyVec3(this.objectTransformation,e,d);k=q.dist(d,this._bvWorldSpace.center);this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,k+b*f)}this._bvDirty=!1}},b.prototype._calculateTransformedBoundingVolume=function(a,b,e){var d=a.getBBMin();a=a.getBBMax();for(var f=q.create(),g=q.create(),k=-1;3>k;++k){q.set(d,f);q.set(a,g);-1<k&&(f[k]=
a[k],g[k]=d[k]);c.multiplyVec3(e,f);c.multiplyVec3(e,g);for(var h=0;3>h;++h)b.bbMin[h]=Math.min(b.bbMin[h],f[h],g[h]),b.bbMax[h]=Math.max(b.bbMax[h],f[h],g[h])}},b.prototype._getScaleFactor=function(a){return Math.max(Math.max(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8]),Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])),Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))},b.prototype._invalidateBoundingVolume=function(){this._bvDirty=!0;this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace)},
b.prototype._notifyDirty=function(a,b,c,e){this._parentLayer&&(c=c||f.OBJECT,this._parentLayer.notifyDirty(a,b,c,e||this))},b._idGen=new h,b}();var r=function(){function a(){this.bbMin=q.create();this.bbMax=q.create();this.center=q.create();this.bsRadius=0}return a.prototype.init=function(){q.set3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,this.bbMin);q.set3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,this.bbMax);q.set3(0,0,0,this.center);this.bsRadius=0},a.prototype.getCenter=function(){return this.center},
a.prototype.getBSRadius=function(){return this.bsRadius},a}();return m})},"esri/views/3d/webgl-engine/lib/IdGen":function(){define(["require","exports"],function(m,l){return function(){function h(){this._count=0}return h.prototype.gen=function(d){return null==d&&(d="a"),d+"_"+this._count++},h}()})},"esri/views/3d/webgl-engine/lib/ComponentUtils":function(){define(["require","exports","../../../../core/arrayUtils"],function(m,l,h){function d(a,b){if(null!=a){var c=a.isVisibleBit,e=a.data,d=8*e.BYTES_PER_ELEMENT;
return e.length*d>b?t(c,e,b,d):!a.isVisibleBit}return!0}function b(a){return null===a.component?-1:a.component}function g(a,b,c,e,f){d(b,e)&&k(a,b,c,c[e],c[e+1]-1,f)}function k(a,b,c,e,d,f){c=(b=0<a.length?a[a.length-1]:null)?b.range[1]:-1;var g=b?b.options:null;c>=e||(c+1===e&&g===f?b.range[1]=d:a.push({range:[e,d],options:f}))}function f(a){return void 0===a&&(a=!0),{isVisibleBit:!a,data:new Uint32Array(0)}}function a(a,b){return c(a,b,!0)}function e(a,b){return c(a,b,!1)}function c(a,b,c){var e=
!1;a=a||u;e=a.isVisibleBit;a=a.data;b=r(b);var d=8*a.BYTES_PER_ELEMENT,f=a.length*d;c=c===e;if(0===a.length||0===b)e=!c;else if(b>f&&!c)e=!0;else{for(var g=v[d],f=v[0],k=0;k<a.length-1;k++)if(e=!c&&a[k]!==g||c&&a[k]!==f)return e;e=a.length-1;b=v[(b-1)%d+1];e=!c&&(a[e]&b)!==b||c&&(a[e]&b)!==f}return e}function q(a){return 0<a.length}function t(a,b,c,e){var d=c/e|0;return 0!==(b[d]&1<<c-d*e)===a}function r(a){return Math.max(0,a.length-1)}Object.defineProperty(l,"__esModule",{value:!0});l.updateVisibility=
function(a,b,c,e){if(c<r(b)){null==a&&(a=f());var d=a.isVisibleBit,g=a.data,k=8*g.BYTES_PER_ELEMENT,h=c/k|0,l=c-k*h;b=(r(b)-1)/k|0;var n=g;e=e===d;n.length*k>c||!e||(c=Math.max(h+1,Math.ceil(1.5*n.length)),c=Math.min(c,b+1),g=new Uint32Array(c),g.set(n));h<g.length&&(g[h]=g[h]&~(1<<l)|(e?1:0)<<l);a.data=g}return a};l.getVisibility=d;l.hideAllComponents=function(a){if(null==a)a=f(!1);else{a.isVisibleBit=!0;for(var b=0;b<a.data.length;b++)a.data[b]=0}return a};l.unhideAllComponents=function(a){var b;
if(null!=a)for(b=a,b.isVisibleBit=!1,a=0;a<b.data.length;a++)b.data[a]=0;return b};l.generateVisibleIndexRanges=function(a,b){var c;if(a)if(q(b))if(0===a.data.length)c=[],b=[[b[0],b[b.length-1]-1]],c=a.isVisibleBit?c:b;else{c=[];for(var e=a.isVisibleBit,d=a.data,f=8*d.BYTES_PER_ELEMENT,g=d.length*f,k=r(b),h=!1,l=0;g>l&&k>l;l++){var m=t(e,d,l,f);if(m!==h){var u=b[l];m?c.push([u,0]):(h=c[c.length-1],h[1]=u-1);h=m}}a=!a.isVisibleBit;k>g&&a&&!h?c.push([b[g],b[k]-1]):h&&(h=c[c.length-1],h[1]=b[a?k:Math.min(k,
g)]-1)}else c=[],c=a.isVisibleBit?c:null;else c=null;return c};l.addHighlight=function(a,c,e,d){a=a||[];c={component:c,options:e,id:d};a.push(c);c=b(c);for(e=a.length-1;0<e&&c<b(a[e-1]);)d=[a[e],a[e-1]],a[e-1]=d[0],a[e]=d[1],--e;return a};l.removeHighlight=function(a,b){return a?(a=a.filter(function(a){return a.id!==b}),0===a.length?null:a):a};l.generateHighlightedIndexRanges=function(a,b,c){if(b){if(q(c)){for(var d=c[0],f=c[c.length-1]-1,h=[],l=!e(a,c),n=0;n<b.length;++n){var m=b[n].options,t=b[n].component;
if(null!==t)g(h,a,c,t,m);else if(l)k(h,a,c,d,f,m);else for(t=0;t<r(c);++t)g(h,a,c,t,m)}return 0<h.length?h:null}return(l=!a||!a.isVisibleBit)?b.map(function(a){return{range:null,options:a.options}}):null}return null};l.defaultVisibilities=f;l.isAllVisible=function(a,b){return!e(a,b)};l.isAllHidden=function(b,c){return!a(b,c)};l.hasVisible=a;l.hasHidden=e;var u=f();l.createOffsets=function(a){return Array.isArray(a)?new Uint32Array(a):a};l.hasComponent=function(a,b){return b<r(a)};l.hasComponents=
q;var v=[];for(m=0;65>m;m++)v.push(Math.pow(2,m)-1);l.componentCount=r;l.componentFind=function(a,b){a=h.binaryIndexOf(a,b,!0);return 0<=a?a:null}})},"esri/views/3d/webgl-engine/lib/HighlightUtils":function(){define(["require","exports","./IdGen"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});var d=new h;l.generateHighlightId=function(){return d.gen("highlight")}})},"esri/views/3d/webgl-engine/lib/ModelContentType":function(){define(["require","exports"],function(m,l){return function(){function h(){}
return h.LAYER="layers",h.OBJECT="objects",h.GEOMETRY="geometries",h.MATERIAL="materials",h.TEXTURE="textures",h}()})},"esri/views/3d/webgl-engine/lib/GeometryRecord":function(){define(["require","exports","./IdGen"],function(m,l,h){return function(){function d(b,g,k,f,a,e){this.id=d._idGen.gen(b.getId());this.geometry=b;this.materials=g;this.transformation=k;this.instanceParameters=f;this.origin=a;this.customTransformation=e}return d.prototype.getId=function(){return this.id},d.prototype.getStaticTransformation=
function(){return this.transformation},d.prototype.getShaderTransformation=function(){return this.customTransformation?this.customTransformation(this.transformation):this.transformation},d._idGen=new h,d}()})},"esri/views/3d/support/viewpointUtils":function(){define("require exports ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/Extent ../../../geometry/Geometry ../../../geometry/support/webMercatorUtils ../../../core/Error ../../../core/promiseUtils ../../../Camera ../../../Viewpoint ../../../Graphic ../lib/glMatrix ./mathUtils ./projectionUtils ../camera/intersectionUtils ./cameraUtils ./aaBoundingBox ./aaBoundingRect ./intersectionUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w){function z(a){return 360-r.cyclicalDeg.normalize(a)}function C(a){return r.cyclicalDeg.normalize(360-a)}function B(a,b,c){if(!b)return null;var d=a.spatialReference||h.WGS84;if(b.camera){a=b.get("camera.position.spatialReference");if(!k.canProject(a,d))return null;b=b.camera.clone();return a.equals(d)||(b.position=k.project(b.position,d)),b}var f=b.get("targetGeometry.spatialReference");if(f&&!k.canProject(f,d))return null;var f=x.internalToExternal(a,
a.state.camera),g={noReset:!1};if(null!=b.rotation&&(f.heading=z(b.rotation),g.noReset=!0),null!=c&&(f.tilt=c),"point"===b.targetGeometry.type){c=b.targetGeometry;var l=void 0,n=b.targetGeometry.clone(),l=null!=b.scale?x.scaleToDistance(a,b.scale,c.latitude):a.state.camera.distance;b=x.eyeHeadingTiltForCenterPointAtDistance(a,f.heading,f.tilt,n,l,g);d=u.vectorToPoint(b.eye,a.renderSpatialReference,d);return new e(d,b.heading,b.tilt,f.fov)}return x.fromExtent(a,b.targetGeometry.extent,f.heading,f.tilt,
g)}function F(a,b,c){b=c.scale;return null==b&&null!=c.zoom&&(b=x.zoomToScale(a,c.zoom)),b}function G(a,b){var c=!1;return null!=b.heading?(a.heading=b.heading,c=!0):null!=b.rotation&&(a.heading=z(b.rotation),c=!0),null!=b.tilt&&(a.tilt=b.tilt,c=!0),null!=b.fov&&(a.fov=b.fov),c}function N(a,b,c){var e=a.spatialReference||h.WGS84;return b=b||x.externalToInternal(a,c.camera),c.targetGeometry=u.vectorToPoint(b.center,a.renderSpatialReference,e),c.scale=x.computeScale(a,b),c.rotation=C(c.camera.heading),
c}function M(a,b,c){if(b){if(!k.canProject(b.spatialReference,a.spatialReference))throw new f("viewpointutils:incompatible-spatialreference","Spatial reference ("+(b.spatialReference?b.spatialReference.wkid:"unknown")+") is incompatible with the view ("+a.spatialReference.wkid+")",{geometry:b});var e=[];if(!b.hasZ&&a.basemapTerrain){var d=void 0;(d="point"===b.type?b:"multipoint"===b.type||"polyline"===b.type?b.extent.center:"extent"===b.type?b.center:b.centroid)&&k.canProject(d,a.basemapTerrain.spatialReference)?
W[2]=a.basemapTerrain.getElevation(d)||0:W[2]=0}(0,ha[b.type])(b,function(a){e.push(a[0],a[1],a[2])},W);var g=e.length/3;if(0!==g&&(d=Array(e.length),u.bufferToBuffer(e,b.spatialReference,0,d,a.spatialReference,0,g)))for(b.hasZ&&(c.hasZ=!0),a=0;a<d.length;a+=3)b.hasZ?(W[0]=d[a+0],W[1]=d[a+1],W[2]=d[a+2]):(W[0]=d[a+0],W[1]=d[a+1]),y.expand(c.boundingBox,W)}}function R(a,b,c){return a.whenViewForGraphic(b).then(function(a){return a&&a.whenGraphicBounds?a.whenGraphicBounds(b):void 0}).then(function(a){var b=
a.boundingBox;y.expand(c.boundingBox,b);a.screenSpaceObjects&&a.screenSpaceObjects.forEach(function(a){c.screenSpaceObjects.push(a)});isFinite(b[2])&&(c.hasZ=!0)}).otherwise(function(){M(a,b.geometry,c)})}function P(b,c,e){if(Array.isArray(c)&&2===c.length){var d=c[0],f=c[1];if("number"==typeof d&&"number"==typeof f)return fa.x=d,fa.y=f,fa.z=void 0,fa.spatialReference=h.WGS84,M(b,fa,e),a.resolve()}if(c&&"function"==typeof c.map)return a.eachAlways(c.map(function(a){return P(b,a,e)}));if(c instanceof
g)try{M(b,c,e)}catch(ua){return a.reject(ua)}else if(c instanceof q)return R(b,c,e);return a.resolve()}function Q(a,b,c,e){if(b.camera)return T(a,c,b.camera,e);e.scale=b.scale;e.rotation=b.rotation;e.targetGeometry=b.targetGeometry?b.targetGeometry.clone():null;e.camera=null;null!=c.heading?e.rotation=C(c.heading):null!=c.rotation&&(e.rotation=c.rotation);b=F(a,e.targetGeometry,c);return null!=b&&(e.scale=b),e.camera=B(a,e,c.tilt),e}function T(a,b,c,e){e.camera=c.clone();e.camera.fov=a.camera.fov;
b=a.spatialReference;c=e.camera.position.spatialReference;return k.canProject(c,b)?(c.equals(b)||(e.camera.position=k.project(e.camera.position,b)),N(a,null,e)):null}function O(a,b,c,e){if(!c)return null;e.targetGeometry=c.clone();var f=v.cameraOnContentAlongViewDirection(a);if(b.position){c=e.targetGeometry;var g=a.renderSpatialReference;return u.pointToVector(b.position,V,g),u.pointToVector(c,X,g),e.targetGeometry=new d(c),e.camera.position=new d(b.position),t.vec3d.subtract(X,V,U),x.directionToHeadingTilt(a,
V,U,f.up,e.camera),e.scale=x.distanceToScale(a,t.vec3d.dist(V,X),e.targetGeometry.latitude),e.rotation=C(e.camera.heading),e}if(b.zoomFactor){var g=f.distance/b.zoomFactor,k=t.vec3d.scale(f.viewForward,-g,W);t.vec3d.add(f.center,k,f.eye);f.markViewDirty();e.scale=x.distanceToScale(a,g,c.latitude)}x.internalToExternal(a,f,e.camera);g={noReset:!1};return G(e.camera,b)&&(g.noReset=!0),b.zoomFactor||(e.scale=F(a,e.targetGeometry,b),null==e.scale&&(u.pointToVector(c,W,a.renderSpatialReference),w.frustumPoint(f.frustumPlanes,
W)?e.scale=x.distanceToScale(a,t.vec3d.dist(f.eye,W),c.latitude):e.scale=x.computeScale(a,f)),x.fromCenterScale(a,e.targetGeometry,e.scale,e.camera,g,e.camera))?e:null}function S(a,b,c,e){e.targetGeometry=c.clone();var d=v.cameraOnContentAlongViewDirection(a);x.internalToExternal(a,d,e.camera);d={noReset:!1};return G(e.camera,b)&&(d.noReset=!0),x.fromExtent(a,c,e.camera.heading,e.camera.tilt,d,e.camera)?e:null}function H(a,b){if(!b||!a.spatialReference)return null;a={target:null};if("declaredClass"in
b||Array.isArray(b))a.target=b;else{for(var c in b)a[c]=b[c];b.center&&!a.target&&(a.target=b.center)}return a}function Y(b){return b&&(b.rotation=C(b.camera.heading)),a.resolve(b)}Object.defineProperty(l,"__esModule",{value:!0});l.DEFAULT_FRAME_COVERAGE=.66;l.rotationToHeading=z;l.headingToRotation=C;l.toCamera=B;l.fromInternalCamera=function(a,b,d){return d||(d=new c({camera:new e})),x.internalToExternal(a,b,d.camera),N(a,b,d)};l.fromCamera=function(a,b,e){return e||(e=new c),e.camera=b.clone(),
N(a,null,e)};l.create=function(g,k){var h=H(g,k);if(!h)return a.reject(new f("viewpointutils-create:no-target","Missing target for creating viewpoint"));var q=new c({camera:new e({fov:g.camera.fov})}),r=null!=h.scale||null!=h.zoom;if(h.target instanceof c)return Y(Q(g,h.target,h,q));if(h.target instanceof e)return Y(T(g,h,h.target,q));if(h.target instanceof b)return k=h.target.xmin===h.target.xmax||h.target.ymin===h.target.ymax,Y(r||k?O(g,h,h.target.center,q):S(g,h,h.target,q));var m={boundingBox:y.create(y.NEGATIVE_INFINITY),
spatialReference:g.spatialReference,hasZ:!1,screenSpaceObjects:[]};return P(g,h.target,m).then(function(){if(isFinite(m.boundingBox[0])){y.center(m.boundingBox,W);fa.x=W[0];fa.y=W[1];fa.z=W[2];fa.spatialReference=g.spatialReference;var a=void 0;isFinite(fa.z)&&m.hasZ?a=y.isPoint(m.boundingBox):(fa.z=void 0,a=n.isPoint(y.toRect(m.boundingBox,K)));if(r||a)a=O(g,h,fa,q);else{var b=fa,a=m.boundingBox,c;c=m.screenSpaceObjects;var e=l.DEFAULT_FRAME_COVERAGE;if(c.length){for(var f=Number.NEGATIVE_INFINITY,
k=0;k<c.length;k++)var w=c[k].screenSpaceBoundingRect,f=Math.max(f,Math.abs(w[0]),Math.abs(w[1]),Math.abs(w[2]),Math.abs(w[3]));c=e-f/Math.min(g.width,g.height)*2}else c=e;e=c;q.targetGeometry=b.clone();c=v.cameraOnContentAlongViewDirection(g);f=0;b.hasZ?f=b.z:g.basemapTerrain&&(f=g.basemapTerrain.getElevation(b));t.vec3d.set3(b.x,b.y,f,W);u.computeLinearTransformation(g.spatialReference,W,E,g.renderSpatialReference);t.mat4d.toMat3(E,p);t.mat3d.transpose(p);y.set(A,y.NEGATIVE_INFINITY);b=[[0,1,2],
[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];for(k=0;k<b.length;k++){var w=b[k],z=a[w[2]];isFinite(z)||(z=f);t.vec3d.set3(a[w[0]],a[w[1]],z,W);u.vectorToVector(W,g.spatialReference,W,g.renderSpatialReference);y.expand(A,t.mat3d.multiplyVec3(p,W))}a=y.width(A);b=y.height(A);f=y.depth(A);k=1/Math.tan(c.fovY/2);a=Math.max(.5*Math.sqrt(a*a+f*f)*Math.max(k,1/Math.tan(c.fovX/2))+.5*b,.5*b*k+.5*Math.max(a,f))/e;x.internalToExternal(g,c,q.camera);c={noReset:!1};a=(G(q.camera,h)&&(c.noReset=!0),
q.scale=x.distanceToScale(g,a,q.targetGeometry.latitude),x.fromCenterScale(g,q.targetGeometry,q.scale,q.camera,c,q.camera)?q:null)}return a}h.position?(a=v.cameraOnContentAlongViewDirection(g),a=(t.vec3d.set(a.viewForward,U),x.directionToHeadingTilt(g,a.eye,U,a.up,ba),q.camera.position=new d(h.position),q.camera.heading=null!=h.heading?h.heading:ba.heading,q.camera.tilt=null!=h.tilt?h.tilt:ba.tilt,N(g,null,q))):(a=v.cameraOnContentAlongViewDirection(g),a=u.vectorToPoint(a.center,g.renderSpatialReference,
fa,g.spatialReference),a=O(g,h,a,q));return a}).then(function(a){return Y(a)})};var W=t.vec3d.create(),E=t.mat4d.create(),p=t.mat3d.create(),A=y.create(),K=n.create(),U=t.vec3d.create(),V=t.vec3d.create(),X=t.vec3d.create(),ba={heading:0,tilt:0},fa=new d,ha={point:function(a,b,c){c[0]=a.x;c[1]=a.y;a.hasZ&&(c[2]=a.z);b(c)},polygon:function(a,b,c){for(var e=a.hasZ,d=0;d<a.rings.length;d++)for(var f=a.rings[d],g=0;g<f.length;g++)c[0]=f[g][0],c[1]=f[g][1],e&&(c[2]=f[g][2]),b(c)},polyline:function(a,b,
c){for(var e=a.hasZ,d=0;d<a.paths.length;d++)for(var f=a.paths[d],g=0;g<f.length;g++)c[0]=f[g][0],c[1]=f[g][1],e&&(c[2]=f[g][2]),b(c)},multipoint:function(a,b,c){var e=a.points;a=a.hasZ;for(var d=0;d<e.length;d++)c[0]=e[d][0],c[1]=e[d][1],a&&(c[2]=e[d][2]),b(c)},extent:function(a,b,c){a.hasZ?(b(t.vec3d.set3(a.xmin,a.ymin,a.zmin,c)),b(t.vec3d.set3(a.xmax,a.ymin,a.zmin,c)),b(t.vec3d.set3(a.xmin,a.ymax,a.zmin,c)),b(t.vec3d.set3(a.xmax,a.ymax,a.zmin,c)),b(t.vec3d.set3(a.xmin,a.ymin,a.zmax,c)),b(t.vec3d.set3(a.xmax,
a.ymin,a.zmax,c)),b(t.vec3d.set3(a.xmin,a.ymax,a.zmax,c)),b(t.vec3d.set3(a.xmax,a.ymax,a.zmax,c))):(b(t.vec3d.set3(a.xmin,a.ymin,c[2],c)),b(t.vec3d.set3(a.xmax,a.ymin,c[2],c)),b(t.vec3d.set3(a.xmin,a.ymax,c[2],c)),b(t.vec3d.set3(a.xmax,a.ymax,c[2],c)))}}})},"esri/views/3d/support/aaBoundingBox":function(){define(["require","exports","./aaBoundingRect","../../../geometry/Extent"],function(m,l,h,d){function b(a){return a[0]>=a[3]?0:a[3]-a[0]}function g(a){return a[1]>=a[4]?0:a[4]-a[1]}function k(a){return a[2]>=
a[5]?0:a[5]-a[2]}function f(a){return 6===a.length}Object.defineProperty(l,"__esModule",{value:!0});l.create=function(a){return void 0===a&&(a=l.ZERO),[a[0],a[1],a[2],a[3],a[4],a[5]]};l.fromExtent=function(a){return[a.xmin,a.ymin,a.zmin,a.xmax,a.ymax,a.zmax]};l.toExtent=function(a,b){var c=isFinite(a[2])||isFinite(a[5]);return new d(c?{xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],zmin:a[2],zmax:a[5],spatialReference:b}:{xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],spatialReference:b})};l.fromMinMax=function(a,
b){return[a[0],a[1],a[2],b[0],b[1],b[2]]};l.expand=function(a,b,c){void 0===c&&(c=a);var e=b.declaredClass;return"esri.geometry.Extent"===e?(c[0]=Math.min(a[0],b.xmin),c[1]=Math.min(a[1],b.ymin),c[3]=Math.max(a[3],b.xmax),c[4]=Math.max(a[4],b.ymax),b.hasZ&&(c[2]=Math.min(a[2],b.zmin),c[5]=Math.max(a[5],b.zmax))):"esri.geometry.Point"===e?(c[0]=Math.min(a[0],b.x),c[1]=Math.min(a[1],b.y),c[3]=Math.max(a[3],b.x),c[4]=Math.max(a[4],b.y),b.hasZ&&(c[2]=Math.min(a[2],b.z),c[5]=Math.max(a[5],b.z))):f(b)?
(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.min(a[2],b[2]),c[3]=Math.max(a[3],b[3]),c[4]=Math.max(a[4],b[4]),c[5]=Math.max(a[5],b[5])):h.is(b)?(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[3]=Math.max(a[3],b[2]),c[4]=Math.max(a[4],b[3])):Array.isArray(b)&&(2===b.length?(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[3]=Math.max(a[3],b[0]),c[4]=Math.max(a[4],b[1])):3===b.length&&(c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.min(a[2],b[2]),c[3]=Math.max(a[3],
b[0]),c[4]=Math.max(a[4],b[1]),c[5]=Math.max(a[5],b[2]))),c};l.expandBuffer=function(a,b,c,d,f){void 0===f&&(f=a);var e=a[0],g=a[1],k=a[2],h=a[3],l=a[4];a=a[5];for(var n=0;d>n;n++)e=Math.min(e,b[c+3*n]),g=Math.min(g,b[c+3*n+1]),k=Math.min(k,b[c+3*n+2]),h=Math.max(h,b[c+3*n]),l=Math.max(l,b[c+3*n+1]),a=Math.max(a,b[c+3*n+2]);return f[0]=e,f[1]=g,f[2]=k,f[3]=h,f[4]=l,f[5]=a,f};l.allFinite=function(a){for(var b=0;6>b;b++)if(!isFinite(a[b]))return!1;return!0};l.width=b;l.depth=g;l.height=k;l.center=function(a,
e){return void 0===e&&(e=[0,0,0]),e[0]=a[0]+b(a)/2,e[1]=a[1]+g(a)/2,e[2]=a[2]+k(a)/2,e};l.size=function(a,e){return void 0===e&&(e=[0,0,0]),e[0]=b(a),e[1]=g(a),e[2]=k(a),e};l.containsPoint=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[0]<=a[3]&&b[1]<=a[4]&&b[2]<=a[5]};l.containsPointWithMargin=function(a,b,c){return b[0]>=a[0]-c&&b[1]>=a[1]-c&&b[2]>=a[2]-c&&b[0]<=a[3]+c&&b[1]<=a[4]+c&&b[2]<=a[5]+c};l.contains=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[3]<=a[3]&&b[4]<=
a[4]&&b[5]<=a[5]};l.intersects=function(a,b){return Math.max(b[0],a[0])<=Math.min(b[3],a[3])&&Math.max(b[1],a[1])<=Math.min(b[4],a[4])&&Math.max(b[2],a[2])<=Math.min(b[5],a[5])};l.offset=function(a,b,c,d,f){return void 0===f&&(f=a),f[0]=a[0]+b,f[1]=a[1]+c,f[2]=a[2]+d,f[3]=a[3]+b,f[4]=a[4]+c,f[5]=a[5]+d,f};l.setMin=function(a,b,c){return void 0===c&&(c=a),c[0]=b[0],c[1]=b[1],c[2]=b[2],c!==a&&(c[3]=a[3],c[4]=a[4],c[5]=a[5]),c};l.setMax=function(a,b,c){return void 0===c&&(c=a),c[3]=b[0],c[4]=b[1],c[5]=
b[2],c!==a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2]),a};l.set=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a};l.toRect=function(a,b){return b||(b=h.create()),b[0]=a[0],b[1]=a[1],b[2]=a[3],b[3]=a[4],b};l.fromRect=function(a,b){return a[0]=b[0],a[1]=b[1],a[3]=b[2],a[4]=b[3],a};l.is=f;l.isPoint=function(a){return 0===b(a)&&0===g(a)&&0===k(a)};l.equals=function(a,b,c){if(null==a||null==b)return a===b;if(!f(a)||!f(b))return!1;if(c)for(var e=0;e<a.length;e++){if(!c(a[e],b[e]))return!1}else for(e=
0;e<a.length;e++)if(a[e]!==b[e])return!1;return!0};l.POSITIVE_INFINITY=[-(1/0),-(1/0),-(1/0),1/0,1/0,1/0];l.NEGATIVE_INFINITY=[1/0,1/0,1/0,-(1/0),-(1/0),-(1/0)];l.ZERO=[0,0,0,0,0,0]})},"esri/views/3d/support/intersectionUtils":function(){define(["../lib/glMatrix"],function(m){function l(b,f,a,e){e.clip[0]=0;e.clip[1]=a?e.len:Number.MAX_VALUE;for(a=0;a<b.length;a++){var c;var g=b[a],k=f;c=e;var h=d.dot(g,c.dir),k=-d.dot(k,g)-g[3];0>k&&0<=h?c=!1:-1E-6<h&&1E-6>h?c=!0:!(0>k||0>h)||0>k&&0>h?(k/=h,c=(0<
h?k<c.clip[1]&&(c.clip[1]=k):k>c.clip[0]&&(c.clip[0]=k),c.clip[0]<=c.clip[1])):c=!0;if(!c)return!1}return!0}function h(g,f,a,e){return g?(a&&e&&(b.len=d.dist(f,a)),d.set(g,b.dir)):e?(b.len=d.dist(f,a),d.scale(d.subtract(a,f,b.dir),1/b.len)):d.normalize(d.subtract(a,f,b.dir)),b}var d=m.vec3d;m=m.vec2d;var b={dir:d.create(),len:0,clip:m.create()},g={planeSphere:function(b,d,a){return b[0]*d[0]+b[1]*d[1]+b[2]*d[2]+b[3]<a},frustumSphere:function(b,d,a){for(var e=0;6>e;e++)if(!g.planeSphere(b[e],d,a))return!1;
return!0},frustumRay:function(b,d,a,e){a=h(e,d,a,!1);return l(b,d,null,a)},frustumPoint:function(b,f){for(var a=0;6>a;a++){var e=b[a];if(0>-d.dot(f,e)-e[3])return!1}return!0},frustumLineSegment:function(b,d,a,e){e=h(e,d,a,!0);return l(b,d,a,e)},closestPointOnRay:function(b,f,a,e){a=d.dot(f,d.subtract(a,b,e));return d.add(b,d.scale(f,a,e),e),e}};return g})},"esri/views/3d/camera/constraintUtils":function(){define("require exports ../lib/glMatrix ../../animation/easing ./constraintUtils/common ./constraintUtils/tilt ./constraintUtils/tilt ./constraintUtils/altitude ./constraintUtils/altitude ./constraintUtils/distance ./constraintUtils/distance ./constraintUtils/surfaceCollision ./constraintUtils/surfaceCollision".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){Object.defineProperty(l,"__esModule",{value:!0});l.applyTilt=k.apply;l.tiltError=k.error;l.applyAltitude=a.apply;l.altitudeError=a.error;l.applyDistance=c.apply;l.distanceError=c.error;l.applySurfaceCollision=t.apply;l.applyAll=function(a,c,e,d){void 0===e&&(e=u);void 0===d&&(d=c);var f=!1;d!==c&&d.copyFrom(c);d.markViewDirty();d.computeUp(a.state.mode);for(c=0;v>c;c++){for(var g=0,k=0,h=r;k<h.length;k++){var l=h[k];if(b.hasConstraintType(e.selection,l.type)){var n=
Math.abs(l.error(a,d,e));l.apply(a,d,e)&&(f=!0,g+=n)}}if(0===g)break}c=b.hasConstraintType(e.selection,8);e=4===e.interactionType?1:0;return c&&q.apply(a,d,e)&&(f=!0),f&&d.computeUp(a.state.mode),f};l.pixelDistanceToInteractionFactor=function(a,b){a="number"==typeof a?a:h.vec2d.dist(a,b);return d.inOutCubic(Math.min(1,a/150))};var r=[{type:1,error:function(a,b,c){return g.error(a,b,c)*b.distance},apply:g.apply},{type:2,error:f.error,apply:f.apply},{type:4,error:e.error,apply:e.apply}],u={selection:15,
interactionType:0,interactionFactor:0,interactionStartCamera:null,interactionDirection:null},v=5})},"esri/views/3d/camera/constraintUtils/common":function(){define(["require","exports","../../lib/glMatrix","../../support/mathUtils"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.hasConstraintType=function(b,d){return 0!==(b&d)};l.adjustRangeForInteraction=function(b,d,k,f,a,e){0!==b&&(k?(e.min=Math.min(e.min,d),e.max=Math.max(e.max,d)):null!=f?(e.min-=Math.max(0,(d-e.min)*(1-
f)),e.max+=Math.max(0,(d-e.max)*(1-f))):a&&(e.min-=Math.max(0,d-e.min-a),e.max+=Math.max(0,d-e.max-a)))};l.defaultApplyOptions={selection:0,interactionType:0,interactionFactor:0,interactionStartCamera:null,interactionDirection:null};l.interactionDirectionTowardsConstraintMinimization=function(b,g,k,f,a){return k||(k=g.viewForward),h.vec3d.set(k,a),h.vec3d.scale(a,d.sign(h.vec3d.dot(k,f))),a}})},"esri/views/3d/camera/constraintUtils/tilt":function(){define("require exports ../../lib/glMatrix ../../support/mathUtils ../../support/earthUtils ../../state/utils/viewUtils ./common".split(" "),
function(m,l,h,d,b,g,k){function f(b,c,e,h){if((void 0===e&&(e=k.defaultApplyOptions),void 0===h&&(h=k.defaultApplyOptions),3===e.interactionType)||!b.state.constraints.tilt)return 0;var l=g.viewAngle(b.renderCoordsHelper,c.center,c.eye);c=b.state.constraints.tilt(c.distance,t);if(0!==e.interactionType){var n=e.interactionStartCamera,r=e.interactionFactor,m=c.min,u=c.max,v=f(b,n,k.defaultApplyOptions,e),x=0===v?0:g.viewAngle(b.renderCoordsHelper,n.center,n.eye);c.min=m;c.max=u;2===e.interactionType?
(k.hasConstraintType(e.selection,2)&&a(b,n,c),k.adjustRangeForInteraction(v,x,!0,r,q,c)):k.adjustRangeForInteraction(v,x,!1,r,q,c)}2===h.interactionType&&k.hasConstraintType(h.selection,2)&&a(b,h.interactionStartCamera,c);b=d.clamp(l,c.min,c.max);l-=b;return 1E-6>=Math.abs(l)?0:l}function a(a,c,e){if(!a.state.isLocal){var f=a.state.constraints;if(f.altitude){a=h.vec3d.length2(c.center);var g=Math.sqrt(a);c=c.distance;var k=f.altitude.min+b.earthRadius,f=f.altitude.max+b.earthRadius,k=(k*k-c*c-a)/
(-2*g*c);e.min=Math.max(e.min,Math.min(Math.PI-d.acos((f*f-c*c-a)/(-2*g*c)),e.max));e.max=Math.min(e.max,Math.PI-d.acos(k))}}}Object.defineProperty(l,"__esModule",{value:!0});l.apply=function(a,b,d,g){void 0===d&&(d=k.defaultApplyOptions);void 0===g&&(g=b);b!==g&&g.copyFrom(b);a=f(a,b,d);return 0===a?!1:(h.mat4d.identity(c),h.mat4d.rotate(c,-a,b.viewRight),h.vec3d.subtract(b.center,b.eye,e),h.mat4d.multiplyVec3(c,e),h.vec3d.subtract(b.center,e,g.eye),h.mat4d.multiplyVec3(c,g.up),g.markViewDirty(),
!0)};l.error=f;var e=h.vec3d.create(),c=h.mat4d.create(),q=d.deg2rad(5),t={min:0,max:0}})},"esri/views/3d/state/utils/viewUtils":function(){define(["require","exports","../../lib/glMatrix","../../support/mathUtils"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.viewAngle=function(k,f,a){k.worldUpAtPosition(f,b);h.vec3d.subtract(a,f,g);k=h.vec3d.length(g);return 0===k?0:d.acos(h.vec3d.dot(g,b)/k)};var b=h.vec3d.create(),g=h.vec3d.create()})},"esri/views/3d/camera/constraintUtils/altitude":function(){define("require exports ../../lib/glMatrix ../../support/mathUtils ../../support/intersectionUtils ./common".split(" "),
function(m,l,h,d,b,g){function k(b,c,e){void 0===e&&(e=g.defaultApplyOptions);var f=b.state.constraints.altitude;if(!b.state.isGlobal||!f||2===e.interactionType&&g.hasConstraintType(e.selection,1))return 0;var f=b.state.constraints.altitude,h=a,f=(h.min=f.min,h.max=f.max,h),l=e.interactionType;if(0!==l){var h=f.min,n=f.max,q=e.interactionStartCamera;e=e.interactionFactor;var l=2===l||1===l,r=k(b,q),q=0===r?0:b.renderCoordsHelper.getAltitude(q.eye);f.min=h;f.max=n;g.adjustRangeForInteraction(r,q,l,
e,.05*q,f)}b=b.renderCoordsHelper.getAltitude(c.eye);b=d.clamp(b,f.min,f.max)-b;return 1E-6>=Math.abs(b)?0:b}function f(a,b,c,e){return a.renderCoordsHelper.worldUpAtPosition(b.eye,e),h.vec3d.scale(e,c),e}Object.defineProperty(l,"__esModule",{value:!0});l.apply=function(a,l,m,v){void 0===m&&(m=g.defaultApplyOptions);void 0===v&&(v=l);v!==l&&v.copyFrom(l);var r=k(a,l,m);if(0===r)return!1;var t=a.renderCoordsHelper,n=t.getAltitude(l.eye)+r;a=g.interactionDirectionTowardsConstraintMinimization(a,l,m.interactionDirection,
f(a,l,d.sign(r),c),e);m=h.vec3d.set(l.viewForward,q);return t.intersectManifold(l.eye,a,n,v.eye)||t.setAltitude(n,v.eye),b.closestPointOnRay(l.eye,m,l.center,l.center),v.markViewDirty(),!0};l.error=k;var a={min:0,max:0},e=h.vec3d.create(),c=h.vec3d.create(),q=h.vec3d.create()})},"esri/views/3d/camera/constraintUtils/distance":function(){define(["require","exports","../../lib/glMatrix","../../webgl-engine/lib/Util","./common"],function(m,l,h,d,b){function g(a,c,e){if(void 0===e&&(e=b.defaultApplyOptions),
!a.state.isLocal)return 0;var d=a.state.constraints.distance;if(!a.pointsOfInterest.surfaceOrigin.renderLocation||d===1/0)return 0;k.min=0;k.max=d;var d=k,f=e.interactionType;if(0!==f){var l=d.min,q=d.max,n=e.interactionStartCamera;e=e.interactionFactor;var f=1===f||4===f,r=g(a,n),n=0===r?0:h.vec3d.dist(n.eye,a.pointsOfInterest.surfaceOrigin.renderLocation);d.min=l;d.max=q;b.adjustRangeForInteraction(r,n,f,e,.05*n,d)}a=h.vec3d.dist(c.eye,a.pointsOfInterest.surfaceOrigin.renderLocation);a=k.max-a;
return-1E-6<=a?0:a}Object.defineProperty(l,"__esModule",{value:!0});l.error=g;l.apply=function(k,l,r,m){void 0===r&&(r=b.defaultApplyOptions);void 0===m&&(m=l);m!==l&&m.copyFrom(l);var q=g(k,l,r);if(0===q)return!1;var t=k.pointsOfInterest.surfaceOrigin,q=h.vec3d.dist(l.eye,k.pointsOfInterest.surfaceOrigin.renderLocation)+q,u=h.vec3d.set(l.eye,f);r=b.interactionDirectionTowardsConstraintMinimization(k,l,r.interactionDirection,h.vec3d.direction(k.pointsOfInterest.surfaceOrigin.renderLocation,l.eye,
c),e);return d.raySphere(l.eye,r,t.renderLocation,q,m.eye)?(l=h.vec3d.subtract(m.eye,u,a),h.vec3d.add(m.center,l),m.markViewDirty(),l=k.renderCoordsHelper.getAltitude(m.center),k.renderCoordsHelper.intersectManifold(m.eye,m.viewForward,l,m.center),m.markViewDirty(),!0):!1};var k={min:0,max:0},f=h.vec3d.create(),a=h.vec3d.create(),e=h.vec3d.create(),c=h.vec3d.create()})},"esri/views/3d/camera/constraintUtils/surfaceCollision":function(){define(["require","exports","../intersectionUtils","../../lib/glMatrix"],
function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.apply=function(g,k,f,a){void 0===f&&(f=0);void 0===a&&(a=k);var e=g.state.constraints;if(k!==a&&a.copyFrom(k),!e.collision.enabled)return!1;var c=h.surfaceElevationBelowEye(g,k);k=g.renderCoordsHelper.getAltitude(k.eye);e=e.collision.elevationMargin;return k-c>=e?!1:(d.vec3d.subtract(a.center,a.eye,b),g.renderCoordsHelper.setAltitude(c+e,a.eye),1===f&&d.vec3d.add(a.eye,b,a.center),a.markViewDirty(),!0)};var b=d.vec3d.create()})},
"esri/views/3d/state/Frustum":function(){define(["require","exports","../lib/glMatrix","../support/earthUtils","../webgl-engine/lib/Util"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function g(){this.planes=Array(6);this.points=Array(8);this.lines=Array(12);this.origin=h.vec3d.create();this.direction=h.vec3d.create();this._altitude=null;for(var b=0;6>b;b++)this.planes[b]=h.vec4d.create();for(b=0;8>b;b++)this.points[b]=h.vec3d.create();for(b=0;12>b;b++)this.lines[b]=
{origin:null,direction:h.vec3d.create(),endpoint:null}}return g.prototype.updateLine=function(b,d,a){b.origin=d;b.endpoint=a;h.vec3d.direction(a,d,b.direction)},g.prototype.update=function(g){b.matrix2frustumPlanes(g.viewMatrix,g.projectionMatrix,this.points,this.planes);for(var f=0;4>f;f++){var a=f,e=f+4;this.updateLine(this.lines[f],this.points[a],this.points[e]);this.updateLine(this.lines[f+4],this.points[a],3===f?this.points[0]:this.points[a+1]);this.updateLine(this.lines[f+8],this.points[e],
3===f?this.points[4]:this.points[e+1])}h.vec3d.set(g.eye,this.origin);h.vec3d.set(g.viewForward,this.direction);this._altitude=h.vec3d.length(this.origin)-d.earthRadius},Object.defineProperty(g.prototype,"altitude",{get:function(){return this._altitude},enumerable:!0,configurable:!0}),g}();l.Frustum=m;l["default"]=m})},"esri/views/3d/state/ConstraintsManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/HandleRegistry ../../../core/watchUtils ../camera/intersectionUtils ../camera/constraintUtils ./SurfaceCollisionConstraint ./NearFarHeuristic ../support/mathUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){Object.defineProperty(l,"__esModule",{value:!0});m=function(g){function l(a){var b=g.call(this)||this;return b.handles=new k,b.nearFarHeuristic=q.createNearFarHeuristic(a.view.state.mode,a.view.basemapTerrain,a.view.renderCoordsHelper.spatialReference),b}return h(l,g),l.prototype.initialize=function(){var a=this;this.handles.add([this.view.watch(["constraints.clipDistance.near","constraints.clipDistance.far"],function(){return a.handleClipDistanceNearFarChanged()}),
this.view.watch("constraints.clipDistance.mode",function(){return a.handleClipDistanceModeChanged()}),this.view.state.events.on("before-camera-change",function(b){return a.cameraUpdateNearFar(b.camera)}),this.view.watch("dataExtent",function(){return a.updateNearFar()},!0)],"clipDistance");this.handles.add([this.view.watch(["constraints.altitude.min","constraints.altitude.max"],function(){return a.handleAltitudeMinMaxChanged()},!0)],"altitude");this.handles.add([this.view.watch("constraints.tilt.max",
function(){return a.handleTiltMaxChanged()},!0),this.view.watch("constraints.tilt.mode",function(){return a.handleTiltModeChanged()},!0),this.view.watch("state.camera",function(){return a.tiltAutoUpdateMax()},!0)],"tilt");this.handles.add([this.view.watch("constraints.collision.enabled",function(){return a.handleCollisionEnabledChanged()},!0)],"collision");this.view.state.isLocal&&this.handles.add(f.init(this.view,"dataExtent",function(b){return a.updateLocalSurfaceDistance(b)}));this.updateNearFar();
"local"!==this.view.state.mode&&this.updateAltitude();this.updateTilt();this.updateCollision();this._set("surfaceCollisionConstraint",new c["default"]({view:this.view}))},l.prototype.destroy=function(){this.handles&&(this.handles.destroy(),this.handles=null);this.surfaceCollisionConstraint&&(this.surfaceCollisionConstraint.destroy(),this._set("surfaceCollisionConstraint",null))},l.prototype.handleClipDistanceNearFarChanged=function(){var a=this,b=this.view.constraints&&this.view.constraints.clipDistance;
b&&"auto"!==b.mode&&this.view.state.updateCamera(function(c){return a.cameraUpdateNearFarManual(c,b),!0})},l.prototype.handleClipDistanceModeChanged=function(){this.updateNearFar()},l.prototype.updateNearFar=function(){var a=this;this.view.state.updateCamera(function(b){return a.cameraUpdateNearFar(b),!0})},l.prototype.cameraUpdateNearFar=function(a){var b=this.view.constraints&&this.view.constraints.clipDistance;"manual"===(b?b.mode:"auto")?this.cameraUpdateNearFarManual(a,b):this.cameraUpdateNearFarAuto(a,
b)},l.prototype.cameraUpdateNearFarAuto=function(b,c){var e=this.nearFarHeuristic.compute(b.eye,b.center,this.view.dataExtent,a.surfaceElevationBelowEye(this.view,b),r),d=e.distance,f=e.maxFarNearRatio,e=e.minNearDistance;d/f>e?(b.far=d,b.near=b.far/f):(b.near=e,b.far=b.near*f);c&&c.autoUpdate(b.near,b.far)},l.prototype.cameraUpdateNearFarManual=function(a,b){b&&(a.near=b.near,a.far=b.far)},l.prototype.handleCollisionEnabledChanged=function(){this.updateCollision()},l.prototype.updateCollision=function(){var a=
this.view.constraints&&this.view.constraints.collision,b=this.view.state.constraints.collision,a=a?a.enabled:!1;a!==b.enabled&&(b.enabled=a,a&&this.reapplyConstraints(8))},l.prototype.handleAltitudeMinMaxChanged=function(){this.updateAltitude()},l.prototype.updateAltitude=function(){var a=this.view.constraints&&this.view.constraints.altitude;a&&"local"!==this.view.state.mode?this.view.state.constraints.altitude={min:a.min,max:a.max}:this.view.state.constraints.altitude=null;this.reapplyConstraints()},
l.prototype.handleTiltModeChanged=function(){this.updateTilt()},l.prototype.handleTiltMaxChanged=function(){var a=this.view.constraints&&this.view.constraints.tilt;a&&"auto"!==a.mode&&(this.updateTiltManual(a),this.reapplyConstraints())},l.prototype.updateTilt=function(){var a=this.view.constraints&&this.view.constraints.tilt;"manual"===(a?a.mode:"auto")?this.updateTiltManual(a):this.updateTiltAuto(a);this.reapplyConstraints()},l.prototype.updateTiltManual=function(a){var b=this.view.state.constraints;
b.tilt=b.createConstantMaxTilt(t.deg2rad(a.max))},l.prototype.updateTiltAuto=function(a){a=this.view.state.constraints;a.tilt=a.createDefaultTilt();this.tiltAutoUpdateMax()},l.prototype.tiltAutoUpdateMax=function(){var a=this.view.constraints&&this.view.constraints.tilt;if(a&&"auto"===a.mode){var b=this.view.state.constraints;b.tilt&&(b=b.tilt(this.view.state.camera.distance).max,a.autoUpdate(t.rad2deg(b)))}},l.prototype.updateLocalSurfaceDistance=function(a){var b=Math.max(a.width,a.height);0>=b||
(a.hasZ&&(b=Math.max(b,a.zmax-a.zmin)),a=this.view.state,b=3*b/Math.atan(a.camera.fov/2),b!==a.constraints.distance&&(a.constraints.distance=b))},l.prototype.reapplyConstraints=function(a){var b=this;void 0===a&&(a=15);this.view.state.updateCamera(function(c){return e.applyAll(b.view,c,{selection:a,interactionType:0,interactionFactor:null,interactionStartCamera:null,interactionDirection:null})})},d([b.property({constructOnly:!0})],l.prototype,"view",void 0),d([b.property({readOnly:!0})],l.prototype,
"surfaceCollisionConstraint",void 0),l=d([b.subclass("esri.views.3d.state.ConstraintsManager")],l)}(b.declared(g));l.ConstraintsManager=m;var r={distance:0,maxFarNearRatio:0,minNearDistance:0};l["default"]=m})},"esri/views/3d/state/SurfaceCollisionConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/HandleRegistry ../camera/intersectionUtils ../camera/constraintUtils".split(" "),
function(m,l,h,d,b,g,k,f,a){Object.defineProperty(l,"__esModule",{value:!0});m=function(e){function c(a){a=e.call(this)||this;return a.handles=new k,a}return h(c,e),c.prototype.initialize=function(){var a=this;this.handles.add(this.view.basemapTerrain.on("elevation-change",function(b){return a.handleElevationChangeEvent(b)}))},c.prototype.destroy=function(){this.handles&&(this.handles.destroy(),this.handles=null)},c.prototype.handleElevationChangeEvent=function(a){if(this.view.state.cameraController)return!1;
f.eyeWithinExtent(this.view,this.view.state.camera,a.extent,a.spatialReference)&&this.applyToCurrentCamera()},c.prototype.applyToCurrentCamera=function(){var b=this;this.view.state.updateCamera(function(c){a.applySurfaceCollision(b.view,c,1)})},d([b.property({constructOnly:!0})],c.prototype,"view",void 0),c=d([b.subclass("esri.views.3d.state.ElevationCollisionConstraint")],c)}(b.declared(g));l.SurfaceCollisionConstraint=m;l["default"]=m})},"esri/views/3d/state/NearFarHeuristic":function(){define("require exports ../lib/glMatrix ../../../geometry/support/scaleUtils ../support/mathUtils ../support/earthUtils".split(" "),
function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});l.createNearFarHeuristic=function(a,b,c){return"global"===a?new f:new k(b,c)};var k=function(){function c(a,b){this.elevationProvider=a;this.unitInMeters=d.getMetersPerUnitForSR(b)}return c.prototype.compute=function(c,d,f,k,l){l||(l={maxFarNearRatio:0,distance:0,minNearDistance:0});var n=g.earthRadius;l.maxFarNearRatio=a;l.minNearDistance=e/this.unitInMeters;var q=c[2]*this.unitInMeters,m=q;k=q-k;var w=this.elevationProvider?
this.elevationProvider.getElevationBounds():null;w&&(q=0<=k?m-this.unitInMeters*w[0]:this.unitInMeters*w[1]-m);m=Math.max(f.xmax-f.xmin,f.ymax-f.ymin,4*Math.max(f.xmax-f.xmin,f.ymax-f.ymin));h.vec3d.subtract(d,c,v);u[0]=0<v[0]?f.xmax:f.xmin;u[1]=0<v[1]?f.ymax:f.ymin;u[2]=0<v[2]?m/2:-m/2;h.vec3d.subtract(u,c);h.vec3d.normalize(v);c=1.1*h.vec3d.dot(u,v)*this.unitInMeters;d=q+n;n=Math.sqrt(d*d-n*n);f=Math.max(f.xmax-f.xmin,f.ymax-f.ymin);d=f*r*this.unitInMeters;q=b.clamp((q-d)/(f*t*this.unitInMeters-
d),0,1);return q*=q*q,l.distance=b.lerp(n,c,q),l.distance*=Math.max(Math.log(Math.abs(k)),1),l.distance=Math.min(l.distance,Math.max(34064E4,m)),l.distance/=this.unitInMeters,l},c}(),f=function(){function d(){}return d.prototype.compute=function(c,d,f,k,l){l||(l={maxFarNearRatio:0,minNearDistance:0,distance:0});d=g.earthRadius;c=h.vec3d.dot(c,c);f=d*d;(l.maxFarNearRatio=a,l.minNearDistance=e/1,this.isNemoMode(c,k))?(k=d+k,l.distance=Math.sqrt(c-k*k)/1):c>f?(l.maxFarNearRatio=b.clamp(2E4-(Math.log(Math.sqrt(c)-
d)-7.983)/9.011*19E3,1E3,2E4),l.distance=Math.sqrt(c-f)/1):l.distance=l.maxFarNearRatio*l.minNearDistance;return l.distance*=1.2,l},d.prototype.isNemoMode=function(a,b){var e=g.earthRadius+c;return e*e>a&&q>b},d}(),a=2E4,e=2,c=2E4,q=-500,t=.001,r=1E-4,u=h.vec3d.create(),v=h.vec3d.create()})},"esri/views/3d/state/controllers/SurfaceCollisionCorrectionController":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/HandleRegistry ../../camera/intersectionUtils ../../camera/constraintUtils ./CameraController".split(" "),
function(m,l,h,d,b,g,k){Object.defineProperty(l,"__esModule",{value:!0});m=function(f){function a(a){var b=f.call(this)||this;return b.handles=new d,b.view=a.view,b.desiredCamera=a.desiredCamera.copy(),b}return h(a,f),Object.defineProperty(a.prototype,"canStop",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"constraintEnabled",{get:function(){return this.view.state.constraints.collision.enabled},enumerable:!0,configurable:!0}),a.prototype.onControllerStart=
function(a){var b=this;f.prototype.onControllerStart.call(this,a);this.handles.add(this.view.basemapTerrain.on("elevation-change",function(a){return b.handleElevationChangeEvent(a)}));this.applyCorrection()},a.prototype.onControllerEnd=function(a){this.handles.removeAll();f.prototype.onControllerEnd.call(this,a)},a.prototype.handleElevationChangeEvent=function(a){b.eyeWithinExtent(this.view,this.desiredCamera,a.extent,a.spatialReference)&&this.applyCorrection()},a.prototype.applyCorrection=function(){var a=
this;this.view.state.updateCamera(function(b){b.copyViewFrom(a.desiredCamera);g.applySurfaceCollision(a.view,b,1)||a.constraintEnabled||(a.state=k.State.Stopped)})},a}(k.CameraController);l.SurfaceCollisionCorrectionController=m})},"esri/views/3d/state/helpers/PickingHelper":function(){define(["require","exports","../../lib/glMatrix","../../webgl-engine/lib/Selector","../../camera/intersectionUtils"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function g(b){this.view=
b;this.tmpR0=h.vec3d.create();this.tmpR1=h.vec3d.create();this.tmpSelector=new d(this.view.viewingMode)}return g.prototype.pickPointInScreen=function(b,d){return this.pickedIntersectionPoint(this.pickInScreen(b,!1),d)},g.prototype.pickFreePointFromSegment=function(d,f,a){h.vec3d.set(d,this.tmpR0);h.vec3d.set(f,this.tmpR1);h.vec3d.subtract(this.tmpR1,this.tmpR0);h.vec3d.normalize(this.tmpR1);var e=this.view.dataExtent;d=Math.max(e.xmax-e.xmin,e.ymax-e.ymin,8*Math.max(e.xmax-e.xmin,e.ymax-e.ymin));
f=this.view.state.camera;var c=Math.max(0,e.xmin-f.eye[0],f.eye[0]-e.xmax),e=Math.max(0,e.ymin-f.eye[1],f.eye[1]-e.ymax),c=Math.sqrt(c*c+e*e),e=this.view.renderCoordsHelper.getAltitude(f.eye);f=b.surfaceElevationBelowEye(this.view,f);f=d/Math.max(1,Math.pow(Math.max(0,Math.log(d/(Math.abs(e-f)+Number.MIN_VALUE))),2));f=Math.max(f,Math.min(c,d));h.vec3d.scale(this.tmpR1,f);h.vec3d.add(this.tmpR0,this.tmpR1,a)},g.prototype.pickFreePointInScreen=function(b,d){this.view._pickRayWithBeginPoint(b,void 0,
this.view.state.camera.viewMatrix,this.tmpR0,this.tmpR1);this.pickFreePointFromSegment(this.tmpR0,this.tmpR1,d)},g.prototype.pickRaySegment=function(b,d,a){return this.pickedIntersectionPoint(this.view._pickRay(b,d,null,null,null,null,this.tmpSelector),a)},g.prototype.pickInScreen=function(b,d){return this.view._pickRayWithBeginPoint(b,void 0,this.view.state.camera.viewMatrix,this.tmpR0,this.tmpR1),d&&h.vec3d.set(this.view.state.camera.eye,this.tmpR0),this.view._pickRay(this.tmpR0,this.tmpR1,b,b,
null,null,this.tmpSelector)},g.prototype.pickedIntersectionPoint=function(b,d){return b?b.getMinResult().getIntersectionPoint(d):!1},g}();l.PickingHelper=m})},"esri/views/3d/environment/SceneViewEnvironment":function(){define(["dojo/_base/lang","../../../webscene/Environment","../../../webscene/Lighting","./SceneViewLighting","./SceneViewAtmosphere"],function(m,l,h,d,b){var g=l.createSubclass({declaredClass:"esri.views.3d.environment.SceneViewEnvironment",properties:{atmosphere:{type:b,json:{read:!1}},
atmosphereEnabled:{value:!0,json:{read:!1}},starsEnabled:{value:!0,json:{read:!1}},lighting:{set:function(b){if(!b)return void(this.lighting||this._set("lighting",new d));if(this.lighting)null!=b.date&&(this.lighting.date=b.date),null!=b.defaultDate&&(this.lighting.defaultDate=b.defaultDate),null!=b.displayUTCOffset&&(this.lighting.displayUTCOffset=b.displayUTCOffset),this.lighting.directShadowsEnabled=b.directShadowsEnabled,null!=b.ambientOcclusionEnabled&&(this.lighting.ambientOcclusionEnabled=
b.ambientOcclusionEnabled),null!=b.cameraTrackingEnabled&&(this.lighting.cameraTrackingEnabled=b.cameraTrackingEnabled);else if(b instanceof d)this._set("lighting",b);else if(b instanceof h){var f={directShadowsEnabled:b.directShadowsEnabled};null!=b.date&&(f.date=b.date);null!=b.displayUTCOffset&&(f.displayUTCOffset=b.displayUTCOffset);null!=b.defaultDate&&(f.defaultDate=b.defaultDate);this._set("lighting",new d(f))}else this._set("lighting",new d(b))}}},getDefaults:function(){return m.mixin(this.inherited(arguments),
{atmosphere:{}})},atmosphere:null,atmosphereEnabled:!0,starsEnabled:!0,clone:function(){return new g({lighting:this.lighting.clone(),atmosphere:this.atmosphere.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled})}});return g})},"esri/views/3d/environment/SceneViewLighting":function(){define(["../../../core/Evented","../../../webscene/Lighting"],function(m,l){var h=new Date,d={target:null,date:null},b={target:null,timezoneOffset:0};return l.createSubclass([m],{declaredClass:"esri.views.3d.environment.SceneViewLighting",
properties:{cameraTrackingEnabled:{value:!0},ambientOcclusionEnabled:{value:!1},defaultDate:{get:function(){return new Date(this._get("defaultDate"))},set:function(b){var d=this._get("date")===this._get("defaultDate");b=new Date(b);this._set("defaultDate",b);d&&this._set("date",b)}},date:{cast:function(b){return b},set:function(b){null!=b&&(this._set("date",new Date(b)),this.positionTimezoneInfo.autoUpdated=!1,this._emitDateWillChange())}}},constructor:function(){this.positionTimezoneInfo={hours:0,
minutes:0,seconds:0,autoUpdated:!0};this._autoUpdateDate=null;var b=(new Date).getFullYear(),b=new Date("March 15, "+b+" 12:00:00 UTC");this._set("defaultDate",b);this._set("date",b)},autoUpdate:function(d,k){var f=this._calculateTimezoneOffset(this.positionTimezoneInfo);if(this.positionTimezoneInfo.hours=k.hours,this.positionTimezoneInfo.minutes=k.minutes,this.positionTimezoneInfo.seconds=k.seconds,null!=d){this.positionTimezoneInfo.autoUpdated=!0;var a=this.date&&this.date.getTime();this._set("date",
new Date(d));this._emitDateWillChange()}k=this._calculateTimezoneOffset(this.positionTimezoneInfo);return f!==k&&(b.target=this,b.timezoneOffset=k,this.emit("timezone-will-change",b)),null!=d?a!==d.getTime():void 0},_calculateTimezoneOffset:function(b){return Math.round(b.hours+b.minutes/60+b.seconds/3600)},_emitDateWillChange:function(){d.target=this;h.setTime(this._get("date").getTime());d.date=h;this.emit("date-will-change",d)}})})},"esri/views/3d/environment/SceneViewAtmosphere":function(){define(["../../../core/Accessor"],
function(m){return m.createSubclass({properties:{quality:{}},quality:"low",_qualitySetter:function(l){-1!==["low","high"].indexOf(l)&&this._set("quality",l)},clone:function(){return new this.constructor({quality:this.quality})}})})},"esri/views/3d/environment/SceneViewEnvironmentManager":function(){define("../../../core/declare ../../../core/Accessor ../../../core/Evented ../../../core/promiseUtils ../../../core/watchUtils ../../../core/HandleRegistry ../../../geometry/Point ../../../geometry/support/webMercatorUtils ../../../geometry/SpatialReference ../support/sunUtils ../support/earthUtils ./EnvironmentRenderer ../webgl-engine/lighting/Lightsources ../lib/glMatrix".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){var u=r.vec3d,v=new Date,x={hours:0,minutes:0,seconds:0},y=[.5773502691896258,-.5773502691896258,.5773502691896258],n=u.createFrom(.22,.22,.33),w=u.createFrom(.22,.22,.22);m=m([l,h],{declaredClass:"esri.views.3d.environment.SceneViewEnvironmentManager",referencePointUpdateDelay:200,referencePointUpdateInterval:3E3,referencePointUpdateDistThreshold:1E6,properties:{updating:{dependsOn:["noReferencePositionQueries"],readOnly:!0,get:function(){return!(this.noReferencePositionQueries||
!this._referencePosUpdateQuery&&!this._referencePosMapCoordsRequested)}},noReferencePositionQueries:{},view:{},_environmentRenderer:{}},constructor:function(){this._viewHandles=new g;this._environmentRenderer=null;this._viewConnected=this._trackingEnabled=this._preserveAbsoluteDateTime=!1;this._referencePosResetPreserveAbsoluteTime=null;this._resetReferencePosition()},destroy:function(){this._viewHandles.destroy();this.disposeRendering()},disposeRendering:function(){this._environmentRenderer&&(this._environmentRenderer.destroy(),
this._environmentRenderer=null);this._resetReferencePosition(!0)},updateReadyChange:function(a){a&&!this._viewConnected?(this._viewConnected=!0,this.connectView(this.view)):!a&&this._viewConnected&&(this._viewConnected=!1,this.disconnectView(this.view))},connectView:function(a){this._environmentRenderer=new q({view:a});this._viewHandles.add([b.on(this.view,"environment.lighting","date-will-change",this._lightingDateHandler.bind(this)),this.view.watch("interacting,stationary",this._interactingStationaryHandler.bind(this)),
this.view.watch("environment.lighting.directShadowsEnabled,environment.lighting.ambientOcclusionEnabled",this._updateRenderParamsHandler.bind(this)),this.view.watch("spatialReference",this._spatialReferenceHandler.bind(this)),b.init(this.view,"viewingMode",this._viewingModeHandler.bind(this)),b.init(this.view,"environment.lighting.cameraTrackingEnabled",this._updateCameraTracking.bind(this),!0),this.watch("noReferencePositionQueries",this._cameraHandler.bind(this,null))]);this._updateRenderParamsHandler();
this._updateLightParams();this._cameraHandler()},_updateCameraTracking:function(a){(this._trackingEnabled=a,a)?(a=b.init(this,"view.state.camera",this._cameraHandler.bind(this,null),!0),this._viewHandles.add(a,"camera")):((a=this.get("view.environment.lighting"))&&(a.positionTimezoneInfo.autoUpdated=!1),this._viewHandles.remove("camera"))},disconnectView:function(a){this.disposeRendering();this._viewHandles.removeAll()},_lightingDateHandler:function(a){if(a=a.date){var b=this.view.environment.lighting;
if(!b.positionTimezoneInfo.autoUpdated){this._preserveAbsoluteDateTime=!0;var e=this.view.spatialReference;if(!(e.isWGS84||e.isWebMercator||(e=this.view.camera.position,this._referencePosMapCoords&&this._referencePosMapCoords.equals(e))))return void this._requestReferencePositionUpdate(e);if(this._preupdateTracking(a),this._referencePosWGS84)e=c.positionToTimezone(this._referencePosWGS84,x),b.autoUpdate(null,e),this._trackingEnabled&&(b.positionTimezoneInfo.autoUpdated=!0)}this._updateLightParams(a)}},
_preupdateTracking:function(a){!this._trackingEnabled&&this.get("view.environment.lighting.cameraTrackingEnabled")&&this._cameraHandler(a)},_cameraHandler:function(a){if(this.view.ready){var b=this.view.camera;if(b){var c=this.view.spatialReference;c.isWGS84||c.isWebMercator?this._cameraHandlerGlobal(b,a):this._cameraHandlerLocal(b,a)}}},_cameraHandlerGlobal:function(b,c){b=b.position;this._referencePosWGS84||(this._referencePosWGS84=new k({spatialReference:a.WGS84}));b.spatialReference.isWebMercator?
f.webMercatorToGeographic(b,!1,this._referencePosWGS84):(this._referencePosWGS84.x=b.x,this._referencePosWGS84.y=b.y);this._referencePosWGS84.z=b.z;this._autoUpdateTimezone(b,c)||this._updateLightParams(c)},_cameraHandlerLocal:function(a,b){a=a.position;(!this._referencePosMapCoords||this._referencePosMapCoordsRequested||this._exceedsReferencePosDistThreshold(a))&&this._requestReferencePositionUpdate(a,!0);this.view.mapCoordsHelper&&this._referencePosWGS84&&(this._referencePosWGS84.z=a.z*this.view.mapCoordsHelper.unitInMeters,
this._referencePosChanged())},_interactingStationaryHandler:function(){!this.view.interacting&&this.view.stationary&&this._executePendingReferencePositionUpdate()},_mainLight:new t.MainLight,_ambientLight:new t.AmbientLight,_moonLight:new t.FillLight,_updateLightParams:function(a){var b=this.view.environment.lighting;a=a||b.date;var c,b=this.view._stage;this._referencePosWGS84?(c=e.computeColorAndIntensity(a,this._referencePosWGS84),e.computeDirection(a,this._referencePosWGS84,this.view.viewingMode,
c.diffuse.direction)):c={diffuse:{color:[1,1,1],intensity:.55,direction:y},ambient:{color:[1,1,1],intensity:.55},noonFactor:.5,globalFactor:0};u.scale(c.diffuse.color,c.diffuse.intensity*Math.PI,this._mainLight.intensity);u.negate(c.diffuse.direction,this._mainLight.direction);u.scale(c.ambient.color,c.ambient.intensity,this._ambientLight.intensity);u.lerp(n,w,c.globalFactor,this._moonLight.intensity);u.scale(this._moonLight.intensity,(1-.5*c.globalFactor)*(1-.4*c.noonFactor*(1-c.globalFactor)));
u.set(c.diffuse.direction,this._moonLight.direction);b.setLighting({lights:[this._mainLight,this._ambientLight,this._moonLight],globalFactor:c.globalFactor,groundLightingFactor:1-c.noonFactor});this._updateRenderParamsHandler()},_autoUpdateTimezone:function(a,b){if(!this.view.get("environment.lighting.cameraTrackingEnabled"))return!1;v.setTime((b||this.view.environment.lighting.date).getTime());a=c.positionToTimezone(a,x);var e=this.view.environment.lighting.positionTimezoneInfo;if(e.autoUpdated){if(e.hours===
a.hours&&e.minutes===a.minutes&&e.seconds===a.seconds)return!1}else e=a;var d=v.getUTCHours()-(a.hours-e.hours),f=v.getUTCMinutes()-(a.minutes-e.minutes),e=v.getUTCSeconds()-(a.seconds-e.seconds);return v.setUTCHours(d),v.setUTCMinutes(f),v.setUTCSeconds(e),b?!1:this.view.environment.lighting.autoUpdate(v,a)},_updateRenderParamsHandler:function(){var a=this.view._stage,b=!0;this._referencePosWGS84&&(b=e.computeShadowsEnabled(this._referencePosWGS84,this.view.viewingMode));a&&a.setRenderParams({shadowMap:this.view.environment.lighting.directShadowsEnabled&&
b,ssao:this.view.environment.lighting.ambientOcclusionEnabled})},_spatialReferenceHandler:function(){this._resetReferencePosition()},_viewingModeHandler:function(a){this._resetReferencePosition()},_resetReferencePosition:function(a){this._cancelReferencePosUpdates();this._referencePosWGS84=this._referencePosResetPreserveAbsoluteTime=this._referencePosMapCoordsRequested=this._referencePosMapCoords=null;a||this.notifyChange("updating")},_requestReferencePositionUpdate:function(a,b){if(this.view.mapCoordsHelper.canProject()&&
!this.noReferencePositionQueries&&(this._referencePosMapCoordsRequested?this._referencePosMapCoordsRequested.copy(a):this._referencePosMapCoordsRequested=a.clone(),this._referencePosResetPreserveAbsoluteTime=!!b,!this._referencePosUpdateQuery&&!this._referencePosUpdateTimer&&!this.view.interacting&&this.view.stationary)){var c=this,e=this._referencePosUpdateQuery=d.after(this.referencePointUpdateDelay).then(function(){if(c._referencePosUpdateQuery===e)return c._doReferencePositionUpdateQuery(function(){return c._referencePosUpdateQuery!==
e})}).always(function(){c._referencePosUpdateQuery===e&&(c._referencePosUpdateQuery=null,c._referencePosUpdateTimer||c._executePendingReferencePositionUpdate(),c.notifyChange("updating"))}),f=this._referencePosUpdateTimer=d.after(this.referencePointUpdateInterval).then(function(){c._referencePosUpdateTimer===f&&(c._referencePosUpdateTimer=null,c._referencePosUpdateQuery||c._executePendingReferencePositionUpdate())});this.notifyChange("updating")}},_doReferencePositionUpdateQuery:function(b){return this._referencePosResetPreserveAbsoluteTime&&
(this._preserveAbsoluteDateTime=!1),this._referencePosMapCoords?this._referencePosMapCoords.copy(this._referencePosMapCoordsRequested):this._referencePosMapCoords=this._referencePosMapCoordsRequested.clone(),this._referencePosResetPreserveAbsoluteTime=null,this._referencePosMapCoordsRequested=null,this.view.mapCoordsHelper.toGeographic(this._referencePosMapCoords).then(function(c){if(!b()&&!isNaN(c[0])&&!isNaN(c[1])){var e=this._referencePosMapCoords.z*this.view.mapCoordsHelper.unitInMeters;this._referencePosWGS84?
(this._referencePosWGS84.x=c[0],this._referencePosWGS84.y=c[1],this._referencePosWGS84.z=e):this._referencePosWGS84=new k({x:c[0],y:c[1],z:e,spatialReference:a.WGS84});this._referencePosChanged()}}.bind(this))},_executePendingReferencePositionUpdate:function(){var a=this._referencePosMapCoordsRequested;a&&this._requestReferencePositionUpdate(a,this._referencePosResetPreserveAbsoluteTime)},_referencePosChanged:function(){this._preserveAbsoluteDateTime?this._updateLightParams():this._autoUpdateTimezone(this._referencePosWGS84)||
this._updateLightParams()},_exceedsReferencePosDistThreshold:function(a){return this._referencePosMapCoords?(a=this._referencePosMapCoords.distance(a),this.view.mapCoordsHelper&&(a*=this.view.mapCoordsHelper.unitInMeters),a>this.referencePointUpdateDistThreshold):!0},_cancelReferencePosUpdates:function(){this._referencePosUpdateTimer=this._referencePosUpdateQuery=null}});return m.FIXED_LIGHT_DIRECTION=y,m})},"esri/views/3d/support/sunUtils":function(){define(["./mathUtils","../lib/glMatrix","../lib/SunCalc"],
function(m,l,h){var d=l.vec3d,b=l.mat4d,g=m.lerp,k=b.identity(),f={azimuth:0,altitude:0},a={local:{altitude:1500,ambientAtNight:.1,ambientAtNoon:.45,ambientAtTwilight:.2,diffuseAtNoon:.65,diffuseAtTwilight:.7},global:{altitude:8E5,ambient:.015,diffuse:.75},planarDirection:{localAltitude:1E4,globalAltitude:1E6,globalAngles:{azimuth:Math.PI/3,altitude:Math.PI/3}}},e={ambient:{color:d.create(),intensity:0},diffuse:{color:d.create(),intensity:0,direction:d.create()}},c={settings:a,computeDirection:function(a,
e,g,l){l||(l=d.create());var q=b.identity(k);if("global"===g)h.getPosition(a,0,0,f),d.set3(0,0,-1,l),b.rotateX(q,-f.azimuth),b.rotateY(q,-f.altitude);else{var r=c.settings.planarDirection;g=r.globalAngles;r=(Math.abs(e.z)-r.localAltitude)/(r.globalAltitude-r.localAltitude);r=m.clamp(r,0,1);1>r?(h.getPosition(a,e.y,e.x,f),f.azimuth=(1-r)*f.azimuth+r*g.azimuth,f.altitude=(1-r)*f.altitude+r*g.altitude):(f.azimuth=g.azimuth,f.altitude=g.altitude);d.set3(0,-1,0,l);b.rotateZ(q,-f.azimuth);b.rotateX(q,-f.altitude)}b.multiplyVec3(q,
l);return l},computeShadowsEnabled:function(a,b){return"global"===b?!0:Math.abs(a.z)<c.settings.planarDirection.localAltitude},computeColorAndIntensity:function(b,f){var k=f.z,l=c.settings;d.set3(1,1,1,e.ambient.color);e.ambient.intensity=l.global.ambient;d.set3(1,1,1,e.diffuse.color);e.diffuse.intensity=l.global.diffuse;k=(Math.abs(k)-l.local.altitude)/(l.global.altitude-l.local.altitude);k=m.clamp(k,0,1);e.globalFactor=k;f=h.getTimes(b,f.y,f.x);if(1>k){var r,t,l=b.valueOf();f.polarException===h.POLAR_EXCEPTION.MIDNIGHT_SUN?
(r=l-36E5*(b.getHours()+48)-6E4*b.getMinutes(),t=r+432E6):f.polarException===h.POLAR_EXCEPTION.POLAR_NIGHT?(r=l-2,t=l-1):(r=f.sunrise.valueOf(),t=f.sunset.valueOf());var n,w,z=t-r,C=r+z/2,B=z/4,F=C-B,B=C+B,G=.06*z,z=r-G/2;r+=G/2;var N=t-G/2;t+=G/2;var M=a.local,G=[.01,M.ambientAtNight],R=[.8,.8,1],P=[.01,.01,.01],Q=[M.diffuseAtTwilight,M.ambientAtTwilight],T=[1,.75,.75],O=[.8,.8,1],S=[.9*M.diffuseAtNoon,M.ambientAtNoon],H=[1,.98,.98],Y=[.98,.98,1],W=[M.diffuseAtNoon,M.ambientAtNoon],E=[1,1,1],p=[1,
1,1],M=[0,0],A=[0,0],K=[0,0],l=(z>l||l>t?(M=G,A=P,K=R,w="night"):r>l?(n=r-z,M=q(l-z,n,G,Q),A=q(l-z,n,P,T),K=q(l-z,n,R,O),w="sun rising"):F>l?(n=F-r,M=q(l-r,n,Q,S),A=q(l-r,n,T,H),K=q(l-r,n,O,Y),w="early morning"):C>l?(n=C-F,M=q(l-F,n,S,W),A=q(l-F,n,H,E),K=q(l-F,n,Y,p),w="late morning"):B>l?(n=B-C,M=q(l-C,n,W,S),A=q(l-C,n,E,H),K=q(l-C,n,p,Y),w="early afternoon"):N>l?(n=N-B,M=q(l-B,n,S,Q),A=q(l-B,n,H,T),K=q(l-B,n,Y,O),w="late afternoon"):t>l&&(n=t-N,M=q(l-N,n,Q,G),A=q(l-N,n,T,P),K=q(l-N,n,O,R),w="sun setting"),
{diffuse:{intensity:M[0],color:A},ambient:{intensity:M[1],color:K},timeOfDay:w});d.lerp(l.ambient.color,e.ambient.color,k,e.ambient.color);e.ambient.intensity=g(l.ambient.intensity,e.ambient.intensity,k);d.lerp(l.diffuse.color,e.diffuse.color,k,e.diffuse.color);e.diffuse.intensity=g(l.diffuse.intensity,e.diffuse.intensity,k)}var U,V;n=b.valueOf();f.polarException===h.POLAR_EXCEPTION.MIDNIGHT_SUN?(U=n-36E5*(b.getHours()+48)-6E4*b.getMinutes(),V=U+432E6):f.polarException===h.POLAR_EXCEPTION.POLAR_NIGHT?
(U=n-2,V=n-1):(U=f.sunrise.valueOf(),V=f.sunset.valueOf());b=1-m.clamp(Math.abs(n-(U+(V-U)/2))/432E5,0,1);return e.noonFactor=b,e}},q=function(a,b,c,e){for(var d=[],f=0;f<c.length;f++)d[f]=(e[f]-c[f])*a/b+c[f];return d};return c})},"esri/views/3d/lib/SunCalc":function(){define([],function(){function m(a){return new Date((a+.5-n)*y)}function l(a,b){return u(c(a)*q(C)-t(b)*c(C),q(a))}function h(a,b){return r(c(b)*q(C)+q(b)*c(C)*c(a))}function d(a,b,e){return u(c(a),q(a)*c(b)-t(e)*q(b))}function b(a,
b,e){return r(c(b)*c(e)+q(b)*q(e)*q(a))}function g(a){return x*(1.9148*c(a)+.02*c(2*a)+3E-4*c(3*a))}function k(a,b){a=x*(357.5291+.98560028*a);var c=g(a);a=a+c+102.9372*x+e;return b||(b={dec:0,ra:0}),b.dec=h(a,0),b.ra=l(a,0),b}function f(a,b,e){return w+a+.0053*c(b)-.0069*c(2*e)}function a(a){var b=x*(134.963+13.064993*a),e=x*(93.272+13.22935*a);a=x*(218.316+13.176396*a)+6.289*x*c(b);e=5.128*x*c(e);b=385001-20905*q(b);return{ra:l(a,e),dec:h(a,e),dist:b}}var e=Math.PI,c=Math.sin,q=Math.cos,t=Math.tan,
r=Math.asin,u=Math.atan2,v=Math.acos,x=e/180,y=864E5,n=2440588,w=2451545,z={dec:0,ra:0},C=23.4397*x,B={POLAR_EXCEPTION:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(a,c,e,f){e=x*-e;c*=x;var g=a.valueOf()/y-.5+n-w;a=k(g,z);e=x*(280.16+360.9856235*g)-e-a.ra;return f||(f={azimuth:0,altitude:0}),f.azimuth=d(e,c,a.dec),f.altitude=b(e,c,a.dec),f}},F=[[-.83,"sunrise","sunset"]];B.addTime=function(a,b,c){F.push([a,b,c])};return B.getTimes=function(a,b,d){function k(a){var b=u,d=N;a=v((c(a)-
c(b)*c(d))/(q(b)*q(d)));return f(9E-4+(a+t)/(2*e)+z,C,G)}var l,r,t=x*-d,u=x*b,z=Math.round(a.valueOf()/y-.5+n-w-9E-4-t/(2*e));a=9E-4+(0+t)/(2*e)+z;var C=x*(357.5291+.98560028*a);b=g(C);var G=C+b+102.9372*x+e,N=h(G,0),E=f(a,C,G),p={solarNoon:m(E),nadir:m(E-.5),polarException:B.POLAR_EXCEPTION.NORMAL};a=0;for(b=F.length;b>a;a+=1)d=F[a],l=k(d[0]*x),r=E-(l-E),p[d[1]]=m(r),p[d[2]]=m(l);return p.polarException=function(a){a=(c(a)-c(u)*c(N))/(q(u)*q(N));return-1>a?B.POLAR_EXCEPTION.MIDNIGHT_SUN:1<a?B.POLAR_EXCEPTION.POLAR_NIGHT:
B.POLAR_EXCEPTION.NORMAL}(F[0][0]*x),p},B.getMoonPosition=function(c,e,f){f=x*-f;e*=x;var g=c.valueOf()/y-.5+n-w;c=a(g);f=x*(280.16+360.9856235*g)-f-c.ra;g=b(f,e,c.dec);return g+=.017*x/t(g+10.26*x/(g+5.1*x)),{azimuth:d(f,e,c.dec),altitude:g,distance:c.dist}},B.getMoonFraction=function(b){var e=b.valueOf()/y-.5+n-w;b=k(e);e=a(e);b=v(c(b.dec)*c(e.dec)+q(b.dec)*q(e.dec)*q(b.ra-e.ra));b=u(149598E3*c(b),e.dist-149598E3*q(b));return(1+q(b))/2},B})},"esri/views/3d/environment/EnvironmentRenderer":function(){define("../../../core/watchUtils ../support/ExternalRenderer ./PanoramicAtmosphere ./RealisticAtmosphere ./SimpleAtmosphere ./Stars ../webgl-engine/lib/RenderSlot".split(" "),
function(m,l,h,d,b,g,k){return l.createSubclass({declaredClass:"esri.views.3d.environment.EnvironmentRenderer",properties:{view:{},viewingMode:{dependsOn:["view.viewingMode"],get:function(){return this.get("view.viewingMode")||"global"}},atmosphereQuality:{dependsOn:["view.environment.atmosphereEnabled","view.environment.atmosphere.quality"],get:function(){return this.get("view.environment.atmosphereEnabled")?this.get("view.environment.atmosphere.quality")||"none":"none"}},starsEnabled:{dependsOn:["view.environment.starsEnabled"],
get:function(){return this.get("view.environment.starsEnabled")||!1}},transparent:{dependsOn:["view.basemapTerrain.opacity","view.basemapTerrain.wireframe"],get:function(){var b=this.get("view.basemapTerrain");return b&&b._renderer.isTransparent()}},_atmosphere:{},_stars:{},needsRender:{dependsOn:["_stars.needsRender","_atmosphere.needsRender"],get:function(){return!!(this._needsRender||this._atmosphere&&this._atmosphere.needsRender||this._stars&&this._stars.needsRender)}}},constructor:function(){this._STANDARD_SLOT=
k.BACKGROUND;this._SPECIAL_SLOT=k.POSTPROCESSING_ATMOSPHERE;this._slots=[this._STANDARD_SLOT,this._SPECIAL_SLOT];this._stars=this._atmosphere=this._atmosphereReadyPromise=this._AtmosphereClass=null;this._needsRender=!0;this.notifyChange("needsRender")},initialize:function(){this.view._stage.addExternalRenderer(this._slots,this);this._basemapTerrainHandle=m.when(this.view,"basemapTerrain",this._updateBasemapTerrain.bind(this))},destroy:function(){this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=
null);this._stars&&(this._stars.destroy(),this._stars=null);this._basemapTerrainHandle&&this._basemapTerrainHandle.remove();this.view&&(this.view._stage.removeExternalRenderer(this),this.view=null)},setup:function(b){this.watch("viewingMode,atmosphereQuality,transparent,visible",this._updateAtmosphere.bind(this));this._updateAtmosphere();this.watch("starsEnabled,transparent,visible",this._updateStars.bind(this));this._updateStars();this.watch("view.basemapTerrain.loaded",function(){this._needsRender=
!0;this.notifyChange("needsRender")}.bind(this))},resetNeedsRender:function(){this._atmosphere&&(this._atmosphere.resetNeedsRender?this._atmosphere.resetNeedsRender():this._atmosphere.didRender&&(this._atmosphere.needsRender=!1,this._atmosphere.didRender=!1));this._stars&&(this._stars.resetNeedsRender?this._stars.resetNeedsRender():this._stars.didRender&&(this._stars.needsRender=!1,this._stars.didRender=!1));this.didRender&&(this._needsRender=!1,this.didRender=!1,this.notifyChange("needsRender"))},
render:function(b){return this.get("view.basemapTerrain.loaded")||"global"!==this.viewingMode?this._stars||this._atmosphere?(this._stars&&this._stars.render(b),this._atmosphere&&this._atmosphere.render(b),this._stars&&this._stars.didRender||this._atmosphere&&this._atmosphere.didRender):!0:!1},_updateStars:function(){var b=this._getAtmosphereSlot();this.starsEnabled&&!this._stars?(this._stars=new g({view:this.view,slot:b}),this._stars.initializeRenderContext(this.renderContext)):!this.starsEnabled&&
this._stars?(this._stars.destroy(),this._stars=null):this._stars&&(this._stars.slot=b);this._needsRender=!0;this.notifyChange("needsRender")},_updateAtmosphere:function(){var b=this._getAtmosphereSlot();if(this._atmosphere&&(this._atmosphere.slot=b),this._updateAtmosphereClass(this.renderContext)){this._needsRender=!0;this.notifyChange("needsRender");var a=function(){this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=null)}.bind(this);if(!this._AtmosphereClass)return a(),void this._updateBasemapTerrain();
this._atmosphereReadyPromise&&(this._atmosphereReadyPromise.cancel(),this._atmosphereReadyPromise=null);var e=new this._AtmosphereClass({view:this.view,slot:b});e.initializeRenderContext(this.renderContext);this._atmosphere?this._atmosphereReadyPromise=e.when(function(){a();this._atmosphereReadyPromise=null;this._atmosphere=e}.bind(this)):this._atmosphere=e;e.when(this._updateBasemapTerrain.bind(this))}},_updateAtmosphereClass:function(f){var a=this._AtmosphereClass;return"none"===this.atmosphereQuality?
this._AtmosphereClass=null:"high"===this.atmosphereQuality&&!this.transparent&&d.isSupported(f)?"local"===this.viewingMode?this._AtmosphereClass=h:this._AtmosphereClass=d:"local"===this.viewingMode?this._AtmosphereClass=h:this._AtmosphereClass=b,this._AtmosphereClass!==a},_getAtmosphereSlot:function(){return this.transparent&&"global"===this.viewingMode?this._SPECIAL_SLOT:this._STANDARD_SLOT},_updateBasemapTerrain:function(){var b=this.get("view.basemapTerrain");b&&(b.velvetOverground=!(!this._AtmosphereClass||
this._AtmosphereClass===d))}})})},"esri/views/3d/support/ExternalRenderer":function(){define("../../../core/declare ../../../core/Accessor ../../../core/Promise dojo/Deferred dojo/aspect dojo/_base/lang".split(" "),function(m,l,h,d,b,g){return m([l,h],{"-chains-":g.mixin(l._meta.chains,{setup:"after",initializeRenderContext:"after",uninitializeRenderContext:"before"}),properties:{gl:{readOnly:!0,get:function(){return this._gl}},needsRender:{value:!0},visible:{value:!0}},constructor:function(){this.didRender=
!1;this.renderContext=null;this.watch("visible",function(){this.needsRender=!0}.bind(this));this._contextDfd=new d},initialize:function(){this.addResolvingPromise(this._contextDfd.promise);b.around(this,"render",function(b){return function(){return this.isRejected()?(this.didRender=!0,!0):!this.isResolved()||this.visible&&!b.apply(this,arguments)?!1:(this.didRender=!0,!0)}.bind(this)}.bind(this));this.when(function(){this.destroyed||this.setup(this.renderContext)}.bind(this))},needsRender:!0,visible:!0,
initializeRenderContext:function(b){this.renderContext=b;this._contextDfd.resolve()},uninitializeRenderContext:function(b){},setup:function(b){},render:function(b){return!1}})})},"esri/views/3d/environment/PanoramicAtmosphere":function(){define("dojo/text!./materials/SimpleAtmosphereMaterial.xml dojo/Deferred ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/Texture ../webgl-engine/lib/Util ../webgl-engine/lib/GLTextureRep ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ./resources/SimpleAtmosphereTexture ../../webgl/Program ../webgl-engine/lib/DefaultVertexBufferLayouts ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){var v=d.vec2d,x=d.vec3d,y=d.mat4d,n=f.VertexAttrConstants,w=y.create();return h.createSubclass({declaredClass:"esri.views.3d.environment.PanoramicAtmosphere",properties:{view:{},needsRender:{value:!1},slot:{value:c.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={texV:v.create(),silCircleCenter:x.create(),silCircleV1:x.create(),silCircleV2:x.create()};this._textureRep=this._texture=null;this.slot=
c.BACKGROUND},initialize:function(){this._textureDfd=new l;this.addResolvingPromise(this._textureDfd.promise)},destroy:function(){this._textureRep&&(this._texture&&(this._textureRep.release("SimpleAtmosphere"),this._textureRep.getTexture("SimpleAtmosphere").unload()),this._textureRep=null);this._program&&(this._program.dispose(),this._program=null);this._textureDfd&&(this._textureDfd.cancel(),this._textureDfd=null)},initializeRenderContext:function(b){this._textureRep=new a({SimpleAtmosphere:new k(q,
"SimpleAtmosphere",{wrapClamp:!0})},b.programRep,function(){return this.view.state.camera.viewport}.bind(this),b.rctx);this._texture=this._textureRep.aquire("SimpleAtmosphere",void 0,void 0,function(a){this._texture=a.getGLTexture();this._textureDfd.resolve();this._textureDfd=null}.bind(this))},setup:function(a){var c=this._createGeometryData(),e=this.renderContext.rctx;this._renderer=new b(c,r.Pos3,null,e);a.shaderSnippets.vsSimpleAtmosphere||a.shaderSnippets._parse(m);this._program=new t(e,a.shaderSnippets.vsSimpleAtmosphere,
a.shaderSnippets.fsSimpleAtmosphere,u.Default3D,["PANORAMIC"])},render:function(a){if(a.slot!==this.slot||a.pass!==e.MATERIAL||!this._textureRep.getIsLoaded("SimpleAtmosphere"))return!1;var b=this.renderContext.rctx,c=b.gl,d=this._program;return b.bindProgram(d),b.bindTexture(this._texture),d.setUniform1i("tex",0),d.setUniformMatrix4fv("proj",a.camera.projectionMatrix),y.toRotationMat(a.camera.viewMatrix,w),d.setUniformMatrix4fv("view",w),d.setUniform4f("color",1,1,1,1),d.setUniform3fv("lightDirection",
a.lightingData.direction),b.setFaceCullingEnabled(!0),b.setDepthFunction(c.LEQUAL),b.setBlendingEnabled(!0),b.setDepthWriteEnabled(!1),this._renderer.render(this._program),b.setDepthWriteEnabled(!0),b.setBlendingEnabled(!1),b.setDepthFunction(c.LESS),b.setFaceCullingEnabled(!1),!0},_createGeometryData:function(){for(var a=g.createPolySphereGeometry(1,2),b=a.indices[n.POSITION],c=0;c<b.length;c+=3){var e=b[c];b[c]=b[c+2];b[c+2]=e}b=a.getVertexAttr();e=b[n.NORMAL].data;for(c=0;c<e.length;c++)e[c]=-e[c];
return{indices:a.indices,vertexAttr:b}}})})},"esri/views/3d/webgl-engine/lib/GeometryRenderer":function(){define("require exports ../materials/internal/MaterialUtil ./Util ./DefaultVertexAttributeLocations ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums".split(" "),function(m,l,h,d,b,g,k,f,a){return function(){function a(a,e,l,r){this._drawMode=4;this._count=a.indices[d.VertexAttrConstants.POSITION].length;var c=new Float32Array(this._count*f.getStride(e)/
4);l?l(a,void 0,void 0,null,e,c,0):h.fillInterleaved(a,void 0,void 0,null,e,c,0);this._rctx=r;this._vao=new g(r,b.Default3D,{geometry:e},{geometry:k.createVertex(r,35044,c)})}return a.prototype.enablePointRendering=function(a){this._drawMode=a?0:4},a.prototype.render=function(a){var b=this._rctx;b.bindVAO(this._vao);f.assertCompatibleVertexAttributeLocations(this._vao,a);b.drawArrays(this._drawMode,0,this._count)},a}()})},"esri/views/3d/webgl-engine/materials/internal/MaterialUtil":function(){define("require exports ../../lib/IdGen ../../lib/gl-matrix ../../lib/ComponentUtils ../../lib/Util ../../parts/Model ../../lib/screenSizePerspectiveUtils ../../../../webgl/Util ../../../support/aaBoundingBox".split(" "),
function(m,l,h,d,b,g,k,f,a,e){function c(a,b,c,e,d,f){if(void 0===d||3!==f)for(d=0;f>d;++d)c[e+d]=a[b+d];else{var g=a[b],k=a[b+1];a=a[b+2];c[e]=d[0]*g+d[4]*k+d[8]*a+d[12];c[e+1]=d[1]*g+d[5]*k+d[9]*a+d[13];c[e+2]=d[2]*g+d[6]*k+d[10]*a+d[14]}return f}function q(a,b,c,e,d,f){for(var g=a.length,k=0;g>k;++k){for(var h=c*a[k],l=0;c>l;++l)e[d+l]=b[h+l];d+=f}}function t(a,b,c,e,d,f){e=new Uint8Array(e.buffer);d*=4;f*=4;var g=a.length;if(4===c)for(c=0;g>c;++c){var k=4*a[c];e[d]=b[k];e[d+1]=b[k+1];e[d+2]=b[k+
2];e[d+3]=b[k+3];d+=f}else if(3===c)for(c=0;g>c;++c)k=3*a[c],e[d]=b[k],e[d+1]=b[k+1],e[d+2]=b[k+2],e[d+3]=255,d+=f}function r(a,b,c,d,f){var g=v(b,c,G);if(e.setMin(B,a.getBBMin()),e.setMax(B,a.getBBMax()),x(B,b,g,d)){var g=a.getPrimitiveIndices(),k=a.getIndices(),h=a.getPosition(),l=g?g.length:k.length/3;if(1E4<l&&(a=a.getChildren(),void 0!==a)){for(g=0;8>g;++g)void 0!==a[g]&&r(a[g],b,c,d,f);return}u(b,c,0,l,k,h,g,f)}}function u(a,b,c,e,f,g,k,h){var l=g.data,n=g.offsetIdx;g=g.strideIdx;var p=a[0],
q=a[1];a=a[2];var r=b[0]-p,m=b[1]-q;for(b=b[2]-a;e>c;c++){var t=k?k[c]:c,u=n+g*f[3*t],v=n+g*f[3*t+1],w=n+g*f[3*t+2],x=l[u],y=l[u+1],z=l[u+2],u=l[v]-x,C=l[v+1]-y,v=l[v+2]-z,A=l[w]-x,F=l[w+1]-y,w=l[w+2]-z,B=m*w-F*b,G=b*A-w*r,H=r*F-A*m,D=u*B+C*G+v*H,x=p-x,E=q-y,O=a-z,y=E*v-C*O,z=O*u-v*x,S=x*C-u*E;if(D>N){B=x*B+E*G+O*H;if(0>B||B>D)continue;G=r*y+m*z+b*S;if(0>G||B+G>D)continue}else{if(!(-N>D))continue;B=x*B+E*G+O*H;if(0<B||D>B)continue;G=r*y+m*z+b*S;if(0<G||D>B+G)continue}D=(A*y+F*z+w*S)/D;0<=D&&(B=M,
u=(d.vec3d.set3(u,C,v,R),d.vec3d.set3(A,F,w,P),d.vec3d.normalize(d.vec3d.cross(R,P,B))),h(D,u,t))}}function v(a,b,c){return d.vec3d.set3(1/(b[0]-a[0]),1/(b[1]-a[1]),1/(b[2]-a[2]),c)}function x(a,b,c,e){var d=(a[0]-e-b[0])*c[0],f=(a[3]+e-b[0])*c[0],g=Math.min(d,f),d=Math.max(d,f),f=(a[1]-e-b[1])*c[1],k=(a[4]+e-b[1])*c[1];if(g=Math.max(g,Math.min(f,k)),d=Math.min(d,Math.max(f,k)),g>d)return!1;f=(a[2]-e-b[2])*c[2];a=(a[5]+e-b[2])*c[2];return g=Math.max(g,Math.min(f,a)),d=Math.min(d,Math.max(f,a)),d>=
g}function y(a,b,c,e){return void 0!==a?c.aquire(a,b,e):void 0}function n(a,b){void 0!==a&&b.release(a)}function w(a,b){b=b?w(b):{};for(var c in a){var e=a[c];e&&e.forEach&&(e=z(e));null==e&&c in b||(b[c]=e)}return b}function z(a){var b=[];return a.forEach(function(a){return b.push(a)}),b}Object.defineProperty(l,"__esModule",{value:!0});var C=d.mat4d.create(),B=e.create(),F=g.VertexAttrConstants;l.__Material_idGen=new h;l.__GLMaterial_id=0;l.IDENTITY=d.mat4d.identity();l.fill=c;l.fillInterleaved=
function(b,c,e,d,f,g,k,h){for(var l=a.getStride(f)/4,n=0;n<f.length;n++){var p=f[n],r=k+p.offset/4,p=p.name,m=b.vertexAttr[p];if(null!=m&&(null==h||null!=h[p]))switch(p){case "uv0":q(b.indices[p],m.data,m.size,g,r,l);break;case "region":for(var p=b.indices[p],u=m.data,v=m.size,m=g,w=l,m=new Uint16Array(m.buffer),r=2*r,w=2*w,x=p.length,y=0;x>y;++y){for(var z=v*p[y],C=0;v>C;++C)m[r+C]=u[z+C];r+=w}break;case "color":if(d&&d.color)if(p=b.indices[p],u=m.data,v=d.color,y=m.size,m=g,w=l,m=new Uint8Array(m.buffer),
r*=4,w*=4,x=p.length,4===y)for(y=0;x>y;++y)z=4*p[y],m[r]=u[z]*v[0],m[r+1]=u[z+1]*v[1],m[r+2]=u[z+2]*v[2],m[r+3]=u[z+3]*v[3],r+=w;else{if(3===y)for(C=255*v[3],y=0;x>y;++y)z=3*p[y],m[r]=u[z]*v[0],m[r+1]=u[z+1]*v[1],m[r+2]=u[z+2]*v[2],m[r+3]=C,r+=w}else t(b.indices[p],m.data,m.size,g,r,l);break;case "symbolColor":t(b.indices[p],m.data,m.size,g,r,l);break;default:if(v=p===F.POSITION?c:p===F.NORMAL?e:void 0,void 0!==v&&3===m.size)for(p=b.indices[p],u=m.data,m=g,w=l,x=p.length,y=0;x>y;++y){var A=3*p[y],
z=u[A],C=u[A+1],A=u[A+2];m[r]=v[0]*z+v[4]*C+v[8]*A+v[12];m[r+1]=v[1]*z+v[5]*C+v[9]*A+v[13];m[r+2]=v[2]*z+v[6]*C+v[10]*A+v[14];r+=w}else q(b.indices[p],m.data,m.size,g,r,l)}}};l.triangleVertexArrayToWireframeLines=function(a,b,e,d){for(e=Math.floor(e/3)-1;0<=e;e--){var f=b+3*e*d,g=b+6*e*d+5*d;c(a,f,a,g,null,d);g-=d;c(a,f+d,a,g,null,d);g-=d;c(a,f+d,a,g,null,d);g-=d;c(a,f+2*d,a,g,null,d);g-=d;c(a,f+2*d,a,g,null,d);g-=d;c(a,f,a,g,null,d)}};l.intersectTriangleGeometry=function(a,c,d,f,k,h,l){g.assert("triangle"===
a.data.primitiveType);c=c.componentVisibilities;f=f.tolerance;var n=a.getBoundingInfo();if(1<a.getComponentCount()){if(d=v(k,h,G),e.setMin(B,n.getBBMin()),e.setMax(B,n.getBBMax()),x(B,k,d,f))for(var p=a.data,n=a.getComponentCount(),q=p.getIndices(F.POSITION),m=p.getAttribute(F.POSITION),p=p.componentOffsets,t=0;n>t;t++)if(b.getVisibility(c,t)){var w=a.getComponentAABB(t,B);x(w,k,d,f)&&u(k,h,p[t]/3,p[t+1]/3,q,m,void 0,l)}}else b.getVisibility(c,0)&&r(n,k,h,f,l)};var G=d.vec3d.create(),N=Math.pow(2,
-52),M=d.vec3d.create(),R=d.vec3d.create(),P=d.vec3d.create();l.transformToWorld=function(a,b,c){return d.vec4d.set4(a[0]-b[0],a[1]-b[1],a[2]-b[2],1,c)};l.transformToView=function(a,b,c,e){return d.mat4d.translate(c,b,C),c=C,d.mat4d.multiplyVec4(c,a,e)};l.transformToProjection=function(a,b,c,e){return e[0]=a[0]+c[0],e[1]=a[1]+c[1],e[2]=a[2]+c[2],e[3]=a[3],d.mat4d.multiplyVec4(b,e)};l.transformToNDC=function(a,b){return d.vec4d.scale(a,1/Math.abs(a[3]),b)};l.applyScreenSizePerspectiveScale=function(a,
b,c,e,d){return f.scale(a,e,c,d)};l.verticalOffsetAtDistance=function(a,b,c,e,d){var k=c.screenLength||0;d&&(k=f.scale(k,e,b,d));return g.clamp(k*Math.tan(.5*a.fovY)/(.5*a.fullHeight)*b,c.minWorldLength||0,null!=c.maxWorldLength?c.maxWorldLength:1/0)};l.basicMaterialConstructor=function(a,b){var c=!0,e=!1,d=0,f=l.__Material_idGen.gen(b);a.getId=function(){return f};var h;a.getParentStage=function(){return h};a.addParentStage=function(a){g.assert(void 0===h,"Material can only be added to a single Stage");
h=a};a.removeParentStage=function(a){h=void 0};a.setVisible=function(b){c!==b&&(c=b,a.notifyDirty("matChanged"))};a.isVisible=function(){return c};a.setRenderOccluded=function(b){e!==b&&(e=b,a.notifyDirty("matChanged"))};a.isRenderOccluded=function(){return e};a.notifyDirty=function(b){h&&h.notifyDirty(k.ContentType.MATERIAL,a,b)};a.setRenderPriority=function(a){d=a;this.notifyDirty("matChanged")};a.getRenderPriority=function(){return d}};l.aquireIfNotUndefined=y;l.releaseIfNotUndefined=n;var Q=d.mat4.create();
l.bindView=function(a,b,c){d.mat4d.translate(b,a,Q);c.setUniform3fv("localOrigin",a);c.setUniformMatrix4fv("view",Q)};l.bindCamPos=function(a,b,c){c.setUniform3f("camPos",b[3]-a[0],b[7]-a[1],b[11]-a[2])};l.bindVerticalOffset=function(a,b,c){if(a){var e=b.fovY,d=b.viewport[3];b=void 0;a=(void 0===b&&(b=T),b.screenLength=a.screenLength,b.perDistance=Math.tan(.5*e)/(.5*d),b.minWorldLength=a.minWorldLength,b.maxWorldLength=a.maxWorldLength,b);c.setUniform4f("verticalOffset",a.screenLength,a.perDistance,
a.minWorldLength,a.maxWorldLength)}};l.bindScreenSizePerspective=function(a,b,c){if(void 0===c&&(c="screenSizePerspectiveAlignment"),a){var e=a.parameters;b.setUniform4f(c,e.divisor,e.offset,e.minPixelSize,a.paddingPixelsOverride)}};l.basicGLMaterialConstructor=function(a,b){var c=l.__GLMaterial_id++;a.getId=function(){return c};a.getMaterialId=function(){return b.getId()};a.isVisible=function(){return b.isVisible()};a.isRenderOccluded=function(){return b.isRenderOccluded()};a.getRenderPriority=function(){return b.getRenderPriority()}};
l.singleTextureGLMaterialConstructor=function(a,b,c,e){var d=y(c.textureId,c.initTexture,b,e);a.updateTexture=function(a){c.textureId!==a&&(n(c.textureId,b),c.textureId=a,d=y(c.textureId,c.initTexture,b,e))};a.renderTexture=function(a){(a=b.getTexture(c.textureId))&&a.dirty&&a.redraw&&a.redraw()};a.bindTexture=function(a,b){void 0!==d&&(b.setUniform1i("tex",0),a.bindTexture(d.getGLTexture()))};a.bindTextureSize=function(a,b){void 0!==d&&(a=d.getGLTexture(),b.setUniform2f("texSize",a.descriptor.width,
a.descriptor.height))};a.dispose=function(){n(c.textureId,b)}};l.multiTextureGLMaterialConstructor=function(a,b,c,e){for(var d=e.length,f=Array(d),g=0;d>g;g++)f[g]=y(c[e[g][0]],c[e[g][1]],b);a.updateTextures=function(a){for(var g=0;d>g;g++){var k=c[e[g][0]],h=a[e[g][0]];k!==h&&(n(k,b),c[e[g][0]]=h,f[g]=y(h,c[e[g][1]],b))}};a.bindTextures=function(a,b){for(var c=0;d>c;c++)void 0!==f[c]&&(b.setUniform1i(e[c][2],c),a.bindTexture(f[c].getGLTexture(),c));a.setActiveTexture(0)};a.bindOneTexture=function(a,
b,c){b.setUniform1i(e[c][2],c);a.bindTexture(f[c].getGLTexture(),c);a.setActiveTexture(0)};a.disposeTextures=function(){for(var a=0;d>a;a++)n(c[e[a][0]],b)}};l.copyParameters=w;l.updateParameters=function(a,b){var c=!1,e;for(e in b){var d=b[e];void 0!==d&&(c=!0,Array.isArray(d)?a[e]=d.slice():a[e]=d)}return c};l.colorMixModes={multiply:1,ignore:2,replace:3,tint:4};var T={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0}})},"esri/views/3d/webgl-engine/parts/Model":function(){define("require exports dojo/string ../lib/ModelContentType ../lib/ModelDirtySet ../lib/RenderGeometry ../lib/Util ../lib/gl-matrix".split(" "),
function(m,l,h,d,b,g,k,f){var a=k.assert,e=f.vec3d,c=f.mat4d,q=k.logWithBase;return function(){function f(){this.dirtySet=new b(this);this._uniqueIdx=0;this._id2origin={};this.content={};for(var a in d)this.content[d[a]]={}}return f.prototype.getAll=function(b){b=this.content[b];return a(void 0!==b),b},f.prototype.get=function(a,b){return this.getAll(a)[b]},f.prototype.add=function(b,c){var e=this.content[b];a(void 0!==e);var f=c.getId();a(null==e[f],"Model/Stage already contains object to be added");
e[f]=c;b===d.LAYER&&this.notifyDirty(b,c,"layerAdded")},f.prototype.remove=function(b,c){var e=this.content[b];a(void 0!==e);var f=e[c];return a(void 0!==f,"Model/Stage doesn't contain object to be removed"),delete e[c],b===d.TEXTURE&&f.unload(),b===d.LAYER&&this.notifyDirty(b,f,"layerRemoved"),f},f.prototype.getDirtySet=function(){return this.dirtySet},f.prototype.notifyDirty=function(a,b,c,e){this.dirtySet.handleUpdate(b,c,e)},f.prototype.getOrigin=function(a,b,c){void 0===c&&(c=10);var d=0;b=b*
c/1E4;1<b&&(d=Math.ceil(q(b,2)));b=1E4*Math.pow(2,d);c=Math.round(a[0]/b);var f=Math.round(a[1]/b);a=Math.round(a[2]/b);var d=d+"_"+c+"_"+f+"_"+a,g=this._id2origin[d];return null==g&&(g={vec3:e.createFrom(c*b,f*b,a*b),id:d},this._id2origin[d]=g),g},f.prototype.getGeometryRenderGeometries=function(a,b,e){var d=a.getId(),f=b.geometry,k=f.getData(),h=!!f.singleUse,l=b.materials,q=b.instanceParameters,r=a.getCombinedStaticTransformation(b),m=c.maxScale(r),t=b.origin,f=f.getBoundingInfo(),u=b.getId(),
v=this._uniqueIdx++;a=new g(k,f,l[0],r,b.customTransformation,m,a.getCastShadow(),h,d,u,v);a.origin=t||this.getOrigin(a.center,a.bsRadius);a.instanceParameters=q;e.push(a)},f.prototype.updateRenderGeometryTransformation=function(a,b,c){a.getCombinedStaticTransformation(b,c.transformation);c.updateTransformation(c.transformation)},f.prototype.formatDebugInfo=function(a){var b=[];if(a){b[0]="\x3ctable\x3e";for(var c in d)a=d[c],b[0]+="\x3ctr\x3e\x3ctd\x3e"+a+'\x3c/td\x3e\x3ctd style\x3d"text-align: right"\x3e'+
Object.keys(this.getAll(a)).length+"\x3c/td\x3e\x3c/tr\x3e";b[0]+="\x3c/table\x3e";b[1]=this.dirtySet.formatDebugInfo(!0)}else{b[0]="";for(c in d)a=d[c],b[0]+=h.pad(String(Object.keys(this.getAll(a)).length),6," ")+" "+a+", ";b[1]=this.dirtySet.formatDebugInfo(!1)}return b},f.prototype.validateContent=function(){var a=this.getAll(d.OBJECT),b;for(b in a)this.validateObject(a[b]);var a=this.getAll(d.LAYER),c;for(c in a)this.validateLayer(a[c]);c=this.getAll(d.MATERIAL);for(var e in c)this.validateMaterial(c[e])},
f.prototype.validateObject=function(b){b=b.geometryRecords;for(var c=0;c<b.length;++c){var e=b[c];a(null!=this.get(d.GEOMETRY,e.geometry.id));a(1===e.materials.length,"object materials do not match geometry groups");a(null!=this.get(d.MATERIAL,e.materials[0].getId()))}},f.prototype.validateLayer=function(b){b=b.getObjects();for(var c=0;c<b.length;++c){var e=this.get(d.OBJECT,b[c].getId());a(null!=e)}},f.prototype.validateMaterial=function(b){b=b.getAllTextureIds();for(var c=0;c<b.length;++c){var e=
this.get(d.TEXTURE,b[c]);a(null!=e)}},f.ContentType=d,f}()})},"esri/views/3d/webgl-engine/lib/ModelDirtySet":function(){define(["require","exports","./ModelContentType","./ModelDirtyTypesTs","./Util"],function(m,l,h,d,b){var g=b.objectEmpty,k=b.assert;return function(){function b(a){this._residentGeomRecords={};this._dirtyGeomRecords={};this._dirtyMaterials={};this._model=a}return Object.defineProperty(b.prototype,"residentLayerCount",{get:function(){return Object.keys(this._residentGeomRecords).length},
enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"residentObjectCount",{get:function(){var a=0,b;for(b in this._residentGeomRecords)a+=Object.keys(this._residentGeomRecords[b]).length;return a},enumerable:!0,configurable:!0}),b.prototype._getResidentGeometryRecords=function(){return this._residentGeomRecords},b.prototype._getDirtyGeometryRecords=function(){return this._dirtyGeomRecords},b.prototype.getDirtyMaterials=function(){return g(this._dirtyMaterials)?null:this._dirtyMaterials},
b.prototype.clearDirtyMaterials=function(){this._dirtyMaterials={}},b.prototype.hasDirtyGeometryRecords=function(){for(var a in this._dirtyGeomRecords)for(var b in this._dirtyGeomRecords[a]){var c=this._dirtyGeomRecords[a][b];if(c&&!g(c))return!0}return!1},b.prototype.handleUpdate=function(a,b,c){return k(this[b],"ModelDirtySet doesn't know how to process "+b),this[b](a,c)},b.prototype.shaderTransformationChanged=function(a){if(a=this._residentGeomRecords[a.getId()])for(var b in a){var c=this._model.content[h.OBJECT][b];
if(c&&c.hasVolativeTransformation()){var c=a[b],d;for(d in c)for(var f=0,g=c[d][1];f<g.length;f++)g[f].shaderTransformationChanged()}}},b.prototype.getAddRemoveUpdateList=function(a){return this.getAddRemoveUpdateListFilteredByLayers(Object.keys(this._dirtyGeomRecords),a)},b.prototype.getAddRemoveUpdateListFilteredByLayers=function(a,b){for(var c=[],e=[],d=[],f=0;f<a.length;f++){var l=a[f];if(l in this._dirtyGeomRecords){for(var m in this._dirtyGeomRecords[l]){var x=this._dirtyGeomRecords[l][m];if(x){var y=
this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,l,m),n;for(n in x){var w=x[n],z=w[0],C=w[1],w=w[2],B=2&C&&1&w;if(4&C||B){var F=y[n];F?e.push.apply(e,F[1]):4===C&&k(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid remove");b&&F&&delete y[n]}if(1&C||B){var F=[z,[]],G=this._model.get(h.OBJECT,m);this._model.getGeometryRenderGeometries(G,z,F[1]);c.push.apply(c,F[1]);b&&(y[n]=F)}if(2&C&&!B)if(F=y[n],G=this._model.get(h.OBJECT,m),F){C=F[1];B=C.length;if(16&w)for(F=0;B>F;F++){var N=
C[F];this._model.updateRenderGeometryTransformation(G,z,N)}for(F=0;B>F;F++)N=C[F],d.push({renderGeometry:N,updateType:w})}else k(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid update")}g(y)&&delete this._residentGeomRecords[l][m]}}g(this._residentGeomRecords[l])&&delete this._residentGeomRecords[l]}b&&delete this._dirtyGeomRecords[l]}return[c,e,d]},b.prototype.getResidentRenderGeometries=function(){return this.getResidentRenderGeometriesFilteredByLayers(Object.keys(this._residentGeomRecords))},
b.prototype.getResidentRenderGeometriesFilteredByLayers=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(d in this._residentGeomRecords)for(var f in this._residentGeomRecords[d]){var g=this._residentGeomRecords[d][f];if(g)for(var k in g)b.push.apply(b,g[k][1])}}return b},b.prototype.componentVisibilityChanged=function(a,b,c){if(null!=b)this._componentPropertyChanged(a,b,c,2);else{b=0;for(var e=a.getGeometryRecords();b<e.length;b++)this._componentPropertyChanged(a,e[b],c,2)}},b.prototype.componentHighlightChanged=
function(a,b,c){if(null!=b)this._componentPropertyChanged(a,b,c,32);else{b=0;for(var e=a.getGeometryRecords();b<e.length;b++)this._componentPropertyChanged(a,e[b],c,32)}},b.prototype.vertexAttrsUpdated=function(a,b,c){this._updateOrCreateDirtyRecord(a,b,c,2,0,0,2,5,4)},b.prototype.colorAttrsUpdated=function(a,b,c){this._updateOrCreateDirtyRecord(a,b,c,2,0,0,2,5,8)},b.prototype.matChanged=function(a){this._dirtyMaterials[a.getId()]=!0},b.prototype.layerAdded=function(a){for(var b=a.getObjects(),c=
0;c<b.length;c++)this.layObjectAdded(a,b[c])},b.prototype.layerRemoved=function(a){for(var b=a.getObjects(),c=0;c<b.length;c++)this.layObjectRemoved(a,b[c])},b.prototype.layObjectAdded=function(a,b){a=a.getId();for(var c=b.getGeometryRecords(),e=0;e<c.length;e++)this.objGeometryAdded(b,c[e],a)},b.prototype.layObjectRemoved=function(a,b){a=a.getId();for(var c=b.getGeometryRecords(),e=0;e<c.length;e++)this.objGeometryRemoved(b,c[e],a)},b.prototype.layObjectReplaced=function(a,b){this.layObjectRemoved(a,
b[0]);this.layObjectAdded(a,b[1])},b.prototype.objDirty=function(a,b){b=b||this._getParentLayerId(a);var c=a.getId(),c=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,b,c),e;for(e in c)this._updateOrCreateDirtyRecord(a,c[e][0],b,2,0,2,0,5,1)},b.prototype.objTransformation=function(a,b){b=b||this._getParentLayerId(a);var c=a.getId(),c=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,b,c),e;for(e in c)this._updateOrCreateDirtyRecord(a,c[e][0],b,2,0,0,2,5,16)},b.prototype.objGeometryAdded=
function(a,b,c){this._updateOrCreateDirtyRecord(a,b,c,1,4,0,0,0)},b.prototype.objGeometryRemoved=function(a,b,c){this._updateOrCreateDirtyRecord(a,b,c,4,1,2,0,0)},b.prototype.objGeometryReplaced=function(a,b){this.objGeometryRemoved(a,b[0]);this.objGeometryAdded(a,b[1])},b.prototype.objGeometryTransformation=function(a,b){this.objGeometryReplaced(a,b)},b.prototype._componentPropertyChanged=function(a,b,c,d){this._updateOrCreateDirtyRecord(a,b,c,2,0,0,2,5,d)},b.prototype._updateOrCreateDirtyRecord=
function(a,b,c,d,f,g,h,l,m){c=c||this._getParentLayerId(a);var e=a.getId();a=b.getId();c=this._createObjectRecordObjIfNonexistent(this._dirtyGeomRecords,c,e);(e=c[a])?(b=e[1],b&f?delete c[a]:b&g?(e[1]=d,e[2]=m):b&h?e[2]|=m:b&l||k(!1,"ModelDirtySet.objGeometryAdded: inconsistent state")):c[a]=[b,d,m]},b.prototype._createObjectRecordObjIfNonexistent=function(a,b,c){return a[b]||(a[b]={}),a[b][c]||(a[b][c]={}),a[b][c]},b.prototype._getParentLayerId=function(a){return a.parentLayer.id},b.prototype.formatDebugInfo=
function(a){var b=["ADD","UPD",void 0,"REM"];if(a)return"";a="";for(var c in this._dirtyGeomRecords)for(var d in this._dirtyGeomRecords[c]){var f=this._dirtyGeomRecords[c][d];if(f){0<a.length&&(a+="\n");a+=c+"."+d;var g=[],k;for(k in f){var h=f[k][1];g[h]||(g[h]=[]);g[h].push(f[k][0].geometry.id)}for(f=0;f<g.length;f++)if(g[f])for(a+=" "+b[f-1]+": ",h=0;h<g[f].length;h++)a+=g[f][h]+", "}}return a},b}()})},"esri/views/3d/webgl-engine/lib/ModelDirtyTypesTs":function(){define(["require","exports"],function(m,
l){Object.defineProperty(l,"__esModule",{value:!0})})},"esri/views/3d/webgl-engine/lib/RenderGeometry":function(){define(["require","exports","./gl-matrix"],function(m,l,h){var d=h.vec3d,b=h.mat4d;return function(){function g(b,f,a,e,c,g,h,l,m,v,x){this.shaderTransformationDirty=!0;this.data=b.toRenderData();this.componentOffsets=b.componentOffsets;this.boundingInfo=f;this.material=a;this.origin=null;this.center=d.create();this.bsRadius=0;this.transformation=null;this.calculateShaderTransformation=
c;e&&this.updateTransformation(e,g);this.castShadow=h;this.singleUse=l;this.name=m;this.uniqueName=v;this.idx=x;this.canBeMerged=!0;this.instanceParameters={}}return g.prototype.updateTransformation=function(b,d){this.transformation=b;this.shaderTransformationDirty=!0;this.bsRadius=this.getBoundingSphere(b,d,this.center)},g.prototype.shaderTransformationChanged=function(){this.shaderTransformationDirty=!0},g.prototype.getBoundingSphere=function(d,f,a){return f=f||b.maxScale(d),b.multiplyVec3(d,this.boundingInfo.getCenter(),
a),this.boundingInfo.getBSRadius()*f},Object.defineProperty(g.prototype,"hasShaderTransformation",{get:function(){return!!this.calculateShaderTransformation},enumerable:!0,configurable:!0}),g.prototype.getShaderTransformation=function(){return this.calculateShaderTransformation?(this.shaderTransformationDirty&&(this.shaderTransformation||(this.shaderTransformation=b.create()),b.set(this.calculateShaderTransformation(this.transformation),this.shaderTransformation),this.shaderTransformationDirty=!1),
this.shaderTransformation):this.transformation},g}()})},"esri/views/3d/webgl-engine/lib/screenSizePerspectiveUtils":function(){define(["require","exports","./Util"],function(m,l,h){function d(a){return Math.abs(a*a*a)}function b(a,b,e,f){void 0===f&&(f=c);var g=e.parameters;e=e.paddingPixelsOverride;return f.scale=Math.min(g.divisor/(b-g.offset),1),f.factor=d(a),f.minPixelSize=g.minPixelSize,f.paddingPixels=e,f}function g(a,b){return 0===a?b.minPixelSize:b.minPixelSize*(1+2*b.paddingPixels/a)}function k(a,
b){return Math.max(h.lerp(a*b.scale,a,b.factor),g(a,b))}function f(a,c,e){a=b(a,c,e);return a.minPixelSize=0,a.paddingPixels=0,k(1,a)}Object.defineProperty(l,"__esModule",{value:!0});l.getSettings=function(b){return new a(b,l.defaultDescription)};l.getLabelSettings=function(b){var c=l.defaultDescription.curvatureDependent;return new a(b,{curvatureDependent:{min:{curvature:c.min.curvature,tiltAngle:c.min.tiltAngle,scaleFallOffFactor:e.curvatureDependent.min.scaleFallOffFactor},max:{curvature:c.max.curvature,
tiltAngle:c.max.tiltAngle,scaleFallOffFactor:e.curvatureDependent.max.scaleFallOffFactor}},scaleStart:l.defaultDescription.scaleStart,scaleFallOffRange:l.defaultDescription.scaleFallOffRange,minPixelSize:e.minPixelSize})};l.perspectiveFactor=d;l.scaleFactor=b;l.applyScaleFactor=k;l.applyScaleFactorVec2=function(a,b,c){void 0===c&&(c=[0,0]);var e=Math.min(Math.max(b.scale,g(a[1],b)/a[1]),1);return c[0]=h.lerp(a[0]*e,a[0],b.factor),c[1]=h.lerp(a[1]*e,a[1],b.factor),c};l.precomputeScale=f;l.precomputeScaleFactor=
function(a,b,c,e){return e.scale=f(a,b,c),e.factor=0,e.minPixelSize=c.parameters.minPixelSize,e.paddingPixels=c.paddingPixelsOverride,e};l.applyPrecomputedScaleFactorVec2=function(a,b,c){void 0===c&&(c=[0,0]);b=Math.min(Math.max(b.scale,g(a[1],b)/a[1]),1);return c[0]=a[0]*b,c[1]=a[1]*b,c};l.scale=function(a,c,e,d){return k(a,b(c,e,d))};var a=function(){function a(a,b,c,e){void 0===c&&(c={camera:{distance:0,fovY:0},divisor:0,offset:0,minPixelSize:0,paddingPixels:0});this.viewingMode=a;this.description=
b;this.parameters=c;this._paddingPixelsOverride=e;"local"===this.viewingMode?(this.coverageCompensation=this.surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersLocal):(this.coverageCompensation=this.surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersGlobal)}return Object.defineProperty(a.prototype,"paddingPixelsOverride",{get:function(){return this._paddingPixelsOverride||
this.parameters.paddingPixels},enumerable:!0,configurable:!0}),a.prototype.update=function(a){return this.parameters&&this.parameters.camera.fovY===a.fovY&&this.parameters.camera.distance===a.distance?!1:(this.calculateParameters(a,this.parameters),!0)},a.prototype.overridePadding=function(b){return b!==this.paddingPixelsOverride?new a(this.viewingMode,this.description,this.parameters,b):this},a.prototype.calculateParameters=function(a,b){var c=this.description,e=c.scaleStart,d=c.scaleFallOffRange,
c=c.minPixelSize,f=a.fovY,g=a.distance,k=this.calculateCurvatureDependentParameters(a),h=this.coverageCompensation(a,k),l=k.tiltAngle,k=k.scaleFallOffFactor,g=Math.sin(l)*g,l=.5*Math.PI-l-f*(.5-e*h),e=g/Math.cos(l),d=(e-g/Math.cos(l+f*d*h)*k)/(1-k);return b.camera.fovY=a.fovY,b.camera.distance=a.distance,b.offset=d,b.divisor=e-d,b.minPixelSize=c,b},a.prototype.calculateCurvatureDependentParametersLocal=function(a,b){return void 0===b&&(b=q),b.tiltAngle=this.description.curvatureDependent.min.tiltAngle,
b.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor,b},a.prototype.calculateCurvatureDependentParametersGlobal=function(a,b){void 0===b&&(b=q);var c=this.description.curvatureDependent;a=1+a.distance/t;var e=[c.min.curvature,c.max.curvature],d=e[0];a=h.clamp((Math.sqrt(a*a-1)-d)/(e[1]-d),0,1);e=[c.min,c.max];c=e[0];e=e[1];return b.tiltAngle=h.lerp(c.tiltAngle,e.tiltAngle,a),b.scaleFallOffFactor=h.lerp(c.scaleFallOffFactor,e.scaleFallOffFactor,a),b},a.prototype.surfaceCoverageCompensationLocal=
function(a,b){return(a.fovY-b.tiltAngle)/a.fovY},a.prototype.surfaceCoverageCompensationGlobal=function(a,b){var c=t*t;b=b.tiltAngle+.5*Math.PI;var e=a.fovY;a=a.distance;a=a*a+c-2*Math.cos(b)*a*t;var d=Math.sqrt(a);return(Math.acos(Math.sqrt(a-c)/d)-Math.asin(t/(d/Math.sin(b)))+.5*e)/e},a}();l.defaultDescription={curvatureDependent:{min:{curvature:h.deg2rad(10),tiltAngle:h.deg2rad(12),scaleFallOffFactor:.5},max:{curvature:h.deg2rad(70),tiltAngle:h.deg2rad(40),scaleFallOffFactor:.8}},scaleStart:.3,
scaleFallOffRange:.65,minPixelSize:0};var e={curvatureDependent:{min:{scaleFallOffFactor:.7},max:{scaleFallOffFactor:.95}},minPixelSize:14};l.copyParameters=function(a,b){return b.camera.distance=a.camera.distance,b.camera.fovY=a.camera.fovY,b.divisor=a.divisor,b.offset=a.offset,b.minPixelSize=a.minPixelSize,b};var c={scale:0,factor:0,minPixelSize:0,paddingPixels:0},q={tiltAngle:0,scaleFallOffFactor:0},t=6378137})},"esri/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":function(){define(["require",
"exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.Default3D={position:0,normal:1,uv0:2,color:3,instanceColor:3,size:4,auxpos1:5,symbolColor:5,auxpos2:6,featureAttribute:6,instanceFeatureAttribute:6,region:7,model:8,modelNormal:12}})},"esri/views/3d/webgl-engine/lib/GeometryUtil":function(){define(["./GeometryData","./BufferVectorMath","./Util","./gl-matrix"],function(m,l,h,d){function b(a,b,c,e,d){return Math.abs(g.dot(b,a))>d?!1:(g.cross(a,b,c),g.normalize(c),g.cross(c,
a,e),g.normalize(e),!0)}var g=d.vec3,k=d.vec4,f=d.vec3d,a=h.VertexAttrConstants,e=l.Vec3Compact,c=f.create(),q=f.create(),t={createSphereGeometry:function(b,c,e,d,f,k,l){b=b||50;d=void 0!==d?d:-Math.PI;f=void 0!==f?f:2*Math.PI;k=void 0!==k?k:.5*-Math.PI;l=void 0!==l?l:Math.PI;var n,q,r=Math.max(3,Math.floor(c)||8),t=Math.max(2,Math.floor(e)||6),u=(r+1)*(t+1);e=new Float32Array(3*u);c=new Float32Array(3*u);var u=new Float32Array(2*u),v=[],w=g.create(),x=0;for(q=0;t>=q;q++){var y=[],Q=q/t,T=k+Q*l,O=
Math.cos(T);for(n=0;r>=n;n++){var S=n/r,H=d+S*f,Y=Math.cos(H)*O*b,W=Math.sin(T)*b,H=-Math.sin(H)*O*b;e[3*x]=Y;e[3*x+1]=W;e[3*x+2]=H;g.set3(Y,W,H,w);g.normalize(w);c[3*x]=w[0];c[3*x+1]=w[1];c[3*x+2]=w[2];u[2*x]=S;u[2*x+1]=Q;y.push(x);++x}v.push(y)}b=new Uint32Array(2*r*(t-1)*3);for(q=x=0;t>q;q++)for(n=0;r>n;n++)d=v[q][n],f=v[q][n+1],k=v[q+1][n+1],l=v[q+1][n],0===q?(b[x++]=d,b[x++]=k,b[x++]=l):q===t-1?(b[x++]=d,b[x++]=f,b[x++]=k):(b[x++]=d,b[x++]=f,b[x++]=k,b[x++]=k,b[x++]=l,b[x++]=d);h.assert(x===
b.length);r={};r[a.POSITION]=b;r[a.NORMAL]=b;r[a.UV0]=b;t={};return t[a.POSITION]={size:3,data:e},t[a.NORMAL]={size:3,data:c},t[a.UV0]={size:2,data:u},new m(t,r)},createPolySphereGeometry:function(b,c,d){function f(a,c){a>c&&(a=c+(c=a,0));var d=a.toString()+"."+c.toString();if(h[d])return h[d];var f=k.length;return k.length+=3,e.add(k,3*a,k,3*c,k,f),e.scale(k,f,b/e.length(k,f)),f/=3,h[d]=f,f}var g,k;d?(k=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],d=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]):
(d=b*(1+Math.sqrt(5))/2,k=[-b,d,0,b,d,0,-b,-d,0,b,-d,0,0,-b,d,0,b,d,0,-b,-d,0,b,-d,d,0,-b,d,0,b,-d,0,-b,-d,0,b],d=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]);for(g=0;g<k.length;g+=3)e.scale(k,g,b/e.length(k,g));var h={};for(g=0;c>g;g++){for(var l=d.length,q=new Uint32Array(4*l),r=0;l>r;r+=3){var t=d[r],u=d[r+1],v=d[r+2],M=f(t,u),R=f(u,v),P=f(v,t),Q=4*r;q[Q]=t;q[Q+1]=M;q[Q+2]=P;q[Q+3]=u;q[Q+4]=R;q[Q+5]=M;q[Q+6]=
v;q[Q+7]=P;q[Q+8]=R;q[Q+9]=M;q[Q+10]=R;q[Q+11]=P}d=q;h={}}c=new Float32Array(k);for(g=0;c>g;g+=3)e.normalize(c,g);k=new Float32Array(k);g={};g[a.POSITION]=d;g[a.NORMAL]=d;d={};return d[a.POSITION]={size:3,data:k},d[a.NORMAL]={size:3,data:c},new m(d,g)},createPointGeometry:function(b,c,e,d,f,g,k){var h=new Float32Array(3);h[0]=c?c[0]:0;h[1]=c?c[1]:0;h[2]=c?c[2]:0;c=new Float32Array(3);if(c[0]=b?b[0]:0,c[1]=b?b[1]:0,c[2]=b?b[2]:1,null==g)b=new Float32Array(2),b[0]=0,b[1]=0;else{b=new Float32Array(g.length);
for(var l=0;l<g.length;l++)b[l]=g[l]}g=new Uint8Array(4);g[0]=e?255*e[0]:255;g[1]=e?255*e[1]:255;g[2]=e?255*e[2]:255;g[3]=e&&3<e.length?255*e[3]:255;e=new Float32Array(2);if(e[0]=null!=d&&2==d.length?d[0]:1,e[1]=null!=d&&2==d.length?d[1]:1,null!=f){var n=new Float32Array(4);n[0]=f[0];n[1]=f[1];n[2]=f[2];n[3]=f[3]}if(null!=k){var q=new Float32Array(4);q[0]=k[0];q[1]=k[1];q[2]=k[2];q[3]=k[3]}l=new Uint32Array(1);l[0]=0;d={};d[a.POSITION]=l;d[a.NORMAL]=l;d[a.UV0]=l;d[a.COLOR]=l;d[a.SIZE]=l;null!=f&&
(d[a.AUXPOS1]=l);null!=k&&(d[a.AUXPOS2]=l);l={};return l[a.POSITION]={size:3,data:h},l[a.NORMAL]={size:3,data:c},l[a.UV0]={size:b.length,data:b},l[a.COLOR]={size:4,data:g},l[a.SIZE]={size:2,data:e},null!=f&&(l[a.AUXPOS1]={size:4,data:n}),null!=k&&(l[a.AUXPOS2]={size:4,data:q}),new m(l,d,m.DefaultOffsets,"point")},createPointArrayGeometry:function(b,c){for(var e=new Float32Array(3*b.length),d=new Float32Array(c?3*b.length:3),f=new Uint32Array(b.length),g=new Uint32Array(b.length),k=0;k<b.length;k++)e[3*
k]=b[k][0],e[3*k+1]=b[k][1],e[3*k+2]=b[k][2],c&&(d[3*k]=c[k][0],d[3*k+1]=c[k][1],d[3*k+2]=c[k][2]),f[k]=k,g[k]=0;c||(d[0]=0,d[1]=1,d[2]=0);b=new Float32Array(2);b[0]=0;b[1]=0;k={};k[a.POSITION]=f;k[a.NORMAL]=c?f:g;k[a.UV0]=g;c={};return c[a.POSITION]={size:3,data:e},c[a.NORMAL]={size:3,data:d},c[a.UV0]={size:2,data:b},new m(c,k,m.DefaultOffsets,"point")},createTriangleGeometry:function(){var b=new Float32Array(9);b[0]=0;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=100;b[6]=100;b[7]=0;b[8]=0;var c=new Uint32Array(3);
c[0]=0;c[1]=1;c[2]=2;var e=new Float32Array(3);e[0]=0;e[1]=1;e[2]=0;var d=new Uint32Array(3);d[0]=0;d[1]=0;d[2]=0;var f=new Float32Array(2);f[0]=0;f[1]=0;var g=new Uint32Array(3);g[0]=0;g[1]=0;g[2]=0;var k={};k[a.POSITION]=c;k[a.NORMAL]=d;k[a.UV0]=g;c={};return c[a.POSITION]={size:3,data:b},c[a.NORMAL]={size:3,data:e},c[a.UV0]={size:2,data:f},new m(c,k)},createSquareGeometry:function(b){var c,e,d=new Float32Array(12);if(b)for(c=0;4>c;c++)for(e=0;3>e;e++)d[3*c+e]=b[c][e];else d[0]=-1,d[1]=-1,d[2]=
0,d[3]=1,d[4]=-1,d[5]=0,d[6]=1,d[7]=1,d[8]=0,d[9]=-1,d[10]=1,d[11]=0;e=new Uint32Array(6);e[0]=0;e[1]=1;e[2]=2;e[3]=2;e[4]=3;e[5]=0;b=new Float32Array(3);b[0]=0;b[1]=0;b[2]=1;var f=new Uint32Array(6);for(c=0;6>c;c++)f[c]=0;c=new Float32Array(8);c[0]=0;c[1]=0;c[2]=1;c[3]=0;c[4]=1;c[5]=1;c[6]=0;c[7]=1;var g=new Uint8Array(4);g[0]=255;g[1]=255;g[2]=255;g[3]=255;var k={};k[a.POSITION]=e;k[a.NORMAL]=f;k[a.UV0]=e;k[a.COLOR]=f;e={};return e[a.POSITION]={size:3,data:d},e[a.NORMAL]={size:3,data:b},e[a.UV0]=
{size:2,data:c},e[a.COLOR]={size:4,data:g},new m(e,k)},createBoxGeometry:function(){var b,c,e=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],d=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],f=[0,0,1,0,1,1,0,1],g=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],k=Array(36);for(b=0;6>b;b++)for(c=0;6>c;c++)k[6*b+c]=b;var h=Array(36);for(b=0;6>b;b++)h[6*b+0]=0,h[6*b+1]=1,h[6*b+2]=2,h[6*b+3]=2,h[6*b+4]=3,h[6*b+5]=0;return function(b){var c;
Array.isArray(b)||(b=[b,b,b]);var l=new Float32Array(24);for(c=0;8>c;c++)l[3*c]=e[c][0]*b[0],l[3*c+1]=e[c][1]*b[1],l[3*c+2]=e[c][2]*b[2];b={};b[a.POSITION]=new Uint32Array(g);b[a.NORMAL]=new Uint32Array(k);b[a.UV0]=new Uint32Array(h);c={};return c[a.POSITION]={size:3,data:l},c[a.NORMAL]={size:3,data:new Float32Array(d)},c[a.UV0]={size:2,data:new Float32Array(f)},new m(c,b)}}(),createDiamondGeometry:function(){var b=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],c=[0,1,-1,1,1,0,0,
1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],e=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],d=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];return function(f){var g;Array.isArray(f)||(f=[f,f,f]);var k=new Float32Array(18);for(g=0;6>g;g++)k[3*g]=b[g][0]*f[0],k[3*g+1]=b[g][1]*f[1],k[3*g+2]=b[g][2]*f[2];f={};f[a.POSITION]=new Uint32Array(e);f[a.NORMAL]=new Uint32Array(d);g={};return g[a.POSITION]={size:3,data:k},g[a.NORMAL]={size:3,data:new Float32Array(c)},new m(g,f)}}(),createTetrahedronGeometry:function(){var b=
g.createFrom(-.5,0,-.5),c=g.createFrom(.5,0,-.5),e=g.createFrom(0,0,.5),d=g.createFrom(0,.5,0),f=g.create(),k=g.create(),h=g.create(),l=g.create(),q=g.create();g.subtract(b,d,f);g.subtract(b,c,k);g.cross(f,k,h);g.normalize(h,h);g.subtract(c,d,f);g.subtract(c,e,k);g.cross(f,k,l);g.normalize(l,l);g.subtract(e,d,f);g.subtract(e,b,k);g.cross(f,k,q);g.normalize(q,q);var t=[b,c,e,d],F=[0,-1,0,h[0],h[1],h[2],l[0],l[1],l[2],q[0],q[1],q[2]],G=[0,1,2,3,1,0,3,2,1,3,0,2],N=[0,0,0,1,1,1,2,2,2,3,3,3];return function(b){var c;
Array.isArray(b)||(b=[b,b,b]);var e=new Float32Array(12);for(c=0;4>c;c++)e[3*c]=t[c][0]*b[0],e[3*c+1]=t[c][1]*b[1],e[3*c+2]=t[c][2]*b[2];b={};b[a.POSITION]=new Uint32Array(G);b[a.NORMAL]=new Uint32Array(N);c={};return c[a.POSITION]={size:3,data:e},c[a.NORMAL]={size:3,data:new Float32Array(F)},new m(c,b)}}(),createConeGeometry:function(b,c,e,d){var f=0,k=g.createFrom(0,f,0),h=g.createFrom(0,f+b,0),l=g.createFrom(0,-1,0),q=g.createFrom(0,1,0);d&&(f=b,h=g.createFrom(0,0,0),k=g.createFrom(0,f,0),l=g.createFrom(0,
1,0),q=g.createFrom(0,-1,0));var k=[h,k],l=[l,q],q=e+2,r=0,h=Math.sqrt(b*b+c*c);if(d)for(d=e-1;0<=d;d--)r=2*Math.PI/e*d,t=g.createFrom(Math.cos(r)*c,f,Math.sin(r)*c),k.push(t),r=g.createFrom(b*Math.cos(r)/h,-c/h,b*Math.sin(r)/h),l.push(r);else for(d=0;e>d;d++){var r=2*Math.PI/e*d,t=g.createFrom(Math.cos(r)*c,f,Math.sin(r)*c);k.push(t);r=g.createFrom(b*Math.cos(r)/h,c/h,b*Math.sin(r)/h);l.push(r)}b=new Uint32Array(6*(e+2));e=new Uint32Array(6*(e+2));f=c=0;for(d=3;d<k.length;d++)b[c++]=1,b[c++]=d-1,
b[c++]=d,e[f++]=0,e[f++]=0,e[f++]=0;b[c++]=k.length-1;b[c++]=2;b[c++]=1;e[f++]=0;e[f++]=0;e[f++]=0;for(d=3;d<k.length;d++)b[c++]=d,b[c++]=d-1,b[c++]=0,e[f++]=d,e[f++]=d-1,e[f++]=1;b[c++]=0;b[c++]=2;b[c++]=k.length-1;e[f++]=1;e[f++]=2;e[f++]=l.length-1;f=1;Array.isArray(f)||(f=[f,f,f]);c=new Float32Array(3*q);for(d=0;q>d;d++)c[3*d]=k[d][0]*f[0],c[3*d+1]=k[d][1]*f[1],c[3*d+2]=k[d][2]*f[2];k=new Float32Array(3*q);for(d=0;q>d;d++)k[3*d]=l[d][0],k[3*d+1]=l[d][1],k[3*d+2]=l[d][2];l={};l[a.POSITION]=b;l[a.NORMAL]=
e;q={};return q[a.POSITION]={size:3,data:c},q[a.NORMAL]={size:3,data:k},new m(q,l)},createCylinderGeometry:function(b,c,e,d,f,k){d||(d=g.createFrom(1,0,0));f||(f=g.createFrom(0,0,0));k=void 0===k?!0:k;var h=g.create();g.normalize(d,h);d=g.create();g.scale(h,Math.abs(b),d);var l=g.create();g.scale(d,-.5,l);g.add(l,f);var n=g.createFrom(0,1,0);Math.abs(.2>1-g.dot(h,n))&&g.set3(0,0,1,n);var q=g.create();g.cross(h,n,q);g.normalize(q);g.cross(q,h,n);var r=2*e+(k?2:0),t=e+(k?2:0);f=new Float32Array(3*r);
b=new Float32Array(3*t);var u=new Float32Array(2*r),v=new Uint32Array(3*e*(k?4:2)),x=new Uint32Array(3*e*(k?4:2));k&&(f[3*(r-2)+0]=l[0],f[3*(r-2)+1]=l[1],f[3*(r-2)+2]=l[2],u[2*(r-2)]=0,u[2*(r-2)+1]=0,f[3*(r-1)+0]=f[3*(r-2)+0]+d[0],f[3*(r-1)+1]=f[3*(r-2)+1]+d[1],f[3*(r-1)+2]=f[3*(r-2)+2]+d[2],u[2*(r-1)]=1,u[2*(r-1)+1]=1,b[3*(t-2)+0]=-h[0],b[3*(t-2)+1]=-h[1],b[3*(t-2)+2]=-h[2],b[3*(t-1)+0]=h[0],b[3*(t-1)+1]=h[1],b[3*(t-1)+2]=h[2]);for(var y,Q=function(a,b,c){v[a]=b;x[a]=c},T=0,O=g.create(),S=g.create(),
h=0;e>h;h++)y=2*Math.PI/e*h,g.scale(n,Math.sin(y),O),g.scale(q,Math.cos(y),S),g.add(O,S),b[3*h+0]=O[0],b[3*h+1]=O[1],b[3*h+2]=O[2],g.scale(O,c),g.add(O,l),f[3*h+0]=O[0],f[3*h+1]=O[1],f[3*h+2]=O[2],u[2*h+0]=h/e,u[2*h+1]=0,f[3*(h+e)+0]=f[3*h+0]+d[0],f[3*(h+e)+1]=f[3*h+1]+d[1],f[3*(h+e)+2]=f[3*h+2]+d[2],u[2*(h+e)+0]=h/e,u[2*h+1]=1,y=(h+1)%e,Q(T++,h,h),Q(T++,h+e,h),Q(T++,y,y),Q(T++,y,y),Q(T++,h+e,h),Q(T++,y+e,y);if(k){for(h=0;e>h;h++)y=(h+1)%e,Q(T++,r-2,t-2),Q(T++,h,t-2),Q(T++,y,t-2);for(h=0;e>h;h++)y=
(h+1)%e,Q(T++,h+e,t-1),Q(T++,r-1,t-1),Q(T++,y+e,t-1)}c={};c[a.POSITION]=v;c[a.NORMAL]=x;c[a.UV0]=v;e={};return e[a.POSITION]={size:3,data:f},e[a.NORMAL]={size:3,data:b},e[a.UV0]={size:2,data:u},new m(e,c)},createTubeGeometry:function(a,b,c,e,d){c=c||10;e=null!=e?e:!0;h.assert(1<a.length);for(var f=[],g=[],k=0;c>k;k++){f.push([0,-k-1,-((k+1)%c)-1]);var l=k/c*2*Math.PI;g.push([Math.cos(l)*b,Math.sin(l)*b])}return t.createPathExtrusionGeometry(g,a,[[0,0,0]],f,e,d)},createPathExtrusionGeometry:function(c,
e,d,l,q,n){var r,t=c.length,u=new Float32Array(e.length*t*3+(6*d.length||0)),v=new Float32Array(e.length*t+(2*d.length||0)),x=new Float32Array(e.length*t*3+(d?6:0)),y=0,N=0,M=0,R=(e.length-1)*t*6+6*l.length,P=new Uint32Array(R),R=new Uint32Array(R),Q=0,T=0,O=g.create(),S=g.create(),H=g.create(),Y=g.create(),W=(g.create(),g.create()),E=(g.create(),g.create(),g.create()),p=g.create(),A=g.create(),K=g.create(),U=g.create(),V=(g.create(),g.create(),g.create()),X=g.create(),ba=g.create(),fa=k.create();
g.set3(0,1,0,K);g.subtract(e[1],e[0],S);g.normalize(S);q?(g.add(e[0],n,A),g.normalize(A,H)):g.set3(0,0,1,H);b(S,H,W,H,.99619469809)||b(S,K,W,H,.99619469809)||b(S,K,W,H,.99619469809);g.set(H,Y);g.set(W,X);for(r=0;r<d.length;r++)g.scale(W,d[r][0],E),g.scale(H,d[r][2],A),g.add(E,A),g.add(E,e[0]),u[y++]=E[0],u[y++]=E[1],u[y++]=E[2],v[M++]=0;x[N++]=-S[0];x[N++]=-S[1];x[N++]=-S[2];for(r=0;r<l.length;r++)P[Q++]=0<l[r][0]?l[r][0]:-l[r][0]-1+d.length,P[Q++]=0<l[r][1]?l[r][1]:-l[r][1]-1+d.length,P[Q++]=0<l[r][2]?
l[r][2]:-l[r][2]-1+d.length,R[T++]=0,R[T++]=0,R[T++]=0;var ha,ca=d.length;r=d.length-1;for(var ea=0;ea<e.length;ea++){if(ha=!1,0<ea){g.set(S,O);ea<e.length-1?(g.subtract(e[ea+1],e[ea],S),g.normalize(S)):ha=!0;g.add(O,S,U);g.normalize(U);g.add(e[ea-1],Y,V);fa[0]=U[0];fa[1]=U[1];fa[2]=U[2];fa[3]=-f.dot(U,e[ea]);if(h.rayPlane(V,O,fa,A))g.subtract(A,e[ea]),g.normalize(A,H),g.cross(U,H,W),g.normalize(W);else{var ja=U,na=X,za=K,ua=W,wa=H;b(ja,Y,ua,wa,.99619469809)||b(ja,na,ua,wa,.99619469809)||b(ja,za,
ua,wa,.99619469809)}g.set(H,Y);g.set(W,X)}q&&(g.add(e[ea],n,A),g.normalize(A,ba));for(ja=0;t>ja;ja++)if(g.scale(W,c[ja][0],E),g.scale(H,c[ja][1],A),g.add(E,A),g.normalize(E,p),x[N++]=p[0],x[N++]=p[1],x[N++]=p[2],q?v[M++]=g.dot(E,ba):v[M++]=E[2],g.add(E,e[ea]),u[y++]=E[0],u[y++]=E[1],u[y++]=E[2],!ha)for(na=(ja+1)%t,P[Q++]=ca+ja,P[Q++]=ca+t+ja,P[Q++]=ca+na,P[Q++]=ca+na,P[Q++]=ca+t+ja,P[Q++]=ca+t+na,na=0;6>na;na++)R[T++]=P[Q-6+na]-r;ca+=t}ha=e[e.length-1];for(r=0;r<d.length;r++)g.scale(W,d[r][0],E),
g.scale(H,d[r][1],A),g.add(E,A),g.add(E,ha),u[y++]=E[0],u[y++]=E[1],u[y++]=E[2],v[M++]=0;c=N/3;x[N++]=S[0];x[N++]=S[1];x[N++]=S[2];t=ca-t;for(r=0;r<l.length;r++)P[Q++]=0<=l[r][0]?ca+l[r][0]:-l[r][0]-1+t,P[Q++]=0<=l[r][2]?ca+l[r][2]:-l[r][2]-1+t,P[Q++]=0<=l[r][1]?ca+l[r][1]:-l[r][1]-1+t,R[T++]=c,R[T++]=c,R[T++]=c;l={};l[a.POSITION]=P;l[a.NORMAL]=R;P={};return P[a.POSITION]={size:3,data:u},P.zOffset={size:1,data:v},P[a.NORMAL]={size:3,data:x},new m(P,l)},createPolylineGeometry:function(b,c){h.assert(1<
b.length,"createPolylineGeometry(): polyline needs at least 2 points");h.assert(3===b[0].length,"createPolylineGeometry(): malformed vertex");h.assert(void 0===c||c.length===b.length,"createPolylineGeometry: need same number of points and normals");h.assert(void 0===c||3===c[0].length,"createPolylineGeometry(): malformed normal");for(var e=new Float32Array(3*b.length),d=new Uint32Array(2*(b.length-1)),f=0,g=0,k=0;k<b.length;k++){for(var l=0;3>l;l++)e[f++]=b[k][l];0<k&&(d[g++]=k-1,d[g++]=k)}f={};g=
{};if(f[a.POSITION]=d,g[a.POSITION]={size:3,data:e},c){for(var e=new Float32Array(3*c.length),q=0,k=0;k<b.length;k++)for(l=0;3>l;l++)e[q++]=c[k][l];f[a.NORMAL]=d;g[a.NORMAL]={size:3,data:e}}return new m(g,f,m.DefaultOffsets,"line")},addVertexColors:function(b,c){var e,d=c||[1,1,1,1];c=new Uint8Array(4);c[0]=255*d[0];c[1]=255*d[1];c[2]=255*d[2];c[3]=255*(3<d.length?d[3]:1);var d={},f=b.getVertexAttr();for(e in f)d[e]=f[e];d[a.COLOR]={size:4,data:c};c={};for(e in b.indices)c[e]=b.indices[e];return c[a.COLOR]=
new Uint32Array(c[a.POSITION].length),b=new m(d,c,b.componentOffsets,b.primitiveType)},addNormals:function(a){var b=a.getVertexAttr();a=a.indices;for(var e=l.Vec3Compact.subtract,d=new Float32Array(a.position.length/3*3),g=b.position.data,k=0,h=a.position,r=new Uint32Array(h.length),m=0;m<h.length;m+=3){e(g,3*h[m],g,3*h[m+2],q,0);e(g,3*h[m],g,3*h[m+1],c,0);f.cross(c,q);f.normalize(c);var t=k/3;d[k++]=c[0];d[k++]=c[1];d[k++]=c[2];r[m]=t;r[m+1]=t;r[m+2]=t}b.normal={size:3,data:d};a.normal=r},cgToGIS:function(a){var b,
c;b=a.getVertexAttr();a=b.position.data;var e=b.normal.data;if(e)for(b=0;b<e.length;b+=3)c=e[b+1],e[b+1]=-e[b+2],e[b+2]=c;if(a)for(b=0;b<a.length;b+=3)c=a[b+1],a[b+1]=-a[b+2],a[b+2]=c}};return t})},"esri/views/3d/webgl-engine/lib/GeometryData":function(){define(["require","exports","./ComponentUtils","./geometryDataUtils","./Util"],function(m,l,h,d,b){return function(){function g(k,f,a,e){void 0===f&&(f=g.DefaultIndices);void 0===a&&(a=g.DefaultOffsets);void 0===e&&(e="triangle");this.preinterleaved=
!1;var c={},l;for(l in k){var m=k[l],r=m.size;c[l]={data:m.data,size:r,offsetIdx:0,strideIdx:r}}if(f===g.DefaultIndices){f=b.getFirstObjectValue(c);k=d.generateDefaultIndexArray(f.data.length/f.size);f={};for(var u in c)f[u]=k}this._id=d.getNewId();this._vertexAttributes=c;this._indices=f;this._componentOffsets=h.createOffsets(a);this._primitiveType=e}return Object.defineProperty(g.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"vertexAttributes",
{get:function(){return this._vertexAttributes},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"indices",{get:function(){return this._indices},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"componentOffsets",{get:function(){return this._componentOffsets},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"indexCount",{get:function(){return b.getFirstObjectValue(this._indices).length},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,
"primitiveType",{get:function(){return this._primitiveType},enumerable:!0,configurable:!0}),g.prototype.getId=function(){return this.id},g.prototype.getVertexAttr=function(){return this.vertexAttributes},g.prototype.toRenderData=function(){return{id:this._id.toString(),preinterleaved:!1,indices:this._indices,vertexAttr:this._vertexAttributes}},g.prototype.getIndices=function(b){return this._indices[b]},g.prototype.getAttribute=function(b){return this._vertexAttributes[b]},g.prototype.estimateGpuMemoryUsage=
function(){var b=0;this._indices.position&&(b+=12*this._indices.position.length);this._indices.normal&&(b+=12*this._indices.normal.length);this._indices.uv0&&(b+=8*this._indices.uv0.length);this._indices.color&&(b+=4*this._indices.color.length);return this._indices.terrain&&(b+=2*this._indices.terrain.length,b+=4*this._vertexAttributes.terrain.data.length),b},g.DefaultIndices={},g.DefaultOffsets=new Uint32Array(0),g}()})},"esri/views/3d/webgl-engine/lib/geometryDataUtils":function(){define(["require",
"exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});var h=1,d=null;l.generateDefaultIndexArray=function(b){if(b>h||null==d){for(;b>h;)h*=2;d=new Uint32Array(h);for(var g=0;h>g;g++)d[g]=g}return new Uint32Array(d.buffer,0,b)};var b=0;l.getNewId=function(){return b++}})},"esri/views/3d/webgl-engine/lib/Texture":function(){define("require exports ./IdGen ./Util ./DDSUtil ./gl-matrix ../../../webgl/FramebufferObject ../../../webgl/Texture ../../../webgl/Util ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){function u(a,b,c,e,g,k,h){h=!1!==h;var l=new Image;l.onerror=function(){k(null);l.onerror=void 0;l.onload=void 0};l.onload=function(){d.assert(1<=l.width&&1<=l.height);c.samplingMode=h?9987:9729;c.hasMipmap=h;if(!h&&33071===c.wrapMode||d.isPowerOfTwo(l.width)&&d.isPowerOfTwo(l.height)){c.width=l.width;c.height=l.height;var b=new f(a,c,l)}else b=v(a,l,c,e,g);a.bindTexture(b);k(b);l.onerror=void 0;l.onload=void 0};l.src=b}function v(b,g,h,l,q){var n=d.nextHighestPowerOfTwo(g.width),
m=d.nextHighestPowerOfTwo(g.height);d.assert(n!==g.width||m!==g.height);h.width=n;h.height=m;var u=new f(b,h),v=k.createWithAttachments(b,u,{colorTarget:0,depthStencilTarget:0});g=new f(b,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!!h.flipped,maxAnisotropy:8,preMultiplyAlpha:h.preMultiplyAlpha},g);if(b.bindFramebuffer(v),void 0===q)q=b.getViewport(),q=[q.x,q.y,q.width,q.height];b.setViewport(0,0,n,m);l=l.get("texOnly");n=x.identity();b.bindProgram(l);l.setUniformMatrix4fv("model",
n);l.setUniformMatrix4fv("view",n);l.setUniformMatrix4fv("proj",n);l.setUniform4f("color",1,1,1,1);l.setUniform1i("tex",0);l=new e(b,r.Default3D,{geometry:t.Pos3Tex},{geometry:c.createVertex(b,35044,d.createQuadVertexUvBuffer())});return b.bindTexture(g,0),b.bindVAO(l),b.setDepthTestEnabled(!1),b.setBlendingEnabled(!1),b.drawArrays(5,0,a.vertexCount(l,"geometry")),b.setDepthTestEnabled(!0),b.bindFramebuffer(null),b.setViewport(q[0],q[1],q[2],q[3]),l.dispose(!0),g.dispose(),b.bindFramebuffer(null),
v.detachColorTexture(),v.dispose(),h.hasMipmap&&u.generateMipmap(),u}var x=g.mat4d;return function(){function a(b,c,e){this.data=b;this.id=a.idGen.gen(c);this.unloadFunc=void 0;this.params=e||{};this.params.wrapClamp=this.params.wrapClamp||!1;this.params.mipmap=!1!==this.params.mipmap;this.params.noUnpackFlip=this.params.noUnpackFlip||!1;this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1;this.estimatedTexMemRequiredMB=a.estimateTexMemRequiredMB(this.data,this.params)}return a.estimateTexMemRequiredMB=
function(a,b){return null==a?0:a instanceof ArrayBuffer||a instanceof Uint8Array?a.byteLength/1E6:a instanceof Image||a instanceof ImageData||a instanceof HTMLCanvasElement?(b.mipmap?4/3:1)*a.width*a.height*4/1E6:(b.mipmap?4/3:1)*b.width*b.height*4/1E6||0},a.prototype.getId=function(){return this.id},a.prototype.getEstimatedTexMemRequiredMB=function(){return this.estimatedTexMemRequiredMB},a.prototype.dispose=function(){this.data=void 0},a.prototype.deferredLoading=function(){return"string"==typeof this.data},
a.prototype.getWidth=function(){return this.params.width},a.prototype.getHeight=function(){return this.params.height},a.prototype.initializeThroughUpload=function(c,e,g,k,h){var l=this.data;if(e.flipped=!this.params.noUnpackFlip,e.samplingMode=this.params.mipmap?9987:9729,e.hasMipmap=this.params.mipmap,e.wrapMode=this.params.wrapClamp?33071:10497,e.preMultiplyAlpha=this.params.preMultiplyAlpha,"string"==typeof l)u(c,l,e,g,k,h,this.params.mipmap);else{if(l instanceof Image||l instanceof ImageData||
l instanceof HTMLCanvasElement)this.params.width=l.width,this.params.height=l.height,!this.params.mipmap&&this.params.wrapClamp||d.isPowerOfTwo(l.width)&&d.isPowerOfTwo(l.height)?(e.width=l.width,e.height=l.height,e=new f(c,e,l)):e=v(c,l,e,g,k);else if(l instanceof ArrayBuffer&&this.params.encoding===a.DDS_ENCODING)e=b.createDDSTexture(c,e,l,this.params.mipmap);else if(l instanceof Uint8Array&&this.params.encoding===a.DDS_ENCODING)e=b.createDDSTexture(c,e,l.buffer,this.params.mipmap);else if(l instanceof
Uint8Array)d.assert(0<this.params.width&&0<this.params.height),e.pixelFormat=1===this.params.components?6409:6408,e.width=this.params.width,e.height=this.params.height,e=new f(c,e,l);else{if(null!==l)throw console.warn("Unsupported image data"),Error("Unsupported image data");e=new f(c,e,null)}c.bindTexture(e);h(e)}this.data=void 0},a.prototype.setUnloadFunc=function(a){this.unloadFunc=a},a.prototype.unload=function(){void 0!==this.unloadFunc&&(this.unloadFunc(this.id),this.unloadFunc=void 0)},a.idGen=
new h,a.DDS_ENCODING="image/vnd-ms.dds",a}()})},"esri/views/3d/webgl-engine/lib/DDSUtil":function(){define(["require","exports","../../../webgl/Texture","../../../webgl/enums"],function(m,l,h,d){function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}Object.defineProperty(l,"__esModule",{value:!0});var g=b("DXT1"),k=b("DXT3"),f=b("DXT5");l.createDDSTexture=function(a,b,c,d){var e=new Int32Array(c,0,31);if(542327876!==e[0])return console.error("Invalid magic number in DDS header"),
null;if(!(e[20]&4))return console.error("Unsupported format, must contain a FourCC code"),null;var l,q;l=e[21];switch(l){case g:l=8;q=33776;break;case k:l=16;q=33778;break;case f:l=16;q=33779;break;default:return console.error("Unsupported FourCC code:",String.fromCharCode(255&l,l>>8&255,l>>16&255,l>>24&255)),null}var m=1;e[2]&131072&&!1!==d&&(m=Math.max(1,e[7]));var x,y;d=e[4];var n=e[3],w=e[1]+4;b.samplingMode=1<m?9987:9729;b.hasMipmap=1<m;b.width=e[4];b.height=e[3];b=new h(a,b);a.bindTexture(b);
for(e=0;m>e&&(y=Math.floor((d+3)/4)*Math.floor((n+3)/4)*l,x=new Uint8Array(c,w,y)),a.gl.compressedTexImage2D(a.gl.TEXTURE_2D,e,q,d,n,0,x),w+=y,(1!==d||1!==n)&&1!==m;++e)d=Math.max(1,d>>1),n=Math.max(1,n>>1);return b}})},"esri/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.Pos3=[{name:"position",count:3,type:5126,offset:0,stride:12,normalized:!1}];l.Pos3Tex=[{name:"position",count:3,type:5126,
offset:0,stride:20,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:20,normalized:!1}];l.Pos3Col=[{name:"position",count:3,type:5126,offset:0,stride:16,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:16,normalized:!1}];l.Pos3TexCol=[{name:"position",count:3,type:5126,offset:0,stride:24,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:24,normalized:!1},{name:"color",count:4,type:5121,offset:20,stride:24,normalized:!1}];l.Pos3TexRegion=[{name:"position",count:3,
type:5126,offset:0,stride:28,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:28,normalized:!1},{name:"region",count:4,type:5123,offset:20,stride:28,normalized:!1}];l.Pos3TexRegionCol=[{name:"position",count:3,type:5126,offset:0,stride:44,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:44,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:44,normalized:!1},{name:"color",count:4,type:5121,offset:40,stride:44,normalized:!1}];l.Pos3Norm=[{name:"position",count:3,
type:5126,offset:0,stride:24,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:24,normalized:!1}];l.Pos3NormTex=[{name:"position",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:32,normalized:!1}];l.Pos3NormCol=[{name:"position",count:3,type:5126,offset:0,stride:28,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:28,normalized:!1},{name:"color",count:4,
type:5121,offset:24,stride:28,normalized:!1}];l.Pos3NormTexCol=[{name:"position",count:3,type:5126,offset:0,stride:36,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:36,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:36,normalized:!1},{name:"color",count:4,type:5121,offset:32,stride:36,normalized:!1}];l.Pos3NormTexRegion=[{name:"position",count:3,type:5126,offset:0,stride:40,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:40,normalized:!1},{name:"uv0",
count:2,type:5126,offset:24,stride:40,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:40,normalized:!1}];l.Pos3NormTexRegionCol=[{name:"position",count:3,type:5126,offset:0,stride:44,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:44,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:44,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:44,normalized:!1},{name:"color",count:4,type:5121,offset:40,stride:44,normalized:!1}];l.Pos3NormSymcol=
[{name:"position",count:3,type:5126,offset:0,stride:28,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:28,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:24,stride:28,normalized:!1}];l.Pos3NormTexSymcol=[{name:"position",count:3,type:5126,offset:0,stride:36,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:36,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:36,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:32,stride:36,normalized:!1}];
l.Pos3NormColSymcol=[{name:"position",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"color",count:4,type:5121,offset:24,stride:32,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:28,stride:32,normalized:!1}];l.Pos3NormTexColSymcol=[{name:"position",count:3,type:5126,offset:0,stride:40,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:40,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:40,
normalized:!1},{name:"color",count:4,type:5121,offset:32,stride:40,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:36,stride:40,normalized:!1}];l.Pos3NormTexRegionSymcol=[{name:"position",count:3,type:5126,offset:0,stride:44,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:44,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:44,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:44,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:40,
stride:44,normalized:!1}];l.Pos3NormTexRegionColSymcol=[{name:"position",count:3,type:5126,offset:0,stride:48,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:48,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:48,normalized:!1},{name:"region",count:4,type:5123,offset:32,stride:48,normalized:!1},{name:"color",count:4,type:5121,offset:40,stride:48,normalized:!1},{name:"symbolColor",count:4,type:5121,offset:44,stride:48,normalized:!1}];l.Pos2=[{name:"position",count:2,type:5126,
offset:0,stride:8,normalized:!1}];l.Pos2Tex=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];l.Model=[{name:"model",count:16,type:5126,offset:0,stride:128,normalized:!1,divisor:1},{name:"modelNormal",count:16,type:5126,offset:64,stride:128,normalized:!1,divisor:1}];l.ModelCol=[{name:"model",count:16,type:5126,offset:0,stride:144,normalized:!1,divisor:1},{name:"modelNormal",count:16,type:5126,offset:64,stride:144,
normalized:!1,divisor:1},{name:"instanceColor",count:4,type:5126,offset:128,stride:144,normalized:!1,divisor:1}]})},"esri/views/3d/webgl-engine/lib/GLTextureRep":function(){define("require exports ./Util ../../../../core/Logger ../../../webgl/Texture ../../../webgl/enums".split(" "),function(m,l,h,d,b,g){var k=d.getLogger("esri.views.3d.webgl-engine.lib.GLTextureRep"),f=function(){function a(a){this._glTexture=null;this._refCount=0;this._glTexture=a}return a.prototype.incRefCnt=function(){++this._refCount},
a.prototype.decRefCnt=function(){--this._refCount;h.assert(0<=this._refCount)},a.prototype.getRefCnt=function(){return this._refCount},a.prototype.setGLTexture=function(a){this._glTexture=a},a.prototype.getGLTexture=function(){return this._glTexture},a}();return function(){function a(a,b,d,f){this.NUM_PARALLEL=8;this.textures=a;this._programRepository=b;this.getViewportToRestore=d;this._rctx=f;this.NUM_PARALLEL=8;this.id2textureRef={};this.loading={};this._queue=[];this.listeners=[];this.maxMaxAnisotropy=
(this.afExt=f.extensions.textureFilterAnisotropic)?f.parameters.maxMaxAnisotropy:1;this.maxAnisotropy=Math.min(8,this.maxMaxAnisotropy);this._needsRender=!0;this._fallbackTextureData=new Uint8Array(256);this._fallbackTextureTransparentData=new Uint8Array(256);for(a=0;a<this._fallbackTextureData.length;++a)this._fallbackTextureData[a]=255,this._fallbackTextureTransparentData[a]=0!==(a+1)%4?255:0;this._fallbackTextureDesc={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:8,height:8,
maxAnisotropy:8}}return a.prototype.resetNeedsRender=function(){this._needsRender=!1},a.prototype.needsRender=function(){return this._needsRender},a.prototype.aquire=function(a,c,d,g){var e=this,l=this.id2textureRef[a];if(null==l){c=this.textures[a];h.assert(void 0!==c);c.setUnloadFunc(this._unload.bind(this));d=!0===d;var q=this._createGLTextureDescription(c);if(l=new f(null),h.assert(null==this.id2textureRef[a]),this.id2textureRef[a]=l,c.initializeThroughRender)a=c.initializeThroughRender(this._rctx,
q),l.setGLTexture(a),g&&g(l);else if(c.deferredLoading())this.getLoadingCount()<this.NUM_PARALLEL?this._loadImage(a,q,g):this._queue.push([a,q,g]);else try{c.initializeThroughUpload(this._rctx,q,this._programRepository,this.getViewportToRestore(),function(a){l.setGLTexture(a);e._needsRender=!0;g&&g(l)})}catch(x){k.error("#aquire","Error loading texture: "+x.toString())}null==l.getGLTexture()&&l.setGLTexture(d?new b(this._rctx,this._fallbackTextureDesc,this._fallbackTextureTransparentData):new b(this._rctx,
this._fallbackTextureDesc,this._fallbackTextureData));this._needsRender=!0}return l.incRefCnt(),l},a.prototype.release=function(a){a=this.id2textureRef[a];void 0!==a&&(a.decRefCnt(),h.assert(0<=a.getRefCnt()))},a.prototype.getLoadingCount=function(){return Object.keys(this.loading).length},a.prototype.getIsLoaded=function(a){if(null==this.id2textureRef[a]||void 0!==this.loading[a])return!1;for(var b=0;b<this._queue.length;++b)if(this._queue[b][0]===a)return!1;return!0},a.prototype.addTextureListener=
function(a){h.assert(-1===this.listeners.indexOf(a));this.listeners.push(a)},a.prototype.removeTextureListener=function(a){a=this.listeners.indexOf(a);h.assert(-1!==a);this.listeners.splice(a,1)},a.prototype.getTexture=function(a){return this.textures[a]},a.prototype.getMaxAnisotropy=function(){return this.maxAnisotropy},a.prototype._unload=function(a){var b=this.id2textureRef[a];void 0!==b&&(b.getGLTexture().dispose(),delete this.id2textureRef[a]);this.next(a)},a.prototype._createGLTextureDescription=
function(a){return{target:3553,pixelFormat:6408,dataType:5121,maxAnisotropy:this.afExt&&a.params&&a.params.mipmap&&!a.params.disableAnisotropy?this.maxAnisotropy:void 0,wrapMode:a.params&&a.params.wrapClamp?33071:void 0}},a.prototype.next=function(a){if(a in this.loading){delete this.loading[a];var b=Object.keys(this.id2textureRef),e=Object.keys(this.loading);this.listeners.forEach(function(c){c(a,b,e)});this.processQueue()}},a.prototype._loadImage=function(a,b,d){var c=this;h.assert(null==this.loading[a]);
this.loading[a]=!0;var e=this.textures[a];h.assert(void 0!==e);setTimeout(function(){var f=c.id2textureRef[a];f&&f.getRefCnt()&&e.initializeThroughUpload(c._rctx,b,c._programRepository,c.getViewportToRestore(),function(b){c.next(a);c._needsRender=!0;f&&f.getRefCnt()&&(f.setGLTexture(b),d&&d(f))})},0)},a.prototype.processQueue=function(){for(var a=[],b=0;b<this._queue.length;++b){var d=this._queue[b][0],f=this.id2textureRef[d];void 0!==f&&(0===f.getRefCnt()?(f.getGLTexture().dispose(),delete this.id2textureRef[d]):
a.push(this._queue[b]))}this._queue=a;a=Math.min(this.NUM_PARALLEL-Object.keys(this.loading).length,this._queue.length);for(b=0;a>b;++b)this._loadImage(this._queue[b][0],this._queue[b][1],this._queue[b][2]);this._queue.splice(0,a)},a}()})},"esri/views/3d/webgl-engine/lib/RenderPass":function(){define(["require","exports"],function(m,l){var h;m=h||(h={});m[m.MATERIAL=0]="MATERIAL";m[m.MATERIAL_DEPTH=1]="MATERIAL_DEPTH";m[m.MATERIAL_NORMAL=2]="MATERIAL_NORMAL";m[m.MATERIAL_DEPTH_SHADOWMAP=3]="MATERIAL_DEPTH_SHADOWMAP";
m[m.MATERIAL_HIGHLIGHT=4]="MATERIAL_HIGHLIGHT";m[m.MAX_PASS=5]="MAX_PASS";return h})},"esri/views/3d/webgl-engine/lib/RenderSlot":function(){define(["require","exports"],function(m,l){var h;m=h||(h={});m[m.BACKGROUND=0]="BACKGROUND";m[m.INTERNAL_MATERIAL=1]="INTERNAL_MATERIAL";m[m.STENCIL_MATERIAL=2]="STENCIL_MATERIAL";m[m.OPAQUE_TERRAIN=3]="OPAQUE_TERRAIN";m[m.OPAQUE_MATERIAL=4]="OPAQUE_MATERIAL";m[m.OPAQUE_EXTERNAL=5]="OPAQUE_EXTERNAL";m[m.TRANSPARENT_MATERIAL=6]="TRANSPARENT_MATERIAL";m[m.TRANSPARENT_EXTERNAL=
7]="TRANSPARENT_EXTERNAL";m[m.TRANSPARENT_TERRAIN=8]="TRANSPARENT_TERRAIN";m[m.OCCLUSION_PIXELS=9]="OCCLUSION_PIXELS";m[m.POSTPROCESSING_HIGHLIGHT=10]="POSTPROCESSING_HIGHLIGHT";m[m.POSTPROCESSING_ATMOSPHERE=11]="POSTPROCESSING_ATMOSPHERE";m[m.POSTPROCESSING_EXTERNAL=12]="POSTPROCESSING_EXTERNAL";m[m.HUDMATERIAL1=13]="HUDMATERIAL1";m[m.HUDMATERIAL2=14]="HUDMATERIAL2";m[m.LINE_CALLOUTS=15]="LINE_CALLOUTS";m[m.LINE_CALLOUTS_HUD_DEPTH=16]="LINE_CALLOUTS_HUD_DEPTH";m[m.MAX_SLOTS=17]="MAX_SLOTS";return h})},
"esri/views/3d/environment/resources/SimpleAtmosphereTexture":function(){define([],function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAIACAYAAABD1gYFAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7AAAAOwAFq1okJAAAAB3RJTUUH4QkLDx4bnqU2+QAAAd1JREFUSMd9lkmWxDAIQ/Xluv+V0wuDjaeuhV+IGQUoJUnNwGfAVvx+lsBCWJIsCaMpQn8nuhgqyyEzbAX1Ih0oHaQZN5X5jul581diaDVbSgAdZv1YLoCLyn/RruCsOdcqR7RS/jXkLMa9UddcDn9O7G8gwprzs6xbQl/Fns3BE90r9veQ/wzNrTM5p1yDF1yokLCosDX5kik1lxeSWxfWsihN/lZcHuPIOuhccZ4Ovt74qQK3USkFzsQx7Ki5NgqoMI1J5ILztr9UrGoGHN2qnSEwOHiD97ByDghs/KIVYp9DfdIIoJPcBkWWnM2O2s5ru3su+8GdPLhM5048r/09UDsZmJ3HRwe5MT/aA9Ul4cG74+lIvICYlZcFY42B6vAzuz/HEVn5VbP3DDgQ7xuAGZtnI76cEkbPczDDgSMDR8iFkfBMTQV728mnsx84GopNWZxQsWJxbI9pD0hmNAzWB8bun41hRk+3mNlRFvbY86mcMEVCWWAX+xJbERJHWVPP3Wkq91uyDtuKDLrYNKLl7bww6rZulo3jnafyePJ64ZZi67aEl0MkbJtTbE1h+2vIzVOU3JwWISrNyNtfi+9xqECIXZk87ODcEMeBhjj41GN1Xf+DzP9c9UmPd39C1BID2rDpAwAAAABJRU5ErkJggg\x3d\x3d"})},
"esri/views/3d/environment/RealisticAtmosphere":function(){define("dojo/text!./materials/RealisticAtmosphereMaterial.xml ../../../core/watchUtils ../../../core/HandleRegistry ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/OffscreenRenderingHelper ../support/earthUtils ../../webgl/Program ../webgl-engine/lib/DefaultVertexBufferLayouts ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){var u=c.earthRadius,v=b.vec3d,x=b.vec2d,y=b.vec4d;b=.02*Math.PI;c=.004*Math.PI;var n=v.createFrom(1/Math.pow(.65,4),1/Math.pow(.57,4),1/Math.pow(.475,4)),w=v.create(n);v.scale(w,b);v.add(w,v.createFrom(c,c,c));var z=(1- -.99999*-.99999)/(2+-.99999*-.99999)*1.5;d=d.createSubclass({declaredClass:"esri.views.3d.environment.RealisticAtmosphere",properties:{view:{},planar:{value:!1,set:function(a){a=!!a;a!==this.planar&&this._update();this._set("planar",a)}},needsRender:{value:!1}},
constructor:function(){this._handles=new h;this._lowerElevationBoundRadius=0;this._earthRadius=u;this._renderer=this._skyPlanarProgram=this._skyProgram=this._hazePlanarProgram=this._hazeProgram=null;this._renderData={texDepth:x.create(),v3CameraPos:v.create(),v3CameraUp:v.create(),v3CameraRight:v.create(),v3CameraDir:v.create(),halfSizeNearPlane:x.create(),v2CameraCenterOffset:x.create(),v4SphereComp:y.create(),v4AtmosParams1:y.create(),v4AtmosParams2:y.create(),v4AtmosParams3:y.create(),v3InvWavelength:n,
v3InvWavelengthScaled:w,v4Radii:y.create(),fScale:0,fScaleDepth:.25,fLowerAlphaBlendBound:0,fScaleOverScaleDepth:0,fOneOverScaleDepth:0,fScaleDepthBlue:.05,fOneOverScaleDepthBlue:20,fScaleOverScaleDepthBlue:0,g:-.99999,g2:-.99999*-.99999,fMiePhaseCoefficients:z,showTest:0,nearFar:x.create()};this._updateRadius(u);this._hazeSlot=a.POSTPROCESSING_ATMOSPHERE;this._skySlot=a.BACKGROUND},destroy:function(){this._handles&&(this._handles.destroy(),this._handles=null);this._hazeProgram&&(this._hazeProgram.dispose(),
this._hazeProgram=null);this._hazePlanarProgram&&(this._hazePlanarProgram.dispose(),this._hazePlanarProgram=null);this._skyProgram&&(this._skyProgram.dispose(),this._skyProgram=null);this._skyPlanarProgram&&(this._skyPlanarProgram.dispose(),this._skyPlanarProgram=null)},setup:function(a){var b=k.createSquareGeometry().toRenderData(),c=this.renderContext.rctx;this._renderer=new g(b,t.Pos3Tex,null,c);b=this._update.bind(this);this._handles.add(l.init(this,"view.state.camera",b,!0));var b=this._updateElevation.bind(this),
e=function(){this._updateElevation({tile:this.view.basemapTerrain.rootTiles[0]})}.bind(this),d=this._updateVisibleElevationBounds.bind(this);this._handles.add(l.on(this,"view.basemapTerrain","elevation-change",b,e));this._handles.add(l.on(this,"view.basemapTerrain","elevation-bounds-change",d,d));a.shaderSnippets.fsRealisticAtmosphere||a.shaderSnippets._parse(m);this._hazeProgram=new q(c,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,r.Default3D,["HAZE"]);this._skyProgram=
new q(c,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,r.Default3D);this._hazePlanarProgram=new q(c,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,r.Default3D,["HAZE","PLANAR"]);this._skyPlanarProgram=new q(c,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,r.Default3D,["PLANAR"])},render:function(a){if(!(a.slot!=this._hazeSlot&&a.slot!=this._skySlot||a.pass!=f.MATERIAL||a.slot==this._hazeSlot&&a.options.earlyOcclusionPixelDraw)){var b,
c=this.renderContext.rctx,e=c.gl,d=a.offscreenRenderingHelper,g=!1;if(a.slot==this._hazeSlot){b=this.planar?this._hazePlanarProgram:this._hazeProgram;c.bindProgram(b);c.setBlendFunctionSeparate(e.ONE,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);d.detachDepthTextureFromBuffer();var g=!0,k=d.getDepthTexture();c.bindTexture(k,0);b.setUniform1i("tDepth",0);b.setUniform4fv("v4SphereComp",this._renderData.v4SphereComp)}return a.slot==this._skySlot&&(b=this.planar?this._skyPlanarProgram:this._skyProgram,c.bindProgram(b),
c.setBlendFunctionSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),b.setUniform4fv("v4SphereComp",this._renderData.v4SphereComp),b.setUniform4fv("v4AtmosParams3",this._renderData.v4AtmosParams3)),b.setUniform3fv("v3InvWavelength",this._renderData.v3InvWavelength),b.setUniform3fv("v3InvWavelengthScaled",this._renderData.v3InvWavelengthScaled),b.setUniform3fv("v3LightDir",a.lightingData.direction),b.setUniform3fv("v3CameraPos",this._renderData.v3CameraPos),b.setUniform3fv("v3CameraUp",
this._renderData.v3CameraUp),b.setUniform3fv("v3CameraRight",this._renderData.v3CameraRight),b.setUniform3fv("v3CameraDir",this._renderData.v3CameraDir),b.setUniform2fv("nearFar",this._renderData.nearFar),b.setUniform2fv("halfSizeNearPlane",this._renderData.halfSizeNearPlane),b.setUniform2fv("v2CameraCenterOffset",this._renderData.v2CameraCenterOffset),b.setUniform4fv("v4Radii",this._renderData.v4Radii),b.setUniform4fv("v4AtmosParams1",this._renderData.v4AtmosParams1),b.setUniform4fv("v4AtmosParams2",
this._renderData.v4AtmosParams2),b.setUniform1f("showTest",this._renderData.showTest),c.setDepthTestEnabled(!1),c.setBlendingEnabled(!0),this._renderer.render(b),c.setBlendingEnabled(!1),c.setDepthTestEnabled(!0),c.setBlendFunctionSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),g&&d.restoreDepthTextureToBuffer(),!0}},_setEnableTestImage:function(a){a?this._renderData.showTest=1:this._renderData.showTest=0;this.needsRender=!0},_adjustRadiusForTesselation:function(a){return a*
Math.cos(Math.PI/Math.pow(2,4)/16)},_normalizeRadius:function(a){return a=this._adjustRadiusForTesselation(a),Math.max(u-1E4,Math.min(a,u))},_updateElevation:function(a){0===a.tile.lij[0]&&(a=this._adjustRadiusForTesselation(u+a.tile.elevationBounds[0]),a!==this._lowerElevationBoundRadius&&(this._lowerElevationBoundRadius=a,this._earthRadius=-1,this._updateVisibleElevationBounds()))},_updateVisibleElevationBounds:function(){var a=this._adjustRadiusForTesselation(u+this.view.basemapTerrain.getElevationBounds()[0]);
return 0>this._earthRadius||a<this._earthRadius?this._updateRadius(a):!1},_updateRadius:function(a){this._earthRadius=a;var b=a*a,c=a/10*10.25,e=c*c,d=1/(c-a),f=d/.25,g=d/.05,k=.3*(c-a)+a,h=1/(c-k),l=this._renderData;return y.set4(d,.25,f,4,l.v4AtmosParams1),y.set4(-.99999,.05,g,20,l.v4AtmosParams2),y.set4(-.99999*-.99999,z,k,h,l.v4AtmosParams3),y.set4(a,b,c,e,l.v4Radii),l.fScale=d,l.fLowerAlphaBlendBound=k,l.fScaleOverScaleDepth=f,l.fScaleOverScaleDepthBlue=g,this._update(),!0},_update:function(a){if(a=
a||this.get("view.state.camera")){if(v.negate(a.viewForward,this._renderData.v3CameraDir),v.set(a.viewUp,this._renderData.v3CameraUp),v.set(a.viewRight,this._renderData.v3CameraRight),this.planar){var b=this.view.renderCoordsHelper;this._renderData.fCameraHeight=b.getAltitude(a.eye)/b.unitInMeters+u}else this._renderData.fCameraHeight=v.length(a.eye);this._renderData.fCameraHeight2=this._renderData.fCameraHeight*this._renderData.fCameraHeight;this._renderData.fC=this._renderData.fCameraHeight2-this._renderData.v4Radii[3];
this._renderData.fCSur=this._renderData.fCameraHeight2-this._renderData.v4Radii[1];this._renderData.v4SphereComp=y.createFrom(this._renderData.fCameraHeight,this._renderData.fCameraHeight2,this._renderData.fC,this._renderData.fCSur);v.set(a.eye,this._renderData.v3CameraPos);x.set2(Math.tan(a.fovX/2)/(a.width/a.fullWidth),Math.tan(a.fovY/2)/(a.height/a.fullHeight),this._renderData.halfSizeNearPlane);x.set2((a.padding[3]+a.width/2)/a.fullWidth-.5,(a.padding[2]+a.height/2)/a.fullHeight-.5,this._renderData.v2CameraCenterOffset);
x.set2(a.near,a.far,this._renderData.nearFar);this.needsRender=!0}}});return d.isSupported=function(a){return e.supportsDepthTexture(a.rctx.extensions)},d})},"esri/views/3d/webgl-engine/lib/OffscreenRenderingHelper":function(){define("require exports ./Util dojo/text!../materials/internal/offscreen.xml ../../../webgl/FramebufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Program ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){var r={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},u={target:3553,pixelFormat:6408,dataType:32819,samplingMode:9729,wrapMode:33071,width:0,height:0};return function(){function c(a,b){this._hudVisibilityTexture=null;this._enabled=!1;this.height=this.width=0;this._programRep=a;this._rctx=b;this.height=this.width=null}return c.prototype.enable=function(){if(!this.getEnableState()){var a=this._rctx;this._enabled=!0;
this.framebuffer=b.createWithAttachments(a,r,{colorTarget:0,depthStencilTarget:a.extensions.depthTexture?4:3});this.quadVAO=this.createQuadVAO(a)}},c.prototype.disable=function(){this.getEnableState()&&(this._enabled=!1,this.framebuffer.dispose(),this.quadVAO.dispose(!0),this.framebuffer=null,this.quadVAO=null,this._depthStencilTextureCached=null)},c.prototype.createQuadVAO=function(a){var b=new Float32Array([-1,-1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,1,1,1]);return new k(a,t.Default3D,{geometry:q.Pos2Tex},
{geometry:f.createVertex(a,35044,b)})},c.prototype.setEnableState=function(a){a?this.enable():this.disable()},c.prototype.getEnableState=function(){return this._enabled},c.prototype.getColorTexture=function(){return this.framebuffer.colorTexture},c.prototype.getDepthTexture=function(){return c.supportsDepthTexture(this._rctx.extensions)?this.framebuffer.depthStencilTexture||this._depthStencilTextureCached:null},c.prototype.getHUDVisibilityTexture=function(){return this._hudVisibilityTexture},c.supportsDepthTexture=
function(a){return!!a.depthTexture},c.prototype.initializeFrame=function(a){h.assert(this.getEnableState());var b=this._rctx,c=b.gl;a=a.fullViewport;this.width=a[2];this.height=a[3];this.framebuffer.resize(this.width,this.height);b.bindFramebuffer(this.framebuffer);b.setClearStencil(0);b.setClearColor(0,0,0,1);b.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT)},c.prototype.renderHUDVisibility=function(a){var b=this._rctx,c=b.gl;this._hudVisibilityTexture||(this._hudVisibilityTexture=
new g(b,u));this._hudVisibilityTexture.resize(this.width,this.height);var e=this.framebuffer.detachColorTexture();this.framebuffer.attachColorTexture(this._hudVisibilityTexture);b.bindFramebuffer(this.framebuffer);b.setClearColor(0,0,0,1);b.clear(c.COLOR_BUFFER_BIT);a();c.flush();this.framebuffer.detachColorTexture();this.framebuffer.attachColorTexture(e)},c.prototype.bindFramebuffer=function(){this._rctx.bindFramebuffer(this.framebuffer)},c.prototype.getFramebuffer=function(){return this.framebuffer},
c.prototype.detachDepthTextureFromBuffer=function(){this._depthStencilTextureCached=this.framebuffer.depthStencilTexture;this.framebuffer.detachDepthStencilTexture()},c.prototype.restoreDepthTextureToBuffer=function(){this.framebuffer.attachDepthStencilTexture(this._depthStencilTextureCached);this._depthStencilTextureCached=null},c.prototype.drawQuad=function(a){h.assert(this.getEnableState());a=this._rctx;var b=a.gl,c=this._programRep.get("offscreenProgram");a.bindFramebuffer();a.setDepthTestEnabled(!1);
a.clear(b.COLOR_BUFFER_BIT);a.bindProgram(c);c.setUniform1i("tex",1);a.bindTexture(this.framebuffer.colorTexture,1);a.bindVAO(this.quadVAO);a.drawArrays(5,0,e.vertexCount(this.quadVAO,"geometry"));a.setDepthTestEnabled(!0)},c.loadShaders=function(b,c,e,f){b._parse(d);b=new a(f,b.vsOffscreenRenderer,b.fsOffscreenRenderer,t.Default3D);e.add("offscreenProgram",b)},c}()})},"esri/views/3d/environment/SimpleAtmosphere":function(){define("dojo/text!./materials/SimpleAtmosphereMaterial.xml dojo/Deferred ../../../core/watchUtils ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/Texture ../webgl-engine/lib/Util ../webgl-engine/lib/GLTextureRep ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ./resources/SimpleAtmosphereTexture ../support/earthUtils ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){var v=t.earthRadius,x=b.vec3d,y=b.vec2d,n=b.mat4d,w=f.VertexAttrConstants,z=(v-1E4)/v,C=(v+3E5)/v,B=-1E4/3E5,F=1-B;return d.createSubclass({declaredClass:"esri.views.3d.environment.SimpleAtmosphere",properties:{view:{},needsRender:{value:!1},slot:{value:c.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={texV:y.create(),silCircleCenter:x.create(),silCircleV1:x.create(),silCircleV2:x.create()};this._textureRep=
this._texture=null},initialize:function(){this._textureDfd=new l;this.addResolvingPromise(this._textureDfd.promise)},destroy:function(){this._currentViewChangedHandle&&(this._currentViewChangedHandle.remove(),this._currentViewChangedHandle=null);this._textureRep&&(this._texture&&(this._textureRep.release("SimpleAtmosphere"),this._textureRep.getTexture("SimpleAtmosphere").unload()),this._textureRep=null);this._program&&(this._program.dispose(),this._program=null);this._textureDfd&&(this._textureDfd.cancel(),
this._textureDfd=null)},initializeRenderContext:function(b){this._textureRep=new a({SimpleAtmosphere:new k(q,"SimpleAtmosphere",{wrapClamp:!0})},b.programRep,function(){return this.view.state.camera.viewport}.bind(this),b.rctx);this._texture=this._textureRep.aquire("SimpleAtmosphere",void 0,void 0,function(a){this._texture=a.getGLTexture();this._textureDfd.resolve();this._textureDfd=null}.bind(this))},setup:function(a){var b=this._createRibbonGeometryData();this._renderer=new g(b,[{name:"position",
count:3,type:5126,offset:0,stride:12,normalized:!1}],null,a.rctx);this._currentViewChangedHandle=h.init(this,"view.state.camera",this._update.bind(this),!0);a.shaderSnippets.vsSimpleAtmosphere||a.shaderSnippets._parse(m);this._program=new r(a.rctx,a.shaderSnippets.vsSimpleAtmosphere,a.shaderSnippets.fsSimpleAtmosphere,u.Default3D)},render:function(a){if(a.slot!==this.slot||a.pass!==e.MATERIAL)return!1;var b=this.renderContext.rctx,c=b.gl,d=this._program;return b.bindProgram(d),d.setUniform4f("color",
1,1,1,1),d.setUniformMatrix4fv("proj",a.camera.projectionMatrix),d.setUniformMatrix4fv("view",a.camera.viewMatrix),d.setUniform3fv("silCircleCenter",this._renderData.silCircleCenter),d.setUniform3fv("silCircleV1",this._renderData.silCircleV1),d.setUniform3fv("silCircleV2",this._renderData.silCircleV2),d.setUniform2fv("texV",this._renderData.texV),b.bindTexture(this._texture,0),d.setUniform1i("tex",0),d.setUniform3fv("lightDirection",a.lightingData.direction),b.setDepthFunction(c.LEQUAL),b.setBlendingEnabled(!0),
b.setDepthWriteEnabled(!1),this._renderer.render(d),b.setBlendingEnabled(!1),b.setDepthWriteEnabled(!0),b.setDepthFunction(c.LESS),!0},_update:function(a){var b=x.create(),c=x.create(),e=x.create(),d=this.view.renderCoordsHelper.getAltitude(a.eye);x.scale(a.eye,(v+50)/x.length(a.eye),e);this._computeSilhouetteCircle(e,a.center,a.up,v);x.add(this._renderData.silCircleCenter,this._renderData.silCircleV2,b);x.scale(b,C,c);var e=this._computeScreenRimWidth(e,a.up,b,c),g=0,k=1,h=1;50>d?(g=.001953125,k=
.1015625):500>d?(h=(d-50)/450,g=.001953125*(1-h)+.001953125*h,k=.1015625*(1-h)+.21875*h):5E3>d?(h=(d-500)/4500,g=.001953125*(1-h)+.001953125*h,k=.21875*(1-h)+.51171875*h):5E4>d&&(h=(d-5E3)/45E3,g=.001953125*(1-h)+.001953125*h,k=.51171875*(1-h)+.4140625*h);d=B+g*F;h=B+e*k*F;50<x.length(a.eye)-v&&(this._computeSilhouetteCircle(a.eye,a.center,a.up,v),x.add(this._renderData.silCircleCenter,this._renderData.silCircleV2,b),x.scale(b,C,c),a=this._computeScreenRimWidth(a.eye,a.up,b,c),a=f.clamp((a-1.5)/(e-
1.5),0,1),d=B+a*g*F,h=B+f.lerp(1,e*k,a)*F);y.set2(d,h,this._renderData.texV);this.needsRender=!0},_computeSilhouetteCircle:function(a,b,c,e){var d=x.length(a),f=e*Math.sqrt(d*d-e*e)/d,g=this._renderData.silCircleV1,k=this._renderData.silCircleV2;return x.scale(a,Math.sqrt(e*e-f*f)/d,this._renderData.silCircleCenter),x.cross(a,b,g),1>x.length2(g)&&x.cross(a,c,g),x.scale(g,f/x.length(g)),x.cross(g,a,k),x.scale(k,f/x.length(k)),f},_computeScreenRimWidth:function(a,b,c,e){var d=n.create();n.lookAt(a,
c,b,d);a=this.view.state.camera;return f.project(c,d,a.projectionMatrix,a.viewport),f.project(e,d,a.projectionMatrix,a.viewport),x.dist(c,e)/a.height},_createRibbonGeometryData:function(){for(var a=new Float32Array(768),b=new Uint32Array(768),c=0;128>c;c++){var e=6*c;a[e+0]=c;a[e+1]=z;a[e+2]=0;a[e+3]=c;a[e+4]=C;a[e+5]=1;var d=2*c,f=127===c?0:d+2;b[e+0]=d;b[e+1]=d+1;b[e+2]=f+1;b[e+3]=f+1;b[e+4]=f;b[e+5]=d}c={};c[w.POSITION]=b;b={};return b[w.POSITION]={size:3,data:a},{indices:c,vertexAttr:b}}})})},
"esri/views/3d/environment/Stars":function(){define("dojo/text!./materials/StarMaterial.xml require ../../../request ../../../core/watchUtils ../../../core/promiseUtils ../../../core/Error ../../../core/Logger ../lib/glMatrix ../support/ExternalRenderer ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/Util ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations ../../webgl/Util".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x){var y=f.mat4d;f=f.mat3d;var n=c.VertexAttrConstants,w="9bb2ff;9eb5ff;aabfff;bbccff;ccd8ff ;dae2ff;e4e9ff;eeefff;f8f6ff;fff9fb;fff5ef;fff1e5;ffeddb;ffe9d2;ffe6ca;ffe3c3;ffe0bb;ffddb4;ffdaad;ffd6a5;ffd29c;ffcc8f;ffc178;ffa94b;ff7b00".split(";"),z=k.getLogger("esri.views.3d.environment.Stars"),C=f.toMat4(f.createFrom(1,0,0,0,.9174771405229186,.39778850739794974,0,-.39778850739794974,.9174771405229186)),B=f.toMat4(f.createFrom(1,0,0,0,.9174771405229186,-.39778850739794974,
0,.39778850739794974,.9174771405229186)),F=null;return a.createSubclass({properties:{view:{},numBinaryFloats:{value:2},numBinaryUInt8:{value:1},bytesPerStar:{value:9},needsRender:{value:!1},slot:{value:r.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={model:y.identity()};this.slot=r.BACKGROUND;this._vertexBufferLayout=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:20,
normalized:!1},{name:"size",count:1,type:5126,offset:16,stride:20,normalized:!1}]},initialize:function(){this._loadDataPromise=this._loadBrightStarCatalogue();this.addResolvingPromise(this._loadDataPromise)},destroy:function(){this._loadDataPromise.isFulfilled()||this._loadDataPromise.cancel("Atmosphere has been removed.");this._dateHandle&&(this._dateHandle.remove(),this._dateHandle=null);this._program&&(this._program.dispose(),this._program=null)},setup:function(a){this._numStars=this._starData.byteLength/
this.bytesPerStar;var b=new Float32Array(this._starData,0,this._numStars*this.numBinaryFloats),c=new Uint8Array(this._starData,this._numStars*this.numBinaryFloats*4,this._numStars*this.numBinaryUInt8),b=this._createStarGeometryData(b,c);this._renderer=new e(b,this._vertexBufferLayout,this._fillInterleaved,a.rctx);this._renderer.enablePointRendering(!0);this._dateHandle=d.init(this,"view.environment.lighting.date",this._update.bind(this));a.shaderSnippets.vertexShaderStar||a.shaderSnippets._parse(m);
this._program=new u(a.rctx,a.shaderSnippets.vertexShaderStar,a.shaderSnippets.fragmentShaderStar,v.Default3D)},render:function(a){if(a.slot!==this.slot||a.pass!==t.MATERIAL)return!1;var b=this.renderContext.rctx,c=b.gl,e=this._program;return b.bindProgram(e),e.setUniformMatrix4fv("view",a.camera.viewMatrix),e.setUniformMatrix4fv("proj",a.camera.projectionMatrix),e.setUniform4fv("viewport",a.camera.fullViewport),e.setUniformMatrix4fv("model",this._renderData.model),b.setDepthFunction(c.LEQUAL),b.setBlendingEnabled(!0),
b.setBlendFunctionSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA),b.setDepthWriteEnabled(!1),this._renderer.render(e),b.setBlendingEnabled(!1),b.setDepthWriteEnabled(!0),b.setDepthFunction(c.LESS),!0},_fillInterleaved:function(a,b,c,e,d,f,g){var k=x.getStride(d);c=k/4;var h=q.fill,l=a.indices[n.POSITION],r=a.vertexAttr[n.POSITION].data;e=g+x.findAttribute(d,"position").offset/4;for(var m=0;m<l.length;++m){var t=3*l[m];h(r,t,f,e,b,3);e+=c}b=a.indices[n.COLOR];l=a.vertexAttr[n.COLOR].data;
e=g+x.findAttribute(d,"color").offset;r=new Uint8Array(f.buffer);for(m=0;m<b.length;++m)t=4*b[m],h(l,t,r,e,null,4),e+=k;k=a.indices[n.SIZE];a=a.vertexAttr[n.SIZE].data;e=g+x.findAttribute(d,"size").offset/4;for(m=0;m<k.length;++m)f[e]=a[k[m]],e+=c},_computeDayDuration:function(a){var b=new Date(a.getFullYear(),0,1,11,58,56),c=new Date(a.getFullYear()+1,0,1,11,58,55);return(a-b)/(c-b)},_update:function(a){if(a){var b=a.getHours()/12,c=a.getMinutes()/60*(2/24),e=a.getSeconds()/60*(2/1440),b=(b+c+e-
.9972222)%2;a=2*this._computeDayDuration(a);c=y.create(B);y.rotateZ(c,-a*Math.PI);y.multiply(C,c,c);y.rotateZ(c,-b*Math.PI);this._renderData.model=c;this.needsRender=!0}},_hexToRGB:function(a){return[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16)]},_unpackUint8Attributes:function(a){return 192<=a?[2.9,a-192]:160<=a?[2.5,a-160]:128<=a?[2,a-128]:96<=a?[1.5,a-96]:64<=a?[1,a-64]:32<=a?[.7,a-32]:[.4,a]},_createStarGeometryData:function(a,b){for(var c=new Float32Array(3*
this._numStars),e=new Uint8Array(4*this._numStars),d=new Float32Array(this._numStars),f=new Uint32Array(this._numStars),g=0;g<this._numStars;g++){var k=2*g,h=3*g,l=4*g,q=a[k+0],k=a[k+1];c[h+0]=-Math.cos(q)*Math.sin(k);c[h+1]=-Math.sin(q)*Math.sin(k);c[h+2]=-Math.cos(k);h=this._unpackUint8Attributes(b[g]);q=this._hexToRGB(w[h[1]]);e[l+0]=255*q[0];e[l+1]=255*q[1];e[l+2]=255*q[2];e[l+3]=255;d[g]=h[0];f[g]=g}a={};a[n.POSITION]=f;a[n.NORMAL]=f;a[n.UV0]=f;a[n.COLOR]=f;a[n.SIZE]=f;f={};return f[n.POSITION]=
{size:3,data:c},f[n.COLOR]={size:4,data:e},f[n.SIZE]={size:1,data:d},{indices:a,vertexAttr:f}},_verifyStartData:function(a){if(!a)throw new g("stars:no-data-received","Failed to create stars because star catalogue is missing");a=a.byteLength/this.bytesPerStar;if(0!==a%1||5E4<a||5E3>a)throw new g("stars:invalid-data","Failed to create stars because star catalogue data is invalid");},_loadBrightStarCatalogue:function(){return F?(this._starData=F,b.resolve()):h(l.toUrl("./resources/stars.wsv"),{responseType:"array-buffer",
failOk:!0}).then(function(a){a=a.data;this._verifyStartData(a);this._starData=F=a}.bind(this)).otherwise(function(a){throw z.error("loadBrightStarCatalogue",a.message),a;})}})})},"esri/views/3d/webgl-engine/lighting/Lightsources":function(){define(["require","exports","../../lib/glMatrix"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});var d=h.vec3d;m=function(){return function(b,g,k){void 0===b&&(b=d.create());void 0===g&&(g=d.createFrom(.57735,.57735,.57735));void 0===k&&(k=!0);
this.intensity=b;this.direction=g;this.castShadows=k}}();l.MainLight=m;m=function(){return function(b,g){void 0===b&&(b=d.create());void 0===g&&(g=d.createFrom(.57735,.57735,.57735));this.intensity=d.create();this.direction=d.create();this.intensity=b;this.direction=g}}();l.FillLight=m;m=function(){return function(b){void 0===b&&(b=d.create());this.intensity=b}}();l.AmbientLight=m;m=function(){return function(){this.sh={r:[0],g:[0],b:[0]}}}();l.SphericalHarmonicsLight=m})},"esri/views/3d/constraints/Constraints":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ./AltitudeConstraint ./ClipDistanceConstraint ./TiltConstraint ./CollisionConstraint".split(" "),
function(m,l,h,d,b,g,k,f,a,e){Object.defineProperty(l,"__esModule",{value:!0});m=function(c){function g(){var b=null!==c&&c.apply(this,arguments)||this;return b.tilt=new a["default"],b.altitude=new k["default"],b.clipDistance=new f["default"],b.collision=new e["default"],b}return h(g,c),d([b.property({type:a["default"]})],g.prototype,"tilt",void 0),d([b.property({type:k["default"]})],g.prototype,"altitude",void 0),d([b.property({type:f["default"]})],g.prototype,"clipDistance",void 0),d([b.property({type:e["default"]})],
g.prototype,"collision",void 0),g=d([b.subclass("esri.views.3d.constraints.Constraints")],g)}(b.declared(g));l.Constraints=m;l["default"]=m})},"esri/views/3d/constraints/AltitudeConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor dojo/_base/kernel ../state/Constraints".split(" "),function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});m=
function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;return b.min=f.AltitudeDefault.min,b.max=f.AltitudeDefault.max,b}return h(e,a),Object.defineProperty(e.prototype,"mode",{get:function(){return k.deprecated("esri.views.SceneView.constraints.altitude.mode is deprecated. The altitude constraint no longer applies to local scenes and does not have an automatic mode anymore.","","4.6"),"manual"},set:function(a){k.deprecated("esri.views.SceneView.constraints.altitude.mode is deprecated. The altitude constraint no longer applies to local scenes and does not have an automatic mode anymore.",
"","4.6")},enumerable:!0,configurable:!0}),d([b.property({type:Number})],e.prototype,"min",void 0),d([b.property({type:Number})],e.prototype,"max",void 0),e=d([b.subclass("esri.views.3d.constraints.AltitudeConstraint")],e)}(b.declared(g));l.AltitudeConstraint=m;l["default"]=m})},"esri/views/3d/constraints/ClipDistanceConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),
function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;return a.mode="auto",a}return h(f,g),Object.defineProperty(f.prototype,"near",{get:function(){return this._get("near")},set:function(a){this._set("near",a);a>=this._get("far")&&(this.far=a+1E-9);this.mode="manual"},enumerable:!0,configurable:!0}),f.prototype.castNear=function(a){return Math.max(1E-8,a)},Object.defineProperty(f.prototype,"far",{get:function(){return this._get("far")},
set:function(a){this._set("far",a);a<=this._get("near")&&(this.near=a-1E-9);this.mode="manual"},enumerable:!0,configurable:!0}),f.prototype.castFar=function(a){return Math.max(1E-8,a)},f.prototype.autoUpdate=function(a,b){"auto"===this.mode&&(this._get("near")!==a&&this._set("near",a),this._get("far")!==b&&this._set("far",b))},d([b.property({type:Number,value:1E-8})],f.prototype,"near",null),d([b.cast("near")],f.prototype,"castNear",null),d([b.property({type:Number,value:1E-8})],f.prototype,"far",
null),d([b.cast("far")],f.prototype,"castFar",null),d([b.property({type:String})],f.prototype,"mode",void 0),f=d([b.subclass("esri.views.3d.constraints.ClipDistanceConstraint")],f)}(b.declared(g));l.ClipDistanceConstraint=m;l["default"]=m})},"esri/views/3d/constraints/TiltConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../support/mathUtils ../state/Constraints".split(" "),
function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});var a=k.rad2deg(f.TiltDefault.min),e=k.rad2deg(f.TiltDefault.max);m=function(c){function f(){var a=null!==c&&c.apply(this,arguments)||this;return a.mode="auto",a}return h(f,c),Object.defineProperty(f.prototype,"max",{get:function(){return this._get("max")},set:function(a){this._set("max",a);this.mode="manual"},enumerable:!0,configurable:!0}),f.prototype.castMax=function(b){return k.clamp(b,a,e)},f.prototype.autoUpdate=function(a){"auto"===
this.mode&&this._get("max")!==a&&this._set("max",a)},d([b.property({type:String})],f.prototype,"mode",void 0),d([b.property({type:Number,value:e})],f.prototype,"max",null),d([b.cast("max")],f.prototype,"castMax",null),f=d([b.subclass("esri.views.3d.constraints.TiltConstraint")],f)}(b.declared(g));l.TiltConstraint=m;l["default"]=m})},"esri/views/3d/constraints/CollisionConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),
function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;return a.enabled=!0,a}return h(f,g),d([b.property()],f.prototype,"enabled",void 0),f=d([b.subclass("esri.views.3d.constraints.CollisionConstraint")],f)}(b.declared(g));l.CollisionConstraint=m;l["default"]=m})},"esri/views/3d/input/SceneInputManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/watchUtils ../../../core/Accessor ../../../core/HandleRegistry ../../../core/accessorSupport/decorators ../../input/InputManager ../../input/BrowserEventSource ../../input/ViewEvents ../../input/handlers/PreventContextMenu ./handlers/DoubleClickZoom ./handlers/DragRotate ./handlers/DragZoom ./handlers/KeyPan ./handlers/MouseWheelZoom ./handlers/SingleKeyResetHeading ./handlers/SingleKeyResetTilt ./handlers/PointerDownCancelAnimation ./handlers/TwoFingerTilt ./handlers/PinchAndPanNavigation".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C){m=function(g){function l(){var a=null!==g&&g.apply(this,arguments)||this;return a._handles=new k,a}return h(l,g),l.prototype.initialize=function(){var a=this;this.viewEvents=new c.ViewEvents(this.view);this._handles.add([b.whenNot(this.view,"ready",function(){return a._disconnect()}),b.when(this.view,"ready",function(){return a._connect()})])},l.prototype.destroy=function(){this._handles&&(this._handles.removeAll(),this._handles=null);this._disconnect()},
Object.defineProperty(l.prototype,"primaryDragAction",{get:function(){return this._get("primaryDragAction")},set:function(a){"pan"!==a&&"rotate"!==a||a===this._get("primaryDragAction")||(this._set("primaryDragAction",a),this._updateMode())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"mode",{get:function(){return this._get("mode")},set:function(a){"default"!==a&&"pro"!==a||a===this._get("mode")||(this._set("mode",a),this._updateMode())},enumerable:!0,configurable:!0}),l.prototype._disconnect=
function(){this.viewEvents.disconnect();this._source&&(this._source.destroy(),this._source=null);this._inputManager&&(this._inputManager.destroy(),this._inputManager=null)},l.prototype._connect=function(){var b=this.view;this._source=new e.BrowserEventSource(this.view.canvas);var c=new a.InputManager(this._source);this._inputManager=c;c.installHandlers("prevent-context-menu",[new q.PreventContextMenu]);this._modeDragPan=new C.PinchAndPanNavigation(b,"primary");this._modeDragRotate=new r.DragRotate(b,
"secondary","center");this._modeDragZoom=new u.DragZoom(b,"tertiary");c.installHandlers("navigation",[new w.PointerDownCancelAnimation(b),new t.DoubleClickZoom(b),new v.KeyPan(b,{left:"ArrowLeft",right:"ArrowRight",forward:"ArrowUp",backward:"ArrowDown",up:"u",down:"j"}),new x.MouseWheelZoom(b),new n.SingleKeyResetTilt(b,"p"),new y.SingleKeyResetHeading(b,"n"),new r.DragRotate(b,"primary","eye",["b"]),new r.DragRotate(b,"secondary","center",["b"]),new C.PinchAndPanNavigation(b,"tertiary",["b"]),this._modeDragRotate,
this._modeDragZoom,this._modeDragPan,new z.TwoFingerTilt(b)]);this.viewEvents.connect(c);this._updateMode()},l.prototype._updateMode=function(){var a=this.primaryDragAction,a=B.get(this.mode).get(a);this._modeDragPan&&(this._modeDragPan.pointerType=a.pan);this._modeDragRotate&&(this._modeDragRotate.pointerType=a.rotate);this._modeDragZoom&&(this._modeDragZoom.pointerType=a.zoom)},d([f.property()],l.prototype,"view",void 0),d([f.property({value:"pan"})],l.prototype,"primaryDragAction",null),d([f.property({value:"default"})],
l.prototype,"mode",null),d([f.property({readOnly:!0,aliasOf:"_inputManager.latestPointerType"})],l.prototype,"latestPointerType",void 0),d([f.property()],l.prototype,"_inputManager",void 0),l=d([f.subclass("esri.views.3d.input.SceneInputManager")],l)}(f.declared(g));var B=new Map;l=new Map;g=new Map;return l.set("pan",{pan:"primary",rotate:"secondary",zoom:"tertiary"}),l.set("rotate",{pan:"secondary",rotate:"primary",zoom:"tertiary"}),g.set("pan",{pan:"primary",rotate:"tertiary",zoom:"secondary"}),
g.set("rotate",{pan:"tertiary",rotate:"primary",zoom:"secondary"}),B.set("default",l),B.set("pro",g),m})},"esri/views/3d/input/handlers/DoubleClickZoom":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/InputHandler ../../../input/handlers/support ../../state/helpers/PickingHelper ../../state/controllers/global/ZoomStepController ../../state/controllers/local/ZoomStepController".split(" "),function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});
m=function(a){function e(b,e){var c=a.call(this,!0)||this;return c.view=b,c.pickingHelper=new g.PickingHelper(b),c.registerIncoming("double-click",e,function(a){return c.handleDoubleClick(a)}),c}return h(e,a),e.prototype.handleDoubleClick=function(a){var c=a.data;if(b.eventMatchesPointerType(c["native"],"primary")){var e=this.view.state.isGlobal?new k.ZoomStepController(this.view,this.pickingHelper,"animation"):new f.ZoomStepController(this.view,this.pickingHelper,"animation");this.view.state.switchCameraController(e);
e.zoomStep(Math.log(.5)/Math.log(.6),[c.x,this.view.height-c.y]);a.stopPropagation()}},e}(d.InputHandler);l.DoubleClickZoom=m})},"esri/views/3d/state/controllers/global/ZoomStepController":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../PointToPointAnimationController ../../../camera/constraintUtils ../../../lib/glMatrix ../../utils/navigationUtils ../../../webgl-engine/lib/Camera ../../../../animation/easing".split(" "),function(m,l,h,d,b,g,k,f,a){Object.defineProperty(l,
"__esModule",{value:!0});m=function(e){function c(a,b,c){b=e.call(this,a.state,b,"interaction"===c?null:void 0)||this;return b.view=a,b.mode=c,b.zoomLocation=g.vec3d.create(),b.tmpCamera=new f,b.panAxis=g.vec3d.create(),b.tmpViewDir=g.vec3d.create(),b.targetOnSphere=g.vec3d.create(),b.constraintOptions={selection:7,interactionType:1,interactionFactor:null,interactionStartCamera:new f,interactionDirection:null},b.sphere={center:g.vec3d.create(),radius:0},b}return h(c,e),Object.defineProperty(c.prototype,
"isInteractive",{get:function(){return"interaction"===this.mode},enumerable:!0,configurable:!0}),c.prototype.zoomStep=function(a,b){if(this.active){var c=this.view.state,e=this.constraintOptions.interactionStartCamera;this.animation.finished?e.copyFrom(c.camera):this.animation.cameraAt(1,e);e=!1;0<a&&this.pickingHelper.pickPointInScreen(b,this.zoomLocation)&&(e=!0);this.tmpCamera.copyFrom(c.camera);e||(this.pickingHelper.pickRaySegment(this.tmpCamera.eye,this.tmpCamera.center,this.zoomLocation)?this.tmpCamera.center=
this.zoomLocation:g.vec3d.set(this.tmpCamera.center,this.zoomLocation));this.updateCamera(this.tmpCamera,Math.pow(.6,a),this.zoomLocation,b);this.begin(this.tmpCamera)}},c.prototype.animationSettings=function(){return{apex:null,duration:.6,easing:a.outExpo}},c.prototype.updateCamera=function(a,c,e,d){this.sphere.radius=g.vec3d.length(e);g.vec3d.subtract(a.center,a.eye,this.tmpViewDir);var f=g.vec3d.length(this.tmpViewDir),h=f*c;if(1>=c&&4>h&&(h=4,c=h/f),!(1E-6>Math.abs(f-h))){f=g.vec3d.length(a.center);
this.sphere.radius!==f&&g.vec3d.scale(a.center,(this.sphere.radius+c*(f-this.sphere.radius))/f);if(g.vec3d.scale(this.tmpViewDir,-c),g.vec3d.add(a.center,this.tmpViewDir,a.eye),b.applyAll(this.view,a,this.constraintOptions),1E-12<g.vec3d.dist2(e,a.center)&&k.intersectSphereFromScreenPoint(this.sphere,a,d,this.targetOnSphere))c=k.rotationAndAxisFromPoints(e,this.targetOnSphere,this.panAxis),k.applyRotation(a,this.sphere.center,this.panAxis,c);b.applySurfaceCollision(this.view,a)}},c}(d.PointToPointAnimationController);
l.ZoomStepController=m})},"esri/views/3d/state/utils/navigationUtils":function(){define(["require","exports","../../lib/glMatrix","./primitiveIntersectionUtils","../../support/mathUtils"],function(m,l,h,d,b){function g(a,b,c,f,g){void 0===g&&(g=!1);var k=B;return d.createRay(b,c,k,g),d.intersectSphere(a,k,f)?!0:(e(a,k,f),!1)}function k(a,b,c,e){var f=B;return d.createRay(b,c,f,!0),d.intersectSphere(a,f,e)}function f(a,c,e){h.vec3d.cross(a,c,e);a=h.vec3d.dot(a,c)/(h.vec3d.length(a)*h.vec3d.length(c));
return-b.acos(a)}function a(a,b,c,e){var d=y;h.mat4d.identity(d);h.mat4d.rotate(d,e,c);h.vec3d.subtract(a.eye,b);h.mat4d.multiplyVec3(d,a.eye,a.eye);h.vec3d.add(a.eye,b);h.vec3d.subtract(a.center,b);h.mat4d.multiplyVec3(d,a.center,a.center);h.vec3d.add(a.center,b);h.mat4d.multiplyVec3(d,a.up,a.up);a.markViewDirty()}function e(a,c,e){var d=w,f=z,g=x;h.vec3d.subtract(c.origin,a.center,f);h.vec3d.cross(f,c.direction,d);h.vec3d.cross(d,f,e);h.vec3d.scale(e,1/h.vec3d.length(e)*a.radius);a=-b.asin(a.radius/
h.vec3d.length(c.origin));h.mat4d.identity(g);h.mat4d.rotate(g,a,d);h.mat4d.multiplyVec3(g,e)}function c(a,b){h.vec3d.set3(0,0,0,b);for(var c=0;c<a.length;c++)h.vec3d.add(b,a[c]);h.vec3d.scale(b,1/a.length)}Object.defineProperty(l,"__esModule",{value:!0});l.Earth={center:h.vec3d.create(),radius:6378137};l.normalizeCoordinate=function(a,b,c){return c[0]=b[0]/a.width,c[1]=b[1]/a.height,c};l.sphereOrSilhouettePointFromScreenPoint=g;l.intersectSphereFromScreenPoint=k;l.rotationAndAxisFromPoints=f;l.rotationFromPointsAroundAxis=
function(a,b,c){var e=w,d=z,f=C;h.vec3d.set(a,d);h.vec3d.set(b,f);a=h.vec3d.dot(d,c);b=h.vec3d.dot(f,c);h.vec3d.scale(c,a,e);h.vec3d.subtract(d,e);h.vec3d.normalize(d);h.vec3d.scale(c,b,e);h.vec3d.subtract(f,e);h.vec3d.normalize(f);a=h.vec3d.dot(d,f);h.vec3d.cross(c,d,e);c=h.vec3d.dot(f,e);return Math.atan2(c,a)};l.setPlane=function(a,b,c){h.vec3d.set(b,c.normal);c.d=-h.vec3d.dot(b,a)};l.setPlaneD=function(a,b){b.d=-h.vec3d.dot(b.normal,a)};l.normalizeRotationDelta=function(a){for(;a>Math.PI;)a-=
2*Math.PI;for(;a<-Math.PI;)a+=2*Math.PI;return a};l.applyRotation=a;l.closestPointOnSphereSilhouette=e;l.intersectPlaneFromScreenPoint=function(a,b,c,e){var f=B;return d.createRay(b,c,f),d.intersectPlane(a,f,e)};l.applyZoomToPoint=function(a,b,c,e){var d=n;c=1-c;h.vec3d.subtract(b,a.eye,d);var f=h.vec3d.length(d),g=f*(1-c);0<=c&&e>g&&(g=e,c=-(g-f)/f);1E-6>Math.abs(f-g)||(h.vec3d.scale(d,c),h.vec3d.add(a.eye,d),h.vec3d.lerp(a.center,b,c))};l.applyZoomOnSphere=function(a,b,c){h.vec2d.set2(b.width/2,
b.height/2,q);k(a,b,q,b.center);h.vec3d.subtract(b.center,b.eye,n);a=h.vec3d.length(n);1E-6>Math.abs(a-a*c)||(h.vec3d.scale(n,c),h.vec3d.subtract(b.center,n,b.eye),b.markViewDirty())};var q=h.vec2d.create();l.navPointToScreenPoint=function(a,b,c){h.vec2d.set2(b.x,a.height-b.y,c)};l.centroidOnSphere=function(a,b,e){c(b,e);h.vec3d.normalize(e);h.vec3d.scale(e,a)};l.centroid=c;var t;!function(a){a[a.Vertical=0]="Vertical";a[a.Horizontal=1]="Horizontal"}(t=l.PanMode||(l.PanMode={}));l.VerticalPanTresholds=
{Elevation:3E4,Angle:8/180*Math.PI};l.pickPointAndInitSphere=function(a,b,c,e){var d=h.vec3d.create(),f={center:h.vec3d.create(),radius:0},n=!0;return a.pickPointInScreen(c,d)?f.radius=h.vec3d.length(d):(f.radius=h.vec3d.length(b.center),f.radius<.9*l.Earth.radius&&(f.radius=l.Earth.radius),f.radius=Math.max(h.vec3d.length(b.center),.9*l.Earth.radius),e?g(f,b,c,d):n=k(f,b,c,d)),{sphere:f,scenePickPoint:n?d:null}};l.decidePanMode=function(a,b,c){if(h.vec3d.length(a.eye)-l.Earth.radius<l.VerticalPanTresholds.Elevation){if(b.radius>
h.vec3d.length(a.eye))return t.Vertical;h.vec3d.normalize(h.vec3d.subtract(a.eye,c,r));return Math.abs(.5*Math.PI-Math.acos(h.vec3d.dot(c,r)/h.vec3d.length(c)))<l.VerticalPanTresholds.Angle?t.Vertical:t.Horizontal}return t.Horizontal};var r=h.vec3d.create();l.applyPanPlanar=function(a,b,c,e){h.vec3d.subtract(c,b,u);h.vec3d.subtract(a.eye,u);h.vec3d.subtract(a.center,u);a.markViewDirty();e&&e.estimator.addPanValue(e.time,e.endScreenPoint,c,u)};var u=h.vec3d.create();l.applyPanSpherical=function(b,
c,e,d,g){e=f(e,d,v);a(c,b.center,v,e);g&&g.estimator.addPanValue(g.time,g.endScreenPoint,d,v)};var v=h.vec3d.create(),x=h.mat4d.create(),y=h.mat4d.create(),n=h.vec3d.create(),w=h.vec3d.create(),z=h.vec3d.create(),C=h.vec3d.create(),B={origin:h.vec3d.create(),direction:h.vec3d.create()}})},"esri/views/3d/state/utils/primitiveIntersectionUtils":function(){define(["require","exports","../../lib/glMatrix"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.createRay=function(b,k,f,a){void 0===
a&&(a=!1);h.vec3d.set3(k[0],k[1],0,d);a?h.vec3d.set(b.eye,f.origin):h.vec3d.unproject(d,b.viewMatrix,b.projectionMatrix,b.fullViewport,f.origin);d[2]=1;h.vec3d.unproject(d,b.viewMatrix,b.projectionMatrix,b.fullViewport,f.direction);h.vec3d.subtract(f.direction,f.origin,f.direction);h.vec3d.normalize(f.direction)};l.intersectSphere=function(d,k,f){var a=h.vec3d.subtract(k.origin,d.center,b),e=h.vec3d.dot(k.direction,k.direction),c=2*h.vec3d.dot(k.direction,a);d=h.vec3d.dot(a,a)-d.radius*d.radius;d=
c*c-4*e*d;if(0>d)return!1;a=Math.sqrt(d);d=(-c-a)/(2*e);e=(-c+a)/(2*e);return(0>d||d>e&&0<e)&&(d=e),0<d?(h.vec3d.add(k.origin,h.vec3d.scale(k.direction,d,f),f),!0):!1};l.intersectPlane=function(b,d,f){var a=h.vec3d.dot(b.normal,d.direction);if(0===a)return!1;b=-(h.vec3d.dot(b.normal,d.origin)+b.d)/a;return 0>b?!1:(h.vec3d.add(d.origin,h.vec3d.scale(d.direction,b,f),f),!0)};var d=h.vec3d.create(),b=h.vec3d.create()})},"esri/views/3d/state/controllers/local/ZoomStepController":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../PointToPointAnimationController ../../../camera/constraintUtils ../../../lib/glMatrix ../../../webgl-engine/lib/Camera ../../../../animation/easing".split(" "),
function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});m=function(a){function e(b,e,d){e=a.call(this,b.state,e,"interaction"===d?null:void 0)||this;return e.view=b,e.mode=d,e.zoomLocation=g.vec3d.create(),e.tmpCamera=new k,e.tmpRayDir=g.vec3d.create(),e.constraintOptions={selection:15,interactionType:1,interactionFactor:null,interactionStartCamera:new k,interactionDirection:null},e}return h(e,a),Object.defineProperty(e.prototype,"isInteractive",{get:function(){return"interaction"===
this.mode},enumerable:!0,configurable:!0}),e.prototype.zoomStep=function(a,b){if(this.active){var c=this.view.state,e=this.constraintOptions.interactionStartCamera;this.animation.finished?e.copyFrom(c.camera):this.animation.cameraAt(1,e);this.tmpCamera.copyFrom(c.camera);0<a?this.pickingHelper.pickPointInScreen(b,this.zoomLocation)||this.pickingHelper.pickFreePointInScreen(b,this.zoomLocation):this.pickingHelper.pickRaySegment(this.tmpCamera.eye,this.tmpCamera.center,this.zoomLocation)?this.tmpCamera.center=
this.zoomLocation:g.vec3d.set(this.tmpCamera.center,this.zoomLocation);this.updateCamera(this.tmpCamera,Math.pow(.6,a),this.zoomLocation,b);this.begin(this.tmpCamera)}},e.prototype.animationSettings=function(){return{apex:null,duration:.6,easing:f.outExpo}},e.prototype.updateCamera=function(a,e,d,f){g.vec3d.subtract(d,a.eye,this.tmpRayDir);f=g.vec3d.length(this.tmpRayDir);var c=f*e;1>=e&&4>c&&(c=4,e=c/f);1E-6>Math.abs(f-c)||(g.vec3d.scale(this.tmpRayDir,e),g.vec3d.subtract(d,this.tmpRayDir,a.eye),
g.vec3d.lerp(a.center,d,1-e),b.applyAll(this.view,this.tmpCamera,this.constraintOptions))},e}(d.PointToPointAnimationController);l.ZoomStepController=m})},"esri/views/3d/input/handlers/DragRotate":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/InputHandler ../../../input/handlers/support ../../state/controllers/RotateController ../../state/helpers/PickingHelper".split(" "),function(m,l,h,d,b,g,k){Object.defineProperty(l,"__esModule",{value:!0});m=function(d){function a(a,
b,f,g){var c=d.call(this,!0)||this;return c.view=a,c.pointerType=b,c.pivotPoint=f,c.pickingHelper=new k.PickingHelper(a),c.registerIncoming("drag",g,function(a){return c.handleDrag(a)}),c}return h(a,d),a.prototype.handleDrag=function(a){var c=a.data;if(!(1<c.pointers.length)){var e=c.pointers[0];if(b.eventMatchesMousePointerType(e.startEvent["native"],this.pointerType)){e=[e.currentEvent.x,this.view.height-e.currentEvent.y];switch(c.action){case "start":this.cameraController=new g.RotateController(this.view,
this.pickingHelper,this.pivotPoint);this.view.state.switchCameraController(this.cameraController);this.cameraController.begin(e);break;case "update":this.cameraController.update(e);break;case "end":this.cameraController.end(),this.cameraController=null}a.stopPropagation()}}},a}(d.InputHandler);l.DragRotate=m})},"esri/views/3d/state/controllers/RotateController":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../camera/constraintUtils ./InteractiveController ../../lib/glMatrix ../../support/mathUtils ../../state/utils/navigationUtils ../../state/Constraints".split(" "),
function(m,l,h,d,b,g,k,f,a){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function c(a,c,e){var d=b.call(this)||this;return d.view=a,d.pickingHelper=c,d.pivot=e,d.lastPoint=g.vec2d.create(),d.tmpWorldUp=g.vec3d.create(),d.tmpViewDir=g.vec3d.create(),d.tmpRotCurPoint=g.vec2d.create(),d.tmpTransf=g.mat4d.create(),d.tmpAxis=g.vec3d.create(),d.pivotPos=g.vec3d.create(),d.constraintOptions={selection:15,interactionType:2,interactionFactor:0,interactionStartCamera:null,interactionDirection:null},
d.rotScale="center"===e?3:1.5,d}return h(c,b),c.prototype.begin=function(a){if(this.active){switch(this.pivot){case "eye":g.vec3d.set(this.beginCamera.eye,this.pivotPos);this.constraintOptions.interactionType=3;this.constraintOptions.selection=0;break;case "center":this.pickingHelper.pickRaySegment(this.beginCamera.eye,this.beginCamera.center,this.pivotPos)||(this.view.state.isLocal?this.pickingHelper.pickFreePointFromSegment(this.beginCamera.eye,this.beginCamera.center,this.pivotPos):g.vec3d.set(this.beginCamera.center,
this.pivotPos)),this.beginCamera.center=this.pivotPos,this.constraintOptions.interactionType=2,this.constraintOptions.selection=11}this.constraintOptions.interactionStartCamera=this.beginCamera;f.normalizeCoordinate(this.beginCamera,a,this.lastPoint)}},c.prototype.update=function(a){if(this.active){var b;switch(this.pivot){case "eye":b=this.currentCamera.center;break;case "center":this.currentCamera.center=this.pivotPos,b=this.currentCamera.eye}this.applyRotation(this.currentCamera,a,b,this.pivotPos);
d.applyAll(this.view,this.currentCamera,this.constraintOptions)}},c.prototype.end=function(){this.active&&this.finishController()},c.prototype.applyRotation=function(b,c,e,d){this.view.renderCoordsHelper.worldUpAtPosition(d,this.tmpWorldUp);f.normalizeCoordinate(b,c,this.tmpRotCurPoint);c=(this.tmpRotCurPoint[1]-this.lastPoint[1])*this.rotScale;var h=(this.tmpRotCurPoint[0]-this.lastPoint[0])*this.rotScale;g.vec3d.subtract(e,d,this.tmpViewDir);var l=g.vec3d.length(this.tmpViewDir),l=k.acos(g.vec3d.dot(this.tmpViewDir,
this.tmpWorldUp)/l);if("eye"===this.pivot){var q=.5*Math.PI-l,n=.495*Math.PI;c=q-Math.max(-n,Math.min(n,q+-.5*c))}c=Math.max(a.TiltDefault.min,c+l)-l;g.mat4d.identity(this.tmpTransf);g.vec3d.cross(b.up,this.tmpViewDir,this.tmpAxis);"center"===this.pivot&&(h=-h);g.mat4d.rotate(this.tmpTransf,h,this.tmpWorldUp);g.mat4d.rotate(this.tmpTransf,c,this.tmpAxis);g.mat4d.multiplyVec3(this.tmpTransf,this.tmpViewDir);g.vec3d.add(d,this.tmpViewDir,e);g.mat4d.multiplyVec3(this.tmpTransf,b.up);g.vec2d.set(this.tmpRotCurPoint,
this.lastPoint);b.markViewDirty()},c}(b.InteractiveController);l.RotateController=m})},"esri/views/3d/state/controllers/InteractiveController":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","./CameraController","../../webgl-engine/lib/Camera"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(d){function g(){var f=null!==d&&d.apply(this,arguments)||this;return f.beginCamera=new b,f.currentCamera=new b,f}return h(g,d),Object.defineProperty(g.prototype,
"isInteractive",{get:function(){return!0},enumerable:!0,configurable:!0}),g.prototype.stepController=function(b,a){d.prototype.stepController.call(this,b,a);a.copyViewFrom(this.currentCamera);this.currentCamera.copyFrom(a)},g.prototype.onControllerStart=function(b){d.prototype.onControllerStart.call(this,b);this.beginCamera.copyFrom(b);this.currentCamera.copyFrom(b)},g.prototype.onControllerEnd=function(b){b.copyViewFrom(this.currentCamera);d.prototype.onControllerEnd.call(this,b)},g}(d.CameraController);
l.InteractiveController=m})},"esri/views/3d/input/handlers/DragZoom":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/InputHandler ../../../input/handlers/support ../../state/helpers/PickingHelper ../../state/controllers/global/ZoomController ../../state/controllers/local/ZoomController".split(" "),function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});m=function(a){function e(b,e,d){var c=a.call(this,!0)||this;return c.view=b,c.pointerType=
e,c.pickingHelper=new g.PickingHelper(b),c.registerIncoming("drag",d,function(a){return c.handleDrag(a)}),c}return h(e,a),e.prototype.handleDrag=function(a){var c=a.data;if(!(1<c.pointers.length)){var e=c.pointers[0];if(b.eventMatchesMousePointerType(e.startEvent["native"],this.pointerType)){e=[e.currentEvent.x,this.view.height-e.currentEvent.y];switch(c.action){case "start":this.view.state.isGlobal?this.cameraController=new k.ZoomController(this.view,this.pickingHelper):this.cameraController=new f.ZoomController(this.view,
this.pickingHelper);this.view.state.switchCameraController(this.cameraController);this.cameraController.begin(e);break;case "update":this.cameraController.update(e);break;case "end":this.cameraController.end(),this.cameraController=null}a.stopPropagation()}}},e}(d.InputHandler);l.DragZoom=m})},"esri/views/3d/state/controllers/global/ZoomController":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../camera/constraintUtils ../InteractiveController ../../utils/navigationUtils ../../../lib/glMatrix".split(" "),
function(m,l,h,d,b,g,k){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function a(a,c){var e=b.call(this)||this;return e.view=a,e.pickingHelper=c,e.pickPoint=k.vec3d.create(),e.tmpP0=k.vec3d.create(),e.panAxis=k.vec3d.create(),e.tmpRayDir=k.vec3d.create(),e.targetOnSphere=k.vec3d.create(),e.dragBeginPoint=k.vec2d.create(),e.normalizedAnchorPoint=k.vec2d.create(),e.constraintOptions={selection:7,interactionType:1,interactionFactor:0,interactionStartCamera:null,interactionDirection:null},
e.sphere={center:k.vec3d.create(),radius:0},e.hasPickPoint=!1,e}return h(a,b),a.prototype.begin=function(a){this.active&&(k.vec2d.set(a,this.dragBeginPoint),g.normalizeCoordinate(this.beginCamera,a,this.normalizedAnchorPoint),a=g.pickPointAndInitSphere(this.pickingHelper,this.beginCamera,a,!1),this.hasPickPoint=!!a.scenePickPoint,this.pickPoint=a.scenePickPoint,this.sphere=a.sphere,this.constraintOptions.interactionStartCamera=this.beginCamera)},a.prototype.update=function(a){if(this.active){this.currentCamera.eye=
this.beginCamera.eye;this.currentCamera.center=this.beginCamera.center;this.currentCamera.up=this.beginCamera.up;k.vec3d.subtract(this.currentCamera.center,this.currentCamera.eye,this.tmpRayDir);var b=k.vec3d.length(this.tmpRayDir);g.normalizeCoordinate(this.currentCamera,a,this.tmpP0);var e=12*(this.tmpP0[1]-this.normalizedAnchorPoint[1]),f=b*Math.pow(2,e),h=this.view.state.constraints.minimumPoiDistance;if(0>e&&h>f&&(f=h),!(1E-6>Math.abs(b-f))){this.hasPickPoint&&b>f&&(e=1-(1-f/b)*(1-this.sphere.radius/
k.vec3d.length(this.currentCamera.center)),k.vec3d.scale(this.currentCamera.center,e));if(k.vec3d.scale(this.tmpRayDir,-f/b),k.vec3d.add(this.currentCamera.center,this.tmpRayDir,this.currentCamera.eye),this.constraintOptions.interactionFactor=d.pixelDistanceToInteractionFactor(this.dragBeginPoint,a),d.applyAll(this.view,this.currentCamera,this.constraintOptions),this.hasPickPoint)g.sphereOrSilhouettePointFromScreenPoint(this.sphere,this.currentCamera,this.dragBeginPoint,this.targetOnSphere,!0),a=
g.rotationAndAxisFromPoints(this.pickPoint,this.targetOnSphere,this.panAxis),g.applyRotation(this.currentCamera,this.sphere.center,this.panAxis,a);d.applySurfaceCollision(this.view,this.currentCamera)}}},a.prototype.end=function(){this.active&&this.finishController()},a}(b.InteractiveController);l.ZoomController=m})},"esri/views/3d/state/controllers/local/ZoomController":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../camera/constraintUtils ../InteractiveController ../../../lib/glMatrix ../../../support/mathUtils ../../utils/navigationUtils".split(" "),
function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});m=function(a){function b(b,e){var c=a.call(this)||this;return c.view=b,c.pickingHelper=e,c.tmpP=g.vec3d.create(),c.tmpN=g.vec3d.create(),c.tmpP0=g.vec3d.create(),c.tmpPoi=g.vec3d.create(),c.tmpRayDir=g.vec3d.create(),c.dragBeginPoint=g.vec2d.create(),c.normalizedAnchorPoint=g.vec2d.create(),c.constraintOptions={selection:15,interactionType:1,interactionFactor:0,interactionStartCamera:null,interactionDirection:g.vec3d.create()},
c.plane={normal:g.vec3d.create(),d:0},c}return h(b,a),b.prototype.begin=function(a){this.active&&(g.vec2d.set(a,this.dragBeginPoint),f.normalizeCoordinate(this.beginCamera,a,this.normalizedAnchorPoint),this.pickingHelper.pickPointInScreen(a,this.tmpP)||this.pickingHelper.pickFreePointInScreen(a,this.tmpP),g.vec3d.normalize(g.vec3d.subtract(this.beginCamera.eye,this.beginCamera.center,this.tmpN)),0>this.tmpN[1]&&g.vec3d.negate(this.tmpN),f.setPlane(this.tmpP,this.tmpN,this.plane),this.constraintOptions.interactionStartCamera=
this.beginCamera)},b.prototype.update=function(a){if(this.active){f.intersectPlaneFromScreenPoint(this.plane,this.currentCamera,this.dragBeginPoint,this.tmpPoi)||g.vec3d.set(this.currentCamera.center,this.tmpPoi);f.normalizeCoordinate(this.currentCamera,a,this.tmpP0);var b=4*(this.normalizedAnchorPoint[1]-this.tmpP0[1]);g.vec2d.set(this.tmpP0,this.normalizedAnchorPoint);g.vec3d.subtract(this.tmpPoi,this.currentCamera.eye,this.tmpRayDir);var c=g.vec3d.length(this.tmpRayDir),e=c*(1-b);g.vec3d.set(this.tmpRayDir,
this.constraintOptions.interactionDirection);g.vec3d.scale(this.constraintOptions.interactionDirection,k.sign(b)/c);var h=this.view.state.constraints.minimumPoiDistance;0<=b&&h>e&&(e=h,b=-(e-c)/c);1E-6>Math.abs(c-e)||(g.vec3d.scale(this.tmpRayDir,b),g.vec3d.add(this.currentCamera.eye,this.tmpRayDir),g.vec3d.lerp(this.currentCamera.center,this.tmpPoi,b),this.tmpPoi[2]>this.beginCamera.center[2]?this.currentCamera.center[2]=Math.max(this.beginCamera.center[2],this.currentCamera.center[2]):this.currentCamera.center[2]=
Math.min(this.beginCamera.center[2],this.currentCamera.center[2]),this.currentCamera.markViewDirty(),this.constraintOptions.interactionFactor=d.pixelDistanceToInteractionFactor(this.dragBeginPoint,a),d.applyAll(this.view,this.currentCamera,this.constraintOptions))}},b.prototype.end=function(){this.active&&this.finishController()},b}(b.InteractiveController);l.ZoomController=m})},"esri/views/3d/input/handlers/KeyPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper",
"../../../input/InputHandler","../../state/controllers/global/PanContinuousController"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(d){function g(f,a,e){var c=d.call(this,!0)||this;return c.view=f,c.keyToDirection=(g={},g[a.left]=b.Direction.LEFT,g[a.right]=b.Direction.RIGHT,g[a.forward]=b.Direction.FORWARD,g[a.backward]=b.Direction.BACKWARD,g[a.up]=b.Direction.UP,g[a.down]=b.Direction.DOWN,g),f.state.isGlobal&&(c.registerIncoming("key-down",e,function(a){return c.handleKeyDown(a)}),
c.registerIncoming("key-up",e,function(a){return c.handleKeyUp(a)})),c;var g}return h(g,d),g.prototype.handleKeyDown=function(d){if(!d.data.repeat){var a=this.keyToDirection[d.data.key];null!=a&&(this.cameraController&&this.cameraController.active||(this.cameraController=new b.PanContinuousController(this.view),this.view.state.switchCameraController(this.cameraController)),this.cameraController.active&&this.handleKey(d,a,!0))}},g.prototype.handleKeyUp=function(b){var a=this.keyToDirection[b.data.key];
null!=a&&this.cameraController&&this.cameraController.active&&this.handleKey(b,a,!1)},g.prototype.handleKey=function(b,a,e){e?this.cameraController.addDirection(a):this.cameraController.removeDirection(a);b.stopPropagation()},g}(d.InputHandler);l.KeyPan=m})},"esri/views/3d/state/controllers/global/PanContinuousController":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../camera/constraintUtils ../CameraController ../../../support/earthUtils ../../../support/mathUtils ../../../lib/glMatrix".split(" "),
function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});l.Direction={LEFT:1,RIGHT:2,FORWARD:4,BACKWARD:8,UP:16,DOWN:32};var a=f.vec3d,e=f.mat4d;m=function(b){function c(c){var d=b.call(this)||this;return d.view=c,d.directionStatus=0,d.direction=a.create(),d.tmpAxis=a.create(),d.radiusChange=0,d.velocity=0,d.tmpP1=a.create(),d.tmpTransf=e.create(),d}return h(c,b),Object.defineProperty(c.prototype,"isInteractive",{get:function(){return!0},enumerable:!0,configurable:!0}),c.prototype.addDirection=
function(b){(0===this.directionStatus&&a.set3(0,0,0,this.direction),this.directionStatus&b)||((this.directionStatus|=b,b&(l.Direction.LEFT|l.Direction.RIGHT|l.Direction.FORWARD|l.Direction.BACKWARD))?(this.computePanAxis(b,this.tmpAxis),a.add(this.direction,this.tmpAxis)):(b=this.directionStatus&(l.Direction.UP|l.Direction.DOWN),this.radiusChange=b===l.Direction.UP?1:b===l.Direction.DOWN?-1:0),this.velocity=this.computePanVelocity())},c.prototype.removeDirection=function(b){(this.directionStatus&=
~b,0===this.directionStatus&&this.active)?this.finishController():b&(l.Direction.LEFT|l.Direction.RIGHT|l.Direction.FORWARD|l.Direction.BACKWARD)?(this.computePanAxis(b,this.tmpAxis),a.subtract(this.direction,this.tmpAxis),.01>a.length(this.direction)&&a.set3(0,0,0,this.direction)):(b=this.directionStatus&(l.Direction.UP|l.Direction.DOWN),this.radiusChange=b===l.Direction.UP?1:b===l.Direction.DOWN?-1:0)},c.prototype.stepController=function(c,f){b.prototype.stepController.call(this,c,f);c*=this.velocity;
var g=!1;if(0<Math.abs(this.radiusChange)){var g=1+c*this.radiusChange,k=f.viewForward,h=a.normalize(f.center,this.tmpP1);(-.999<a.dot(k,h)||0>this.radiusChange)&&a.scale(f.center,g);a.scale(f.eye,g);this.velocity=this.computePanVelocity();g=!0}.01<a.length2(this.direction)&&(e.identity(this.tmpTransf),e.rotate(this.tmpTransf,c,this.direction),e.multiplyVec3(this.tmpTransf,f.eye),e.multiplyVec3(this.tmpTransf,f.center),e.multiplyVec3(this.tmpTransf,f.up),g=!0);g&&d.applyAll(this.view,f,{selection:14,
interactionType:4,interactionStartCamera:this.view.state.camera,interactionFactor:null,interactionDirection:null})},c.prototype.computePanAxis=function(b,c){var e=this.view.state.camera;a.subtract(e.center,e.eye,c);a.cross(c,e.up);b!==l.Direction.LEFT&&b!==l.Direction.RIGHT||(a.normalize(c),a.cross(c,e.center));b!==l.Direction.RIGHT&&b!==l.Direction.FORWARD||a.negate(c);a.normalize(c)},c.prototype.computePanVelocity=function(){var b=.5*Math.abs(a.length(this.view.state.camera.eye)-g.earthRadius);
return b=k.clamp(b,1,2*g.earthRadius),k.acos(1-b*b/(2*g.earthRadius*g.earthRadius))},c}(b.CameraController);l.PanContinuousController=m})},"esri/views/3d/input/handlers/MouseWheelZoom":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/InputHandler ../../state/helpers/PickingHelper ../../state/controllers/global/ZoomStepController ../../state/controllers/local/ZoomStepController".split(" "),function(m,l,h,d,b,g,k){Object.defineProperty(l,"__esModule",{value:!0});
m=function(d){function a(a,c){var e=d.call(this,!0)||this;return e.view=a,e.pickingHelper=new b.PickingHelper(a),e.registerIncoming("mouse-wheel",c,function(a){return e.handleMouseWheel(a)}),e}return h(a,d),a.prototype.handleMouseWheel=function(a){var b=a.data;this.cameraController&&this.cameraController.active||(this.cameraController=this.view.state.isGlobal?new g.ZoomStepController(this.view,this.pickingHelper,"interaction"):new k.ZoomStepController(this.view,this.pickingHelper,"interaction"),this.view.state.switchCameraController(this.cameraController));
this.cameraController.zoomStep(-1/60*b.deltaY,[b.x,this.view.height-b.y]);a.stopPropagation()},a}(d.InputHandler);l.MouseWheelZoom=m})},"esri/views/3d/input/handlers/SingleKeyResetHeading":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","./SingleKey"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d,f,a){a=b.call(this,"esri.views.3d.input.handlers.SingleKeyResetHeading",f,a)||this;return a.view=d,a.key=f,a}return h(d,b),
d.prototype.activate=function(){this.view.goTo({heading:0})},d}(d.SingleKey);l.SingleKeyResetHeading=m})},"esri/views/3d/input/handlers/SingleKey":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d,f,a){var e=b.call(this,!0)||this;return e.key=f,e.registerIncoming("key-down",a,function(a){return e._handleKeyDown(a)}),e}return h(d,b),d.prototype._handleKeyDown=
function(b){b.data.key===this.key&&(this.activate(),b.stopPropagation())},d}(d.InputHandler);l.SingleKey=m})},"esri/views/3d/input/handlers/SingleKeyResetTilt":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","./SingleKey"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d,f,a){a=b.call(this,"esri.views.3d.input.handlers.SingleKeyResetTilt",f,a)||this;return a.view=d,a.key=f,a}return h(d,b),d.prototype.activate=function(){this.view.goTo({tilt:0})},
d}(d.SingleKey);l.SingleKeyResetTilt=m})},"esri/views/3d/input/handlers/PointerDownCancelAnimation":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d,f){var a=b.call(this,!0)||this;return a.view=d,a.registerIncoming("pointer-down",f,function(b){return a.view.state.stopActiveCameraController()}),a}return h(d,b),d}(d.InputHandler);l.PointerDownCancelAnimation=
m})},"esri/views/3d/input/handlers/TwoFingerTilt":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/InputHandler ../../state/helpers/PickingHelper ../../state/controllers/RotateController".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(d){function f(a,e){void 0===e&&(e=!1);var c=d.call(this,!0)||this;return c.view=a,c.invert=e,c.pickingHelper=new b.PickingHelper(a),c.registerIncoming("vertical-two-finger-drag",
function(a){return c.handleTwoFinger(a)}),c}return h(f,d),f.prototype.handleTwoFinger=function(a){var b=[0,-a.data.delta*(this.invert?-1:1)];switch(a.data.action){case "begin":this.cameraController=new g.RotateController(this.view,this.pickingHelper,"center");this.view.state.switchCameraController(this.cameraController);this.cameraController.begin(b);break;case "update":this.cameraController.update(b);break;case "end":this.cameraController.end(),this.cameraController=null}},f}(d.InputHandler);l.TwoFingerTilt=
m})},"esri/views/3d/input/handlers/PinchAndPanNavigation":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/InputHandler ../../../input/handlers/support ../../state/helpers/PickingHelper ../../state/controllers/global/PinchAndPanController ../../state/controllers/local/PinchAndPanController".split(" "),function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});m=function(a){function e(b,e,d){var c=a.call(this,!0)||this;return c.view=b,c.pointerType=
e,c.lastEndTimestamp=0,c.pickingHelper=new g.PickingHelper(b),c.registerIncoming("drag",d,function(a){return c.handleDrag(a)}),c}return h(e,a),e.prototype.handleDrag=function(a){var c=a.data.pointers[0].startEvent["native"];if("mouse"!==c.pointerType||b.eventMatchesMousePointerType(c,this.pointerType)){c=a.timestamp-this.lastEndTimestamp;c=this.momentum&&this.momentum.active&&40>c;switch(a.data.action){case "start":case "update":if(c)break;this.controller&&this.controller.active?.002>(a.data.currentState.timestamp-
a.data.previousState.timestamp)/1E3||this.controller.update(a.data.pointers,a.data.currentState,a.timestamp):(this.view.state.isGlobal?this.controller=new k.PinchAndPanController(this.view,this.pickingHelper):this.controller=new f.PinchAndPanController(this.view,this.pickingHelper),this.view.state.switchCameraController(this.controller),this.controller.begin(a.data.pointers,a.data.currentState,a.timestamp));break;case "end":this.controller&&this.controller.active&&(this.lastEndTimestamp=a.timestamp,
this.momentum=this.controller.end(),this.momentum&&this.view.state.switchCameraController(this.momentum),this.controller=null)}a.stopPropagation()}},e}(d.InputHandler);l.PinchAndPanNavigation=m})},"esri/views/3d/state/controllers/global/PinchAndPanController":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../lib/glMatrix ../../../input/util ../../../webgl-engine/lib/Camera ../InteractiveController ./MomentumController ../../utils/navigationUtils ../../utils/navigationUtils ../../../camera/constraintUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){Object.defineProperty(l,"__esModule",{value:!0});m=function(k){function l(a,c){var h=k.call(this)||this;return h.view=a,h.pickingHelper=c,h.smoothRotation=new b.ExponentialFalloff(.05),h.rotationAxis=d.vec3d.create(),h.panningCenterScene=d.vec3d.create(),h.panningPlane={normal:d.vec3d.create(),d:0},h.smoothScaling=new b.ExponentialFalloff(.05),h.zoomCenterScreen=d.vec2d.create(),h.beginScenePoints={points:[],center:d.vec3d.create()},h.adjustedSphere={center:d.vec3d.create(),
radius:0},h.panMode=e.PanMode.Horizontal,h.tmp2d=d.vec2d.create(),h.tmp3d=d.vec3d.create(),h.tmpInteractionDirection=d.vec3d.create(),h.beginScreenPoint=d.vec2d.create(),h.screenPickPoint=d.vec2d.create(),h.currentPoints=[],h.currentCenter=d.vec3d.create(),h.constraintOptions={selection:15,interactionType:0,interactionFactor:0,interactionStartCamera:new g,interactionDirection:null},h.momentumController=new f.MomentumController(a),h}return h(l,k),l.prototype.begin=function(b,c,f){if(this.active){this.beginRadius=
c.radius;a.navPointToScreenPoint(this.currentCamera,c.center,this.screenPickPoint);d.vec2d.set(this.screenPickPoint,this.beginScreenPoint);f=a.pickPointAndInitSphere(this.pickingHelper,this.beginCamera,this.screenPickPoint,!0);if(this.scenePickPoint=f.scenePickPoint,this.sphere=f.sphere,this.panMode=a.decidePanMode(this.beginCamera,this.sphere,this.scenePickPoint),this.panMode===e.PanMode.Horizontal)this.computeSpherePoints(b,"startEvent",this.sphere,this.beginCamera,this.beginScenePoints.points),
a.centroidOnSphere(this.sphere.radius,this.beginScenePoints.points,this.beginScenePoints.center);else{d.vec3d.set(this.beginCamera.viewForward,this.panningPlane.normal);d.vec3d.normalize(this.panningPlane.normal);d.vec3d.negate(this.panningPlane.normal);a.setPlane(this.scenePickPoint,this.panningPlane.normal,this.panningPlane);b=d.vec3d.create();d.vec3d.set3(this.screenPickPoint[0],this.currentCamera.height,0,b);f=d.vec3d.create();var g=d.vec3d.length(this.beginCamera.eye);this.adjustedSphere.radius=
g<this.sphere.radius?g-100:this.sphere.radius;a.sphereOrSilhouettePointFromScreenPoint(this.adjustedSphere,this.beginCamera,b,f);this.beginCamera.projectPoint(f,b);this.screenPickPoint[1]=Math.min(this.screenPickPoint[1],.9*b[1]);this.pickingHelper.pickPointInScreen(this.screenPickPoint,this.scenePickPoint)&&a.setPlane(this.scenePickPoint,this.panningPlane.normal,this.panningPlane);a.navPointToScreenPoint(this.currentCamera,c.center,this.tmp2d);a.intersectPlaneFromScreenPoint(this.panningPlane,this.beginCamera,
this.tmp2d,this.panningCenterScene)}this.constraintOptions.interactionStartCamera.copyFrom(this.beginCamera)}},l.prototype.update=function(a,b,c){if(this.active){this.currentCamera.copyFrom(this.beginCamera);var d=1<a.length;this.panMode===e.PanMode.Horizontal?(d&&this.zoomSpherical(b,c),this.panningSpherical(a,b,c),d&&this.rotateSpherical(a,b,c)):(d&&this.zoomPlanar(a,b,c),this.panningPlanar(a,b,c),d&&this.rotatePlanar(a,b,c));this.currentCamera.markViewDirty()}},l.prototype.end=function(){return this.panMode===
e.PanMode.Horizontal?this.momentumController.setParameters(this.sphere.radius,this.panMode,this.zoomCenterScreen,this.beginScenePoints.center):this.momentumController.setParameters(this.sphere.radius,this.panMode,this.zoomCenterScreen,this.panningCenterScene),this.finishController(),this.momentumController.initiate()?this.momentumController:null},l.prototype.computeSpherePoints=function(b,c,e,f,g){g.length=b.length;for(var k=this.tmp2d,h=0;h<g.length;h++)a.navPointToScreenPoint(f,b[h][c],k),void 0===
g[h]&&(g[h]=d.vec3d.create()),a.sphereOrSilhouettePointFromScreenPoint(e,f,k,g[h]);return g},l.prototype.zoomSpherical=function(b,e){var f=this.currentCamera.height,g=this.beginRadius/b.radius;this.smoothScaling.gain=.001875*Math.min(Math.max(b.radius,40),120);this.smoothScaling.update(g);a.applyZoomOnSphere(this.sphere,this.currentCamera,this.smoothScaling.value);d.vec2d.set2(b.center.x,f-b.center.y,this.zoomCenterScreen);this.momentumController.addScaleValue(e,this.smoothScaling.value);this.constraintOptions.interactionType=
1;this.constraintOptions.interactionFactor=c.pixelDistanceToInteractionFactor(b.radius-this.beginRadius);c.applyAll(this.view,this.currentCamera,this.constraintOptions)},l.prototype.panningSpherical=function(b,e,d){this.currentPoints;this.computeSpherePoints(b,"currentEvent",this.sphere,this.currentCamera,this.currentPoints);a.centroidOnSphere(this.sphere.radius,this.currentPoints,this.currentCenter);a.navPointToScreenPoint(this.currentCamera,e.center,this.tmp2d);a.applyPanSpherical(this.sphere,this.currentCamera,
this.beginScenePoints.center,this.currentCenter,{estimator:this.momentumController,time:d,endScreenPoint:this.tmp2d});this.constraintOptions.interactionType=4;this.constraintOptions.interactionFactor=c.pixelDistanceToInteractionFactor(this.screenPickPoint,this.tmp2d);c.applyAll(this.view,this.currentCamera,this.constraintOptions)},l.prototype.rotateSpherical=function(b,e,f){var g=b.length;d.vec3d.normalize(this.beginScenePoints.center,this.rotationAxis);this.computeSpherePoints(b,"currentEvent",this.sphere,
this.currentCamera,this.currentPoints);for(var k=b=0;g>k;k++)b+=a.rotationFromPointsAroundAxis(this.currentPoints[k],this.beginScenePoints.points[k],this.rotationAxis);k=this.smoothRotation.value;g=a.normalizeRotationDelta(b/g-k);b=k+g;this.smoothRotation.gain=.00125*Math.min(Math.max(e.radius,40),120);this.smoothRotation.update(b);g=this.smoothRotation.value;this.momentumController.addRotationValue(f,g);a.applyRotation(this.currentCamera,this.sphere.center,this.rotationAxis,g);this.constraintOptions.interactionType=
2;this.constraintOptions.interactionFactor=c.pixelDistanceToInteractionFactor(e.radius*b);c.applyAll(this.view,this.currentCamera,this.constraintOptions)},l.prototype.panningPlanar=function(b,e,d){a.navPointToScreenPoint(this.currentCamera,e.center,this.tmp2d);a.intersectPlaneFromScreenPoint(this.panningPlane,this.currentCamera,this.tmp2d,this.tmp3d)&&(a.applyPanPlanar(this.currentCamera,this.panningCenterScene,this.tmp3d,{estimator:this.momentumController,time:d,endScreenPoint:this.tmp2d}),this.constraintOptions.interactionType=
4,this.constraintOptions.interactionFactor=c.pixelDistanceToInteractionFactor(this.beginScreenPoint,this.tmp2d),this.constraintOptions.interactionDirection=this.view.renderCoordsHelper.worldUpAtPosition(this.currentCamera.eye,this.tmpInteractionDirection),c.applyAll(this.view,this.currentCamera,this.constraintOptions),this.constraintOptions.interactionDirection=null)},l.prototype.zoomPlanar=function(b,e,d){b=this.beginRadius/e.radius;this.smoothScaling.gain=.001875*Math.min(Math.max(e.radius,40),
120);this.smoothScaling.update(b);this.momentumController.addScaleValue(d,this.smoothScaling.value);this.momentumController.setParametersVertical(this.panningCenterScene);a.applyZoomToPoint(this.currentCamera,this.panningCenterScene,this.smoothScaling.value,this.view.state.constraints.minimumPoiDistance);this.constraintOptions.interactionType=1;this.constraintOptions.interactionFactor=c.pixelDistanceToInteractionFactor(e.radius-this.beginRadius);c.applyAll(this.view,this.currentCamera,this.constraintOptions)},
l.prototype.rotatePlanar=function(b,e,f){d.vec3d.set(this.panningCenterScene,this.rotationAxis);var g=e.angle;b=this.smoothRotation.value;g=a.normalizeRotationDelta(g-b);g=b+g;this.smoothRotation.gain=.00125*Math.min(Math.max(e.radius,40),120);this.smoothRotation.update(g);b=this.smoothRotation.value;this.momentumController.addRotationValue(f,b);a.applyRotation(this.currentCamera,this.sphere.center,this.rotationAxis,b);this.constraintOptions.interactionType=2;this.constraintOptions.interactionFactor=
c.pixelDistanceToInteractionFactor(e.radius*b);c.applyAll(this.view,this.currentCamera,this.constraintOptions)},l}(k.InteractiveController);l.PinchAndPanController=m})},"esri/views/3d/input/util":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function h(d){this._gain=d}return h.prototype.reset=function(d){this._value=d},Object.defineProperty(h.prototype,"gain",{set:function(d){this._gain=d},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,
"value",{get:function(){return void 0===this._value?0:this._value},enumerable:!0,configurable:!0}),h.prototype.update=function(d){void 0===this._value?this._value=d:this._value=this._gain*d+(1-this._gain)*this._value},h}();l.ExponentialFalloff=m})},"esri/views/3d/state/controllers/global/MomentumController":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../AnimationController ../../../webgl-engine/lib/Camera ../../../lib/glMatrix ../../utils/navigationUtils ../../../../navigation/Momentum ../../utils/navigationUtils ../../../camera/constraintUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e){Object.defineProperty(l,"__esModule",{value:!0});var c=g.vec3d.create();m=function(d){function l(a){var c=d.call(this)||this;return c.view=a,c.zoom={momentum:null,estimator:new f.ZoomMomentumEstimator(.05),enabled:!0},c.rotation={momentum:null,estimator:new f.RotationMomentumEstimator(.05,3,.05,.95),enabled:!0},c.pan={momentum:null,estimator:new f.ScreenspaceMomentumEstimator(.05,500,12,.82),enabled:!0},c.elapsedTimeSec=0,c._panAxisOrDirection=g.vec3d.create(),c._centerOnScreen=
g.vec2d.create(),c._centerOnSphere=g.vec3d.create(),c._tmpSphereCenter=g.vec3d.create(),c._tmpScaleAxis=g.vec3d.create(),c.sphere={center:g.vec3d.create(),radius:0},c.tmpInteractionDirection=g.vec3d.create(),c._verticalCenter=g.vec3d.create(),c.beginCamera=new b,c.constraintOptions={selection:15,interactionType:0,interactionFactor:0,interactionStartCamera:new b,interactionDirection:null},c}return h(l,d),l.prototype.setParameters=function(a,b,c,e){this.sphere.radius=a;c&&e?(g.vec2d.set(c,this._centerOnScreen),
g.vec3d.set(e,this._centerOnSphere)):(this.zoom.enabled=!1,this.rotation.enabled=!1);this._mode=b},l.prototype.setParametersVertical=function(a){g.vec3d.set(a,this._verticalCenter)},l.prototype.addPanValue=function(a,b,c,e){this.pan.estimator.add(b[0],b[1],c,.001*a);g.vec3d.set(e,this._panAxisOrDirection)},l.prototype.addRotationValue=function(a,b){this.rotation.estimator.add(b,.001*a)},l.prototype.addScaleValue=function(a,b){this.zoom.estimator.add(b,.001*a)},l.prototype.initiate=function(){return this.zoom.enabled&&
(this.zoom.momentum=this.zoom.estimator.evaluateMomentum()),!this.zoom.momentum&&this.rotation.enabled&&(this.rotation.momentum=this.rotation.estimator.evaluateMomentum()),this.zoom.momentum||this.rotation.momentum||!this.pan.enabled||(this.pan.momentum=this.pan.estimator.evaluateMomentum()),null!=(this.zoom.momentum||this.rotation.momentum||this.pan.momentum)},l.prototype.onControllerStart=function(a){this.beginCamera.copyFrom(a);this.constraintOptions.interactionStartCamera.copyFrom(this.beginCamera);
d.prototype.onControllerStart.call(this,a)},Object.defineProperty(l.prototype,"steppingFinished",{get:function(){return this.momentumFinished()},enumerable:!0,configurable:!0}),l.prototype.stepController=function(b,d){d.copyViewFrom(this.beginCamera);this.elapsedTimeSec+=b;var f=this._centerOnScreen;b=this._centerOnSphere;if(this.zoom.momentum){var h=this.zoom.momentum.valueDelta(0,this.elapsedTimeSec);this._mode===a.PanMode.Horizontal?(k.applyZoomOnSphere(this.sphere,d,h),this.constraintOptions.selection=
15,this.constraintOptions.interactionType=1,this.constraintOptions.interactionDirection=null,e.applyAll(this.view,d,this.constraintOptions),k.sphereOrSilhouettePointFromScreenPoint(this.sphere,d,f,this._tmpSphereCenter),f=k.rotationAndAxisFromPoints(b,this._tmpSphereCenter,this._tmpScaleAxis),k.applyRotation(d,this.sphere.center,this._tmpScaleAxis,f),this.constraintOptions.interactionType=4):(g.vec3d.set(d.eye,this.tmpInteractionDirection),k.applyZoomToPoint(d,this._verticalCenter,h,this.view.state.constraints.minimumPoiDistance),
this.constraintOptions.interactionType=1,this.constraintOptions.interactionDirection=g.vec3d.direction(this.tmpInteractionDirection,d.eye));e.applyAll(this.view,d,this.constraintOptions)}this.pan.momentum&&(this._mode===a.PanMode.Horizontal?(f=k.rotationAndAxisFromPoints(this.pan.momentum.dataOldest,this.pan.momentum.dataNewest,this._panAxisOrDirection)/this.pan.momentum.dataTimeDelta,f=this.pan.momentum.valueFromInitialVelocity(f,this.elapsedTimeSec),k.applyRotation(d,this.sphere.center,this._panAxisOrDirection,
f)):(f=g.vec3d.dist(this.pan.momentum.dataOldest,this.pan.momentum.dataNewest),f/=this.pan.momentum.dataTimeDelta,f=this.pan.momentum.valueFromInitialVelocity(f,this.elapsedTimeSec),g.vec3d.normalize(this._panAxisOrDirection),g.vec3d.scale(this._panAxisOrDirection,f),g.vec3d.subtract(d.eye,this._panAxisOrDirection),g.vec3d.subtract(d.center,this._panAxisOrDirection),d.markViewDirty(),this.constraintOptions.interactionDirection=this._panAxisOrDirection),this.constraintOptions.interactionType=4,e.applyAll(this.view,
d,this.constraintOptions),this.constraintOptions.interactionDirection=null);this.rotation.momentum&&(f=this.rotation.momentum.valueDelta(0,this.elapsedTimeSec),k.applyRotation(d,c,b,f),this.constraintOptions.interactionType=2,this.constraintOptions.interactionDirection=null,e.applyAll(this.view,d,this.constraintOptions))},l.prototype.momentumFinished=function(){return this.zoom.momentum&&this.zoom.momentum.isFinished(this.elapsedTimeSec)&&(this.zoom.momentum=null),this.rotation.momentum&&this.rotation.momentum.isFinished(this.elapsedTimeSec)&&
(this.rotation.momentum=null),this.pan.momentum&&this.pan.momentum.isFinished(this.elapsedTimeSec)&&(this.pan.momentum=null),!this.zoom.momentum&&!this.rotation.momentum&&!this.pan.momentum},l}(d.AnimationController);l.MomentumController=m})},"esri/views/3d/state/controllers/local/PinchAndPanController":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../lib/glMatrix ../../../input/util ../../../webgl-engine/lib/Camera ../InteractiveController ./MomentumController ../../utils/navigationUtils ../../../camera/constraintUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e){Object.defineProperty(l,"__esModule",{value:!0});var c;!function(a){a[a.Vertical=0]="Vertical";a[a.Horizontal=1]="Horizontal"}(c=l.PanMode||(l.PanMode={}));var q=d.vec3d.createFrom(0,0,1),t=16/180*Math.PI;m=function(k){function l(a,c){var e=k.call(this)||this;return e.view=a,e.pickingHelper=c,e.rotationValueSmooth=new b.ExponentialFalloff(.05),e.scalingValueSmooth=new b.ExponentialFalloff(.05),e.planeHorizontal={normal:d.vec3d.create(),d:0},e.planeVertical={normal:d.vec3d.create(),
d:0},e.beginCenterHorizontal=d.vec3d.create(),e.beginCenterVertical=d.vec3d.create(),e.tmpPoints=[],e.beginCenterScreen=d.vec2d.create(),e.tmpCentroid3d=d.vec3d.create(),e.tmpCentroid2d=d.vec2d.create(),e.tmp2d=d.vec2d.create(),e.constraintOptions={selection:15,interactionType:0,interactionFactor:0,interactionStartCamera:new g,interactionDirection:null},e.momentumController=new f.MomentumController(a),e}return h(l,k),l.prototype.begin=function(b,e,f){if(this.active){this.beginRadius=e.radius;this.rotationValueSmooth.reset();
this.scalingValueSmooth.reset();a.navPointToScreenPoint(this.beginCamera,e.center,this.beginCenterScreen);this.planeHorizontal.d=0;d.vec3d.set(q,this.planeHorizontal.normal);e=d.vec3d.create();this.pickingHelper.pickPointInScreen(this.beginCenterScreen,e)||this.pickingHelper.pickFreePointInScreen(this.beginCenterScreen,e);f=d.vec3d.create();d.vec3d.negate(this.beginCamera.viewForward,f);var g=d.vec3d.create();d.vec3d.set(q,g);var k=d.vec3d.dot(f,g);this.panMode=Math.asin(0>k?-k:k)>=t?c.Horizontal:
c.Vertical;a.setPlaneD(e,this.planeHorizontal);0>d.vec3d.dot(this.planeHorizontal.normal,this.beginCamera.eye)+this.planeHorizontal.d&&(d.vec3d.negate(this.planeHorizontal.normal),this.planeHorizontal.d*=-1);this.panMode===c.Vertical&&(d.vec3d.scale(g,k),d.vec3d.subtract(f,g,this.planeVertical.normal),d.vec3d.normalize(this.planeVertical.normal),a.setPlaneD(e,this.planeVertical),this.computePlanePoints(b,"currentEvent",this.planeVertical,this.beginCamera,this.tmpPoints),a.centroid(this.tmpPoints,
this.beginCenterVertical));this.computePlanePoints(b,"currentEvent",this.planeHorizontal,this.beginCamera,this.tmpPoints);a.centroid(this.tmpPoints,this.beginCenterHorizontal);this.constraintOptions.interactionStartCamera.copyFrom(this.beginCamera)}},l.prototype.update=function(b,f,g){if(this.active){this.currentCamera.copyFrom(this.beginCamera);var k=1<b.length,h=this.panMode===c.Horizontal?this.planeHorizontal:this.planeVertical,l=this.panMode===c.Horizontal?this.beginCenterHorizontal:this.beginCenterVertical;
if(k){var q=this.beginRadius/f.radius,r=.001875*Math.min(Math.max(f.radius,40),120);this.scalingValueSmooth.gain=r;this.scalingValueSmooth.update(q);a.applyZoomToPoint(this.currentCamera,l,this.scalingValueSmooth.value,this.view.state.constraints.minimumPoiDistance);this.momentumController.addScaleValue(g,this.scalingValueSmooth.value,l);this.constraintOptions.interactionType=1;this.constraintOptions.interactionFactor=e.pixelDistanceToInteractionFactor(Math.abs(f.radius-this.beginRadius));e.applyAll(this.view,
this.currentCamera,this.constraintOptions)}if(this.computePlanePoints(b,"currentEvent",h,this.currentCamera,this.tmpPoints),a.centroid(this.tmpPoints,this.tmpCentroid3d),a.navPointToScreenPoint(this.currentCamera,f.center,this.tmpCentroid2d),a.applyPanPlanar(this.currentCamera,l,this.tmpCentroid3d,{estimator:this.momentumController,time:g,endScreenPoint:this.tmpCentroid2d}),this.constraintOptions.interactionType=4,this.constraintOptions.interactionFactor=e.pixelDistanceToInteractionFactor(this.beginCenterScreen,
this.tmpCentroid2d),e.applyAll(this.view,this.currentCamera,this.constraintOptions),k)b=this.planeHorizontal.normal,d.vec3d.set(this.planeHorizontal.normal,b),k=f.angle,r=this.rotationValueSmooth.value,k=a.normalizeRotationDelta(k-r),k=r+k,r=.00125*Math.min(Math.max(f.radius,40),120),this.rotationValueSmooth.gain=r,this.rotationValueSmooth.update(k),r=this.rotationValueSmooth.value,this.momentumController.addRotationValue(g,l,b,r),a.applyRotation(this.currentCamera,l,b,r),this.constraintOptions.interactionType=
2,this.constraintOptions.interactionFactor=e.pixelDistanceToInteractionFactor(Math.abs(f.radius*r)),e.applyAll(this.view,this.currentCamera,this.constraintOptions);this.currentCamera.markViewDirty()}},l.prototype.end=function(){return this.finishController(),this.momentumController.initiate()?this.momentumController:null},l.prototype.computePlanePoints=function(b,c,e,f,g){g.length=b.length;for(var k=this.tmp2d,h=0;h<g.length;h++){var l=b[h];k[0]=l[c].x;k[1]=this.view.height-l[c].y;void 0===g[h]&&
(g[h]=d.vec3d.create());a.intersectPlaneFromScreenPoint(e,f,k,g[h])}return g},l}(k.InteractiveController);l.PinchAndPanController=m})},"esri/views/3d/state/controllers/local/MomentumController":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../AnimationController ../../../webgl-engine/lib/Camera ../../../lib/glMatrix ../../utils/navigationUtils ../../../../navigation/Momentum ../../../camera/constraintUtils".split(" "),function(m,l,h,d,b,g,k,f,a){Object.defineProperty(l,
"__esModule",{value:!0});m=function(e){function c(a){var c=e.call(this)||this;return c.view=a,c.zoom={momentum:null,estimator:new f.ZoomMomentumEstimator(.05),enabled:!0},c.rotation={momentum:null,estimator:new f.RotationMomentumEstimator(.05,3,.05,.95),enabled:!0},c.pan={momentum:null,estimator:new f.ScreenspaceMomentumEstimator(.05,500,12,.82),enabled:!0},c._scaleState={center:g.vec3d.create()},c._rotationState={center:g.vec3d.create(),axis:g.vec3d.create()},c._panState={direction:g.vec3d.create()},
c.elapsedTimeSec=0,c.zoomDirection=g.vec3d.create(),c.constraintOptions={selection:15,interactionType:0,interactionFactor:0,interactionStartCamera:new b,interactionDirection:null},c}return h(c,e),c.prototype.addPanValue=function(a,b,c,e){this.pan.estimator.add(b[0],b[1],c,.001*a);g.vec3d.set(e,this._panState.direction);g.vec3d.normalize(this._panState.direction)},c.prototype.addRotationValue=function(a,b,c,e){this.rotation.estimator.add(e,.001*a);g.vec3d.set(b,this._rotationState.center);g.vec3d.set(c,
this._rotationState.axis)},c.prototype.addScaleValue=function(a,b,c){this.zoom.estimator.add(b,.001*a);g.vec3d.set(c,this._scaleState.center)},c.prototype.initiate=function(){return this.zoom.enabled&&(this.zoom.momentum=this.zoom.estimator.evaluateMomentum()),!this.zoom.momentum&&this.rotation.enabled&&(this.rotation.momentum=this.rotation.estimator.evaluateMomentum()),this.zoom.momentum||this.rotation.momentum||!this.pan.enabled||(this.pan.momentum=this.pan.estimator.evaluateMomentum()),null!=(this.zoom.momentum||
this.rotation.momentum||this.pan.momentum)},Object.defineProperty(c.prototype,"steppingFinished",{get:function(){return this.zoom.momentum&&this.zoom.momentum.isFinished(this.elapsedTimeSec)&&(this.zoom.momentum=null),this.rotation.momentum&&this.rotation.momentum.isFinished(this.elapsedTimeSec)&&(this.rotation.momentum=null),this.pan.momentum&&this.pan.momentum.isFinished(this.elapsedTimeSec)&&(this.pan.momentum=null),!this.zoom.momentum&&!this.rotation.momentum&&!this.pan.momentum},enumerable:!0,
configurable:!0}),c.prototype.onControllerStart=function(a){this.constraintOptions.interactionStartCamera.copyFrom(a);this.constraintOptions.interactionDirection=null;e.prototype.onControllerStart.call(this,a)},c.prototype.stepController=function(b,c){if(e.prototype.stepController.call(this,b,c),this.zoom.momentum){g.vec3d.normalize(g.vec3d.subtract(this._scaleState.center,c.eye,this.zoomDirection));this.constraintOptions.interactionDirection=this.zoomDirection;this.constraintOptions.interactionType=
1;var d=this.zoom.momentum.valueDelta(this.elapsedTimeSec,b);k.applyZoomToPoint(c,this._scaleState.center,d,this.view.state.constraints.minimumPoiDistance);a.applyAll(this.view,c,this.constraintOptions)}this.pan.momentum&&(g.vec3d.normalize(this._panState.direction),d=g.vec3d.dist(this.pan.momentum.dataOldest,this.pan.momentum.dataNewest),d/=this.pan.momentum.dataTimeDelta,d*=this.pan.momentum.velocityFactor(this.elapsedTimeSec),g.vec3d.scale(this._panState.direction,d*b),g.vec3d.subtract(c.eye,this._panState.direction),
g.vec3d.subtract(c.center,this._panState.direction),c.markViewDirty(),this.constraintOptions.interactionType=4,a.applyAll(this.view,c,this.constraintOptions));this.rotation.momentum&&(d=this.rotation.momentum.valueDelta(this.elapsedTimeSec,b),k.applyRotation(c,this._rotationState.center,this._rotationState.axis,d),this.constraintOptions.interactionType=2,a.applyAll(this.view,c,this.constraintOptions));this.elapsedTimeSec+=b},c}(d.AnimationController);l.MomentumController=m})},"esri/views/3d/webgl-engine/Stage":function(){define("require exports ./parts/Model ./parts/View ./lib/Selector ./lib/Camera ./lib/gl-matrix ./lib/Util ./lib/ModelContentType ./lighting/Lightsources".split(" "),
function(m,l,h,d,b,g,k,f,a,e){m=k.vec2d;l=k.vec2;var c=k.vec3d;k=function(){function k(a,f,g){this._intersectTolerance=b.DEFAULT_TOLERANCE;this._viewContent=[];this._externalIntersectionHandlers=[];this.container=f;this.viewingMode=a;this.model=new h;this.view=new d(f,this,this.model.getDirtySet(),g);this._validateHUDSelector=new b(this.viewingMode);this._validateHUDSelector.enableHUDSelection=!1;this.view.setLighting({lights:[new e.MainLight(c.createFrom(.7,.7,.7)),new e.AmbientLight(c.createFrom(.3,
.3,.3))],groundLightingFactor:.5,globalFactor:.5})}return k.prototype.setNeedsRender=function(){this.view.setNeedsRender()},k.prototype.dispose=function(){this.view.dispose();this.model=this.view=null},k.prototype.frame=function(a,b){void 0===b&&(b=0);var e=Math.max(1E-6,a.getBSRadius());b=Math.max(2,b+2);b*=e;var e=this.getCamera(),d=c.create(e.viewForward);c.scale(d,-(1.5*b/Math.tan(e.fov)));c.set(a.getCenter(),e.center);c.add(e.center,d,e.eye);e=new g(e.eye,e.center,e.up);this.setCamera(e)},k.prototype.beginMod=
function(){k.DebugSettings.fineGrainedContentValidation&&this.model.validateContent()},k.prototype.endMod=function(a){void 0===a&&(a=!1);k.DebugSettings.fineGrainedContentValidation&&!a&&this.model.validateContent()},k.prototype.add=function(a,b){this.model.add(a,b);"function"==typeof b.addParentStage&&b.addParentStage(this)},k.prototype.remove=function(a,b){a=this.model.remove(a,b);return"function"==typeof a.removeParentStage&&a.removeParentStage(this),a},k.prototype.notifyDirty=function(a,b,c,e){this.model.notifyDirty(a,
b,c,e)},k.prototype.processDirty=function(){var a=this.model.getDirtySet(),b=a.getDirtyMaterials();if(a.hasDirtyGeometryRecords()||b){k.DebugSettings.endFrameContentValidation&&this.model.validateContent();k.DebugSettings.logDirtySet&&console.log("Dirty set: "+this.model.getDirtySet().formatDebugInfo(!1));var c=a.getAddRemoveUpdateListFilteredByLayers(this._viewContent,!0);(0<c[0].length+c[1].length+c[2].length||b)&&this.view.modify(c[0],c[1],c[2],b);k.DebugSettings.logDirtySet&&(console.log("RGs add: "+
c[0].map(function(a){return a.uniqueName})),console.log("RGs remove: "+c[1].map(function(a){return a.uniqueName})));a.getAddRemoveUpdateList(!0);a.clearDirtyMaterials();this.view.setNeedsRender()}},k.prototype.processDirtyLayer=function(a){var b=this.model.getDirtySet(),c=b.getDirtyMaterials();a=b.getAddRemoveUpdateListFilteredByLayers([a],!0);(0<a[0].length+a[1].length+a[2].length||c)&&this.view.modify(a[0],a[1],a[2],c);b.clearDirtyMaterials();this.view.setNeedsRender()},k.prototype.get=function(a,
b){return this.model.get(a,b)},k.prototype.getAll=function(a){return this.model.getAll(a)},k.prototype.addTextureListener=function(a){this.view.addTextureListener(a)},k.prototype.removeTextureListener=function(a){this.view.removeTextureListener(a)},k.prototype.getContainer=function(){return this.container},k.prototype.getCamera=function(){return this.view.getCamera()},k.prototype.setCamera=function(a){this.view.setCamera(a)},k.prototype.getViewParams=function(a){return this.view.getViewParams(a)},
k.prototype.setViewParams=function(a){this.view.setViewParams(a)},k.prototype.getLayers=function(){return this.model.getAll(a.LAYER)},k.prototype.setLighting=function(a){this.view.setLighting(a)},k.prototype.getCanvas=function(){return this.view.getCanvas()},k.prototype.setRenderParams=function(a){this.view.setRenderParams(a)},k.prototype.getRenderParams=function(){return this.view.getRenderParams()},k.prototype.has=function(a){return this.view.has(a)},k.prototype.getViewContent=function(){return this._viewContent.slice(0)},
k.prototype.setViewContent=function(a){var b=f.array2object(this._viewContent),c=f.array2object(a),e=f.subtractObjects(c,b),b=f.subtractObjects(b,c);this.processDirty();c=this.model.getDirtySet();e=c.getResidentRenderGeometriesFilteredByLayers(f.object2array(e));b=c.getResidentRenderGeometriesFilteredByLayers(f.object2array(b));this.view.modify(e,b,[]);this._viewContent=a.slice(0)},k.prototype.addToViewContent=function(a){for(var b=[],c=0;c<a.length;c++)-1===this._viewContent.indexOf(a[c])&&b.push(a[c]);
0<a.length&&(this.processDirty(),a=this.model.getDirtySet().getResidentRenderGeometriesFilteredByLayers(b),this.view.modify(a,[],[]),this._viewContent.push.apply(this._viewContent,b))},k.prototype.removeFromViewContent=function(a){this.processDirty();for(var b=this.model.getDirtySet(),c=this._viewContent,e=[],d=0;d<a.length;d++){var f=c.indexOf(a[d]);-1<f&&(c[f]=c[c.length-1],c.pop(),e.push(a[d]))}a=b.getResidentRenderGeometriesFilteredByLayers(e);this.view.modify([],a,[])},k.prototype.getViewFrustumObjects=
function(){return this.view.getFrustumObjects()},k.prototype.getLocalOrigin=function(a,b,c){return this.model.getOrigin(a,b,c)},k.prototype.getFrameTask=function(){return this.view.getFrameTask()},k.prototype.requestScreenCapture=function(a,b){this.view.requestScreenCapture(a,b)},k.prototype.getAllTexturesLoaded=function(){return this.view.getAllTexturesLoaded()},k.prototype.getTextureLoaded=function(a){return this.view.getTextureLoaded(a)},k.prototype.addExternalRenderer=function(a,b){return"function"==
typeof b.intersect&&this._externalIntersectionHandlers.push(b),this.view.addExternalRenderer(a,b)},k.prototype.removeExternalRenderer=function(a){var b=this._externalIntersectionHandlers.indexOf(a);return-1<b&&this._externalIntersectionHandlers.splice(b,1),this.view.removeExternalRenderer(a)},k.prototype.getContentDebugStrings=function(a){return this.model.formatDebugInfo(a)},k.prototype.getRenderStats=function(){return this.view.getCombinedStats()},k.prototype.getRenderStatString=function(a){var b=
this.getRenderStats(),c="";if(a){var c=c+"\x3ctable\x3e",e;for(e in b)c+="\x3ctr\x3e\x3ctd\x3e"+e+'\x3c/td\x3e\x3ctd style\x3d"text-align: right"\x3e'+Math.round(b[e])+"\x3c/td\x3e\x3c/tr\x3e";c+="\x3c/table\x3e"}else for(e in b)c+=e+": "+b[e]+"\n";return c},k.prototype.pick=function(a,b,e,d){var f=c.create(),g=c.create();return this.view.getPickRay(a,f,g),this.pickRay(f,g,a,a,b,e,d)},k.prototype.pickRayWithBeginPoint=function(a,b,c,e,d){this.view.pickRayWithBeginPoint(a,b,c,e,d)},k.prototype.pickRay=
function(a,e,d,f,g,k,l){f=this.view.getCamera();d||(d=q,f.projectPoint(e,d));var n;if(g){n=Array(g.length);for(var m=0;m<n.length;m++)n[m]=this.model.get(h.ContentType.LAYER,g[m])}else{n=[];g=this.getViewContent();for(var u=this.model.getAll(h.ContentType.LAYER),m=0;m<g.length;m++){var w=u[g[m]];w&&"VISIBLE"===w.getState()&&n.push(w)}}l?l.init(n,a,e,d,f,this._intersectTolerance,k):l=new b(this.viewingMode,n,a,e,d,f,this._intersectTolerance,k);for(m=0;m<this._externalIntersectionHandlers.length;m++)this._externalIntersectionHandlers[m].intersect(l,
a,e,d);if(l.getHudResults().length){m=l.getHudResults();m.sort(function(a,b){return b.dist-a.dist});e=m[m.length-1];g=t;f.projectPoint(e.center,g);g[0]=Math.round(g[0]);g[1]=Math.round(g[1]);u=r;this.view.getPickRay(g,a,u);d=c.dist(e.center,a)/c.dist(a,u)*.99;this._validateHUDSelector.init(n,a,u,g,f,this._intersectTolerance,k);for(m=0;m<this._externalIntersectionHandlers.length;m++)this._externalIntersectionHandlers[m].intersect(this._validateHUDSelector,a,u,g);a=this._validateHUDSelector.getMinResult();
(null==a.dist||d<=a.dist)&&l.getMinResult().copyFrom(e)}return l},k.prototype.getIntersectTolerance=function(){return this._intersectTolerance},k.prototype.setIntersectTolerance=function(a){void 0===a&&(a=1E-5);this._intersectTolerance=a},k.prototype.getTextureGraphicsRenderer=function(){return this.view.getTextureGraphicsRenderer()},k.DebugSettings={fineGrainedContentValidation:!1,endFrameContentValidation:!1,logDirtySet:!1},k.ModelContentType=a,k}();var q=m.create(),t=l.create(),r=c.create();return k})},
"esri/views/3d/webgl-engine/parts/View":function(){define("require exports ../../../../core/sniff ../../../../core/Logger ../lib/GLTextureRep ../lib/GLMaterialRep ../lib/ShaderSnippets ../lib/GLSLShaderRep ../lib/TextureRenderer ../lib/gl-matrix ../lib/webgl-utils ./Model ./Viewport ../materials/repository ../lib/SSAOHelperObscurance ../lib/HighlightHelper ../lib/RenderOccludedHelper ../lib/OffscreenRenderingHelper ../lib/tracer ../../../webgl/RenderingContext ../lib/ProgramRepository ../lighting/Lightsources ../../../support/screenshotUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B){var F=e.vec3d,G=e.vec4d,N=d.getLogger("esri.views.3d.webgl-engine.parts.View");return function(){function e(c,e,d,f){var k=this;this._backgroundColor=G.createFrom(1,1,1,1);this._lightDirection=F.createFrom(0,1,0);this._didRender=!1;this._idleSuspend=this._needsRender=!0;this._shouldRender=!1;this._screenCaptureQueue=[];this._container=c;this._stage=e;this._initializeContext(f);this._initializeShaders(f);this._textureRep=new b(e.getAll(q.ContentType.TEXTURE),
this._programRepository,function(){return k._viewport.getCamera().viewport},this._rctx);this._materialRep=new g(this._textureRep,this._programRepository);this._viewport=new t(this._programRepository,this._materialRep,this._textureRep,this._rctx);this._initializeViewportCamera();this._textureRenderer=new a(this._rctx,this._canvas,this._programRepository,this._materialRep,this._textureRep,d);this._initializeFrameTask()}return e.prototype._initializeFrameTask=function(){var a=this;this._frameTask={preRender:function(){(n.begin(),
a._stage.processDirty(),a.needsRender())?(a._shouldRender=!0,a._viewport.getCamera().setGLViewport(a._rctx),a._rctx.setClearColor.apply(a._rctx,a._backgroundColor),a._rctx.clear(16640)):a._shouldRender=!1},render:function(){a._shouldRender&&(a._didRender=!0,a._viewport.render(a._lightDirection,null))},postRender:function(){n.end()},update:function(){a._performScreenCaptures();a.resetNeedsRender()}}},e.prototype._initializeViewportCamera=function(){var a=this._container.getBoundingClientRect(),b=this._viewport.getCamera();
b.viewport[2]=a.width;b.viewport[3]=a.height;this._viewport.setCamera(b)},e.prototype._initializeContext=function(a){(this._canvas=a.canvas)||(this._canvas=document.createElement("canvas"));this._canvas.setAttribute("style","width: 100%; height:100%; display:block;");var b=c.setupWebGL(this._canvas,{alpha:a.alpha||!1,antialias:!1,depth:!0,stencil:null==a.stencil?!0:a.stencil});this._gl=n.instrumentContext(b[0]);this._rctx=new w(b[0],{disabledExtensions:a.deactivatedWebGLExtensions});!a.alpha&&this._rctx.contextAttributes.alpha&&
N.error("WebGL context has alpha channel even though no alpha channel was requested");11<=h("safari")&&(this._container.style.backgroundColor="black");this._container.appendChild(this._canvas)},e.prototype._initializeShaders=function(a){this._shaderSnippets=new k({fsprecisionf:"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\nprecision highp sampler2D;\n#else\nprecision mediump float;\nprecision mediump sampler2D;\n#endif\n",vsprecisionf:"\nprecision highp float;\nprecision highp sampler2D;\n",
viewingMode:"global"===a.viewingMode?"#define VIEWING_MODE_GLOBAL 1 \n":" #define VIEWING_MODE_LOCAL 1 \n"});this._shaderRep=new f;this._programRepository=new z;r.initializeShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);v.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);x.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx);u.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,
this._rctx);y.loadShaders(this._shaderSnippets,this._shaderRep,this._programRepository,this._rctx)},e.prototype.dispose=function(){this._viewport.dispose();this._viewport=null;this._textureRenderer.dispose();this._textureRenderer=null;this._programRepository.dispose();this._programRepository=null;this._container.contains(this._canvas)&&this._container.removeChild(this._canvas);this._gl=this._canvas=this._container=null},e.prototype.getCombinedStats=function(){return this._viewport.getCombinedStats()},
e.prototype.setNeedsRender=function(){this._didRender=!1;this._needsRender=!0},e.prototype.resetNeedsRender=function(){this._didRender&&(this._needsRender=!1,this._didRender=!1);this._viewport.resetNeedsRender();this._textureRep.resetNeedsRender()},e.prototype.needsRender=function(){return this._needsRender||!this._idleSuspend||this._viewport.needsRender()||this._textureRep.needsRender()},e.prototype.getFrameTask=function(){return this._frameTask},e.prototype.setLighting=function(a){F.set3(0,0,0,
this._lightDirection);for(var b=0,c=a.lights;b<c.length;b++){var e=c[b];if(e instanceof C.MainLight){F.negate(e.direction,this._lightDirection);break}}this._viewport.setLighting(a);this._needsRender=!0},e.prototype.getMainLightDirection=function(){return this._lightDirection},e.prototype.getViewParams=function(a){var b=this._viewport.getViewParams(a);return(!a||a.backgroundColor)&&(b.backgroundColor=this._backgroundColor),b},e.prototype.setViewParams=function(a){this._needsRender=!0;a.backgroundColor&&
(this._backgroundColor=a.backgroundColor);this._viewport.setViewParams(a)},e.prototype.setRenderParams=function(a){this._needsRender=!0;void 0!==a.idleSuspend&&(this._idleSuspend=!!a.idleSuspend);this._viewport.setRenderParams(a)},e.prototype.getRenderParams=function(){var a=this._viewport.getRenderParams();return a.anisotropicFiltering=this._textureRep.getMaxAnisotropy(),a.idleSuspend=this._idleSuspend,a},Object.defineProperty(e.prototype,"renderingContext",{get:function(){return this._rctx},enumerable:!0,
configurable:!0}),e.prototype.has=function(a){return"s3tc"===a?!!this._rctx.extensions.compressedTextureS3TC:"standardDerivatives"===a?!!this._rctx.extensions.standardDerivatives:"shaderTextureLOD"===a?!!this._rctx.extensions.shaderTextureLOD:"angleInstancedArrays"===a?!!this._rctx.extensions.angleInstancedArrays:!1},e.prototype.getFrustumObjects=function(){return this._viewport.getFrustumObjects()},e.prototype.modify=function(a,b,c,e){this._viewport.modify(a,b,c,e)},e.prototype.setCamera=function(a){this._viewport.setCamera(a)},
e.prototype.getCamera=function(){return this._viewport.getCamera()},e.prototype.getPickRay=function(a,b,c){this._viewport.getPickRay(a,b,c)},e.prototype.pickRayWithBeginPoint=function(a,b,c,e,d){this._viewport.pickRayWithBeginPoint(a,b,c,e,d)},e.prototype.getCanvas=function(){return this._canvas},e.prototype.getTextureGraphicsRenderer=function(){return this._textureRenderer},e.prototype.requestScreenCapture=function(a,b){this._screenCaptureQueue.push({settings:a||{},callback:b});this._needsRender=
!0},e.prototype.getAllTexturesLoaded=function(){return 0===this._textureRep.getLoadingCount()},e.prototype.getTextureLoaded=function(a){return this._textureRep.getIsLoaded(a)},e.prototype.addTextureListener=function(a){this._textureRep.addTextureListener(a)},e.prototype.removeTextureListener=function(a){this._textureRep.removeTextureListener(a)},e.prototype.addExternalRenderer=function(a,b){return this._viewport.addExternalRenderer(a,b)?(b.initializeRenderContext({rctx:this._rctx,gl:this._rctx.gl,
shaderSnippets:this._shaderSnippets,shaderRep:this._shaderRep,programRep:this._programRepository,textureRep:this._textureRep}),!0):!1},e.prototype.removeExternalRenderer=function(a){return this._viewport.removeExternalRenderer(a)?(a.uninitializeRenderContext({rctx:this._rctx,gl:this._rctx.gl}),!0):!1},e.prototype._performScreenCaptures=function(){if(0!==this._screenCaptureQueue.length){for(var a=0;a<this._screenCaptureQueue.length;a++){var b=this._screenCaptureQueue[a],c=0,e=0,d=this._canvas.width,
f=this._canvas.height,g=this._canvas.width,k=this._canvas.height,h=b.settings.area;(h&&(c=h.x,e=h.y,d=h.width,f=h.height),void 0!==b.settings.width&&void 0!==b.settings.height)?(h=b.settings.width/b.settings.height,f*h<d?(h*=f,c+=Math.floor((d-h)/2),d=Math.floor(h)):(h=d/h,e+=Math.floor((f-h)/2),f=Math.floor(h)),g=b.settings.width,k=b.settings.height):(g=d,k=f);var l=this._canvas,h=null;if(0!==c||0!==e||d!==this._canvas.width||f!==this._canvas.height||g!==this._canvas.width||k!==this._canvas.height){this._resizeCanvas||
(this._resizeCanvas=document.createElement("canvas"));this._resizeCanvas.width=g;this._resizeCanvas.height=k;var n=this._resizeCanvas.getContext("2d"),h=new Uint8Array(d*f*4);this._gl.readPixels(c,this._canvas.height-(e+f),d,f,6408,5121,h);c=n.getImageData(0,0,g,k);B.resampleHermite(h,d,f,c.data,g,k,!0);n.putImageData(c,0,0);l=this._resizeCanvas;n=null}d={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"}[b.settings.format?b.settings.format.toLowerCase():"png"];f=1;void 0!==b.settings.quality&&(f=
b.settings.quality/100);d={dataURL:l.toDataURL(d,f),x:0,y:0,width:g,height:k};b.settings.returnByteBuffer&&(d.data=h);b.callback(d)}this._screenCaptureQueue=[]}},e}()})},"esri/views/3d/webgl-engine/lib/GLMaterialRep":function(){define(["require","exports","./Util"],function(m,l,h){var d=function(){function b(b){this.refCnt=0;this.glMaterial=b}return b.prototype.incRefCnt=function(){++this.refCnt},b.prototype.decRefCnt=function(){--this.refCnt;h.assert(0<=this.refCnt)},b.prototype.getRefCnt=function(){return this.refCnt},
b.prototype.getGLMaterial=function(){return this.glMaterial},b}();return function(){function b(b,d){this.textureRep=b;this.programRep=d;this.id2glMaterialRef={}}return b.prototype.aquire=function(b){return this.aquireExt(b,"color")},b.prototype.aquireDepthShadowMap=function(b){return this.aquireExt(b,"depthShadowMap")},b.prototype.aquireDepth=function(b){return this.aquireExt(b,"depth")},b.prototype.aquireNormal=function(b){return this.aquireExt(b,"normal")},b.prototype.aquireHighlight=function(b){return this.aquireExt(b,
"highlight")},b.prototype.aquireExt=function(b,k){var f;f=b.getId()+"_"+k;var a=this.id2glMaterialRef[f];null==a?(b=(a=b.getGLMaterials()[k])?new a(b,this.programRep,this.textureRep):void 0,a=new d(b),this.id2glMaterialRef[f]=a):b=a.getGLMaterial();return a.incRefCnt(),b&&this.increaseProgramReferences(b),b},b.prototype.release=function(b){this.releaseExt(b,"color")},b.prototype.releaseDepth=function(b){this.releaseExt(b,"depth")},b.prototype.releaseNormal=function(b){this.releaseExt(b,"normal")},
b.prototype.releaseDepthShadowMap=function(b){this.releaseExt(b,"depthShadowMap")},b.prototype.releaseHighlight=function(b){this.releaseExt(b,"highlight")},b.prototype.releaseExt=function(b,d){b=b+"_"+d;d=this.id2glMaterialRef[b];if(d.decRefCnt(),0===d.getRefCnt())(d=d.getGLMaterial())&&(this.decreaseProgramReferences(d),void 0!==d.dispose&&d.dispose()),delete this.id2glMaterialRef[b]},b.prototype.updateMaterialParameters=function(b){var d=this.id2glMaterialRef[b+"_color"];d&&d.getGLMaterial()&&this.updateParamsForMat(d.getGLMaterial());
(d=this.id2glMaterialRef[b+"_depth"])&&d.getGLMaterial()&&this.updateParamsForMat(d.getGLMaterial());(d=this.id2glMaterialRef[b+"_depthShadowMap"])&&d.getGLMaterial()&&this.updateParamsForMat(d.getGLMaterial());(d=this.id2glMaterialRef[b+"_normal"])&&d.getGLMaterial()&&this.updateParamsForMat(d.getGLMaterial());(b=this.id2glMaterialRef[b+"_highlight"])&&b.getGLMaterial()&&this.updateParamsForMat(b.getGLMaterial())},b.prototype.updateParamsForMat=function(b){b.updateParameters&&b.updateParameters()},
b.prototype.increaseProgramReferences=function(b){if(b.getAllPrograms){b=b.getAllPrograms();for(var d=0;d<b.length;d++)this.programRep.increaseRefCount(b[d])}else this.programRep.increaseRefCount(b.getProgram())},b.prototype.decreaseProgramReferences=function(b){if(b.getAllPrograms){b=b.getAllPrograms();for(var d=0;d<b.length;d++)this.programRep.decreaseRefCount(b[d])}else this.programRep.decreaseRefCount(b.getProgram())},b}()})},"esri/views/3d/webgl-engine/lib/ShaderSnippets":function(){define(["require",
"exports","./Util","dojox/xml/parser"],function(m,l,h,d){return function(){function b(b){var d=h.VertexAttrConstants,f;for(f in d)this[d[f]]=h.VertexAttrConstants[f];if(b)for(var a in b)this[a]=b[a]}return b.prototype._parse=function(b){b=d.parse(b).getElementsByTagName("snippet");for(var g=/\$[a-zA-Z0-9]+[ \t]*/,f=/[\$\s]+/g,a=0;a<b.length;a++){var e=b[a].getAttribute("name");h.assert(null==this[e]);for(var c=b[a].textContent;;){var l=c.match(g);if(null==l)break;var m=this[l[0].replace(f,"")];h.assert(void 0!==
m);c=c.replace(l[0],m)}this[e]=c}},b}()})},"esri/views/3d/webgl-engine/lib/GLSLShaderRep":function(){define(["require","exports","./Util"],function(m,l,h){return function(){function d(){this.shaders={}}return d.prototype.add=function(b,d){h.assert(null==this.shaders[b]);this.shaders[b]=d},d.prototype.get=function(b){return h.assert(void 0!==this.shaders[b]),this.shaders[b]},d}()})},"esri/views/3d/webgl-engine/lib/TextureRenderer":function(){define("require exports ./Renderer ./Camera ./Util ./gl-matrix ../materials/internal/TexOnlyGLMaterial ./ModelDirtyTypesTs ./RenderPass ./HighlightUtils ./ComponentUtils ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/Texture ../../support/debugFlags ../lighting/Lightsources ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z){var C=g.vec3d,B=g.vec4d,F=g.mat4d;m=function(){function d(a,b,c,e,d,f){var g=this;this._acquiredTextures={};this._clearColor=B.createFrom(0,0,0,0);this._id2origin={};this._uniqueIdx=0;this._rctx=a;this._canvas=b;this._programRep=c;this._textureRep=d;this._modelDirtySet=f;this._renderer=new h(c,e,d,this._rctx,!0);this._renderer.onHasHighlightsChanged=function(a){g.onHasHighlightsChanged&&g.onHasHighlightsChanged(a)};this._renderer.setLighting({lights:[new y.AmbientLight(C.createFrom(1,
1,1))],groundLightingFactor:1,globalFactor:0})}return d.prototype.dispose=function(){for(var a in this._acquiredTextures)this._acquiredTextures[a].fbo.dispose(),this._textureRep.release(a);this._acquiredTextures=null;this._renderer.dispose();this._renderer=null},d.prototype.addRenderGeometries=function(a){var b=this;a.forEach(function(a){null==a.origin&&(a.origin=b.getOrigin(a.center,a.bsRadius));a.idx=b._uniqueIdx++});this._renderer.modify(a,[])},d.prototype.removeRenderGeometries=function(a){this._renderer.modify([],
a)},d.prototype.updateRenderGeometries=function(a,b){a=a.map(function(a){return{renderGeometry:a,updateType:b}});this._renderer.modify([],[],a,{})},d.prototype.updateRenderOrder=function(a){0<Object.keys(a).length&&this._renderer.modifyRenderOrder(a)},d.prototype.setBackgroundColor=function(a){this._clearColor=a},d.prototype.addRenderGeometryHighlight=function(a,b){var d=a.instanceParameters,f=e.generateHighlightId();return d.componentHighlights=c.addHighlight(d.componentHighlights,null,b,f),this.updateRenderGeometries([a],
32),f},d.prototype.removeRenderGeometryHighlight=function(a,b){var e=a.instanceParameters;e.componentHighlights=c.removeHighlight(e.componentHighlights,b);this.updateRenderGeometries([a],32)},d.prototype.isEmpty=function(){return this._renderer.isEmpty()},d.prototype.processDirtyMaterials=function(){var a=this._modelDirtySet.getDirtyMaterials();a&&this._renderer.modify([],[],[],a);this._modelDirtySet.clearDirtyMaterials()},Object.defineProperty(d.prototype,"hasHighlights",{get:function(){return this._renderer.hasHighlights},
enumerable:!0,configurable:!0}),d.prototype.draw=function(b,c){return this.drawPass(a.MATERIAL,b,c)},d.prototype.drawHighlights=function(b,c){return this.drawPass(a.MATERIAL_HIGHLIGHT,b,c)},d.prototype.drawPass=function(b,c,e){if(this.isEmpty()&&!x.OVERLAY_DRAW_TEST_TEXTURE||(this.processDirtyMaterials(),b===a.MATERIAL_HIGHLIGHT&&!this.hasHighlights)||!e.views.some(function(a){return a.extent[0]!==a.extent[2]&&a.extent[1]!==a.extent[3]}))return!1;var d,f=c.getId(),g=this._rctx,k=g.gl;if(this._acquiredTextures[f])d=
this._acquiredTextures[f].fbo;else{d=this._textureRep.aquire(f).getGLTexture();d=q.createWithAttachments(this._rctx,d,{colorTarget:0,depthStencilTarget:0});var h=Object.keys(this._acquiredTextures).length;this._acquiredTextures[f]={texture:c,fbo:d,idx:h}}c=e.width;h=e.height;d.width===c&&d.height===h||(d.resize(c,h),d.colorTexture.setSamplingMode(9729));N.near=1;N.far=1E4;g.bindFramebuffer(d);g.setDepthTestEnabled(!1);g.setBlendFunctionSeparate(770,771,1,771);g.setClearColor.apply(g,this._clearColor);
g.clear(k.COLOR_BUFFER_BIT);this._renderer.setPixelRatio(e.pixelRatio||1);for(k=0;k<e.views.length;k++)d=e.views[k],N.viewport=d.viewport,F.ortho(0,d.extent[2]-d.extent[0],0,d.extent[3]-d.extent[1],N.near,N.far,N.projectionMatrix),F.identity(N.viewMatrix),F.translate(N.viewMatrix,[-d.extent[0],-d.extent[1],0]),N.setGLViewport(this._rctx),x.OVERLAY_DRAW_TEST_TEXTURE&&this._drawTestTexture(c,h,G[this._acquiredTextures[f].idx%G.length]),this._renderer.renderGeometryPass(b,N);return g.setDepthTestEnabled(!0),
g.setBlendFunctionSeparate(770,771,1,771),g.bindFramebuffer(null),g.setViewport(0,0,this._canvas.width,this._canvas.height),!0},d.prototype._drawTestTexture=function(a,b,c){var e=this._rctx,d=e.gl;if(!this._testPatternMat){for(var f=new Uint8Array(a*b*4),g=0,h=0;b>h;h++)for(var l=0;a>l;l++){var n=Math.floor(l/10),p=Math.floor(h/10);2>n||2>p||10*n>a-20||10*p>b-20?(f[g++]=255,f[g++]=255,f[g++]=255,f[g++]=255):(f[g++]=255,f[g++]=255,f[g++]=255,1&n&&1&p?f[g++]=1&l^1&h?0:255:f[g++]=1&n^1&p?0:128)}a=new v(e,
{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:a,height:b},f);this._testPatternMat=new k(this._programRep,a,[1,1,1,1],!0,d.ALWAYS);this._testPatternBindParams={proj:F.identity(),view:F.identity(),nearFar:[-1,1],origin:[0,0,0]};d=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,-1,1,0,0,1,1,1,0,1,1]);this._quadVAO=new t(e,z.Default3D,{geometry:w.Pos3Tex},{geometry:r.createVertex(e,35044,d)})}this._testPatternMat.setColor([c[0],c[1],c[2],1]);this._testPatternMat.bind(e,this._testPatternBindParams);
this._testPatternMat.bindView(e,this._testPatternBindParams);e.bindVAO(this._quadVAO);e.drawArrays(5,0,u.vertexCount(this._quadVAO,"geometry"));this._testPatternMat.release(e)},d.prototype.getOrigin=function(a,c){var e=0;c=10*c/1E4;1<c&&(e=Math.ceil(b.logWithBase(c,2)));c=1E4*Math.pow(2,e);var d=Math.round(a[0]/c),f=Math.round(a[1]/c);a=Math.round(a[2]/c);var e=e+"_"+d+"_"+f+"_"+a,g=this._id2origin[e];return null==g&&(g={vec3:C.createFrom(d*c,f*c,a*c),id:e},this._id2origin[e]=g),g},d}();var G=[[1,
.5,.5],[.5,.5,1],[.5,1,.5]],N=new d;return m})},"esri/views/3d/webgl-engine/lib/Renderer":function(){define("require exports ./IntervalUtilities ./ModelDirtyTypesTs ./Float32ArrayList ./InstanceBufferData ../lighting/SceneLighting ./LinearDepthTextureHelper ./NormalTextureHelper ./HighlightTextureHelper ./RenderPass ./RenderSlot ./RenderContext ./ExternalRendererContainer ./StencilRenderingHelper ./Util ./gl-matrix ./ComponentUtils ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ./FxaaRenderPass ./SmaaRenderPass ../../../webgl/enums ./DefaultVertexAttributeLocations ../../../webgl/Profiling ../materials/HUDMaterial".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R){function P(a){return y.generateVisibleIndexRanges(a.instanceParameters.componentVisibilities,a.componentOffsets)}function Q(a,b,c){var e=a.origin.vec3;E(ba,-e[0],-e[1],-e[2]);p.multiply(ba,a.transformation,b);p.inverse(b,c);p.transpose(c)}function T(a,b,c){for(var e in a){var d=a[e];b(e,d);for(var f in d.origin2data)c(f,d.origin2data[f])}}function O(a){return!1===a.preinterleaved?W(a.indices).length:a.indexCount}var S,H=v.assert,Y=
v.objectEmpty,W=v.getFirstObjectValue,E=v.setMatrixTranslation3;m=x.vec2d;var p=x.mat4d,A=v.VertexAttrConstants,K=p.identity();v=function(){function d(b,c,d,g,h){this._lighting=new k.SceneLighting;this._mat2DataMerged={};this._mat2DataInstanced={};this._mat2DataPreinterleaved={};this._renderOrder=[];this._externalRenderers=new r;this._renderContext=new t;this._isRendering=!1;this._highlights=[];this._pixelRatio=1;this._threshold=1535;this._needsRender=!0;this._fallbackDepthStencilTexture=null;this._stats=
new U;this.ssaoEnabled=!1;this.renderOptions={antialiasing:"smaa",earlyOcclusionPixelDraw:!1};this._programRep=b;this._materialRep=c;this._orderedRendering=h;this._rctx=g;this._fxaaPass=new B(g);this._smaaPass=new F(g);this._renderContext.lightingData=this._lighting.getOld();g.setDepthTestEnabled(!0);g.setFaceCullingEnabled(!0);g.setBlendingEnabled(!1);g.setBlendFunctionSeparate(770,771,1,771);this._bindParameters={view:null,proj:null,viewInvTransp:null,nearFar:null,lightingData:null,viewport:null,
framebufferTex:null,shadowMappingEnabled:!1,ssaoEnabled:!1,origin:null,pixelRatio:null,instanceParameters:null,depthFBO:null,normalFBO:null,extensions:{angleInstancedArrays:g.extensions.angleInstancedArrays}};this._linearDepthTextureHelper=new f(g);this._normalTextureHelper=new a(g);this._highlightTextureHelper=new e(g);this._stencilRenderingHelper=new u(g);this._initializeFramebufferTexture()}return d.prototype._initializeFramebufferTexture=function(){var a=this._rctx.gl,a=this._rctx.contextAttributes.alpha?
a.RGBA:a.RGB,b=new n(this._rctx,{target:3553,pixelFormat:a,dataType:5121,samplingMode:9728,wrapMode:33071,width:4,height:4});this._framebuffer={format:a,texture:b}},d.prototype.dispose=function(){var a=this,b=function(b){a._releaseMaterials(b)},c=function(a,b){if(b.type===S.Preinterleaved)for(var c in b.instances)b.instances[c].vao.dispose(!0);else b.vao.dispose(!0)};T(this._mat2DataMerged,b,c);T(this._mat2DataInstanced,b,c);T(this._mat2DataPreinterleaved,b,c);this._mat2DataPreinterleaved=this._mat2DataInstanced=
this._mat2DataMerged=null;this._framebuffer.texture.dispose();this._framebuffer.texture=null;this._linearDepthTextureHelper.getEnableState()&&this._linearDepthTextureHelper.disable();this._normalTextureHelper.getEnableState()&&this._normalTextureHelper.disable();this._highlightTextureHelper.getEnableState()&&this._highlightTextureHelper.setEnableState(!1);this._stencilRenderingHelper.getEnableState()&&this._stencilRenderingHelper.setEnableState(!1);this._fallbackDepthStencilTexture&&(this._fallbackDepthStencilTexture.dispose(),
this._fallbackDepthStencilTexture=null)},d.prototype.setLighting=function(a){this._lighting.set(a)},d.prototype.setPixelRatio=function(a){this._pixelRatio=a;this._needsRender=!0},d.prototype.getPixelRatio=function(){return this._pixelRatio},d.prototype.addExternalRenderer=function(a,b){return this._externalRenderers.addRenderer(a,b),!0},d.prototype.removeExternalRenderer=function(a){return this._externalRenderers.removeRenderer(a),!0},d.prototype.getExternalRenderers=function(){return this._externalRenderers},
d.prototype.resetNeedsRender=function(){this._needsRender=!1;this._externalRenderers.resetNeedsRender()},d.prototype.needsRender=function(){return this._needsRender||this._externalRenderers.needsRender()},d.prototype.getCombinedStats=function(){var a=this;this._stats.VBOallocatedSize=0;this._stats.VBOoptimalSize=0;this._stats.VBOusedSize=0;var b=function(){},c=function(b,c){if(c.type===S.Preinterleaved)for(var e in c.instances)b=c.instances[e].buffer,a._stats.VBOallocatedSize+=b.length,a._stats.VBOusedSize+=
b.length,a._stats.VBOoptimalSize+=b.length;else a._stats.VBOallocatedSize+=c.buffer.getArray().length,a._stats.VBOusedSize+=c.buffer.getSize(),a._stats.VBOoptimalSize+=c.optimalCount};return T(this._mat2DataMerged,b,c),T(this._mat2DataInstanced,b,c),T(this._mat2DataPreinterleaved,b,c),this._stats.VBOallocatedSize*=.00390625,this._stats.VBOusedSize*=.00390625,this._stats.VBOoptimalSize*=.00390625,this._stats},d.prototype._addHighlight=function(a){var b=this._getInstance(a);return null===b?void console.error("No instance found for RenderGeometry {name: '"+
a.name+"', uniqueName: '"+a.uniqueName+"'}"):(this._highlights.push(b),this._orderedRendering&&this._sortHighlightsByRenderOrder(),this._needsRender=!0,void(this.onHasHighlightsChanged&&this.onHasHighlightsChanged(this.hasHighlights)))},d.prototype._removeHighlight=function(a){var b=this._highlights.length;this._highlights=this._highlights.filter(function(b){return b.uniqueName!==a.uniqueName});b!==this._highlights.length&&(this.onHasHighlightsChanged&&this.onHasHighlightsChanged(this.hasHighlights),
this._needsRender=!0)},Object.defineProperty(d.prototype,"hasHighlights",{get:function(){return 0<this._highlights.length},enumerable:!0,configurable:!0}),d.prototype._renderHUDVisibility=function(a){var b=this,c=R.shouldRenderVisibilityDuringRenderPass(a.pass),e=a.offscreenRenderingHelper&&a.offscreenRenderingHelper.getEnableState();c&&e&&a.offscreenRenderingHelper.renderHUDVisibility(function(){b._renderInternalSlot(q.OCCLUSION_PIXELS,a)})},d.prototype.renderGeometrySlots=function(a){this._externalRenderers.render(q.INTERNAL_MATERIAL,
a);this._renderInternalSlot(q.STENCIL_MATERIAL,a);this._externalRenderers.render(q.OPAQUE_TERRAIN,a);this._renderInternalSlot(q.OPAQUE_MATERIAL,a);this._externalRenderers.render(q.OPAQUE_EXTERNAL,a);a.ssaoHelper&&a.ssaoHelper.bindAll(this._programRep);this._renderInternalSlot(q.TRANSPARENT_MATERIAL,a);this.renderOptions.earlyOcclusionPixelDraw&&(this._renderHUDVisibility(a),this._renderInternalSlot(q.LINE_CALLOUTS,this._renderContext));this._externalRenderers.render(q.TRANSPARENT_EXTERNAL,a);a.ssaoHelper&&
a.ssaoHelper.bindAll(this._programRep);this._externalRenderers.render(q.TRANSPARENT_TERRAIN,a)},d.prototype._renderHighlights=function(a,b,e){var d=!!e&&e.getEnableState()&&(this.hasHighlights||this._externalRenderers.needsHighlight());if(this._highlightTextureHelper.setEnableState(d),d){d=null;e.profilingCallback&&(d=M.startMeasurement(this._renderContext.rctx));this._highlightTextureHelper.setupFBOs(a);this._highlightTextureHelper.prepareHighlightPass();this.renderGeometryPass(c.MATERIAL_HIGHLIGHT,
a,null,null);this._rctx.clear(this._rctx.gl.DEPTH_BUFFER_BIT);this._renderInternalSlot(q.LINE_CALLOUTS_HUD_DEPTH,this._renderContext);this._renderInternalSlot(q.HUDMATERIAL1,this._renderContext);this._renderInternalSlot(q.HUDMATERIAL2,this._renderContext);this._highlightTextureHelper.finish(b);var f=this._highlightTextureHelper.getHighlightFBO();e.render(a,b,f);null!==d&&e.profilingCallback&&d.stop(function(a){e.profilingCallback&&e.profilingCallback(a)})}},d.prototype._needsRenderOccluded=function(a){for(var b in this._mat2DataInstanced){var c=
this._mat2DataInstanced[b][0];if(c&&c.isRenderOccluded()&&c.beginSlot(a)&&c.isVisible())return!0}return!1},d.prototype._renderOccluded=function(a,b,e){if(b&&e&&e.getEnableState()){var d=this._needsRenderOccluded(q.OPAQUE_MATERIAL)||this._needsRenderOccluded(q.TRANSPARENT_MATERIAL);if(d!==b.getEnableState()&&b.setEnableState(d),d)d=this._renderContext,b.setupFBOs(a),b.prepareColorPass(),d.pass=c.MATERIAL,d.renderOccludedOnly=!0,this._renderInternalSlot(q.OPAQUE_MATERIAL,d),this._renderInternalSlot(q.TRANSPARENT_MATERIAL,
d),d.renderOccludedOnly=!1,b.finish(e.getFramebuffer()),b.apply()}},d.prototype._renderUnordered=function(a,b,e,d){var f=this._rctx;this._isRendering=!0;this._stats.reset();this._updateGlobalUniforms(a.projectionMatrix);this._renderContext.pass=c.MATERIAL;this._renderContext.camera=a;this._renderContext.shadowMap=b;this._renderContext.ssaoHelper=d.ssao;this._renderContext.offscreenRenderingHelper=d.offscreenRendering;this._renderContext.stencilRenderingHelper=this._stencilRenderingHelper;this._renderContext.depth=
this._linearDepthTextureHelper.getDepthFBO();this._renderContext.normals=this._normalTextureHelper.getNormalFBO();this._renderContext.highlight=this._highlightTextureHelper.getHighlightFBO();this._renderContext.options=this.renderOptions;this._renderContext.rctx=this._rctx;this._renderContext.lightingData=this._lighting.getOld();d.offscreenRendering.setEnableState(!0);d.offscreenRendering.initializeFrame(a);this._externalRenderers.render(q.BACKGROUND,this._renderContext);this.renderGeometrySlots(this._renderContext);
this._externalRenderers.render(q.POSTPROCESSING_ATMOSPHERE,this._renderContext);this._externalRenderers.render(q.POSTPROCESSING_EXTERNAL,this._renderContext);this.renderOptions.earlyOcclusionPixelDraw||(this._renderHUDVisibility(this._renderContext),this._renderInternalSlot(q.LINE_CALLOUTS,this._renderContext));this._renderOccluded(a,d.renderOccluded,d.offscreenRendering);b=this.renderOptions.antialiasing;"smaa"===b&&this._smaaPass.ensureEnabled()?(this._fxaaPass.disable(),this._smaaPass.render({colorTexture:d.offscreenRendering.getColorTexture()},
null)):"fxaa"===b&&this._fxaaPass.enable()?(this._smaaPass.disable(),this._fxaaPass.render({colorTexture:d.offscreenRendering.getColorTexture()},null)):(b=a.viewport,b=p.ortho(b[0],b[2],b[1],b[3],-1,1),d.offscreenRendering.drawQuad(b),this._fxaaPass.disable(),this._smaaPass.disable());f.bindFramebuffer(null);this._renderContext.framebufferTex=d.offscreenRendering.getColorTexture();this._renderInternalSlot(q.LINE_CALLOUTS_HUD_DEPTH,this._renderContext);this._renderInternalSlot(q.HUDMATERIAL1,this._renderContext);
this._renderInternalSlot(q.HUDMATERIAL2,this._renderContext);this._renderHighlights(a,e,d.highlight);this._isRendering=!1},d.prototype._renderGeometryPassOrderedHighlight=function(a){this._renderInternalHighlights(this._highlights)},d.prototype._renderGeometryPassOrderedMaterial=function(a){for(var b=null,c=0;c<this._renderOrder.length;c++){var e=this._renderOrder[c][1];if(e.instanced){var d=e.instanced||e.merged,f=d[a.pass];f&&f.isVisible()&&(this._renderInternalInstanced(d,f,this._bindParameters,
1/0),b=null)}e.merged&&(d=e.merged,(f=d[a.pass])&&f.isVisible()&&(e=f.getProgram(),e!==b&&(e.setUniformMatrix4fv("model",K),e.hasUniform("modelNormal")&&e.setUniformMatrix4fv("modelNormal",K)),b=e,this._renderInternalMerged(d,f,this._bindParameters,1/0)))}},d.prototype._renderGeometryPassOrdered=function(a){var b=a.camera;this._bindParameters.view=b.viewMatrix;this._bindParameters.proj=b.projectionMatrix;this._bindParameters.viewInvTransp=b.viewInverseTransposeMatrix;X[0]=b.near;X[1]=b.far;this._bindParameters.nearFar=
X;this._bindParameters.lightingData=this._lighting.getOld();this._bindParameters.viewport=b.fullViewport;this._bindParameters.framebufferTex=this._framebuffer.texture;this._bindParameters.pixelRatio=this._pixelRatio;this._bindParameters.instanceParameters=void 0;this._bindParameters.depthFBO=this._linearDepthTextureHelper.getDepthFBO();this._bindParameters.normalFBO=this._normalTextureHelper.getNormalFBO();a.isHighlightPass?this._renderGeometryPassOrderedHighlight(a):this._renderGeometryPassOrderedMaterial(a)},
d.prototype._renderOrdered=function(a,b){this._stats.reset();this.renderGeometryPass(a,b)},d.prototype.render=function(a,b,e){this._orderedRendering?this._renderOrdered(c.MATERIAL,a):this._renderUnordered(a,e.shadowMap,b,e)},d.prototype.renderAuxiliaryBuffers=function(a,b,e){var d=e.ssao;e=e.shadowMap;var f=this.ssaoEnabled||this._externalRenderers.needsLinearDepth();this._linearDepthTextureHelper.setEnableState(f);f&&(this._linearDepthTextureHelper.setupFBOs(a),this._linearDepthTextureHelper.prepareDepthPass(),
this.renderGeometryPass(c.MATERIAL_DEPTH,a,e,d),this._linearDepthTextureHelper.finish(b));this._normalTextureHelper.setEnableState(this.ssaoEnabled);this.ssaoEnabled&&(this._normalTextureHelper.setupFBOs(a),this._normalTextureHelper.prepareNormalPass(),this.renderGeometryPass(c.MATERIAL_NORMAL,a,e,d),this._normalTextureHelper.finish(b));this.ssaoEnabled&&d.computeSSAO(a,b,this._linearDepthTextureHelper.getDepthFBO(),this._normalTextureHelper.getNormalFBO());d.bindAll(this._programRep)},d.prototype.renderGeometryPass=
function(a,b,c,e){this._isRendering=!0;this._updateGlobalUniforms(b.projectionMatrix);this._renderContext.pass=a;this._renderContext.camera=b;this._renderContext.shadowMap=c;this._renderContext.ssaoHelper=e;this._renderContext.depth=this._linearDepthTextureHelper.getDepthFBO();this._renderContext.normals=this._normalTextureHelper.getNormalFBO();this._renderContext.rctx=this._rctx;this._orderedRendering?this._renderGeometryPassOrdered(this._renderContext):this._renderGeometryPassUnordered(this._renderContext);
this._isRendering=!1},d.prototype._renderGeometryPassUnordered=function(a){this.renderGeometrySlots(a)},d.prototype._renderInternalHighlights=function(a,b){void 0===b&&(b=null);for(var e=0;e<a.length;++e){var d=a[e],f=d.matData[c.MATERIAL_HIGHLIGHT];f&&(null===b||f.beginSlot(b))&&f.isVisible()&&this._renderInternalHighlight(d,this._bindParameters,c.MATERIAL_HIGHLIGHT)}},d.prototype._renderInternalSlotOccluded=function(a,b){for(var c in this._mat2DataInstanced){var e=this._mat2DataInstanced[c],d=e[b.pass];
d&&d.isRenderOccluded()&&d.beginSlot(a)&&d.isVisible()&&this._renderInternalInstanced(e,d,this._bindParameters,a)}},d.prototype._renderInternalSlotMaterial=function(a,b){for(var c in this._mat2DataInstanced){var e=this._mat2DataInstanced[c],d=e[b.pass];d&&d.beginSlot(a)&&d.isVisible()&&this._renderInternalInstanced(e,d,this._bindParameters,a)}for(var e=this._programRep.getProgramsUsingUniform("model"),d=this._programRep.getProgramsUsingUniform("modelNormal"),f=0;f<e.length;f++){var g=e[f];g.setUniformMatrix4fv("model",
K);-1<d.indexOf(g)&&g.setUniformMatrix4fv("modelNormal",K)}for(c in this._mat2DataMerged)e=this._mat2DataMerged[c],(d=e[b.pass])&&d.beginSlot(a)&&d.isVisible()&&this._renderInternalMerged(e,d,this._bindParameters,a);for(c in this._mat2DataPreinterleaved)e=this._mat2DataPreinterleaved[c],(d=e[b.pass])&&d.beginSlot(a)&&d.isVisible()&&this._renderInternalPreinterleaved(e,d,this._bindParameters,a);a===q.STENCIL_MATERIAL&&this._stencilRenderingHelper.finish()},d.prototype._renderInternalSlotHighlights=
function(a,b){this._renderInternalHighlights(this._highlights,a)},d.prototype._renderInternalSlot=function(a,b){this._bindParameters.view=b.camera.viewMatrix;this._bindParameters.proj=b.camera.projectionMatrix;this._bindParameters.viewInvTransp=b.camera.viewInverseTransposeMatrix;this._bindParameters.cameraAboveGround=b.camera.aboveGround;this._bindParameters.fovY=b.camera.fovY;this._bindParameters.poiDistance=b.camera.distance;X[0]=b.camera.near;X[1]=b.camera.far;var c=this._renderContext.offscreenRenderingHelper;
this._bindParameters.nearFar=X;this._bindParameters.lightingData=this._lighting.getOld();this._bindParameters.viewport=b.camera.fullViewport;this._bindParameters.framebufferTex=c?c.getColorTexture():null;this._bindParameters.shadowMap=b.shadowMap;this._bindParameters.shadowMappingEnabled=!!b.shadowMap&&b.shadowMap.getEnableState();this._bindParameters.ssaoEnabled=!!b.ssaoHelper&&b.ssaoHelper.getEnableState();this._bindParameters.pixelRatio=this._pixelRatio;this._bindParameters.instanceParameters=
void 0;this._bindParameters.depthFBO=this._linearDepthTextureHelper.getDepthFBO();this._bindParameters.hudVisibilityTexture=c?c.getHUDVisibilityTexture():null;b.isHighlightPass?this._renderInternalSlotHighlights(a,b):b.renderOccludedOnly?this._renderInternalSlotOccluded(a,b):this._renderInternalSlotMaterial(a,b)},d.prototype._renderInternalInstanced=function(a,b,c,e){var d=this._rctx,f=d.gl,g=!1,k=b.getDrawMode(d),h=this._bindParameters.extensions.angleInstancedArrays,l;for(l in a.origin2data){var n=
a.origin2data[l];c.origin=n.origin;e===q.STENCIL_MATERIAL&&(this._stencilRenderingHelper.setEnableState(!0),this._stencilRenderingHelper.prepareStencilWritePass());var p=!1;if(b.instanced)for(var m in n.perGeometryDataInfo){var r=n.perGeometryDataInfo[m];g||(b.bind(d,c),g=!0);d.bindVAO(r.vao);var t=b.getProgram();C.assertCompatibleVertexAttributeLocations(r.vao,t);p||(b.bindView(d,c),p=!0);var t=r.to-r.from,u=r.refCount;k===f.TRIANGLES&&(this._stats.trianglesRendered+=u*t/3);h.drawArraysInstancedANGLE(k,
r.from,t,u);this._stats.drawCallsAngleInstanced++;this._stats.instancesDrawnAngle+=u}else{var r=n.instances,w;for(w in r)t=r[w],(u=t.displayedIndexRange)&&0===u.length||(g||(b.bind(d,c),g=!0),p||(d.bindVAO(n.vao),b.bindView(d,c),p=!0),b.bindInstance(d,t),this._stats.drawCallsInstanced++,k===f.TRIANGLES&&(this._stats.trianglesRendered+=(t.to-t.from)/3),u?this._drawArraysFaceRange(u,t.from,k):d.drawArrays(k,t.from,t.to-t.from))}}d.bindVAO(null);g&&b.release(d,c)},d.prototype._renderInternalHighlight=
function(a,b,c){var e=this._rctx,d=e.gl;c=a.matData[c];var f=c.getDrawMode(e),g=a.instance,k=g.highlightedIndexRange,h=this._renderContext.offscreenRenderingHelper,h=(h?h.getDepthTexture():null)||this._getFallbackDepthTexture(),l=c.getProgram(),n=this._bindParameters.extensions.angleInstancedArrays;if(b.origin=a.originData.origin,c.instanced&&a.type===S.Instanced)for(a=a.instancedVAO,c.bind(e,b),e.bindVAO(a),C.assertCompatibleVertexAttributeLocations(a,l),c.bindView(e,b),a=0;a<k.length;a++){var p=
k[a],q=p.range?p.range[0]+g.from:g.from,p=p.range?p.range[1]-p.range[0]+1:g.to-g.from;e.bindTexture(h,5);l.setUniform1i("depthTex",5);l.setUniform4f("highlightViewportPixelSz",0,0,1/this._bindParameters.viewport[2],1/this._bindParameters.viewport[3]);n.drawArraysInstancedANGLE(f,q,p,1);f===d.TRIANGLES&&(this._stats.trianglesRendered+=1*p/3);this._stats.drawCallsHighlight++}else if(a.type===S.Instanced&&c.instanced)console.error("_renderInternalHighlight: incompatible instance type");else{switch(c.bind(e,
b),c.bindView(e,b),a.type){case S.Merged:n=a.originData;e.bindVAO(n.vao);l.setUniformMatrix4fv("model",K);break;case S.Instanced:n=a.originData;e.bindVAO(n.vao);c.bindInstance(e,g);break;case S.Preinterleaved:n=a.originData,a=n.instances[a.uniqueName].vao,e.bindVAO(a),c.bindInstance(e,g)}for(a=0;a<k.length;a++)p=k[a],q=p.range?p.range[0]+g.from:g.from,p=p.range?p.range[1]-p.range[0]+1:g.to-g.from,e.bindTexture(h,5),c.getProgram().setUniform1i("depthTex",5),l.setUniform4f("highlightViewportPixelSz",
0,0,1/this._bindParameters.viewport[2],1/this._bindParameters.viewport[3]),e.drawArrays(f,q,p),f===d.TRIANGLES&&(this._stats.trianglesRendered+=p/3),this._stats.drawCallsHighlight++}e.bindVAO(null);c.release(e,b)},d.prototype._drawArraysFaceRange=function(a,b,c){for(var e=this._rctx,d=0;d<a.length;d++){var f=a[d];e.drawArrays(c,f[0]+b,f[1]-f[0]+1)}this._stats.drawCallsFragmented+=a.length-1},d.prototype._renderInternalMerged=function(a,b,c,e){var d=this._rctx,f=d.gl,g=!1,k;for(k in a.origin2data){var h=
a.origin2data[k];if(c.origin=h.origin,e===q.STENCIL_MATERIAL&&(this._stencilRenderingHelper.setEnableState(!0),this._stencilRenderingHelper.prepareStencilWritePass()),!h.displayedIndexRange||0!==h.displayedIndexRange.length){g||(b.bind(d,c),g=!0);var l=b.getProgram();d.bindVAO(h.vao);C.assertCompatibleVertexAttributeLocations(h.vao,l);b.bindView(d,c);this._stats.drawCallsMerged++;l=b.getDrawMode(d);l===f.TRIANGLES&&(this._stats.trianglesRendered+=h.vao.vertexBuffers.geometry.size/3);h.displayedIndexRange?
this._drawArraysFaceRange(h.displayedIndexRange,0,l):d.drawArrays(l,0,C.vertexCount(h.vao,"geometry"))}}g&&b.release(d,c)},d.prototype._renderInternalPreinterleaved=function(a,b,c,e){var d=this._rctx,f=d.gl,g=!1,k=b.getDrawMode(d),h;for(h in a.origin2data){var l=a.origin2data[h];c.origin=l.origin;var n=!1;e===q.STENCIL_MATERIAL&&(this._stencilRenderingHelper.setEnableState(!0),this._stencilRenderingHelper.prepareStencilWritePass());for(var p in l.instances){var m=l.instances[p],r=m.instance,m=m.vao,
t=r.displayedIndexRange;if(!t||0!==t.length){g||(b.bind(d,c),g=!0);var u=b.getProgram();C.assertCompatibleVertexAttributeLocations(m,u);d.bindVAO(m);n||(b.bindView(d,c),n=!0);b.bindInstance(d,r);this._stats.drawCallsPreinterleaved++;k===f.TRIANGLES&&(this._stats.trianglesRendered+=(r.to-r.from)/3);t?this._drawArraysFaceRange(t,r.from,k):d.drawArrays(k,r.from,r.to-r.from)}}}d.bindVAO(null);g&&b.release(d,c)},d.prototype._updateGlobalUniforms=function(a){for(var b=this._programRep.getProgramsUsingUniform("proj"),
c=0;c<b.length;c++)b[c].setUniformMatrix4fv("proj",a);if(this._lighting){b=this._programRep.getProgramsUsingUniform("lightingMainDirection");for(c=0;c<b.length;c++)this._lighting.setUniforms(b[c]);b=this._programRep.getProgramsUsingUniform("lightDirection");for(c=0;c<b.length;c++)this._lighting.setUniforms(b[c])}},d.prototype.print=function(){var a=Object.keys(this._mat2DataMerged).length,b=Object.keys(this._mat2DataInstanced).length,c=Object.keys(this._mat2DataPreinterleaved).length;console.log("number of materials (merged/instanced/preinterleaved): "+
a+"/"+b+"/"+c);var e=0;T(this._mat2DataMerged,function(){},function(a,b){e+=Object.keys(b.instances).length});var d=0;T(this._mat2DataInstanced,function(){},function(a,b){d+=Object.keys(b.instances).length});var f=0;T(this._mat2DataPreinterleaved,function(){},function(a,b){f+=Object.keys(b.instances).length});console.log("number of instances (merged/instanced/preinterleaved): "+e+"/"+d+"/"+f)},d.prototype.isEmpty=function(){for(var a in this._mat2DataInstanced){var b=this._mat2DataInstanced[a],c;
for(c in b.origin2data)if(!Y(b.origin2data[c].instances))return!1}for(a in this._mat2DataMerged)for(c in b=this._mat2DataMerged[a],b.origin2data)if(!Y(b.origin2data[c].instances))return!1;for(a in this._mat2DataPreinterleaved)for(c in b=this._mat2DataPreinterleaved[a],b.origin2data)if(!Y(b.origin2data[c].instances))return!1;return!0},d.prototype.modify=function(a,b,c,e){this._isRendering&&console.warn("Renderer.modify called while rendering");var d=[],f=[],g=[];this._classifyRenderGeometry(a,d,f,
g);a=[];var k=[],h=[];this._classifyRenderGeometry(b,a,k,h);var l={};c&&this._performUpdates(c,l);c=[];this._modifyMerged(d,a,c,l);this._modifyInstanced(f,k,c);this._modifyPreinterleaved(g,h,c);this._updateMergedFaceranges(l);this._releaseMaterials(c);d=this._highlights.length;b&&0<b.length&&0<d&&(this._highlights=this._highlights.filter(function(a){return!b.some(function(b){return b.uniqueName===a.uniqueName})}),d!==this._highlights.length&&this.onHasHighlightsChanged&&this.onHasHighlightsChanged(this.hasHighlights));
this._updateHighlightVAOs();this._modifyMaterials(e);this._needsRender=!0},d.prototype._classifyRenderGeometry=function(a,b,c,e){for(var d=0;d<a.length;d++){var f=a[d];if(1<=O(f.data))switch(this._getType(f)){case S.Merged:b.push(f);break;case S.Instanced:c.push(f);break;case S.Preinterleaved:e.push(f)}}},d.prototype._performUpdates=function(a,b){for(var c=0;c<a.length;c++){var e=a[c],d=e.updateType,e=e.renderGeometry,f=this._getType(e)===S.Merged;if(1<=O(e.data)){if(2&d&&this._updateFaceranges(e,
b),32&d){var g=this._getInstance(e);g&&this._updateHighlightFaceranges(e,g.instance)}4&d||f&&16&d?this._updateVertexAttributes(e,!f):!f&&16&d?this._updateInstanceTransformation(e):8&d&&this._updateColorAttributes(e)}}},d.prototype._updateFaceranges=function(a,b){var c,e=a.material.getId(),d=a.origin.id,f=this._getType(a);if(f===S.Preinterleaved){var g=this._getOriginData(f,e,d);c=g.instances[a.uniqueName].instance}else g=this._getOriginData(f,e,d),(c=g.instances[a.uniqueName])&&f===S.Merged&&(b[this._modifiedMergedFacerangesKey(e,
d)]=g);c&&(c.displayedIndexRange=P(a),this._updateHighlightFaceranges(a,c))},d.prototype._updateHighlightFaceranges=function(a,b){if(b){var c=b.highlightedIndexRange,e;e=y.generateHighlightedIndexRanges(a.instanceParameters.componentVisibilities,a.instanceParameters.componentHighlights,a.componentOffsets);(b.highlightedIndexRange=e)&&!c?this._addHighlight(a):!e&&c&&this._removeHighlight(a)}},d.prototype._updateMergedFaceranges=function(a){for(var b in a){var c=a[b];c.displayedIndexRange=[];var e=
c.instances,d=!0,f;for(f in e){var g=e[f];g.displayedIndexRange?(c.displayedIndexRange.push.apply(c.displayedIndexRange,h.offsetIntervals(g.displayedIndexRange,g.from)),d=!1):c.displayedIndexRange.push([g.from,g.to-1])}d?c.displayedIndexRange=null:c.displayedIndexRange=h.mergeIntervals(c.displayedIndexRange)}},d.prototype._updateVertexAttributes=function(a,b){var c,e,d,f=a.material;c=f.getId();e=a.origin.id;var g=C.getStride(f.getVertexBufferLayout())/4;d=this._getType(a);if(d===S.Preinterleaved)d=
this._getOriginData(d,c,e),b=d.instances[a.uniqueName],c=b.instance,e=b.buffer,d=b.vao;else{d=this._getOriginData(d,c,e);c=d.instances[a.uniqueName];e=d.buffer.getArray();d=d.vao;var k=void 0,h=void 0;b||(Q(a,fa,ha),k=fa,h=ha);f.fillInterleaved(a.data,k,h,a.instanceParameters,e,c.from*g)}H(c.from+f.getOutputAmount(O(a.data))/g===c.to,"material VBO layout has changed");d.vertexBuffers.geometry.setSubData(e,c.from*g*4,c.from*g*4,c.to*g*4)},d.prototype._updateInstanceTransformation=function(a){var b=
this._getType(a),c=a.material.getId(),e=a.origin.id;if(b===S.Preinterleaved)b=this._getOriginData(b,c,e),e=b.instances[a.uniqueName].instance,Q(a,e.transformation,e.transformationNormal);else if(b=this._getOriginData(b,c,e),e=b.instances[a.uniqueName],b=b.perGeometryDataInfo[a.data.id],c=b.instanceBufferData,Q(a,e.transformation,e.transformationNormal),c)a=c.getSlot(a.idx),c.fill(a,0,e.transformation),c.fill(a,16,e.transformationNormal),a=4*c.getOffset(a),e=C.getStride(b.vao.layout.instance),b.vao.vertexBuffers.instance.setSubData(c.getArray(),
a,a,a+e)},d.prototype._updateColorAttributes=function(a){var b,c,e,d=a.material;b=d.getId();c=a.origin.id;var f=C.getStride(d.getVertexBufferLayout())/4;e=this._getType(a);if(e===S.Preinterleaved){e=this._getOriginData(e,b,c);var g=e.instances[a.uniqueName];b=g.instance;c=g.buffer;e=g.vao}else{e=this._getOriginData(e,b,c);b=e.instances[a.uniqueName];c=e.buffer.getArray();e=e.vao;var k=(g={},g[A.COLOR]=!0,g[A.SYMBOLCOLOR]=!0,g);d.fillInterleaved(a.data,void 0,void 0,a.instanceParameters,c,b.from*f,
k)}H(b.from+d.getOutputAmount(O(a.data))/f===b.to,"material VBO layout has changed");e.vertexBuffers.geometry.setSubData(c,b.from*f*4,b.from*f*4,b.to*f*4)},d.prototype._modifyMerged=function(a,c,e,d){var f=this._rctx,g=S.Merged;a=this._compMat2delta(a,c,g);c=this._mat2DataMerged;for(var k in a){var h=a[k],l;for(l in h){var n=h[l],q=n.optimalCount,m=n.material,r=m.getVertexBufferLayout(),t=C.getStride(r)/4,u=c[k];if(null==u){H(0<q);var v=m.getRenderPriority(),u=this._initializeMatData(m);c[k]=u;this._orderedRendering&&
this._insertIntoRenderOrder(u,v,"merged")}v=u.origin2data[l];if(null==v&&(H(0<q),v={type:g,instances:{},vao:new w(f,N.Default3D,{geometry:r},{geometry:z.createVertex(f,35044)}),buffer:new b(q),optimalCount:0,origin:n.origin},u.origin2data[l]=v),0<q){var r=v.buffer.getSize(),x=v.buffer.getArray(),u=q<n.sparseCount/2,y=v.buffer.resize(u?q:n.sparseCount),A=n.toRemove;if(u||y){for(var r=0,B=v.buffer.getArray(),u=0;u<A.length;++u)y=v.instances[A[u].uniqueName],v.optimalCount-=(y.to-y.from)*t,delete v.instances[A[u].uniqueName];
var u={},F;for(F in v.instances)y=v.instances[F],H(null==u[y.from]),u[y.from]=y;for(var G in u){var y=u[G],K=y.from*t,M=y.to*t;B.set(x.subarray(K,M),r);y.from=r/t;r+=M-K;y.to=r/t}H(r===v.optimalCount)}else for(u=0;u<A.length;++u)y=A[u].uniqueName,H(void 0!==v.instances[y]),K=v.instances[y].from*t,M=v.instances[y].to*t,v.buffer.erase(K,M),delete v.instances[y],v.optimalCount-=M-K;E(ba,-n.origin[0],-n.origin[1],-n.origin[2]);x=n.toAdd;n=!1;for(u=0;u<x.length;++u)A=x[u],K=A.data,p.multiply(ba,A.transformation,
fa),p.inverse(fa,ha),p.transpose(ha),y=r,m.fillInterleaved(K,fa,ha,A.instanceParameters,v.buffer.getArray(),r),K=m.getOutputAmount(O(K)),B=y+K,H(null==v.instances[A.uniqueName]),M=P(A),y=new V(A.name,y/t,B/t,M,void 0,void 0,A.idx),v.instances[A.uniqueName]=y,this._updateHighlightFaceranges(A,y),M&&(n=!0),v.optimalCount+=K,r+=K;H(v.optimalCount===q);q=new Float32Array(v.buffer.getArray().buffer,0,v.buffer.getSize());v.vao.vertexBuffers.geometry.setData(q);(n||v.displayedIndexRange)&&(d[this._modifiedMergedFacerangesKey(k,
l)]=v)}else H(0===q),v.vao.dispose(!0),v.vao=null,delete u.origin2data[l],0===Object.keys(u.origin2data).length&&(e.push(k),delete c[k],this._orderedRendering&&this._removeFromRenderOrder(u,"merged"))}}},d.prototype._modifyInstanced=function(a,e,d){var f=this._rctx,k=S.Instanced;a=this._compMat2delta(a,e,k);e=this._mat2DataInstanced;for(var h in a){var l=a[h],n;for(n in l){var q=l[n];if(0!==q.optimalCount){var m=q.material,r=e[h];if(null==r){var t=m.getRenderPriority(),r=this._initializeMatData(m);
e[h]=r;this._orderedRendering&&this._insertIntoRenderOrder(r,t,"instanced")}var u=m.getVertexBufferLayout(),v=r[c.MATERIAL].instanced?m.getInstanceBufferLayout():void 0,x=v&&C.findAttribute(v,"instanceColor"),y=v&&C.findAttribute(v,"instanceFeatureAttribute"),A=C.getStride(u)/4,t=r.origin2data[n];null==t&&(t={type:k,instances:{},vao:new w(f,N.Default3D,{geometry:u},{geometry:z.createVertex(f,35044)}),buffer:new b(q.optimalCount),optimalCount:0,perGeometryDataInfo:{},origin:q.origin},r.origin2data[n]=
t);var r=t.buffer.getSize(),B=t.buffer.getArray(),F=q.optimalCount<q.sparseCount/2,G=t.buffer.resize(F?q.optimalCount:q.sparseCount),K;for(K in q.perGeometryDelta){var M=t.perGeometryDataInfo[K];if(M&&M.instanceBufferData){var R=q.perGeometryDelta[K].removeCount;0<R&&M.instanceBufferData.prepareFree(R)}}var U=q.toRemove;if(F||G){for(F=0;F<U.length;++F){G=U[F];delete t.instances[G.uniqueName];K=G.data.id;var Q=M=t.perGeometryDataInfo[K];0===--Q.refCount&&null==q.dataId2refCount[K]?(t.optimalCount-=
(Q.to-Q.from)*A,delete t.perGeometryDataInfo[K]):M.instanceBufferData&&M.instanceBufferData.free(G.idx)}var r=0,F=t.buffer.getArray(),G={},X;for(X in t.perGeometryDataInfo)Q=t.perGeometryDataInfo[X],H(null==G[Q.from]),G[Q.from]=Q;for(var T in G)Q=G[T],R=Q.from*A,M=Q.to*A,F.set(B.subarray(R,M),r),Q.from=r/A,r+=M-R,Q.to=r/A;for(var Y in t.instances)R=t.instances[Y],R.from=t.perGeometryDataInfo[R.dataId].from,R.to=t.perGeometryDataInfo[R.dataId].to}else for(F=0;F<U.length;++F)G=U[F],delete t.instances[G.uniqueName],
K=G.data.id,M=t.perGeometryDataInfo[K],0===--M.refCount&&null==q.dataId2refCount[K]?(R=M.from*A,M=M.to*A,t.buffer.erase(R,M),t.optimalCount-=M-R,delete t.perGeometryDataInfo[K]):M.instanceBufferData&&M.instanceBufferData.free(G.idx);E(ba,-q.origin[0],-q.origin[1],-q.origin[2]);for(K in q.perGeometryDelta)(M=t.perGeometryDataInfo[K])&&M.instanceBufferData&&(F=q.perGeometryDelta[K].addCount,0<F&&M.instanceBufferData.prepareAllocate(F));B=q.toAdd;for(F=0;F<B.length;++F){G=B[F];R=G.data;K=R.id;M=t.perGeometryDataInfo[K];
if(null==M){m.fillInterleaved(R,void 0,void 0,void 0,t.buffer.getArray(),r);U=m.getOutputAmount(O(R));R=r/A;r+=U;M=r/A;if(t.optimalCount+=U,M={refCount:1,from:R,to:M,vao:null,instanceBufferData:null},v)R=C.getStride(v)/4,M.vao=new w(f,N.Default3D,{geometry:u,instance:v},{geometry:t.vao.vertexBuffers.geometry,instance:z.createVertex(f,35044)}),M.instanceBufferData=new g(R,q.perGeometryDelta[K].addCount);t.perGeometryDataInfo[K]=M}else++M.refCount;H(M.from*A<=t.buffer.getSize()&&M.to*A<=t.buffer.getSize());
R=p.create();p.multiply(ba,G.transformation,R);U=P(G);R=new V(G.name,M.from,M.to,U,R,G.instanceParameters,G.idx,K);t.instances[G.uniqueName]=R;this._updateHighlightFaceranges(G,R);if(M=M.instanceBufferData)U=M.allocate(G.idx),M.fill(U,0,R.transformation),M.fill(U,16,R.transformationNormal),x&&M.fill(U,x.offset/4,G.instanceParameters.color),y&&M.fill(U,y.offset/4,G.instanceParameters.featureAttribute)}H(t.optimalCount===q.optimalCount);m=new Float32Array(t.buffer.getArray().buffer,0,t.buffer.getSize());
t.vao.vertexBuffers.geometry.setData(m);for(K in t.perGeometryDataInfo)if(u=t.perGeometryDataInfo[K],u.vao&&(m=u.vao.vertexBuffers.instance))v=q.perGeometryDelta[K],0<v.addCount+v.removeCount&&(u=u.instanceBufferData.compact(),m.setData(u))}else q=e[h],q.origin2data[n].vao.dispose(!0),delete q.origin2data[n],0===Object.keys(q.origin2data).length&&(d.push(h),delete e[h],this._orderedRendering&&this._removeFromRenderOrder(q,"instanced"))}}},d.prototype._modifyPreinterleaved=function(a,b,c){for(var e=
this._rctx,d=S.Preinterleaved,f=this._mat2DataPreinterleaved,g=0;g<a.length;g++){var k=a[g],h=k.material,l=h.getId(),n=k.origin.id,q=k.origin.vec3,r=f[l];null==r&&(r=this._initializeMatData(h),f[l]=r);l=r.origin2data[n];null==l&&(l={type:d,origin:q,count:0,instances:{}},r.origin2data[n]=l);E(ba,-q[0],-q[1],-q[2]);r=p.create();p.multiply(ba,k.transformation,r);q=P(k);n=k.data;n.preinterleaved?(r=new V(k.name,0,n.indexCount,q,r,k.instanceParameters,k.idx,n.id),h=h.getVertexBufferLayout(),h=new w(e,
N.Default3D,{geometry:h},{geometry:z.createVertex(e,35044)}),h.vertexBuffers.geometry.setData(n.vertexData),l.count+=1,l.instances[k.uniqueName]={instance:r,vao:h,buffer:n.vertexData},this._updateHighlightFaceranges(k,r)):H(!1,"Non-interleaved render geometry processed as pre-interleaved")}for(a=0;a<b.length;a++)k=b[a],q=k.origin,h=k.material,l=h.getId(),n=q.id,k=k.uniqueName,r=f[l],e=r.origin2data[n],e.instances[k].vao.dispose(),delete e.instances[k],--e.count,0===e.count&&delete r.origin2data[n],
0===Object.keys(r.origin2data).length&&(c.push(l),delete f[l])},d.prototype._compMat2delta=function(a,b,c){var e={};return this._updateMat2delta(a,!0,c,e),this._updateMat2delta(b,!1,c,e),e},d.prototype._updateMat2delta=function(a,b,c,e){c=c===S.Instanced;for(var d=0;d<a.length;d++){var f=a[d],g=f.origin,k=f.material,h=k.getId(),l=c?this._mat2DataInstanced[h]:this._mat2DataMerged[h],l=l&&l.origin2data[g.id],n=e[h];null==n&&(n={},e[h]=n);h=n[g.id];if(null==h){if(h={optimalCount:null==l?0:l.optimalCount,
sparseCount:null==l?0:l.buffer.getSize(),material:k,toAdd:[],toRemove:[],perGeometryDelta:null,origin:g.vec3},c){var p={};if(void 0!==l)for(var q in l.perGeometryDataInfo)p[q]=l.perGeometryDataInfo[q].refCount;h.dataId2refCount=p;h.perGeometryDelta={}}n[g.id]=h}g=k.getOutputAmount(O(f.data));c?(k=f.data.id,(l=h.perGeometryDelta[k])||(l={addCount:0,removeCount:0},h.perGeometryDelta[k]=l),b?(l.addCount++,null==h.dataId2refCount[k]&&(h.dataId2refCount[k]=0),1===++h.dataId2refCount[k]&&(h.optimalCount+=
g,h.sparseCount+=g),h.toAdd.push(f)):(l.removeCount++,0===--h.dataId2refCount[k]&&(delete h.dataId2refCount[k],h.optimalCount-=g),h.toRemove.push(f))):b?(h.optimalCount+=g,h.sparseCount+=g,h.toAdd.push(f)):(h.optimalCount-=g,h.toRemove.push(f))}},d.prototype._getType=function(a){if(a.data.preinterleaved)return S.Preinterleaved;var b=!1,c=O(a.data);return b=b||!1===a.material.canBeMerged,b=b||a.material.instanced,b=b||a.material.isBackdrop,b=b||!0===a.material.isRenderOccluded(),a.singleUse||(b=b||
c>this._threshold),b?S.Instanced:S.Merged},d.prototype._getTargetMat2Data=function(a){switch(a){case S.Merged:return this._mat2DataMerged;case S.Instanced:return this._mat2DataInstanced;case S.Preinterleaved:return this._mat2DataPreinterleaved}},d.prototype._getOriginData=function(a,b,c){return this._getTargetMat2Data(a)[b].origin2data[c]},d.prototype._modifiedMergedFacerangesKey=function(a,b){return a+"_"+b},d.prototype._insertIntoRenderOrder=function(a,b,e){for(var d=a[c.MATERIAL].getMaterialId(),
f=this._renderOrder.length,g=0;f>g&&this._renderOrder[g][0]>=b;){var k=this._renderOrder[g][1];if(k.id===d)return H(!k[e],"matData for type already exists"),void(k[e]=a);g++}d={id:d,instanced:null,merged:null};d[e]=a;this._renderOrder.splice(g,0,[b,d])},d.prototype._removeFromRenderOrder=function(a,b){var e=a[c.MATERIAL].getMaterialId();for(a=0;this._renderOrder[a][1].id!==e;)a++;e=this._renderOrder[a][1];e[b]=null;e.instanced||e.merged||this._renderOrder.splice(a,1)},d.prototype._sortHighlightsByRenderOrder=
function(){this._highlights.sort(function(a,b){a=a.matData[c.MATERIAL].getRenderPriority();b=b.matData[c.MATERIAL].getRenderPriority();return a>b?-1:b>a?1:0})},d.prototype._updateRenderOrder=function(a,b){for(var e=b.length,d=0;e>d&&b[d][1].id!==a;)d++;if(e>d){a=b[d][1];a=(a.merged||a.instanced)[c.MATERIAL].getRenderPriority();var f=b[d][0];if(a!==b[d][0])for(b[d][0]=a,f=a>f?-1:1,d+=f;-1<d&&e>d&&f*b[d][0]>f*a;){var g=b[d];b[d]=b[d-f];b[d-f]=g;d+=f}}},d.prototype._modifyMaterials=function(a){for(var b in a)this._materialRep.updateMaterialParameters(b)},
d.prototype.modifyRenderOrder=function(a){if(this._orderedRendering){for(var b in a)this._updateRenderOrder(b,this._renderOrder);this._sortHighlightsByRenderOrder();this._needsRender=!0}},d.prototype._initializeMatData=function(a){var b={origin2data:{}};return b[c.MATERIAL]=this._materialRep.aquire(a),b[c.MATERIAL_DEPTH_SHADOWMAP]=this._materialRep.aquireDepthShadowMap(a),b[c.MATERIAL_NORMAL]=this._materialRep.aquireNormal(a),b[c.MATERIAL_DEPTH]=this._materialRep.aquireDepth(a),b[c.MATERIAL_HIGHLIGHT]=
this._materialRep.aquireHighlight(a),b},d.prototype._releaseMaterials=function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._materialRep.release(a[b]),this._materialRep.releaseDepthShadowMap(a[b]),this._materialRep.releaseNormal(a[b]),this._materialRep.releaseDepth(a[b]),this._materialRep.releaseHighlight(a[b]);else this._materialRep.release(a),this._materialRep.releaseDepthShadowMap(a),this._materialRep.releaseNormal(a),this._materialRep.releaseDepth(a),this._materialRep.releaseHighlight(a)},
d.prototype._getInstance=function(a){var b=a.uniqueName,c=a.material.getId(),e=this._getType(a),c=this._getTargetMat2Data(e)[c];if(!c)return null;a=c.origin2data[a.origin.id];if(!a)return null;var d;return d=a.type===S.Preinterleaved?a.instances[b].instance:a.instances[b],d?{type:e,uniqueName:b,instance:d,matData:c,originData:a,instancedVAO:null,instancedVAOBaseInstance:null}:null},d.prototype._createBaseInstanceVAO=function(a){var b=this._rctx,c=a.instance,e=a.originData;if(a.type===S.Instanced&&
e.perGeometryDataInfo){var e=e.perGeometryDataInfo[c.dataId],d=e.instanceBufferData;d&&(e=e.vao,c=d.getSlot(c.idx),a.instancedVAOBaseInstance!==c&&(d=C.setBaseInstanceOffset(e.layout,c),a.instancedVAO=new w(b,e.locations,d,e.vertexBuffers,e.indexBuffer),a.instancedVAOBaseInstance=c))}},d.prototype._updateHighlightVAOs=function(){for(var a=0;a<this._highlights.length;++a)this._createBaseInstanceVAO(this._highlights[a])},d.prototype._getFallbackDepthTexture=function(){return this._fallbackDepthStencilTexture||
(this._fallbackDepthStencilTexture=new n(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))),this._fallbackDepthStencilTexture},d}();var U=function(){function a(){this.reset()}return a.prototype.reset=function(){this.VBOusedSize=this.VBOoptimalSize=this.VBOallocatedSize=this.instancesDrawnAngle=this.drawCallsHighlight=this.drawCallsFragmented=this.drawCallsPreinterleaved=this.drawCallsMerged=this.drawCallsAngleInstanced=this.drawCallsInstanced=
this.trianglesRendered=0},a}(),V=function(){return function(a,b,c,e,d,f,g,k){this.name=a;this.from=b;this.to=c;this.displayedIndexRange=e;this.transformation=d;this.instanceParameters=f;this.idx=g;this.dataId=k;null!=d&&(this.transformationNormal=p.create(),p.set(d,this.transformationNormal),p.inverse(this.transformationNormal,this.transformationNormal),p.transpose(this.transformationNormal,this.transformationNormal))}}();!function(a){a[a.Merged=0]="Merged";a[a.Instanced=1]="Instanced";a[a.Preinterleaved=
2]="Preinterleaved"}(S||(S={}));var X=m.create(),ba=p.identity(),fa=p.create(),ha=p.create();return v})},"esri/views/3d/webgl-engine/lib/IntervalUtilities":function(){define(["require","exports"],function(m,l){return function(){function h(){}return h.copyIntervals=function(d){for(var b=[],g=0;g<d.length;g++){var k=d[g];b.push([k[0],k[1]])}return b},h.convertFaceToIndexRange=function(d,b){for(var g=0;g<d.length;g++){var k=d[g];k[0]*=b;k[1]=k[1]*b+(b-1)}},h.sortIntervals=function(d){return d.sort(function(b,
d){return b[0]===d[0]?b[1]>d[1]?1:b[1]<d[1]?-1:0:b[0]>d[0]?1:b[0]<d[0]?-1:0})},h.intersectIntervals=function(d,b){if(0>=d.length)return[];for(var g=[],k=0;k<d.length;k++){var f=d[k];f[1]<b[0]||f[0]>b[1]||(f=[f[0],f[1]],f[0]<b[0]&&(f[0]=b[0]),f[1]>b[1]&&(f[1]=b[1]),g.push(f))}return g},h.mergeIntervals=function(d){if(0>=d.length)return[];var b=[];d=this.sortIntervals(d);b.push(d[0]);for(var g=1;g<d.length;g++){var k=b[b.length-1];k[1]+1<d[g][0]?b.push(d[g]):k[1]<d[g][1]&&(k[1]=d[g][1],b.pop(),b.push(k))}return b},
h.invertIntervals=function(d,b){for(var g=[],k=0,f=0;f<d.length;f++){var a=d[f];a[0]>k&&g.push([k,a[0]-1]);k=a[1]+1}return b>=k&&g.push([k,b]),g},h.offsetIntervals=function(d,b){for(var g=[],k=0;k<d.length;k++){var f=d[k];g.push([f[0]+b,f[1]+b])}return g},h}()})},"esri/views/3d/webgl-engine/lib/Float32ArrayList":function(){define(["require","exports","./Util"],function(m,l,h){return function(){function d(b){null==b?b=16:65536>b&&(b=h.nextHighestPowerOfTwo(b));this.array=new Float32Array(b);this.size=
0}return d.prototype.resize=function(b,d){void 0===d&&(d=!1);this.size=b;var g;if(this.size>this.array.length){for(b=this.array.length||1;b<this.size;)b*=2;return g=new Float32Array(b),d&&g.set(this.array),this.array=g,!0}if(this.size<=this.array.length/2){b=this.array.length;for(var f=2*this.size;b>=f;)b=Math.floor(b/2);return g=new Float32Array(b),d&&g.set(this.array.subarray(0,b)),this.array=g,!0}return!1},d.prototype.append=function(b){var d=this.size;this.resize(this.size+b.length,!0);this.array.set(b,
d)},d.prototype.erase=function(b,d){for(;d>b;++b)this.array[b]=0},d.prototype.getArray=function(){return this.array},d.prototype.getSize=function(){return this.size},d}()})},"esri/views/3d/webgl-engine/lib/InstanceBufferData":function(){define(["require","exports","./Util"],function(m,l,h){return function(){function d(b,d){null==d&&(d=4);var g=h.nextHighestPowerOfTwo(d*b);this.array=new Float32Array(g);this.zeroItem=new Float32Array(b);this.endSlot=0;this.perInstanceDataSize=b;this.emptySlots=[];
this.emptySlotsIdx=0;this.id2slot={};this.slot2id=Array(d)}return d.prototype.prepareFree=function(b){this.emptySlots.length+=b},d.prototype.free=function(b){b=this.id2slot[b];null!=b&&(this.emptySlots[this.emptySlotsIdx++]=b,this.slot2id[b]=void 0)},d.prototype.prepareAllocate=function(b){b-=this.emptySlotsIdx;0<b&&this._resizeArray((this.endSlot+b)*this.perInstanceDataSize)},d.prototype.allocate=function(b){var d;return d=0<this.emptySlotsIdx?this.emptySlots[--this.emptySlotsIdx]:this.endSlot++,
this.id2slot[b]=d,this.slot2id[d]=b,d},d.prototype.getSlot=function(b){return this.id2slot[b]},d.prototype.getOffset=function(b){return b*this.perInstanceDataSize},d.prototype.getArray=function(){return this.array},d.prototype.fill=function(b,d,k){this.array.set(k,b*this.perInstanceDataSize+d)},d.prototype.compact=function(){if(0<this.emptySlotsIdx){this.emptySlots.length=this.emptySlotsIdx;for(this.emptySlots.sort(function(a,b){return a-b});0<this.emptySlotsIdx&&this.emptySlots[this.emptySlotsIdx-
1]===this.endSlot;)this.emptySlotsIdx--,this.endSlot--;for(;0<this.emptySlotsIdx;){this.emptySlotsIdx--;var b=this.endSlot-1,d=this.emptySlots[this.emptySlotsIdx],k=b*this.perInstanceDataSize,f=d*this.perInstanceDataSize;this.array.set(this.array.subarray(k,k+this.perInstanceDataSize),f);this.array.set(this.zeroItem,k);k=this.slot2id[b];this.slot2id[b]=void 0;this.slot2id[d]=k;this.id2slot[k]=d;this.endSlot--}}return this._resizeArray(this.endSlot*this.perInstanceDataSize),this.emptySlots.length=
0,this.array},d.prototype._resizeArray=function(b){var d;if(b>this.array.length){for(d=this.array.length||1;b>d;)d*=2;b=new Float32Array(d);b.set(this.array);this.array=b}else if(b<=this.array.length/2){d=this.array.length;for(b*=2;d>=b;)d/=2;b=new Float32Array(d);b.set(this.array.subarray(0,d));this.array=b}},d}()})},"esri/views/3d/webgl-engine/lighting/SceneLighting":function(){define(["require","exports","./SphericalHarmonics","../../lib/glMatrix"],function(m,l,h,d){Object.defineProperty(l,"__esModule",
{value:!0});var b=d.vec3d,g=d.vec4d,k=b.create();m=function(){function d(){this._renderLighting={main:{intensity:b.create(),direction:b.createFrom(1,0,0),castShadows:!1},sphericalHarmonics:{sh:{r:[0],g:[0],b:[0]}}};this._shOrder=2;this._oldDirection=b.create();this._oldSpecular=g.create();this._oldDiffuse=g.create();this._oldAmbient=g.create()}return d.prototype.setUniforms=function(a,b){(void 0===b&&(b=!1),b||a.getDefine("GROUND_NORMAL_SHADING"))?a.setUniform1f("lightingFixedFactor",(1-this._info.groundLightingFactor)*
(1-this._info.globalFactor)):a.setUniform1f("lightingFixedFactor",0);a.setUniform1f("lightingGlobalFactor",this._info.globalFactor);a.setUniform3fv("lightingMainDirection",this._renderLighting.main.direction);a.setUniform3fv("lightingMainIntensity",this._renderLighting.main.intensity);a.setUniform1f("ambientBoostFactor",.4);b=this._renderLighting.sphericalHarmonics.sh;0===this._shOrder?a.setUniform3f("lightingAmbientSH0",b.r[0],b.g[0],b.b[0]):1===this._shOrder?(a.setUniform4f("lightingAmbientSH_R",
b.r[0],b.r[1],b.r[2],b.r[3]),a.setUniform4f("lightingAmbientSH_G",b.g[0],b.g[1],b.g[2],b.g[3]),a.setUniform4f("lightingAmbientSH_B",b.b[0],b.b[1],b.b[2],b.b[3])):2===this._shOrder&&(a.setUniform3f("lightingAmbientSH0",b.r[0],b.g[0],b.b[0]),a.setUniform4f("lightingAmbientSH_R1",b.r[1],b.r[2],b.r[3],b.r[4]),a.setUniform4f("lightingAmbientSH_G1",b.g[1],b.g[2],b.g[3],b.g[4]),a.setUniform4f("lightingAmbientSH_B1",b.b[1],b.b[2],b.b[3],b.b[4]),a.setUniform4f("lightingAmbientSH_R2",b.r[5],b.r[6],b.r[7],b.r[8]),
a.setUniform4f("lightingAmbientSH_G2",b.g[5],b.g[6],b.g[7],b.g[8]),a.setUniform4f("lightingAmbientSH_B2",b.b[5],b.b[6],b.b[7],b.b[8]));a.setUniform3fv("lightDirection",this._oldDirection)},d.prototype.set=function(a){this._info=a;h.combineLights(a.lights,this._shOrder,this._renderLighting.main,this._renderLighting.sphericalHarmonics);b.negate(this._renderLighting.main.direction,this._oldDirection);a=1/Math.PI;this._oldAmbient[0]=.282095*this._renderLighting.sphericalHarmonics.sh.r[0]*a;this._oldAmbient[1]=
.282095*this._renderLighting.sphericalHarmonics.sh.g[0]*a;this._oldAmbient[2]=.282095*this._renderLighting.sphericalHarmonics.sh.b[0]*a;this._oldAmbient[3]=1;this._oldDiffuse[0]=this._renderLighting.main.intensity[0]*a;this._oldDiffuse[1]=this._renderLighting.main.intensity[1]*a;this._oldDiffuse[2]=this._renderLighting.main.intensity[2]*a;this._oldDiffuse[3]=1;a=b.set(this._oldDiffuse,k);b.scale(a,.4*this._info.globalFactor);b.add(this._oldAmbient,a)},Object.defineProperty(d.prototype,"globalFactor",
{get:function(){return this._info.globalFactor},enumerable:!0,configurable:!0}),d.prototype.getOld=function(){return{ambient:this._oldAmbient,diffuse:this._oldDiffuse,specular:this._oldSpecular,direction:this._oldDirection,helper:this}},d}();l.SceneLighting=m})},"esri/views/3d/webgl-engine/lighting/SphericalHarmonics":function(){define("require exports ./Lightsources ../lib/LongVectorMath ../../lib/glMatrix ../../support/mathUtils".split(" "),function(m,l,h,d,b,g){function k(a){return(a+1)*(a+1)}
function f(a){return g.clamp(Math.floor(Math.sqrt(a)-1),0,2)}function a(a,b,c){var e=a[0],d=a[1];a=a[2];c=c||[];return c.length=k(b),0<=b&&(c[0]=.28209479177),1<=b&&(c[1]=.4886025119*e,c[2]=.4886025119*a,c[3]=.4886025119*d),2<=b&&(c[4]=1.09254843059*e*d,c[5]=1.09254843059*d*a,c[6]=.31539156525*(3*a*a-1),c[7]=1.09254843059*e*a,c[8]=.54627421529*(e*e-d*d)),c}function e(a,b){a=k(a);b=b||{r:[],g:[],b:[]};b.r.length=b.g.length=b.b.length=a;for(var c=0;a>c;c++)b.r[c]=b.g[c]=b.b[c]=0;return b}function c(b,
c){for(var e=f(c.r.length),g=0;g<b.length;g++){var k=b[g];t.negate(k.direction,n);a(n,e,x);d.elementwiseProduct(x,w);d.scalarProduct(x,k.intensity[0],y);d.add(c.r,y);d.scalarProduct(x,k.intensity[1],y);d.add(c.g,y);d.scalarProduct(x,k.intensity[2],y);d.add(c.b,y)}return c}function q(b,c){a(n,0,x);for(var e=0;e<b.length;e++){var d=b[e];c.r[0]+=x[0]*w[0]*d.intensity[0]*4*Math.PI;c.g[0]+=x[0]*w[0]*d.intensity[1]*4*Math.PI;c.b[0]+=x[0]*w[0]*d.intensity[2]*4*Math.PI}return c}Object.defineProperty(l,"__esModule",
{value:!0});var t=b.vec3d;l.numberOfCoefficients=k;l.numberOfCoefficientsInBand=function(a){return 2*a+1};l.orderFromNumberOfCoefficients=f;l.computeCoefficients=a;l.initSHCoefficients=e;l.projectFillLights=c;l.projectAmbientLights=q;l.combineLights=function(a,b,f,g){e(b,g.sh);t.set3(0,0,0,f.intensity);var k=!1,l=r,n=u;b=v;l.length=0;n.length=0;for(var m=b.length=0;m<a.length;m++){var w=a[m];w instanceof h.MainLight&&!k?(t.set(w.direction,f.direction),f.intensity[0]=w.intensity[0],f.intensity[1]=
w.intensity[1],f.intensity[2]=w.intensity[2],f.castShadows=w.castShadows,k=!0):w instanceof h.MainLight||w instanceof h.FillLight?l.push(w):w instanceof h.AmbientLight?n.push(w):w instanceof h.SphericalHarmonicsLight&&b.push(w)}c(l,g.sh);q(n,g.sh);for(a=0;a<b.length;a++)w=b[a],d.add(g.sh.r,w.sh.r),d.add(g.sh.g,w.sh.g),d.add(g.sh.b,w.sh.b)};var r=[],u=[],v=[],x=[0],y=[0],n=t.create(),w=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398]})},"esri/views/3d/webgl-engine/lib/LongVectorMath":function(){define(["require",
"exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.dotProduct=function(h,d){for(var b=0,g=0;g<h.length;g++)b+=h[g]*d[g];return b};l.elementwiseProduct=function(h,d,b){b=b||h;b.length=h.length;for(var g=0;g<h.length;g++)b[g]=h[g]*d[g];return b};l.scalarProduct=function(h,d,b){b=b||h;b.length=h.length;for(var g=0;g<h.length;g++)b[g]=h[g]*d;return b};l.add=function(h,d,b){b=b||h;b.length=h.length;for(var g=0;g<h.length;g++)b[g]=h[g]+d[g];return b}})},"esri/views/3d/webgl-engine/lib/LinearDepthTextureHelper":function(){define(["require",
"exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(m,l,h,d,b){return function(){function b(b){this._rctx=b;this._depthFBO=void 0;this.height=this.width=this.viewportToRestore=null}return b.prototype.setEnableState=function(b){b!==this.getEnableState()&&(b?this.enable():this.disable())},b.prototype.getEnableState=function(){return void 0!==this._depthFBO},b.prototype.getDepthFBO=function(){return this._depthFBO},b.prototype.enable=function(){h.assert(!this.getEnableState());
this._depthFBO=d.createWithAttachments(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:3})},b.prototype.disable=function(){h.assert(this.getEnableState());this._depthFBO.dispose();this._depthFBO=void 0},b.prototype.setupFBOs=function(b){h.assert(this.getEnableState());this.viewportToRestore=b=b.fullViewport;this.width=b[2];this.height=b[3];this._rctx.setViewport(0,0,this.width,this.height)},b.prototype.prepareDepthPass=
function(){h.assert(this.getEnableState());var b=this._rctx,d=b.gl;this._depthFBO.resize(this.width,this.height);b.bindFramebuffer(this._depthFBO);b.setClearStencil(0);b.setClearColor(0,0,0,0);b.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT|d.STENCIL_BUFFER_BIT);b.setBlendingEnabled(!1)},b.prototype.finish=function(b){var d=this._rctx;d.bindFramebuffer(b);d.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])},b}()})},"esri/views/3d/webgl-engine/lib/NormalTextureHelper":function(){define(["require",
"exports","./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(m,l,h,d,b){return function(){function b(b){this.rctx=b;this.normalFBO=void 0;this.height=this.width=this.viewportToRestore=null}return b.prototype.setEnableState=function(b){b!==this.getEnableState()&&(b?this.enable():this.disable())},b.prototype.getEnableState=function(){return void 0!==this.normalFBO},b.prototype.getNormalFBO=function(){return this.normalFBO},b.prototype.enable=function(){h.assert(!this.getEnableState());
this.normalFBO=d.createWithAttachments(this.rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})},b.prototype.disable=function(){h.assert(this.getEnableState());this.normalFBO.dispose();this.normalFBO=void 0},b.prototype.setupFBOs=function(b){h.assert(this.getEnableState());this.viewportToRestore=b=b.viewport;this.width=b[2];this.height=b[3];this.rctx.setViewport(0,0,this.width,this.height)},b.prototype.prepareNormalPass=
function(){h.assert(this.getEnableState());var b=this.rctx,d=b.gl;this.normalFBO.resize(this.width,this.height);b.bindFramebuffer(this.normalFBO);b.setClearColor(0,0,0,0);b.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT)},b.prototype.finish=function(b){var d=this.rctx;d.bindFramebuffer(b);d.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])},b}()})},"esri/views/3d/webgl-engine/lib/HighlightTextureHelper":function(){define(["require","exports",
"./Util","../../../webgl/FramebufferObject","../../../webgl/enums"],function(m,l,h,d,b){return function(){function b(b){this._rctx=b;this.height=this.width=this.viewportToRestore=this.fbo2=this.fbo=null}return b.prototype.setEnableState=function(b){b!==this.getEnableState()&&(b?this.enable():this.disable())},b.prototype.getEnableState=function(){return null!==this.fbo},b.prototype.getHighlightFBO=function(){return this.fbo},b.prototype.getBlurFBO=function(){return this.fbo2},b.prototype.enable=function(){h.assert(!this.getEnableState());
this.fbo=d.createWithAttachments(this._rctx,{target:3553,pixelFormat:6408,dataType:32819,samplingMode:9729,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})},b.prototype.disable=function(){h.assert(this.getEnableState());this.fbo.dispose();this.fbo=null},b.prototype.setupFBOs=function(b){h.assert(this.getEnableState());this.viewportToRestore=b=b.fullViewport;this.width=b[2];this.height=b[3];this._rctx.setViewport(0,0,this.width,this.height)},b.prototype.prepareHighlightPass=function(){h.assert(this.getEnableState());
var b=this._rctx,d=b.gl;this.fbo.resize(this.width,this.height);b.bindFramebuffer(this.fbo);b.setClearColor(0,0,0,0);b.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT)},b.prototype.finish=function(b){var d=this._rctx;d.bindFramebuffer(b);d.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])},b}()})},"esri/views/3d/webgl-engine/lib/RenderContext":function(){define(["require","exports","./RenderSlot","./RenderPass"],function(m,l,h,d){return function(){function b(){this.normals=
this.lightingData=this.highlight=this.depth=this.camera=null;this.pass=d.MATERIAL;this.shadowMap=null;this.slot=h.BACKGROUND;this.options=this.rctx=this.framebufferTex=this.stencilRenderingHelper=this.offscreenRenderingHelper=this.ssaoHelper=null;this.renderOccludedOnly=!1}return Object.defineProperty(b.prototype,"isHighlightPass",{get:function(){return this.pass===d.MATERIAL_HIGHLIGHT},enumerable:!0,configurable:!0}),b}()})},"esri/views/3d/webgl-engine/lib/ExternalRendererContainer":function(){define(["require",
"exports","./RenderSlot"],function(m,l,h){return function(){function d(){this.renderersChanged=!1;this.renderers=[];this.slots=[];for(var b=0;b<h.MAX_SLOTS;++b)this.slots[b]=[]}return d.prototype.addRenderer=function(b,d){this.renderers.push(d);for(var g=0;g<b.length;++g)this.slots[b[g]].push(d);this.renderersChanged=!0},d.prototype.removeRenderer=function(b){this.renderers=this.renderers.filter(function(d){return d!==b});for(var d=0;d<this.slots.length;++d)this.slots[d]=this.slots[d].filter(function(d){return d!==
b});this.renderersChanged=!0},d.prototype.render=function(b,d){d.slot=b;var g=0;for(b=this.slots[b];g<b.length;g++){var f=b[g];f.render(d)&&(f.didRender=!0)}},d.prototype.needsRender=function(){if(this.renderersChanged)return!0;for(var b=0,d=this.renderers;b<d.length;b++)if(d[b].needsRender)return!0;return!1},d.prototype.needsHighlight=function(){for(var b=0,d=this.renderers;b<d.length;b++)if(d[b].needsHighlight)return!0;return!1},d.prototype.needsLinearDepth=function(){for(var b=0,d=this.renderers;b<
d.length;b++)if(d[b].needsLinearDepth)return!0;return!1},d.prototype.resetNeedsRender=function(){this.renderersChanged=!1;for(var b=0,d=this.renderers;b<d.length;b++){var k=d[b];k.resetNeedsRender?k.resetNeedsRender():k.didRender&&(k.needsRender=!1,k.didRender=!1)}},d}()})},"esri/views/3d/webgl-engine/lib/StencilRenderingHelper":function(){define(["require","exports","./Util","../../../webgl/enums"],function(m,l,h,d){return function(){function b(b){this._enabled=!1;this._rctx=b}return b.prototype.enable=
function(){this._enabled=!0;this._rctx.setStencilTestEnabled(!0)},b.prototype.disable=function(){this._enabled=!1;this._rctx.setStencilTestEnabled(!1)},b.prototype.getIsSupported=function(){return!!this._rctx.contextAttributes.stencil},b.prototype.setEnableState=function(b){b?this.enable():this.disable()},b.prototype.getEnableState=function(){return this._enabled},b.prototype.prepareStencilWritePass=function(){h.assert(this.getEnableState());var b=this._rctx;b.setStencilFunction(519,1,255);b.setStencilOp(7680,
7680,7681);b.setStencilWriteMask(255)},b.prototype.finish=function(){if(this.getEnableState()){var b=this._rctx;b.setStencilFunction(519,0,0);b.setStencilOp(7680,7680,7680)}},b.prototype.enableStencilRead=function(){this.getEnableState()&&this._rctx.setStencilFunction(517,1,255)},b.prototype.disableStencilRead=function(){this.getEnableState()&&this._rctx.setStencilFunction(519,0,0)},b}()})},"esri/views/3d/webgl-engine/lib/FxaaRenderPass":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/enums".split(" "),
function(m,l,h,d,b,g){return function(){function g(b){this.isEnabled=!1;this.vertexAttributeLocations={position:0};this.vertexBufferLayout=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];this.rctx=b}return g.prototype.enable=function(){if(!this.isEnabled){var f=this.rctx;this.program=new h(f,"\n      #version 100\n      precision highp float;\n\n      attribute vec2 position;\n\n      varying   vec2 fCoordinate;\n\n      void main() {\n        fCoordinate \x3d (position + 1.0 ) * 0.5;\n        gl_Position \x3d vec4(position, -1, 1);\n      }",
"\n      #version 100\n      #ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp float;\n      #else\n      precision mediump float;\n      #endif\n\n      /**\n       * @license\n       * Copyright (c) 2011 NVIDIA Corporation. All rights reserved.\n       *\n       * TO  THE MAXIMUM  EXTENT PERMITTED  BY APPLICABLE  LAW, THIS SOFTWARE  IS PROVIDED\n       * *AS IS*  AND NVIDIA AND  ITS SUPPLIERS DISCLAIM  ALL WARRANTIES,  EITHER  EXPRESS\n       * OR IMPLIED, INCLUDING, BUT NOT LIMITED  TO, NONINFRINGEMENT,IMPLIED WARRANTIES OF\n       * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO EVENT SHALL  NVIDIA\n       * OR ITS SUPPLIERS BE  LIABLE  FOR  ANY  DIRECT, SPECIAL,  INCIDENTAL,  INDIRECT,  OR\n       * CONSEQUENTIAL DAMAGES WHATSOEVER (INCLUDING, WITHOUT LIMITATION,  DAMAGES FOR LOSS\n       * OF BUSINESS PROFITS, BUSINESS INTERRUPTION, LOSS OF BUSINESS INFORMATION, OR ANY\n       * OTHER PECUNIARY LOSS) ARISING OUT OF THE  USE OF OR INABILITY  TO USE THIS SOFTWARE,\n       * EVEN IF NVIDIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.\n       */\n\n      #define FXAA_EDGE_THRESHOLD      (1.0/8.0)\n      #define FXAA_EDGE_THRESHOLD_MIN  (1.0/24.0)\n      #define FXAA_SEARCH_STEPS        16\n      #define FXAA_SEARCH_THRESHOLD    (1.0/4.0)\n      #define FXAA_SUBPIX_CAP          (3.0/4.0)\n      #define FXAA_SUBPIX_TRIM         (1.0/4.0)\n      #define FXAA_SUBPIX_TRIM_SCALE (1.0/(1.0 - FXAA_SUBPIX_TRIM))\n\n      uniform vec2 uRcpFrameDimension;\n      uniform sampler2D uColorTexture;\n      varying vec2 fCoordinate;\n\n      // Return the luma, the estimation of luminance from rgb inputs.\n      // This approximates luma using one FMA instruction,\n      // skipping normalization and tossing out blue.\n      // FxaaLuma() will range 0.0 to 2.963210702.\n      float FxaaLuma(vec3 rgb) {\n        return rgb.y * (0.587 / 0.299) + rgb.x;\n      }\n      vec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\n        return (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);\n      }\n      vec4 FxaaTexOff(sampler2D tex, vec2 pos, ivec2 off, vec2 rcpFrame) {\n        float x \x3d pos.x + float(off.x) * rcpFrame.x;\n        float y \x3d pos.y + float(off.y) * rcpFrame.y;\n        return texture2D(tex, vec2(x, y));\n      }\n\n      // pos is the output of FxaaVertexShader interpolated across screen.\n      // xy -\x3e actual texture position {0.0 to 1.0}\n      // rcpFrame should be a uniform equal to  {1.0/frameWidth, 1.0/frameHeight}\n      vec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame) {\n        vec3 rgbN \x3d FxaaTexOff(tex, pos.xy, ivec2( 0,-1), rcpFrame).xyz;\n        vec3 rgbW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1, 0), rcpFrame).xyz;\n        vec3 rgbM \x3d FxaaTexOff(tex, pos.xy, ivec2( 0, 0), rcpFrame).xyz;\n        vec3 rgbE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1, 0), rcpFrame).xyz;\n        vec3 rgbS \x3d FxaaTexOff(tex, pos.xy, ivec2( 0, 1), rcpFrame).xyz;\n        float lumaN \x3d FxaaLuma(rgbN);\n        float lumaW \x3d FxaaLuma(rgbW);\n        float lumaM \x3d FxaaLuma(rgbM);\n        float lumaE \x3d FxaaLuma(rgbE);\n        float lumaS \x3d FxaaLuma(rgbS);\n        float rangeMin \x3d min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\n        float rangeMax \x3d max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\n        float range \x3d rangeMax - rangeMin;\n        if (range \x3c max(FXAA_EDGE_THRESHOLD_MIN, rangeMax * FXAA_EDGE_THRESHOLD)) {\n          return rgbM;\n        }\n        vec3 rgbL \x3d rgbN + rgbW + rgbM + rgbE + rgbS;\n        float lumaL \x3d (lumaN + lumaW + lumaE + lumaS) * 0.25;\n        float rangeL \x3d abs(lumaL - lumaM);\n        float blendL \x3d max(0.0, (rangeL / range) - FXAA_SUBPIX_TRIM) * FXAA_SUBPIX_TRIM_SCALE;\n        blendL \x3d min(FXAA_SUBPIX_CAP, blendL);\n        vec3 rgbNW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1,-1), rcpFrame).xyz;\n        vec3 rgbNE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1,-1), rcpFrame).xyz;\n        vec3 rgbSW \x3d FxaaTexOff(tex, pos.xy, ivec2(-1, 1), rcpFrame).xyz;\n        vec3 rgbSE \x3d FxaaTexOff(tex, pos.xy, ivec2( 1, 1), rcpFrame).xyz;\n        rgbL +\x3d (rgbNW + rgbNE + rgbSW + rgbSE);\n        rgbL *\x3d vec3(1.0/9.0);\n        float lumaNW \x3d FxaaLuma(rgbNW);\n        float lumaNE \x3d FxaaLuma(rgbNE);\n        float lumaSW \x3d FxaaLuma(rgbSW);\n        float lumaSE \x3d FxaaLuma(rgbSE);\n        float edgeVert \x3d\n          abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\n          abs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\n          abs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\n        float edgeHorz \x3d\n          abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\n          abs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\n          abs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\n        bool horzSpan \x3d edgeHorz \x3e\x3d edgeVert;\n        float lengthSign \x3d horzSpan ? -rcpFrame.y : -rcpFrame.x;\n        if(!horzSpan) {\n          lumaN \x3d lumaW;\n          lumaS \x3d lumaE;\n        }\n        float gradientN \x3d abs(lumaN - lumaM);\n        float gradientS \x3d abs(lumaS - lumaM);\n        lumaN \x3d (lumaN + lumaM) * 0.5;\n        lumaS \x3d (lumaS + lumaM) * 0.5;\n        if (gradientN \x3c gradientS)\n        {\n          lumaN \x3d lumaS;\n          lumaN \x3d lumaS;\n          gradientN \x3d gradientS;\n          lengthSign *\x3d -1.0;\n        }\n        vec2 posN;\n        posN.x \x3d pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);\n        posN.y \x3d pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);\n        gradientN *\x3d FXAA_SEARCH_THRESHOLD;\n        vec2 posP \x3d posN;\n        vec2 offNP \x3d horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);\n        float lumaEndN \x3d lumaN;\n        float lumaEndP \x3d lumaN;\n        bool doneN \x3d false;\n        bool doneP \x3d false;\n        posN +\x3d offNP * vec2(-1.0, -1.0);\n        posP +\x3d offNP * vec2( 1.0,  1.0);\n        for(int i \x3d 0; i \x3c FXAA_SEARCH_STEPS; i++) {\n          if(!doneN) {\n            lumaEndN \x3d FxaaLuma(texture2D(tex, posN.xy).xyz);\n          }\n          if(!doneP) {\n            lumaEndP \x3d FxaaLuma(texture2D(tex, posP.xy).xyz);\n          }\n          doneN \x3d doneN || (abs(lumaEndN - lumaN) \x3e\x3d gradientN);\n          doneP \x3d doneP || (abs(lumaEndP - lumaN) \x3e\x3d gradientN);\n          if(doneN \x26\x26 doneP) { break; }\n          if(!doneN) {\n            posN -\x3d offNP;\n          }\n          if(!doneP) {\n            posP +\x3d offNP;\n          }\n        }\n        float dstN \x3d horzSpan ? pos.x - posN.x : pos.y - posN.y;\n        float dstP \x3d horzSpan ? posP.x - pos.x : posP.y - pos.y;\n        bool directionN \x3d dstN \x3c dstP;\n        lumaEndN \x3d directionN ? lumaEndN : lumaEndP;\n        if(((lumaM - lumaN) \x3c 0.0) \x3d\x3d ((lumaEndN - lumaN) \x3c 0.0)) {\n          lengthSign \x3d 0.0;\n        }\n        float spanLength \x3d (dstP + dstN);\n        dstN \x3d directionN ? dstN : dstP;\n        float subPixelOffset \x3d (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\n        vec3 rgbF \x3d texture2D(tex, vec2(\n          pos.x + (horzSpan ? 0.0 : subPixelOffset),\n          pos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\n        return FxaaLerp3(rgbL, rgbF, blendL);\n      }\n\n      void main() {\n        vec4 color;\n        vec2 screenCoord \x3d fCoordinate;\n        // if (screenCoord.x \x3c 0.5) {\n          color.rgb \x3d FxaaPixelShader(screenCoord, uColorTexture, uRcpFrameDimension);\n        // } else if (screenCoord.x \x3c 0.501 \x26\x26 screenCoord.x \x3e 0.499) {\n        //   color.rgb \x3d vec3(1,0,0);\n        // } else {\n        //   color \x3d texture2D(uColorTexture, fCoordinate);\n        // }\n        color.a \x3d 1.0;\n        gl_FragColor \x3d color;\n      }",
this.vertexAttributeLocations);var a=new Float32Array([-1,-1,3,-1,-1,3]);this.vao=new d(f,this.vertexAttributeLocations,{geometry:this.vertexBufferLayout},{geometry:new b(f,34962,35044,a)});this.isEnabled=!0}},g.prototype.disable=function(){this.isEnabled&&(this.program.dispose(),this.program=null,this.vao.dispose(),this.vao=null,this.isEnabled=!1)},g.prototype.render=function(b,a){this.enable();var e=this.rctx;e.bindVAO(this.vao);e.bindFramebuffer(a);var c=0,d=0;null!=a?(c=a.descriptor.width,d=a.descriptor.height):
(c=e.gl.canvas.width,d=e.gl.canvas.height);e.bindProgram(this.program);e.bindTexture(b.colorTexture,0);this.program.setUniform1i("uColorTexture",0);this.program.setUniform2f("uRcpFrameDimension",1/c,1/d);e.setFaceCullingEnabled(!1);e.drawArrays(4,0,3)},g}()})},"esri/views/3d/webgl-engine/lib/SmaaRenderPass":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/FramebufferObject ../../support/imageUtils ../../../webgl/enums".split(" "),
function(m,l,h,d,b,g,k,f,a){var e=null;return function(){function a(a){this.isEnabled=!1;this.vertexAttributeLocations={vPosition:0};this.vertexBufferLayout=[{name:"vPosition",count:2,type:5126,offset:0,stride:8,normalized:!1}];this.rctx=a}return a.prototype.ensureEnabled=function(){if(this.isEnabled)return!0;if(!e)return m(["./SmaaRenderPassData"],function(a){e=a}),!1;var a=this.rctx;this.programEdgeDetect=new h(a,e.edgeDetectShader.vertex,e.edgeDetectShader.fragment,this.vertexAttributeLocations);
this.programBlendWeights=new h(a,e.blendWeightShader.vertex,e.blendWeightShader.fragment,this.vertexAttributeLocations);this.programBlur=new h(a,e.blurShader.vertex,e.blurShader.fragment,this.vertexAttributeLocations);var c=new Float32Array([-1,-1,3,-1,-1,3]);return this.vao=new d(a,this.vertexAttributeLocations,{geometry:this.vertexBufferLayout},{geometry:new b(a,34962,35044,c)}),this.tmpFramebufferEdges=k.createWithAttachments(this.rctx,{target:3553,pixelFormat:6407,dataType:5121,samplingMode:9729,
wrapMode:33071,width:4,height:4},{colorTarget:0,depthStencilTarget:0}),this.tmpFramebufferBlend=k.createWithAttachments(this.rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:4,height:4},{colorTarget:0,depthStencilTarget:0}),this.textureArea=this.loadTextureFromBase64(e.areaTexture,9729,6407),this.textureSearch=this.loadTextureFromBase64(e.searchTexure,9728,6409),this.isEnabled=!0,!0},a.prototype.disable=function(){this.isEnabled&&(this.programEdgeDetect.dispose(),
this.programEdgeDetect=null,this.programBlendWeights.dispose(),this.programBlendWeights=null,this.programBlur.dispose(),this.programBlur=null,this.vao.dispose(),this.vao=null,this.textureArea.dispose(),this.textureArea=null,this.textureSearch.dispose(),this.textureSearch=null,this.tmpFramebufferBlend.dispose(),this.tmpFramebufferBlend=null,this.tmpFramebufferEdges.dispose(),this.tmpFramebufferEdges=null,this.isEnabled=!1)},a.prototype.render=function(a,b){this.ensureEnabled();var c=this.rctx,e=0,
d=0;null!=b?(e=b.descriptor.width,d=b.descriptor.height):(e=c.gl.canvas.width,d=c.gl.canvas.height);c.bindVAO(this.vao);c.setFaceCullingEnabled(!0);c.setCullFace(1029);c.setFrontFace(2305);c.setBlendingEnabled(!1);c.setDepthTestEnabled(!1);c.setViewport(0,0,e,d);this.tmpFramebufferEdges.resize(e,d);c.bindFramebuffer(this.tmpFramebufferEdges);c.setClearColor(0,0,0,1);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(this.programEdgeDetect);c.bindTexture(a.colorTexture,0);this.programEdgeDetect.setUniform1i("tColor",
0);this.programEdgeDetect.setUniform4f("uResolution",1/e,1/d,e,d);c.drawArrays(4,0,3);this.tmpFramebufferBlend.resize(e,d);c.bindFramebuffer(this.tmpFramebufferBlend);c.setClearColor(0,0,1,1);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(this.programBlendWeights);this.programBlendWeights.setUniform4f("uResolution",1/e,1/d,e,d);c.bindTexture(this.textureSearch,1);this.programBlendWeights.setUniform1i("tSearch",1);c.bindTexture(this.textureArea,2);this.programBlendWeights.setUniform1i("tArea",2);c.bindTexture(this.tmpFramebufferEdges.colorTexture,
3);this.programBlendWeights.setUniform1i("tEdges",3);c.drawArrays(4,0,3);c.bindFramebuffer(b);c.setClearColor(0,1,0,1);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(this.programBlur);this.programBlur.setUniform4f("uResolution",1/e,1/d,e,d);c.bindTexture(a.colorTexture,0);this.programBlur.setUniform1i("tColor",0);c.bindTexture(this.tmpFramebufferBlend.colorTexture,1);this.programBlur.setUniform1i("tBlendWeights",1);c.drawArrays(4,0,3);c.setDepthTestEnabled(!0)},a.prototype.loadTextureFromBase64=function(a,
b,c){var e=new g(this.rctx,{pixelFormat:c,dataType:5121,wrapMode:33071,samplingMode:b},null);return f.dataUriToImage(a).then(function(a){e.resize(a.width,a.height);e.setData(a)}),e},a}()})},"esri/views/3d/support/imageUtils":function(){define(["require","exports","dojo/Deferred","../../../core/urlUtils","../../../request"],function(m,l,h,d,b){function g(b){var d=!1,a=new Image,e=new h(function(){d=!0;a.src=""}),c=function(){d||e.reject()};return a.onload=function(){d||e.resolve(a)},a.onerror=c,a.onabort=
c,a.src=b,e.promise}Object.defineProperty(l,"__esModule",{value:!0});l.dataURItoBlob=function(b){var d=atob(b.split(",")[1]);b=b.split(",")[0].split(":")[1].split(";")[0];for(var a=new ArrayBuffer(d.length),e=new Uint8Array(a),c=0;c<d.length;c++)e[c]=d.charCodeAt(c);return new Blob([a],{type:b})};l.dataUriToImage=g;l.requestImage=function(k){return d.isDataProtocol(k)?g(k):b(k,{responseType:"image",allowImageDataAccess:!0}).then(function(b){return b.data})}})},"esri/views/webgl/Profiling":function(){define(["require",
"exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.startMeasurement=function(d){if(!d.extensions.disjointTimerQuery)return null;var b=new h;return b.start(d),b};var h=function(){function d(){}return d.prototype.start=function(b){this._rctx=b;b=b.extensions.disjointTimerQuery;this._query=b.createQueryEXT();b.beginQueryEXT(b.TIME_ELAPSED_EXT,this._query)},d.prototype.stop=function(b,d){void 0===d&&(d=50);this._cb=b;this._checkInterval=d;b=this._rctx.extensions.disjointTimerQuery;
b.endQueryEXT(b.TIME_ELAPSED_EXT);this._checkQueryResult()},d.prototype._checkQueryResult=function(){var b=this._rctx.extensions.disjointTimerQuery,d=b.getQueryObjectEXT(this._query,b.QUERY_RESULT_AVAILABLE_EXT),k=this._rctx.gl.getParameter(b.GPU_DISJOINT_EXT);return d&&!k?(b=b.getQueryObjectEXT(this._query,b.QUERY_RESULT_EXT),void this._cb(b/1E6)):k?void this._cb(null):void setTimeout(this._checkQueryResult.bind(this),this._checkInterval)},d}()})},"esri/views/3d/webgl-engine/materials/HUDMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/text!./HUDMaterial.xml ./internal/MaterialUtil ../lib/Util ../../../webgl/Util ./internal/MaterialBase ./internal/GLMaterialTextureBase ../lib/gl-matrix ../lib/RenderSlot ../lib/RenderPass ../lib/ShaderVariations ../lib/ComponentUtils ../../support/aaBoundingRect ../lib/screenSizePerspectiveUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){function x(a,b){void 0===b&&(b=R);if(a.textureIsSignedDistanceField){var c=a.anchorPos;a=a.distanceFieldBoundingBox;var e=b;e[0]=c[0]*(a[2]-a[0])+a[0];e[1]=c[1]*(a[3]-a[1])+a[1]}else y.set(a.anchorPos,b);return b}var y=e.vec2d,n=e.vec3d,w=e.mat3d,z=e.mat4d,C={"bottom-left":[0,0],bottom:[.5,0],"bottom-right":[1,0],left:[0,.5],center:[.5,.5],right:[1,.5],"top-left":[0,1],top:[.5,1],"top-right":[1,1]},B=[{name:"position",count:3,type:5126,offset:0,stride:76,
normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:76,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:76,normalized:!1},{name:"color",count:4,type:5121,offset:32,stride:76,normalized:!1},{name:"size",count:2,type:5126,offset:36,stride:76,normalized:!1},{name:"auxpos1",count:4,type:5126,offset:44,stride:76,normalized:!1},{name:"auxpos2",count:4,type:5126,offset:60,stride:76,normalized:!1}],F={texCoordScale:[1,1],occlusionTest:!0,binaryHighlightOcclusion:!0,drawInSecondSlot:!1,
color:[1,1,1,1],outlineColor:[1,1,1,1],outlineSize:0,textureIsSignedDistanceField:!1,distanceFieldBoundingBox:null,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],screenOffset:[0,0],verticalOffset:null,screenSizePerspective:null,screenSizePerspectiveAlignment:null,anchorPos:C.center,shaderPolygonOffset:1E-5,polygonOffset:!1,
textureId:null,centerOffsetUnits:"world",debugDrawBorder:!1};m=function(a){function c(c,e){e=a.call(this,e)||this;return e._textureDirty=!1,e.params=b.copyParameters(c,F),"string"==typeof e.params.anchorPos&&(e.params.anchorPos=C[e.params.anchorPos]),e}return h(c,a),c.prototype.dispose=function(){},c.prototype.getParameterValues=function(){var a=this.params;return{color:a.color,texCoordScale:a.texCoordScale,polygonOffset:a.polygonOffset,anchorPos:a.anchorPos,screenOffset:a.screenOffset,verticalOffset:a.verticalOffset,
screenSizePerspective:a.screenSizePerspective,screenSizePerspectiveAlignment:a.screenSizePerspectiveAlignment,shaderPolygonOffset:a.shaderPolygonOffset,textureIsSignedDistanceField:a.textureIsSignedDistanceField,outlineColor:a.outlineColor,outlineSize:a.outlineSize,distanceFieldBoundingBox:a.distanceFieldBoundingBox,vvSizeEnabled:a.vvSizeEnabled,vvSizeMinSize:a.vvSizeMinSize,vvSizeMaxSize:a.vvSizeMaxSize,vvSizeOffset:a.vvSizeOffset,vvSizeFactor:a.vvSizeFactor,vvColorEnabled:a.vvColorEnabled,vvColorValues:a.vvColorValues,
vvColorColors:a.vvColorColors,textureId:a.textureId,occlusionTest:a.occlusionTest,binaryHighlightOcclusion:a.binaryHighlightOcclusion,centerOffsetUnits:a.centerOffsetUnits,debugDrawBorder:a.debugDrawBorder,drawInSecondSlot:a.drawInSecondSlot}},c.prototype.setParameterValues=function(a){for(var b in a)"textureId"===b&&g.assert(!!this.params.textureId,"Can only change texture of material that already has a texture"),this.params[b]=a[b];this.notifyDirty("matChanged")},c.prototype.getParams=function(){return this.params},
c.prototype.getOutputAmount=function(a){return 114*a},c.prototype.getInstanceBufferLayout=function(){},c.prototype.getVertexBufferLayout=function(){return B},c.prototype.fillInterleaved=function(a,c,e,d,f,h){var l=4*h,n=a.indices[g.VertexAttrConstants.POSITION],p=a.vertexAttr[g.VertexAttrConstants.POSITION].data,q=h+k.findAttribute(B,g.VertexAttrConstants.POSITION).offset/4;for(d=0;d<n.length;++d){var m=3*n[d];b.fill(p,m,f,q,c,3);q+=19;b.fill(p,m,f,q,c,3);q+=19;b.fill(p,m,f,q,c,3);q+=19;b.fill(p,
m,f,q,c,3);q+=19;b.fill(p,m,f,q,c,3);q+=19;b.fill(p,m,f,q,c,3);q+=19}c=a.indices[g.VertexAttrConstants.NORMAL];p=a.vertexAttr[g.VertexAttrConstants.NORMAL].data;q=h+k.findAttribute(B,g.VertexAttrConstants.NORMAL).offset/4;for(d=0;d<c.length;++d)m=3*c[d],b.fill(p,m,f,q,e,3),q+=19,b.fill(p,m,f,q,e,3),q+=19,b.fill(p,m,f,q,e,3),q+=19,b.fill(p,m,f,q,e,3),q+=19,b.fill(p,m,f,q,e,3),q+=19,b.fill(p,m,f,q,e,3),q+=19;var r,t,u,w;d=a.vertexAttr[g.VertexAttrConstants.UV0].data;null==d||3>=d.length?(r=0,t=0,u=
this.params.texCoordScale[0],w=this.params.texCoordScale[1]):(r=a.vertexAttr[g.VertexAttrConstants.UV0].data[0],t=a.vertexAttr[g.VertexAttrConstants.UV0].data[1],u=a.vertexAttr[g.VertexAttrConstants.UV0].data[2],w=a.vertexAttr[g.VertexAttrConstants.UV0].data[3]);u=Math.min(1.99999,u+1);w=Math.min(1.99999,w+1);m=h+k.findAttribute(B,g.VertexAttrConstants.UV0).offset/4;for(d=0;d<n.length;++d)f[m]=r,f[m+1]=t,m+=19,f[m]=u,f[m+1]=t,m+=19,f[m]=u,f[m+1]=w,m+=19,f[m]=u,f[m+1]=w,m+=19,f[m]=r,f[m+1]=w,m+=19,
f[m]=r,f[m+1]=t,m+=19;r=a.indices[g.VertexAttrConstants.COLOR];t=a.vertexAttr[g.VertexAttrConstants.COLOR].data;l+=k.findAttribute(B,g.VertexAttrConstants.COLOR).offset;u=new Uint8Array(f.buffer);for(d=0;d<r.length;++d)m=4*r[d],b.fill(t,m,u,l,null,4),l+=76,b.fill(t,m,u,l,null,4),l+=76,b.fill(t,m,u,l,null,4),l+=76,b.fill(t,m,u,l,null,4),l+=76,b.fill(t,m,u,l,null,4),l+=76,b.fill(t,m,u,l,null,4),l+=76;m=a.indices[g.VertexAttrConstants.SIZE];l=a.vertexAttr[g.VertexAttrConstants.SIZE].data;r=h+k.findAttribute(B,
g.VertexAttrConstants.SIZE).offset/4;for(d=0;d<m.length;++d)t=l[2*m[d]],u=l[2*m[d]+1],f[r]=t,f[r+1]=u,r+=19,f[r]=t,f[r+1]=u,r+=19,f[r]=t,f[r+1]=u,r+=19,f[r]=t,f[r+1]=u,r+=19,f[r]=t,f[r+1]=u,r+=19,f[r]=t,f[r+1]=u,r+=19;if(null!=a.indices[g.VertexAttrConstants.AUXPOS1]&&null!=a.vertexAttr[g.VertexAttrConstants.AUXPOS1])for(l=a.indices[g.VertexAttrConstants.AUXPOS1],r=a.vertexAttr[g.VertexAttrConstants.AUXPOS1].data,t=h+k.findAttribute(B,"auxpos1").offset/4,d=0;d<l.length;++d)m=4*l[d],b.fill(r,m,f,t,
null,4),t+=19,b.fill(r,m,f,t,null,4),t+=19,b.fill(r,m,f,t,null,4),t+=19,b.fill(r,m,f,t,null,4),t+=19,b.fill(r,m,f,t,null,4),t+=19,b.fill(r,m,f,t,null,4),t+=19;if(null!=a.indices[g.VertexAttrConstants.AUXPOS2]&&null!=a.vertexAttr[g.VertexAttrConstants.AUXPOS2])for(l=a.indices[g.VertexAttrConstants.AUXPOS2],a=a.vertexAttr[g.VertexAttrConstants.AUXPOS2].data,h+=k.findAttribute(B,"auxpos2").offset/4,d=0;d<l.length;++d)m=4*l[d],b.fill(a,m,f,h,null,4),h+=19,b.fill(a,m,f,h,null,4),h+=19,b.fill(a,m,f,h,null,
4),h+=19,b.fill(a,m,f,h,null,4),h+=19,b.fill(a,m,f,h,null,4),h+=19,b.fill(a,m,f,h,null,4),h+=19},c.prototype.intersect=function(a,b,c,e,d,f,k,h){if(e.isSelection&&e.enableHUDSelection&&!r.isAllHidden(b.componentVisibilities,a.data.componentOffsets)){var l=a.getData();a=this.params;d=b=1;if(z.toMat3(c,H),h){d=h(E);b=d[0];d=d[5];h=H;f=h[0];var q=h[1],m=h[2],t=h[3],u=h[4],w=h[5],y=h[6],C=h[7],F=h[8],B=1/Math.sqrt(f*f+q*q+m*m),G=1/Math.sqrt(t*t+u*u+w*w),N=1/Math.sqrt(y*y+C*C+F*F);h[0]=f*B;h[1]=q*B;h[2]=
m*B;h[3]=t*G;h[4]=u*G;h[5]=w*G;h[6]=y*N;h[7]=C*N;h[8]=F*N}h=l.getVertexAttr()[g.VertexAttrConstants.POSITION];f=l.getVertexAttr()[g.VertexAttrConstants.SIZE];l=l.getVertexAttr()[g.VertexAttrConstants.NORMAL];g.assert(3<=h.size);q=e.point;m=e.camera;t=x(a);for(u=0;u<h.data.length/h.size;u++)if(w=u*h.size,n.set3(h.data[w],h.data[w+1],h.data[w+2],P),z.multiplyVec3(c,P,P),w=u*f.size,A[0]=f.data[w]*b,A[1]=f.data[w+1]*d,z.multiplyVec3(m.viewMatrix,P),w=u*l.size,n.set3(l.data[w],l.data[w+1],l.data[w+2],
Q),this.applyVerticalOffsetTransformation(P,Q,H,m,M),m.applyProjection(P,T),-1<T[0])w=Math.floor(T[0]),C=Math.floor(T[1]),v.applyPrecomputedScaleFactorVec2(A,M.factor,A),w=w-p-(0<t[0]?A[0]*t[0]:0),y=w+A[0]+2*p,C=C-p-(0<t[1]?A[1]*t[1]:0),F=C+A[1]+2*p,a.textureIsSignedDistanceField&&(B=a.outlineSize/2,G=a.distanceFieldBoundingBox,w+=A[0]*G[0],C+=A[1]*G[1],y-=A[0]*(1-G[2]),F-=A[1]*(1-G[3]),w-=B,y+=B,C-=B,F+=B),q[0]>w&&q[0]<y&&q[1]>C&&q[1]<F&&(y=e.p0,C=e.p1,z.multiplyVec3(z.inverse(m.viewMatrix,Y),P,
S),T[0]=q[0],T[1]=q[1],m.unprojectPoint(T,P),w=n.negate(e.getDirection(),n.create()),y=n.dist(y,P)/n.dist(y,C),k(y,w,-1,1,!0,S))}},c.prototype.normalAndViewAngle=function(a,b,c,e){return void 0===e&&(e=W),w.multiplyVec3(b,a,e.normal),z.multiplyVec3(c.viewInverseTransposeMatrix,e.normal),e.cosAngle=n.dot(O,K),e},c.prototype.updateScaleInfo=function(a,b,c){b=this.params;b.screenSizePerspective?a.factor=v.precomputeScaleFactor(W.cosAngle,c,b.screenSizePerspective,a.factor):(a.factor.scale=1,a.factor.factor=
0,a.factor.minPixelSize=0,a.factor.paddingPixels=0);b.screenSizePerspectiveAlignment?(a.scaleAlignment=v.precomputeScale(W.cosAngle,c,b.screenSizePerspectiveAlignment),a.minPixelSizeAlignment=b.screenSizePerspectiveAlignment.parameters.minPixelSize):(a.scaleAlignment=a.factor.scale,a.minPixelSizeAlignment=a.factor.minPixelSize)},c.prototype.applyVerticalOffsetTransformation=function(a,c,e,d,f,g){var h=this.params;if(16===e.length&&(e=z.toMat3(e,H)),!h.verticalOffset||!h.verticalOffset.screenLength)return f&&
(h.screenSizePerspective||h.screenSizePerspectiveAlignment)?(d=this.normalAndViewAngle(c,e,d),h=n.length(a),this.updateScaleInfo(f,d.cosAngle,h)):f&&(f.factor.scale=1,f.scaleAlignment=1),g?n.set(a,g):a;c=this.normalAndViewAngle(c,e,d);e=n.length(a);d=b.verticalOffsetAtDistance(d,e,h.verticalOffset,c.cosAngle,h.screenSizePerspectiveAlignment||h.screenSizePerspective);return f&&this.updateScaleInfo(f,c.cosAngle,e),n.add(a,n.scale(c.normal,d),g)},c.prototype.getGLMaterials=function(){return{color:G,
depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:N}},c.prototype.getAllTextureIds=function(){return[this.params.textureId]},c.prototype.setTextureDirty=function(){this._textureDirty=!0},c.prototype.calculateRelativeScreenBounds=function(a,b,c){void 0===c&&(c=u.create());var e=this.params,d=c;void 0===d&&(d=R);y.set(e.anchorPos,d);d[0]*=-a[0];d[1]*=-a[1];d[0]+=e.screenOffset[0]*b;d[1]+=e.screenOffset[1]*b;return c[2]=c[0]+a[0],c[3]=c[1]+a[1],c},c.prototype.calculateAnchorPosForRendering=
function(a){return x(this.params,a)},c.loadShaders=function(a,b,c,e){a._parse(d);var f=function(a){a.addDefine("OcclTest","OCCL_TEST");a.addDefine("SDF","SIGNED_DISTANCE_FIELD");a.addDefine("vvSize","VV_SIZE");a.addDefine("vvColor","VV_COLOR");a.addDefine("verticalOffset","VERTICAL_OFFSET");a.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");a.addDefine("centerOffsetUnitsScreen","CENTER_OFFSET_UNITS_SCREEN")},g=new t("hud",["vertexShaderHUD","fragmentShaderHUD"],null,c,b,a,e);f(g);g.addDefine("debugDrawBorder",
"DEBUG_DRAW_BORDER");c.addShaderVariations("hud-material-shader-variations",g);g=new t("hudHighlight",["vertexShaderHUD","fragmentShaderHUDHighlight"],null,c,b,a,e);f(g);g.addDefine("binaryHighlightOcclusion","BINARY_HIGHLIGHT_OCCLUSION");c.addShaderVariations("hud-material-highlight-shader-variations",g);a=new t("hudOcclusionTestPixel",["vertexShaderOcclusionTestPixel","fragmentShaderSimple"],null,c,b,a,e);a.addDefine("verticalOffset","VERTICAL_OFFSET");a.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");
a.addDefine("centerOffsetUnitsScreen","CENTER_OFFSET_UNITS_SCREEN");c.addShaderVariations("hud-material-occlusion-test-pixel-shader-variations",a)},c.shouldRenderVisibilityDuringRenderPass=function(a){return a===q.MATERIAL||q.MATERIAL_HIGHLIGHT},c}(f.MaterialBase);a=function(a){function e(c,e,d){d=a.call(this,c,c.getParams(),e,d)||this;return d.programRep=e,d.params=b.copyParameters(c.getParams()),d.selectProgram(),d.selectSlot(),d}return h(e,a),e.prototype.selectSlot=function(){this.mainSlot=this.params.drawInSecondSlot?
c.HUDMATERIAL2:c.HUDMATERIAL1},e.prototype.beginSlot=function(a){return a===this.mainSlot},e.prototype.getProgram=function(){return this.program},e.prototype.getAllPrograms=function(){return[this.program]},e.prototype.updateParameters=function(){var a=this.material.getParams(),b=this.params;b.color=a.color;b.texCoordScale=a.texCoordScale;b.polygonOffset=a.polygonOffset;b.anchorPos=a.anchorPos;b.screenOffset=a.screenOffset;b.verticalOffset=a.verticalOffset;b.screenSizePerspective=a.screenSizePerspective;
b.screenSizePerspectiveAlignment=a.screenSizePerspectiveAlignment;b.shaderPolygonOffset=a.shaderPolygonOffset;b.textureIsSignedDistanceField=a.textureIsSignedDistanceField;b.outlineColor=a.outlineColor;b.outlineSize=a.outlineSize;b.vvSizeEnabled=a.vvSizeEnabled;b.vvSizeMinSize=a.vvSizeMinSize;b.vvSizeMaxSize=a.vvSizeMaxSize;b.vvSizeOffset=a.vvSizeOffset;b.vvSizeFactor=a.vvSizeFactor;b.vvColorEnabled=a.vvColorEnabled;b.vvColorValues=a.vvColorValues;b.vvColorColors=a.vvColorColors;this.updateTexture(a.textureId);
this.selectProgram();this.selectSlot()},e.prototype.bindRender=function(a,b){var c=this.params,e=this.getProgram();this.bindTexture(a,e);e.setUniform1i("hudVisibilityTexture",1);a.bindTexture(b.hudVisibilityTexture,1);a.setActiveTexture(0);e.setUniform4fv("overrideColor",c.color);e.setUniform1f("pixelRatio",b.pixelRatio);c.textureIsSignedDistanceField&&(e.setUniform4fv("outlineColor",c.outlineColor),e.setUniform1f("outlineSize",c.outlineSize));c.vvSizeEnabled&&(e.setUniform3fv("vvSizeMinSize",c.vvSizeMinSize),
e.setUniform3fv("vvSizeMaxSize",c.vvSizeMaxSize),e.setUniform3fv("vvSizeOffset",c.vvSizeOffset),e.setUniform3fv("vvSizeFactor",c.vvSizeFactor));c.vvColorEnabled&&(e.setUniform1fv("vvColorValues",c.vvColorValues),e.setUniform4fv("vvColorColors",c.vvColorColors));e.setUniform2fv("texScale",c.texCoordScale);e.setUniform2f("screenOffset",2*c.screenOffset[0],2*c.screenOffset[1]);e.setUniform2fv("anchorPos",x(c));c.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setBlendingEnabled(!0);
a.setBlendFunction(1,771)},e.prototype.bindProjection=function(a,c){this.material._textureDirty&&(this.renderTexture(a),this.material._textureDirty=!1);var e=c.cameraAboveGround?1:-1,d=this.getProgram(),f=this.params;a.bindProgram(d);d.setUniform1f("cameraGroundRelative",e);d.setUniform1f("polygonOffset",f.shaderPolygonOffset);d.setUniform4fv("viewport",c.viewport);b.bindVerticalOffset(f.verticalOffset,c,d);d.setUniformMatrix4fv("viewNormal",c.viewInvTransp);f.screenSizePerspective&&(b.bindScreenSizePerspective(f.screenSizePerspective,
d,"screenSizePerspective"),b.bindScreenSizePerspective(f.screenSizePerspectiveAlignment||f.screenSizePerspective,d,"screenSizePerspectiveAlignment"))},e.prototype.releaseRender=function(a){a.setPolygonOffsetFillEnabled(!1);a.setBlendFunction(770,771);a.setBlendingEnabled(!1)},e.prototype.bindView=function(a,c){a=c.origin;var e=this.getProgram();b.bindView(a,c.view,e);b.bindCamPos(a,c.viewInvTransp,e)},e.prototype.bindInstance=function(a,b){a=this.getProgram();a.setUniformMatrix4fv("model",b.transformation);
a.setUniformMatrix4fv("modelNormal",b.transformationNormal)},e.prototype.getDrawMode=function(a){return a.gl.TRIANGLES},e}(a.GLMaterialTextureBase);var G=function(a){function b(b,c,e){b=a.call(this,b,c,e)||this;return b.isOcclusionSlot=!1,b}return h(b,a),b.prototype.selectProgram=function(){var a=this.params;this.programOcclusionTestPixel=this.programRep.getShaderVariationsProgram("hud-material-occlusion-test-pixel-shader-variations",[!!a.verticalOffset,!!a.screenSizePerspective,"screen"===a.centerOffsetUnits]);
this.program=this.programRep.getShaderVariationsProgram("hud-material-shader-variations",[a.occlusionTest,a.textureIsSignedDistanceField,!!a.vvSizeEnabled,!!a.vvColorEnabled,!!a.verticalOffset,!!a.screenSizePerspective,"screen"===a.centerOffsetUnits,!!a.debugDrawBorder])},b.prototype.getDrawMode=function(a){a=a.gl;return this.isOcclusionSlot?a.POINTS:a.TRIANGLES},b.prototype.release=function(a){a.setDepthFunction(a.gl.LESS);this.isOcclusionSlot||this.releaseRender(a)},b.prototype.bind=function(a,
b){var c=a.gl;this.bindProjection(a,b);var e=this.getProgram();a.setDepthFunction(c.LEQUAL);this.isOcclusionSlot?e.setUniform4f("color",1,1,1,1):(this.bindRender(a,b),this.bindTexture(a,e))},b.prototype.getProgram=function(){return this.isOcclusionSlot?this.programOcclusionTestPixel:this.program},b.prototype.getAllPrograms=function(){return[this.programOcclusionTestPixel,this.program]},b.prototype.beginSlot=function(a){return this.params.occlusionTest?(this.isOcclusionSlot=a===c.OCCLUSION_PIXELS,
a===c.OCCLUSION_PIXELS||a===this.mainSlot):(this.isOcclusionSlot=!1,a===this.mainSlot)},b}(a),N=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h(b,a),b.prototype.selectProgram=function(){var a=this.params;this.program=this.programRep.getShaderVariationsProgram("hud-material-highlight-shader-variations",[a.occlusionTest,a.textureIsSignedDistanceField,!!a.vvSizeEnabled,!!a.vvColorEnabled,!!a.verticalOffset,!!a.screenSizePerspective,"screen"===a.centerOffsetUnits,a.binaryHighlightOcclusion])},
b.prototype.bind=function(a,b){this.bindProjection(a,b);this.bindRender(a,b)},b.prototype.release=function(a){this.releaseRender(a)},b}(a),M={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},scaleAlignment:0,minPixelSizeAlignment:0},R=[0,0],P=n.create(),Q=n.create(),T=n.create(),O=n.create(),S=n.create(),H=w.create(),Y=z.create(),W={normal:O,cosAngle:0},E=z.create();z.identity(E);var p=1,A=[0,0],K=[0,0,1];return m})},"esri/views/3d/webgl-engine/materials/internal/MaterialBase":function(){define(["require",
"exports","./MaterialUtil","../../lib/ModelContentType"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function b(b){this.visible=!0;this.renderOccluded=!1;this.renderPriority=0;this.parentStage=null;this.id=h.__Material_idGen.gen(b)}return b.prototype.getId=function(){return this.id},b.prototype.getParentStage=function(){return this.parentStage},b.prototype.addParentStage=function(b){this.parentStage=b},b.prototype.removeParentStage=function(b){this.parentStage=
null},b.prototype.setVisible=function(b){this.visible!==b&&(this.visible=b,this.notifyDirty("matChanged"))},b.prototype.isVisible=function(){return this.visible},b.prototype.setRenderOccluded=function(b){this.renderOccluded!==b&&(this.renderOccluded=b,this.notifyDirty("matChanged"))},b.prototype.isRenderOccluded=function(){return this.renderOccluded},b.prototype.notifyDirty=function(b){this.parentStage&&this.parentStage.notifyDirty(d.MATERIAL,this,b)},b.prototype.setRenderPriority=function(b){this.renderPriority=
b;this.notifyDirty("matChanged")},b.prototype.getRenderPriority=function(){return this.renderPriority},b}();l.MaterialBase=m;l["default"]=m})},"esri/views/3d/webgl-engine/materials/internal/GLMaterialTextureBase":function(){define(["require","exports","../../../../../core/tsSupport/extendsHelper","./GLMaterialBase","./MaterialUtil"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(d){function g(f,a,e,c,g){void 0===g&&(g=!1);f=d.call(this,f,e,c)||this;return f.params=
a,f.textureRep=c,f.initTransparent=g,f.glTextureRef=b.aquireIfNotUndefined(a.textureId,a.initTexture,c,g),f}return h(g,d),g.prototype.updateTexture=function(d){var a=this.params;a.textureId!==d&&(b.releaseIfNotUndefined(a.textureId,this.textureRep),a.textureId=d,this.glTextureRef=b.aquireIfNotUndefined(a.textureId,a.initTexture,this.textureRep,this.initTransparent))},g.prototype.renderTexture=function(b){(b=this.textureRep.getTexture(this.params.textureId))&&b.dirty&&b.redraw&&b.redraw()},g.prototype.bindTexture=
function(b,a){null!=this.glTextureRef&&(a.setUniform1i("tex",0),b.bindTexture(this.glTextureRef.getGLTexture()))},g.prototype.bindTextureSize=function(b,a){null!=this.glTextureRef&&(b=this.glTextureRef.getGLTexture(),a.setUniform2f("texSize",b.descriptor.width,b.descriptor.height))},g.prototype.dispose=function(){b.releaseIfNotUndefined(this.params.textureId,this.textureRep)},g}(d["default"]);l.GLMaterialTextureBase=m;l["default"]=m})},"esri/views/3d/webgl-engine/materials/internal/GLMaterialBase":function(){define(["require",
"exports","./MaterialUtil"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function d(b,d,k){this.id=h.__GLMaterial_id++;this.material=b}return d.prototype.getId=function(){return this.id},d.prototype.getMaterialId=function(){return this.material.getId()},d.prototype.isVisible=function(){return this.material.isVisible()},d.prototype.isRenderOccluded=function(){return this.material.isRenderOccluded()},d.prototype.getRenderPriority=function(){return this.material.getRenderPriority()},
d}();l.GLMaterialBase=m;l["default"]=m})},"esri/views/3d/webgl-engine/lib/ShaderVariations":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang ./Util ../../../webgl/Program ./DefaultVertexAttributeLocations".split(" "),function(m,l,h,d,b,g,k){return function(){function f(a,e,c,d,f,g,h){this.variables=[];this.sealed=!1;this.programCache={};b.assert(2===e.length,"you must specify shader snippet prefixes for vertex and fragment shaders");this.programNamePrefix=
a;this.shaderSnippetPrefixes=e;this.baseDefines=c;this.programRep=d;this.snippets=g;this.rctx=h;this.baseDefines=c?c.slice():[]}return f.prototype.addDefine=function(a,e,c,d){b.assert(!this.sealed,"you cannot add another variable after the first program has been generated");b.assert(!!a,"you must specify a program name suffix");this.variables.push({programNameSuffixes:["",a],shaderNameSuffixes:d||a,defineStr:e,affectsShaderTypes:c||[!0,!0]})},f.prototype.addBinaryShaderSnippetSuffix=function(a,e,
c){b.assert(!this.sealed,"you cannot add another variable after the first program has been generated");b.assert(!!a,"you must specify a program name suffix");this.variables.push({programNameSuffixes:["",a],shaderSnippetSuffixes:["",e],affectsShaderTypes:c||[!0,!0]})},f.prototype.addNaryShaderSnippetSuffix=function(a,e){b.assert(!this.sealed,"you cannot add another variable after the first program has been generated");var c=a.map(function(a){return b.assert(null!=a.value,"value must always be specified"),
a.value});this.variables.push({values:c,programNameSuffixes:a.map(function(a,b){return null!=a.programNameSuffix?a.programNameSuffix:c[b]}),shaderSnippetSuffixes:a.map(function(a,b){return null!=a.shaderSnippetSuffix?a.shaderSnippetSuffix:c[b]}),affectsShaderTypes:e||[!0,!0]})},f.prototype.getShaderVariation=function(a){b.assert(a.length===this.variables.length,"you must specify a value for each variable");for(var e=this.programNamePrefix,c=d.clone(this.shaderSnippetPrefixes),f=d.clone(this.shaderSnippetPrefixes),
g=d.clone(this.baseDefines),h=0;h<this.variables.length;h++){var k=this.variables[h],l=a[h],m=void 0;k.values?(m=k.values.indexOf(l.toString()),b.assert(0<=m,"invalid value "+l+" for variable "+h)):m=l?1:0;e+=k.programNameSuffixes[m];for(l=0;2>l;l++)k.affectsShaderTypes[l]&&(k.shaderSnippetSuffixes&&(c[l]+=k.shaderSnippetSuffixes[m],f[l]+=k.shaderSnippetSuffixes[m]),k.defineStr&&m&&(g.push(k.defineStr),f[l]+=k.shaderNameSuffixes))}return{programName:e,shaderSnippetNames:c,shaderNames:f,defines:g}},
f.prototype.getProgram=function(a,e,c){void 0===e&&(e=this.snippets);void 0===c&&(c=this.rctx);this.sealed=!0;var d=a.reduce(function(a,b){return a+b.toString()},"");if(this.programCache[d])return this.programCache[d];a=this.getShaderVariation(a);var f=this.programRep.get(a.programName);if(f)return f;var h=a.shaderSnippetNames[0],l=e[h];b.assert(null!=l,"shader snippet '"+h+"' does not exist");h=a.shaderSnippetNames[1];e=e[h];return b.assert(null!=e,"shader snippet '"+h+"' does not exist"),f=new g(c,
l,e,k.Default3D,a.defines),this.programCache[d]=f,this.programRep.add(a.programName,f),f},f}()})},"esri/views/3d/webgl-engine/materials/internal/TexOnlyGLMaterial":function(){define("require exports dojo/text!./TexOnlyGLMaterial.xml ./MaterialUtil ../../lib/RenderSlot ../../lib/gl-matrix ../../../../webgl/Program ../../../../webgl/enums ../../lib/DefaultVertexAttributeLocations".split(" "),function(m,l,h,d,b,g,k,f,a){var e=g.vec4d.createFrom(1,1,1,1);return function(){function c(a,b,c,e,f){this.id=
d.__GLMaterial_id++;this.program=a.get("texOnly");this.color=c;this.depthFunc=f;this.blend=e;this.texGLName=b}return c.prototype.getId=function(){return this.id},c.prototype.beginSlot=function(a){return a===b.INTERNAL_MATERIAL},c.prototype.getProgram=function(){return this.program},c.prototype.setColor=function(a){this.color=a},c.prototype.bind=function(a,b){a.bindProgram(this.program);this.program.setUniformMatrix4fv("model",d.IDENTITY);this.program.setUniformMatrix4fv("proj",b.proj);this.program.setUniform4fv("color",
void 0!==this.color?this.color:e);this.program.setUniform1i("tex",0);a.bindTexture(this.texGLName,0);this.blend&&(a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA));a.setDepthTestEnabled(!0);void 0!==this.depthFunc&&a.setDepthFunction(this.depthFunc)},c.prototype.release=function(a){void 0!==this.depthFunc&&a.setDepthFunction(513);this.blend&&a.setBlendingEnabled(!1)},c.prototype.bindView=function(a,b){d.bindView(b.origin,
b.view,this.program)},c.prototype.bindInstance=function(a,b){this.program.setUniformMatrix4fv("model",b.transformation)},c.prototype.getDrawMode=function(a){return a.gl.TRIANGLES},c.loadShaders=function(b,c,e,d){b._parse(h);b=new k(d,b.vertexShaderTexOnly,b.fragmentShaderTexOnly,a.Default3D);e.add("texOnly",b)},c}()})},"esri/views/3d/support/debugFlags":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),
function(m,l,h,d,b,g){return new (function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;return a.SCENEVIEW_HITTEST_RETURN_SELECTOR=!1,a.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1,a.HIGHLIGHTS_VISUALIZE_BLOCKS=!1,a.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1,a.DECONFLICTOR_SHOW_OUTLINES=!1,a.DECONFLICTOR_SHOW_GRID=!1,a.LABELS_SHOW_BORDER=!1,a.OVERLAY_DRAW_TEST_TEXTURE=!1,a.OVERLAY_SHOW_CENTER=!1,a.TESTS_DISABLE_UPDATE_THROTTLE_THRESHOLDS=!1,a.DISABLE_POI_UPDATE_ON_SURFACE_GEOMETRY_CHANGES=!1,a.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=
!1,a}return h(f,g),d([b.property()],f.prototype,"SCENEVIEW_HITTEST_RETURN_SELECTOR",void 0),d([b.property()],f.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0),d([b.property()],f.prototype,"HIGHLIGHTS_VISUALIZE_BLOCKS",void 0),d([b.property()],f.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0),d([b.property()],f.prototype,"DECONFLICTOR_SHOW_OUTLINES",void 0),d([b.property()],f.prototype,"DECONFLICTOR_SHOW_GRID",void 0),d([b.property()],f.prototype,"LABELS_SHOW_BORDER",void 0),d([b.property()],
f.prototype,"OVERLAY_DRAW_TEST_TEXTURE",void 0),d([b.property()],f.prototype,"OVERLAY_SHOW_CENTER",void 0),d([b.property()],f.prototype,"TESTS_DISABLE_UPDATE_THROTTLE_THRESHOLDS",void 0),d([b.property()],f.prototype,"DISABLE_POI_UPDATE_ON_SURFACE_GEOMETRY_CHANGES",void 0),d([b.property()],f.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0),f=d([b.subclass()],f)}(b.declared(g)))})},"esri/views/3d/webgl-engine/lib/webgl-utils":function(){define([],function(){var m=function(l,h){for(var d=
["webgl","experimental-webgl","webkit-3d","moz-webgl"],b=null,g=0;g<d.length;++g){try{b=l.getContext(d[g],h)}catch(k){}if(b)break}return b};return{create3DContext:m,setupWebGL:function(l,h){function d(b){var d=l.parentNode;d&&(d.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+b+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}
return window.WebGLRenderingContext?(h=m(l,h))?[h]:(d('It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),[null,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e']):(d('This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),
[null,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'])},detectWebGL:function(){var l;try{l=window.WebGLRenderingContext}catch(d){l=[!1,0]}var h;try{h=m(document.createElement("canvas"))}catch(d){h=[!1,1]}l?h?(l=h,l=[!0,{VERSION:l.getParameter(l.VERSION),SHADING_LANGUAGE_VERSION:l.getParameter(l.SHADING_LANGUAGE_VERSION),VENDOR:l.getParameter(l.VENDOR),RENDERER:l.getParameter(l.RENDERER),EXTENSIONS:l.getSupportedExtensions(),
MAX_TEXTURE_SIZE:l.getParameter(l.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:l.getParameter(l.MAX_RENDERBUFFER_SIZE),MAX_VERTEX_TEXTURE_IMAGE_UNITS:l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]):l=[!1,1]:l=[!1,0];return l}}})},"esri/views/3d/webgl-engine/parts/Viewport":function(){define("require exports dojo/has ../lib/PerformanceTimer ../lib/Camera ../lib/Util ../lib/gl-matrix ./Visualizer".split(" "),function(m,l,h,d,b,g,k,f){var a=k.vec3;m=k.vec4d;var e=k.mat4d,c=[0,0],q=e.create(),t=[m.create(),
m.create(),m.create(),m.create(),m.create(),m.create()],r=h("dojo-debug-messages");return function(){function h(c,e,g,h){this._content={};this._frustumCullingEnabled=!0;this._maxFarNearRatio=2E4;this._stats={renderGeometriesTotal:0,renderGeometriesVisible:0,visualizerRenderTimer:null,viewportRenderTimer:null};this._needsRender=!0;this._rctx=h;this._gl=h.gl;this._visualizer=new f(c,e,g,this._rctx);this._camera=new b(a.createFrom(0,100,-100),a.createFrom(0,0,0));r&&(this._stats.visualizerRenderTimer=
new d(10),this._stats.viewportRenderTimer=new d(10))}return h.prototype.getCombinedStats=function(){var a={},b=this._visualizer.getCombinedStats(),c;for(c in b)a[c]=b[c];if(a.renderGeometriesTotal=this._stats.renderGeometriesTotal,a.renderGeometriesVisible=this._stats.renderGeometriesVisible,r&&(a.visualizerTotalRenderTime=this._stats.visualizerRenderTimer.getTotal(),a.visualizerCurrentRenderTime=this._stats.visualizerRenderTimer.getLastFiltered(),a.viewportTotalRenderTime=this._stats.viewportRenderTimer.getTotal(),
a.viewportCurrentRenderTime=this._stats.viewportRenderTimer.getLastFiltered(),a.totalNumFramesRendered=this._stats.viewportRenderTimer.getNumMeasurements()),void 0!==this._gl.getUsedTextureMemory&&(a.textureMemory=this._gl.getUsedTextureMemory()),void 0!==this._gl.getUsedRenderbufferMemory&&(a.renderbufferMemory=this._gl.getUsedRenderbufferMemory()),void 0!==this._gl.getUsedVBOMemory&&(a.VBOMemory=this._gl.getUsedVBOMemory()),void 0!==this._gl.getUsedTextureMemoryStats){var b=this._gl.getUsedTextureMemoryStats(),
e;for(e in b)a["texMem type: "+e]=b[e]}return a},h.prototype.dispose=function(){this._visualizer.dispose();this._visualizer=null},h.prototype.setLighting=function(a){this._visualizer.setLighting(a)},h.prototype.getViewParams=function(a){var b=this._visualizer.getViewParams(a);return(!a||a.frustumCullingEnabled)&&(b.frustumCullingEnabled=this._frustumCullingEnabled),(!a||a.maxFarNearRatio)&&(b.maxFarNearRatio=this._maxFarNearRatio),b},h.prototype.setViewParams=function(a){void 0!==a.frustumCullingEnabled&&
(this._frustumCullingEnabled=a.frustumCullingEnabled);void 0!==a.maxFarNearRatio&&(-1===a.maxFarNearRatio?this._maxFarNearRatio=2E4:this._maxFarNearRatio=a.maxFarNearRatio);this._visualizer.setViewParams(a);this._needsRender=!0},h.prototype.setRenderParams=function(a){this._visualizer.setRenderParams(a)},h.prototype.getRenderParams=function(){return this._visualizer.getRenderParams()},h.prototype.getFrustumObjects=function(){var a={},b;for(b in this._content)a[this._content[b].name]=1;return a},h.prototype.modify=
function(a,b,c,e){this._visualizer.modify(a,b,c,e);this._content=this._visualizer.getContent()},h.prototype.getContent=function(){return this._content},h.prototype.setCamera=function(a){this._camera.copyFrom(a);this._updateNearFar();this._needsRender=!0},h.prototype.getCamera=function(){return this._camera},h.prototype.getPickRay=function(a,b,c){return this.pickRayWithBeginPoint(a,void 0,this._camera.viewMatrix,b,c)},h.prototype.pickRayWithBeginPoint=function(a,b,c,e,d){return this._visualizer.getPickRay(a,
b,this._camera,c,e,d)},h.prototype.addExternalRenderer=function(a,b){return this._visualizer.addExternalRenderer(a,b)},h.prototype.removeExternalRenderer=function(a){return this._visualizer.removeExternalRenderer(a)},h.prototype.getExternalRenderers=function(){return this._visualizer.getExternalRenderers()},h.prototype.render=function(a,b){r&&this._stats.viewportRenderTimer.start();this._updateNearFar();r&&this._stats.visualizerRenderTimer.start();this._visualizer.render(this._camera,a,b);r&&(this._stats.visualizerRenderTimer.stop(),
this._stats.viewportRenderTimer.stop())},h.prototype.resetNeedsRender=function(){this._needsRender=!1;this._visualizer.resetNeedsRender()},h.prototype.needsRender=function(){return this._needsRender||this._visualizer.needsRender()},h.prototype._updateNearFar=function(){(this._frustumCullingEnabled||0<this._maxFarNearRatio)&&(c[1]=0,this._computeFrustumCullingAndNearFar(this._camera.eye,c),0<this._maxFarNearRatio&&0<c[1]&&(this._camera.far=c[1],this._camera.near=Math.max(c[0],this._camera.far/this._maxFarNearRatio)))},
h.prototype._computeFrustumCullingAndNearFar=function(a,b){e.perspective(this._camera.fovY,this._camera.aspect,1,10,q);g.matrix2frustumPlanes(this._camera.viewMatrix,q,t);this._stats.renderGeometriesTotal=0;this._stats.renderGeometriesVisible=0;a=-Number.MAX_VALUE;var c=-Number.MAX_VALUE,d=t[0][0],f=t[0][1],h=t[0][2],k=t[0][3],l=t[1][0],m=t[1][1],r=t[1][2],u=t[1][3],v=t[2][0],x=t[2][1],P=t[2][2],Q=t[2][3],T=t[3][0],O=t[3][1],S=t[3][2],H=t[3][3],Y=t[4][0],W=t[4][1],E=t[4][2],p=t[4][3],A=t[5][3],K;
for(K in this._content){var U=this._content[K];if(this._stats.renderGeometriesTotal++,!U.material.isBackdrop){var V=U.center,X=V[0],ba=V[1],V=V[2],U=U.bsRadius;if(d*X+f*ba+h*V+k>U)continue;if(l*X+m*ba+r*V+u>U)continue;if(v*X+x*ba+P*V+Q>U)continue;if(T*X+O*ba+S*V+H>U)continue;ba=Y*X+W*ba+E*V;X=ba+U;ba=-ba+U;X>a&&(a=X);ba>c&&(c=ba)}this._stats.renderGeometriesVisible++}K=a!==-Number.MAX_VALUE;0<this._stats.renderGeometriesVisible&&K&&(b[0]=.99*Math.max(1-(a+p),2),b[1]=1.01*Math.max(10+(c+A),b[0]+1))},
h}()})},"esri/views/3d/webgl-engine/parts/Visualizer":function(){define("require exports ../lib/Renderer ../lib/SSAOHelperObscurance ../lib/ShadowMap ../lib/NearFarCalc ../lib/Util ../lib/gl-matrix ../lib/RenderPass ../lib/HighlightHelper ../lib/RenderOccludedHelper ../lib/OffscreenRenderingHelper".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q){var t=f.vec3d,r=f.mat4d,u=k.assert;return function(){function f(a,f,k,l){this._drawSSAOMapDebugQuad=this._drawShadowMapDebugQuad=!1;this._needsRender=!0;this._content=
{};this._rctx=l;this._renderer=new h(a,f,k,this._rctx,!1);this._programRep=a;this._nearFarCalc=new g;this._helpers={shadowMap:new b(a,this._rctx),ssao:new d(a,k,this._rctx,this.setNeedsRender.bind(this)),highlight:new e(a,k,this._rctx),renderOccluded:new c(a,k,this._rctx),offscreenRendering:new q(a,this._rctx)}}return f.prototype.getCombinedStats=function(){return this._renderer.getCombinedStats()},f.prototype.dispose=function(){this._renderer.dispose();this._helpers.shadowMap.getEnableState()&&this._helpers.shadowMap.setEnableState(!1);
this._helpers.shadowMap.dispose();this._helpers.ssao.getEnableState()&&this._helpers.ssao.setEnableState(!1);this._helpers.ssao.dispose();this._helpers.highlight.getEnableState()&&this._helpers.highlight.setEnableState(!1);this._helpers.renderOccluded.getEnableState()&&this._helpers.renderOccluded.setEnableState(!1);this._helpers.offscreenRendering.getEnableState()&&this._helpers.offscreenRendering.setEnableState(!1)},f.prototype.setLighting=function(a){this._renderer.setLighting(a)},f.prototype.getViewParams=
function(a){var b=a||{};return(!a||a.pixelRatio)&&(b.pixelRatio=this._renderer.getPixelRatio()),b},f.prototype.setViewParams=function(a){null!=a.pixelRatio&&this._renderer.setPixelRatio(a.pixelRatio)},f.prototype.setRenderParams=function(a){void 0!==a.shadowMapResolution&&!1===this._helpers.shadowMap.getEnableState()&&this._helpers.shadowMap.setTextureResolution(a.shadowMapResolution);void 0!==a.shadowMap&&a.shadowMap!==this._helpers.shadowMap.getEnableState()&&this._helpers.shadowMap.setEnableState(a.shadowMap);
void 0!==a.shadowMapMaxCascades&&this._helpers.shadowMap.setMaxNumCascades(a.shadowMapMaxCascades);!0!==this._helpers.highlight.getEnableState()&&this._helpers.highlight.setEnableState(!0);void 0!==a.ssao&&a.ssao!==this._helpers.ssao.getEnableState()&&this._helpers.ssao.setEnableState(a.ssao);void 0!==a.ssaoAttenuation&&this._helpers.ssao.setAttenuation(a.ssaoAttenuation);void 0!==a.ssaoRadius&&this._helpers.ssao.setRadius(a.ssaoRadius);void 0!==a.ssaoFilterRadius&&console.error("The property ssaoFilterRadius is no longer supported as a render parameter.");
void 0!==a.ssaoSamples&&this._helpers.ssao.setSamples(a.ssaoSamples);void 0!==a.drawShadowMapDebugQuad&&(this._drawShadowMapDebugQuad=a.drawShadowMapDebugQuad);void 0!==a.drawSSAODebugQuad&&(this._drawSSAOMapDebugQuad=a.drawSSAODebugQuad);this._helpers.ssao.getEnableState()?this._renderer.ssaoEnabled=!0:this._renderer.ssaoEnabled=!1;void 0!==a.offscreenRendering&&a.offscreenRendering!==this._helpers.offscreenRendering.getEnableState()&&this._helpers.offscreenRendering.setEnableState(a.offscreenRendering);
void 0!==a.antialiasingEnabled&&(a.antialiasingEnabled?this._renderer.renderOptions.antialiasing="smaa":this._renderer.renderOptions.antialiasing="none");void 0!==a.earlyOcclusionPixelDraw&&(this._renderer.renderOptions.earlyOcclusionPixelDraw=a.earlyOcclusionPixelDraw);void 0!==a.defaultHighlightOptions&&this._helpers.highlight.setDefaultOptions(a.defaultHighlightOptions);this._needsRender=!0},f.prototype.getRenderParams=function(){var a={};return this._helpers.shadowMap.getIsSupported()&&(a.shadowMap=
this._helpers.shadowMap.getEnableState(),a.shadowMapResolution=this._helpers.shadowMap.getTextureResolution(),a.shadowMapMaxCascades=this._helpers.shadowMap.getMaxNumCascades()),this._helpers.ssao.getIsSupported()&&(a.ssao=this._helpers.ssao.getEnableState(),a.ssaoAttenuation=this._helpers.ssao.getAttenuation(),a.ssaoRadius=this._helpers.ssao.getRadius(),a.ssaoFilterRadius=this._helpers.ssao.getFilterRadius(),a.ssaoSamples=this._helpers.ssao.getSamples()),a},f.prototype.modify=function(a,b,c,e){this._renderer.modify(a,
b,c,e);for(e=0;e<b.length;++e)delete this._content[b[e].uniqueName];for(e=0;e<a.length;++e)this._content[a[e].uniqueName]=a[e];for(e=0;e<c.length;++e)u(this._content[c[e].renderGeometry.uniqueName]===c[e].renderGeometry)},f.prototype.getContent=function(){return this._content},f.prototype.getPickRay=function(a,b,c,e,d,f){t.unproject(t.createFrom(a[0],a[1],0),e,c.projectionMatrix,c.fullViewport,d);t.unproject(t.createFrom(a[0],a[1],1),e,c.projectionMatrix,c.fullViewport,f)},f.prototype.getProjectionMatrix=
function(a,b,c,e,d){b=k.fovx2fovy(b,a[2],a[3]);r.perspective(180*b/Math.PI,a[2]/a[3],c,e,d)},f.prototype.addExternalRenderer=function(a,b){return this._renderer.addExternalRenderer(a,b)},f.prototype.removeExternalRenderer=function(a){return this._renderer.removeExternalRenderer(a)},f.prototype.getExternalRenderers=function(){return this._renderer.getExternalRenderers()},f.prototype.resetNeedsRender=function(){this._needsRender=!1;this._renderer.resetNeedsRender()},f.prototype.needsRender=function(){return this._needsRender||
this._renderer.needsRender()},f.prototype.setNeedsRender=function(){this._needsRender=!0},f.prototype.render=function(b,c,e){var d,f=b.viewport;if(this._helpers.shadowMap.getEnableState()){d=this._nearFarCalc.calculateSceneNearFar(b,this._content);this._helpers.shadowMap.prepare(b,c,this._content,d);c=this._helpers.shadowMap.getCascades();for(d=0;d<c.length;++d){var g=c[d];g.camera.setGLViewport(this._rctx);this._renderer.renderGeometryPass(a.MATERIAL_DEPTH_SHADOWMAP,g.camera)}this._helpers.shadowMap.finish(e);
b.setGLViewport(this._rctx)}if(this._helpers.shadowMap.bindAll(this._programRep),this._renderer.renderAuxiliaryBuffers(b,e,this._helpers),this._renderer.render(b,e,this._helpers),this._drawShadowMapDebugQuad&&this._helpers.shadowMap.getEnableState())b=r.ortho(f[0],f[2],f[1],f[3],-1,1),this._helpers.shadowMap.drawDebugQuad(b);this._drawSSAOMapDebugQuad&&this._helpers.ssao.getEnableState()&&(b=r.ortho(f[0],f[2],f[1],f[3],-1,1),this._helpers.ssao.drawQuad(b))},f}()})},"esri/views/3d/webgl-engine/lib/SSAOHelperObscurance":function(){define("require exports ../../../../core/Logger ./Util ./gl-matrix dojo/text!../materials/internal/ssao.xml ../../../webgl/Program ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../support/imageUtils ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){var x=b.vec3d,y=b.vec4d,n=h.getLogger("esri.views.3d.webgl-engine.lib.SSAOHelperObscurance");m=function(){function b(a,b,c,e){this._enabled=!1;this._BLUR_F=2;this._attenuation=.5;this._radius=3;this._samples=16;this._viewportToRestore=y.create();this._rctx=c;this._programRep=a;this._requestRender=e;this._emptyTexture=new f(c,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:4,height:4},null)}return b.prototype.dispose=function(){this._emptyTexture.dispose();
this._emptyTexture=null},b.prototype.getIsSupported=function(){var a=this._rctx,b=-1!==a.parameters.versionString.indexOf("WebGL 0.93"),c=-1!==a.parameters.versionString.indexOf("WebGL 0.94");return a.extensions.standardDerivatives&&!(b||c)},b.prototype.setEnableState=function(a){a?this.enable():this.disable()},b.prototype.getEnableState=function(){return this._enabled},b.prototype.enable=function(){var b=this;if(!this.getEnableState()){if(!this.getIsSupported())return void n.warn("SSAO is not supported for this browser or hardware");
this._enabled=!0;var c={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0},e={colorTarget:0,depthStencilTarget:0};this._ssaoFBO=a.createWithAttachments(this._rctx,c,e);this._blur0FBO=a.createWithAttachments(this._rctx,c,e);this._blur1FBO=a.createWithAttachments(this._rctx,c,e);t.dataUriToImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAqf0lEQVR42gTBB5ydB2EY8G/v8b7v7Xnv9mmcdFp3WpasZUuWFzZgDJgkhgwoSdM2JbTNjzZA06ZNgaRJWtKSEgjDGNuA8UYeWpZkbZ10uj3efu977317j/7/4De/8ef9vCow2VUGGHzRhuQ+t08GvhZb+jy85wOu/68JzwtQSCZedpsvC8SL6NJNNwZoHMaZiMoCrjrPATpGJFxvRCYMKqTCBsyVw8h5B6ROArU3+8HOGLe3Ay+UABow3D4wEcfOakDbjh2h594mikMNcI62ISNzIius0bfeN+QHrv+L7M53FHq1XC29breFgmCjwPHQ/fo88OIg9kvDdQPhB93G8yk6DtRYFT64fR/jQn0NIcIgYHylyFjVHPBboCB7HQ5sXuoZqQCHqKUjtvKNpvxkivqlZe514DOA/Keethib6OkOw204MMTjY3HX8VIGFeITgBEApGRFY3hyKyPeRWK/NNa2huJeLKzBJAimiY7ZQbAh0HwPEP9jxHhs6he37z8+KWqdeD7TCttNwgHftJpfzCq/iOJbKrxap2Ymet8zwVEoNReE7T4aI6t2mBuO4Meyh3vHAeK2+KvLzWHEgSCJpgR5EvP7QPFLyeDWWrqc1iVz6LwPI7GEpOEExCwzVZwtKtDGyzRW5tGyz5WA7HLtfrOIHp9T9kXQB1z7E10eYMytTs5QOuci8E+YIk9W/roj5nxvjVVLaM+30x/09CPGIdQlfsOe/WqxoS9Sf5bVv+drIqyP6uNrQMxFGDPSt1PurVE/UcuV9ci35bmCPTiIjsuZZjZCePj01iMbKBYa7UyVIDI+MDMSAV7sw6CSjKEG0IqwXhEkVtFwFJQ9D3q9q2RE8xEzuxvCN0Bq0pAFH7IMZEW3/zQU6rQ8Dw1bqPE2XCxtht8B/Hsg/yzu3CUcGdb6PW6QCVRs7bYKDwDQfYefmmJO2O/d4LyOzns2kA3kt7Bxrn1ZZ4hlYFs+uYpAnNDyDI36VE+6wLadkEwTwQIdYovCIM8SEVS24D+ktuqjWIT4yWFEN/zEfsqIWkFfKQsW8DNVyLEDKWwZ6ew8x5ojpAmh7DbTuiCGFcW/DXl5hO7Y/BztDCbwqtMaxcanBq59oBYuVIAM2o2twXHduUpDjChd7xinXHoB5OKsvd/jlrN+SnHoir0dn1hWWSbrDzj0Nd6x3PUb1LYyVIpv9AHW9sPW+aEhU8peULyaAG12TddDnq0zVg5S+vfnVLQBwjt3PcU9k0feDfAkCjohqkfBRgeVfcx1xYcTzRYoNbVPbCQ/mmC66x3pMpN7IPDeT7a2+TYYDYj41QNoEoGVQhPLlIPb8k2yMZlM2gNIiEu4nfIZFKeDW08qY9ds2wLoLWIt2yJuYrXnWhNbytRVs1sHIw6qhoE/sYJsJArzFLNdUzxalSOyF3oIBU2ttqZFumoEj6XoZVOHKWSJDoGe+WGZmObQuA4f+uap/u15hOEW1LveusgkSWNvivQRRg7bAQWcd+wUcmN/DTkr6XeHmX/pVnYkebSt/RBNP8PhsXnqFhfUu/ozIH++g98KYa+EnqoRZtFucB/WVPy5MoJEyH+RgSeFoTuDS3Rjpi7Iog/+N2aD7N9oJkprVsWpNOqZ5JsMfDKSID//tUCyQrANUm4Q/czDP1mKVTo2lrM6uuJh9RV3pMc1ylB/5zpYs3EWgR87+hDYZY06VIzFYd+HxTY9FyARG0RytMQAJujsU3Pz/qPlwVVI99+KBosYv4qQOzQP4WWCfPVd5eSjvPMmAkY0LFL9lX5vMfDKgtMADu3pCrNLctVht8XYBr6KRvBkWte8jafxscvmLE7tITB4IxDf4GJ/7YdtklZdgOO6z62Bj4ADitP0UfcQAiwSnoEgw44j+mCCpjb7zL2IcBSOYLS5ArdRgU/EJrsgnLhuAgv6ylO+fTYJZMPiFVUt4bafDNpq8gW2/+Wc1LSVejMjel0a5Yg2kUT1DzSmbB3aGVsieORVfXAq7vYkeQUZKUHxZlufMOFKsneeaJYoxjH4j6q2BObSoPx+o2RkzKti/lyb2uC7h60bB4z9maJ4tnFpvw/fQ8zfJ3IAAiSE6G2X40l/PFI+xGgcAjM+/31BL8p1KGRn8kFaztzEFxsAfOxjR910VTxaqsh6/z5RGNebzyWtoossscYHUPKL91d9BhtQTclREMGf6PoMnmDJ6orHxKl7RZO9DwAIBqRCqlbTHs8hf0fa/1ZcPuxk/I42xYnbafCqgGGatSnGPUaE/1azHhdzw/rok76dX+vslH00lkxaRKfW/wwn3mJTQOH5bu/vzgMJNnTuAvJMFL3p9f90ttxSrfnxNusCI0spKhX0O7XBAHcouivCT56YhuFE+A4vrQr7VfSfeXbsbpt4rbhpwuNPNBagcd8A6DO4PgSzeDQ6lGlIevQ2yGyG3fn49mPgnTNJZqVuLwC8E3FFyBozgL47rtOWlrXOd1s/dRPjgYmLAzl2dWFOGk+bW+PStap2Xm/ERvzJdDYd4fd16N3x3ooL/FzJ8PEPT4H4WRk5ygiRK97yrjHU5p/69gdFfUdLiDlYG0NeFYyjRmZNdLM6mDPgwceejmpR8ek2Pm02WQ3ZqW5nCDTpL9931LtJdladOI0oZjCwoGICD1xZV4cYZxIgzhjekCf9wh4+jDU5IjvsdEm/12T6e0aJ5YqnS7ROWkWBX3FAnboqd7c6kAcAxZwBS3bSAZcH0F6pV/7AkfvSEzW3fzrp1VvQjkL3wetuK7N/CV692ve/zNVq5KYktPLl/CMDhNzFjT6ZOIK3RgxqBaLxgL8Aoc+F8MeP7gFuRpXbCDtlAbL10NvMh/tsocPBVQx9SFIIiN0CNzcipYWwz5GmjGWiarABr7U30U+uUNtF9/saPWDaKnox3JOtzsKvq1INHtwgug+a9C8U+XIiPGGIWaCNg7RE1WFxot+t3g22M6JFGzGOpSzmpS+ODP4Q6RwuwVKDW0f8olQHYv4Iwf51NAr0mmJoXL1TpxX/Jwq9m3b+wiCKtLfiNrWV4I/5xBkDPvnpZ+Q8EN/Czdf1bA+T5A6JpRxP74kwUm8y12j7Jd+fsDMtag5nJvLUigJjbnooZikOBpxD6T+Nk7Ln0kFZlhujYcHz/L1UK05AHRt+gErP4E4f5gKsX+O8TCsbUG1hHj2+vX3Ng7bL0R3a5KytLaPmeay0xND+gBfUj9Phq/2xfYKS87H3ta1Qso4H9Ca6X0hoMdy/IXM7QuhIVg9ZbI2oBRhk6xpX8qoHNrL9POGnrNERY9igV1x61qKLAvFcGoiRcch1N+k7LK/5D0D3eIobCG4s2iADwB67+vJqtk0Tc1TMkgQLKKRG4Bl48I3u2FQq/lO3XbK9g21Br2Wrcyobb2DqyLVhQbWbiwX3JdQGgLjIbjStUiveYGF6IpjdMZj6eyO1pSwXCSByV38TzEY2/VEpeAXdtABk0qq9aZB+cGf+ukGgq26f4iAJfso+9b38L3dfnIImHIwH4TRyf4e78yxS+Uxq6TugN4xw5XDxOoluqXYDJhgyxre24BJr10njnXjpWcTtWbdv4aXNbXQq03s36vFSR1oz9oxk321YuwoQdbNCsfy3tHAmMcnpdcCnnvFu3ffTYs/Ph90bPfqToDdPLPaNcCKivoo0Rwkqbsk1bPVbJpYxGIKUfXH4pK6H8fghaPY13icA4JO+NLuCpoYlHDM9EB75+kNH/n6o9zE+TRnBkkL8xiqWY+Q9ZzaAg4+fLzZjhNfw3w/gUQRFiPz+fPeS0b8aFIJGPC+rr24QY6gIO9YVpEO6A2aaeyYdXRMVVLdKluURo78cBmBt9EtRzeNaKwWKt2E84X3D5pkIp/iAp5BlCgOpbCJAGniU3QBwNA46JmID4zirCmjDcPth6PehZa+zDdAvOqltgXj53q4T5ealBjQn4yoLHxl7ENmhUxeNvsVRYwtikoW6UeUxgr9EMFvwiR9UeuVRYKur4GLqMtLds4H9c7GxNSJGLKubjwZ8TGOXLmgCr4e5uEw7XWCj+lNk1wMUOZOC/mXXfhLtvOu24Kyd7Rq3dEnkuAFo8DA4pyLpJ0zioo44oRxXdESQO1rq81ulq3WDJXbt3ADVNIjWg2a/R+JYnI2PeepVLB6LPzi5eMUa2/jvGWrYA0pIsd2Ax6mPHbLgJuQbN3uQNGGu19WDg/3b6lAnBRn9N3KlQsrLj5LkBOCnwk7P3pLX1ljdnh8cnPPerTvbJmSkWHISCPCTNYii/Dg4JrjaCNS+3DAPRwm9DyJkalkLQz4YsGNLFveiCyw6cE4MzvjUgRAl0jAQclYHdAaYaFVABepI4sP/oeepxPi9oGlSi3tpWIX0FzAOuE71y02MAmdQrbkGPmClGtJGKw+fOHi4cTrPd5qF/4KGkWmwqPqRP9fyB03ZL2FMBtc/W3/43eT17zGJUY+tBegRFjLJktlYf8TKpkmzJai8GvczudWw+UeEPcTZGuLLoFGDpv5YDH7ZFo4P1jmZ3TCjEotNcBqm155Pjm3NzFEKWKF7KcVY72eG4IF507vbNnbj9CwxsimhPW5KBT/cwpfvy/YzvJdcA+6n/B0d85Em9Jpj0SJ6LewBcL7Fw//+NzPSGw1uSqy9jfTmcJuyMzyA57DcJ7BZOkbPIcUXsDPjoMXY/keYYLd0Rax9ZOgJqJzTsb8onXqy1r3kKf8mbdIKVceTSXiiGi4/HR7Pt5tt27+BzW2VM1tj6lqIToB4087XR9bgOfSFKyGf5eeM2J0YhpmrH9/Uu2+28qDSL1av08BUz/i2dTounIci36M4SXJfQvpHifh6TOnD1lTMejVlfZUXf66md5FwdmEaOG1150HxOMK+gQNbgOZs0N1/lb7CJLdA8ILbK7RYCYPhDrXAb+xLMG4f8mFkDpBeyS5+tXLxfxPxJxjk++79i5TfpbnAivqN+HcMfaKsuVEQwkWRTQ6/a5BboYuIP2CsCo3BHucNjYkXfHt7YLxqKU/w4c/bdMrAM0RpawTOtWVdL3+l+Mr9a6KGHjzCdL+Pcs82YJuhXDZ2rh2NZcStekK3eqM4bjnwp/7yMa1OFl1OV3t6QPCo35w0tr2V7Copy7J1Es2x8Vv/HFIPufBxivtOv7nfIH2UelqlYzTdYMRhlOaizWtwONQqix3wIN5egwKRjEqW/h7rM7j0/YG2BRMfQkYeQJUQeo9nCmVps09F9focPDhOOXQUQMjU5dVeslBdgwfdev4kpssy+ovCLglTwJ6SUOXLRMTn3S0pz10x5bTC15u11cl30Nk9Jrzr0xP8nKHV48h0J54cVJqaeI9qlm1gjOB1k0QhXwFP2ObcgC+t0r1ti6P/KzA/SXo/IN0SMFjq9ZuIrLr9A1akw429QOUM5B5UEmUvRmTAe60bM1yWrYMPpCFXI/q4RWB0CWq9rGRvUP6uaKQ/IG34bkpJkt3ViM6N0IEnJx4orp2D+v9I4duJatlZ7BHsJdqYiWJ5E3tNwoeEVCoY2xmtrCoYT1IXAPjUwBP+UKQvs1zFNa06XEMiWsMnUtTlALgZWDlM1hWo28GbMfiUPvgdt/o7pfRflcM/cqANpekRiR1c1GDZum7sabObAKJGAiHtLqegHQC9DUL/UQuHsMQHtHGasfv6lruN/s+g4LNBZ8IJFEA+CQPYmvAjW3wuu8Em2BOLwXwZlFGfMPA9gYvg7ivh8mmQV+jMZCwMKS/nJW8SwW8HazdipRdLct7AJkj40MeOWg3QPwIrXSSc0ovjYScZv/py9VCo137HQyowz7J1BdefseFZXLWQTNmHRNUYHKOArrc1Ld3Tuhw9+iusRlGgUILvkENzEP00tfai71AkRVocwA0+urjxvsVO2au4HpYHBLzTXC5UGH9S7qA+0j8DO6I9fVCSn0La27FII/Qbem53DIga6BQMqMD2zzG2vQobkLxi4skm+av45lv9+w+7UIYVvifAu/74qdQWePGbEC300M0D1rtJrtekESHiIQhLqFk1c20F3oyQ/1MLh3NF2TCvWlpMoB11+RF/m885P9EFQfa2INC4bf0oSDykNB1c7ThJKog6qH/NiRykcxtxc2BiNWPBGQs03Gqy95X23pK3XS3Id6JoO1j/fb+rDEHXOWYCdF5p3D/MD/9Mrf9+0tmM5+43b29zk5/TG88Wc7/BuItg64CzAGDFRsPDYMwC4GPHTsRewpMoEvw7U5wNabW1NhdM5YstTBJvmeCl7EufAXYGheRUrgK3lAcnaBjUtvX7A1YCYrVzG4BI+Fs3u211IAOjITr3qxz1iQhYAzxcC97nqQcC/gNJ/ksGu21JMSvl4BgZhY+tDS2kbAZC/0+j2RmMSIBqxviUr8mBMw5m0irMJ0A6wqp4q7OS54rtv3SYfwE31V4hYBefEWo9yP7E3S6Ry/zAdvd68APdrcHzIBj1kQVNtfTmSN4Y1lvHcX/BxRMGVgizNziT1a+NL4f1ZGrBBLkAbTppStCqqHPLZhyPiDx3SKmtw205TO2WxMEQqkULr7vCn91BzmndvbHWFAu8GiSrgAZyZNMScbS5iAArlhrh5G4HedwL/wH2E6v+bbD1O455A4uBvlNoAUNKwqPsjk9+loTuhkiXwuigelze5UHCb/AJNKw2cc+G4CfE/Z0ZwVsDXSAOfr9R/gpL/ghGMJOL8BA2mOuKNInxFF6AW/7uErMW8sNkEBOBtXXXEbm30CCTJbxe6EOIbec+RTjqvdUflOP7AfgnkC8nhSIm3neEOmts61kCO/o2RP02eqWjJjzYn3A/WgFSoyAwj64gKr0H3nFCK7pZt2FDmwwcSqB3YBMgY3HXWDAoBqr9PHSGIeh/l/QZXZpL2wpO7AylAwZ87Pce3z6xUVvn4SNt0I8zpte4alIJpNWn8cjfSE4UKTvooupk8qPXRvFrmj6smvX17qSIX9baO7HYIjg6IqOvJIEg3tVQ9qyR25F2fx7JpzrMHwCdjgkYRexElPxR1RDICwMQssAVuoCZADE5CJ9ZJS8LV/rUdEFDlFhrI1yQ+/EEZmII9DDLO54bQvrj5cmbQPfa7cH/UOQXdKzucZ2IOklamgTnaRQuwQ/+x1PS39leFqUqIMbQ9x6YH8xs9TiGTviU6lvwehYNuM1i85I+gNg8DiEuTIIk2iOce93t0LQ0udyF6JpSw2dw9G1nJVmKfxT36xJryH6PzgQR9qRD1Mm5e37Mygzm/LbTyeGse9tUbxKBlqB2FtLmQgRT0XuwlEeSNxcWvzw98AE28vXwWr2FlIrAWsXu9Qf2Q3c/wgIo6RZJ5GQlejmceYZfebOaO8nDj/iTnf8s2C9IEEsxD0K57+JXP2Utf9NInQAnGuzKs458w4LXRbgQ9GaWxz4G11+LwAVYeMNM7iHu6gv4qVhtn2OYKeKRJRdJHF61unu1ms8j/2aR7OYTz6aWX1mXRDFnB7aepsLG4BHvkkwVYqa/DYsRNiB3CDPZ2q5Kr5L8oC6j5ULS3/jzu6tf88tQ1tTXmBhfdwgUwXDbbt33gD8woaq7sVQiLnSMXLTtZzY89fkny98x1N8pSu8ETpNAIhg/T8GIQvlae9NA9hx0Nc/krzNurU+PlTodk7+HO9MBugPzcYk8hFtQfN/X7klPxXMLqKf25wcIYKZhb/Htf+L1Uc18kw5jZOGML5c98ZDc5yHfzmVjvWqAh2URb7rTpwH7Z5Z+n7SJeCIdOVzgdwzy80P8Hd9okBHiZ/rd9S+Vrvw4zFlirKiTK6TcVpw1zP5HqVhBXt6RhPfu3IsNMMHfNPSZVSonE3UuRpsMiGM3OJSv93QnDntYsYtdGVuljAmJA47Bndeazv44WQHWORbVjGCIspejDdhnQEoI5OYlcXg5yt52/BHhWJF2Rgxn5H7RStg/JEAf9XnV5j1UAfm2Iy+qgJmEmxTPRFm9jxx0wK5FwlHNEHBPdTZ53Mfs/p00dG2Ren4MbqsBCHPX40CcaD98IfZyAX/LGkYN+CRygtyrER/0WGlb84sVrjlknK7HuCRx0us3BOkONLiBYUCABPNb+cChaP1nBEzlW6DhhQp4wS7EaP8jKzkYuZbKviVem6ZHQsCk7QpfziL22v/or/9J1/1wUns39AYhbg+CwWbwRuSzsQTe07J0eMfvMWHVtaiDsBwCaUJapcqMVu/+bgG9YOOvJ0rvKPZQBrhYhc4Z5hMKxupj1xvFyWmg1W5N56lDJHzoDx/cuAshRzC4RgMiLb4Q2pN8r9bnJc+XUvwe3YZ5fcMVHyusfcuXdpv27i51WA0lbuZsfK3s5de9lWW9zXCCmTWIWhI18QtJZ9RNj1RbAC/ACLbCUo/Cit3JZCjjtKR+f5zdBJtOH2uWGr47tDtauNpKbom3Vu6n4oxtJhFDmzaT2pc62ZPu0gKZ4cnId/Bp195CRRtJRKMX3+4KNbD9NDEARUw+Dj82NV0k8VggVL8EZM8rwKmwWWb4ZiA9mmtNR/6rbulcqybAyYcAajMrvmsCHZJlu0CItUtWhsU38uDA04ET8wqzujLFgSgRRzt+kXEaAKwDm59pL/0Y4byu6kKl7cTK+UR9vb7pvG1tF02qxaRg1uiHnx+g7wOFJdw86CMbIvQEdeeHfeLxFBSPJn5VXZvyXLVsJVZjFpf/G5N9TGEn4xIAIx1aZlnqNx48+fxpszhYt1rUyHKHyqS/reuRCO8KEKE/+p90d4cP7dOZGBZrAe4Q2Cr6VoWFGp7KU8jzB6QbTf++mX28Qt7b0RpHxG638hMdZDlOSXXCsLeIhHkEgDBnDc48xzage9HPIxbGocP0yslbVL0Ed92bnx3d/O9vKImgbfPx20LzQCP7f6r+b/H2tmDTlvc+6g0PHKeaeAe5lUU2I63NVlYI5Hba+5RBXfNRT+s/tQ4/PTEt6013TMhfYY1q4O1CPEUaPZSt/QOqj9rMG3KYH1yhRG/UXcb6yZcW8U+k+wPZPCgBlgpNu8Kf+VLERKyNT9vbszywFAMfMpx9lkOsgwtg4j67egVCDgb+ZEV+Y3qxbUuniUxWX3sxPzIPegZS/ka7kue5Y0IwTZu5WqyB9RSCfE3Uwk57704/vV7o8av3lyOVAoQ+jppahwoMNvpxOGpVqrkEMMvAXy4/1nLZ7CXbF+Kq4DobenxfVH8/pClZz8kcJjJSt/V/IWS/l38JjraIQDwVzDZtH9eDrv81QfiKDZ1jLt12E1ftzmRWhx30rpGsWMCynxugBxI8c3BRcxANJ0r34OFhMkV49Gt40u53T1vkZujkMataE3APzs1g0F8IXsmQDntQsdKFNf6iGH8VLQGmiW3JPBuidQduZTq7OqgW5JykjNnmiYjhbLj8+P7cqCWZYZRrkQTaRDf45QL5RUW9XKQDYn5MF6gY8ryV/nXW3qQrGXcQEKwbvgo4z6HJe/l20BOgwI4GgQJQVMNVFiLM3ZsX3olzj1B2we3+Guo/EO8csQZWY33MdXWPW08uYR5nM+10sH+4/+NzncE/GNbn6voapCiKV4hwCWxfwQ78q7g/B6aP81fbEJ+wCzml/1fZcKYdX5lgUa+LB/huzhEU6bsC/HuPnLhb8Wg6ni/HtV9Ygzwe4IyOGaVdivTDbEOW8wcpQLHx/7eC3Zi8sy8oXu5DhE+kw1u06LV7AqFiBTzxumkfMOCJAaDW1i2H8GXwYpRK1uBaofc2xGWoiG1SfQOZZd0xdeJz8d58GK/YijySB0J9Q+cPTWd/fav6mWhmSO8Q1NbxYhNAcb578XuSsC1uvGTGXkoqnwE2LrPE4WXsNmR+dr37NhPqTXwkhI99/qiruLWDhPRfke3BzfdO0Ym4QFzArH8aMPeu75kh1CseVwnsv8eZgrp91VD2VNU2J07EI+ZuhsZro1D0FpfMsrN9T7l9p9GKTy9r7nBy5t7G3PJk57ic3KRV0fbnLkfXYjF0cMEtFJzX6tUctEsk76FuiYm6EKzekXpHANhG2gts8KgF2qDT9Ady9p3FJLXcvD25D//CQrhEA4ctzFtu/O1u7KgeZ1Lgehq0AnjThaOUIIg7oyTm6DQFQGxYkfvTSD5z57MAe02y8MhnHbc3kWCVWgQS5KFidDa1hijkDgK9HylNiIkH7XUrO8mGx+CxPLJ6RBdr/s20MPBsaIkt9iU5tym3LEP0dJx732kMJwDPoVwVGRLds0r/XgQ5tHsywG8kAgXM0DB7PeFzbWyWa93IoiNSjCBLB+zoOu2+108JuNch6SnYLid74PzEj7llBoIHpx7hDqyxHrF/GasXOcNsJUiWOCPPptVgZcrbrM+/gYSTsRQGWXfwbi+2QpryYDX91ZRFe+c74jbKkPWQeYJdeasX+669/9kssmTPRZwQeXKLpE1E+wMyRDnkcUh+wZGLtPCR7U1wokVAtb7GMvgxlM9qyhlaafSIiZSV2vD+PkAeQIjhlvNRwBAevJgfJOo8qbpPQ2lV3ymUV1TQolwR8JBjKHETgw/91SRAJYKWvUwY46fq3dmcPUTKvlFYHq4cWmVrkV/zqAmy8WLPDahcp4/cpPwdQXMEimgoAXgeHsB/4wcD4WgpYL2kvse//ZIdm06Q86YrrHN/K2SfRJ33m8q3c8ZOC98HW3tg6JanGyYpF7dQgLGiKVfQ9BSfnsWrmyqiJkSrmImzcgVGKVKYrTVWN7tf6d09g6JtyFuSLqhgFsKE9Fy0wFs608u58BMfHhXUar/Ce5muvzisF6JoXe2fcbJTln4mpowiRCwa1bKE6YQTUT9l2z2PjQjcg7OFOC2z8RtLwKey7nwpOL7UIOmIcqMA0iv93CeLhhdhHK4m+WVcKc6sqRqPbXLI16EKsbTpOrc4BMRmvPYq2zwSQVf6zmEllfa8DyVodxwKuwDoOxBniJSY0GaSTDsOqaQq/TpWPIHx64a5xoLT7VUtdG8H8OA3t0HiED0CijKwqttKb740UfZbUfUqGDsNpefiSl7rr/f83Q50h3RzmP+FgiNLqYstIw1HsxCxO+NEcqIwD1RLyafv9PRS1ILpg6J3x9QLGncu4++SB34Fv9pKDJ2lVkflsOoIdszZhLGgK6yT3sT6qIAYAGSBuEik+gu6XOLEgRo4G9MPE8n3jPXHO7aczYZ1+58G+f9MLf5MHd1ldxDeLWLZJoN9pgofnfxs6YhJmWY95DHASjIJ7z4lgpx/SPVFkL0J+49CDoRHdmCHKHKzSLUtPev6OAMuUMQEEHouvSjVNk/k3u7co8aJ+6ADVeEupccQgcHC7UHvmhdNBOLdkMUixyPyK5y5ExMa1LU8oJ3sOnIx+RekN9rAOLaHYPY+Mg+Y7XM8dkgU5p0NAOF36Npi5F2nrS0C9fUadVLAZStsYtK4z94LmF/r8P5vHAT/Fou9Tm8cbjNGvPSpfGe9jhgGmhEpo965JlCczvY8rexaSSe7OVjwZnN2Ob0XkI0+vIwpbCs8lTFWA3WPBZ+j2YdrQXUIbCB4f3E+ES1oGFtWgKXRWKbVP8KnH6tCcoS3ie6H7TTq8e/HEl2l9buU/IptFZByo+5URfMLrQ3UGn29p2sMOyh5u9PYYuA+tOC9Dtsn0O61GrW8Vd1aH6ESfgC5Jg/P8EeGoNSrO1RuOKZ6QOKuKyDdGpj3XS1dR40xjXig7TSGmF9BUEK49IG27ZCocDx5yYHgIKBh8yjbftWO9QPkIibON4Mkgr6TQvea8SNccZVMwuqhXXh1GcPOknL/us4J3nxgC/7gSJD6ZPnuEYD5h5xabgNFEADolRV4z8cp5UeJB0vLK0bCTjKuGoBUQPwToZ9JDn5+w5NxIp4QtgLQBtgfDq1Oc+biHviY+Jm56YXtd9rtk2tlOP76Fb93EUwCcuET2W7HdYPAfxuz11rhA9bgJiSxErg86pGuTrrkL8nelqi1o1VcikcTFPFpXBsQkF9hrfTG5MedxuuME2ltj2r/X8zXK+ZOiW1l5EdKm0wYA6zzCzH/b+cGOyASKNKByGzhU+dk/DSiX2v6GbD0sUznKsJdgSIpDB5vsOUmpSXMKxhQJdBh2zQB9Uga2d7mF1i5Z8Pb/mg0GVkuNZFeFdf6/sQsRJ50cShX0xvFi14EdTAyK5xklct0uG9dU9Ly1BB7e4OdFA2kzjJ4+m4cGSTZsV7nWyCf6oBZWxqinVt+YsTvf6sQA1rUNjuKCtq0KP8EGoOrnXterJwiZH5WDOMJ9wiaTF4E1V6uuU/1KwyzJ+H1nMWLaG9MzrZDB0QJOUnUSxKEth9LU1tb7gYILPvJutypcbbUg/cb8KOPnEjRaCOkwJVQYECuiICK6u6V6FnMA4Qdf4LKiO9CPrEHjf0QCB60rN/YDmrSfSJweSDouFYaper4DVl9KMj8Qq4nhIkrzSCV1VtB8Pv6oXTxphryWz16RTVKqPbbKq9zbQasDtcKWRE9WvP3FNcsICp2kRWQCpSzS+z4+Er1rJgNglbTAWRqrATd8ElRNLkfMfFJWHPwNMPW7vUSOpc9im7UGfizlYOdvT787XWsxMF36s1xPyQov0uMDNuh7HVeyHWziyzKJnJFH1zyJG7twS5yiydQvr+9XtYK/mjNWUEdhgM3TJsWQEK3aaE+HqwUhLE1b65h42a1E3HMqoXuC4BzlnNuEIgryVdgYucd4NsTHd+tf+jBWV+6h6kT2CgOBmdI7gEfBrIYkOCO9tZGY+K770tcEjoG+l/rLT2tDByN06xhRUokM4Ltw8U/fNh/ydTjO4JddSFJ0n6Z9SMiz3lreKURYDM2Z+Szp9+zXvKr6SE29NRrJAGbmRjkSxi3sOErHFrB10tJ2uuT+/tem+j2qexl1P1B2DlgxMa8kS4WHKFWv0vqTQxY7YqnQN8jE+lmv3woeUknMmJciOh8HaLQ2A4uHN+oXYqBkyrckpNz2iLo5vZD/nuEEs/JWzZsCcp2U8YtsPcGQNdIOqvcZRD40+RjBs4WmDr7pU77XhyaIrC93dqsR+qa8BHQOWj4Bu7/Ha59bpCbhRoXY5nTHcgXGvNW2VGXpouirMtJDL3cggbY4AV6rYdtSbnCb2FR0Z3oEVYPa38SZH/o+79XTKl48AVc9BeBWAJbggJXJboVa3PUkSLquk/t1LtVD19MizUfx5LVJ+bJeSq5krVfq1glKB5TIifOV/Do4YI96WDkPPZoWbriIDEdfqy828yhXsnn3/Q6xwJvxVRu4ckHYGnN8zaBRAdlIQwaphWujvdJ4yQCnsPlge7wXDKQuPB5N5wTIyBk/4aw/x/R8SmxQAIM6p4hOxgaYEqGMRpnHcImrDOAMzoXe5VuTKeSPwTmd9FAoKsDOcbGwJsRslfufhCPDSOeWxn4MGty5kg1UIKiP9KtE0xsFPeMLKY0a93YsRVF6su0Tt99uEIYYhogYODAIeFhKqEoyScLyLpjtsnsKTisrwea2HklEPbCjoHgxYi/aPGvA4ZvW8U1dmnMPBgKzwPWT0KUDrRhLPZrT5vB4pMbfon/pNjubIqSAql2YwbQQ66PYVPKvacgMpbKeSS7HSboMBqsLqOFLRlY6bT9QfjaHB7bGfcHQrij1HeGzjphnmbYO359jhvWcLnotM4nsaKU84N3l6nyqRVAQ2K1lrzE659W4Y8ff/hhirkxkgauyvgHNf5Azu8xxk+geLrsjEjx7wK9Z5DodQgqFhp5dO0L4xmvV4M0Y0SFL0OEAVJhhZCKKOnUEM+8TXV/ijaeWGRfwFcNXeQQ4Y7jPytH+ZKzujr6KtApadQaVPlBtAUtg9thT+0kGoo/CvMwOHLTWLuQAvZKzCXc2eFg388gR0yblNUY5JXJ0oFq8N6Et7LKFG367qbWxTUnt3vgemDfAeCT3iMX9+ixihTYoJQGQduFd2K61cIwIDy42PwyyfBAlB69X7pGJWNsTubeIzIBLt1b4a6OQB8ptWFIGIquvVlHu0wqhWx6QJPCQW+8z2h0mDaBT+D9Wddq+oAV60yhIgprTSh7klj8n15U6kkIEZluuJjvLpLZU1QoduLnoIodg37XTJlN/Y0gfKIMzYFZ03d5Wt7iluXVifzY6pDCEoLJ9wOz5Hy6CR/+zuPZFZd4t60NpSxXp6rd3nWq2NfD+YRwSdCNRPK6Lu8LkjZpvlgn+wl0xjLLDD1ixtN0kEMsMAhr8NFsCh6wXAOvrUOc0oEDDrlq9fZH0o8qXnYcv+cXGJweDpW6T2+Lt5q9nFKfv5/JnuxsfcdFm4RMa+wwv/5WLaaPCuv93AxVUQE4R4hKhMQ0H+TkXrcoWciBXUUSWJatVI4SzzvRkzb5PRI+wBz2lOju72rUh1j7mdyWptDkPB/q48dgfBzSCRDyLK/iwy+4+Ndx/I5XmXXV5dlkcnObFaHFJvI5aKgJzGYQ6qpcZ4zooB37BkE9QnAQ5rfxPDVE0hJ2oN6rBryoUXU3OiuuHV/IygkyxwkqeK+YUcsBo5CdWKXw1IC1oZd3U4uKEx93sE1J80d0cKwYmHeqt4jBHVC3p84ObsRrrlbAlJtJcKYXRdj/HwATFUYLcKM1oAAAAABJRU5ErkJggg\x3d\x3d").then(function(a){b._noiseTexture=
new f(b._rctx,{target:3553,pixelFormat:6408,dataType:5121,hasMipmap:!0,width:G,height:G},a);b._requestRender()})}},b.prototype.getQuadVAO=function(){if(!this._quadVAO){var a=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this._quadVAO=new e(this._rctx,v.Default3D,{geometry:u.Pos2},{geometry:c.createVertex(this._rctx,35044,a)})}return this._quadVAO},b.prototype.disable=function(){this.getEnableState()&&(this._enabled=!1,this._quadVAO&&this._quadVAO.dispose(!0),this._noiseTexture&&this._noiseTexture.dispose(),
this._blur1FBO.dispose(),this._blur0FBO.dispose(),this._ssaoFBO.dispose(),this._quadVAO=null,this._noiseTexture=null,this._blur1FBO=null,this._blur0FBO=null,this._ssaoFBO=null)},b.prototype.setAttenuation=function(a){this._attenuation=a},b.prototype.getAttenuation=function(){return this._attenuation},b.prototype.setRadius=function(a){this._radius=a},b.prototype.getRadius=function(){return this._radius},b.prototype.getFilterRadius=function(){return 4},b.prototype.setSamples=function(a){this._samples=
a},b.prototype.getSamples=function(){return this._samples},b.prototype.computeSSAO=function(a,b,c,e){if(this._noiseTexture){d.assert(this.getEnableState());var f=this._rctx,g=c.width,h=c.height,k=g/this._BLUR_F,l=h/this._BLUR_F;this._ssaoFBO.resize(g,h);this._blur0FBO.resize(k,l);this._blur1FBO.resize(k,l);k=1*g;l=1*h;f.bindFramebuffer(this._ssaoFBO);y.set(a.fullViewport,this._viewportToRestore);f.setViewport(0,0,g,h);var n=this._programRep.get(8>=this._samples?"ssao8":16>=this._samples?"ssao16":
32>=this._samples?"ssao32":"ssao64"),m=this._programRep.get("blur"),r=a.projectionMatrix;w[0]=-2/(k*r[0]);w[1]=-2/(l*r[5]);w[2]=(1-r[2])/r[0];w[3]=(1+r[6])/r[5];r=0===r[11];n.setUniform2f("rnmScale",g/G,h/G);n.setUniform3fv("pSphere",8>=this._samples?z:16>=this._samples?C:32>=this._samples?B:F);f.bindProgram(n);n.setUniform1f("numSpiralTurns",this._samples<N.length?N[this._samples]:5779);n.setUniform4fv("projInfo",new Float32Array(w));g=1/a.computePixelSizeAtDist(1);n.setUniform1f("projScale",1*g);
n.setUniform2f("screenDimensions",k,l);r?(n.setUniform2f("nearFar",a.near,a.far),n.setUniform2f("zScale",0,-1)):(n.setUniform2f("nearFar",a.near,a.far),n.setUniform2f("zScale",1,0));var t=2*this._radius,h=x.dist(a.eye,a.center),t=20*a.computePixelSizeAtDist(h),t=Math.max(.1,t);n.setUniform1f("radius",t);n.setUniform1f("intensity",4*this._attenuation/Math.pow(t,6));n.setUniform1i("rnm",0);n.setUniform1i("normalMap",1);n.setUniform1i("depthMap",2);f.bindTexture(this._noiseTexture,0);f.bindTexture(e.colorTexture,
1);f.bindTexture(c.colorTexture,2);c=this.getQuadVAO();f.bindVAO(c);f.drawArrays(5,0,q.vertexCount(c,"geometry"));f.bindTexture(this._ssaoFBO.colorTexture,0);f.setViewport(0,0,k/this._BLUR_F,l/this._BLUR_F);f.bindFramebuffer(this._blur0FBO);m.setUniform2f("screenDimensions",k,l);m.setUniform1i("tex",0);m.setUniform1i("normalMap",1);m.setUniform1i("depthMap",2);m.setUniform2f("blurSize",0,1*this._BLUR_F/l);m.setUniform1i("radius",4);m.setUniform1f("g_BlurFalloff",.08);m.setUniform2f("nearFar",a.near,
a.far);5E4<h&&(g=Math.max(0,g-(h-5E4)));m.setUniform1f("projScale",g);r?m.setUniform2f("zScale",0,-1):m.setUniform2f("zScale",1,0);f.drawArrays(5,0,q.vertexCount(c,"geometry"));m.setUniform2f("blurSize",1*this._BLUR_F/k,0);f.bindFramebuffer(this._blur1FBO);f.bindTexture(this._blur0FBO.colorTexture,0);f.drawArrays(5,0,q.vertexCount(c,"geometry"));f.bindFramebuffer(b);f.setViewport(this._viewportToRestore[0],this._viewportToRestore[1],this._viewportToRestore[2],this._viewportToRestore[3])}},b.prototype.setUniforms=
function(a){var b=this.getEnableState()&&this._noiseTexture,c=this._rctx;c.bindTexture(b?this._blur1FBO.colorTexture:this._emptyTexture,6);c.setActiveTexture(0);a.setUniform1i("ssaoTex",6);b?a.setUniform4f("viewportPixelSz",this._viewportToRestore[0],this._viewportToRestore[1],1/this._ssaoFBO.width,1/this._ssaoFBO.height):a.setUniform4f("viewportPixelSz",-1,-1,-1,-1)},b.prototype.bindAll=function(a){a=a.getProgramsUsingUniform("viewportPixelSz");for(var b=0;b<a.length;b++)this.setUniforms(a[b])},
b.prototype.drawQuad=function(a){d.assert(this.getEnableState());var b=this._programRep.get("showDepth");this._debugQuadVAO||(this._debugQuadVAO=new e(this._rctx,v.Default3D,{geometry:u.Pos2Tex},{geometry:c.createVertex(this._rctx,35044,M)}));var f=this._rctx;f.setDepthTestEnabled(!1);b.setUniformMatrix4fv("proj",new Float32Array(a));b.setUniform1i("depthTex",0);f.bindTexture(this._ssaoFBO.colorTexture,0);f.bindVAO(this._debugQuadVAO);f.drawArrays(5,0,q.vertexCount(this._debugQuadVAO,"geometry"));
f.setDepthTestEnabled(!0)},b.loadShaders=function(a,b,c,e){d.assert(null==a.samples);a._parse(g);b=new k(e,a.vertexShaderShowDepth,a.fragmentShaderShowDepth,v.Default3D);var f=a.createFsSSAOSrcObscurance,h=new k(e,a.vsUVQuad,f,v.Default3D,{NUM_TAP_SAMPLES:"8"}),l=new k(e,a.vsUVQuad,f,v.Default3D,{NUM_TAP_SAMPLES:"16"}),n=new k(e,a.vsUVQuad,f,v.Default3D,{NUM_TAP_SAMPLES:"32"}),f=new k(e,a.vsUVQuad,f,v.Default3D,{NUM_TAP_SAMPLES:"64"});a=new k(e,a.vsUVQuad,a.fsBlurEdgeAware,v.Default3D,{RADIUS:(4).toString()});
c.add("showDepth",b);c.add("ssao8",h);c.add("ssao16",l);c.add("ssao32",n);c.add("ssao64",f);c.add("blur",a)},b}();var w=y.create(),z=new Float32Array([.186937,0,0,.677503,0,0,-.782832,.128424,.557187,.248064,.460317,-.659755,.062892,.918659,.312829,-.241031,-.814826,.224206,-.642866,.132138,-.45016,.145727,-.590568,-.626141,.005017,-.002234,.012668]),C=new Float32Array([.186937,0,0,.700542,0,0,-.864858,-.481795,-.111713,-.624773,.102853,-.730153,-.387172,.260319,.007229,-.222367,-.642631,-.707697,
-.01336,-.014956,.169662,.122575,.1544,-.456944,-.177141,.85997,-.42346,-.131631,.814545,.524355,-.779469,.007991,.624833,.308092,.209288,.35969,.359331,-.184533,-.377458,.192633,-.482999,-.065284,.233538,.293706,-.055139,.417709,-.386701,.442449,-.301656,-.836426,.408344]),B=new Float32Array([.837372,0,0,.723531,-.467287,.034157,.169582,-.31169,-.881801,.696236,.455215,-.204568,-.304514,.528086,.626381,-.053116,.222507,.037523,.199755,.311291,.916799,-.681552,-.516264,.501792,-.37127,.021088,.737477,
-.029503,.209188,-.95298,-.573731,.009962,-.154202,-.257345,-.905958,.282747,.370779,.527867,-.669424,-.601758,-.191278,-.708243,.271796,.782684,.535565,-.006867,-.015312,-.017276,.419958,.265628,.233036,-.543898,.554747,-.174055,-.079242,.053475,-.099539,.372042,-.339267,-.357362,.015781,-.011352,.042707,-.340564,-.272507,-.067725,.799249,-.127948,.586808,.450015,.01965,-.416454,-.506524,.323229,.206546,-.087316,-.311097,.466049,.146374,-.34528,-.045904,-.152614,-.926686,-.287529,-.665726,-.032904,
.246643,.248703,.637193,-.062541,-.073706,.495925,-.315143,.05946,-.116042,.075586]),F=new Float32Array([.186937,0,0,.605726,-.313457,-.097616,.003541,.781245,.283011,-.225029,-.373279,.274442,-.047511,.04992,-.226365,.627629,-.623617,-.463628,.133094,-.318299,.528128,.262035,.100234,-.09012,.178335,-.426972,-.666048,-.27306,-.207352,.05514,-.613649,-.063395,.060608,-.283391,-.41382,-.087565,.136768,.506126,.484137,-.593808,-.344603,.453164,.675326,.124799,-.697865,-.33502,.411337,-.09337,-.15271,
.002908,-.063582,.366733,-.699739,.401148,-.519536,-.585625,-.508413,.106482,-.428709,-.260221,.012847,-.118806,.016962,-.188182,.49945,.452364,.586617,.722539,-.23302,.111295,.202827,.066695,-.036503,.315842,.896467,-.039109,-.270116,-.080062,.613435,.508787,.538656,-.352275,.566869,-.666275,.887876,-.138341,-.434135,-.444711,.269156,.119506,-.029457,-.077316,.754474,.274125,-.13876,-.37082,-.73268,.332723,.568545,-.203992,.878922,-.430778,.541154,-.546752,.11786,-3.93E-4,-.083318,.059333,-.341406,
-.117017,-.318568,-.262425,-.457913,.848753,.89229,-.30157,.322416,.742328,.032262,.643827,.048091,-.078044,-.49908,.064858,.549944,-.796252,-.230688,.88978,-.010153,.397241,-.27645,.405666,-.46593,.131187,-.600166,.333834,-.078219,.73837,-.870169,-.411658,-.222175,-.492421,.741454,.293757,-.591244,.389112,-.388324,.792346,.578552,.088459,-.121858,-.437241,-.472535,-.374835,.302427,.721264,.057485,.204085,-.126575,.510325,.481492,-.579888,-.29411,-.82136,.156404,-.819717,-.042466,.456573,.079884,
.07019,.179002,.220279,.970222,-.088025,-.299911,-.234627,-.820794,.912112,.243306,.317869,.241336,.161841,-.721568,.301135,-.635993,-.0939,-.514731,-.089673,.850964,-.905087,.314604,-.098397]),G=64,N=[1,1,1,2,3,2,5,2,3,2,3,3,5,5,3,4,7,5,5,7,9,8,5,5,7,7,7,8,5,8,11,12,7,10,13,8,11,8,7,14,11,11,13,12,13,19,17,13,11,18,19,11,11,14,17,21,15,16,17,18,13,17,11,17,19,18,25,18,19,19,29,21,19,27,31,29,21,18,17,29,31,31,23,18,25,26,25,23,19,34,19,27,21,25,39,29,17,21,27,29],M=new Float32Array([0,0,0,0,512,
0,1,0,0,512,0,1,512,512,1,1]);return m})},"esri/views/3d/webgl-engine/lib/ShadowMap":function(){define("./Camera ./Util ./gl-matrix ../../../../core/Logger ../../../webgl/Texture ../../../webgl/FramebufferObject ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ./DefaultVertexAttributeLocations ./DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(m,l,h,d,b,g,k,f,a,e,c){var q=h.vec2d,t=h.vec3d,r=h.vec4d,u=h.mat3d,v=h.mat4d,x=h.mat4,y=d.getLogger("esri.views.3d.webgl-engine.lib.ShadowMap");
return function(d,h){function n(a,b){return t.set3(a[b],a[b+3],a[b+6],sa),sa}var w,B,F=h.gl,G=4096,N=new b(h,{target:F.TEXTURE_2D,pixelFormat:F.RGBA,dataType:F.UNSIGNED_BYTE,samplingMode:F.NEAREST,width:4,height:4}),M=1,R=2,P=[0,0,0,0,0];this.dispose=function(){N.dispose();N=null};var Q,T,O,S=function(){this.camera=new m;this.lightMat=v.create()},H=[];for(Q=0;4>Q;++Q)H[Q]=new S;this.getIsSupported=function(){return h.extensions.standardDerivatives};this.setTextureResolution=function(a){G=a};this.getTextureResolution=
function(){return G};this.setMaxNumCascades=function(a){R=l.clamp(Math.floor(a),1,4)};this.getMaxNumCascades=function(){return R};this.setEnableState=function(a){a?this.enable():this.disable()};this.getEnableState=function(){return void 0!==w};this.getDepthTexture=function(){return w};this.enable=function(){if(!this.getEnableState()){if(!this.getIsSupported())return void y.warn("Shadow maps are not supported for this browser or hardware");w=new b(h,{target:F.TEXTURE_2D,pixelFormat:F.RGBA,dataType:F.UNSIGNED_BYTE,
wrapMode:F.CLAMP_TO_EDGE,samplingMode:F.NEAREST,flipped:!0,width:G,height:G});B=g.createWithAttachments(h,w,{colorTarget:0,depthStencilTarget:1,width:G,height:G})}};this.disable=function(){this.getEnableState()&&B&&(B.dispose(),B=void 0,w=void 0)};var Y=v.create(),W=v.create(),E=r.create(),p=Array(8);for(Q=0;8>Q;++Q)p[Q]=r.create();var A=t.create(),K=t.create(),U=q.create(),V=q.create(),X=q.create(),ba=q.create(),fa=q.create(),ha=v.create(),ca=t.create();this.prepare=function(a,b,c,e){l.assert(this.getEnableState());
v.multiply(a.projectionMatrix,a.viewMatrix,Y);var d=e[0],f=e[1];2>d&&(d=2);2>f&&(f=2);d>=f&&(d=2,f=4);M=Math.min(1+Math.floor(l.logWithBase(f/d,4)),R);c=Math.pow(f/d,1/M);for(e=0;M+1>e;++e)P[e]=d*Math.pow(c,e);v.inverse(Y,W);v.lookAt([0,0,0],[-b[0],-b[1],-b[2]],[0,1,0],ha);c=a.viewMatrix;a=a.projectionMatrix;for(e=0;M>e;++e){var g=H[e],d=-P[e],f=-P[e+1],d=(a[10]*d+a[14])/Math.abs(a[11]*d+a[15]),f=(a[10]*f+a[14])/Math.abs(a[11]*f+a[15]);l.assert(f>d);for(T=0;8>T;++T)for(r.set4(0===T%4||3==T%4?-1:1,
0===T%4||1==T%4?-1:1,4>T?d:f,1,E),v.multiplyVec4(W,E,p[T]),O=0;3>O;++O)p[T][O]/=p[T][3];t.negate(p[0],ca);v.translate(ha,ca,g.camera.viewMatrix);for(T=0;8>T;++T)v.multiplyVec3(g.camera.viewMatrix,p[T]);t.set(p[0],A);t.set(p[0],K);for(T=1;8>T;++T)for(O=0;3>O;++O)A[O]=Math.min(A[O],p[T][O]),K[O]=Math.max(K[O],p[T][O]);A[2]-=200;K[2]+=200;g.camera.near=-K[2];g.camera.far=-A[2];d=1/p[0][3];f=1/p[4][3];l.assert(f>d);var k=d+Math.sqrt(d*f),m=Math.sin(Math.acos(c[2]*b[0]+c[6]*b[1]+c[10]*b[2])),k=k/m,d=p,
u=k,w=m,m=U,x=V,y=X,z=ba,k=fa;q.set2(0,0,wa);for(var C=void 0,C=0;4>C;++C)q.add(wa,d[C],wa);q.scale(wa,.25);q.set2(0,0,da);for(C=4;8>C;++C)q.add(da,d[C],da);q.scale(da,.25);q.lerp(d[4],d[5],.5,ra[0]);q.lerp(d[5],d[6],.5,ra[1]);q.lerp(d[6],d[7],.5,ra[2]);q.lerp(d[7],d[4],.5,ra[3]);for(var N=0,S=q.dist2(ra[0],wa),C=1;4>C;++C){var Q=q.dist2(ra[C],wa);S>Q&&(S=Q,N=C)}q.subtract(ra[N],d[N+4],ga);C=ga[0];ga[0]=-ga[1];ga[1]=C;q.subtract(da,wa,pa);q.lerp(ga,pa,w);q.normalize(ga);N=w=void 0;w=N=q.dot(q.subtract(d[0],
wa,J),ga);for(C=1;8>C;++C)S=q.dot(q.subtract(d[C],wa,J),ga),w>S?w=S:S>N&&(N=S);q.set(wa,m);q.scale(ga,w-u,J);q.add(m,J,m);for(var Q=-1,ea=1,C=u=S=0;8>C;++C){q.subtract(d[C],m,D);q.normalize(D);var sa=ga[0]*D[1]-ga[1]*D[0];0<sa?sa>Q&&(Q=sa,S=C):ea>sa&&(ea=sa,u=C)}l.verify(0<Q,"leftArea");l.verify(0>ea,"rightArea");q.scale(ga,w,Ea);q.add(Ea,wa,Ea);q.scale(ga,N,L);q.add(L,wa,L);Fa[0]=-ga[1];Fa[1]=ga[0];x=l.rayRay2D(m,d[u],L,q.add(L,Fa,J),1,x);y=l.rayRay2D(m,d[S],L,J,1,y);z=l.rayRay2D(m,d[S],Ea,q.add(Ea,
Fa,J),1,z);d=l.rayRay2D(m,d[u],Ea,J,1,k);l.verify(x,"rayRay");l.verify(y,"rayRay");l.verify(z,"rayRay");l.verify(d,"rayRay");y=U;d=V;m=ba;z=fa;k=g.camera.projectionMatrix;q.scale(q.subtract(m,z,Z),.5);ma[0]=Z[0];ma[1]=Z[1];ma[2]=0;ma[3]=Z[1];ma[4]=-Z[0];ma[5]=0;ma[6]=Z[0]*Z[0]+Z[1]*Z[1];ma[7]=Z[0]*Z[1]-Z[1]*Z[0];ma[8]=1;ma[6]=-q.dot(n(ma,0),y);ma[7]=-q.dot(n(ma,1),y);y=q.dot(n(ma,0),m)+ma[6];x=q.dot(n(ma,1),m)+ma[7];C=q.dot(n(ma,0),z)+ma[6];z=q.dot(n(ma,1),z)+ma[7];y=-(y+C)/(x+z);ma[0]+=ma[1]*y;ma[3]+=
ma[4]*y;ma[6]+=ma[7]*y;y=1/(q.dot(n(ma,0),m)+ma[6]);x=1/(q.dot(n(ma,1),m)+ma[7]);ma[0]*=y;ma[3]*=y;ma[6]*=y;ma[1]*=x;ma[4]*=x;ma[7]*=x;ma[2]=ma[1];ma[5]=ma[4];ma[8]=ma[7];ma[7]+=1;y=q.dot(n(ma,1),d)+ma[7];x=q.dot(n(ma,2),d)+ma[8];C=q.dot(n(ma,1),m)+ma[7];z=q.dot(n(ma,2),m)+ma[8];y=-.5*(y/x+C/z);ma[1]+=ma[2]*y;ma[4]+=ma[5]*y;ma[7]+=ma[8]*y;y=q.dot(n(ma,1),d)+ma[7];x=q.dot(n(ma,2),d)+ma[8];C=-x/y;ma[1]*=C;ma[4]*=C;ma[7]*=C;k[0]=ma[0];k[1]=ma[1];k[2]=0;k[3]=ma[2];k[4]=ma[3];k[5]=ma[4];k[6]=0;k[7]=ma[5];
k[8]=0;k[9]=0;k[10]=1;k[11]=0;k[12]=ma[6];k[13]=ma[7];k[14]=0;k[15]=ma[8];g.camera.projectionMatrix[10]=2/(A[2]-K[2]);g.camera.projectionMatrix[14]=-(A[2]+K[2])/(A[2]-K[2]);v.multiply(g.camera.projectionMatrix,g.camera.viewMatrix,g.lightMat);d=G/2;g.camera.viewport[0]=0===e%2?0:d;g.camera.viewport[1]=0===Math.floor(e/2)?0:d;g.camera.viewport[2]=d;g.camera.viewport[3]=d}ja=void 0;P[M]=100*f;h.bindFramebuffer(B);h.bindTexture(null,7);h.setClearColor(1,1,1,1);h.clear(F.COLOR_BUFFER_BIT|F.DEPTH_BUFFER_BIT);
h.setBlendingEnabled(!1)};var ea=[];this.getCascades=function(){for(var a=0;M>a;++a)ea[a]=H[a];return ea.length=M,ea};this.finish=function(a){l.assert(this.getEnableState());h.bindFramebuffer(a)};this.bind=function(a){var b=this.getEnableState();h.bindTexture(b?w:N,7);h.bindProgram(a);a.setUniform1i("depthTex",7);a.setUniform1f("depthHalfPixelSz",b?.5/G:-1);a.setUniform1i("shadowMapNum",M);a.setUniform4f("shadowMapDistance",P[0],P[1],P[2],P[3])};this.bindAll=function(a){a=a.getProgramsUsingUniform("shadowMapDistance");
for(var b=0;b<a.length;b++)this.bind(a[b])};var ja,na=x.create(),za=new Float32Array(64);this.bindView=function(a,b){if(this.getEnableState()){if(!ja||ja[0]!==b[0]||ja[1]!==b[1]||ja[2]!==b[2]){var c;ja=ja||t.create();t.set(b,ja);for(T=0;M>T;++T)for(x.translate(H[T].lightMat,b,na),c=0;16>c;++c)za[16*T+c]=na[c]}a.setUniformMatrix4fv("shadowMapMatrix",za)}};Q=new Float32Array(16);Q[0]=0;Q[1]=0;Q[2]=0;Q[3]=0;Q[4]=256;Q[5]=0;Q[6]=1;Q[7]=0;Q[8]=0;Q[9]=256;Q[10]=0;Q[11]=1;Q[12]=256;Q[13]=256;Q[14]=1;Q[15]=
1;var ua=new k(h,a.Default3D,{geometry:e.Pos2Tex},{geometry:f.createVertex(h,F.STATIC_DRAW,Q)});this.drawDebugQuad=function(a){l.assert(this.getEnableState());var b=d.get("showDepth");h.setDepthTestEnabled(!1);h.bindProgram(b);b.setUniformMatrix4fv("proj",a);b.setUniform1i("depthTex",0);h.bindTexture(w,0);h.bindVAO(ua);c.assertCompatibleVertexAttributeLocations(ua,b);h.drawArrays(F.TRIANGLE_STRIP,0,c.vertexCount(ua,"geometry"));h.setDepthTestEnabled(!0)};var wa=q.create(),da=q.create(),ra=[q.create(),
q.create(),q.create(),q.create()],ga=q.create(),pa=q.create(),J=q.create(),D=q.create(),Ea=q.create(),L=q.create(),Fa=q.create(),sa=t.create(),Z=q.create(),ma=u.create()}})},"esri/views/3d/webgl-engine/lib/NearFarCalc":function(){define(["require","exports","./Util","./gl-matrix","./ComponentUtils"],function(m,l,h,d,b){m=d.vec3d;var g=d.vec4d,k=d.mat4d;d=function(){function a(){this._context={content:[],near:[],far:[],nearSpecial:[],farSpecial:[],bestNear:0,bestFar:0,bestNear2:0,bestFar2:0};this._boundingInfoHelper=
new f}return a.prototype._resetContext=function(){var a=this._context;return a.content.length=0,a.near.length=0,a.far.length=0,a.nearSpecial.length=0,a.farSpecial.length=0,a.bestNear=Number.MAX_VALUE,a.bestFar=-Number.MAX_VALUE,this._context},a.prototype.calculateSceneNearFar=function(a,e){var d=this._resetContext(),f=a.viewMatrix,g=f[2],h=f[6],k=f[10],l=f[14],q=0,m;for(m in e)if(f=e[m],!b.isAllHidden(f.instanceParameters.componentVisibilities,f.componentOffsets)&&f.castShadow){var r=void 0,t=void 0;
f.hasShaderTransformation?(r=f.getBoundingSphere(f.getShaderTransformation(),null,c),t=c):(r=f.bsRadius,t=f.center);var u=g*t[0]+h*t[1]+k*t[2]+l,t=u-r,r=u+r;d.content[q]=f;d.near[q]=-r;d.far[q]=-t;++q}if(0===q)return[d.bestNear,d.bestFar];for(e=0;q>e;++e)d.near[e]>d.bestFar&&(d.bestFar=d.near[e]),2<d.near[e]&&d.far[e]<d.bestNear&&(d.bestNear=d.far[e]);d.bestNear2=Math.max(.5*d.bestNear,2);d.bestFar2=2*d.bestFar;for(e=h=g=0;q>e;++e)d.near[e]<d.bestNear&&(d.near[e]>=d.bestNear2?d.bestNear=d.near[e]:
d.nearSpecial[g++]=e),d.far[e]>d.bestFar&&(d.far[e]<=d.bestFar2?d.bestFar=d.far[e]:d.farSpecial[h++]=e);if(0===g&&0===h)return[d.bestNear,d.bestFar];d.nearSpecial.length=g;d.farSpecial.length=h;d.nearSpecial.sort(function(a,b){return d.near[a]<d.near[b]?-1:d.near[a]>d.near[b]?1:0});d.farSpecial.sort(function(a,b){return d.far[a]<d.far[b]?1:d.far[a]>d.far[b]?-1:0});this._boundingInfoHelper.init(a,d);for(e=0;g>e;++e)d.near[d.nearSpecial[e]]<d.bestNear&&(f=d.content[d.nearSpecial[e]],a=f.boundingInfo,
this._boundingInfoHelper.includeNearBoundingInfoRec(a,f.getShaderTransformation()));for(e=0;h>e;++e)d.far[d.farSpecial[e]]>d.bestFar&&(f=d.content[d.farSpecial[e]],a=f.boundingInfo,this._boundingInfoHelper.includeFarBoundingInfoRec(a,f.getShaderTransformation()));return[d.bestNear,d.bestFar]},a}();var f=function(){function b(){this._clippingHelper=new a;this._planes=[g.create(),g.create(),g.create(),g.create(),g.create(),g.create()];this._viewProj=k.create();this._view=k.create()}return b.prototype.init=
function(a,b){this._context=b;k.set(a.viewMatrix,this._view);k.multiply(a.projectionMatrix,this._view,this._viewProj);a.copyFrustumPlanes(this._planes);this._clippingHelper.init(b)},b.prototype.includeNearBoundingInfoRec=function(a,b){var e=a.getBSRadius(),d=a.getCenter();k.multiplyVec3(b,d,c);var d=c[0],f=c[1],g=c[2];if(e*=Math.sqrt(Math.max(Math.max(b[0]*b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+b[9]*b[9]),b[2]*b[2]+b[6]*b[6]+b[10]*b[10])),!(this._planes[0][0]*d+this._planes[0][1]*f+this._planes[0][2]*
g+this._planes[0][3]>e||this._planes[1][0]*d+this._planes[1][1]*f+this._planes[1][2]*g+this._planes[1][3]>e||this._planes[2][0]*d+this._planes[2][1]*f+this._planes[2][2]*g+this._planes[2][3]>e||this._planes[3][0]*d+this._planes[3][1]*f+this._planes[3][2]*g+this._planes[3][3]>e))if(d=this._view[2]*d+this._view[6]*f+this._view[10]*g+this._view[14],f=d+e,!(2>-(d-e)||-f>=this._context.bestNear)){if(-f>this._context.bestNear2)return void(this._context.bestNear=-f);if(100<e&&(e=a.getChildren(),void 0!==
e)){for(a=0;8>a;++a)void 0!==e[a]&&this.includeNearBoundingInfoRec(e[a],b);return}this._clippingHelper.intersectFrustumAABB(this._viewProj,b,a.getBBMin(),a.getBBMax())}},b.prototype.includeFarBoundingInfoRec=function(a,b){var e=a.getBSRadius(),d=a.getCenter();k.multiplyVec3(b,d,c);var d=c[0],f=c[1],g=c[2];if(e*=Math.sqrt(Math.max(Math.max(b[0]*b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+b[9]*b[9]),b[2]*b[2]+b[6]*b[6]+b[10]*b[10])),!(this._planes[0][0]*d+this._planes[0][1]*f+this._planes[0][2]*g+
this._planes[0][3]>e||this._planes[1][0]*d+this._planes[1][1]*f+this._planes[1][2]*g+this._planes[1][3]>e||this._planes[2][0]*d+this._planes[2][1]*f+this._planes[2][2]*g+this._planes[2][3]>e||this._planes[3][0]*d+this._planes[3][1]*f+this._planes[3][2]*g+this._planes[3][3]>e))if(d=this._view[2]*d+this._view[6]*f+this._view[10]*g+this._view[14]-e,!(-d<=this._context.bestFar)){if(-d<this._context.bestFar2)return void(this._context.bestFar=-d);if(100<e&&(e=a.getChildren(),void 0!==e)){for(a=0;8>a;++a)void 0!==
e[a]&&this.includeFarBoundingInfoRec(e[a],b);return}this._clippingHelper.intersectFrustumAABB(this._viewProj,b,a.getBBMin(),a.getBBMax())}},b}(),a=function(){function a(){this._clipP=Array(8);for(var a=0;8>a;++a)this._clipP[a]=g.create()}return a.prototype.init=function(a){this._context=a},a.prototype.intersectFrustumAABB=function(a,b,c,d){k.multiply(a,b,q);for(a=0;8>a;++a){b=this._clipP[a];var f=0===a||3===a||4===a||7===a?c[0]:d[0],g=0===a||1===a||4===a||5===a?c[1]:d[1],h=4>a?c[2]:d[2];b[0]=q[0]*
f+q[4]*g+q[8]*h+q[12];b[1]=q[1]*f+q[5]*g+q[9]*h+q[13];b[2]=q[2]*f+q[6]*g+q[10]*h+q[14];b[3]=q[3]*f+q[7]*g+q[11]*h+q[15]}for(a=0;12>a;++a){c=this._clipTriangle(this._clipP[e[a][0]],this._clipP[e[a][1]],this._clipP[e[a][2]]);d=!0;for(b=0;b<c.length;++b)if(f=c[b][3],2<=f){d=!1;break}if(!d)for(b=0;b<c.length;++b)f=c[b][3],f<this._context.bestNear&&(this._context.bestNear=f),f>this._context.bestFar&&(this._context.bestFar=f)}},a.prototype._inside=function(a,b){return 0===b?a[0]>=-a[3]:1===b?a[1]>=-a[3]:
2===b?a[0]<=a[3]:3===b?a[1]<=a[3]:void h.assert(!1)},a.prototype._intersect=function(a,b,c){var e=0;return 0===c?e=(-a[3]-a[0])/(b[0]-a[0]+b[3]-a[3]):1===c?e=(-a[3]-a[1])/(b[1]-a[1]+b[3]-a[3]):2===c?e=(a[3]-a[0])/(b[0]-a[0]-b[3]+a[3]):3===c&&(e=(a[3]-a[1])/(b[1]-a[1]-b[3]+a[3])),g.lerp(a,b,e,g.create())},a.prototype._clipTriangle=function(a,b,c){a=[a,b,c];for(b=0;4>b;++b){c=a;a=[];for(var e=0;e<c.length;++e){var d=c[e],f=c[(e+1)%c.length];this._inside(f,b)?(this._inside(d,b)||a.push(this._intersect(d,
f,b)),a.push(f)):this._inside(d,b)&&a.push(this._intersect(d,f,b))}}return a},a}(),e=[[0,1,3],[2,3,1],[1,5,2],[6,2,5],[5,4,6],[7,6,4],[4,0,7],[3,7,0],[3,2,7],[6,7,2],[4,5,0],[1,0,5]],c=m.create(),q=k.create();return d})},"esri/views/3d/webgl-engine/lib/HighlightHelper":function(){define("require exports ./Util ./gl-matrix dojo/text!../materials/internal/highlight.xml ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations ../../support/debugFlags".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){var u=d.vec4d;return function(){function c(a,b,c){this._grid={coverageMipmap:null,vao:null,verticalCellCount:0,horizontalCellCount:0,cellPixelSize:0,mipmapLevels:0,viewportWidth:0,viewportHeight:0};this.blur1Fbo=this.blur0Fbo=this.quadVAO=null;this._rctx=c;this.viewportToRestore=u.create();this.programRep=a;this.defaultOptions={color:new Float32Array([1,0,1,1]),haloOpacity:1,fillOpacity:.2,haloOpacityOccluded:.25,fillOpacityOccluded:.05}}return c.prototype._gridUpdateResources=
function(b,c){var e=this._rctx,d=this._grid,h=!1;if(null===d.coverageMipmap&&(d.coverageMipmap=[b],h=!0),(d.viewportWidth!==b.width||d.viewportHeight!==b.height)&&(h=!0,d.viewportWidth=b.width,d.viewportHeight=b.height),d.coverageMipmap[0]=b,d.cellPixelSize!==c&&(d.cellPixelSize=c,h=!0),h){for(c=1;c<d.coverageMipmap.length;c++)d.coverageMipmap[c].dispose();d.mipmapLevels=Math.ceil(Math.log(d.cellPixelSize)*Math.LOG2E);d.coverageMipmap.length=d.mipmapLevels+1;for(c=0;c<d.mipmapLevels;c++)h=d.coverageMipmap[c],
h=g.createWithAttachments(e,{target:3553,pixelFormat:6407,dataType:33635,samplingMode:9729,wrapMode:33071,width:Math.ceil(h.width/2),height:Math.ceil(h.height/2)},{colorTarget:0,depthStencilTarget:0,width:Math.ceil(h.width/2),height:Math.ceil(h.height/2)}),d.coverageMipmap[c+1]=h}var h=Math.ceil(b.height/d.cellPixelSize),k=Math.ceil(b.width/d.cellPixelSize);if(!d.vao||d.verticalCellCount!==h||d.horizontalCellCount!==k){d.verticalCellCount=h;d.horizontalCellCount=k;b=h+1;c=k+1;for(var h=1/h,k=1/k,
l=new Float32Array(24*b*c),m=0,r=0;b>r;r++)for(var u=0;c>u;u++)l[m+0]=(u-.5)*k*2-1,l[m+1]=(r-.5)*h*2-1,l[m+2]=u*k,l[m+3]=r*h,l[m+4]=(u+.5)*k*2-1,l[m+5]=(r-.5)*h*2-1,l[m+6]=u*k,l[m+7]=r*h,l[m+8]=(u-.5)*k*2-1,l[m+9]=(r+.5)*h*2-1,l[m+10]=u*k,l[m+11]=r*h,l[m+12]=(u-.5)*k*2-1,l[m+13]=(r+.5)*h*2-1,l[m+14]=u*k,l[m+15]=r*h,l[m+16]=(u+.5)*k*2-1,l[m+17]=(r-.5)*h*2-1,l[m+18]=u*k,l[m+19]=r*h,l[m+20]=(u+.5)*k*2-1,l[m+21]=(r+.5)*h*2-1,l[m+22]=u*k,l[m+23]=r*h,m+=24;d.vao&&d.vao.dispose(!0);d.vao=new f(e,t.Default3D,
{geometry:q.Pos2Tex},{geometry:a.createVertex(e,35044,l)})}},c.prototype._gridComputeMipmap=function(){var a=this._rctx,b=this._grid,c=this.programRep.get("conservative-downsample");a.bindVAO(this.quadVAO);for(var d=0;d<b.mipmapLevels;d++){a.bindFramebuffer(b.coverageMipmap[d+1]);a.bindTexture(b.coverageMipmap[d].colorTexture,0);var f=b.coverageMipmap[d+1].width,g=b.coverageMipmap[d+1].height;a.bindProgram(c);c.setUniform1i("tex",0);c.setUniform2f("invFramebufferDim",1/f,1/g);a.setViewport(0,0,f,
g);a.drawArrays(5,0,e.vertexCount(this.quadVAO,"geometry"))}},c.prototype.createQuadVAO=function(){var b=this._rctx,c=new Float32Array([-1,-1,1,-1,-1,1,1,1]);return new f(b,t.Default3D,{geometry:q.Pos2},{geometry:a.createVertex(b,35044,c)})},Object.defineProperty(c.prototype,"profilingCallback",{get:function(){return r.HIGHLIGHTS_PROFILE_TO_CONSOLE?function(a){return console.log(a)}:null},enumerable:!0,configurable:!0}),c.prototype.getIsSupported=function(){return!0},c.prototype.setEnableState=function(a){a?
this.enable():this.disable()},c.prototype.getEnableState=function(){return null!==this.blur0Fbo},c.prototype.enable=function(){this.quadVAO=this.createQuadVAO();var a={colorTarget:0,depthStencilTarget:0,width:0,height:0},b={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:0,height:0};this.blur0Fbo=g.createWithAttachments(this._rctx,b,a);this.blur1Fbo=g.createWithAttachments(this._rctx,b,a)},c.prototype.disable=function(){this.getEnableState()&&(this.quadVAO.dispose(!0),
this.blur1Fbo.dispose(),this.blur0Fbo.dispose(),this.quadVAO=null,this.blur0Fbo=null,this.blur1Fbo=null)},c.prototype.getHighlightFBO=function(){return this.blur0Fbo},c.prototype.render=function(a,b,c){var d=!r.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED,f=r.HIGHLIGHTS_VISUALIZE_BLOCKS,g=this._rctx;h.assert(this.getEnableState());u.set(a.fullViewport,this.viewportToRestore);a=Math.ceil(c.width/1);var k=Math.ceil(c.height/1);this.blur0Fbo.resize(a,k);this.blur1Fbo.resize(a,k);g.bindVAO(this.quadVAO);g.setDepthWriteEnabled(!1);
g.setDepthTestEnabled(!1);g.setBlendingEnabled(!1);var l=null,n=l=null,q=null;if(d){var m=this._grid;this._gridUpdateResources(c,32);this._gridComputeMipmap();n=m.vao;q=4;l=this.programRep.get("highlight-blur-grid-5");g.bindProgram(l);g.bindTexture(m.coverageMipmap[m.mipmapLevels].colorTexture,1);l.setUniform1i("coverageTex",1)}else n=this.quadVAO,q=5,l=this.programRep.get("highlight-blur-5"),g.bindProgram(l);(g.bindVAO(n),g.bindFramebuffer(this.blur0Fbo),g.setViewport(0,0,a,k),g.setClearColor(0,
0,0,0),g.clear(g.gl.COLOR_BUFFER_BIT),l.setUniform1i("tex",0),g.bindTexture(c.colorTexture,0),l.setUniform2f("blurSize",1/a,0),g.drawArrays(q,0,e.vertexCount(n,"geometry")),g.bindFramebuffer(this.blur1Fbo),g.clear(g.gl.COLOR_BUFFER_BIT),g.bindTexture(this.blur0Fbo.colorTexture,0),l.setUniform2f("blurSize",0,1/k),g.drawArrays(q,0,e.vertexCount(n,"geometry")),g.bindFramebuffer(b),g.setBlendingEnabled(!0),g.setBlendFunctionSeparate(770,771,1,771),g.setViewport(this.viewportToRestore[0],this.viewportToRestore[1],
this.viewportToRestore[2],this.viewportToRestore[3]),d)?(l=this.programRep.get(f?"highlight-apply-grid-debug":"highlight-apply-grid"),g.bindProgram(l),l.setUniform1i("coverageTex",2),g.bindTexture(this._grid.coverageMipmap[this._grid.mipmapLevels].colorTexture,2)):(l=this.programRep.get("highlight-apply"),g.bindProgram(l));l.setUniform1i("tex",0);g.bindTexture(this.blur1Fbo.colorTexture,0);l.setUniform1i("origin",1);g.bindTexture(c.colorTexture,1);l.setUniform4fv("color",this.defaultOptions.color);
l.setUniform1f("outlineSize",8.6);l.setUniform1f("blurSize",.4);l.setUniform4f("opacities",this.defaultOptions.haloOpacity,this.defaultOptions.haloOpacityOccluded,this.defaultOptions.fillOpacity,this.defaultOptions.fillOpacityOccluded);g.drawArrays(q,0,e.vertexCount(n,"geometry"));g.bindVAO(null);g.setDepthWriteEnabled(!0);g.setDepthTestEnabled(!0);g.setBlendingEnabled(!1)},c.prototype.setDefaultOptions=function(a){this.defaultOptions=a},c.loadShaders=function(a,c,e,d){a._parse(b);c=0;for(var f=["3",
"5","7","9"];c<f.length;c++){var g=f[c];e.add("highlight-blur-"+g,new k(d,a.vsHighlightBlurFastGaussian,a.fsHighlightBlurFastGaussian,t.Default3D,{GAUSSIAN_SAMPLES:g}));e.add("highlight-blur-grid-"+g,new k(d,a.vsHighlightBlurFastGaussian,a.fsHighlightBlurFastGaussian,t.Default3D,{GAUSSIAN_SAMPLES:g,GRID_OPTIMIZATION:"true"}))}e.add("highlight-apply",new k(d,a.vsHighlightApply,a.fsHighlightApply,t.Default3D));e.add("highlight-apply-grid",new k(d,a.vsHighlightApply,a.fsHighlightApply,t.Default3D,["GRID_OPTIMIZATION"]));
e.add("highlight-apply-grid-debug",new k(d,a.vsHighlightApply,a.fsHighlightApply,t.Default3D,["GRID_OPTIMIZATION","GRID_DEBUG"]));e.add("conservative-downsample",new k(d,a.vsConservativeDownsample,a.fsConservativeDownsample,t.Default3D))},c}()})},"esri/views/3d/webgl-engine/lib/RenderOccludedHelper":function(){define("require exports ./Util ./gl-matrix dojo/text!../materials/internal/occluded.xml ../../../webgl/FramebufferObject ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums ./DefaultVertexBufferLayouts ./DefaultVertexAttributeLocations".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){var r=d.vec4d;return function(){function c(a,b,c){this._quadVAO=null;this._rctx=c;this._colorFBO=void 0;this._viewportToRestore=r.create();this.programRep=a}return Object.defineProperty(c.prototype,"colorFBO",{get:function(){return this._colorFBO},enumerable:!0,configurable:!0}),c.prototype.createQuadVAO=function(){var b=this._rctx,c=new Float32Array([-1,-1,1,-1,-1,1,1,1]);return new f(b,t.Default3D,{geometry:q.Pos2},{geometry:a.createVertex(b,35044,c)})},c.prototype.setEnableState=
function(a){a?this.enable():this.disable()},c.prototype.getEnableState=function(){return void 0!==this._colorFBO},c.prototype.enable=function(){this._quadVAO=this.createQuadVAO();this._colorFBO=g.createWithAttachments(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:0,height:0},{colorTarget:0,depthStencilTarget:1})},c.prototype.disable=function(){this.getEnableState()&&(this._quadVAO.dispose(!0),this._quadVAO=void 0,this._colorFBO.dispose(),this._colorFBO=
void 0)},c.prototype.setupFBOs=function(a){h.assert(this.getEnableState());this._viewportToRestore=a=a.fullViewport;this._width=a[2];this._height=a[3];this._rctx.setViewport(0,0,this._width,this._height)},c.prototype.prepareColorPass=function(){h.assert(this.getEnableState());var a=this._rctx,b=a.gl;this._colorFBO.resize(this._width,this._height);a.bindFramebuffer(this._colorFBO);a.setClearColor(0,0,0,0);a.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)},c.prototype.finish=function(a){var b=this._rctx;
b.bindFramebuffer(a);b.setViewport(this._viewportToRestore[0],this._viewportToRestore[1],this._viewportToRestore[2],this._viewportToRestore[3])},c.prototype.apply=function(){var a=this._rctx,b=this.programRep.get("render-occluded-apply");a.bindProgram(b);a.bindVAO(this._quadVAO);a.bindTexture(this._colorFBO.colorTexture,0);b.setUniform1i("occludedColorMap",0);a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setBlendingEnabled(!0);a.setBlendFunction(770,771);a.drawArrays(5,0,e.vertexCount(this._quadVAO,
"geometry"));a.bindVAO(null);a.setDepthWriteEnabled(!0);a.setDepthTestEnabled(!0);a.setBlendingEnabled(!1)},c.loadShaders=function(a,c,e,d){a._parse(b);e.add("render-occluded-apply",new k(d,a.vsRenderOccludedApply,a.fsRenderOccludedApply,t.Default3D))},c}()})},"esri/views/3d/webgl-engine/materials/repository":function(){define("dojo/text!./internal/util.xml dojo/text!./internal/hud.xml ./BillboardMaterial ./ColorMaterial ./HUDMaterial ./LineCalloutMaterial ./LeafCardMaterial ./Material ./RibbonLineMaterial ./WaterMaterial ./MeasurementArrowMaterial ./internal/SimpleGLMaterial ./internal/TexOnlyGLMaterial ./internal/BlendLayers".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){return{initializeShaders:function(u,v,x,y){u._parse(m);u._parse(l);q.loadShaders(u,v,x,y);t.loadShaders(u,v,x,y);f.loadShaders(u,v,x,y);h.loadShaders(u,v,x,y);b.loadShaders(u,v,x,y);g.loadShaders(u,v,x,y);k.loadShaders(u,v,x,y);a.loadShaders(u,v,x,y);e.loadShaders(u,v,x,y);r.loadShaders(u,v,x,y);d.loadShaders(u,v,x,y);c.loadShaders(u,v,x,y)}}})},"esri/views/3d/webgl-engine/materials/BillboardMaterial":function(){define("dojo/text!./BillboardMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(m,l,h,d,b,g,k){var f=function(b,d){l.basicMaterialConstructor(this,d);var f=g.Pos3NormTex;this.getSize=function(){return 1.05};this.dispose=function(){};this.getTextureId=function(){return b};this.getOutputAmount=function(a){var b=k.getStride(f)/4;return a*b*6};this.getVertexBufferLayout=function(){return f};this.fillInterleaved=function(a,b,c,e,d,f){e=l.fill;var g=a.indices.va,h=a.vertexAttr.va.data,k=a.vertexAttr.tc4.data,n=a.vertexAttr.n0.data,q=a.vertexAttr.n1.data,m=a.vertexAttr.n2.data;
a=a.vertexAttr.n3.data;for(var r=0;r<g.length;++r){var t=4*g[r],u=3*g[r];f+=e(h,t,d,f,b,3);f+=e(n,u,d,f,c,3);d[f++]=k[t];d[f++]=k[t+1];f+=e(h,t,d,f,b,3);f+=e(q,u,d,f,c,3);d[f++]=k[t+2]+1;d[f++]=k[t+1];f+=e(h,t,d,f,b,3);f+=e(m,u,d,f,c,3);d[f++]=k[t+2]+1;d[f++]=k[t+3]+1;f+=e(h,t,d,f,b,3);f+=e(m,u,d,f,c,3);d[f++]=k[t+2]+1;d[f++]=k[t+3]+1;f+=e(h,t,d,f,b,3);f+=e(a,u,d,f,c,3);d[f++]=k[t];d[f++]=k[t+3]+1;f+=e(h,t,d,f,b,3);f+=e(n,u,d,f,c,3);d[f++]=k[t];d[f++]=k[t+1]}};this.intersect=function(){};this.getGLMaterials=
function(){return{color:a,depthShadowMap:c,normal:void 0,depth:e,highlight:void 0}};this.getAllTextureIds=function(){return[b]}},a=function(a,b,c){l.basicGLMaterialConstructor(this,a);var e=h.TRANSPARENT_MATERIAL,d=b.get("billboard");l.singleTextureGLMaterialConstructor(this,c,{textureId:a.getTextureId()});this.beginSlot=function(a){return e===a};this.getProgram=function(){return d};this.bind=function(a,b){a.bindProgram(d);this.bindTexture(a,d);a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,
a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);a.setDepthTestEnabled(!0)};this.release=function(a){};this.bindView=function(a,b){l.bindView(b.origin,b.view,d)};this.bindInstance=function(a,b){d.setUniformMatrix4fv("model",b.transformation);d.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},e=function(a,b,c,e){l.basicGLMaterialConstructor(this,a);var d=h.TRANSPARENT_MATERIAL,f=null==e?b.get("billboardDepth"):b.get("billboardDepthShadowMap");
l.singleTextureGLMaterialConstructor(this,c,{textureId:a.getTextureId()});this.beginSlot=function(a){return d===a};this.getProgram=function(){return f};this.bind=function(a,b){a.bindProgram(f);this.bindTexture(a,f);f.setUniform2fv("nearFar",b.nearFar)};this.release=function(a){};this.bindView=function(a,b){l.bindView(b.origin,b.view,f)};this.bindInstance=function(a,b){f.detUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},c=function(a,b,c){e.call(this,
a,b,c,!0)};return f.loadShaders=function(a,c,e,f){a._parse(m);var g=new d(f,a.vertexShaderBillboard,a.fragmentShaderBillboard,b.Default3D),h=c.get("fsDepthTextured");c=c.get("fsDepthTexturedShadowMap");h=new d(f,a.vertexShaderBillboardDepth,h.source,b.Default3D,h.defines);a=new d(f,a.vertexShaderBillboardDepth,c.source,b.Default3D,c.defines);e.add("billboard",g);e.add("billboardDepth",h);e.add("billboardDepthShadowMap",a)},f})},"esri/views/3d/webgl-engine/materials/ColorMaterial":function(){define("dojo/_base/lang dojo/text!./ColorMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../lib/Util ../lib/ShaderVariations ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),
function(m,l,h,d,b,g,k,f,a){b=function(b,d){h.basicMaterialConstructor(this,d);b=b||{};b.color=b.color||[1,1,1,1];b.polygonOffset=b.polygonOffset||!1;b.vertexColors=b.vertexColors||!1;var g=f.Pos3Col;this.getParams=function(){return b};this.setColor=function(a){b.color=a;this.notifyDirty("matChanged")};this.getColor=function(){return b.color};this.setTransparent=function(a){b.transparent=a;this.notifyDirty("matChanged")};this.getTransparent=function(a){return b.transparent};this.dispose=function(){};
this.getOutputAmount=function(b){var c=a.getStride(g)/4;return b*c};this.getVertexBufferLayout=function(){return g};this.fillInterleaved=function(a,b,c,e,d,f,k){h.fillInterleaved(a,b,c,e,g,d,f,k)};this.intersect=h.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:e,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:c}};this.getAllTextureIds=function(){return[]}};var e=function(a,b,c){h.basicGLMaterialConstructor(this,a);var e=m.clone(a.getParams()),f=b.getShaderVariationsProgram("colorMaterial",
[e.vertexColors]),g=a.getColor();this.beginSlot=function(a){return a===(1>g[3]?d.TRANSPARENT_MATERIAL:d.OPAQUE_MATERIAL)};this.getProgram=function(){return f};this.updateParameters=function(){e.color=a.getColor();e.transparent=a.getTransparent()};this.bind=function(a,b){a.bindProgram(f);f.setUniform4fv("eColor",e.color);a.setFaceCullingEnabled(!1);e.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(1,1));e.transparent&&(a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,
a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA));a.setDepthTestEnabled(!0)};this.release=function(a){a.setPolygonOffsetFillEnabled(!1);e.transparent&&a.setBlendingEnabled(!1)};this.bindView=function(a,b){h.bindView(b.origin,b.view,f)};this.bindInstance=function(a,b){f.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},c=function(a,b,c){h.basicGLMaterialConstructor(this,a);var e=m.clone(a.getParams()),f=b.getShaderVariationsProgram("colorMaterial",
[e.vertexColors]),g=[1,1,1,1];this.beginSlot=function(a){return a===(1>g[3]?d.TRANSPARENT_MATERIAL:d.OPAQUE_MATERIAL)};this.getProgram=function(){return f};this.updateParameters=function(){e.color=a.getColor();e.transparent=a.getTransparent()};this.bind=function(a,b){a.bindProgram(f);f.setUniform4fv("eColor",e.color);a.setFaceCullingEnabled(!1);e.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(1,1))};this.release=function(a){a.setPolygonOffsetFillEnabled(!1)};this.bindView=function(a,
b){h.bindView(b.origin,b.view,f)};this.bindInstance=function(a,b){f.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};return b.programs=null,b.loadShaders=function(a,b,c,e){a._parse(l);a=new g("colorMaterial",["vertexShaderColorMaterial","fragmentShaderColorMaterial"],null,c,b,a,e,k.Default3D);a.addDefine("Color","VERTEXCOLORS");c.addShaderVariations("colorMaterial",a)},b})},"esri/views/3d/webgl-engine/materials/LineCalloutMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/text!./LineCalloutMaterial.xml ./internal/MaterialUtil ../lib/Util ../../../webgl/Util ./internal/MaterialBase ./internal/GLMaterialBase ../lib/RenderSlot ../lib/ShaderVariations".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){function q(a,b,c){3===c.length?a.setUniform4f(b,c[0],c[1],c[2],1):a.setUniform4fv(b,c)}var t=g.VertexAttrConstants,r=[{name:"position",count:3,type:5126,offset:0,stride:48,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:48,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:48,normalized:!1},{name:"auxpos1",count:4,type:5126,offset:32,stride:48,normalized:!1}],u={verticalOffset:null,screenSizePerspective:null,screenOffset:[0,0],color:[0,0,
0,1],size:1,borderColor:null,occlusionTest:!1,shaderPolygonOffset:1E-5,depthHUDAlignStart:!1,centerOffsetUnits:"world"};m=function(a){function e(c,d){d=a.call(this,d)||this;return d.params=b.copyParameters(c,u),d._uniqueMaterialIdentifier=e.uniqueMaterialIdentifier(d.params),d}return h(e,a),Object.defineProperty(e.prototype,"uniqueMaterialIdentifier",{get:function(){return this._uniqueMaterialIdentifier},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){},e.prototype.getGLMaterials=function(){return{color:v,
depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}},e.prototype.getAllTextureIds=function(){return[]},e.prototype.fillAttributeData=function(a,c,e,d,f,g){var h=a.indices[c];a=a.vertexAttr[c].data;if(h&&a)for(c=e+k.findAttribute(r,c).offset/4,e=0;e<h.length;e++)for(var l=d*h[e],n=0;6>n;n++)b.fill(a,l,g,c,f,d),c+=12},e.prototype.fillInterleaved=function(a,b,c,e,d,f,g){this.fillAttributeData(a,t.POSITION,f,3,b,d);this.fillAttributeData(a,t.NORMAL,f,3,c,d);this.fillAttributeData(a,t.AUXPOS1,
f,4,null,d);a=f+k.findAttribute(r,t.UV0).offset/4;b=0;for(c=x;b<c.length;b++)e=c[b],d[a+0]=e[0],d[a+1]=e[1],a+=12},e.prototype.getOutputAmount=function(a){return 288*a},e.prototype.getInstanceBufferLayout=function(){},e.prototype.getVertexBufferLayout=function(){return r},e.prototype.intersect=function(a,b,c,e,d,f,g,h){},e.prototype.getParameterValues=function(){var a=this.params;return{verticalOffset:a.verticalOffset,screenSizePerspective:a.screenSizePerspective,screenOffset:a.screenOffset,centerOffsetUnits:a.centerOffsetUnits,
color:[a.color[0],a.color[1],a.color[2],a.color[3]],size:a.size,borderColor:a.borderColor,occlusionTest:a.occlusionTest,shaderPolygonOffset:a.shaderPolygonOffset,depthHUDAlignStart:a.depthHUDAlignStart}},e.prototype.setParameterValues=function(a){b.updateParameters(this.params,a)&&(this._uniqueMaterialIdentifier=e.uniqueMaterialIdentifier(this.params),this.notifyDirty("matChanged"))},e.uniqueMaterialIdentifier=function(a){return JSON.stringify({screenOffset:a.screenOffset||[0,0],centerOffsetUnits:a.centerOffsetUnits||
"world"})},e.loadShaders=function(a,b,e,f){a._parse(d);a=new c("lineCallout",["vertexShaderLineCallout","fragmentShaderLineCallout"],null,e,b,a,f);a.addDefine("occlTest","OCCL_TEST");a.addDefine("verticalOffset","VERTICAL_OFFSET");a.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");a.addDefine("depthHud","DEPTH_HUD");a.addDefine("depthHudAlignStart","DEPTH_HUD_ALIGN_START");a.addDefine("centerOffsetUnitsScreen","CENTER_OFFSET_UNITS_SCREEN");e.addShaderVariations("line-callout-material-shader-variations",
a)},e}(f.MaterialBase);var v=function(a){function c(b,c,e){b=a.call(this,b,c,e)||this;return b.isRenderSlot=!0,b.programRep=c,b.updateParameters(),b}return h(c,a),c.prototype.updateParameters=function(){this.params=this.material.getParameterValues();this.selectProgram()},c.prototype.selectProgram=function(){var a=this.params;this.renderProgram=this.programRep.getShaderVariationsProgram("line-callout-material-shader-variations",[!!a.occlusionTest,!!a.verticalOffset,!!a.screenSizePerspective,!1,!!a.depthHUDAlignStart,
"screen"===a.centerOffsetUnits]);this.depthProgram=this.programRep.getShaderVariationsProgram("line-callout-material-shader-variations",[!!a.occlusionTest,!!a.verticalOffset,!!a.screenSizePerspective,!0,!!a.depthHUDAlignStart,"screen"===a.centerOffsetUnits])},c.prototype.beginSlot=function(a){switch(a){case e.LINE_CALLOUTS:return this.isRenderSlot=!0,!0;case e.LINE_CALLOUTS_HUD_DEPTH:return this.isRenderSlot=!1,!0}return!1},Object.defineProperty(c.prototype,"program",{get:function(){return this.isRenderSlot?
this.renderProgram:this.depthProgram},enumerable:!0,configurable:!0}),c.prototype.getAllPrograms=function(){return[this.renderProgram,this.depthProgram]},c.prototype.getProgram=function(){return this.program},c.prototype.getDrawMode=function(a){return a.gl.TRIANGLES},c.prototype.bind=function(a,c){var e=c.cameraAboveGround?1:-1,d=this.program,f=this.params;a.bindProgram(d);d.setUniform1f("cameraGroundRelative",e);d.setUniform1f("polygonOffset",f.shaderPolygonOffset);d.setUniform4fv("viewport",c.viewport);
d.setUniformMatrix4fv("viewNormal",c.viewInvTransp);d.setUniform1i("hudVisibilityTexture",0);a.bindTexture(c.hudVisibilityTexture,0);q(d,"color",f.color);d.setUniform2f("screenOffset",f.screenOffset[0],f.screenOffset[1]);this.bindBorder(a,c);b.bindVerticalOffset(f.verticalOffset,c,d);this.bindSizing(a,c);b.bindScreenSizePerspective(f.screenSizePerspective,d);this.isRenderSlot?this.bindRender(a,c):this.bindHUDDepth(a,c)},c.prototype.bindRender=function(a,b){a.setBlendFunctionSeparate(1,771,770,771);
a.setBlendingEnabled(!0);a.setDepthWriteEnabled(!1)},c.prototype.bindHUDDepth=function(a,b){a.setColorMask(!1,!1,!1,!1);a.setDepthWriteEnabled(!0);a.setBlendingEnabled(!1);a.setDepthTestEnabled(!0)},c.prototype.bindView=function(a,c){a=this.program;b.bindView(c.origin,c.view,a);b.bindCamPos(c.origin,c.viewInvTransp,a)},c.prototype.bindInstance=function(a,b){a=this.program;a.setUniformMatrix4fv("model",b.transformation);a.setUniformMatrix4fv("modelNormal",b.transformationNormal)},c.prototype.release=
function(a,b){this.isRenderSlot?this.releaseRender(a,b):this.releaseHUDDepth(a,b)},c.prototype.releaseRender=function(a,b){a.setBlendingEnabled(!1);a.setBlendFunction(770,771);a.setDepthWriteEnabled(!0)},c.prototype.releaseHUDDepth=function(a,b){a.setColorMask(!0,!0,!0,!0)},c.prototype.bindSizing=function(a,b){a=this.program;var c=this.params;a.setUniform2f("pixelToNDC",2/b.viewport[2],2/b.viewport[3]);a.setUniform1f("lineSize",Math.ceil(c.size))},c.prototype.bindBorder=function(a,b){a=this.program;
b=this.params;null!==b.borderColor?(q(a,"borderColor",b.borderColor),a.setUniform1f("borderSize",1)):(a.setUniform4f("borderColor",0,0,0,0),a.setUniform1f("borderSize",0))},c}(a.GLMaterialBase),x=[[0,0],[1,0],[0,1],[1,0],[1,1],[0,1]];return m})},"esri/views/3d/webgl-engine/materials/LeafCardMaterial":function(){define("dojo/text!./LeafCardMaterial.xml ./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../../../webgl/Util".split(" "),
function(m,l,h,d,b,g,k,f){function a(){return v=(9301*v+49297)%233280,v/233280}var e=d.vec3,c=d.mat4,q=d.mat4d;d=function(b,d,g,k,m,v){l.basicMaterialConstructor(this,v);var n=[{name:"position",count:3,type:5126,offset:0,stride:44,normalized:!1},{name:"normal",count:4,type:5126,offset:12,stride:44,normalized:!1},{name:"uv0",count:4,type:5126,offset:28,stride:44,normalized:!1}],w=f.getStride(n)/4;this.getAmbient=function(){return d};this.getDiffuse=function(){return g};this.getSpecular=function(){return k};
this.getShininess=function(){return m};this.dispose=function(){};this.getTextureId=function(){return b};this.getOutputAmount=function(a){var b,c=0;for(b=0;a/6>b;b++)0===b%1&&(c+=6);a=c;for(b=c=0;a/6>b;b++)0===b%1&&(c+=6);return c*w};this.getVertexBufferLayout=function(){return n};this.reduce=function(a,b){var c=a.position,e=a.normal;a=a.uv0;for(var d=[],f=[],g=[],h=0,k=0;k<c.length/6;k++)if(0===k%b)for(var l=0;6>l;l++)d[h]=c[6*k+l],f[h]=e[6*k+l],g[h]=a[6*k+l],h++;return{position:d,normal:f,uv0:g}};
this.fillInterleaved=function(b,d,f,g,k,n){g=l.fill;var m=this.reduce(b.indices,1),m=this.reduce(m,1),r=this.getOutputAmount(b.indices.position.length);h.assert(r===m.position.length*w);var t=m.position,u=m.normal,v=m.uv0,m=b.vertexAttr.position.data,x=b.vertexAttr.normal.data,y=b.vertexAttr.uv0.data,p=e.create();b=t.length/6;for(var r=n,z=e.createFrom(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),C=e.createFrom(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),F=0;b>F;++F){for(var B=e.create(),
G=e.create(),N=[100,100,-100,-100],M=e.create(),P=0;6>P;++P){var R=6*F+P,Q=3*t[R],ja=3*u[R],R=2*v[R];B[0]+=m[Q+0];B[1]+=m[Q+1];B[2]+=m[Q+2];G[0]+=x[ja+0];G[1]+=x[ja+1];G[2]+=x[ja+2];ja=y[R+0];R=y[R+1];N[0]=Math.min(N[0],ja);N[1]=Math.min(N[1],R);N[2]=Math.max(N[2],ja);N[3]=Math.max(N[3],R);0===P&&e.set3(m[Q+0],m[Q+1],m[Q+2],M)}B[0]/=6;B[1]/=6;B[2]/=6;G[0]/=6;G[1]/=6;G[2]/=6;B[0]+=.1*(2*a()-1);B[1]+=.1*(2*a()-1);B[2]+=.1*(2*a()-1);void 0!==d&&(q.multiplyVec3(d,M,M),q.multiplyVec3(d,B,B),q.multiplyVec3(f,
G,G));e.add(B,p,p);e.max(z,B,z);e.min(C,B,C);N[0]+=.01;N[1]+=.01;N[2]-=.01;N[3]-=.01;for(P=0;4>P;P++)N[P]=Math.min(N[P],.99999);P=2*a()*Math.PI;M=1.41*e.dist(M,B);n+=g(B,0,k,n,void 0,3);n+=g(G,0,k,n,void 0,3);k[n++]=0;k[n++]=N[0];k[n++]=N[1];k[n++]=P;k[n++]=M;n+=g(B,0,k,n,void 0,3);n+=g(G,0,k,n,void 0,3);k[n++]=0;k[n++]=N[2]+1;k[n++]=N[1];k[n++]=P;k[n++]=M;n+=g(B,0,k,n,void 0,3);n+=g(G,0,k,n,void 0,3);k[n++]=0;k[n++]=N[2]+1;k[n++]=N[3]+1;k[n++]=P;k[n++]=M;n+=g(B,0,k,n,void 0,3);n+=g(G,0,k,n,void 0,
3);k[n++]=0;k[n++]=N[2]+1;k[n++]=N[3]+1;k[n++]=P;k[n++]=M;n+=g(B,0,k,n,void 0,3);n+=g(G,0,k,n,void 0,3);k[n++]=0;k[n++]=N[0];k[n++]=N[3]+1;k[n++]=P;k[n++]=M;n+=g(B,0,k,n,void 0,3);n+=g(G,0,k,n,void 0,3);k[n++]=0;k[n++]=N[0];k[n++]=N[1];k[n++]=P;k[n++]=M}p[0]/=b;p[1]/=b;p[2]/=b;d=e.create();e.add(z,C,d);e.scale(d,.5,d);n=e.create();e.subtract(z,C,n);n[0]=Math.abs(n[0])/2;n[1]=Math.abs(n[1])/2;n[2]=Math.abs(n[2])/2;t=e.create(p);t[1]-=(z[1]-C[1])/3;z=e.create();C=e.create();m=e.create();u=[e.create(),
e.create(),e.create(),e.create()];p=[0,0,0,0];v=c.create();for(F=0;b>F;++F){e.set3(k[r],k[r+1],k[r+2],m);e.subtract(m,t,z);e.normalize(z,z);C=e.subtract(m,d,C);e.normalize(C,C);y=Math.abs(e.dot(C,[1,0,0]));P=Math.abs(e.dot(C,[0,1,0]));x=Math.abs(e.dot(C,[0,0,1]));y=y*Math.abs(d[0]-m[0])/n[0];y+=P*Math.abs(d[1]-m[1])/n[1];y+=x*Math.abs(d[2]-m[2])/n[2];for(P=0;4>P;P++)c.identity(v),c.rotate(v,.8*(2*a()-1),[0,1,0],v),c.rotate(v,.8*(2*a()-1),[1,0,0],v),c.multiplyVec3(v,z,u[P]),p[P]=.5+.5*y-.2*(2*a()-
1);x=.8+.3*(2*a()-1);for(P=0;6>P;++P){var na;switch(P){case 0:na=0;break;case 1:na=1;break;case 2:na=2;break;case 3:na=2;break;case 4:na=3;break;case 5:na=0}r+=3;r+=g(u[na],0,k,r,f,3);k[r++]=p[na];r+=3;k[r++]*=x}}};this.intersect=function(){};this.getGLMaterials=function(){return{color:t,depthShadowMap:u,normal:void 0,depth:r,highlight:void 0}};this.getAllTextureIds=function(){return[b]}};var t=function(a,c,e){l.basicGLMaterialConstructor(this,a);var d=b.TRANSPARENT_MATERIAL,f=c.get("leafCard");l.singleTextureGLMaterialConstructor(this,
e,{textureId:a.getTextureId()});this.beginSlot=function(a){return d===a};this.getProgram=function(){return f};var g=a.getAmbient(),h=a.getDiffuse(),k=a.getSpecular(),n=a.getShininess();this.bind=function(a,b){a.bindProgram(f);this.bindTexture(a,f);f.setUniform3fv("ambient",g);f.setUniform3fv("diffuse",h);f.setUniform3fv("specular",k);f.setUniform1f("shininess",n);f.setUniform1f("trafoScale",1);a.setBlendingEnabled(!1);a.setDepthTestEnabled(!0)};this.release=function(a){};this.bindView=function(a,
b){l.bindView(b.origin,b.view,f);l.bindCamPos(b.origin,b.viewInvTransp,f)};this.bindInstance=function(a,b){f.setUniformMatrix4fv("model",b.transformation);f.setUniformMatrix4fv("modelNormal",b.transformationNormal);a=b.transformation;f.setUniform1f("trafoScale",(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8])+Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])+Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))/3)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},r=function(a,c,e,d){l.basicGLMaterialConstructor(this,a);
var f=b.TRANSPARENT_MATERIAL,g=null==d?c.get("leafCardDepth"):c.get("leafCardDepthShadowMap");l.singleTextureGLMaterialConstructor(this,e,{textureId:a.getTextureId()});this.beginSlot=function(a){return f===a};this.getProgram=function(){return g};this.bind=function(a,b){a.bindProgram(g);this.bindTexture(a,g);g.setUniform2fv("nearFar",b.nearFar)};this.release=function(a){};this.bindView=function(a,b){l.bindView(b.origin,b.view,g)};this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",b.transformation);
a=b.transformation;g.setUniform1f("trafoScale",(Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8])+Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])+Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))/3)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},u=function(a,b,c){r.call(this,a,b,c,!0)};d.loadShaders=function(a,b,c,e){a._parse(m);var d=new g(e,a.vertexShaderLeafCard,a.fragmentShaderLeafCard,k.Default3D),f=b.get("fsDepthTextured");b=b.get("fsDepthTexturedShadowMap");f=new g(e,a.vertexShaderLeafCardDepth,f.source,
k.Default3D,f.defines);a=new g(e,a.vertexShaderLeafCardDepth,b.source,k.Default3D,b.defines);c.add("leafCard",d);c.add("leafCardDepth",f);c.add("leafCardDepthShadowMap",a)};var v=1234;return d})},"esri/views/3d/webgl-engine/materials/Material":function(){define("dojo/text!./Material.xml ./internal/MaterialUtil ../../../webgl/Program ../lib/ShaderVariations ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util ../../layers/graphics/graphicUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){function q(a,b){var e=b.vvSizeEnabled;b.vvSizeEnabled?(a.setUniform3fv("vvSizeMinSize",b.vvSizeMinSize),a.setUniform3fv("vvSizeMaxSize",b.vvSizeMaxSize),a.setUniform3fv("vvSizeOffset",b.vvSizeOffset),a.setUniform3fv("vvSizeFactor",b.vvSizeFactor)):e&&a.setUniform3fv("vvSizeValue",b.vvSizeValue);e&&(a.setUniform3fv("vvSymbolAnchor",b.vvSymbolAnchor),c.computeObjectRotation(b.vvSymbolRotation[2],b.vvSymbolRotation[0],b.vvSymbolRotation[1],w.identity(B)),a.setUniformMatrix3fv("vvSymbolRotation",
w.toMat3(B,C)));b.vvColorEnabled&&(a.setUniform1fv("vvColorValues",b.vvColorValues),a.setUniform4fv("vvColorColors",b.vvColorColors))}function t(a,b){a.vvSizeEnabled=b.vvSizeEnabled;a.vvSizeMinSize=b.vvSizeMinSize;a.vvSizeMaxSize=b.vvSizeMaxSize;a.vvSizeOffset=b.vvSizeOffset;a.vvSizeFactor=b.vvSizeFactor;a.vvSizeValue=b.vvSizeValue;a.vvSymbolAnchor=b.vvSymbolAnchor;a.vvSymbolRotation=b.vvSymbolRotation}function r(a,b){return y.set(a,z),y.multiply(b,z)}var u,v=b.assert,x=g.vec3,y=g.vec4,n=g.mat3,w=
g.mat4,z=y.create(),C=n.create(),B=w.create(),F=x.create(),G=x.create(),N=x.createFrom(0,0,1),M=x.create(),R=x.create(),P=x.create(),Q=x.create(),T=function(a,b){l.basicMaterialConstructor(this,b);a=a||{};a.ambient=a.ambient||[.2,.2,.2];a.diffuse=a.diffuse||[.8,.8,.8];a.specular=a.specular||[0,0,0];a.externalColor=a.externalColor||[1,1,1,1];a.colorMixMode=a.colorMixMode||"multiply";a.shininess=a.shininess||10;a.opacity=void 0!==a.opacity?a.opacity:1;a.layerOpacity=void 0!==a.layerOpacity?a.layerOpacity:
1;a.blendModeOneOne=a.blendModeOneOne||!1;a.inverseWindingOrder=a.inverseWindingOrder||!1;a.vertexColors=a.vertexColors||!1;a.symbolColors=a.symbolColors||!1;a.flipV=a.flipV||!1;a.doubleSided=a.doubleSided||!1;a.cullFace=a.cullFace||void 0;a.instanced=a.instanced||!1;this.instanced=!!a.instanced;a.groundNormalShading=a.groundNormalShading||!1;a.writeStencil=a.writeStencil||!1;a.textureId||(a.reflTextureId=void 0);a.receiveSSAO=void 0!==a.receiveSSAO?a.receiveSSAO:!0;a.castShadows=void 0!==a.castShadows?
a.castShadows:!0;a.verticalOffset=a.verticalOffset||null;a.screenSizePerspective=a.screenSizePerspective||null;a.vvSizeEnabled=a.vvSizeEnabled||!1;a.vvSizeMinSize=a.vvSizeMinSize||[1,1,1];a.vvSizeMaxSize=a.vvSizeMaxSize||[100,100,100];a.vvSizeOffset=a.vvSizeOffset||[0,0,0];a.vvSizeFactor=a.vvSizeFactor||[1,1,1];a.vvSizeValue=a.vvSizeValue||[1,1,1];a.vvColorEnabled=a.vvColorEnabled||!1;a.vvColorValues=a.vvColorValues||[0,0,0,0,0,0,0,0];a.vvColorColors=a.vvColorColors||[1,0,0,0,1,0,0,0,1,0,0,0,1,0,
0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0];a.vvSymbolAnchor=a.vvSymbolAnchor||[0,0,0];a.vvSymbolRotation=a.vvSymbolRotation||[0,0,0];var c=T.getVertexBufferLayout(a),d=null;a.instanced&&(d=[],e.addDescriptor(d,"model",16,5126,!1,1),e.addDescriptor(d,"modelNormal",16,5126,!1,1),-1<a.instanced.indexOf("color")&&e.addDescriptor(d,"instanceColor",4,5126,!1,1),-1<a.instanced.indexOf("featureAttribute")&&e.addDescriptor(d,"instanceFeatureAttribute",4,5126,!1,1));var f=this.isVisible.bind(this);this.isVisible=
function(){return f()&&0<a.opacity&&0<a.layerOpacity};this.dispose=function(){};this.getParams=function(){return a};this.getParameterValues=function(){var b={ambient:a.ambient,diffuse:a.diffuse,specular:a.specular,externalColor:a.externalColor,colorMixMode:a.colorMixMode,shininess:a.shininess,opacity:a.opacity,layerOpacity:a.layerOpacity,transparent:a.transparent,polygonOffset:a.polygonOffset,reflectivity:a.reflectivity,atlasRegions:a.atlasRegions,flipV:a.flipV,doubleSided:a.doubleSided,cullFace:a.cullFace,
writeStencil:a.writeStencil,receiveSSAO:a.receiveSSAO,castShadows:a.castShadows,verticalOffset:a.verticalOffset,screenSizePerspective:a.screenSizePerspective,vvSizeEnabled:a.vvSizeEnabled,vvSizeMinSize:a.vvSizeMinSize,vvSizeMaxSize:a.vvSizeMaxSize,vvSizeOffset:a.vvSizeOffset,vvSizeFactor:a.vvSizeFactor,vvSizeValue:a.vvSizeValue,vvColorEnabled:a.vvColorEnabled,vvColorValues:a.vvColorValues,vvColorColors:a.vvColorColors,groundNormalShading:a.groundNormalShading,vvSymbolAnchor:a.vvSymbolAnchor,vvSymbolRotation:a.vvSymbolRotation};
return a.textureId&&(b.textureId=a.textureId,b.initTexture=a.initTexture),b};this.setParameterValues=function(b){for(var c in b)"textureId"===c&&v(a.textureId,"Can only change texture of material that already has a texture"),"castShadows"===c&&v(b.castShadows===a.castShadows,"Can not change shadow casting behavior."),a[c]=b[c];this.notifyDirty("matChanged")};this.getOutputAmount=function(a){var b=e.getStride(c)/4;return a*b};this.getVertexBufferLayout=function(){return c};this.getInstanceBufferLayout=
function(){return d};this.fillInterleaved=function(a,b,e,d,f,g,h){l.fillInterleaved(a,b,e,d,c,f,g,h)};this.intersect=function(b,c,e,d,f,g,h,k){if(null!=a.verticalOffset){k=d.camera;x.set3(e[12],e[13],e[14],P);var p=x.subtract(P,k.eye,Q),q=x.length(p),m=x.scale(p,1/q),r=null,p=null;switch(d.viewingMode){case "global":p=x.normalize(P,M);break;case "local":p=x.set(N,M)}a.screenSizePerspective&&(r=x.dot(p,m));k=l.verticalOffsetAtDistance(k,q,a.verticalOffset,r,a.screenSizePerspective);x.scale(p,k);n.multiplyVec3(d.transformInverseRotation,
p,R);f=x.subtract(f,R,F);g=x.subtract(g,R,G)}l.intersectTriangleGeometry(b,c,e,d,f,g,h)};this.getGLMaterials=function(){return{color:Y,depthShadowMap:a.castShadows?E:null,normal:p,depth:W,highlight:A}};this.getAllTextureIds=function(){var b=[];return a.textureId&&b.push(a.textureId),a.reflTextureId&&b.push(a.reflTextureId),b}};T.paramsFromOldConstructor=function(a,b,c,e,d,f,g,h,k,l,n,p,q){return{textureId:a,transparent:b,ambient:c,diffuse:e,specular:d,shininess:f,opacity:g,polygonOffset:h,initTexture:k,
reflTextureId:l,reflectivity:n,flipV:p,doubleSided:q,cullFace:void 0}};var O=function(a,b){var c=a.gl;(b.cullFace?"none"===b.cullFace:b.transparent)?a.setFaceCullingEnabled(!1):(a.setFaceCullingEnabled(!0),"front"===b.cullFace&&a.setCullFace(c.FRONT))},S=function(a,b){var c=a.gl;(b.cullFace?"none"===b.cullFace:b.transparent)?a.setFaceCullingEnabled(!0):(a.setFaceCullingEnabled(!1),"front"===b.cullFace&&a.setCullFace(c.BACK))},H=function(a,b){return a?k.TRANSPARENT_MATERIAL:b?k.STENCIL_MATERIAL:k.OPAQUE_MATERIAL},
Y=function(a,b,c){l.basicGLMaterialConstructor(this,a);var e=l.copyParameters(a.getParams()),d=H(e.transparent,e.writeStencil);l.singleTextureGLMaterialConstructor(this,c,e);var f=l.aquireIfNotUndefined(e.reflTextureId,e.reflInitTexture,c);f&&(f=f.getGLTexture());v(!(e.atlasRegions&&e.reflTextureId),"Atlas texture with reflection is not yet supported");var g=e.textureId?e.atlasRegions?"AtlasTextured":"Textured":"none";this.instanced=u&&e.instanced;var h,k=!!this.instanced&&-1<this.instanced.indexOf("color"),
n=!u&&e.instanced&&-1<e.instanced.indexOf("color"),p=[[null,null],[null,null]],m=null;this._loadPrograms=function(){p[0][0]=this._loadProgram(!1,!1);p[1][0]=this._loadProgram(!0,!1);e.receiveSSAO?(p[0][1]=this._loadProgram(!1,!0),p[1][1]=this._loadProgram(!0,!0),h=p[0].concat(p[1])):(p[0][1]=p[0][0],p[1][1]=p[1][0],h=[p[0][0],p[1][0]])};this._loadProgram=function(a,c){return b.getShaderVariationsProgram("material",[g,!!e.reflTextureId,e.vertexColors,e.symbolColors,e.flipV,e.doubleSided,!!this.instanced,
k,a,c,!!e.vvSizeEnabled,!!e.vvColorEnabled,null!=e.verticalOffset,null!=e.screenSizePerspective,e.groundNormalShading])};this._loadPrograms();var w="AtlasTextured"===g,x=this.dispose;this.dispose=function(){x();l.releaseIfNotUndefined(e.reflTextureId,c)};this.beginSlot=function(a){return d===a};this.getProgram=function(){return m||p[0][0]};this.getAllPrograms=function(){return h};this.updateParameters=function(){var b=a.getParams();e.ambient=b.ambient;e.diffuse=b.diffuse;e.specular=b.specular;e.externalColor=
b.externalColor;e.colorMixMode=b.colorMixMode;e.shininess=b.shininess;e.opacity=b.opacity;e.layerOpacity=b.layerOpacity;e.polygonOffset=b.polygonOffset;e.reflectivity=b.reflectivity;e.flipV=b.flipV;e.doubleSided=b.doubleSided;e.cullFace=b.cullFace;e.receiveSSAO=b.receiveSSAO;e.castShadows=b.castShadows;e.verticalOffset=b.verticalOffset;e.screenSizePerspective=b.screenSizePerspective;t(e,b);e.vvColorEnabled=b.vvColorEnabled;e.vvColorValues=b.vvColorValues;e.vvColorColors=b.vvColorColors;e.transparent!=
b.transparent&&(d=H(b.transparent),e.transparent=b.transparent);e.groundNormalShading=b.groundNormalShading;e.initTexture=b.initTexture;this.updateTexture(b.textureId);b.atlasRegions&&(e.atlasRegions=b.atlasRegions);e.blendModeOneOne=b.blendModeOneOne;e.inverseWindingOrder=b.inverseWindingOrder;this._loadPrograms()};this.bind=function(a,b){var c=a.gl;m=p[b.shadowMappingEnabled?1:0][b.ssaoEnabled?1:0];a.bindProgram(m);m.setUniform3fv("ambient",e.ambient);m.setUniform3fv("diffuse",e.diffuse);m.setUniform3fv("specular",
e.specular);m.setUniform4fv("externalColor",e.externalColor);m.setUniform1i("colorMixMode",l.colorMixModes[e.colorMixMode]);m.setUniform1f("shininess",e.shininess);m.setUniform1f("opacity",e.opacity);m.setUniform1f("layerOpacity",e.layerOpacity);l.bindVerticalOffset(e.verticalOffset,b,m);l.bindScreenSizePerspective(e.screenSizePerspective,m);q(m,e);this.bindTexture(a,m);w&&this.bindTextureSize(a,m);a.setBlendFunctionSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);void 0!==
f&&(m.setUniform1i("reflTex",1),a.bindTexture(f,1),m.setUniform1f("reflectivity",e.reflectivity));e.inverseWindingOrder&&a.setFrontFace(c.CW);e.transparent?(a.setBlendingEnabled(!0),e.blendModeOneOne?(a.setBlendFunction(c.ONE,c.ONE),a.setDepthWriteEnabled(!1)):a.setBlendFunctionSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA)):a.setBlendingEnabled(!1);e.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(2,2));O(a,e);a.setDepthTestEnabled(!0)};this.release=
function(a,b){b=a.gl;a.setPolygonOffsetFillEnabled(!1);S(a,e);a.setBlendingEnabled(!1);a.setBlendFunctionSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA);a.setDepthWriteEnabled(!0);a.setFrontFace(b.CCW)};this.bindView=function(a,b){m=p[b.shadowMappingEnabled?1:0][b.ssaoEnabled?1:0];a=b.origin;l.bindView(a,b.view,m);l.bindCamPos(a,b.viewInvTransp,m);b.shadowMappingEnabled&&b.shadowMap.bindView(m,a)};this.bindInstance=function(a,b){(m.setUniformMatrix4fv("model",b.transformation),
m.setUniformMatrix4fv("modelNormal",b.transformationNormal),b.instanceParameters&&n)&&(a=b.instanceParameters.color)&&m.setUniform4fv("externalColor",r(a,e.externalColor))};this.getDrawMode=function(a){return a.gl.TRIANGLES}},W=function(a,b,c,d){l.basicGLMaterialConstructor(this,a);var f=l.copyParameters(a.getParams());this.instanced=u&&f.instanced;var g=e.hasAttribute(a.getVertexBufferLayout(),"uv0")?(f.atlasRegions,"Textured"):"none",h=b.getShaderVariationsProgram("material-depth",[g,f.flipV,!!this.instanced,
!!d,!!f.vvSizeEnabled,null!=f.verticalOffset,null!=f.screenSizePerspective]),k=H(f.transparent,f.writeStencil);l.singleTextureGLMaterialConstructor(this,c,f);this.beginSlot=function(a){return k===a};this.getProgram=function(){return h};this.updateParameters=function(){var b=a.getParams();f.initTexture=b.initTexture;f.cullFace=b.cullFace;f.inverseWindingOrder=b.inverseWindingOrder;f.flipV=b.flipV;t(f,b);this.updateTexture(b.textureId)};this.bind=function(a,b){var c=a.gl;a.bindProgram(h);h.setUniform2fv("nearFar",
b.nearFar);f.inverseWindingOrder&&a.setFrontFace(c.CW);l.bindVerticalOffset(f.verticalOffset,b,h);l.bindScreenSizePerspective(f.screenSizePerspective,h);q(h,f);this.bindTexture(a,h);O(a,f);a.setDepthTestEnabled(!0)};this.release=function(a){var b=a.gl;S(a,f);f.inverseWindingOrder&&a.setFrontFace(b.CCW)};this.bindView=function(a,b){l.bindView(b.origin,b.view,h);f.screenSizePerspective&&l.bindCamPos(b.origin,b.viewInvTransp,h)};this.bindInstance=function(a,b){h.setUniformMatrix4fv("model",b.transformation)};
this.getDrawMode=function(a){return a.gl.TRIANGLES}},E=function(a,b,c){W.call(this,a,b,c,!0)},p=function(a,b,c){l.basicGLMaterialConstructor(this,a);var d=l.copyParameters(a.getParams()),f=e.hasAttribute(a.getVertexBufferLayout(),"uv0")?(d.atlasRegions,"Textured"):"none";this.instanced=u&&d.instanced;var g=b.getShaderVariationsProgram("material-normal",[f,d.flipV,!!this.instanced,!!d.vvSizeEnabled,null!=d.verticalOffset,null!=d.screenSizePerspective]),h=H(d.transparent,d.writeStencil);l.singleTextureGLMaterialConstructor(this,
c,d);this.beginSlot=function(a){return h===a};this.getProgram=function(){return g};this.updateParameters=function(){var b=a.getParams();d.initTexture=b.initTexture;d.cullFace=b.cullFace;d.inverseWindingOrder=b.inverseWindingOrder;d.flipV=b.flipV;t(d,b);this.updateTexture(b.textureId)};this.bind=function(a,b){var c=a.gl;a.bindProgram(g);this.bindTexture(a,g);g.setUniformMatrix4fv("viewNormal",b.viewInvTransp);l.bindVerticalOffset(d.verticalOffset,b,g);l.bindScreenSizePerspective(d.screenSizePerspective,
g);q(g,d);O(a,d);d.inverseWindingOrder&&a.setFrontFace(c.CW);a.setDepthTestEnabled(!0)};this.release=function(a){var b=a.gl;S(a,d);d.inverseWindingOrder&&a.setFrontFace(b.CCW)};this.bindView=function(a,b){l.bindView(b.origin,b.view,g);d.screenSizePerspective&&l.bindCamPos(b.origin,b.viewInvTransp,g)};this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",b.transformation);g.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}},A=function(a,
b,c,d){l.basicGLMaterialConstructor(this,a);var f=l.copyParameters(a.getParams());d=e.hasAttribute(a.getVertexBufferLayout(),"uv0")?(f.atlasRegions,"Textured"):"none";this.instanced=u&&f.instanced;var g=b.getShaderVariationsProgram("material-highlight",[d,f.flipV,!!this.instanced,!!f.vvSizeEnabled,null!=f.verticalOffset,null!=f.screenSizePerspective]),h=H(f.transparent,f.writeStencil);l.singleTextureGLMaterialConstructor(this,c,f);this.beginSlot=function(a){return h===a};this.getProgram=function(){return g};
this.updateParameters=function(){var b=a.getParams();f.initTexture=b.initTexture;f.cullFace=b.cullFace;f.inverseWindingOrder=b.inverseWindingOrder;f.flipV=b.flipV;t(f,b);this.updateTexture(b.textureId)};this.bind=function(a,b){var c=a.gl;a.bindProgram(g);this.bindTexture(a,g);l.bindVerticalOffset(f.verticalOffset,b,g);l.bindScreenSizePerspective(f.screenSizePerspective,g);q(g,f);O(a,f);f.inverseWindingOrder&&a.setFrontFace(c.CW);a.setDepthTestEnabled(!0)};this.release=function(a){var b=a.gl;S(a,f);
f.inverseWindingOrder&&a.setFrontFace(b.CW)};this.bindView=function(a,b){l.bindView(b.origin,b.view,g);f.screenSizePerspective&&l.bindCamPos(b.origin,b.viewInvTransp,g)};this.bindInstance=function(a,b){g.setUniformMatrix4fv("model",b.transformation);g.setUniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};return T.getVertexBufferLayout=function(b){var c="Pos3";return b.groundNormalShading||(c+="Norm"),b.textureId&&(c+=b.atlasRegions?"TexRegion":
"Tex"),b.vertexColors&&(c+="Col"),b.symbolColors&&(c+="Symcol"),a[c]},T.loadShaders=function(a,b,c,e){a._parse(m);u=e.extensions.angleInstancedArrays;e.extensions.shaderTextureLOD;e.extensions.standardDerivatives;var g=new d("phong",["vsPhong","fsPhong"],null,c,b,a,e);g.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);g.addBinaryShaderSnippetSuffix("Refl","Refl",[!1,!0]);g.addDefine("Color","VERTEXCOLORS");g.addDefine("symbolColor",
"SYMBOLVERTEXCOLORS");g.addDefine("FlipV","FLIPV");g.addDefine("DoubleSided","DOUBLESIDED");g.addDefine("Instanced","INSTANCED");g.addDefine("InstColor","INSTANCEDCOLOR");g.addDefine("ReceiveShadows","RECEIVE_SHADOWS");g.addDefine("ReceiveSSAO","RECEIVE_SSAO");g.addDefine("vvSize","VV_SIZE");g.addDefine("vvColor","VV_COLOR");g.addDefine("VerticalOffset","VERTICAL_OFFSET");g.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");g.addDefine("groundNormalShading","GROUND_NORMAL_SHADING");c.addShaderVariations("material",
g);g=new d("depth",["vsDepth","fsDepth"],null,c,b,a,e);g.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);g.addDefine("FlipV","FLIPV");g.addDefine("Instanced","INSTANCED");g.addDefine("ShadowMap","BIAS_SHADOWMAP");g.addDefine("vvSize","VV_SIZE");g.addDefine("VerticalOffset","VERTICAL_OFFSET");g.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");c.addShaderVariations("material-depth",g);g=new d("normal",["vsNormal",
"fsNormal"],null,c,b,a,e);g.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);g.addDefine("FlipV","FLIPV");g.addDefine("Instanced","INSTANCED");g.addDefine("vvSize","VV_SIZE");g.addDefine("VerticalOffset","VERTICAL_OFFSET");g.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");c.addShaderVariations("material-normal",g);g=new d("highlight",["vsHighlight","fsHighlight"],null,c,b,a,e);g.addNaryShaderSnippetSuffix([{value:"none",
programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);g.addDefine("FlipV","FLIPV");g.addDefine("Instanced","INSTANCED");g.addDefine("vvSize","VV_SIZE");g.addDefine("VerticalOffset","VERTICAL_OFFSET");g.addDefine("screenSizePerspective","SCREEN_SIZE_PERSPECTIVE");c.addShaderVariations("material-highlight",g);var g=new h(e,a.vsDepth,a.fsDepth,f.Default3D,["BIAS_SHADOWMAP 1"]),k=new h(e,a.vsDepthTextured,a.fsDepthTextured,f.Default3D,["BIAS_SHADOWMAP 1"]),l=new h(e,
a.vsDepth,a.fsDepth,f.Default3D),n=new h(e,a.vsDepthTextured,a.fsDepthTextured,f.Default3D),p=new h(e,a.vsNormal,a.fsNormal,f.Default3D),q=new h(e,a.vsNormalTextured,a.fsNormalTextured,f.Default3D),r=new h(e,a.vsHighlight,a.fsHighlight,f.Default3D);e=new h(e,a.vsHighlightTextured,a.fsHighlightTextured,f.Default3D);c.add("depthShadowMap",g);c.add("depthTexturedShadowMap",k);c.add("depth",l);c.add("depthTextured",n);c.add("normal",p);c.add("normalTextured",q);c.add("highlight",r);c.add("highlightTextured",
e);b.add("fsDepth",{source:a.fsDepth});b.add("fsDepthTextured",{source:a.fsDepthTextured});b.add("fsDepthShadowMap",{source:a.fsDepthShadowMap,defines:["BIAS_SHADOWMAP 1"]});b.add("fsDepthTexturedShadowMap",{source:a.fsDepthTextured,defines:["BIAS_SHADOWMAP 1"]});b.add("vsDepth",{source:a.vsDepth});b.add("fsNormal",{source:a.fsNormal})},T})},"esri/views/3d/layers/graphics/graphicUtils":function(){define(["require","exports","../../../../geometry","../../../../geometry/support/webMercatorUtils","../../lib/glMatrix"],
function(m,l,h,d,b){function g(a,b){var c=a.spatialReference;c.equals(b)||(c.isWebMercator&&b.wkid===h.SpatialReference.WGS84.wkid?d.webMercatorToGeographic(a,!1,a):b.isWebMercator&&c.wkid===h.SpatialReference.WGS84.wkid&&d.geographicToWebMercator(a,!1,a))}function k(a){if(Array.isArray(a)){for(var b=0;b<a.length;b++)if(!k(a[b]))return!1;return!0}return null==a||0<=a}Object.defineProperty(l,"__esModule",{value:!0});var f=b.vec4d,a=b.mat4d,e=[1,1,1];l.computeCentroid=function(a,b){if("extent"===a.type)return a.center;
if("polygon"===a.type)return a.centroid;for(var c=0,e=0,d=0,f=a.hasZ,k=0,l=0,n=a.paths;l<n.length;l++){for(var q=n[l],m=0,C=q;m<C.length;m++){var B=C[m],c=c+B[0],e=e+B[1];f&&(d+=B[2])}k+=q.length}a=new h.Point({x:c/k,y:e/k,z:f?d/k:void 0,spatialReference:a.spatialReference});return b&&g(a,b),a};l.convertToSR=g;l.enlargeExtent=function(a,b,e){if(a){b||(b=f.create());var c=.5*a.width*(e-1);e=.5*a.height*(e-1);return a.width<1E-7*a.height?c+=e/20:a.height<1E-7*a.width&&(e+=c/20),f.set4(a.xmin-c,a.ymin-
e,a.xmax+c,a.ymax+e,b),b}return null};l.updateVertexAttributeAuxpos1w=function(a,b){for(var c=0;c<a.geometries.length;++c){var e=a.geometries[c].data.vertexAttributes.auxpos1;e&&e.data[3]!==b&&(e.data[3]=b,a.geometryVertexAttrsUpdated(c))}};l.mixinColorAndOpacity=function(a,b){var c=[1,1,1,1];return null!=a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2]),null!==b&&void 0!==b?c[3]=b:null!=a&&3<a.length&&(c[3]=a[3]),c};l.overrideColor=function(a,b,e,d,f){f=[f[0],f[1],f[2],f[3]];for(var c=0;3>c;++c)a&&null!=a[c]?f[c]=
a[c]:e&&null!=e[c]&&(f[c]=e[c]);return null!=b?f[3]=b:null!=d&&(f[3]=d),f};l.computeObjectScale=function(a,b,d,f){void 0===a&&(a=e);void 0===f&&(f=1);var c=Array(3);if(null==b||null==d)c[0]=1,c[1]=1,c[2]=1;else{for(var g=void 0,h=0,k=2;0<=k;k--){var l=a[k],q=void 0,m=null!=l,r=0===k&&!g&&!m,t=d[k];"symbolValue"===l||r?q=0!==t?b[k]/t:1:m&&"proportional"!==l&&isFinite(l)&&(q=0!==t?l/t:1);null!=q&&(c[k]=q,g=q,h=Math.max(h,Math.abs(q)))}for(k=2;0<=k;k--)null==c[k]?c[k]=g:0===c[k]&&(c[k]=.001*h)}for(k=
2;0<=k;k--)c[k]/=f;return c};l.computeSizeWithResourceSize=function(a,b){var c=b.width,e=b.depth,d=b.height;b=b.isPrimitive?10:1;if(null==c&&null==d&&null==e)return[b*a[0],b*a[1],b*a[2]];for(var f,c=[c,e,d],e=0;3>e;e++)if(d=c[e],null!=d){f=d/a[e];break}for(e=0;3>e;e++)null==c[e]&&(c[e]=a[e]*f);return c};l.validateSymbolLayerSize=function(a){return null!=a.isPrimitive&&(a=[a.width,a.depth,a.height]),k(a)?null:"Symbol sizes may not be negative values"};l.computeObjectRotation=function(b,e,d,f){void 0===
f&&(f=a.identity());b=b||0;e=e||0;d=d||0;return 0!==b&&a.rotateZ(f,-b/180*Math.PI,f),0!==e&&a.rotateX(f,e/180*Math.PI,f),0!==d&&a.rotateY(f,d/180*Math.PI,f),f}})},"esri/views/3d/webgl-engine/materials/RibbonLineMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/text!./RibbonLineMaterial.xml ./internal/MaterialUtil ./internal/MaterialBase ./internal/GLMaterialBase ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/ComponentUtils ../lib/DefaultVertexBufferLayouts ../lib/ShaderVariations ../../../webgl/Util".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){m=function(e){function g(a,c){c=e.call(this,c)||this;return c.params=b.copyParameters(a,M),"miter"!==c.params.join&&(c.params.miterLimit=0),c.numVertsAtJoin="wall"===c.params.type?2:4,c.numVertsAtCap=2,c.canBeMerged="screen"===c.params.type&&null==c.params.stippleLength,c}return h(g,e),g.prototype.setColor=function(a){this.params.color=a;this.notifyDirty("matChanged")},g.prototype.getColor=function(){return this.params.color},g.prototype.dispose=function(){},
g.prototype.getParams=function(){return this.params},g.prototype.getParameterValues=function(){var a=this.params;return{color:a.color,width:a.width,type:a.type,join:a.join,polygonOffset:a.polygonOffset,miterLimit:a.miterLimit,stippleLength:a.stippleLength}},g.prototype.setParameterValues=function(a){for(var b in a)f.assert("type"!==b,"RibbonLineMaterial: type cannot be changed after creation"),f.assert("stippleLength"!==b||null!=a[b]==(null!=this.params[b]),"RibbonLineMaterial: stippleLength on/off cannot be changed after creation"),
this.params[b]=a[b];"miter"!==this.params.join&&(this.params.miterLimit=0);this.notifyDirty("matChanged")},g.prototype.getOutputAmount=function(a){a=(a/2+1-2)*this.numVertsAtJoin+2*this.numVertsAtCap;return this.canBeMerged&&(a+=2),a*r.getStride(P)/4},g.prototype.getInstanceBufferLayout=function(){},g.prototype.getVertexBufferLayout=function(){return"wall"===this.params.type?R:P},g.prototype.fillInterleaved=function(a,b,c,e,d,g){c=a.vertexAttr[f.VertexAttrConstants.POSITION].data;e=a.vertexAttr[f.VertexAttrConstants.COLOR]?
a.vertexAttr[f.VertexAttrConstants.COLOR].data:x;var h=a.vertexAttr[f.VertexAttrConstants.SIZE]?a.vertexAttr[f.VertexAttrConstants.SIZE].data:y;(a=a.indices&&a.indices[f.VertexAttrConstants.POSITION])&&a.length!==2*(c.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");"wall"===this.params.type?this.fillWithoutAuxpos(c,b,d,g):this.fillWithAuxpos(c,e,h,b,d,g)},g.prototype.intersect=function(b,e,d,g,h,k,l,q){if(g.isSelection&&!c.isAllHidden(e.componentVisibilities,b.data.componentOffsets)){var p,
m;e=b.getData();b=e.getVertexAttr()[f.VertexAttrConstants.POSITION].data;e=e.getVertexAttr()[f.VertexAttrConstants.SIZE];e=(e&&e.data[0])+this.params.width;h=Number.MAX_VALUE;k=g.camera;q=g.point;for(var r=0;r<b.length-5;r+=3){if(n[0]=b[r],n[1]=b[r+1],n[2]=b[r+2],a.mat4d.multiplyVec3(d,n),w[0]=b[r+3],w[1]=b[r+4],w[2]=b[r+5],a.mat4d.multiplyVec3(d,w),k.projectPoint(n,B),k.projectPoint(w,F),0>B[2]&&0<F[2])a.vec3d.subtract(n,w,z),p=k.frustumPlanes,m=-(a.vec3d.dot(p[4],n)+p[4][3]),p=m/a.vec3d.dot(z,p[4]),
a.vec3d.scale(z,p,z),a.vec3d.add(n,z,n),k.projectPoint(n,B);else if(0<B[2]&&0>F[2])a.vec3d.subtract(w,n,z),p=k.frustumPlanes,m=-(a.vec3d.dot(p[4],w)+p[4][3]),p=m/a.vec3d.dot(z,p[4]),a.vec3d.scale(z,p,z),a.vec3d.add(w,z,w),k.projectPoint(w,F);else if(0>B[2]&&0>F[2])continue;p=f.pointLineSegmentDistance2D(B,F,q);h>p&&(h=p,a.vec3d.set(n,G),a.vec3d.set(w,N))}d=g.p0;g=g.p1;e/2+4>h&&(b=f.lineSegmentLineSegmentDistance3D(G,N,d,g),e=Number.MAX_VALUE,b[0]&&(a.vec3d.subtract(b[2],d,C),e=a.vec3d.length(C)/a.vec3d.dist(d,
g)),l(e,C))}},g.prototype.getGLMaterials=function(){return{color:u,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:v}},g.prototype.getAllTextureIds=function(){return[]},g.prototype.fillWithAuxpos=function(a,b,c,e,d,f){var g=a.length/3,h=a[0],k=a[1],l=a[2],n=0,q=f,m=r.getStride(this.getVertexBufferLayout())/4;this.canBeMerged&&(f+=m);e&&(h=e[0]*h+e[4]*k+e[8]*l+e[12],k=e[1]*h+e[5]*k+e[9]*l+e[13],l=e[2]*h+e[6]*k+e[10]*l+e[14]);var t=h,u=k,w=l,v=a[3],x=a[4],y=a[5];e&&(v=e[0]*v+e[4]*x+e[8]*
y+e[12],x=e[1]*v+e[5]*x+e[9]*y+e[13],y=e[2]*v+e[6]*x+e[10]*y+e[14]);for(var z=0;g>z;z++){var C=3*z;g-1>z&&(v=a[C+3],x=a[C+4],y=a[C+5],e&&(v=e[0]*v+e[4]*x+e[8]*y+e[12],x=e[1]*v+e[5]*x+e[9]*y+e[13],y=e[2]*v+e[6]*x+e[10]*y+e[14]));n+=Math.sqrt((t-h)*(t-h)+(u-k)*(u-k)+(w-l)*(w-l));d[f++]=t;d[f++]=u;d[f++]=w;d[f++]=n;d[f++]=0===z?-1.2:-1;d[f++]=h;d[f++]=k;d[f++]=l;d[f++]=v;d[f++]=x;d[f++]=y;d[f++]=b[0];d[f++]=b[1];d[f++]=b[2];d[f++]=b[3];d[f++]=c[0];d[f++]=t;d[f++]=u;d[f++]=w;d[f++]=n;d[f++]=0===z?1.2:
1;d[f++]=h;d[f++]=k;d[f++]=l;d[f++]=v;d[f++]=x;d[f++]=y;d[f++]=b[0];d[f++]=b[1];d[f++]=b[2];d[f++]=b[3];d[f++]=c[0];0<z&&g-1>z&&(d[f++]=t,d[f++]=u,d[f++]=w,d[f++]=n,d[f++]=-1.2,d[f++]=h,d[f++]=k,d[f++]=l,d[f++]=v,d[f++]=x,d[f++]=y,d[f++]=b[0],d[f++]=b[1],d[f++]=b[2],d[f++]=b[3],d[f++]=c[0],d[f++]=t,d[f++]=u,d[f++]=w,d[f++]=n,d[f++]=1.2,d[f++]=h,d[f++]=k,d[f++]=l,d[f++]=v,d[f++]=x,d[f++]=y,d[f++]=b[0],d[f++]=b[1],d[f++]=b[2],d[f++]=b[3],d[f++]=c[0]);h=t;k=u;l=w;t=v;u=x;w=y}if(this.canBeMerged){for(z=
q;q+m>z;z++)d[z]=d[z+m];a=f-m;for(z=0;m>z;z++)d[f++]=d[a++]}},g.prototype.fillWithoutAuxpos=function(a,b,c,e){for(var d,f,g,h=a.length/3,k=0,l=a[0],n=a[1],q=a[2],m=0;h>m;m++){var r=3*m;d=l;f=n;g=q;l=a[r];n=a[r+1];q=a[r+2];b&&(l=b[0]*l+b[4]*n+b[8]*q+b[12],n=b[1]*l+b[5]*n+b[9]*q+b[13],q=b[2]*l+b[6]*n+b[10]*q+b[14]);k+=Math.sqrt((l-d)*(l-d)+(n-f)*(n-f)+(q-g)*(q-g));c[e++]=l;c[e++]=n;c[e++]=q;c[e++]=k;c[e++]=-1;c[e++]=l;c[e++]=n;c[e++]=q;c[e++]=k;c[e++]=1}},g.loadShaders=function(a,b,c,e){a._parse(d);
var f=function(a){a.addDefine("Screen","SCREENSCALE");a.addDefine("Strip","STRIP");a.addDefine("Wall","WALL");a.addDefine("Stipple","STIPPLE")},g=new t("ribbon-line",["vsRibbonLine","fsRibbonLine"],null,c,b,a,e);f(g);c.addShaderVariations("ribbon-line-material-shader-variations",g);a=new t("ribbon-line",["vsRibbonLine","fsRibbonLineHighlight"],null,c,b,a,e);f(a);c.addShaderVariations("ribbon-line-material-highlight-shader-variations",a)},g}(g.MaterialBase);var u=function(a){function c(c,e){var d=
a.call(this,c,e)||this;return d.params=b.copyParameters(c.getParams()),delete d.params.join,d.program=e.getShaderVariationsProgram("ribbon-line-material-shader-variations",["screen"===d.params.type,"strip"===d.params.type,"wall"===d.params.type,null!=d.params.stippleLength]),d}return h(c,a),c.prototype.updateParameters=function(){var a=this.material.getParams(),b=this.params;b.polygonOffset=a.polygonOffset;b.color=a.color;b.width=a.width;b.miterLimit="miter"===a.join?a.miterLimit:0;b.stippleLength=
a.stippleLength},c.prototype.beginSlot=function(a){return a===e.TRANSPARENT_MATERIAL},c.prototype.getProgram=function(){return this.program},c.prototype.bind=function(a,b){var c=this.program,e=this.params;(a.bindProgram(c),c.setUniform4fv("eColor",e.color),c.setUniform1f("miterLimit",e.miterLimit),c.setUniform1f("nearPlane",b.nearFar[0]),"screen"===e.type?(c.setUniform2fv("screenSize",[b.viewport[2],b.viewport[3]]),c.setUniform1f("extLineWidth",e.width*b.pixelRatio)):c.setUniform1f("extLineWidth",
e.width),null!=e.stippleLength)&&c.setUniform1f("stippleLengthDoubleInv",e.stippleLength?1/(2*e.stippleLength):0);e.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,-4));a.setFaceCullingEnabled(!1);a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);a.setDepthTestEnabled(!0);a.setDepthWriteEnabled(1<=e.color[3])},c.prototype.release=function(a){this.params.polygonOffset&&a.setPolygonOffsetFillEnabled(!1);
a.setBlendingEnabled(!1);a.setDepthWriteEnabled(!0)},c.prototype.bindView=function(a,c){b.bindView(c.origin,c.view,this.program)},c.prototype.bindInstance=function(a,b){this.program.setUniformMatrix4fv("model",b.transformation)},c.prototype.getDrawMode=function(a){return a.gl.TRIANGLE_STRIP},c}(k.GLMaterialBase),v=function(a){function c(c,e){var d=a.call(this,c,e)||this;return d.params=b.copyParameters(c.getParams()),delete d.params.join,d.program=e.getShaderVariationsProgram("ribbon-line-material-highlight-shader-variations",
["screen"===d.params.type,"strip"===d.params.type,"wall"===d.params.type,null!=d.params.stippleLength]),d}return h(c,a),c.prototype.updateParameters=function(){var a=this.material.getParams(),b=this.params;b.polygonOffset=a.polygonOffset;b.color=a.color;b.width=a.width;b.miterLimit="miter"===a.join?a.miterLimit:0;b.stippleLength=a.stippleLength},c.prototype.beginSlot=function(a){return a===e.OPAQUE_MATERIAL},c.prototype.getProgram=function(){return this.program},c.prototype.bind=function(a,b){var c=
this.program,e=this.params;(a.bindProgram(c),c.setUniform4fv("eColor",e.color),c.setUniform1f("miterLimit",e.miterLimit),c.setUniform1f("nearPlane",b.nearFar[0]),"screen"===e.type?(c.setUniform2fv("screenSize",[b.viewport[2],b.viewport[3]]),c.setUniform1f("extLineWidth",e.width*b.pixelRatio)):c.setUniform1f("extLineWidth",e.width),null!=e.stippleLength)&&c.setUniform1f("stippleLengthDoubleInv",e.stippleLength?1/(2*e.stippleLength):0);e.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),a.setPolygonOffset(0,
-4));a.setFaceCullingEnabled(!1);a.setDepthTestEnabled(!0);a.setDepthWriteEnabled(1<=e.color[3])},c.prototype.release=function(a){this.params.polygonOffset&&a.setPolygonOffsetFillEnabled(!1);a.setDepthWriteEnabled(!0)},c.prototype.bindView=function(a,c){b.bindView(c.origin,c.view,this.program)},c.prototype.bindInstance=function(a,b){this.program.setUniformMatrix4fv("model",b.transformation)},c.prototype.getDrawMode=function(a){return a.gl.TRIANGLE_STRIP},c}(k.GLMaterialBase),x=[255,255,255,255],y=
[0,0,0,0],n=a.vec3d.create(),w=a.vec3d.create(),z=a.vec3d.create(),C=a.vec3d.create(),B=a.vec2d.create(),F=a.vec2d.create(),G=a.vec3d.create(),N=a.vec3d.create(),M={color:[1,1,1,1],width:0,type:"screen",join:"miter",miterLimit:5,polygonOffset:!1,stippleLength:null},R=q.Pos3Tex,P=[{name:"position",count:3,type:5126,offset:0,stride:64,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:64,normalized:!1},{name:"auxpos1",count:3,type:5126,offset:20,stride:64,normalized:!1},{name:"auxpos2",count:3,
type:5126,offset:32,stride:64,normalized:!1},{name:"color",count:4,type:5126,offset:44,stride:64,normalized:!1},{name:"size",count:1,type:5126,offset:60,stride:64,normalized:!1}];return m})},"esri/views/3d/webgl-engine/materials/WaterMaterial":function(){define("dojo/text!./WaterMaterial.xml ./internal/MaterialUtil ../lib/RenderSlot ../../../webgl/Program ../lib/DefaultVertexAttributeLocations ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(m,l,h,d,b,g,k){var f=function(b,
c,d,f,h,m){l.basicMaterialConstructor(this,m);var e=g.Pos3;this.dispose=function(){};this.getNoiseTextureId=function(){return b};this.getReflTextureId=function(){return c};this.getColor=function(){return d};this.getScale=function(){return f};this.getSpeed=function(){return h};this.getOutputAmount=function(a){return a*k.getStride(e)/4};this.getVertexBufferLayout=function(){return e};this.fillInterleaved=function(a,b,c,d,f,g,h){l.fillInterleaved(a,b,c,d,e,f,g,h)};this.intersect=l.intersectTriangleGeometry;
this.getGLMaterials=function(){return{color:a,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};this.getAllTextureIds=function(){return[b,c]}},a=function(a,b,d){l.basicGLMaterialConstructor(this,a);var c=h.TRANSPARENT_MATERIAL,e=b.get("water");b={noiseTextureId:a.getNoiseTextureId(),reflTextureId:a.getReflTextureId()};l.multiTextureGLMaterialConstructor(this,d,b,[["noiseTextureId",void 0,"noiseTex"],["reflTextureId",void 0,"reflTex"]]);var f=a.getColor(),g=a.getScale(),k=a.getSpeed(),
q=Date.now();this.beginSlot=function(a){return c===a};this.getProgram=function(){return e};this.bind=function(a,b){a.bindProgram(e);this.bindTextures(a,e);e.setUniform3fv("color",f);e.setUniform1f("scale",g);a=(Date.now()-q)/1E5*k;a-=Math.floor(a);e.setUniform1f("speed",a);b.shadowMappingEnabled||e.setUniform1f("depthHalfPixelSz",-1)};this.release=function(a){};this.bindView=function(a,b){a=b.origin;l.bindView(a,b.view,e);l.bindCamPos(a,b.viewInvTransp,e);b.shadowMappingEnabled&&b.shadowMap.bindView(e,
a)};this.bindInstance=function(a,b){e.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.TRIANGLES}};return f.loadShaders=function(a,c,f,g){a._parse(m);a=new d(g,a.vertexShaderWater,a.fragmentShaderWater,b.Default3D);f.add("water",a)},f})},"esri/views/3d/webgl-engine/materials/MeasurementArrowMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/text!./MeasurementArrowMaterial.xml ./internal/MaterialUtil ../lib/Util ../../../webgl/Util ./internal/MaterialBase ./internal/GLMaterialBase ../lib/gl-matrix ../lib/RenderSlot ../lib/ShaderVariations".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){var t=e.vec3d,r=e.mat4d,u=[{name:g.VertexAttrConstants.POSITION,count:3,type:5126,offset:0,stride:36,normalized:!1},{name:g.VertexAttrConstants.NORMAL,count:3,type:5126,offset:12,stride:36,normalized:!1},{name:g.VertexAttrConstants.UV0,count:2,type:5126,offset:24,stride:36,normalized:!1},{name:g.VertexAttrConstants.AUXPOS1,count:1,type:5126,offset:32,stride:36,normalized:!1}],v={width:32,outlineSize:.2,outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,1,1,
1],stripeOddColor:[1,.5,0,1],polygonOffset:!1};m=function(a){function c(c,e){e=a.call(this,e)||this;return e.canBeMerged=!1,e.params=b.copyParameters(c,v),e}return h(c,a),c.prototype.dispose=function(){},c.prototype.getParameterValues=function(){var a=this.params;return{width:a.width,outlineSize:a.outlineSize,outlineColor:a.outlineColor,stripeLength:a.stripeLength,stripeEvenColor:a.stripeEvenColor,stripeOddColor:a.stripeOddColor,polygonOffset:a.polygonOffset}},c.prototype.setParameterValues=function(a){b.updateParameters(this.params,
a)&&this.notifyDirty("matChanged")},c.prototype.getParams=function(){return this.params},c.prototype.getOutputAmount=function(a){return 18*(a/2+1)},c.prototype.getInstanceBufferLayout=function(){},c.prototype.getVertexBufferLayout=function(){return u},c.prototype.fillInterleaved=function(a,c,e,d,f,h){d=a.vertexAttr[g.VertexAttrConstants.POSITION].data;var l=a.vertexAttr[g.VertexAttrConstants.NORMAL].data,q=d.length/3;(a=a&&a.indices&&a.indices.position)&&a.length!==2*(q-1)&&console.warn("MeasurementArrowMaterial does not support indices");
a=h+k.findAttribute(u,g.VertexAttrConstants.POSITION).offset/4;var m=h+k.findAttribute(u,g.VertexAttrConstants.NORMAL).offset/4,v=h+k.findAttribute(u,g.VertexAttrConstants.UV0).offset/4;h+=k.findAttribute(u,g.VertexAttrConstants.AUXPOS1).offset/4;for(var x=y,F=n,B=w,p=z,A=C,G=0,N=0;q>N;++N){var M=3*N;if(t.set3(d[M],d[M+1],d[M+2],x),q-1>N)M=3*(N+1),t.set3(d[M],d[M+1],d[M+2],F),t.set3(l[M],l[M+1],l[M+2],A),t.normalize(A),t.subtract(F,x,B),t.normalize(B),t.cross(A,B,p),t.normalize(p);M=t.dist(x,F);c&&
e&&(r.multiplyVec3(c,x),r.multiplyVec3(c,F),r.multiplyVec3(e,p));b.fill(x,0,f,a,void 0,3);a+=9;b.fill(x,0,f,a,void 0,3);a+=9;b.fill(p,0,f,m,void 0,3);m+=9;b.fill(p,0,f,m,void 0,3);m+=9;f[v]=G;f[v+1]=-1;v+=9;f[v]=G;f[v+1]=1;v+=9;q-1>N&&(G+=M)}for(N=0;q>N;++N)f[h]=G,h+=9,f[h]=G,h+=9},c.prototype.intersect=function(a,b,c,e,d,f,g,h){},c.prototype.getGLMaterials=function(){return{color:x,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}},c.prototype.getAllTextureIds=function(){return[]},
c.loadShaders=function(a,b,c,e){a._parse(d);a=new q("measurement-arrow",["vsMeasurementArrow","fsMeasurementArrow"],null,c,b,a,e);c.addShaderVariations("measurement-arrow-material-shader-variations",a)},c}(f.MaterialBase);var x=function(a){function e(c,e,d){d=a.call(this,c,e,d)||this;return d.programRep=e,d.params=b.copyParameters(c.getParams()),d.selectProgram(),d}return h(e,a),e.prototype.selectProgram=function(){this.program=this.programRep.getShaderVariationsProgram("measurement-arrow-material-shader-variations",
[])},e.prototype.updateParameters=function(){this.params=this.material.getParameterValues();this.selectProgram()},e.prototype.beginSlot=function(a){return a===c.OPAQUE_MATERIAL},e.prototype.getProgram=function(){return this.program},e.prototype.getDrawMode=function(a){return a.gl.TRIANGLE_STRIP},e.prototype.bind=function(a,b){b=this.program;a.setDepthTestEnabled(!0);a.setDepthWriteEnabled(!0);a.setFaceCullingEnabled(!1);a.setBlendingEnabled(!1);this.params.polygonOffset&&(a.setPolygonOffsetFillEnabled(!0),
a.setPolygonOffset(0,-4));a.bindProgram(b);b.setUniform1f("width",this.params.width);b.setUniform1f("outlineSize",this.params.outlineSize);b.setUniform4fv("outlineColor",this.params.outlineColor);b.setUniform1f("stripeLength",this.params.stripeLength);b.setUniform4fv("stripeEvenColor",this.params.stripeEvenColor);b.setUniform4fv("stripeOddColor",this.params.stripeOddColor)},e.prototype.bindView=function(a,c){a=c.origin;var e=this.getProgram();b.bindView(a,c.view,e)},e.prototype.bindInstance=function(a,
b){this.getProgram().setUniformMatrix4fv("model",b.transformation)},e.prototype.release=function(a){a.setDepthTestEnabled(!0);a.setDepthWriteEnabled(!0);a.setBlendingEnabled(!1);this.params.polygonOffset&&a.setPolygonOffsetFillEnabled(!1)},e}(a.GLMaterialBase),y=t.create(),n=t.create(),w=t.create(),z=t.create(),C=t.create();a=r.create();return r.identity(a),m})},"esri/views/3d/webgl-engine/materials/internal/SimpleGLMaterial":function(){define("require exports dojo/text!./SimpleGLMaterial.xml ./MaterialUtil ../../lib/RenderSlot ../../../../webgl/Program ../../../../webgl/enums ../../lib/DefaultVertexAttributeLocations".split(" "),
function(m,l,h,d,b,g,k,f){return function(){function a(a,b,f,g){void 0===g&&(g=4);this.id=d.__GLMaterial_id++;this.program=a.get("simple");this.color=b;this.depthFunc=f;this.drawMode=g}return a.prototype.getId=function(){return this.id},a.prototype.beginSlot=function(a){return a===b.INTERNAL_MATERIAL},a.prototype.getProgram=function(){return this.program},a.prototype.bind=function(a,b){a.bindProgram(this.program);this.program.setUniformMatrix4fv("model",d.IDENTITY);this.program.setUniformMatrix4fv("proj",
b.proj);this.program.setUniform4fv("color",this.color);a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);a.setDepthTestEnabled(!0);void 0!==this.depthFunc&&a.setDepthFunction(this.depthFunc)},a.prototype.release=function(a){void 0!==this.depthFunc&&a.setDepthFunction(513);a.setBlendingEnabled(!1)},a.prototype.bindView=function(a,b){d.bindView(b.origin,b.view,this.program)},a.prototype.bindInstance=function(a,b){this.program.setUniformMatrix4fv("model",
b.transformation)},a.prototype.getDrawMode=function(a){return this.drawMode},a.loadShaders=function(a,b,d,k){a._parse(h);a=new g(k,a.vertexShaderSimple,a.fragmentShaderSimple,f.Default3D);d.add("simple",a)},a}()})},"esri/views/3d/webgl-engine/materials/internal/BlendLayers":function(){define(["dojo/text!./BlendLayers.xml","../../../../webgl/Program","../../lib/DefaultVertexAttributeLocations"],function(m,l,h){return{loadShaders:function(d,b,g,k){d._parse(m);d=new l(k,d.vertexShaderBlendLayers,d.fragmentShaderBlendLayers,
h.Default3D);g.add("blendLayers",d)}}})},"esri/views/3d/webgl-engine/lib/tracer":function(){define(["require","exports","./webgl-debug"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});var d=null,b=[];l.enabled=!1;l.begin=function(){l.enabled&&(d=[])};l.trace=function(b){l.enabled&&null!=d&&d.push(b)};l.end=function(){if(l.enabled){var g=d;return d=null,g&&(b.forEach(function(b){return b(g)}),b.length=0),g}};l.instrumentContext=function(b){return l.enabled?h.makeDebugContext(b,void 0,
function(b,f){l.enabled&&d&&d.push("gl."+b+"("+h.glFunctionArgsToString(b,f)+")")}):b};l.request=function(d){b.push(d)}})},"esri/views/3d/webgl-engine/lib/webgl-debug":function(){define([],function(){function m(b){if(null==a){a={};e={};for(var c in b)"number"==typeof b[c]&&(a[b[c]]=c,e[c]=b[c])}}function l(){if(null==a)throw"WebGLDebugUtils.init(ctx) not called";}function h(b){l();var c=a[b];return void 0!==c?"gl."+c:"/*UNKNOWN WebGL ENUM*/ 0x"+b.toString(16)}function d(a,b,d,g){a=f[a];if(void 0!==
a&&(a=a[b],void 0!==a&&a[d])){if("object"==typeof a[d]&&void 0!==a[d].enumBitwiseOr){b=a[d].enumBitwiseOr;d=0;a=[];for(var c=0;c<b.length;++c){var k=e[b[c]];0!==(g&k)&&(d|=k,a.push(h(k)))}return d===g?a.join(" | "):h(g)}return h(g)}return null===g?"null":void 0===g?"undefined":g.toString()}function b(a,b,e){a.__defineGetter__(e,function(){return b[e]});a.__defineSetter__(e,function(a){b[e]=a})}function g(a,e,f,k){function c(a,b){return function(){f&&f(b,arguments);var c=a[b].apply(a,arguments),d=
k.getError();return 0!=d&&(l[d]=!0,e(d,b,arguments)),c}}k=k||a;m(a);e=e||function(a,b,c){for(var e="",f=c.length,g=0;f>g;++g)e+=(0==g?"":", ")+d(b,f,g,c[g]);a="WebGL error "+h(a)+" in "+b+"("+e+")";window.console&&window.console.error?window.console.error(a):window.console&&window.console.log&&window.console.log(a)};var l={},q={},r;for(r in a)if("function"==typeof a[r])if("getExtension"!=r)q[r]=c(a,r);else{var n=c(a,r);q[r]=function(){var b=n.apply(a,arguments);return g(b,e,f,k)}}else b(q,a,r);return q.getError=
function(){for(var b in l)if(l.hasOwnProperty(b)&&l[b])return l[b]=!1,b;return a.NO_ERROR},q}function k(a){var b=a.getParameter(a.MAX_VERTEX_ATTRIBS),c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c);for(var e=0;b>e;++e)a.disableVertexAttribArray(e),a.vertexAttribPointer(e,4,a.FLOAT,!1,0,0),a.vertexAttrib1f(e,0);a.deleteBuffer(c);b=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);for(e=0;b>e;++e)a.activeTexture(a.TEXTURE0+e),a.bindTexture(a.TEXTURE_CUBE_MAP,null),a.bindTexture(a.TEXTURE_2D,null);a.activeTexture(a.TEXTURE0);
a.useProgram(null);a.bindBuffer(a.ARRAY_BUFFER,null);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindRenderbuffer(a.RENDERBUFFER,null);a.disable(a.BLEND);a.disable(a.CULL_FACE);a.disable(a.DEPTH_TEST);a.disable(a.DITHER);a.disable(a.SCISSOR_TEST);a.blendColor(0,0,0,0);a.blendEquation(a.FUNC_ADD);a.blendFunc(a.ONE,a.ZERO);a.clearColor(0,0,0,0);a.clearDepth(1);a.clearStencil(-1);a.colorMask(!0,!0,!0,!0);a.cullFace(a.BACK);a.depthFunc(a.LESS);a.depthMask(!0);a.depthRange(0,
1);a.frontFace(a.CCW);a.hint(a.GENERATE_MIPMAP_HINT,a.DONT_CARE);a.lineWidth(1);a.pixelStorei(a.PACK_ALIGNMENT,4);a.pixelStorei(a.UNPACK_ALIGNMENT,4);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);a.UNPACK_COLORSPACE_CONVERSION_WEBGL&&a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.BROWSER_DEFAULT_WEBGL);a.polygonOffset(0,0);a.sampleCoverage(1,!1);a.scissor(0,0,a.canvas.width,a.canvas.height);a.stencilFunc(a.ALWAYS,0,4294967295);a.stencilMask(4294967295);
a.stencilOp(a.KEEP,a.KEEP,a.KEEP);a.viewport(0,0,a.canvas.width,a.canvas.height);for(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT|a.STENCIL_BUFFER_BIT);a.getError(););}var f={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},
getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,
1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,
1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},a=null,e=null;return{init:m,mightBeEnum:function(b){return l(),void 0!==a[b]},glEnumToString:h,glFunctionArgToString:d,
glFunctionArgsToString:function(a,b){for(var c="",e=b.length,f=0;e>f;++f)c+=(0==f?"":", ")+d(a,e,f,b[f]);return c},makeDebugContext:g,makeLostContextSimulatingCanvas:function(a){function c(a){return"function"==typeof a?a:function(b){a.handleEvent(b)}}function e(){for(var a=Object.keys(P),b=0;b<a.length;++b)delete P[a]}function d(){++N;B||G==N&&a.loseContext()}function f(a,b){var c=a[b];return function(){if(d(),!B)return c.apply(a,arguments)}}function g(a){return{statusMessage:a,preventDefault:function(){M=
!0}}}function h(a){for(var c in a)"function"==typeof a[c]?n[c]=f(a,c):b(n,a,c);n.getError=function(){if(d(),!B)for(var a;a=l.getError();)P[a]=!0;for(a in P)if(P[a])return delete P[a],a;return n.NO_ERROR};var e="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");for(c=0;c<e.length;++c){var g=e[c];n[g]=function(b){return function(){if(d(),B)return null;var c=b.apply(a,arguments);return c.__webglDebugContextLostId__=C,F.push(c),c}}(a[g])}e="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");
for(c=0;c<e.length;++c)g=e[c],n[g]=function(b){return function(){return d(),B?null:b.apply(a,arguments)}}(n[g]);e="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(c=0;c<e.length;++c)g=e[c],n[g]=function(b){return function(){return d(),B?!1:b.apply(a,arguments)}}(n[g]);return n.checkFramebufferStatus=function(b){return function(){return d(),B?n.FRAMEBUFFER_UNSUPPORTED:b.apply(a,arguments)}}(n.checkFramebufferStatus),n.getAttribLocation=function(b){return function(){return d(),
B?-1:b.apply(a,arguments)}}(n.getAttribLocation),n.getVertexAttribOffset=function(b){return function(){return d(),B?0:b.apply(a,arguments)}}(n.getVertexAttribOffset),n.isContextLost=function(){return B},n}var l,n,m=[],z=[];n={};var C=1,B=!1,F=[],G=0,N=0,M=!1,R=0,P={};a.getContext=function(b){return function(){var c=b.apply(a,arguments);if(c instanceof WebGLRenderingContext){if(c!=l){if(l)throw"got different context";l=c;n=h(l)}return n}return c}}(a.getContext);return function(a){var b=a.addEventListener;
a.addEventListener=function(e,d,f){switch(e){case "webglcontextlost":m.push(c(d));break;case "webglcontextrestored":z.push(c(d));break;default:b.apply(a,arguments)}}}(a),a.loseContext=function(){if(!B){B=!0;G=0;for(++C;l.getError(););e();P[l.CONTEXT_LOST_WEBGL]=!0;var b=g("context lost"),c=m.slice();setTimeout(function(){for(var e=0;e<c.length;++e)c[e](b);0<=R&&setTimeout(function(){a.restoreContext()},R)},0)}},a.restoreContext=function(){B&&z.length&&setTimeout(function(){if(!M)throw"can not restore. webglcontestlost listener did not call event.preventDefault";
for(var a=0;a<F.length;++a){var b=F[a];b instanceof WebGLBuffer?l.deleteBuffer(b):b instanceof WebGLFramebuffer?l.deleteFramebuffer(b):b instanceof WebGLProgram?l.deleteProgram(b):b instanceof WebGLRenderbuffer?l.deleteRenderbuffer(b):b instanceof WebGLShader?l.deleteShader(b):b instanceof WebGLTexture&&l.deleteTexture(b)}k(l);B=!1;N=0;M=!1;for(var a=z.slice(),b=g("context restored"),c=0;c<a.length;++c)a[c](b)},0)},a.loseContextInNCalls=function(a){if(B)throw"You can not ask a lost contet to be lost";
G=N+a},a.getNumCalls=function(){return N},a.setRestoreTimeout=function(a){R=a},a},resetToInitialState:k}})},"esri/views/3d/webgl-engine/lib/ProgramRepository":function(){define(["require","exports","./Util"],function(m,l,h){return function(){function d(){this.shaderVariators={};this._nextId=0;this._programsByName={};this._namesById=[];this._programRefCount=[];this._commonUniforms={model:[],modelNormal:[],lightDirection:[],proj:[],shadowMapDistance:[],viewportPixelSz:[],lightingMainDirection:[]}}return d.prototype.dispose=
function(){for(var b in this._programsByName)this._programsByName[b].dispose();this._programRefCount=this._namesById=this._programsByName=null},d.prototype.add=function(b,d){h.assert(null==this._programsByName[b]);this._programsByName[b]=d;this._namesById[d.id]=b},d.prototype.get=function(b){return this._programsByName[b]},d.prototype.addShaderVariations=function(b,d){this.shaderVariators[b]=d},d.prototype.getShaderVariations=function(b){return this.shaderVariators[b]},d.prototype.getShaderVariationsProgram=
function(b,d,h,f){return(b=this.getShaderVariations(b))&&b.getProgram(d,h,f)},d.prototype.getProgramsUsingUniform=function(b){return this._commonUniforms[b]||[]},d.prototype.increaseRefCount=function(b){var d=b.id;this._programRefCount[d]?this._programRefCount[d]++:(this._programRefCount[d]=1,this._findCommonUniforms(b))},d.prototype.decreaseRefCount=function(b){var d=b.id;1<this._programRefCount[d]?this._programRefCount[d]--:(this._forgetCommonUniforms(b),this._programRefCount[d]=0)},d.prototype._getNextId=
function(){return this._nextId++},d.prototype._findCommonUniforms=function(b){for(var d in this._commonUniforms)b.hasUniform(d)&&(h.assert(-1===this._commonUniforms[d].indexOf(b),"common uniforms of program have already been determined"),this._commonUniforms[d].push(b))},d.prototype._forgetCommonUniforms=function(b){for(var d in this._commonUniforms){var h=this._commonUniforms[d],f=h.indexOf(b);-1<f&&(h[f]=h[h.length-1],h.pop())}},d}()})},"esri/views/3d/support/CombinedElevationProvider":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ./Evented".split(" "),
function(m,l,h,d,b,g,k){return function(f){function a(a){var b=f.call(this)||this;return b.providers={im:[],ground:[],scene:[]},b.handles=new Map,b.elevationChange=function(a){b.emit("elevation-change",a)},b}return h(a,f),a.prototype.getElevation=function(a,b){var c=-(1/0),e=!1;if("scene"===b)for(var d=0,f=this.providers.im;d<f.length;d++){var g=f[d],g=g.getElevation(a,b);null!=g&&(c=Math.max(g,c),!e&&isFinite(c)&&(e=!0))}if(!e)for(e=0,d=this.providers.ground;e<d.length;e++)g=d[e],g=g.getElevation(a,
b),null!=g&&(c=Math.max(g,c));if("scene"===b)for(e=0,d=this.providers.scene;e<d.length;e++)g=d[e],g=g.getElevation(a,b),null!=g&&(c=Math.max(g,c));return isFinite(c)?c:null},a.prototype.register=function(a,b){this.handles.set(b,b.on("elevation-change",this.elevationChange));this.providers[a].push(b)},a.prototype.unregister=function(a){this.handles.has(a)&&(this.handles.get(a).remove(),this.handles["delete"](a));for(var b=0,e=Object.keys(this.providers);b<e.length;b++){var d=e[b],f=this.providers[d].indexOf(a);
-1<f&&this.providers[d].splice(f,1)}},d([b.property({constructOnly:!0})],a.prototype,"view",void 0),d([b.property({readOnly:!0,aliasOf:"view.basemapTerrain.spatialReference"})],a.prototype,"spatialReference",void 0),a=d([b.subclass("esri.views.3d.support.CombinedElevationProvider")],a)}(b.declared(g,k.Evented))})},"esri/views/3d/support/HighlightOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../Color".split(" "),
function(m,l,h,d,b,g,k){return function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;return a.color=new k([0,255,255]),a.haloOpacity=1,a.fillOpacity=.25,a}return h(a,f),a.toEngineOptions=function(a){return{color:new Float32Array(k.toUnitRGBA(a.color)),haloOpacity:a.haloOpacity,haloOpacityOccluded:.25*a.haloOpacity,fillOpacity:a.fillOpacity,fillOpacityOccluded:.25*a.fillOpacity}},d([b.property({type:k})],a.prototype,"color",void 0),d([b.property()],a.prototype,"haloOpacity",void 0),
d([b.property()],a.prototype,"fillOpacity",void 0),a=d([b.subclass()],a)}(b.declared(g))})},"esri/views/3d/support/RenderCoordsHelper":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/support/scaleUtils ../lib/glMatrix ./earthUtils ./projectionUtils ../webgl-engine/lib/BufferVectorMath ../webgl-engine/lib/Util".split(" "),function(m,l,h,d,b,g,k,f,a,e,c){Object.defineProperty(l,"__esModule",{value:!0});
l.createRenderCoordsHelper=function(a,b){return"global"===a?new q(b):new t(b)};m=function(){function c(a,b){this.spatialReference=a;this.unitInMeters=b}return c.prototype.toRenderCoords=function(c,e,d){return c instanceof b?a.pointToVector(c,e,this.spatialReference):a.vectorToVector(c,e,d,this.spatialReference)},c.prototype.fromRenderCoords=function(c,e,f){return e instanceof b?a.vectorToPoint(c,this.spatialReference,e,f):e instanceof d?a.vectorToPoint(c,this.spatialReference,e):a.vectorToVector(c,
this.spatialReference,e,f)},c}();l.RenderCoordsHelper=m;var q=function(b){function d(c){return b.call(this,c||a.SphericalECEFSpatialReference,1)||this}return h(d,b),d.prototype.getAltitude=function(a,b){void 0===b&&(b=0);return e.Vec3Compact.length(a,b)-f.earthRadius},d.prototype.setAltitude=function(a,b){a=(a+f.earthRadius)/e.Vec3Compact.length(b,0);e.Vec3Compact.scale(b,0,a)},d.prototype.setAltitudeOfTransformation=function(a,b){a=(a+f.earthRadius)/e.Vec3Compact.length(b,12);e.Vec3Compact.scale(b,
12,a)},d.prototype.worldUpAtPosition=function(a,b){return k.vec3d.normalize(a||[0,0,0],b)},d.prototype.intersectManifold=function(a,b,e,d){return void 0===d&&(d=k.vec3d.create()),c.raySphere(a,b,null,f.earthRadius+e,u)?0>k.vec3d.dot(k.vec3d.direction(u,a,v),b)?!1:(k.vec3d.set(u,d),!0):!1},d}(m),t=function(a){function b(b){b=a.call(this,b,g.getMetersPerUnitForSR(b))||this;return b.worldUp=[0,0,1],b}return h(b,a),b.prototype.getAltitude=function(a,b){return b?a[b+2]:a[2]},b.prototype.setAltitude=function(a,
b){b[2]=a},b.prototype.setAltitudeOfTransformation=function(a,b){b[14]=a},b.prototype.worldUpAtPosition=function(a,b){return k.vec3d.set(this.worldUp,b)},b.prototype.intersectManifold=function(a,b,e,d){return void 0===d&&(d=k.vec3d.create()),k.vec4d.set4(this.worldUp[0],this.worldUp[1],this.worldUp[2],-e,r),c.rayPlane(a,b,r,u)?0>k.vec3d.dot(k.vec3d.direction(u,a,v),b)?!1:(k.vec3d.set(u,d),!0):!1},b}(m),r=k.vec4d.create(),u=k.vec3d.create(),v=k.vec3d.create()})},"esri/views/3d/support/MapCoordsHelper":function(){define("dojo/Evented dojo/Deferred ../../../core/declare ../../../portal/support/geometryServiceUtils ../../../tasks/support/ProjectParameters ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/support/scaleUtils".split(" "),
function(m,l,h,d,b,g,k,f){return h(m,{unitInMeters:1,spatialReference:null,constructor:function(a,b,c){this.spatialReference=b;this.unitInMeters=f.getMetersPerUnitForSR(this.spatialReference);(this.geometryService=c)||d.create(a&&a.portalItem).then(function(a){this.geometryService=a}.bind(this)).otherwise(function(){})},toGeographic:function(a){var e=new l,c=!0,d=this.spatialReference;if(!this.geometryService)return e.reject("Must specify geometryService in esri/config"),e;Array.isArray(a[0])&&"number"!=
typeof a[0]||(a=[a],c=!1);a.forEach(function(b,c){b instanceof k||(a[c]=new k(b,d))});var f=new b({geometries:a,outSR:g.WGS84});return this.geometryService.project(f).then(function(a){try{a=a.map(function(a){return[a.x,a.y]}),e.resolve(c?a:a[0])}catch(u){e.reject(u)}},function(a){e.reject(a)}),e.promise},canProject:function(){return!!this.geometryService}})})},"esri/views/3d/support/ResourceController":function(){define("../../../core/declare ../../../core/Scheduler ../../../core/HandleRegistry ./StreamDataSupplier ./StreamDataLoader ./PreallocArray ../webgl-engine/lib/Util".split(" "),
function(m,l,h,d,b,g,k){function f(a){this.budget=this.begin=0;this.performance=a;this.enabled=!0}var a=k.assert,e={TERRAIN:"terrain",SCENE:"scene",SYMBOLOGY:"symbols"},c=new g(20);f.prototype.now=function(){return this.performance.now()};f.prototype.reset=function(a){this.begin=this.now();this.budget=this.enabled?a:Number.MAX_VALUE};f.prototype.done=function(){return this.enabled&&this.elapsed()>=this.budget};f.prototype.remaining=function(){return Math.max(this.budget-this.elapsed(),0)};f.prototype.elapsed=
function(){return this.now()-this.begin};m=m(null,{constructor:function(a,c,d){d=d||k.performance;this._clients=[];this._frameWorker=null;this._budget=new f(d);this._idleFrameWorkers=[];this._idleFrameWorkerRobin=0;this._idleUpdatesStartFired=!1;this._lastTargetChangeTime=d.now();this.navigationTimeout=300;this.animatingFrameTimeBudget=10;this.idleFrameWorkerBudget=30;this.idleFrameTimeBudget=50;d={};for(var g in e)d[e[g]]=0;d[e.TERRAIN]=15;d[e.SCENE]=20;d[e.SYMBOLOGY]=5;this._maxGpuMemory=500;this.streamDataLoader=
new b(d);this._cameraListeners=new h;this._cameraListeners.add([a.watch("state.camera",this._cameraChangedHandler.bind(this),!0)]);c||(c=l);this._frameTask=c.addFrameTask({update:this._frameUpdate.bind(this)});this._view=a;this.stats={frameUpdateTime:new q,idleUpdateTime:new q};this.frameUpdateNavigation=null},destroy:function(){this._frameTask.remove();this._frameTask=null;this._cameraListeners.remove();this.streamDataLoader.destroy();this.streamDataLoader=null},setEnableBudget:function(a){this._budget.enabled=
!!a},registerClient:function(a,b,c){return this._clients.push({client:a,type:b}),"function"==typeof a.setMaxGpuMemory&&a.setMaxGpuMemory(this._maxGpuMemory),new d(b,this.streamDataLoader,c)},deregisterClient:function(a){for(var b=0;b<this._clients.length;b++)if(this._clients[b].client===a)return this._clients[b]=this._clients[this._clients.length-1],void this._clients.pop();console.warn("deregistering an unregistered client.")},setMaxGpuMemory:function(a){this._maxGpuMemory=a;for(var b=0;b<this._clients.length;b++){var c=
this._clients[b].client;"function"==typeof c.setMaxGpuMemory&&c.setMaxGpuMemory(a)}},registerIdleFrameWorker:function(b,c){var e=this._idleFrameWorkers.some(function(a){return a.client===b});a(!e,"Can only register idle frame workers once per client/layer");a(!c.idleFrame||c.needsUpdate,"needsUpdate has to be specified if idleFrame is specified");this._idleFrameWorkers.push({client:b,callbacks:c});this._isIdle()&&this._idleUpdatesStartFired&&c.idleBegin&&c.idleBegin.call(b)},deregisterIdleFrameWorker:function(a){for(var b=
this._idleFrameWorkers,c=0;c<b.length;c++){var e=b[c];if(e.client===a)return this._idleUpdatesStartFired&&e.callbacks.idleEnd&&e.callbacks.idleEnd.call(a),b[c]=b[b.length-1],void b.pop()}},registerFrameWorker:function(b){a(!this._frameWorker,"Only one (non-idle) per-frame worker supported at the moment");this._frameWorker=b},deregisterFrameWorker:function(){this._frameWorker=null},_cameraChangedHandler:function(){this._lastTargetChangeTime=this._budget.now();this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=
!1,this._callWorkersNoScheduling("idleEnd"))},_frameUpdate:function(a){var b=this._isIdle()?this.idleFrameWorkerBudget:this.animatingFrameTimeBudget;this._budget.reset(b-a.spendInFrame);this._view.stateManager&&this._view.stateManager.step(a.deltaTime/1E3);this._view.inputManager&&this._view.inputManager._pinchNavigation&&this._view.inputManager._pinchNavigation.momentum.doFrameUpdate(a.deltaTime);this._frameWorker&&(this._frameWorker(this._budget),this.stats.frameUpdateTime.addSample(this._budget.elapsed()));
this._isIdle()&&(this._idleUpdatesStartFired||(this._callWorkersNoScheduling("idleBegin"),this._idleUpdatesStartFired=!0),this._budget.reset(this.idleFrameTimeBudget-this._budget.elapsed()),3<this._budget.remaining()&&(this._callWorkersStrictScheduling("idleFrame",this._budget),this.stats.idleUpdateTime.addSample(this._budget.elapsed())))},_isIdle:function(){return this._budget.now()-this._lastTargetChangeTime>this.navigationTimeout},_callWorkersNoScheduling:function(a){for(var b=this._idleFrameWorkers,
c=0;c<b.length;c++){var e=b[c];e.callbacks[a]&&e.callbacks[a].call(e.client)}},_callWorkersStrictScheduling:function(a,b){var e,d,f,g=this._idleFrameWorkers,h=g.length;c.clear();d=0;for(f=this._idleFrameWorkerRobin;h>d;d++)e=g[f++%h],e.callbacks.needsUpdate&&e.callbacks.needsUpdate.call(e.client)&&(0===c.length&&(this._idleFrameWorkerRobin=f),c.push(e));e=b.now();for(d=e+b.remaining();0<c.length&&d>e;)b.reset((d-e)/c.length),e=c.pop(),e.callbacks[a].call(e.client,b),e=b.now()}});m.ClientType=e;var q=
function(){this.addSample=function(a){this.min=Math.min(this.min,a);this.max=Math.max(this.max,a);this.total+=a;this.numSamples++};this.getAverage=function(){return this.total/this.numSamples};this.reset=function(){this.numSamples=this.total=0;this.min=Number.MAX_VALUE;this.max=-Number.MAX_VALUE};this.reset()};return m})},"esri/views/3d/support/StreamDataSupplier":function(){define(["require","exports"],function(m,l){return function(){function h(d,b,g){this._clientType=d;this._loader=b;this._activeRequests=
null;g&&g.trackRequests&&(this._activeRequests=new Map)}return h.prototype.request=function(d,b,g){var h=this;b=this._loader.request(d,b,this._clientType,g);this._activeRequests&&(this._activeRequests.set(d,b),g=function(){h._activeRequests["delete"](d)},b.then(g,g));return b},h.prototype.isRequested=function(d){return this._loader.isRequested(d)},h.prototype.cancelRequest=function(d){this._loader.cancel(d)},h.prototype.cancelAll=function(){var d=this;this._activeRequests&&(this._activeRequests.forEach(function(b){d._loader.cancel(b)}),
this._activeRequests.clear())},h.prototype.hasPendingDownloads=function(){return this._loader.hasPendingDownloads()},h}()})},"esri/views/3d/support/StreamDataLoader":function(){define("../../../core/declare ../../../request ../../../core/urlUtils ./PromiseLightweight ./AsyncQuotaRoundRobinQueue ../webgl-engine/lib/Util".split(" "),function(m,l,h,d,b,g){var k=g.assert,f={QUEUED:1,DOWNLOADING:2,CANCELLED:4};m=m(null,{constructor:function(a){this.alreadyLoading={};this.loadQueue=new b(e,this._doneLoadingCallback,
this,a);this._urlInfo={hasSameOrigin:{},canUseXhr:{}}},destroy:function(){for(var a in this.alreadyLoading){for(var b=this.alreadyLoading[a],e=0;e<b.clientPromises.length;e++){var d=b.clientPromises[e];d.isRejected()||d.reject(b.url,null,b.docType,b.clientMetadata[e])}this._cancelTask(b)}this.loadQueue.clear();this.alreadyLoading=this.loadQueue=null},request:function(a,b,e,g){g=g||{};var c=new d.Promise(function(){this.cancel(c)}.bind(this));c.requestURL=a;var h=this.alreadyLoading[a];return h?(h.clientPromises.push(c),
h.clientMetadata.push(g.metadata)):(h={url:a,docType:b,clientType:e,status:f.QUEUED,clientMetadata:[g.metadata],clientPromises:[c],downloadObj:null,_cancelledInQueue:!1},this.alreadyLoading[a]=h,this.loadQueue.push(h)),c},isRequested:function(a){return void 0!==this.alreadyLoading[a]},cancel:function(a){var b=this.alreadyLoading[a.requestURL];b&&this._removeRequestPromiseFromTask(b,a)},hasPendingDownloads:function(){return!g.objectEmpty(this.alreadyLoading)},_removeRequestPromiseFromTask:function(a,
b){var c=a.clientPromises.length;1<c?(b=a.clientPromises.indexOf(b),k(-1<b,"request to be cancelled is already cancelled or invalid"),a.clientPromises[b]=a.clientPromises[c-1],a.clientPromises.pop(),a.clientMetadata[b]=a.clientMetadata[c-1],a.clientMetadata.pop()):(k(a.clientPromises[0]===b,"request to be cancelled is already cancelled or invalid"),this._cancelTask(a))},_cancelTask:function(a){if(a.status===f.DOWNLOADING){if(this.loadQueue.workerCancelled(a),"image"===a.docType&&h.isDataProtocol(a.url)){var b=
a.downloadObj;b.removeAttribute("onload");b.removeAttribute("onerror");b.removeAttribute("src")}else a.status=f.CANCELLED,a.downloadObj.cancel();a.downloadObj=null}a.status=f.CANCELLED;a.clientPromises=void 0;a.clientMetadata=void 0;delete this.alreadyLoading[a.url]},_doneLoadingCallback:function(a,b){var c;if(k(a.status===f.DOWNLOADING),delete this.alreadyLoading[a.url],b)for(c=0;c<a.clientPromises.length;c++)a.clientPromises[c].isRejected()||a.clientPromises[c].reject(a.url,b,a.docType,a.clientMetadata[c]);
else for(c=0;c<a.clientPromises.length;c++)a.clientPromises[c].done(a.url,a.result,a.docType,a.clientMetadata[c])}});var a=function(a,b,e){a.onload=function(){b.status!==f.CANCELLED&&(b.result=a,a.removeAttribute("onload"),a.removeAttribute("onerror"),e(b))};a.onerror=function(){b.status!==f.CANCELLED&&(a.removeAttribute("onload"),a.removeAttribute("onerror"),e(b,{status:404}))}},e=function(b,e){if(b.status===f.CANCELLED)return!1;if(b.status=f.DOWNLOADING,"image"===b.docType&&h.isDataProtocol(b.url)){var c=
new Image;return a(c,b,e),c.src=b.url,b.downloadObj=c,!0}var d;switch(b.docType){case "binary":d="array-buffer";c=0;break;case "image":d="image";break;default:d="json"}return b.downloadObj=l(b.url,{responseType:d,timeout:c,allowImageDataAccess:"image"===b.docType}),b.downloadObj.then(function(a){b.duration=g.performance.now()-b.startTime;b.size=0;b.result=a.data;e(b)},function(a){b.downloadObj.isCanceled()||e(b,a)}),!0};return m.TaskStatus=f,m})},"esri/views/3d/support/PromiseLightweight":function(){!function(m){function l(b){this._callbacks=
[];this._errbacks=[];this._cancelCallback=b;this._iserr=this._isdone=this._iscancelled=!1}function h(b,d){var g=new l;return 0===b.length?g.done.apply(g,d):b[0].apply(null,d).then(function(){b.splice(0,1);h(b,arguments).then(function(){g.done.apply(g,arguments)})}),g}l.prototype.cancel=function(b){this._callbacks=[];this._errbacks=[];this._iscancelled=!0;this._cancelCallback&&this._cancelCallback(b)};l.prototype.then=function(b,d,h){var f;if(!this._iscancelled)return this._isdone?f=b.apply(h,this.result):
this._iserr&&d?f=d.apply(h,this.result):(this._callbacks.push(function(){return b.apply(h,arguments)}),d&&this._errbacks.push(function(){return d.apply(h,arguments)})),f};l.prototype.done=function(){this.result=arguments;this._isdone=!0;for(var b=0;b<this._callbacks.length;b++)this._callbacks[b].apply(null,arguments);this._callbacks=[];this._errbacks=[]};l.prototype.resolve=l.prototype.done;l.prototype.reject=function(){if(!this._iscancelled){this.result=arguments;this._iserr=!0;for(var b=0;b<this._errbacks.length;b++)this._errbacks[b].apply(null,
arguments);this._callbacks=[];this._errbacks=[]}};l.prototype.isRejected=function(){return this._iserr};l.prototype.isFulfilled=function(){return this._isdone||this._iserr};l.prototype.isResolved=function(){return this._isdone};l.prototype.isCancelled=function(){return this._iscancelled};var d={Promise:l,join:function(b){function d(b,d){return function(){d&&(c=!0);a+=1;e[b]=Array.prototype.slice.call(arguments);a===f&&(c?h.reject():h.done(e))}}for(var h=new l,f=b.length,a=0,e=[],c=!1,q=0;f>q;q++)b[q].then(d(q,
!1),d(q,!0));return 0===b.length&&h.done(),h},chain:h};"function"==typeof define&&define.amd?define([],function(){return d}):m.promise=d}(this)},"esri/views/3d/support/AsyncQuotaRoundRobinQueue":function(){define(["../../../core/arrayUtils","../webgl-engine/lib/Util"],function(m,l){return function(h,d,b,g,k){function f(){return"workers: "+q+", queues: "+c.map(function(a){return a.length})}var a=0,e={},c=[],q=[],t=[],r=[],u=0,v=0,x;for(x in g)c[a]=[],q[a]=0,r[a]={requests:0,size:0,duration:0,speed:0},
t[a]=g[x],e[x]=a++,v+=g[x];var y=c.length,a=0;this.setWorkerQuota=function(a){l.assert(m.equals(Object.keys(this.typeWorkerAllication),Object.keys(a)));this.typeWorkerAllication=a;v=0;for(var b in a)t[e[b]]=a[b],v+=a[b]};this.setWorkerFunc=function(a){h=a};this.push=function(a){var b=e[a.clientType];v>u?(q[b]++,u++,k&&console.log("queue start type "+b+", "+f()),h(a,z)):(c[b].push(a),k&&console.log("queue push type "+b+", "+f()))};this._getStatsForType=function(a){a=e[a];return{quota:t[a],workers:q[a],
queueSize:c[a].length,requestStats:r[a]}};this.removeTasks=function(a,b){for(var d=[],f=c[e[b]],g=0;g<f.length;g++){var h=f[g];-1<a.indexOf(h)||d.push(h)}c[e[b]]=d};this.workerCancelled=function(a){n(a);a._cancelledInQueue=!0};this.clear=function(){for(var a=0;a<c.length;a++)c[a]=[]};var n=function(b){var c=e[b.clientType];q[c]--;u--;r[c].requests++;r[c].size+=b.size||0;r[c].duration+=b.duration||0;r[c].speed=0<r[c].duration?r[c].size/r[c].duration:0;l.assert(0<=q[c]);b=a;c=!1;do q[b]<t[b]&&w(b)&&
(c=!0),b=(b+1)%y;while(!c&&b!=a);if(!c){do w(b)&&(c=!0),b=(b+1)%y;while(!c&&b!=a)}!c&&k&&console.log("queue sink, "+f());a=b},w=function(a){for(;0<c[a].length;){if(h(c[a].shift(),z))return k&&console.log("queue startqueued clientType "+a+", "+f()),q[a]++,u++,!0;k&&console.log("queue task cancelled, "+f())}return!1},z=function(a){a._cancelledInQueue||(d.apply(b,arguments),n(a))}}})},"esri/views/3d/support/PreallocArray":function(){define(["../../../core/declare","./HeapSort"],function(m,l){return m([],
{constructor:function(h,d){if(this.data=Array(h),this.length=0,d){for(var b=0;h>b;b++)this.data[b]=d(b);this._allocator=d;this._hasAllocator=!0}else this._allocator=this._nullAllocator,this._hasAllocator=!1},_nullAllocator:function(){return null},grow:function(h){for(;this.data.length<h;)this.data.push(this._allocator(this.data.length))},next:function(){return this._hasAllocator?(this.data.length===this.length&&this.grow(2*this.length),this.data[this.length++]):null},swap:function(h,d){var b=this.data[h];
this.data[h]=this.data[d];this.data[d]=b},push:function(h){this.data.length===this.length&&this.grow(2*this.length);this.data[this.length++]=h},pushArray:function(h){var d=this.length+h.length;d>=this.data.length&&this.grow(Math.max(2*this.length,d));for(d=0;d<h.length;d++)this.data[this.length++]=h[d]},pushEither:function(h){Array.isArray(h)?this.pushArray(h):this.push(h)},pop:function(){if(0===this.length)return null;var h=this.data[--this.length];return this._hasAllocator||(this.data[this.length]=
null),h},slice:function(h,d){return void 0===d&&(d=this.length),this.data.slice(h,d)},clear:function(){if(!this._hasAllocator)for(var h=0;h<this.length;h++)this.data[h]=null;this.length=0},peek:function(){return 0===this.length?null:this.data[this.length-1]},sort:function(h){return l.sort(this.data,0,this.length,h),this}})})},"esri/views/3d/support/HeapSort":function(){define([],function(){function m(h,d,b,g){for(var k=d,f=b>>>1,a=h[k-1];f>=d;){d=k<<1;b>d&&0>g(h[d-1],h[d])&&++d;var e=h[d-1];if(0>=
g(e,a))break;h[k-1]=e;k=d}h[k-1]=a}function l(h,d){return d>h?-1:h>d?1:0}return{sort:function(h,d,b,g){void 0===d&&(d=0);void 0===b&&(b=h.length);void 0===g&&(g=l);for(var k=b>>>1;k>d;k--)m(h,k,b,g);for(var f=d+1,k=b-1;k>d;k--)b=h[d],h[d]=h[k],h[k]=b,m(h,f,k,g);return h}}})},"esri/views/3d/support/DisplayQualityProfile":function(){define(["require","exports","../../../core/sniff"],function(m,l,h){var d={low:{sceneService:{"3dObject":{lodFactor:.2},point:{lodFactor:1},integratedMesh:{lodFactor:.6},
pointCloud:{lodFactor:.5},uncompressedTextureDownsamplingEnabled:!0},tiledSurface:{lodBias:-1,angledSplitBias:.5},antialiasingEnabled:!1,gpuMemoryLimit:200},high:{sceneService:{"3dObject":{lodFactor:1},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1},uncompressedTextureDownsamplingEnabled:!1},tiledSurface:{lodBias:0,angledSplitBias:1},antialiasingEnabled:!0,gpuMemoryLimit:500}};return function(){function b(){}return b.isValidProfile=function(b){return b in d},b.getDefaultProfile=
function(){return h("trident")||h("safari")||h("esri-mobile")?"low":"high"},b.apply=function(b,h){b=d[b];h.qualitySettings.sceneService["3dObject"].lodFactor=b.sceneService["3dObject"].lodFactor;h.qualitySettings.sceneService.point.lodFactor=b.sceneService.point.lodFactor;h.qualitySettings.sceneService.integratedMesh.lodFactor=b.sceneService.integratedMesh.lodFactor;h.qualitySettings.sceneService.pointCloud.lodFactor=b.sceneService.pointCloud.lodFactor;h.qualitySettings.sceneService.uncompressedTextureDownsamplingEnabled=
b.sceneService.uncompressedTextureDownsamplingEnabled;h.qualitySettings.tiledSurface.lodBias=b.tiledSurface.lodBias;h.qualitySettings.tiledSurface.angledSplitBias=b.tiledSurface.angledSplitBias;h.qualitySettings.antialiasingEnabled=b.antialiasingEnabled;h.qualitySettings.gpuMemoryLimit=b.gpuMemoryLimit},b}()})},"esri/views/3d/support/QualitySettings":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/typescript ../../../core/Accessor".split(" "),
function(m,l,h,d,b,g){var k=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return h(c,a),d([b.property({value:1})],c.prototype,"lodFactor",void 0),c=d([b.subclass()],c)}(g),f=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return h(c,a),c.prototype.getDefaults=function(){return{"3dObject":new k,point:new k,integratedMesh:new k,pointCloud:new k,uncompressedTextureDownsamplingEnabled:!1}},d([b.property()],c.prototype,"3dObject",void 0),d([b.property()],
c.prototype,"point",void 0),d([b.property()],c.prototype,"integratedMesh",void 0),d([b.property()],c.prototype,"pointCloud",void 0),d([b.property()],c.prototype,"uncompressedTextureDownsamplingEnabled",void 0),c=d([b.subclass()],c)}(g),a=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return h(c,a),d([b.property({value:0})],c.prototype,"lodBias",void 0),d([b.property({value:1})],c.prototype,"angledSplitBias",void 0),c=d([b.subclass()],c)}(g);return function(e){function c(){return null!==
e&&e.apply(this,arguments)||this}return h(c,e),c.prototype.getDefaults=function(){return{sceneService:new f,tiledSurface:new a,antialiasingEnabled:!0}},d([b.property()],c.prototype,"sceneService",void 0),d([b.property()],c.prototype,"tiledSurface",void 0),d([b.property()],c.prototype,"antialiasingEnabled",void 0),d([b.property()],c.prototype,"gpuMemoryLimit",void 0),c=d([b.subclass()],c)}(g)})},"esri/core/accessorSupport/typescript":function(){define(["../declare","../typescript","../JSONSupport",
"dojo/_base/lang"],function(m,l,h,d){function b(d,h){if(!d)return h;if(!h)return d;for(var f in h){var a=d[f],e=h[f];Array.isArray(e)&&Array.isArray(a)?d[f]=a.concat(e):"object"==typeof e&&"object"==typeof a?d[f]=b(a,e):d[f]=e}return d}return{subclass:function(g,k){return function(f){f=l.declareDefinition(f,g);a&&(f.instanceMembers.properties=b(a,f.instanceMembers.properties));var a=f.instanceMembers.properties;if(a)for(var e in a){var c=a[e];c&&!c.reader&&c.type&&(c.type===Date?c.reader=function(a){return null!=
a?new Date(a):null}:-1!==c.type._meta.bases.indexOf(h)&&(c.reader=function(a){return function(b){return a.fromJSON(b)}}(c.type)))}return d.mixin(m(f.bases,f.instanceMembers),f.classMembers)}},shared:l.shared,property:function(b){return function(d,f){var a=Object.getPrototypeOf(d),a=a&&a.properties;d.properties&&d.properties!==a||(d.properties={});d.properties=d.properties||{};d.properties[f]=b||{}}}}})},"esri/core/typescript":function(){define(["./declare","dojo/_base/lang"],function(m,l){var h={declareDefinition:function(d,
b){var g,h=[],f=Object.getPrototypeOf(d.prototype);if(f!==Object.prototype){var a=f.constructor;g=a.prototype;h.push(a)}b&&(h=h.concat(b));b={};for(var a=Object.getOwnPropertyNames(d.prototype),e=0;e<a.length;e++){var c=a[e];if("constructor"!==c){var l=c;"dojoConstructor"===c&&(l="constructor");g&&d.prototype[c]===g[c]||(b[l]=d.prototype[c])}}a=Object.getOwnPropertyNames(d);g=Object.getOwnPropertyNames(f.constructor);f={};for(e=0;e<a.length;e++)c=a[e],-1===g.indexOf(c)&&(f[c]=d[c]);return{bases:h,
instanceMembers:b,classMembers:f}},subclass:function(d){return function(b){b=h.declareDefinition(b,d);return l.mixin(m(b.bases,b.instanceMembers),b.classMembers)}},shared:function(d){return function(b,g){b[g]=d}}};return h})},"esri/views/3d/support/SharedSymbolResources":function(){define("require exports ./TextureCollection ./ResourceController ../../../core/watchUtils ../../../core/HandleRegistry ../webgl-engine/lib/screenSizePerspectiveUtils".split(" "),function(m,l,h,d,b,g,k){Object.defineProperty(l,
"__esModule",{value:!0});m=function(){function a(a){this.streamDataSupplier=this.textures=null;this.graphicsOwners=[];this.screenSizePerspectiveHandles=null;var b=d.ClientType.SYMBOLOGY;this.viewState=a.viewState;this.stage=a.stage;this.pointsOfInterest=a.pointsOfInterest;this.resourceController=a.resourceController;this.streamDataSupplier=this.resourceController.registerClient(this,b);this.textures=new h(this.streamDataSupplier,a.stage,{preMultiplyAlpha:!0,wrapClamp:!0});this.screenSizePerspectiveSettings=
k.getSettings(a.viewingMode);this.screenSizePerspectiveSettingsLabels=k.getLabelSettings(a.viewingMode)}return a.prototype.destroy=function(){this.resourceController.deregisterClient(this);this.streamDataSupplier=this.textures=null},a.prototype.addGraphicsOwner=function(a){var c=this;this.graphicsOwners.push(a);var e=null;return a.layerView&&(e=b.init(a.layerView,"layer.screenSizePerspectiveEnabled",function(){return c.updateScreenSizePerspectiveEnabled()})),{remove:function(){e&&(e.remove(),e=null,
c.updateScreenSizePerspectiveEnabled())}}},a.prototype.updateScreenSizePerspectiveEnabled=function(){var a=this,b=this.graphicsOwners.some(function(a){return a.layerView&&!0===a.layerView.get("layer.screenSizePerspectiveEnabled")});b&&!this.screenSizePerspectiveHandles?(this.screenSizePerspectiveHandles=new g,b=function(){return a.updateScreenSizePerspectiveSettings()},this.screenSizePerspectiveHandles.add([this.pointsOfInterest.centerOnSurfaceInfrequent.watch("distance",b,!0),this.pointsOfInterest.events.on("camera-parameters-changed",
b)]),this.updateScreenSizePerspectiveSettings()):!b&&this.screenSizePerspectiveHandles&&(this.screenSizePerspectiveHandles.destroy(),this.screenSizePerspectiveHandles=null)},a.prototype.updateScreenSizePerspectiveSettings=function(){f.distance=this.pointsOfInterest.centerOnSurfaceInfrequent.distance;f.fovY=this.viewState.camera.fovY;this.screenSizePerspectiveSettings.update(f);this.screenSizePerspectiveSettingsLabels.update(f);this.stage.setNeedsRender()},a}();l.SharedSymbolResources=m;var f={distance:0,
fovY:0};l["default"]=m})},"esri/views/3d/support/TextureCollection":function(){define("../../../core/declare ../../../core/urlUtils dojo/Deferred dojo/_base/lang ../webgl-engine/Stage ../webgl-engine/lib/Texture ../webgl-engine/lib/Util".split(" "),function(m,l,h,d,b,g,k){var f=k.assert;return m(null,{constructor:function(a,b,c){this._streamDataSupplier=a;this._stage=b;this._textureRecords={};this._loadedHandler=this._loadedHandler.bind(this);this._errorHandler=this._errorHandler.bind(this);this._textureOptions=
c||{}},acquire:function(a,e,c){var d;if(d=this._textureRecords[a])return d.referenceCount++,d.texture||d.clientDfd;if(e)return c=e(a),this._stage.add(b.ModelContentType.TEXTURE,c),d={texture:c,referenceCount:1},this._textureRecords[a]=d,c;d=new h;e=this._streamDataSupplier.request(a,"image");return this._textureRecords[a]={clientDfd:d,loaderDfd:e,texture:null,size:Math.ceil(c||0),referenceCount:1},e.then(this._loadedHandler,this._errorHandler),d.promise},release:function(a){var e=this._textureRecords[a];
e?(1>e.referenceCount&&console.warn("TextureCollection: reference count is \x3c 1 for "+a),e.referenceCount--,1>e.referenceCount&&(e.texture?(this._stage.remove(b.ModelContentType.TEXTURE,e.texture.getId()),e.texture=null):this._streamDataSupplier.cancelRequest(e.loaderDfd),delete this._textureRecords[a])):console.warn("TextureCollection: texture doesn't exist: "+a)},isInUse:function(a){a=this._textureRecords[a];return f(!a||0<a.referenceCount,"texture record with zero reference count"),!!a},_loadedHandler:function(a,
e,c){c=this._textureRecords[a];if(f(c&&!c.texture),l.isSVG(a)&&(c.size||0===e.width&&0===e.height)){a=e.width?e.height/e.width:1;var h=c.size||64;1<a?(e.width=Math.round(h/a),e.height=h):(e.width=h,e.height=Math.round(h*a))}a=d.mixin({width:e.width,height:e.height},this._textureOptions);e=new g(e,"symbol",a);this._stage.add(b.ModelContentType.TEXTURE,e);c.texture=e;c.clientDfd.resolve(e)},_errorHandler:function(a){a=this._textureRecords[a];f(a&&!a.texture);a.clientDfd.reject()}})})},"esri/views/3d/support/pointsOfInterest/PointsOfInterest":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/HandleRegistry ../../../../core/Accessor ../../../../geometry/Point ../../lib/glMatrix ../Evented ../PropertiesPool ./CenterOnSurface ./ContentGeometryUpdates ./disposeMembers ./SurfaceGeometryUpdates ./StableSurfaceCenter ../../webgl-engine/lib/Camera ../../webgl-engine/lib/Selector".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y){Object.defineProperty(l,"__esModule",{value:!0});m=function(k){function l(a){a=k.call(this,a)||this;return a.handles=new g,a.lastSeenCameraParameters=new x,a.surfaceAltitudeAtCenter=0,a.surfaceAltitudeAtCenterDirty=!0,a.surfaceAltitudeAtCenterWithContent=0,a.surfaceAltitudeAtCenterWithContentDirty=!0,a.propertiesPool=new c["default"]({pointOfView:f,renderPointOfView:Array},a),a.updateSurfaceAltitudeFrequentInterval=z,a.updateSurfaceAltitudeInfrequentInterval=
C,a.events=new e.Evented,a.renderPointOfView=[0,0,0],a}return h(l,k),l.prototype.initialize=function(){var a=this,b=this.view.state,c=this.view.basemapTerrain,e=this.view.renderCoordsHelper;this.surfaceSelector=new y(b.mode);b.isGlobal?this.surfaceSelector.enableBackfacesTerrain=!1:this.surfaceSelector.enableBackfacesTerrain=!0;this.surfaceSelector.enableInvisibleTerrain=!1;this.contentSelector=new y(b.mode);this.contentSelector.enableTerrain=!1;var d=this.estimateSurfaceAltitudeAtCenter.bind(this);
this._set("centerOnSurfaceInfrequent",new q["default"]({state:b,surface:c,renderCoordsHelper:e,estimateSurfaceAltitudeAtCenter:d,altitudeEstimationInterval:this.updateSurfaceAltitudeInfrequentInterval}));this._set("centerOnSurfaceFrequent",new q["default"]({state:b,surface:c,renderCoordsHelper:e,estimateSurfaceAltitudeAtCenter:d,altitudeEstimationInterval:this.updateSurfaceAltitudeFrequentInterval}));this._set("centerOnContent",new q["default"]({state:b,surface:c,renderCoordsHelper:e,estimateSurfaceAltitudeAtCenter:this.estimateSurfaceAltitudeAtCenterWithContent.bind(this),
altitudeEstimationInterval:this.updateSurfaceAltitudeFrequentInterval}));this._set("surfaceGeometryUpdates",new u["default"]({state:b,surface:c,renderCoordsHelper:e,centerOnSurfaceInstances:[this.centerOnSurfaceFrequent,this.centerOnContent,this.centerOnSurfaceInfrequent]}));this._set("contentGeometryUpdates",new t["default"]({contentLayerViews:this.view.allLayerViews,renderCoordsHelper:e}));this._set("surfaceOrigin",new v["default"]({view:this.view}));this.handles.add(b.watch("camera",function(b){return a.cameraChanged(b)},
!0));this.handles.add(this.surfaceGeometryUpdates.events.on("request-update",function(){return a.updateCenterPointsOfInterest()}));this.handles.add(c.watch("extent",function(){return a.updateCenterPointsOfInterest()}));this.handles.add(this.contentGeometryUpdates.events.on("request-update",function(){return a.updateCenterOnContent()}));this.cameraChanged(this.view.state.camera);this.forceUpdate()},l.prototype.destroy=function(){r["default"](this,"handles","centerOnSurfaceInfrequent","centerOnSurfaceFrequent",
"centerOnContent","surfaceOrigin","propertiesPool")},Object.defineProperty(l.prototype,"pointOfView",{get:function(){var a=this.propertiesPool.get("pointOfView");return this.view.renderCoordsHelper.fromRenderCoords(this.renderPointOfView,a,this.view.state.spatialReference),a},enumerable:!0,configurable:!0}),l.prototype.forceUpdate=function(){this.surfaceGeometryUpdates.forceUpdate();this.centerOnSurfaceInfrequent.forceUpdate();this.centerOnSurfaceFrequent.forceUpdate();this.centerOnContent.forceUpdate()},
l.prototype.hasPendingUpdates=function(){return this.surfaceGeometryUpdates.hasPendingUpdates()||this.centerOnContent.hasPendingUpdates()||this.centerOnSurfaceInfrequent.hasPendingUpdates()||this.centerOnSurfaceFrequent.hasPendingUpdates()},l.prototype.estimateSurfaceAltitudeAtCenterWithContent=function(){if(!this.surfaceAltitudeAtCenterWithContentDirty)return this.surfaceAltitudeAtCenterWithContent;this.surfaceAltitudeAtCenterWithContentDirty=!1;var a=this.view.state.camera;return this.view._stage.pickRay(a.eye,
a.center,null,null,null,!1,this.contentSelector),this.contentSelector.minResult.getIntersectionPoint(w)?this.surfaceAltitudeAtCenterWithContent=this.view.renderCoordsHelper.getAltitude(w):this.surfaceAltitudeAtCenterWithContent=this.estimateSurfaceAltitudeAtCenter(),this.surfaceAltitudeAtCenterWithContent},l.prototype.estimateSurfaceAltitudeAtCenter=function(){if(!this.view.basemapTerrain)return 0;if(!this.surfaceAltitudeAtCenterDirty)return this.surfaceAltitudeAtCenter;this.surfaceAltitudeAtCenterDirty=
!1;var a=this.view.state.camera;return this.surfaceSelector.init(null,a.eye,a.center,null,a,null,!1),this.view.basemapTerrain.intersect(this.surfaceSelector,a.eye,a.center),this.surfaceSelector.minResult.getIntersectionPoint(w)&&(this.surfaceAltitudeAtCenter=this.view.renderCoordsHelper.getAltitude(w)),this.surfaceAltitudeAtCenter},l.prototype.cameraChanged=function(b){this.updateCenterPointsOfInterest(b);this.cameraParametersChanged(this.lastSeenCameraParameters,b)&&(this.lastSeenCameraParameters.copyFrom(b),
n.camera=b,this.events.emit("camera-parameters-changed",n));b=b.eye;this.renderPointOfView[0]===b[0]&&this.renderPointOfView[1]===b[1]&&this.renderPointOfView[2]===b[2]||this._set("renderPointOfView",a.vec3d.set(b,this.propertiesPool.get("renderPointOfView")))},l.prototype.updateCenterPointsOfInterest=function(a){void 0===a&&(a=this.view.state.camera);this.surfaceAltitudeAtCenterWithContentDirty=this.surfaceAltitudeAtCenterDirty=!0;this.centerOnSurfaceFrequent.update(a);this.centerOnSurfaceInfrequent.update(a);
this.centerOnContent.update(a)},l.prototype.updateCenterOnContent=function(){this.surfaceAltitudeAtCenterWithContentDirty=!0;this.centerOnContent.update(this.view.state.camera)},l.prototype.cameraParametersChanged=function(a,b){return a.fov!==b.fov?!0:a.fullViewport[0]!==b.fullViewport[0]||a.fullViewport[1]!==b.fullViewport[1]||a.fullViewport[2]!==b.fullViewport[2]||a.fullViewport[3]!==b.fullViewport[3]?!0:a.padding[0]!==b.padding[0]||a.padding[1]!==b.padding[1]||a.padding[2]!==b.padding[2]||a.padding[3]!==
b.padding[3]?!0:!1},d([b.property({constructOnly:!0})],l.prototype,"updateSurfaceAltitudeFrequentInterval",void 0),d([b.property({constructOnly:!0})],l.prototype,"updateSurfaceAltitudeInfrequentInterval",void 0),d([b.property({readOnly:!0})],l.prototype,"centerOnContent",void 0),d([b.property({readOnly:!0})],l.prototype,"centerOnSurfaceFrequent",void 0),d([b.property({readOnly:!0})],l.prototype,"centerOnSurfaceInfrequent",void 0),d([b.property({readOnly:!0})],l.prototype,"surfaceOrigin",void 0),d([b.property({readOnly:!0})],
l.prototype,"contentGeometryUpdates",void 0),d([b.property({readOnly:!0})],l.prototype,"events",void 0),d([b.property({readOnly:!0,dependsOn:["renderPointOfView"]})],l.prototype,"pointOfView",null),d([b.property({readOnly:!0})],l.prototype,"renderPointOfView",void 0),d([b.property({readOnly:!0})],l.prototype,"surfaceGeometryUpdates",void 0),d([b.property({constructOnly:!0})],l.prototype,"view",void 0),l=d([b.subclass("esri.views.3d.support.PointsOfInterest")],l)}(b.declared(k));l.PointsOfInterest=
m;var n={camera:null},w=a.vec3d.create(),z=200,C=3E3;l["default"]=m})},"esri/views/3d/support/pointsOfInterest/CenterOnSurface":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/throttle ../../../../geometry/Point ../../lib/glMatrix ../earthUtils ../PropertiesPool ../mathUtils ../debugFlags ./PointOfInterest".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t){Object.defineProperty(l,
"__esModule",{value:!0});m=function(l){function m(a){a=l.call(this,a)||this;return a.propertiesPool=new e["default"]({location:k,renderLocation:Array},a),a.currentSurfaceAltitude=0,a.latestSurfaceAltitude=0,a.distance=0,a.renderLocation=[0,0,0],a}return h(m,l),t=m,m.prototype.initialize=function(){this.measureSurfaceAltitudeThrottle=g.throttle(this.measureSurfaceAltitude,this.altitudeEstimationInterval,this);this.handles.add(this.measureSurfaceAltitudeThrottle);this.measureSurfaceAltitude()},Object.defineProperty(m.prototype,
"location",{get:function(){var a=this.propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,a,this.state.spatialReference),a},enumerable:!0,configurable:!0}),m.prototype.update=function(a){this.measureSurfaceAltitudeThrottle();this.updateCenterOnSurface()},m.prototype.forceUpdate=function(){this.measureSurfaceAltitudeThrottle.forceUpdate();this.updateCenterOnSurface()},m.prototype.hasPendingUpdates=function(){return this.measureSurfaceAltitudeThrottle.hasPendingUpdates()},
Object.defineProperty(m.prototype,"estimatedSurfaceAltitude",{get:function(){return this.latestSurfaceAltitude},enumerable:!0,configurable:!0}),m.prototype.measureSurfaceAltitude=function(){this.latestSurfaceAltitude=this.estimateSurfaceAltitudeAtCenter();this.updateCenterOnSurface()},m.prototype.updateCenterOnSurface=function(){var a=r,b=this.calculateSurfaceIntersection(this.currentSurfaceAltitude,a),c=this.currentSurfaceAltitude!==this.latestSurfaceAltitude;!b&&c&&(b=this.calculateSurfaceIntersection(this.latestSurfaceAltitude,
a),b&&(this.currentSurfaceAltitude=this.latestSurfaceAltitude));c=u;(b&&this.latestSurfaceAltitudeChangesDistanceSignificantly(a,c)&&(f.vec3d.set(c,a),this.currentSurfaceAltitude=this.latestSurfaceAltitude),b)?(b=f.vec3d.dist(this.state.camera.eye,a),b!==this._get("distance")&&this._set("distance",b)):(b=this.state.camera,f.vec3d.add(f.vec3d.scale(b.viewForward,this._get("distance"),a),b.eye));b=this._get("renderLocation");b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]||this._set("renderLocation",f.vec3d.set(a,
this.propertiesPool.get("renderLocation")))},m.prototype.calculateSurfaceIntersection=function(b,e){var d=this.state.camera;if(!this.renderCoordsHelper.intersectManifold(d.eye,d.viewForward,b,e))return!1;if(this.state.isGlobal){b=a.earthRadius+b;var g=f.vec3d.length2(d.eye),h=b*b>g,k=f.vec3d.dist(d.eye,e);if(h&&k>a.earthRadius/4)return f.vec3d.add(f.vec3d.scale(d.viewForward,b-Math.sqrt(g),e),d.eye),!0}else(d=this.surface.ready&&this.surface.extent)&&(e[0]=c.clamp(e[0],d[0],d[2]),e[1]=c.clamp(e[1],
d[1],d[3]));return!0},m.prototype.latestSurfaceAltitudeChangesDistanceSignificantly=function(a,b){if(this.latestSurfaceAltitude===this.currentSurfaceAltitude||null==a)return!1;if(this.calculateSurfaceIntersection(this.latestSurfaceAltitude,b)){var c=this.state.camera.eye;a=f.vec3d.dist(c,a);b=f.vec3d.dist(c,b);if(q.TESTS_DISABLE_UPDATE_THROTTLE_THRESHOLDS||Math.abs(b-a)/a>t.RELATIVE_ALTITUDE_CHANGE_THRESHOLD)return!0}return!1},m.RELATIVE_ALTITUDE_CHANGE_THRESHOLD=.05,d([b.property({constructOnly:!0})],
m.prototype,"altitudeEstimationInterval",void 0),d([b.property({readOnly:!0})],m.prototype,"distance",void 0),d([b.property({constructOnly:!0})],m.prototype,"estimateSurfaceAltitudeAtCenter",void 0),d([b.property({readOnly:!0,dependsOn:["renderLocation"]})],m.prototype,"location",null),d([b.property({readOnly:!0})],m.prototype,"renderLocation",void 0),m=t=d([b.subclass("esri.views.3d.support.CenterOnSurface")],m);var t}(b.declared(t.PointOfInterest));l.CenterOnSurface=m;var r=f.vec3d.create(),u=f.vec3d.create();
l["default"]=m})},"esri/core/throttle":function(){define(["require","exports"],function(m,l){function h(d,b,g,h){var f=null,a=1E3;"number"==typeof b?(a=b,h=g):(f=b,a=g);var e,c=0,k=function(){c=0;d.apply(h,e)};b=function(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];f&&f.apply(h,b);e=b;a?c||(c=setTimeout(k,a)):k()};return b.remove=function(){c&&(clearTimeout(c),c=0)},b.forceUpdate=function(){c&&(clearTimeout(c),k())},b.hasPendingUpdates=function(){return!!c},b}Object.defineProperty(l,
"__esModule",{value:!0});l.throttle=h;l["default"]=h})},"esri/views/3d/support/pointsOfInterest/PointOfInterest":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/HandleRegistry ../../../../core/Accessor ./disposeMembers".split(" "),function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});m=function(a){function e(b){b=a.call(this)||this;return b.handles=
new g,b}return h(e,a),e.prototype.destroy=function(){f["default"](this,"handles")},d([b.property({constructOnly:!0})],e.prototype,"renderCoordsHelper",void 0),d([b.property({constructOnly:!0})],e.prototype,"surface",void 0),d([b.property({constructOnly:!0})],e.prototype,"state",void 0),e=d([b.subclass("esri.views.3d.support.PointOfInterest")],e)}(b.declared(k));l.PointOfInterest=m;l["default"]=m})},"esri/views/3d/support/pointsOfInterest/disposeMembers":function(){define(["require","exports","../../../../core/Accessor"],
function(m,l,h){function d(b){for(var d=[],k=1;k<arguments.length;k++)d[k-1]=arguments[k];if(b instanceof h&&b.destroyed)try{throw Error("instance is already destroyed");}catch(e){console.warn(e.stack)}else for(k=0;k<d.length;k++){var f=d[k];if(!(f in b))throw Error("Property '"+f+"' does not exist and cannot be disposed");var a=b[f];a&&("function"==typeof a.destroy?a.destroy():"function"==typeof a.dispose?a.dispose():"function"==typeof a.remove&&a.remove());b instanceof h&&f in b.__accessor__.metadatas?
b._set(f,null):b[f]=null}}Object.defineProperty(l,"__esModule",{value:!0});l.disposeMembers=d;l["default"]=d})},"esri/views/3d/support/pointsOfInterest/ContentGeometryUpdates":function(){define(["require","exports","../../../../core/HandleRegistry","../Evented"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function g(b){this.handles=new h;this.events=new d.Evented;this.contentLayerViews=b.contentLayerViews;this.handles.add(this.contentLayerViews.on("change",this.layerViewsChanged.bind(this)));
this.layerViewsChanged({added:this.contentLayerViews.toArray(),removed:[],moved:[],target:this.contentLayerViews})}return g.prototype.destroy=function(){this.handles&&(this.handles.destroy(),this.handles=null)},g.prototype.layerViewsChanged=function(b){var d=this;b.added.forEach(function(a){"esri.views.3d.layers.SceneLayerView3D"===a.declaredClass&&d.handles.add(a.on("visible-geometry-changed",d.contentChanged.bind(d)),a.uid)});b.removed.forEach(function(a){return d.handles.remove(a.uid)})},g.prototype.contentChanged=
function(){this.events.emit("request-update",b)},g}();l.ContentGeometryUpdates=m;var b={};l["default"]=m})},"esri/views/3d/support/pointsOfInterest/SurfaceGeometryUpdates":function(){define("require exports ../../../../core/HandleRegistry ../../../../core/Scheduler ../../lib/glMatrix ../Evented ../aaBoundingRect ../debugFlags".split(" "),function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function b(a){var b=this;this.handles=new h;this.tileGeometryUpdateExtent=
k.create(k.NEGATIVE_INFINITY);this.tileGeometryUpdateSpatialReference=null;this.hasPendingTileGeometryChanges=!0;this.events=new g.Evented;this.centerOnSurfaceInstances=a.centerOnSurfaceInstances;this.renderCoordsHelper=a.renderCoordsHelper;this.state=a.state;this.handles.add(a.surface.on("elevation-change",function(a){return b.tileGeometryChangeHandler(a)}))}return b.prototype.destroy=function(){this.handles&&(this.handles.destroy(),this.handles=null)},b.prototype.forceUpdate=function(){this.handles.has("tile-geometry-update")&&
this.updateCenterOnGeometryUpdate();this.hasPendingTileGeometryChanges&&(this.events.emit("request-update",a),this.hasPendingTileGeometryChanges=!1)},b.prototype.hasPendingUpdates=function(){return this.handles.has("tile-geometry-update")},b.prototype.tileGeometryChangeHandler=function(a){var b=this;this.tileGeometryUpdateSpatialReference=a.spatialReference;k.expand(this.tileGeometryUpdateExtent,a.tile.extent);this.handles.has("tile-geometry-update")||this.handles.add(d.schedule(function(){return b.updateCenterOnGeometryUpdate()}),
"tile-geometry-update")},b.prototype.updateCenterOnGeometryUpdate=function(){this.handles.remove("tile-geometry-update");this.centerIntersectsExtent(this.tileGeometryUpdateExtent,this.tileGeometryUpdateSpatialReference)&&(f.DISABLE_POI_UPDATE_ON_SURFACE_GEOMETRY_CHANGES?this.hasPendingTileGeometryChanges=!0:this.events.emit("request-update",a));k.set(this.tileGeometryUpdateExtent,k.NEGATIVE_INFINITY)},b.prototype.furthestCenterOnSurface=function(){for(var a=this.centerOnSurfaceInstances[0],b=1;b<
this.centerOnSurfaceInstances.length;b++){var c=this.centerOnSurfaceInstances[b];c.distance>a.distance&&(a=c)}return a},b.prototype.centerIntersectsExtent=function(a,b){var d=this.state.camera.eye,f=q,g=this.furthestCenterOnSurface();return this.renderCoordsHelper.fromRenderCoords(d,e,b),this.renderCoordsHelper.fromRenderCoords(g.renderLocation,c,b),e[0]<c[0]?(f[0]=e[0],f[2]=c[0]):(f[0]=c[0],f[2]=e[0]),e[1]<c[1]?(f[1]=e[1],f[3]=c[1]):(f[1]=c[1],f[3]=e[1]),k.intersects(f,a)},b}();l.SurfaceGeometryUpdates=
m;var a={},e=b.vec3d.create(),c=b.vec3d.create(),q=k.create(k.NEGATIVE_INFINITY);l["default"]=m})},"esri/views/3d/support/pointsOfInterest/StableSurfaceCenter":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/Accessor ../../../../core/HandleRegistry ../../../../core/watchUtils ../../../../core/accessorSupport/decorators ../../../../geometry/Point ../aaBoundingRect".split(" "),function(m,l,h,d,b,g,k,f,a,e){Object.defineProperty(l,
"__esModule",{value:!0});m=function(b){function c(a){a=b.call(this,a)||this;return a.location=null,a._updatePromise=null,a._handles=new g,a}return h(c,b),Object.defineProperty(c.prototype,"renderLocation",{get:function(){if(!this.location)return null;var a=[0,0,0];return this.view.renderCoordsHelper.toRenderCoords(this.location,a),a},enumerable:!0,configurable:!0}),c.prototype.initialize=function(){var a=this;this.view.state.isLocal&&(this._handles.add([this.watch("surfaceView.extent",function(){return a._update()}),
k.on(this,"surface.layers","change",function(){return a._update()})]),this._update())},c.prototype.destroy=function(){this._handles.destroy()},c.prototype._update=function(){var b=this;if(this._updatePromise&&(this._updatePromise.cancel("cancel"),this._updatePromise=null),!this.surfaceView||!this.surfaceView.extent)return void this._set("location",null);var c=e.center(this.surfaceView.extent),c=new a({x:c[0],y:c[1],z:0,spatialReference:this.surfaceView.spatialReference});this.surface&&0<this.surface.layers.length?
(this._set("location",null),this._updatePromise=this.surface.queryElevation(c,{noDataValue:0}).then(function(a){b._updatePromise=null;b._set("location",a.geometry)}).otherwise(function(a){"cancel"!==a&&console.error("StableSurfaceCenter failed to update: ",a)})):this._set("location",c)},d([f.property({constructOnly:!0})],c.prototype,"view",void 0),d([f.property({readOnly:!0,aliasOf:"view.map.ground"})],c.prototype,"surface",void 0),d([f.property({readOnly:!0,aliasOf:"view.basemapTerrain"})],c.prototype,
"surfaceView",void 0),d([f.property({readOnly:!0})],c.prototype,"location",void 0),d([f.property({readOnly:!0,dependsOn:["location"]})],c.prototype,"renderLocation",null),c=d([f.subclass("esri.views.3d.terrain.StableSurfaceCenter")],c)}(f.declared(b));l.StableSurfaceCenter=m;l["default"]=m})},"esri/views/3d/terrain/TerrainSurface":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/arrayUtils ../../../core/CollectionFlattener ../../../core/ObjectPool ../../../core/Logger ../../../core/watchUtils ../../../core/HandleRegistry ../../../geometry/Point ../lib/glMatrix ../support/aaBoundingRect ../support/Evented ../support/mathUtils ../support/PreallocArray ../support/projectionUtils ../support/PromiseLightweight ../support/ResourceController ./OverlayManager ./PlanarTile ./SphericalTile ./SurfaceExtentHelper ./SurfaceTilingSchemeLogic ./TerrainConst ./TerrainRenderer ./terrainUtils ./TileGeometryFactory ./TilemapOnlyTile ./tileUtils ./tileUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P,Q,T,O,S){function H(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}function Y(a){return a&&("cancel"===a||"cancel"===a.dojoType)}function W(a,b){var c=!1;b=b||a;var e=0;for(a=a.children;e<a.length;e++){var d=a[e];if(d){for(var f in d.layerInfo)for(var g in d.layerInfo[f]){var h=d.layerInfo[f][g].upsampleFromTile;if(h&&h.tile===b)return!0}c=c||W(d,b)}}return c}var E=r.vec3d,p=r.vec4d,A=r.mat4d,K=P.weakAssert,U=e.getLogger("esri.views.3d.terrain.TerrainSurface");
m=function(e){function g(){var b=e.call(this)||this;b.defaultTileBackground=M.DEFAULT_TILE_BACKGROUND;b.hideSkirtsDistanceFromExtentMargin=V;b.hideSkirtsMinimumCameraTilt=X;b._clippingExtent=null;b._dataExtent=null;b._elevationBounds=[0,0];b._rootExtent=[0,0,0,0];b._iteratorPool=new a(S.IteratorPreorder);b._postorderIterator=new S.IteratorPostorder;b.visible=!1;b.suspended=!1;b._pendingUpdates=!1;b._lvPendingUpdates=!1;b._updateNextFrame=0;b._vectorTileLayerRequests=0;b._curOverlayOpacity=1;b._curEyePos=
E.create();b._curSplitLimits=[0,0,0,0,0,0];b._curFrustumPlanes=Array(6);b._viewProjectionMatrix=A.identity();b.tilemapStats={tilemapRequestsSent:0,tilemapRequestsPending:0,tilemapRequestErrors:0,fullTilemaps:0,emptyTilemaps:0,tilesRequested:0,tileRequestsSent:0,tileRequestErrors:0,tilesNotPresent:0};b._layerViews=[[],[]];b._layerIndexByLayerViewId=[{},{}];b._basemapLayerViewHandles={};b._handles=new q;b._frameUpdateLowerPrio=new y(500);b._topLevelTilemapOnlyTiles=Array(M.TILEMAP_SIZE_EXP+1);b.loaded=
!1;b.maxTextureScale=1.2;b.rootTiles=null;for(var c=0;c<b._topLevelTilemapOnlyTiles.length;c++)b._topLevelTilemapOnlyTiles[c]=new T([c-M.TILEMAP_SIZE_EXP,0,0]);for(c=0;6>c;c++)b._curFrustumPlanes[c]=p.create();return b}return h(g,e),g.prototype.normalizeCtorArgs=function(a,b){return this._view=a,this._stage=a._stage,this._set("manifold",b),{}},g.prototype.initialize=function(){var a=this;this.tilePool="planar"===this.manifold?B.Pool:F.Pool;this._renderer=new R(this.manifold,null,this._view.pointsOfInterest);
this._renderer.loaded=this._setLoaded.bind(this);this._renderer.updateTileBackground(this.tileBackground);this._renderer.install(this._view._stage);this._set("overlayManager",new C({terrainSurface:this,view:this._view}));this._handles.add(this.watch("overlayManager.hasHighlights",this._handleHasHighlights.bind(this)),"overlayManager");var b={layers:this._view.map.allLayers,layerViews:this._view.allLayerViews,spatialReference:this._view.spatialReference};this.extentHelper="spherical"===this.manifold?
new G.SurfaceExtentHelperGlobal(b):new G.SurfaceExtentHelperLocal(b);this._handles.add(c.init(this.extentHelper,"stencilEnabledExtents",function(b){a._renderer.setStencilEnabledLayerExtents(b)}),"extentHelper");b=this._view.defaultsFromMap?new f({root:this._view.map,rootCollectionNames:this._view.defaultsFromMap.mapCollectionPaths,getChildrenFunction:function(a){return a.layers}}):this._view.map.allLayers;b=new N({layers:b,extentHelper:this.extentHelper,manifold:this.manifold,viewSpatialReference:this._view.spatialReference});
this._set("tilingSchemeLogic",b);this._handles.add([this.tilingSchemeLogic.watch("tilingScheme",this._updateTilingSchemeAndExtent.bind(this),!0),this.tilingSchemeLogic.watch("extent",this._updateTilingSchemeAndExtent.bind(this),!0)],"tilingSchemeLogic");this._updateTilingSchemeAndExtent();this._streamDataSupplier=this._view.resourceController.registerClient(this,z.ClientType.TERRAIN);b={needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate};this._view.resourceController.registerFrameWorker(this._frameUpdate.bind(this));
this._view.resourceController.registerIdleFrameWorker(this,b);this._viewChangeUpdate=this._viewChangeUpdate.bind(this);this._handles.add([this._view.on("resize",this._viewChangeUpdate),this._view.watch("state.camera",this._viewChangeUpdate,!0),this._view.watch("qualitySettings.tiledSurface.lodBias",this._viewChangeUpdate),this._view.watch("clippingArea",this._clippingChanged.bind(this))],"view");this._handles.add(this._view.allLayerViews.on("change",this._handleLayerViewChanges.bind(this)),"allLayerViews");
this._handleLayerViewChanges({added:this._view.allLayerViews.toArray(),removed:[],moved:[],target:this._view.allLayerViews});this._updateClippingExtent();this.notifyChange("extent")},g.prototype.destroy=function(){this._handles.destroy();this._removeAllTiles();this.tilingSchemeLogic.destroy();this._set("tilingSchemeLogic",null);this.extentHelper.destroy();this.extentHelper=null;for(var a in this._basemapLayerViewHandles)this._unregisterTiledLayerView(a);this._view.resourceController.deregisterFrameWorker();
this._view.resourceController.deregisterIdleFrameWorker(this);this._view.resourceController.deregisterClient(this);this.overlayManager&&(this.overlayManager.destroy(),this._set("overlayManager",null));this._renderer.destroy(this._stage);this._streamDataSupplier=this._stage=this._view=this._renderer=null},Object.defineProperty(g.prototype,"cullBackFaces",{set:function(a){this._renderer.setCullBackFaces(a);this._set("cullBackFaces",a)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,
"extent",{get:function(){return this._clippingExtent||this._rootExtent},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"frontMostTransparent",{set:function(a){this._renderer.setFrontMostTransparent(a);this._set("frontMostTransparent",a)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"opacity",{set:function(a){this._renderer.setOpacity(a);this._set("opacity",a)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"ready",{get:function(){return!!this.rootTiles},
enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"renderOrder",{set:function(a){this._renderer.setRenderOrder(a);this._set("renderOrder",a)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"skirts",{set:function(a){this._renderer.setDrawSkirts(a);this._set("skirts",a)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"tileBackground",{set:function(a){a!==this.tileBackground&&this._renderer.updateTileBackground(a);this._set("tileBackground",a)},enumerable:!0,
configurable:!0}),Object.defineProperty(g.prototype,"velvetOverground",{set:function(a){a!==this.velvetOverground&&this._renderer.setVelvetOverground(a);this._set("velvetOverground",a)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"wireframe",{set:function(a){this._renderer.setWireframe(a);this._set("wireframe",a);this._view._stage.setRenderParams({earlyOcclusionPixelDraw:a})},enumerable:!0,configurable:!0}),g.prototype.setVisibility=function(a){a!==this.visible&&(this.visible=
a,this._renderer.setVisibility(a),this.setUpdatesDisabled(!a),a&&this._viewChangeUpdate())},g.prototype.isVisible=function(){return this.visible&&this.ready},g.prototype.isSeeThrough=function(){return this._renderer.isTransparent()},g.prototype.setUpdatesDisabled=function(a){(this.suspended=a)||this._viewChangeUpdate()},g.prototype.intersect=function(a,b,c){this._renderer.intersect(a,b,c)},g.prototype.getElevation=function(a){if(!this.ready)return null;var b=this.rootTiles;if(0===b[0].layerInfo[M.LayerClass.ELEVATION].length)return null;
if(a instanceof t){if(!n.pointToVector(a,ca,this.tilingScheme.spatialReference))return U.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null;a=ca}for(var c,e=0;e<b.length;e++){var d=b[e];if(O.isPosWithinTile(d,a)){for(;d&&!d.renderData;)b=0,a[0]>.5*(d.extent[0]+d.extent[2])&&(b+=1),a[1]<.5*(d.extent[1]+d.extent[3])&&(b+=2),d=d.children[b];c=(b=d.renderData)&&b.geometryState?b.geometryState.samplerData:null;break}}return c?Q.elevationSampler(a[0],
a[1],c):null},g.prototype.getElevationBounds=function(){return this._elevationBounds},g.prototype.getScale=function(a){if(this.tilingScheme){if(!n.pointToVector(a,ca,this.spatialReference))return U.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null;if(this.rootTiles)for(var b=0;b<this.rootTiles.length;b++)if(a=this.rootTiles[b],O.isPosWithinTile(a,ca)){for(;a.children[0];)b=0,ca[0]>a.children[0].extent[2]&&(b+=1),ca[1]<a.children[0].extent[1]&&
(b+=2),a=a.children[b];return this._getLodBiasCorrectedScale(a.lij[0])}}return 1E100},g.prototype.queryVisibleScaleRange=function(a,b,c,e){b=b?this.tilingScheme.levelAtScale(b):0;c=c?this.tilingScheme.levelAtScale(c):1/0;var d=this._getLodBias();this._renderer.queryVisibleLevelRange(a,b+d,c+d,e)},g.prototype._setLoaded=function(){this.loaded||this._set("loaded",!0)},g.prototype._updateTilingSchemeAndExtent=function(){var a=this.tilingSchemeLogic.extent,b=this.tilingSchemeLogic.tilingScheme,c=!1;a&&
!u.equals(a,this._dataExtent)&&(c=!0,this._dataExtent?u.set(this._dataExtent,a):this._dataExtent=u.create(a));b!==this.tilingScheme&&(K(!!b,"tiling scheme cannot be reset to undefined"),c=!0,this.tilingScheme&&this._removeAllTiles(),this._set("tilingScheme",b),this._updateClippingExtent(),b&&(this._updateTiledLayers(),this._renderer.setTileSize(b.pixelSize[0]),this.overlayManager.setSpatialReference(b.spatialReference,"spherical"===this.manifold)));c&&this._updateRootTiles()},g.prototype._acquireTile=
function(a,b,c,e){var d=this.tilePool.acquire();return ea[0]=a,ea[1]=b,ea[2]=c,d.init(ea,e,this,this.tilingScheme),d},g.prototype._releaseTile=function(a){a.dispose();a.parent=null;a.parentSurface=null;this.tilePool.release(a)},g.prototype._updateRootTiles=function(){var a=this,b=this._clippingExtent||this._dataExtent,c=this.tilingScheme;if(b&&c){var e=ca,d=c.rootTilesInExtent(b,e,1/0);if(this.rootTiles){if(d.length>ba)return void U.warn(M.TOO_MANY_ROOT_TILES_AFTER_CHANGE_ERROR);var b=this.rootTiles.map(function(a){return a.lij}),
f=k.difference(b,d,H);if(0<f.removed.length||0<f.added.length){var g=this.rootTiles.filter(function(b){return-1<k.findIndex(f.removed,H.bind(null,b.lij))?(a._purgeChildTiles(b),a._purgeTile(b),!1):!0});f.added.forEach(function(b){b=a._acquireTile(0,b[1],b[2],null);g.push(b);a._loadTile(b)});this._set("rootTiles",g);this._renderer.setRootTiles(this.rootTiles)}}else d.length>ba&&(U.warn(M.TOO_MANY_ROOT_TILES_FOR_LAYER_ERROR),d=c.rootTilesInExtent(b,e,ba)),this._set("rootTiles",d.map(function(b){b=a._acquireTile(0,
b[1],b[2],null);return a._loadTile(b),b})),this._renderer.setRootTiles(this.rootTiles);k.equals(e,this._rootExtent)||(this._rootExtent=p.create(e),this._hasFixedExtent()||this.notifyChange("extent"));this.setVisibility(!0);this._viewChangeUpdate();this.overlayManager.setOverlayDirty();this.notifyChange("ready")}},g.prototype._viewChangeUpdate=function(){this._stage&&!this.suspended&&this.tilingScheme&&this.visible&&(this._updateViewDependentParameters(),this._updateOverlayOpacity(this._curEyePos),
this._updateTiles(this.rootTiles))},g.prototype._updateTiles=function(a){var b=this._iteratorPool.acquire();b.reset(a);var c,e,d=this._curSplitLimits,f=this._curFrustumPlanes,g=this._curEyePos;for(O.hasVisibleSiblings(a)?(c=this._elevationBounds[0],e=this._elevationBounds[1]):(c=1/0,e=-(1/0));!b.done;){a=b.next();a.updateClippingStatus(this._clippingExtent);var h=!0;if(a.updateVisibility(f,g)){a.updateScreenDepth(this._viewProjectionMatrix);a.renderData&&(c=Math.min(a.elevationBounds[0],c),e=Math.max(a.elevationBounds[1],
e));var k=a.shouldSplit(d,g);k===ha.SPLIT?(a.pendingUpdates&=~ha.MERGE,a.renderData?(h=!1,a.pendingUpdates|=ha.SPLIT,b.skip()):h=!1):(a.pendingUpdates&=~ha.SPLIT,k===ha.VSPLITMERGE&&a.updateAgents(M.LayerClass.ELEVATION),b.skip())}else b.skip();if(h&&!a.renderData){a.pendingUpdates|=ha.MERGE;a.pendingUpdates&=~ha.SPLIT;h=this._iteratorPool.acquire();for(h.reset(a);!h.done;)k=h.next(),k.updateVisibility(f,g),k.visible&&k.updateScreenDepth(this._viewProjectionMatrix);this._iteratorPool.release(h)}0!==
a.pendingUpdates&&(this._pendingUpdates=!0)}this._iteratorPool.release(b);isFinite(c)&&isFinite(e)&&(this._elevationBounds[0]!==c||this._elevationBounds[1]!==e)&&(this._elevationBounds[0]=c,this._elevationBounds[1]=e,this.emit("elevation-bounds-change",null))},g.prototype._updateViewDependentParameters=function(){var a=this._view.state.camera,b=Math.tan(.5*a.fovX),c=Math.tan(.5*a.fovY),e=this.tilingScheme.pixelSize,d=Math.pow(2,-this._getLodBias());this._curSplitLimits[0]=b;this._curSplitLimits[1]=
e[0]/a.width*this.maxTextureScale*d;this._curSplitLimits[2]=c;this._curSplitLimits[3]=e[1]/a.height*this.maxTextureScale*d;this._curSplitLimits[4]=this.tilingScheme.getMaxLod();this._curSplitLimits[5]=this._view.qualitySettings.tiledSurface.angledSplitBias;a.copyFrustumPlanes(this._curFrustumPlanes);A.multiply(a.projectionMatrix,a.viewMatrix,this._viewProjectionMatrix);E.set(a.eye,this._curEyePos);P.autoUpdateSkirtsVisibility(this,this._curEyePos)},g.prototype._setLayerViewsUpdating=function(){for(var a=
0;a<M.LayerClass.LAYER_CLASS_COUNT;a++)for(var b=this._layerViews[a],c=0;c<b.length;c++)b[c]._evaluateUpdatingState(this._pendingUpdates)},g.prototype._frameUpdateTraversal=function(a){if(!this.suspended){this._frameUpdateLowerPrio.clear();var b=this._renderer.resourceCounter.numTileTexturesComposited,c=this._iteratorPool.acquire();c.reset(this.rootTiles);for(var e=!1,d=!1;!c.done&&(1<a.remaining()||!e)&&this._renderer.resourceCounter.numTileTexturesComposited-b<fa;){var f=c.next();f.pendingUpdates&
ha.MERGE?(this._mergeTile(f),f.pendingUpdates&=~ha.MERGE,e=!0,c.skip()):f.pendingUpdates&ha.SPLIT?(this._splitTile(f),f.pendingUpdates&=~ha.SPLIT,e=!0,c.skip()):0<f.pendingUpdates&&this._frameUpdateLowerPrio.push(f);0!==f.pendingUpdates&&(d=!0)}return this._pendingUpdates=d||!c.done,this._iteratorPool.release(c),e}},g.prototype._updateTileGeometry=function(a){this._renderer._updateTileGeometry(a);ja.spatialReference=this.spatialReference;ja.tile=a;ja.extent=a.extent;this.emit("elevation-change",ja)},
g.prototype._updateTileTexture=function(a){this._renderer.updateTileTexture(a)},g.prototype._frameUpdate=function(a){if(this.rootTiles){for(var b=this._frameUpdateTraversal(a);(1<a.remaining()||!b)&&0<this._frameUpdateLowerPrio.length;){var c=this._frameUpdateLowerPrio.pop();c.pendingUpdates&ha.DECODE_ELEVATION?(this._decodeElevation(c),c.pendingUpdates&=~ha.DECODE_ELEVATION,b=!0):c.pendingUpdates&ha.UPDATE_GEOMETRY?(this._renderer.updateTileGeometryNeedsUpdate(c),this._updateTileGeometry(c),b=!0,
c.pendingUpdates&=~ha.UPDATE_GEOMETRY):c.pendingUpdates&ha.UPDATE_TEXTURE&&(this._updateTileTexture(c),c.pendingUpdates&=~ha.UPDATE_TEXTURE,b=!0);0!==c.pendingUpdates&&(this._pendingUpdates=!0)}0<this._frameUpdateLowerPrio.length&&(this._pendingUpdates=!0);(this._streamDataSupplier.hasPendingDownloads()||0!==this._vectorTileLayerRequests)&&(this._pendingUpdates=!0);this._pendingUpdates!==this._lvPendingUpdates&&(this._pendingUpdates||20===++this._updateNextFrame)&&(this._setLayerViewsUpdating(),this._lvPendingUpdates=
this._pendingUpdates,this._updateNextFrame=0)}},g.prototype._needsIdleUpdate=function(){return this.isVisible()&&this.overlayManager&&this.overlayManager.overlaysNeedUpdate()},g.prototype._idleUpdate=function(){this.overlayManager.updateOverlay();this._updateOverlayOpacity(this._curEyePos)},g.prototype._updateClippingExtent=function(){if(!this.spatialReference)return!1;var a=[0,0,0,0],b=null;return n.extentToBoundingRect(this._view.clippingArea,a,this.spatialReference)&&(b=a),k.equals(b,this._clippingExtent)?
!1:(this._clippingExtent=b,this._renderer.clippingExtent=b,this.notifyChange("extent"),this.overlayManager.setOverlayDirty(),!0)},g.prototype._clippingChanged=function(){this._updateClippingExtent()&&this._updateRootTiles()},g.prototype._getLodBias=function(){return Math.round(this._view.qualitySettings.tiledSurface.lodBias)},g.prototype._getLodBiasCorrectedScale=function(a){var b=this.tilingScheme.levels;a=x.clamp(a-this._getLodBias(),0,b.length-1);return b[a].scale},g.prototype._cancelTilemapRequests=
function(a){for(var b=0;b<M.LayerClass.LAYER_CLASS_COUNT;b++){var c=a.layerInfo[b];if(c)for(var e=0;e<c.length;e++){var d=c[e];d.tilemapRequest&&(d.tilemapRequest.cancel(),d.tilemapRequest=null)}}},g.prototype._removeAllTiles=function(){var a=this;this.rootTiles&&(this.rootTiles.forEach(function(b){a._purgeChildTiles(b);a._purgeTile(b)}),this._set("rootTiles",null),this.notifyChange("ready"));for(var b=0;b<this._topLevelTilemapOnlyTiles.length;b++)this._cancelTilemapRequests(this._topLevelTilemapOnlyTiles[b]);
this.setVisibility(!1)},g.prototype._purgeChildTiles=function(a){var b=this._postorderIterator;for(b.reset(a);!b.done;){for(var c=b.next(),e=0;4>e;e++)c.children[e]=null;c!==a&&this._purgeTile(c)}},g.prototype._purgeTile=function(a){a.unload(this._renderer);this._cancelTilemapRequests(a);a.parent=null;this._releaseTile(a)},g.prototype._splitTile=function(a){var b=a.lij[0]+1,c=2*a.lij[1],e=2*a.lij[2];a.children[0]=this._createTile(b,c,e,a);a.children[1]=this._createTile(b,c,e+1,a);a.children[2]=this._createTile(b,
c+1,e,a);a.children[3]=this._createTile(b,c+1,e+1,a);a.unload(this._renderer);na.spatialReference=this.spatialReference;na.extent=a.extent;na.scale=this._getLodBiasCorrectedScale(b);this.emit("scale-change",na)},g.prototype._createTile=function(a,b,c,e){K(!!e,"_createTile sanity check");a=this._acquireTile(a,b,c,e);if(a.updateClippingStatus(this._clippingExtent),a.updateVisibility(this._curFrustumPlanes,this._curEyePos),a.visible)a.updateScreenDepth(this._viewProjectionMatrix),a.shouldSplit(this._curSplitLimits,
this._curEyePos)===ha.SPLIT&&(a.pendingUpdates|=ha.SPLIT,this._pendingUpdates=!0);return this._loadTile(a),a},g.prototype._mergeTile=function(a){K(!a.renderData,"_mergeTile sanity check");this._loadTile(a);this._purgeChildTiles(a);na.spatialReference=this.spatialReference;na.extent=a.extent;na.scale=this._getLodBiasCorrectedScale(a.lij[0]);this.emit("scale-change",na)},g.prototype._loadTile=function(a){a.load(this._renderer);this.overlayManager&&this.overlayManager.hasOverlays()&&this.overlayManager.setOverlayParamsOfTile(a,
a.renderData,this._curOverlayOpacity);ja.spatialReference=this.spatialReference;ja.tile=a;ja.extent=a.extent;this.emit("elevation-change",ja)},g.prototype._handleHasHighlights=function(a){this._renderer.setNeedsHighlight(a)},g.prototype._decodeElevation=function(a){var b=M.LayerClass.ELEVATION,c=a.layerInfo[b];if(c)for(var e=0;e<c.length;e++){var d=c[e];if(d.pendingUpdates&=~ha.DECODE_ELEVATION,d.rawData){var f=a.decodeElevationData(d.rawData);if(d.rawData=null,f){d.data=f;var d=a.lij[0],g=this._iteratorPool.acquire();
for(g.reset(a);!g.done;){var h=g.next();h.findElevationBoundsForLayer(e,d);h.computeElevationBounds()}this._iteratorPool.release(g);a.dataArrived(e,b,f);this._updateTiles(a)}}}},g.prototype._handleLayerViewChanges=function(a){var b=this,c=!1;a.added.forEach(function(a){var e=a.layer;P.isTiledLayerView(a)?(b._registerTiledLayer(a),e.loaded&&(c=!0)):a.supportsDraping&&b.overlayManager&&b.overlayManager.registerLayerView(a)});a.removed.forEach(function(a){P.isTiledLayerView(a)?(c=!0,b._unregisterTiledLayerView(a.uid)):
a.supportsDraping&&b.overlayManager&&b.overlayManager.unregisterLayerView(a)});(c=c||0<a.moved.filter(P.isTiledLayerView).length)&&this._updateTiledLayers()},g.prototype._registerTiledLayer=function(a){var b=this,c=[];c.push(a.watch("suspended",function(){b._updateTiledLayers()}));c.push(a.watch("fullOpacity",function(){return b._updateTileTextures()}));a.on("data-changed",function(){var c=P.isElevationLayerView(a)?M.LayerClass.ELEVATION:M.LayerClass.MAP,e=b._layerIndexByLayerViewId[c][a.uid];null!=
e&&b._invalidateLayerData(e,c)});this._basemapLayerViewHandles[a.uid]=c},g.prototype._unregisterTiledLayerView=function(a){var b=this._basemapLayerViewHandles[a];if(b){for(var c=0;c<b.length;c++)b[c].remove();delete this._basemapLayerViewHandles[a]}},g.prototype._updateTiledLayers=function(){var a=this;if(this.tilingScheme){var b=this._view.allLayerViews,c=[[],[]],e=M.LayerClass,d=null,f=u.create(u.NEGATIVE_INFINITY);b.forEach(function(b){var g=b.layer;if(b.layer&&b&&!b.suspended&&P.isTiledLayerView(b)){var h=
b.fullExtent;if(h){if(!a.tilingScheme.compatibleWith(b.tileInfo))return void U.warn("Terrain: tiling scheme of layer "+g.id+" is incompatible with other tiled layers, will not be drawn");u.expand(f,h);P.isElevationLayerView(b)?c[e.ELEVATION].push(b):(b.maxDataLevel!==1/0&&(null===d||b.maxDataLevel>d)&&(d=b.maxDataLevel),c[e.MAP].push(b))}else U.warn("Terrain: Map or elevation layer does not have fullExtent: "+g.id)}},this);for(var b=function(a){var b=g._layerViews[a],d=c[a];d.reverse();var f=b.length!==
d.length,h=d.length,k=Array(h),l=Array(b.length);g._layerIndexByLayerViewId[a]={};for(var n=0;h>n;n++){g._layerIndexByLayerViewId[a][d[n].uid]=n;var p=b.indexOf(d[n]);k[n]=p;n!==p&&(f=!0);-1<p&&(l[p]=n)}if(f){g._topLevelTilemapOnlyTiles.forEach(function(b){return b.modifyLayers(l,k,a)});b=g._postorderIterator;if(g.rootTiles)for(b.reset(g.rootTiles);!b.done;)b.next().modifyLayers(l,k,a);if(g._layerViews[a]=d,g.rootTiles){for(b.reset(g.rootTiles);!b.done;)d=b.next(),d.restartAgents(a),a===e.ELEVATION&&
d.computeElevationBounds();g._updateTiles(g.rootTiles)}}},g=this,h=0;h<e.LAYER_CLASS_COUNT;h++)b(h);this.tilingScheme.levels.length-1<d&&(this.tilingScheme.ensureMaxLod(d),this._viewChangeUpdate())}},g.prototype._hasFixedExtent=function(){return!!this._clippingExtent},g.prototype.layerViewByIndex=function(a,b){return this._layerViews[b][a]},g.prototype.numLayers=function(a){return this._layerViews[a].length},g.prototype.numTotalLayers=function(){return this._layerViews.reduce(function(a,b){return b.length+
a},0)},g.prototype._updateTileTextures=function(){var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;)a.next().updateTexture();this._iteratorPool.release(a)},g.prototype._invalidateLayerData=function(a,b){var c=this._iteratorPool.acquire();for(c.reset(this.rootTiles);!c.done;)c.next().removeLayerAgent(a,b);for(c.reset(this.rootTiles);!c.done;)c.next().invalidateLayerData(a,b);this._iteratorPool.release(c)},g.prototype.requestTileData=function(a,b,c){var e=this;this.tilemapStats.tilesRequested++;
var d=this.layerViewByIndex(b,c),f=d.layer;if(f.tilemapCache){var g=this.getTilemapTile(a),h=g.layerInfo[c][b];if(!h.tilemap){h.tilemapRequest||(h.tilemapRequest=this.requestTilemap(g,b,c,d,f));var k,l=new w.Promise(function(){k&&k.cancel()});return h.tilemapRequest.always(function(){if(h.tilemapRequest=null,!l.isCancelled()){var b=e._layerIndexByLayerViewId[c][d.uid];null!=b&&(g.tileDataAvailable(a,b,c)?(k=e._requestTileData(a,b,c,d),k.then(function(){return l.resolve()})):(e.tilemapStats.tilesNotPresent++,
e._dispatchDataEvent(a,"dataMissing",c,d,{notInTilemap:!0}),l.reject()))}}),l}if(!g.tileDataAvailable(a,b,c))return this.tilemapStats.tilesNotPresent++,this._dispatchDataEvent(a,"dataMissing",c,d,{notInTilemap:!0}),b=new w.Promise,b.reject(),b}return this._requestTileData(a,b,c,d)},g.prototype._requestTileData=function(a,b,c,e){return this.tilemapStats.tileRequestsSent++,c===M.LayerClass.ELEVATION?this._requestElevationTileData(a,b,c,e):this._requestMapTileData(a,b,c,e)},g.prototype._requestElevationTileData=
function(a,b,c,e){function d(b){var d=h._layerIndexByLayerViewId[c][e.uid];null!=d?(d=a.layerInfo[c][d],d.rawData=b,a.pendingUpdates|=ha.DECODE_ELEVATION,d.pendingUpdates|=ha.DECODE_ELEVATION,h._pendingUpdates=!0):U.warn("TerrainSurface: received data from unknown layer %d %s",c,a.lij.toString())}function f(b){Y(b)||(h.tilemapStats.tileRequestErrors++,h._dispatchDataEvent(a,"dataMissing",c,e,b))}var g,h=this;P.isElevationLayerView(e)?(b=e.layer,P.useFetchTileForLayer(b)?(g=b.fetchTile(a.lij[0],a.lij[1],
a.lij[2],M.ELEVATION_NODATA_VALUE),g.then(function(a){return d(a)},f)):(b=e.getTileUrl(a.lij[0],a.lij[1],a.lij[2]),g=this._streamDataSupplier.request(b,"binary"),g.then(function(a,b){b.url=a;d(b)},f))):K(!1,"_requestElevationTileData can only be called for elevation layer views");return g},g.prototype._requestMapTileData=function(a,b,c,e){function d(b){g._dispatchDataEvent(a,"dataArrived",c,e,b)}function f(b){Y(b)||(g._dispatchDataEvent(a,"dataMissing",c,e,b),g.tilemapStats.tileRequestErrors++)}var g=
this;if(P.isVectorTileLayerView(e)){var h=e.tileHandler;b=e.schemeHelper.getCompatibleLevelRowCol(a.lij);b=h.getVectorTileWithLRC(b[0],b[1],b[2],0);b.then(d).otherwise(f).always(function(){g._vectorTileLayerRequests=h.ongoingRequestCount});this._vectorTileLayerRequests=h.ongoingRequestCount}else P.useFetchTileForLayer(e.layer)&&P.isTileLayerView(e)?(b=e.layer.fetchTile(a.lij[0],a.lij[1],a.lij[2]),b.then(d).otherwise(f)):(b=e.getTileUrl(a.lij[0],a.lij[1],a.lij[2]),b=this._streamDataSupplier.request(b,
"image"),b.then(function(a,b){return d(b)},f));return b},g.prototype.requestTilemap=function(a,b,c,e,d){var f=this,g=a.lij[0]+M.TILEMAP_SIZE_EXP,h=a.lij[1]<<M.TILEMAP_SIZE_EXP,k=a.lij[2]<<M.TILEMAP_SIZE_EXP;return this.tilemapStats.tilemapRequestsSent++,this.tilemapStats.tilemapRequestsPending++,d.tilemapCache.fetchTilemap(g,h,k,{timeout:6E3}).then(function(d){f.tilemapStats.tilemapRequestsPending--;b=f._layerIndexByLayerViewId[c][e.uid];null!=b&&(a.layerInfo[c][b].tilemap=d)}).otherwise(function(a){f.tilemapStats.tilemapRequestsPending--;
f.tilemapStats.tilemapRequestErrors++})},g.prototype.getTilemapTile=function(a){var b=a.lij[0];return b>M.TILEMAP_SIZE_EXP?O.getTileNLevelsUp(a,M.TILEMAP_SIZE_EXP):this._topLevelTilemapOnlyTiles[b]},g.prototype._dispatchDataEvent=function(a,b,c,e,d){e=this._layerIndexByLayerViewId[c][e.uid];null!=e?a[b](e,c,d):U.warn("TerrainSurface: received data from unknown layer")},g.prototype._updateTileOverlayParams=function(){if(this.rootTiles){var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;){var b=
a.next();b.renderData&&this.overlayManager&&this.overlayManager.setOverlayParamsOfTile(b,b.renderData,this._curOverlayOpacity)}this._iteratorPool.release(a);this._renderer.setNeedsRender()}},g.prototype._updateOverlayOpacity=function(a){if(this.overlayManager&&(a=this.overlayManager.updateOpacity(a),!isNaN(a))){if(a!==this._curOverlayOpacity&&this.rootTiles){var b=this._iteratorPool.acquire();for(b.reset(this.rootTiles);!b.done;){var c=b.next();c.renderData&&c.renderData.overlayTexId&&(c.renderData.overlayOpacity=
a)}this._iteratorPool.release(b)}this._curOverlayOpacity=a;this._renderer.setNeedsRender()}},g.prototype.getStats=function(){var a=0,b=0,c=0,e=[],d=this._iteratorPool.acquire();for(d.reset(this.rootTiles);!d.done;){var f=d.next();if(a++,f.renderData&&(b++,f.visible))c++,f=f.lij[0],e[f]=null!=e[f]?e[f]+1:1}return this._iteratorPool.release(d),{numNodes:a,numLeaves:b,numVisible:c,numVisiblePerLevel:e}},g.prototype.getMemoryUsage=function(){var a=0,b=0,c=0,e=0,d=0,f=0,g=this._iteratorPool.acquire();
g.reset(this.rootTiles);for(var h=this.tilingScheme.pixelSize,h=h[0]*h[1]*4;!g.done;){var k=g.next(),l=W(k),n;for(n in k.layerInfo[M.LayerClass.MAP]){var p=k.layerInfo[M.LayerClass.MAP][n].data,q=p&&p.descriptor?1.3*p.descriptor.width*p.descriptor.height*4:0,p=p&&!p.descriptor?h:0;k.renderData||l?(a+=p,e+=q):(b+=p,d+=q)}for(n in k.layerInfo[M.LayerClass.ELEVATION])p=k.layerInfo[M.LayerClass.ELEVATION][n].data,a+=p?h:0;k.renderData&&(l=k.renderData.texture,e+=l&&l.descriptor?1.3*l.descriptor.width*
l.descriptor.height*4:0,k=k.renderData.geometryInfo.geometry,f+=k.data.estimateGpuMemoryUsage(),c+=2*k.data.getIndices("terrain").length,c+=4*k.data.getAttribute("terrain").data.length)}return this._iteratorPool.release(g),{cpuVisibleImageData:a,cpuInvisibleImageData:b,cpuGeometryData:c,gpuVisibleImageData:e,gpuInvisibleImageData:d,gpuGeometryData:f}},g.prototype.getTile=function(a){var b=a.split("/").map(function(a){return+a});if(0===b[0])return this.rootTiles.forEach(function(a){return a.lij[1]===
b[1]&&a.lij[2]===b[2]?a:void 0}),null;var c,e=Math.pow(2,b[0]),d=Math.floor(b[1]/e),f=Math.floor(b[2]/e);if(this.rootTiles.some(function(a){return a.lij[1]===d&&a.lij[2]===f?(c=a,!0):!1}),c){for(e=1<<b[0]-1;c.lij[0]<b[0];){var g=b[1]&e?2:0;if(0<(b[2]&e)&&g++,!c.children[g])return console.log("Tile "+a+" doesn't exist, smallest ancestor is "+O.tile2str(c)),null;c=c.children[g];e>>=1}return K(c.lij[0]===b[0]&&c.lij[1]===b[1]&&c.lij[2]===b[2],"not the right tile?"),c}return null},g.prototype.hasPendingUpdates=
function(){if(this._streamDataSupplier.hasPendingDownloads()||0!==this._vectorTileLayerRequests)return!0;var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;)if(0<a.next().pendingUpdates)return this._iteratorPool.release(a),!0;return this._iteratorPool.release(a),!1},g.prototype.setBorders=function(a){this._renderer.setBorders(a)},g.prototype.setDisableRendering=function(a){this._renderer.setDisableRendering(a)},d([b.property({value:!1})],g.prototype,"cullBackFaces",null),d([b.property({readOnly:!0})],
g.prototype,"extent",null),d([b.property({value:!1})],g.prototype,"frontMostTransparent",null),d([b.property({readOnly:!0})],g.prototype,"loaded",void 0),d([b.property({value:1})],g.prototype,"opacity",null),d([b.property({readOnly:!0})],g.prototype,"overlayManager",void 0),d([b.property({readOnly:!0})],g.prototype,"manifold",void 0),d([b.property()],g.prototype,"maxTextureScale",void 0),d([b.property({readOnly:!0})],g.prototype,"ready",null),d([b.property({value:1})],g.prototype,"renderOrder",null),
d([b.property({readOnly:!0})],g.prototype,"rootTiles",void 0),d([b.property({value:!0})],g.prototype,"skirts",null),d([b.property({readOnly:!0,aliasOf:"tilingScheme.spatialReference"})],g.prototype,"spatialReference",void 0),d([b.property({value:M.DEFAULT_TILE_BACKGROUND})],g.prototype,"tileBackground",null),d([b.property({readOnly:!0})],g.prototype,"tilingScheme",void 0),d([b.property({readOnly:!0,aliasOf:"tilingSchemeLogic.tilingSchemeLocked"})],g.prototype,"tilingSchemeLocked",void 0),d([b.property({readOnly:!0,
aliasOf:"tilingSchemeLogic.tilingSchemeDone"})],g.prototype,"tilingSchemeDone",void 0),d([b.property({readOnly:!0})],g.prototype,"tilingSchemeLogic",void 0),d([b.property({value:!0})],g.prototype,"velvetOverground",null),d([b.property({value:!1})],g.prototype,"wireframe",null),g=d([b.subclass("esri.views.3d.terrain.TerrainSurface")],g)}(b.declared(g,v.Evented));var V=1.2,X=80/180*Math.PI,ba=M.MAX_ROOT_TILES,fa=12,ha=M.TileUpdateTypes,ca=p.create(),ea=[0,0,0],ja={spatialReference:null,tile:null,extent:null},
na={spatialReference:null,extent:null,scale:0};return m})},"esri/views/3d/terrain/OverlayManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/on ../../../core/Logger ../../../core/Accessor ../../../core/HandleRegistry ../../../core/accessorSupport/decorators ../../../geometry/Point ../lib/glMatrix ../state/utils/viewUtils ../support/mathUtils ../support/earthUtils ../support/projectionUtils ../support/aaBoundingRect ../support/debugFlags ../webgl-engine/Stage ../webgl-engine/lib/Texture ../webgl-engine/lib/Selector ../support/debugFlags ../../../symbols/SimpleMarkerSymbol ../../../Graphic".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B){var F,G=[[-.1,-2,3.9,2],[-.1,-3.9,3.9,.1],[-2,-3.9,2,.1],[-3.9,-3.9,.1,.1],[-3.9,-2,.1,2],[-3.9,-.1,.1,3.9],[-2,-.1,2,3.9],[-.1,-.1,3.9,3.9]],N=g.getLogger("esri.views.3d.OverlayManager"),M=function(g){function k(){var a=null!==g&&g.apply(this,arguments)||this;return a._handles=new f,a._overlaySR=null,a._renderSR=null,a._overlaySREqualsRenderSR=!0,a._connectedLayers={},a._scale=0,a._dirty=!1,a._isSpherical=!1,a._latestOriginId=0,a.opacity=0,
a}return h(k,g),Object.defineProperty(k.prototype,"hasHighlights",{get:function(){return this._renderer.hasHighlights},enumerable:!0,configurable:!0}),k.prototype.initialize=function(){var a=this;this._stage=this.view._stage;this._renderer=this._stage.getTextureGraphicsRenderer();this._renderer.onHasHighlightsChanged=function(){return a.onHasHighlightsChanged()};this._initialEmptyTexture=new n(new Uint8Array([0,0,0,0]),"overlayEmpty",{width:1,height:1,wrapClamp:!0});this.groundSelector=new w(this.view.viewingMode);
this.groundSelector.enableBackfacesTerrain=!0;this.groundSelector.enableInvisibleTerrain=!0;this.groundSelector.enableHUDSelection=!1;this._stage.add(y.ModelContentType.TEXTURE,this._initialEmptyTexture);this._handles.add(this.view.watch(["pointsOfInterest.renderPointOfView","pointsOfInterest.centerOnSurfaceFrequent.location"],function(){return a.setOverlayDirty()}))},k.prototype.destroy=function(){for(var a in this._connectedLayers)this.unregisterLayerView(this._connectedLayers[a].layerView);this._disposeOverlays();
this._stage.remove(y.ModelContentType.TEXTURE,this._initialEmptyTexture.getId());this._handles&&(this._handles.destroy(),this._handles=null)},k.prototype.onHasHighlightsChanged=function(){this.setOverlayDirty();this.notifyChange("hasHighlights")},k.prototype.hasOverlays=function(){return!!this._overlays},k.prototype.setSpatialReference=function(a,b){(this._overlaySR=a)?(this._renderSR=this.view.renderSpatialReference,this._overlaySREqualsRenderSR=this._overlaySR.equals(this._renderSR),this._isSpherical=
b,b?this._longitudeCyclical=a.isWebMercator?new t.Cyclical(-2.0037508342788905E7,2.0037508342788905E7):new t.Cyclical(-180,180):this._longitudeCyclical=null):(this._disposeOverlays(),this._longitudeCyclical=null)},k.prototype.registerLayerView=function(a){var c=this,e=a.layer.uid;if(this._connectedLayers[e])return void N.warn("[OverlayManager#registerLayerView]: Layer "+e+" is already connected");var d=b(a,"draped-data-change",function(){return c.setOverlayDirty()});if(this._connectedLayers[e]={eventHandles:[d],
layerView:a},a.setDrapingExtent&&this._overlays)for(e=0;e<this._overlays.length;e++)d=this._overlays[e],a.setDrapingExtent(e,d.extent,this._overlaySR,2048,d.renderLocalOrigin);this.setOverlayDirty();this._setLayerViewOverlayUpdating(a,this._dirty)},k.prototype.unregisterLayerView=function(a){for(var b in this._connectedLayers){var c=this._connectedLayers[b];if(c.layerView===a){if(c.eventHandles)for(var e=0;e<c.eventHandles.length;e++)c.eventHandles[e].remove();delete this._connectedLayers[b];this.setOverlayDirty();
a.destroyed||(a._overlayUpdating=!1,a._evaluateUpdatingState())}}},k.prototype.setOverlayDirty=function(){this._dirty||(this._setOverlayUpdating(!0),this._dirty=!0)},k.prototype._setLayerViewOverlayUpdating=function(a,b){(!b||!a.suspended&&a.hasDraped)&&(a._overlayUpdating=b,a._evaluateUpdatingState())},k.prototype._setOverlayUpdating=function(a){for(var b in this._connectedLayers)this._setLayerViewOverlayUpdating(this._connectedLayers[b].layerView,a);(b=this.view._graphicsView)&&(b._overlayUpdating=
a,b._evaluateUpdatingState())},k.prototype.updateOverlay=function(){if(this._overlaySR){var a=this._computeOverlayExtents();if(a){this._overlays||this._initOverlays();for(var b=0;b<this._overlays.length;b++){var e=this._overlays[b],d;a:{d=a[b];for(var f=e.extent,g=x.TESTS_DISABLE_UPDATE_THROTTLE_THRESHOLDS?0:M.EXTENTS_DIFFER_THRESHOLD*Math.max(d[2]-d[0],d[3]-d[1],f[2]-f[0],f[3]-f[1]),h=0;4>h;h++)if(Math.abs(f[h]-d[h])>g){d=!0;break a}d=!1}if(d){c.vec4d.set(a[b],e.extent);e.renderLocalOrigin={id:"OV_"+
this._latestOriginId++,vec3:v.center(e.extent,c.vec3d.create())};for(var k in this._connectedLayers)d=this._connectedLayers[k].layerView,d.setDrapingExtent&&d.setDrapingExtent(b,a[b],this._overlaySR,2048,e.renderLocalOrigin)}}this._setOverlayUpdating(!1);this._drawOverlays();this.terrainSurface._updateTileOverlayParams();this._dirty=!1}}},k.prototype.overlaysNeedUpdate=function(){return this._dirty&&!!this._overlaySR},k.prototype.updateOpacity=function(a){var b=1;if(this._overlays){var c=this._scale;
a=this.view.renderCoordsHelper.getAltitude(a);c>3.5*a&&(b=(a-c/10)/(c/3.5-c/10),b=Math.sqrt(t.clamp(b,0,1)))}return b},k.prototype.setOverlayParamsOfTile=function(a,b,e){var d=a.extent;a=this._overlayForTile(a);if(!a)return b.overlayTexId=null,void(b.highlightOverlayTexId=null);var f=a.extent;b.overlayTexScale[0]=(d[2]-d[0])/(f[2]-f[0]);b.overlayTexScale[1]=(d[3]-d[1])/(f[3]-f[1]);var g=d[0];if(this._longitudeCyclical){var g=this._longitudeCyclical.minimalMonotonic(f[0],g),h=this._longitudeCyclical.minimalMonotonic(f[0],
d[2]);g>h&&(g=h-(d[2]-d[0]))}c.vec2d.set2((g-f[0])/(f[2]-f[0]),(d[1]-f[1])/(f[3]-f[1]),b.overlayTexOffset);a.valid?b.overlayTexId=a.texture.getId():b.overlayTexId=this._initialEmptyTexture.getId();a.highlightValid?b.highlightOverlayTexId=a.highlightTexture.getId():b.highlightOverlayTexId=this._initialEmptyTexture.getId();void 0!==e?b.overlayOpacity=e:b.overlayOpacity=1},k.prototype.overlayPixelSizeInMapUnits=function(a){var b;return this._overlays&&(this._overlays[0]&&this._pointIsInExtent(a,this._overlays[0].extent)?
b=this._overlays[0].extent:this._overlays[1]&&(b=this._overlays[1].extent)),b?(b[2]-b[0])/2048:0},k.prototype._overlayForTile=function(a){var b=a.extent;a=a.clippingArea?v.intersection(b,a.clippingArea,T):b;return this._rectInsideRect(a,this._overlays[0].extent)?this._overlays[0]:this._rectanglesOverlap(a,this._overlays[1].extent)?this._overlays[1]:null},k.prototype._createEmptyOverlay=function(){var a=new n(null,"overlay",{wrapClamp:!0,mipmap:!0});this._stage.add(y.ModelContentType.TEXTURE,a);var b=
new n(null,"highlightOverlay",{wrapClamp:!0,mipmap:!0});return this._stage.add(y.ModelContentType.TEXTURE,b),{extent:c.vec4d.create(),texture:a,valid:!1,highlightTexture:b,highlightValid:!1,renderLocalOrigin:{id:"O",vec3:[0,0,0]}}},k.prototype._initOverlays=function(){this._overlays=[this._createEmptyOverlay(),this._createEmptyOverlay()]},k.prototype._disposeOverlays=function(){if(this._overlays){var a=this._stage;this._overlays.forEach(function(b){a.remove(y.ModelContentType.TEXTURE,b.texture.getId());
a.remove(y.ModelContentType.TEXTURE,b.highlightTexture.getId())});this._overlays=null}},k.prototype._intersectGroundFromView=function(a,b,e,d){var f=c.vec3d.createFrom(b*this.view.width,e*this.view.height,1);c.vec3d.unproject(f,a.viewMatrix,a.projectionMatrix,a.fullViewport,f);b=c.vec3d.createFrom(b*this.view.width,e*this.view.height,0);return c.vec3d.unproject(b,a.viewMatrix,a.projectionMatrix,a.fullViewport,b),this.groundSelector.init([],b,f,null,a,null,!1),this.view.basemapTerrain.intersect(this.groundSelector,
b,f),this.groundSelector.minResult.getIntersectionPoint(d)},k.prototype._findHorizonBasedPointOfInterest=function(a,b,e){var d=.5;if("global"===this.view.viewingMode){d=c.vec3d.create(a.eye);c.vec3d.normalize(d);c.vec3d.negate(d);b=c.vec3d.length(b);b=Math.asin(b/c.vec3d.length(a.eye));var f=Math.acos(c.vec3d.dot(a.viewForward,d)),d=t.clamp((b-(f-.5*a.fovY))/a.fovY,0,1);b=t.clamp((-b-(f-.5*a.fovY))/a.fovY,0,1);d=1===d&&0===b?.5:b+.55*(d-b)}else d=c.mat4d.multiplyVec4(a.projectionMatrix,c.vec4d.createFrom(0,
Math.tan(.5*Math.PI-Math.acos(-a.viewForward[2])),1,0))[1],d=t.clamp(.5+.5*d,0,1),d=1===d||0===d?.5:0<a.eye[2]?.55*d:1-.55*(1-d);return this._intersectGroundFromView(a,.5,d,e)?!0:!1},k.prototype._computeOverlayExtents=function(){var a=this.view.state.camera,b=this.terrainSurface.extent,d=c.vec3d.create(),f=this.view.pointsOfInterest.centerOnSurfaceFrequent.renderLocation;this._findHorizonBasedPointOfInterest(a,this.view.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,d)||c.vec3d.set(f,d);
this._scale=this.view.renderCoordsHelper.getAltitude(a.eye);var g=c.vec3d.dist(a.eye,d),f=q.viewAngle(this.view.renderCoordsHelper,f,a.eye),f=Math.PI/2-Math.abs(f-Math.PI/2);if(z.OVERLAY_SHOW_CENTER){var h=new C({color:[255,0,0],outline:{color:[255,255,255],width:2}}),k=new e;u.vectorToPoint(d,this._renderSR,k,this._overlaySR);h=new B({geometry:k,symbol:h});void 0!==F&&this.view.graphics.remove(F);this.view.graphics.add(h);F=h}this._overlaySREqualsRenderSR||u.vectorToVector(d,this._renderSR,d,this._overlaySR);
h=1024*a.perPixelRatio*g*2;g=!1;k=1/0;this._isSpherical&&(this._overlaySR.isWebMercator?(h/=Math.cos(u.webMercator.y2lat(d[1])),k=this.terrainSurface.extent[3],k*=.999):(g=!0,h/=r.metersPerDegree,k=90),h>=k&&(h=k,d[1]=0,this._overlaySR.isWebMercator&&(d[0]=0)));var l=1;g&&(l=1/Math.max(.2,Math.cos(Math.abs(t.deg2rad(d[1])))),180<h*l&&(l=180/h));var n=h*l,m=S[0];m[0]=d[0]-n;m[1]=d[1]-h;m[2]=d[0]+n;m[3]=d[1]+h;this._isSpherical&&this._shiftExtentToFitBounds(m,1/0,k);g=S[1];(c.vec4d.set(m,g),6*n>b[2]-
b[0])?c.vec4d.set(b,g):f<=.25*Math.PI?(g[0]-=n,g[1]-=h,g[2]+=n,g[3]+=h):(u.vectorToVector(a.eye,this._renderSR,O,this._overlaySR),c.vec2d.subtract(d,O,T),a=-Math.atan2(T[1],T[0])+.125*Math.PI,0>a&&(a+=2*Math.PI),c.vec4d.scale(G[Math.floor(a/(.25*Math.PI))],2*h,T),T[0]*=l,T[2]*=l,c.vec4d.add(g,T,g));if(this._isSpherical&&(g[0]=this._longitudeCyclical.clamp(g[0]),g[2]=this._longitudeCyclical.clamp(g[2]),g[1]=Math.max(g[1],-k),g[3]=Math.min(g[3],k)),!this._isSpherical&&b)a=v.intersection(m,b,H),b=v.intersection(g,
b,Y),v.contains(a,b)&&(g[2]=g[0],g[3]=g[1]);return this.opacity=1,S},k.prototype._drawOverlays=function(){for(var a=this._overlays[0].extent[2]-this._overlays[0].extent[0],b=this._renderer,e=0;e<this._overlays.length;e++){var d=this._overlays[e].extent,f=this._longitudeCyclical?d[2]>this._longitudeCyclical.max:!1,g=this._longitudeCyclical?d[0]<this._longitudeCyclical.min:!1;if(f||g){R.views=Q;var g=void 0,g=f?this._longitudeCyclical.max-d[0]:this._longitudeCyclical.min-d[0],g=Math.round(g/(d[2]-d[0])*
2048),h=R.views[0];c.vec4d.set4(0,0,g,2048,h.viewport);c.vec4d.set4(d[0],d[1],this._longitudeCyclical.max,d[3],h.extent);f||(h.extent[0]+=this._longitudeCyclical.range);h=R.views[1];c.vec4d.set4(g,0,2048-g,2048,h.viewport);c.vec4d.set4(this._longitudeCyclical.min,d[1],d[2],d[3],h.extent);f&&(h.extent[2]-=this._longitudeCyclical.range)}else R.views=P,c.vec4d.set(d,R.views[0].extent),c.vec4d.set4(0,0,2048,2048,R.views[0].viewport);R.width=2048;R.height=2048;R.pixelRatio=a/(d[2]-d[0]);this._overlays[e].valid=
b.draw(this._overlays[e].texture,R);this._overlays[e].highlightValid=b.drawHighlights(this._overlays[e].highlightTexture,R)}},k.prototype._rectanglesOverlap=function(a,b){return this._longitudeCyclical?(this._longitudeCyclical.contains(b[0],b[2],a[0])||this._longitudeCyclical.contains(b[0],b[2],a[2])||this._longitudeCyclical.contains(a[0],a[2],b[0]))&&!(a[1]>b[3]||a[3]<b[1]):v.intersects(a,b)},k.prototype._rectInsideRect=function(a,b){return this._longitudeCyclical?this._longitudeCyclical.contains(b[0],
b[2],a[0])&&this._longitudeCyclical.contains(b[0],b[2],a[2])&&a[1]>b[1]&&a[3]<b[3]:v.contains(b,a)},k.prototype._pointIsInExtent=function(a,b){if(this._longitudeCyclical)return this._longitudeCyclical.contains(b[0],b[2],a.x)&&a.y>=b[1]&&a.y<=b[3];var c=a.x;a=a.y;return c>b[0]&&c<b[2]&&a>b[1]&&a<b[3]},k.prototype._shiftExtentToFitBounds=function(a,b,c){var e=0,d=0;a[0]<-b?e=a[0]+b:a[2]>b&&(e=b-a[2]);a[1]<-c?d=a[1]+c:a[3]>c&&(d=c-a[3]);v.offset(a,e,d)},k.EXTENTS_DIFFER_THRESHOLD=1E-5,d([a.property()],
k.prototype,"view",void 0),d([a.property()],k.prototype,"terrainSurface",void 0),d([a.property({type:Boolean})],k.prototype,"hasHighlights",null),k=d([a.subclass("esri.views.3d.terrain.OverlayManager")],k)}(a.declared(k)),R={width:0,height:0,pixelRatio:0,views:null},P=[{viewport:c.vec4d.create(),extent:c.vec4d.create()}],Q=[P[0],{viewport:c.vec4d.create(),extent:c.vec4d.create()}],T=c.vec4d.create(),O=c.vec3d.create(),S=[c.vec4d.create(),c.vec4d.create()],H=v.create(),Y=v.create();return M})},"esri/views/3d/terrain/PlanarTile":function(){define(["./TileBase",
"./TileGeometryFactory","../../../core/ObjectPool","../support/mathUtils","../lib/glMatrix"],function(m,l,h,d,b){var g=b.vec3d.createFrom(0,0,1);b=function(b,d,a,e){m.call(this);this.tileUp=g;void 0!==b&&this.init(b,d,a,e)};return b.prototype=new m,b.prototype.constructor=b,b.prototype.init=function(b,f,a,e){m.prototype.init.call(this,b,f,a,e);this.edgeLen=this.extent[2]-this.extent[0];this.curvatureHeight=0;this.centerAtSeaLevel[0]=d.lerp(this.extent[0],this.extent[2],.5);this.centerAtSeaLevel[1]=
d.lerp(this.extent[1],this.extent[3],.5);this.centerAtSeaLevel[2]=0;this.updateRadiusAndCenter()},b.prototype.updateRadiusAndCenter=function(){m.prototype.updateRadiusAndCenter.call(this);var b=(this.extent[2]-this.extent[0])*Math.SQRT1_2,d=.5*(this.elevationBounds[0]-this.elevationBounds[1]);this.radius=Math.sqrt(b*b+d*d)},b.prototype.isVisible=function(b){if(!this.intersectsClippingArea)return!1;var d=this.extent[0],a=this.extent[1],e=this.elevationBounds[0],c=this.extent[2],g=this.extent[3],h=
this.elevationBounds[1];return 0<b[0][0]*(0<b[0][0]?d:c)+b[0][1]*(0<b[0][1]?a:g)+b[0][2]*(0<b[0][2]?e:h)+b[0][3]?!1:0<b[1][0]*(0<b[1][0]?d:c)+b[1][1]*(0<b[1][1]?a:g)+b[1][2]*(0<b[1][2]?e:h)+b[1][3]?!1:0<b[2][0]*(0<b[2][0]?d:c)+b[2][1]*(0<b[2][1]?a:g)+b[2][2]*(0<b[2][2]?e:h)+b[2][3]?!1:0<b[3][0]*(0<b[3][0]?d:c)+b[3][1]*(0<b[3][1]?a:g)+b[3][2]*(0<b[3][2]?e:h)+b[3][3]?!1:0<b[4][0]*(0<b[4][0]?d:c)+b[4][1]*(0<b[4][1]?a:g)+b[4][2]*(0<b[4][2]?e:h)+b[4][3]?!1:0<b[5][0]*(0<b[5][0]?d:c)+b[5][1]*(0<b[5][1]?
a:g)+b[5][2]*(0<b[5][2]?e:h)+b[5][3]?!1:!0},b.prototype._numSubdivisionsAtLevel=[2,2,2,2,2,2,2,2],b.prototype.createGeometry=function(b,d,a){return b.needsUpdate=!1,l.createPlanarGlobeTile(b.numVertsPerRow,this.extent,b.samplerData,d,a,b.clippingArea)},b.Pool=new h(b),b})},"esri/views/3d/terrain/TileBase":function(){define("./terrainUtils ./tileUtils ./TerrainConst ./ElevationData ./TilePerLayerInfo ./ElevationTileAgent ./MapTileAgent ../support/mathUtils ../lib/glMatrix ../../../core/arrayUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e){var c=a.vec3d,q=a.vec2d,t=a.vec4d,r=a.mat4d,u=m.weakAssert,v=c.create(),x=t.create(),y=t.create(),n=c.create(),w=k.AGENT_DONE,z=h.LayerClass.LAYER_CLASS_COUNT,C=h.LayerClass.MAP,B=h.LayerClass.ELEVATION,F=h.TileUpdateTypes;a=function(a,b,e){this.lij=[0,0,0];this.extent=t.create();this.extentWGS84Rad=t.create();this.centerAtSeaLevel=c.create();this.center=c.create();this.tileUp=n;this.elevationBounds=q.create();this.children=[null,null,null,null];this.layerInfo=Array(z);
this.intersectsClippingArea=this.isWithinClippingArea=!0;this.clippingArea=null;this._maxTesselation=0};return a.prototype.init=function(a,c,e,d){this.lij[0]=a[0];this.lij[1]=a[1];this.lij[2]=a[2];d.getExtent(a[0],a[1],a[2],this.extent,this.extentWGS84Rad);this.intersectsClippingArea=this.isWithinClippingArea=!0;this.clippingArea=null;this.radius=this.edgeLen=0;this.vlevel=a?a[0]:0;c&&c.elevationBounds?q.set(c.elevationBounds,this.elevationBounds):q.set2(0,0,this.elevationBounds);this.parent=c;for(a=
0;4>a;a++)this.children[a]=null;this.pendingUpdates=0;this.renderData=null;this.renderOrder=this.screenDepth=0;this.visible=!1;this.parentSurface=e;for(a=0;z>a;a++)if(e){var f;c=e.numLayers(a);this.layerInfo[a]?(f=this.layerInfo[a],f.length=c):(f=Array(c),this.layerInfo[a]=f);for(var g=0;c>g;g++)f[g]=b.makeEmptyLayerInfo(a,f[g]),a==B&&this.findElevationBoundsForLayer(g,-1)}else this.layerInfo[a]=null;this.computeElevationBounds();this._maxTesselation=Math.min(d.pixelSize[0],h.MAX_TILE_TESSELATION)},
a.prototype.dispose=function(){for(var a=0;z>a;a++)for(var b=this.layerInfo[a],c=0;c<b.length;c++)b[c].dispose()},a.prototype.updateScreenDepth=function(a){c.set(this.center,y);y[3]=1;r.multiplyVec4(a,y,y);this.screenDepth=y[2]/y[3]},a.prototype.shouldSplit=function(a,b){var e=this.lij[0];if(1>e)return F.SPLIT;c.subtract(this.center,b,v);var d=c.length(v),g=this.edgeLen/(a[0]*d*2),d=this.edgeLen/(a[2]*d*2),h=a[1],k=a[3],l=a[4];a=a[5];return h>g?this.vlevel!==this.lij[0]?(this.vlevel=this.lij[0],F.VSPLITMERGE):
F.NONE:e>=l?(d=e+Math.ceil(-f.log2(h/g)),d!==this.vlevel?(this.vlevel=d,F.VSPLITMERGE):F.NONE):6<e&&(c.scale(this.tileUp,c.dot(this.tileUp,v),x),c.subtract(x,v),c.length2(x)>this.radius*this.radius)&&(c.scale(x,this.radius/c.length(x)),c.add(x,this.center),c.subtract(b,x,x),b=this.elevationBounds[1]-this.elevationBounds[0],b=Math.min(1,(Math.abs(c.dot(x,this.tileUp))+.5*b+this.curvatureHeight)/c.length(x)),.1/a*k>b*d)?F.NONE:F.SPLIT},a.prototype.decodeElevationData=function(a){var b;if(a instanceof
ArrayBuffer)try{b=d.createFromLERC(this.lij,this.extent,a,h.noDataValueOpt)}catch(M){console.warn("Error decoding %s: %s",a.url,M.message)}else b=d.createFromFetchTileResult(this.lij,this.extent,a);return b},a.prototype.getWGS84Extent=function(){return this.extentWGS84Rad.map(f.rad2deg)},a.prototype.load=function(a){for(var b=0;z>b;b++)this.layerInfo[b]&&this._createOrUpdateAgents(0,b);a.loadTile(this)},a.prototype.unload=function(a){this.renderData&&a.unloadTile(this);for(a=0;z>a;a++)for(var b=this.layerInfo[a],
c=0;c<b.length;c++){var e=b[c];e.loadingAgent&&e.loadingAgent!==w&&(e.loadingAgent.dispose(),(a===h.LayerClass.ELEVATION?g:k).Pool.release(e.loadingAgent),e.loadingAgent=null);e.pendingUpdates=0}this.pendingUpdates&=~h.TileUpdateTypes.UPDATE_GEOMETRY;this.pendingUpdates&=~h.TileUpdateTypes.UPDATE_TEXTURE},a.prototype.updateClippingStatus=function(a){e.equals(a,this.clippingArea)||(a?(this.intersectsClippingArea=this.intersectsExtent(a),this.isWithinClippingArea=this.isWithinExtent(a)):(this.intersectsClippingArea=
!0,this.isWithinClippingArea=!0),this.clippingArea=a,this.renderData&&this.updateGeometry())},a.prototype.updateVisibility=function(a,b,c){a=c||this.isVisible(a,b)&&this.intersectsClippingArea;if(a!==this.visible)for(this.visible=a,b=this.layerInfo[0],c=0;c<b.length;c++){var e=b[c];e.loadingAgent&&e.loadingAgent!==w&&e.loadingAgent.setSuspension(!a)}return a},a.prototype.getLayerInfo=function(a,b){return this.layerInfo[b][a]},a.prototype.hasLayerData=function(a,b){return(a=this.layerInfo[b][a])&&
a.data&&!a.dataInvalidated},a.prototype.tileDataAvailable=function(a,b,c){return(b=this.layerInfo[c][b].tilemap)?"unavailable"!==b.getAvailability(a.lij[1],a.lij[2]):!0},a.prototype.requestLayerData=function(a,b,c){h.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d requested by tile %s",this.lij.toString(),b,a,c.tile.lij.toString());var e=this.layerInfo[b][a];if(-1<e.waitingAgents.indexOf(c))return console.warn("agent already requested this piece of map data (tile %s, agent tile %s, layer: %d/%d)",
this.lij.toString(),c.tile.lij.toString(),b,a),!0;if(e.data&&!e.dataInvalidated)return console.warn("agent requested existing data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),c.tile.lij.toString(),b,a),e.waitingAgents.push(c),setTimeout(c.dataArrived.bind(c,this),0),!0;if(e.pendingUpdates&F.DECODE_ELEVATION)return e.waitingAgents.push(c),!0;if(e.waitingAgents.push(c),!e.requestPromise){var d=this.parentSurface.requestTileData(this,a,b);if(d.isFulfilled())return!1;a=function(){e.requestPromise===
d&&(e.requestPromise=null)};return e.requestPromise=d,d.then(a,a),!!d}return!0},a.prototype.descendants=function(a){a||(a=[]);for(var b=0;4>b;b++){var c=this.children[b];c&&(c.descendants(a),a.unshift(this.children[b]))}return a},a.prototype.isLij=function(a){return this.lij[0]===a[0]&&this.lij[1]===a[1]&&this.lij[2]==a[2]},a.prototype.findByLij=function(a){if(this.isLij(a))return this;for(var b=0;4>b;b++){var c=this.children[b];if(c&&(c=c.findByLij(a)))return c}return null},a.prototype.unrequestLayerData=
function(a,b,c){h.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d canceled by tile %s",this.lij.toString(),b,a,c.tile.lij.toString());var e=this.layerInfo[b][a],d=e.waitingAgents;c=d.indexOf(c);if(u(-1<c,"agent has not requested this piece of map data"),d[c]=d[d.length-1],d.length--,1>d.length)d=e.requestPromise,c=!1,b===C&&(c=this.parentSurface.layerViewByIndex(a,C),c=m.isVectorTileLayerView(c)),c||u(d||e.rawData,"no pending operations on layerInfo that agents were waiting for"),d&&!d.isFulfilled()&&
(d.cancel(),e.requestPromise=null),h.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d request/loading canceled",this.lij.toString(),b,a)},a.prototype.dataArrived=function(a,b,c){a=this.layerInfo[b][a];a.data=c;a.dataInvalidated=!1;for(c=0;c<a.waitingAgents.length;c++)a.waitingAgents[c].dataArrived(this);a.waitingAgents.length=0},a.prototype.dataMissing=function(a,b,c){c.notInTilemap||console.error("Tile %s layer %d/%d error",this.lij.toString(),b,a);a=this.layerInfo[b][a];a.dataMissing=!0;
for(b=0;b<a.waitingAgents.length;b++)a.waitingAgents[b].dataMissing(this);a.waitingAgents.length=0},a.prototype.updateTexture=function(a){this.renderData&&(a?this.parentSurface._renderer.updateTileTexture(this):(this.pendingUpdates|=h.TileUpdateTypes.UPDATE_TEXTURE,this.parentSurface._pendingUpdates=!0))},a.prototype.invalidateLayerData=function(a,b){this.layerInfo[b][a].invalidateSourceData();this.restartAgents(b)},a.prototype.computeElevationBounds=function(){q.set2(Number.MAX_VALUE,-Number.MAX_VALUE,
this.elevationBounds);for(var a=this.layerInfo[B],b=!1,c=0;c<a.length;c++){var e=a[c];e.elevationBounds&&(this.elevationBounds[0]=Math.min(this.elevationBounds[0],e.elevationBounds[0]),this.elevationBounds[1]=Math.max(this.elevationBounds[1],e.elevationBounds[1]),b=!0)}b||q.set2(0,0,this.elevationBounds);this.updateRadiusAndCenter()},a.prototype.updateRadiusAndCenter=function(){c.scale(this.tileUp,.5*(this.elevationBounds[0]+this.elevationBounds[1]),x);c.add(this.centerAtSeaLevel,x,this.center)},
a.prototype.findElevationBoundsForLayer=function(a,b){var e=this.layerInfo[B][a];if(!e.elevationBounds||e.elevationBounds[2]<b)if(b=this.parentSurface.layerViewByIndex(a,B),l.fallsWithinLayer(this,b.layer,!1)){b=!1;if(e.data)q.set(e.data.bounds,x),x[2]=this.lij[0],b=!0;else{for(var d=this.parent,f=0,g=null,k=e.data;d&&(!k||f<h.ELEVATION_DESIRED_RESOLUTION_LEVEL)&&(f=this.vlevel-d.lij[0],g=k||g,k=d.layerInfo[B][a].data,!(!k&&g&&f>=h.ELEVATION_DESIRED_RESOLUTION_LEVEL));)d=d.parent;(k=k||g)&&(k.computeMinMaxValue(this.lij[0],
this.lij[1],this.lij[2],x),x[0]!==1/0&&(x[2]=k.level,b=!0))}b&&(e.elevationBounds?c.set(x,e.elevationBounds):e.elevationBounds=[x[0],x[1],x[2]])}},a.prototype.updateGeometry=function(){this.pendingUpdates|=h.TileUpdateTypes.UPDATE_GEOMETRY;this.parentSurface._pendingUpdates=!0},a.prototype.modifyLayers=function(a,c,e){for(var d=c.length,f=this.layerInfo[e],l=Array(d),n=0;n<f.length;n++){var q=f[n];q.loadingAgent&&q.loadingAgent!==w&&(q.loadingAgent.dispose(),(e===h.LayerClass.ELEVATION?g:k).Pool.release(q.loadingAgent),
q.loadingAgent=null);q.waitingAgents.length=0}if(e===C)for(n=0;n<f.length;n++)void 0===a[n]&&f[n].dispose();for(n=0;d>n;n++)a=c[n],l[n]=-1<a?f[a]:b.makeEmptyLayerInfo(e);this.layerInfo[e]=l},a.prototype.restartAgents=function(a){if(this.renderData)if(this._createOrUpdateAgents(0,a),a===B){this.updateGeometry();a=this.layerInfo[a];for(var b=0;b<a.length;b++)a[b].pendingUpdates|=h.TileUpdateTypes.UPDATE_GEOMETRY;this.parentSurface._pendingUpdates=!0}else this.updateTexture(!0)},a.prototype.updateAgents=
function(a){if(this.renderData){for(var b=this.layerInfo[a],c=0;c<b.length;c++){var e=b[c];e.loadingAgent===w&&(e.loadingAgent=null)}this._createOrUpdateAgents(0,a)}},a.prototype.removeLayerAgent=function(a,b){a=this.layerInfo[b][a];a.loadingAgent&&a.loadingAgent!==w&&a.loadingAgent.dispose();a.loadingAgent=null},a.prototype.agentDone=function(a,b){var c=this.layerInfo[b],e=c[a];e.loadingAgent=w;e.data||e.upsampleFromTile||a<c.length-1&&this._createOrUpdateAgents(a+1,b)},a.prototype._createOrUpdateAgents=
function(a,b){var c;c=b===B?!1:!this.visible;for(var e=this.layerInfo[b];a<e.length;){var d=e[a],f=!1,n=this.parentSurface.layerViewByIndex(a,b);if(null!==d.loadingAgent&&d.loadingAgent!==w)f=d.loadingAgent.update();else if(d.loadingAgent!==w&&l.fallsWithinLayer(this,n.layer,!1)){var q=b===h.LayerClass.ELEVATION?g:k,m=q.Pool.acquire();(f=m.init(this,a,b,c))?d.loadingAgent=m:(m.dispose(),q.Pool.release(m),d.loadingAgent=w)}if(f&&!n.isTransparent)break;a++}},a.prototype.geometryState=function(a){var b,
c=this._getElevationInfo(a?a.samplerData:null),d=this.lij[0],g=!1;c.samplerData?(b=this.vlevel-d,b=Math.max(d-c.maxTileLevel,h.ELEVATION_DESIRED_RESOLUTION_LEVEL-b),d=this._maxTesselation,b=f.clamp((d>>b)+1,2,d+1)):b=8>d?this._numSubdivisionsAtLevel[d]+1:2;d=this.clippingArea;return(!this.intersectsClippingArea||this.isWithinClippingArea)&&(d=null),a?(a.numVertsPerRow!==b&&(a.numVertsPerRow=b,g=!0),c.changed&&(a.samplerData=c.samplerData,g=!0),e.equals(a.clippingArea,d)||(a.clippingArea=d,g=!0),a.needsUpdate=
g):a={numVertsPerRow:b,samplerData:c.samplerData,needsUpdate:!0,clippingArea:d},a},a.prototype._getElevationInfo=function(a){for(var b=this.layerInfo[B],c=b.length,e=Array(c),d=0,f=0,g=!1,h=0;c>h;h++){var k=b[h];if(k.upsampleFromTile){var k=k.upsampleFromTile.tile,n=k.layerInfo[B][h].data;a&&a[d]===n.samplerData||(g=!0);e[d++]=n.samplerData;f=Math.max(f,k.lij[0])}else k.data&&(n=this.parentSurface.layerViewByIndex(h,B),l.fallsWithinLayer(this,n.layer,!1)&&(a&&a[d]===k.data.samplerData||(g=!0),e[d++]=
k.data.samplerData,f=this.lij[0]))}return a&&a.length!==d&&(g=!0),0<d?e.length=d:e=null,{changed:g,samplerData:e,maxTileLevel:f}},a.prototype.isWithinExtent=function(a){var b=this.extent;return b[0]>=a[0]&&a[2]>=b[2]&&b[1]>=a[1]&&a[3]>=b[3]},a.prototype.intersectsExtent=function(a){var b=this.extent;return b[2]>=a[0]&&a[2]>=b[0]&&b[3]>=a[1]&&a[3]>=b[1]},a})},"esri/views/3d/terrain/tileUtils":function(){define(["require","exports","./UpsampleInfo","../support/PreallocArray"],function(m,l,h,d){function b(a,
e,c,d){d=e.call(c,a,d);for(var f=0;4>f;f++){var g=a.children[f];g&&b(g,e,c,d)}}function g(a,b,c){if(Array.isArray(a))for(var e=0;e<a.length;e++)k(a[e],b,c);else k(a,b,c)}function k(a,b,c){for(var e=0;4>e;e++){var d=a.children[e];d&&g(d,b,c)}b.call(c,a)}Object.defineProperty(l,"__esModule",{value:!0});m=function(){function a(a){void 0===a&&(a=100);this.q=new d(a);this._last=null;this.done=!0}return a.prototype.reset=function(a){this.q.clear();a&&this.q.pushEither(a);this._last=null;this.done=0===this.q.length},
a.prototype.skip=function(){this._last=null;0===this.q.length&&(this.done=!0)},a.prototype.next=function(){if(this.done)return null;if(null!==this._last){var a=this._last.children;if(a[0])for(var b=4;0<=b;b--){var d=a[b];d&&this.q.push(d)}this._last=null}return this._last=this.q.pop(),0!==this.q.length||this._last.children[0]||(this.done=!0),this._last},a}();l.IteratorPreorder=m;m=function(){function a(a){void 0===a&&(a=100);this.q=new d(a);this.done=!0}return a.prototype.reset=function(a){this.q.clear();
this.q.pushEither(a);for(a=0;a<this.q.length;)for(var b=this.q.data[a++],e=0;4>e;e++){var d=b.children[e];d&&this.q.push(d)}this.done=0===this.q.length},a.prototype.next=function(){var a=this.q.pop();return this.done=0===this.q.length,a},a}();l.IteratorPostorder=m;l.lij2str=function(a,b,c){return a+"/"+b+"/"+c};l.tile2str=function(a){return a.lij[0]+"/"+a.lij[1]+"/"+a.lij[2]};l.traverseTilesPreorder=function(a,e,c,d){if(Array.isArray(a))for(var f=0;f<a.length;f++)b(a[f],e,c,d);else b(a,e,c,d)};l.traverseTilesPostorder=
g;l.fallsWithinLayer=function(a,b,c){if(!b)return!1;var e=b.fullExtent,d=a.extent;if(c){if(d[0]<e.xmin||d[1]<e.ymin||d[2]>e.xmax||d[3]>e.ymax)return!1}else if(e.xmin>d[2]||e.ymin>d[3]||e.xmax<d[0]||e.ymax<d[1])return!1;a=a.parentSurface.tilingScheme.levels[a.lij[0]].scale;return 0<b.minScale&&a>1.00000001*b.minScale?!1:0<b.maxScale&&a<.99999999*b.maxScale?!1:!0};l.isPosWithinTile=function(a,b){a=a.extent;return b[0]>=a[0]&&b[1]>=a[1]&&b[0]<=a[2]&&b[1]<=a[3]};l.getTileNLevelsUp=function(a,b){for(;0<
b;)a=a.parent,b--;return a};l.nextTileInAncestry=function(a,b){var c=a.lij[0]-b.lij[0]-1,e=a.lij[2]>>c,d=0;return 1&a.lij[1]>>c&&(d+=2),1&e&&(d+=1),b.children[d]};l.computeUpsampleInfoForAncestor=function(a,b){for(var c=1,e=0,d=0;a!==b;)if(c*=.5,e*=.5,d*=.5,1&a.lij[2]&&(e+=.5),0===(1&a.lij[1])&&(d+=.5),a=a.parent,null==a)throw Error("tile was not a descendant of ancestorTile");a=h.Pool.acquire();return a.init(b,e,d,c),a};var f=[null];l.hasVisibleSiblings=function(a){var b;Array.isArray(a)?b=a:(f[0]=
a,b=f);for(a=0;a<b.length;a++){var c=b[a],d=c.parent;if(d)for(var g=0;4>g;g++){var h=d.children[g];if(h&&h!==c&&h.visible)return!0}}return!1}})},"esri/views/3d/terrain/UpsampleInfo":function(){define(["require","exports","../lib/glMatrix","../../../core/ObjectPool"],function(m,l,h,d){var b=h.vec2d;return function(){function g(d,f,a,e){this.scale=0;this.tile=null;this.offset=b.create();void 0!==d&&this.init(d,f,a,e)}return g.prototype.init=function(b,d,a,e){this.tile=b;this.offset[0]=d;this.offset[1]=
a;this.scale=e},g.prototype.dispose=function(){this.tile=null;this.offset[0]=0;this.scale=this.offset[1]=0},g.Pool=new d(g),g}()})},"esri/views/3d/terrain/ElevationData":function(){define(["require","exports","../../../layers/support/rasterFormats/LercCodec","./TerrainConst","../support/mathUtils"],function(m,l,h,d,b){return function(){function g(b,d,a,e){this.samplerData=null;this.level=b;this.i=d;this.j=a;this.extent=e}return g.prototype.computeMinMaxValue=function(g,f,a,e){var c=1/0,h=-(1/0);g-=
this.level;var k=Math.pow(2,g);if(Math.floor(f/k)===this.i&&Math.floor(a/k)===this.j&&0<g){var l=this.samplerData.width,m=this.samplerData.pixelData,v=.5*d.ELEVATION_NODATA_VALUE;g=(l-1)/k;a=(a-this.j*k)*g;f=(f-this.i*k)*g;if(1>g){var k=Math.floor(a),x=Math.floor(f),y=k+x*l,n=m[y],w=m[y+1],z=m[y+l],y=m[y+l+1];if(v>n+w+z+y)return c=b.bilerp(n,w,z,y,a-k,f-x),h=b.bilerp(n,w,z,y,a-k+g,f-x),l=b.bilerp(n,w,z,y,a-k,f-x+g),g=b.bilerp(n,w,z,y,a-k+g,f-x+g),e[0]=Math.min(c,h,l,g),e[1]=Math.max(c,h,l,g),e;a=
k;f=x;g=1}else a=Math.floor(a),f=Math.floor(f),g=Math.ceil(g);for(k=a;a+g>=k;k++)for(x=f;f+g>=x;x++)y=k+x*l,n=m[y],v>n?(c=Math.min(c,n),h=Math.max(h,n)):(c=0<c?0:c,h=0>h?0:h)}return e[0]=c,e[1]=h,e},g.createFromLERC=function(b,d,a,e){a=h.decode(a,e);b=new g(b[0],b[1],b[2],d);b.samplerData={pixelData:a.pixelData,width:a.width,height:a.height,minValue:a.minValue,maxValue:a.maxValue,noDataValue:a.noDataValue,safeWidth:.99999999*(a.width-1),dx:(a.width-1)/(b.extent[2]-b.extent[0]),dy:(a.width-1)/(b.extent[3]-
b.extent[1]),x0:b.extent[0],y1:b.extent[3]};return b.bounds=[b.samplerData.minValue,-3E38<b.samplerData.maxValue?b.samplerData.maxValue:0],b},g.createFromFetchTileResult=function(b,d,a){b=new g(b[0],b[1],b[2],d);d=a.values;for(var e=a.noDataValue,c=1/0,f=-(1/0),h=!0,k=0;k<d.length;k++){var l=d[k];l!==e&&(c=c>l?l:c,f=l>f?l:f,h=!1)}return h&&(c=0,f=0),b.samplerData={pixelData:a.values,width:a.width,height:a.height,minValue:c,maxValue:f,noDataValue:e,safeWidth:.99999999*(a.width-1),dx:(a.width-1)/(b.extent[2]-
b.extent[0]),dy:(a.width-1)/(b.extent[3]-b.extent[1]),x0:b.extent[0],y1:b.extent[3]},b.bounds=[c,f],b},g}()})},"esri/views/3d/terrain/TilePerLayerInfo":function(){define("require exports ./TileAgentBase ./TerrainConst ./UpsampleInfo ../../webgl/Texture ../../vectorTiles/VectorTileDisplayObject".split(" "),function(m,l,h,d,b,g,k){return function(){function f(a){this.waitingAgents=[];this.rawData=this.requestPromise=this.loadingAgent=this.upsampleFromTile=this.tilemapRequest=this.tilemap=this.data=
null;this.pendingUpdates=0;this.elevationBounds=void 0;this.init(a)}return f.prototype.init=function(a){this.waitingAgents.length=0;this.data=null;this.dataInvalidated=this.dataMissing=!1;this.rawData=this.requestPromise=this.loadingAgent=this.upsampleFromTile=this.tilemapRequest=this.tilemap=null;this.pendingUpdates=0;a===d.LayerClass.ELEVATION&&(this.elevationBounds=null)},f.prototype.invalidateSourceData=function(){this.tilemap=null;this.dataInvalidated=!0;this.dataMissing=!1;this.upsampleFromTile&&
(b.Pool.release(this.upsampleFromTile),this.upsampleFromTile=null)},f.prototype.dispose=function(){this.loadingAgent&&this.loadingAgent!==h.AGENT_DONE&&(this.loadingAgent.dispose(),this.loadingAgent=null);this.requestPromise&&(this.requestPromise.cancel(),this.requestPromise=null);this.tilemap=null;this.tilemapRequest&&(this.tilemapRequest.cancel(),this.tilemapRequest=null);this.upsampleFromTile&&(b.Pool.release(this.upsampleFromTile),this.upsampleFromTile=null);this.rawData=null;this.pendingUpdates=
0;this.disposeData()},f.prototype.disposeData=function(){var a=this.data;a&&(a instanceof g?a.dispose():a instanceof k&&a.dispose(),this.data=null)},f.makeEmptyLayerInfo=function(a,b){return b?(b.init(a),b):new f(a)},f}()})},"esri/views/3d/terrain/TileAgentBase":function(){define(["require","exports","./UpsampleInfo","./tileUtils"],function(m,l,h,d){function b(d,a,e,c,k,l,m){return!d.parent||m>g?null:(c*=.5,k*=.5,l*=.5,1&d.lij[2]&&(k+=.5),0===(1&d.lij[1])&&(l+=.5),d.parent.hasLayerData(a,e))?(a=h.Pool.acquire(),
a.init(d.parent,k,l,c),a):b(d.parent,a,e,c,k,l,m+1)}var g=6,k=Error("Abstract method called on TileAgentBase");return function(){function f(){}return f.prototype.init=function(a,b,c,d){this.tile=a;this.layerIdx=b;this.layerClass=c;this.suspended=d;this._tileLayerInfo=a.getLayerInfo(b,c);this._dataRequested=null;a=this._findAncestorWithData();return a?(this._setUpsamplingTile(a.tile),h.Pool.release(a)):(this._tileLayerInfo.upsampleFromTile&&h.Pool.release(this._tileLayerInfo.upsampleFromTile),this._tileLayerInfo.upsampleFromTile=
null),this._requestNext(!0)},f.prototype.dispose=function(){this._dataRequested&&(this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this),this._dataRequested=null);this._tileLayerInfo=this.tile=null},f.prototype.setSuspension=function(a){a!==this.suspended&&(this.suspended=a,a?this._dataRequested&&(this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this),this._dataRequested=null):this._tileLayerInfo.data||this.update())},f.prototype.update=function(){var a=this._findAncestorWithData();
return a&&this._tileLayerInfo.upsampleFromTile&&a.tile!==this._tileLayerInfo.upsampleFromTile.tile?this._setUpsamplingTile(a.tile):a&&h.Pool.release(a),this._requestNext()},f.prototype.dataArrived=function(a){throw k;},f.prototype.dataMissing=function(a){this._dataRequested=null;this._tileLayerInfo.disposeData();this._requestNext()},f.prototype._agentDone=function(){this.tile.agentDone(this.layerIdx,this.layerClass);this.dispose()},f.prototype._requestNext=function(a){if(void 0===a&&(a=!1),this.suspended)return!0;
var b=this._findNextDownload();if(this._dataRequested){if(b===this._dataRequested)return!0;this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this);this._dataRequested=null}b?b.requestLayerData(this.layerIdx,this.layerClass,this)&&(this._dataRequested=b):a||this._agentDone();return!!this._dataRequested},f.prototype._findNextDownload=function(){for(var a,b=this.layerIdx,c=this.layerClass,g=this.tile.parentSurface.layerViewByIndex(b,c),h=g.minDataLevel,k=g.maxDataLevel,l=this._desiredMinLevelDelta(),
m=f.START_LOADING_LEVEL_DELTA+l,x=this._scaleRangeEnabled,y=this.tile,n=0,w=y.lij[0],z=this._tileLayerInfo.upsampleFromTile?this._tileLayerInfo.upsampleFromTile.tile.lij[0]:-1,C=this.tile.parentSurface,B=C.tilemapStats,F=C.getTilemapTile(y),G=!1;y&&(!x||d.fallsWithinLayer(y,g.layer,!1))&&y.lij[0]>=h;){var N=y.layerInfo[c][b];if(N.data&&n>=l){y.lij[0]>z&&this._setUpsamplingTile(y);N.dataInvalidated&&(a=y);break}if(F&&!F.tileDataAvailable(y,b,c))G=!0;else if(y.lij[0]<=k&&!N.data&&!N.dataMissing&&(a=
y,n>=m))break;(y=y.parent)&&F&&(F=F.parent||C.getTilemapTile(y));n++}return a&&w-a.lij[0]<l&&this._tileLayerInfo.upsampleFromTile&&(a=null),!a&&G&&B.tilesNotPresent++,a},f.prototype._findAncestorWithData=function(){return b(this.tile,this.layerIdx,this.layerClass,1,0,0,0)},f.prototype._desiredMinLevelDelta=function(){throw k;},f.prototype._setUpsamplingTile=function(a){throw k;},f.prototype._unsetUpsamplingTile=function(){this._tileLayerInfo.upsampleFromTile&&h.Pool.release(this._tileLayerInfo.upsampleFromTile);
this._tileLayerInfo.upsampleFromTile=null},f.START_LOADING_LEVEL_DELTA=4,f.AGENT_DONE=new f,f}()})},"esri/views/3d/terrain/ElevationTileAgent":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/ObjectPool ./TerrainConst ./TileAgentBase ./UpsampleInfo".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;return a._scaleRangeEnabled=!1,a}return h(a,f),a.prototype.dataArrived=function(a){a!==this.tile?this._setUpsamplingTile(a):
(this._unsetUpsamplingTile(),this.updateGeometry());this._dataRequested=null;this._requestNext()},a.prototype.updateGeometry=function(){this._tileLayerInfo.pendingUpdates|=b.TileUpdateTypes.UPDATE_GEOMETRY;this.tile.updateGeometry()},a.prototype._findAncestorWithData=function(){for(var a,c=this.layerClass,d=this.layerIdx,f=this.tile,g=f.vlevel;f&&!(f.layerInfo[c][d].data&&(a=f,g-f.lij[0]>=b.ELEVATION_DESIRED_RESOLUTION_LEVEL));)f=f.parent;return a?(c=k.Pool.acquire(),c.init(a,0,0,1),c):null},a.prototype._desiredMinLevelDelta=
function(){return b.ELEVATION_DESIRED_RESOLUTION_LEVEL-(this.tile.vlevel-this.tile.lij[0])},a.prototype._setUpsamplingTile=function(a){this._unsetUpsamplingTile();var b=k.Pool.acquire();b.init(a,0,0,1);this._tileLayerInfo.upsampleFromTile=b;this.updateGeometry()},a.Pool=new d(a),a}(g)})},"esri/views/3d/terrain/MapTileAgent":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/ObjectPool ./TileAgentBase ./tileUtils".split(" "),function(m,l,h,d,b,g){return function(b){function f(){var a=
b.call(this)||this;return a._scaleRangeEnabled=!0,a}return h(f,b),f.prototype.dataArrived=function(a){a!==this.tile?this._setUpsamplingTile(a):(this._unsetUpsamplingTile(),this.tile.updateTexture());this._dataRequested=null;a!==this.tile&&this._requestNext()},f.prototype._desiredMinLevelDelta=function(){return 0},f.prototype._setUpsamplingTile=function(a){this._tileLayerInfo.upsampleFromTile&&this._tileLayerInfo.upsampleFromTile.tile===a||(this._unsetUpsamplingTile(),this._tileLayerInfo.upsampleFromTile=
g.computeUpsampleInfoForAncestor(this.tile,a),this.tile.updateTexture())},f.Pool=new d(f),f}(b)})},"esri/views/3d/terrain/TileGeometryFactory":function(){define("../webgl-engine/lib/Geometry ../webgl-engine/lib/GeometryData ../lib/glMatrix ../support/earthUtils ../support/mathUtils ./TerrainConst".split(" "),function(m,l,h,d,b,g){function k(a,b,c,e,d){a<e[0]&&(e[0]=a);a>d[0]&&(d[0]=a);b<e[1]&&(e[1]=b);b>d[1]&&(d[1]=b);c<e[2]&&(e[2]=c);c>d[2]&&(d[2]=c)}function f(a,c,e){for(var d=0;d<e.length;d++){var f=
e[d];if(f){var h=f.safeWidth,k=f.width,l=f.pixelData,n=b.clamp(f.dy*(f.y1-c),0,h),f=b.clamp(f.dx*(a-f.x0),0,h),h=Math.floor(n),q=Math.floor(f),m=h*k+q,r=m+k,t=l[m],k=l[r],m=l[m+1],l=l[r+1];if(t+k+m+l<.5*g.ELEVATION_NODATA_VALUE)return n-=h,f-=q,a=t+(m-t)*f,a+(k+(l-k)*f-a)*n}}return null}var a=d.earthRadius,e=h.vec3d,c=b.lerp,q=function(){var a,b,c,d=e.create(),f=e.create(),g=e.create();this.init=function(h,k){b=h;c=k;e.subtract(g,f,d);a=.5*e.length(d);e.lerp(f,g,.5,d)};this.getCenter=function(){return d};
this.getBSRadius=function(){return a};this.getBBMin=function(){return f};this.getBBMax=function(){return g};this.getPosition=function(){return b};this.getIndices=function(){return c};this.getPrimitiveIndices=function(){};this.getChildren=function(){}},t=function(b,c,e,d){b*=a;for(var f=0;c>=f;f++)e[5*d]=0,e[5*d+1]=0,e[5*d+2]=b,d++},r=new function(){var a=Array(50),b=0,c={};this.get=function(d){var f=c[d];f||(f={ptr:0,data:Array(50)},c[d]=f);var g;if(0<f.ptr?(e.vertexArrayHits++,g=f.data[--f.ptr],
f.data[f.ptr]=null):(e.vertexArrayMisses++,g=new Float32Array(d)),0<b)return e.geometryHits++,d=a[--b],a[b]=null,d.getData().getVertexAttr().terrain.data=g,d;e.geometryMisses++;d={};d.terrain={size:5,data:g};g=new q;return new m(new l(d,{terrain:null}),"tile",g)};this.put=function(e){var d=e.getData(),f=d.getVertexAttr(),g=f.terrain.data,h=c[g.length];50>h.ptr&&(h.data[h.ptr++]=g);f.terrain.data=null;d.indices.terrain=null;50>b&&(a[b++]=e)};var e={geometryHits:0,geometryMisses:0,vertexArrayHits:0,
vertexArrayMisses:0};this.stats=e;this._pools={geometry:a,vertexArray:c}},u=[],v=Array(g.MAX_TILE_TESSELATION+1),x=Array(g.MAX_TILE_TESSELATION+1),y=Array(g.MAX_TILE_TESSELATION+1),n=Array(g.MAX_TILE_TESSELATION+1),w={values:null,numSurfaceIndices:0,numSkirtIndices:0},z=function(a,b,c){return c||(a.values=b.values),a.numSurfaceIndices=b.numSurfaceIndices,a.numSkirtIndices=b.numSkirtIndices,a},C=function(a,b,c,e,d){var f;f=w;var g=2&c,h=b+(e?1024:0)+(g?2048:0),k=u[h];if(f||(f={}),k)f=(z(f,k),f);else{var l,
k=b-1,n=b-1,q=b*b;l=2*k+2*n;var m=k*n*6,r=6*l,t=6*(2*k+n-1);e&&(m*=2,r*=2,t*=2);l=65536<q+l?new Uint32Array(m+r):new Uint16Array(m+r);for(var p,v,x,y,C=0,F=0,B=m,G=0,N=0;n>=N;N++){g&&(G=0===N?t:N===n?-t:0);for(var B=B+G,M=0;k>=M;M++){var ea=-1,ja=-1;if(0===N&&(ea=q+M,M!==k&&(ja=C+1)),M===k&&(ea=q+k+N,n>N&&(ja=C+k+1)),N===n&&(ea=q+k+n+(k-M),0<M&&(ja=C-1)),0===M&&0<N&&(ea=q+2*k+n+(n-N),ja=C-(k+1)),-1<ea){var na=0===M&&1===N?q:ea+1;-1<ja&&(p=C,v=ea,x=na,y=ja,e?(l[B+0]=p,l[B+1]=v,l[B+2]=v,l[B+3]=x,l[B+
4]=x,l[B+5]=p,l[B+6]=x,l[B+7]=y,l[B+8]=y,l[B+9]=p,l[B+10]=p,l[B+11]=x,B+=12):(l[B+0]=p,l[B+1]=v,l[B+2]=x,l[B+3]=x,l[B+4]=y,l[B+5]=p,B+=6))}++C;k>M&&n>N&&(p=N*(k+1)+M,v=p+1,x=v+(k+1),y=x-1,e?(l[F+0]=p,l[F+1]=v,l[F+2]=v,l[F+3]=x,l[F+4]=x,l[F+5]=p,l[F+6]=x,l[F+7]=y,l[F+8]=y,l[F+9]=p,l[F+10]=p,l[F+11]=x,F+=12):(l[F+0]=p,l[F+1]=v,l[F+2]=x,l[F+3]=x,l[F+4]=y,l[F+5]=p,F+=6))}B-=G}f=(f.values=l,f.numSurfaceIndices=m,f.numSkirtIndices=r,u[h]=z({},f),f)}g=a.getData();h=g.getAttribute("terrain");return g.indices.terrain=
f.values,a.getBoundingInfo().init(h,f.values),d||(d={}),d.geometry=a,d.numWithoutSkirtIndices=f.numSurfaceIndices+(c?6*(b-1)*(e?2:1):0),d.numVertsPerRow=b,z(d,f,!0)};return{createPlanarGlobeTile:function(a,b,c,d,g,h,l){var n,q,m=b[0],t=b[1],u=b[2]-m;b=b[3]-t;var w=.1*u,v=a-1,x=a-1,p=a*a,y=r.get(5*(p+(2*v+2*x))),z=y.getData().getVertexAttr().terrain.data,B=0;n=y.getBoundingInfo();var F=n.getBBMin(),G=n.getBBMax();e.set3(1E7,1E7,1E7,F);e.set3(-1E7,-1E7,-1E7,G);for(q=0;x>=q;q++){var N=q/x,P=t+N*b;h&&
(P<h[1]?(P=h[1],N=(P-t)/b):P>h[3]&&(P=h[3],N=(P-t)/b));for(n=0;v>=n;n++){var M=n/v,R=m+M*u;h&&(R<h[0]?(R=h[0],M=(R-m)/u):R>h[2]&&(R=h[2],M=(R-m)/u));var ea=c?f(R,P,c)||0:0,R=R-d[0],ja=P-d[1],ea=ea-d[2];k(R,ja,ea,F,G);z[5*B]=R;z[5*B+1]=ja;z[5*B+2]=ea;z[5*B+3]=M;z[5*B+4]=N;var na=-1;0===q&&(na=p+n);n===v&&(na=p+v+q);q===x&&(na=p+v+x+(v-n));0===n&&0<q&&(na=p+2*v+x+(x-q));-1<na&&(z[5*na]=R,z[5*na+1]=ja,z[5*na+2]=ea-w,z[5*na+3]=M,z[5*na+4]=N,k(R,ja,ea-w,F,G));++B}}return C(y,a,0,g,l)},createSphericalGlobeTile:function(b,
d,g,h,l,q,m,u,w){var z=g[0],B=g[1],F=g[2],G=g[3],N=Math.max(.9,1-.5*(F-z));g=b-1;var E=b-1,p=b*b,A=r.get(5*(p+(2*g+2*E))),K=A.getData().getVertexAttr().terrain.data,P=d[2]-d[0],M=d[3]-d[1],R=F-z,F=q[0],Q=q[1];q=q[2];var T=A.getBoundingInfo(),ha=T.getBBMin(),T=T.getBBMax();e.set3(1E7,1E7,1E7,ha);e.set3(-1E7,-1E7,-1E7,T);var ca;for(ca=0;g>=ca;ca++){var ea=ca/g,ja=z+ea*R;v[ca]=Math.sin(ja);x[ca]=Math.cos(ja);y[ca]=ea;n[ca]=d[0]+ea*P}for(z=P=0;E>=z;z++){var na,R=z/E;ca=c(B,G,R);var ja=Math.cos(ca),za=
Math.sin(ca);h?(na=a/2*Math.log((1+za)/(1-za)),R=(na-d[1])/M):na=180*ca/Math.PI;for(ca=0;g>=ca;ca++){var ea=y[ca],ua=v[ca],wa=x[ca],da=a;l&&(da+=f(n[ca],na,l)||0);var wa=wa*ja*da,ua=ua*ja*da,da=za*da,ra=wa-F,ga=ua-Q,pa=da-q;k(ra,ga,pa,ha,T);var J=5*P;K[J+0]=ra;K[J+1]=ga;K[J+2]=pa;K[J+3]=ea;K[J+4]=R;J=-1;if(0===z&&(J=p+ca),ca===g&&(J=p+g+z),z===E&&(J=p+g+E+(g-ca)),0===ca&&0<z&&(J=p+2*g+E+(E-z)),-1<J)wa=wa*N-F,ua=ua*N-Q,da=da*N-q,k(wa,ua,da,ha,T),J*=5,K[J+0]=wa,K[J+1]=ua,K[J+2]=da,K[J+3]=ea,K[J+4]=
R;++P}}h&&(d=!!(2&m),1&m&&t(-1,g,K,p),d&&t(1,g,K,p+g+E));return C(A,b,h?m:0,u,w)},releaseGeometry:r.put,elevationSampler:f,_geometryObjectPool:r}})},"esri/views/3d/webgl-engine/lib/Geometry":function(){define("require exports ./IdGen ./Util ./BoundingInfo ./ComponentUtils ./Util".split(" "),function(m,l,h,d,b,g,k){return function(){function f(a,b,c){this.singleUse=!1;this.componentAABB=null;this.id=f.__idGen.gen(b);this.data=a;this.boundingInfo=c}return f.prototype.getId=function(){return this.id},
f.prototype.getData=function(){return this.data},f.prototype.getComponentCount=function(){return g.componentCount(this.data.componentOffsets)},f.prototype.getComponentAABB=function(a,b){null==this.componentAABB&&(this.componentAABB=this._computeComponentAABB());for(var c=0;6>c;c++)b[c]=this.componentAABB[6*a+c];return b},f.prototype._computeComponentAABB=function(){for(var a=this.getComponentCount(),b=new Float32Array(6*a),c=0;a>c;c++)this._calculateAABB(c,b,6*c);return b},f.prototype._calculateAABB=
function(a,b,c){void 0===c&&(c=0);var e=this.data.getIndices(k.VertexAttrConstants.POSITION),d=this.data.getAttribute(k.VertexAttrConstants.POSITION),f=this.data.componentOffsets,g=f.length?f[a+1]:e.length,h=1/0,l=1/0,m=1/0,n=-(1/0),w=-(1/0),z=-(1/0),C=d.offsetIdx,B=d.strideIdx;for(a=f.length?f[a]:0;g>a;a++)var F=C+B*e[a],f=d.data[F],G=d.data[F+1],F=d.data[F+2],h=Math.min(h,f),l=Math.min(l,G),m=Math.min(m,F),n=Math.max(n,f),w=Math.max(w,G),z=Math.max(z,F);return b?(b[c]=h,b[c+1]=l,b[c+2]=m,b[c+3]=
n,b[c+4]=w,b[c+5]=z):b=[h,l,m,n,w,z],b},f.prototype.calculateBoundingInfo=function(){var a=this.data.getIndices(k.VertexAttrConstants.POSITION),e=this.data.getAttribute(k.VertexAttrConstants.POSITION),c="triangle"===this.data.primitiveType?3:1;if(0===a.length)for(var a=new Uint32Array(c),f=0;c>f;++f)a[f]=f;f=a.length;d.assert(0===f%c);for(var g=f/c,h=new Uint32Array(g),f=0;g>f;++f)h[f]=f;return new b(h,c,a,e)},f.prototype.getBoundingInfo=function(){return null==this.boundingInfo&&(this.boundingInfo=
this.calculateBoundingInfo()),this.boundingInfo},f.prototype.invalidateBoundingInfo=function(){this.boundingInfo=null},f.__idGen=new h,f}()})},"esri/views/3d/webgl-engine/lib/BoundingInfo":function(){define(["require","exports","./Util","./gl-matrix"],function(m,l,h,d){var b=d.vec3d;return function(){function d(d,f,a,e){h.assert(1<=d.length);h.assert(0===a.length%f);h.assert(a.length>=d.length*f);h.assert(3===e.size||4===e.size);this.primitiveIndices=d;this.indices=a;this._position=e;this._numIndexPerPrimitive=
f;var c=e.data,g=e.offsetIdx;e=e.strideIdx;var k=d.length,l=g+e*a[f*d[0]];this.bbMin=b.createFrom(c[l],c[l+1],c[l+2]);this.bbMax=b.create(this.bbMin);for(var m=0;k>m;++m)for(var v=f*d[m],x=0;f>x;++x)for(var l=g+e*a[v+x],y=0;3>y;++y){var n=c[l+y];n<this.bbMin[y]?this.bbMin[y]=n:n>this.bbMax[y]&&(this.bbMax[y]=n)}this.center=b.create();b.lerp(this.bbMin,this.bbMax,.5,this.center);for(m=this.bsRadius=0;k>m;++m)for(v=f*d[m],x=0;f>x;++x)l=g+e*a[v+x],y=c[l]-this.center[0],n=c[l+1]-this.center[1],l=c[l+
2]-this.center[2],l=y*y+n*n+l*l,l>this.bsRadius&&(this.bsRadius=l);this.bsRadius=Math.sqrt(this.bsRadius)}return d.prototype.getCenter=function(){return this.center},d.prototype.getBSRadius=function(){return this.bsRadius},d.prototype.getBBMin=function(){return this.bbMin},d.prototype.getBBMax=function(){return this.bbMax},d.prototype.getPrimitiveIndices=function(){return this.primitiveIndices},d.prototype.getIndices=function(){return this.indices},d.prototype.getPosition=function(){return this._position},
d.prototype.getChildren=function(){if(this.children)return this.children;if(1<b.dist2(this.bbMin,this.bbMax)){for(var g=b.lerp(this.bbMin,this.bbMax,.5,b.create()),f=this.primitiveIndices.length,a=new Uint8Array(f),e=Array(8),c=0;8>c;++c)e[c]=0;for(var c=this._position,h=c.data,l=c.offsetIdx,m=c.strideIdx,c=0;f>c;++c){for(var u=0,v=this._numIndexPerPrimitive*this.primitiveIndices[c],x=l+m*this.indices[v],y=h[x],n=h[x+1],w=h[x+2],z=1;z<this._numIndexPerPrimitive;++z){var x=l+m*this.indices[v+z],C=
h[x],B=h[x+1],x=h[x+2];y>C&&(y=C);n>B&&(n=B);w>x&&(w=x)}y<g[0]&&(u|=1);n<g[1]&&(u|=2);w<g[2]&&(u|=4);a[c]=u;++e[u]}for(c=g=0;8>c;++c)0<e[c]&&++g;if(2>g)return;g=Array(8);for(c=0;8>c;++c)g[c]=0<e[c]?new Uint32Array(e[c]):void 0;for(c=0;8>c;++c)e[c]=0;for(c=0;f>c;++c)u=a[c],g[u][e[u]++]=this.primitiveIndices[c];this.children=Array(8);for(c=0;8>c;++c)void 0!==g[c]&&(this.children[c]=new d(g[c],this._numIndexPerPrimitive,this.indices,this._position))}return this.children},d}()})},"esri/views/3d/terrain/SphericalTile":function(){define("./TileBase ./TileGeometryFactory ../../../core/ObjectPool ../support/mathUtils ../support/earthUtils ../lib/glMatrix".split(" "),
function(m,l,h,d,b,g){var k=g.vec3d,f=b.earthRadius,a=function(a,b,d,g){d=f+d;var c=Math.cos(a);g[0]=Math.cos(b)*c*d;g[1]=Math.sin(b)*c*d;g[2]=Math.sin(a)*d};b=function(a,b,d,f){m.call(this);this.tileUp=k.create();this.obb=Array(8);this._isWebMercator=!1;for(var c=0;8>c;c++)this.obb[c]=k.create();void 0!==a&&this.init(a,b,d,f)};return b.prototype=new m,b.prototype.constructor=b,b.prototype.init=function(b,c,g,h){m.prototype.init.call(this,b,c,g,h);this._isWebMercator=h.spatialReference.isWebMercator;
c=this.extentWGS84Rad[0];g=this.extentWGS84Rad[1];h=this.extentWGS84Rad[2];var e=this.extentWGS84Rad[3];b=b[0];var l=d.lerp(g,e,.5),q=d.lerp(c,h,.5);this.edgeLen=(h-c)*Math.cos(0===b?0:Math.min(Math.abs(g),Math.abs(e)))*f;this.curvatureHeight=f-Math.sqrt(f*f-this.edgeLen*this.edgeLen/4);a(l,q,0,this.centerAtSeaLevel);k.set(this.centerAtSeaLevel,this.tileUp);k.normalize(this.tileUp);this._updateOBB();this.updateRadiusAndCenter()},b.prototype.isVisible=function(a,b){if(!this.intersectsClippingArea)return!1;
if(9<this.lij[0]){b=this.obb;for(var c=0;6>c;c++){for(var d=0;8>d&&!(0>a[c][0]*b[d][0]+a[c][1]*b[d][1]+a[c][2]*b[d][2]+a[c][3]);d++);if(8===d)return!1}}else if(b=this.radius,c=this.center,a[0][0]*c[0]+a[0][1]*c[1]+a[0][2]*c[2]+a[0][3]>b||a[1][0]*c[0]+a[1][1]*c[1]+a[1][2]*c[2]+a[1][3]>b||a[2][0]*c[0]+a[2][1]*c[1]+a[2][2]*c[2]+a[2][3]>b||a[3][0]*c[0]+a[3][1]*c[1]+a[3][2]*c[2]+a[3][3]>b||a[4][0]*c[0]+a[4][1]*c[1]+a[4][2]*c[2]+a[4][3]>b||a[5][0]*c[0]+a[5][1]*c[1]+a[5][2]*c[2]+a[5][3]>b)return!1;return!0},
b.prototype.computeElevationBounds=function(){m.prototype.computeElevationBounds.call(this);this._updateOBB()},b.prototype.updateRadiusAndCenter=function(){if(0===this.lij[0])k.set3(0,0,0,this.center),this.radius=f+this.elevationBounds[1];else{m.prototype.updateRadiusAndCenter.call(this);var a=Math.max(k.dist2(this.center,this.obb[0]),k.dist2(this.center,this.obb[1]));this.radius=Math.sqrt(a)}},b.prototype._numSubdivisionsAtLevel=[128,64,32,16,16,8,8,4],b.prototype.createGeometry=function(a,b,d){var c=
this._isPole(this.lij[1],this.lij[0]);return a.needsUpdate=!1,l.createSphericalGlobeTile(a.numVertsPerRow,this.extent,this.extentWGS84Rad,this._isWebMercator,a.samplerData,b,c,d)},b.prototype._updateOBB=function(){var b,c=this.extentWGS84Rad,d=this.obb;for(b=0;2>b;b++){var g=this.elevationBounds[b],h=4*b;a(c[1],c[0],g,d[h++]);a(c[3],c[0],g,d[h++]);a(c[3],c[2],g,d[h++]);a(c[1],c[2],g,d[h++])}this._isWebMercator&&(b=this._isPole(this.lij[1],this.lij[0]),2===b?(k.set3(0,0,f,d[1]),k.set3(0,0,f,d[2]),
k.set3(0,0,f,d[5]),k.set3(0,0,f,d[6])):1===b&&(k.set3(0,0,-f,d[0]),k.set3(0,0,-f,d[3]),k.set3(0,0,-f,d[4]),k.set3(0,0,-f,d[7])))},b.prototype._isPole=function(a,b){var c=0;return a===(1<<b)-1&&(c+=1),0===a&&(c+=2),c},b.Pool=new h(b),b})},"esri/views/3d/terrain/SurfaceExtentHelper":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/arrayUtils ../../../core/HandleRegistry ../../../geometry/support/webMercatorUtils ../../../views/3d/support/aaBoundingRect ./terrainUtils ./TerrainConst".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){function t(b,c){return b&&!b.spatialReference.equals(c)&&(b=a.canProject(b.spatialReference,c)?a.project(b,c):null),b}Object.defineProperty(l,"__esModule",{value:!0});m=function(a){function c(b){b=a.call(this,b)||this;return b._changeListeners=new f,b}return h(c,a),c.prototype.initialize=function(){var a=this;this._changeListeners.add([this.layerViews.on("change",function(){return a.notifyChange("stencilEnabledExtents")})])},c.prototype.destroy=function(){this._changeListeners.destroy();
this._changeListeners=null},Object.defineProperty(c.prototype,"layerViewsExtent",{get:function(){return this._computeLayerViewsExtent()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"tiledLayersExtent",{get:function(){return this._computeTiledLayersExtent()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"stencilEnabledExtents",{get:function(){return this._computeStencilEnabledExtents(this.layerViews,this.spatialReference)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,
"spatialReference",{set:function(a){this.tilingScheme||this._set("spatialReference",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"tilingScheme",{set:function(a){this._set("tilingScheme",a);this._set("spatialReference",a.spatialReference)},enumerable:!0,configurable:!0}),c.prototype._computeStencilEnabledExtents=function(a,b){var c=[],d=0;for(a=a.items;d<a.length;d++){var e=a[d].layer;"IntegratedMeshLayer"===e.operationalLayerType&&null!=b&&(e=t(e.fullExtent,b),null!=e&&c.push([e.xmin,
e.ymin,e.xmax,e.ymax]))}return c},d([b.property({readOnly:!0})],c.prototype,"layerViewsExtent",null),d([b.property({readOnly:!0,dependsOn:["spatialReference","tilingScheme"]})],c.prototype,"tiledLayersExtent",null),d([b.property({readOnly:!0,dependsOn:["spatialReference"]})],c.prototype,"stencilEnabledExtents",null),d([b.property()],c.prototype,"spatialReference",null),d([b.property()],c.prototype,"tilingScheme",null),d([b.property()],c.prototype,"defaultTiledLayersExtent",void 0),d([b.property({constructOnly:!0})],
c.prototype,"layers",void 0),d([b.property({constructOnly:!0})],c.prototype,"layerViews",void 0),c=d([b.subclass()],c)}(b.declared(g));g=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return h(c,a),c.prototype._computeLayerViewsExtent=function(){return this._getGlobalExtent()},c.prototype._computeTiledLayersExtent=function(){return this._getGlobalExtent()},c.prototype._getGlobalExtent=function(){return this.spatialReference.isWebMercator?q.WEBMERCATOR_WORLD_EXTENT:q.GEOGRAPHIC_WORLD_EXTENT},
d([b.property({dependsOn:["spatialReference"]})],c.prototype,"layerViewsExtent",void 0),c=d([b.subclass()],c)}(b.declared(m));l.SurfaceExtentHelperGlobal=g;m=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}return h(f,a),f.prototype.initialize=function(){var a=this;this._changeListeners.add([this.layers.on("change",function(){return a.notifyChange("tiledLayersExtent")}),this.layerViews.on("change",function(){return a.notifyChange("layerViewsExtent")})])},f.prototype._computeLayerViewsExtent=
function(){var a=e.create(e.NEGATIVE_INFINITY),b=this.spatialReference;this.layerViews.forEach(function(c){c.isResolved()&&(c=c.fullExtentInViewSpatialReference||c.layer.fullExtent,(c=t(c,b))&&e.expand(a,c))});var c=e.allFinite(a)?a:null,d=this._get("layerViewsExtent");return k.equals(c,d)?d:c},f.prototype._computeTiledLayersExtent=function(){var a=this.tilingScheme;if(!a)return null;var b=this.spatialReference,d=e.create(e.NEGATIVE_INFINITY);this.layers.forEach(function(f){if(f.loaded&&c.isTiledLayer(f)){var g=
c.getTiledLayerInfo(f,b,"local");f=g.tileInfo;g=g.fullExtent;f&&a.compatibleWith(f)&&g&&g.spatialReference.equals(b)&&e.expand(d,g)}});this.defaultTiledLayersExtent&&e.expand(d,this.defaultTiledLayersExtent);var f=e.allFinite(d)?d:null,g=this._get("tiledLayersExtent");return k.equals(f,g)?g:f},f=d([b.subclass()],f)}(b.declared(m));l.SurfaceExtentHelperLocal=m})},"esri/views/3d/terrain/SurfaceTilingSchemeLogic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/HandleRegistry ./terrainUtils ./TilingScheme".split(" "),
function(m,l,h,d,b,g,k,f,a){return function(e){function c(a){a=e.call(this,a)||this;return a._changeHandles=new k,a}return h(c,e),c.prototype.initialize=function(){var a=this;this._changeHandles.add(this.layers.on("change",function(){return a._update()}));this._changeHandles.add(this.extentHelper.watch("layerViewsExtent",function(){return a._setAdHocTilingScheme()}));this._update();this.tilingSchemeLocked||this._setAdHocTilingScheme()},c.prototype.destroy=function(){this._changeHandles.destroy();
this._changeHandles=null},c.prototype._update=function(){var b=this;if(this._waitTask=null,!this.tilingSchemeLocked){this._set("tilingSchemeDone",!1);var c=this.layers.find(function(a){return f.isTiledLayer(a)?a.isFulfilled()?a.isRejected()?!1:!!f.getTiledLayerInfo(a,b.viewSpatialReference,b.manifold).tileInfo:!0:!1});if(c)if(c.isResolved()){var d=f.getTiledLayerInfo(c,this.viewSpatialReference,this.manifold).tileInfo,d=new a(d),c=f.getKnownTiledServiceLevelCap(c.url);1/0>c&&d.capMaxLod(c);this._set("tilingSchemeDone",
!0);this._lockTilingScheme(d)}else this._updateWhen(c);else this._set("tilingSchemeDone",!0)}},c.prototype._updateWhen=function(a){var b=this,c=a.when().always(function(){c===b._waitTask&&b._update()});this._waitTask=c},c.prototype._lockTilingScheme=function(b){var c=this;if("spherical"===this.manifold){var d=b.levels.length-1;b=b.spatialReference.isWebMercator?a.makeWebMercatorAuxiliarySphere(d):a.makeWGS84WithTileSize(b.pixelSize[0],d)}this.tilingSchemeLocked=!0;this.tilingScheme=b;this.extentHelper.tilingScheme=
this.tilingScheme;this._updateTiledLayerExtent();this._changeHandles.removeAll();this._changeHandles.add(this.extentHelper.watch("tiledLayersExtent",function(){return c._updateTiledLayerExtent()}))},c.prototype._updateTiledLayerExtent=function(){this.extent=this.extentHelper.tiledLayersExtent},c.prototype._setAdHocTilingScheme=function(){if("spherical"===this.manifold)this.tilingScheme=this.extentHelper.spatialReference.isWebMercator?a.WebMercatorAuxiliarySphere:a.makeWGS84WithTileSize(256),this.extent=
this.extentHelper.layerViewsExtent;else{var b=this.extentHelper.layerViewsExtent;b&&(this.tilingScheme=a.fromExtent(b,this.extentHelper.spatialReference),this.extent=b)}},d([b.property()],c.prototype,"tilingScheme",void 0),d([b.property()],c.prototype,"extent",void 0),d([b.property({value:!1})],c.prototype,"tilingSchemeLocked",void 0),d([b.property({readOnly:!0,value:!1})],c.prototype,"tilingSchemeDone",void 0),d([b.property({constructOnly:!0})],c.prototype,"viewSpatialReference",void 0),d([b.property({constructOnly:!0})],
c.prototype,"layers",void 0),d([b.property({constructOnly:!0})],c.prototype,"extentHelper",void 0),d([b.property({constructOnly:!0})],c.prototype,"manifold",void 0),c=d([b.subclass()],c)}(b.declared(g))})},"esri/views/3d/terrain/TerrainRenderer":function(){define("dojo/when ./tileUtils ./TerrainConst ./TileGeometryFactory ./TileRenderData ./ResourceCounter ./TileRenderer ../support/PreallocArray ../../../core/ObjectPool ../../../core/promiseUtils ../support/imageUtils ../webgl-engine/lib/ShaderVariations dojo/text!./TerrainMaterial.xml ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/lib/Util ../lib/glMatrix ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/tracer ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations ../webgl-engine/lib/DefaultVertexBufferLayouts ../webgl-engine/lib/screenSizePerspectiveUtils ../../webgl/Util".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M){var R=u.assert;u=v.vec2d;var P=v.vec3d,Q=v.vec4d,T=v.mat4d.identity(),O=[2,2],S=y.OPAQUE_TERRAIN,H=y.TRANSPARENT_TERRAIN,Y=P.create(),W=u.create();v=function(u,p,v){function y(a,b){a=a.screenDepth;b=b.screenDepth;return b>a?-sa:a>b?sa:0}function A(a,b){return 0===a.tiles.length?-sa:0===b.tiles.length?sa:y(a.tiles.data[0],b.tiles.data[0])}p=p||256;var E,X,ba,fa=!1,ha=null,ca=null,ea=null,ja={},na=new a(b),za=new f(10,function(){return{root:null,
tiles:new f(300)}}),ua=!0,wa=new l.IteratorPreorder,da=null,ra=!0,ga=1,pa=!0,J=!1,D={mode:"none",width:1.5,falloff:1.5,wireOpacity:1,surfaceOpacity:0,color:[1,1,1,0],resolution:64},Ea=!1,L=!1,Fa=!1,sa=1,Z=!0,ma=!0,Pa=null,Ia=null,Ha=null,Xa=!1,oa=[];this.updateTileBackground=function(a){return Ha&&Ha.cancel(),Ha=a?c.requestImage(a).otherwise(function(){return null}):e.resolve(null),this.renderTileBackground(),Ha};var Ma=0,Ka=0,va=0,Wa=0;this.resourceCounter=new g;this.castShadows=!0;this.clippingExtent=
null;this.loaded=function(){};var Za=!1;this.needsRender=!0;this.receiveShadows=this.needsHighlight=this.didRender=!1;var Ba=new f(10),Va=0,ka=new f(30),Ga=new a(function(){this.extent=Q.create();this.maxLevel=this.minLevel=0;this.callback=null},!1);this.renderTileBackground=function(){return X&&Ha&&Ia?Ha.then(function(a){Ia&&(Xa=!0,Ia.setGridImage(a),ha&&l.traverseTilesPreorder(ha,function(a){Ia.updateTileTexture(a)}.bind(this)))}.bind(this)):void 0};this.initializeRenderContext=function(a){X=a.rctx;
ba=a.rctx.gl;var b=function(a){m(a).then(function(){fa=!0;this.setNeedsRender()}.bind(this)).otherwise(b)}.bind(this);b(this.renderTileBackground());E=a.textureRep;var c=a.shaderSnippets,d=a.shaderRep;a=a.programRep;c.vsTerrain||c._parse(t);X.extensions.standardDerivatives;var e=new q("terrain",["vsTerrain","fsTerrain"],null,a,d,c,X);e.addDefine("Spherical","SPHERICAL");e.addDefine("Overlay","OVERLAY");e.addDefine("Atmosphere","ATMOSPHERE");e.addDefine("Wireframe","WIREFRAME");e.addDefine("TileBorders",
"TILE_BORDERS");e.addBinaryShaderSnippetSuffix("Wireframe","Wireframe",[!1,!0]);e.addDefine("ReceiveShadows","RECEIVE_SHADOWS");e.addDefine("ScreenSizePerspective","SCREEN_SIZE_PERSPECTIVE");d=new q("terrainNormal",["vsTerrainNormal","fsNormal"],null,a,d,c,X);d.addDefine("Spherical","SPHERICAL");d.addDefine("AlphaZero","ALPHA_ZERO");ea={depth:a.get("depth"),depthShadowMap:a.get("depthShadowMap"),depthOnly:new B(X,c.vsTerrainDepthOnly,c.fsTerrainDepthOnly,F.Default3D),highlight:new B(X,c.vsTerrainHighlight,
c.fsTerrainHighlight,F.Default3D)};ca={color:e,normal:d};this._updatePrograms();Ia=new k(X,p,a,this.resourceCounter,this.setNeedsRender.bind(this));this.renderTileBackground();Pa=new w(X,{target:ba.TEXTURE_2D,pixelFormat:ba.RGBA,dataType:ba.UNSIGNED_BYTE,samplingMode:ba.NEAREST,width:4,height:4})};this.uninitializeRenderContext=function(a){null!=Pa&&(Pa.dispose(),Pa=null);Ia&&(Ia.dispose(),Ia=null)};this._updatePrograms=function(){var a="spherical"===u,b="shader"===D.mode;ea.color=ca.color.getProgram([a,
!0,a&&ma,b,Ea,b||Ea,this.receiveShadows,J]);ea.normal=ca.normal.getProgram([a,!0]);this.setNeedsRender()};this.destroy=function(a){this.uninstall(a);Ha&&(Ha.cancel(),Ha=null)};this.install=function(a){a.addExternalRenderer([S,H],this)};this.uninstall=function(a){a.removeExternalRenderer(this)};this.setRootTiles=function(a){ha=a;this.setNeedsRender()};this.setNeedsHighlight=function(a){this.needsHighlight=a;this.setNeedsRender()};this.setStencilEnabledLayerExtents=function(a){oa=a;this.setNeedsRender()};
this.setTileSize=function(a){p=a;Ia&&(Ia.tileSize=a);this.setNeedsRender()};this.loadTile=function(a){R(null===a.renderData);a.renderData=na.acquire();a.renderData.init();var b=this.getLocalOriginOfTile(a),c=a.createGeometry(a.renderData.updateGeometryState(a),b,"debug"===D.mode,a.renderData.geometryInfo);a.renderData.localOrigin=b;this._setTileGeometry(a,c);Xa&&Ia.updateTileTexture(a)};this.queryVisibleLevelRange=function(a,b,c,d){var e=Ga.acquire();Q.set(a,e.extent);b?e.minLevel=b:e.minLevel=-Number.MAX_VALUE;
null!=c?e.maxLevel=c:e.maxLevel=Number.MAX_VALUE;e.callback=d;ka.push(e);this.setNeedsRender()};this.updateTileTexture=function(a){Ia&&Xa&&Ia.updateTileTexture(a)};this.updateTileGeometryNeedsUpdate=function(a){return a.renderData.updateGeometryState(a).needsUpdate};this._updateTileGeometry=function(a){for(var b=a.renderData.geometryState,c=a.layerInfo[h.LayerClass.ELEVATION],d=0;d<c.length;d++)c[d].pendingUpdates&=~h.TileUpdateTypes.UPDATE_GEOMETRY;return b.needsUpdate?(a.renderData.vao&&this._releaseTileGeometry(a),
b=a.createGeometry(b,a.renderData.localOrigin,"debug"===D.mode,a.renderData.geometryInfo),this._setTileGeometry(a,b),!0):!1};this.updateTileGeometry=function(a){return a.renderData.updateGeometryState(a),this._updateTileGeometry(a)};this.unloadTile=function(a){this._releaseTileGeometry(a);a.renderData.texture&&a.renderData.texture.dispose();na.release(a.renderData);a.renderData=null};this.getLocalOriginOfTile=function(a){if(10<=a.lij[0]){for(;7<a.lij[0];)a=a.parent;return a.centerAtSeaLevel}if("spherical"===
u)return Y;for(;a.parent;)a=a.parent;return a.centerAtSeaLevel};this.setVisibility=function(a){ra=a;this.setNeedsRender()};this.getStats=function(){return{numTilesRendered:Ka,numTilesCulled:va,numTrianglesRendered:Ma,numOriginsRendered:Wa}};this.setDisableRendering=function(a){L=!!a;this.setNeedsRender()};this.getOpacity=function(){return ga};this.getWireframeEnabled=function(){return"shader"===D.mode};this.setDebugScreenSizePerspective=function(a){a!==J&&(J=a,this._updatePrograms())};this.setWireframe=
function(a){if(a&&!0!==a||(a={mode:a?"shader":"none"}),void 0!==a.mode&&D.mode!==a.mode){var b="debug"===D.mode,c="debug"===a.mode;D.mode=a.mode;this._updatePrograms();b!==c&&ha&&l.traverseTilesPreorder(ha,function(a){if(a.renderData){a.renderData.vao&&this._releaseTileGeometry(a);var b=a.createGeometry(a.renderData.updateGeometryState(a),a.renderData.localOrigin,c,a.renderData.geometryInfo);this._setTileGeometry(a,b)}}.bind(this))}for(var d in a)D.hasOwnProperty(d)&&(D[d]=a[d]),this.setNeedsRender();
D.resolution&&(D.resolution=Math.min(D.resolution,p),D.resolution=1<<Math.round(Math.log(D.resolution)/Math.LN2))};this.setOpacity=function(a){ga=a;this.setNeedsRender()};this.setDrawSkirts=function(a){pa=a;this.setNeedsRender()};this.setCullBackFaces=function(a){Fa=a;this.setNeedsRender()};this.setRenderOrder=function(a){sa=a;this.setNeedsRender()};this.setBorders=function(a){Ea!==a&&(Ea=a,this._updatePrograms())};this.setFrontMostTransparent=function(a){Z!==a&&(Z=a,this.setNeedsRender())};this.setVelvetOverground=
function(a){ma!==a&&(ma=a,this._updatePrograms())};this.setNeedsRender=function(){this.needsRender=!0;this.didRender=!1;ua=!0};this.resetNeedsRender=function(){this.didRender&&(this.needsRender=0!==ka.length,this.didRender=!1)};var aa=P.create();this.isTransparent=function(){return 1>ga||"shader"===D.mode&&(1>D.wireOpacity||1>D.surfaceOpacity)};this._renderMaterialPass=function(a,b){var c=this.isTransparent(),d=a.shadowMap&&a.shadowMap.getEnableState();this.receiveShadows!=d&&(this.receiveShadows=
d,this._updatePrograms());d=a.camera;(X.setDepthTestEnabled(!0),X.setBlendingEnabled(c),c&&X.setBlendFunctionSeparate(ba.SRC_ALPHA,ba.ONE_MINUS_SRC_ALPHA,ba.ONE,ba.ONE_MINUS_SRC_ALPHA),c&&Z)?(c=ea.depthOnly,X.bindProgram(c),X.setColorMask(!1,!1,!1,!1),X.setDepthWriteEnabled(!0),this._renderTilesAuxiliary(a,c,b),X.setColorMask(!0,!0,!0,!0),X.setDepthFunction(ba.EQUAL),X.setDepthWriteEnabled(!1)):X.setDepthFunction(ba.LESS);c=ea.color;X.bindProgram(c);c.setUniform1f("opacity",ga);("shader"===D.mode||
Ea)&&(c.setUniform1f("wireframe.width",D.width),c.setUniform1f("wireframe.falloff",Math.min(D.width,D.falloff)),c.setUniform1f("wireframe.wireOpacity",D.wireOpacity*ga),c.setUniform1f("wireframe.surfaceOpacity",D.surfaceOpacity*ga),c.setUniform4fv("wireframe.color",D.color));d=a.camera;a.shadowMap&&a.shadowMap.bind(c);a.ssaoHelper&&a.ssaoHelper.setUniforms(c);c.setUniform1i("tex",4);c.setUniform1i("overlayTex",5);c.setUniformMatrix4fv("viewNormal",d.viewInverseTransposeMatrix);c.setUniformMatrix4fv("proj",
d.projectionMatrix);a.lightingData.helper.setUniforms(c,!0);d=d.viewMatrix;P.set3(d[12],d[13],d[14],aa);P.normalize(aa);c.setUniform3fv("viewDirection",aa);for(Wa=Ma=va=Ka=0;Ba.length<Ba.data.length&&0<ka.length;)d=ka.pop(),Ba.push(d);Va=Ba.length;this._renderTiles(a,c,b);X.setBlendingEnabled(!1);X.setDepthFunction(ba.LESS);X.setDepthWriteEnabled(!0);for(a=0;a<Ba.length;a++)b=Ba.data[a],Ga.release(b),b.callback(a>=Va),b.callback=null;Ba.clear();0<Ka&&!Za&&(Za=!0,this.loaded&&this.loaded())};this._renderDepthPass=
function(a,b,c){var d=a.camera;X.bindProgram(b);X.setBlendingEnabled(!1);X.setDepthTestEnabled(!0);X.setDepthFunction(ba.LESS);b.setUniformMatrix4fv("model",T);b.setUniformMatrix4fv("viewNormal",d.viewInverseTransposeMatrix);W[0]=d.near;W[1]=d.far;b.setUniform2fv("nearFar",W);this._renderTilesAuxiliary(a,b,c)};this._renderNormalPass=function(a,b){var c=a.camera,d=ea.normal;X.bindProgram(d);X.setBlendingEnabled(!1);X.setDepthTestEnabled(!0);X.setDepthFunction(ba.LESS);d.setUniformMatrix4fv("viewNormal",
c.viewInverseTransposeMatrix);this._renderTilesAuxiliary(a,d,b)};this._renderHighlightPass=function(a,b){var c=ea.highlight;X.bindProgram(c);X.setBlendingEnabled(!1);X.setDepthTestEnabled(!0);X.setDepthFunction(ba.LESS);var d=a.offscreenRenderingHelper;X.bindTexture(d.getDepthTexture(),6);c.setUniform1i("depthTex",6);c.setUniform4f("highlightViewportPixelSz",0,0,1/d.width,1/d.height);this._renderTilesAuxiliary(a,c,b,!0)};this.render=function(a){if(fa&&!L&&ra&&ha&&Xa){var b=this.isTransparent()?H:
S;if(a.slot===b){n.trace("# BEGIN RENDER TERRAIN");b=a.pass;X.setFaceCullingEnabled(Fa);var c=1===a.lightingData.helper.globalFactor;b===x.MATERIAL?this._renderMaterialPass(a,this._updatePerOriginTileData()):b===x.MATERIAL_DEPTH_SHADOWMAP&&this.castShadows&&c?this._renderDepthPass(a,ea.depthShadowMap,this._updatePerOriginTileData()):b===x.MATERIAL_DEPTH?this._renderDepthPass(a,ea.depth,this._updatePerOriginTileData()):b===x.MATERIAL_NORMAL?this._renderNormalPass(a,this._updatePerOriginTileData()):
b===x.MATERIAL_HIGHLIGHT&&this.needsHighlight&&(this._renderHighlightPass(a,this._updatePerOriginTileData()),X.clear(X.gl.DEPTH_BUFFER_BIT));return Fa&&X.setFaceCullingEnabled(!1),n.trace("# END RENDER TERRAIN"),!0}}};this._updatePerOriginTileData=function(){if(!ua)return za;if(da=null,this._renderCollectOrigins(),0!==sa){for(var a=0;a<za.length;a++)this._sortFrontToBack(za.data[a].tiles,y);this._sortFrontToBack(za,A)}return ua=!1,za};this._renderCollectOrigins=function(){za.clear();for(var a=0;a<
ha.length;a++){var b=ha[a],c=za.next();c.root=b;"spherical"===u?c.origin=Y:c.origin=b.centerAtSeaLevel;c.tiles.clear();this._renderCollectOriginsForRoot(c)}return!0};this._renderCollectOriginsForRoot=function(a){for(wa.reset(a.root);!wa.done;){var b=wa.next(),c=b.renderData;if(!c||b.visible){var d=za.peek();if(7===b.lij[0]&&((d===a||0!==d.tiles.length)&&(d=za.next(),d.tiles.clear()),d.root=b,d.origin=b.centerAtSeaLevel),c)10<=b.lij[0]?za.peek().tiles.push(b):a.tiles.push(b),(!da||b.vlevel>da.vlevel)&&
(da=b),wa.skip()}else va++,wa.skip()}};this._sortFrontToBack=function(a,b){a.sort(b)};this._updateStencilReadStateForTile=function(a,b){if(a.stencilRenderingHelper&&a.stencilRenderingHelper.getEnableState()){for(var c=!1,d=0;d<oa.length;d++)if(b.intersectsExtent(oa[d])){c=!0;break}c?a.stencilRenderingHelper.enableStencilRead():a.stencilRenderingHelper.disableStencilRead()}};this._renderTilesAuxiliary=function(a,b,c,d){var e=a.camera,f=e.viewMatrix,g=a.rctx;b.setUniformMatrix4fv("proj",e.projectionMatrix);
d&&b.setUniform1i("overlayTex",5);for(e=0;e<c.length;e++){var h=c.data[e];b.setUniform3fv("origin",h.origin);r.bindView(h.origin,f,b);for(var k=0;k<h.tiles.length;k++){var l=h.tiles.data[k],n=l.renderData;d&&(n.highlightOverlayTexId?ya(b,n,n.highlightOverlayTexId):g.bindTexture(Pa,5));this._updateStencilReadStateForTile(a,l);g.bindVAO(n.vao);M.assertCompatibleVertexAttributeLocations(n.vao,b);l=n.vao.indexBuffer.size;pa||(l=n.geometryInfo.numWithoutSkirtIndices);g.drawElements(ba.TRIANGLES,l,n.vao.indexBuffer.indexType,
0)}}g.bindVAO(null);g.stencilRenderingHelper&&g.stencilRenderingHelper.disableStencilRead()};this._renderTiles=function(a,b,c){var d=a.camera.viewMatrix;if(J){var e=N.getSettings(u);e.update({distance:v.distanceToSurface,fovY:v.fovY});r.bindScreenSizePerspective(e,b,"screenSizePerspective")}for(e=0;e<c.length;e++){var f=c.data[e];b.setUniform3fv("origin",f.origin);r.bindView(f.origin,d,b);a.shadowMap&&a.shadowMap.bindView(b,f.origin);Wa++;var g=f.tiles;if(0!==g.length){var h=ba.TRIANGLES;"debug"===
D.mode&&(h=ba.LINES);var k,l,q=da;q?(k=q.vlevel,l=p/D.resolution):(k=16,l=p/64);for(q=0;q<g.length;q++){var m=g.data[q],f=m.renderData;this._updateStencilReadStateForTile(a,m);n.trace("# RENDER TILE "+m.lij[0]+"/"+m.lij[1]+"/"+m.lij[2]+", screenDepth:"+m.screenDepth);b.setUniform2fv("texOffset",f.texOffset);b.setUniform1f("texScale",f.texScale);(X.bindTexture(f.textureReference||f.texture,4),f.overlayTexId?ya(b,f,f.overlayTexId):(b.setUniform2fv("overlayTexOffset",O),X.bindTexture(Pa,5)),"shader"===
D.mode||Ea)&&b.setUniform1f("wireframe.subdivision",l*(1<<k-m.vlevel));var t=f.vao.indexBuffer.size;pa||(t=f.geometryInfo.numWithoutSkirtIndices);X.bindVAO(f.vao);M.assertCompatibleVertexAttributeLocations(f.vao,b);X.drawElements(h,t,f.vao.indexBuffer.indexType,0);m.renderOrder=Ka;Ka++;Ma+=t/3;f=m.extent;m=m.lij[0];for(t=0;Va>t;){var w=Ba.data[t],x=w.extent;m>=w.minLevel&&m<=w.maxLevel&&x[0]<=f[2]&&x[2]>=f[0]&&x[1]<=f[3]&&x[3]>=f[1]?(Ba.swap(t,Va-1),Va--):t++}}}}X.bindVAO(null);a.stencilRenderingHelper&&
a.stencilRenderingHelper.disableStencilRead()};var ya=function(a,b,c){var d=ja[c];d||(d=E.aquire(c).getGLTexture(),R(d),ja[c]=d);a.setUniform2fv("overlayTexOffset",b.overlayTexOffset);a.setUniform2fv("overlayTexScale",b.overlayTexScale);a.setUniform1f("overlayOpacity",b.overlayOpacity);X.bindTexture(d,5)},Aa=P.create(),Ca=P.create(),ta=P.create(),xa=this.clippingExtent;this.intersect=function(a,b,c){if(ha&&(!a.isSelection||!this.isTransparent())&&a.enableTerrain){P.subtract(c,b,Aa);var d=a.getMinResult(),
e=a.getMaxResult();wa.reset(ha);for(var f={};!wa.done;){var g=wa.next();if(null!==g.renderData){if(a.enableInvisibleTerrain){if(!g.visible&&xa&&!g.intersectsExtent(xa))continue}else if(!g.visible)continue;var h=g.renderData.geometryInfo.geometry,k=g.renderData.localOrigin;P.subtract(b,k,Ca);P.subtract(c,k,ta);r.intersectTriangleGeometry(h,f,void 0,a,Ca,ta,function(b,c,f){if((pa||!(3*f>=g.renderData.geometryInfo.numWithoutSkirtIndices))&&0<=b&&(a.enableBackfacesTerrain||0>P.dot(c,Aa))){var h;(void 0===
d.dist||b<d.dist)&&(h=l.lij2str(g.lij[0],g.lij[1],g.lij[2]),d.set(void 0,h,b,c,void 0),d.setIntersector("terrain"));(void 0===e.dist||b>e.dist)&&(h=l.lij2str(g.lij[0],g.lij[1],g.lij[2]),e.set(void 0,h,b,c,void 0),e.setIntersector("terrain"))}})}}}};this._setTileGeometry=function(a,b){a=a.renderData;var c=b.geometry.getData(),e=c.getVertexAttr().terrain.data,c=c.indices.terrain;a.vao=new z(X,F.Default3D,{geometry:G.Pos3Tex},{geometry:C.createVertex(X,ba.STATIC_DRAW,e)},C.createIndex(X,ba.STATIC_DRAW,
c));a.geometryInfo.geometry&&d.releaseGeometry(a.geometryInfo.geometry);a.geometryInfo=b;this.setNeedsRender()};this._releaseTileGeometry=function(a){a=a.renderData;a.vao.dispose(!0);a.vao=null;a.geometryInfo.geometry&&d.releaseGeometry(a.geometryInfo.geometry);a.geometryInfo.geometry=null;this.setNeedsRender()}};return v.TileRenderData=b,v})},"esri/views/3d/terrain/TileRenderData":function(){define(["require","exports","../lib/glMatrix"],function(m,l,h){var d=h.vec2d;return function(){function b(){this.overlayTexOffset=
d.create();this.texOffset=d.create();this.geometryInfo={geometry:null,numSurfaceIndices:0,numSkirtIndices:0,numWithoutSkirtIndices:0,numVertsPerRow:0};this.init()}return b.prototype.init=function(){this.geometryInfo.geometry=null;this.geometryInfo.numSurfaceIndices=0;this.geometryInfo.numSkirtIndices=0;this.geometryInfo.numWithoutSkirtIndices=0;this.geometryInfo.numVertsPerRow=0;this.textureReference=this.texture=this.vao=this.geometryState=null;d.set2(0,0,this.texOffset);this.texScale=1;this.highlightOverlayTexId=
this.overlayTexId=null;this.overlayTexScale=[1,1];this.overlayOpacity=1;this.localOrigin=null},b.prototype.updateGeometryState=function(b){return this.geometryState=b.geometryState(this.geometryState),this.geometryState},b}()})},"esri/views/3d/terrain/ResourceCounter":function(){define(["require","exports"],function(m,l){return function(){function h(){this._numTileTexturesComposited=0}return Object.defineProperty(h.prototype,"numTileTexturesComposited",{get:function(){return this._numTileTexturesComposited},
enumerable:!0,configurable:!0}),h.prototype.incrementNumTileTexturesComposited=function(){this._numTileTexturesComposited++},h.prototype.resetNumTileTexturesComposited=function(){this._numTileTexturesComposited=0},h}()})},"esri/views/3d/terrain/TileRenderer":function(){define("require exports ../lib/glMatrix ../../webgl/FramebufferObject ../../webgl/VertexArrayObject ../../webgl/Texture ../../webgl/BufferObject ../../webgl/Util ../webgl-engine/lib/DefaultVertexAttributeLocations ../webgl-engine/lib/DefaultVertexBufferLayouts ../../vectorTiles/VectorTileDisplayObject ../../vectorTiles/tileRendererHelper3D ./TerrainConst".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){var r=h.vec2d,u=Array(20),v=[0,0];return function(){function h(c,d,f,g,h){this._gridTex=null;this.tileSize=256;this._context=c;this.tileSize=d;this._resourceCounter=g;this._setNeedsRender=h;c.extensions.textureFilterAnisotropic&&(this._maxAnisotropy=Math.min(8,c.parameters.maxMaxAnisotropy));d=new Float32Array(20);d[0]=-1;d[1]=-1;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=-1;d[7]=0;d[8]=1;d[9]=0;d[10]=-1;d[11]=1;d[12]=0;d[13]=0;d[14]=1;d[15]=1;d[16]=1;d[17]=0;d[18]=1;d[19]=
1;this._vaoQuad=new b(c,a.Default3D,{geometry:e.Pos3Tex},{geometry:k.createVertex(c,35044,d)});this._blendLayersProgram=f.get("blendLayers")}return h.prototype.dispose=function(){this._fbo&&(this._fbo.dispose(),this._fbo=null);this._vaoQuad&&(this._vaoQuad.dispose(),this._vaoQuad=null);this._gridTex&&(this._gridTex.dispose(),this._gridTex=null);this._blendLayersProgram&&(this._blendLayersProgram.dispose(),this._blendLayersProgram=null);this._context&&(this._context=null)},h.prototype.updateTileTexture=
function(a){for(var b=t.LayerClass.MAP,c=a.layerInfo[b],d=0;d<c.length;d++)c[d].pendingUpdates&=~t.TileUpdateTypes.UPDATE_TEXTURE;if(a.renderData){for(var e,f,g,h=a.renderData,k=0,l=!0,d=0;d<c.length;d++){e=c[d];var q=a.parentSurface.layerViewByIndex(d,b);if(u[d]=q.fullOpacity,(e.data||e.upsampleFromTile)&&(k++,!q.isTransparent)){l=!1;break}}d===c.length&&d--;0===k&&this._gridTex?(h.textureReference=this._gridTex,r.set2(0,0,h.texOffset),h.texScale=1):1!==k||l?(this._composeMapLayers(a,c,d,l,u),h.textureReference=
null,r.set2(0,0,h.texOffset),h.texScale=1):(e=c[d],e.data?(f=e,r.set2(0,0,h.texOffset),h.texScale=1):(g=e.upsampleFromTile,f=g.tile.layerInfo[b][d],r.set(g.offset,h.texOffset),h.texScale=g.scale),f&&(f.data instanceof HTMLImageElement&&(f.data=this._buildTexture(f.data)),h.textureReference=f.data));this._setNeedsRender()}},h.prototype.setGridImage=function(a){this._gridTex=this._buildTexture(a)},h.prototype._buildTexture=function(a){var b,c={target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,
samplingMode:9729,maxAnisotropy:this._maxAnisotropy,flipped:!0,hasMipmap:!0},d=this._context;if(a)try{b=new g(d,c,a)}catch(C){c.width=c.height=this.tileSize,b=new g(d,c),console.warn("TileRenderer: failed to execute 'texImage2D', cross-origin image may not be loaded.")}else c.width=c.height=this.tileSize,b=new g(d,c);return d.bindTexture(b),b.generateMipmap(),b},h.prototype._drawVectorData=function(a,b,c,d,e,f,g,h,k){void 0===k&&(k=1);q(this._context,c,a,b.renderer,b.schemeHelper,c[0],d,e,0,f,g,h,
k)},h.prototype._drawRasterData=function(a,b,c,d){void 0===d&&(d=1);var e=this._context,g=this._blendLayersProgram,h=this._vaoQuad;e.bindProgram(g);e.bindVAO(h);f.assertCompatibleVertexAttributeLocations(h,g);e.bindTexture(a,0);g.setUniform1i("tex",0);g.setUniform1f("scale",b);g.setUniform2f("offset",c[0],c[1]);g.setUniform1f("opacity",d);e.drawArrays(5,0,f.vertexCount(h,"geometry"))},h.prototype._composeMapLayers=function(a,b,e,f,g){var h=t.LayerClass.MAP,k=this._context;a.renderData.texture||(a.renderData.texture=
this._buildTexture());var l=a.renderData.texture,n=this._fbo;n&&n.width===l.descriptor.width&&n.height===l.descriptor.height||(n=d.create(k,{colorTarget:0,depthStencilTarget:1,width:l.descriptor.width,height:l.descriptor.height}),this._fbo=n);var q=k.gl;k.bindFramebuffer(n);k.setViewport(0,0,this.tileSize,this.tileSize);k.setClearColor(0,0,0,0);k.setClearDepth(1);k.clear(q.COLOR_BUFFER_BIT|q.DEPTH_BUFFER_BIT);k.setDepthTestEnabled(!1);k.setBlendFunctionSeparate(1,771,1,771);k.setBlendEquation(32774);
k.setBlendingEnabled(!0);var m,r,u,w;for(f&&this._gridTex&&this._drawRasterData(this._gridTex,1,v);0<=e;e--)f=null,(m=b[e],m.data)?(f=m,r=v,u=1):m.upsampleFromTile&&(u=m.upsampleFromTile,f=u.tile.layerInfo[h][e],w=u.tile.lij[0],r=u.offset,u=u.scale),f&&(((f.data instanceof HTMLImageElement||f.data instanceof HTMLCanvasElement)&&(f.data=this._buildTexture(f.data)),f.data instanceof c)?(n=a.parentSurface.layerViewByIndex(e,h),this._drawVectorData(f.data,n,a.lij,l.descriptor.width,l.descriptor.height,
u,r,w,g[e])):this._drawRasterData(f.data,u,r,g[e]));k.bindTexture(l);q.copyTexImage2D(k.gl.TEXTURE_2D,0,l.descriptor.pixelFormat,0,0,l.descriptor.width,l.descriptor.height,0);l.generateMipmap();k.bindFramebuffer(null);k.setBlendFunctionSeparate(770,771,1,771);k.setBlendingEnabled(!1);this._resourceCounter.incrementNumTileTexturesComposited()},h}()})},"esri/views/vectorTiles/tileRendererHelper3D":function(){define(["require","exports","dojo/has","../../core/libs/gl-matrix/vec3","../../core/libs/gl-matrix/mat4"],
function(m,l,h,d,b){var g={extent:{xmin:0,ymin:0,xmax:0,ymax:0,spatialReference:{wkid:102100,isWrappable:!0},intersects:function(b){return!1}},center:[0,0],scale:1,resolution:1,rotation:0,width:1,height:1,pixelRatio:1,size:[256,256],spatialReference:{wkid:102100,isWrappable:!0},worldScreenWidth:1,viewpoint:{},toMap:function(b,a){return[0,0]},toScreen:function(b,a){return[0,0]},clone:function(){return null},copy:function(b){return this}},k=d.create();return function(d,a,e,c,l,m,r,u,v,x,y,n,w){v=[a[0],
a[1],a[2]];for(var f=x;1>f;f*=2)v[0]--,v[1]>>=1,v[2]>>=1;a={context:d,budget:null,state:g,stationary:!0,devicePixelRatio:1,displayLevel:l.adjustLevel(m),requiredLevel:l.adjustLevel(a[0]),drawphase:0,renderer:c,layerOpacity:w};if(r!==u)throw Error("It is expected that tiles are square!");m=1/x;w=l.getSchemaShift(v,m);f=w[1];e.tileTransform.displayCoord[0]=-1-2*m*y[0]-w[0];e.tileTransform.displayCoord[1]=1+2*m*(1-y[1]-x)+f;x=e.tileTransform.transform;b.identity(x);l.isWGS84&&512===l.lockedSchemaPixelSize&&
(m*=2);0===n&&(m/=2);l=.25*m/r;k.set([l,-l,1]);b.scale(x,x,k);d.setBlendFunctionSeparate(1,771,1,771);d.setClearDepth(1);d.clear(d.gl.DEPTH_BUFFER_BIT);a.state.size=[r,u];a.state.width=r;a.state.height=u;c.setStateParams(a.state,a.devicePixelRatio,v[0]);e.attach(a);d.setFaceCullingEnabled(!1);d.setDepthFunction(515);d.setBlendingEnabled(!1);d.setDepthTestEnabled(!0);d.setDepthWriteEnabled(!0);e.processRender(a);d.setDepthWriteEnabled(!1);d.setBlendingEnabled(!0);a.drawphase=1;e.processRender(a);a.drawphase=
2;e.processRender(a);h("esri-vector-tiles-debug")&&c.renderTileInfo(d,e);d.setDepthWriteEnabled(!0);d.setDepthTestEnabled(!1);d.setFaceCullingEnabled(!0)}})},"esri/views/3d/terrain/TilemapOnlyTile":function(){define(["require","exports","./TerrainConst","./TilePerLayerInfo"],function(m,l,h,d){return function(){function b(b){this.parent=null;this.lij=b;this.layerInfo=Array(h.LayerClass.LAYER_CLASS_COUNT)}return b.prototype.tileDataAvailable=function(b,d,f){return(d=this.layerInfo[f][d].tilemap)?"unavailable"!==
d.getAvailability(b.lij[1],b.lij[2]):!0},b.prototype.modifyLayers=function(b,h,f){b=h.length;for(var a=this.layerInfo[f],e=Array(b),c=0;b>c;c++){var g=h[c];e[c]=-1<g?a[g]:new d(f)}this.layerInfo[f]=e},b}()})},"esri/views/3d/layers/graphics/Deconflictor":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/watchUtils ../../../../core/HandleRegistry ../../../../core/Logger ../../support/aaBoundingRect ../../support/PreallocArray ./deconflictorDebug ../../lib/glMatrix ../../webgl-engine/lib/Util ../../webgl-engine/lib/screenSizePerspectiveUtils ../../webgl-engine/materials/internal/MaterialUtil ../../webgl-engine/materials/HUDMaterial".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){function u(a){return!!a&&"selection"===a.type}var v=e.vec2d;m=e.vec4d;var x=c.VertexAttrConstants,y=g.getLogger("esri.views.3d.graphics.Deconflictor"),n=m.create(),w=m.create(),z=m.create(),C=m.create(),B=v.create(),F=k.create(),G=k.create(),N=new Set,M=c.lerp,R=new f(100),P=new f(100),Q=function(){function a(a,b){this.creator=a;this.disposer=b;this.list=[];this.currentIndex=0}return a.prototype.alloc=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];
return this.currentIndex>=this.list.length&&this.list.push(new this.creator(a)),this.list[this.currentIndex++]},a.prototype.freeAll=function(){for(var a=this.currentIndex,b=this.disposer,c=this.list;0<=--a;)b(c[a]);this.currentIndex=0},a}(),T=function(){function a(){this.graphics3DGraphic=null;this.positions=[v.create(),v.create(),v.create(),v.create()];this.posView=this.yMax=this.yMin=this.xMax=this.xMin=0;this.graphicsOwner=null;this.graphicId=this.id=0}return a.release=function(a){a.graphics3DGraphic=
null;a.graphicsOwner=null},a}();g=function(){function c(a){var c=this;this.graphicsOwners=[];this.deconflictTimeoutId=0;this.handles=new b;this.graphicInfoPool=new Q(T,T.release);this.nextGraphicInfoId=0;this.accBinsNumX=15;this.accBinsNumY=20;this.accBinsSizeY=this.accBinsSizeX=0;this.accBins=null;this.accNumTests=0;this.iconMarginFactor=-.1;this.view=a;this.handles.add([a.watch("state.camera",function(){return c.scheduleRun()}),d.whenNot(a,"ready",function(){return c.clearDeconflictTimeout()})])}
return c.prototype.destroy=function(){this.handles.destroy();this.handles=null;this.clearDeconflictTimeout();this.graphicInfoPool.freeAll();this.view=this.graphicInfoPool=null},c.prototype.clearDeconflictTimeout=function(){this.deconflictTimeoutId&&(clearTimeout(this.deconflictTimeoutId),this.deconflictTimeoutId=0)},c.prototype.addGraphicsOwner=function(a){var b=this;this.graphicsOwners.push(a);this.setDirty();a.layer&&"function"==typeof a.layer.watch&&a.layer.watch("featureReduction",function(c,
d){u(c)?b.setDirty():u(d)&&(b._removeIconVisibilityFlags(a),b.setDirty())})},c.prototype.removeGraphicsOwner=function(a){a=this.graphicsOwners.indexOf(a);0<=a&&this.graphicsOwners.splice(a,1);this.setDirty()},c.prototype.setDirty=function(){this.scheduleRun(10)},c.prototype.initializeLabelVisibility=function(a){a.setVisibilityFlag(2,!1,1)},c.prototype.doesIntersectExistingPoly=function(a){var b=a.graphicId,c=a.positions;N.clear();for(var d=Math.floor(a.xMin/this.accBinsSizeX);d<=Math.floor(a.xMax/
this.accBinsSizeX);d++)if(!(0>d||d>=this.accBinsNumX))for(var e=Math.floor(a.yMin/this.accBinsSizeY);e<=Math.floor(a.yMax/this.accBinsSizeY);e++)if(!(0>e||e>=this.accBinsNumY)){var f=this.accBins[d][e],g=0;a:for(;g<f.length;g++){var h=f.data[g];if(h.graphicId!==b&&!N.has(h.id)){N.add(h.id);h=h.positions;this.accNumTests++;for(var k=0;2>k;k++){var l=0===k?c:h,n=0===k?h:c,q=0;b:for(;4>q;q++){var m=l[q],r=l[(q+1)%4],t=l[(q+2)%4];B[0]=r[0]-m[0];B[1]=r[1]-m[1];r=v.normalize(B);w=[-r[1],r[0]];r[0]=w[0];
r[1]=w[1];m=r[0]*m[0]+r[1]*m[1];t=r[0]*t[0]+r[1]*t[1]<m;for(w=0;4>w;w++){var u=n[w],u=r[0]*u[0]+r[1]*u[1];if(t&&m>u||!t&&u>m)continue b}continue a}}return!0}}}return!1;var w},c.prototype.initBins=function(a,b){if(null==this.accBins){this.accBins=[];for(var c=0;c<this.accBinsNumX;c++){this.accBins.push([]);for(var d=this.accBins[this.accBins.length-1],e=0;e<this.accBinsNumY;e++)d.push(new f(10))}}for(c=0;c<this.accBinsNumX;c++)for(e=0;e<this.accBinsNumY;e++)this.accBins[c][e].clear();this.accBinsSizeX=
a/this.accBinsNumX;this.accBinsSizeY=b/this.accBinsNumY;this.accNumTests=0},c.prototype.addToBins=function(a){for(var b=Math.floor(a.xMin/this.accBinsSizeX);b<=Math.floor(a.xMax/this.accBinsSizeX);b++)if(!(0>b||b>=this.accBinsNumX))for(var c=Math.floor(a.yMin/this.accBinsSizeY);c<=Math.floor(a.yMax/this.accBinsSizeY);c++)0>c||c>=this.accBinsNumY||this.accBins[b][c].push(a)},c.prototype.scheduleRun=function(a){var b=this;void 0===a&&(a=200);0===this.deconflictTimeoutId&&(this.deconflictTimeoutId=setTimeout(function(){return b.run()},
a))},c.prototype.run=function(){var b=this.view;if(this.clearDeconflictTimeout(),!b.ready)return void this.setDirty();var c=b.state.camera;this.graphicInfoPool.freeAll();this.nextGraphicInfoId=0;var d=c.fullWidth,e=c.fullHeight;a.prepare(b);R.clear();P.clear();for(var b=!1,f=0;f<this.graphicsOwners.length;f++){var g=this.graphicsOwners[f];if(null!=g.getGraphics3DGraphics&&null!=g.getGraphics3DGraphicsKeys){var h=null!=g.labelsEnabled&&g.labelsEnabled(),k=u(g.layer?g.layer.featureReduction:null);if(h||
k){b||(this.initBins(d,e),b=!0);for(var l=g.getGraphics3DGraphics(),n=g.getGraphics3DGraphicsKeys(),q=0;q<n.length;q++){var m=l[n[q]];m.areVisibilityFlagsSet(void 0,2)&&(k&&this._collectGraphics(m,!1,g,c,R,this.iconMarginFactor),h&&this._collectGraphics(m,!0,g,c,P))}}}}R.sort(function(a,b){return b.posView-a.posView});P.sort(function(a,b){return b.posView-a.posView});this._deconflictVisibleObjects(R,!1);P.length&&this._deconflictVisibleObjects(P,!0);a.drawAccelerationStruct(this,R);a.drawAccelerationStruct(this,
P)},c.prototype._collectGraphics=function(a,b,c,d,e,f){void 0===f&&(f=0);var g=b?a._labelGraphics:a._graphics,h=b?1:0;if(g.length){var l,p,m;b=k.set(F,k.NEGATIVE_INFINITY);for(var u=0;u<g.length;u++){var v=g[u];if(!v.isDraped()){var A=v.stageObject,B=A?A.getNumGeometryRecords():0;if(!(1>B)){var N=A.getGeometryRecord(0),H=N.materials[0];if(H instanceof r)if(1<B)y.warn("Graphic objects with more than 1 geometry record are not supported");else{B=N.geometry.getData().getVertexAttr();if(!p){p=A.getCenter();
m=N.origin.vec3;p=t.transformToWorld(p,m,n);p=t.transformToView(p,m,d.viewMatrix,w);H.applyVerticalOffsetTransformation(p,B[x.NORMAL].data,A.objectTransformation,d,O);A=B[x.AUXPOS1].data;B="screen"!==H.getParams().centerOffsetUnits;m=t.transformToProjection(p,d.projectionMatrix,B?A:[0,0,0],z);m=t.transformToNDC(m,C);B||(m[0]+=A[0]/d.fullWidth*2,m[1]+=A[1]/d.fullHeight*2);if(-1>m[0]||-1>m[1]||-1>m[2]||1<=m[0]||1<=m[1])break;l=p[2];a.areVisibilityFlagsSet(2,void 0,h)&&(l*=.7)}v=v.getScreenSize(S);q.applyPrecomputedScaleFactorVec2(v,
O.factor,v);H=k.offset(H.calculateRelativeScreenBounds(v,O.scaleAlignment,G),M(0,d.fullWidth,.5+.5*m[0]),M(0,d.fullHeight,.5+.5*m[1]));0!==f&&(v=f*Math.min(k.width(H),k.height(H)),H[0]-=v,H[1]-=v,H[2]+=v,H[3]+=v);k.expand(b,H)}}}}null!=l&&(d=this.graphicInfoPool.alloc(),d.id=this.nextGraphicInfoId++,d.graphicId=a.graphic.uid,d.xMin=b[0],d.yMin=b[1],d.xMax=b[2],d.yMax=b[3],d.positions[0][0]=b[0],d.positions[0][1]=b[1],d.positions[1][0]=b[0],d.positions[1][1]=b[3],d.positions[2][0]=b[2],d.positions[2][1]=
b[3],d.positions[3][0]=b[2],d.positions[3][1]=b[1],d.graphics3DGraphic=a,d.posView=l,d.graphicsOwner=c,e.push(d))}},c.prototype._deconflictVisibleObjects=function(b,c){for(var d=c?1:0,e=0;e<b.length;e++){var f=b.data[e],g=f.graphics3DGraphic,h=!(c&&!1===g.areVisibilityFlagsSet(2,void 0))&&!this.doesIntersectExistingPoly(f);h&&this.addToBins(f);g.setVisibilityFlag(2,h,d);a.drawPoly(f.positions,h?"green":"red")}},c.prototype._removeIconVisibilityFlags=function(a){if(null!=a.getGraphics3DGraphics&&null!=
a.getGraphics3DGraphicsKeys){var b=a.getGraphics3DGraphics(),c=0;for(a=a.getGraphics3DGraphicsKeys();c<a.length;c++)b[a[c]].setVisibilityFlag(2,void 0)}},c}();var O={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},scaleAlignment:0,minPixelSizeAlignment:0},S=v.create();return g})},"esri/views/3d/layers/graphics/deconflictorDebug":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../lib/glMatrix","../../support/debugFlags"],function(m,l,h,d,b){function g(a,
b){if(e){var c=k.height,d=f;d.beginPath();d.lineWidth=1;d.strokeStyle=b;d.moveTo(a[0][0],c-a[0][1]);for(b=1;4>b;b++)d.lineTo(a[b][0],c-a[b][1]),d.stroke();d.lineTo(a[0][0],c-a[0][1]);d.stroke();d.closePath()}}Object.defineProperty(l,"__esModule",{value:!0});var k,f,a=d.vec2d,e=!1,c=!1;l.drawAccelerationStruct=function(b,d){if(c&&f){for(var e=f,h=[a.create(),a.create(),a.create(),a.create()],k=0,l=0;l<b.accBinsNumX;l++)for(var q=0;q<b.accBinsNumY;q++){var n=b.accBins[l][q],k=k+n.length,m=l*b.accBinsSizeX,
t=(l+1)*b.accBinsSizeX,C=q*b.accBinsSizeY,B=(q+1)*b.accBinsSizeY;h[0][0]=m;h[0][1]=C;h[1][0]=t;h[1][1]=C;h[2][0]=t;h[2][1]=B;h[3][0]=m;h[3][1]=B;e.fillText(n.length.toFixed(),m+5,C+15);g(h,"blue")}e.fillText("total totalShownLabels: "+k,70,40);e.fillText("total visible labels: "+d.length,70,50);e.fillText("total numTests: "+b.accNumTests,70,30)}};l.prepare=function(a){e=b.DECONFLICTOR_SHOW_OUTLINES;c=b.DECONFLICTOR_SHOW_GRID;(e||c)&&(null==k&&(k=document.createElement("canvas"),k.setAttribute("id",
"canvas2d"),a.surface.parentElement.style.position="relative",a.surface.parentElement.appendChild(k)),k.setAttribute("width",a.width+"px"),k.setAttribute("height",a.height+"px"),k.setAttribute("style","position:absolute;left:0px;top:0px;display:block;pointer-events:none;"),f=k.getContext("2d"),f.clearRect(0,0,a.width,a.height),f.font="8px Arial")};l.drawPoly=g})},"esri/views/3d/layers/GraphicsView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../layers/GraphicsView ./graphics/Graphics3DCore ./graphics/Graphics3DSpatialIndex ./graphics/Graphics3DElevationAlignment ../support/PromiseLightweight ../../../core/promiseUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){return function(g){function l(){var a=null!==g&&g.apply(this,arguments)||this;return a.graphicsCore=null,a.spatialIndex=null,a.elevationAlignment=null,a.supportsDraping=!0,a._overlayUpdating=!1,a._eventHandles=[],a}return h(l,g),Object.defineProperty(l.prototype,"graphics",{set:function(a){a!==this.loadedGraphics&&(this.loadedGraphics=a);this._set("graphics",a)},enumerable:!0,configurable:!0}),l.prototype.initialize=function(){var a=this;this.mockLayerId="__sceneView.graphics-"+
Date.now().toString(16);this.spatialIndex=new f;this.spatialIndex.whenLoaded().then(function(){return a.deferredInitialize()})},l.prototype.deferredInitialize=function(){var b=this;if(!this.destroyed){this.loadedGraphics=this.graphics;this.graphicsCore=new k;this.elevationAlignment=new a;var c={id:this.mockLayerId,uid:this.mockLayerId};this.spatialIndex.initialize(this,c,this.view.spatialReference,this.graphicsCore);this.elevationAlignment.initialize(this,function(a,c,d){b.spatialIndex.intersects(a,
c,d)},this.graphicsCore,this.view.elevationProvider);this.graphicsCore.initialize(this,c,this.elevationAlignment,null,this.spatialIndex,null,null,null,null,this.view.basemapTerrain);this._eventHandles.push(this.view.watch("clippingArea",function(){return b.updateClippingExtent()}));this.updateClippingExtent();this.view.resourceController.registerIdleFrameWorker(this,{needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate})}},l.prototype.destroy=function(){this._eventHandles.forEach(function(a){return a.remove()});
this._eventHandles=null;this.view.resourceController.deregisterIdleFrameWorker(this);this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.elevationAlignment&&(this.elevationAlignment.destroy(),this.elevationAlignment=null);this.graphicsCore&&(this.graphicsCore.destroy(),this.graphicsCore=null);this.loadedGraphics=null},l.prototype.getGraphicsFromStageObject=function(a,b){var c=a.getMetadata().graphicId,d=null;this.loadedGraphics&&this.loadedGraphics.some(function(a){return a.uid===
c?(d=a,!0):!1});a=new e.Promise;return null!==d?a.done(d):a.reject(),a},l.prototype.whenGraphicBounds=function(a){var b=this;return this.spatialIndex?this.spatialIndex.whenLoaded().then(function(){return b.graphicsCore?b.graphicsCore.whenGraphicBounds(a):c.reject()}):c.reject()},l.prototype._needsIdleUpdate=function(){return this.elevationAlignment.needsIdleUpdate()},l.prototype._idleUpdate=function(a){this.elevationAlignment.idleUpdate(a)},l.prototype._notifySuspendedChange=function(){},l.prototype._notifyDrapedDataChange=
function(){this.view.basemapTerrain&&this.view.basemapTerrain.overlayManager.setOverlayDirty()},l.prototype._evaluateUpdatingState=function(){if(this.elevationAlignment){var a;a=0+this.elevationAlignment.numNodesUpdating();a+=this.graphicsCore.numNodesUpdating();this.updating=a=(a=(a=(a=0<a||this._overlayUpdating)||this.spatialIndex.isUpdating())||this.elevationAlignment.isUpdating())||this.graphicsCore.needsIdleUpdate()}else this.updating=!1},l.prototype.updateClippingExtent=function(){this.graphicsCore.setClippingExtent(this.view.clippingArea,
this.view.spatialReference)&&this.graphicsCore.recreateAllGraphics()},d([b.property()],l.prototype,"graphics",null),d([b.property()],l.prototype,"loadedGraphics",void 0),d([b.property({value:!0})],l.prototype,"updating",void 0),d([b.property({value:!1})],l.prototype,"suspended",void 0),l=d([b.subclass("esri.views.3d.layers.GraphicsView3D")],l)}(b.declared(g))})},"esri/views/3d/layers/graphics/Graphics3DCore":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/watchUtils ../../../../core/arrayUtils ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../support/projectionUtils ../../../../renderers/UniqueValueRenderer ../../../../renderers/support/rendererConversion ../../../../renderers/support/diffUtils ../../../../geometry/Point ../../../../geometry/Extent ../../webgl-engine/Stage ../../webgl-engine/lib/Util ../../webgl-engine/lib/Layer ../../webgl-engine/lib/FloatingBoxLocalOriginFactory ../../../../symbols/WebStyleSymbol ../../../../symbols/LabelSymbol3D ../../../../symbols/TextSymbol ../../../../symbols/support/symbolConversion ../../../../symbols/support/unitConversionUtils ../../lib/glMatrix ./featureExpressionInfoUtils ./Graphics3DGraphic ./Graphics3DWebStyleSymbol ./graphicUtils ./Graphics3DSymbolFactory ./Graphics3DOwner ./ElevationQuery ../../support/aaBoundingBox ../../support/mathUtils dojo/Deferred".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P,Q,T,O,S,H,Y){function W(a){(a=a.elevationInfo&&a.elevationInfo.unit)&&!F.supportsUnit(a)&&A.warn("elevationInfo.unit","'"+a+"' is not a valid unit")}m=G.vec3d;var E=new r,p=m.create(),A=f.getLogger("esri.views.3d.layers.graphics.Graphics3DCore");return function(){function f(a){void 0===a&&(a=!0);this.elevationFeatureExpressionEnabled=a;this.graphics={};this.graphicsDrapedIds={};this.graphicsBySymbol={};this.graphicsKeys=[];this.symbols=
{};this.graphicsWithoutSymbol={};this.computedExtent=null;this.symbolCreationContext=new T.Graphics3DSymbolCreationContext;this.hasDraped=!1;this.updatingGraphicIds=new Set;this.graphicTransformFunc=this.onComputedExtentChange=this.stage=this.labelStageLayer=this.stageLayer=this.tilingSchemeHandle=this.lastFastUpdate=null;this.eventHandles=[];this.sharedSymbolResourcesOwnerHandle=this.highlights=this.elevationQueryService=this.labeling=this.spatialIndex=this.scaleVisibility=this.elevation=this.layer=
this.layerView=this.viewSR=null;this.whenGraphics3DGraphicRequests={}}return f.prototype.initialize=function(a,c,d,e,g,h,k,l,n,p){var q=this;this.layerView=a;this.layer=c;this.viewSR=a.view.spatialReference;this.elevation=d;this.scaleVisibility=e;this.spatialIndex=g;this.labeling=h;this.highlights=k;this.onComputedExtentChange=l;this.graphicTransformFunc=n;var m=this.layerView.view;this.elevationQueryService=new O.ElevationQuery(this.viewSR,function(){return m.map.ground},{maximumAutoTileRequests:4});
this.initializeStage(m,this.layer.uid);this.symbolCreationContext.sharedResources=m.sharedSymbolResources;this.sharedSymbolResourcesOwnerHandle=m.sharedSymbolResources.addGraphicsOwner(this);this.symbolCreationContext.renderer=this.layer.renderer;this.symbolCreationContext.stage=this.stage;this.symbolCreationContext.streamDataSupplier=m.sharedSymbolResources.streamDataSupplier;this.symbolCreationContext.renderSpatialReference=m.renderSpatialReference;this.symbolCreationContext.renderCoordsHelper=
m.renderCoordsHelper;this.symbolCreationContext.layer=this.layer;this.symbolCreationContext.layerView=this.layerView;this.symbolCreationContext.layerOrder=0;this.symbolCreationContext.localOriginFactory=f.createLocalOriginFactory();this.symbolCreationContext.elevationProvider=m.elevationProvider;W(this.layer);c=N.extractExpressionInfo(this.layer.elevationInfo,this.elevationFeatureExpressionEnabled);this.symbolCreationContext.featureExpressionInfoContext=N.createContext(c,this.viewSR,A);m.deconflictor.addGraphicsOwner(this);
this.symbolCreationContext.screenSizePerspectiveEnabled=m.screenSizePerspectiveEnabled&&this.layer.screenSizePerspectiveEnabled;this.tilingSchemeHandle=b.when(p,"tilingScheme",function(a){a.spatialReference.equals(q.symbolCreationContext.overlaySR)||(q.symbolCreationContext.overlaySR=p.spatialReference,q.recreateAllGraphics())});this.eventHandles.push(this.layerView.watch("suspended",function(){return q.suspendedChange()}));this.eventHandles.push(this.layerView.watch("layer.screenSizePerspectiveEnabled,view.screenSizePerspectiveEnabled",
function(){q.symbolCreationContext.screenSizePerspectiveEnabled=m.screenSizePerspectiveEnabled&&q.layer.screenSizePerspectiveEnabled;q.recreateAllGraphics()}));this.eventHandles.push(b.on(a,"loadedGraphics","change",function(a){return q.graphicsCollectionChanged(a)},function(){q.clearSymbolsAndGraphics();q.graphicsCollectionChanged({added:q.layerView.loadedGraphics.toArray(),removed:[]})}));this.validateRenderer(this.layer.renderer)},f.prototype.destroy=function(){var a=this;if(this.layerView.view.deconflictor.removeGraphicsOwner(this),
this.clear(),this.stage){var b=[this.stageLayer.getId()];this.labelStageLayer&&b.push(this.labelStageLayer.getId());this.stage.removeFromViewContent(b);b.forEach(function(b){return a.stage.remove(v.ModelContentType.LAYER,b)});this.stage=this.labelStageLayer=this.stageLayer=null}this.tilingSchemeHandle&&(this.tilingSchemeHandle.remove(),this.tilingSchemeHandle=null);this.eventHandles.forEach(function(a){return a.remove()});this.layerView=this.labeling=this.scaleVisibility=this.viewSR=this.onComputedExtentChange=
this.eventHandles=null;for(var c in this.whenGraphics3DGraphicRequests)this.whenGraphics3DGraphicRequests[c].reject(new k("graphic:layer-destroyed","Layer has been destroyed"));this.whenGraphics3DGraphicRequests=null;this.sharedSymbolResourcesOwnerHandle&&(this.sharedSymbolResourcesOwnerHandle.remove(),this.sharedSymbolResourcesOwnerHandle=null)},f.prototype.clear=function(){var a=!1,b;for(b in this.graphics){var c=this.graphics[b],a=a||c.isDraped();c.destroy()}this.graphics={};this.graphicsKeys=
null;for(var d in this.symbols)(b=this.symbols[d])&&b.destroy();this.symbols={};this.graphicsBySymbol={};this.graphicsWithoutSymbol={};this.hasDraped=!1;a&&this.layerView._notifyDrapedDataChange()},f.prototype.initializeStage=function(a,b){this.stage=a._stage;this.stageLayer=new y(b,{state:this.layerView.suspended?"HIDDEN":"VISIBLE"},b);this.stage.add(v.ModelContentType.LAYER,this.stageLayer);a=[this.stageLayer.getId()];this.labeling&&(this.labelStageLayer=new y(b,{state:this.layerView.suspended?
"HIDDEN":"IGNORED"},b+"_labels"),this.stage.add(v.ModelContentType.LAYER,this.labelStageLayer),a.push(this.labelStageLayer.getId()));this.stage.addToViewContent(a)},f.prototype.setDrawingOrder=function(a){this.symbolCreationContext.layerOrder=a;var b={},c={},d;for(d in this.graphics)this.graphics[d].setDrawOrder(a,b,c);for(var e in c)(c=this.symbols[e])&&c.setDrawOrder(a,b);x.objectEmpty(b)||(this.stage.getTextureGraphicsRenderer().updateRenderOrder(b),this.layerView._notifyDrapedDataChange())},f.prototype.suspendedChange=
function(){!0===this.layerView.suspended?(this.stageLayer.setState("HIDDEN"),this.labelStageLayer&&this.labelStageLayer.setState("HIDDEN"),this.hideAllGraphics()):!1===this.layerView.suspended&&(this.stageLayer.setState("VISIBLE"),this.labelStageLayer&&this.labelStageLayer.setState("IGNORED"),this.updateAllGraphicsVisibility())},f.prototype.getGraphics3DGraphics=function(){return this.graphics},f.prototype.getGraphics3DGraphicById=function(a){return this.graphics[a]},f.prototype.getGraphics3DGraphicsKeys=
function(){return null===this.graphicsKeys&&(this.graphicsKeys=Object.keys(this.graphics)),this.graphicsKeys},f.prototype.labelsEnabled=function(){return!(!this.labeling||!this.labeling.layerLabelsEnabled())},f.prototype.getSymbolUpdateType=function(){var a=0,b=0,c=0,d;for(d in this.symbols){var e=this.symbols[d];e&&(e=e.getFastUpdateStatus(),a+=e.loading,c+=e.fast,b+=e.slow)}return 0<a?"unknown":0<=c&&0===b?"fast":0<=b&&0===c?"slow":"mixed"},f.prototype.numNodesUpdating=function(){return this.updatingGraphicIds.size},
f.prototype.needsIdleUpdate=function(){return!!this.lastFastUpdate&&500<performance.now()-this.lastFastUpdate},f.prototype.idleUpdate=function(a){a.done()||(this.lastFastUpdate&&(this.labeling&&this.labeling.updateLabelingInfo(),this.lastFastUpdate=null),this.layerView._evaluateUpdatingState())},f.prototype.whenGraphics3DGraphic=function(b){var c=this.graphics[b.uid];if(c)return a.resolve(c);c=this.whenGraphics3DGraphicRequests[b.uid];return c||(c=new Y,this.whenGraphics3DGraphicRequests[b.uid]=c),
c.promise},f.prototype.boundsForGraphics3DGraphic=function(a){return d(this,void 0,void 0,function(){var b,c,d,f,g,k,l,n,q;return h(this,function(h){switch(h.label){case 0:return b=this.layerView.view.spatialReference,c=this.layerView.view.renderSpatialReference,d=this.layerView.view.basemapTerrain.spatialReference,f=function(a,d,f){return e.bufferToBuffer(a,c,d,a,b,d,f)},g=function(a,c,f){return e.bufferToBuffer(a,d,c,a,b,c,f)},[4,a.getProjectedBoundingBox(f,g,this.elevationQueryService)];case 1:return(k=
h.sent())?(l=k.boundingBox,k.requiresDrapedElevation&&(n=this.symbolCreationContext.elevationProvider,n&&(S.center(l,p),E.x=p[0],E.y=p[1],E.z=void 0,E.spatialReference=b,q=n.getElevation(E)||0,l[2]=Math.min(l[2],q),l[5]=Math.max(l[5],q))),[2,{boundingBox:l,screenSpaceObjects:k.screenSpaceObjects}]):[2,null]}})})},f.prototype.whenGraphicBounds=function(a){var c=this;return b.whenOnce(this.layerView,"loadedGraphics").then(function(){var b=c.layerView.layer&&c.layerView.layer.objectIdField,d=c.layerView.loadedGraphics.find(function(c){return c===
a?!0:b&&c.attributes&&a.attributes&&c.attributes[b]===a.attributes[b]?!0:!1});if(d)return c.whenGraphics3DGraphic(d);throw new k("internal:graphic-not-part-of-view","Graphic is not part of this view");}).then(function(a){return c.boundsForGraphics3DGraphic(a)})},f.prototype.graphicsCollectionChanged=function(a){var b=this.graphicTransformFunc?this.graphicTransformFunc(a.added):a.added;this.add(b);this.remove(a.removed)},f.prototype.graphicUpdateHandler=function(a){var b=this.graphics[a.graphic.uid];
if(b)switch(a.property){case "visible":b.setVisibilityFlag(0,a.newValue)&&(b.isDraped()&&this.layerView._notifyDrapedDataChange(),this.labeling&&this.layerView.view.deconflictor.setDirty())}},f.prototype.beginGraphicUpdate=function(a){this.updatingGraphicIds.add(a.uid);"symbolsUpdating"in this.layerView&&!this.layerView.get("symbolsUpdating")&&this.layerView.set("symbolsUpdating",!0);this.layerView._evaluateUpdatingState()},f.prototype.endGraphicUpdate=function(a){a&&this.updatingGraphicIds["delete"](a.uid);
"symbolsUpdating"in this.layerView&&this.layerView.get("symbolsUpdating")&&0===this.updatingGraphicIds.size&&(this.layerView.view.flushDisplayModifications(),this.layerView.set("symbolsUpdating",!1));this.layerView._evaluateUpdatingState()},f.prototype.expandComputedExtent=function(a){var b,c,d,g,h,k;if("point"===a.type)b=c=a.x,d=g=a.y,a.z&&(h=k=a.z);else if("polygon"===a.type||"polyline"===a.type||"multipoint"===a.type){k=a.extent;if(!k)return;b=k.xmin;c=k.xmax;d=k.ymin;g=k.ymax;h=k.zmin;k=k.zmax}var l=
this.viewSR,n=f.tmpVec;!a.spatialReference.equals(l)&&e.xyzToVector(b,d,0,a.spatialReference,n,l)&&(b=n[0],d=n[1],e.xyzToVector(c,g,0,a.spatialReference,n,l),c=n[0],g=n[1]);H.isFinite(b)&&H.isFinite(c)&&H.isFinite(d)&&H.isFinite(g)&&((l=this.computedExtent)?(b<l.xmin&&(l.xmin=b),c>l.xmax&&(l.xmax=c),d<l.ymin&&(l.ymin=d),g>l.ymax&&(l.ymax=g)):(l=new u(b,d,c,g,a.spatialReference),this.computedExtent=l),H.isFinite(h)&&!H.isFinite(k)&&((null==l.zmin||h<l.zmin)&&(l.zmin=h),(null==l.zmax||k>l.zmax)&&(l.zmax=
k)),this.onComputedExtentChange&&this.onComputedExtentChange())},f.prototype.updateHasDraped=function(){this.hasDraped=!1;for(var a in this.graphicsDrapedIds)if(this.graphicsDrapedIds.hasOwnProperty(a)){this.hasDraped=!0;break}},f.prototype.elevationInfoChange=function(){W(this.layer);var a=N.extractExpressionInfo(this.layer.elevationInfo,this.elevationFeatureExpressionEnabled);this.symbolCreationContext.featureExpressionInfoContext=N.createContext(a,this.viewSR,A);this.labeling&&this.labeling.elevationInfoChange();
this.layer.renderer!==this.symbolCreationContext.renderer&&this.rendererChange(this.layer.renderer);for(var b in this.graphicsBySymbol){var c=this.symbols[b],a=this.graphicsBySymbol[b];if(c&&c.layerPropertyChanged("elevationInfo",a)){for(var d in a){var e=a[d],c=e.graphic,e=e._labelGraphics;this.elevation&&this.elevation.markGraphicElevationDirty(c.uid);for(var f=0;f<e.length;f++){var g=e[f];g.graphics3DSymbolLayer.updateGraphicElevationContext(c,g)}}this.layerView._evaluateUpdatingState()}else this._recreateSymbol(b)}},
f.prototype.clearSymbolsAndGraphics=function(){this.clear();this.elevation&&this.elevation.clear();this.labeling&&this.labeling.clear()},f.prototype.recreateAllGraphics=function(){this.clearSymbolsAndGraphics();this.computedExtent=null;this.onComputedExtentChange&&this.onComputedExtentChange();this.layerView.loadedGraphics&&this.layerView.view.basemapTerrain.tilingScheme&&this.add(this.layerView.loadedGraphics.toArray())},f.prototype._recreateSymbol=function(a){var b=this.graphicsBySymbol[a],c=[],
d=!1,e;for(e in b){var f=b[e];f.isDraped()&&(delete this.graphicsDrapedIds[e],d=!0);c.push(f.graphic);f.destroy();delete this.graphics[e]}this.graphicsBySymbol[a]={};(b=this.symbols[a])&&b.destroy();delete this.symbols[a];this.updateHasDraped();d&&this.layerView._notifyDrapedDataChange();this.add(c)},f.prototype.add=function(a){if(this.layerView.view.basemapTerrain&&this.layerView.view.basemapTerrain.tilingScheme){for(var b=a.length,c=Array(b),d=Array(b),e=Array(b),f=!1,g=0;b>g;g++){var h=a[g],k=
h.geometry;k&&(this.expandComputedExtent(k),k=this.layerView.getRenderingInfo?this.layerView.getRenderingInfo(h):{symbol:h.symbol},(this.graphicsWithoutSymbol[h.uid]=h,k&&k.symbol)?(d[g]=k.symbol,e[g]=k,(k=this.getOrCreateGraphics3DSymbol(d[g],k.renderer))&&(c[g]=k,this.beginGraphicUpdate(h))):f||(f=!0,A.warn("Graphic in layer "+this.layer.id+" has no symbol and will not render")))}for(g=0;b>g;g++)this.waitForSymbol(c[g],d[g],a[g],e[g])}},f.prototype.waitForSymbol=function(a,b,c,d){var e=this;a&&
a.then(function(){e.createGraphics3DGraphic(a,c,d);e.endGraphicUpdate(c);e.labeling&&e.layerView.view.deconflictor.setDirty()},function(){e.endGraphicUpdate(c)})},f.prototype.remove=function(a){for(var b=!1,c=a.length,d=0;c>d;d++){var e=a[d].uid,f=this.graphics[e];if(f){f.isDraped()&&(delete this.graphicsDrapedIds[e],b=!0);var g=f.graphics3DSymbol.symbol.id;f.destroy();delete this.graphics[e];delete this.graphicsBySymbol[g][e];delete this.graphicsWithoutSymbol[e];this.graphicsKeys=null}}this.updateHasDraped();
b&&this.layerView._notifyDrapedDataChange();this.layerView.view.deconflictor.setDirty()},f.prototype.hasLabelingContext=function(a){if(a instanceof z||a instanceof C){var b=this.symbolCreationContext.layer;return b.labelingInfo?b.labelingInfo.some(function(b){return b.symbol===a}):!1}return!1},f.prototype.hasValidSymbolCreationContext=function(a){return a instanceof z&&!this.hasLabelingContext(a)?(A.error("LabelSymbol3D is only valid as part of a LabelClass. Using LabelSymbol3D as a renderer symbol is not supported."),
!1):!0},f.prototype.createGraphics3DSymbol=function(a,b){if(!this.hasValidSymbolCreationContext(a))return null;a=B.to3D(a,!0,!1,this.hasLabelingContext(a));if(a.symbol){var c=void 0;b&&b.backgroundFillSymbol&&(b=B.to3D(b.backgroundFillSymbol,!1,!0),b.symbol&&(c=b.symbol.symbolLayers));return Q.make(a.symbol,this.symbolCreationContext,c)}return a.error&&A.error(a.error.message),null},f.prototype.getOrCreateGraphics3DSymbol=function(a,b){var c=this,d=this.symbols[a.id];return void 0===d&&(d=a instanceof
w?new R(a,function(a){return c.createGraphics3DSymbol(a,b)}):this.createGraphics3DSymbol(a,b),this.symbols[a.id]=d),d},f.prototype.createGraphics3DGraphic=function(a,b,c){if(delete this.graphicsWithoutSymbol[b.uid],!this.symbols[a.symbol.id])return void this.add([b]);this.graphics[b.uid]||(c=a.createGraphics3DGraphic(b,c),this.graphics[b.uid]=c,this.graphicsKeys=null,this.graphicsBySymbol[a.symbol.id]||(this.graphicsBySymbol[a.symbol.id]={}),this.graphicsBySymbol[a.symbol.id][b.uid]=c,c.initialize(this.stageLayer,
this.stage),c.isDraped()&&(this.graphicsDrapedIds[b.uid]=!0,this.hasDraped=!0,this.layerView._notifyDrapedDataChange()),c.centroid=null,"point"!==b.geometry.type&&c instanceof M&&(c.centroid=P.computeCentroid(b.geometry,this.viewSR)),a=this.scaleVisibility&&this.scaleVisibility.scaleRangeActive(),this.spatialIndex&&this.spatialIndex.shouldAddToSpatialIndex(b,c,a)&&this.spatialIndex.addGraphicToSpatialIndex(b,c),this.labeling&&this.labeling.layerLabelsEnabled()&&this.labeling.createLabelsForGraphic(b,
c),a&&this.scaleVisibility.updateGraphicScaleVisibility(b,c),c.setVisibilityFlag(0,b.visible&&!this.layerView.suspended),(a=this.whenGraphics3DGraphicRequests[b.uid])&&(delete this.whenGraphics3DGraphicRequests[b.uid],a.resolve(c)),this.highlights&&this.highlights.graphicCreated(c))},f.prototype.rendererChange=function(a){var b=this.symbolCreationContext.renderer;if(a!==b){this.validateRenderer(a);var c=t.diff(b,a);if(this.updateUnchangedSymbolMappings(c,a,b),this.symbolCreationContext.renderer=a,
c)if("complete"===c.type)this.recreateAllGraphics();else if("partial"===c.type){if(!this.applyRendererDiff(c,a,b))return void this.recreateAllGraphics();this.volatileGraphicsUpdated()}}},f.prototype.diffHasSymbolChange=function(a){for(var b in a.diff)switch(b){case "visualVariables":break;case "defaultSymbol":break;case "uniqueValueInfos":break;case "authoringInfo":case "fieldDelimiter":delete a.diff[b];break;default:return!0}return!1},f.prototype.applySymbolSetDiff=function(a,b,c,d){d=!1;a=a||[];
b=b||[];for(var e=[],f=0;f<b.length;f++){var g=b[f],h=this.graphicsBySymbol[g.id],k;for(k in h){var l=h[k],n=l.graphic;(g!==c.defaultSymbol||c.getSymbol(n)!==c.defaultSymbol)&&(l.isDraped()&&(delete this.graphicsDrapedIds[k],d=!0),a.length||c.defaultSymbol?e.push(n):this.graphicsWithoutSymbol[k]=n,l.destroy(),this.highlights&&this.highlights.graphicDeleted(this.graphics[k]),delete h[k],delete this.graphics[k],this.graphicsKeys=null)}if(void 0===h||0===Object.keys(h).length)delete this.graphicsBySymbol[g.id],
(h=this.symbols[g.id])&&h.destroy(),delete this.symbols[g.id]}if(a.length||e.length){for(k in this.graphicsWithoutSymbol)e.push(this.graphicsWithoutSymbol[k]);this.graphicsWithoutSymbol={};this.add(e)}this.updateHasDraped();d&&this.layerView._notifyDrapedDataChange();this.layerView.view.deconflictor.setDirty()},f.prototype.applyUniqueValueRendererDiff=function(a,b,c){var d=a.diff.defaultSymbol,e=a.diff.uniqueValueInfos;if(d||e){var f=e?e.added.map(function(a){return a.symbol}):[],g=e?e.removed.map(function(a){return a.symbol}):
[];if(e)for(var h=0;h<e.changed.length;h++)f.push(e.changed[h].newValue.symbol),g.push(e.changed[h].oldValue.symbol);return d?(c.defaultSymbol&&g.push(c.defaultSymbol),b.defaultSymbol&&f.push(b.defaultSymbol)):c.defaultSymbol&&f.length&&g.push(b.defaultSymbol),this.applySymbolSetDiff(f,g,b,c),delete a.diff.defaultSymbol,delete a.diff.uniqueValueInfos,!0}return!1},f.prototype.calculateUnchangedSymbolMapping=function(a,b,d){if(b instanceof c&&d instanceof c)if(a){if("partial"===a.type){var e=a.diff;
a=e.defaultSymbol;var e=e.uniqueValueInfos,f=void 0;return f=e?e.unchanged.map(function(a){return{oldId:a.oldValue.symbol.id,newId:a.newValue.symbol.id}}):d.uniqueValueInfos.map(function(a,c){return{oldId:a.symbol.id,newId:b.uniqueValueInfos[c].symbol.id}}),!a&&d.defaultSymbol&&f.push({oldId:d.defaultSymbol.id,newId:b.defaultSymbol.id}),f}}else if(d&&d.defaultSymbol)return[{oldId:d.defaultSymbol.id,newId:b.defaultSymbol.id}];return[]},f.prototype.updateUnchangedSymbolMappings=function(a,b,c){var d=
0;for(a=this.calculateUnchangedSymbolMapping(a,b,c);d<a.length;d++)if(c=a[d],b=c.oldId,c=c.newId,b&&b!==c){var e=this.graphicsBySymbol[b];delete this.graphicsBySymbol[b];void 0!==e&&(this.graphicsBySymbol[c]=e);e=this.symbols[b];delete this.symbols[b];void 0!==e&&(this.symbols[c]=e,e.symbol.id=c)}},f.prototype.applyRendererDiff=function(a,b,d){var e=!1;if(this.diffHasSymbolChange(a))return!1;if(b instanceof c&&d instanceof c&&this.applyUniqueValueRendererDiff(a,b,d)&&0===Object.keys(a.diff).length)return!0;
for(var f in this.graphicsBySymbol)if(d=this.symbols[f]){var g=this.graphicsBySymbol[f];if(!d.applyRendererDiff(a,b,g))return!1;if(!e)for(var h in g)if(g[h].isDraped()){this.layerView._notifyDrapedDataChange();e=!0;break}}return!0},f.prototype.opacityChange=function(){var a=!1,b;for(b in this.graphicsBySymbol){var c=this.symbols[b];if(c){var d=this.graphicsBySymbol[b];if(c.layerPropertyChanged("opacity"),!a)for(var e in d)if(d[e].isDraped()){this.layerView._notifyDrapedDataChange();a=!0;break}}}},
f.prototype.setClippingExtent=function(a,b){var c=this.symbolCreationContext.clippingExtent,d=[];return e.extentToBoundingRect(a,d,b)?this.symbolCreationContext.clippingExtent=[d[0],d[1],-(1/0),d[2],d[3],1/0]:this.symbolCreationContext.clippingExtent=null,!g.equals(this.symbolCreationContext.clippingExtent,c)},f.prototype.forEachGraphics3DGraphic=function(a){var b=this;if(this.layerView.loadedGraphics){var c=!1,d=!1;this.layerView.loadedGraphics.forEach(function(e){var f=b.getGraphics3DGraphicById(e.uid);
f&&a(f,e)&&(c=!0,d=d||f.isDraped())});c&&this.layerView.view.deconflictor.setDirty();d&&this.layerView._notifyDrapedDataChange()}},f.prototype.updateAllGraphicsVisibility=function(){var a=this;this.forEachGraphics3DGraphic(function(b,c){var d=b.setVisibilityFlag(0,c.visible),e=!1;return a.scaleVisibility&&(e=a.scaleVisibility.updateGraphicScaleVisibility(c,b)),d||e})},f.prototype.hideAllGraphics=function(){this.forEachGraphics3DGraphic(function(a){return a.setVisibilityFlag(0,!1)})},f.prototype.validateRenderer=
function(a){(a=q.validateTo3D(a))&&A.warn("Renderer for layer '"+(this.layer.title?this.layer.title+", ":"")+", id:"+this.layer.id+"' is not supported in a SceneView",a.message)},f.prototype.volatileGraphicsUpdated=function(){this.labeling&&(this.lastFastUpdate=performance.now());this.stageLayer.invalidateSpatialQueryAccelerator();this.stageLayer.shaderTransformationChanged();this.layerView._evaluateUpdatingState()},f.createLocalOriginFactory=function(){return new n(5E6,16)},f.prototype.snapshotInternals=
function(){var a=this;return{graphics:Object.keys(this.graphics).sort(),symbols:Object.keys(this.symbols).sort(),graphicsBySymbol:Object.keys(this.graphicsBySymbol).sort().map(function(b){return{symbolId:b,graphics:Object.keys(a.graphicsBySymbol[b]).sort()}}),graphicsWithoutSymbol:Object.keys(this.graphicsWithoutSymbol).sort(),graphicsDrapedIds:Object.keys(this.graphicsDrapedIds).sort()}},f.tmpVec=G.vec3d.create(),f}()})},"esri/core/tsSupport/generatorHelper":function(){define([],function(){return function(m,
l){function h(a){return function(b){return d([a,b])}}function d(d){if(b)throw new TypeError("Generator is already executing.");for(;a;)try{if(b=1,g&&(k=g[2&d[0]?"return":d[0]?"throw":"next"])&&!(k=k.call(g,d[1])).done)return k;switch(g=0,k&&(d=[0,k.value]),d[0]){case 0:case 1:k=d;break;case 4:return a.label++,{value:d[1],done:!1};case 5:a.label++;g=d[1];d=[0];continue;case 7:d=a.ops.pop();a.trys.pop();continue;default:if(k=a.trys,!(k=0<k.length&&k[k.length-1])&&(6===d[0]||2===d[0])){a=0;continue}if(3===
d[0]&&(!k||d[1]>k[0]&&d[1]<k[3]))a.label=d[1];else if(6===d[0]&&a.label<k[1])a.label=k[1],k=d;else if(k&&a.label<k[2])a.label=k[2],a.ops.push(d);else{k[2]&&a.ops.pop();a.trys.pop();continue}}d=l.call(m,a)}catch(c){d=[6,c],g=0}finally{b=k=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}var b,g,k,f,a={label:0,sent:function(){if(1&k[0])throw k[1];return k[1]},trys:[],ops:[]};return f={next:h(0),"throw":h(1),"return":h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),
f}})},"esri/core/tsSupport/awaiterHelper":function(){define(["dojo/Deferred","dojo/when"],function(m,l){return function(h,d,b,g){function k(b){try{a(g.next(b))}catch(q){e.reject(q)}}function f(b){try{a(g["throw"](b))}catch(q){e.reject(q)}}function a(a){a.done?l(a.value).then(e.resolve,e.reject):l(a.value).then(k,f)}var e=new m;return a((g=g.apply(h,d||[])).next()),e.promise}})},"esri/renderers/UniqueValueRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/accessorSupport/decorators ../core/lang ../core/urlUtils ../core/Logger ../core/arrayUtils ../core/Error ../core/accessorSupport/ensureType ../portal/Portal ../support/arcadeUtils ../symbols/WebStyleSymbol ../symbols/support/jsonUtils ../symbols/support/styleUtils ../symbols/support/typeUtils ./Renderer ./support/LegendOptions ./support/UniqueValueInfo ./support/diffUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C){var B=a.getLogger("esri.renderers.UniqueValueRenderer"),F=q.ensureType(z["default"]);return function(a){function l(b){b=a.call(this)||this;return b._valueInfoMap={},b._isDefaultSymbolDerived=!1,b.type="unique-value",b.field=null,b.field2=null,b.field3=null,b.valueExpression=null,b.valueExpressionTitle=null,b.legendOptions=null,b.defaultLabel=null,b.fieldDelimiter=null,b.portal=null,b.styleOrigin=null,b.diff={uniqueValueInfos:function(a,b){if(a||
b){if(!a||!b)return{type:"complete",oldValue:a,newValue:b};for(var c=!1,d={type:"collection",added:[],removed:[],changed:[],unchanged:[]},f=function(f){var g=e.find(a,function(a){return a.value===b[f].value});g?C.diff(g,b[f])?(d.changed.push({type:"complete",oldValue:g,newValue:b[f]}),c=!0):(d.unchanged.push({oldValue:g,newValue:b[f]}),c=!0):(d.added.push(b[f]),c=!0)},g=0;g<b.length;g++)f(g);f=function(f){e.find(b,function(b){return b.value===a[f].value})||(d.removed.push(a[f]),c=!0)};for(g=0;g<a.length;g++)f(g);
return c?d:void 0}}},b._set("uniqueValueInfos",[]),b}return h(l,a),n=l,l.prototype.writeType=function(a,b,c,d){b.type="uniqueValue"},l.prototype.castField=function(a){return null==a?a:"function"==typeof a?a:q.ensureString(a)},l.prototype.writeField=function(a,b,d,e){"string"==typeof a?b[d]=a:e&&e.messages?e.messages.push(new c("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):B.error(".field: cannot write field to JSON since it's not a string value")},
Object.defineProperty(l.prototype,"compiledFunc",{get:function(){return r.createFunction(this.valueExpression)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"defaultSymbol",{set:function(a){this._isDefaultSymbolDerived=!1;this._set("defaultSymbol",a)},enumerable:!0,configurable:!0}),l.prototype.readDefaultSymbol=function(a,b,c){return v.read(a,b,c)},l.prototype.writeDefaultSymbolWebScene=function(a,b,c,d){this._isDefaultSymbolDerived||v.writeTarget(a,b,c,d)},l.prototype.writeDefaultSymbol=
function(a,b,c,d){this._isDefaultSymbolDerived||v.writeTarget(a,b,c,d)},l.prototype.readPortal=function(a,b,c){return c.portal||t.getDefault()},l.prototype.readStyleOrigin=function(a,b,c){if(b.styleName)return Object.freeze({styleName:b.styleName});if(b.styleUrl)return a=f.read(b.styleUrl,c),Object.freeze({styleUrl:a})},l.prototype.writeStyleOrigin=function(a,b,c,d){a.styleName?b.styleName=a.styleName:a.styleUrl&&(b.styleUrl=f.write(a.styleUrl,d),f.isAbsolute(b.styleUrl)&&(b.styleUrl=f.normalize(b.styleUrl)))},
Object.defineProperty(l.prototype,"uniqueValueInfos",{set:function(a){return this.styleOrigin?void B.error("#uniqueValueInfos\x3d","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",a),void this._updateValueInfoMap())},enumerable:!0,configurable:!0}),l.prototype.addUniqueValueInfo=function(a,b){if(this.styleOrigin)return void B.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");
a="object"==typeof a?F(a):new z["default"]({value:a,symbol:b});this.uniqueValueInfos.push(a);this._valueInfoMap[a.value]=a},l.prototype.removeUniqueValueInfo=function(a){if(this.styleOrigin)return void B.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");for(var b=0;b<this.uniqueValueInfos.length;b++)if(this.uniqueValueInfos[b].value===a+""){delete this._valueInfoMap[a];this.uniqueValueInfos.splice(b,1);break}},l.prototype.getUniqueValueInfo=
function(a,b){var c,d=this.field,e=a.attributes;this.valueExpression?c=r.executeFunction(this.compiledFunc,r.createExecContext(a,r.getViewInfo(b))):"function"!=typeof d&&this.field2?(a=this.field2,b=this.field3,c=[],d&&c.push(e[d]),a&&c.push(e[a]),b&&c.push(e[b]),c=c.join(this.fieldDelimiter||"")):"function"==typeof d?c=d(a):d&&(c=e[d]);return this._valueInfoMap[c+""]},l.prototype.getSymbol=function(a,b){return(a=this.getUniqueValueInfo(a,b))&&a.symbol||this.defaultSymbol},l.prototype.getSymbols=
function(){for(var a=[],b=0,c=this.uniqueValueInfos;b<c.length;b++){var d=c[b];d.symbol&&a.push(d.symbol)}return this.defaultSymbol&&a.push(this.defaultSymbol),a},l.prototype.clone=function(){var a=new n({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:k.clone(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:k.clone(this.visualVariables),legendOptions:k.clone(this.legendOptions),
authoringInfo:this.authoringInfo&&this.authoringInfo.clone()});this._isDefaultSymbolDerived&&(a._isDefaultSymbolDerived=!0);a._set("portal",this.portal);var b=k.clone(this.uniqueValueInfos);return this.styleOrigin&&(a._set("styleOrigin",Object.freeze(k.clone(this.styleOrigin))),Object.freeze(b)),a._set("uniqueValueInfos",b),a._updateValueInfoMap(),a},l.prototype.collectRequiredFields=function(a){this.inherited(arguments);[this.field,this.field2,this.field3].forEach(function(b){b&&"string"==typeof b&&
(a[b]=!0)});this.valueExpression&&r.extractFieldNames(this.valueExpression).forEach(function(b){a[b]=!0})},l.prototype.populateFromStyle=function(){var a=this;return x.fetchStyle(this.styleOrigin,{portal:this.portal}).then(function(b){var c=[];return a._valueInfoMap={},b&&b.data&&Array.isArray(b.data.items)&&b.data.items.forEach(function(d){var e=new u({styleUrl:b.styleUrl,styleName:b.styleName,portal:a.portal,name:d.name});a.defaultSymbol||d.name!==b.data.defaultItem||(a.defaultSymbol=e,a._isDefaultSymbolDerived=
!0);e=new z["default"]({value:d.name,symbol:e});c.push(e);a._valueInfoMap[d.name]=e}),a._set("uniqueValueInfos",Object.freeze(c)),!a.defaultSymbol&&a.uniqueValueInfos.length&&(a.defaultSymbol=a.uniqueValueInfos[0].symbol,a._isDefaultSymbolDerived=!0),a})},l.prototype._updateValueInfoMap=function(){var a=this;this._valueInfoMap={};this.uniqueValueInfos.forEach(function(b){return a._valueInfoMap[b.value+""]=b})},l.fromPortalStyle=function(a,b){var c=new n(b&&b.properties);c._set("styleOrigin",Object.freeze({styleName:a}));
c._set("portal",b&&b.portal||t.getDefault());b=c.populateFromStyle();return b.otherwise(function(b){B.error("#fromPortalStyle('"+a+"'[, ...])","Failed to create unique value renderer from style name",b)}),b},l.fromStyleUrl=function(a,b){b=new n(b&&b.properties);b._set("styleOrigin",Object.freeze({styleUrl:a}));b=b.populateFromStyle();return b.otherwise(function(b){B.error("#fromStyleUrl('"+a+"'[, ...])","Failed to create unique value renderer from style URL",b)}),b},d([g.property()],l.prototype,"type",
void 0),d([g.writer("type")],l.prototype,"writeType",null),d([g.property({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],l.prototype,"field",void 0),d([g.cast("field")],l.prototype,"castField",null),d([g.writer("field")],l.prototype,"writeField",null),d([g.property({type:String,json:{write:!0}})],l.prototype,"field2",void 0),d([g.property({type:String,json:{write:!0}})],l.prototype,"field3",void 0),d([g.property({type:String,json:{write:!0}})],l.prototype,"valueExpression",void 0),
d([g.property({type:String,json:{write:!0}})],l.prototype,"valueExpressionTitle",void 0),d([g.property({dependsOn:["valueExpression"]})],l.prototype,"compiledFunc",null),d([g.property({type:w["default"],json:{write:!0}})],l.prototype,"legendOptions",void 0),d([g.property({type:String,json:{write:!0}})],l.prototype,"defaultLabel",void 0),d([g.property({types:y.types})],l.prototype,"defaultSymbol",null),d([g.reader("defaultSymbol")],l.prototype,"readDefaultSymbol",null),d([g.writer("web-scene","defaultSymbol",
{defaultSymbol:{types:y.types3D}})],l.prototype,"writeDefaultSymbolWebScene",null),d([g.writer("defaultSymbol")],l.prototype,"writeDefaultSymbol",null),d([g.property({type:String,json:{write:!0}})],l.prototype,"fieldDelimiter",void 0),d([g.property({type:t,readOnly:!0})],l.prototype,"portal",void 0),d([g.reader("portal",["styleName"])],l.prototype,"readPortal",null),d([g.property({readOnly:!0})],l.prototype,"styleOrigin",void 0),d([g.reader("styleOrigin",["styleName","styleUrl"])],l.prototype,"readStyleOrigin",
null),d([g.writer("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],l.prototype,"writeStyleOrigin",null),d([g.property({type:[z["default"]],json:{write:{overridePolicy:function(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],l.prototype,"uniqueValueInfos",null),d([g.property({dependsOn:["field","field2","field3","valueExpression"],readOnly:!0})],l.prototype,"requiredFields",void 0),d([b(1,g.cast(y.ensureType))],l.prototype,"addUniqueValueInfo",null),l=n=d([g.subclass("esri.renderers.UniqueValueRenderer")],
l);var n}(g.declared(n))})},"esri/symbols/support/styleUtils":function(){define("require exports ../Symbol3D ./jsonUtils ./Thumbnail ./StyleOrigin ../../core/urlUtils ../../core/promiseUtils ../../core/Error ../../request ../../portal/Portal ../../portal/PortalQueryParams".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q){function t(a,b){return y(a).then(function(b){return{data:b.data,baseUrl:k.removeFile(a),styleUrl:a}})}function r(a,b){var d;b=b.portal||c.getDefault();var e=b.url+" - "+(b.user&&b.user.username)+
" - "+a;return n[e]||(n[e]=u(a,b).then(function(a){return d=a,a.fetchData()}).then(function(b){return{data:b,baseUrl:d.itemUrl,styleName:a}})),n[e]}function u(b,c){return c.load().then(function(){var a=new q({disableExtraQuery:!0,query:"owner:"+w+" AND type:"+z+' AND typekeywords:"'+b+'"'});return c.queryItems(a)}).then(function(c){c=c.results;var d=null,e=b.toLowerCase();if(c&&Array.isArray(c))for(var f=0;f<c.length;f++){var g=c[f];if(g.typeKeywords.some(function(a){return a.toLowerCase()===e})&&
g.type===z&&g.owner===w){d=g;break}}if(d)return d.load();throw new a("symbolstyleutils:style-not-found","The style '"+b+"' could not be found",{styleName:b});})}function v(b,c){return b.styleUrl?t(b.styleUrl,c):b.styleName?r(b.styleName,c):f.reject(new a("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function x(c,e,l){for(var n=c.data,q={portal:l.portal,url:k.urlToObject(c.baseUrl),origin:"portal-item"},m=function(a){if(a.name!==e)return"continue";
var f=k.read(a.webRef,q),n={portal:l.portal,url:k.urlToObject(k.removeFile(f)),origin:"portal-item"};return{value:y(f).then(function(f){if((f=d.fromJSON(f.data,n))&&f.isInstanceOf(h)){if(a.thumbnail)if(a.thumbnail.href){var m=k.read(a.thumbnail.href,q);f.thumbnail=new b["default"]({url:m})}else a.thumbnail.imageData&&(f.thumbnail=new b["default"]({url:"data:image/png;base64,"+a.thumbnail.imageData}));c.styleUrl?f.styleOrigin=new g({portal:l.portal,styleUrl:c.styleUrl,name:e}):c.styleName&&(f.styleOrigin=
new g({portal:l.portal,styleName:c.styleName,name:e}))}return f})}},r=0,n=n.items;r<n.length;r++){var t=m(n[r]);if("object"==typeof t)return t.value}return f.reject(new a("symbolstyleutils:symbol-name-not-found","The symbol name '"+e+"' could not be found",{symbolName:e}))}function y(a){var b={responseType:"json"};return b.query={f:"json"},e(k.normalize(a),b)}Object.defineProperty(l,"__esModule",{value:!0});var n={};l.fetchStyle=v;l.resolveWebStyleSymbol=function(b,c){return b.name?v(b,c).then(function(a){return x(a,
b.name,c)}):f.reject(new a("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};l.fetchSymbolFromStyle=x;l.styleNameFromItem=function(a){var b=0;for(a=a.typeKeywords;b<a.length;b++){var c=a[b];if(/^Esri.*Style$/.test(c)&&"Esri Style"!==c)return c}};var w="esri_en",z="Style"})},"esri/renderers/Renderer":function(){define("../core/declare ../core/Accessor ../core/JSONSupport ../core/kebabDictionary ../core/screenUtils ../core/lang ../core/Error ../support/arcadeUtils dojo/_base/lang ../Color ./support/utils ./support/AuthoringInfo".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){var t=d({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),r=d({widthAndDepth:"width-and-depth"}),u=d({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"}),v=(d({classedSize:"classed-size",classedColor:"classed-color",univariateColorSize:"univariate-color-size"}),
d({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),d({percentTotal:"percent-of-total"}),Math.PI);return m([l,h],{declaredClass:"esri.renderers.Renderer",properties:{authoringInfo:{type:q,value:null,json:{write:!0}},requiredFields:{dependsOn:["visualVariables"],get:function(){var a=Object.create(null);return this.collectRequiredFields(a),Object.keys(a)}},
type:{type:String,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}},visualVariables:{json:{read:{source:["visualVariables","rotationType","rotationExpression"],reader:function(a,b){return this._readVariables(a,b)}},write:function(a,b,c,d){var e=[];a.forEach(function(a,b){"size"===a.type?e.push(this._writeSizeInfo(a,d,b)):"color"===a.type?e.push(this._writeColorInfo(a,d,b)):"opacity"===a.type?e.push(this._writeOpacityInfo(a,d,b)):"rotation"===a.type&&e.push(this._writeRotationInfo(a,d,b))},this);
b.visualVariables=e}}}},constructor:function(){this._cache={}},_rotationRE:/^\[([^\]]+)\]$/i,_viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,_visualVariablesSetter:function(a){var b=this._cache;this.visualVariables&&this.visualVariables.forEach(function(a,c){b.hasOwnProperty(c)&&(b[c]=null)},this);a&&a.some(function(a){return!!a.target})&&a.sort(function(a,b){return a.target===b.target?0:a.target?1:-1});a&&a.forEach(function(a,c){"color"===a.type?b[c]=this._processColorInfo(a):"opacity"===
a.type?b[c]=this._processOpacityInfo(a):"size"===a.type?b[c]=this._processSizeInfo(a):"rotation"===a.type&&(b[c]=this._processRotationInfo(a))},this);this._set("visualVariables",a)},getSymbol:function(a,b){},getVisualVariableValues:function(b,c){var d,e=this.visualVariables;return e&&(d=e.map(function(d){var e,f=d.type,g=f+"Info";switch(c=a.mixin({},c),c[g]=d,f){case "size":e=this.getSize(b,c);break;case "color":e=this.getColor(b,c);break;case "opacity":e=this.getOpacity(b,c);break;case "rotation":e=
this.getRotationAngle(b,c)}return{variable:d,value:e}},this).filter(function(a){return null!=a.value},this)),d},hasVisualVariables:function(a,b){return a?!!this.getVisualVariablesForType(a,b):!!(this.getVisualVariablesForType("size",b)||this.getVisualVariablesForType("color",b)||this.getVisualVariablesForType("opacity",b)||this.getVisualVariablesForType("rotation",b))},getVisualVariablesForType:function(a,b){var c,d=this.visualVariables;return d&&(c=d.filter(function(c){return c.type===a&&("string"==
typeof b?c.target===b:!1===b?!c.target:!0)}),c&&0===c.length&&(c=void 0)),c},getSize:function(a,b){var c=this._getVarInfo(b&&b.sizeInfo,"size"),d=c.variable,c=this._cache[c.cacheKey],e=null;if(d)var f=d.minSize,e=d.maxSize,f="object"==typeof f&&f?this._getSize(a,f,c&&c.minSize,b):f,e="object"==typeof e&&e?this._getSize(a,e,c&&c.maxSize,b):e,e=this._getSize(a,d,c&&c.root,b,[f,e]);return e},getSizeRangeAtScale:function(a,b){var c,d=this._getVarInfo(a,"size"),e=this._cache[d.cacheKey],f={scale:b};if(a=
d.variable,a&&b)if(b=a.minSize,a=a.maxSize,b="object"==typeof b&&b?this._getSize({},b,e&&e.minSize,f):b,e="object"==typeof a&&a?this._getSize({},a,e&&e.maxSize,f):a,null!=b||null!=e)b>e&&(b=e=b),c={minSize:b,maxSize:e};return c},getColor:function(a,b){var c=this._getVarInfo(b&&b.colorInfo,"color");return this._getColorComponent(a,c.variable,this._cache[c.cacheKey],b)},getOpacity:function(a,b){var c=this._getVarInfo(b&&b.opacityInfo,"opacity");return this._getColorComponent(a,c.variable,this._cache[c.cacheKey],
b,!0)},getRotationAngle:function(b,c){var d=this._getVarInfo(c&&c.rotationInfo,"rotation"),e=d.variable,g=this._cache[d.cacheKey],h=e.axis||"heading",d="heading"===h&&"arithmetic"===e.rotationType?90:0,h="heading"===h&&"arithmetic"===e.rotationType?-1:1,e=e.field,g=g&&g.compiledFunc,k=b.attributes,l=0;return(e||g)&&(g?l=f.executeFunction(g,f.createExecContext(b,f.getViewInfo(c))):a.isFunction(e)?l=e.apply(this,arguments):k&&(l=k[e]||0),l="number"!=typeof l||isNaN(l)?null:d+h*l),l},collectRequiredFields:function(a){var b=
[];this.visualVariables&&(b=b.concat(this.visualVariables));b.forEach(function(b){b&&(b.field&&(a[b.field]=!0),b.normalizationField&&(a[b.normalizationField]=!0),b.valueExpression&&f.extractFieldNames(b.valueExpression).forEach(function(b){a[b]=!0}))})},_getVarInfo:function(a,b){var c;a&&a.type===b&&this.visualVariables?(c=this.visualVariables.indexOf(a),a=this.visualVariables[c]):this.visualVariables&&(a=(a=this.getVisualVariablesForType(b))&&a[0],c=this.visualVariables.indexOf(a));return{variable:a,
cacheKey:c}},_readSizeInfo:function(a){return a.axis&&(a.axis=r.fromJSON(a.axis)),a.valueUnit&&(a.valueUnit=u.fromJSON(a.valueUnit)),a},_readColorInfo:function(b){return b&&(b.colors&&b.colors.forEach(function(c,d){a.isArray(c)?b.colors[d]=e.fromJSON(c):b.colors[d]=new e(c)}),b.stops&&b.stops.forEach(function(c,d){c.color&&a.isArray(c.color)?b.stops[d].color=e.fromJSON(c.color):c.color&&(b.stops[d].color=new e(c.color))})),b},_readOpacityInfo:function(b){var c;return b&&(c=a.mixin({},b),c.transparencyValues&&
(c.opacityValues=c.transparencyValues.map(function(a){return 1-a/100}),delete c.transparencyValues),c.stops&&(c.stops=c.stops.map(function(b){return b=a.mixin({},b),b.opacity=1-b.transparency/100,delete b.transparency,b}))),c},_readVariables:function(a,b){a&&(a=a.map(function(a){return a=g.clone(a),a.type=t.fromJSON(a.type),"size"===a.type?a=this._readSizeInfo(a):"color"===a.type?a=this._readColorInfo(a):"opacity"===a.type&&(a=this._readOpacityInfo(a)),a},this));var c=b.rotationType;if(b=b.rotationExpression)c=
{type:"rotation",rotationType:c},(b=b.match(this._rotationRE))&&b[1]&&(c.field=b[1],a||(a=[]),a.push(c));return a},_createCache:function(a){var b=a&&a.valueExpression,c=f.createSyntaxTree(b),c=f.createFunction(c),d=!(!a||!a.expression)||this._viewScaleRE.test(b);return{ipData:this._interpolateData(a),hasExpr:!!b,compiledFunc:c,isScaleDriven:d}},_processColorInfo:function(a){return a&&(a.colors&&a.colors.forEach(function(b,c){b instanceof e||(a.colors[c]=new e(b))}),a.stops&&a.stops.forEach(function(b,
c){!b.color||b.color instanceof e||(a.stops[c].color=new e(b.color))}),this._sortStops(a.stops)),this._createCache(a)},_processOpacityInfo:function(a){return this._sortStops(a&&a.stops),this._createCache(a)},_processSizeInfo:function(a){return a.stops&&Array.isArray(a.stops)?a.stops=this._processSizeInfoStops(a.stops):(a.minSize=a.minSize&&this._processSizeInfoSize(a.minSize),a.maxSize=a.maxSize&&this._processSizeInfoSize(a.maxSize)),{root:this._createCache(a),minSize:this._createCache(a.minSize),
maxSize:this._createCache(a.maxSize)}},_processSizeInfoSize:function(a){return"object"==typeof a?a.stops=this._processSizeInfoStops(a.stops):a=b.toPt(a),a},_processSizeInfoStops:function(a){return a&&Array.isArray(a)&&(a.forEach(function(a){a.size=b.toPt(a.size)}),this._sortStops(a)),a},_sortStops:function(a){a&&Array.isArray(a)&&a.sort(function(a,b){return a.value-b.value})},_processRotationInfo:function(a){return this._createCache(a)},_getSize:function(b,d,e,g,h){var k=b.attributes,l=d.field,n=
d.stops,q=0,m=e&&e.hasExpr,r=e&&e.compiledFunc,t=e&&e.ipData,u=e&&e.isScaleDriven,w="number"==typeof b,x=w?b:null;if(l||u||m){var y,z=g&&g.scale,H=h?h[0]:d.minSize,Y=h?h[1]:d.maxSize,W=d.minDataValue,E=d.maxDataValue,p=d.valueUnit||"unknown",A=d.valueRepresentation,K=d.scaleBy,U=d.normalizationField,V=k?parseFloat(k[U]):void 0,X=g&&g.shape;if(u?x=null==z?this._getAverageValue(d):z:"number"!=typeof x&&(m?x=f.executeFunction(r,f.createExecContext(b,f.getViewInfo(g))):a.isFunction(l)?x=l.apply(this,
arguments):k&&(x=k[l])),null==x||U&&!w&&(isNaN(V)||0===V))return null;if(isNaN(V)||w||(x/=V),n){var ba,fa,Y=this._lookupData(x,t);y=Y[0];H=Y[1];y===H?q=n[y].size:(ba=n[y].size,fa=n[H].size,q=ba+(fa-ba)*Y[2])}else null!=H&&null!=Y&&null!=W&&null!=E?W>=x?q=H:x>=E?q=Y:(y=(x-W)/(E-W),"area"===K&&X)?(n=(q="circle"===X)?v*Math.pow(H/2,2):H*H,n+=y*((q?v*Math.pow(Y/2,2):Y*Y)-n),q=q?2*Math.sqrt(n/v):Math.sqrt(n)):q=H+y*(Y-H):"unknown"===p?null!=H&&null!=W?(H&&W?(y=x/W,q="circle"===X?2*Math.sqrt(y*Math.pow(H/
2,2)):"square"===X||"diamond"===X||"image"===X?Math.sqrt(y*Math.pow(H,2)):y*H):q=x+(H||W),q=H>q?H:q,null!=Y&&q>Y&&(q=Y)):q=x:(n=(g&&g.resolution?g.resolution:1)*c.meterIn[p],"area"===A?(q=Math.sqrt(x/v)/n,q*=2):(q=x/n,("radius"===A||"distance"===A)&&(q*=2)),null!=H&&H>q&&(q=H),null!=Y&&q>Y&&(q=Y))}else d&&(q=n&&n[0]&&n[0].size,null==q&&(q=d.minSize));return q=isNaN(q)?0:q},_getAverageValue:function(a){var b,c,d=a.stops;return d?(b=d[0].value,c=d[d.length-1].value):(b=a.minDataValue||0,c=a.maxDataValue||
0),(b+c)/2},_getColorComponent:function(b,c,d,e,g,h){var k,l=b.attributes,n=c&&c.field,q="number"==typeof b,m=q?b:null,r=d&&d.hasExpr,t=d&&d.compiledFunc,u=d&&d.ipData;if(n||r){var v=c.normalizationField,w=l?parseFloat(l[v]):void 0;"number"!=typeof m&&(r?m=f.executeFunction(t,f.createExecContext(b,f.getViewInfo(e))):a.isFunction(n)?m=n.apply(this,arguments):l&&(m=l[n]));null==m||v&&!q&&(isNaN(w)||0===w)||(isNaN(w)||q||(m/=w),k=g?this._getOpacity(m,c,u):this._getColor(m,c,u))}else c&&(l=c.stops,g?
(k=l&&l[0]&&l[0].opacity,null==k&&(k=c.opacityValues&&c.opacityValues[0])):k=l&&l[0]&&l[0].color||c.colors&&c.colors[0]);return h&&(h.data=m,h.value=k),h||k},_interpolateData:function(a){var b;if(a)if(a.colors||a.opacityValues){var c=(a.colors||a.opacityValues).length,d=a.minDataValue,e=(a.maxDataValue-d)/(c-1);b=[];for(a=0;c>a;a++)b[a]=d+a*e}else a.stops&&(b=a.stops.map(function(a){return a.value}));return b},_getOpacity:function(a,b,c){var d;a=this._lookupData(a,c);if(b=b||this.opacityInfo,a){var e,
f;c=a[0];var g=a[1];c===g?d=this._getOpacValue(b,c):(e=this._getOpacValue(b,c),f=this._getOpacValue(b,g),d=e+(f-e)*a[2])}return d},_getOpacValue:function(a,b){return a.opacityValues?a.opacityValues[b]:a.stops[b].opacity},_getColor:function(a,b,c){var d;a=this._lookupData(a,c);if(b=b||this.colorInfo,a)d=a[0],c=a[1],d=d===c?this._getColorObj(b,d):e.blendColors(this._getColorObj(b,d),this._getColorObj(b,c),a[2]),d=new e(d);return d},_getColorObj:function(a,b){return a.colors?a.colors[b]:a.stops[b].color},
_lookupData:function(a,b){var c;if(b){var d=0,e=b.length-1;b.some(function(b,c){return b>a?(e=c,!0):(d=c,!1)});c=[d,e,(a-b[d])/(b[e]-b[d])]}return c},_processForContext:function(a,b,c){if(b&&"web-scene"===b.origin){var d=null!=a.expression,e=null!=a.valueExpressionTitle&&"rotation"===a.type;b.messages&&(d&&b.messages.push(new k("property:unsupported",a.type+"VisualVariable.expression is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:c+".expression",
context:b})),e&&b.messages.push(new k("property:unsupported",a.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:c+".valueExpressionTitle",context:b})));d&&delete a.expression;e&&delete a.valueExpressionTitle}else"size"===a.type&&this._convertExpressionToArcade(a)},_writeRotationInfo:function(b,c,d){return b&&(b=a.mixin({},b),this._processForContext(b,c,"visualVariables["+d+"]"),b.type=t.toJSON(b.type),
b=g.fixJson(b,!0)),b},_convertExpressionToArcade:function(a){a&&a.expression&&(a.valueExpression="$view.scale")},_writeSizeInfo:function(b,c,d){if(b){b=a.mixin({},b);this._processForContext(b,c,"string"==typeof d?d:"visualVariables["+d+"]");var e=b.minSize,f=b.maxSize;e&&(b.minSize="number"==typeof e?e:this._writeSizeInfo(e,c,"visualVariables["+d+"].minSize"));f&&(b.maxSize="number"==typeof f?f:this._writeSizeInfo(f,c,"visualVariables["+d+"].maxSize"));c=b.legendOptions;d=b.axis;b.type=t.toJSON(b.type);
d&&(b.axis=r.toJSON(d));c&&(b.legendOptions=a.mixin({},c),c=c.customValues,c&&(b.legendOptions.customValues=c.slice(0)));b.stops&&(b.stops=b.stops.map(function(b){return b=a.mixin({},b),null===b.label&&delete b.label,b}));b=g.fixJson(b,!0)}return b},_writeColorInfo:function(b,c,d){return b&&(b=a.mixin({},b),this._processForContext(b,c,"visualVariables["+d+"]"),b.type=t.toJSON(b.type),b.colors&&(b.colors=b.colors.map(function(a){return e.toJSON(a)})),b.stops&&(b.stops=b.stops.map(function(b){return b=
a.mixin({},b),b.color&&(b.color=e.toJSON(b.color)),null===b.label&&delete b.label,b})),b.legendOptions&&(b.legendOptions=a.mixin({},b.legendOptions)),b=g.fixJson(b,!0)),b},_writeOpacityInfo:function(b,c,d){var e;return b&&(e=a.mixin({},b),this._processForContext(e,c,"visualVariables["+d+"]"),e.type=t.toJSON(e.type),e.opacityValues&&(e.transparencyValues=e.opacityValues.map(function(a){return Math.max(0,Math.min(Math.round(100*(1-a)),100))}),delete e.opacityValues),e.stops&&(e.stops=e.stops.map(function(b){b=
a.mixin({},b);return b.transparency=Math.max(0,Math.min(Math.round(100*(1-b.opacity)),100)),delete b.opacity,null===b.label&&delete b.label,b})),e.legendOptions&&(e.legendOptions=a.mixin({},e.legendOptions)),e=g.fixJson(e,!0)),e}})})},"esri/renderers/support/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/date/locale ../../Color ../../core/numberUtils dojo/i18n!dojo/cldr/nls/gregorian".split(" "),function(m,l,h,d,b,g){function k(a){return a&&l.map(a,function(a){return new d(a)})}function f(a,
b,c){var d="";return 0===b?d=e.lt+" ":b===c&&(d=e.gt+" "),d+a}var a={},e={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},c={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},q={millisecond:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},second:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},minute:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},hour:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},
day:{selector:"date",dateOptions:{formatLength:"long"}},month:{selector:"date",dateOptions:{formatLength:"long"}},year:{selector:"date",dateOptions:{selector:"year"}}},t={formatLength:"short",fullYear:!0},r={formatLength:"short"};return m.mixin(a,{meterIn:{inches:1/.0254,feet:1/.3048,"us-feet":3.28084,yards:1/.9144,miles:1/1609.344,"nautical-miles":1/1852,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:.001,"decimal-degrees":180/20015077},timelineDateFormatOptions:{selector:"date",
dateOptions:{formatLength:"short",fullYear:!0}},formatDate:function(a,b){var c,d=[];null==a||a instanceof Date||(a=new Date(a));b=b||{};b=m.mixin({},b);var e=b.selector?b.selector.toLowerCase():null,f=!e||-1<e.indexOf("time"),e=!e||-1<e.indexOf("date");return f&&(b.timeOptions=b.timeOptions||r,b.timeOptions&&(b.timeOptions=m.mixin({},b.timeOptions),b.timeOptions.selector=b.timeOptions.selector||"time",d.push(b.timeOptions))),e&&(b.dateOptions=b.dateOptions||t,b.dateOptions&&(b.dateOptions=m.mixin({},
b.dateOptions),b.dateOptions.selector=b.dateOptions.selector||"date",d.push(b.dateOptions))),d&&d.length?(d=l.map(d,function(b){return h.format(a,b)}),c=1==d.length?d[0]:g["dateTimeFormat-medium"].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,b){return d[b]})):c=h.format(a),c},createColorStops:function(c){var d=c.values,e=c.colors,g=c.labelIndexes,h=c.isDate,k=c.dateFormatOptions;return l.map(d,function(c,n){var q=null;if(!g||-1<l.indexOf(g,n)){var m;(m=h?a.formatDate(c,k):b.format(c))&&(q=f(m,
n,d.length-1))}return{value:c,color:e[n],label:q}})},updateColorStops:function(c){var d,e=c.stops,g=c.changes,h=c.isDate,k=c.dateFormatOptions,q=[],m=l.map(e,function(a){return a.value});l.forEach(g,function(a){q.push(a.index);m[a.index]=a.value});d=b.round(m,{indexes:q});l.forEach(e,function(c,g){if(c.value=m[g],null!=c.label){var l,n=null;(l=h?a.formatDate(d[g],k):b.format(d[g]))&&(n=f(l,g,e.length-1));c.label=n}})},createClassBreakLabel:function(a){var c=a.minValue,d=a.maxValue,f=a.isFirstBreak?
"":e.gt+" ";a="percent-of-total"===a.normalizationType?e.pct:"";return c=null==c?"":b.format(c),d=null==d?"":b.format(d),f+c+a+" "+e.ld+" "+d+a},setLabelsForClassBreaks:function(c){var d=c.classBreakInfos,e=c.classificationMethod,f=c.normalizationType,g=[];d&&d.length&&("standard-deviation"===e?console.log("setLabelsForClassBreaks: cannot set labels for class breaks generated using 'standard-deviation' method."):c.round?(g.push(d[0].minValue),l.forEach(d,function(a){g.push(a.maxValue)}),g=b.round(g),
l.forEach(d,function(b,c){b.label=a.createClassBreakLabel({minValue:0===c?g[0]:g[c],maxValue:g[c+1],isFirstBreak:0===c,normalizationType:f})})):l.forEach(d,function(b,c){b.label=a.createClassBreakLabel({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===c,normalizationType:f})}))},updateClassBreak:function(b){var c,d=b.classBreaks,e=b.normalizationType,f=b.change,g=f.index,f=f.value,h=-1,k=-1,l=d.length;return"standard-deviation"===b.classificationMethod?void console.log("updateClassBreak: cannot update labels for class breaks generated using 'standard-deviation' method."):
(0===g?h=g:g===l?k=g-1:(k=g-1,h=g),-1<h&&l>h&&(c=d[h],c.minValue=f,c.label=a.createClassBreakLabel({minValue:c.minValue,maxValue:c.maxValue,isFirstBreak:0===h,normalizationType:e})),void(-1<k&&l>k&&(c=d[k],c.maxValue=f,c.label=a.createClassBreakLabel({minValue:c.minValue,maxValue:c.maxValue,isFirstBreak:0===k,normalizationType:e}))))},calculateDateFormatInterval:function(a){var b,d,e,f,g,h,k,q,m,r=a.length,t=1/0;a=l.map(a,function(a){return new Date(a)});for(b=0;r-1>b;b++){e=a[b];g=[];k=1/0;q="";
for(d=b+1;r>d;d++)f=a[d],f=e.getFullYear()!==f.getFullYear()&&"year"||e.getMonth()!==f.getMonth()&&"month"||e.getDate()!==f.getDate()&&"day"||e.getHours()!==f.getHours()&&"hour"||e.getMinutes()!==f.getMinutes()&&"minute"||e.getSeconds()!==f.getSeconds()&&"second"||"millisecond",h=c[f],k>h&&(k=h,q=f),g.push(f);t>k&&(t=k,m=q)}return m},createUniqueValueLabel:function(c){var d=c.value,e=c.fieldInfo,f=c.domain;c=c.dateFormatInterval;var g=String(d),f=f&&f.codedValues?f.getName(d):null;return f?g=f:"number"==
typeof d&&(g=e&&"date"===e.type?a.formatDate(d,c&&q[c]):b.format(d)),g},cloneColorVariable:function(a){var b;return a&&(b=m.mixin({},a),b.colors=k(b.colors),b.stops=b.stops&&l.map(b.stops,function(a){return a=m.mixin({},a),a.color&&(a.color=new d(a.color)),a}),b.legendOptions&&(b.legendOptions=m.mixin({},b.legendOptions))),b},cloneOpacityVariable:function(a){var b;a&&(b=m.mixin({},a),(a=b.opacityValues)&&(b.opacityValues=a.slice(0)),(a=b.stops)&&(b.stops=l.map(a,function(a){return m.mixin({},a)})),
(a=b.legendOptions)&&(b.legendOptions=m.mixin({},a)));return b},cloneSizeVariable:function(b){var c;b&&(c=m.mixin({},b),c.stops&&(c.stops=l.map(c.stops,function(a){return m.mixin({},a)})),(b=c.minSize)&&"object"==typeof b&&(c.minSize=a.cloneSizeVariable(b)),(b=c.maxSize)&&"object"==typeof b&&(c.maxSize=a.cloneSizeVariable(b)),(b=c.legendOptions)&&(c.legendOptions=m.mixin({},b),b=b.customValues,b&&(c.legendOptions.customValues=b.slice(0))));return c}}),a})},"esri/core/numberUtils":function(){define(["dojo/number",
"dojo/i18n!dojo/cldr/nls/number"],function(m,l){function h(b,a){return b-a}var d=/^-?(\d+)(\.(\d+))?$/i,b=new RegExp("\\"+l.decimal+"0+$","g"),g=/(\d)0*$/g,k={numDigits:function(b){var a=String(b),e=a.match(d);b={integer:0,fractional:0};if(e&&e[1])b.integer=e[1].split("").length,b.fractional=e[3]?e[3].split("").length:0;else if(-1<a.toLowerCase().indexOf("e")){var c,f,e=a.split("e"),a=e[0],e=e[1];a&&e&&(a=Number(a),e=Number(e),f=0<e,f||(e=Math.abs(e)),c=k.numDigits(a),f?(c.integer+=e,e>c.fractional?
c.fractional=0:c.fractional-=e):(c.fractional+=e,e>c.integer?c.integer=1:c.integer-=e),b=c)}return b},percentChange:function(b,a,d,c){var e,f,g,h={previous:null,next:null};return null!=d&&(e=b-d,f=a-d,g=f-e,h.previous=Math.floor(Math.abs(100*g/e))),null!=c&&(e=c-b,f=c-a,g=f-e,h.next=Math.floor(Math.abs(100*g/e))),h},round:function(b,a){var d,c,f,g,l,m,v,x,y,n;b=b.slice(0);var w=a&&null!=a.tolerance?a.tolerance:2,z=a&&a.indexes,C=a&&null!=a.strictBounds?a.strictBounds:!1;if(z)z.sort(h);else for(z=
[],v=0;v<b.length;v++)z.push(v);for(v=0;v<z.length;v++)if(n=z[v],d=b[n],a=0===n?null:b[n-1],c=n===b.length-1?null:b[n+1],f=k.numDigits(d),g=f.fractional){x=0;for(y=!1;g>=x&&!y;){m=d;y=x;var B=l=void 0;m=(l=Number(m.toFixed(y)),m>l?B=l+1/Math.pow(10,y):(B=l,l-=1/Math.pow(10,y)),l=Number(l.toFixed(y)),B=Number(B.toFixed(y)),[l,B]);l=C&&0===v?m[1]:m[0];y=w;m=B=void 0;var F=k.percentChange(d,l,a,c);y=(B=null==F.previous||F.previous<=y,m=null==F.next||F.next<=y,B&&m||F.previous+F.next<=2*y);x++}y&&(b[n]=
l)}return b},format:function(d,a){a=a||{places:20,round:-1};d=m.format(d,a);return d&&(d=d.replace(g,"$1").replace(b,"")),d}};return k})},"esri/renderers/support/AuthoringInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport ../../core/kebabDictionary ./AuthoringInfoVisualVariable".split(" "),function(m,l,h,d,b,g,k,f){var a=k({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",
esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),e=k({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size"});return function(c){function g(a){a=c.call(this)||this;return a.lengthUnit=null,a.visualVariables=null,a}return h(g,c),k=g,Object.defineProperty(g.prototype,"classificationMethod",{get:function(){if("class-breaks-size"===this.type||"class-breaks-color"===this.type){var a=
this._get("classificationMethod");return a?a:"manual"}return null},set:function(a){this._set("classificationMethod",a)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"fields",{get:function(){return"predominance"===this.type?this._get("fields"):null},set:function(a){this._set("fields",a)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"standardDeviationInterval",{get:function(){return"standard-deviation"===this.classificationMethod?this._get("standardDeviationInterval"):
null},set:function(a){this._set("standardDeviationInterval",a)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"type",{get:function(){return this._get("type")},set:function(a){var b=a;"classed-size"===a?b="class-breaks-size":"classed-color"===a&&(b="class-breaks-color");this._set("type",b)},enumerable:!0,configurable:!0}),g.prototype.clone=function(){return new k({classificationMethod:this.classificationMethod,fields:this.fields&&this.fields.slice(0),lengthUnit:this.lengthUnit,
standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(function(a){return a.clone()})})},d([b.property({type:String,value:null,dependsOn:["type"],json:{read:a.read,write:a.write}})],g.prototype,"classificationMethod",null),d([b.property({type:[String],value:null,dependsOn:["type"],json:{write:!0}})],g.prototype,"fields",null),d([b.property({type:String,json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],
g.prototype,"lengthUnit",void 0),d([b.property({type:Number,value:null,dependsOn:["classificationMethod"],json:{write:!0}})],g.prototype,"standardDeviationInterval",null),d([b.property({type:String,value:null,json:{read:e.read,write:e.write}})],g.prototype,"type",null),d([b.property({type:[f],json:{write:!0}})],g.prototype,"visualVariables",void 0),g=k=d([b.subclass("esri.renderers.support.AuthoringInfo")],g);var k}(b.declared(g))})},"esri/renderers/support/AuthoringInfoVisualVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast ../../core/JSONSupport ../../core/kebabDictionary".split(" "),
function(m,l,h,d,b,g,k,f){var a=f({percentTotal:"percent-of-total"}),e=f({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity"});return function(c){function f(a){a=c.call(this)||this;return a.endTime=null,a.field=null,a.maxSliderValue=null,a.minSliderValue=null,a.startTime=null,a.type=null,a.units=null,a}return h(f,c),k=f,f.prototype.castEndTime=function(a){return"string"==typeof a||"number"==typeof a?a:null},f.prototype.castStartTime=function(a){return"string"==typeof a||"number"==typeof a?
a:null},Object.defineProperty(f.prototype,"style",{get:function(){return"color"===this.type?this._get("style"):null},set:function(a){this._set("style",a)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"theme",{get:function(){return"color"===this.type?this._get("theme")||"high-to-low":null},set:function(a){this._set("theme",a)},enumerable:!0,configurable:!0}),f.prototype.clone=function(){return new k({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,
startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})},d([b.property({json:{write:!0}})],f.prototype,"endTime",void 0),d([g.cast("endTime")],f.prototype,"castEndTime",null),d([b.property({type:String,json:{write:!0}})],f.prototype,"field",void 0),d([b.property({type:Number,json:{write:!0}})],f.prototype,"maxSliderValue",void 0),d([b.property({type:Number,json:{write:!0}})],f.prototype,"minSliderValue",void 0),d([b.property({json:{write:!0}})],f.prototype,"startTime",
void 0),d([g.cast("startTime")],f.prototype,"castStartTime",null),d([b.property({type:String,value:null,dependsOn:["type"],json:{read:a.read,write:a.write}})],f.prototype,"style",null),d([b.property({type:String,value:null,dependsOn:["type"],json:{write:!0}})],f.prototype,"theme",null),d([b.property({type:String,json:{read:e.read,write:e.write}})],f.prototype,"type",void 0),d([b.property({type:String,json:{write:!0}})],f.prototype,"units",void 0),f=k=d([b.subclass("esri.renderers.support.AuthoringInfoVisualVariable")],
f);var k}(b.declared(k))})},"esri/renderers/support/LegendOptions":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;return a.title=null,a}return h(f,g),a=f,f.prototype.clone=function(){return new a({title:this.title})},d([b.property({type:String,
json:{write:!0}})],f.prototype,"title",void 0),f=a=d([b.subclass("esri.renderers.support.LegendOptions")],f);var a}(b.declared(g));l.LegendOptions=m;l["default"]=m})},"esri/renderers/support/UniqueValueInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport ../../symbols/support/typeUtils ../../symbols/support/jsonUtils".split(" "),function(m,l,h,d,b,g,k,f){Object.defineProperty(l,
"__esModule",{value:!0});m=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;return b.description=null,b.label=null,b.symbol=null,b.value=null,b}return h(e,a),c=e,e.prototype.clone=function(){return new c({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})},d([b.property({type:String,json:{write:!0}})],e.prototype,"description",void 0),d([b.property({type:String,json:{write:!0}})],e.prototype,"label",void 0),d([b.property({types:k.types,
json:{origins:{"web-scene":{read:f.read,write:{target:{symbol:{types:k.types3D}},writer:f.writeTarget}}},read:f.read,write:f.writeTarget}})],e.prototype,"symbol",void 0),d([b.property({type:String,json:{write:!0}})],e.prototype,"value",void 0),e=c=d([b.subclass("esri.renderers.support.UniqueValueInfo")],e);var c}(b.declared(g));l.UniqueValueInfo=m;l["default"]=m})},"esri/renderers/support/diffUtils":function(){define("require exports dojo/_base/lang ../../core/Accessor ../../core/Collection ../../core/accessorSupport/utils".split(" "),
function(m,l,h,d,b,g){function k(a){return a instanceof b?Object.keys(a.items):a instanceof d?g.getProperties(a).keys():a?Object.keys(a):[]}function f(a,c){return a instanceof b?a.items[c]:a[c]}function a(a,b){return Array.isArray(a)&&Array.isArray(b)?a.length!==b.length:!1}function e(b,d){var g=b.diff;if(g&&h.isFunction(g))return g(b,d);var l=k(b),m=k(d);if(0!==l.length||0!==m.length){if(!l.length||!m.length||a(b,d))return{type:"complete",oldValue:b,newValue:d};var q=m.filter(function(a){return-1===
l.indexOf(a)}),t=l.filter(function(a){return-1===m.indexOf(a)}),q=l.filter(function(a){return-1<m.indexOf(a)&&f(b,a)!==f(d,a)}).concat(q,t).sort();if((t=b?b.declaredClass:null)&&-1<c.indexOf(t)&&q.length)return{type:"complete",oldValue:b,newValue:d};var n,w;for(w in q){var t=q[w],z=f(b,t),C=f(d,t),B=void 0;h.isFunction(z)||h.isFunction(C)||z!==C&&(null!=z||null!=C)&&(B=g&&g[t]&&h.isFunction(g[t])?g[t](z,C):"object"==typeof z&&"object"==typeof C&&(z?z.declaredClass:null)===(C?C.declaredClass:null)?
e(z,C):{type:"complete",oldValue:z,newValue:C},B&&(n=n||{type:"partial",diff:{}},n.diff[t]=B))}return n}}Object.defineProperty(l,"__esModule",{value:!0});var c=["esri.Color","esri.portal.Portal"];l.diff=function(a,b){return h.isFunction(a)||h.isFunction(b)||!a&&!b?void 0:!a||!b||"object"==typeof a&&"object"==typeof a&&(a?a.declaredClass:null)!==(b?b.declaredClass:null)?{type:"complete",oldValue:a,newValue:b}:e(a,b)}})},"esri/renderers/support/rendererConversion":function(){define(["require","exports",
"../../core/Error","../../symbols/support/symbolConversion"],function(m,l,h,d){function b(b,a){if(!a)return null;var d;if(d=Array.isArray(a)?a:[a],0<d.length){var c=d.map(function(a){return a.details.symbol.type||a.details.symbol.declaredClass}).filter(function(a){return!!a});c.sort();var f=[];return c.forEach(function(a,b){0!==b&&a===c[b-1]||f.push(a)}),new h("renderer-conversion-3d:unsupported-symbols","Renderer contains symbols ("+f.join(", ")+") which are not supported in 3D",{renderer:b,symbolErrors:d})}return null}
function g(f){var a=f.uniqueValueInfos.map(function(a){return d.to3D(a.symbol).error}).filter(function(a){return!!a}),e=d.to3D(f.defaultSymbol);return e.error&&a.unshift(e.error),b(f,a)}function k(f){var a=f.classBreakInfos.map(function(a){return d.to3D(a.symbol).error}).filter(function(a){return!!a}),e=d.to3D(f.defaultSymbol);return e.error&&a.unshift(e.error),b(f,a)}Object.defineProperty(l,"__esModule",{value:!0});l.validateTo3D=function(f){return f?"simple"===f.type?b(f,d.to3D(f.symbol).error):
"unique-value"===f.type?g(f):"class-breaks"===f.type?k(f):new h("renderer-conversion-3d:unsupported-renderer","Unsupported renderer of type '"+(f.type||f.declaredClass)+"'",{renderer:f}):null}})},"esri/views/3d/webgl-engine/lib/Layer":function(){define("require exports dojo/has ./IdGen ./Octree ./PerformanceTimer ./Util ./gl-matrix ./ModelContentType".split(" "),function(m,l,h,d,b,g,k,f,a){var e=f.vec3d,c=h("dojo-debug-messages");return function(){function f(a,b,c){this._parentStages=[];this._children=
[];this.id=f._idGen.gen(c);this.name=a;b=b||{};this.group=b.group||"";this.state=b.state||"VISIBLE";this.interaction=b.interaction||"PICKABLE";this.translation=e.create(b.translation);this._extent=[e.createFrom(0,0,0),e.createFrom(1E3,1E3,1E3)];this._extentDirty=!0}return f.prototype.getId=function(){return this.id},f.prototype.getParentStages=function(){return this._parentStages},f.prototype.addParentStage=function(a){-1===this._parentStages.indexOf(a)&&this._parentStages.push(a)},f.prototype.removeParentStage=
function(a){a=this._parentStages.indexOf(a);-1<a&&this._parentStages.splice(a,1)},f.prototype.getName=function(){return this.name},f.prototype.getGroup=function(){return this.group},f.prototype.getState=function(){return this.state},f.prototype.getInteraction=function(){return this.interaction},f.prototype.getTranslation=function(){return this.translation},f.prototype.getObjectIds=function(){return this._children.map(function(a){return a.getId()})},f.prototype.getObjects=function(){return this._children},
f.prototype.setState=function(a){this.state=a},f.prototype.getExtent=function(){return this._updateExtent(),this._extent},f.prototype.addObject=function(a){this._children.push(a);a.addParentLayer(this);this.notifyDirty("layObjectAdded",a);this._invalidateExtent();this._spatialAccelerator&&this._spatialAccelerator.add(a)},f.prototype.hasObject=function(a){return-1<this._children.indexOf(a)},f.prototype.removeObject=function(a){return null!=k.arrayRemove(this._children,a)?(a.removeParentLayer(this),
this.notifyDirty("layObjectRemoved",a),this._invalidateExtent(),this._spatialAccelerator&&this._spatialAccelerator.remove(a),!0):!1},f.prototype.replaceObject=function(a,b){var c=this._children.indexOf(a);k.assert(-1<c,"Layer.replaceObject: layer doesn't contain specified object");this._children[c]=b;a.removeParentLayer(this);b.addParentLayer(this);this.notifyDirty("layObjectReplaced",[a,b]);this._invalidateExtent();this._spatialAccelerator&&(this._spatialAccelerator.remove(a),this._spatialAccelerator.add(b))},
f.prototype.notifyObjectBBChanged=function(a,b){this._spatialAccelerator&&this._spatialAccelerator.update(a,b)},f.prototype.getCenter=function(){this._updateExtent();var a=e.create();return e.lerp(this._extent[0],this._extent[1],.5,a)},f.prototype.getBSRadius=function(){return this._updateExtent(),.5*e.dist(this._extent[0],this._extent[1])},f.prototype.getSpatialQueryAccelerator=function(){return this._spatialAccelerator?this._spatialAccelerator:50<this._children.length?(this._createOctree(),this._spatialAccelerator):
void 0},f.prototype.shaderTransformationChanged=function(){this.notifyDirty("shaderTransformationChanged",null)},f.prototype.invalidateSpatialQueryAccelerator=function(){this._spatialAccelerator=null},f.prototype.notifyDirty=function(b,c,d,e){d=d||a.LAYER;e=e||this;for(var f=0;f<this._parentStages.length;f++)this._parentStages[f].notifyDirty(d,e,b,c)},f.prototype._createOctree=function(){for(var a=this.getExtent(),d=0,f=0;3>f;f++)d=Math.max(d,a[1][f]-a[0][f]);f=e.create();e.lerp(a[0],a[1],.5,f);var h;
if(c&&(h=new g(1),h.start()),this._spatialAccelerator=new b(f,1.2*d),this._spatialAccelerator.add(this._children),h)a=h.stop(),console.info("Octree for layer "+this.id+" created in "+Math.round(a)+" ms")},f.prototype._invalidateExtent=function(){this._extentDirty=!0},f.prototype._updateExtent=function(){if(this._extentDirty){if(0===this._children.length)return void(this._extent=[[0,0,0],[0,0,0]]);var a=this._children[0];this._extent=[e.create(a.getBBMin()),e.create(a.getBBMax())];for(a=0;a<this._children.length;++a)for(var b=
this._children[a],c=b.getBBMin(),b=b.getBBMax(),d=0;3>d;++d)this._extent[0][d]=Math.min(this._extent[0][d],c[d]),this._extent[1][d]=Math.max(this._extent[1][d],b[d]);this._extentDirty=!1}},f._idGen=new d,f}()})},"esri/views/3d/webgl-engine/lib/Octree":function(){define("require exports ./gl-matrix ./Util dojo/has ./PerformanceTimer".split(" "),function(m,l,h,d,b,g){function k(a,b,c){return c=c||a,c[0]=a[0]+b,c[1]=a[1]+b,c[2]=a[2]+b,c}var f=h.vec3d,a=b("dojo-debug-messages");m=function(){function b(a,
b,c){this._maximumObjectsPerNode=10;this._maximumDepth=20;this._autoResize=!0;this._outsiders=[];c&&(void 0!==c.maximumObjectsPerNode&&(this._maximumObjectsPerNode=c.maximumObjectsPerNode),void 0!==c.maximumDepth&&(this._maximumDepth=c.maximumDepth),void 0!==c.autoResize&&(this._autoResize=c.autoResize));isNaN(a[0])||isNaN(a[1])||isNaN(a[2])||isNaN(b)?this._root=new e(null,f.createFrom(0,0,0),.5):this._root=new e(null,a,b/2)}return Object.defineProperty(b.prototype,"center",{get:function(){return this._root.center},
enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"size",{get:function(){return 2*this._root.halfSize},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"root",{get:function(){return this._root.node},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"outsiders",{get:function(){return this._outsiders.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"maximumObjectsPerNode",{get:function(){return this._maximumObjectsPerNode},enumerable:!0,
configurable:!0}),Object.defineProperty(b.prototype,"maximumDepth",{get:function(){return this._maximumDepth},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"autoResize",{get:function(){return this._autoResize},enumerable:!0,configurable:!0}),b.prototype.add=function(a){a=this._objectOrObjectsArray(a);this._grow(a);for(var b=e.acquire(),c=0;c<a.length;c++){var d=a[c];b.init(this._root);0===d.getBSRadius()||isNaN(d.getBSRadius())||!this._autoResize&&!this._fitsInsideTree(this._boundingSphereFromObject(d,
x))?this._outsiders.push(d):this._add(d,b)}e.release(b)},b.prototype.remove=function(a,b){a=this._objectOrObjectsArray(a);for(var c=e.acquire(),f=!0,g=0;g<a.length;g++){var h=a[g],k=this._boundingSphereFromObject(b||h,x);0===k.radius||isNaN(k.radius)||!this._autoResize&&!this._fitsInsideTree(k)?f=null!=d.arrayRemove(this._outsiders,h):(c.init(this._root),f=this._remove(h,k,c))}return e.release(c),this._shrink(),f},b.prototype.update=function(a,b){this.remove(a,b);this.add(a)},b.prototype.forEachAlongRay=
function(a,b,c){this._forEachTest(function(c){return k(c.center,2*-c.halfSize,r),k(c.center,2*c.halfSize,u),d.rayBoxTest(a,b,r,u)},c)},b.prototype.forEachInBoundingBox=function(a,b,c){this._forEachTest(function(c){for(var d=2*c.halfSize,e=0;3>e;e++)if(c.center[e]+d<a[e]||c.center[e]-d>b[e])return!1;return!0},c)},b.prototype.forEachNode=function(a){this._forEachNode(this._root,function(b){return a(b.node,b.center,2*b.halfSize)})},b.prototype._forEachTest=function(a,b){this._outsiders.forEach(b);this._forEachNode(this._root,
function(c){return a(c)?(c=c.node,c.terminals.forEach(b),null!==c.residents&&c.residents.forEach(b),!0):!1})},b.prototype._forEachNode=function(a,b){a=e.acquire().init(a);for(var c=[a];0!==c.length;){if(a=c.pop(),b(a)&&!a.isLeaf())for(var d=0;d<a.node.children.length;d++)a.node.children[d]&&c.push(e.acquire().init(a).advance(d));e.release(a)}},b.prototype._objectOrObjectsArray=function(a){return Array.isArray(a)||(q[0]=a,a=q),a},b.prototype._remove=function(a,b,c){v.length=0;var e,f;if(c.advanceTo(b,
function(a,b){v.push(a.node,b)})?(e=null!=d.arrayRemove(c.node.terminals,a),f=0===c.node.terminals.length):(e=null!=d.arrayRemove(c.node.residents,a),f=0===c.node.residents.length),f)for(a=v.length-2;0<=a&&this._purge(v[a],v[a+1]);a-=2);return e},b.prototype._nodeIsEmpty=function(a){if(0!==a.terminals.length)return!1;if(null!==a.residents)return 0===a.residents.length;for(var b=0;b<a.children.length;b++)if(a.children[b])return!1;return!0},b.prototype._purge=function(a,b){return 0<=b&&(a.children[b]=
null),this._nodeIsEmpty(a)?(null===a.residents&&(a.residents=[]),!0):!1},b.prototype._add=function(a,b){b.advanceTo(this._boundingSphereFromObject(a,x))?b.node.terminals.push(a):(b.node.residents.push(a),b.node.residents.length>this._maximumObjectsPerNode&&b.depth<this._maximumDepth&&this._split(b))},b.prototype._split=function(a){var b=a.node.residents;a.node.residents=null;for(var c=0;c<b.length;c++){var d=e.acquire().init(a);this._add(b[c],d);e.release(d)}},b.prototype._grow=function(b){if(0!==
b.length&&this._autoResize&&(b=this._boundingSphereFromObjects(b,this._boundingSphereFromObject,y),!isNaN(b.radius)&&0!==b.radius&&!this._fitsInsideTree(b))){var c,d;if(a&&(c=new g(1),c.start()),this._nodeIsEmpty(this._root.node))f.set(b.center,this._root.center),this._root.halfSize=1.25*b.radius,d="grow-empty";else{var h=e.acquire();this._rootBoundsForRootAsSubNode(b,h);this._placingRootViolatesMaxDepth(h)?(this._rebuildTree(b,h),d="rebuild"):(this._growRootAsSubNode(h),d="sub-node");e.release(h)}a&&
(c=c.stop(),console.info("Octree grown in "+Math.round(c)+" ms (strategy: "+d+")"))}},b.prototype._rebuildTree=function(a,b){var c=this;f.set(b.center,n.center);n.radius=b.halfSize;a=this._boundingSphereFromObjects([a,n],function(a){return a},w);b=e.acquire().init(this._root);this._root.initFrom(null,a.center,1.25*a.radius);this._forEachNode(b,function(a){return c.add(a.node.terminals),null!==a.node.residents&&c.add(a.node.residents),!0});e.release(b)},b.prototype._placingRootViolatesMaxDepth=function(a){var b=
0;this._forEachNode(this._root,function(a){return b=Math.max(b,a.depth),!0});return b+Math.log(a.halfSize/this._root.halfSize)*Math.LOG2E>this._maximumDepth},b.prototype._rootBoundsForRootAsSubNode=function(a,b){var c=a.radius,d=a.center;a=-(1/0);for(var e=this._root.center,f=this._root.halfSize,g=0;3>g;g++){var h=Math.max(0,Math.ceil((e[g]-f-(d[g]-c))/(2*f))),k=Math.max(0,Math.ceil((d[g]+c-(e[g]+f))/(2*f)))+1;a=Math.max(a,Math.pow(2,Math.ceil(Math.log(h+k)*Math.LOG2E)));z[g].min=h;z[g].max=k}for(g=
0;3>g;g++)h=z[g].min,k=z[g].max,c=(a-(h+k))/2,h+=Math.ceil(c),k+=Math.floor(c),t[g]=e[g]-f-h*f*2+(k+h)*f;return b.initFrom(null,t,a*f,0)},b.prototype._growRootAsSubNode=function(a){var b=this._root.node;f.set(this._root.center,y.center);y.radius=this._root.halfSize;this._root.init(a);a.advanceTo(y,null,!0);a.node.children=b.children;a.node.residents=b.residents;a.node.terminals=b.terminals},b.prototype._shrink=function(){if(this._autoResize)for(;;){var a=this._findShrinkIndex();if(-1===a)break;this._root.advance(a);
this._root.depth=0}},b.prototype._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var a=null,b=this._root.node.children,c=0,d=0;d<b.length&&null==a;)c=d++,a=b[c];for(;d<b.length;)if(b[d++])return-1;return c},b.prototype._fitsInsideTree=function(a){var b=this._root.center,c=this._root.halfSize,d=a.center;return c>=a.radius&&d[0]>=b[0]-c&&d[0]<=b[0]+c&&d[1]>=b[1]-c&&d[1]<=b[1]+c&&d[2]>=b[2]-c&&d[2]<=b[2]+c},b.prototype._boundingSphereFromObject=function(a,
b){return f.set(a.getCenter(),b.center),b.radius=a.getBSRadius(),b},b.prototype._boundingSphereFromObjects=function(a,b,c){if(1===a.length){var d=b(a[0],y);f.set(d.center,c.center);c.radius=d.radius}else{r[0]=1/0;r[1]=1/0;r[2]=1/0;u[0]=-(1/0);u[1]=-(1/0);u[2]=-(1/0);for(var e=0;e<a.length;e++){var d=b(a[e],y),g=r,h=d.center,k=d.radius;g[0]=Math.min(g[0],h[0]-k);g[1]=Math.min(g[1],h[1]-k);g[2]=Math.min(g[2],h[2]-k);g=u;h=d.center;d=d.radius;g[0]=Math.max(g[0],h[0]+d);g[1]=Math.max(g[1],h[1]+d);g[2]=
Math.max(g[2],h[2]+d)}f.scale(f.add(r,u,c.center),.5);c.radius=Math.max(u[0]-r[0],u[1]-r[1],u[2]-r[2])/2}return c},b}();var e=function(){function a(a,b,c,d){void 0===c&&(c=0);void 0===d&&(d=0);this.center=f.create();this.initFrom(a,b,c,0)}return a.prototype.init=function(a){return this.initFrom(a.node,a.center,a.halfSize,a.depth)},a.prototype.initFrom=function(b,c,d,e){return void 0===b&&(b=null),void 0===d&&(d=this.halfSize),void 0===e&&(e=this.depth),this.node=b||a.createEmptyNode(),c&&f.set(c,
this.center),this.halfSize=d,this.depth=e,this},a.prototype.advance=function(b){var d=this.node.children[b];d||(d=a.createEmptyNode(),this.node.children[b]=d);this.node=d;this.halfSize/=2;this.depth++;b=c[b];return this.center[0]+=b[0]*this.halfSize,this.center[1]+=b[1]*this.halfSize,this.center[2]+=b[2]*this.halfSize,this},a.prototype.advanceTo=function(a,b,c){for(void 0===c&&(c=!1);;){if(this.isTerminalFor(a))return b&&b(this,-1),!0;if(this.isLeaf()&&!c)return b&&b(this,-1),!1;this.isLeaf()&&(this.node.residents=
null);var d=this._childIndex(a);b&&b(this,d);this.advance(d)}},a.prototype.isLeaf=function(){return null!=this.node.residents},a.prototype.isTerminalFor=function(a){return a.radius>this.halfSize/2},a.prototype._childIndex=function(a){a=a.center;for(var b=this.center,c=0,d=0;3>d;d++)b[d]<a[d]&&(c|=1<<d);return c},a.createEmptyNode=function(){return{children:[null,null,null,null,null,null,null,null],terminals:[],residents:[]}},a.acquire=function(){if(0===this._pool.length)return new a;var b=this._pool[this._pool.length-
1];return this._pool.length--,b},a.release=function(a){this._pool.push(a)},a._pool=[],a}(),c=[[-1,-1,-1],[1,-1,-1],[-1,1,-1],[1,1,-1],[-1,-1,1],[1,-1,1],[-1,1,1],[1,1,1]],q=[null],t=f.create(),r=f.create(),u=f.create(),v=[],x={center:f.create(),radius:0},y={center:f.create(),radius:0},n={center:f.create(),radius:0},w={center:f.create(),radius:0},z=[{min:0,max:0},{min:0,max:0},{min:0,max:0}];return m})},"esri/views/3d/webgl-engine/lib/FloatingBoxLocalOriginFactory":function(){define(["require","exports",
"./gl-matrix"],function(m,l,h){var d=h.vec3d;m=function(){function g(b,d){this._origins=[];this._boxSize=b;this._maxNumOrigins=d}return g.prototype.getOrigin=function(h){for(var f,a=this._origins.length,e=!1,c=Number.MAX_VALUE,k=0;a>k;k++){var l=this._origins[k];d.subtract(h,l.vec3,b);b[0]=Math.abs(b[0]);b[1]=Math.abs(b[1]);b[2]=Math.abs(b[2]);var m=b[0]+b[1]+b[2];c>m&&(f=l,c=m,e=b[0]<this._boxSize&&b[1]<this._boxSize&&b[2]<this._boxSize)}e||f&&null!=this._maxNumOrigins&&!(this._origins.length<this._maxNumOrigins)||
(f=g.OFFSET,f={vec3:[h[0]+f,h[1]+f,h[2]+f],id:g.ORIGIN_PREFIX+this._origins.length},this._origins.push(f));return f},g.OFFSET=1.11,g.ORIGIN_PREFIX="fb_",g}();var b=d.create();return m})},"esri/symbols/support/unitConversionUtils":function(){define(["require","exports","../../renderers/support/utils"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.supportsUnit=function(d){return null!=h.meterIn[d]};l.getMetersPerUnit=function(d){return 1/(h.meterIn[d]||1)}})},"esri/views/3d/layers/graphics/featureExpressionInfoUtils":function(){define(["require",
"exports","../../../../support/arcadeUtils"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.createContext=function(d,b,g){var k=null;d=d&&d.expression;if("string"==typeof d){var f="0"===d?0:null;null!=f?k={cachedResult:f}:(d=h.createSyntaxTree(d),h.dependsOnView(d)?(null!=g&&g.error("Expressions containing '$view' are not supported on ElevationInfo"),k={cachedResult:0}):k={arcade:{func:h.createFunction(d),context:h.createExecContext(null,{sr:b})}})}return k};l.createFeature=function(d){return h.createFeature(d)};
l.setContextFeature=function(d,b){null==d||null!=d.cachedResult||h.updateExecContext(d.arcade.context,b)};l.execute=function(d){if(null!=d){if(null!=d.cachedResult)return d.cachedResult;var b=d.arcade,b=h.executeFunction(b.func,b.context);return"number"!=typeof b&&(d.cachedResult=0,b=0),b}return 0};l.extractExpressionInfo=function(d,b){void 0===b&&(b=!1);var g=(d=d&&d.featureExpressionInfo)&&d.expression;return b||"0"===g||(d=null),d};l.zeroContext={cachedResult:0}})},"esri/views/3d/layers/graphics/Graphics3DGraphic":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/asyncUtils ../../../../core/ObjectPool ../../support/aaBoundingBox ../../support/aaBoundingRect ./featureExpressionInfoUtils".split(" "),
function(m,l,h,d,b,g,k,f,a){var e=new g(Array,function(a){return k.set(a,k.ZERO)},null,10,5),c=f.create();return function(){function g(b,c,d){this.addedToSpatialIndex=!1;this._labelGraphics=[];this._auxiliaryGraphics=[];for(var e=Array(2),f=0;f<e.length;f++)e[f]=Array(3);this._visibilityFlags=e;this._featureExpressionFeature=null;this.graphics3DSymbol=c;this.graphic=b;this._graphics=d;this._featureExpressionFeature=a.createFeature(b)}return g.prototype.initialize=function(a,b){var c=this;this._layer=
a;this._stage=b;this.forEachSymbolLayerGraphic(function(d){d.initialize(a,b);d.setVisibility(c.isVisible())})},g.prototype.destroy=function(){this.forEachRenderedGraphic(function(a){return a.destroy()});this._graphics.length=0;this._labelGraphics.length=0;this._auxiliaryGraphics.length=0},g.prototype.clearLabelGraphics=function(){this.forEachLabelGraphic(function(a){return a.destroy()});this._labelGraphics.length=0},g.prototype.addLabelGraphic=function(a,b,c){this._labelGraphics.push(a);a.initialize(b,
c);a.setVisibility(this.isVisible(1))},g.prototype.addAuxiliaryGraphic=function(a){this._auxiliaryGraphics.push(a);this._layer&&(a.initialize(this._layer,this._stage),a.setVisibility(this.isVisible()))},g.prototype.isDraped=function(){var a=!1;return this.forEachSymbolLayerGraphic(function(b){b.isDraped()&&(a=!0)}),a},g.prototype.setDrawOrder=function(a,b,c){var d=this;c[this.graphics3DSymbol.symbol.id]=!0;this.forEachSymbolLayerGraphic(function(e,f){e.setDrawOrder(a+(1-(1+f)/d._graphics.length),
b,c)})},g.prototype.areVisibilityFlagsSet=function(a,b,c){void 0===c&&(c=0);c=this._visibilityFlags[c];if(null!=a)return c[a];a=!0;for(var d=0;d<c.length;d++)if(d!==b){var e=c[d];a=a&&(null==e||!0===e)}return a},g.prototype.isVisible=function(a){void 0===a&&(a=0);for(var b=!0,c=0;a>=c;c++)for(var d=this._visibilityFlags[c],e=0;e<d.length;e++)var f=d[e],b=b&&(null==f||!0===f);return b},g.prototype.setVisibilityFlag=function(a,b,c){void 0===c&&(c=0);var d=this.isVisible(c);this._visibilityFlags[c][a]=
b;var e=this.isVisible(c);if(d!==e){if(1===c)this.forEachLabelGraphic(function(a){return a.setVisibility(e)});else{this.forEachSymbolLayerGraphic(function(a){return a.setVisibility(e)});var f=this.isVisible(1);this.forEachLabelGraphic(function(a){return a.setVisibility(f)})}return!0}return!1},g.prototype.getBSRadius=function(){var a=0;return this.forEachSymbolLayerGraphic(function(b){a=Math.max(a,b.getBSRadius())}),a},g.prototype.getCenterObjectSpace=function(){return this._graphics[0].getCenterObjectSpace()},
g.prototype.getProjectedBoundingBox=function(a,g,l,m){return d(this,void 0,void 0,function(){var q=this;return h(this,function(r){switch(r.label){case 0:return m||(m={boundingBox:null,requiresDrapedElevation:!1,screenSpaceObjects:[]}),m.boundingBox?k.set(m.boundingBox,k.NEGATIVE_INFINITY):m.boundingBox=k.create(k.NEGATIVE_INFINITY),m.requiresDrapedElevation=!1,[4,b.forEach(this._graphics,function(b){return d(q,void 0,void 0,function(){var c,d,f;return h(this,function(h){switch(h.label){case 0:return b?
(c=b.isDraped()?g:a,d=e.acquire(),[4,b.getProjectedBoundingBox(c,l,d,m.screenSpaceObjects)]):[2];case 1:return f=h.sent(),isFinite(f[2])&&isFinite(f[5])||(m.requiresDrapedElevation=!0),f&&k.expand(m.boundingBox,d),e.release(d),[2]}})})})];case 1:return r.sent(),k.allFinite(m.boundingBox)||f.allFinite(k.toRect(m.boundingBox,c))?[2,m]:[2,null]}})})},g.prototype.needsElevationUpdates=function(){for(var a=0,b=this._graphics;a<b.length;a++){var c=b[a];if(c&&c.needsElevationUpdates)return!0}a=0;for(b=this._labelGraphics;a<
b.length;a++)if((c=b[a])&&c.needsElevationUpdates)return!0;return!1},g.prototype.alignWithElevation=function(a,b){var c=this;this.forEachRenderedGraphic(function(d){d.alignWithElevation(a,b,c._featureExpressionFeature)})},g.prototype.addHighlight=function(a,b){this.forEachSymbolLayerGraphic(function(c){return c.addHighlight(a,b)})},g.prototype.removeHighlight=function(a){this.forEachSymbolLayerGraphic(function(b){return b.removeHighlight(a)})},g.prototype.forEachGraphicList=function(a,b){a.forEach(function(a,
c){return a&&b(a,c)})},g.prototype.forEachSymbolLayerGraphic=function(a){this.forEachGraphicList(this._graphics,a);this.forEachGraphicList(this._auxiliaryGraphics,a)},g.prototype.forEachLabelGraphic=function(a){this.forEachGraphicList(this._labelGraphics,a)},g.prototype.forEachRenderedGraphic=function(a){this.forEachSymbolLayerGraphic(a);this.forEachLabelGraphic(a)},g}()})},"esri/core/asyncUtils":function(){define(["require","exports","./tsSupport/generatorHelper","./tsSupport/awaiterHelper","./promiseUtils"],
function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});l.forEach=function(g,k,f){return d(this,void 0,void 0,function(){return h(this,function(a){switch(a.label){case 0:return[4,b.eachAlways(g.map(function(a,b){return k.apply(f,[a,b])}))];case 1:return a.sent(),[2]}})})};l.map=function(g,k,f){return d(this,void 0,void 0,function(){var a;return h(this,function(d){switch(d.label){case 0:return[4,b.eachAlways(g.map(function(a,b){return k.apply(f,[a,b])}))];case 1:return a=d.sent(),[2,a.map(function(a){return a.value})]}})})}})},
"esri/views/3d/layers/graphics/Graphics3DWebStyleSymbol":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../support/PromiseLightweight"],function(m,l,h,d){return function(b){function d(d,f){var a=b.call(this)||this;return a.symbol=null,a.graphics3DSymbol=null,a.symbol=d,d.fetchSymbol().then(function(b){if(a.isRejected())throw Error();a.graphics3DSymbol=f(b)}).then(function(){if(a.isRejected())throw Error();a.graphics3DSymbol.then(function(){a.isRejected()||a.resolve()},
function(b){a.isRejected()||a.reject(b)})}).otherwise(function(b){a.isRejected()||a.reject(b)}),a}return h(d,b),d.prototype.createGraphics3DGraphic=function(b,d){return this.graphics3DSymbol.createGraphics3DGraphic(b,d,this)},d.prototype.layerPropertyChanged=function(b,d){return this.graphics3DSymbol.layerPropertyChanged(b,d)},d.prototype.applyRendererDiff=function(b,d,a){return this.graphics3DSymbol.applyRendererDiff(b,d,a)},d.prototype.getFastUpdateStatus=function(){return this.graphics3DSymbol?
this.graphics3DSymbol.getFastUpdateStatus():{loading:1,fast:0,slow:0}},d.prototype.setDrawOrder=function(b,d){return this.graphics3DSymbol.setDrawOrder(b,d)},d.prototype.destroy=function(){this.isFulfilled()||this.reject();this.graphics3DSymbol&&this.graphics3DSymbol.destroy()},d}(d.Promise)})},"esri/views/3d/layers/graphics/Graphics3DSymbolFactory":function(){define(["require","exports","./Graphics3DSymbol","./Graphics3DPointSymbol"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});
l.make=function(b,g,k){var f;switch(b.type){case "point-3d":f=d;break;default:f=h}return new f(b,g,k)}})},"esri/views/3d/layers/graphics/Graphics3DSymbol":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../support/PromiseLightweight ./Graphics3DGraphic ./Graphics3DSymbolLayerFactory".split(" "),function(m,l,h,d,b,g){return function(d){function f(a,b,c){var e=d.call(this)||this;e.symbol=a;a=a.symbolLayers;c&&(a=c.concat(a));c=a.length;e.childGraphics3DSymbols=Array(a.length);
e.childGraphics3DSymbolPromises=Array(a.length);for(var f=b.layerOrder,h=0,k=0,l=!1,m=function(a,b){b&&(this.childGraphics3DSymbols[a]=b,k++);h--;!this.isRejected()&&l&&1>h&&(0<k?this.resolve():this.reject())},y=0;c>y;y++){var n=a.getItemAt(y);!1!==n.enabled&&(b.layerOrder=f+(1-(1+y)/c),b.layerOrderDelta=1/c,(n=g.make(e.symbol,n,b,n._ignoreDrivers))&&(h++,e.childGraphics3DSymbolPromises[y]=n,n.then(m.bind(e,y,n),m.bind(e,y,null))))}return b.layerOrder=f,l=!0,!e.isRejected()&&1>h&&e.resolve(),e}return h(f,
d),f.prototype.createGraphics3DGraphic=function(a,d,c){for(var e=Array(this.childGraphics3DSymbols.length),f=0;f<this.childGraphics3DSymbols.length;f++){var g=this.childGraphics3DSymbols[f];g&&(e[f]=g.createGraphics3DGraphic(a,d))}return new b(a,c||this,e)},f.prototype.layerPropertyChanged=function(a,b){for(var c=this.childGraphics3DSymbols.length,d=function(c){var d=e.childGraphics3DSymbols[c],f=function(a){return a._graphics[c]};return d&&!d.layerPropertyChanged(a,b,f)?{value:!1}:void 0},e=this,
f=0;c>f;f++){var g=d(f);if("object"==typeof g)return g.value}return!0},f.prototype.applyRendererDiff=function(a,b,c){return this.isResolved()?this.childGraphics3DSymbols.reduce(function(d,e,f){return d&&(!e||e.applyRendererDiff(a,b,c,f))},!0):!1},f.prototype.getFastUpdateStatus=function(){var a=0,b=0,c=0;return this.childGraphics3DSymbolPromises.forEach(function(d){d&&!d.isFulfilled()?a++:d&&d.isFastUpdatesEnabled()?c++:d&&b++}),{loading:a,slow:b,fast:c}},f.prototype.setDrawOrder=function(a,b){for(var c=
this.childGraphics3DSymbols.length,d=1/c,e=0;c>e;e++){var f=this.childGraphics3DSymbols[e];f&&f.setDrawOrder(a+(1-(1+e)/c),d,b)}},f.prototype.destroy=function(){this.isFulfilled()||this.reject();for(var a=0;a<this.childGraphics3DSymbolPromises.length;a++)this.childGraphics3DSymbolPromises[a]&&this.childGraphics3DSymbolPromises[a].destroy()},f}(d.Promise)})},"esri/views/3d/layers/graphics/Graphics3DSymbolLayerFactory":function(){define("require exports ../../../../core/Logger ./Graphics3DIconSymbolLayer ./Graphics3DObjectSymbolLayer ./Graphics3DLineSymbolLayer ./Graphics3DPathSymbolLayer ./Graphics3DFillSymbolLayer ./Graphics3DExtrudeSymbolLayer ./Graphics3DTextSymbolLayer".split(" "),
function(m,l,h,d,b,g,k,f,a,e){Object.defineProperty(l,"__esModule",{value:!0});var c=h.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayerFactory");l.make=function(a,b,d,e){var f=q[b.type];return f?new f(a,b,d,e):(c.error("GraphicsLayerFactory#make","unknown symbol type "+b.type),null)};var q={icon:d,object:b,line:g,path:k,fill:f,extrude:a,text:e}})},"esri/views/3d/layers/graphics/Graphics3DIconSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang dojo/when dojo/errors/CancelError ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./SignedDistanceFunctions ../support/FastSymbolUpdates ./graphicUtils ../../../../core/screenUtils ../../../../core/sniff ../../../../core/Error ../../../../symbols/support/symbolUtils ../../../../Color ../../../../geometry/Polygon ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/Texture ../../webgl-engine/materials/HUDMaterial ../../../../core/urlUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P){function Q(a){var b,c=p,d=c*A;switch("primitive:"===a.substring(0,10)&&(a=a.substring(10)),a){case U.PRIM_CIRCLE:b=q.computeSignedDistancefieldCicle(c,d);break;case U.PRIM_SQUARE:b=q.computeSignedDistancefieldSquare(c,d,!1);break;case U.PRIM_KITE:b=q.computeSignedDistancefieldSquare(c,d,!0);break;case U.PRIM_CROSS:b=q.computeSignedDistancefieldCrossAndX(c,d,!1);break;case U.PRIM_X:b=q.computeSignedDistancefieldCrossAndX(c,d,!0)}return new M(b,
"sdf_"+a,{mipmap:!1,wrapClamp:!0,width:p,height:p,components:4})}var T=C.vec3d;m=C.vec4d;var O=C.mat4d.identity(),S=[0,0,1],H=[0,0,0,0],Y=[0,0,0],W=[1,1,1],E="center bottom top left right bottom-left bottom-right top-left top-right".split(" "),p=128,A=.5,K=[A/2,A/2,1-A/2,1-A/2],U={PRIM_CIRCLE:"circle",PRIM_SQUARE:"square",PRIM_CROSS:"cross",PRIM_X:"x",PRIM_KITE:"kite"},V=[p*A,p*A];k=function(k){function l(){var a=null!==k&&k.apply(this,arguments)||this;return a._elevationOptions={supportsOffsetAdjustment:!0,
supportsOnTheGround:!0},a}return h(l,k),l.prototype._prepareResources=function(){var a=this.symbol,b=Math.round(null!=a.size?u.pt2px(a.size):16);this._size=null;this._symbolTextureRatio=1;this._primitive=null;var c=this._getStageIdHint();if(!this._isPropertyDriven("size")){var d=r.validateSymbolLayerSize(b);if(d)return this._logWarning(d),void this.reject()}this._isPropertyDriven("size")&&64>b&&(b=64);var e=a.resource||{primitive:"circle",href:void 0},d={anchorPos:this._getAnchorPos(a)},f=this.symbolContainer;
if(this._hasVisibleVerticalOffset(f)){var f=f.verticalOffset,g=f.minWorldLength,h=f.maxWorldLength;d.verticalOffset={screenLength:u.pt2px(f.screenLength),minWorldLength:g||0,maxWorldLength:null!=h?h:1/0}}if(this._context.screenSizePerspectiveEnabled&&(d.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),e.href)this._outlineSize=this._getOutlineSize(a,null),d.color=this._getFillColor(a,null),d.outlineColor=this._getOutlineColor(a),d.outlineSize=this._outlineSize,d.textureIsSignedDistanceField=
!1,this._prepareImageResources(b,d,c);else{e=e.primitive||"circle";f="primitive:"+e;if(this._primitive=e,this._outlineSize=this._getOutlineSize(a,e),d.color=this._getFillColor(a,e),d.outlineColor=this._getOutlineColor(a),d.outlineSize=this._outlineSize,("cross"===e||"x"===e)&&0===d.outlineSize)return void this.reject();this.texture=this._context.sharedResources.textures.acquire(f,Q);this._textureURI=f;d.textureIsSignedDistanceField=!0;d.distanceFieldBoundingBox=K;d.textureId=this.texture.getId();
this._size=[b,b];this._symbolTextureRatio=1/A;this._createMaterialsAndAddToStage(d,this._context.stage,c);this.resolve()}},l.prototype._getOutlineSize=function(a,b){var c=0;return c=a.outline&&null!=a.outline.size?u.pt2px(a.outline.size):"cross"===b||"x"===b?1.5:0,Math.max(c,0)},l.prototype._getOutlineColor=function(a){var b=this._getLayerOpacity();if(a.outline&&null!=a.outline.color){var c=n.toUnitRGB(a.outline.color);return[c[0],c[1],c[2],a.outline.color.a*b]}return[0,0,0,b]},l.prototype._getFillColor=
function(a,b){return"cross"===b||"x"===b?H:this._getMaterialOpacityAndColor()},l.prototype._getAnchorPos=function(a){return-1<E.indexOf(a.anchor)?a.anchor:"center"},l.prototype._prepareImageResources=function(a,c,d){var e=this,f=y.getIconHref(this.symbolContainer,this.symbol);if(!v("esri-canvas-svg-support")&&P.isSVG(f))return this._logWarning("IconSymbol3DLayer failed to load (SVG symbols are not supported in IE11)"),void this.reject(new x("SVG Not Supported","IconSymbol3DLayer failed to load (SVG symbols are not supported in IE11)"));
b(this._context.sharedResources.textures.acquire(f,null,a),function(b){if(!e.isRejected()){var f=b.params,g=f.width/f.height;a?1<g?e._size=[a,Math.round(a/g)]:e._size=[Math.round(a*g),a]:e._size=[f.width,f.height];c.textureId=b.getId();e._createMaterialsAndAddToStage(c,e._context.stage,d);e.resolve()}},function(a){a instanceof g?e.reject():(a="IconSymbol3DLayer failed to load (Request for icon resource failed: "+f+")",e._logWarning(a),e.reject(new x("Request Failed",a)))});this._textureURI=f},l.prototype._createMaterialsAndAddToStage=
function(a,b,c){this._fastUpdates=t.initFastSymbolUpdatesState(this._context.renderer,this._supportsShaderVisualVariables(),this._fastVisualVariableConvertOptions());this._fastUpdates.enabled&&d.mixin(a,this._fastUpdates.materialParameters);var e=d.mixin({},a);e.verticalOffset=null;e.screenSizePerspective=null;e.occlusionTest=!1;e.shaderPolygonOffset=0;this._drapedMaterial=new R(e,c+"_iconDraped");b.add(B.ModelContentType.MATERIAL,this._drapedMaterial);a.occlusionTest=!0;this._material=new R(a,c+
"_icon");b.add(B.ModelContentType.MATERIAL,this._material)},l.prototype.destroy=function(){k.prototype.destroy.call(this);this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(B.ModelContentType.MATERIAL,this._material.getId()),this._material=null);this._drapedMaterial&&(this._context.stage.remove(B.ModelContentType.MATERIAL,this._drapedMaterial.getId()),this._drapedMaterial=null);this._textureURI&&(this._context.sharedResources.textures.release(this._textureURI),this._textureURI=
null)},l.prototype._getGeometry=function(a){a=this._validateGeometry(a.geometry);return"extent"===a.type?c.placePointOnPolygon(w.fromExtent(a)):"polyline"===a.type?c.placePointOnPolyline(a):"polygon"===a.type?c.placePointOnPolygon(a):"point"===a.type?a:(this._logWarning("unsupported geometry type for icon symbol: "+a.type),null)},l.prototype._getScaleFactor=function(a){if(this._isPropertyDriven("size")&&a.size){for(var b=0;3>b;b++){var c=a.size[b];c&&"symbolValue"!==c&&"proportional"!==c&&(a.size[b]=
u.pt2px(c))}b=this._size[0]>this._size[1]?this._size[0]:this._size[1];if("symbolValue"===a.size[0])return 1;if(isFinite(+a.size[0]))return+a.size[0]/b;if(isFinite(+a.size[2]))return+a.size[2]/b}return 1},l.prototype.createGraphics3DGraphic=function(a,b){var c=this._getGeometry(a);if(null===c)return null;var d="graphic"+a.uid,e=this._getVertexOpacityAndColor(b),f=1;this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size||(f=this._getScaleFactor(b));f*=this._symbolTextureRatio;b=[this._size[0]*
f,this._size[1]*f];f=this.getGraphicElevationContext(a);return"on-the-ground"===f.mode?this._createAsOverlay(a,c,e,b,f,d,a.uid):this._createAs3DShape(a,c,e,b,f,d,a.uid)},l.prototype.layerPropertyChanged=function(a,b,d){if("opacity"===a)return b=this._getFillColor(this.symbol,this._primitive),this._drapedMaterial.setParameterValues({color:b}),this._material.setParameterValues({color:b}),b=this._getOutlineColor(this.symbol),this._drapedMaterial.setParameterValues({outlineColor:b}),this._material.setParameterValues({outlineColor:b}),
!0;if("elevationInfo"===a){a=this._elevationContext.mode;this._updateElevationContext();var e=this._elevationContext.mode;if("on-the-ground"===a&&"on-the-ground"===e)return!0;if(a!==e&&("on-the-ground"===a||"on-the-ground"===e))return!1;a=c.needsElevationUpdates2D(e)||"absolute-height"===e;for(var f in b){var g=b[f];(e=d(g))&&!e.isDraped()&&(g=this.getGraphicElevationContext(g.graphic),e.needsElevationUpdates=a,e.elevationContext.set(g))}return!0}return!1},l.prototype.applyRendererDiff=function(a,
b,c,d){for(var e in a.diff)switch(e){case "visualVariables":if(!t.updateFastSymbolUpdatesState(this._fastUpdates,b,this._fastVisualVariableConvertOptions()))return!1;this._material.setParameterValues(this._fastUpdates.materialParameters);this._drapedMaterial.setParameterValues(this._fastUpdates.materialParameters);break;default:return!1}return!0},l.prototype.setDrawOrder=function(a,b,c){this._drapedMaterial&&(this._drapedMaterial.setRenderPriority(a),c[this._drapedMaterial.getId()]=!0)},l.prototype._defaultElevationInfoNoZ=
function(){return X},l.prototype._createAs3DShape=function(a,b,d,g,h,k,l){var n=this,p=this._getFastUpdateAttrValues(a);a=p?function(a){return t.evaluateModelTransform(n._fastUpdates.materialParameters,p,a)}:null;d=G.createPointGeometry(S,null,d,g,ba,null,p);d=[new F(d,k)];k=c.createStageObjectForPoint.call(this,b,d,[[this._material]],null,null,h,k,this._context.layer.uid,l,!0,a);if(null===k)return null;var m=new f(this,k.object,d,null,null,e.perObjectElevationAligner,h);return m.alignedTerrainElevation=
k.terrainElevation,m.needsElevationUpdates=c.needsElevationUpdates2D(h.mode)||"absolute-height"===h.mode,m.getScreenSize=this._createScreenSizeGetter(g,a),m.calculateRelativeScreenBounds=function(a){return n._material.calculateRelativeScreenBounds(m.getScreenSize(),1,a)},c.extendPointGraphicElevationContext(m,b,this._context.elevationProvider),m},l.prototype._createAsOverlay=function(b,d,e,f,g,h,k){var l=this;this._drapedMaterial.setRenderPriority(this._symbolLayerOrder);k=T.create();z.pointToVector(d,
k,this._context.overlaySR);k[2]=this._getDrapedZ();if((d=this._context.clippingExtent)&&!c.pointInBox2D(k,d))return null;var n=this._getFastUpdateAttrValues(b);b=n?function(a){return t.evaluateModelTransform(l._fastUpdates.materialParameters,n,a)}:null;e=G.createPointGeometry(S,k,e,f,null,null,n);d=new N(e);d.material=this._drapedMaterial;d.center=k;d.bsRadius=0;d.transformation=O;d.name=h;d.uniqueName=h+"#"+e.id;var p=new a(this,[d],null,null,null,g);return p.getScreenSize=this._createScreenSizeGetter(f,
b),p.calculateRelativeScreenBounds=function(a){return l._drapedMaterial.calculateRelativeScreenBounds(p.getScreenSize(),1,a)},p},l.prototype._createScreenSizeGetter=function(a,b){var c=this._outlineSize+2;if(this._fastUpdates.enabled){var d=a[0]/this._symbolTextureRatio,e=a[1]/this._symbolTextureRatio;return function(a){void 0===a&&(a=Array(2));var f=b(O);return a[0]=f[0]*d+c,a[1]=f[5]*e+c,a}}var f=a[0]/this._symbolTextureRatio+c,g=a[1]/this._symbolTextureRatio+c;return function(a){return void 0===
a&&(a=Array(2)),a[0]=f,a[1]=g,a}},l.prototype._supportsShaderVisualVariables=function(){return!0},l.prototype._fastVisualVariableConvertOptions=function(){var a=this._size[0]>this._size[1]?this._size[0]:this._size[1],b=[a,a,a],c=u.px2pt(1),a=a*c;return{modelSize:b,symbolSize:[a,a,a],unitInMeters:c,transformation:{anchor:Y,scale:W,rotation:Y}}},l.prototype._hasVisibleVerticalOffset=function(a){return this.symbolContainer&&"point-3d"===this.symbolContainer.type&&this.symbolContainer.hasVisibleVerticalOffset()},
l.PRIMITIVE_SIZE=V,l.VALID_ANCHOR_STRINGS=E,l}(k);var X={mode:"relative-to-ground",offset:0},ba=m.createFrom(0,0,0,1);return k})},"esri/views/3d/layers/graphics/Graphics3DSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../support/PromiseLightweight ./featureExpressionInfoUtils ./ElevationContext ./graphicUtils ./Graphics3DSymbolCommonCode ./constants ../../../../core/Logger ../../../../Color ../../../../core/Scheduler".split(" "),function(m,l,h,d,b,g,k,
f,a,e,c,q){function t(a,b){a=null!=a?b.attributes[a]:0;return null!=a&&isFinite(a)||(a=0),a}var r=new g,u=e.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayer"),v={mode:"on-the-ground",offset:0,unit:"meters"},x={mode:"absolute-height",offset:0,unit:"meters"};return function(d){function e(a,b,c,e){var f=d.call(this)||this;return f._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0},f.symbolContainer=a,f.symbol=b,f._context=c,f._symbolLayerOrder=c.layerOrder,f._symbolLayerOrderDelta=
c.layerOrderDelta,f._elevationContext=new g,f._material=null,f._geometryCreationWarningHandle=null,f._updateDrivenProperties(e),f._updateElevationContext(),f._prepareResources(),f}return h(e,d),e.prototype._logWarning=function(a){u.warn(a)},e.prototype._logGeometryCreationWarnings=function(a,b,c,d){var e=this;if(null==this._geometryCreationWarningHandle){var f=a.geometryData&&a.geometryData.polygons;d+=" geometry failed to be created";var g=null;a.projectionSuccess?!b.length||1===b.length&&!b[0].length?
g=d+" (no "+c+" were defined)":Array.isArray(b)&&Array.isArray(b[0])?b.some(function(a){return 1===a.length})?g=d+" ("+c+" should contain at least 2 vertices)":f&&0===f.length&&"rings"===c&&(g=d+" (filled "+c+" should use clockwise winding - try reversing the order of vertices)"):g=d+" ("+c+" should be defined as a 2D array)":g=d+" (failed to project geometry to view spatial reference)";g&&(this._geometryCreationWarningHandle=q.schedule(function(){return e._onNextTick()}),this._logWarning(g))}},e.prototype._onNextTick=
function(){this._geometryCreationWarningHandle=null},e.prototype._validateGeometry=function(a){switch(a.type){case "point":if(null==a.x||null==a.y){this._logWarning("point coordinate is null - setting to default value");var b=a.clone();return b.x=a.x||0,b.y=a.y||0,b}}return a},e.prototype._prepareResources=function(a){throw Error("This is an abstract base class");},e.prototype._defaultElevationInfoNoZ=function(){return v},e.prototype._defaultElevationInfoZ=function(){return x},e.prototype._updateElevationContext=
function(){this._elevationContext.setDefaults();var a=this._context.layer.elevationInfo;a&&this._elevationContext.mixinApi(a);(a=this.symbol&&this.symbol.elevationInfo)&&this._elevationContext.mixinApi(a);this._elevationContext.featureExpressionInfoContext=this._context.featureExpressionInfoContext},e.prototype.getGraphicElevationContext=function(c){var d=c.geometry.hasZ?this._defaultElevationInfoZ():this._defaultElevationInfoNoZ();r.setUnit(null!=this._elevationContext.unit?this._elevationContext.unit:
d.unit);r.mode=this._elevationContext.mode||d.mode;r.setOffsetMeters(null!=this._elevationContext.meterUnitOffset?this._elevationContext.meterUnitOffset:d.offset);r.featureExpressionInfoContext=this._elevationContext.featureExpressionInfoContext;r.hasOffsetAdjustment=!1;this._elevationOptions.supportsOnTheGround||"on-the-ground"!==r.mode||(r.mode="relative-to-ground",r.setOffsetMeters(0),r.featureExpressionInfoContext=b.zeroContext);d=b.createFeature(c);return b.setContextFeature(r.featureExpressionInfoContext,
d),f.needsOffsetAdjustment(r,this._elevationOptions,c.geometry,this.symbolContainer)&&(r.setOffsetRenderUnits(a.defaultIconElevationOffset),r.hasOffsetAdjustment=!0),r},e.prototype._getDrapedZ=function(){return-2},e.prototype._updateDrivenProperties=function(a){var b={color:!1,opacity:!1,size:!1};a||(a=this._context.renderer)&&(b.color=!!a.colorInfo,b.size=!!a.sizeInfo,a.visualVariables&&a.visualVariables.forEach(function(a){switch(a.type){case "color":if(b.color=!0,a.colors)for(var c=0;c<a.colors.length;c++){var d=
a.colors[c];d&&(Array.isArray(d)&&3<d.length&&255!==d[3]||void 0!==d.a&&255!==d.a)&&(b.opacity=!0)}if(a.stops)for(c=0;c<a.stops.length;c++)(d=a.stops[c].color)&&(Array.isArray(d)&&3<d.length&&255!==d[3]||void 0!==d.a&&255!==d.a)&&(b.opacity=!0);break;case "opacity":b.opacity=!0;break;case "size":b.size=!0}}));this._drivenProperties=b},e.prototype._isPropertyDriven=function(a){return this._drivenProperties[a]},e.prototype._getLayerOpacity=function(){if(this._context.layerView&&"fullOpacity"in this._context.layerView)return this._context.layerView.fullOpacity;
var a=this._context.layer.opacity;return null==a?1:a},e.prototype._getMaterialOpacity=function(){var a;a=1*this._getLayerOpacity();var b=this.symbol&&this.symbol.material;return b&&!this._isPropertyDriven("opacity")&&b.color&&(a*=b.color.a),a},e.prototype._getMaterialOpacityAndColor=function(){var a=this.symbol&&this.symbol.material,b=this._getMaterialOpacity(),a=!this._isPropertyDriven("color")&&a&&a.color?c.toUnitRGB(a.color):null;return k.mixinColorAndOpacity(a,b)},e.prototype._getVertexOpacityAndColor=
function(a,b,c){var d=this._isPropertyDriven("color")?a.color:null;a=this._isPropertyDriven("opacity")?a.opacity:null;d=k.mixinColorAndOpacity(d,a);return c&&(d[0]*=c,d[1]*=c,d[2]*=c,d[3]*=c),b?new b(d):d},e.prototype._getStageIdHint=function(){return this._context.layer.id+"_symbol"},e.prototype.isFastUpdatesEnabled=function(){return this._fastUpdates&&this._fastUpdates.enabled},e.prototype.setDrawOrder=function(a,b,c){this._material&&(this._material.setRenderPriority(a),c[this._material.getId()]=
!0)},e.prototype.createGraphics3DGraphic=function(a,b){for(var c=2;c<arguments.length;c++);throw Error("This is an abstract base class");},e.prototype.destroy=function(){this._geometryCreationWarningHandle&&(this._geometryCreationWarningHandle.remove(),this._geometryCreationWarningHandle=null)},e.prototype.layerPropertyChanged=function(a,b,c){return!1},e.prototype.applyRendererDiff=function(a,b,c,d){return!1},e.prototype._getFastUpdateAttrValues=function(a){if(!this._fastUpdates.enabled)return null;
var b=this._fastUpdates.visualVariables,c=b.size?t(b.size.field,a):0;a=b.color?t(b.color.field,a):0;return[c,a,0,0]},e}(d.Promise)})},"esri/views/3d/layers/graphics/ElevationContext":function(){define(["require","exports","../../../../symbols/support/unitConversionUtils","./featureExpressionInfoUtils"],function(m,l,h,d){return function(){function b(b){b?this.set(b):this.setDefaults()}return Object.defineProperty(b.prototype,"meterUnitOffset",{get:function(){return this._meterUnitOffset},enumerable:!0,
configurable:!0}),Object.defineProperty(b.prototype,"unit",{get:function(){return this._unit},enumerable:!0,configurable:!0}),b.prototype.setUnit=function(b){this._unit=b;this._metersPerElevationInfoUnit=h.getMetersPerUnit(b)},b.prototype.setDefaults=function(){this.mode=null;this._renderUnitOffset=this._meterUnitOffset=0;this.featureExpressionInfoContext=null;this.hasOffsetAdjustment=!1;this.setUnit("meters")},b.prototype.set=function(b){this.mode=b.mode;this._meterUnitOffset=b._meterUnitOffset||
0;this._renderUnitOffset=b._renderUnitOffset||0;this.featureExpressionInfoContext=b.featureExpressionInfoContext;this.hasOffsetAdjustment=b.hasOffsetAdjustment;this.setUnit(b.unit)},b.prototype.setOffsetMeters=function(b){this._meterUnitOffset=b;this._renderUnitOffset=0},b.prototype.setOffsetElevationInfoUnits=function(b){this._meterUnitOffset=b*this._metersPerElevationInfoUnit;this._renderUnitOffset=0},b.prototype.setOffsetRenderUnits=function(b){this._meterUnitOffset=0;this._renderUnitOffset=b},
b.prototype.addOffsetRenderUnits=function(b){this._renderUnitOffset+=b},b.prototype.mixinApi=function(b){null!=b.mode&&(this.mode=b.mode);null!=b.unit&&this.setUnit(b.unit);null!=b.offset&&this.setOffsetElevationInfoUnits(b.offset)},b.prototype.calculateOffsetRenderUnits=function(b){var g=this._meterUnitOffset,f=this.featureExpressionInfoContext;return null!=f&&(g+=d.execute(f)*this._metersPerElevationInfoUnit),g/b.unitInMeters+this._renderUnitOffset},b}()})},"esri/views/3d/layers/graphics/Graphics3DSymbolCommonCode":function(){define("require exports ../../../../geometry/Point ../../../../symbols/callouts/calloutUtils ../../../../geometry/support/coordsUtils ./graphicUtils ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/lib/Object3D".split(" "),
function(m,l,h,d,b,g,k,f,a){function e(a,b,c,d,e){var f=0,g=b.z||0,h=0,k=c.mode;d=c.calculateOffsetRenderUnits(d);c=c.featureExpressionInfoContext;return"on-the-ground"===k?(h=a.getElevation(b,"ground")||0,f=h,e&&(e.verticalDistanceToGround=0,e.terrainElevation=h)):"relative-to-ground"===k?(h=a.getElevation(b,"ground")||0,f=d,null==c&&(f+=g),e&&(e.verticalDistanceToGround=f,e.terrainElevation=h),f+=h):"relative-to-scene"===k?(h=a.getElevation(b,"scene")||0,f=d,e&&(e.verticalDistanceToGround=f,e.terrainElevation=
h),f+=h):"absolute-height"===k&&(f=d,null==c&&(f+=g),e&&(h=a.getElevation(b,"ground")||0,e.verticalDistanceToGround=f-h,e.terrainElevation=h)),f}function c(a){for(var b=0,c=a.length-1,d=0;c>d;d++)b+=a[d][0]*a[d+1][1]-a[d+1][0]*a[d][1];return 0<=b}function q(a,b,c,d,e,f){d*=3;for(var g=0;e>g;++g){var h=a[b++];c[d++]=h[0];c[d++]=h[1];c[d++]=f?h[2]:0}return d/3}function t(a,b){for(var d=a.length,e=Array(d),f=Array(d),g=Array(d),h=0,k=0,l=0,n=0,m=0;d>m;++m)n+=a[m].length;for(var n=new Float64Array(3*
n),r=0,t=d-1;0<=t;t--){var u=a[t];if(c(u))e[h++]=u;else{for(var w=u.length,m=0;h>m;++m)w+=e[m].length;m={index:r,pathLengths:Array(h+1),count:w,holeIndices:Array(h)};m.pathLengths[0]=u.length;0<u.length&&(g[l++]={index:r,count:u.length});r=q(u,0,n,r,u.length,b);for(u=0;h>u;++u)w=e[u],m.holeIndices[u]=r,m.pathLengths[u+1]=w.length,0<w.length&&(g[l++]={index:r,count:w.length}),r=q(w,0,n,r,w.length,b);h=0;0<m.count&&(f[k++]=m)}}for(u=0;h>u;++u)w=e[u],0<w.length&&(g[l++]={index:r,count:w.length}),r=q(w,
0,n,r,w.length,b);return d>k&&(f.length=k),d>l&&(g.length=l),{vertexData:n,polygons:f,outlines:g}}function r(a,b,c,d,e){b*=3;d*=3;for(var f=0;e>f;++f)c[d++]=a[b++],c[d++]=a[b++],c[d++]=a[b++]}function u(a,b,c,d,e,f,g){return k.bufferToBuffer(a,c,b,d,f,e,g)}function v(a,b,c){k.pointToVector(a,b,c)}function x(a,b){return!(a[0]>b[3]||a[0]<b[0]||a[1]>b[4]||a[1]<b[1])}function y(a,b){return!(b[0]>a[3]||b[3]<a[0]||b[1]>a[4]||b[4]<a[1])}Object.defineProperty(l,"__esModule",{value:!0});m=f.mat4d;var n=f.vec3d.create(),
w=m.identity(),z=new h({x:0,y:0,z:0,spatialReference:null});l.createStageObjectForPoint=function(b,c,d,f,h,l,m,q,r,t,u){var y=c?c.length:0,z=this._context.clippingExtent;if(v(b,n,this._context.elevationProvider.spatialReference),z&&!x(n,z))return null;v(b,n,this._context.renderSpatialReference);z=this._context.localOriginFactory.getOrigin(n);m=new a({castShadow:!1,metadata:{layerUid:q,graphicId:r,usesVerticalDistanceToGround:!!t},idHint:m});for(q=0;y>q;q++)m.addGeometry(c[q],d[q],f?f[q]:w,h,z,u);
c=this._context.renderSpatialReference;f=this._context.elevationProvider;h=this._context.renderCoordsHelper;var F;d=0;m.metadata.usesVerticalDistanceToGround?(d=e(f,b,l,h,C),g.updateVertexAttributeAuxpos1w(m,C.verticalDistanceToGround),F=C.terrainElevation):(u="absolute-height"!==l.mode,d=e(f,b,l,h,u?C:null),u&&(F=C.terrainElevation));l=m.getObjectTransformation();n[0]=b.x;n[1]=b.y;n[2]=d;b=(k.computeLinearTransformation(b.spatialReference,n,l,c)?m.setObjectTransformation(l):console.warn("Could not locate symbol object properly, it might be misplaced"),
{terrainElevation:F});return{object:m,terrainElevation:b.terrainElevation}};l.extendPointGraphicElevationContext=function(a,b,c){a=a.elevationContext;c=c.spatialReference;v(b,n,c);a.centerPointInElevationSR=new h({x:n[0],y:n[1],z:b.hasZ?n[2]:0,spatialReference:c})};l.placePointOnPolyline=function(a){var c=a.paths[0];if(!c||0===c.length)return null;c=b.getPointOnPath(c,b.getPathLength(c)/2);return new h({x:c[0],y:c[1],z:c[2],spatialReference:a.spatialReference})};l.placePointOnPolygon=function(a){return g.computeCentroid(a)};
l.computeElevation=e;l.getSingleSizeDriver=function(a,b){return void 0===b&&(b=0),isFinite(a[b])?a[b]:null};l.isCounterClockwise=c;l.copyPointData=q;l.copyPathData=t;l.copyVertices=r;l.chooseOrigin=function(a,b,c,d){b=Math.floor(b+(c-1)/2);d[0]=a[3*b+0];d[1]=a[3*b+1];d[2]=a[3*b+2]};l.subtractCoordinates=function(a,b,c,d){b*=3;for(var e=0;c>e;++e)a[b++]-=d[0],a[b++]-=d[1],a[b++]-=d[2]};l.setZ=function(a,b,c,d){b*=3;for(var e=0;c>e;++e)a[b+2]=d,b+=3};l.offsetZ=function(a,b,c,d){b*=3;for(var e=0;c>e;++e)a[b+
2]+=d,b+=3};l.scaleZ=function(a,b,c,d){b*=3;for(var e=0;c>e;++e)a[b+2]*=d,b+=3};l.flatArrayToArrayOfArrays=function(a,b,c){var d=[];b*=3;for(var e=0;c>e;++e)d.push([a[b++],a[b++],a[b++]]);return d};l.reproject=u;l.reprojectPoint=v;l.getGeometryVertexData3D=function(a,b,c,d,e,f,g){var h=e.spatialReference;a=t(a,b);b=a.vertexData;var k=b.length/3,l=new Float64Array(b.length),n=!0;c.equals(h)?r(b,0,l,0,b.length):n=u(b,0,c,l,0,h,k);var m=0,q=0,w=g.mode,v=0,p=0;c=0;f=g.calculateOffsetRenderUnits(f);g=
g.featureExpressionInfoContext;z.spatialReference=e.spatialReference;for(var m=3*m,q=3*q,x=0;k>x;++x)z.x=l[m+0],z.y=l[m+1],z.z=l[m+2],"on-the-ground"===w?(v=e.getElevation(z)||0,p=v,c+=v):"relative-to-ground"===w?(v=e.getElevation(z)||0,p=v+f,null==g&&(p+=z.z),c+=v):"relative-to-scene"===w?(v=e.getElevation(z,"scene")||0,p=v+f,c+=v):"absolute-height"===w&&(p=f,null==g&&(p+=z.z)),b[q+0]=l[m+0],b[q+1]=l[m+1],b[q+2]=p,m+=3,q+=3;e=(c/=k,{terrainElevation:c});return h.equals(d)||u(b,0,h,b,0,d,k),{geometryData:a,
vertexData:b,eleVertexData:l,terrainElevation:e.terrainElevation,projectionSuccess:n}};l.getGeometryVertexDataDraped=function(a,b,c){a=t(a,!1);var d=a.vertexData,e=d.length/3,f=!0;return b.equals(c)||(f=k.bufferToBuffer(d,b,0,d,c,0,e)),{geometryData:a,vertexData:d,projectionSuccess:f}};l.computeBoundingBox=function(a,b,c,d){d[0]=Number.MAX_VALUE;d[1]=Number.MAX_VALUE;d[2]=Number.MAX_VALUE;d[3]=-Number.MAX_VALUE;d[4]=-Number.MAX_VALUE;d[5]=-Number.MAX_VALUE;b*=3;for(var e=0;c>e;++e){var f=a[b++],g=
a[b++],h=a[b++];f<d[0]&&(d[0]=f);g<d[1]&&(d[1]=g);h<d[2]&&(d[2]=h);f>d[3]&&(d[3]=f);g>d[4]&&(d[4]=g);h>d[5]&&(d[5]=h)}return d};l.pointInBox2D=x;l.boxesIntersect2D=y;l.boundingBoxClipped=function(a,b){return b?!y(a,b):!1};l.needsElevationUpdates2D=function(a){return"relative-to-ground"===a||"relative-to-scene"===a};l.needsElevationUpdates3D=function(a){return"absolute-height"!==a};l.needsOffsetAdjustment=function(a,b,c,e){if(!1===b.needsOffsetAdjustment||!1===b.supportsOffsetAdjustment||"on-the-ground"===
a.mode)return!1;if(0===a.meterUnitOffset){if(!0===b.needsOffsetAdjustment)return!0;if(d.isCalloutSupport(e)&&e.hasVisibleVerticalOffset())return!1;if("relative-to-ground"===a.mode&&(!c.hasZ||a.featureExpressionInfoContext)||"relative-to-scene"===a.mode)return!0}return!1};var C={verticalDistanceToGround:0,terrainElevation:0}})},"esri/views/3d/layers/graphics/constants":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.defaultIconElevationOffset=
1})},"esri/views/3d/layers/graphics/Graphics3DGraphicLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ./Graphics3DGraphicElevationContext ./featureExpressionInfoUtils ../../webgl-engine/Stage ../../lib/glMatrix ../../support/aaBoundingBox".split(" "),function(m,l,h,d,b,g,k,f,a,e){m=a.vec3d;var c=a.mat4d,q=[0,0,0];a=function(){function a(b,c,d,e,f,h,k,l){this._addedToStage=!1;this.alignedTerrainElevation=
0;this.needsElevationUpdates=!1;this.graphics3DSymbolLayer=b;this.uniqueMaterials=e;this.uniqueGeometries=d;this.uniqueTextures=f;this.stageObject=c;this.elevationAligner=h;this.elevationContext=new g(k);this.stageLayer=this.stage=null;this._visible=!1;this.visibilityMode=null!=l?l:a.VisibilityModes.HIDE_FACERANGE}return a.prototype.initialize=function(a,b){if(this.stageLayer=a,this.stage=b,this.uniqueMaterials)for(a=0;a<this.uniqueMaterials.length;a++)b.add(f.ModelContentType.MATERIAL,this.uniqueMaterials[a]);
if(this.uniqueGeometries)for(a=0;a<this.uniqueGeometries.length;a++)b.add(f.ModelContentType.GEOMETRY,this.uniqueGeometries[a]);if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)b.add(f.ModelContentType.TEXTURE,this.uniqueTextures[a]);b.add(f.ModelContentType.OBJECT,this.stageObject)},a.prototype.isDraped=function(){return!1},a.prototype.setVisibility=function(b){return null!=this.stage?this._visible!==b?(this._visible=b,this._visible?this._addedToStage?this.stageObject.unhideAllComponents():
(this.stageLayer.addObject(this.stageObject),this._addedToStage=!0):this.visibilityMode===a.VisibilityModes.HIDE_FACERANGE?this.stageObject.hideAllComponents():(this.stageLayer.removeObject(this.stageObject),this._addedToStage=!1),!0):!1:void 0},a.prototype.destroy=function(){var a=this.stage;if(this.stageLayer){if(this.uniqueMaterials)for(var b=0;b<this.uniqueMaterials.length;b++)a.remove(f.ModelContentType.MATERIAL,this.uniqueMaterials[b].getId());if(this.uniqueGeometries)for(b=0;b<this.uniqueGeometries.length;b++)a.remove(f.ModelContentType.GEOMETRY,
this.uniqueGeometries[b].getId());if(this.uniqueTextures)for(b=0;b<this.uniqueTextures.length;b++)a.remove(f.ModelContentType.TEXTURE,this.uniqueTextures[b].getId())}a.remove(f.ModelContentType.OBJECT,this.stageObject.getId());this._addedToStage&&(this.stageLayer.removeObject(this.stageObject),this._addedToStage=!1);this._visible=!1;this.stage=this.stageLayer=null},a.prototype.alignWithElevation=function(a,b,c){this.elevationAligner&&(k.setContextFeature(this.elevationContext.featureExpressionInfoContext,
c),a=this.elevationAligner(this.stageObject,this.elevationContext,a,b),null!=a&&(this.alignedTerrainElevation=a))},a.prototype.setDrawOrder=function(a,b,c){},a.prototype.getBSRadius=function(){return this.stageObject.getBSRadius()},a.prototype.getCenterObjectSpace=function(){return this.stageObject.getCenter(!0)},a.prototype.getBoundingBoxObjectSpace=function(a){var b=this.stageObject;return a||(a=e.create()),e.setMin(a,b.getBBMin(!0)),e.setMax(a,b.getBBMax(!0)),a},a.prototype.getProjectedBoundingBox=
function(a,f,g,h){return b(this,void 0,void 0,function(){var b,k,l,n,m,w,v,x;return d(this,function(d){switch(d.label){case 0:b=this.getBoundingBoxObjectSpace(g);k=u;l=e.isPoint(b)?1:k.length;for(n=0;l>n;n++)m=k[n],r[0]=b[m[0]],r[1]=b[m[1]],r[2]=b[m[2]],c.multiplyVec3(this.stageObject.objectTransformation,r),t[3*n+0]=r[0],t[3*n+1]=r[1],t[3*n+2]=r[2];if(!a(t,0,l))return[3,6];e.set(b,e.NEGATIVE_INFINITY);w=null;this.calculateRelativeScreenBounds&&(w=this.calculateRelativeScreenBounds());for(n=0;3*l>
n;n+=3){for(v=0;3>v;v++)b[v]=Math.min(b[v],t[n+v]),b[v+3]=Math.max(b[v+3],t[n+v]);w&&h.push({location:t.slice(n,n+3),screenSpaceBoundingRect:w})}if(!f||(e.center(b,q),"absolute-height"===this.elevationContext.mode))return[3,5];x=void 0;d.label=1;case 1:return d.trys.push([1,3,,4]),[4,f.queryElevation(q[0],q[1])];case 2:return x=d.sent(),[3,4];case 3:return d.sent(),x=null,[3,4];case 4:null!=x&&e.offset(b,0,0,-this.alignedTerrainElevation+x),d.label=5;case 5:return[2,b];case 6:return[2,null]}})})},
a.prototype.addHighlight=function(a,b){b=this.stageObject.highlightAllComponents(b);a.addObject(this.stageObject,b)},a.prototype.removeHighlight=function(a){a.removeObject(this.stageObject)},a.VisibilityModes={REMOVE_OBJECT:0,HIDE_FACERANGE:1},a}();var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=m.create(),u=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];return a})},"esri/views/3d/layers/graphics/Graphics3DGraphicElevationContext":function(){define(["require","exports",
"../../../../core/tsSupport/extendsHelper","./ElevationContext"],function(m,l,h,d){return function(b){function d(d){d=b.call(this,d)||this;return d.centerPointInElevationSR=null,d}return h(d,b),d}(d)})},"esri/views/3d/layers/graphics/Graphics3DDrapedGraphicLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ./ElevationContext ../../support/aaBoundingBox ../../support/aaBoundingRect ../../webgl-engine/Stage".split(" "),
function(m,l,h,d,b,g,k,f,a){m=function(){function f(a,b,c,d,e,f){this.needsElevationUpdates=!1;this.graphics3DSymbolLayer=a;this.renderGeometries=b;this.uniqueMaterials=c;this.uniqueTextures=d;this.boundingBox=e;this.elevationContext=new g(f);this.stage=null;this._visible=!1}return f.prototype.initialize=function(b,c){if(this.stage=c,this.uniqueMaterials)for(b=0;b<this.uniqueMaterials.length;b++)c.add(a.ModelContentType.MATERIAL,this.uniqueMaterials[b]);if(this.uniqueTextures)for(b=0;b<this.uniqueTextures.length;b++)c.add(a.ModelContentType.TEXTURE,
this.uniqueTextures[b])},f.prototype.isDraped=function(){return!0},f.prototype.setVisibility=function(a){return null!=this.stage?this._visible!==a?(this._visible=a,this._visible?this.stage.getTextureGraphicsRenderer().addRenderGeometries(this.renderGeometries):this.stage.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries),!0):!1:void 0},f.prototype.destroy=function(){if(this.stage){var b=this.stage;if(this._visible&&b.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries),
this._visible=!1,this.uniqueMaterials)for(var c=0;c<this.uniqueMaterials.length;c++)b.remove(a.ModelContentType.MATERIAL,this.uniqueMaterials[c].getId());if(this.uniqueTextures)for(c=0;c<this.uniqueTextures.length;c++)b.remove(a.ModelContentType.TEXTURE,this.uniqueTextures[c].getId());this.stage=null}},f.prototype.alignWithElevation=function(a,b,c){},f.prototype.setDrawOrder=function(a,b,c){var d=this;this.uniqueMaterials&&this.uniqueMaterials.forEach(function(c){c.setRenderPriority(a);d._visible&&
(b[c.getId()]=!0)})},f.prototype.getBSRadius=function(){return this.renderGeometries.reduce(function(a,b){return Math.max(a,b.bsRadius)},0)},f.prototype.getCenterObjectSpace=function(){return[0,0,0]},f.prototype.addHighlight=function(a,b){var c=this.stage.getTextureGraphicsRenderer();this.renderGeometries.forEach(function(d){var e=c.addRenderGeometryHighlight(d,b);a.addRenderGeometry(d,c,e)})},f.prototype.removeHighlight=function(a){this.renderGeometries.forEach(function(b){a.removeRenderGeometry(b)})},
f.prototype.getProjectedBoundingBox=function(a,c,f,g){return b(this,void 0,void 0,function(){var b,h,l;return d(this,function(d){switch(d.label){case 0:k.set(f,k.NEGATIVE_INFINITY);for(b=0;b<this.renderGeometries.length;b++)h=this.renderGeometries[b],this._getRenderGeometryProjectedBoundingRect(h,e,a,g),k.expand(f,e);if(!c)return[3,5];k.center(f,q);l=void 0;d.label=1;case 1:return d.trys.push([1,3,,4]),[4,c.queryElevation(q[0],q[1])];case 2:return l=d.sent(),[3,4];case 3:return d.sent(),l=null,[3,
4];case 4:null!=l&&(f[2]=Math.min(f[2],l),f[5]=Math.max(f[5],l)),d.label=5;case 5:return[2,f]}})})},f.prototype._getRenderGeometryProjectedBoundingRect=function(a,b,d,e){if(this.boundingBox)k.set(c,this.boundingBox);else{var f=a.center;a=a.bsRadius;c[0]=f[0]-a;c[1]=f[1]-a;c[2]=f[2]-a;c[3]=f[0]+a;c[4]=f[1]+a;c[5]=f[2]+a}return d(c,0,2),this.calculateRelativeScreenBounds&&e.push({location:k.center(c),screenSpaceBoundingRect:this.calculateRelativeScreenBounds()}),k.toRect(c,b)},f}();var e=f.create(),
c=[0,0,0,0,0,0],q=[0,0,0];return m})},"esri/views/3d/layers/graphics/ElevationAligners":function(){define("require exports ../../../../geometry/Point ../../lib/glMatrix ../../support/projectionUtils ../../support/debugFlags ../../webgl-engine/lib/Util ./Graphics3DSymbolCommonCode ./graphicUtils".split(" "),function(m,l,h,d,b,g,k,f,a){Object.defineProperty(l,"__esModule",{value:!0});var e=k.VertexAttrConstants;m=d.vec3d;var c=new h,q=m.create(),t=m.create(),r=m.create(),u={verticalDistanceToGround:0,
terrainElevation:0};l.perVertexElevationAligner=function(a,b,d,h){c.spatialReference=d.spatialReference;for(var k=a.getGeometryRecords(),n=k.length,m="absolute-height"!==b.mode,v=0,x=0;n>x;x++){var y=k[x].geometry,N=k[x].getShaderTransformation(),M=y.getData();t[0]=N[12];t[1]=N[13];t[2]=N[14];y.invalidateBoundingInfo();for(var N=M.getVertexAttr(),M=N[e.POSITION],y=M.data,N=N.mapPos.data,M=M.size,R=y.length/M,P=0,Q=0,T=!1,O=0,S=0;R>S;S++){c.x=N[Q++];c.y=N[Q++];c.z=N[Q++];r[0]=y[P];r[1]=y[P+1];r[2]=
y[P+2];var H=f.computeElevation(d,c,b,h,m?u:null);(m&&(O+=u.terrainElevation),q[0]=y[P]+t[0],q[1]=y[P+1]+t[1],q[2]=y[P+2]+t[2],h.setAltitude(H,q),y[P]=q[0]-t[0],y[P+1]=q[1]-t[1],y[P+2]=q[2]-t[2],g.TESTS_DISABLE_UPDATE_THROTTLE_THRESHOLDS)?T=!0:(H=l.updateThresholdInMeters/h.unitInMeters,(Math.abs(r[0]-y[P])>=H||Math.abs(r[1]-y[P+1])>=H||Math.abs(r[2]-y[P+2])>=H)&&(T=!0));P+=M}v+=O/R;T&&a.geometryVertexAttrsUpdated(x)}return v/n};l.perObjectElevationAligner=function(c,d,e,h,k){var n=d.centerPointInElevationSR,
m=0;k=0;if(c.metadata.usesVerticalDistanceToGround)m=f.computeElevation(e,n,d,h,u),a.updateVertexAttributeAuxpos1w(c,u.verticalDistanceToGround),k=u.terrainElevation;else{var r="absolute-height"!==d.mode,m=f.computeElevation(e,n,d,h,r?u:null);r&&(k=u.terrainElevation)}d=c.getObjectTransformation();e=[d[12],d[13],d[14]];g.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES?(q[0]=n.x,q[1]=n.y,q[2]=m,b.computeLinearTransformation(n.spatialReference,q,d,h.spatialReference)&&c.setObjectTransformation(d)):h.setAltitudeOfTransformation(m,
d);h=l.updateThresholdInMeters/h.unitInMeters;return(Math.abs(d[12]-e[0])>=h||Math.abs(d[13]-e[1])>=h||Math.abs(d[14]-e[2])>=h)&&c.setObjectTransformation(d),k};l.updateThresholdInMeters=.01;l.iterativeUpdatesEnabled=!0})},"esri/views/3d/layers/graphics/SignedDistanceFunctions":function(){define(["require","exports","../../support/mathUtils"],function(m,l,h){function d(a){return a-Math.floor(a)}function b(a,b,c){a=h.clamp(a,0,.9999991);var e=d(a*g[0]),f=d(a*g[1]),l=d(a*g[2]);a=d(a*g[3]);b[c+0]=256*
(e-e*k[0]);b[c+1]=256*(f-e*k[1]);b[c+2]=256*(l-f*k[2]);b[c+3]=256*(a-l*k[3])}Object.defineProperty(l,"__esModule",{value:!0});var g=[16777216,65536,256,1],k=[0,1/256,1/256,1/256],f=[1/16777216,1/65536,1/256,1];l.packFloat=b;l.unpackFloat=function(a,b){var c=a[b+1]/256,d=a[b+2]/256,e=a[b+3]/256,g=0;return g+=a[b+0]/256*f[0],g+=c*f[1],g+=d*f[2],g+=e*f[3]};l.computeSignedDistancefieldCicle=function(a,d){var c=new Uint8Array(4*a*a),e=a/2-.5;d/=2;for(var f=0;a>f;f++)for(var g=0;a>g;g++){var h=g+a*f,k=
g-e,l=f-e,k=Math.sqrt(k*k+l*l)-d,k=k/a+.5;b(k,c,4*h)}return c};l.computeSignedDistancefieldSquare=function(a,d,c){c&&(d/=Math.SQRT2);for(var e=new Uint8Array(4*a*a),f=0;a>f;f++)for(var g=0;a>g;g++){var h=g-.5*(a-.5),k=f-.5*(a-.5),l=f*a+g;if(c)var m=(h+k)/Math.SQRT2,k=(k-h)/Math.SQRT2,h=m;h=Math.max(Math.abs(h),Math.abs(k))-.5*d;h=h/a+.5;b(h,e,4*l)}return e};l.computeSignedDistancefieldCrossAndX=function(a,d,c){c&&(d*=Math.SQRT2);d*=.5;for(var e=new Uint8Array(4*a*a),f=0;a>f;f++)for(var g=0;a>g;g++){var h=
g-.5*a+0,k=f-.5*a+0,l=f*a+g;if(c)var m=(h+k)/Math.SQRT2,k=(k-h)/Math.SQRT2,h=m;h=Math.abs(h);k=Math.abs(k);m=void 0;m=h>k?h>d?Math.sqrt((h-d)*(h-d)+k*k):k:k>d?Math.sqrt(h*h+(k-d)*(k-d)):h;m=m/a+.5;b(m,e,4*l)}return e}})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define(["require","exports","../../../../renderers/support/utils","../../lib/glMatrix","../graphics/graphicUtils"],function(m,l,h,d,b){function g(a){return null!==a&&void 0!==a}function k(a){return"number"==typeof a}function f(a,
b){a&&a.push(b);e(b)}function a(a){C&&console.warn("[FastSymbolUpdates] "+a)}function e(a){C&&console.info("[FastSymbolUpdates] "+a)}function c(a,b,c,d,e){var l=a.minSize,n=a.maxSize;if(a.expression)return f(e,"Could not convert size info: expression not supported"),!1;if(a.useSymbolValue)return a=d.symbolSize[c],b.minSize[c]=a,b.maxSize[c]=a,b.offset[c]=b.minSize[c],b.factor[c]=0,b.type[c]=1,!0;if(g(a.field))return g(a.stops)?2===a.stops.length&&k(a.stops[0].size)&&k(a.stops[1].size)?(q(a.stops[0].size,
a.stops[1].size,a.stops[0].value,a.stops[1].value,b,c),b.type[c]=1,!0):(f(e,"Could not convert size info: stops only supported with 2 elements"),!1):k(l)&&k(n)&&g(a.minDataValue)&&g(a.maxDataValue)?(q(l,n,a.minDataValue,a.maxDataValue,b,c),b.type[c]=1,!0):null!=h.meterIn[a.valueUnit]?(b.minSize[c]=-(1/0),b.maxSize[c]=1/0,b.offset[c]=0,b.factor[c]=1/h.meterIn[a.valueUnit],b.type[c]=1,!0):"unknown"===a.valueUnit?(f(e,"Could not convert size info: proportional size not supported"),!1):(f(e,"Could not convert size info: scale-dependent size not supported"),
!1);if(!g(a.field)){if(a.stops&&a.stops[0]&&k(a.stops[0].size))return b.minSize[c]=a.stops[0].size,b.maxSize[c]=a.stops[0].size,b.offset[c]=b.minSize[c],b.factor[c]=0,b.type[c]=1,!0;if(k(l))return b.minSize[c]=l,b.maxSize[c]=l,b.offset[c]=l,b.factor[c]=0,b.type[c]=1,!0}return f(e,"Could not convert size info: unsupported variant of sizeInfo"),!1}function q(a,b,c,d,e,f){d=0<Math.abs(d-c)?(b-a)/(d-c):0;e.minSize[f]=0<d?a:b;e.maxSize[f]=0<d?b:a;e.offset[f]=a-c*d;e.factor[f]=d}function t(a,b,d,e){if(a.normalizationField||
a.valueRepresentation)return f(e,"Could not convert size info: unsupported property"),null;var g=a.field;if(null!=g&&"string"!=typeof g)return f(e,"Could not convert size info: field is not a string"),null;if(b.size){if(a.field)if(b.size.field){if(a.field!==b.size.field)return f(e,"Could not convert size info: multiple fields in use"),null}else b.size.field=a.field}else b.size={field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};var h;switch(a.axis){case "width":return h=
c(a,b.size,0,d,e),h?b:null;case "height":return h=c(a,b.size,2,d,e),h?b:null;case "depth":return h=c(a,b.size,1,d,e),h?b:null;case "width-and-depth":return h=c(a,b.size,0,d,e),h&&c(a,b.size,1,d,e),h?b:null;case null:case void 0:case "all":return h=c(a,b.size,0,d,e),h=h&&c(a,b.size,1,d,e),h=h&&c(a,b.size,2,d,e),h?b:null;default:return f(e,'Could not convert size info: unknown axis "'+a.axis+'""'),null}}function r(a,b,c){for(var d=0;3>d;++d){var e=b.unitInMeters;1===a.type[d]&&(e*=b.modelSize[d],a.type[d]=
2);a.minSize[d]/=e;a.maxSize[d]/=e;a.offset[d]/=e;a.factor[d]/=e}if(0!==a.type[0])b=0;else if(0!==a.type[1])b=1;else{if(0===a.type[2])return f(c,"No size axis contains a valid size or scale"),!1;b=2}for(d=0;3>d;++d)0===a.type[d]&&(a.minSize[d]=a.minSize[b],a.maxSize[d]=a.maxSize[b],a.offset[d]=a.offset[b],a.factor[d]=a.factor[b],a.type[d]=a.type[b]);return!0}function u(a,b,c){a[4*b+0]=c.r/255;a[4*b+1]=c.g/255;a[4*b+2]=c.b/255;a[4*b+3]=c.a}function v(a,b,c){if(a.normalizationField)return f(c,"Could not convert color info: unsupported property"),
null;if("string"==typeof a.field)if(a.stops){if(8<a.stops.length)return f(c,"Could not convert color info: too many color stops"),null;b.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};a=a.stops;for(c=0;8>c;++c){var d=a[Math.min(c,a.length-1)];b.color.values[c]=d.value;u(b.color.colors,c,d.color)}}else{if(!a.colors)return f(c,"Could not convert color info: missing stops or colors"),null;if(!g(a.minDataValue)||!g(a.maxDataValue))return f(c,
"Could not convert color info: missing data values"),null;if(2!==a.colors.length)return f(c,"Could not convert color info: invalid colors array"),null;b.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};b.color.values[0]=a.minDataValue;u(b.color.colors,0,a.colors[0]);b.color.values[1]=a.maxDataValue;u(b.color.colors,1,a.colors[1]);for(c=2;8>c;++c)b.color.values[c]=a.maxDataValue,u(b.color.colors,c,a.colors[1])}else{if(!(a.stops&&
0<=a.stops.length||a.colors&&0<=a.colors.length))return f(c,"Could not convert color info: no field and no colors/stops"),null;a=a.stops&&0<=a.stops.length?a.stops[0].color:a.colors[0];b.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(c=0;8>c;c++)b.color.values[c]=1/0,u(b.color.colors,c,a)}return b}function x(a,b,c,d){a=2===c&&"arithmetic"===a.rotationType;b.offset[c]=a?90:0;b.factor[c]=a?-1:1;b.type[c]=1}function y(a,b,c){if("string"!=
typeof a.field)return f(c,"Could not convert rotation info: field is not a string"),null;if(b.rotation){if(a.field)if(b.rotation.field){if(a.field!==b.rotation.field)return f(c,"Could not convert rotation info: multiple fields in use"),null}else b.rotation.field=a.field}else b.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(a.axis){case "tilt":return x(a,b.rotation,0,c),b;case "roll":return x(a,b.rotation,1,c),b;case null:case void 0:case "heading":return x(a,b.rotation,
2,c),b;default:return f(c,'Could not convert rotation info: unknown axis "'+a.axis+'""'),null}}function n(a,b,c){if(!a)return null;var d=!b.supportedTypes||!!b.supportedTypes.size,e=!b.supportedTypes||!!b.supportedTypes.color,g=!b.supportedTypes||!!b.supportedTypes.rotation;C&&(c=c||[]);return(a=a.reduce(function(a,h){if(!a)return a;if(h.valueExpression)return f(c,"Could not convert visual variables: arcade expressions not supported"),null;switch(h.type){case "size":return d?t(h,a,b,c):a;case "color":return e?
v(h,a,c):a;case "rotation":return g?y(h,a,c):a;default:return f(c,"Could not convert visual variables: unsupported type "+h.type),null}},{size:null,color:null,rotation:null}))&&a.size&&!r(a.size,b,c)?null:a}function w(b,c,d){if(!!b!=!!c)return a("State update failed ({$name} enabled/disabled)"),!1;if(b&&b.field!==c.field)return a("State update failed ({$name} field changed)"),!1;if(b&&"rotation"===d)for(d=0;3>d;d++)if(b.type[d]!==c.type[d]||b.offset[d]!==c.offset[d]||b.factor[d]!==c.factor[d])return!1;
return!0}function z(a,b){var c={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvSymbolAnchor:null,vvSymbolRotation:null},d=a&&null!=a.size;return a&&a.size?(c.vvSizeEnabled=!0,c.vvSizeMinSize=a.size.minSize,c.vvSizeMaxSize=a.size.maxSize,c.vvSizeOffset=a.size.offset,c.vvSizeFactor=a.size.factor):a&&d&&(c.vvSizeValue=b.transformation.scale),a&&d&&(c.vvSymbolAnchor=b.transformation.anchor,
c.vvSymbolRotation=b.transformation.rotation),a&&a.color&&(c.vvColorEnabled=!0,c.vvColorValues=a.color.values,c.vvColorColors=a.color.colors),c}Object.defineProperty(l,"__esModule",{value:!0});var C=!1;l.convertVisualVariables=n;l.initFastSymbolUpdatesState=function(b,c,d){return c?b?b.disableFastUpdates?(a("State not initialized, fast updates disabled (renderer.disableFastUpdates set)"),{enabled:!1}):(b=n(b.visualVariables,d))?(e("State initialized, fast updates enabled"),{enabled:!0,visualVariables:b,
materialParameters:z(b,d),customTransformation:b&&null!=b.size}):(a("State not initialized, fast updates disabled (conversion failed)"),{enabled:!1}):(a("State not initialized, fast updates disabled (no renderer)"),{enabled:!1}):(a("State not initialized, fast updates disabled (no shader support)"),{enabled:!1})};l.updateFastSymbolUpdatesState=function(b,c,d){if(!c||!b.enabled)return!1;var f=b.visualVariables;return(c=n(c.visualVariables,d))?w(f.size,c.size,"size")&&w(f.color,c.color,"color")&&w(f.rotation,
c.rotation,"rotation")?(b.visualVariables=c,b.materialParameters=z(c,d),b.customTransformation=c&&null!=c.size,e("State updated"),!0):!1:(a("State update failed (conversion failed)"),!1)};l.getMaterialParams=z;var B;!function(a){var c=d.mat4d,e=d.vec3,f=c.create(),g=e.create();a.evaluateModelTransform=function(a,d,e){if(!a.vvSizeEnabled)return e;if(c.identity(f),c.multiply(e,f,f),b.computeObjectRotation(a.vvSymbolRotation[2],a.vvSymbolRotation[0],a.vvSymbolRotation[1],f),a.vvSizeEnabled){for(e=0;3>
e;++e){var h=a.vvSizeOffset[e]+d[0]*a.vvSizeFactor[e],k=a.vvSizeMinSize[e],l=a.vvSizeMaxSize[e];g[e]=k>h?k:h>l?l:h}c.scale(f,g,f)}else c.scale(f,a.vvSizeValue,f);return c.translate(f,a.vvSymbolAnchor,f),f}}(B||(B={}));l.evaluateModelTransform=B.evaluateModelTransform})},"esri/symbols/support/symbolUtils":function(){define(["require","exports","../../core/sniff"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.isVolumetricSymbol=function(b){return(b=b&&b.symbolLayers)?b.some(function(b){b=
b.type;return"object"===b||"path"===b||"extrude"===b}):!1};l.getIconHref=function(b,g){g=g.resource.href;return!h("esri-canvas-svg-support")&&b.styleOrigin&&d.test(g)?g.replace(d,"/resource/png/$1.png"):g};var d=/\/resource\/(.*?)\.svg$/})},"esri/views/3d/layers/graphics/Graphics3DObjectSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang dojo/errors/CancelError ../../../../Color ../../../../core/screenUtils ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./graphicUtils ../support/FastSymbolUpdates ./objectResourceUtils ../../lib/glMatrix ../../../../symbols/ObjectSymbol3DLayer ../../support/aaBoundingBox ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/Material".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z){var C=u.mat4d,B=u.vec3d,F=[1,1,1],G=[1,1,1,1],N=[0,0,0];m=[-.5,-.5,-.5,.5,.5,.5];l=[-.5,-.5,0,.5,.5,1];var M={sphere:m,cube:m,cylinder:l,cone:l,"inverted-cone":l,tetrahedron:[-.5,-.5,0,.5,.5,.5],diamond:m},R=[y.ModelContentType.MATERIAL,y.ModelContentType.TEXTURE,y.ModelContentType.GEOMETRY];return function(f){function l(){return null!==f&&f.apply(this,arguments)||this}return h(l,f),l.prototype._prepareResources=function(){var a=this.symbol,b=this._getStageIdHint();
if(!this._isPropertyDriven("size")){var c=q.validateSymbolLayerSize(this.symbol);if(c)return this._logWarning(c),void this.reject()}a.resource&&a.resource.href?this._prepareModelResources(a.resource.href,b):this._preparePrimitiveResources(a.resource?a.resource.primitive:"sphere",b)},l.prototype._preparePrimitiveResources=function(a,b){var c=this.symbol;if("sphere"===a)this._geometryData=w.createPolySphereGeometry(.5,2,!0);else if("cube"===a)this._geometryData=w.createBoxGeometry(1);else if("cylinder"===
a)this._geometryData=w.createCylinderGeometry(1,.5,32,[0,0,1],[0,0,.5]);else{if("cone"===a)this._geometryData=w.createConeGeometry(1,.5,15,!1);else if("inverted-cone"===a)this._geometryData=w.createConeGeometry(1,.5,15,!0);else if("tetrahedron"===a)this._geometryData=w.createTetrahedronGeometry(1);else{if("diamond"!==a)return this._logWarning("Unknown object symbol primitive: "+a),void this.reject();this._geometryData=w.createDiamondGeometry(1)}w.cgToGIS(this._geometryData)}this._geometry=new n(this._geometryData,
b);this._context.stage.add(y.ModelContentType.GEOMETRY,this._geometry);this._resourceBoundingBox=M[a];this._resourceSize=x.size(this._resourceBoundingBox);this._symbolSize=q.computeSizeWithResourceSize(this._resourceSize,c);a=this._getMaterialOpacity();a={specular:[0,0,0],shininess:3,opacity:a,transparent:1>a||this._isPropertyDriven("opacity"),instanced:["transformation"],ambient:F,diffuse:F};var e=this.symbolContainer;if("point-3d"===e.type&&e.verticalOffset){var e=e.verticalOffset,f=e.minWorldLength,
h=e.maxWorldLength;a.verticalOffset={screenLength:k.pt2px(e.screenLength),minWorldLength:f||0,maxWorldLength:null!=h?h:1/0};a.castShadows=!1}(this._context.screenSizePerspectiveEnabled&&(a.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),this._isPropertyDriven("color"))?a.externalColor=G:(c=c.material?g.toUnitRGBA(c.material.color):G,a.externalColor=c);this._fastUpdates=t.initFastSymbolUpdatesState(this._context.renderer,this._supportsShaderVisualVariables(),this._fastVisualVariableConvertOptions());
this._fastUpdates.enabled?(d.mixin(a,this._fastUpdates.materialParameters),a.instanced.push("featureAttribute")):this._hasPerInstanceColor()&&a.instanced.push("color");this._material=new z(a,b+"_objectmat");this._context.stage.add(y.ModelContentType.MATERIAL,this._material);this.resolve()},l.prototype._prepareModelResources=function(a,c){var e=this,f=["transformation"];c={materialParamsMixin:{instanced:f},idHint:c,streamDataSupplier:this._context.streamDataSupplier};this._fastUpdates=t.initFastSymbolUpdatesState(this._context.renderer,
this._supportsShaderVisualVariables(),this._fastVisualVariableConvertOptions());this._fastUpdates.enabled?(d.mixin(c.materialParamsMixin,this._fastUpdates.materialParameters),f.push("featureAttribute")):this._hasPerInstanceColor()&&f.push("color");f=this.symbolContainer;if("point-3d"===f.type&&f.verticalOffset){var f=f.verticalOffset,g=f.minWorldLength,h=f.maxWorldLength;c.materialParamsMixin.verticalOffset={screenLength:k.pt2px(f.screenLength),minWorldLength:g||0,maxWorldLength:null!=h?h:1/0};c.materialParamsMixin.castShadows=
!1}this._symbolLoaderPromise=r.fetch(a,c);this._symbolLoaderPromise.then(function(a){if(e._symbolLoaderPromise=null,!e.isRejected()){var b=e._context,c=a.stageResources,d=b.stage,f=e._getExternalColorParameters(e.symbol.material),g=e._getMaterialOpacity(),h=e._isPropertyDriven("opacity"),k=c[y.ModelContentType.MATERIAL];a.originalMaterialOpacities=Array(k.length);k.forEach(function(c,d){var e=c.getParameterValues();c.setParameterValues(f);a.originalMaterialOpacities[d]=e.opacity;d=e.opacity*g;c.setParameterValues({opacity:d,
transparent:1>d||h||e.transparent});b.screenSizePerspectiveEnabled&&c.setParameterValues({screenSizePerspective:b.sharedResources.screenSizePerspectiveSettings})});R.forEach(function(a){for(var b=c[a],e=0;b&&e<b.length;e++)d.add(a,b[e])});e._resourceBoundingBox=r.computeBoundingBox(a);e._resourceSize=x.size(e._resourceBoundingBox);e._pivotOffset=a.pivotOffset;e._symbolSize=q.computeSizeWithResourceSize(e._resourceSize,e.symbol);e._i3sModel=a;t.updateFastSymbolUpdatesState(e._fastUpdates,e._context.renderer,
e._fastVisualVariableConvertOptions())&&k.forEach(function(a){return a.setParameterValues(e._fastUpdates.materialParameters)});e.resolve()}},function(a){if(e._symbolLoaderPromise=null,!e.isFulfilled()){if(!(a instanceof b)){var c="ObjectSymbol3DLayer failed to load";a&&a.message&&(c+=" ("+a.message+")");e._logWarning(c)}e.reject()}})},l.prototype._forEachMaterial=function(a){this._i3sModel?this._i3sModel.stageResources[y.ModelContentType.MATERIAL].forEach(a):a(this._material)},l.prototype._getExternalColorParameters=
function(a){var b={};return this._isPropertyDriven("color")?b.externalColor=G:a&&a.color?b.externalColor=g.toUnitRGBA(a.color):(b.externalColor=G,b.colorMixMode="ignore"),b},l.prototype.destroy=function(){f.prototype.destroy.call(this);this.isFulfilled()||this.reject();this._symbolLoaderPromise&&this._symbolLoaderPromise.cancel();var a=this._context.stage;if(this._i3sModel){var b=this._i3sModel.stageResources;R.forEach(function(c){for(var d=b[c],e=0;d&&e<d.length;e++)a.remove(c,d[e].getId())})}else this._material&&
a.remove(y.ModelContentType.MATERIAL,this._material.getId()),this._geometry&&a.remove(y.ModelContentType.GEOMETRY,this._geometry.getId())},l.prototype._getGeometry=function(a){a=this._validateGeometry(a.geometry);return"polyline"===a.type?c.placePointOnPolyline(a):"polygon"===a.type?c.placePointOnPolygon(a):"extent"===a.type?a.center:"point"!==a.type?(this._logWarning("unsupported geometry type for object symbol: "+a.type),null):a},l.prototype.createGraphics3DGraphic=function(a,b){var c=this._getGeometry(a);
if(null===c)return null;var d="graphic"+a.uid,e=this.getGraphicElevationContext(a);return this._createAs3DShape(a,c,b,e,d,a.uid)},l.prototype.layerPropertyChanged=function(a,b,d){var e=this;if("opacity"===a){var f=this._isPropertyDriven("opacity");if(this._i3sModel){var g=this._getMaterialOpacity();this._i3sModel.stageResources[y.ModelContentType.MATERIAL].forEach(function(a,b){b=e._i3sModel.originalMaterialOpacities[b]*g;a.setParameterValues({opacity:b,transparent:1>b||f})})}else b=this._getMaterialOpacity(),
this._material.setParameterValues({opacity:b,transparent:1>b||f});return!0}if("elevationInfo"===a){this._updateElevationContext();for(var h in b){var k=b[h];if(a=d(k))k=this.getGraphicElevationContext(k.graphic),a.needsElevationUpdates=c.needsElevationUpdates3D(k.mode),a.elevationContext.set(k)}return!0}return!1},l.prototype.applyRendererDiff=function(a,b,c,d){var e=this,f;for(f in a.diff)switch(f){case "visualVariables":if(!t.updateFastSymbolUpdatesState(this._fastUpdates,b,this._fastVisualVariableConvertOptions()))return!1;
this._forEachMaterial(function(a){return a.setParameterValues(e._fastUpdates.materialParameters)});break;default:return!1}return!0},l.prototype._createAs3DShape=function(b,d,f,g,h,k){var l=this,n=null,m=null;(b=this._getFastUpdateAttrValues(b))&&(n=n||{},n.featureAttribute=b,m=function(a){return t.evaluateModelTransform(l._fastUpdates.materialParameters,n.featureAttribute,a)});!this._fastUpdates.enabled&&this._hasPerInstanceColor()&&(n=n||{},n.color=q.mixinColorAndOpacity(f.color,f.opacity));b=this._context.layer.uid;
var r=C.identity();if(this._applyObjectRotation(f,r),this._applyObjectRotation(this.symbol,r),this._applyObjectScale(f,r),this._applyAnchor(r),this._i3sModel){f=this._i3sModel.stageResources[y.ModelContentType.GEOMETRY];for(var u=this._i3sModel.materialsByComponent,w=Array(f.length),v=0;v<r.length;v++)w[v]=r;h=c.createStageObjectForPoint.call(this,d,f,u,w,n,g,h,b,k,null,m)}else h=c.createStageObjectForPoint.call(this,d,[this._geometry],[[this._material]],[r],n,g,h,b,k,null,m);if(null===h)return null;
if(this._fastUpdates.enabled){var x=t.getMaterialParams(this._fastUpdates.visualVariables,this._fastVisualVariableConvertOptions());this._forEachMaterial(function(a){return a.setParameterValues(x)})}h.object.setCastShadow(!0);k=new a(this,h.object,null,null,null,e.perObjectElevationAligner,g,a.VisibilityModes.REMOVE_OBJECT);return k.alignedTerrainElevation=h.terrainElevation,k.needsElevationUpdates=c.needsElevationUpdates3D(g.mode),c.extendPointGraphicElevationContext(k,d,this._context.elevationProvider),
k},l.prototype._applyObjectScale=function(a,b){this._fastUpdates.enabled&&this._fastUpdates.customTransformation||(a=this._isPropertyDriven("size")&&a.size?a.size:this._symbolSize,a=q.computeObjectScale(a,this._symbolSize,this._resourceSize,this._context.renderCoordsHelper.unitInMeters),1===a[0]&&1===a[1]&&1===a[2]||C.scale(b,a))},l.prototype._applyObjectRotation=function(a,b){return this._fastUpdates.enabled&&this._fastUpdates.customTransformation&&a instanceof v?void 0:q.computeObjectRotation(a.heading,
a.tilt,a.roll,b)},l.prototype._computeAnchor=function(){switch(this.symbol.anchor){case "center":return B.scale(x.center(this._resourceBoundingBox),-1);case "top":var a=x.center(this._resourceBoundingBox);return[-a[0],-a[1],-this._resourceBoundingBox[5]];case "bottom":return a=x.center(this._resourceBoundingBox),[-a[0],-a[1],-this._resourceBoundingBox[2]];default:return this._pivotOffset?B.scale(this._pivotOffset,-1,Array(3)):N}},l.prototype._applyAnchor=function(a){if(!this._fastUpdates.enabled||
!this._fastUpdates.customTransformation){var b=this._computeAnchor();b&&C.translate(a,b)}},l.prototype._hasPerInstanceColor=function(){return this._isPropertyDriven("color")||this._isPropertyDriven("opacity")},l.prototype._supportsShaderVisualVariables=function(){return this._context.stage.has("angleInstancedArrays")?!0:!1},l.prototype._fastVisualVariableConvertOptions=function(){var a=this._resourceBoundingBox?x.size(this._resourceBoundingBox):F,b=this._resourceBoundingBox?this._computeAnchor():
N,c=this._context.renderCoordsHelper.unitInMeters,d=q.computeObjectScale(this._symbolSize,this._symbolSize,this._resourceSize,c);return{modelSize:a,symbolSize:this._symbolSize||F,unitInMeters:c,transformation:{anchor:b,scale:d,rotation:[this.symbol.tilt||0,this.symbol.roll||0,this.symbol.heading||0]}}},l.PRIMITIVE_BOUNDING_BOX=M,l}(f)})},"esri/views/3d/layers/graphics/objectResourceUtils":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/sniff dojo/_base/lang dojo/Deferred dojo/errors/CancelError ../../../../request ../../../../core/Error ../../../../core/Version ../../../../core/Logger ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/Material ../../webgl-engine/lib/Texture ../../support/aaBoundingBox".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y){function n(b){return new a("","Request for object resource failed: "+b)}function w(a,c){var f,g,h=[],k=[],l=[],n=[],m=[],q=e.Version.parse(a.version||"1.0","wosr");C.validate(q);var q="meshsymbol_"+a.model.name,t=a.textureDefinitions,w={},y;for(y in t){var B=t[y];if(f=B.images[0].data){g=B.encoding+";base64,"+f;f="/textureDefinitions/"+y;var F={noUnpackFlip:!0,wrapClamp:!1};d("enable-feature:jkieboom/alpha-channel-usage")&&(F.wrapClamp=!0);g=new x(g,q,
F);m.push(g);w[f]={engineTexObj:g,alphaChannelUsage:"rgba"===B.channels?B.alphaChannelUsage||"transparency":"none"}}else z.warn("Externally referenced texture data is not yet supported")}y=a.model.geometries;t=a.materialDefinitions;for(B=0;B<y.length;B++){g=F=y[B];var p=g.params,A=p.topology;f=!0;switch(p.vertexAttributes||(z.warn("Geometry must specify vertex attributes"),f=!1),p.topology){case "PerAttributeArray":break;case "Indexed":case null:case void 0:if(p.faces){if(p.vertexAttributes)for(A in A=
void 0,p.vertexAttributes){var K=p.faces[A];K&&K.values?(null!=K.valueType&&"UInt32"!==K.valueType&&(z.warn("Unsupported indexed geometry indices type '"+K.valueType+"', only UInt32 is currently supported"),f=!1),null!=K.valuesPerElement&&1!==K.valuesPerElement&&(z.warn("Unsupported indexed geometry values per element '"+K.valuesPerElement+"', only 1 is currently supported"),f=!1)):(z.warn("Indexed geometry does not specify face indices for '"+A+"' attribute"),f=!1)}}else z.warn("Indexed geometries must specify faces"),
f=!1;break;default:z.warn("Unsupported topology '"+A+"'"),f=!1}g.params.material||(z.warn("Geometry requires material"),f=!1);g=g.params.vertexAttributes;p=void 0;for(p in g)g[p].values||(z.warn("Geometries with externally defined attributes are not yet supported"),f=!1);if(f){g=F.params;f=g.material;g=g.texture;var A=F.params.vertexAttributes,p={},U;for(U in A)K=A[U],p[U]={data:K.values,size:K.valuesPerElement};l.push([]);A={};if("PerAttributeArray"===F.params.topology){for(var F=p.position.data.length/
p.position.size,K=new Uint32Array(F),V=0;F>V;V++)K[V]=V;var F=K,X;for(X in p)A[X]=F}else for(var ba in F.params.faces)A[ba]=new Uint32Array(F.params.faces[ba].values);F=g?w[g]:null;K=n[f]?n[f][g]:null;K||(K=f.substring(f.lastIndexOf("/")+1),K=t[K].params,1===K.transparency&&(K.transparency=0),K={ambient:K.diffuse,diffuse:K.diffuse,specular:[0,0,0],shininess:0,opacity:1-(K.transparency||0),transparent:0<K.transparency,textureId:F?F.engineTexObj.getId():void 0,doubleSided:!0,cullFace:"none",flipV:!1,
colorMixMode:K.externalColorMixMode||"tint"},d("enable-feature:jkieboom/alpha-channel-usage")&&(!F||"transparency"!==F.alphaChannelUsage&&"maskAndTransparency"!==F.alphaChannelUsage||(K.transparent=!0)),c&&c.materialParamsMixin&&b.mixin(K,c.materialParamsMixin),K=new v(K,q),n[f]||(n[f]={}),n[f][g]=K,k.push(K));l[B].push(K);f=new r(new u(p,A),q);h.push(f)}}return{stageResources:{textures:m,materials:k,geometries:h},materialsByComponent:l,pivotOffset:a.model.pivotOffset}}Object.defineProperty(l,"__esModule",
{value:!0});var z=c.getLogger("esri.views.3d.layers.graphics.objectResourceUtils"),C=new e.Version(1,1,"wosr");l.fetch=function(a,b){b=b||{};var c=b.streamDataSupplier;if(c){var d=c.request(a,"json"),e=new g(function(){return c.cancelRequest(d)});return d.then(function(a,c){try{var d=w(c,b);return e.resolve(d)}catch(S){return e.reject(S)}},function(a){e.reject(a instanceof k?a:n(a))}),e.promise}var h=f(a),l=new g(function(){return h.cancel()});return h.then(function(a){try{var c=w(a.data,b);return l.resolve(c)}catch(O){return l.reject(O)}},
function(b){l.reject(b instanceof k?b:n(a))}),l.promise};l.computeBoundingBox=function(a){a=a.stageResources[t.ModelContentType.GEOMETRY];for(var b=y.create(y.NEGATIVE_INFINITY),c=[0,0,0],d=[0,0,0],e=0;e<a.length;e++){var f=a[e].getBoundingInfo();q.vec3d.set(f.getBBMin(),c);q.vec3d.set(f.getBBMax(),d);for(f=0;3>f;++f)b[f]=Math.min(b[f],c[f]),b[f+3]=Math.max(b[f+3],d[f])}return b};l.createStageResources=w})},"esri/core/Version":function(){define(["require","exports","./Error"],function(m,l,h){Object.defineProperty(l,
"__esModule",{value:!0});m=function(){function d(b,d,h){void 0===h&&(h="");this.major=b;this.minor=d;this._context=h}return d.prototype.lessThan=function(b,d){return this.major<b||b===this.major&&this.minor<d},d.prototype.since=function(b,d){return!this.lessThan(b,d)},d.prototype.validate=function(b){if(this.major!==b.major)throw new h((this._context&&this._context+":")+"unsupported-version","Required major "+(this._context&&this._context+" ")+"version is '"+this.major+"', but got '${version.major}.${version.minor}'",
{version:b});},d.prototype.clone=function(){return new d(this.major,this.minor,this._context)},d.parse=function(b,g){void 0===g&&(g="");var k=b.split("."),f=k[0],k=k[1],a=/^\s*\d+\s*$/;if(!f||!f.match||!f.match(a))throw new h((g&&g+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:b});if(!k||!k.match||!k.match(a))throw new h((g&&g+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:b});b=parseInt(f,10);f=parseInt(k,
10);return new d(b,f,g)},d}();l.Version=m})},"esri/views/3d/layers/graphics/Graphics3DLineSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./lineUtils ../../../../core/screenUtils ../../../../geometry/Polygon ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/RenderGeometry ./graphicUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x){var y=q.vec3d,n=q.mat4d;return function(d){function l(){return null!==d&&d.apply(this,arguments)||this}return h(l,d),l.prototype._prepareResources=function(){var b=this.symbol,c=this._isPropertyDriven("size")||this._isPropertyDriven("color")||this._isPropertyDriven("opacity"),b={idHint:this._getStageIdHint(),width:this._getWidth(b),color:this._getMaterialOpacityAndColor()};if(!this._isPropertyDriven("size")){var d=x.validateSymbolLayerSize(b.width);if(d)return this._logWarning(d),
void this.reject()}if(c||1.5<=b.width)this._isPropertyDriven("size")&&(b.width=0),this._material=a.createRibbonMaterial(b);else{if(!(0<b.width))return void this.reject();this._material=a.createNativeMaterial(b)}this._context.stage.add(t.ModelContentType.MATERIAL,this._material);this.resolve()},l.prototype._getWidth=function(a){return null!=a.size?e.pt2px(a.size):1},l.prototype.destroy=function(){d.prototype.destroy.call(this);this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(t.ModelContentType.MATERIAL,
this._material.getId()),this._material=null)},l.prototype.createGraphics3DGraphic=function(a,b){var c=this._validateGeometry(a.geometry);if("polyline"!==c.type&&"polygon"!==c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for line symbol: "+c.type),null;var c="polygon"===c.type||"extent"===c.type?"rings":"paths",d="graphic"+a.uid,g=this._getVertexOpacityAndColor(b,Float32Array,255),h=0;b.size&&this._isPropertyDriven("size")&&(h=f.getSingleSizeDriver(b.size),h=e.pt2px(h));
b=this.getGraphicElevationContext(a);return"on-the-ground"===b.mode?this._createAsOverlay(a,c,g,h,b,d):this._createAs3DShape(a,c,g,h,b,d,a.uid)},l.prototype.layerPropertyChanged=function(a,b,c){if("opacity"===a)return b=this._material.getColor(),this._material.setColor([b[0],b[1],b[2],this._getMaterialOpacity()]),!0;if("elevationInfo"===a){a=this._elevationContext.mode;this._updateElevationContext();var d=this._elevationContext.mode;if(null==a||null==d)return!1;if("on-the-ground"===a&&"on-the-ground"===
d)return!0;if(a!==d&&("on-the-ground"===a||"on-the-ground"===d))return!1;a=f.needsElevationUpdates2D(d);for(var e in b){var g=b[e];(d=c(g))&&!d.isDraped()&&(g=g.graphic,d.needsElevationUpdates=a,d.elevationContext.set(this.getGraphicElevationContext(g)))}return!0}return!1},l.prototype._getOutlineGeometry=function(a,b){return b},l.prototype._getGeometry=function(a){a=this._validateGeometry(a.geometry);return"extent"===a.type&&(a=c.fromExtent(a)),a},l.prototype._createAs3DShape=function(c,d,e,g,h,l,
m){var q=this._getGeometry(c),t=q.hasZ,w=q[d],v=this._getOutlineGeometry(q,w);c=[];var x=[],z=[],C=y.create(),B=Array(6),q=f.getGeometryVertexData3D(v,t,q.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,this._context.renderCoordsHelper,h);if(this._logGeometryCreationWarnings(q,w,d,"LineSymbol3DLayer"),0<v.length){for(var w=q.geometryData.outlines,v=q.eleVertexData,t=q.vertexData,F=0;F<w.length;++F){var p=w[F];if(!(1>=p.count)){var A=p.index,K=p.count;this._context.clippingExtent&&
(f.computeBoundingBox(v,A,K,B),f.boundingBoxClipped(B,this._context.clippingExtent))||(f.chooseOrigin(t,A,K,C),f.subtractCoordinates(t,A,K,C),p=new Float64Array(v.buffer,3*A*v.BYTES_PER_ELEMENT,3*K),A=new Float64Array(t.buffer,3*A*t.BYTES_PER_ELEMENT,3*K),A=a.createPolylineGeometry(A,p,"rings"===d,e,g),A=new u(A,l+"path"+F),A.singleUse=!0,c.push(A),x.push([this._material]),A=n.identity(),n.translate(A,C,A),z.push(A))}}if(0<c.length)return d=new r({geometries:c,materials:x,transformations:z,castShadow:!1,
metadata:{layerUid:this._context.layer.uid,graphicId:m},idHint:l}),d=new b(this,d,c,null,null,k.perVertexElevationAligner,h),d.alignedTerrainElevation=q.terrainElevation,d.needsElevationUpdates=f.needsElevationUpdates2D(h.mode),d}return null},l.prototype._createAsOverlay=function(b,c,d,e,h,k){var l=this._getGeometry(b);this._material.setRenderPriority(this._symbolLayerOrder);var m=l[c],q=this._getOutlineGeometry(l,m);b=[];var r=Array(6),t=y.create(),l=f.getGeometryVertexDataDraped(q,l.spatialReference,
this._context.overlaySR);if(this._logGeometryCreationWarnings(l,m,c,"LineSymbol3DLayer"),0<q.length){m=l.vertexData;q=l.geometryData.outlines;for(l=0;l<q.length;++l){var u=q[l],w=u.index,u=u.count;if(f.computeBoundingBox(m,w,u,r),!f.boundingBoxClipped(r,this._context.clippingExtent)){f.chooseOrigin(m,w,u,t);f.subtractCoordinates(m,w,u,t);f.setZ(m,w,u,this._getDrapedZ());u=new Float64Array(m.buffer,3*w*m.BYTES_PER_ELEMENT,3*u);w=n.identity();n.translate(w,t,w);var u=a.createPolylineGeometry(u,null,
"rings"===c,d,e),x=new v(u);x.material=this._material;x.center=[.5*(r[0]+r[3]),.5*(r[1]+r[4]),0];x.bsRadius=.5*Math.sqrt((r[3]-r[0])*(r[3]-r[0])+(r[4]-r[1])*(r[4]-r[1]));x.transformation=w;x.name=k;x.uniqueName=k+"#"+u.id;b.push(x)}}return new g(this,b,null,null,r,h)}return null},l}(d)})},"esri/views/3d/layers/graphics/lineUtils":function(){define("require exports ../../webgl-engine/materials/RibbonLineMaterial ../../webgl-engine/materials/NativeLineMaterial ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/Util".split(" "),
function(m,l,h,d,b,g){function k(a){var b=a.length;return a[0]===a[b-3]&&a[1]===a[b-2]&&a[2]===a[b-1]}Object.defineProperty(l,"__esModule",{value:!0});var f=g.VertexAttrConstants;l.createRibbonMaterial=function(a){var b={width:a.width,color:a.color,miterLimit:a.miterLimit,polygonOffset:!0};return"miter"===a.join||"bevel"===a.join?b.join=a.join:(b.join="miter",a.join&&console.warn("unsupported join type for line symbol: "+a.join)),new h(b,a.idHint+"_ribbonlinemat")};l.createNativeMaterial=function(a){return new d(a.width,
a.color,a.idHint+"_nativelinemat")};l.isClosed=k;l.createPolylineGeometry=function(a,d,c,g,h){var e,l,m;if(c=c&&!k(a)){c=new Float32Array(a.length+3);for(l=0;l<a.length;l++)c[l]=a[l];l=c.length;c[l-3]=a[0];c[l-2]=a[1];c[l-1]=a[2];e=a.length/3+1;l=new Uint32Array(2*(e-1));m=new Uint32Array(2*(e-1))}else e=a.length/3,l=new Uint32Array(2*(e-1)),m=new Uint32Array(2*(e-1)),c=a;a=new Float32Array(1);a[0]=h;for(var q=h=0,t=0;e-1>t;t++)l[h++]=t,l[h++]=t+1,m[q++]=0,m[q++]=0;h={};e={};h[f.POSITION]=l;h[f.COLOR]=
m;h[f.SIZE]=m;e[f.POSITION]={size:3,data:c,offsetIdx:0,strideIdx:3};e[f.COLOR]={size:4,data:g,offsetIdx:0,strideIdx:4};e[f.SIZE]={size:1,data:a,offsetIdx:0,strideIdx:1};d&&(h.mapPos=l,e.mapPos={size:3,data:d,offsetIdx:0,strideIdx:3});return new b(e,h,b.DefaultOffsets,"line")}})},"esri/views/3d/webgl-engine/materials/NativeLineMaterial":function(){define("./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/DefaultVertexBufferLayouts ../lib/ComponentUtils ../../../webgl/Util".split(" "),
function(m,l,h,d,b,g,k){var f=h.vec3d,a=h.vec2d,e=h.mat4d,c=l.VertexAttrConstants,q=f.create(),t=f.create(),r=f.create(),u=f.create(),v=a.create(),x=a.create(),y=f.create(),n=f.create(),w=[],z=function(a,b){m.basicGLMaterialConstructor(this,a);var c=b.get("simple"),e=a.getColor();this.beginSlot=function(a){return a===d.OPAQUE_MATERIAL};this.getProgram=function(){return c};this.bind=function(a,b){a.bindProgram(c);c.setUniform4fv("color",e);a.setBlendingEnabled(1>e[3]);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,
a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);a.setDepthTestEnabled(!0)};this.release=function(a){1>e[3]&&a.setBlendingEnabled(!1)};this.bindView=function(a,b){m.bindView(b.origin,b.view,c)};this.bindInstance=function(a,b){c.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.LINES}},C=function(a,b){m.basicGLMaterialConstructor(this,a);var c=b.get("highlight");this.beginSlot=function(a){return a===d.OPAQUE_MATERIAL};this.getProgram=function(){return c};
this.bind=function(a,b){a.bindProgram(c);a.setDepthTestEnabled(!0)};this.release=function(a){};this.bindView=function(a,b){m.bindView(b.origin,b.view,c)};this.bindInstance=function(a,b){c.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.gl.LINES}};return function(a,d,h){m.basicMaterialConstructor(this,h);var B=b.Pos3,F=k.getStride(B)/4;this.canBeMerged=!0;this.setColor=function(a){d=a;this.notifyDirty("matChanged")};this.getColor=function(){return d};this.dispose=
function(){};this.getOutputAmount=function(a){return a*F};this.getVertexBufferLayout=function(){return B};this.fillInterleaved=function(a,b,d,e,f,g){d=a.vertexAttr[c.POSITION].data;if(b){var h=d;d=w;for(e=0;e<h.length;e+=3){var k=h[e],l=h[e+1],n=h[e+2];d[e]=b[0]*k+b[4]*l+b[8]*n+b[12];d[e+1]=b[1]*k+b[5]*l+b[9]*n+b[13];d[e+2]=b[2]*k+b[6]*l+b[10]*n+b[14]}}a=a.indices[c.POSITION];for(e=0;e<a.length;e++)b=3*a[e],f[g++]=d[b],f[g++]=d[b+1],f[g++]=d[b+2]};this.intersect=function(a,b,c,d,h,k,m){if(d.isSelection&&
!g.isAllHidden(b.componentVisibilities,a.data.componentOffsets)){var w,z;b=a.getData().getVertexAttr("position").position.data;a=Number.MAX_VALUE;h=d.camera;k=d.point;for(var C=0;C<b.length-5;C+=3){if(q[0]=b[C],q[1]=b[C+1],q[2]=b[C+2],e.multiplyVec3(c,q),t[0]=b[C+3],t[1]=b[C+4],t[2]=b[C+5],e.multiplyVec3(c,t),h.projectPoint(q,v),h.projectPoint(t,x),0>v[2]&&0<x[2])f.subtract(q,t,r),w=h.frustumPlanes,z=-(f.dot(w[4],q)+w[4][3]),w=z/f.dot(r,w[4]),f.scale(r,w,r),f.add(q,r,q),h.projectPoint(q,v);else if(0<
v[2]&&0>x[2])f.subtract(t,q,r),w=h.frustumPlanes,z=-(f.dot(w[4],t)+w[4][3]),w=z/f.dot(r,w[4]),f.scale(r,w,r),f.add(t,r,t),h.projectPoint(t,x);else if(0>v[2]&&0>x[2])continue;w=l.pointLineSegmentDistance2D(v,x,k);a>w&&(a=w,f.set(q,y),f.set(t,n))}c=d.p0;d=d.p1;2>a&&(a=l.lineSegmentLineSegmentDistance3D(y,n,c,d),b=Number.MAX_VALUE,a[0]&&(f.subtract(a[2],c,u),a=f.length(u),f.scale(u,1/a),b=a/f.dist(c,d)),m(b,u))}};this.getGLMaterials=function(){return{color:z,depthShadowMap:void 0,normal:void 0,depth:void 0,
highlight:C}};this.getAllTextureIds=function(){return[]}}})},"esri/views/3d/layers/graphics/Graphics3DPathSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ../../../../geometry/Point ../../support/projectionUtils ../../../../views/3d/lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util ./graphicUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v){function x(a,b,c,d){for(var e=a.getGeometryRecords(),f=e.length,h="absolute-height"!==b.mode,k=0,l=0;f>l;l++){var n=e[l].geometry,m=[e[l].transformation[12],e[l].transformation[13],e[l].transformation[14]],q=n.getData().getVertexAttr(),p=q[z.POSITION].data,r=q.zOffset.data,q=q.mapPos.data,t=q.length/3;w(p.length/3===t*G+2,"unexpected tube geometry");var u=0,v=0;B.spatialReference=c.spatialReference;for(var x=0,y=0;t>y;y++){B.x=q[3*y];B.y=q[3*y+1];B.z=q[3*
y+2];var N=g.computeElevation(c,B,b,d,h?F:null);h&&(x+=F.terrainElevation);var M=G;0!==y&&y!==t-1||M++;for(var P=0;M>P;P++)C[0]=p[u]+m[0],C[1]=p[u+1]+m[1],C[2]=p[u+2]+m[2],d.setAltitude(N+r[v],C),p[u]=C[0]-m[0],p[u+1]=C[1]-m[1],p[u+2]=C[2]-m[2],u+=3,v+=1;n.invalidateBoundingInfo()}a.geometryVertexAttrsUpdated(l);k+=x/t}return k/f}var y=a.vec3d,n=a.mat4d,w=u.assert;m=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}return h(d,a),d.prototype._prepareResources=function(){if(!this._isPropertyDriven("size")){var a=
v.validateSymbolLayerSize(this._getSymbolSize());if(a)return this._logWarning(a),void this.reject()}var a=this._getStageIdHint(),b=this._getMaterialOpacityAndColor(),c=y.create(b),b=b[3],c={diffuse:c,ambient:c,opacity:b,transparent:1>b||this._isPropertyDriven("opacity"),vertexColors:this._isPropertyDriven("color")||this._isPropertyDriven("opacity")};this._material=new r(c,a+"_3dlinemat");this._context.stage.add(e.ModelContentType.MATERIAL,this._material);this.resolve()},d.prototype.destroy=function(){a.prototype.destroy.call(this);
this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(e.ModelContentType.MATERIAL,this._material.getId()),this._material=null)},d.prototype.createGraphics3DGraphic=function(a,b){var c=this._validateGeometry(a.geometry);if("polyline"!==c.type)return this._logWarning("unsupported geometry type for path symbol: "+c.type),null;var c="graphic"+a.uid,d=this.getGraphicElevationContext(a);return this._createAs3DShape(a,b,d,c,a.uid)},d.prototype.layerPropertyChanged=function(a,b,c){if("opacity"===
a)return b=this._getMaterialOpacity(),c=1>b||this._isPropertyDriven("opacity"),this._material.setParameterValues({opacity:b,transparent:c}),!0;if("elevationInfo"===a){this._updateElevationContext();for(var d in b){var e=b[d];if(a=c(e))e=this.getGraphicElevationContext(e.graphic),a.needsElevationUpdates=g.needsElevationUpdates3D(e.mode),a.elevationContext.set(e)}return!0}return!1},d.prototype._getPathSize=function(a){var b;return b=a.size&&this._isPropertyDriven("size")?g.getSingleSizeDriver(a.size):
this._getSymbolSize(),b/=this._context.renderCoordsHelper.unitInMeters},d.prototype._getSymbolSize=function(){return this.symbol.size||1},d.prototype._createAs3DShape=function(a,d,e,h,k){var l=a.geometry,m=l.hasZ,r=l.paths;a=[];var u=[],w=[],p=y.create(),v=this._context.renderSpatialReference===f.SphericalECEFSpatialReference,z=Array(6),C=this._getPathSize(d),l=g.getGeometryVertexData3D(r,m,l.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,this._context.renderCoordsHelper,
e);if(this._logGeometryCreationWarnings(l,r,"paths","PathSymbol3DLayer"),0<r.length){for(var r=l.geometryData.outlines,m=l.eleVertexData,B=l.vertexData,F=0;F<r.length;++F){var N=r[F];if(!(1>=N.count)){var M=N.index,O=N.count;if(!this._context.clippingExtent||(g.computeBoundingBox(m,M,O,z),!g.boundingBoxClipped(z,this._context.clippingExtent))){g.chooseOrigin(B,M,O,p);g.subtractCoordinates(B,M,O,p);N=new Float64Array(m.buffer,3*M*m.BYTES_PER_ELEMENT,3*O);M=g.flatArrayToArrayOfArrays(B,M,O);M=t.createTubeGeometry(M,
.5*C,G,v,p);if(M.getVertexAttr().mapPos={size:3,data:N,offsetIdx:0,strideIdx:3},this._material.getParams().vertexColors)N=this._getVertexOpacityAndColor(d),M=t.addVertexColors(M,N);N=new q(M,h+"path"+F);N.singleUse=!0;a.push(N);u.push([this._material]);N=n.identity();n.translate(N,p,N);w.push(N)}}}if(0<a.length)return d=new c({geometries:a,materials:u,transformations:w,castShadow:!0,metadata:{layerUid:this._context.layer.uid,graphicId:k},idHint:h}),d=new b(this,d,a,null,null,x,e),d.alignedTerrainElevation=
l.terrainElevation,d.needsElevationUpdates=g.needsElevationUpdates3D(e.mode),d}return null},d}(d);var z=u.VertexAttrConstants,C=y.create(),B=new k,F={verticalDistanceToGround:0,terrainElevation:0},G=10;return m})},"esri/views/3d/layers/graphics/Graphics3DFillSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/screenUtils ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./lineUtils ./graphicUtils ../../../../geometry/Polygon ../../../../Color ../../lib/glMatrix ../../support/aaBoundingBox ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/lib/Util ./earcut/earcut".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B){var F=C.VertexAttrConstants;m=r.vec3d;var G=r.mat4d;b=function(b){function l(){var a=null!==b&&b.apply(this,arguments)||this;return a._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0},a}return h(l,b),l.prototype._prepareResources=function(){this._prepareFillResources();this._prepareOutlineResources();this.resolve()},l.prototype._prepareFillResources=function(){var a=this._getStageIdHint(),b=this._getMaterialOpacityAndColor(),
b={color:b,transparent:1>b[3]||this._isPropertyDriven("opacity"),polygonOffset:!1,vertexColors:!0};this._material=new z(b,a+"_colormat");this._context.stage.add(v.ModelContentType.MATERIAL,this._material)},l.prototype._prepareOutlineResources=function(){var a=this.symbol.outline;if(this._hasOutline=!!(a&&a.size&&0<a.size&&a.color),this._hasOutline)a={idHint:this._getStageIdHint()+"_outline",color:this._getOutlineColor(),width:d.pt2px(a.size)},2<a.width?this._outlineMaterial=e.createRibbonMaterial(a):
this._outlineMaterial=e.createNativeMaterial(a),this._context.stage.add(v.ModelContentType.MATERIAL,this._outlineMaterial)},l.prototype.destroy=function(){b.prototype.destroy.call(this);this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(v.ModelContentType.MATERIAL,this._material.getId()),this._material=null);this._outlineMaterial&&(this._context.stage.remove(v.ModelContentType.MATERIAL,this._outlineMaterial.getId()),this._outlineMaterial=null)},l.prototype.createGraphics3DGraphic=
function(a,b){var c=this._validateGeometry(a.geometry);if("polyline"!==c.type&&"polygon"!==c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for fill symbol: "+c.type),null;c="graphic"+a.uid;b=this._getVertexOpacityAndColor(b,Uint8Array,255);var d=this.getGraphicElevationContext(a);return"on-the-ground"===d.mode?this._createAsOverlay(a,b,d,c):this._createAs3DShape(a,b,d,c,a.uid)},l.prototype.layerPropertyChanged=function(b,c,d){if("opacity"===b){c=this._material.getColor();
if(c[3]=this._getMaterialOpacity(),this._material.setColor(c),this._material.setTransparent(1>c[3]),this._outlineMaterial)c=this._outlineMaterial.getColor(),this._outlineMaterial.setColor([c[0],c[1],c[2],this._getOutlineOpacity()]);return!0}if("elevationInfo"===b){b=this._elevationContext.mode;this._updateElevationContext();var e=this._elevationContext.mode;if(null==b||null==e)return!1;if("on-the-ground"===b&&"on-the-ground"===e)return!0;if(b!==e&&("on-the-ground"===b||"on-the-ground"===e))return!1;
b=a.needsElevationUpdates2D(e);for(var f in c){var g=c[f];(e=d(g))&&!e.isDraped()&&(g=g.graphic,e.needsElevationUpdates=b,e.elevationContext.set(this.getGraphicElevationContext(g)))}return!0}return!1},l.prototype.setDrawOrder=function(a,b,c){this._material&&(this._material.setRenderPriority(a+b/2),c[this._material.getId()]=!0);this._outlineMaterial&&(this._outlineMaterial.setRenderPriority(a),c[this._outlineMaterial.getId()]=!0)},l.prototype._createAs3DShape=function(b,c,d,e,h){var k=this._getPolyGeometry(b),
l=k.hasZ;b=k.rings;var n=this._getOutlineGeometry(k,b),k=a.getGeometryVertexData3D(n,l,k.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,this._context.renderCoordsHelper,d);P.idHint=e;P.color=c;P.data=k;var m;this._hasOutline&&(m=new k.vertexData.constructor(k.vertexData));if(P.outNum=0,P.outGeometries=[],P.outTransforms=[],P.outMaterials=[],this._createAs3DShapeFill(P),P.data.vertexData=m,this._createAs3DShapeOutline(P),this._logGeometryCreationWarnings(P.data,
b,"rings","FillSymbol3DLayer"),0===P.outNum)return null;c=new x({geometries:P.outGeometries,materials:P.outMaterials,transformations:P.outTransforms,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicId:h},idHint:e});c=new g(this,c,P.outGeometries,null,null,f.perVertexElevationAligner,d);return c.alignedTerrainElevation=k.terrainElevation,c.needsElevationUpdates=a.needsElevationUpdates2D(d.mode),c},l.prototype._createAs3DShapeFill=function(b){for(var c=b.data.geometryData.polygons,d=
b.data.eleVertexData,e=b.data.vertexData,f=function(f){var h=c[f];f=h.count;var k=h.index;if(g._context.clippingExtent&&(a.computeBoundingBox(d,k,f,N),a.boundingBoxClipped(N,g._context.clippingExtent)))return"continue";var l=new Float64Array(d.buffer,3*k*d.BYTES_PER_ELEMENT,3*f),n=new Float64Array(e.buffer,3*k*e.BYTES_PER_ELEMENT,3*f),h=h.holeIndices.map(function(a){return a-k}),h=B(l,h,3);if(0===h.length)return"continue";a.chooseOrigin(e,k,f,M);a.subtractCoordinates(e,k,f,M);f=g._createFillGeometry(h,
0,n,l,b.color);f=new y(f,b.idHint);f.singleUse=!0;l=G.identity();G.translate(l,M,l);b.outGeometries.push(f);b.outMaterials.push([g._material]);b.outTransforms.push(l);b.outNum++},g=this,h=0;h<c.length;++h)f(h)},l.prototype._createAs3DShapeOutline=function(b){if(this._hasOutline)for(var c=b.data.geometryData.outlines,d=b.data.eleVertexData,f=b.data.vertexData,g=0;g<c.length;++g){var h=c[g],k=h.index,l=h.count;this._context.clippingExtent&&(a.computeBoundingBox(d,k,l,N),a.boundingBoxClipped(N,this._context.clippingExtent))||
(a.chooseOrigin(f,k,l,M),a.subtractCoordinates(f,k,l,M),h=new Float64Array(d.buffer,3*k*d.BYTES_PER_ELEMENT,3*l),k=new Float64Array(f.buffer,3*k*f.BYTES_PER_ELEMENT,3*l),k=e.createPolylineGeometry(k,h,b.isRings,R,0),k=new y(k,b.idHint+"outline"+g),k.singleUse=!0,h=G.identity(),G.translate(h,M,h),b.outGeometries.push(k),b.outMaterials.push([this._outlineMaterial]),b.outTransforms.push(h),b.outNum++)}},l.prototype._createAsOverlay=function(b,c,d,e){var f=this._getPolyGeometry(b);b=f.rings;var g=this._getOutlineGeometry(f,
b);this._material.setRenderPriority(this._symbolLayerOrder+this._symbolLayerOrderDelta/2);this._hasOutline&&this._outlineMaterial.setRenderPriority(this._symbolLayerOrder);f=a.getGeometryVertexDataDraped(g,f.spatialReference,this._context.overlaySR);P.idHint=e;P.color=c;P.data=f;var h;this._hasOutline&&(h=new f.vertexData.constructor(f.vertexData));return P.outNum=0,P.outGeometries=[],P.outBoundingBox=u.create(u.NEGATIVE_INFINITY),this._createAsOverlayFill(P),P.data.vertexData=h,this._createAsOverlayOutline(P),
this._logGeometryCreationWarnings(P.data,b,"rings","FillSymbol3DLayer"),0<P.outNum?new k(this,P.outGeometries,null,null,P.outBoundingBox,d):null},l.prototype._createAsOverlayFill=function(b){for(var c=b.data.vertexData,d=b.data.geometryData.polygons,e=function(e){var g=d[e];e=g.count;var h=g.index,k=new Float64Array(c.buffer,3*h*c.BYTES_PER_ELEMENT,3*e),g=g.holeIndices.map(function(a){return a-h}),k=B(k,g,3);if(0===k.length||(a.computeBoundingBox(c,h,e,N),a.boundingBoxClipped(N,f._context.clippingExtent)))return"continue";
u.expand(b.outBoundingBox,N);a.chooseOrigin(c,h,e,M);a.subtractCoordinates(c,h,e,M);a.setZ(c,h,e,f._getDrapedZ());e=G.identity();G.translate(e,M,e);k=f._createFillGeometry(k,h,c,null,b.color);g=new w(k);g.material=f._material;var l=N;g.center=[.5*(l[0]+l[3]),.5*(l[1]+l[4]),0];g.bsRadius=.5*Math.sqrt((l[3]-l[0])*(l[3]-l[0])+(l[4]-l[1])*(l[4]-l[1]));g.transformation=e;g.name=b.idHint;g.uniqueName=b.idHint+"#"+k.id;b.outGeometries.push(g);b.outNum++},f=this,g=0;g<d.length;++g)e(g)},l.prototype._createAsOverlayOutline=
function(b){if(this._hasOutline)for(var c=b.data.vertexData,d=b.data.geometryData.outlines,f=0;f<d.length;++f){var g=d[f],h=g.index,g=g.count;if(a.computeBoundingBox(c,h,g,N),!a.boundingBoxClipped(N,this._context.clippingExtent)){u.expand(b.outBoundingBox,N);a.chooseOrigin(c,h,g,M);a.subtractCoordinates(c,h,g,M);a.setZ(c,h,g,this._getDrapedZ());g=new Float64Array(c.buffer,3*h*c.BYTES_PER_ELEMENT,3*g);h=G.identity();G.translate(h,M,h);var g=e.createPolylineGeometry(g,null,!0,R,0),k=new w(g);k.material=
this._outlineMaterial;var l=N;k.center=[.5*(l[0]+l[3]),.5*(l[1]+l[4]),0];k.bsRadius=.5*Math.sqrt((l[3]-l[0])*(l[3]-l[0])+(l[4]-l[1])*(l[4]-l[1]));k.transformation=h;k.name=b.idHint+"outline";k.uniqueName=b.idHint+"outline#"+g.id;b.outGeometries.push(k);b.outNum++}}},l.prototype._getOutlineGeometry=function(a,b){return b},l.prototype._getOutlineOpacity=function(){return this._getLayerOpacity()*this.symbol.outline.color.a},l.prototype._getOutlineColor=function(){var a=this.symbol.outline.color,b=this._getOutlineOpacity();
return c.mixinColorAndOpacity(t.toUnitRGB(a),b)},l.prototype._getPolyGeometry=function(a){a=a.geometry;return"extent"===a.type?q.fromExtent(a):a},l.prototype._createFillGeometry=function(a,b,c,d,e){for(var f=a.length,g=new Uint32Array(f),h=new Uint32Array(f),k=0;f>k;k++)g[k]=a[k]+b,h[k]=0;a={};b={};return a[F.POSITION]=g,a[F.COLOR]=h,b[F.POSITION]={size:3,data:c},b[F.COLOR]={size:4,data:e},d&&(b.mapPos={size:3,data:d},a.mapPos=g),new n(b,a)},l}(b);var N=u.create(),M=m.create(),R=new Float32Array([255,
255,255,255]),P={idHint:null,color:null,data:null,outNum:0,outBoundingBox:null,outGeometries:null,outMaterials:null,outTransforms:null};return b})},"esri/views/3d/layers/graphics/earcut/earcut":function(){define([],function(){function m(a,c,e){e=e||2;var k=c&&c.length,n=k?c[0]*e:a.length,m=l(a,0,n,e,!0),q=[];if(!m)return q;var t,u,w,v;if(k){var x=e,y,z,S;v=[];k=0;for(y=c.length;y>k;k++)z=c[k]*x,S=y-1>k?c[k+1]*x:a.length,z=l(a,z,S,x,!1),z===z.next&&(z.steiner=!0),v.push(f(z));v.sort(b);for(k=0;k<v.length;k++){c=
v[k];x=m;if(x=g(c,x))c=r(x,c),h(c,c.next);m=h(m,m.next)}}if(a.length>80*e){t=w=a[0];u=k=a[1];for(x=e;n>x;x+=e)v=a[x],c=a[x+1],t>v&&(t=v),u>c&&(u=c),v>w&&(w=v),c>k&&(k=c);w=Math.max(w-t,k-u)}return d(m,q,e,t,u,w),q}function l(a,b,d,e,f){var g;if(f===0<y(a,b,d,e))for(f=b;d>f;f+=e)g=u(f,a[f],a[f+1],g);else for(f=d-e;f>=b;f-=e)g=u(f,a[f],a[f+1],g);return g&&c(g,g.next)&&(v(g),g=g.next),g}function h(a,b){if(!a)return a;b||(b=a);var d=a;do if(a=!1,d.steiner||!c(d,d.next)&&0!==e(d.prev,d,d.next))d=d.next;
else{if(v(d),d=b=d.prev,d===d.next)return null;a=!0}while(a||d!==b);return b}function d(b,f,g,l,m,u,x){if(b){if(!x&&u){var n=b,w=n;do null===w.z&&(w.z=k(w.x,w.y,l,m,u)),w.prevZ=w.prev,w=w.nextZ=w.next;while(w!==n);w.prevZ.nextZ=null;w.prevZ=null;var n=w,y,z,C,B,F,G,H=1;do{w=n;B=n=null;for(F=0;w;){F++;z=w;for(y=G=0;H>y&&(G++,z=z.nextZ,z);y++);for(y=H;0<G||0<y&&z;)0===G?(C=z,z=z.nextZ,y--):0!==y&&z?w.z<=z.z?(C=w,w=w.nextZ,G--):(C=z,z=z.nextZ,y--):(C=w,w=w.nextZ,G--),B?B.nextZ=C:n=C,C.prevZ=B,B=C;w=
z}B.nextZ=null;H*=2}while(1<F)}for(w=b;b.prev!==b.next;){C=b.prev;n=b.next;if(u)a:{z=b;y=l;var Y=m,W=u;B=z.prev;F=z;G=z.next;if(0<=e(B,F,G))z=!1;else{var E=B.x>F.x?B.x>G.x?B.x:G.x:F.x>G.x?F.x:G.x,p=B.y>F.y?B.y>G.y?B.y:G.y:F.y>G.y?F.y:G.y,H=k(B.x<F.x?B.x<G.x?B.x:G.x:F.x<G.x?F.x:G.x,B.y<F.y?B.y<G.y?B.y:G.y:F.y<G.y?F.y:G.y,y,Y,W);y=k(E,p,y,Y,W);for(Y=z.nextZ;Y&&Y.z<=y;){if(Y!==z.prev&&Y!==z.next&&a(B.x,B.y,F.x,F.y,G.x,G.y,Y.x,Y.y)&&0<=e(Y.prev,Y,Y.next)){z=!1;break a}Y=Y.nextZ}for(Y=z.prevZ;Y&&Y.z>=
H;){if(Y!==z.prev&&Y!==z.next&&a(B.x,B.y,F.x,F.y,G.x,G.y,Y.x,Y.y)&&0<=e(Y.prev,Y,Y.next)){z=!1;break a}Y=Y.prevZ}z=!0}}else a:if(z=b,B=z.prev,F=z,G=z.next,0<=e(B,F,G))z=!1;else{for(H=z.next.next;H!==z.prev;){if(a(B.x,B.y,F.x,F.y,G.x,G.y,H.x,H.y)&&0<=e(H.prev,H,H.next)){z=!1;break a}H=H.next}z=!0}if(z)f.push(C.i/g),f.push(b.i/g),f.push(n.i/g),v(b),w=b=n.next;else if(b=n,b===w){if(x)if(1===x){x=f;C=g;n=b;do w=n.prev,z=n.next.next,!c(w,z)&&q(w,n,n.next,z)&&t(w,z)&&t(z,w)&&(x.push(w.i/C),x.push(n.i/C),
x.push(z.i/C),v(n),v(n.next),n=b=z),n=n.next;while(n!==b);b=n;d(b,f,g,l,m,u,2)}else{if(2===x)a:{x=b;do{for(C=x.next.next;C!==x.prev;){if(n=x.i!==C.i){n=x;w=C;z=void 0;if(z=n.next.i!==w.i&&n.prev.i!==w.i){z=void 0;b:{z=n;do{if(z.i!==n.i&&z.next.i!==n.i&&z.i!==w.i&&z.next.i!==w.i&&q(z,z.next,n,w)){z=!0;break b}z=z.next}while(z!==n);z=!1}z=!z}B=void 0;if(B=z&&t(n,w)&&t(w,n)){z=n;B=!1;F=(n.x+w.x)/2;w=(n.y+w.y)/2;do z.y>w!=z.next.y>w&&F<(z.next.x-z.x)*(w-z.y)/(z.next.y-z.y)+z.x&&(B=!B),z=z.next;while(z!==
n)}n=B}if(n){b=r(x,C);x=h(x,x.next);b=h(b,b.next);d(x,f,g,l,m,u);d(b,f,g,l,m,u);break a}C=C.next}x=x.next}while(x!==b)}}else d(h(b),f,g,l,m,u,1);break}}}}function b(a,b){return a.x-b.x}function g(b,c){var d,e=c,f=b.x,g=b.y,h=-(1/0);do{if(g<=e.y&&g>=e.next.y){var k=e.x+(g-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(f>=k&&k>h){if(h=k,k===f){if(g===e.y)return e;if(g===e.next.y)return e.next}d=e.x<e.next.x?e:e.next}}e=e.next}while(e!==c);if(!d)return null;if(f===h)return d.prev;var l;c=d;for(var k=d.x,n=d.y,
m=1/0,e=d.next;e!==c;)f>=e.x&&e.x>=k&&a(n>g?f:h,g,k,n,n>g?h:f,g,e.x,e.y)&&(l=Math.abs(g-e.y)/(f-e.x),(m>l||l===m&&e.x>d.x)&&t(e,b)&&(d=e,m=l)),e=e.next;return d}function k(a,b,c,d,e){return a=32767*(a-c)/e,b=32767*(b-d)/e,a=16711935&(a|a<<8),a=252645135&(a|a<<4),a=858993459&(a|a<<2),a=1431655765&(a|a<<1),b=16711935&(b|b<<8),b=252645135&(b|b<<4),b=858993459&(b|b<<2),b=1431655765&(b|b<<1),a|b<<1}function f(a){var b=a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function a(a,b,c,d,e,f,g,h){return 0<=
(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function e(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function c(a,b){return a.x===b.x&&a.y===b.y}function q(a,b,d,f){return c(a,b)&&c(d,f)||c(a,f)&&c(d,b)?!0:0<e(a,b,d)!=0<e(a,b,f)&&0<e(d,f,a)!=0<e(d,f,b)}function t(a,b){return 0>e(a.prev,a,a.next)?0<=e(a,b,a.next)&&0<=e(a,a.prev,b):0>e(a,b,a.prev)||0>e(a,a.next,b)}function r(a,b){var c=new x(a.i,a.x,a.y),d=new x(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=
b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function u(a,b,c,d){a=new x(a,b,c);return d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a),a}function v(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function x(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function y(a,b,c,d){for(var e=0,f=c-d;c>b;b+=d)e+=(a[f]-a[b])*(a[b+1]+a[f+1]),f=b;return e}
return m.deviation=function(a,b,c,d){var e=b&&b.length,f=Math.abs(y(a,0,e?b[0]*c:a.length,c));if(e)for(var e=0,g=b.length;g>e;e++)f-=Math.abs(y(a,b[e]*c,g-1>e?b[e+1]*c:a.length,c));for(e=b=0;e<d.length;e+=3){var g=d[e]*c,h=d[e+1]*c,k=d[e+2]*c;b+=Math.abs((a[g]-a[k])*(a[h+1]-a[g+1])-(a[g]-a[h])*(a[k+1]-a[g+1]))}return 0===f&&0===b?0:Math.abs((b-f)/f)},m.flatten=function(a){for(var b=a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,e=0;e<a.length;e++){for(var f=0;f<a[e].length;f++)for(var g=
0;b>g;g++)c.vertices.push(a[e][f][g]);0<e&&(d+=a[e-1].length,c.holes.push(d))}return c},m})},"esri/views/3d/layers/graphics/Graphics3DExtrudeSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ../../../../geometry/Polygon ../../../../geometry/Point ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util ./earcut/earcut ./graphicUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y){function n(a,b,c,d,e,f,g,h,k,l,n,p,m,q){var r=c.length/3,t=0;n+=2*d.count;var u=d.index,w=d.count,v=k,x=n;F.set(m,M);var y=0<p?1:-1,u=3*u,A=v;m=3*A;for(var C=v+w,v=3*C,B=0;w>B;++B)q&&(M[0]=a[u+0],M[1]=a[u+1],M[2]=a[u+2],F.normalize(M)),e[m+0]=a[u+0],e[m+1]=a[u+1],e[m+2]=a[u+2],f[m+0]=b[u+0],f[m+1]=b[u+1],f[m+2]=b[u+2],g[m+0]=-y*M[0],g[m+1]=-y*M[1],g[m+2]=-y*M[2],h[A]=0,e[v+0]=a[u+0]+p*M[0],e[v+1]=a[u+1]+p*M[1],e[v+2]=a[u+2]+p*M[2],f[v+0]=b[u+0],f[v+1]=
b[u+1],f[v+2]=b[u+2],g[v+0]=y*M[0],g[v+1]=y*M[1],g[v+2]=y*M[2],h[C]=p,m+=3,v+=3,u+=3,A+=1,C+=1;u=0;m=3*x;v=3*(x+r);m=3*(x+r);v=3*x;a=R;b=P;0>p&&(a=P,b=R);for(B=0;r>B;++B)l[m+0]=c[u+a[0]],l[m+1]=c[u+a[1]],l[m+2]=c[u+a[2]],l[v+0]=c[u+b[0]]+w,l[v+1]=c[u+b[1]]+w,l[v+2]=c[u+b[2]]+w,m+=3,v+=3,u+=3;k+=2*d.count;n=n+2*r-(2*d.count+2*r);z(e,f,h,g,t,d.pathLengths[0],d.count,k,l,n,p);k+=4*d.pathLengths[0];n+=2*d.pathLengths[0];t+=d.pathLengths[0];for(c=1;c<d.pathLengths.length;++c)z(e,f,h,g,t,d.pathLengths[c],
d.count,k,l,n,p),k+=4*d.pathLengths[c],n+=2*d.pathLengths[c],t+=d.pathLengths[c]}function w(a,b,c,d,e,f,g){d[f]=d[g];g*=3;f*=3;a[f+0]=a[g+0];a[f+1]=a[g+1];a[f+2]=a[g+2];b[f+0]=b[g+0];b[f+1]=b[g+1];b[f+2]=b[g+2];c[f+0]=e[0];c[f+1]=e[1];c[f+2]=e[2]}function z(a,b,c,d,e,f,g,h,k,l,n){var p=e,m=e+1,q=e+g,r=e+g+1,t=h,u=h+1,v=h+2*f;h=h+2*f+1;0>n&&(p=e+g+1,r=e);l*=3;for(var x=0;f>x;++x){x===f-1&&(0<n?(m=e,r=e+g):(m=e,p=e+g));var y=a,z=p,A=m,C=q,B=O,z=3*z,A=3*A,C=3*C;F.set3(y[z++],y[z++],y[z++],S);F.set3(y[A++],
y[A++],y[A++],H);F.set3(y[C++],y[C++],y[C++],Y);F.subtract(H,S,W);F.subtract(Y,S,E);F.cross(E,W,B);F.normalize(B,B);w(a,b,d,c,O,t,p);w(a,b,d,c,O,u,m);w(a,b,d,c,O,v,q);w(a,b,d,c,O,h,r);k[l++]=t;k[l++]=v;k[l++]=h;k[l++]=t;k[l++]=h;k[l++]=u;p++;m++;q++;r++;t+=2;u+=2;v+=2;h+=2}}function C(a,b,c,d){var e=d.setAltitude;Q.spatialReference=c.spatialReference;for(var f=a.getGeometryRecords(),h=f.length,k="absolute-height"!==b.mode,l=0,n=0;h>n;n++){var m=f[n].geometry,q=f[n].transformation,r=m.getData();A[0]=
q[12];A[1]=q[13];A[2]=q[14];m.invalidateBoundingInfo();for(var r=r.getVertexAttr(),m=r[B.POSITION].data,q=r[B.SIZE].data,r=r.mapPos.data,t=m.length/3,u=0,v=0,w=!1,x=0,y=0;t>y;y++){Q.x=r[v];Q.y=r[v+1];Q.z=r[v+2];p[0]=m[u];p[1]=m[u+1];p[2]=m[u+2];var z=g.computeElevation(c,Q,b,d,k?T:null);k&&(x+=T.terrainElevation);N[0]=m[u]+A[0];N[1]=m[u+1]+A[1];N[2]=m[u+2]+A[2];e(z+q[u/3],N);m[u]=N[0]-A[0];m[u+1]=N[1]-A[1];m[u+2]=N[2]-A[2];z=.01/d.unitInMeters;(Math.abs(p[0]-m[u])>z||Math.abs(p[1]-m[u+1])>z||Math.abs(p[2]-
m[u+2])>z)&&(w=!0);v+=3;u+=3}w&&a.geometryVertexAttrsUpdated(n);l+=x/t}return l/h}var B=v.VertexAttrConstants,F=e.vec3d,G=e.mat4d,N=F.create(),M=F.create(),R=[0,2,1],P=[0,1,2],Q=new f,T={verticalDistanceToGround:0,terrainElevation:0};m=function(d){function e(){return null!==d&&d.apply(this,arguments)||this}return h(e,d),e.prototype._prepareResources=function(){if(!this._isPropertyDriven("size")){var a=y.validateSymbolLayerSize(this._getSymbolSize());if(a)return this._logWarning(a),void this.reject()}var a=
this._getStageIdHint(),b=this._getMaterialOpacityAndColor(),d=F.create(b),b=b[3],d={diffuse:d,ambient:d,opacity:b,transparent:1>b||this._isPropertyDriven("opacity"),vertexColors:!0};this._material=new u(d,a+"_3dlinemat");this._context.stage.add(c.ModelContentType.MATERIAL,this._material);this.resolve()},e.prototype.destroy=function(){d.prototype.destroy.call(this);this.isFulfilled()||this.reject();this._material&&this._context.stage.remove(c.ModelContentType.MATERIAL,this._material.getId())},e.prototype.createGraphics3DGraphic=
function(a,b){var c=this._validateGeometry(a.geometry);if("polygon"!==c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for extrude symbol: "+c.type),null;var c="polygon"===c.type||"extent"===c.type?"rings":"paths",d="graphic"+a.uid,e=this._getVertexOpacityAndColor(b,Float32Array,255),f=this.getGraphicElevationContext(a);return this._createAs3DShape(a,c,b,e,f,d,a.uid)},e.prototype.layerPropertyChanged=function(a,b,c){if("opacity"===a)return b=this._getMaterialOpacity(),
c=1>b||this._isPropertyDriven("opacity"),this._material.setParameterValues({opacity:b,transparent:c}),!0;if("elevationInfo"===a){this._updateElevationContext();for(var d in b){var e=b[d];if(a=c(e))e=this.getGraphicElevationContext(e.graphic),a.needsElevationUpdates=g.needsElevationUpdates3D(e.mode),a.elevationContext.set(e)}return!0}return!1},e.prototype._getExtrusionSize=function(a){var b;return b=a.size&&this._isPropertyDriven("size")?g.getSingleSizeDriver(a.size,2):this._getSymbolSize(),b/=this._context.renderCoordsHelper.unitInMeters},
e.prototype._getSymbolSize=function(){return this.symbol.size||1},e.prototype._createAs3DShape=function(c,d,e,f,h,l,p){var m=c.geometry;"extent"===m.type&&(m=k.fromExtent(m));c=m[d];var r=m.hasZ,u=[],v=[],w=[],y=F.create(),z=Array(6),A=this._context.renderSpatialReference===a.SphericalECEFSpatialReference,B=this._getExtrusionSize(e),H=F.create();A||this._context.renderCoordsHelper.worldUpAtPosition(null,H);e=g.getGeometryVertexData3D(c,r,m.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,
this._context.renderCoordsHelper,h);if(this._logGeometryCreationWarnings(e,c,d,"ExtrudeSymbol3DLayer"),0<c.length){var D=e.geometryData.polygons,E=e.eleVertexData,L=e.vertexData;d=L.length/3;var K=new Float64Array(18*d),N=new Float64Array(18*d),M=new Float64Array(18*d),P=new Float64Array(6*d),O=0;d=function(a){var b=D[a],c=b.count,d=b.index;if(S._context.clippingExtent&&(g.computeBoundingBox(E,d,c,z),g.boundingBoxClipped(z,S._context.clippingExtent)))return"continue";var e=new Float64Array(E.buffer,
3*d*K.BYTES_PER_ELEMENT,3*c),h=b.holeIndices.map(function(a){return a-d}),e=x(e,h,3);if(0<e.length){g.chooseOrigin(L,d,c,y);var h=new Uint32Array(6*c+2*e.length),k=6*c,p=new Float64Array(K.buffer,3*O*K.BYTES_PER_ELEMENT,3*k),m=new Float64Array(N.buffer,3*O*N.BYTES_PER_ELEMENT,3*k),q=new Float64Array(M.buffer,3*O*M.BYTES_PER_ELEMENT,3*k),r=new Float64Array(P.buffer,1*O*P.BYTES_PER_ELEMENT,1*k);n(L,E,e,b,p,q,m,r,0,h,0,B,H,A);g.subtractCoordinates(p,0,k,y);O+=6*c;b=S._createExtrudeGeometry(h,{positions:p,
elevation:q,normals:m,heights:r},f);a=new t(b,l+"path"+a);a.singleUse=!0;u.push(a);v.push([S._material]);a=G.identity();G.translate(a,y,a);w.push(a)}};var S=this;for(c=0;c<D.length;++c)d(c);if(0<u.length)return p=new q({geometries:u,materials:v,transformations:w,castShadow:!0,metadata:{layerUid:this._context.layer.uid,graphicId:p},idHint:l}),p=new b(this,p,u,null,null,C,h),p.alignedTerrainElevation=e.terrainElevation,p.needsElevationUpdates=g.needsElevationUpdates3D(h.mode),p}return null},e.prototype._createExtrudeGeometry=
function(a,b,c){for(var d=a.length,e=new Uint32Array(d),f=0;d>f;f++)e[f]=0;d={};f={};return d[B.POSITION]=a,d[B.NORMAL]=a,d[B.COLOR]=e,f[B.POSITION]={size:3,data:b.positions},f[B.NORMAL]={size:3,data:b.normals},f[B.COLOR]={size:4,data:c},f[B.SIZE]={size:1,data:b.heights},b.elevation&&(f.mapPos={size:3,data:b.elevation},d.mapPos=a),new r(f,d)},e}(d);var O=F.create(),S=F.create(),H=F.create(),Y=F.create(),W=F.create(),E=F.create(),p=F.create(),A=F.create();return m})},"esri/views/3d/layers/graphics/Graphics3DTextSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../Color ../../../../core/screenUtils ../../../../symbols/callouts/calloutUtils ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./graphicUtils ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/TextTexture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){var v=[1,1,1,1],x=[0,0,1],y={mode:"relative-to-ground",offset:0},n=[0,0,0,1];return function(k){function l(){var a=null!==k&&k.apply(this,arguments)||this;return a._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},a}return h(l,k),l.prototype._prepareResources=function(){if(!this._isPropertyDriven("size")){var a=c.validateSymbolLayerSize(this._getTextSize());if(a)return this._logWarning(a),void this.reject()}this._anchor="center";this.resolve()},
l.prototype.destroy=function(){k.prototype.destroy.call(this);this.isFulfilled()||this.reject()},l.prototype.createGraphics3DGraphic=function(a,b,c,d){var e="polyline"===a.geometry.type,f=this._getGeometry(a);if(!f)return this._logWarning("unsupported geometry type for text symbol: "+a.geometry.type),null;var g=this._context.layer.id+"_label_"+a.uid,h=b.text||this.symbol.text;if(!h||1>h.length)return null;b&&null!=b.needsOffsetAdjustment&&(this._elevationOptions.needsOffsetAdjustment=b.needsOffsetAdjustment);
var k=this.getGraphicElevationContext(a,b.elevationOffset||0);return this._createAs3DShape(this.symbol,f,h,k,g,a.uid,b,c,d,e)},l.prototype.getGraphicElevationContext=function(a,b){void 0===b&&(b=0);a=k.prototype.getGraphicElevationContext.call(this,a);return a.addOffsetRenderUnits(b),a},l.prototype._getGeometry=function(a){a=this._validateGeometry(a.geometry);return"polyline"===a.type?e.placePointOnPolyline(a):"polygon"===a.type?e.placePointOnPolygon(a):"extent"===a.type?a.center:"point"!==a.type?
null:a},l.prototype.layerPropertyChanged=function(a,b,c){if("opacity"===a)this._logWarning("layer opacity change not yet implemented in Graphics3DTextSymbolLayer");else if("elevationInfo"===a){if(this._updateElevationContext(),b)for(var d in b){a=b[d];var e=c(a);e&&this.updateGraphicElevationContext(a.graphic,e)}return!0}return!1},l.prototype.updateGraphicElevationContext=function(a,b){a=this.getGraphicElevationContext(a,b.metadata.elevationOffset);b.elevationContext.set(a);b.needsElevationUpdates=
e.needsElevationUpdates2D(a.mode)||"absolute-height"===a.mode},l.prototype._defaultElevationInfoNoZ=function(){return y},l.prototype._createAs3DShape=function(c,h,k,l,m,w,y,z,Q,T){var C=y.centerOffset||n,B=y.screenOffset||[0,0],F=y.debugDrawBorder||!1,G=y.translation||[0,0,0],N=y.anchor||this._anchor||"center";this._anchor=N;var E,p=c.material?d.toUnitRGBA(c.material.color):v,A=c.halo&&c.halo.color&&0<c.halo.size,K=A?d.toUnitRGBA(c.halo.color):v,A=A?b.pt2px(c.halo.size):0,M=this._getTextSize(c);c=
new r(k,{size:M,color:p,font:{family:c.font&&c.font.family?c.font.family:"Arial",weight:c.font&&c.font.weight?c.font.weight:"normal",style:c.font&&c.font.style?c.font.style:"normal"},halo:{size:A,color:K}},m);Q=(p=Q&&Q.canHoldTextTexture(c))?Q.addTextTexture(c):null;z?E=y:g.isCalloutSupport(this.symbolContainer)&&this.symbolContainer.hasVisibleVerticalOffset()&&(E=this.symbolContainer);B={textureId:p?Q.texture.getId():c.getId(),texCoordScale:p?[1,1]:c.getTexcoordScale(),occlusionTest:!0,screenOffset:B,
anchorPos:N,polygonOffset:!0,color:[1,1,1,1],centerOffsetUnits:y.centerOffsetUnits,debugDrawBorder:F,drawInSecondSlot:!0};E&&E.verticalOffset&&(E=E.verticalOffset,F=E.minWorldLength,N=E.maxWorldLength,B.verticalOffset={screenLength:b.pt2px(E.screenLength),minWorldLength:F||0,maxWorldLength:null!=N?N:1/0});this._context.screenSizePerspectiveEnabled&&(E=this._context.sharedResources,F=E.screenSizePerspectiveSettings,B.screenSizePerspective=E.screenSizePerspectiveSettingsLabels.overridePadding(A),B.screenSizePerspectiveAlignment=
F);T&&(B.shaderPolygonOffset=1E-4);T=null;A=JSON.stringify(B);null!=z?(T=z.getMaterial(A),null==T?(T=new u(B,m),z.addMaterial(A,T)):p&&T.setTextureDirty()):T=new u(B,m);T=[T];A=[c.getTextWidth(),c.getTextHeight()];C=t.createPointGeometry(x,G,void 0,A,C,Q?Q.uvMinMax:null);C=[new q(C,m)];m=e.createStageObjectForPoint.call(this,h,C,[T],null,null,l,m,this._context.layer.uid,w,!0);z=new f(this,m.object,C,null==z?T:null,p?null:[c],a.perObjectElevationAligner,l);z.alignedTerrainElevation=m.terrainElevation;
z.needsElevationUpdates=e.needsElevationUpdates2D(l.mode)||"absolute-height"===l.mode;var P=p?c.getTextWidth():c.getWidth(),R=p?c.getTextHeight():c.getHeight();return z.getScreenSize=function(a){return void 0===a&&(a=Array(2)),a[0]=P,a[1]=R,a},z.metadata={labelText:k,elevationOffset:y.elevationOffset||0},e.extendPointGraphicElevationContext(z,h,this._context.elevationProvider),z},l.prototype._getTextSize=function(a){return b.pt2px((a||this.symbol).size)||12},l}(k)})},"esri/views/3d/webgl-engine/lib/TextTexture":function(){define("require exports ./Texture ./Util ../../../webgl/Texture ../../../webgl/enums".split(" "),
function(m,l,h,d,b,g){function k(){var a=document.createElement("canvas");return a.width=e,a.height=e,a}function f(a){return"rgb("+a.slice(0,3).map(function(a){return Math.floor(255*a)}).toString()+")"}function a(a){return"rgba("+a.slice(0,3).map(function(a){return Math.floor(255*a)}).toString()+","+a[3]+")"}var e=512;m=function(){function g(b,c,e,g){void 0===g&&(g=!0);this._idHint=e;this._text=b;this._textLines=b.split(/\r?\n/);this._params=c;this._haloSize=Math.round(this._params.halo.size);this._fillStyle=
a(this._params.color);this._haloStyle=f(this._params.halo.color);this._textWidth=this._computeTextWidth();this._lineHeight=this._computeLineHeight();this._textHeight=this._computeTextHeight();g?this._scaleFactor=Math.min(1,Math.min(2048/this._textWidth,2048/this._textHeight)):this._scaleFactor=1;this._renderedWidth=Math.round(this._textWidth*this._scaleFactor);this._renderedHeight=Math.round(this._textHeight*this._scaleFactor);g&&d.assert(2048>=this._renderedWidth&&2048>=this._renderedHeight);this._width=
d.nextHighestPowerOfTwo(this._renderedWidth);this._height=d.nextHighestPowerOfTwo(this._renderedHeight)}return g.prototype.getId=function(){return null==this._id&&(this._id=h.idGen.gen(this._idHint)),this._id},g.prototype.getParams=function(){return this._params},g.prototype.getText=function(){return this._text},g.prototype.deferredLoading=function(){return!1},g.prototype.getWidth=function(){return this._width},g.prototype.getHeight=function(){return this._height},g.prototype.getTextWidth=function(){return this._textWidth},
g.prototype.getTextHeight=function(){return this._textHeight},g.prototype.getRenderedWidth=function(){return this._renderedWidth},g.prototype.getRenderedHeight=function(){return this._renderedHeight},g.prototype.initializeThroughRender=function(a,c){var d=this._getTextCanvas();d.width=this._width;d.height=this._height;var e=d.getContext("2d");e.save();c.samplingMode=9987;c.wrapMode=33071;c.flipped=!0;c.preMultiplyAlpha=!0;c.hasMipmap=!0;this.renderText(this._renderedWidth,this._renderedHeight,e,0,
this._height-this._renderedHeight);a=new b(a,c,d);return e.restore(),a},g.prototype.getTexcoordScale=function(){return[this._renderedWidth/this._width,this._renderedHeight/this._height]},g.prototype.setUnloadFunc=function(a){this._unloadFunc=a},g.prototype.unload=function(){this._unloadFunc&&(this._unloadFunc(this._id),this._unloadFunc=null)},g.prototype.renderText=function(a,b,d,f,g){void 0===f&&(f=0);void 0===g&&(g=0);b=this._lineHeight*this._scaleFactor;var h=this._haloSize,k=d.textAlign;a=("center"===
k?.5*a:"right"===k?a:0)+h;d.save();var l=3>h;if(0<h){var k=h,m=this._getHaloCanvas();m.width=Math.max(e,this._renderedWidth);m.height=Math.max(e,this._renderedHeight);var q=m.getContext("2d");if(q.clearRect(0,0,m.width,m.height),this._setFontProperties(q,this._params.size*this._scaleFactor),q.fillStyle=this._haloStyle,q.strokeStyle=this._haloStyle,q.lineJoin=l?"miter":"round",l)for(var r=0,t=this._textLines;r<t.length;r++){for(var l=t[r],u=0,v=c;u<v.length;u++){var x=v[u];q.fillText(l,a+h*x[0],h+
h*x[1])}k+=b}else for(r=0,t=this._textLines;r<t.length;r++){l=t[r];u=2*h;for(v=0;5>v;v++)q.lineWidth=(.6+.1*v)*u,q.strokeText(l,a,k);k+=b}d.globalAlpha=this._params.halo.color[3];d.drawImage(m,f,g);m.width=e;m.height=e;d.globalAlpha=1}this._setFontProperties(d,this._params.size*this._scaleFactor);k=g+h;g=0;for(h=this._textLines;g<h.length;g++)l=h[g],d.globalCompositeOperation="destination-out",d.fillStyle="rgb(0, 0, 0)",d.fillText(l,f+a,k),d.globalCompositeOperation="source-over",d.fillStyle=this._fillStyle,
d.fillText(l,f+a,k),k+=b;d.restore()},g.preferredAtlasSize=function(){return e},g.prototype._getTextCanvas=function(){return null==g._textCanvas2D&&(g._textCanvas2D=k()),g._textCanvas2D},g.prototype._getHaloCanvas=function(){return null==g._haloCanvas2D&&(g._haloCanvas2D=k()),g._haloCanvas2D},g.prototype._setFontProperties=function(a,b){var c=this._params.font;a.font=c.style+" "+c.weight+" "+b+"px "+c.family;a.textAlign="left";a.textBaseline="top"},g.prototype._computeTextWidth=function(){var a=this._getTextCanvas().getContext("2d");
this._setFontProperties(a,this._params.size);for(var b=0,c=0,d=this._textLines;c<d.length;c++){var e=a.measureText(d[c]).width;e>b&&(b=e)}c=this._params.font;return("italic"===c.style||"oblique"===c.style||"string"==typeof c.weight&&("bold"===c.weight||"bolder"===c.weight)||"number"==typeof c.weight&&600<c.weight)&&(b+=.3*a.measureText("A").width),b+=2*this._haloSize,b=Math.round(b)},g.prototype._computeLineHeight=function(){return Math.floor(1.275*this._params.size+2*this._haloSize)},g.prototype._computeTextHeight=
function(){return this._computeLineHeight()*this._textLines.length},g}();var c=[];for(l=0;360>l;l+=22.5)c.push([Math.cos(Math.PI*l/180),Math.sin(Math.PI*l/180)]);return m})},"esri/views/3d/layers/graphics/Graphics3DPointSymbol":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","./Graphics3DSymbol","./Graphics3DCalloutSymbolLayerFactory"],function(m,l,h,d,b){return function(d){function g(f,a,e){f=d.call(this,f,a,e)||this;return f.calloutSymbolLayer=null,f.symbol.hasVisibleCallout()&&
(f.calloutSymbolLayer=b.make(f.symbol,a)),f}return h(g,d),g.prototype.destroy=function(){d.prototype.destroy.call(this)},g.prototype.createGraphics3DGraphic=function(b,a,e){e=d.prototype.createGraphics3DGraphic.call(this,b,a,e);this.calloutSymbolLayer&&(b=this.createCalloutGraphic(b,a))&&e.addAuxiliaryGraphic(b);return e},g.prototype.layerPropertyChanged=function(b,a){var e=this;return d.prototype.layerPropertyChanged.call(this,b,a)?this.calloutSymbolLayer?this.calloutSymbolLayer.layerPropertyChanged(b,
a,function(a){var b=0;for(a=a._auxiliaryGraphics;b<a.length;b++){var c=a[b];if(c.graphics3DSymbolLayer===e.calloutSymbolLayer)return c}}):!0:!1},g.prototype.createCalloutGraphic=function(b,a){return this.calloutSymbolLayer.createGraphics3DGraphic(b,{renderer:a.renderer,symbol:a.symbol,needsOffsetAdjustment:a.needsOffsetAdjustment,translation:[0,0,0],centerOffset:[0,0,0,0],screenOffset:[0,0],centerOffsetUnits:"world",elevationOffset:0,materialCollection:null})},g}(d)})},"esri/views/3d/layers/graphics/Graphics3DCalloutSymbolLayerFactory":function(){define(["require",
"exports","../../../../core/Logger","../../../../symbols/callouts/calloutUtils","./Graphics3DLineCalloutSymbolLayer"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});var g=h.getLogger("esri.views.3d.layers.graphics.Graphics3DCalloutSymbolLayerFactory");l.make=function(b,a){if(!d.isCalloutSupport(b))return g.error("Graphics3DCalloutSymbolLayerFactory#make","symbol of type '"+b.type+"' does not support callouts"),null;if(!b.callout)return null;var e=k[b.callout.type];return e?new e(b,
a):(g.error("Graphics3DCalloutSymbolLayerFactory#make","unknown or unsupported callout type "+b.callout.type),null)};var k={line:b}})},"esri/views/3d/layers/graphics/Graphics3DLineCalloutSymbolLayer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ./ElevationAligners ../../../../core/screenUtils ../../../../Color ../../../../geometry/Polygon ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/Util ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/LineCalloutMaterial".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){var v,x,y=t.VertexAttrConstants;m=function(d){function l(a,b){a=d.call(this,a,null,b,!0)||this;return a._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},a}return h(l,d),l.prototype.destroy=function(){d.prototype.destroy.call(this);this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(c.ModelContentType.MATERIAL,this._material.getId()),this._material=null)},l.prototype._prepareResources=function(){var a=this._getStageIdHint();
this._createMaterialsAndAddToStage(this._context.stage,a);this.resolve()},l.prototype.perInstanceMaterialParameters=function(a){var b=this.materialParameters;return b.screenOffset=a.screenOffset||[0,0],b.centerOffsetUnits=a.centerOffsetUnits||"world",b},Object.defineProperty(l.prototype,"materialParameters",{get:function(){var b=this.symbolContainer,c=b.callout,d=a.toUnitRGBA(c.color);d[3]*=this._getLayerOpacity();var e=f.pt2px(c.size||0),g=null;if(b.verticalOffset)var g=b.verticalOffset,h=g.minWorldLength,
k=g.maxWorldLength,g={screenLength:f.pt2px(g.screenLength),minWorldLength:h||0,maxWorldLength:null!=k?k:1/0};c=c.border&&c.border.color?a.toUnitRGBA(c.border.color):null;h="object"===b.symbolLayers.getItemAt(0).type;return{color:d,size:e,verticalOffset:g,screenSizePerspective:this._context.screenSizePerspectiveEnabled?this._context.sharedResources.screenSizePerspectiveSettings:null,screenOffset:[0,0],centerOffsetUnits:"world",borderColor:c,occlusionTest:!h,shaderPolygonOffset:h?0:void 0,depthHUDAlignStart:"label-3d"===
b.type}},enumerable:!0,configurable:!0}),l.prototype._createMaterialsAndAddToStage=function(a,b){this._material=new u(this.materialParameters,b+"_lineCallout_common");a.add(c.ModelContentType.MATERIAL,this._material)},l.prototype._defaultElevationInfoNoZ=function(){return z},l.prototype._getGeometry=function(a){a=this._validateGeometry(a.geometry);return"extent"===a.type?g.placePointOnPolygon(e.fromExtent(a)):"polyline"===a.type?g.placePointOnPolyline(a):"polygon"===a.type?g.placePointOnPolygon(a):
"point"===a.type?a:(this._logWarning("unsupported geometry type for point symbol: "+a.type),null)},l.prototype.createGraphics3DGraphic=function(a,b){null!=b.needsOffsetAdjustment&&(this._elevationOptions.needsOffsetAdjustment=b.needsOffsetAdjustment);var c=this.getGraphicElevationContext(a,b.elevationOffset||0),d=b.symbol,e="on-the-ground"===this._elevationContext.mode&&!d.symbolLayers.some(function(a){return"object"===a.type||"text"===a.type});if("label-3d"!==d.type&&e)return null;d=this._getGeometry(a);
return null===d?null:this._createAs3DShape(a,d,c,b,"graphic"+a.uid,a.uid)},l.prototype.layerPropertyChanged=function(a,b,c){switch(a){case "opacity":return this.layerOpacityChanged(b,c);case "elevationInfo":return this.layerElevationInfoChanged(b,c)}return!1},l.prototype.layerOpacityChanged=function(a,b){return this._material.setParameterValues(this.materialParameters),!0},l.prototype.layerElevationInfoChanged=function(a,b){var c=this._elevationContext.mode;this._updateElevationContext();var d=this._elevationContext.mode;
if(c!==d&&("on-the-ground"===c||"on-the-ground"===d))return!1;for(var e in a)c=a[e],(d=b(c))&&this.updateGraphicElevationContext(c.graphic,d);return!0},l.prototype.getGraphicElevationContext=function(a,b){void 0===b&&(b=0);a=d.prototype.getGraphicElevationContext.call(this,a);return a.addOffsetRenderUnits(b),a},l.prototype.updateGraphicElevationContext=function(a,b){a=this.getGraphicElevationContext(a,b.metadata.elevationOffset);b.elevationContext.set(a);b.needsElevationUpdates=g.needsElevationUpdates2D(a.mode)},
l.prototype.createVertexData=function(a){var b=a.translation;a=a.centerOffset;if(!b&&!a)return n;b=b?{size:3,data:[b[0],b[1],b[2]]}:n[y.POSITION];a=a?{size:4,data:[a[0],a[1],a[2],a[3]]}:n[y.AUXPOS1];return c={},c[y.POSITION]=b,c[y.NORMAL]=n[y.NORMAL],c[y.AUXPOS1]=a,c;var c},l.prototype.getOrCreateMaterial=function(a,b){var c=this.perInstanceMaterialParameters(a),d=u.uniqueMaterialIdentifier(c);if(d===this._material.uniqueMaterialIdentifier)return{material:this._material,isUnique:!1};if(a.materialCollection){var e=
a.materialCollection.getMaterial(d);return e||(e=new u(c,b+"_lineCallout_shared"),a.materialCollection.addMaterial(d,e)),{material:e,isUnique:!1}}e=new u(c,b+"_lineCallout_unique");return{material:e,isUnique:!0}},l.prototype._createAs3DShape=function(a,c,d,e,f,h){a=new r(this.createVertexData(e),w,r.DefaultOffsets,"point");a=[new q(a,f)];var l=this.getOrCreateMaterial(e,f);f=g.createStageObjectForPoint.call(this,c,a,[[l.material]],null,null,d,f,this._context.layer.uid,h,!0);if(null===f)return null;
h=new b(this,f.object,a,l.isUnique?[l.material]:null,null,k.perObjectElevationAligner,d);return h.metadata={elevationOffset:e.elevationOffset||0},h.alignedTerrainElevation=f.terrainElevation,h.needsElevationUpdates=g.needsElevationUpdates2D(d.mode),g.extendPointGraphicElevationContext(h,c,this._context.elevationProvider),h},l}(d);var n=(v={},v[y.POSITION]={size:3,data:[0,0,0]},v[y.NORMAL]={size:3,data:[0,0,1]},v[y.AUXPOS1]={size:4,data:[0,0,0,1]},v);v=new Uint32Array([0]);var w=(x={},x[y.POSITION]=
v,x[y.NORMAL]=v,x[y.AUXPOS1]=v,x),z={mode:"relative-to-ground",offset:0};return m})},"esri/views/3d/layers/graphics/Graphics3DOwner":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});m=function(){return function(){this.featureExpressionInfoContext=this.localOriginFactory=this.layerView=this.layer=this.overlaySR=this.renderCoordsHelper=this.renderSpatialReference=this.clippingExtent=this.layerOrderDelta=this.layerOrder=this.stage=this.renderer=this.elevationProvider=
this.streamDataSupplier=this.sharedResources=null;this.screenSizePerspectiveEnabled=!0}}();l.Graphics3DSymbolCreationContext=m})},"esri/views/3d/layers/graphics/ElevationQuery":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper dojo/Deferred dojo/_base/lang ../../../../core/Scheduler ../../../../geometry/Multipoint".split(" "),function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function a(a,b,d){this.spatialReference=
a;this._getElevationQueryProvider=b;this._queries=[];this._isScheduled=!1;this._queryOptions=g.mixin({},d,{ignoreInvisibleLayers:!0})}return a.prototype.queryElevation=function(a,c){return d(this,void 0,void 0,function(){var d;return h(this,function(e){return d=new b,this._queries.push({x:a,y:c,result:d}),this._scheduleDoQuery(),[2,d.promise]})})},a.prototype._scheduleDoQuery=function(){var a=this;this._isScheduled||(k.schedule(function(){return a._doQuery()}),this._isScheduled=!0)},a.prototype._doQuery=
function(){return d(this,void 0,void 0,function(){var a,b,d,g,k,l,m;return h(this,function(c){switch(c.label){case 0:if(this._isScheduled=!1,a=this._queries,this._queries=[],b=a.map(function(a){return[a.x,a.y]}),d=new f({points:b,spatialReference:this.spatialReference}),g=this._getElevationQueryProvider(),!g)return a.forEach(function(a,b){return a.result.reject()}),[2];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,g.queryElevation(d,this._queryOptions)];case 2:return k=c.sent(),[3,4];case 3:return l=
c.sent(),a.forEach(function(a){return a.result.reject(l)}),[2];case 4:return m=k.geometry.points,a.forEach(function(a,b){return a.result.resolve(m[b][2])}),[2]}})})},a}();l.ElevationQuery=m})},"esri/views/3d/layers/graphics/Graphics3DSpatialIndex":function(){define("require exports dojo/Deferred ../../../../processors/SpatialIndex ../../../../geometry/SpatialReference ../../../../geometry/support/webMercatorUtils".split(" "),function(m,l,h,d,b,g){return function(){function k(){var b=this;this.spatialIndex=
new d;this.spatialIndexNumPendingQueries=this.spatialIndexNumGraphics=0;this.graphicsCore=this.viewSR=this.layer=this.layerView=null;this._readyDfd=new h;var a=function(a){return a.workerClient&&a.workerClient.worker};a(this.spatialIndex)?this._readyDfd.resolve():this.spatialIndex.on("start",function(){a(b.spatialIndex)&&b._readyDfd.resolve()})}return k.prototype.initialize=function(b,a,d,c){this.layerView=b;this.layer=a;this.viewSR=d;this.graphicsCore=c},k.prototype.destroy=function(){this.spatialIndex&&
(this.spatialIndex.destroy(),this.spatialIndex=null);this.graphicsCore=this.layerView=this.viewSR=null},k.prototype.numNodesUpdating=function(){return 0},k.prototype.isUpdating=function(){return 0<this.spatialIndexNumPendingQueries},k.prototype.hasGraphics=function(){return 0<this.spatialIndexNumGraphics},k.prototype.intersects=function(b,a,d){var c=this;return this.hasGraphics()?(this.spatialIndexNumPendingQueries++,void this.spatialIndex.intersects(b,void 0,void 0,!0).then(function(a){c.spatialIndexNumPendingQueries--;
d(a.results,a.results.length);c.layerView._evaluateUpdatingState()})):void d([],0)},k.prototype.shouldAddToSpatialIndex=function(b,a,d){return d||a.needsElevationUpdates()},k.prototype.addGraphicsToSpatialIndex=function(b){if(this.layerView.loadedGraphics)for(var a=this.layerView.loadedGraphics.toArray(),d=a.length,c=0;d>c;c++){var f=a[c],g=this.graphicsCore.getGraphics3DGraphicById(f.uid);g&&!g.addedToSpatialIndex&&this.shouldAddToSpatialIndex(f,g,b)&&this.addGraphicToSpatialIndex(f,g)}},k.prototype.addGraphicToSpatialIndex=
function(d,a){var e=d.geometry.spatialReference,c=this.viewSR,f={id:d.uid,geometry:null};if(e.equals(c))f.geometry=d.geometry.toJSON();else{var h=void 0;if(e.wkid===b.WGS84.wkid&&c.isWebMercator)h=g.geographicToWebMercator(d.geometry);else{if(!e.isWebMercator||c.wkid!==b.WGS84.wkid)return console.warn("Cannot convert graphic geometry to map spatial reference, elevation and scale updates are disabled"),!1;h=g.webMercatorToGeographic(d.geometry)}f.geometry=h.toJSON()}return this.spatialIndexNumGraphics++,
this.spatialIndex.runProcess([f],this.layer.id),a.addedToSpatialIndex=!0,!0},k.prototype.whenLoaded=function(){return this._readyDfd.promise},k}()})},"esri/processors/SpatialIndex":function(){define("../core/declare dojo/Deferred dojo/_base/lang ./Processor ../workers/WorkerClient ../layers/FeatureLayer".split(" "),function(m,l,h,d,b,g){return m([d],{declaredClass:"esri.processors.SpatialIndex",index:null,indexType:"rtree",autostart:!1,constructor:function(d){d=d||{};var f=!1!==d.autostart;if(h.mixin(this,
d),this.workerCallback=["./scripts/helpers","./scripts/indexInterface","./indexWorker"],!this.fetchWithWorker){var a=this;this.workerClient=new b("./mutableWorker",function(b){this.workerClient=b;this.workerCallback.push("./libs/"+this.indexType);this.workerClient.importScripts(this.workerCallback).then(function(){a._attachedSystem=!0;f&&a.start()})}.bind(this))}this._featCache={}},destroy:function(){this.workerClient&&this.workerClient.terminate()},addLayer:function(b,d){if(b.graphics&&b.graphics.length||
d||b.isInstanceOf(g)){var a=this.workerClient;if(!this._attachedSystem&&a.worker){var e=this;this.inherited(arguments,[b,!0]);a.importScripts("./libs/"+this.indexType).then(function(){e.runProcess(b.graphics,b.id);e._attachedSystem=!0})}else this.inherited(arguments,[b])}},unsetMap:function(){this.stop();this.workerClient.terminate();this.fetchWithWorker||(this.workerClient=new b(this.workerCallback,function(){}));this.inherited(arguments);this.start()},removeLayer:function(b){this.inherited(arguments)},
runProcess:function(b,d){if(b&&b.length){var a=this,e=this.workerClient,c=b[0]._graphicsLayer;d||0===d||(d=c?c.id:"rawFeatures_"+Object.keys(this._featCache).length);this._featCache[d]||(this._featCache[d]={});for(var f,g,h=[],k=b.length,l=c&&c.objectIdField;k--;)g=b[k],f=g.attributes&&l?g.attributes[l]:g.id,null!=f&&this._featCache[d][f]||(this._featCache[d][f]=1,g.declaredClass?h.push({id:f,geometry:g.geometry.toJSON(!0),attributes:g.attributes}):h.push(g));0!==h.length&&(e.postMessage({insert:h,
system:this.indexType,options:this.indexOptions,idField:c&&c.objectIdField,layerId:d}).then(function(b){c&&c.emit("process-end",{processor:a,results:{insert:b.insert}})}),c&&c.emit("process-start",{processor:this}))}},_sendFeaturesFromLayer:function(b,d){d=d.graphic;var a=this.workerClient,e=this,c=d.attributes[b.objectIdField];this._featCache[b.id]||(this._featCache[b.id]={});this._featCache[b.id][c]||(this._featCache[b.id][c]=1,a.postMessage({insert:[{attributes:d.attributes,geometry:d.geometry.toJSON(!0)}],
system:this.indexType,options:this.indexOptions,idField:b.objectIdField,layerId:b.id}).then(function(a){b.emit("process-end",{processor:e,results:{insert:a.insert}})}),b.emit("process-start",{processor:e}))},_notifyProcessStart:function(b,d){},_sendFeaturesFromTask:function(b,d){var a,e=d.featureSet.features,c=[],f=this.workerClient,g=this,h=e.length;for(this._featCache[b.id]||(this._featCache[b.id]={});h--;)a=e[h],d=a.attributes[b.objectIdField],this._featCache[b.id][d]||(this._featCache[b.id][d]=
1,c.push(a));f.postMessage({insert:c,system:this.indexType,options:this.indexOptions,idField:b.objectIdField,layerId:b.id}).then(function(a){b.emit("process-end",{processor:g,results:{insert:a.insert}})});b.emit("process-start",{processor:g})},get:function(){},intersects:function(b,d,a,e){var c;return"rtree"!=this.indexType?(console.error("Index.intersects only works with rtree indexes"),c=new l,c.reject({message:"Index.intersects only works with rtree indexes"}),c.promise):this.workerClient.postMessage({search:b,
layerId:d,returnNode:a,onlyIds:e})},within:function(b,d,a){var e;if("rtree"!=this.indexType)return console.error("Index.within only works with rtree indexes"),e=new l,e.reject({message:"Index.within only works with rtree indexes"}),e.promise},nearest:function(b){var d;return"kdtree"!=this.indexType?(console.error("Index.nearest only works with kdtree indexes"),d=new l,d.reject({message:"Index.nearest only works with kdtree indexes"}),d.promise):this.workerClient.postMessage({search:b})}})})},"esri/processors/Processor":function(){define("../core/sniff ../core/declare dojo/_base/lang dojo/_base/array dojo/Evented ../workers/RequestClient ../layers/GraphicsLayer".split(" "),
function(m,l,h,d,b,g,k){return l([b],{declaredClass:"esri.processors.Processor",layers:null,results:null,passFeatures:!0,drawFeatures:!0,requireWorkerSupport:!0,fetchWithWorker:!1,workerCallback:null,workerClient:null,_started:null,_handlers:null,constructor:function(b){return b=b||{},h.mixin(this,b),m("esri-workers")||!1===this.requireWorkerSupport&&!1===b.requireWorkerSupport?(this._handlers={},this._notifyProcessStart=h.hitch(this,this._notifyProcessStart),this._sendFeaturesFromTask=h.hitch(this,
this._sendFeaturesFromTask),this._sendFeaturesFromLayer=h.hitch(this,this._sendFeaturesFromLayer),void(!1!==b.autostart&&this.start())):(console.log("Browser doesn't support workers \x26 worker support is required for this processor"),this.addLayer=this.setMap=this.start=this.runProcess=function(){},void(this._disabled=!0))},addLayer:function(b,a){var d=b._task,c=this._handlers[b.id]=[],f="complete";!1===this.drawFeatures&&(b._params.drawMode=!1);this.fetchWithWorker?(this.workerClient||(this.workerClient=
g.getClient(this.workerCallback)),d.requestOptions={workerOptions:{worker:this.workerClient}},this.passFeatures&&c.push(d.on(f,h.partial(this._notifyProcessStart,b)))):this.passFeatures?(f=this.drawFeatures?"graphic-draw":"graphic-add",c.push(b.on(f,h.partial(this._sendFeaturesFromLayer,b)))):c.push(d.on(f,h.partial(this._sendFeaturesFromTask,b)));!0!==a&&b.graphics&&this.runProcess(b.graphics,b.id)},removeLayer:function(b){d.forEach(this._handlers[b.id],function(a){a.remove()});delete this._handlers[b.id]},
setMap:function(b){if(this.map){if(b==this.map)return;this.unsetMap()}var a=this;d.forEach(this.layers,a.removeLayer);d.forEach(b.graphicsLayerIds,function(d){a.addLayer(b.findLayerById(d))});this._handlers.map=[b.on("layer-add",function(b){b=b.layer;b.isInstanceOf(k)&&a.addLayer(b)}),b.on("layer-remove",function(b){b=b.layer;b.isInstanceOf(k)&&a.removeLayer(b)})];this.map=b},unsetMap:function(){this.map&&(d.forEach(this._handlers.map,function(b){b.remove()}),delete this._handlers.map,d.forEach(this.layers,
this.removeLayer),this.map=null)},start:function(){this.map?this.setMap(this.map):this.layers&&(h.isArray(this.layers)||(this.layers=[this.layers]),d.forEach(this.layers,this.addLayer));this._started=!0;this.emit("start",{processor:this});console.log("processor started")},stop:function(){this._started=!1;for(var b in this._handlers)this._handlers.hasOwnProperty(b)&&(this._handlers[b].remove(),delete this._handlers[b]);this.emit("stop",{processor:this});console.log("processor stopped")},runProcess:function(b,
a){},_sendFeaturesFromTask:function(){},_sendFeaturesFromLayer:function(){},_notifyProcessStart:function(){}})})},"esri/workers/RequestClient":function(){define(["../core/declare","dojo/_base/xhr","../config","./WorkerClient"],function(m,l,h,d){function b(a,b){var c=new g;(c.addWorkerCallback(a,b),k.unshift({id:b?a+"::"+b:a,client:c}),k.length>f)&&k.pop().client.terminate();return c}var g=m([d],{declaredClass:"esri.workers.RequestClient",constructor:function(){this.setWorker(["./mutableWorker","./requestWorker"],
function(){})},get:function(a){return this._send("GET",a)},post:function(a){return this._send("POST",a)},_send:function(a,b){b=l._ioSetArgs(b);b.xhr=null;var c=b.ioArgs,d=c.url;return delete c.url,delete c.args,this.postMessage({method:a,url:d,options:c}).then(this._getSuccessHandler(b),this._getErrorHandler(b),this._getProgressHandler(b)),b},_addHeaderFunctions:function(a){return a.getResponseHeader=function(b){var c,d=a.headers;return Object.keys(d).forEach(function(a){return a.toLowerCase()==b.toLowerCase()?
(c=d[a],!1):void 0}),c},a.getAllResponseHeaders=function(){var b=[],d=a.headers;return Object.keys(d).forEach(function(a){b.push(a+": "+d[a])}),b=b.join("\n")},a},_getSuccessHandler:function(a){var b=this,d=a.ioArgs;return function(c){a.xhr=b._addHeaderFunctions(c);c=a.xhr.getResponseHeader("content-type");("xml"==d.handleAs||-1<c.indexOf("xml"))&&"string"==typeof a.xhr.response&&(a.xhr.response=(new DOMParser).parseFromString(a.xhr.response,"text/xml"));a.resolve(a.xhr.response,a.xhr)}},_getErrorHandler:function(a){return function(b){a.reject(b)}},
_getProgressHandler:function(a){return function(b){a.progress(b)}}}),k=[],f=h.request.maxWorkers,a=new g;return g.getClient=function(d,c){if(d){var e;return k.some(function(a){return a.id==(c?d+"::"+c:d)&&(e=a.client),!0}),e||b(d,c)}return a},g.setLimit=function(a){f=h.request.maxWorkers=a},g})},"esri/workers/WorkerClient":function(){define("dojo/Evented ../core/declare dojo/Deferred dojo/_base/lang dojo/request ../core/sniff ../core/urlUtils require".split(" "),function(m,l,h,d,b,g,k,f){var a=window.Blob||
window.webkitBlob||window.mozBlob,e=window.URL||window.webkitURL||window.mozURL;return l([m],{declaredClass:"esri.workers.WorkerClient",worker:null,_queue:null,constructor:function(a,b){this._isIE=g("ie");this._queue={};this._acceptMessage=d.hitch(this,this._acceptMessage);this._errorMessage=d.hitch(this,this._errorMessage);a&&this.setWorker(a,function(a){this.worker=a;b(this)}.bind(this))},setWorker:function(b,d){if(b instanceof Array){var c=b;b=c.shift()}var f=this._getUrl(b),f=k.normalize(f),g;
b=!k.hasSameOrigin(f,location.href);if(!1===f)return console.log("Can not resolve worker path"),!1;if(this.worker&&(g=this.worker,g.removeEventListener("message",this._acceptMessage,!1),g.removeEventListener("error",this._errorMessage,!1),g.terminate(),g=null),b){g=this._getUrl("./mutableWorker",!0);try{this._getRemoteText(g,function(b){b=e.createObjectURL(new a([b],{type:"text/javascript"}));d(this._createWorker(b,f))}.bind(this))}catch(v){try{g=k.getProxyUrl(g).path+"?"+encodeURI(g),this._useProxy=
!0,d(this._createWorker(g,c))}catch(x){return console.log("Can not create worker"),!1}}}else d(this._createWorker(f,c))},_createWorker:function(a,b){a=new Worker(a);return a.addEventListener("message",this._acceptMessage,!1),a.addEventListener("error",this._errorMessage,!1),this.worker=a,b&&this.importScripts(b),a},postMessage:function(a,b){(a instanceof Array||"object"!=typeof a)&&(a={data:a});var c=Math.floor(64E9*Math.random()).toString(36);a.msgId=c;c=this._queue[c]=new h;return this.worker?(b?
this.worker.postMessage(a,b):this.worker.postMessage(a),this.emit("start-message",{target:this,message:a})):c.reject({message:"No worker was set."}),c.promise},terminate:function(){var a=Object.keys(this._queue);this.worker&&this.worker.terminate();for(var b=a.length-1;0<=b;b--)this._queue[a[b]].cancel("terminated"),delete this._queue[a[b]]},addWorkerCallback:function(a,b){var c,e=this._getUrl(a,!0);return!1===e?(c=new h,c.reject({message:"Could not load text from "+a}),c.promise):this.postMessage({action:"add-callback",
url:e,cbName:b||"main"}).then(d.hitch(this,function(a){a.target=this;this.emit("callback-added",a)}))},importScripts:function(a){Array.isArray(a)||(a=[a]);a=a.map(function(a){a=this._getUrl(a,!0);return this._useProxy&&!k.hasSameOrigin(a,location.href)&&(a=k.getProxyUrl(a).path+"?"+encodeURI(a)),a},this);return this.postMessage({action:"import-script",url:a}).then(d.hitch(this,function(a){a.target=this;this.emit("scripts-imported",a)}))},_acceptMessage:function(a){var b=a.data,c=b.msgId;if(b.status&&
"debug"==b.status)console[b.showAs||"debug"](b);else if(c&&c in this._queue){var d=this._queue[c];"progress"==b.status?d.progress(a.data):"error"==b.status?(d.reject(a.data),delete this._queue[c]):(d.resolve(a.data),delete this._queue[c])}this.emit("message",{message:a.data,event:a,target:this})},_errorMessage:function(a){this.onerror||this.onError?this.onerror?this.onerror(a):this.onError(a):console.log("Worker Error: "+a.message+"\nIn "+a.filename+" on "+a.lineno)},_getUrl:function(a,b){if(!a)return console.error("can not resolve empty path"),
!1;a.match(/\.js$/)||(a+=".js");a=f.toUrl(a);return b?k.makeAbsolute(a):a},_getRemoteText:function(a,d){(a=this._getUrl(a))&&b.get(a,{sync:!1,handleAs:"text",headers:{"X-Requested-With":"","Content-Type":"text/plain"}}).then(function(a){d(a)})},_startBlobWorker:function(){var b=this._xdSource;b||(b=this._getUrl("./mutableWorker"),b=new a(["if(!self._mutable){importScripts('"+b+"');}"],{type:"text/javascript"}),b=this._xdSource=e.createObjectURL(b));try{return new Worker(b)}catch(q){return console.log(q.message),
!1}}})})},"esri/layers/GraphicsLayer":function(){define("../core/Accessor ../core/Collection ../core/promiseUtils ./Layer ./mixins/ScaleRangeLayer ../Graphic dojo/_base/lang".split(" "),function(m,l,h,d,b,g,k){var f=m.createSubclass({properties:{layer:null,layerView:null,graphics:null}});return d.createSubclass([b],{declaredClass:"esri.layers.GraphicsLayer",viewModulePaths:{"2d":"../views/2d/layers/GraphicsLayerView2D","3d":"../views/3d/layers/FeatureLayerView3D"},getDefaults:function(a){return k.mixin(this.inherited(arguments),
{graphics:[]})},destroy:function(){this.removeAll()},_gfxHdl:null,properties:{elevationInfo:null,graphics:{type:l.ofType(g),set:function(a){var b=this._get("graphics");b||(a.forEach(function(a){a.layer=this},this),this._gfxHdl=a.on("change",function(a){var b,c,d;d=a.added;for(b=0;c=d[b];b++)c.layer=this;d=a.removed;for(b=0;c=d[b];b++)c.layer=null}.bind(this)),this._set("graphics",a),b=a);b.removeAll();b.addMany(a)}},screenSizePerspectiveEnabled:!0,type:{readOnly:!0,value:"graphics"}},add:function(a){return this.graphics.add(a),
this},addMany:function(a){return this.graphics.addMany(a),this},removeAll:function(){return this.graphics.removeAll(),this},createGraphicsController:function(a){return h.resolve(new f({layer:this,layerView:a.layerView,graphics:this.graphics}))},remove:function(a){this.graphics.remove(a)},removeMany:function(a){this.graphics.removeMany(a)},graphicChanged:function(a){this.emit("graphic-update",a)}})})},"esri/layers/FeatureLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/accessorSupport/decorators dojo/_base/lang ../Graphic ../PopupTemplate ../request ../core/MultiOriginJSONSupport ../core/Collection ../core/Error ../core/HandleRegistry ../core/Logger ../core/kebabDictionary ../core/lang ../core/promiseUtils ../core/requireUtils ../core/urlUtils ../geometry/Extent ../geometry/HeightModelInfo ../geometry/SpatialReference ../geometry/support/normalizeUtils ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/support/jsonUtils ../symbols/support/ElevationInfo ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/support/jsonUtils ../renderers/support/styleUtils ../renderers/support/typeUtils ../tasks/support/FeatureSet ../tasks/support/Query ./Layer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./mixins/RefreshableLayer ./mixins/ArcGISService ./graphics/sources/MemorySource ./support/Field ./support/fieldUtils ./support/FeatureProcessing ./support/FeatureTemplate ./support/FeatureType ./support/FeatureReduction ./support/LabelClass ./support/labelingInfo ./support/arcgisLayerUrl ./support/commonProperties".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P,Q,T,O,S,H,Y,W,E,p,A,K,U,V,X,ba,fa,ha,ca,ea,ja,na,za,ua,wa){function da(a){return a&&null!=a.applyEdits}function ra(a){return a&&a.isInstanceOf&&a.isInstanceOf(X)}function ga(a,b,c){return!(a&&a.hasOwnProperty(b)?!a[b]:!c)}var pa=v({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),J=u.getLogger("esri.layers.FeatureLayer");
return function(c){function l(a){a=c.call(this)||this;return a.viewModulePaths={"2d":"../views/2d/layers/FeatureLayerView2D","3d":"../views/3d/layers/FeatureLayerView3D"},a._handles=new r,a.featureReduction=null,a.copyright=null,a.displayField=null,a.definitionExpression=null,a.editFieldsInfo=null,a.elevationInfo=null,a.fields=null,a.fullExtent=null,a.gdbVersion=null,a.geometryType=null,a.hasM=!1,a.hasZ=!1,a.heightModelInfo=null,a.isTable=!1,a.labelsVisible=!1,a.labelingInfo=null,a.layerId=void 0,
a.legendEnabled=!0,a.maxRecordCount=void 0,a.minScale=0,a.maxScale=0,a.objectIdField=null,a.operationalLayerType="ArcGISFeatureLayer",a.popupEnabled=!0,a.popupTemplate=null,a.relationships=null,a.returnM=!1,a.returnZ=!1,a.screenSizePerspectiveEnabled=!0,a.serviceDefinitionExpression=null,a.spatialReference=B.WGS84,a.templates=null,a.timeInfo=null,a.title=null,a.sublayerTitleMode="item-title",a.trackIdField=null,a.type="feature",a.typeIdField=null,a.types=null,a.userIsAdmin=!1,a.version=void 0,a.visible=
!0,a}return h(l,c),l.prototype.normalizeCtorArgs=function(a,b){return"string"==typeof a?k.mixin({},{url:a},b):a},l.prototype.load=function(){var a=this,b=this.source&&(Array.isArray(this.source)||ra(this.source));if(this.portalItem&&b)return void this.addResolvingPromise(y.resolve());b=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]}).always(function(){return a.url&&null==a.layerId&&/FeatureServer\/*$/i.test(a.url)?a._fetchFirstLayerId().then(function(b){null!=b&&(a.layerId=
b)}):void 0}).then(function(){if(!a.url&&!a._hasMemorySource())throw new t("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return a.createGraphicsSource().then(a._initLayerProperties.bind(a))});return this.addResolvingPromise(b),this.when()},Object.defineProperty(l.prototype,"allRenderers",{get:function(){return this._getAllRenderers(this.renderer)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"capabilities",{get:function(){var a=
this._get("capabilities");return a||!this.loaded||this.hasService?a:{data:{supportsAttachment:!1,supportsM:!1,supportsZ:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!0,supportsDelete:!0,supportsEditing:!0,supportsQuery:!0,supportsUpdate:!0},query:{supportsStatistics:!1,supportsCentroid:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!0,supportsGeometryProperties:!1,supportsOrderBy:!1,supportsPagination:!1,supportsQuantization:!1,supportsResultType:!1,
supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsQueryByOthers:!1},queryRelated:{supportsPagination:!1,supportsCount:!1,supportsOrderBy:!1},editing:{supportsGeometryUpdate:!0,supportsGlobalId:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}},enumerable:!0,configurable:!0}),l.prototype.readCapabilities=function(a,b){return b=b.layerDefinition||
b,{data:this._readDataCapabilities(b),operations:this._readOperationsCapabilities(b.capabilities||a,b),query:this._readQueryCapabilities(b),queryRelated:this._readQueryRelatedCapabilities(b),editing:this._readEditingCapabilities(b)}},Object.defineProperty(l.prototype,"hasAttachments",{get:function(){return this.hasService&&this._get("hasAttachments")||!1},enumerable:!0,configurable:!0}),l.prototype.readIsTable=function(a,b){return b=b&&b.layerDefinition||b,"Table"===b.type},Object.defineProperty(l.prototype,
"hasService",{get:function(){return!this._hasMemorySource()},enumerable:!0,configurable:!0}),l.prototype.readMinScale=function(a,b){return b.effectiveMinScale||a||0},l.prototype.readMaxScale=function(a,b){return b.effectiveMaxScale||a||0},l.prototype.readObjectIdFieldFromService=function(a,b){if(b=b.layerDefinition||b,b.objectIdField)return b.objectIdField;if(b.fields)for(a=0,b=b.fields;a<b.length;a++){var c=b[a];if("esriFieldTypeOID"===c.type)return c.name}},Object.defineProperty(l.prototype,"outFields",
{get:function(){var a=this,b=this._userOutFields,c=this.requiredFields;return b=b&&b.slice(0),c=c&&c.slice(0),b?-1===b.indexOf("*")&&c.forEach(function(a){-1===b.indexOf(a)&&b.push(a)}):b=c,this.loaded&&(b=b.filter(function(b){return"*"===b||!!a.getField(b,a.fields)},this),b=b.map(function(b){return"*"===b?b:a.getField(b,a.fields).name},this),b=b.filter(function(a,b,c){return c.indexOf(a)===b})),b},set:function(a){var b=this,c=this.requiredFields&&this.requiredFields.slice(0);a?-1===a.indexOf("*")&&
c.forEach(function(b){-1===a.indexOf(b)&&a.push(b)}):a=c;this.loaded&&(a=a.filter(function(a){return"*"===a||!!b.getField(a,b.fields)},this),a=a.map(function(a){return"*"===a?a:b.getField(a,b.fields).name},this));this._userOutFields=a},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"parsedUrl",{get:function(){var a=this.url?w.urlToObject(this.url):null;return null!=this.layerId&&null!=a&&(a.path=w.join(a.path,this.layerId.toString())),a},enumerable:!0,configurable:!0}),l.prototype.readPopupEnabled=
function(a,b){return!b.disablePopup},l.prototype.writePopupEnabled=function(a,b,c){b[c]=!a},Object.defineProperty(l.prototype,"renderer",{set:function(a){var b=this._getAllRenderers(a);fa.fixRendererFields(b,this.fields);this._set("renderer",a)},enumerable:!0,configurable:!0}),l.prototype.readRenderer=function(a,b,c){b=b.layerDefinition||b;var d,e,f=b.drawingInfo&&b.drawingInfo.renderer||void 0;if(f)(d=O.read(f,b,c)||void 0)||J.error("Failed to create renderer",{rendererDefinition:b.drawingInfo.renderer,
layer:this,context:c});else if(b.defaultSymbol)R.read(b.defaultSymbol,b,c),b.types&&b.types.length?(d=new T({defaultSymbol:e,field:b.typeIdField}),b.types.forEach(function(a){f.addUniqueValueInfo(a.id,R.read(a.symbol,a,c))})):d=new Q({symbol:e});else if("Table"!==b.type){switch(b.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":e=new G;break;case "esriGeometryPolyline":e=new N;break;case "esriGeometryPolygon":e=new M}d=e&&new Q({symbol:e})}return d},Object.defineProperty(l.prototype,
"requiredFields",{get:function(){var a=this.timeInfo,b=[],c=[],a=[this.objectIdField,this.typeIdField,this.editFieldsInfo&&this.editFieldsInfo.creatorField,a&&a.startTimeField,a&&a.endTimeField,this.trackIdField];this.allRenderers.forEach(function(a){b=b.concat(a.requiredFields)});this.labelingInfo&&this.labelingInfo.length&&this.labelingInfo.forEach(function(a){c=c.concat(a.requiredFields)});var a=a.concat(b),a=a.concat(c),d=this.elevationInfo&&this.elevationInfo.featureExpressionInfo;return d&&
(a=a.concat(d.requiredFields)),this.popupTemplate&&(a=a.concat(this.popupTemplate.requiredFields)),a.filter(function(a,b,c){return!!a&&c.indexOf(a)===b&&"function"!=typeof a})},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"source",{set:function(a){var b=this._get("source");b!==a&&(ra(b)&&this._resetMemorySource(b),ra(a)&&this._initMemorySource(a),this._set("source",a))},enumerable:!0,configurable:!0}),l.prototype.castSource=function(a){return a?Array.isArray(a)||a&&a.isInstanceOf&&
a.isInstanceOf(q)?new X({layer:this,items:a}):a:null},l.prototype.readSource=function(a,b){a=Y.fromJSON(b.featureSet);return new X({layer:this,items:a&&a.features||[]})},l.prototype.readTemplates=function(a,b){var c=b.editFieldsInfo;b=c&&c.creatorField;c=c&&c.editorField;return a=a&&a.map(function(a){return ca.fromJSON(a)}),this._fixTemplates(a,b),this._fixTemplates(a,c),a},l.prototype.readTitle=function(a,b){a=b.layerDefinition&&b.layerDefinition.name||b.name;b=b.title||b.layerDefinition&&b.layerDefinition.title;
return a?(b=this.portalItem&&this.portalItem.title,"item-title"===this.sublayerTitleMode?this.url?ua.titleFromUrlAndName(this.url,a):a:(a=a||this.url&&ua.parse(this.url).title)?("item-title-and-service-name"===this.sublayerTitleMode&&b&&(a=b+" - "+a),ua.cleanTitle(a)):void 0):"item-title"===this.sublayerTitleMode&&b?b:void 0},l.prototype.readTitleFromWebMap=function(a,b){return(a=b.layerDefinition&&b.layerDefinition.name)?a:b.title},l.prototype.readTypeIdField=function(a,b){(b=b.layerDefinition||
b,a=b.typeIdField)&&(b=this.getField(a,b.fields))&&(a=b.name);return a},l.prototype.readTypes=function(a,b){var c=this;b=b.layerDefinition||b;a=b.types;var d=(b=b.editFieldsInfo)&&b.creatorField,e=b&&b.editorField;return a&&a.map(function(a){return a=ea.fromJSON(a),c._fixTemplates(a.templates,d),c._fixTemplates(a.templates,e),a})},Object.defineProperty(l.prototype,"url",{set:function(a){a=ua.sanitizeUrlWithLayerId(this,a,J);this._set("url",a.url);null!=a.layerId&&this._set("layerId",a.layerId)},enumerable:!0,
configurable:!0}),l.prototype.writeUrl=function(a,b,c,d){ua.writeUrlWithLayerId(this,a,b)},l.prototype.readVersion=function(a,b){return b=b.layerDefinition||b,b.currentVersion?b.currentVersion:b.hasOwnProperty("capabilities")||b.hasOwnProperty("drawingInfo")||b.hasOwnProperty("hasAttachments")||b.hasOwnProperty("htmlPopupType")||b.hasOwnProperty("relationships")||b.hasOwnProperty("timeInfo")||b.hasOwnProperty("typeIdField")||b.hasOwnProperty("types")?10:9.3},l.prototype.readVisible=function(a,b){return b.layerDefinition&&
null!=b.layerDefinition.defaultVisibility?!!b.layerDefinition.defaultVisibility:null!=b.visibility?!!b.visibility:void 0},l.prototype.applyEdits=function(a){var b=this;return this.load().then(function(){return da(b.source)?b._processApplyEditsParams(a):y.reject(new t("FeatureLayer","Layer source does not support applyEdits capability"))}).then(function(a){return da(b.source)?b.source.applyEdits(a).then(function(a){var c=function(a){return a.filter(function(a){return!a.error}).map(x.clone)},c={addedFeatures:c(a.addFeatureResults),
updatedFeatures:c(a.updateFeatureResults),deletedFeatures:c(a.deleteFeatureResults)};return(c.addedFeatures.length||c.updatedFeatures.length||c.deletedFeatures.length)&&b.emit("edits",c),a}):void 0})},l.prototype.createGraphicsSource=function(){var a=this;return this._hasMemorySource()?(this.emit("graphics-source-create",{graphicsSource:this.source}),this.source.when()):n.when(m,"./graphics/sources/FeatureLayerSource").then(function(b){return new b({layer:a})}).then(function(a){return a.when()}).then(function(b){return a.emit("graphics-source-create",
{graphicsSource:b}),b})},l.prototype.createGraphicsController=function(a){var b,c=this,d=a.layerView,e=q.ofType(f),g=this.source,h=ra(g),l=k.mixin(a.options||{},{layer:this,layerView:d,graphics:h?g:new e});return b=h?"./graphics/controllers/MemoryController":"2d"===d.view.type?"./graphics/controllers/AutoController2D":"./graphics/controllers/SnapshotController",n.when(m,b).then(function(a){return new a(l)}).then(function(a){return c.emit("graphics-controller-create",{graphicsController:a}),a.when()})},
l.prototype.createQuery=function(){var a=new W,b=this.get("capabilities.data");return a.returnGeometry=!0,a.returnZ=b&&b.supportsZ&&this.returnZ||null,a.returnM=b&&b.supportsM&&this.returnM||null,a.outFields=this.outFields,a.where=this.definitionExpression||"1\x3d1",a.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,a},l.prototype.getFieldDomain=function(a,b){var c,d=this,e=!1;b=(b=b&&b.feature)&&b.attributes;var f=this.typeIdField&&b&&b[this.typeIdField];return null!=f&&this.types&&
(e=this.types.some(function(b){return b.id==f?(c=b.domains&&b.domains[a],c&&"inherited"===c.type&&(c=d._getLayerDomain(a)),!0):!1})),e||c||(c=this._getLayerDomain(a)),c},l.prototype.getField=function(a,b){var c=this.processing?this.fields.concat(this.processing.fields):this.fields;return fa.getField(a,b||c)},l.prototype.graphicChanged=function(a){this.emit("graphic-update",a)},l.prototype.queryFeatures=function(a){var b=this;return this.load().then(function(){return b.source.queryFeatures?void 0:
y.reject(new t("FeatureLayer","Layer source does not support queryFeatures capability"))}).then(function(){return b.source.queryFeatures(a||b.createQuery())}).then(function(a){if(a&&a.features){var c=b.popupTemplate;a.features.forEach(function(a){a.popupTemplate=c;a.layer=b})}return a})},l.prototype.queryObjectIds=function(a){var b=this;return this.load().then(function(){return b.source.queryObjectIds?b.source.queryObjectIds(a||b.createQuery()):y.reject(new t("FeatureLayer","Layer source does not support queryObjectIds capability"))})},
l.prototype.queryFeatureCount=function(a){var b=this;return this.load().then(function(){return b.source.queryFeatureCount?b.source.queryFeatureCount(a||b.createQuery()):y.reject(new t("FeatureLayer","Layer source does not support queryFeatureCount capability"))})},l.prototype.queryExtent=function(a){var b=this;return this.load().then(function(){return b.source.queryExtent?b.source.queryExtent(a||b.createQuery()):y.reject(new t("FeatureLayer","Layer source does not support queryExtent capability"))})},
l.prototype.read=function(a,b){switch(b&&b.origin){case "web-scene":this.inherited(arguments,[{returnZ:!0},b])}var c=a.featureCollection;if(c){var d=c.layers;d&&1===d.length&&(this.inherited(arguments,[d[0],b]),null!=c.showLegend&&this.inherited(arguments,[{showLegend:c.showLegend},b]))}return this.inherited(arguments,[a,b]),this},l.prototype.write=function(a,b){if(b&&"web-scene"===b.origin&&b.messages){if(!this.url)return b.messages.push(new t("layer:unsupported","Layers ("+this.title+", "+this.id+
") of type '"+this.declaredClass+"' require a url to a service to be written to web scenes",{layer:this})),null;if(this.isTable)return b.messages.push(new t("layer:unsupported","Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' using a Table source cannot written to web scenes",{layer:this})),null}return this.inherited(arguments)},l.prototype._getLayerDomain=function(a){if(!this.fields)return null;var b=null;return this.fields.some(function(c){return c.name===a&&(b=c.domain),!!b}),
b},l.prototype._fetchFirstLayerId=function(){return e(this.url,{query:{f:"json"},callbackParamName:"callback",responseType:"json"}).then(function(a){return(a=a.data)&&Array.isArray(a.layers)&&0<a.layers.length?a.layers[0].id:void 0})},l.prototype._initLayerProperties=function(a){var b=this;return this.source||(this.source=a),a.url&&(this.url=a.url),a.layerDefinition&&this.read(a.layerDefinition,{origin:"service",url:this.parsedUrl}),this._verifySource(),this._verifyFields(),this._addSymbolUrlTokens(),
fa.fixRendererFields(this._getAllRenderers(this.renderer),this.fields),this.watch("token",function(){b._addSymbolUrlTokens()}),S.loadStyleRenderer(this,{origin:"service"})},l.prototype._findUrlBasedSymbols=function(){var a=this.renderer;if(!a)return[];var b=[];a.symbol&&b.push(a.symbol);a.defaultSymbol&&b.push(a.defaultSymbol);a=a.classBreakInfos||a.uniqueValueInfos;return a&&a.forEach(function(a){a.symbol&&b.push(a.symbol)}),b.filter(function(a){return!!a.url})},l.prototype._addSymbolUrlTokens=function(){var a=
this.token;!this._hasMemorySource()&&a&&this._findUrlBasedSymbols().forEach(function(b){var c=b.url;if(c&&-1!==c.search(/https?\:/i)&&!/[?&]token=/.test(c)){var d=-1===c.indexOf("?")?"?":"\x26";b.url=c+d+"token\x3d"+a}})},l.prototype._getAllRenderers=function(a){if(!a)return[];var b=[];return[a,a.trackRenderer,a.observationRenderer,a.latestObservationRenderer].forEach(function(a){a&&(b.push(a),a.rendererInfos&&a.rendererInfos.forEach(function(a){a.renderer&&b.push(a.renderer)}))}),b},l.prototype._verifyFields=
function(){var a=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+a+")");this.isTable||this._hasMemorySource()||-1!==a.search(/\/FeatureServer\//i)||this.fields&&this.fields.some(function(a){return"geometry"===a.type})||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+a+")")},l.prototype._fixTemplates=
function(a,b){a&&a.forEach(function(a){(a=a.prototype&&a.prototype.attributes)&&b&&delete a[b]})},l.prototype._verifySource=function(){var a=this;if(this._hasMemorySource()){if(this.url)throw new t("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url");var b=["geometryType","fields","objectIdField"];if(!b.every(function(b){return null!=a[b]}))throw new t("feature-layer:missing-property","FeatureLayer created as feature collection requires properties: "+
b.join(),{requiredProperties:b});}else{if(this.isTable)throw new t("feature-layer:source-type-not-supported","The table feature service type is not yet supported",{sourceType:"Table"});if(!this.url)throw new t("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source");}},l.prototype._initMemorySource=function(a){var b=this;a.forEach(function(a){a.layer=b});this._handles.add([a.on("after-add",function(a){a.item.layer=b}),a.on("after-remove",function(a){a.item.layer=
null})],"fl-source")},l.prototype._resetMemorySource=function(a){a.forEach(function(a){a.layer=null});this._handles.remove("fl-source")},l.prototype._hasMemorySource=function(){return!(this.url||!this.source)},l.prototype._readDataCapabilities=function(a){return{supportsAttachment:ga(a,"hasAttachments",!1),supportsM:ga(a,"hasM",!1),supportsZ:ga(a,"hasZ",!1)}},l.prototype._readOperationsCapabilities=function(a,b){a=a?a.toLowerCase().split(",").map(function(a){return a.trim()}):[];var c=-1!==a.indexOf("editing"),
d=c&&-1!==a.indexOf("create"),e=c&&-1!==a.indexOf("delete"),f=c&&-1!==a.indexOf("update");return c&&!(d||e||f)&&(d=e=f=!0),{supportsCalculate:ga(b,"supportsCalculate",!1),supportsTruncate:ga(b,"supportsTruncate",!1),supportsValidateSql:ga(b,"supportsValidateSql",!1),supportsAdd:d,supportsDelete:e,supportsEditing:c,supportsQuery:-1!==a.indexOf("query"),supportsUpdate:f}},l.prototype._readQueryCapabilities=function(a){var b=a.advancedQueryCapabilities,c=a.ownershipBasedAccessControlForFeatures;return{supportsStatistics:ga(b,
"supportsStatistics",a.supportsStatistics),supportsCentroid:ga(b,"supportsReturningGeometryCentroid",!1),supportsDistance:ga(b,"supportsQueryWithDistance",!1),supportsDistinct:ga(b,"supportsDistinct",a.supportsAdvancedQueries),supportsExtent:ga(b,"supportsReturningQueryExtent",!1),supportsGeometryProperties:ga(b,"supportsReturningGeometryProperties",!1),supportsOrderBy:ga(b,"supportsOrderBy",a.supportsAdvancedQueries),supportsPagination:ga(b,"supportsPagination",!1),supportsQuantization:ga(a,"supportsCoordinatesQuantization",
!1),supportsResultType:ga(b,"supportsQueryWithResultType",!1),supportsSqlExpression:ga(b,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:ga(a,"useStandardizedQueries",!1),supportsQueryByOthers:ga(c,"allowOthersToQuery",!0)}},l.prototype._readQueryRelatedCapabilities=function(a){a=a.advancedQueryCapabilities;var b=ga(a,"supportsAdvancedQueryRelated",!1);return{supportsPagination:ga(a,"supportsQueryRelatedPagination",!1),supportsCount:b,supportsOrderBy:b}},l.prototype._readEditingCapabilities=
function(a){var b=a.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:ga(a,"allowGeometryUpdates",!0),supportsGlobalId:ga(a,"supportsApplyEditsWithGlobalIds",!1),supportsRollbackOnFailure:ga(a,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:ga(a,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:ga(a,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:ga(b,"allowAnonymousToDelete",!0),supportsDeleteByOthers:ga(b,"allowOthersToDelete",!0),supportsUpdateByAnonymous:ga(b,
"allowAnonymousToUpdate",!0),supportsUpdateByOthers:ga(b,"allowOthersToUpdate",!0)}},l.prototype._processApplyEditsParams=function(a){if(!a)return y.reject(new t("feature-layer:missing-parameters","'addFeatures', 'updateFeatures' or 'deleteFeatures' parameter is required"));if(a=k.mixin({},a),a.addFeatures=a.addFeatures||[],a.updateFeatures=a.updateFeatures||[],a.deleteFeatures=a.deleteFeatures||[],a.addFeatures.length||a.updateFeatures.length||a.deleteFeatures.length){var b=function(a){var b=new f;
return b.geometry=a.geometry,b.attributes=a.attributes,b};return a.addFeatures=a.addFeatures.map(b),a.updateFeatures=a.updateFeatures.map(b),this._normalizeGeometries(a)}return y.reject(new t("feature-layer:missing-parameters","'addFeatures', 'updateFeatures' or 'deleteFeatures' parameter is required"))},l.prototype._normalizeGeometries=function(a){var b=a.addFeatures,c=a.updateFeatures,d=b.concat(c).map(function(a){return a.geometry});return F.normalizeCentralMeridian(d).then(function(d){var e=b.length,
f=c.length;return d.slice(0,e).forEach(function(b,c){a.addFeatures[c].geometry=b}),d.slice(e,e+f).forEach(function(b,c){a.updateFeatures[c].geometry=b}),a})},d([g.property({types:{key:"type",base:ja.FeatureReduction,typeMap:{selection:ja.FeatureReductionSelection}},json:{origins:{"web-scene":{read:{source:"layerDefinition.featureReduction"},write:{target:"layerDefinition.featureReduction"}}}}})],l.prototype,"featureReduction",void 0),d([g.property({readOnly:!0,dependsOn:["loaded","renderer","fields"]})],
l.prototype,"allRenderers",null),d([g.property({readOnly:!0,dependsOn:["loaded"]})],l.prototype,"capabilities",null),d([g.reader("capabilities","layerDefinition.capabilities layerDefinition.advancedQueryCapabilities layerDefinition.supportsStatistics layerDefinition.supportsAdvancedQueries layerDefinition.hasAttachments layerDefinition.hasM layerDefinition.hasZ layerDefinition.supportsCalculate layerDefinition.supportsTruncate layerDefinition.supportsValidateSql layerDefinition.supportsCoordinatesQuantization layerDefinition.useStandardizedQueries layerDefinition.ownershipBasedAccessControlForFeatures layerDefinition.allowGeometryUpdates layerDefinition.supportsApplyEditsWithGlobalIds layerDefinition.supportsRollbackOnFailureParameter layerDefinition.allowUpdateWithoutMValues layerDefinition.supportsAttachmentsByUploadId".split(" ")),
g.reader("service","capabilities","advancedQueryCapabilities supportsStatistics supportsAdvancedQueries hasAttachments hasM hasZ supportsCalculate supportsTruncate supportsValidateSql supportsCoordinatesQuantization useStandardizedQueries ownershipBasedAccessControlForFeatures allowGeometryUpdates supportsApplyEditsWithGlobalIds supportsRollbackOnFailureParameter allowUpdateWithoutMValues supportsAttachmentsByUploadId capabilities".split(" "))],l.prototype,"readCapabilities",null),d([g.property({type:String,
json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],l.prototype,"copyright",void 0),d([g.property({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],l.prototype,"displayField",void 0),d([g.property({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],l.prototype,"definitionExpression",
void 0),d([g.property({readOnly:!0,json:{read:R.read}})],l.prototype,"defaultSymbol",void 0),d([g.property({readOnly:!0})],l.prototype,"editFieldsInfo",void 0),d([g.property({type:P,json:{origins:{service:{read:{source:"elevationInfo"},write:{target:"elevationInfo",enabled:!1}}},read:{source:"layerDefinition.elevationInfo"},write:{target:"layerDefinition.elevationInfo"}}})],l.prototype,"elevationInfo",void 0),d([g.property({type:[ba],json:{origins:{service:{read:!0}},read:{source:"layerDefinition.fields"}}})],
l.prototype,"fields",void 0),d([g.property({type:z,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],l.prototype,"fullExtent",void 0),d([g.property()],l.prototype,"gdbVersion",void 0),d([g.property({json:{origins:{service:{read:pa.read}},read:{source:"layerDefinition.geometryType",reader:pa.read}}})],l.prototype,"geometryType",void 0),d([g.property({readOnly:!0,dependsOn:["loaded"],json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasAttachments"}}})],
l.prototype,"hasAttachments",null),d([g.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],l.prototype,"hasM",void 0),d([g.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],l.prototype,"hasZ",void 0),d([g.property({readOnly:!0,type:C})],l.prototype,"heightModelInfo",void 0),d([g.property({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],l.prototype,"id",void 0),d([g.property({readOnly:!0})],
l.prototype,"isTable",void 0),d([g.reader("service","isTable",["type"]),g.reader("isTable",["layerDefinition.type"])],l.prototype,"readIsTable",null),d([g.property({dependsOn:["loaded","url","source"],readOnly:!0})],l.prototype,"hasService",null),d([g.property({type:Boolean,json:{read:{source:"showLabels"},write:{target:"showLabels"}}})],l.prototype,"labelsVisible",void 0),d([g.property({type:[na],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:za.reader},write:{target:"drawingInfo.labelingInfo",
enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:za.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],l.prototype,"labelingInfo",void 0),d([g.property({type:Number,json:{origins:{service:{read:{source:"id"}}},read:!1}})],l.prototype,"layerId",void 0),d([g.property({type:Boolean,json:{read:{source:"showLegend"},write:{target:"showLegend"}}})],l.prototype,"legendEnabled",void 0),d([g.property({type:Number,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.maxRecordCount"}}})],
l.prototype,"maxRecordCount",void 0),d([g.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}})],l.prototype,"minScale",void 0),d([g.reader("service","minScale",["minScale","effectiveMinScale"])],l.prototype,"readMinScale",null),d([g.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}})],l.prototype,"maxScale",
void 0),d([g.reader("service","maxScale",["maxScale","effectiveMaxScale"])],l.prototype,"readMaxScale",null),d([g.property({type:String})],l.prototype,"objectIdField",void 0),d([g.reader("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),g.reader("service","objectIdField",["objectIdField","fields"])],l.prototype,"readObjectIdFieldFromService",null),d([g.property()],l.prototype,"operationalLayerType",void 0),d([g.property({dependsOn:["requiredFields"]})],l.prototype,"outFields",
null),d([g.property({readOnly:!0,dependsOn:["layerId"]})],l.prototype,"parsedUrl",null),d([g.property({type:Boolean,json:{write:{target:"disablePopup"}}})],l.prototype,"popupEnabled",void 0),d([g.reader("popupEnabled",["disablePopup"])],l.prototype,"readPopupEnabled",null),d([g.writer("popupEnabled")],l.prototype,"writePopupEnabled",null),d([g.property({type:a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],l.prototype,"popupTemplate",void 0),d([g.property({type:ha})],l.prototype,"processing",
void 0),d([g.property({readOnly:!0})],l.prototype,"relationships",void 0),d([g.property({types:H.types,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}}},write:{target:"layerDefinition.drawingInfo.renderer"}}})],l.prototype,"renderer",null),d([g.reader("service","renderer",["drawingInfo.renderer","defaultSymbol","type"]),g.reader("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol","layerDefinition.type"])],l.prototype,"readRenderer",null),d([g.property({readOnly:!0,
dependsOn:["allRenderers","labelingInfo","elevationInfo.featureExpressionInfo","popupTemplate.requiredFields"]})],l.prototype,"requiredFields",null),d([g.property({type:Boolean})],l.prototype,"returnM",void 0),d([g.property({type:Boolean})],l.prototype,"returnZ",void 0),d([g.property(wa.screenSizePerspectiveEnabled)],l.prototype,"screenSizePerspectiveEnabled",void 0),d([g.property()],l.prototype,"source",null),d([g.cast("source")],l.prototype,"castSource",null),d([g.reader("portal-item","source",
["featureSet"]),g.reader("web-map","source",["featureSet"])],l.prototype,"readSource",null),d([g.property({readOnly:!0,json:{origins:{service:{read:{source:"definitionExpression"}}}}})],l.prototype,"serviceDefinitionExpression",void 0),d([g.property({type:B,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],l.prototype,"spatialReference",void 0),d([g.property({type:[ca]})],l.prototype,"templates",void 0),d([g.reader("templates",
["editFieldsInfo","creatorField","editorField","templates"])],l.prototype,"readTemplates",null),d([g.property()],l.prototype,"timeInfo",void 0),d([g.property()],l.prototype,"title",void 0),d([g.reader("service","title",["name"]),g.reader("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],l.prototype,"readTitle",null),d([g.reader("web-map","title",["layerDefinition.name","title"])],l.prototype,"readTitleFromWebMap",null),d([g.property({type:String})],l.prototype,"sublayerTitleMode",
void 0),d([g.property({type:String,readOnly:!0,json:{read:{source:"timeInfo.trackIdField"}}})],l.prototype,"trackIdField",void 0),d([g.property({json:{read:!1}})],l.prototype,"type",void 0),d([g.property({type:String,readOnly:!0})],l.prototype,"typeIdField",void 0),d([g.reader("service","typeIdField"),g.reader("typeIdField",["layerDefinition.typeIdField"])],l.prototype,"readTypeIdField",null),d([g.property({type:[ea]})],l.prototype,"types",void 0),d([g.reader("service","types",["types"]),g.reader("types",
["layerDefinition.types"])],l.prototype,"readTypes",null),d([g.property({type:String})],l.prototype,"url",null),d([g.writer("url")],l.prototype,"writeUrl",null),d([g.property({readOnly:!0})],l.prototype,"userIsAdmin",void 0),d([g.property({json:{origins:{"portal-item":{read:!1}}}})],l.prototype,"version",void 0),d([g.reader("service","version","currentVersion capabilities drawingInfo hasAttachments htmlPopupType relationships timeInfo typeIdField types".split(" ")),g.reader("version","layerDefinition.currentVersion layerDefinition.capabilities layerDefinition.drawingInfo layerDefinition.hasAttachments layerDefinition.htmlPopupType layerDefinition.typeIdField layerDefinition.types".split(" "))],
l.prototype,"readVersion",null),d([g.property({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],l.prototype,"visible",void 0),d([g.reader("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],l.prototype,"readVisible",null),d([b(0,g.cast(W))],l.prototype,"queryFeatures",null),d([b(0,g.cast(W))],l.prototype,"queryObjectIds",null),d([b(0,g.cast(W))],l.prototype,"queryFeatureCount",null),d([b(0,g.cast(W))],l.prototype,"queryExtent",
null),l=d([g.subclass("esri.layers.FeatureLayer")],l)}(g.declared(E,p,A,K,U,V,c))})},"esri/renderers/SimpleRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/lang ../symbols/support/jsonUtils ../symbols/support/typeUtils ./Renderer".split(" "),function(m,l,h,d,b,g,k,f,a){return function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;return b.description=null,b.label=null,b.symbol=
null,b.type="simple",b}return h(c,a),e=c,c.prototype.writeSymbolWebScene=function(a,b,c,d){k.writeTarget(a,b,c,d)},c.prototype.writeSymbol=function(a,b,c,d){k.writeTarget(a,b,c,d)},c.prototype.readSymbol=function(a,b,c){return k.read(a,b,c)},c.prototype.getSymbol=function(a,b){return this.symbol},c.prototype.getSymbols=function(){return this.symbol?[this.symbol]:[]},c.prototype.clone=function(){return new e({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:g.clone(this.visualVariables),
authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})},d([b.property({type:String,json:{write:!0}})],c.prototype,"description",void 0),d([b.property({type:String,json:{write:!0}})],c.prototype,"label",void 0),d([b.property({types:f.types})],c.prototype,"symbol",void 0),d([b.writer("web-scene","symbol",{symbol:{types:f.types3D}})],c.prototype,"writeSymbolWebScene",null),d([b.writer("symbol")],c.prototype,"writeSymbol",null),d([b.reader("symbol")],c.prototype,"readSymbol",null),c=e=d([b.subclass("esri.renderers.SimpleRenderer")],
c);var e}(b.declared(a))})},"esri/renderers/support/jsonUtils":function(){define(["../../core/Warning","../SimpleRenderer","../UniqueValueRenderer","../ClassBreaksRenderer"],function(m,l,h,d){var b={simple:l,uniqueValue:h,classBreaks:d},g={fromJson:function(b){try{throw Error("fromJson is deprecated, use fromJSON instead");}catch(f){console.warn(f.stack)}return g.fromJSON(b)},read:function(d,f,a){return d&&(d.styleName||d.styleUrl)&&"uniqueValue"!==d.type?(a&&a.messages&&a.messages.push(new m("renderer:unsupported",
"Only UniqueValueRenderer can be referenced from a web style, but found '"+d.type+"'",{definition:d,context:a})),null):(f=d?b[d.type]||null:null)?(f=new f,f.read(d,a),f):(a&&a.messages&&d&&a.messages.push(new m("renderer:unsupported","Renderers of type '"+(d.type||"unknown")+"' are not supported",{definition:d,context:a})),null)},fromJSON:function(d){var f=d?b[d.type]||null:null;return f?f.fromJSON(d):null}};return g})},"esri/renderers/ClassBreaksRenderer":function(){define("../core/declare ../core/lang ../core/kebabDictionary ../core/Error ../core/Logger ../core/accessorSupport/ensureType dojo/_base/lang ../support/arcadeUtils ../symbols/Symbol ../symbols/PolygonSymbol3D ../symbols/support/jsonUtils ../symbols/support/typeUtils ./Renderer ./support/LegendOptions ./support/ClassBreakInfo".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){var v=b.getLogger("esri.renderers.ClassBreaksRenderer");r=r.LegendOptions;u=u.ClassBreakInfo;var x=h({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),y=h({esriClassifyNaturalBreaks:"natural-breaks",esriClassifyEqualInterval:"equal-interval",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyGeometricalInterval:"geometrical-interval"}),n=g.ensureType(u),w=m(t,
{declaredClass:"esri.renderers.ClassBreaksRenderer",properties:{backgroundFillSymbol:{types:{base:a,key:"type",typeMap:{"simple-fill":q.types.typeMap["simple-fill"],"picture-fill":q.types.typeMap["picture-fill"],"polygon-3d":q.types.typeMap["polygon-3d"]}},value:null,json:{origins:{"web-scene":{read:c.read,write:{target:{backgroundFillSymbol:{type:e}},writer:c.writeTarget}}},read:c.read,write:c.writeTarget}},classBreakInfos:{type:[u],json:{read:function(a,b,c){if(Array.isArray(a)){var d=b.minValue;
return a.map(function(a){var b=new u;return b.read(a,c),null==b.minValue&&(b.minValue=d),null==b.maxValue&&(b.maxValue=b.minValue),d=b.maxValue,b})}},write:function(a,b,c,d){a=a.map(function(a){return a.write({},d)});this._areClassBreaksConsecutive()&&a.forEach(function(a){delete a.classMinValue});b[c]=a}}},minValue:{type:Number,readOnly:!0,dependsOn:["classBreakInfos"],get:function(){return this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0},json:{read:!1,write:{overridePolicy:function(){return 0!==
this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}},classificationMethod:{type:String,value:null,json:{read:y.fromJSON,write:function(a,b){(a=y.toJSON(a))&&(b.classificationMethod=a)}}},defaultLabel:{type:String,value:null,json:{write:!0}},defaultSymbol:{types:q.types,value:null,json:{origins:{"web-scene":{read:c.read,write:{target:{defaultSymbol:{types:q.types3D}},writer:c.writeTarget}}},read:c.read,write:c.writeTarget}},valueExpression:{type:String,value:null,
json:{write:!0}},valueExpressionTitle:{type:String,value:null,json:{write:!0}},compiledFunc:{dependsOn:["valueExpression"],get:function(){return f.createFunction(this.valueExpression)}},legendOptions:{type:r,value:null,json:{write:!0}},field:{value:null,cast:function(a){return null==a?a:"function"==typeof a?a:g.ensureString(a)},json:{type:String,write:function(a,b,c,e){"string"==typeof a?b[c]=a:e&&e.messages?e.messages.push(new d("property:unsupported","ClassBreaksRenderer.field set to a function cannot be written to JSON")):
v.error(".field: cannot write field to JSON since it's not a string value")}}},isMaxInclusive:!0,normalizationField:{type:String,value:null,json:{write:!0}},normalizationTotal:{type:Number,value:null,json:{write:!0}},normalizationType:{type:String,value:null,dependsOn:["normalizationField","normalizationTotal"],get:function(){var a=this._get("normalizationType"),b=!!this.normalizationField,c=null!=this.normalizationTotal;return b||c?(a=b&&"field"||c&&"percent-of-total",b&&c&&console.warn("warning: both normalizationField and normalizationTotal are set!")):
("field"===a||"percent-of-total"===a)&&(a=null),a},json:{read:x.fromJSON,write:function(a,b){(a=x.toJSON(a))&&(b.normalizationType=a)}}},requiredFields:{dependsOn:["field","normalizationField","valueExpression"]},type:{value:"class-breaks",json:{write:function(a,b){b.type="classBreaks"}}}},constructor:function(){this.classBreakInfos=[]},addClassBreakInfo:function(a,b,c){a="number"==typeof a?new u({minValue:a,maxValue:b,symbol:c}):n(l.clone(a));this.classBreakInfos.push(a);1===this.classBreakInfos.length&&
this.notifyChange("minValue")},removeClassBreakInfo:function(a,b){var c,d,e=this.classBreakInfos.length;for(d=0;e>d;d++)if(c=[this.classBreakInfos[d].minValue,this.classBreakInfos[d].maxValue],c[0]==a&&c[1]==b){this.classBreakInfos.splice(d,1);break}},getBreakIndex:function(a,b){var c,d,e=this.field;c=a.attributes;var g=this.classBreakInfos.length,h=this.isMaxInclusive;if(this.valueExpression)a=f.executeFunction(this.compiledFunc,f.createExecContext(a,f.getViewInfo(b)));else if(k.isFunction(e))a=
e(a);else if(a=parseFloat(c[e]),e=this.normalizationType)if(b=parseFloat(this.normalizationTotal),c=parseFloat(c[this.normalizationField]),"log"===e)a=Math.log(a)*Math.LOG10E;else if("percent-of-total"!==e||isNaN(b)){if("field"===e&&!isNaN(c)){if(isNaN(a)||isNaN(c))return-1;a/=c}}else a=a/b*100;if(null!=a&&!isNaN(a)&&"number"==typeof a)for(c=0;g>c;c++)if(d=[this.classBreakInfos[c].minValue,this.classBreakInfos[c].maxValue],d[0]<=a&&(h?a<=d[1]:a<d[1]))return c;return-1},getClassBreakInfo:function(a,
b){a=this.getBreakIndex(a,b);return-1!==a?this.classBreakInfos[a]:null},getSymbol:function(a,b){a=this.getBreakIndex(a,b);return-1<a?this.classBreakInfos[a].symbol:this.defaultSymbol},getSymbols:function(){var a=[];return this.classBreakInfos.forEach(function(b){b.symbol&&a.push(b.symbol)}),this.defaultSymbol&&a.push(this.defaultSymbol),a},clone:function(){return new w({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),classificationMethod:this.classificationMethod,
defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:l.clone(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:l.clone(this.visualVariables),legendOptions:l.clone(this.legendOptions),authoringInfo:this.authoringInfo&&
this.authoringInfo.clone()})},collectRequiredFields:function(a){this.inherited(arguments);[this.field,this.normalizationField].forEach(function(b){b&&(a[b]=!0)});this.valueExpression&&f.extractFieldNames(this.valueExpression).forEach(function(b){a[b]=!0})},_areClassBreaksConsecutive:function(){for(var a=this.classBreakInfos,b=1;b<a.length;b++)if(a[b-1].maxValue!==a[b].minValue)return!1;return!0}});return w})},"esri/renderers/support/ClassBreakInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport ../../symbols/support/typeUtils ../../symbols/support/jsonUtils".split(" "),
function(m,l,h,d,b,g,k,f){Object.defineProperty(l,"__esModule",{value:!0});m=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;return b.description=null,b.label=null,b.minValue=null,b.maxValue=0,b.symbol=null,b}return h(e,a),c=e,e.prototype.clone=function(){return new c({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})},d([b.property({type:String,json:{write:!0}})],e.prototype,"description",
void 0),d([b.property({type:String,json:{write:!0}})],e.prototype,"label",void 0),d([b.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],e.prototype,"minValue",void 0),d([b.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],e.prototype,"maxValue",void 0),d([b.property({types:k.types,json:{origins:{"web-scene":{read:f.read,write:{target:{symbol:{types:k.types3D}},writer:f.writeTarget}}},read:f.read,write:f.writeTarget}})],
e.prototype,"symbol",void 0),e=c=d([b.subclass("esri.renderers.support.ClassBreakInfo")],e);var c}(b.declared(g));l.ClassBreakInfo=m;l["default"]=m})},"esri/renderers/support/typeUtils":function(){define("require exports ../Renderer ../SimpleRenderer ../UniqueValueRenderer ../ClassBreaksRenderer".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});l.types={key:"type",base:h,typeMap:{simple:d,"unique-value":b,"class-breaks":g}}})},"esri/layers/graphics/sources/MemorySource":function(){define("../../../core/Collection ../../../core/Promise ../../../core/promiseUtils ../../../core/Error ../../../tasks/support/FeatureSet ../../../Graphic ../QueryEngine".split(" "),
function(m,l,h,d,b,g,k){return m.ofType(g).createSubclass([l],{properties:{layer:{value:null},_queryEngine:{value:null,dependsOn:["layer.loaded"],get:function(){return this.get("layer.loaded")?new k({features:this,objectIdField:this.layer.objectIdField}):null}}},queryFeatures:function(d){return this._queryEngine?this._queryEngine.queryFeatures(d).then(function(a){var d=new b;return d.features=a,d}):this._rejectQuery("Not ready to execute query")},queryObjectIds:function(b){return this._queryEngine?
this._queryEngine.queryObjectIds(b):this._rejectQuery("Not ready to execute query")},queryFeatureCount:function(b){return this._queryEngine?this._queryEngine.queryFeatureCount(b):this._rejectQuery("Not ready to execute query")},queryExtent:function(b){return this._queryEngine?this._queryEngine.queryExtent(b):this._rejectQuery("Not ready to execute query")},_rejectQuery:function(b){return h.reject(new d("MemorySource",b))}})})},"esri/layers/support/FeatureProcessing":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/lang ../../layers/support/Field".split(" "),
function(m,l,h,d,b,g,k,f){return function(a){function e(){return null!==a&&a.apply(this,arguments)||this}return h(e,a),c=e,e.fromWorker=function(a){if(!a)return null;var b=new c;return b.fields=a.fields&&a.fields.map(function(a){return f.fromJSON(a)}),b.options=a.options,b.process=new (Function.bind.apply(Function,[void 0].concat(a.process.args,[a.process.body]))),b},e.prototype.clone=function(){return new c(k.clone({fields:this.fields,options:this.options,process:this.process}))},e.prototype.toWorker=
function(){var a=this.process.toString();return{fields:this.fields,options:this.options,process:{body:a.substring(a.indexOf("{")+1,a.lastIndexOf("}")),args:a.slice(a.indexOf("(")+1,a.indexOf(")")).match(/([^\s,]+)/g)}}},d([b.property({type:[f]})],e.prototype,"fields",void 0),d([b.property()],e.prototype,"options",void 0),d([b.property()],e.prototype,"process",void 0),e=c=d([b.subclass("esri.layers.support.FeatureProcessing")],e);var c}(b.declared(g))})},"esri/layers/support/FeatureTemplate":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport ../../core/kebabDictionary ../../core/lang".split(" "),
function(m,l,h,d,b,g,k,f){var a=k({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",
esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});return function(e){function c(a){a=e.call(this,a)||this;return a.name=null,a.description=null,a.drawingTool=null,a.prototype=null,a.thumbnail=null,a}return h(c,e),c.prototype.writeDrawingTool=function(b,c){c.drawingTool=a.toJSON(b)},c.prototype.writePrototype=function(a,b){b.prototype=f.fixJson(f.clone(a),!0)},c.prototype.writeThumbnail=function(a,b){b.thumbnail=f.fixJson(f.clone(a))},d([b.property({json:{write:!0}})],
c.prototype,"name",void 0),d([b.property({json:{write:!0}})],c.prototype,"description",void 0),d([b.property({json:{read:a.fromJSON,write:!0}})],c.prototype,"drawingTool",void 0),d([b.writer("drawingTool")],c.prototype,"writeDrawingTool",null),d([b.property({json:{write:!0}})],c.prototype,"prototype",void 0),d([b.writer("prototype")],c.prototype,"writePrototype",null),d([b.property({json:{write:!0}})],c.prototype,"thumbnail",void 0),d([b.writer("thumbnail")],c.prototype,"writeThumbnail",null),c=d([b.subclass("esri.layers.support.FeatureTemplate")],
c)}(b.declared(g))})},"esri/layers/support/FeatureType":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport ./domains ./FeatureTemplate ../../core/lang".split(" "),function(m,l,h,d,b,g,k,f,a){return function(e){function c(a){a=e.call(this,a)||this;return a.id=null,a.name=null,a.domains=null,a.templates=null,a}return h(c,e),c.prototype.readDomains=function(a){var b={},c;for(c in a)if(a.hasOwnProperty(c)){var d=
a[c];switch(d.type){case "range":b[c]=k.RangeDomain.fromJSON(d);break;case "codedValue":b[c]=k.CodedValueDomain.fromJSON(d);break;case "inherited":b[c]=k.InheritedDomain.fromJSON(d)}}return b},c.prototype.writeDomains=function(b,c){var d={},e;for(e in b)b.hasOwnProperty(e)&&(d[e]=b[e]&&b[e].toJSON());a.fixJson(d);c.domains=d},c.prototype.readTemplates=function(a){return a&&a.map(function(a){return new f(a)})},c.prototype.writeTemplates=function(a,b){b.templates=a&&a.map(function(a){return a.toJSON()})},
d([b.property({json:{write:!0}})],c.prototype,"id",void 0),d([b.property({json:{write:!0}})],c.prototype,"name",void 0),d([b.property({json:{write:!0}})],c.prototype,"domains",void 0),d([b.reader("domains")],c.prototype,"readDomains",null),d([b.writer("domains")],c.prototype,"writeDomains",null),d([b.property({json:{write:!0}})],c.prototype,"templates",void 0),d([b.reader("templates")],c.prototype,"readTemplates",null),d([b.writer("templates")],c.prototype,"writeTemplates",null),c=d([b.subclass("esri.layers.support.FeatureType")],
c)}(b.declared(g))})},"esri/layers/support/FeatureReduction":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/JSONSupport".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;return a.type=null,a}return h(f,g),d([b.property({type:String,readOnly:!0,json:{read:!1,write:!0}})],f.prototype,
"type",void 0),f=d([b.subclass("esri.layers.support.FeatureReduction")],f)}(b.declared(g));l.FeatureReduction=m;m=function(g){function f(){var a=null!==g&&g.apply(this,arguments)||this;return a.type="selection",a}return h(f,g),d([b.property()],f.prototype,"type",void 0),f=d([b.subclass("esri.layers.support.FeatureReductionSelection")],f)}(b.declared(m));l.FeatureReductionSelection=m})},"esri/layers/support/LabelClass":function(){define("../../core/date ../../core/JSONSupport ../../core/lang ../../core/kebabDictionary dojo/_base/lang dojo/number ./types ../../support/arcadeUtils ../../symbols/support/jsonUtils ../../symbols/support/typeUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e){function c(a){a=(a=f.createSyntaxTree(a))&&a.body&&a.body[0]&&a.body[0].body&&a.body[0].body.body;if(!a||1!==a.length)return null;a="ExpressionStatement"===a[0].type&&a[0].expression;if(!a||"MemberExpression"!==a.type)return null;var b=a.object;if(!b||"Identifier"!==b.type||"$feature"!==b.name)return null;a=a.property;if(!a)return null;switch(a.type){case "Literal":return a.value;case "Identifier":return a.name}return null}function q(a){return a?"service"===a.origin?
!1:!a.layer||!k.isOfType(a.layer,"map-image"):!0}var t=/__begin__/ig,r=/__end__/ig,u=/^__begin__/i,v=/__end__$/i,x=d({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",
esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",
esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"}),y=l.createSubclass({declaredClass:"esri.layers.support.LabelClass",properties:{name:{type:String,value:null,json:{write:!0}},labelExpression:{type:String,value:null,json:{read:function(a,b,
c,d){b=b.labelExpressionInfo;if(!b||!b.value&&!b.expression)return a},write:{allowNull:!0,writer:function(a,b,d,e){this.labelExpressionInfo&&q(e)&&(null!=this.labelExpressionInfo.value?a=this._templateStringToSql(this.labelExpressionInfo.value):null!=this.labelExpressionInfo.expression&&(e=c(this.labelExpressionInfo.expression))&&(a="["+e+"]"));null!=a&&(b[d]=a)}}}},labelExpressionInfo:{value:null,json:{read:function(a,c,d,e){return a&&a.value&&(a=b.mixin(b.clone(a),{expression:this._convertTemplatedStringToArcade(a.value)}),
delete a.value),a},write:{target:{"labelExpressionInfo.expression":{type:String}},overridePolicy:function(a,b,c){return q(c)?{allowNull:!0}:{enabled:!1}},writer:function(a,c,d,e){if(null==a&&null!=this.labelExpression&&q(e))a={expression:this.getLabelExpressionArcade()};else{if(!a)return;a=h.fixJson(b.clone(a))}null!=a.value&&(a.expression=this._convertTemplatedStringToArcade(a.value));a.expression&&(delete a.value,c[d]=a)}}}},labelPlacement:{type:String,value:null,json:{read:function(a,b){return x.fromJSON(a)},
write:function(a,b){(a=x.toJSON(a))&&(b.labelPlacement=a)}}},maxScale:{type:Number,value:0,json:{write:function(a,b){(a||this.minScale)&&(b.maxScale=a)}}},minScale:{type:Number,value:0,json:{write:function(a,b){(a||this.maxScale)&&(b.minScale=a)}}},requiredFields:{readOnly:!0,dependsOn:["labelExpression","labelExpressionInfo","where"],get:function(){var a=Object.create(null);return this._collectRequiredFields(a),Object.keys(a)}},symbol:{value:null,types:e.types,json:{origins:{"web-scene":{read:a.read,
write:{target:{symbol:{types:e.types3D}},writer:a.writeTarget}}},read:a.read,write:a.writeTarget}},useCodedValues:{type:Boolean,value:null,json:{write:!0}},where:{type:String,value:null,json:{write:!0}}},getLabelExpression:function(){var a={expression:"",type:"none"};return this.labelExpressionInfo?this.labelExpressionInfo.value?(a.expression=this.labelExpressionInfo.value,a.type="conventional"):this.labelExpressionInfo.expression&&(a.expression=this.labelExpressionInfo.expression,a.type="arcade"):
null!=this.labelExpression&&(a.expression=this._sqlToTemplateString(this.labelExpression),a.type="conventional"),a},getLabelExpressionArcade:function(){var a=this.getLabelExpression();if(!a)return null;switch(a.type){case "conventional":return this._convertTemplatedStringToArcade(a.expression);case "arcade":return a.expression}return null},getOptions:function(){var a={},b=this.labelExpressionInfo;if(b){var c=b.expression;c&&!b.value&&(a.hasArcadeExpression=!0,a.compiledArcadeFunc=f.createFunction(c))}return a},
getLabelExpressionSingleField:function(){var a=this.getLabelExpression();if(!a)return null;switch(a.type){case "conventional":return(a=a.expression.match(n))&&a[1].trim()||null;case "arcade":return c(a.expression)}return null},clone:function(){return new y({labelExpression:this.labelExpression,labelExpressionInfo:b.clone(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:this.symbol.clone(),where:this.where,useCodedValues:this.useCodedValues})},
_collectRequiredFields:function(a){this._collectLabelExpressionRequiredFields(this.getLabelExpression(),a);this._collectWhereRequiredFields(this.where,a)},_sqlToTemplateString:function(a){return a.replace(/\[/g,"{").replace(/\]/g,"}")},_templateStringToSql:function(a){return a.replace(/\{/g,"[").replace(/\}/g,"]")},_collectWhereRequiredFields:function(a,b){null!=a&&(a=a.split(" "),3===a.length&&(b[a[0]]=!0),7===a.length&&(b[a[0]]=!0,b[a[4]]=!0))},_collectLabelExpressionRequiredFields:function(a,b){"arcade"===
a.type?f.extractFieldNames(a.expression).forEach(function(a){b[a]=!0}):(a=a.expression.match(/{[^}]*}/g))&&a.forEach(function(a){b[a.slice(1,-1)]=!0})},_convertTemplatedStringToArcade:function(a){var c;return a?(c=b.replace(a,function(a,b){return'__begin__$feature["'+b+'"]__end__'}),c=u.test(c)?c.replace(u,""):'"'+c,c=v.test(c)?c.replace(v,""):c+'"',c=c.replace(t,'" + ').replace(r,' + "')):c='""',c}});y.evaluateWhere=function(a,b){var c=function(a,b,c){switch(b){case "\x3d":return a==c?!0:!1;case "\x3c\x3e":return a!=
c?!0:!1;case "\x3e":return a>c?!0:!1;case "\x3e\x3d":return a>=c?!0:!1;case "\x3c":return c>a?!0:!1;case "\x3c\x3d":return c>=a?!0:!1}return!1};try{if(null==a)return!0;var d=a.split(" ");if(3===d.length)return c(b[d[0]],d[1],d[2]);if(7===d.length){var e=c(b[d[0]],d[1],d[2]),f=d[3],g=c(b[d[4]],d[5],d[6]);switch(f){case "AND":return e&&g;case "OR":return e||g}}return!1}catch(M){console.log("Error.: can't parse \x3d "+a)}};y.buildLabelText=function(a,b,c,d){var e="";if(d&&d.hasArcadeExpression)d.compiledArcadeFunc&&
(a=f.createExecContext(b),a=f.executeFunction(d.compiledArcadeFunc,a),null!=a&&(e=a.toString()));else var g=b&&b.attributes||{},e=a.replace(/{[^}]*}/g,function(a){return y.formatField(a.slice(1,-1),a,g,c,d)});return e};y.formatField=function(a,c,d,e,f){var k=a.toLowerCase();for(a=0;a<e.length;a++)if(e[a].name.toLowerCase()===k){c=d[e[a].name];var l=e[a].domain;if(l&&b.isObject(l)){if("codedValue"==l.type)for(d=0;d<l.codedValues.length;d++)l.codedValues[d].code==c&&(c=l.codedValues[d].name);else"range"==
l.type&&l.minValue<=c&&c<=l.maxValue&&(c=l.name);break}l=e[a].type;"date"==l?(l=m.fromJSON(f&&f.dateFormat||"shortDate"),(l="DateFormat"+m.getFormat(l))&&(c=h.substitute({myKey:c},"{myKey:"+l+"}"))):("integer"==l||"small-integer"==l||"long"==l||"double"==l)&&f&&f.numberFormat&&f.numberFormat.digitSeparator&&f.numberFormat.places&&(c=g.format(c,{places:f.numberFormat.places}))}return null==c?"":c};var n=/^\s*\{([^}]+)\}\s*$/i;return y})},"esri/layers/support/labelingInfo":function(){define(["require",
"exports","./LabelClass"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});var d=/\[([^\[\]]+)\]/gi;l.reader=function(b,g,k){var f=this;return b?b.map(function(a){var b=new h;if(b.read(a,k),b.labelExpression){var c=g.fields||g.layerDefinition&&g.layerDefinition.fields||f.fields;b.labelExpression=b.labelExpression.replace(d,function(a,b){a:if(c){a=b.toLowerCase();for(var d=0;d<c.length;d++){var e=c[d].name;if(e.toLowerCase()===a){b=e;break a}}}return"["+b+"]"})}return b}):null}})},
"esri/layers/support/commonProperties":function(){define(["require","exports","../../core/accessorSupport/write","../../core/accessorSupport/utils","../../core/accessorSupport/PropertyOrigin"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});l.screenSizePerspectiveEnabled={type:Boolean,value:!0,json:{origins:{"web-scene":{read:{source:["id","url","layerType"],reader:function(g,h){return null==h.screenSizePerspective&&"defaults"===this.originOf("screenSizePerspectiveEnabled")?void d.getProperties(this).store.set("screenSizePerspectiveEnabled",
!1,b.OriginId.DEFAULTS):h.screenSizePerspective}},write:{ignoreOrigin:!0,target:"screenSizePerspective",writer:function(b,d,f,a){"defaults"===this.originOf("screenSizePerspectiveEnabled")&&b?d[f]=b:h.willPropertyWrite(this,"screenSizePerspectiveEnabled",{},a)&&(d[f]=b)}}}}}}})},"esri/views/3d/layers/graphics/Graphics3DElevationAlignment":function(){define(["require","exports","../../../../core/throttle","../../support/aaBoundingRect"],function(m,l,h,d){return function(){function b(){this.dirtyExtent=
d.create(d.NEGATIVE_INFINITY);this.numPendingSpatialIndexQueries=0;this.elevationDirtyGraphicsQueue=[];this.elevationDirtyGraphicsSet={};this.elevationUpdateEventHandle=null;this.eventHandles=[];this.updateElevation=!1;this.graphicsCore=this.layerView=null;this.markDirtyThrottled=h.throttle(this.markDirty,100,this)}return b.prototype.initialize=function(b,d,f,a){var e=this;this.layerView=b;this.graphicsCore=f;this.elevationProvider=a;this.getGraphicsInExtent=d;this.elevationUpdateEventHandle=a.on("elevation-change",
function(a){return e.elevationUpdateHandler(a)});this.eventHandles.push(this.layerView.watch("suspended",function(){return e.suspendedChange()}))},b.prototype.destroy=function(){this.elevationDirtyGraphicsSet=this.elevationDirtyGraphicsQueue=null;this.elevationUpdateEventHandle&&(this.elevationUpdateEventHandle.remove(),this.elevationUpdateEventHandle=null);this.eventHandles.forEach(function(b){return b.remove()});this.eventHandles=null;this.markDirtyThrottled.remove();this.getGraphicsInExtent=this.graphicsCore=
this.layerView=null},b.prototype.clear=function(){this.elevationDirtyGraphicsSet={};this.elevationDirtyGraphicsQueue=[]},b.prototype.suspendedChange=function(){!0===this.layerView.suspended?this.updateElevation=!1:!1===this.layerView.suspended&&this.updateElevation&&this.markAllGraphicsElevationDirty()},b.prototype.isUpdating=function(){return 0<this.elevationDirtyGraphicsQueue.length||this.markDirtyThrottled.hasPendingUpdates()||0<this.numPendingSpatialIndexQueries},b.prototype.numNodesUpdating=
function(){return this.elevationDirtyGraphicsQueue.length},b.prototype.needsIdleUpdate=function(){return this.elevationProvider&&0<this.elevationDirtyGraphicsQueue.length},b.prototype.idleUpdate=function(b){if(!b.done()){var d=this.layerView.view,f=this.elevationDirtyGraphicsQueue.length;if(0<f){for(var a=this.graphicsCore.stageLayer.getId(),e=this.graphicsCore.labelStageLayer?this.graphicsCore.labelStageLayer.getId():null,c=0,g=0,g=0;f>g;g++){var h=this.elevationDirtyGraphicsQueue[g],l=this.graphicsCore.graphics[h];
if(l&&l.alignWithElevation(this.elevationProvider,d.renderCoordsHelper),delete this.elevationDirtyGraphicsSet[h],c++,20<=c){if(d._stage.processDirtyLayer(a),null!=e&&d._stage.processDirtyLayer(e),b.done())break;c=0}}d._stage.processDirtyLayer(a);null!=e&&d._stage.processDirtyLayer(e);this.elevationDirtyGraphicsQueue.splice(0,g+1);d.deconflictor.setDirty();this.layerView._evaluateUpdatingState()}}},b.prototype.markAllGraphicsElevationDirty=function(){for(var b in this.graphicsCore.graphics)this.markGraphicElevationDirty(this.graphicsCore.graphics[b].graphic.uid);
this.layerView._evaluateUpdatingState()},b.prototype.markGraphicElevationDirty=function(b){this.elevationDirtyGraphicsSet[b]||(this.elevationDirtyGraphicsSet[b]=!0,this.elevationDirtyGraphicsQueue.push(b))},b.prototype.elevationUpdateHandler=function(b){var g=b.extent;this.layerView.suspended?this.updateElevation||(b=this.graphicsCore.computedExtent)&&g[2]>b.xmin&&g[0]<b.xmax&&g[3]>b.ymin&&g[1]<b.ymax&&(this.updateElevation=!0):(d.expand(this.dirtyExtent,g),this.spatialReference=b.spatialReference,
this.markDirtyThrottled(),this.layerView._evaluateUpdatingState())},b.prototype.markDirty=function(){var b=this,h=this.dirtyExtent;h[0]===-(1/0)?this.markAllGraphicsElevationDirty():(this.numPendingSpatialIndexQueries++,this.getGraphicsInExtent(h,this.spatialReference,function(d,a){b.numPendingSpatialIndexQueries--;for(var e=0;a>e;e++){var c=d[e],f=b.graphicsCore.graphics[c];f&&f.needsElevationUpdates()&&b.markGraphicElevationDirty(c)}b.layerView._evaluateUpdatingState()}),this.layerView._evaluateUpdatingState());
d.set(this.dirtyExtent,d.NEGATIVE_INFINITY)},b}()})},"esri/views/ui/3d/DefaultUI3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI dojo/_base/lang".split(" "),function(m,l,h,d,b,g,k){return function(f){function a(){return f.call(this)||this}return h(a,f),a.prototype.getDefaults=function(){return k.mixin(this.inherited(arguments),{components:["attribution","zoom","navigation-toggle",
"compass"]})},a=d([b.subclass("esri.views.ui.3d.DefaultUI3D")],a)}(b.declared(g))})},"esri/layers/graphics/controllers/I3SOnDemandController":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/promise/all dojo/errors/CancelError dojo/has dojo/_base/lang ../../../views/3d/support/ResourceController ../../../core/sql/WhereClause ../../../views/3d/layers/SceneLayerView3D ../../../views/3d/layers/i3s/I3SNodeLoader ../../../views/3d/layers/i3s/I3SIndexTraversal ../../../views/3d/layers/i3s/I3SUtil ../../../views/3d/layers/i3s/I3SLodHandling ../../../views/3d/layers/i3s/I3SViewportQueries ../../../views/3d/layers/i3s/IdleQueue ../../../views/3d/layers/i3s/GoogPriorityQueue ../../../layers/SceneLayer ../../../layers/IntegratedMeshLayer ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/Evented ../../../core/Promise ../../../core/Logger ../../../core/promiseUtils ../../../core/watchUtils ../../../core/HandleRegistry ../../../views/3d/support/PromiseLightweight ../../../views/3d/support/projectionUtils ../../../views/3d/lib/glMatrix".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P,Q,T){function O(a,b){b=b.toLowerCase();for(var c=0;c<a.length;c++)if(a[c].name.toLowerCase()===b)return c;return-1}var S=G.getLogger("esri.layers.graphics.controllers.I3SOnDemandController");m=function(l){function m(a){a=l.call(this)||this;return a.nodeIndex={},a.screenSizeFactor=0,a.updating=!0,a.updatingPercentage=0,a._lodFactorProperty=null,a._isIdle=!1,a._alwaysLoadEverythingModeEnabled=!1,a._uncompressedTextureDownsamplingEnabled=
!1,a._computedMbs={},a._nodeQueue=null,a.maxQueueLevel=0,a._numNodesLoading=0,a._numAttributesLoading=0,a._progressMaxNumNodes=1,a._poi=null,a._requiredAttributesDirty=!0,a._updatesDisabled=!1,a.disableCache=!1,a._restartNodeLoading=!1,a._fields=null,a._attributeStorageInfo=null,a._handles=new R,a._idleQueue=new x.IdleQueue,a}return h(m,l),Object.defineProperty(m.prototype,"isMeshPyramid",{get:function(){return"mesh-pyramids"===this.layer.profile||"MeshPyramid"===this.layer.store.lodType},enumerable:!0,
configurable:!0}),Object.defineProperty(m.prototype,"streamDataSupplier",{get:function(){return this.layerView.view.resourceController.registerClient(this.layerView,a.ClientType.SCENE,{trackRequests:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"parsedDefinitionExpression",{get:function(){if(!(this.layer instanceof n&&this.layer.definitionExpression))return null;try{var a=e.create(this.layer.definitionExpression);if(!a.isStandardized())return S.error("definitionExpression is using non standard function"),
null;var b=[],c=a.getFields();return r.findFieldsCaseInsensitive(c,this.layer.fields,{missingFields:b}),0<b.length?(S.error("definitionExpression references unknown fields: "+b.join(", ")),null):a}catch(U){return S.error("Failed to parse definitionExpression: "+U),null}},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"definitionExpressionFields",{get:function(){if(this.parsedDefinitionExpression){var a=this.parsedDefinitionExpression.getFields();return r.findFieldsCaseInsensitive(a,
this._fields)}return null},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"crsVertex",{get:function(){return r.getVertexCrs(this.layer)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"crsIndex",{get:function(){return r.getIndexCrs(this.layer)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"rootNodeVisible",{get:function(){var a=this._rootNodeId&&this.nodeIndex[this._rootNodeId];return a&&this._viewportQueries?this._viewportQueries.isNodeVisible(a):
!0},enumerable:!0,configurable:!0}),m.prototype.initialize=function(){var a=this;this.updateEventListener={needsUpdate:function(){return a._needsAnimationFrameHandler()},idleFrame:function(b){return a._animationFrameHandler(b)},idleBegin:function(){a._startNodeLoading();a._updateIdleState(!0)},idleEnd:function(){a.cancelNodeLoading();a._updateIdleState(!1)}};this.updateEventListenerWhileSuspended={idleBegin:function(){return a._startNodeLoadingWhileSuspended()}};this._lodHandling=new u(this.layerViewRequiredFunctions,
this.layerViewOptionalFunctions,function(){return a._evaluateUpdatingState()});this.layerView._controller=this;var d=this.layer;this._defaultGeometrySchema=d.store.defaultGeometrySchema;this._rootNodeUrl=d.store.rootNode;var e=this._rootNodeUrl.split("/");this._rootNodeId=e[e.length-1];this.disableCache=k("disable-feature:idb-cache");d instanceof n?("mesh"===d.geometryType?this._lodFactorProperty="qualitySettings.sceneService.3dObject.lodFactor":"point"===d.geometryType&&(this._lodFactorProperty=
"qualitySettings.sceneService.point.lodFactor"),this._fields=d.fields,this._attributeStorageInfo=d.attributeStorageInfo):d instanceof w&&(this._lodFactorProperty="qualitySettings.sceneService.integratedMesh.lodFactor");d=b([this.layer.when(),this.layerView.when()]).then(function(){if(!a.destroyed&&a.layerView&&!a.layerView.destroyed){a.setClippingArea(a.layerView.view.clippingArea);var b=a.layerView.view.pointsOfInterest,d=function(){return a.restartNodeLoading()};a._centerOnSurface=b.centerOnSurfaceFrequent;
a._handles.add([a._centerOnSurface.watch("renderLocation",function(){return a._pointOfInterestChanged()}),b.events.on("camera-parameters-changed",d)],"view");var e=a.layerView.view.resourceController,f=!1;a._handles.add(M.init(a.layerView,"suspended",function(b){f&&e.deregisterIdleFrameWorker(a);b?e.registerIdleFrameWorker(a,a.updateEventListenerWhileSuspended):e.registerIdleFrameWorker(a,a.updateEventListener);f=!0}),"layerview");a._handles.add(a.layer.watch("elevationInfo",function(b){return a._elevationInfoChanged(b)}),
"layer");a.layerView instanceof c&&a._handles.add([M.init(a.layerView,"alwaysLoadEverythingModeEnabled",function(b){a._alwaysLoadEverythingModeEnabled=b;d()}),M.init(a.layerView,"uncompressedTextureDownsamplingEnabled",function(b){a._uncompressedTextureDownsamplingEnabled=b;d()})],"layer");a._lodFactorProperty&&a._handles.add(a.layerView.view.watch(a._lodFactorProperty,function(){return a._qualityChanged()}),"quality")}});this.addResolvingPromise(d)},m.prototype.destroy=function(){this.layerView.view.resourceController.deregisterIdleFrameWorker(this);
this.layerView.view.resourceController.deregisterClient(this.layerView);this._handles.destroy();this._nodeLoader=null},m.prototype._getRequiredAttributes=function(){if(!(null!=this._attributeStorageInfo&&this.layer instanceof n&&this._fields))return[];var a=Object.create(null);if(this.layer.renderer&&this.layer.renderer.collectRequiredFields(a),this.layer.labelsVisible&&this.layer.labelingInfo&&this.layer.labelingInfo.forEach(function(b){b._collectRequiredFields(a)}),null!=this.definitionExpressionFields)for(var b=
0,c=this.definitionExpressionFields;b<c.length;b++)a[c[b]]=!0;var d=this._attributeStorageInfo,e=this._fields,f=this.layer.objectIdField;return Object.keys(a).map(function(a){var b=O(d,a);a=O(e,a);return 0<=b&&0<=a?{index:b,name:e[a].name,field:e[a],attributeStorageInfo:d[b]}:null}).filter(function(a){return null!=a&&a.name!==f}).sort(function(a,b){return b.index-a.index}).filter(function(a,b,c){return 0===b||c[b-1].index!==a.index})},m.prototype._requiredFieldsChange=function(){this._requiredAttributesDirty=
!0;this.restartNodeLoading()},m.prototype._labelingChanged=function(){var a=this._requiredAttributes,b=this._getRequiredAttributes();a.length===b.length&&a.every(function(a){return 0<=O(b,a.name)})||this._requiredFieldsChange()},m.prototype.setClippingArea=function(a){var b=[];Q.extentToBoundingBox(a,b,this.layerView.view.renderSpatialReference)?this._clippingArea=b:this._clippingArea=null},m.prototype._qualityChanged=function(){this.restartNodeLoading()},m.prototype._pointOfInterestChanged=function(){this._poi&&
(this._calculatePointOfInterest(this._poi),this._indexLoader&&(this._indexLoader.updatePointOfInterest(this._poi),this._indexLoader.progressiveLoadPenalty=H.distancePenalty*this._viewportQueries.distCameraToPOI(this._poi)))},m.prototype._calculatePointOfInterest=function(a){void 0===a&&(a=T.vec3d.create());var b=T.vec3d.create(),c=T.vec3d.create(),d=this._centerOnSurface.renderLocation,e=this.layerView.view.renderCoordsHelper;T.vec3d.subtract(d,this.camPos,b);T.vec3d.normalize(b);e.worldUpAtPosition(d,
c);b=Math.acos(T.vec3d.dot(c,b))-.5*Math.PI;return T.vec3d.lerp(this.camPos,d,Math.max(0,Math.min(1,b/(.5*Math.PI))),a),a},m.prototype.updateClippingArea=function(a){this.setClippingArea(a);this.restartNodeLoading()},m.prototype.getBaseUrl=function(){return this.layer.parsedUrl.path},m.prototype.updateElevationChanged=function(a,b,c){r.findIntersectingNodes(a,b,this.nodeIndex.root,this.crsIndex,this.nodeIndex,c);for(a=0;a<c.length;a++)b=c.data[a],this._computedMbs[b.id]&&(this._computedMbs[b.id][3]=
-1),b.id===this._rootNodeId&&this.notifyChange("rootNodeVisible");c.length&&this.restartNodeLoading()},m.prototype._elevationInfoChanged=function(a){a=0;for(var b=Object.keys(this._computedMbs);a<b.length;a++)this._computedMbs[b[a]][3]=-1;this._initViewData()},m.prototype.restartNodeLoading=function(){this._restartNodeLoading=!0;this._evaluateUpdatingState()},m.prototype.schedule=function(a){return this._idleQueue.push(a)},m.prototype._needsAnimationFrameHandler=function(){return!0},m.prototype._animationFrameHandler=
function(a){if(this._restartNodeLoading&&(this.cancelNodeLoading(),this._startNodeLoading()),null!=this._nodeLoader){var b=this._indexLoader&&(this.maxQueueLevel>=this._indexLoader.getMaxLevel(0)||!this._indexLoader.isLoading());if(this._nodeQueue&&b)for(var c=this._indexLoader.isLoading()?3:5;this._numNodesLoading<c&&!this._nodeQueue.isEmpty();)this._loadNode(this._nodeQueue.dequeue());this._indexLoader&&(b=b?4:10,c=this._indexLoader.getNumLoading(),b=Math.min(b-c,4),0<b&&this._indexLoader.continueTraversal(b));
for(;0<this._idleQueue.length()&&!a.done();)this._idleQueue.process();this._evaluateUpdatingState();this._lodHandling.lodGlobalHandling()}},m.prototype._evaluateUpdatingState=function(){var a=this._indexLoader?this._indexLoader.getQueueSize():0,b=this._nodeQueue?this._nodeQueue.getCount():0,a=a+3*(b+this._numNodesLoading),b=!(!(0<a||0<this._numAttributesLoading||this._indexLoader&&this._indexLoader.isLoading()||this._restartNodeLoading||0<this._idleQueue.length()||this._lodHandling&&this._lodHandling.requiresLODGlobalHandling)&&
this._isIdle);0===a&&(this._progressMaxNumNodes=1);this._progressMaxNumNodes=Math.max(a,this._progressMaxNumNodes);b!==this._get("updating")&&this._set("updating",b);a=100*a/this._progressMaxNumNodes;a!==this._get("updatingPercentage")&&this._set("updatingPercentage",a)},m.prototype._initViewData=function(){var a=this.layerView.view,b=a.state.camera,c=a.renderCoordsHelper;this.camPos=T.vec3d.create(a.pointsOfInterest.renderPointOfView);this.screenSizeFactor=1/b.perPixelRatio;this._poi=this._calculatePointOfInterest();
var d=this._lodFactorProperty&&this.layerView.view.get(this._lodFactorProperty)||1;this._viewportQueries=new v(this._computedMbs,this.crsIndex,c,b,this._clippingArea,null!=this.layerViewOptionalFunctions.traversalOptions?this.layerViewOptionalFunctions.traversalOptions.errorMetricPreference:null,a.elevationProvider,this.layer.elevationInfo,{progressiveLoadFactor:this._getProgressiveLoadFactor(this.layer,d),screenspaceErrorBias:d,angleDependentLoD:.5>d,disableLod:this._alwaysLoadEverythingModeEnabled});
this.notifyChange("rootNodeVisible")},m.prototype._getProgressiveLoadFactor=function(a,b){return a instanceof n&&"mesh"===a.geometryType?(a=1<=b&&k("enable-feature:progressive-3dobject"))?H.factor3dObject:1:a instanceof w?(a=1<=b&&!k("disable-feature:progressive-im"))?H.factorIM:1:1},m.prototype._startNodeLoadingWhileSuspended=function(){var a=this;(this._initViewData(),this._alwaysLoadEverythingModeEnabled&&this.layerView.visible&&!this.layerView.get("parent.suspended"))||this._removeInvisibleNodes(function(b){return a._viewportQueries.isNodeVisible(b)})},
m.prototype._startNodeLoading=function(){var a=this;if(this._restartNodeLoading=!1,!this._updatesDisabled&&null!=this.streamDataSupplier){this._initViewData();null!=this.layerViewOptionalFunctions.getLoadedAttributes&&this._requiredAttributesDirty&&(this._requiredAttributes=this._getRequiredAttributes(),this._requiredAttributesDirty=!1,this._handles.add([this.layer.watch("renderer",function(){return a._requiredFieldsChange()}),this.layer.watch("definitionExpression",function(){return a._requiredFieldsChange()}),
this.layer.watch("labelsVisible",function(){return a._labelingChanged()}),this.layer.watch("labelingInfo",function(){return a._labelingChanged()})],"requiredAttributes"));var b=this.layerViewOptionalFunctions.textureOptions,d=q.TextureFormat.Normal;b&&b.useCompressedTextures?d=q.TextureFormat.Compressed:this._uncompressedTextureDownsamplingEnabled&&(d=q.TextureFormat.Downsampled);b=this._defaultGeometrySchema;this._nodeLoader=new q(this.streamDataSupplier,S,b,this._requiredAttributes,{textureFormat:d,
loadTextureData:this.layerView instanceof c&&this.layerView.rendererNeedsTextures,loadFeatureData:!this.isMeshPyramid||null==b||null==b.ordering});d=f.mixin({loadEverything:this._alwaysLoadEverythingModeEnabled},this.layerViewOptionalFunctions.traversalOptions);this._indexLoader=new t(this.getBaseUrl(),this._rootNodeUrl,this._rootNodeId,this._poi,this.nodeIndex,this.streamDataSupplier,this._viewportQueries,function(b,c){return a._processNodeIndexDocument(b,c)},function(b){return a._lodHandling.finishedLevel(b)},
S,d);this._indexLoader.progressiveLoadPenalty=H.distancePenalty*this._viewportQueries.distCameraToPOI(this._poi);this._nodeQueue=new Y;this.maxQueueLevel=0;this._indexLoader.start();this._alwaysLoadEverythingModeEnabled||this._removeInvisibleNodes(function(b){return a._indexLoader.nodeIsVisible(b)});this._lodHandling.startNodeLoading(function(b){return a._indexLoader.nodeIsVisible(b)},function(b){return a._indexLoader.nodeTraversalState(b)},this.nodeIndex,this._rootNodeId,{mode:null!=d&&d.perLevelTraversal?
"perLevel":"global",allowPartialOverlaps:!!d.allowPartialOverlaps,maxLodLevel:this._viewportQueries.maxLodLevel});this.layerViewOptionalFunctions.additionalStartNodeLoadingHandler&&this.layerViewOptionalFunctions.additionalStartNodeLoadingHandler();this._evaluateUpdatingState()}},m.prototype.isNodeLoading=function(){return null!=this._nodeLoader&&null!=this._indexLoader},m.prototype.cancelNodeLoading=function(){this.isNodeLoading()&&(this._indexLoader.cancel(),this._nodeLoader.cancel(),this.streamDataSupplier.cancelAll(),
this._idleQueue.cancelAll(),this._numNodesLoading=0,this._nodeLoader=null,this._indexLoader=null,this._nodeQueue=null,this._poi=null,this.layerViewOptionalFunctions.additionalCancelNodeLoadingHandler&&this.layerViewOptionalFunctions.additionalCancelNodeLoadingHandler(),this._evaluateUpdatingState())},m.prototype._removeInvisibleNodes=function(a){for(var b={},c=this.layerViewRequiredFunctions.getAddedNodeIDs(),d=0;d<c.length;d++){var e=c[d],f=this.nodeIndex[e];this._isNodeVisibleWithParents(f,a)?b[e]=
f:this._removeNodeData(f)}return b},m.prototype._isNodeVisibleWithParents=function(a,b){var c=a;do a=b(c),c=c.parentNode,c=null!=c?this.nodeIndex[c.id]:null;while(a&&null!=c);return a},m.prototype._removeNodeData=function(a){this._lodHandling.setLodGlobalDirty();this.layerViewRequiredFunctions.removeNodeData(a)},m.prototype._processNodeIndexDocument=function(a,b){var c=this.layerViewOptionalFunctions.traversalOptions;if(c&&c.perLevelTraversal)return this._loadNode(a);this._nodeQueue.enqueue(b,a);
this.maxQueueLevel=Math.max(a.level,this.maxQueueLevel);a=new P.Promise;return a.done(),a},m.prototype._loadNode=function(a){var b=this,c=new P.Promise;if(null!=a.featureData&&0<a.featureData.length)if(this.layerViewRequiredFunctions.areAllBundlesLoaded(a)){var d=this.layerViewOptionalFunctions.getLoadedAttributes,d=null!=d?d(a):void 0;null!=d&&d!==this._requiredAttributes&&(this._nodeLoader.loadAttributes(a,a.baseUrl,this._requiredAttributes).then(function(c){b.layerViewOptionalFunctions.setAttributeData(a,
b._requiredAttributes,c)}).otherwise(function(c){b.layerViewOptionalFunctions.setAttributeData(a,b._requiredAttributes,{})}).then(function(){b._numAttributesLoading--;b._evaluateUpdatingState()}),this._numAttributesLoading++,this._evaluateUpdatingState());this._lodHandling.shouldLoadNode(a)&&this._lodHandling.lodSwapBundleLoaded(a)}else if(this._lodHandling.shouldLoadNode(a)){if(this.layerViewRequiredFunctions.isOverMemory())return c.done(),c;for(var d=[],e=0;e<a.featureData.length;e++)this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(a,
e)||d.push(this._loadAndAddBundle(a,e));return this._numNodesLoading++,this._evaluateUpdatingState(),N.eachAlways(d).then(function(){b._numNodesLoading--;b._evaluateUpdatingState();c.done()}),c}return c.done(),c},m.prototype._loadCached=function(a,b){var c=this,d=this.disableCache?null:this.layerViewOptionalFunctions.loadCachedBundle,e=this.disableCache?null:this.layerViewOptionalFunctions.addCachedBundle;return d&&e?this.schedule().then(function(){return d(a,b,function(a,b){return c._nodeLoader.loadTextures(a,
b)})}).then(function(d){if(null==d)return!1;var f=c._requiredAttributes;return c.schedule().then(function(){return c._nodeLoader.loadAttributes(a,a.baseUrl,f)}).then(function(a){return c.schedule({loadedAttributes:f,attributeData:a})}).then(function(c){return e(a,b,d,c)}).then(function(){return c._lodHandling.lodSwapBundleLoaded(a),!0})}):N.resolve(!1)},m.prototype._loadUncached=function(a,b){var c=this;return this.schedule().then(function(){return c._nodeLoader.loadBundleData(a,b)}).then(function(a){return c.schedule(a)}).then(function(d){return c.layerViewRequiredFunctions.addBundle(a,
b,d)}).then(function(){return c._lodHandling.lodSwapBundleLoaded(a)})},m.prototype._loadAndAddBundle=function(a,b){var c=this;return this._loadCached(a,b).then(function(d){return d?void 0:c._loadUncached(a,b)}).otherwise(function(c){c instanceof g||S.error("Failed to load node '"+a.id+"' bundle "+b+": "+c)})},m.prototype._updateIdleState=function(a){a!==this._isIdle&&(this._isIdle=a,this._evaluateUpdatingState())},d([z.property({readOnly:!0})],m.prototype,"isMeshPyramid",null),d([z.property({readOnly:!0})],
m.prototype,"streamDataSupplier",null),d([z.property({readOnly:!0,dependsOn:["layer.definitionExpression"]})],m.prototype,"parsedDefinitionExpression",null),d([z.property({readOnly:!0,dependsOn:["parsedDefinitionExpression"]})],m.prototype,"definitionExpressionFields",null),d([z.property({readOnly:!0})],m.prototype,"crsVertex",null),d([z.property({readOnly:!0})],m.prototype,"crsIndex",null),d([z.property({readOnly:!0})],m.prototype,"nodeIndex",void 0),d([z.property()],m.prototype,"camPos",void 0),
d([z.property()],m.prototype,"screenSizeFactor",void 0),d([z.property()],m.prototype,"layerView",void 0),d([z.property()],m.prototype,"layerViewRequiredFunctions",void 0),d([z.property()],m.prototype,"layerViewOptionalFunctions",void 0),d([z.property()],m.prototype,"layer",void 0),d([z.property({readOnly:!0})],m.prototype,"updating",void 0),d([z.property({readOnly:!0})],m.prototype,"updatingPercentage",void 0),d([z.property({readOnly:!0})],m.prototype,"rootNodeVisible",null),m=d([z.subclass("esri.layers.graphics.controllers.I3SOnDemandController")],
m)}(z.declared(C,F,B));var H={factorIM:.2,factor3dObject:.05,distancePenalty:10},Y=y.goog.structs.PriorityQueue;return m})},"esri/core/sql/WhereClause":function(){define(["require","exports","./WhereGrammar","../../moment","./StandardizedFunctions"],function(m,l,h,d,b){function g(a){return Array.isArray(a)?a:[a]}function k(a){return null!==a?!0!==a:null}function f(a,b){if(null==a)return null;for(var c=!1,d=0;d<b.length;d++){var e=b[d];if(null==e)c=null;else if(a===e){c=!0;break}}return c}function a(a,
b,c){if(null==a)return null;for(var d="",e=0,f=0;f<b.length;f++){var g=b.charAt(f);switch(e){case 0:g===c?e=1:d+=0<="-[]/{}()*+?.\\^$|".indexOf(g)?"\\"+g:"%"===g?".*":"_"===g?".":g;break;case 1:d+=0<="-[]/{}()*+?.\\^$|".indexOf(g)?"\\"+g:g,e=0}}return(new RegExp("^"+d+"$")).test(a)}function e(a){return a instanceof Date?a.valueOf():a}function c(a,b,c){if(null==b||null==c)return null;b=e(b);c=e(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>c;case "\x3c":return c>
b;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return c>=b}}function q(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d],f=e.toLowerCase();void 0===c[f]&&(b.push(e),c[f]=1)}return b}return function(){function l(){this.parameters=this.parseTree=null}return l.create=function(a){var b=new l;return b.parseTree=h.WhereGrammar.parse(a),b},l.prototype.isStandardized=function(){var a=!0;return this.visitAll(this.parseTree,function(c){a&&"function"===c.type&&(a=b.isStandardized(c.name,c.args.value.length))}),
a},l.prototype.setVariablesDictionary=function(a){this.parameters=a},l.prototype.testFeature=function(a){return!!this.evaluateNode(this.parseTree,a)},l.prototype.calculateValue=function(a){return this.evaluateNode(this.parseTree,a)},l.prototype.getFunctions=function(){var a=[];return this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())}),q(a)},l.prototype.getFields=function(){var a=[];return this.visitAll(this.parseTree,function(b){"column_ref"===b.type&&a.push(b.column)}),
q(a)},l.prototype.getVariables=function(){var a=[];return this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())}),q(a)},l.prototype.featureValue=function(a,b,c){a=a&&"object"==typeof a.attributes?a.attributes:a;var d=a[b];if(void 0!==d)return d;for(var e in a)if(b.toLowerCase()===e.toLowerCase())return c.column=e,a[e];return null},l.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,
b);break;case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var e=d[c];this.visitAll(e,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a["else"]&&this.visitAll(a["else"],b);break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)e=a[c],this.visitAll(e,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}},l.prototype.evaluateNode=function(h,l){switch(h.type){case "case_expression":if("simple"===
h.format)for(var m=e(this.evaluateNode(h.operand,l)),q=0;q<h.clauses.length;q++){if(m===e(this.evaluateNode(h.clauses[q].operand,l)))return this.evaluateNode(h.clauses[q].value,l)}else for(q=0;q<h.clauses.length;q++)if(!0===this.evaluateNode(h.clauses[q].operand,l))return this.evaluateNode(h.clauses[q].value,l);return null!==h["else"]?this.evaluateNode(h["else"],l):null;case "param":return this.parameters[h.value.toLowerCase()];case "expr_list":m=[];q=0;for(h=h.value;q<h.length;q++){var r=h[q];m.push(this.evaluateNode(r,
l))}return m;case "unary_expr":return k(this.evaluateNode(h.expr,l));case "binary_expr":switch(h.operator){case "AND":return m=this.evaluateNode(h.left,l),l=this.evaluateNode(h.right,l),null!=m&&null!=l?!0===m&&!0===l:!1===m||!1===l?!1:null;case "OR":return m=this.evaluateNode(h.left,l),l=this.evaluateNode(h.right,l),null!=m&&null!=l?!0===m||!0===l:!0===m||!0===l?!0:null;case "IS":if("null"!==h.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(h.left,l);case "ISNOT":if("null"!==
h.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(h.left,l);case "IN":return m=g(this.evaluateNode(h.right,l)),f(this.evaluateNode(h.left,l),m);case "NOT IN":return m=g(this.evaluateNode(h.right,l)),k(f(this.evaluateNode(h.left,l),m));case "BETWEEN":return m=this.evaluateNode(h.left,l),l=this.evaluateNode(h.right,l),null==m||null==l[0]||null==l[1]?null:m>=l[0]&&m<=l[1];case "NOTBETWEEN":return m=this.evaluateNode(h.left,l),l=this.evaluateNode(h.right,l),null==m||null==
l[0]||null==l[1]?null:m<l[0]||m>l[1];case "LIKE":return a(this.evaluateNode(h.left,l),this.evaluateNode(h.right,l),h.escape);case "NOT LIKE":return k(a(this.evaluateNode(h.left,l),this.evaluateNode(h.right,l),h.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return c(h.operator,this.evaluateNode(h.left,l),this.evaluateNode(h.right,l));case "*":return this.evaluateNode(h.left,l)*this.evaluateNode(h.right,l);case "-":return this.evaluateNode(h.left,l)-this.evaluateNode(h.right,
l);case "+":return this.evaluateNode(h.left,l)+this.evaluateNode(h.right,l);case "/":return this.evaluateNode(h.left,l)/this.evaluateNode(h.right,l)}throw Error("Not Supported Operator "+h.operator);case "null":case "bool":case "string":case "number":return h.value;case "date":return d(h.value,["YYYY-M-D"]).toDate();case "timestamp":return d(h.value,["YYYY-M-D H:m:s","YYYY-M-D H:mZ","YYYY-M-D H:m:sZ","YYYY-M-D H:m","YYYY-m-d"]).toDate();case "column_ref":return"CURRENT_DATE"===h.column.toUpperCase()?
(r=new Date,r.setHours(0,0,0,0),r):"CURRENT_TIMESTAMP"===h.column.toUpperCase()?new Date:this.featureValue(l,h.column,h);case "function":return l=this.evaluateNode(h.args,l),b.evaluateFunction(h.name,l)}throw Error("Unsupported sql syntax "+h.type);},l}()})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function d(){}return d.parse=function(b){return h.parse(b)},d}();l.WhereGrammar=
m})},"esri/core/sql/sql92grammar":function(){define([],function(){function m(l,h,d,b){this.message=l;this.expected=h;this.found=d;this.location=b;this.name="SyntaxError";"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,m)}return function(l,h){function d(){this.constructor=l}d.prototype=h.prototype;l.prototype=new d}(m,Error),m.buildMessage=function(l,h){function d(b){return b.charCodeAt(0).toString(16).toUpperCase()}function b(b){return b.replace(/\\/g,"\\\\").replace(/"/g,
'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+d(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+d(a)})}function g(b){return b.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+d(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+
d(a)})}var k={literal:function(d){return'"'+b(d.text)+'"'},"class":function(b){var a,d="";for(a=0;a<b.parts.length;a++)d+=b.parts[a]instanceof Array?g(b.parts[a][0])+"-"+g(b.parts[a][1]):g(b.parts[a]);return"["+(b.inverted?"^":"")+d+"]"},any:function(b){return"any character"},end:function(b){return"end of input"},other:function(b){return b.description}};return"Expected "+function(b){var a,d=Array(b.length);for(a=0;a<b.length;a++){var c=a,f;f=b[a];f=k[f.type](f);d[c]=f}if(d.sort(),0<d.length){for(b=
a=1;a<d.length;a++)d[a-1]!==d[a]&&(d[b]=d[a],b++);d.length=b}switch(d.length){case 1:return d[0];case 2:return d[0]+" or "+d[1];default:return d.slice(0,-1).join(", ")+", or "+d[d.length-1]}}(l)+" but "+(h?'"'+b(h)+'"':"end of input")+" found."},{SyntaxError:m,parse:function(l,h){function d(a,b){return{type:"literal",text:a,ignoreCase:b}}function b(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function g(a){var b,c=ac[a];if(c)return c;for(b=a-1;!ac[b];)b--;c=ac[b];for(c={line:c.line,
column:c.column};a>b;)10===l.charCodeAt(b)?(c.line++,c.column=1):c.column++,b++;return ac[a]=c,c}function k(a,b){var c=g(a),d=g(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:d.line,column:d.column}}}function f(a){eb>I||(I>eb&&(eb=I,Gb=[]),Gb.push(a))}function a(){var a,b,d,e;return a=I,b=da(),b!==D?(d=c(),d!==D?(e=da(),e!==D?(b=d,a=b):(I=a,a=D)):(I=a,a=D)):(I=a,a=D),a}function e(){var a,b,d,e,f,g,h,k;if(a=I,b=c(),b!==D){d=[];e=I;f=da();for(f!==D?(g=za(),g!==D?(h=da(),h!==
D?(k=c(),k!==D?(f=[f,g,h,k],e=f):(I=e,e=D)):(I=e,e=D)):(I=e,e=D)):(I=e,e=D);e!==D;)d.push(e),e=I,f=da(),f!==D?(g=za(),g!==D?(h=da(),h!==D?(k=c(),k!==D?(f=[f,g,h,k],e=f):(I=e,e=D)):(I=e,e=D)):(I=e,e=D)):(I=e,e=D);if(d!==D){a={type:"expr_list"};b=[b];for(e=0;e<d.length;e++)b.push(d[e][3]);a=b=(a.value=b,a)}else I=a,a=D}else I=a,a=D;return a}function c(){var a,b,c,d,e,f,g,h;if(a=I,b=q(),b!==D){c=[];d=I;e=da();for(e!==D?(f=X(),f!==D?(g=da(),g!==D?(h=q(),h!==D?(e=[e,f,g,h],d=e):(I=d,d=D)):(I=d,d=D)):(I=
d,d=D)):(I=d,d=D);d!==D;)c.push(d),d=I,e=da(),e!==D?(f=X(),f!==D?(g=da(),g!==D?(h=q(),h!==D?(e=[e,f,g,h],d=e):(I=d,d=D)):(I=d,d=D)):(I=d,d=D)):(I=d,d=D);c!==D?(b=pa(b,c),a=b):(I=a,a=D)}else I=a,a=D;return a}function q(){var a,b,c,d,e,f,g,h;if(a=I,b=t(),b!==D){c=[];d=I;e=da();for(e!==D?(f=V(),f!==D?(g=da(),g!==D?(h=t(),h!==D?(e=[e,f,g,h],d=e):(I=d,d=D)):(I=d,d=D)):(I=d,d=D)):(I=d,d=D);d!==D;)c.push(d),d=I,e=da(),e!==D?(f=V(),f!==D?(g=da(),g!==D?(h=t(),h!==D?(e=[e,f,g,h],d=e):(I=d,d=D)):(I=d,d=D)):
(I=d,d=D)):(I=d,d=D);c!==D?(b=pa(b,c),a=b):(I=a,a=D)}else I=a,a=D;return a}function t(){var a,b,c,d,g;a=I;b=U();b===D&&(b=I,33===l.charCodeAt(I)?(c=Fa,I++):(c=D,0===ia&&f(sa)),c!==D?(d=I,ia++,61===l.charCodeAt(I)?(g=Z,I++):(g=D,0===ia&&f(ma)),ia--,g===D?d=void 0:(I=d,d=D),d!==D?(c=[c,d],b=c):(I=b,b=D)):(I=b,b=D));b!==D?(c=da(),c!==D?(d=t(),d!==D?(b={type:"unary_expr",operator:"NOT",expr:d},a=b):(I=a,a=D)):(I=a,a=D)):(I=a,a=D);if(a===D){var h;a=I;b=x();if(b!==D)if(c=da(),c!==D){var k,n,m,p,q;if(c=
[],k=I,n=da(),n!==D?(m=r(),m!==D?(p=da(),p!==D?(q=x(),q!==D?(n=[n,m,p,q],k=n):(I=k,k=D)):(I=k,k=D)):(I=k,k=D)):(I=k,k=D),k!==D)for(;k!==D;)c.push(k),k=I,n=da(),n!==D?(m=r(),m!==D?(p=da(),p!==D?(q=x(),q!==D?(n=[n,m,p,q],k=n):(I=k,k=D)):(I=k,k=D)):(I=k,k=D)):(I=k,k=D);else c=D;k=(c!==D&&(c={type:"arithmetic",tail:c}),c);if(k===D){var w,y,z,C,B,H,E,K;k=(w=I,y=v(),y!==D?(z=da(),z!==D?(C=ua(),C!==D?(B=da(),B!==D?(H=e(),H!==D?(E=da(),E!==D?(K=wa(),K!==D?(y={op:y,right:H},w=y):(I=w,w=D)):(I=w,w=D)):(I=w,
w=D)):(I=w,w=D)):(I=w,w=D)):(I=w,w=D)):(I=w,w=D),w===D&&(w=I,y=v(),y!==D?(z=da(),z!==D?(C=ua(),C!==D?(B=da(),B!==D?(H=wa(),H!==D?(y={op:y,right:{type:"expr_list",value:[]}},w=y):(I=w,w=D)):(I=w,w=D)):(I=w,w=D)):(I=w,w=D)):(I=w,w=D),w===D&&(w=I,y=v(),y!==D?(z=da(),z!==D?(C=N(),C!==D?(y={op:y,right:C},w=y):(I=w,w=D)):(I=w,w=D)):(I=w,w=D))),w);if(k===D){var G,L,M,J,O,S,Y,Q,W,T;k=(G=I,L=U(),L!==D?(M=da(),M!==D?(J=ba(),J!==D?(O=da(),O!==D?(S=x(),S!==D?(Y=da(),Y!==D?(Q=V(),Q!==D?(W=da(),W!==D?(T=x(),T!==
D?(L={op:"NOT"+J,right:{type:"expr_list",value:[S,T]}},G=L):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)):(I=G,G=D),G===D&&(G=I,L=ba(),L!==D?(M=da(),M!==D?(J=x(),J!==D?(O=da(),O!==D?(S=V(),S!==D?(Y=da(),Y!==D?(Q=x(),Q!==D?(L={op:L,right:{type:"expr_list",value:[J,Q]}},G=L):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)):(I=G,G=D)),G);if(k===D){var X,Ea,fa,aa,Ia,ca;k=(X=I,Ea=A(),Ea!==D?(fa=da(),fa!==D?(aa=U(),aa!==D?(Ia=da(),Ia!==D?(ca=x(),
ca!==D?(Ea={op:Ea+"NOT",right:ca},X=Ea):(I=X,X=D)):(I=X,X=D)):(I=X,X=D)):(I=X,X=D)):(I=X,X=D),X===D&&(X=I,Ea=A(),Ea!==D?(fa=da(),fa!==D?(aa=x(),aa!==D?(Ea={op:Ea,right:aa},X=Ea):(I=X,X=D)):(I=X,X=D)):(I=X,X=D)),X);if(k===D){var ha,oa,ea;w=I;y=u();if(y!==D)if(h=da(),h!==D)if(ha=R(),ha!==D)if(z=da(),z!==D){var va,Ma,Ha,ja;z=(va=I,l.substr(I,6).toLowerCase()===Ub?(Ma=l.substr(I,6),I+=6):(Ma=D,0===ia&&f(cb)),Ma!==D?(Ha=I,ia++,ja=F(),ia--,ja===D?Ha=void 0:(I=Ha,Ha=D),Ha!==D?(Ma="ESCAPE",va=Ma):(I=va,va=
D)):(I=va,va=D),va);z!==D?(oa=da(),oa!==D?(ea=P(),ea!==D?(y={op:y,right:ha,escape:ea.value},w=y):(I=w,w=D)):(I=w,w=D)):(I=w,w=D)}else I=w,w=D;else I=w,w=D;else I=w,w=D;else I=w,w=D;k=(w===D&&(w=I,y=u(),y!==D?(h=da(),h!==D?(ha=R(),ha!==D?(y={op:y,right:ha,escape:""},w=y):(I=w,w=D)):(I=w,w=D)):(I=w,w=D)),w)}}}}h=k;h===D&&(h=null);h!==D?(ha=b,a=b=""==h||void 0==h||null==h?ha:"arithmetic"==h.type?pa(ha,h.tail):ga(h.op,ha,h.right,h.escape)):(I=a,a=D)}else I=a,a=D;else I=a,a=D}return a}function r(){var a;
return l.substr(I,2)===Pa?(a=Pa,I+=2):(a=D,0===ia&&f(Ia)),a===D&&(62===l.charCodeAt(I)?(a=Ha,I++):(a=D,0===ia&&f(Xa)),a===D&&(l.substr(I,2)===oa?(a=oa,I+=2):(a=D,0===ia&&f(Ma)),a===D&&(l.substr(I,2)===Ka?(a=Ka,I+=2):(a=D,0===ia&&f(va)),a===D&&(60===l.charCodeAt(I)?(a=Wa,I++):(a=D,0===ia&&f(Za)),a===D&&(61===l.charCodeAt(I)?(a=Z,I++):(a=D,0===ia&&f(ma)),a===D&&(l.substr(I,2)===Ba?(a=Ba,I+=2):(a=D,0===ia&&f(Va)))))))),a}function u(){var a,b,c,d,e;return a=I,b=I,c=U(),c!==D?(d=da(),d!==D?(e=K(),e!==
D?(c=[c,d,e],b=c):(I=b,b=D)):(I=b,b=D)):(I=b,b=D),b!==D&&(b=b[0]+" "+b[2]),a=b,a===D&&(a=K()),a}function v(){var a,b,c,d,e;return a=I,b=I,c=U(),c!==D?(d=da(),d!==D?(e=p(),e!==D?(c=[c,d,e],b=c):(I=b,b=D)):(I=b,b=D)):(I=b,b=D),b!==D&&(b=b[0]+" "+b[2]),a=b,a===D&&(a=p()),a}function x(){var a,b,c,d,e,f,g,h;if(a=I,b=n(),b!==D){c=[];d=I;e=da();for(e!==D?(f=y(),f!==D?(g=da(),g!==D?(h=n(),h!==D?(e=[e,f,g,h],d=e):(I=d,d=D)):(I=d,d=D)):(I=d,d=D)):(I=d,d=D);d!==D;)c.push(d),d=I,e=da(),e!==D?(f=y(),f!==D?(g=
da(),g!==D?(h=n(),h!==D?(e=[e,f,g,h],d=e):(I=d,d=D)):(I=d,d=D)):(I=d,d=D)):(I=d,d=D);c!==D?(b=pa(b,c),a=b):(I=a,a=D)}else I=a,a=D;return a}function y(){var a;return 43===l.charCodeAt(I)?(a=ka,I++):(a=D,0===ia&&f(Ga)),a===D&&(45===l.charCodeAt(I)?(a=aa,I++):(a=D,0===ia&&f(ya))),a}function n(){var a,b,c,d,e,f,g,h;if(a=I,b=z(),b!==D){c=[];d=I;e=da();for(e!==D?(f=w(),f!==D?(g=da(),g!==D?(h=z(),h!==D?(e=[e,f,g,h],d=e):(I=d,d=D)):(I=d,d=D)):(I=d,d=D)):(I=d,d=D);d!==D;)c.push(d),d=I,e=da(),e!==D?(f=w(),
f!==D?(g=da(),g!==D?(h=z(),h!==D?(e=[e,f,g,h],d=e):(I=d,d=D)):(I=d,d=D)):(I=d,d=D)):(I=d,d=D);c!==D?(b=pa(b,c),a=b):(I=a,a=D)}else I=a,a=D;return a}function w(){var a;return 42===l.charCodeAt(I)?(a=Aa,I++):(a=D,0===ia&&f(Ca)),a===D&&(47===l.charCodeAt(I)?(a=ta,I++):(a=D,0===ia&&f(xa))),a}function z(){var a,b,d,g,h,k,n;n=P();if(n===D){var m,q,r,t;m=I;var u,v,w,x;n=(q=(u=I,v=S(),v!==D?(w=H(),w!==D?(x=Y(),x!==D?(v=parseFloat(v+w+x),u=v):(I=u,u=D)):(I=u,u=D)):(I=u,u=D),u===D&&(u=I,v=S(),v!==D?(w=H(),
w!==D?(v=parseFloat(v+w),u=v):(I=u,u=D)):(I=u,u=D),u===D&&(u=I,v=S(),v!==D?(w=Y(),w!==D?(v=parseFloat(v+w),u=v):(I=u,u=D)):(I=u,u=D),u===D&&(u=I,v=S(),v!==D&&(v=parseFloat(v)),u=v))),u),q!==D?(r=I,ia++,t=B(),ia--,t===D?r=void 0:(I=r,r=D),r!==D?(q={type:"number",value:q},m=q):(I=m,m=D)):(I=m,m=D),m);if(n===D){var y,z;y=I;var A,E,K,L;z=(A=I,l.substr(I,4).toLowerCase()===Tc?(E=l.substr(I,4),I+=4):(E=D,0===ia&&f(Uc)),E!==D?(K=I,ia++,L=F(),ia--,L===D?K=void 0:(I=K,K=D),K!==D?(E=[E,K],A=E):(I=A,A=D)):(I=
A,A=D),A);z!==D&&(z={type:"bool",value:!0});y=z;if(y===D){y=I;var J,W,U,V;z=(J=I,l.substr(I,5).toLowerCase()===jd?(W=l.substr(I,5),I+=5):(W=D,0===ia&&f(ld)),W!==D?(U=I,ia++,V=F(),ia--,V===D?U=void 0:(I=U,U=D),U!==D?(W=[W,U],J=W):(I=J,J=D)):(I=J,J=D),J);z!==D&&(z={type:"bool",value:!1});y=z}n=y;if(n===D){var X,Z,ba,Ea,aa;n=(X=(Z=I,l.substr(I,4).toLowerCase()===hd?(ba=l.substr(I,4),I+=4):(ba=D,0===ia&&f(id)),ba!==D?(Ea=I,ia++,aa=F(),ia--,aa===D?Ea=void 0:(I=Ea,Ea=D),Ea!==D?(ba=[ba,Ea],Z=ba):(I=Z,Z=
D)):(I=Z,Z=D),Z),X!==D&&(X={type:"null",value:null}),X);if(n===D){var Ia,Fa,sa,oa;Ia=I;var va,ma,Ma,Ha;n=(Fa=(va=I,l.substr(I,4).toLowerCase()===Qb?(ma=l.substr(I,4),I+=4):(ma=D,0===ia&&f(xd)),ma!==D?(Ma=I,ia++,Ha=F(),ia--,Ha===D?Ma=void 0:(I=Ma,Ma=D),Ma!==D?(ma="DATE",va=ma):(I=va,va=D)):(I=va,va=D),va),Fa!==D?(sa=da(),sa!==D?(oa=R(),oa!==D?(Fa={type:"date",value:oa.value},Ia=Fa):(I=Ia,Ia=D)):(I=Ia,Ia=D)):(I=Ia,Ia=D),Ia);if(n===D){var ja,ka,ga,Ka;ja=I;var Xa,la,na,Ba;n=(ka=(Xa=I,l.substr(I,9).toLowerCase()===
tb?(la=l.substr(I,9),I+=9):(la=D,0===ia&&f(Eb)),la!==D?(na=I,ia++,Ba=F(),ia--,Ba===D?na=void 0:(I=na,na=D),na!==D?(la="TIMESTAMP",Xa=la):(I=Xa,Xa=D)):(I=Xa,Xa=D),Xa),ka!==D?(ga=da(),ga!==D?(Ka=R(),Ka!==D?(ka={type:"timestamp",value:Ka.value},ja=ka):(I=ja,ja=D)):(I=ja,ja=D)):(I=ja,ja=D),ja)}}}}}a=n;if(a===D){var pa,Wa,ta,qa,ra,Za,Pa,ya,xa,za,Ga,Aa;pa=I;var Va,Ca,Na,Qa;Wa=(Va=I,l.substr(I,7).toLowerCase()===Vc?(Ca=l.substr(I,7),I+=7):(Ca=D,0===ia&&f(Wc)),Ca!==D?(Na=I,ia++,Qa=F(),ia--,Qa===D?Na=void 0:
(I=Na,Na=D),Na!==D?(Ca="EXTRACT",Va=Ca):(I=Va,Va=D)):(I=Va,Va=D),Va);if(Wa!==D)if(ta=da(),ta!==D)if(qa=ua(),qa!==D)if(ra=da(),ra!==D){var La,Ya,Ta,cb,jb;La=(Ya=I,l.substr(I,4).toLowerCase()===Fd?(Ta=l.substr(I,4),I+=4):(Ta=D,0===ia&&f(kd)),Ta!==D?(cb=I,ia++,jb=F(),ia--,jb===D?cb=void 0:(I=cb,cb=D),cb!==D?(Ta="YEAR",Ya=Ta):(I=Ya,Ya=D)):(I=Ya,Ya=D),Ya);if(La===D){var ab,sb,eb,pb;La=(ab=I,l.substr(I,5).toLowerCase()===$a?(sb=l.substr(I,5),I+=5):(sb=D,0===ia&&f(mc)),sb!==D?(eb=I,ia++,pb=F(),ia--,pb===
D?eb=void 0:(I=eb,eb=D),eb!==D?(sb="MONTH",ab=sb):(I=ab,ab=D)):(I=ab,ab=D),ab);if(La===D){var db,gb,ib,ub;La=(db=I,l.substr(I,3).toLowerCase()===Bc?(gb=l.substr(I,3),I+=3):(gb=D,0===ia&&f(yd)),gb!==D?(ib=I,ia++,ub=F(),ia--,ub===D?ib=void 0:(I=ib,ib=D),ib!==D?(gb="DAY",db=gb):(I=db,db=D)):(I=db,db=D),db);if(La===D){var fb,lb,ob,Cb;La=(fb=I,l.substr(I,4).toLowerCase()===zd?(lb=l.substr(I,4),I+=4):(lb=D,0===ia&&f(Ad)),lb!==D?(ob=I,ia++,Cb=F(),ia--,Cb===D?ob=void 0:(I=ob,ob=D),ob!==D?(lb="HOUR",fb=lb):
(I=fb,fb=D)):(I=fb,fb=D),fb);if(La===D){var kb,qb,rb,Ib;La=(kb=I,l.substr(I,6).toLowerCase()===Dc?(qb=l.substr(I,6),I+=6):(qb=D,0===ia&&f(Xc)),qb!==D?(rb=I,ia++,Ib=F(),ia--,Ib===D?rb=void 0:(I=rb,rb=D),rb!==D?(qb="MINUTE",kb=qb):(I=kb,kb=D)):(I=kb,kb=D),kb);if(La===D){var mb,vb,wb,Lb;La=(mb=I,l.substr(I,6).toLowerCase()===Cd?(vb=l.substr(I,6),I+=6):(vb=D,0===ia&&f(Bd)),vb!==D?(wb=I,ia++,Lb=F(),ia--,Lb===D?wb=void 0:(I=wb,wb=D),wb!==D?(vb="SECOND",mb=vb):(I=mb,mb=D)):(I=mb,mb=D),mb)}}}}}Za=La;Za!==
D?(Pa=da(),Pa!==D?(ya=fa(),ya!==D?(xa=da(),xa!==D?(za=c(),za!==D?(Ga=da(),Ga!==D?(Aa=wa(),Aa!==D?(Wa={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:Za},za]}},pa=Wa):(I=pa,pa=D)):(I=pa,pa=D)):(I=pa,pa=D)):(I=pa,pa=D)):(I=pa,pa=D)):(I=pa,pa=D)):(I=pa,pa=D)}else I=pa,pa=D;else I=pa,pa=D;else I=pa,pa=D;else I=pa,pa=D;a=pa;if(a===D){var Sa,Db,Pb,Tb,Xb,Fb,Zb,ac,bc,Hb,cc,nb,uc,Ob,Wb,Yb;Sa=I;var vc,Gb,Yc,kc;Db=(vc=I,l.substr(I,9).toLowerCase()===Ic?(Gb=l.substr(I,9),I+=
9):(Gb=D,0===ia&&f(qc)),Gb!==D?(Yc=I,ia++,kc=F(),ia--,kc===D?Yc=void 0:(I=Yc,Yc=D),Yc!==D?(Gb="SUBSTRING",vc=Gb):(I=vc,vc=D)):(I=vc,vc=D),vc);if(Db!==D)if(Pb=da(),Pb!==D)if(Tb=ua(),Tb!==D)if(Xb=da(),Xb!==D)if(Fb=c(),Fb!==D)if(Zb=da(),Zb!==D)if(ac=fa(),ac!==D)if(bc=da(),bc!==D)if(Hb=c(),Hb!==D)if(cc=da(),cc!==D){nb=I;var wc,Zc,$c,lc;uc=(wc=I,l.substr(I,3).toLowerCase()===Hc?(Zc=l.substr(I,3),I+=3):(Zc=D,0===ia&&f(Ed)),Zc!==D?($c=I,ia++,lc=F(),ia--,lc===D?$c=void 0:(I=$c,$c=D),$c!==D?(Zc="FOR",wc=Zc):
(I=wc,wc=D)):(I=wc,wc=D),wc);uc!==D?(Ob=da(),Ob!==D?(Wb=c(),Wb!==D?(Yb=da(),Yb!==D?(uc=[uc,Ob,Wb,Yb],nb=uc):(I=nb,nb=D)):(I=nb,nb=D)):(I=nb,nb=D)):(I=nb,nb=D);nb===D&&(nb=null);nb!==D?(uc=wa(),uc!==D?(Db={type:"function",name:"substring",args:{type:"expr_list",value:nb?[Fb,Hb,nb[2]]:[Fb,Hb]}},Sa=Db):(I=Sa,Sa=D)):(I=Sa,Sa=D)}else I=Sa,Sa=D;else I=Sa,Sa=D;else I=Sa,Sa=D;else I=Sa,Sa=D;else I=Sa,Sa=D;else I=Sa,Sa=D;else I=Sa,Sa=D;else I=Sa,Sa=D;else I=Sa,Sa=D;else I=Sa,Sa=D;a=Sa;if(a===D){var Da,fc,
Mb,Nb,Rb,yb,Sb,Qc,Ub,Vb,oc,dc,rc,sc;a=(Da=I,fc=ha(),fc!==D?(Mb=da(),Mb!==D?(Nb=ua(),Nb!==D?(Rb=da(),Rb!==D?(yb=M(),yb===D&&(yb=null),yb!==D?(Sb=da(),Sb!==D?(Qc=c(),Qc!==D?(Ub=da(),Ub!==D?(Vb=fa(),Vb!==D?(oc=da(),oc!==D?(dc=c(),dc!==D?(rc=da(),rc!==D?(sc=wa(),sc!==D?(fc={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==yb?"BOTH":yb},Qc,dc]}},Da=fc):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):
(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D),Da===D&&(Da=I,fc=ha(),fc!==D?(Mb=da(),Mb!==D?(Nb=ua(),Nb!==D?(Rb=da(),Rb!==D?(yb=M(),yb===D&&(yb=null),yb!==D?(Sb=da(),Sb!==D?(Qc=c(),Qc!==D?(Ub=da(),Ub!==D?(Vb=wa(),Vb!==D?(fc={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==yb?"BOTH":yb},Qc]}},Da=fc):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)):(I=Da,Da=D)),Da);if(a===D){var Ua,$b,tc,Ac,Cc,nc,Ec,Fc,Gc,
pc,Jc,Kc;Ua=I;var xc,ad,bd,Lc;a=($b=(xc=I,l.substr(I,8).toLowerCase()===xb?(ad=l.substr(I,8),I+=8):(ad=D,0===ia&&f(bb)),ad!==D?(bd=I,ia++,Lc=F(),ia--,Lc===D?bd=void 0:(I=bd,bd=D),bd!==D?(ad="POSITION",xc=ad):(I=xc,xc=D)):(I=xc,xc=D),xc),$b!==D?(tc=da(),tc!==D?(Ac=ua(),Ac!==D?(Cc=da(),Cc!==D?(nc=c(),nc!==D?(Ec=da(),Ec!==D?(Fc=p(),Fc!==D?(Gc=da(),Gc!==D?(pc=c(),pc!==D?(Jc=da(),Jc!==D?(Kc=wa(),Kc!==D?($b={type:"function",name:"position",args:{type:"expr_list",value:[nc,pc]}},Ua=$b):(I=Ua,Ua=D)):(I=Ua,
Ua=D)):(I=Ua,Ua=D)):(I=Ua,Ua=D)):(I=Ua,Ua=D)):(I=Ua,Ua=D)):(I=Ua,Ua=D)):(I=Ua,Ua=D)):(I=Ua,Ua=D)):(I=Ua,Ua=D)):(I=Ua,Ua=D),Ua);if(a===D){var hb,cd,Mc,Nc,Oc,Rc,Pc,Gd;hb=I;var zb,yc,dd,Kb;if(zb=I,yc=C(),zb=yc,zb===D)if(zb=I,96===l.charCodeAt(I)?(yc=md,I++):(yc=D,0===ia&&f(nd)),yc!==D){if(dd=[],od.test(l.charAt(I))?(Kb=l.charAt(I),I++):(Kb=D,0===ia&&f(pd)),Kb!==D)for(;Kb!==D;)dd.push(Kb),od.test(l.charAt(I))?(Kb=l.charAt(I),I++):(Kb=D,0===ia&&f(pd));else dd=D;dd!==D?(96===l.charCodeAt(I)?(Kb=md,I++):
(Kb=D,0===ia&&f(nd)),Kb!==D?(yc=dd.join(""),zb=yc):(I=zb,zb=D)):(I=zb,zb=D)}else I=zb,zb=D;a=(cd=zb,cd!==D?(Mc=da(),Mc!==D?(Nc=ua(),Nc!==D?(Oc=da(),Oc!==D?(Rc=e(),Rc===D&&(Rc=null),Rc!==D?(Pc=da(),Pc!==D?(Gd=wa(),Gd!==D?(cd={type:"function",name:cd,args:Rc?Rc:{type:"expr_list",value:[]}},hb=cd):(I=hb,hb=D)):(I=hb,hb=D)):(I=hb,hb=D)):(I=hb,hb=D)):(I=hb,hb=D)):(I=hb,hb=D)):(I=hb,hb=D),hb);if(a===D){var qd,Ja,gc,rd,Sc,sd,hc,Ab,ed,Hd,Id;if(Ja=I,gc=ca(),gc!==D)if(rd=da(),rd!==D)if(Sc=c(),Sc!==D)if(sd=
da(),sd!==D){hc=[];for(Ab=T();Ab!==D;)hc.push(Ab),Ab=T();hc!==D?(Ab=da(),Ab!==D?(ed=ea(),ed!==D?(gc={type:"case_expression",format:"simple",operand:Sc,clauses:hc,"else":null},Ja=gc):(I=Ja,Ja=D)):(I=Ja,Ja=D)):(I=Ja,Ja=D)}else I=Ja,Ja=D;else I=Ja,Ja=D;else I=Ja,Ja=D;else I=Ja,Ja=D;if(Ja===D)if(Ja=I,gc=ca(),gc!==D)if(rd=da(),rd!==D)if(Sc=c(),Sc!==D)if(sd=da(),sd!==D){hc=[];for(Ab=T();Ab!==D;)hc.push(Ab),Ab=T();hc!==D?(Ab=da(),Ab!==D?(ed=O(),ed!==D?(Hd=da(),Hd!==D?(Id=ea(),Id!==D?(gc={type:"case_expression",
format:"simple",operand:Sc,clauses:hc,"else":ed.value},Ja=gc):(I=Ja,Ja=D)):(I=Ja,Ja=D)):(I=Ja,Ja=D)):(I=Ja,Ja=D)):(I=Ja,Ja=D)}else I=Ja,Ja=D;else I=Ja,Ja=D;else I=Ja,Ja=D;else I=Ja,Ja=D;qd=Ja;if(qd===D){var Ra,ic,td,jc,Bb,fd,Jd,Kd;if(Ra=I,ic=ca(),ic!==D)if(td=da(),td!==D){jc=[];for(Bb=Q();Bb!==D;)jc.push(Bb),Bb=Q();jc!==D?(Bb=da(),Bb!==D?(fd=ea(),fd!==D?(ic={type:"case_expression",format:"searched",clauses:jc,"else":null},Ra=ic):(I=Ra,Ra=D)):(I=Ra,Ra=D)):(I=Ra,Ra=D)}else I=Ra,Ra=D;else I=Ra,Ra=D;
if(Ra===D)if(Ra=I,ic=ca(),ic!==D)if(td=da(),td!==D){jc=[];for(Bb=Q();Bb!==D;)jc.push(Bb),Bb=Q();jc!==D?(Bb=da(),Bb!==D?(fd=O(),fd!==D?(Jd=da(),Jd!==D?(Kd=ea(),Kd!==D?(ic={type:"case_expression",format:"searched",clauses:jc,"else":fd.value},Ra=ic):(I=Ra,Ra=D)):(I=Ra,Ra=D)):(I=Ra,Ra=D)):(I=Ra,Ra=D)):(I=Ra,Ra=D)}else I=Ra,Ra=D;else I=Ra,Ra=D;qd=Ra}a=qd;if(a===D){var gd,Ld,zc,ud,vd,wd;if(zc=I,ud=B(),ud!==D){vd=[];for(wd=G();wd!==D;)vd.push(wd),wd=G();vd!==D?(ud+=vd.join(""),zc=ud):(I=zc,zc=D)}else I=
zc,zc=D;a=(gd=(Ld=zc,Ld),gd!==D&&(gd={type:"column_ref",table:"",column:gd}),gd);a===D&&(a=N(),a===D&&(a=I,b=ua(),b!==D?(d=da(),d!==D?(g=c(),g!==D?(h=da(),h!==D?(k=wa(),k!==D?a=b=(g.paren=!0,g):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)))}}}}}}}return a}function C(){var a,b,c,d;if(a=I,b=B(),b!==D){c=[];for(d=F();d!==D;)c.push(d),d=F();c!==D?(b+=c.join(""),a=b):(I=a,a=D)}else I=a,a=D;return a}function B(){var a;return la.test(l.charAt(I))?(a=l.charAt(I),I++):(a=D,0===ia&&f(sb)),a}function F(){var a;
return Ya.test(l.charAt(I))?(a=l.charAt(I),I++):(a=D,0===ia&&f(pb)),a}function G(){var a;return Lb.test(l.charAt(I))?(a=l.charAt(I),I++):(a=D,0===ia&&f(jb)),a}function N(){var a,b,c;a=I;64===l.charCodeAt(I)?(b=Db,I++):(b=D,0===ia&&f(vb));b!==D?(c=C(),c!==D?(b=[b,c],a=b):(I=a,a=D)):(I=a,a=D);a!==D&&(a={type:"param",value:a[1]});return a}function M(){var a,b,c,d,e;a=(b=I,l.substr(I,7).toLowerCase()===Cc?(c=l.substr(I,7),I+=7):(c=D,0===ia&&f(rc)),c!==D?(d=I,ia++,e=F(),ia--,e===D?d=void 0:(I=d,d=D),d!==
D?(c="LEADING",b=c):(I=b,b=D)):(I=b,b=D),b);if(a===D){var g,h,k,n;a=(g=I,l.substr(I,8).toLowerCase()===La?(h=l.substr(I,8),I+=8):(h=D,0===ia&&f(sc)),h!==D?(k=I,ia++,n=F(),ia--,n===D?k=void 0:(I=k,k=D),k!==D?(h="TRAILING",g=h):(I=g,g=D)):(I=g,g=D),g);if(a===D){var m,p,q,r;a=(m=I,l.substr(I,4).toLowerCase()===Rb?(p=l.substr(I,4),I+=4):(p=D,0===ia&&f(Sb)),p!==D?(q=I,ia++,r=F(),ia--,r===D?q=void 0:(I=q,q=D),q!==D?(p="BOTH",m=p):(I=m,m=D)):(I=m,m=D),m)}}return a}function R(){var a;return a=P(),a===D&&
(a=N()),a}function P(){var a,b,c,d,e;if(a=I,39===l.charCodeAt(I)?(b=qb,I++):(b=D,0===ia&&f(ob)),b===D&&(l.substr(I,2)===fb?(b=fb,I+=2):(b=D,0===ia&&f(kc))),b!==D){c=[];d=I;l.substr(I,2)===wb?(e=wb,I+=2):(e=D,0===ia&&f(bc));e!==D&&(e="'");d=e;for(d===D&&(rb.test(l.charAt(I))?(d=l.charAt(I),I++):(d=D,0===ia&&f(Hb)));d!==D;)c.push(d),d=I,l.substr(I,2)===wb?(e=wb,I+=2):(e=D,0===ia&&f(bc)),e!==D&&(e="'"),d=e,d===D&&(rb.test(l.charAt(I))?(d=l.charAt(I),I++):(d=D,0===ia&&f(Hb)));c!==D?(39===l.charCodeAt(I)?
(d=qb,I++):(d=D,0===ia&&f(ob)),d!==D?(b={type:"string",value:c.join("")},a=b):(I=a,a=D)):(I=a,a=D)}else I=a,a=D;return a}function Q(){var a,b,d,e,f,g,h,k;return a=I,b=ja(),b!==D?(d=da(),d!==D?(e=c(),e!==D?(f=da(),f!==D?(g=na(),g!==D?(h=da(),h!==D?(k=c(),k!==D?(b={type:"when_clause",operand:e,value:k},a=b):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)):(I=a,a=D),a}function T(){var a,b,d,e,f,g,h,k;return a=I,b=ja(),b!==D?(d=da(),d!==D?(e=c(),e!==D?(f=da(),f!==D?(g=na(),g!==D?(h=da(),
h!==D?(k=c(),k!==D?(b={type:"when_clause",operand:e,value:k},a=b):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)):(I=a,a=D)):(I=a,a=D),a}function O(){var a,b,d,e;a=I;var g,h,k,n;return b=(g=I,l.substr(I,4).toLowerCase()===Mc?(h=l.substr(I,4),I+=4):(h=D,0===ia&&f($b)),h!==D?(k=I,ia++,n=F(),ia--,n===D?k=void 0:(I=k,k=D),k!==D?(h="ELSE",g=h):(I=g,g=D)):(I=g,g=D),g),b!==D?(d=da(),d!==D?(e=c(),e!==D?(b={type:"else_clause",value:e},a=b):(I=a,a=D)):(I=a,a=D)):(I=a,a=D),a}function S(){var a,b,c;return a=
W(),a===D&&(a=I,45===l.charCodeAt(I)?(b=aa,I++):(b=D,0===ia&&f(ya)),b===D&&(43===l.charCodeAt(I)?(b=ka,I++):(b=D,0===ia&&f(Ga))),b!==D?(c=W(),c!==D?(b=b[0]+c,a=b):(I=a,a=D)):(I=a,a=D)),a}function H(){var a,b,c;return a=I,46===l.charCodeAt(I)?(b=cc,I++):(b=D,0===ia&&f(lc)),b!==D?(c=W(),c===D&&(c=null),c!==D?(b="."+(null!=c?c:""),a=b):(I=a,a=D)):(I=a,a=D),a}function Y(){var a,b,c;a=I;var d,e,g;return b=(d=I,lb.test(l.charAt(I))?(e=l.charAt(I),I++):(e=D,0===ia&&f(Ac)),e!==D?(Cb.test(l.charAt(I))?(g=
l.charAt(I),I++):(g=D,0===ia&&f(Tb)),g===D&&(g=null),g!==D?(e="e"+(null===g?"":g),d=e):(I=d,d=D)):(I=d,d=D),d),b!==D?(c=W(),c!==D?(b+=c,a=b):(I=a,a=D)):(I=a,a=D),a}function W(){var a,b;if(a=[],b=E(),b!==D)for(;b!==D;)a.push(b),b=E();else a=D;return a!==D&&(a=a.join("")),a}function E(){var a;return Mb.test(l.charAt(I))?(a=l.charAt(I),I++):(a=D,0===ia&&f(ib)),a}function p(){var a,b,c,d;return a=I,l.substr(I,2).toLowerCase()===Ib?(b=l.substr(I,2),I+=2):(b=D,0===ia&&f(Ta)),b!==D?(c=I,ia++,d=F(),ia--,
d===D?c=void 0:(I=c,c=D),c!==D?(b="IN",a=b):(I=a,a=D)):(I=a,a=D),a}function A(){var a,b,c,d;return a=I,l.substr(I,2).toLowerCase()===Nb?(b=l.substr(I,2),I+=2):(b=D,0===ia&&f(Pb)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="IS",a=b):(I=a,a=D)):(I=a,a=D),a}function K(){var a,b,c,d;return a=I,l.substr(I,4).toLowerCase()===Ob?(b=l.substr(I,4),I+=4):(b=D,0===ia&&f(kb)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="LIKE",a=b):(I=a,a=D)):(I=a,a=D),a}function U(){var a,b,
c,d;return a=I,l.substr(I,3).toLowerCase()===Vb?(b=l.substr(I,3),I+=3):(b=D,0===ia&&f(Wb)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="NOT",a=b):(I=a,a=D)):(I=a,a=D),a}function V(){var a,b,c,d;return a=I,l.substr(I,3).toLowerCase()===Xb?(b=l.substr(I,3),I+=3):(b=D,0===ia&&f(Qa)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="AND",a=b):(I=a,a=D)):(I=a,a=D),a}function X(){var a,b,c,d;return a=I,l.substr(I,2).toLowerCase()===oc?(b=l.substr(I,2),I+=2):(b=D,0===ia&&f(dc)),
b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="OR",a=b):(I=a,a=D)):(I=a,a=D),a}function ba(){var a,b,c,d;return a=I,l.substr(I,7).toLowerCase()===Fb?(b=l.substr(I,7),I+=7):(b=D,0===ia&&f(Yb)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="BETWEEN",a=b):(I=a,a=D)):(I=a,a=D),a}function fa(){var a,b,c,d;return a=I,l.substr(I,4).toLowerCase()===Zb?(b=l.substr(I,4),I+=4):(b=D,0===ia&&f(pc)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="FROM",a=b):(I=a,a=D)):
(I=a,a=D),a}function ha(){var a,b,c,d;return a=I,l.substr(I,4).toLowerCase()===ab?(b=l.substr(I,4),I+=4):(b=D,0===ia&&f(db)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="TRIM",a=b):(I=a,a=D)):(I=a,a=D),a}function ca(){var a,b,c,d;return a=I,l.substr(I,4).toLowerCase()===nc?(b=l.substr(I,4),I+=4):(b=D,0===ia&&f(Jc)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="CASE",a=b):(I=a,a=D)):(I=a,a=D),a}function ea(){var a,b,c,d;return a=I,l.substr(I,3).toLowerCase()===Kc?(b=
l.substr(I,3),I+=3):(b=D,0===ia&&f(mb)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="END",a=b):(I=a,a=D)):(I=a,a=D),a}function ja(){var a,b,c,d;return a=I,l.substr(I,4).toLowerCase()===Ec?(b=l.substr(I,4),I+=4):(b=D,0===ia&&f(Fc)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=c,c=D),c!==D?(b="WHEN",a=b):(I=a,a=D)):(I=a,a=D),a}function na(){var a,b,c,d;return a=I,l.substr(I,4).toLowerCase()===Gc?(b=l.substr(I,4),I+=4):(b=D,0===ia&&f(Lc)),b!==D?(c=I,ia++,d=F(),ia--,d===D?c=void 0:(I=
c,c=D),c!==D?(b="THEN",a=b):(I=a,a=D)):(I=a,a=D),a}function za(){var a;return 44===l.charCodeAt(I)?(a=tc,I++):(a=D,0===ia&&f(Nc)),a}function ua(){var a;return 40===l.charCodeAt(I)?(a=Oc,I++):(a=D,0===ia&&f(ub)),a}function wa(){var a;return 41===l.charCodeAt(I)?(a=Pc,I++):(a=D,0===ia&&f(qa)),a}function da(){var a,b;a=[];for(b=ra();b!==D;)a.push(b),b=ra();return a}function ra(){var a;return Na.test(l.charAt(I))?(a=l.charAt(I),I++):(a=D,0===ia&&f(gb)),a}function ga(a,b,c,d){a={type:"binary_expr",operator:a,
left:b,right:c};return void 0!==d&&(a.escape=d),a}function pa(a,b){for(var c=0;c<b.length;c++)a=ga(b[c][1],a,b[c][3]);return a}h=void 0!==h?h:{};var J,D={},Ea={start:a},L=a,Fa="!",sa=d("!",!1),Z="\x3d",ma=d("\x3d",!1),Pa="\x3e\x3d",Ia=d("\x3e\x3d",!1),Ha="\x3e",Xa=d("\x3e",!1),oa="\x3c\x3d",Ma=d("\x3c\x3d",!1),Ka="\x3c\x3e",va=d("\x3c\x3e",!1),Wa="\x3c",Za=d("\x3c",!1),Ba="!\x3d",Va=d("!\x3d",!1),ka="+",Ga=d("+",!1),aa="-",ya=d("-",!1),Aa="*",Ca=d("*",!1),ta="/",xa=d("/",!1),la=/^[A-Za-z_\x80-\uFFFF]/,
sb=b([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Ya=/^[A-Za-z0-9_]/,pb=b([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Lb=/^[A-Za-z0-9_.\x80-\uFFFF]/,jb=b([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Db="@",vb=d("@",!1),qb="'",ob=d("'",!1),fb="N'",kc=d("N'",!1),wb="''",bc=d("''",!1),rb=/^[^']/,Hb=b(["'"],!0,!1),cc=".",lc=d(".",!1),Mb=/^[0-9]/,ib=b([["0","9"]],!1,!1),lb=/^[eE]/,Ac=b(["e","E"],!1,!1),Cb=/^[+\-]/,Tb=b(["+","-"],!1,!1),hd="null",id=d("NULL",!0),Tc="true",Uc=
d("TRUE",!0),jd="false",ld=d("FALSE",!0),Ib="in",Ta=d("IN",!0),Nb="is",Pb=d("IS",!0),Ob="like",kb=d("LIKE",!0),Ub="escape",cb=d("ESCAPE",!0),Vb="not",Wb=d("NOT",!0),Xb="and",Qa=d("AND",!0),oc="or",dc=d("OR",!0),Fb="between",Yb=d("BETWEEN",!0),Zb="from",pc=d("FROM",!0),Hc="for",Ed=d("FOR",!0),Ic="substring",qc=d("SUBSTRING",!0),Vc="extract",Wc=d("EXTRACT",!0),ab="trim",db=d("TRIM",!0),xb="position",bb=d("POSITION",!0),tb="timestamp",Eb=d("TIMESTAMP",!0),Qb="date",xd=d("DATE",!0),Cc="leading",rc=d("LEADING",
!0),La="trailing",sc=d("TRAILING",!0),Rb="both",Sb=d("BOTH",!0),Fd="year",kd=d("YEAR",!0),$a="month",mc=d("MONTH",!0),Bc="day",yd=d("DAY",!0),zd="hour",Ad=d("HOUR",!0),Dc="minute",Xc=d("MINUTE",!0),Cd="second",Bd=d("SECOND",!0),nc="case",Jc=d("CASE",!0),Kc="end",mb=d("END",!0),Ec="when",Fc=d("WHEN",!0),Gc="then",Lc=d("THEN",!0),Mc="else",$b=d("ELSE",!0),tc=",",Nc=d(",",!1),Oc="(",ub=d("(",!1),Pc=")",qa=d(")",!1),Na=/^[ \t\n\r]/,gb=b([" ","\t","\n","\r"],!1,!1),md="`",nd=d("`",!1),od=/^[^`]/,pd=b(["`"],
!0,!1),I=0,ac=[{line:1,column:1}],eb=0,Gb=[],ia=0;if("startRule"in h){if(!(h.startRule in Ea))throw Error("Can't start parsing from rule \""+h.startRule+'".');L=Ea[h.startRule]}if(J=L(),J!==D&&I===l.length)return J;throw J!==D&&I<l.length&&f({type:"end"}),function(a,b,c){return new m(m.buildMessage(a,b),a,b,c)}(Gb,eb<l.length?l.charAt(eb):null,eb<l.length?k(eb,eb+1):k(eb,eb));}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","dojo/regexp"],function(m,l,h){Object.defineProperty(l,
"__esModule",{value:!0});l.evaluateFunction=function(b,g){var h=d[b.toLowerCase()];if(null==h)throw Error("Function Not Recognised");if(g.length<h.minParams||g.length>h.maxParams)throw Error("Invalid Parameter count for call to "+b.toUpperCase());return h.evaluate(g)};l.isStandardized=function(b,g){b=d[b.toLowerCase()];return null!=b&&g>=b.minParams&&g<=b.maxParams};var d={extract:{minParams:2,maxParams:2,evaluate:function(b){var d=b[0];b=b[1];if(null==b)return null;if(b instanceof Date)switch(d.toUpperCase()){case "SECOND":return b.getSeconds();
case "MINUTE":return b.getMinutes();case "HOUR":return b.getHours();case "DAY":return b.getDate();case "MONTH":return b.getMonth()+1;case "YEAR":return b.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(b){if(2===b.length){var d=b[0],h=b[1];return null==d||null==h?null:d.toString().substring(h-1)}if(3===b.length)return d=b[0],h=b[1],b=b[2],null==d||null==h||null==b?null:0>=b?"":d.toString().substring(h-1,h+b-1)}},position:{minParams:2,
maxParams:2,evaluate:function(b){var d=b[0];b=b[1];return null==d||null==b?null:b.indexOf(d)+1}},trim:{minParams:2,maxParams:3,evaluate:function(b){var d=3===b.length,k=d?b[1]:" ",d=d?b[2]:b[1];if(null==k||null==d)return null;k="("+h.escapeString(k)+")";switch(b[0]){case "BOTH":return d.replace(new RegExp("^"+k+"*|"+k+"*$","g"),"");case "LEADING":return d.replace(new RegExp("^"+k+"*","g"),"");case "TRAILING":return d.replace(new RegExp(k+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");
}},abs:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:Math.abs(b[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:Math.ceil(b[0])}},floor:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:Math.floor(b[0])}},log:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:Math.log(b[0])}},log10:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:Math.log(b[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,
evaluate:function(b){return null==b[0]?null:Math.sin(b[0])}},cos:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:Math.cos(b[0])}},tan:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:Math.tan(b[0])}},asin:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:Math.asin(b[0])}},acos:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:Math.acos(b[0])}},atan:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:Math.atan(b[0])}},
sign:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:0<b[0]?1:0>b[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(b){return null==b[0]||null==b[1]?null:Math.pow(b[0],b[1])}},mod:{minParams:2,maxParams:2,evaluate:function(b){return null==b[0]||null==b[1]?null:b[0]%b[1]}},round:{minParams:1,maxParams:2,evaluate:function(b){var d=b[0];b=2===b.length?Math.pow(10,b[1]):1;return null==d?null:Math.round(d*b)/b}},truncate:{minParams:1,maxParams:2,evaluate:function(b){return null==
b[0]?null:1===b.length?parseInt(b[0].toFixed(0),10):parseFloat(b[0].toFixed(b[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(b){return"string"==typeof b[0]||b[0]instanceof String?b[0].length:0}},concat:{minParams:1,maxParams:1/0,evaluate:function(b){for(var d="",h=0;h<b.length;h++){if(null==b[h])return null;d+=b[h].toString()}return d}},lower:{minParams:1,maxParams:1,evaluate:function(b){return null==b[0]?null:b[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(b){return null==
b[0]?null:b[0].toString().toUpperCase()}}}})},"esri/views/3d/layers/SceneLayerView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../layers/IntegratedMeshLayer ../../../core/arrayUtils ../../../core/watchUtils ../../../core/promiseUtils ../../../core/Logger ../../../core/Collection ../../../core/Scheduler ../../../core/lang ../../../geometry/support/scaleUtils ../../../symbols/support/unitConversionUtils dojo/_base/lang dojo/has dojo/errors/CancelError ../../../Graphic ../../../symbols/Symbol3D ../../../tasks/support/Query ./LayerView3D ./i3s/I3SUtil ./i3s/I3SElevationProvider ./i3s/I3SGeometryUtil ./i3s/I3SProjectionUtil ./i3s/I3SQueryEngine ./i3s/Highlights ./i3s/IDBCache ./graphics/graphicUtils ./support/LayerViewUpdatingPercentage ../support/projectionUtils ../support/aaBoundingBox ../webgl-engine/Stage ../webgl-engine/lib/Layer ../webgl-engine/lib/Geometry ../webgl-engine/lib/PreinterleavedGeometryData ../webgl-engine/lib/Object3D ../webgl-engine/lib/Texture ../webgl-engine/materials/Material ./support/attributeUtils ../webgl-engine/lib/Util ../lib/glMatrix".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P,Q,T,O,S,H,Y,W,E,p,A,K,U,V,X){function ba(a,b,c,d,e){var f,g=!1;b.encoding===B.DDS_ENCODING_STRING?f=A.DDS_ENCODING:g=!(V.isPowerOfTwo(a.width)&&V.isPowerOfTwo(a.height));c=((a=b.usedByEngineMats.some(function(a){return a.getParams().atlasRegions})||b.atlas)?d:c)&&!g;return{mipmap:c,wrapClamp:a||!b.wrap,disableAnisotropy:a&&c&&e,encoding:f,noUnpackFlip:!0}}function fa(a){return a.data instanceof ArrayBuffer}function ha(a,b){for(var c=
1024,d=0;d<a.length;d++)c+=a[d].interleavedVertexData.byteLength;for(a=0;a<b.length;a++)d=b[a],d.data instanceof ArrayBuffer&&(c+=d.data.byteLength);return c}var ca=H.ModelContentType,ea=e.getLogger("esri.views.3d.layers.SceneLayerView3D"),ja=[1,1,1,1],na=[.8,.8,.8],za=[.5,.5,.5];m=function(e){function l(){var a=null!==e&&e.apply(this,arguments)||this;return a._queryEngine=null,a._highlights=new R(a),a._elevationProvider=null,a._controllerCreated=!1,a._idbCache=new P.IDBCache("esri-scenelayer-cache",
"geometries",4),a._cancelCount=0,a._hasColors=!1,a._hasTextures=!1,a._hasData=!1,a.alwaysLoadEverythingModeEnabled=!1,a._cacheKeySuffix=null,a._definitionExpressionErrors=0,a._maxDefinitionExpressionErrors=20,a}return h(l,e),Object.defineProperty(l.prototype,"hasTexturesOrVertexColors",{get:function(){return this._hasData?this._hasTextures||this._hasColors?"yes":"probably-not":"unknown"},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"rendererNeedsTextures",{get:function(){return B.rendererNeedsTextures(this.layer.renderer)},
enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"elevationOffset",{get:function(){var a=null!=this.layer?this.layer.elevationInfo:null;if(null!=a&&"absolute-height"===a.mode){var b=r.getMetersPerVerticalUnitForSR(this.layer.spatialReference),c=u.getMetersPerUnit(a.unit);return(a.offset||0)*c/b}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"uncompressedTextureDownsamplingEnabled",{get:function(){return this.view.qualitySettings.sceneService.uncompressedTextureDownsamplingEnabled&&
!this._useCompressedTextures},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"_useCompressedTextures",{get:function(){var a=this.layer.version,a=!x("trident")||1<a.major||1===a.major&&3<a.minor;return this.view.has("s3tc")&&a},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"_enableMipMaps",{get:function(){return!this.uncompressedTextureDownsamplingEnabled},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"_enableAtlasMipMaps",{get:function(){return this._enableMipMaps&&
this.view.has("standardDerivatives")},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"_atlasBiasCompensationEnabled",{get:function(){return!this.view.has("shaderTextureLOD")&&this._enableAtlasMipMaps},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"_disableAtlasAnisotropy",{get:function(){return this._atlasBiasCompensationEnabled},enumerable:!0,configurable:!0}),l.prototype.initialize=function(){var a=this;B.checkSceneLayerValid(this.layer);B.checkSceneLayerCompatibleWithView(this.layer,
this.view);this._initGraphicsController();this.maxGpuMemory=1E3;this.geoMemoryEstimate=this.texMemoryEstimate=this.gpuMemoryEstimate=0;this._stage=this.view._stage;this._matId2Meta={};this._texId2Meta={};this._nodeId2Meta={};this._addThisLayerToStage();this._elevationProvider=new F({layerView:this,stageLayer:this._stageLayer});this.handles.add([f.init(this.view,"clippingArea",function(){return a._clippingAreaChanged()}),f.init(this.layer,"renderer",function(b){return a._rendererChange(b)}),f.init(this.layer,
"objectIdFilter",function(){return a._filterChange()}),f.init(this.layer,"elevationInfo",function(){return a._elevationInfoChanged()}),f.init(this,"_controller.parsedDefinitionExpression",function(){return a._filterChange()}),f.watch(this,"fullOpacity",function(b){return a._opacityChange(b)}),f.watch(this,["elevationOffset","rendererNeedsTextures"],function(){return a._reloadAll()}),f.watch(this,"uncompressedTextureDownsamplingEnabled",function(){return a._reloadAll()}),f.init(this,"suspended",function(b){return a.setVisibility(!b)})],
"sceneLayerHandles");this._idbCache.init();this._cacheKeySuffix=B.getCacheKeySuffix(this.layer.spatialReference,this.view.renderSpatialReference)},l.prototype.destroy=function(){this.handles.remove("sceneLayerHandles");this._removeThisLayerFromStage();this._stage=null;this._idbCache&&(this._idbCache.destroy(),this._idbCache=null);null!=this._controller&&(this._controller.destroy(),this._controller=null);this._highlights.destroy();this._nodeId2Meta=this._texId2Meta=this._matId2Meta=null;this.emit("visible-geometry-changed");
this._visibleGeometryChangedSchedulerHandle&&(this._visibleGeometryChangedSchedulerHandle.remove(),this._visibleGeometryChangedSchedulerHandle=null)},l.prototype.canResume=function(){return this.inherited(arguments)&&(!this._controller||this._controller.rootNodeVisible)},l.prototype.isUpdating=function(){return this._controllerCreated?!(!this._controller||!this._controller.updating):!0},l.prototype.memEstimateTextureAdded=function(a){a=a.getEstimatedTexMemRequiredMB();this.gpuMemoryEstimate+=a;this.texMemoryEstimate+=
a},l.prototype.memEstimateTextureRemoved=function(a){a=a.getEstimatedTexMemRequiredMB();this.gpuMemoryEstimate-=a;this.texMemoryEstimate-=a},l.prototype.memEstimateGeometryAdded=function(a){a=a.estimateGpuMemoryUsage()/1E6;this.gpuMemoryEstimate+=a;this.geoMemoryEstimate+=a},l.prototype.memEstimateGeometryRemoved=function(a){a=a.estimateGpuMemoryUsage()/1E6;this.gpuMemoryEstimate-=a;this.geoMemoryEstimate-=a},l.prototype.isBundleAlreadyAddedToStage=function(a,b){return null!=this._nodeId2Meta[a.id]&&
null!=this._nodeId2Meta[a.id].engineObjectsPerBundle&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle[b]},l.prototype._initGraphicsController=function(){var a=this;this.layer.createGraphicsController({layerView:this,layerViewRequiredFunctions:{addBundle:function(b,c,d){return a._addBundle(b,c,d)},isBundleAlreadyAddedToStage:function(b,c){return a.isBundleAlreadyAddedToStage(b,c)},isOverMemory:function(){return a._isOverMemory()},removeNodeData:function(b){return a._removeNodeDataFromStage(b.id)},
getAddedNodeIDs:function(){return a._getAddedNodeIDs()},areAllBundlesLoaded:function(b){return a._areAllBundlesLoaded(b)}},layerViewOptionalFunctions:{setPolygonOffset:function(b,c){return a._setPolygonOffset(b,c?1:0)},traversalOptions:{initDepthFirst:!1,neighborhood:!0,perLevelTraversal:!1,allowPartialOverlaps:!1},textureOptions:{useCompressedTextures:this._useCompressedTextures},getLoadedAttributes:function(b){return a._getLoadedAttributes(b)},setAttributeData:function(b,c,d){return a._setAttributeData(b,
c,d)},additionalCancelNodeLoadingHandler:function(){return a._cancel()},loadCachedBundle:function(b,c,d){return a._loadCachedBundle(b,c,d)},addCachedBundle:function(b,c,d,e){return a._addCachedBundle(b,c,d,e)}}}).then(function(b){a._controller=b;b.watch("rootNodeVisible",function(){a.notifyChange("suspended")})}).always(function(){a._controllerCreated=!0;a.notifyChange("updating")})},l.prototype.setMaxGpuMemory=function(a){this.maxGpuMemory=a},l.prototype.setVisibility=function(a){if(this._stage&&
this._stageLayer){var b=this._stageLayer.getId(),c=0<=this._stage.getViewContent().indexOf(b);!!a!==c&&(b=[b],a?(this._stage.addToViewContent(b),a=this._isIntegratedMesh()?"im":"scene",this.view.elevationProvider.register(a,this._elevationProvider),this.visibleGeometryChanged()):(this._stage.removeFromViewContent(b),this.visibleGeometryChanged(),this.view.elevationProvider.unregister(this._elevationProvider)))}},l.prototype.getStats=function(){var a={nodesInIndex:0,knownFeatures:0,activeMaterials:0,
"Total GPU Memory Estimate":this.gpuMemoryEstimate+"MB","Geometry Memory Estimate":this.geoMemoryEstimate+"MB","Texture Memory Estimate":this.texMemoryEstimate+"MB"};return this._controller?(a.nodesInIndex=Object.keys(this._controller.nodeIndex).length,a.activeMaterials=Object.keys(this._matId2Meta).length,a):a},l.prototype._addThisLayerToStage=function(){for(var a=this._stage,b=new Uint8Array(256),c=0;c<b.length;c++)b[c]=255;this._whiteTexture=new A(b,"white",{width:8,height:8});a.add(ca.TEXTURE,
this._whiteTexture);b=this.layer.id;this._stageLayer=b=new Y(b,{},b);a.add(ca.LAYER,b)},l.prototype._removeThisLayerFromStage=function(){if(null!=this._stageLayer){var a=this._stage;a.remove(ca.TEXTURE,this._whiteTexture.getId());this._removeAllNodeDataFromStage();V.assert(V.objectEmpty(this._nodeId2Meta));V.assert(V.objectEmpty(this._matId2Meta));V.assert(V.objectEmpty(this._texId2Meta));a.remove(ca.LAYER,this._stageLayer.getId());this._matId2Meta={};this._texId2Meta={};this._nodeId2Meta={};this._stageLayer=
void 0;this.gpuMemoryEstimate=0}},l.prototype._getLoadedAttributes=function(a){return(a=this._nodeId2Meta[a.id])&&1===a.engineObjects.length?a.engineObjects[0].getMetadata().loadedAttributes:void 0},l.prototype._setAttributeData=function(a,b,c){var d=this._nodeId2Meta[a.id];if(d&&1===d.engineObjects.length){var d=d.engineObjects[0],e=d.getMetadata();e.loadedAttributes=b;e.attributeData=c;this._setObjectSymbology(d);this._applyFilters(a);this.visibleGeometryChanged(d)}},l.prototype._isOverMemory=function(){if(this.gpuMemoryEstimate>
this.maxGpuMemory&&this.gpuMemoryEstimate!==this.warnGpuMemoryEstimate){this.warnGpuMemoryEstimate=this.gpuMemoryEstimate;var a=function(a){return a.toLocaleString(void 0,{maximumFractionDigits:1})+" Mb"};ea.warn("GPU Memory Limit exceeded!\nLimit: "+a(this.maxGpuMemory)+" Current: "+a(this.gpuMemoryEstimate)+"\n(Textures: "+a(this.texMemoryEstimate)+" Geometry: "+a(this.geoMemoryEstimate)+")")}return this.gpuMemoryEstimate>this.maxGpuMemory},l.prototype._getAddedNodeIDs=function(){return Object.keys(this._nodeId2Meta)},
l.prototype._calcEngineMaterialTransparencyParams=function(a,b,c){var d=this.fullOpacity,e=1-V.clamp(V.fallbackIfUndefined(b.transparency,0),0,1);a=1>e||1>d||a&&t.endsWith(a.channels,"a")||!0===b.useVertexColorAlpha||c;return{opacity:e,layerOpacity:d,transparent:a}},l.prototype._calcEngineMaterialDoubleSidedParams=function(a){return null!=a.doubleSided?a.doubleSided:!0},l.prototype._calcEngineMaterialCullFaceParams=function(a){return a.cullFace?a.cullFace:null!=a.doubleSided?a.doubleSided?"none":
"back":"none"},l.prototype._getMaterialParameters=function(a,b,c){var d;null!=a&&(d=(d=this._texId2Meta[b])&&d.engineTex?d.engineTex.getId():this._whiteTexture.getId());b=c.params;var e=V.fallbackIfUndefined(b.diffuse,na);"standard"!==c.type&&ea.warn("Unknown material type '"+c.type+"', must be 'standard'");void 0===b.reflectivity&&ea.warn("Material parameter 'reflectivity' is missing.");c=this._isIntegratedMesh();d={ambient:e,diffuse:e,specular:V.fallbackIfUndefined(b.specular,za),shininess:V.fallbackIfUndefined(b.shininess,
64),atlasRegions:b.vertexRegions,textureId:d,vertexColors:this._hasVertexColors(),symbolColors:this._hasSymbolColors(),flipV:!1,doubleSided:this._calcEngineMaterialDoubleSidedParams(b),cullFace:this._calcEngineMaterialCullFaceParams(b),writeStencil:c,receiveSSAO:!c,groundNormalShading:c};c||(a=this._calcEngineMaterialTransparencyParams(a,b),v.mixin(d,a));return d},l.prototype._createEngineMaterial=function(a,b,c,d,e){var f=null!=a?this._getI3STexEncoding(a):null,g=this._getMaterialParameters(a,b,
c),g=new K(g,d);if(g.metadata={i3sMatId:d,i3sTexId:b,i3sTex:a,i3sMatParams:c.params},null!=a){(c=this._texId2Meta[b])?c.usedByEngineMats.push(g):(c={id:b,usedByEngineMats:[g],images:a.images,encoding:f,atlas:!0===a.atlas,wrap:"none"!==a.wrap[0]||"none"!==a.wrap[1]},this._texId2Meta[b]=c);a:{for(a=0;a<e.length;a++)if(f=e[a],f.i3sTexId===b){e=f.data;break a}e=null}null!=e&&null==c.engineTex&&(a=ba(e,c,this._enableMipMaps,this._enableAtlasMipMaps,this._disableAtlasAnisotropy),c.engineTex=new A(e,c.id,
a),this._stage.add(ca.TEXTURE,c.engineTex),this.memEstimateTextureAdded(c.engineTex));if(null!=c.engineTex)for(e=c.engineTex.getId(),a=0,c=c.usedByEngineMats;a<c.length;a++)c[a].setParameterValues({textureId:e})}return this._matId2Meta[d]||(this._matId2Meta[d]={}),this._matId2Meta[d][b]={engineMat:g,refCount:1},g},l.prototype._getI3STexEncoding=function(a){var b=B.getAppropriateTextureEncoding(a.encoding,this._useCompressedTextures);return-1<b?a.encoding[b]:a.encoding},l.prototype._hasNonWhiteColors=
function(a){var b=a.data,c=a.size,d=a.strideIdx;for(a=a.offsetIdx;a<b.length;a+=d)for(var e=0;c>e;e++)if(255!==b[a+e])return!0;return!1},l.prototype._getVertexBufferLayout=function(a,b){var c=a.params.materialID,d=b.materialDefinitions[c];V.assert(void 0!==d,"geometry wants unknown material "+c);var e;a=a.params.textureID||"none";"none"!==a&&((null==b.textureDefinitions||null==b.textureDefinitions[a])&&ea.warn("textureDefinitions missing in shared resource"),e=b.textureDefinitions[a]);b=this._getMaterialParameters(e,
a,d);return K.getVertexBufferLayout(b)},l.prototype._createEngineMat=function(a,b,c){var d=a.params.materialID,e=b.materialDefinitions[d];V.assert(void 0!==e,"geometry wants unknown material "+d);var f;a=a.params.textureID||"none";"none"!==a&&((null==b.textureDefinitions||null==b.textureDefinitions[a])&&ea.warn("textureDefinitions missing in shared resource"),f=b.textureDefinitions[a]);this._matId2Meta[d]&&this._matId2Meta[d][a]?(c=this._matId2Meta[d][a],b=c.engineMat,c.refCount++):b=this._createEngineMaterial(f,
a,e,d,c);return b},l.prototype._areAllBundlesLoaded=function(a){if(null==this._nodeId2Meta[a.id]||null==this._nodeId2Meta[a.id].engineObjectsPerBundle)return!1;for(var b=0;b<a.featureData.length;b++)if(null==this._nodeId2Meta[a.id].engineObjectsPerBundle[b])return!1;return!0},l.prototype._getObjectIdField=function(){return this.layer.objectIdField||"OBJECTID"},l.prototype._findGraphicNodeAndIndex=function(a){a=U.attributeLookup(a.attributes,this._getObjectIdField());for(var b=0,c=Object.keys(this._nodeId2Meta);b<
c.length;b++)for(var d=c[b],e=this._nodeId2Meta[d].engineObjects,f=0;f<e.length;f++){var g=e[f].getMetadata().featureIds.indexOf(a);if(-1!==g)return{node:this._controller.nodeIndex[d],nodeId:d,bundleNr:f,index:g}}return null},l.prototype._getGraphicIndices=function(a,b,c){a=this._nodeId2Meta[a.id].engineObjects;if(!a||!a[b])return[];b=a[b].getMetadata();a=[];for(var d=this._getObjectIdField(),e=0;e<c.length;e++){var f=U.attributeLookup(c[e].attributes,d),f=b.featureIds.indexOf(f);-1!==f&&a.push(f)}return a},
l.prototype.whenGraphicBounds=function(b){b=this._findGraphicNodeAndIndex(b);if(null!=b&&(b=this._boundingBoxCornerPoints(b.index,this._nodeId2Meta[b.nodeId].engineObjects[b.bundleNr],new Float64Array(24)),O.bufferToBuffer(b,this.view.renderSpatialReference,0,b,this.view.spatialReference,0,8))){var c=S.create(S.NEGATIVE_INFINITY);return S.expandBuffer(c,b,0,8),a.resolve({boundingBox:c,screenSpaceObjects:[]})}return a.reject()},l.prototype.whenGraphicAttributes=function(a,b){var c=this;return B.whenGraphicAttributes(this.layer,
[a],this._getObjectIdField(),b,function(){var b=c._findGraphicNodeAndIndex(a);return{node:b.node,indices:[b.index]}},{ignoreUnavailableFields:!0,populateObjectId:!0}).then(function(a){return a[0]})},l.prototype.getGraphicsFromStageObject=function(b,c){if(this.layer instanceof g)return a.reject();var d=b.getMetadata();b=b.getComponentFromTriangleNr(0,c);return null!=b&&null!=d.featureIds&&b<d.featureIds.length?(d=this._createGraphic(b,d),a.resolve(d)):a.reject()},l.prototype._getCacheKey=function(a){return a.baseUrl+
this._cacheKeySuffix},l.prototype._cachingEnabled=function(){return!this._controller.disableCache&&0===this.elevationOffset&&null!=this._cacheKeySuffix},l.prototype._cancel=function(){this._cancelCount=this._cancelCount+1|0},l.prototype._handleCancelled=function(a){if(0<(this._cancelCount-a|0))throw new y;},l.prototype._loadCachedBundle=function(b,c,d){var e=this,f=this._cancelCount;return this._cachingEnabled()?this._idbCache.get(this._getCacheKey(b)).then(function(a){if(null==a)return null;if(e._handleCancelled(f),
a.nodeVersion!==b.version)return e._idbCache.remove(e._getCacheKey(b)),null;var c=function(b){if(null==b.data)return!0;var c=e._getI3STexEncoding(a.sharedResource.textureDefinitions[b.i3sTexId]);return b.encoding!==c};return e.rendererNeedsTextures&&a.textureData.some(c)?d(a.allGeometryData,a.sharedResource).then(function(c){return a.textureData=c,c.every(fa)&&e._idbCache.put(e._getCacheKey(b),a).otherwise(function(){return ea.warn("Failed to update node with textures in IndexedDB cache: "+b.id)}),
e._handleCancelled(f),a}):a}):a.resolve(null)},l.prototype._addBundle=function(a,b,c){var d=this;return this._transformBundle(a,b,c).then(function(e){if(d._cachingEnabled()){var f=e.allGeometryData,g=e.transformedGeometries,h=e.sharedResource,k=e.byteSize,l=e.textureData.map(function(a){return fa(a)?a:{i3sTexId:a.i3sTexId,encoding:a.encoding,data:null}});d._idbCache.put(d._getCacheKey(a),{allGeometryData:f,transformedGeometries:g,textureData:l,sharedResource:h,nodeVersion:a.version,byteSize:k}).otherwise(function(){return ea.warn("Failed to store node in IndexedDB cache: "+
a.id)})}return d._addCachedBundle(a,b,e,c.attributeDataInfo)})},l.prototype._transformBundle=function(b,c,d){c=d.allGeometryData;var e=d.geometryBuffer,f=d.textureData,g=d.sharedResource,h=this._hasColors,k=[];for(d=0;d<c.length;d++)for(var l=c[d],n=l.componentOffsets,m=function(a){var c=p._getVertexBufferLayout(a,g);a=G.interleaveGeometryBuffer(a,e,c,[{name:V.VertexAttrConstants.NORMAL,byteValue:0},{name:V.VertexAttrConstants.COLOR,byteValue:255},{name:V.VertexAttrConstants.SYMBOLCOLOR,byteValue:0}]);
var d=new E(new Float32Array(a),c,n||E.DefaultOffsets),f=p._controller.crsIndex,l=p._controller.crsVertex,m=p.view.renderSpatialReference,q=X.vec4d.set(b.mbs,ra);q[2]+=p.elevationOffset;l=N.reprojectPoints(N.ReprojectionTypes.PER_VERTEX,d.getAttribute(V.VertexAttrConstants.POSITION),q,f,l,m);if(!p._isIntegratedMesh()&&p._controller.isMeshPyramid){var r={normals:d.getAttribute(V.VertexAttrConstants.NORMAL),positions:d.getAttribute(V.VertexAttrConstants.POSITION),normalInd:d.getIndices(V.VertexAttrConstants.NORMAL),
positionInd:d.getIndices(V.VertexAttrConstants.POSITION)};B.processNormals(r,p.layer.normalReferenceFrame||"none",function(a,b){return N.reprojectNormalsPerVertex(a,q,f,b,m)})}(d=d.getAttribute(V.VertexAttrConstants.COLOR))&&(h=h||p._hasNonWhiteColors(d));k.push({layout:c,interleavedVertexData:a,corMatrices:l,hasNonWhiteColors:h})},p=this,q=0,l=l.geometries;q<l.length;q++)m(l[q]);return a.resolve({allGeometryData:c,transformedGeometries:k,textureData:f,sharedResource:g,nodeVersion:b.version,byteSize:ha(k,
f)})},l.prototype._addCachedBundle=function(b,c,d,e){if(this._isOverMemory())return a.reject();var f=d.allGeometryData,g=d.transformedGeometries,h=d.textureData,k=d.sharedResource;if(!this.rendererNeedsTextures)for(d=0;d<h.length;d++)h[d].data=null;d=this._stage;var l={};l[ca.OBJECT]={};l[ca.GEOMETRY]={};l[ca.MATERIAL]={};l[ca.TEXTURE]={};var n=this._stageLayer,m=n.getId();if(null!=this._nodeId2Meta[b.id]&&null!=this._nodeId2Meta[b.id].engineObjectsPerBundle&&this._nodeId2Meta[b.id].engineObjectsPerBundle[c])return this._applyFilters(b),
a.resolve();null==this._nodeId2Meta[b.id]&&(this._nodeId2Meta[b.id]={engineObjects:[],engineObjectsPerBundle:[]});this._nodeId2Meta[b.id].engineObjectsPerBundle[c]=[];for(var q=0,r=this._hasColors,t=0;t<f.length;t++){for(var u=f[t],v=u.componentOffsets,w=u.featureIds,x=b.id+"|"+w[0],y=[],z=[],A=[],C=void 0,B=0,u=u.geometries;B<u.length;B++){var F=u[B],D=this._createEngineMat(F,k,h),C=g[q++],r=r||C.hasNonWhiteColors,H=new E(new Float32Array(C.interleavedVertexData),C.layout,v||E.DefaultOffsets),C=
C.corMatrices,K=X.mat4d.create(C.localTrafo);null!=F.transformation&&X.mat4d.multiply(K,F.transformation,K);F=y.length;H=new W(H,x+(0<F?"_"+F:""));y.push(H);z.push(K);A.push([D]);this.memEstimateGeometryAdded(H.getData());l[ca.MATERIAL][D.getId()]=D;l[ca.GEOMETRY][H.getId()]=H}v=new p({idHint:b.id,name:x,geometries:y,materials:A,transformations:z,castShadow:!0,metadata:{i3sNode:b.id,ceLayer:m,featureIds:w,attributeData:e?e.attributeData:null,loadedAttributes:e?e.loadedAttributes:null,layerUid:this.layer.uid}});
w=X.mat4d.create();X.mat4d.identity(w);X.mat4d.multiply(w,C.globalTrafo,w);v.setObjectTransformation(w);this._nodeId2Meta[b.id].engineObjectsPerBundle[c].push(v);this._nodeId2Meta[b.id].engineObjects.push(v);l[ca.OBJECT][v.getId()]=v;this._setObjectSymbology(v);this._applyFilters(b);this._highlights.objectCreated(v);this.visibleGeometryChanged(v)}d.beginMod();c=l[ca.OBJECT];for(var G in c)c.hasOwnProperty(G)&&n.addObject(c[G]);for(var N in l)if(l.hasOwnProperty(N)){G=l[N];for(var M in G)G.hasOwnProperty(M)&&
null==d.get(N,M)&&d.add(N,G[M])}return d.endMod(),!this._hasTextures&&null!=b.textureData&&0<b.textureData.length&&(this._hasTextures=!0),this._hasColors=r,this._hasData=!0,this.notifyChange("hasTexturesOrVertexColors"),a.resolve()},l.prototype._clippingAreaChanged=function(){var a=this,b=[];if(O.extentToBoundingBox(this.view.clippingArea,b,this.view.renderSpatialReference)?this._clippingArea=b:this._clippingArea=null,this._updateFilters(),this._controller){var c=this._controller.nodeIndex;c&&Object.keys(this._nodeId2Meta).forEach(function(b){return a._applyFilters(c[b])});
this._controller.updateClippingArea(this.view.clippingArea)}},l.prototype._filterChange=function(){if(this._updateFilters(),this._controller){var a=this._controller.nodeIndex;if(a)for(var b=0,c=Object.keys(this._nodeId2Meta);b<c.length;b++)this._applyFilters(a[c[b]])}},l.prototype._updateFilters=function(){var a=this,b=[];if(this.layer.objectIdFilter){var c=new Float64Array(this.layer.objectIdFilter.ids),d="include"===this.layer.objectIdFilter.method;c.sort();b.push(function(b,e){return a._objectIdFilter(c,
d,e)})}if(this._controller&&this._controller.parsedDefinitionExpression&&this._controller.definitionExpressionFields){this._definitionExpressionErrors=0;var e=this._controller.parsedDefinitionExpression,f=this._controller.definitionExpressionFields;b.push(function(b,c){return a._sqlFilter(b,e,f,c)})}this._clippingArea&&b.push(function(b,c){return a._boundingboxFilter(b,a._clippingArea,c)});this._filters=b},l.prototype._sqlFilter=function(a,b,c,d){var e={},f=new n(null,null,e);f.layer=this.layer;var g=
this.layer.objectIdField,h=0,k=0,l=function(a){var l=a.getMetadata();a=l.featureIds;for(var n=l.attributeData,l=c.every(function(a){return null!=n[a]||a===g}),p=0;p<a.length&&h<d.length;p++)if(d[h]===a[p]){var q=!0;if(l){e[g]=a[p];for(var q=0,r=c;q<r.length;q++){var t=r[q];t!==g&&(e[t]=B.getCachedAttributeValue(n[t],p))}q=m._evaluateClause(b,f)}q&&(d[k]=d[h],k++);h++}},m=this,p=0;for(a=this._nodeId2Meta[a.id].engineObjects;p<a.length;p++)l(a[p]);d.length=k},l.prototype._evaluateClause=function(a,
b){try{return a.testFeature(b)}catch(L){return this._definitionExpressionErrors<this._maxDefinitionExpressionErrors&&ea.error("Error while evaluating definitionExpression: "+L),this._definitionExpressionErrors++,this._definitionExpressionErrors===this._maxDefinitionExpressionErrors&&ea.error("Further errors are ignored"),!1}},l.prototype._objectIdFilter=function(a,b,c){for(var d=0,e=0;d<c.length;)0<=k.binaryIndexOf(a,c[d])===b&&(c[e]=c[d],e++),d++;c.length=e},l.prototype._boundingboxFilter=function(a,
b,c){var d=[0,0,0,0];O.mbsToMbs(a.mbs,this._controller.crsIndex,d,this.view.renderSpatialReference);d=null!=b?B.intersectBoundingBoxWithMbs(b,d):2;if(2!==d){if(0===d)return void(c.length=0);var e=d=0,f=0;for(a=this._nodeId2Meta[a.id].engineObjects;f<a.length;f++){var g=a[f],h=g.getMetadata().featureIds,k=g.getObjectTransformation(),l=g.getGeometryRecords()[0].getShaderTransformation();if(X.mat4d.multiply(k,l),0===k[1]&&0===k[2]&&0===k[3]&&0===k[4]&&0===k[6]&&0===k[7]&&0===k[8]&&0===k[9]&&0===k[11]&&
1===k[15]){l=wa;l[0]=(b[0]-k[12])/k[0];l[1]=(b[1]-k[13])/k[5];l[2]=(b[2]-k[14])/k[10];l[3]=(b[3]-k[12])/k[0];l[4]=(b[4]-k[13])/k[5];l[5]=(b[5]-k[14])/k[10];for(var g=g.getGeometryRecords()[0].geometry,k=g.getComponentCount(),n=0;k>n&&d<c.length;n++)if(c[d]===h[n]){var m=g.getComponentAABB(n,da);S.intersects(l,m)&&(c[e]=c[d],e++);d++}}}c.length=e}},l.prototype._applyFilters=function(a){if(this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjects){for(var b=this._nodeId2Meta[a.id].engineObjects,
c=0;c<b.length;c++){var d=b[c];d.unhideAllComponents()}if(0!==this._filters.length){for(var c=[],e=0;e<b.length;e++)d=b[e],c=c.concat(d.getMetadata().featureIds);d=c.length;for(e=0;e<this._filters.length;e++)this._filters[e](a,c);if(c.length!==d)for(e=a=0;e<b.length;e++)for(var d=b[e],f=d.getGeometryRecords()[0],g=d.getMetadata().featureIds,h=0;h<g.length;h++){var k=g[h];a>=c.length||c[a]!==k?d.setComponentVisibility(f,h,!1):a++}}}},l.prototype._removeAllNodeDataFromStage=function(){for(var a=0,b=
Object.keys(this._nodeId2Meta);a<b.length;a++)this._removeNodeDataFromStage(b[a])},l.prototype._removeNodeDataFromStage=function(a){if(null!=this._nodeId2Meta[a]&&null!=this._nodeId2Meta[a].engineObjects){for(var b=this._stage,c=this._stageLayer,d=this._nodeId2Meta[a].engineObjects,e=0;e<d.length;++e){var f=d[e];this._highlights.objectDeleted(f);this.visibleGeometryChanged(f);c.removeObject(f);for(var g=f.getGeometryRecords(),h=0;h<g.length;h++){var k=g[h];this.memEstimateGeometryRemoved(k.geometry.getData());
b.remove(ca.GEOMETRY,k.geometry.getId());for(var l=0;l<k.materials.length;l++){var n=k.materials[l],m=n.getId(),p=n.metadata.i3sMatId,q=n.metadata.i3sTexId||"none",r=this._matId2Meta[p][q];V.assert(0<r.refCount);r.refCount--;0===r.refCount&&this._removeMaterial(m,q,p,n,b)}}b.remove(ca.OBJECT,f.getId())}delete this._nodeId2Meta[a]}},l.prototype._removeMaterial=function(a,b,c,d,e){if(e.remove(ca.MATERIAL,a),"none"!==b){a=this._texId2Meta[b];var f=a.usedByEngineMats;d=f.indexOf(d);if(V.assert(-1<d),
f[d]=f[f.length-1],f.pop(),1>f.length)(d=a.engineTex)&&d!==this._whiteTexture&&(this.memEstimateTextureRemoved(d),e.remove(ca.TEXTURE,a.engineTex.getId())),a.engineTex=void 0,delete this._texId2Meta[b]}delete this._matId2Meta[c][b];V.objectEmpty(this._matId2Meta[c])&&delete this._matId2Meta[c]},l.prototype._setPolygonOffset=function(a,b){if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle){b={polygonOffset:b};for(var c=0;c<this._nodeId2Meta[a.id].engineObjectsPerBundle.length;c++)for(var d=
this._nodeId2Meta[a.id].engineObjectsPerBundle[c],e=0;e<d.length;e++)for(var f=d[e].getGeometryRecords(),g=0;g<f.length;g++)for(var h=f[g].materials,k=0;k<h.length;k++)h[k].setParameterValues(b)}},l.prototype._rendererChange=function(a){if(this._currentRenderer=a,a&&(a.colorInfo||a.sizeInfo)&&ea.warn("renderer.colorInfo and renderer.sizeInfo are not supported for Scene Services. Use visualVariables instead."),a){var b=0;for(a=a.getSymbols();b<a.length;b++){var c=a[b];"mesh-3d"!==c.type&&ea.error("Symbols of type '"+
c.type+"' are not supported for 3D Object Scene Services.")}}},l.prototype._getRenderingInfo=function(a){var b=this._currentRenderer,c=b&&b.getSymbol(a);if(!(c instanceof w&&this._hasSymbolColors()))return null;var d,e,c={symbol:c};if(b&&b.visualVariables)for(a=b.getVisualVariableValues(a),b=0;b<a.length;b++){var f=a[b],g=f.variable.type;"color"===g?d=f.value:"opacity"===g&&(e=f.value)}return d&&(c.color=[d.r/255,d.g/255,d.b/255]),null!=e?c.opacity=e:d&&null!=d.a&&(c.opacity=d.a),c},l.prototype._getSymbolFillMaterial=
function(a,b){var c=0;for(a=a.symbolLayers.items;c<a.length;c++){var d=a[c];if("fill"===d.type)return c=d.material,a=null!=c?c.color:null,null!=a?(ga[0]=a.r/255,ga[1]=a.g/255,ga[2]=a.b/255,ga[3]=a.a,b.color=ga):b.color=null,void(b.colorMixMode=null!=c?c.colorMixMode:null)}b.color=null;b.colorMixMode=null},l.prototype._hasSymbolColors=function(){if(this._isIntegratedMesh()||!this.layer.store.defaultGeometrySchema)return!1;var a=this.layer.store.defaultGeometrySchema.featureAttributes;return a&&a.faceRange&&
a.id},l.prototype._isIntegratedMesh=function(){return this.layer instanceof g},l.prototype._hasVertexColors=function(){return null!=this.layer.store.defaultGeometrySchema.vertexAttributes.color&&(null==this.layer.cachedDrawingInfo||!this.layer.cachedDrawingInfo.color)},l.prototype._setObjectSymbology=function(a){if(this._hasSymbolColors()){for(var b=a.getMetadata(),c=b.featureIds?b.featureIds.length:1,d=new n(null,null,{}),e=d.attributes,f=this.layer.objectIdField,g=this._currentRenderer&&this._currentRenderer.requiredFields,
h=a.geometryRecords[0].geometry,k=h.data.getAttribute(V.VertexAttrConstants.SYMBOLCOLOR),l=!1,m=new Uint8Array(4),p={color:null,colorMixMode:null},q=null,r=0;c>r;r++){if(null!=f&&null!=b.featureIds&&(e[f]=b.featureIds[r]),null!=g&&null!=b.attributeData)for(var t=0,u=g;t<u.length;t++){var v=u[t];null!=b.attributeData[v]&&(e[v]=B.getCachedAttributeValue(b.attributeData[v],r))}(u=this._getRenderingInfo(d))?(u.symbol!==q&&(q=u.symbol,this._getSymbolFillMaterial(u.symbol,p)),t=u.color,u=u.opacity,t=null==
t||null==u?Q.overrideColor(t,u,p.color,p.color&&p.color[3],ja):Q.overrideColor(t,u,null,null,ja),1>t[3]&&(l=!0),B.encodeSymbolColor(t,p.colorMixMode,m)):B.encodeSymbolColor(null,null,m);this._setComponentColor(h,r,k,m)}a.geometryColorAttrsUpdated(0);a=a.getGeometryRecords();for(b=0;b<a.length;b++)for(c=a[b],d=0;d<c.materials.length;d++)e=c.materials[d],f=e.getParams().transparent,g=e.getParams().opacity,e.metadata.symbolIsTransparent=l,h=this._calcEngineMaterialTransparencyParams(e.metadata.i3sTex,
e.metadata.i3sMatParams,e.metadata.symbolIsTransparent),f===h.transparent&&g===h.opacity||e.setParameterValues({transparent:h.transparent,opacity:h.opacity})}},l.prototype._setComponentColor=function(a,b,c,d){var e=c.data,f=c.offsetIdx,g=c.strideIdx;V.assert(4===c.size);c=f+a.data.componentOffsets[b+1]*g;for(a=f+a.data.componentOffsets[b]*g;c>a;a+=g)e[a]=d[0],e[a+1]=d[1],e[a+2]=d[2],e[a+3]=d[3]},l.prototype._elevationInfoChanged=function(){var a=this.layer.elevationInfo&&this.layer.elevationInfo.unit;
a&&!u.supportsUnit(a)&&ea.warn("elevationInfo.unit","'"+a+"' is not a valid unit")},l.prototype._reloadAll=function(){this._removeAllNodeDataFromStage();null!=this._controller&&this._controller.restartNodeLoading()},l.prototype._opacityChange=function(a){for(var b in this._matId2Meta)for(var c in this._matId2Meta[b]){a=this._matId2Meta[b][c].engineMat;var d=a.getParams(),e=this._calcEngineMaterialTransparencyParams(a.metadata.i3sTex,a.metadata.i3sMatParams,a.metadata.symbolIsTransparent);d.transparent===
e.transparent&&d.layerOpacity===e.layerOpacity||a.setParameterValues(e)}},l.prototype.queryExtent=function(a){return this._ensureQueryEngine().queryExtent(a)},l.prototype.queryFeatureCount=function(a){return this._ensureQueryEngine().queryFeatureCount(a)},l.prototype.queryFeatures=function(a){return this._ensureQueryEngine().queryFeatures(a)},l.prototype.queryObjectIds=function(a){return this._ensureQueryEngine().queryObjectIds(a)},l.prototype._ensureQueryEngine=function(){return this._queryEngine||
(this._queryEngine=this._createQueryEngine()),this._queryEngine},l.prototype._createQueryEngine=function(){var a=this,b={id:0,index:0,object:null,bbCorners:new Float64Array(24)};return new M({forAll:function(c,d){a._forAllFeatures(function(d,e,f){b.id=d;b.index=e;b.object=f;a._boundingBoxCornerPoints(b.index,b.object,b.bbCorners);c(b)},d)},createGraphic:function(b){return a._createGraphic(b.index,b.object.getMetadata())},requestFields:function(b,c,d){return B.whenGraphicAttributes(a.layer,c,a._getObjectIdField(),
d,function(){var d=a._getGraphicIndices(b.node,b.bundleNr,c);return{node:b.node,indices:d}},{ignoreUnavailableFields:!1})},createExtentBuilder:function(){return a._createExtentBuilder()}},{enableObjectId:!0,enableOutFields:!!this.layer.objectIdField})},l.prototype._createExtentBuilder=function(){var a=this.view.renderSpatialReference,b=this.view.spatialReference,c=S.create(S.NEGATIVE_INFINITY),d=new Float64Array(24);return{add:function(e){O.bufferToBuffer(e.bbCorners,a,0,d,b,0,8)&&S.expandBuffer(c,
d,0,8)},getExtent:function(){return S.toExtent(c,b)}}},l.prototype._forAllFeatures=function(a,b,c){for(var d=0,e=Object.keys(this._nodeId2Meta);d<e.length;d++)for(var f=e[d],g=this._nodeId2Meta[f].engineObjects,h=0;h<g.length;h++)this._forAllFeaturesOfObject(g[h],a,c),b&&b({node:this._controller.nodeIndex[f],bundleNr:h})},l.prototype._forAllFeaturesOfObject=function(a,b,c){for(var d=a.getMetadata().featureIds,e=a.getGeometryRecords()[0],f=0;f<d.length;f++)(c||a.getComponentVisibility(e,f))&&b(d[f],
f,a,e)},l.prototype._createGraphic=function(a,b){var c={};if(null!=b.featureIds&&(c[this._getObjectIdField()]=b.featureIds[a]),null!=b.attributeData)for(var d=0,e=Object.keys(b.attributeData);d<e.length;d++){var f=e[d];c[f]=B.getCachedAttributeValue(b.attributeData[f],a)}a=new n(null,null,c);return a.layer=this.layer,a},l.prototype._boundingBoxCornerPoints=function(a,b,c){a=b.geometries[0].getComponentAABB(a,wa);for(var d=0;8>d;++d)ua[0]=1&d?a[0]:a[3],ua[1]=2&d?a[1]:a[4],ua[2]=4&d?a[2]:a[5],X.mat4d.multiplyVec3(b.objectTransformation,
ua),c[3*d]=ua[0],c[3*d+1]=ua[1],c[3*d+2]=ua[2];return c},l.prototype.highlight=function(a,b){var d=this,e=this._highlights;if(a instanceof z){b=e.acquireSet(b);var f=b.set,g=b.handle;return this.queryObjectIds(a).then(function(a){return e.setFeatureIds(f,a)}),g}if("number"==typeof a||a instanceof n)return this.highlight([a],b);if(a instanceof c&&(a=a.toArray()),Array.isArray(a)&&0<a.length){if(a[0]instanceof n)return a=a.map(function(a){return U.attributeLookup(a.attributes,d._getObjectIdField())}),
g=e.acquireSet(b),b=g.set,g=g.handle,e.setFeatureIds(b,a),g;if("number"==typeof a[0])return g=e.acquireSet(b),b=g.set,g=g.handle,e.setFeatureIds(b,a),g}return{remove:function(){}}},l.prototype.visibleGeometryChanged=function(a){var b=this;a?this._elevationProvider.objectChanged(a):this._elevationProvider.layerChanged();null==this._visibleGeometryChangedSchedulerHandle&&(this._visibleGeometryChangedSchedulerHandle=q.schedule(function(){b.emit("visible-geometry-changed");b._visibleGeometryChangedSchedulerHandle=
null}))},d([b.property()],l.prototype,"layer",void 0),d([b.property()],l.prototype,"_controller",void 0),d([b.property({dependsOn:["_controller.updating"]})],l.prototype,"updating",void 0),d([b.property({readOnly:!0,aliasOf:"_controller.updatingPercentage"})],l.prototype,"updatingPercentageValue",void 0),d([b.property({readOnly:!0})],l.prototype,"hasTexturesOrVertexColors",null),d([b.property({readOnly:!0,dependsOn:["layer.renderer"]})],l.prototype,"rendererNeedsTextures",null),d([b.property({readOnly:!0,
dependsOn:["layer.elevationInfo"]})],l.prototype,"elevationOffset",null),d([b.property()],l.prototype,"alwaysLoadEverythingModeEnabled",void 0),d([b.property({dependsOn:["view.qualitySettings.sceneService.uncompressedTextureDownsamplingEnabled","_useCompressedTextures"]})],l.prototype,"uncompressedTextureDownsamplingEnabled",null),d([b.property({dependsOn:["layer.version"]})],l.prototype,"_useCompressedTextures",null),l=d([b.subclass("esri.views.3d.layers.SceneLayerView3D")],l)}(b.declared(C,T));
var ua=X.vec3d.create(),wa=S.create(),da=S.create(),ra=X.vec4d.create(),ga=[0,0,0,0];return m})},"esri/layers/IntegratedMeshLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Layer ./mixins/SceneService ../symbols/support/ElevationInfo ../core/Error dojo/_base/lang".split(" "),function(m,l,h,d,b,g,k,f,a,e){return function(c){function g(a,b){a=c.call(this)||this;return a.geometryType="mesh",a.operationalLayerType=
"IntegratedMeshLayer",a.type="integrated-mesh",a.profile="mesh-pyramids",a.elevationInfo=null,a}return h(g,c),g.prototype.normalizeCtorArgs=function(a,b){return"string"==typeof a?e.mixin({},{url:a},b):a},g.prototype.load=function(){var a=this,b=this.loadFromPortal({supportedTypes:["Scene Service"]}).always(function(){return a._fetchService()}).then(function(){return a._verifyRootNodeAndUpdateExtent()});return this.addResolvingPromise(b),this.when()},g.prototype._validateLayer=function(b){if(b.layerType&&
"IntegratedMesh"!==b.layerType)throw new a("integratedmeshlayer:layer-type-not-supported","IntegratedMeshLayer does not support this layer type",{layerType:b.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new a("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(1<this.version.major)throw new a("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,
supportedVersions:"1.x"});},d([b.shared("esri.layers.IntegratedMeshLayer")],g.prototype,"declaredClass",void 0),d([b.shared({"3d":"../views/3d/layers/SceneLayerView3D"})],g.prototype,"viewModulePaths",void 0),d([b.property({type:String,readOnly:!0})],g.prototype,"geometryType",void 0),d([b.property()],g.prototype,"operationalLayerType",void 0),d([b.property({json:{read:!1},readOnly:!0})],g.prototype,"type",void 0),d([b.property({type:f,json:{origins:{service:{read:{source:"elevationInfo"}}},read:{source:"layerDefinition.elevationInfo"},
write:{target:"layerDefinition.elevationInfo"}}})],g.prototype,"elevationInfo",void 0),g=d([b.subclass()],g)}(b.declared(g,k))})},"esri/layers/mixins/SceneService":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../request ../../core/MultiOriginJSONSupport ../../core/Error ../../core/urlUtils ../../core/promiseUtils ../../core/requireUtils ../../core/Logger ../../geometry/Extent ../../geometry/HeightModelInfo ../../geometry/SpatialReference ../Layer ../support/arcgisLayerUrl ./ArcGISService ./OperationalLayer ./PortalLayer".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w){var z=q.getLogger("esri.layers.mixins.SceneService");return function(k){function l(){var a=null!==k&&k.apply(this,arguments)||this;return a.blendMode=null,a.spatialReference=null,a.fullExtent=null,a.heightModelInfo=null,a.version={major:Number.NaN,minor:Number.NaN,versionString:""},a.copyright=null,a.sublayerTitleMode="item-title",a.title=null,a.layerId=null,a}return h(l,k),l.prototype.readSpatialReference=function(a,b){return this._readSpatialReference(b)},
l.prototype._readSpatialReference=function(a){if(null!=a.spatialReference)return u.fromJSON(a.spatialReference);a=a.store;a=(a=a.indexCRS||a.geographicCRS)&&parseInt(a.substring(a.lastIndexOf("/")+1,a.length),10);return null!=a?new u(a):null},l.prototype.readFullExtent=function(a,b){a=b.store;b=this._readSpatialReference(b);return null==b||null==a||null==a.extent?null:new t({xmin:a.extent[0],ymin:a.extent[1],xmax:a.extent[2],ymax:a.extent[3],spatialReference:b})},l.prototype.readVersion=function(a,
b){a=b.store;b=null!=a.version?a.version.toString():"";a={major:Number.NaN,minor:Number.NaN,versionString:b};b=b.split(".");return 2<=b.length&&(a.major=parseInt(b[0],10),a.minor=parseInt(b[1],10)),a},l.prototype.readCopyright=function(a,b){return b.copyrightText},l.prototype.readTitlePortalItem=function(a,b){return"item-title"!==this.sublayerTitleMode?void 0:a},l.prototype.readTitleService=function(a,b){a=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return x.titleFromUrlAndName(this.url,
b.name);b=b.name||x.parse(this.url).title;return"item-title-and-service-name"===this.sublayerTitleMode&&a&&(b=a+" - "+b),x.cleanTitle(b)},l.prototype.readLayerId=function(a,b){return b.id},Object.defineProperty(l.prototype,"url",{set:function(a){a=x.sanitizeUrlWithLayerId(this,a,z);this._set("url",a.url);null!=a.layerId&&this._set("layerId",a.layerId)},enumerable:!0,configurable:!0}),l.prototype.writeUrl=function(a,b){x.writeUrlWithLayerId(this,a,"layers",b)},Object.defineProperty(l.prototype,"parsedUrl",
{get:function(){var b=this._get("url");if(!b)return null;b=a.urlToObject(b);return null!=this.layerId&&x.match.test(b.path)&&(b.path=b.path+"/layers/"+this.layerId),b},enumerable:!0,configurable:!0}),l.prototype.readRootNode=function(a,b){return b.store.rootNode},l.prototype._verifyRootNodeAndUpdateExtent=function(){var a=this;return this._fetchRootNode().then(function(b){return a._updateExtentFromRootNode(b)})},l.prototype._updateExtentFromRootNode=function(a){if(null!=this.fullExtent&&!this.fullExtent.hasZ&&
null!=a&&Array.isArray(a.mbs)&&4===a.mbs.length){var b=a.mbs[2];a=a.mbs[3];this.fullExtent.zmin=b-a;this.fullExtent.zmax=b+a}},l.prototype._fetchRootNode=function(){if(!this.rootNode)return e.resolve();var b=a.join(this.parsedUrl.path,this.rootNode);return g(b,{query:{f:"json"},responseType:"json"}).then(function(a){return a.data}).otherwise(function(a){throw new f("sceneservice:root-node-missing","Root node missing.",{error:a,url:b});})},l.prototype._fetchService=function(){var a,b=this;return a=
null==this.layerId&&/SceneServer\/*$/i.test(this.url)?this._fetchFirstLayerId().then(function(a){null!=a&&(b.layerId=a)}):e.resolve(),a.then(function(){return b._fetchServiceLayer()})},l.prototype._fetchFirstLayerId=function(){return g(this.url,{query:{f:"json"},callbackParamName:"callback",responseType:"json"}).then(function(a){return a.data&&Array.isArray(a.data.layers)&&0<a.data.layers.length?a.data.layers[0].id:void 0})},l.prototype._fetchServiceLayer=function(){var a=this;return g(this.parsedUrl.path,
{query:{f:"json"},responseType:"json"}).then(function(b){b.ssl&&(a.url=a.url.replace(/^http:/i,"https:"));b=b.data;a.read(b,{origin:"service",url:a.parsedUrl});a._validateLayer(b)})},l.prototype._validateLayer=function(a){},l.prototype.createGraphicsController=function(a){var b=this;a.layer=this;var d=c.when(m,"../graphics/controllers/I3SOnDemandController").then(function(b){return new b(a)});return d.then(function(a){b.emit("graphics-controller-create",{graphicsController:a})}),d},d([b.shared({id:{json:{origins:{service:{read:!1},
"portal-item":{read:!1}}}}})],l.prototype,"properties",void 0),d([b.property({type:u})],l.prototype,"spatialReference",void 0),d([b.reader("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],l.prototype,"readSpatialReference",null),d([b.property({type:t})],l.prototype,"fullExtent",void 0),d([b.reader("fullExtent",["store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],l.prototype,"readFullExtent",null),d([b.property({readOnly:!0,type:r})],l.prototype,
"heightModelInfo",void 0),d([b.property({readOnly:!0})],l.prototype,"version",void 0),d([b.reader("version",["store.version"])],l.prototype,"readVersion",null),d([b.property({type:String})],l.prototype,"copyright",void 0),d([b.reader("copyright",["copyrightText"])],l.prototype,"readCopyright",null),d([b.property({type:String})],l.prototype,"sublayerTitleMode",void 0),d([b.property({type:String})],l.prototype,"title",void 0),d([b.reader("portal-item","title")],l.prototype,"readTitlePortalItem",null),
d([b.reader("service","title",["name"])],l.prototype,"readTitleService",null),d([b.property({type:Number})],l.prototype,"layerId",void 0),d([b.reader("service","layerId",["id"])],l.prototype,"readLayerId",null),d([b.property()],l.prototype,"url",null),d([b.writer("url")],l.prototype,"writeUrl",null),d([b.property({dependsOn:["layerId"]})],l.prototype,"parsedUrl",null),d([b.property()],l.prototype,"store",void 0),d([b.property({type:String})],l.prototype,"rootNode",void 0),d([b.reader("rootNode",["store.rootNode"])],
l.prototype,"readRootNode",null),l=d([b.subclass("esri.layers.mixins.SceneService")],l)}(b.declared(v,y,k,n,w))})},"esri/views/3d/layers/i3s/I3SUtil":function(){define("require exports ../../../../request ../../../../core/promiseUtils ../../../../core/Error ../../../../core/urlUtils ../../../../geometry/SpatialReference ../../../../geometry/support/webMercatorUtils ../../../../tasks/QueryTask ../../../../tasks/support/Query ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/lib/Util ./I3SBinaryReader".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r){function u(a){return a&&parseInt(a.substring(a.lastIndexOf("/")+1,a.length),10)}function v(a,b,d,e,f,g){if(null!=d){var h=T;if(c.mbsToMbs(d.mbs,e,h,b),0!==x(a,h)){g.push(d);for(var h=null!=d.children?d.children.length:0,k=0;h>k;k++)v(a,b,f[d.children[k].id],e,f,g)}}}function x(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=0;if(c<a[0])var g=a[0]-c,f=f+g*g;d<a[1]&&(g=a[1]-d,f+=g*g);e<a[2]&&(g=a[2]-e,f+=g*g);c>a[3]&&(g=c-a[3],f+=g*g);d>a[4]&&(g=d-a[4],f+=g*g);e>a[5]&&
(g=e-a[5],f+=g*g);if(f>b*b)return 0;if(0<f)return 1;f=1/0;return c-a[0]<f&&(f=c-a[0]),d-a[1]<f&&(f=d-a[1]),e-a[2]<f&&(f=e-a[2]),a[3]-c<f&&(f=a[3]-c),a[4]-d<f&&(f=a[4]-d),a[5]-e<f&&(f=a[5]-e),f>b?2:1}function y(a,b,c){var d=[],e=c&&c.missingFields;c=c&&c.originalFields;for(var f=0;f<a.length;f++){for(var g=a[f],h=g.toLowerCase(),k=!1,l=0,n=b;l<n.length;l++){var m=n[l];if(h===m.name.toLowerCase()){d.push(m.name);k=!0;c&&c.push(g);break}}!k&&e&&e.push(g)}return d}function n(a,b){return a.filter(function(a){return a.toLowerCase()!==
b.toLowerCase()}).concat([b])}function w(a,b,c,d){b.sort(function(a,b){return a.attributes[c]-b.attributes[c]});var e=b.map(function(a){return a.attributes[c]}),f=[],g=y(d,a.fields,{originalFields:f});return C(a,e,g).then(function(a){for(var c=0;c<b.length;c++){var d=b[c],e=a[c];d.attributes={};for(var h=0;h<f.length;h++)d.attributes[f[h]]=e[g[h]]}return b})}function z(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];e in b.attributes||c.push(e)}return c}function C(c,f,g){if(null!=c.maxRecordCount&&
f.length>c.maxRecordCount){var h=G(f,c.maxRecordCount);return d.all(h.map(function(a){return C(c,a,g)})).then(N)}h=new e({objectIds:f,outFields:g,orderByFields:[c.objectIdField]});return(new a(c.parsedUrl.path)).execute(h).then(function(a){return a&&a.features&&a.features.length===f.length?a.features.map(function(a){return a.attributes}):d.reject(new b("scenelayer:feature-not-in-associated-layer","Feature not found in associated feature layer"))})}function B(a,c,e,f,k){for(var l=[],n=0;n<c.attributeData.length;n++){var m=
c.attributeData[n],p=a[n];p&&-1!==f.indexOf(p.name)&&(m=g.makeAbsolute(m.href,c.baseUrl),l.push({url:m,storageInfo:p}))}return d.eachAlways(l.map(function(a){return h(a.url,{responseType:"array-buffer"}).then(function(b){return r.readBinaryAttribute(a.storageInfo,b.data)})})).then(function(a){var c=[];if(!k.ignoreUnavailableFields&&a.some(function(a){return null==a.value})){for(var c=[],f=0;f<a.length;f++)null==a[f].value&&c.push({name:l[f].storageInfo.name,error:a[f].error});return d.reject(new b("scenelayer:attribute-request-failed",
"Request for scene layer attributes failed",{failedAttributes:c}))}for(var g=0;g<e.length;g++){for(var h=e[g],n={},f=0;f<a.length;f++)null!=a[f].value&&(n[l[f].storageInfo.name]=F(a[f].value,h));c.push(n)}return c})}function F(a,b){b=a[b];return a instanceof Int16Array?b===O?null:b:a instanceof Int32Array?b===S?null:b:b!==b?null:b}function G(a,b){var c=a.length;b=Math.ceil(c/b);for(var d=[],e=0;b>e;e++)d.push(a.slice(Math.floor(c*e/b),Math.floor(c*(e+1)/b)));return d}function N(a){for(var b=[],c=
0;c<a.length;c++)b=b.concat(a[c]);return b}function M(a){var b=new k(u(a.store.indexCRS||a.store.geographicCRS));return b.equals(a.spatialReference)?a.spatialReference:b}function R(a){var b=new k(u(a.store.vertexCRS||a.store.projectedCRS));return b.equals(a.spatialReference)?a.spatialReference:b}function P(a,c,d){if(!f.canProject(a,c))throw new b("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{});if("local"===
d&&a.isGeographic)throw new b("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",{});}function Q(a,b,c){var d=M(a);a=R(a);P(d,b,c);P(a,b,c)}Object.defineProperty(l,"__esModule",{value:!0});l.DDS_ENCODING_STRING="image/vnd-ms.dds";l.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS=["image/jpeg","image/png"];l.extractWkid=u;l.processNormals=function(a,b,d){switch(b){case "none":var e=a.normals,f=a.positions;b=a.normalInd;d=a.positionInd;t.assert(a.normalInd.length===
a.positionInd.length);a=q.vec3d.create();for(var g=q.vec3d.create(),h=f.data,k=f.offsetIdx,f=f.strideIdx,l=e.data,n=e.offsetIdx,e=e.strideIdx,m=0;m<d.length;m+=3){var r=d[m],r=k+f*r,u=h[r],v=h[r+1],w=h[r+2],r=d[m+1],r=k+f*r;a[0]=h[r]-u;a[1]=h[r+1]-v;a[2]=h[r+2]-w;r=d[m+2];r=k+f*r;g[0]=h[r]-u;g[1]=h[r+1]-v;g[2]=h[r+2]-w;q.vec3d.cross(a,g,a);q.vec3d.normalize(a);for(u=0;3>u;u++)v=n+e*b[m+u],l[v]=a[0],l[v+1]=a[1],l[v+2]=a[2]}break;case "east-north-up":break;case "earth-centered":d(a.normals,c.SphericalECEFSpatialReference);
break;case "vertex-reference-frame":break;default:throw Error("Received unexpected normalReferenceFrame: "+b);}};l.getAppropriateTextureEncoding=function(a,b){if(Array.isArray(a)){if(b&&(b=a.indexOf(l.DDS_ENCODING_STRING),-1<b))return b;for(b=0;b<a.length;b++)if(-1<l.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS.indexOf(a[b]))return b;throw Error("Could not find appropriate texture encoding (among "+a.toString()+")");}return-1};l.findIntersectingNodes=v;var T=q.vec4d.create();l.intersectBoundingBoxWithMbs=
x;l.findFieldsCaseInsensitive=y;l.whenGraphicAttributes=function(a,c,e,f,g,h){var k=!0===(h&&h.populateObjectId),l=h.ignoreUnavailableFields?void 0:[],m=1===f.length&&"*"===f[0];!m&&k&&(f=n(f,e));f=m?f:y(f,a.fields,{missingFields:l});if(l&&0!==l.length)return d.reject(new b("scenelayer:unknown-fields","This scene layer does not have the requested fields",{unknownFields:l}));if(0===c.length)return d.resolve(c);var k=a.associatedLayer,l=a.attributeStorageInfo,p=m?a.fields.map(function(a){return a.name}):
f;if(k)return w(k,c,e,p);a=z(p,c[0]);return 0===a.length?d.resolve(c):l?(g=g(),null==g?d.reject(new b("scenelayer:feature-not-loaded","Tried to query attributes for unloaded features")):B(l,g.node,g.indices,a,h).then(function(a){for(var b=0;b<c.length;b++){for(var d=0,e=p;d<e.length;d++){var f=e[d];f in a[b]||(a[b][f]=c[b].attributes[f])}c[b].attributes=a[b]}return c})):d.reject(new b("scenelayer:no-attribute-source","This scene layer does not have a source for attributes available"))};var O=-Math.pow(2,
15),S=-Math.pow(2,31);l.getCachedAttributeValue=F;l.convertFlatRangesToOffsets=function(a,c,d){void 0===d&&(d=2);c=null!=c?c:a.length/d;for(var e=new Uint32Array(c+1),f=0;c>f;f++){var g=a[f*d];e[f]=3*g;var h=(f-1)*d+1;if(0<=h&&g-1!==a[h])throw new b("Face ranges are not continuous");}return e[e.length-1]=3*(a[(c-1)*d+1]+1),e};l.getIndexCrs=M;l.getVertexCrs=R;l.getCacheKeySuffix=function(a,b){return b===c.SphericalECEFSpatialReference?"@ECEF":a.equals(b)?"":null!=b.wkid?"@"+b.wkid:null};l.checkSpatialReference=
P;l.checkSpatialReferences=Q;l.checkSceneLayerValid=function(a){var c;(c=null==a.store||null==a.store.defaultGeometrySchema)||(a=a.store.defaultGeometrySchema,c=!(null!=a.geometryType&&"triangles"!==a.geometryType?0:null!=a.topology&&"PerAttributeArray"!==a.topology?0:null!=a.vertexAttributes&&null!=a.vertexAttributes.position));if(c)throw new b("scenelayer:unsupported-geometry-schema","The geometry schema of this scene layer is not supported.",{});};l.checkSceneLayerCompatibleWithView=function(a,
b){Q(a,b.spatialReference,b.viewingMode)};l.checkPointCloudLayerValid=function(a){var c;(c=null==a.store||null==a.store.defaultGeometrySchema)||(a=a.store.defaultGeometrySchema,c=!(null==a.geometryType||"points"!==a.geometryType?0:null!=a.topology&&"PerAttributeArray"!==a.topology?0:null!=a.encoding&&""!==a.encoding&&"lepcc-xyz"!==a.encoding?0:null!=a.vertexAttributes&&null!=a.vertexAttributes.position));if(c)throw new b("pointcloud:unsupported-geometry-schema","The geometry schema of this point cloud scene layer is not supported.",
{});};l.checkPointCloudLayerCompatibleWithView=function(a,b){P(a.spatialReference,b.spatialReference,b.viewingMode)};l.encodeSymbolColor=function(a,b,c){if(null==a||"ignore"===b)return c[0]=255,c[1]=255,c[2]=255,void(c[3]=255);c[0]=Math.floor(255*a[0]);c[1]=Math.floor(255*a[1]);c[2]=Math.floor(255*a[2]);a=Math.floor(85*a[3]);0===a?c[3]=0:"tint"===b?c[3]=a:"replace"===b?c[3]=a+85:c[3]=a+170};l.rendererNeedsTextures=function(a){if(null==a||"simple"!==a.type&&"class-breaks"!==a.type&&"unique-value"!==
a.type||("unique-value"===a.type||"class-breaks"===a.type)&&null==a.defaultSymbol)return!0;a=a.getSymbols();if(0===a.length)return!0;for(var b=0;b<a.length;b++){var c=a[b];if("mesh-3d"!==c.type||0===c.symbolLayers.length)return!0;for(var d=0,c=c.symbolLayers.items;d<c.length;d++){var e=c[d];if("fill"!==e.type||null==e.material||"replace"!==e.material.colorMixMode)return!0}}return!1}})},"esri/views/3d/layers/i3s/I3SBinaryReader":function(){define("require exports dojo/_base/lang ../../../../core/Logger ../../../../core/Error ./LEPCC".split(" "),
function(m,l,h,d,b,g){function k(a,c,d){for(var e="",f=0;d>f;){var g=a[c+f];if(128>g)e+=String.fromCharCode(g),f++;else if(192<=g&&224>g){if(f+1>=d)throw new b("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");var h=a[c+f+1],g=(31&g)<<6|63&h,e=e+String.fromCharCode(g),f=f+2}else if(224<=g&&240>g){if(f+2>=d)throw new b("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");var h=a[c+f+1],k=a[c+f+2],g=(15&g)<<12|(63&h)<<6|63&k,e=e+String.fromCharCode(g),
f=f+3}else{if(!(240<=g&&248>g))throw new b("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");if(f+3>=d)throw new b("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");h=a[c+f+1];k=a[c+f+2];g=(7&g)<<18|(63&h)<<12|(63&k)<<6|63&a[c+f+3];e=65536<=g?e+String.fromCharCode((g-65536>>10)+55296,(1023&g)+56320):e+String.fromCharCode(g);f+=4}}return e}function f(a,b){for(var c={byteOffset:0,byteCount:0,fields:Object.create(null)},d=0,e=0;e<b.length;e++){var f=
b[e],g=f.valueType||f.type;c.fields[f.property]=(0,l.valueType2ArrayBufferReader[g])(a,d);d+=l.valueType2TypedArrayClassMap[g].BYTES_PER_ELEMENT}return c.byteCount=d,c}function a(a,c,d){var e,f,g=[],h=0;for(f=0;a>f;f+=1){if(e=c[f],0<e){if(g.push(k(d,h,e-1)),0!==d[h+e-1])throw new b("string-array-error","Invalid string array: missing null termination.");}else g.push(null);h+=e}return g}function e(a,b){return new l.valueType2TypedArrayClassMap[b.valueType](a,b.byteOffset,b.count*b.valuesPerElement)}
function c(a,b){return new Uint8Array(a,b.byteOffset,b.byteCount)}function q(a,c,d){a=null!=c.header?f(a,c.header):{byteOffset:0,byteCount:0,fields:{count:d}};d={header:a,byteOffset:a.byteCount,byteCount:0,entries:Object.create(null)};for(var e=a.byteCount,g=0;g<c.ordering.length;g++){var k=c.ordering[g],l=h.clone(c[k]);if(l.count=a.fields.count,"String"===l.valueType){if(l.byteOffset=e,l.byteCount=a.fields[k+"ByteCount"],"UTF-8"!==l.encoding)throw new b("unsupported-encoding","Unsupported String encoding.",
{encoding:l.encoding});}else{if(!r(l.valueType))throw new b("unsupported-value-type","Unsupported binary valueType",{valueType:l.valueType});var n=u(l.valueType),e=e+(0!==e%n?n-e%n:0);l.byteOffset=e;l.byteCount=n*l.valuesPerElement*l.count}e+=l.byteCount;d.entries[k]=l}return d.byteCount=e-d.byteOffset,d}function t(a,c,d){if(c!==a&&v.error("Invalid "+d+" buffer size\n expected: "+a+", actual: "+c+")"),a>c)throw new b("buffer-too-small","Binary buffer is too small",{expectedSize:a,actualSize:c});}
function r(a){return l.valueType2TypedArrayClassMap.hasOwnProperty(a)}function u(a){return r(a)&&l.valueType2TypedArrayClassMap[a].BYTES_PER_ELEMENT}Object.defineProperty(l,"__esModule",{value:!0});var v=d.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");l.readHeader=f;l.readStringArray=a;l.createTypedView=e;l.createRawView=c;l.createAttributeDataIndex=q;l.createGeometryDataIndex=function(a,b,c){var d=f(a,b.header),e=d.byteCount,g={header:d,byteOffset:d.byteCount,byteCount:0,vertexAttributes:h.clone(b.vertexAttributes)},
k=g.vertexAttributes;c||null==k.region||delete k.region;var d=d.fields,l=null!=d.vertexCount?d.vertexCount:d.count;for(c=0;c<b.ordering.length;c++){var n=b.ordering[c];null!=k[n]&&(k[n].byteOffset=e,k[n].count=l,e+=u(k[n].valueType)*k[n].valuesPerElement*l)}k=d.faceCount;if(b.faces&&k)for(g.faces=h.clone(b.faces),l=g.faces,c=0;c<b.ordering.length;c++)n=b.ordering[c],null!=l[n]&&(l[n].byteOffset=e,l[n].count=k,e+=u(l[n].valueType)*l[n].valuesPerElement*k);d=d.featureCount;if(b.featureAttributes&&b.featureAttributeOrder&&
d)for(g.featureAttributes=h.clone(b.featureAttributes),k=g.featureAttributes,c=0;c<b.featureAttributeOrder.length;c++)l=b.featureAttributeOrder[c],k[l].byteOffset=e,k[l].count=d,n=u(k[l].valueType),"UInt64"===k[l].valueType&&(n=8),e+=n*k[l].valuesPerElement*d;return t(e,a.byteLength,"geometry"),g.byteCount=e-g.byteOffset,g};l.readBinaryAttribute=function(d,f,h){if("lepcc-rgb"===d.encoding)return g.decodeRGB(f);if("lepcc-intensity"===d.encoding)return g.decodeIntensity(f);if(null!=d.encoding&&""!==
d.encoding)throw new b("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");d["attributeByteCounts "]&&!d.attributeByteCounts&&(v.warn("Warning: Trailing space in 'attributeByteCounts '."),d.attributeByteCounts=d["attributeByteCounts "]);"ObjectIds"===d.ordering[0]&&d.hasOwnProperty("objectIds")&&(v.warn("Warning: Case error in objectIds"),d.ordering[0]="objectIds");h=q(f,d,h);t(h.byteOffset+h.byteCount,f.byteLength,"attribute");if(d=h.entries.attributeValues||h.entries.objectIds){if("String"===
d.valueType){h=h.entries.attributeByteCounts;var k=e(f,h);f=c(f,d);return a(h.count,k,f)}return e(f,d)}throw new b("bad-attribute-storage-info","Bad attributeStorageInfo specification.");};l.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array};l.valueType2ArrayBufferReader={Float32:function(a,b){return(new DataView(a,0)).getFloat32(b,!0)},Float64:function(a,b){return(new DataView(a,
0)).getFloat64(b,!0)},UInt8:function(a,b){return(new DataView(a,0)).getUint8(b)},Int8:function(a,b){return(new DataView(a,0)).getInt8(b)},UInt16:function(a,b){return(new DataView(a,0)).getUint16(b,!0)},Int16:function(a,b){return(new DataView(a,0)).getInt16(b,!0)},UInt32:function(a,b){return(new DataView(a,0)).getUint32(b,!0)},Int32:function(a,b){return(new DataView(a,0)).getInt32(b,!0)}};l.isValueType=r;l.getBytesPerValue=u})},"esri/views/3d/layers/i3s/LEPCC":function(){define(["require","exports",
"../../../../core/Error"],function(m,l,h){function d(a,b,c){return{identifier:String.fromCharCode.apply(null,new Uint8Array(a,c+f.identifierOffset,f.identifierLength)),version:b.getUint16(c+f.versionOffset,k),checksum:b.getUint32(c+f.checksumOffset,k)}}function b(a,b,c){var d=[];b=g(a,b,d);for(var e=[],f=0;f<d.length;f++){e.length=0;b=g(a,b,e);for(var h=0;h<e.length;h++)c.push(e[h]+d[f])}return b}function g(a,b,c){var d=new DataView(a,b),e=d.getUint8(0),f=31&e,g=!!(32&e),l=(192&e)>>6,e=0;if(0===l)e=
d.getUint32(1,k),b+=5;else if(1===l)e=d.getUint16(1,k),b+=3;else{if(2!==l)throw new h("lepcc-decode-error","Bad count type");e=d.getUint8(1);b+=2}if(g)throw new h("lepcc-decode-error","LUT not implemented");a=new Uint8Array(a,b,Math.ceil(e*f/8));for(var l=g=d=0,m=-1>>>32-f,y=0;e>y;y++){for(;f>g;)d|=a[l]<<g,g+=8,l+=1;c[y]=d&m;d>>>=f;g-=f;32<g+f&&(d|=a[l-1]>>8-g)}return b+l}Object.defineProperty(l,"__esModule",{value:!0});var k=!0,f={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,
byteCount:16};l.decodeXYZ=function(a){var e,c,g,l,m,u,v,x,y,n,w,z,C=new DataView(a,0),B=0;l=d(a,C,B);g=l.identifier;l=l.version;if(B+=f.byteCount,"LEPCC     "!==g)throw new h("lepcc-decode-error","Bad identifier");if(1<l)throw new h("lepcc-decode-error","Unknown version");var F=B;e=C.getUint32(F+0,k);c=C.getUint32(F+4,k);g=C.getFloat64(F+8,k);l=C.getFloat64(F+16,k);m=C.getFloat64(F+24,k);u=C.getFloat64(F+32,k);v=C.getFloat64(F+40,k);x=C.getFloat64(F+48,k);y=C.getFloat64(F+56,k);n=C.getFloat64(F+64,
k);w=C.getFloat64(F+72,k);z=C.getUint32(F+80,k);C.getUint32(F+84,k);B+=88;if(c*Math.pow(2,32)+e!==a.byteLength)throw new h("lepcc-decode-error","Bad size");C=new Float64Array(3*z);e=[];c=[];z=[];F=[];if(B=b(a,B,e),B=b(a,B,c),B=b(a,B,z),B=b(a,B,F),B!==a.byteLength)throw new h("lepcc-decode-error","Bad length");for(var G=B=a=0;G<e.length;G++)for(var B=B+e[G],N=0,M=0;M<c[G];M++){var N=N+z[a],R=F[a];C[3*a]=Math.min(u,g+2*y*N);C[3*a+1]=Math.min(v,l+2*n*B);C[3*a+2]=Math.min(x,m+2*w*R);a++}return{errorX:y,
errorY:n,errorZ:w,result:C}};l.decodeRGB=function(a){var b,c,g,l,m,u,v=new DataView(a,0),x=0;l=d(a,v,x);g=l.identifier;l=l.version;if(x+=f.byteCount,"ClusterRGB"!==g)throw new h("lepcc-decode-error","Bad identifier");if(1<l)throw new h("lepcc-decode-error","Unknown version");u=x;b=v.getUint32(u+0,k);c=v.getUint32(u+4,k);g=v.getUint32(u+8,k);l=v.getUint16(u+12,k);m=v.getUint8(u+14);u=v.getUint8(u+15);x+=16;if(c*Math.pow(2,32)+b!==a.byteLength)throw new h("lepcc-decode-error","Bad size");if(2!==m&&
1!==m||0!==u){if(0===m&&0===u){if(3*g+x!==a.byteLength||0!==l)throw new h("lepcc-decode-error","Bad count");return(new Uint8Array(a,x)).slice()}if(2>=m&&1===u){if(x+3!==a.byteLength||1!==l)throw new h("lepcc-decode-error","Bad count");a=v.getUint8(x);l=v.getUint8(x+1);b=v.getUint8(x+2);x=new Uint8Array(3*g);for(v=0;v<g;v++)x[3*v]=a,x[3*v+1]=l,x[3*v+2]=b;return x}throw new h("lepcc-decode-error","Bad method "+m+","+u);}if(3*l+g+x!==a.byteLength||256<l)throw new h("lepcc-decode-error","Bad count");
b=new Uint8Array(a,x,3*l);a=new Uint8Array(a,x+3*l,g);x=new Uint8Array(3*g);for(v=0;v<g;v++)l=a[v],x[3*v]=b[3*l],x[3*v+1]=b[3*l+1],x[3*v+2]=b[3*l+2];return x};l.decodeIntensity=function(a){var b,c,l,m,r,u=new DataView(a,0),v=0;m=d(a,u,v);l=m.identifier;m=m.version;if(v+=f.byteCount,"Intensity "!==l)throw new h("lepcc-decode-error","Bad identifier");if(1<m)throw new h("lepcc-decode-error","Unknown version");var x=v;b=u.getUint32(x+0,k);c=u.getUint32(x+4,k);l=u.getUint32(x+8,k);m=u.getUint16(x+12,k);
r=u.getUint8(x+14);u.getUint8(x+15);v+=16;if(c*Math.pow(2,32)+b!==a.byteLength)throw new h("lepcc-decode-error","Bad size");u=new Uint16Array(l);if(8===r){if(l+v!==a.byteLength)throw new h("lepcc-decode-error","Bad size");r=new Uint8Array(a,v,l)}else if(16===r){if(2*l+v!==a.byteLength)throw new h("lepcc-decode-error","Bad size");r=new Uint16Array(a,v,l)}else if(r=[],g(a,v,r)!==a.byteLength)throw new h("lepcc-decode-error","Bad size");for(a=0;a<l;a++)u[a]=r[a]*m;return u}})},"esri/views/3d/layers/i3s/I3SElevationProvider":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Accessor ../../../../core/Logger ../../../../geometry/Point ../../webgl-engine/lib/Selector ../../support/Evented ../../support/aaBoundingRect ../../lib/glMatrix".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){var t=c.create(c.NEGATIVE_INFINITY),r={spatialReference:null,extent:t},u=q.vec3d.create(),v=q.vec3d.create(),x=q.vec3d.create(),y=k.getLogger("esri.views.3d.layers.i3s.I3SElevationProvider");return function(e){function g(a){return e.call(this)||this}return h(g,e),g.prototype.initialize=function(){this.renderCoordsHelper=this.layerView.view.renderCoordsHelper;this.intersectLayers=[this.stageLayer];this.selector=new a(this.layerView.view.viewingMode);var b=this.layerView.layer.fullExtent;
this.zmin=b.zmin;this.zmax=b.zmax},g.prototype.getElevation=function(a){if(a instanceof f){if(!this.renderCoordsHelper.toRenderCoords(a,u))return y.error("could not project point for elevation alignment"),-(1/0)}else if(!this.renderCoordsHelper.toRenderCoords(a,this.spatialReference,u))return y.error("could not project point for elevation alignment"),-(1/0);var b=this.layerView.elevationOffset;a=this.zmin+b;b=this.zmax+b;return q.vec3d.set(u,v),q.vec3d.set(u,x),this.renderCoordsHelper.setAltitude(b,
v),this.renderCoordsHelper.setAltitude(a,x),this.selector.init(this.intersectLayers,v,x,null,null,1,!1),this.selector.getMinResult().getIntersectionPoint(u)?this.renderCoordsHelper.getAltitude(u):-(1/0)},g.prototype.layerChanged=function(){this.spatialReference&&(r.extent=this.computeLayerExtent(this.intersectLayers[0]),r.spatialReference=this.spatialReference,this.emit("elevation-change",r))},g.prototype.objectChanged=function(a){this.spatialReference&&(r.extent=this.computeObjectExtent(a),r.spatialReference=
this.spatialReference,this.emit("elevation-change",r))},g.prototype.computeObjectExtent=function(a){return c.set(t,c.NEGATIVE_INFINITY),this.expandExtent(a,t),t},g.prototype.computeLayerExtent=function(a){c.set(t,c.NEGATIVE_INFINITY);var b=0;for(a=a.getObjects();b<a.length;b++)this.expandExtent(a[b],t);return t},g.prototype.expandExtent=function(a,b){for(var d=a.getBBMin(!0),e=a.getBBMax(!0),f=0;8>f;++f)u[0]=1&f?d[0]:e[0],u[1]=2&f?d[1]:e[1],u[2]=4&f?d[2]:e[2],q.mat4d.multiplyVec3(a.objectTransformation,
u),this.renderCoordsHelper.fromRenderCoords(u,u,this.spatialReference),c.expand(b,u);return b},d([b.property({constructOnly:!0})],g.prototype,"layerView",void 0),d([b.property({constructOnly:!0})],g.prototype,"stageLayer",void 0),d([b.property({readOnly:!0,aliasOf:"layerView.view.elevationProvider.spatialReference"})],g.prototype,"spatialReference",void 0),g=d([b.subclass("esri.views.3d.layers.i3s.I3SElevationProvider")],g)}(b.declared(g,e.Evented))})},"esri/views/3d/layers/i3s/I3SGeometryUtil":function(){define(["require",
"exports"],function(m,l){function h(a,b,d,g,h,k,l){switch(d){case 1:for(d=0;l>d;d++)g[h]=a[b],b+=1,h+=k;break;case 2:for(d=0;l>d;d++)g[h]=a[b],g[h+1]=a[b+1],b+=2,h+=k;break;case 3:for(d=0;l>d;d++)g[h]=a[b],g[h+1]=a[b+1],g[h+2]=a[b+2],b+=3,h+=k;break;case 4:for(d=0;l>d;d++)g[h]=a[b],g[h+1]=a[b+1],g[h+2]=a[b+2],g[h+3]=a[b+3],b+=4,h+=k;break;default:throw f("Unhandled stride size "+d);}}function d(a,b,d,g,h,k){switch(b){case 1:for(b=0;k>b;b++)d[g]=a[0],g+=h;break;case 2:for(b=0;k>b;b++)d[g]=a[0],d[g+
1]=a[0],g+=h;break;case 3:for(b=0;k>b;b++)d[g]=a[0],d[g+1]=a[0],d[g+2]=a[0],g+=h;break;case 4:for(b=0;k>b;b++)d[g]=a[0],d[g+1]=a[0],d[g+2]=a[0],d[g+3]=a[0],g+=h;break;default:throw f("Unhandled stride size "+b);}}function b(a){switch(a){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array}throw Error("Unhandled data type: "+a);}function g(a){switch(a){case 5120:return"Int8";
case 5126:return"Float32";case 5124:return"Int32";case 5122:return"Int16";case 5121:return"UInt8";case 5125:return"UInt32";case 5123:return"UInt16"}throw Error("Unhandled data type: "+a);}function k(a){return 0<a&&0===a%Uint32Array.BYTES_PER_ELEMENT}function f(a){return Error("I3SGeometryUtil processing failed: "+a)}Object.defineProperty(l,"__esModule",{value:!0});var a=new Uint8Array(64);l.interleaveGeometryBuffer=function(e,c,l,m){void 0===m&&(m=[]);var q=e.params.vertexAttributes,t=q.position.count;
if(!k(l[0].stride))throw f("Layout stride must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");var v=new Uint32Array(l[0].stride/Uint32Array.BYTES_PER_ELEMENT*t);l=l.slice(0).sort(function(a,b){return a.offset-b.offset});e=function(e){var l=q[e.name],r=b(e.type),u=void 0,x=!1;if(null==l){x=m.filter(function(a){return a.name===e.name})[0];if(!x)throw f("Geometry definition is missing attribute");l={valueType:g(e.type),byteOffset:0,count:t,valuesPerElement:e.count};for(u=0;u<a.length;u++)a[u]=x.byteValue;
u=a.buffer;x=!0}else u=c;if(g(e.type)!==l.valueType)throw f("Geometry definition type must match attribute type");if(0!==l.byteOffset%Uint32Array.BYTES_PER_ELEMENT||0!==e.offset%Uint32Array.BYTES_PER_ELEMENT)throw f(e.name+" offset must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");if(!k(l.valuesPerElement*r.BYTES_PER_ELEMENT)||!k(e.count*r.BYTES_PER_ELEMENT))throw f(e.name+" data must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");var u=new Uint32Array(u),y=l.byteOffset/Uint32Array.BYTES_PER_ELEMENT,
l=l.valuesPerElement*r.BYTES_PER_ELEMENT/Uint32Array.BYTES_PER_ELEMENT,r=e.offset/Uint32Array.BYTES_PER_ELEMENT,F=e.stride/Uint32Array.BYTES_PER_ELEMENT;x?d(u,l,v,r,F,t):h(u,y,l,v,r,F,t)};for(var x=0;x<l.length;x++)e(l[x]);return v.buffer}})},"esri/views/3d/layers/i3s/I3SProjectionUtil":function(){define(["require","exports","../../support/projectionUtils","../../lib/glMatrix","../../webgl-engine/lib/Util"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});l.ReprojectionTypes={PER_VERTEX:"perVertex",
NO_REPROJECTION:"noReprojection"};var g=new Float64Array(3E3);l.reprojectPoints=function(b,f,a,e,c,m){if(b===l.ReprojectionTypes.PER_VERTEX){b=f.data;var k=f.offsetIdx;f=f.strideIdx;var q=d.mat4d.create();h.computeLinearTransformation(e,a,q,m);var u=d.mat4d.create();d.mat4d.inverse(q,u);var v=d.mat4d.create();d.mat4d.identity(v);var x=[0,0,0],y=b.length/f;h.vectorToVector(a,e,x,c);for(a=0;y>a;a+=1E3){e=Math.min(1E3,y-a);for(var n=0;e>n;n++){var w=k+f*(a+n);g[3*n]=b[w]+x[0];g[3*n+1]=b[w+1]+x[1];g[3*
n+2]=b[w+2]+x[2]}h.bufferToBuffer(g,c,0,g,m,0,e);for(n=0;e>n;n++){var z=g[3*n],C=g[3*n+1],B=g[3*n+2],w=k+f*(a+n);b[w]=u[0]*z+u[4]*C+u[8]*B+u[12];b[w+1]=u[1]*z+u[5]*C+u[9]*B+u[13];b[w+2]=u[2]*z+u[6]*C+u[10]*B+u[14]}}m={localTrafo:v,globalTrafo:q}}else c=d.mat4d.create(),d.mat4d.identity(c),b=d.mat4d.create(),h.computeLinearTransformation(e,a,b,m),m={localTrafo:c,globalTrafo:b};return m};l.reprojectNormalsPerVertex=function(g,f,a,e,c){b.assert(e.equals(h.SphericalECEFSpatialReference));e=d.mat4d.create();
h.computeLinearTransformation(a,f,e,c);f=d.mat4d.create();d.mat4d.inverse(e,f);a=g.data;c=g.offsetIdx;g=g.strideIdx;e=a.length/g;for(var k=0;e>k;k++){var l=c+g*k,m=a[l],u=a[l+1],v=a[l+2];a[l]=f[0]*m+f[4]*u+f[8]*v;a[l+1]=f[1]*m+f[5]*u+f[9]*v;a[l+2]=f[2]*m+f[6]*u+f[10]*v}}})},"esri/views/3d/layers/i3s/I3SQueryEngine":function(){define("require exports dojo/promise/all ../../../../core/promiseUtils ../../../../core/Error ../../../../tasks/support/FeatureSet".split(" "),function(m,l,h,d,b,g){return function(){function k(b,
a){this._support=b;this._options=a}return k.prototype.queryExtent=function(b){var a=this;return this._rejectUnsupported(b).then(function(){var d=0,c=a._support.createExtentBuilder();return a._forAllQueried(b,function(a){d++;c.add(a)}),{count:d,extent:0===d?null:c.getExtent()}})},k.prototype.queryFeatureCount=function(b){var a=this;return this._rejectUnsupported(b).then(function(){var d=0;return a._forAllQueried(b,function(){return d++}),d})},k.prototype.queryFeatures=function(b){var a=this;return this._rejectUnsupported(b).then(function(){var e=
[],c=b&&b.outFields,f=[];return a._forAllQueried(b,function(b){return f.push(a._support.createGraphic(b))},function(b){c&&(e.push(a._support.requestFields(b,f,c)),f=[])}),c||e.push(d.resolve(f)),h(e)}).then(function(a){a=a.reduce(function(a,b){return a.concat(b)},[]);var b=new g;return b.features=a,b})},k.prototype.queryObjectIds=function(b){var a=this;return this._rejectUnsupported(b).then(function(){var d=[];return a._forAllQueried(b,function(a){return d.push(a.id)}),d})},k.defaultExtentBuilder=
function(b){var a=null;return{add:function(d){(d=b(d))&&(a=null!=a?a.union(d):d.clone())},getExtent:function(){return a}}},k.prototype._forAllQueried=function(b,a,d){var c=[];if(b&&b.objectIds){var e=b.objectIds;c.push(function(a){return 0<=e.indexOf(a.id)})}this._support.forAll(function(b){for(var d=0;d<c.length;d++)if(!(0,c[d])(b))return;a(b)},d)},k.prototype._rejectUnsupported=function(f){if(null==f)return d.resolve();var a=function(a){return d.reject(new b("Unsupported Query","Unsupported property '"+
a+"'"))};return null!=f.distance?a("distance"):null!=f.geometryPrecision?a("geometryPrecision"):f.groupByFieldsForStatistics&&f.groupByFieldsForStatistics.length?a("groupByFieldsForStatistics"):null!=f.maxAllowableOffset?a("maxAllowableOffset"):f.multipatchOption?a("multipatchOption"):null!=f.num?a("num"):f.orderByFields&&f.orderByFields.length?a("orderByFields"):f.outSpatialReference?a("outSpatialReference"):f.outStatistics&&f.outStatistics.length?a("outStatistics"):f.pixelSize?a("pixelSize"):f.quantizationParameters?
a("quantizationParameters"):f.relationParameter?a("relationParameter"):f.returnDistinctValues?a("returnDistinctValues"):null!=f.start?a("start"):f.text?a("text"):f.timeExtent?a("timeExtent"):f.where?a("where"):f.geometry?a("geometry"):!this._options.enableOutFields&&f.outFields&&f.outFields.length?a("outFields"):!this._options.enableObjectId&&f.objectIds&&f.objectIds.length?a("objectIds"):d.resolve()},k}()})},"esri/views/3d/layers/i3s/Highlights":function(){define(["require","exports","../../webgl-engine/lib/HighlightSet"],
function(m,l,h){var d=function(){return function(b){this.highlightSet=new h;this.ids=new Set;this.options=b}}();return function(){function b(b){this.highlights=[];this.layerView=b}return b.prototype.destroy=function(){this.highlights.forEach(function(b){return b.highlightSet.removeAll()});this.highlights=null},b.prototype.acquireSet=function(b){var g=this,f=new d(b);this.highlights.push(f);return{set:f,handle:{remove:function(){return g.releaseSet(f)}}}},b.prototype.releaseSet=function(b){b.highlightSet.removeAll();
b=this.highlights?this.highlights.indexOf(b):-1;-1!==b&&this.highlights.splice(b,1)},b.prototype.setFeatureIds=function(b,d){d.forEach(function(d){return b.ids.add(d)});this.layerView._forAllFeatures(function(d,a,e,c){b.ids.has(d)&&(d=e.setComponentHighlight(c,a,b.options),b.highlightSet.addObject(e,d))},null,!0)},b.prototype.objectCreated=function(b){var d=this;this.highlights.forEach(function(f){d.layerView._forAllFeaturesOfObject(b,function(a,b,c,d){f.ids.has(a)&&(a=c.setComponentHighlight(d,b,
f.options),f.highlightSet.addObject(c,a))},!0)})},b.prototype.objectDeleted=function(b){this.highlights.forEach(function(d){d.highlightSet.removeObject(b)})},b.prototype.allObjectsDeleted=function(){this.highlights.forEach(function(b){return b.highlightSet.removeAll()})},b}()})},"esri/views/3d/webgl-engine/lib/HighlightSet":function(){define(["require","exports"],function(m,l){return function(){function h(){this.items=[]}return h.prototype.addObject=function(d,b){this.items.push({type:"object",highlightId:b,
object:d})},h.prototype.addRenderGeometry=function(d,b,g){this.items.push({type:"renderGeometry",highlightId:g,renderGeometry:d,renderer:b})},h.prototype.removeObject=function(d){for(var b=this.items.length-1;0<=b;--b){var g=this.items[b];"object"===g.type&&g.object===d&&(g.object.removeHighlights(g.highlightId),this.items.splice(b,1))}},h.prototype.removeRenderGeometry=function(d){for(var b=this.items.length-1;0<=b;--b){var g=this.items[b];"renderGeometry"===g.type&&g.renderGeometry===d&&(g.renderer.removeRenderGeometryHighlight(g.renderGeometry,
g.highlightId),this.items.splice(b,1))}},h.prototype.removeAll=function(){this.items.forEach(function(d){"object"===d.type?d.object.removeHighlights(d.highlightId):"renderGeometry"===d.type&&d.renderer.removeRenderGeometryHighlight(d.renderGeometry,d.highlightId)});this.items=[]},h}()})},"esri/views/3d/layers/i3s/IDBCache":function(){define(["require","exports","../../../../core/Error","../../../../core/promiseUtils"],function(m,l,h,d){function b(b){return d.create(function(d,a){b.oncomplete=function(){return d()};
b.onerror=function(){return a(b.error)};b.onabort=function(){return a(b.error)}})}function g(b){return d.create(function(d,a){"done"===b.readyState?null!=b.error?a(b.error):d(b.result):(b.onsuccess=function(){return d(b.result)},b.onerror=function(){return a(b.error)})})}Object.defineProperty(l,"__esModule",{value:!0});m=function(){function k(b,a,d){this._quotaReductionPromise=this._db=null;this._gcCounter=0;this.gcFrequency=50;this.maxByteSize=1073741824;this.quotaReductionFactor=.2;this._dbName=
b;this._storeName=a;this._version=d}return k.prototype.init=function(){var b=this;return d.resolve().then(function(){var a=indexedDB.open(b._dbName,b._version);return a.onupgradeneeded=function(d){var c=a.result,e=a.transaction,f=c.objectStoreNames.contains(b._storeName)?e.objectStore(b._storeName):c.createObjectStore(b._storeName),c=c.objectStoreNames.contains("last_access")?e.objectStore("last_access"):c.createObjectStore("last_access");c.indexNames.contains("date")||c.createIndex("date","date",
{unique:!1});c.indexNames.contains("byteSize")||c.createIndex("byteSize","byteSize",{unique:!1});d.oldVersion<b._version&&(f.clear(),c.clear())},g(a)}).then(function(a){b._db=a})},k.prototype.destroy=function(){this._db&&(this._db.close(),this._db=null)},k.prototype.put=function(b,a){var e=this;return null==this._db?d.reject(new h("indexedb:not-initialized","IndexedDB Cache is not initialized")):(null!=this._quotaReductionPromise?this._quotaReductionPromise:d.resolve()).then(function(){return e._put(b,
a)}).otherwise(function(c){if("QuotaExceededError"===c.name)return null==e._quotaReductionPromise&&(e._quotaReductionPromise=e._getCacheSize().then(function(b){return e._removeLeastRecentlyAccessed(a.byteSize+Math.ceil(b*e.quotaReductionFactor))}),e._quotaReductionPromise.always(function(){e._quotaReductionPromise=null})),e._quotaReductionPromise.then(function(){return e._put(b,a)});throw c;}).then(function(){e._gcCounter--;0>e._gcCounter&&(e._gcCounter=e.gcFrequency,e._getCacheSize().then(function(a){return e._removeLeastRecentlyAccessed(a-
e.maxByteSize)}))})},k.prototype.get=function(b){var a=this;return null==this._db?d.resolve(null):d.resolve().then(function(){var d=a._db.transaction(a._storeName,"readonly").objectStore(a._storeName).get(b);return g(d)}).then(function(d){null!=d&&a._db.transaction("last_access","readwrite").objectStore("last_access").put({date:(new Date).getTime(),byteSize:d.byteSize},b);return d}).otherwise(function(a){return null})},k.prototype.remove=function(f){var a=this;return null==this._db?d.resolve():d.resolve().then(function(){var d=
a._db.transaction([a._storeName,"last_access"],"readwrite"),c=d.objectStore(a._storeName),g=d.objectStore("last_access");return c["delete"](f),g["delete"](f),b(d)})},k.prototype._put=function(d,a){var e=this._db.transaction([this._storeName,"last_access"],"readwrite");e.objectStore(this._storeName).put(a,d);return e.objectStore("last_access").put({date:(new Date).getTime(),byteSize:a.byteSize},d),b(e)},k.prototype._removeLeastRecentlyAccessed=function(d){if(!(0>=d)){var a=this._db.transaction([this._storeName,
"last_access"],"readwrite"),e=a.objectStore(this._storeName),c=a.objectStore("last_access"),f=0,g=c.index("date").openCursor(null,"next");return g.onsuccess=function(a){a=g.result;null!=a&&(null!=a.value.byteSize&&(f+=a.value.byteSize),e["delete"](a.primaryKey),c["delete"](a.primaryKey),d>f&&a["continue"]())},b(a)}},k.prototype._getCacheSize=function(){var d=this._db.transaction("last_access"),a=0,e=d.objectStore("last_access").index("byteSize").openKeyCursor();return e.onsuccess=function(b){if(b=
e.result){var c=b.key;null!=c&&(a+=c);b["continue"]()}},b(d).then(function(){return a})},k}();l.IDBCache=m;l.whenTransaction=b;l.whenRequest=g})},"esri/views/3d/webgl-engine/lib/PreinterleavedGeometryData":function(){define(["require","exports","../../../webgl/Util","./ComponentUtils","./geometryDataUtils"],function(m,l,h,d,b){function g(b){switch(b){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;
case 5123:return Uint16Array}throw Error("Unhandled data type: "+b);}return function(){function k(f,a,e){void 0===e&&(e=k.DefaultOffsets);this.preinterleaved=!0;this.primitiveType="triangle";for(var c=h.getStride(a)/4,c=b.generateDefaultIndexArray(f.length/c),l={},m=0;m<a.length;m++){var r=a[m],u=new (g(r.type))(f.buffer),v=h.getBytesPerElement(r.type);l[r.name]={data:u,size:r.count,offsetIdx:r.offset/v,strideIdx:r.stride/v}}this._id=b.getNewId();this._vertexData=f;this._vertexAttributes=l;this._layout=
a;this._indexData=c;this._componentOffsets=d.createOffsets(e)}return Object.defineProperty(k.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"vertexData",{get:function(){return this._vertexData},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"indexData",{get:function(){return this._indexData},enumerable:!0,
configurable:!0}),Object.defineProperty(k.prototype,"componentOffsets",{get:function(){return this._componentOffsets},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"indexCount",{get:function(){return this._indexData.length},enumerable:!0,configurable:!0}),k.prototype.getId=function(){return this.id},k.prototype.toRenderData=function(){return{id:this._id.toString(),preinterleaved:!0,indexCount:this.indexCount,vertexData:this._vertexData,layout:this._layout}},k.prototype.getIndices=
function(b){return this._indexData},k.prototype.getAttribute=function(b){return this._vertexAttributes[b]},k.prototype.estimateGpuMemoryUsage=function(){return this._vertexData.byteLength},k.DefaultOffsets=new Uint32Array(0),k}()})},"esri/views/3d/layers/support/attributeUtils":function(){define(["require","exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});l.attributeLookup=function(h,d){d=d.toLowerCase();for(var b=0,g=Object.keys(h);b<g.length;b++){var k=g[b];if(k.toLowerCase()===
d)return h[k]}return null}})},"esri/views/3d/layers/i3s/I3SNodeLoader":function(){define("require exports dojo/_base/lang dojo/Deferred dojo/errors/CancelError ../../webgl-engine/lib/Util ./I3SUtil ./I3SBinaryReader ../../../../core/promiseUtils ../../../../core/urlUtils".split(" "),function(m,l,h,d,b,g,k,f,a,e){m=function(){function c(b,d,f,g,h){this.logger=d;this.defaultGeometrySchema=f;this.requiredAttributes=g;this.options=h;this.loadShared=function(b){if(null==b.sharedResource)return a.resolve({});
var d=e.makeAbsolute(b.sharedResource.href,b.baseUrl);return this.loadJSON(d).then(function(a){return c.fixTextureEncodings(a),c.addAbsoluteHrefTexture(a,d),a})};this.loader=b;this.cancelled=!1}return c.prototype.cancel=function(){this.cancelled=!0},c.prototype.loadJSON=function(a){var b=this.loader.request(a,"json"),c=new d;return b.then(function(a,b){c.resolve(b)},function(b){c.reject(Error("Failed to load: "+a))}),c.promise},c.prototype.loadBinary=function(a){var b=this.loader.request(a,"binary"),
c=new d;return b.then(function(a,b){c.resolve(b)},function(b){c.reject(Error("Failed to load: "+a))}),c.promise},c.prototype.loadImage=function(a){var b=this.loader.request(a,"image"),c=new d;return b.then(function(a,b){c.resolve(b)},function(b){c.reject(Error("Failed to load: "+a))}),c.promise},c.prototype.loadAttribute=function(a,b,c){a=e.makeAbsolute(c,a);return this.loadBinary(a).then(function(a){return f.readBinaryAttribute(b,a)})},c.prototype.loadAttributes=function(b,c,d){var e=this,f=d.map(function(d){return null==
b.attributeData||null==b.attributeData[d.index]?(e.logger.error("Missing attributeData for '"+d.name+"' on node '"+b.id+"'"),a.resolve(null)):e.loadAttribute(c,d.attributeStorageInfo,b.attributeData[d.index].href).otherwise(function(a){return e.logger.error("Failed to load attributeData for '"+d.name+"' on node '"+b.id+"'"),null})});return a.all(f).then(function(a){for(var b={},c=0;c<d.length;++c)a[c]&&(b[d[c].name]=a[c]);return b})},c.prototype.prepareBinaryGeometryData=function(a,b,c,d){if(h.mixin(a.geometries[0].params,
c),d||null!=c.vertexAttributes.region||delete c.vertexAttributes.region,null!=c.featureAttributes){d=c.featureAttributes;if(d.faceRange){var e=f.createTypedView(b,d.faceRange);a.componentOffsets=k.convertFlatRangesToOffsets(e,c.header.fields.featureCount,d.faceRange.valuesPerElement)}if(d.id){a.featureIds=[];var e=1,g=f.valueType2TypedArrayClassMap[d.id.valueType];"UInt64"===d.id.valueType&&(g=Uint32Array,e=2);b=new g(b,d.id.byteOffset,d.id.count*d.id.valuesPerElement*e);for(g=0;g<c.header.fields.featureCount;g++)if(a.featureIds[g]=
b[g*d.id.valuesPerElement*e],2===e){var l=b[g*d.id.valuesPerElement*e+1];if(2097150<=l)throw Error("ID exceeded maximum range supported by javascript (max \x3d 53bit-1 \x3d 9007199254740991)");a.featureIds[g]+=4294967296*l}}}},c.prototype.loadBundleData=function(b,c){var d=this,g=b.baseUrl,h=null,k=this.loadShared(b),l=null;null!=this.requiredAttributes&&(l=this.loadAttributes(b,g,this.requiredAttributes));var n=null;null!=b.geometryData&&(g=e.makeAbsolute(b.geometryData[c].href,g),n=this.loadBinary(g));
return k.then(function(e){d.handleCancelled();return(d.options.loadFeatureData?d.loadFeatureData(b,c):a.resolve(null)).then(function(c){d.handleCancelled();var g=d.options.loadFeatureData?d.collectGeometries(b,c,e):d.meshPyramidGeometryData(b,e);c=null!=n?n.then(function(a){h=a;var b=Object.keys(e.materialDefinitions)[0],b=e.materialDefinitions[b].params.vertexRegions,c=f.createGeometryDataIndex(a,d.defaultGeometrySchema,b);return d.prepareBinaryGeometryData(g[0],a,c,b),g}):a.resolve(g);var k=d.loadTextures(g,
e);return a.all([k,c,l])}).then(function(a){var b=a[0],c=a[1];a=a[2];d.handleCancelled();var f=null;return a&&(f={attributeData:a,loadedAttributes:d.requiredAttributes}),{allGeometryData:c,attributeDataInfo:f,geometryBuffer:h,sharedResource:e,textureData:b}})})},c.addAbsoluteHrefTexture=function(a,b){a=a.textureDefinitions;if(null!=a)for(var c=0,d=Object.keys(a);c<d.length;c++)for(var f=0,g=a[d[c]].images;f<g.length;f++){var h=g[f];Array.isArray(h.href)?h.hrefConcat=h.href.map(function(a){return e.makeAbsolute(a,
b)}):h.hrefConcat=e.makeAbsolute(h.href,b)}},c.fixTextureEncodings=function(a){a=a.textureDefinitions;if(null!=a)for(var b in a){var c=a[b];if(Array.isArray(c.encoding))for(var d=0;d<c.encoding.length;d++){var e=c.encoding[d];"data:"===e.substring(0,5)&&(c.encoding[d]=e.substring(5))}else e=c.encoding,"data:"===e.substring(0,5)&&(c.encoding=e.substring(5))}},c.prototype.loadTexture=function(a,b,c,d){var e=this;return d===k.DDS_ENCODING_STRING?this.loadBinary(a).then(function(a){return e.handleCancelled(),
{i3sTexId:b,data:a,encoding:d}}):this.loadImage(a).then(function(a){var f=a;e.handleCancelled();if(c&&4096<=a.width*a.height){var f=Math.ceil(a.width/2),g=Math.ceil(a.height/2),h=document.createElement("canvas");h.width=f;h.height=g;h.getContext("2d").drawImage(a,0,0,f,g);f=h}return{i3sTexId:b,data:f,encoding:d}})},c.prototype.loadTextures=function(b,d){for(var e=[],f=0;f<b.length;f++){var h=b[f].geometries;if(null!=h)for(var l=0;l<h.length;l++){var m=h[l].params.textureID||"none";if("none"!==m){null!=
d.textureDefinitions&&null!=d.textureDefinitions[m]||this.logger.warn("textureDefinitions missing in shared resource. i3sTexId: "+m);var n=d.textureDefinitions[m];if(g.assert(void 0!==n,"geometry wants unknown texture "+m),0!==n.images.length){var q=n.images[n.images.length-1],t=this.options.textureFormat===c.TextureFormat.Downsampled,C=k.getAppropriateTextureEncoding(n.encoding,this.options.textureFormat===c.TextureFormat.Compressed),n=-1<C?n.encoding[C]:n.encoding,q=-1<C?q.hrefConcat[C]:q.hrefConcat;
this.options.loadTextureData?e.push(this.loadTexture(q,m,t,n)):e.push({i3sTexId:m,encoding:n,data:null})}}}}return a.all(e)},c.prototype.meshPyramidGeometryData=function(a,b){a=b.materialDefinitions?Object.keys(b.materialDefinitions)[0]:null;b=b.textureDefinitions?Object.keys(b.textureDefinitions)[0]:null;return[{featureIds:[],geometries:[{type:"ArrayBufferView",params:{materialID:a,textureID:b}}],featureDataPosition:[0,0,0]}]},c.prototype.collectGeometries=function(a,b,c){a=[];c=0;for(b=b.featureData;c<
b.length;c++){var d=b[c],e=d.geometries;if(null!=e)for(var f=0;f<e.length;f++)a.push({featureIds:[d.id],featureDataPosition:d.position,geometries:[d.geometries[f]]});else null!=d.position&&a.push({featureIds:[d.id],featureDataPosition:d.position,geometries:null})}return a},c.prototype.loadFeatureData=function(a,b){a=e.makeAbsolute(a.featureData[b].href,a.baseUrl);return this.loadJSON(a)},c.prototype.handleCancelled=function(){if(this.cancelled)throw new b;},c}();return function(a){a=a.TextureFormat||
(a.TextureFormat={});a[a.Compressed=0]="Compressed";a[a.Normal=1]="Normal";a[a.Downsampled=2]="Downsampled";!0}(m||(m={})),m})},"esri/views/3d/layers/i3s/I3SIndexTraversal":function(){define("require exports ./GoogPriorityQueue ../../support/PromiseLightweight ../../lib/glMatrix ../../../../core/urlUtils".split(" "),function(m,l,h,d,b,g){var k=h.goog.structs.PriorityQueue;return function(){function f(a,d,c,f,h,k,l,m,x,y,n){void 0===n&&(n={initDepthFirst:!0,neighborhood:!0,perLevelTraversal:!1});var e=
this;this.baseURL=a;this.startNodeUrl=d;this.rootId=c;this.poi=f;this.nodeIndex=h;this.streamDataSupplier=k;this.viewportQueries=l;this.processNodeIndexDocument=m;this.finishedLevelCallback=x;this.logger=y;this.traversalOptions=n;this.queues=[];this.knownNodes=new Set;this.dataLoadingPerLevel=[];this.numIndicesLoading=this.currentLevel=0;this.cancelled=this.queueTraversalEnabled=!1;this.progressiveLoadPenalty=0;this.initQueryErrback=function(){e.initPromise.done()};this.initQueryCallback=function(a,
b){if(e.cancelled)return void e.initPromise.done();if(e.nodeTraversalState(b.id),e.enqueueConnected(a,b,0),e.isLeafNode(b))e.initPromise.done();else{for(var c=1/0,d=null,f=0;f<b.children.length;++f){var h=b.children[f];if(e.nodeIsVisible(h)&&(!e.viewportQueries.hasLOD(b)||!e.viewportQueries.getLodLevel(b))){var k=e.viewportQueries.distToPOI(h,e.poi);c>k&&(c=k,d=h)}}d?(a=g.makeAbsolute(d.href,a),e.getNode(a,d.id,e.initQueryCallback,e.initQueryErrback)):e.initPromise.done()}};this.poi=b.vec3d.create(f);
this._maxLodLevel=this.viewportQueries.maxLodLevel}return f.prototype.updatePointOfInterest=function(a){b.vec3d.set(a,this.poi);this.reprioritizeQueues()},f.prototype.start=function(){var a=this;this._nodeTraversalState={};this._nodeIsVisibleCached={};this.dataLoadingPerLevel=[];this.currentLevel=0;this.maxLevel=[];for(var b=0;b<this._maxLodLevel;b++)this.maxLevel[b]=0;this.rootUrl=g.makeAbsolute(this.startNodeUrl,this.baseURL);this.traversalOptions.initDepthFirst?(this.initPromise=new d.Promise,
this.getNode(this.rootUrl,this.rootId,this.initQueryCallback,this.initQueryErrback),this.initPromise.then(function(){a.cancelled||(a.queueTraversalEnabled=!0)})):(this.enqueue({id:this.rootId,hrefConcat:this.rootUrl,mbs:null},0),this.queueTraversalEnabled=!0)},f.prototype.continueTraversal=function(a){if(void 0===a&&(a=5),this.queueTraversalEnabled)for(var b=0;b<this.queues.length;b++)if(!this.traversalOptions.perLevelTraversal||this.currentLevel===b){for(var c=this.queues[b];this.numIndicesLoading<
a&&!c.isEmpty();)this.processQueueOne(b);this.traversalOptions.perLevelTraversal&&c.isEmpty()&&0===this.dataLoadingPerLevel[b]&&(this.finishedLevelCallback.call(null,this.currentLevel),this.currentLevel++)}},f.prototype.isQueueTraversalEnabled=function(){return this.queueTraversalEnabled},f.prototype.getQueueSize=function(){for(var a=0,b=0;b<this.queues.length;b++)a+=this.queues[b].getCount();return a},f.prototype.cancel=function(){this.queueTraversalEnabled=!1;for(var a=0;a<this.queues.length;a++)this.queues[a].clear();
this.cancelled=!0},f.prototype.isLoading=function(){return 0<this.numIndicesLoading||0<this.getQueueSize()},f.prototype.getNumLoading=function(){return this.numIndicesLoading+this.dataLoadingPerLevel[this.currentLevel]},f.prototype.getMaxLevel=function(a){return this.maxLevel[a]},f.prototype.nodeIsVisible=function(a){return this.traversalOptions.loadEverything?!0:null!=this._nodeIsVisibleCached[a.id]?this._nodeIsVisibleCached[a.id]:(this._nodeIsVisibleCached[a.id]=this.viewportQueries.isNodeVisible(a),
this._nodeIsVisibleCached[a.id])},f.prototype.nodeTraversalState=function(a){if(null!=this._nodeTraversalState[a])return this._nodeTraversalState[a];var b=this.nodeIndex[a];if(null==b)return null;var c=null,d=0;if(null!=b.parentNode){if(c=this.nodeIndex[b.parentNode.id],null==c)return null;c=this._nodeTraversalState[c.id];null!=c&&(d=c.lodLevel)}var c=this.viewportQueries.hasLOD(b),f=this.viewportQueries.getLodLevel(b);return this._nodeTraversalState[b.id]={visited:!0,nodeHasLOD:c,lodLevel:f,isChosen:!c||
f>d},this._nodeTraversalState[a]},f.prototype.reprioritizeQueues=function(){for(var a=0;a<this.queues.length;a++)this.queues[a]=this.reprioritizeQueue(this.queues[a])},f.prototype.reprioritizeQueue=function(a){for(var b=new k;!a.isEmpty();){var c=a.dequeue(),d=this.entryPriority(c);b.enqueue(d,c)}return b},f.prototype.processQueueOne=function(a){var b=this,c=this.queues[a].dequeue();this.dataLoadingPerLevel[a]++;var d=function(){return b.dataLoadingPerLevel[a]--},f=function(e,f){b.nodeTraversalState(f.id);
b.enqueueConnected(e,f,a);e=b.entryPriority(c);b.processNodeIndexDocument(f,e).then(d,d)};this.getNode(c.hrefConcat,c.id,function(a,c){if(b.traversalOptions.neighborhood&&null!=c.parentNode){var e=b.concatHref(c.parentNode,a);b.getNode(e,c.parentNode.id,function(){return f(a,c)},d)}else f(a,c)},d)},f.prototype.getNode=function(a,b,c,d){var e=this;this.numIndicesLoading++;this.nodeIndex[b]?(c(a,this.nodeIndex[b]),this.numIndicesLoading--):this.streamDataSupplier.request(a,"json").then(function(a,b){e.nodeIndex[b.id]=
b;b.baseUrl=a;c(a,b);e.numIndicesLoading--},function(b){null!=d&&d(b);e.loadErrorCallback(a);e.numIndicesLoading--})},f.prototype.isLeafNode=function(a){return null==a.children},f.prototype.concatHref=function(a,b){return g.makeAbsolute(a.href,b)},f.prototype.enqueue=function(a,b){this.traversalOptions.perLevelTraversal||(b=0);for(this.knownNodes.add(a.id);this.queues.length<=b;)this.queues.push(new k),this.dataLoadingPerLevel.push(0);var c=this.entryPriority(a);this.queues[b].enqueue(c,a)},f.prototype.entryPriority=
function(a){if(a.id===this.rootId)return 0;var b=0,c=this.nodeIndex[a.id];null!=c&&null!=c.parentNode&&(c=this._nodeTraversalState[c.parentNode.id],null!=c&&(b=c.lodLevel));a=this.viewportQueries.distToPOI(a,this.poi);return a+b*(a+this.progressiveLoadPenalty)},f.prototype.queueEntryFromNode=function(a,b){return{id:a.id,mbs:a.mbs,hrefConcat:b}},f.prototype.queueEntryFromNodeRef=function(a,b){return this.queueEntryFromNode(a,this.concatHref(a,b))},f.prototype.enqueueConnected=function(a,b,c){if(!this.cancelled&&
null!=b){b.id===this.rootId||null==b.parentNode||this.knownNodes.has(b.parentNode.id)?b.id===this.rootId&&!this.knownNodes.has(b.id)&&this.nodeIsVisible(b)&&this.enqueue(this.queueEntryFromNode(b,a),c):this.enqueue(this.queueEntryFromNodeRef(b.parentNode,a),c-1);var d=this.nodeTraversalState(b.id);if(!d.nodeHasLOD||d.lodLevel!==this._maxLodLevel){if(b.children)for(var e=0,f=b.children;e<f.length;e++){var g=f[e],h=this.nodeIsVisible(g);!this.knownNodes.has(g.id)&&h&&(this.enqueue(this.queueEntryFromNodeRef(g,
a),c+1),this.maxLevel[d.lodLevel]=Math.max(b.level+1,this.maxLevel[d.lodLevel]))}if(this.traversalOptions.neighborhood&&b.neighbors)for(d=0,b=b.neighbors;d<b.length;d++)e=b[d],f=this.nodeIsVisible(e),!this.knownNodes.has(e.id)&&f&&this.enqueue(this.queueEntryFromNodeRef(e,a),c)}}},f.prototype.loadErrorCallback=function(a){this.logger.warn("Error loading node: "+a)},f}()})},"esri/views/3d/layers/i3s/GoogPriorityQueue":function(){define([],function(){var m={};return function(){function l(a){var b=typeof a;
if("object"==b){if(!a)return"null";if(a instanceof Array)return"array";if(a instanceof Object)return b;var d=Object.prototype.toString.call(a);if("[object Window]"==d)return"object";if("[object Array]"==d||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==d||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}function h(b,c){b=b.split(".");var d=a;b[0]in d||!d.execScript||d.execScript("var "+b[0]);for(var e;b.length&&(e=b.shift());)b.length||void 0===c?d=d[e]?d[e]:d[e]={}:d[e]=c}function d(a,b){this.d=a;this.b=b}function b(a){if("array"!=l(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function g(a){if(this.a=[],a)a:{var b,e;if(a instanceof g){b=a.a;e=[];for(var f=b.length,h=0;f>h;h++)e.push(b[h].getKey());b=e;e=a.a;for(var f=[],h=e.length,
l=0;h>l;l++)f.push(e[l].b);if(e=f,0>=a.a.length){a=this.a;for(f=0;f<b.length;f++)a.push(new d(b[f],e[f]));break a}}else{b=[];f=0;for(h in a)b[f++]=h;f=[];h=0;for(e in a)f[h++]=a[e];e=f}for(f=0;f<b.length;f++)k(this,b[f],e[f])}}function k(a,b,f){var c=a.a;c.push(new d(b,f));b=c.length-1;a=a.a;for(f=a[b];0<b&&(c=b-1>>1,a[c].getKey()>f.getKey());)a[b]=a[c],b=c;a[b]=f}function f(){g.call(this)}var a=this;d.prototype.getKey=function(){return this.d};d.prototype.c=function(){return new d(this.d,this.b)};
g.prototype.remove=function(){var a=this.a,c=a.length,d=a[0];if(!(0>=c)){if(1==c)b(a);else{a[0]=a.pop();for(var a=0,c=this.a,f=c.length,g=c[a];f>>1>a;){var h=2*a+1,k=2*a+2,h=f>k&&c[k].getKey()<c[h].getKey()?k:h;if(c[h].getKey()>g.getKey())break;c[a]=c[h];a=h}c[a]=g}return d.b}};g.prototype.c=function(){return new g(this)};g.prototype.g=function(){return this.a.length};g.prototype.h=function(){return 0==this.a.length};g.prototype.clear=function(){b(this.a)};(function(){function a(){}a.prototype=g.prototype;
f.i=g.prototype;f.prototype=new a})();f.prototype.f=function(a,b){k(this,a,b)};f.prototype.e=function(){return this.remove()};h("goog.structs.PriorityQueue",f);h("goog.structs.PriorityQueue.prototype.enqueue",f.prototype.f);h("goog.structs.PriorityQueue.prototype.dequeue",f.prototype.e);h("goog.structs.PriorityQueue.prototype.isEmpty",f.prototype.h);h("goog.structs.PriorityQueue.prototype.clear",f.prototype.clear);h("goog.structs.PriorityQueue.prototype.clone",f.prototype.c);h("goog.structs.PriorityQueue.prototype.getCount",
f.prototype.g)}.call(m),m})},"esri/views/3d/layers/i3s/I3SLodHandling":function(){define(["require","exports"],function(m,l){return function(){function h(d,b,g){this.layerViewRequiredFunctions=d;this.layerViewOptionalFunctions=b;this.lodGlobalDirtyChanged=g}return h.prototype.startNodeLoading=function(d,b,g,h,f){this._lodGlobalDirty=!1;this._lodMode=f.mode;this._allowPartialOverlaps=f.allowPartialOverlaps;this._maxLodLevel=f.maxLodLevel;this._nodeIndex=g;this._rootId=h;this._nodeTraversalState=b;
this._nodeIsVisible=d;this.lodGlobalDirtyChanged(this._lodGlobalDirty)},h.prototype.shouldLoadNode=function(d){var b=this._nodeTraversalState(d.id);return"perLevel"!==this._lodMode?b.isChosen?b.lodLevel===this._maxLodLevel?!0:this._subtreeEmpty(d):!1:b.isChosen||!b.nodeHasLOD?!0:this._allowPartialOverlaps?!this._subtreeComplete(d):this._subtreeEmpty(d)},h.prototype.setLodGlobalDirty=function(){this._lodGlobalDirty=!0;this.lodGlobalDirtyChanged(this._lodGlobalDirty)},h.prototype.finishedLevel=function(d){"perLevel"===
this._lodMode&&this._removeUpToLevelRecursive(this._nodeIndex[this._rootId],d-1)},h.prototype.lodSwapBundleLoaded=function(d){if("perLevel"===this._lodMode){var b=this._nodeTraversalState(d.id).isChosen;b&&this._removeChildrenRecursive(d);null!=this.layerViewOptionalFunctions.setPolygonOffset&&this.layerViewOptionalFunctions.setPolygonOffset(d,!b)}else this.setLodGlobalDirty()},Object.defineProperty(h.prototype,"requiresLODGlobalHandling",{get:function(){return"global"===this._lodMode&&null!=this._rootId&&
(!0===this._lodGlobalDirty||this.layerViewRequiredFunctions.isOverMemory())},enumerable:!0,configurable:!0}),h.prototype.lodGlobalHandling=function(){if(this.requiresLODGlobalHandling){var d=this._rootId,b=this.layerViewRequiredFunctions.isOverMemory();this._lodGlobalHandlingRecursion(d,!1,b);this._lodGlobalDirty=!1;this.lodGlobalDirtyChanged(this._lodGlobalDirty)}},h.prototype._lodGlobalHandlingRecursion=function(d,b,g){var h=this._nodeIndex[d];if(null==h)return!1;d=this._nodeTraversalState(d);d=
d.isChosen&&(!d.nodeHasLOD||d.lodLevel===this._maxLodLevel);var f=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(h,0);f&&null!=this.layerViewOptionalFunctions.setPolygonOffset&&this.layerViewOptionalFunctions.setPolygonOffset(h,!d);if(d&&f)return this._removeChildrenRecursive(h),!0;var a=!1;if(null!=h.children&&0!==h.children.length)for(var a=!0,e=0,c=h.children;e<c.length;e++){var l=c[e];this._nodeIsVisible(l)&&(l=this._lodGlobalHandlingRecursion(l.id,f||b,g),a=a&&l)}return f&&!d&&(b||
a||g)&&(this.layerViewRequiredFunctions.removeNodeData(h),f=!1),a||f},h.prototype._removeChildrenRecursive=function(d){if(null!=d.children){var b=0;for(d=d.children;b<d.length;b++){var g=this._nodeIndex[d[b].id];null!=g&&(this._removeChildrenRecursive(g),this.layerViewRequiredFunctions.removeNodeData(g))}}},h.prototype._removeUpToLevelRecursive=function(d,b){if(!(null==d||0>b)&&(this._nodeTraversalState(d.id).isChosen||this.layerViewRequiredFunctions.removeNodeData(d),null!=d.children)){var g=0;for(d=
d.children;g<d.length;g++)this._removeUpToLevelRecursive(this._nodeIndex[d[g].id],b-1)}},h.prototype._subtreeEmpty=function(d){if(this.layerViewRequiredFunctions.areAllBundlesLoaded(d))return!1;if(null==d.children)return!0;var b=0;for(d=d.children;b<d.length;b++){var g=d[b];if(this._nodeIsVisible(g)&&(g=this._nodeIndex[g.id],null!=g&&!this._subtreeEmpty(g)))return!1}return!0},h.prototype._subtreeComplete=function(d){if(this.layerViewRequiredFunctions.areAllBundlesLoaded(d))return!0;if(null==d.children||
0===d.children.length)return!1;var b=0;for(d=d.children;b<d.length;b++){var g=d[b];if(this._nodeIsVisible(g)&&(g=this._nodeIndex[g.id],null==g||!this._subtreeComplete(g)))return!1}return!0},h}()})},"esri/views/3d/layers/i3s/I3SViewportQueries":function(){define("require exports ../../lib/glMatrix ./I3SUtil ../../webgl-engine/lib/Util ../../support/projectionUtils ../graphics/featureExpressionInfoUtils ../graphics/ElevationContext ../graphics/Graphics3DSymbolCommonCode ../../../../geometry/Point".split(" "),
function(m,l,h,d,b,g,k,f,a,e){var c=h.vec3d,q=h.vec4d;return function(){function h(a,c,d,g,h,l,m,t,C){void 0===C&&(C={});this._computedMbs=a;this.indexSR=c;this._renderCoordsHelper=d;this.extent=h;this.errorMetricPreference=l;this.elevationProvider=m;this.options=C;this.fp=[];this.maxLodLevel=2;this._tmp1=[0,0,0];this._tmp2=[0,0,0];this._tmp3=[0,0,0];this._tmp0=[0,0,0];this.supportedMetrics=["screenSpaceRelative","maxScreenThreshold","removedFeatureDiameter","distanceRangeFromDefaultCamera"];this.screenspaceErrorBias=
C.screenspaceErrorBias||1;this.progressiveLoadFactor=C.progressiveLoadFactor||1;this.enableLoD=!C.disableLod;for(a=0;8>a;++a)this.fp[a]=q.create();b.matrix2frustumPlanes(g.viewMatrix,g.projectionMatrix,this.fp);this.engineSR=this._renderCoordsHelper.spatialReference;this._screenSizeFactor=1/g.perPixelRatio;this._camPos=g.eye;t?(this._elevationContext=new f,this._elevationContext.featureExpressionInfoContext=k.createContext(k.extractExpressionInfo(t,!1)),this._elevationContext.mixinApi(t)):this._elevationContext=
null;this.tmpPoint=new e({x:0,y:0,z:0,spatialReference:c})}return h.prototype.computedMbs=function(b){var c=this._computedMbs[b.id];return null==c&&(c=q.createFrom(0,0,0,-1),this._computedMbs[b.id]=c),0>c[3]&&(q.set(b.mbs,c),this._elevationContext&&1E5>b.mbs[3]&&(this.tmpPoint.x=c[0],this.tmpPoint.y=c[1],this.tmpPoint.z=c[2],c[2]=a.computeElevation(this.elevationProvider,this.tmpPoint,this._elevationContext,this._renderCoordsHelper,null)),g.mbsToMbs(c,this.indexSR,c,this.engineSR)),c},h.prototype.isNodeVisible=
function(a){a=this.computedMbs(a);return this.isMBSinExtent(a)&&this.isMBSVisible(a)},h.prototype.isMBSinExtent=function(a){return this.extent?0!==d.intersectBoundingBoxWithMbs(this.extent,a):!0},h.prototype.isMBSVisible=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];var e=this.fp;return e[0][0]*b+e[0][1]*c+e[0][2]*d+e[0][3]<=a&&e[1][0]*b+e[1][1]*c+e[1][2]*d+e[1][3]<=a&&e[2][0]*b+e[2][1]*c+e[2][2]*d+e[2][3]<=a&&e[3][0]*b+e[3][1]*c+e[3][2]*d+e[3][3]<=a&&e[4][0]*b+e[4][1]*c+e[4][2]*d+e[4][3]<=a&&e[5][0]*
b+e[5][1]*c+e[5][2]*d+e[5][3]<=a},h.prototype.calcScreenSpaceSize=function(a,b){a=this.computedMbs(a);var d=a[3];a=c.dist2(a,this._camPos)-d*d;return 0>a?.5*Number.MAX_VALUE:b/Math.sqrt(a)*this._screenSizeFactor},h.prototype.calcCameraDistance=function(a){a=this.computedMbs(a);return Math.max(0,c.dist(a,this._camPos)-a[3])},h.prototype.calcAngleDependentLoD=function(a){a=this.computedMbs(a);var b=a[3];a=(Math.abs(a[0]*(a[0]-this._camPos[0])+a[1]*(a[1]-this._camPos[1])+a[2]*(a[2]-this._camPos[2]))/
c.length(a)+b)/c.dist(a,this._camPos);return Math.min(1,a)},h.prototype.hasLOD=function(a){return null!=a.lodSelection},h.prototype.hasFeatures=function(a){return null!=a.featureData},h.prototype.getDistancePlanarMode=function(a,b,c){var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];d=d+d+e*e;if(c*c>=d)return Math.abs(a);c=Math.sqrt(d)-c;return Math.sqrt(a*a+c*c)},h.prototype.getDistanceGlobeMode=function(a,b,d){var e=c.length(b),f=c.length(a)-e;c.scale(a,c.dot(a,b)/c.length2(a),this._tmp0);var g=c.dist2(b,
this._tmp0);if(d*d>=g)return Math.abs(f);b=c.scale(b,1/e,this._tmp0);e=c.scale(b,e-d*d/2/e,this._tmp1);g=c.subtract(a,e,this._tmp2);g=c.subtract(g,c.scale(b,c.dot(b,g),this._tmp3),this._tmp2);e=c.add(e,c.scale(g,d/c.length(g),this._tmp2),this._tmp2);d=c.dist(a,e);2E5<=f&&(a=c.subtract(a,e,this._tmp1),a=c.dot(a,b)/c.length(a),.08>a&&(a=1E-4),d/=a);return d},h.prototype.getDistance=function(a,b,c){return this.engineSR===g.SphericalECEFSpatialReference?this.getDistanceGlobeMode(a,b,c):this.getDistancePlanarMode(a,
b,c)},h.prototype._selectErrorMetric=function(a){if(this.errorMetricPreference)for(var b=0;b<this.errorMetricPreference.length;b++)for(var c=0;c<a.length;c++){if(a[c].metricType===this.errorMetricPreference[b])return a[c]}else for(b=0;b<a.length;b++)if(0<=this.supportedMetrics.indexOf(a[b].metricType))return a[b];return null},h.prototype.getLodLevel=function(a){if(a.lodSelection&&0<a.lodSelection.length){if(!1===this.hasFeatures(a))return 0;if(null==a.children||0===a.children.length)return this.maxLodLevel;
var b=this.enableLoD?this._selectErrorMetric(a.lodSelection):null;if(null!=b){if(1>this.progressiveLoadFactor){var c=this.screenspaceErrorBias;return this.evaluateLODmetric(a,this.progressiveLoadFactor*this.screenspaceErrorBias,b)?this.evaluateLODmetric(a,c,b)?2:1:0}return this.evaluateLODmetric(a,this.screenspaceErrorBias,b)?this.maxLodLevel:0}}return 0},h.prototype.evaluateLODmetric=function(a,b,c){return"screenSpaceRelative"===c.metricType?(a=this.computedMbs(a),a=2*this.getDistance(this._camPos,
a,a[3])/this._screenSizeFactor,c.maxError*b<=a):"maxScreenThreshold"===c.metricType?(b=this.calcScreenSpaceSize(a,a.mbs[3]*b),this.options.angleDependentLoD&&(b*=this.calcAngleDependentLoD(a)),b<c.maxError):"removedFeatureDiameter"===c.metricType?10>this.calcScreenSpaceSize(a,c.maxError)*b:"distanceRangeFromDefaultCamera"===c.metricType?this.calcCameraDistance(a)>c.maxError*b:!1},h.prototype.distToPOI=function(a,b){a=this.computedMbs(a);return c.dist(a,b)-a[3]},h.prototype.distCameraToPOI=function(a){return c.dist(this._camPos,
a)},h}()})},"esri/views/3d/layers/i3s/IdleQueue":function(){define(["require","exports","dojo/Deferred"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function d(){this._deferreds=[];this._values=[]}return d.prototype.push=function(b){var d=new h;return this._deferreds.push(d),this._values.push(b),d.promise},d.prototype.length=function(){return this._deferreds.length},d.prototype.process=function(){this._deferreds.shift().resolve(this._values.shift())},d.prototype.cancelAll=
function(){for(var b=0,d=this._deferreds;b<d.length;b++)d[b].cancel();this._deferreds.length=0;this._values.length=0},d}();l.IdleQueue=m})},"esri/layers/SceneLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Layer ./FeatureLayer ./support/Field ./support/fieldUtils ./support/LabelClass ../symbols/support/ElevationInfo ./support/labelingInfo ./support/FeatureReduction ./mixins/SceneService ./support/commonProperties ../PopupTemplate ../request ../core/requireUtils ../core/promiseUtils ../core/urlUtils ../core/Error ../core/Logger ../core/accessorSupport/PropertyOrigin ../core/accessorSupport/utils ../renderers/support/jsonUtils ../renderers/support/styleUtils ../renderers/support/typeUtils ../portal/PortalItem ../tasks/support/Query dojo/_base/lang dojo/promise/all".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P,Q,T){function O(a,b,c){return a&&(a=G.read(a,b,c)||void 0,a||H.error("Failed to create renderer",{rendererDefinition:a,layer:this,context:c})),a}var S=["3DObject","Point"],H=C.getLogger("esri.layers.SceneLayer"),Y={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},
W={"mesh-pyramids":"mesh",points:"point",lines:"polyline",polygons:"polygon"};return function(g){function l(a,b){a=g.call(this)||this;return a.featureReduction=null,a.operationalLayerType="ArcGISSceneServiceLayer",a.type="scene",a.fields=[],a.definitionExpression=null,a.elevationInfo=null,a.labelsVisible=!1,a.labelingInfo=null,a.legendEnabled=!0,a.cachedDrawingInfo={color:!1},a.popupEnabled=!0,a.popupTemplate=null,a.objectIdField=null,a.objectIdFilter=null,a._fieldUsageInfo={},a.screenSizePerspectiveEnabled=
!0,a}return h(l,g),l.prototype.normalizeCtorArgs=function(a,b){return"string"==typeof a?Q.mixin({},{url:a},b):a},l.prototype.getField=function(b){return a.getField(b,this.fields)},Object.defineProperty(l.prototype,"geometryType",{get:function(){return W[this.profile]||"mesh"},enumerable:!0,configurable:!0}),l.prototype.readLabelsVisible=function(a,b){return b.showLabels},l.prototype.writeLabelsVisible=function(a,b){b.showLabels=!!a},Object.defineProperty(l.prototype,"renderer",{set:function(b){a.fixRendererFields(b,
this.fields);this._set("renderer",b)},enumerable:!0,configurable:!0}),l.prototype.readCachedDrawingInfo=function(a,b){return(null==a||"object"!=typeof a)&&(a={}),null==a.color&&(a.color=!1),a},l.prototype.readPopupEnabled=function(a,b){return null!=b.disablePopup?!b.disablePopup:void 0},l.prototype.writePopupEnabled=function(a,b){a||(b.disablePopup=!0)},l.prototype.readObjectIdField=function(a,b){return!a&&b.fields&&b.fields.some(function(b){return"esriFieldTypeOID"===b.type&&(a=b.name),!!a}),a||
void 0},l.prototype.readProfile=function(a,b){a=b.store.profile;return null!=a&&Y[a]?Y[a]:(H.error("Unknown or missing profile",{profile:a,layer:this}),"mesh-pyramids")},l.prototype.readNormalReferenceFrame=function(a,b){return b.store.normalReferenceFrame},l.prototype.load=function(){var b=this,c=this.loadFromPortal({supportedTypes:["Scene Service"]}).always(function(){return b._fetchService()}).then(function(){return T([b._verifyRootNodeAndUpdateExtent(),b._setCompanionFeatureLayer()])}).then(function(){return b._applyCompanionOverrides()}).then(function(){return b._populateFieldUsageInfo()}).then(function(){return N.loadStyleRenderer(b,
{origin:"service"})}).then(function(){return a.fixRendererFields(b.renderer,b.fields)});return this.addResolvingPromise(c),this.when()},l.prototype.createLayerView=function(a){var b,c=this;return b=null==this.profile||"mesh-pyramids"===this.profile?"../views/3d/layers/SceneLayerView3D":"../views/3d/layers/SceneLayerGraphicsView3D",y.when(m,b).then(function(b){return new b({view:a,layer:c})})},l.prototype.createQuery=function(){var a=new P;return"mesh"!==this.geometryType&&(a.returnGeometry=!0,a.returnZ=
!0),a.where=this.definitionExpression||"1\x3d1",a.sqlFormat="standard",a},l.prototype.queryExtent=function(a){var b=this;return this._getAssociatedLayerForQuery().then(function(c){return c.queryExtent(a||b.createQuery())})},l.prototype.queryFeatureCount=function(a){var b=this;return this._getAssociatedLayerForQuery().then(function(c){return c.queryFeatureCount(a||b.createQuery())})},l.prototype.queryFeatures=function(a){var b=this;return this._getAssociatedLayerForQuery().then(function(c){return c.queryFeatures(a||
b.createQuery())}).then(function(a){if(a&&a.features)for(var c=0,d=a.features;c<d.length;c++)d[c].layer=b;return a})},l.prototype.queryObjectIds=function(a){var b=this;return this._getAssociatedLayerForQuery().then(function(c){return c.queryObjectIds(a||b.createQuery())})},l.prototype.getFieldUsageInfo=function(a){return this._fieldUsageInfo[a]||{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}},l.prototype._getAssociatedLayerForQuery=function(){var a=this;
if(!this.loaded)return this.load().then(function(){return a._getAssociatedLayerForQuery()});var b=this.associatedLayer;return null!=b?n.resolve(b):n.reject(new z("scenelayer:query-not-available","SceneLayer queries are not available without associated feature layer"))},l.prototype.hasCachedStatistics=function(a){return null!=this.statisticsInfo&&this.statisticsInfo.some(function(b){return b.name===a})},l.prototype.queryCachedStatistics=function(a){if(!this.hasCachedStatistics(a))return n.reject(new z("scenelayer:no-cached-statistics",
"Cached statistics for this attribute are not available"));for(var b=0,c=this.statisticsInfo;b<c.length;b++){var d=c[b];if(d.name===a)return a=w.join(this.parsedUrl.path,d.href),x(a,{query:{f:"json"},responseType:"json"}).then(function(a){return a.data})}},l.prototype.graphicChanged=function(a){this.emit("graphic-update",a)},l.prototype._validateLayer=function(a){if(a.layerType&&-1===S.indexOf(a.layerType))throw new z("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",
{layerType:a.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new z("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(1<this.version.major)throw new z("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});a=this.normalReferenceFrame;var b=this.spatialReference,c=!1,d=!1;if(null==a)d=c=!0;else switch(b=
b&&b.isGeographic,a){case "east-north-up":case "earth-centered":c=!0;d=b;break;case "vertex-reference-frame":c=!0;d=!b;break;default:c=!1}if(!c)throw new z("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!d)throw new z("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.");},l.prototype._populateFieldUsageInfo=function(){if(this._fieldUsageInfo={},this.fields)for(var a=function(a){var c=!(!b.attributeStorageInfo||
!b.attributeStorageInfo.some(function(b){return b.name===a.name})),d=!!(b.associatedLayer&&b.associatedLayer.fields&&b.associatedLayer.fields.some(function(b){return b&&a.name===b.name}));b._fieldUsageInfo[a.name]={supportsLabelingInfo:c,supportsRenderer:c,supportsPopupTemplate:c||d,supportsLayerQuery:d}},b=this,c=0,d=this.fields;c<d.length;c++)a(d[c])},l.prototype._applyCompanionOverrides=function(){if(this.associatedLayer){if(this.associatedLayer.fields)for(var a=0,b=this.associatedLayer.fields;a<
b.length;a++){var c=b[a];this.getField(c.name)||this.fields.push(c.clone())}a=["popupTemplate","popupEnabled"];b=F.getProperties(this);for(c=0;c<a.length;c++){var d=a[c];this._buddyIsMoreImportant(d)&&(b.setDefaultOrigin(this.associatedLayer.originOf(d)),b.set(d,this.associatedLayer[d]),b.setDefaultOrigin("user"))}}},l.prototype._setCompanionFeatureLayer=function(){var a=this;return this._fetchCompanionFeatureLayer().then(function(b){a.associatedLayer=b})},l.prototype._fetchCompanionFeatureLayer=
function(){var a,b=this;return-1===["mesh-pyramids","points"].indexOf(this.profile)?n.resolve(null):(a=this.portalItem&&this.portalItem.isResolved()?this._fetchCompanionFeatureLayerFromRelatedItems(this.portalItem):this._fetchCompanionFeatureLayerFromUrl(),a.then(function(a){return a.load()}).otherwise(function(a){return null==b.attributeStorageInfo?H.warn("Companion FeatureLayer could not be loaded and no binary attributes found. Popups will not work for this SceneLayer: "+b.title):H.info("Companion FeatureLayer could not be loaded. Falling back to binary attributes for Popups on this SceneLayer: "+
b.title),null}))},l.prototype._fetchCompanionFeatureLayerFromRelatedItems=function(a){var b=this;return a.fetchRelatedItems({relationshipType:"Service2Data",direction:"forward"}).then(function(a){return(a=a.filter(function(a){return"Feature Service"===a.type})[0])?b._fetchCompanionFeatureLayerFromPortalItem(new R({id:a.id,portal:a.portal})):n.reject()}).otherwise(function(){return b._fetchCompanionFeatureLayerFromUrl()})},l.prototype._fetchCompanionFeatureLayerFromPortalItem=function(a){var b=this;
return a.load().then(function(a){return b._findMatchingCompanionSublayerUrl(a.url)}).then(function(b){return n.resolve(new k({url:b,portalItem:a}))})},l.prototype._fetchCompanionFeatureLayerFromUrl=function(){return this._findMatchingCompanionSublayerUrl().then(function(a){return n.resolve(new k({url:a}))})},l.prototype._findMatchingCompanionSublayerUrl=function(a){var b=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);if(!b)return n.reject();null==a&&(a=b[1]+"/FeatureServer");
var c=a.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1");a={query:{f:"json"},responseType:"json"};var d=b[1]+"/SceneServer",e=parseInt(b[2],10),b=x(d,a).otherwise(function(a){return{layers:null}});a=x(c,a);return T([a,b]).then(function(a){var b=a[0];a=a[1];a=a.data&&a.data.layers;b=b.data&&b.data.layers;if(!Array.isArray(b))throw Error("expected layers array");if(Array.isArray(a))for(var d=0;d<Math.min(a.length,b.length);d++){if(a[d].id===e)return c+"/"+b[d].id}else if(e<b.length)return c+"/"+b[e].id;
throw Error("could not find matching associated sublayer");})},l.prototype._buddyIsMoreImportant=function(a){if(!this.associatedLayer)return!1;var b=B.nameToId(this.originOf(a));a=B.nameToId(this.associatedLayer.originOf(a));return null!=a&&a<=B.OriginId.SERVICE?null==b||b<B.OriginId.SERVICE:null!=a&&a<=B.OriginId.PORTAL_ITEM?null==b||b<B.OriginId.PORTAL_ITEM:!1},d([b.shared("esri.layers.SceneLayer")],l.prototype,"declaredClass",void 0),d([b.property({types:{key:"type",base:t.FeatureReduction,typeMap:{selection:t.FeatureReductionSelection}},
json:{origins:{"web-scene":{read:{source:"layerDefinition.featureReduction"},write:{target:"layerDefinition.featureReduction"}}}}})],l.prototype,"featureReduction",void 0),d([b.property()],l.prototype,"associatedLayer",void 0),d([b.property()],l.prototype,"operationalLayerType",void 0),d([b.property({json:{read:!1},readOnly:!0})],l.prototype,"type",void 0),d([b.property({type:[f]})],l.prototype,"fields",void 0),d([b.property({readOnly:!0})],l.prototype,"attributeStorageInfo",void 0),d([b.property({readOnly:!0})],
l.prototype,"statisticsInfo",void 0),d([b.property({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],l.prototype,"definitionExpression",void 0),d([b.property({type:c,json:{origins:{service:{read:{source:"elevationInfo"}}},read:{source:"layerDefinition.elevationInfo"},write:{target:"layerDefinition.elevationInfo"}}})],l.prototype,"elevationInfo",void 0),d([b.property({type:String,dependsOn:["profile"]})],
l.prototype,"geometryType",null),d([b.property({type:Boolean})],l.prototype,"labelsVisible",void 0),d([b.reader("labelsVisible",["showLabels"])],l.prototype,"readLabelsVisible",null),d([b.writer("labelsVisible")],l.prototype,"writeLabelsVisible",null),d([b.property({type:[e],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:q.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:q.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],
l.prototype,"labelingInfo",void 0),d([b.property({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],l.prototype,"legendEnabled",void 0),d([b.property({types:M.types,json:{origins:{service:{read:{source:"drawingInfo.renderer",reader:O}}},read:{source:"layerDefinition.drawingInfo.renderer",reader:O},write:{target:"layerDefinition.drawingInfo.renderer"}},value:null})],l.prototype,"renderer",null),d([b.property({json:{read:!1}})],l.prototype,
"cachedDrawingInfo",void 0),d([b.reader("service","cachedDrawingInfo")],l.prototype,"readCachedDrawingInfo",null),d([b.property({type:Boolean})],l.prototype,"popupEnabled",void 0),d([b.reader("popupEnabled",["disablePopup"])],l.prototype,"readPopupEnabled",null),d([b.writer("popupEnabled")],l.prototype,"writePopupEnabled",null),d([b.property({type:v,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],l.prototype,"popupTemplate",void 0),d([b.property({type:String,json:{read:!1}})],l.prototype,
"objectIdField",void 0),d([b.reader("service","objectIdField",["objectIdField","fields"])],l.prototype,"readObjectIdField",null),d([b.property()],l.prototype,"objectIdFilter",void 0),d([b.property({type:String,json:{read:!1}})],l.prototype,"profile",void 0),d([b.reader("service","profile",["store.profile"])],l.prototype,"readProfile",null),d([b.property({readOnly:!0,type:String,json:{read:!1}})],l.prototype,"normalReferenceFrame",void 0),d([b.reader("service","normalReferenceFrame",["store.normalReferenceFrame"])],
l.prototype,"readNormalReferenceFrame",null),d([b.property(u.screenSizePerspectiveEnabled)],l.prototype,"screenSizePerspectiveEnabled",void 0),l=d([b.subclass()],l)}(b.declared(g,r))})},"esri/views/3d/layers/ElevationLayerView3D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Error ../../../core/promiseUtils ../../../core/watchUtils ./TiledLayerView3D ./support/tiledLayerUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return h(c,a),c.prototype.initialize=function(){var a=this,b=this.get("view.map.ground.layers"),c=this.get("view.map.allLayers"),c=c&&c.includes(this.layer),b=b&&b.includes(this.layer);c&&!b&&(b=new g("layerview:elevation-layer-only","3D elevation layer '"+this.layer.id+"' can only be added in the map ground"),this.addResolvingPromise(k.reject(b)));(b=this._getTileInfoSupportError(this.tileInfo,
this.layer.fullExtent))?this.addResolvingPromise(k.reject(b)):(b=f.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){e.throwIfError(a._getTileInfoCompatibilityError(a.tileInfo,a.view.basemapTerrain.tilingScheme))}),this.addResolvingPromise(b));this.addResolvingPromise(e.checkArcGISServiceVersionCompatibility(this.layer));this._updateMinMaxDataLevel()},d([b.property({aliasOf:"layer.fullExtent"})],c.prototype,"fullExtent",void 0),d([b.property()],c.prototype,"layer",void 0),
d([b.property({aliasOf:"layer.tileInfo"})],c.prototype,"tileInfo",void 0),c=d([b.subclass("esri.views.3d.layers.ElevationLayerView3D")],c)}(b.declared(a))})},"esri/views/3d/layers/support/tiledLayerUtils":function(){define("require exports dojo/request/xhr ../../../../core/Error ../../../../core/promiseUtils ../../../../layers/support/arcgisLayerUrl".split(" "),function(m,l,h,d,b,g){function k(b){var a=null,d=b.search(/\/rest\/services\//i);return 0<d&&(a=b.substring(0,d+6)),a}Object.defineProperty(l,
"__esModule",{value:!0});l.checkArcGISServiceVersionCompatibility=function(f){if(!g.isHostedAgolService(f.url)){if(10.22>f.version)return f=new d("layerview:service-version-too-old","Tiled Map Layers on servers prior to 10.2.2 are not supported. Detected version: "+f.version,{minVersion:10.22,detectedVersion:f.version}),b.reject(f);if(10.22!==f.version||g.isHostedSecuredProxyService(f.url,f.get("portalItem.id")))return b.resolve();f=k(f.url);var a=new d("tiledlayerview3d:service-missing-cors-patch",
"Tiled Map Layers from 10.2.2 servers are only supported if all server updates have been applied.");return h(f+"self?f\x3djson",{headers:{"X-Requested-With":null},timeout:1E4,handleAs:"json"}).then(function(b){if(!b||b.error)throw a;}).otherwise(function(){throw a;})}};l.throwIfError=function(b){if(b)throw b;}})},"esri/views/3d/layers/FeatureLayerView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../layers/FeatureLayer ./GraphicLayerView3DBase ../../../layers/graphics/controllers/SnapshotController ../../../core/watchUtils ../../../core/Error ../../../core/promiseUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){return function(k){function l(a){var b=k.call(this)||this;return b.labelingEnabled=a.layer instanceof g,b}return h(l,k),m=l,l.prototype.initialize=function(){this.addResolvingPromise(this.validateMaximumFeatureCount())},l.prototype.createController=function(){var b=this;return this.layer.createGraphicsController({layerView:this,options:{maxPageSize:300,extent:this.view.clippingArea}}).then(function(c){return c instanceof f&&b._eventHandles.push(a.whenFalseOnce(b,"suspended",
function(){c.startup()})),c}).otherwise(function(a){return c.reject(new e("featurelayerview3d:create-controller",a.message,{error:a}))})},l.prototype.validateMaximumFeatureCount=function(){return 0>m.maximumFeatureCount||!this.layer.url?c.resolve():this.layer.queryFeatureCount().then(function(a){if(a>m.maximumFeatureCount)throw new e("featurelayerview3d:maximum-feature-count-exceeded","The maximum number of allowed features (${maximumFeatureCount}) has been exceeded (layer has ${numberOfFeatures} features)",
{maximumFeatureCount:m.maximumFeatureCount,numberOfFeatures:a});})},l.maximumFeatureCount=-1,d([b.property()],l.prototype,"controller",void 0),l=m=d([b.subclass("esri.views.3d.layers.FeatureLayerView3D")],l);var m}(b.declared(k))})},"esri/views/3d/layers/GraphicLayerView3DBase":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators dojo/promise/all ./graphics/Graphics3DLayerViewCore ./graphics/graphicUtils ./support/LayerViewUpdatingPercentage ../../../renderers/support/renderingInfoUtils ../support/PromiseLightweight ../../../core/watchUtils ./LayerView3D ./support/projectExtentUtils ../../../core/Error ../../../core/promiseUtils ../../../layers/graphics/QueryEngine".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x){return function(a){function l(b){b=a.call(this)||this;return b.supportsHeightUnitConversion=!0,b.controller=null,b.supportsDraping=!0,b._overlayUpdating=null,b._progressMaxNumNodes=0,b._eventHandles=[],b._controllerClientSideFiltering=!1,b._suspendResumeExtent=null,b.fullExtentInViewSpatialReference=null,b._isUpdating=!1,b._controllerCreated=!1,b}return h(l,a),Object.defineProperty(l.prototype,"drawingOrder",{set:function(a){this._layerViewCore.graphicsCore.setDrawingOrder(a);
this._set("drawingOrder",a)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"hasDraped",{get:function(){return this._layerViewCore.graphicsCore.hasDraped},enumerable:!0,configurable:!0}),l.prototype.initialize=function(){var a=this;this._layerViewCore=new k({owner:this,layer:this.layer,spatialIndexRequired:!0,frustumVisibilityEnabled:!0,scaleVisibilityEnabled:!0,labelingEnabled:this.labelingEnabled,elevationAlignmentEnabled:!0,elevationFeatureExpressionEnabled:!0,verticalScaleEnabled:this.supportsHeightUnitConversion,
highlightsEnabled:!0,updateSuspendResumeExtent:function(){return a.updateSuspendResumeExtent()},updateClippingExtent:function(b){return a.updateClippingExtent(b)}});this.addResolvingPromise(this._layerViewCore.initialize());this.drawingOrder=this.view.getDrawingOrder(this.layer.uid);this.initializeController();this.addResolvingPromise(this.validateGeometryType());var b=r.toView(this).then(function(b){a.fullExtentInViewSpatialReference=b});b&&this.addResolvingPromise(b);this._evaluateUpdatingState()},
l.prototype.destroy=function(){this._eventHandles.forEach(function(a){return a.remove()});this._eventHandles=null;this.controller&&(this.controller.destroy(),this.controller=null);this._layerViewCore&&(this._layerViewCore.destroy(),this._layerViewCore=null);this.loadedGraphics=null},l.prototype.getRenderingInfo=function(a){if((a=e.getRenderingInfo(a,{renderer:this.layer.renderer}))&&a.color){var b=a.color;b[0]/=255;b[1]/=255;b[2]/=255}return a},l.prototype.getGraphicsFromStageObject=function(a,b){var d=
a.getMetadata().graphicId,e=null;this.loadedGraphics&&this.loadedGraphics.some(function(a){return a.uid===d?(e=a,!0):!1});a=new c.Promise;return null!==e?a.done(e):a.reject(),a},l.prototype.getGraphics3DGraphics=function(){return this._layerViewCore.graphicsCore.getGraphics3DGraphics()},l.prototype.getGraphics3DGraphicsKeys=function(){return this._layerViewCore.graphicsCore.getGraphics3DGraphicsKeys()},l.prototype.getSymbolUpdateType=function(){return this._layerViewCore.graphicsCore.getSymbolUpdateType()},
l.prototype.queryGraphics=function(){return this._queryEngine?this._queryEngine.queryFeatures():this._rejectQuery()},l.prototype.queryFeatures=function(a){return this._queryEngine?this._queryEngine.queryFeatures(a):this._rejectQuery()},l.prototype.queryObjectIds=function(a){return this._queryEngine?this._queryEngine.queryObjectIds(a):this._rejectQuery()},l.prototype.queryFeatureCount=function(a){return this._queryEngine?this._queryEngine.queryFeatureCount(a):this._rejectQuery()},l.prototype.queryExtent=
function(a){return this._queryEngine?this._queryEngine.queryExtent(a):this._rejectQuery()},l.prototype.whenGraphicBounds=function(a){return this._layerViewCore.graphicsCore.whenGraphicBounds(a)},l.prototype.highlight=function(a,b){return this._layerViewCore.highlight(a,b,this.layer.objectIdField)},l.prototype._rejectQuery=function(){return v.reject(new u("FeatureLayerView3D","Not ready to execute query"))},l.prototype._notifySuspendedChange=function(){this.notifyChange("suspended")},l.prototype._notifyDrapedDataChange=
function(){this.notifyChange("hasDraped");this.emit("draped-data-change")},l.prototype.canResume=function(){return this.inherited(arguments)&&this._layerViewCore&&this._layerViewCore.canResume()},l.prototype._evaluateUpdatingState=function(){if(this._layerViewCore.elevationAlignment){var a;a=0+this._layerViewCore.elevationAlignment.numNodesUpdating();a+=this._layerViewCore.graphicsCore.numNodesUpdating();var b;b=(b=(b=(b=(b=!this._controllerCreated)||this.controller&&this.controller.updating)||this._overlayUpdating)||
this._layerViewCore.graphicsCore.needsIdleUpdate())||!(this.view.basemapTerrain&&this.view.basemapTerrain.ready);var c;c=(c=(c=0<a||b)||this._layerViewCore.spatialIndex.isUpdating())||this._layerViewCore.elevationAlignment.isUpdating();this._progressMaxNumNodes=Math.max(a,this._progressMaxNumNodes);0===a&&(this._progressMaxNumNodes=1);this._isUpdating=c;this.notifyChange("updating");this._set("updatingPercentageValue",b?100:100*a/this._progressMaxNumNodes)}else this._isUpdating=!1,this.notifyChange("updating"),
this._set("updatingPercentageValue",100)},l.prototype.isUpdating=function(){return this._isUpdating},l.prototype.initializeController=function(){var a=this,b=null,c=this.createController().then(function(a){b=a}),d=q.whenTrueOnce(this.view,"basemapTerrain.ready");g([this.when(),d]).then(function(){a.controller=b;a._eventHandles.push(a.controller.watch("updating",function(){return a._evaluateUpdatingState()}));a.loadedGraphics=b.graphics;a._queryEngine=new x({features:a.loadedGraphics,objectIdField:a.layer.objectIdField});
a._evaluateUpdatingState()}).always(function(){a._controllerCreated=!0;a._evaluateUpdatingState()});this.addResolvingPromise(c)},l.prototype.updateClippingExtent=function(a){return this.controller?this._controllerClientSideFiltering?!1:this.controller.extent?(this.controller.extent=null,this._controllerClientSideFiltering=!0,!0):(this.controller.extent=a,!0):!1},l.prototype.updateSuspendResumeExtent=function(){return this._suspendResumeExtent=f.enlargeExtent(this._layerViewCore.graphicsCore.computedExtent,
this._suspendResumeExtent,1.2),this._suspendResumeExtent},l.prototype.validateGeometryType=function(){var a=this.layer;switch(a.geometryType){case "multipatch":case "multipoint":return v.reject(new u("featurelayerview3d:unsupported-geometry-type","Unsupported geometry type ${geometryType}",{geometryType:a.geometryType}))}},l.prototype.getStats=function(){var a=this._layerViewCore.graphicsCore.getGraphics3DGraphics(),b="null",c=this._suspendResumeExtent;c&&(b=[c[0],c[1],c[2],c[3]].map(function(a){return a.toPrecision(4)}).join(", "));
var c="null",d=this._layerViewCore.graphicsCore.computedExtent;return d&&(c=[d.xmin,d.ymin,d.xmax,d.ymax].map(function(a){return a.toPrecision(4)}).join(", ")),{numCollection:this.loadedGraphics.length,numGraphics:Object.keys(a).length,numElevationUpdating:this._layerViewCore.elevationAlignment.numNodesUpdating(),numSpatialIndexUpdating:this._layerViewCore.spatialIndex.numNodesUpdating(),numGraphicsUpdating:this._layerViewCore.graphicsCore.numNodesUpdating(),visibilityFrustum:this._layerViewCore.frustumVisibility.canResume(),
visibilityScale:this._layerViewCore.scaleVisibility.canResume(),resumeExtent:b,computedExtent:c,updating:this.updating,suspended:this.suspended}},l.maximumFeatureCount=-1,d([b.property()],l.prototype,"drawingOrder",null),d([b.property()],l.prototype,"loadedGraphics",void 0),d([b.property()],l.prototype,"symbolsUpdating",void 0),d([b.property()],l.prototype,"hasDraped",null),d([b.property()],l.prototype,"controller",void 0),l=d([b.subclass("esri.views.3d.layers.GraphicsLayerView3DBase")],l)}(b.declared(t,
a))})},"esri/views/3d/layers/graphics/Graphics3DLayerViewCore":function(){define("require exports ../../../../core/HandleRegistry ../../../../core/watchUtils ../../../../core/promiseUtils ../../../../core/Collection ../../../../tasks/support/Query ../../../../Graphic ./Graphics3DCore ./Graphics3DLabeling ./Graphics3DScaleVisibility ./Graphics3DFrustumVisibility ./Graphics3DElevationAlignment ./Graphics3DSpatialIndex ./Graphics3DVerticalScale ./Graphics3DHighlights ../support/attributeUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x){return function(){function l(b){var f=this;if(this._handles=new h,this.layer=b.layer,this.owner=b.owner,this.updateClippingExtent=b.updateClippingExtent,this.updateSuspendResumeExtent=b.updateSuspendResumeExtent,this.getGraphicsInExtent=b.getGraphicsInExtent,this.graphicsCore=new a(b.elevationFeatureExpressionEnabled),b.spatialIndexRequired&&(this.spatialIndex=new r),b.frustumVisibilityEnabled){this.frustumVisibility=new q;var g=this.owner.view.basemapTerrain;
this._handles.add([this.owner.view.on("resize",function(){return f.frustumVisibility.viewChange()}),this.owner.view.state.watch("camera",function(){return f.frustumVisibility.viewChange()},!0),g.on("elevation-bounds-change",function(){return f.frustumVisibility.elevationBoundsChange()})]);"local"===this.owner.view.viewingMode?this.frustumVisibility.isVisibleBelowSurface=!0:this._handles.add(d.init(g,["opacity","wireframe"],function(){return f.frustumVisibility.isVisibleBelowSurface=g.isSeeThrough()}))}b.scaleVisibilityEnabled&&
(b.spatialIndexRequired?(this.scaleVisibility=new c,this._handles.add(this.layer.watch("minScale,maxScale",function(){return f.scaleVisibility.layerMinMaxScaleChangeHandler()}))):console.warn("scaleVisibility requires a spatialIndex"));b.elevationAlignmentEnabled&&(this.elevationAlignment=new t,this._handles.add(this.layer.watch("elevationInfo",function(){return f.graphicsCore.elevationInfoChange()})));b.labelingEnabled&&(this.labeling=new e,this._handles.add(this.layer.watch("labelsVisible",function(){return f.labeling.labelVisibilityChanged()})),
this._handles.add(this.layer.watch("labelingInfo",function(){return f.labeling.updateLabelingInfo()})));b.verticalScaleEnabled&&(this.verticalScale=new u({sourceSpatialReference:this.layer.spatialReference,destSpatialReference:this.owner.view.spatialReference}));b.highlightsEnabled&&(this.highlights=new v)}return l.prototype.initialize=function(){var a=this;return this.whenSpatialIndexLoaded().then(function(){return a.deferredInitialize()})},l.prototype.whenSpatialIndexLoaded=function(){return this.spatialIndex?
this.spatialIndex.whenLoaded():b.resolve()},l.prototype.deferredInitialize=function(){var a=this;this.spatialIndex&&this.spatialIndex.initialize(this.owner,this.layer,this.owner.view.spatialReference,this.graphicsCore);this.frustumVisibility&&this.frustumVisibility.initialize(this.owner);var b=this.owner.view.basemapTerrain,c=this.owner.view.elevationProvider;(this.scaleVisibility&&this.scaleVisibility.initialize(this.owner,this.layer,this.spatialIndex,this.graphicsCore,b),this.elevationAlignment&&
this.elevationAlignment.initialize(this.owner,function(b,c,d){return a._getGraphicsInExtent(b,c,d)},this.graphicsCore,c),this.labeling)&&this.labeling.initialize(this.owner,this.layer,this.spatialIndex,this.graphicsCore,this.scaleVisibility);return this.highlights&&this.highlights.initialize(this.graphicsCore),this.graphicsCore.initialize(this.owner,this.layer,this.elevationAlignment,this.scaleVisibility,this.spatialIndex,this.labeling,this.highlights,function(){a.updateSuspendResumeExtent&&a._updateSuspendResumeExtent(a.updateSuspendResumeExtent())},
function(b){return a.verticalScale?a.verticalScale.adjust(b):b},b),this._handles.add([this.layer.watch("renderer",function(b){return a.graphicsCore.rendererChange(b)}),this.owner.watch("fullOpacity",function(){return a.graphicsCore.opacityChange()})]),this._handles.add(this.layer.on("graphic-update",function(b){return a.graphicsCore.graphicUpdateHandler(b)})),this.owner.view.resourceController.registerIdleFrameWorker(this,{needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate}),this.updateClippingExtent&&
(this._handles.add(this.owner.view.watch("clippingArea",function(){return a._updateClippingExtent()})),this._updateClippingExtent()),this.labeling?this.labeling.updateLabelingInfo():void 0},l.prototype.destroy=function(){this.owner&&this.owner.view.resourceController.deregisterIdleFrameWorker(this);this._handles&&(this._handles.destroy(),this._handles=null);this.frustumVisibility&&(this.frustumVisibility.destroy(),this.frustumVisibility=null);this.scaleVisibility&&(this.scaleVisibility.destroy(),
this.scaleVisibility=null);this.elevationAlignment&&(this.elevationAlignment.destroy(),this.elevationAlignment=null);this.labeling&&(this.labeling.destroy(),this.labeling=null);this.graphicsCore&&(this.graphicsCore.destroy(),this.graphicsCore=null);this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.highlights&&(this.highlights.destroy(),this.highlights=null);this.owner=this.layer=null},l.prototype.highlight=function(a,b,c){var d=this;if(a instanceof k){b=this.highlights.acquireSet(b,
c);var e=b.set,h=b.handle;return this.owner.queryObjectIds(a).then(function(a){return d.highlights.setObjectIds(e,a)}),h}if("number"==typeof a||a instanceof f)return this.highlight([a],b,c);if(a instanceof g&&(a=a.toArray()),Array.isArray(a)&&0<a.length){if(a[0]instanceof f){h=a;if(!c||!h[0].attributes||null===x.attributeLookup(h[0].attributes,c))return a=h.map(function(a){return a.uid}),h=this.highlights.acquireSet(b,null),b=h.set,h=h.handle,this.highlights.setUids(b,a),h;a=h.map(function(a){return x.attributeLookup(a.attributes,
c)})}if("number"==typeof a[0])return h=this.highlights.acquireSet(b,c),b=h.set,h=h.handle,this.highlights.setObjectIds(b,a),h}return{remove:function(){}}},l.prototype.canResume=function(){return(!this.frustumVisibility||this.frustumVisibility.canResume())&&(!this.scaleVisibility||this.scaleVisibility.canResume())},l.prototype._needsIdleUpdate=function(){return this.frustumVisibility&&this.frustumVisibility.needsIdleUpdate()?!0:this.scaleVisibility&&this.scaleVisibility.needsIdleUpdate()?!0:this.elevationAlignment&&
this.elevationAlignment.needsIdleUpdate()?!0:this.graphicsCore&&this.graphicsCore.needsIdleUpdate()?!0:!1},l.prototype._idleUpdate=function(a){this.frustumVisibility&&this.frustumVisibility.idleUpdate(a);this.scaleVisibility&&this.scaleVisibility.idleUpdate(a);this.elevationAlignment&&this.elevationAlignment.idleUpdate(a);this.graphicsCore&&this.graphicsCore.idleUpdate(a)},l.prototype._updateSuspendResumeExtent=function(a){this.frustumVisibility&&this.frustumVisibility.setExtent(a);this.scaleVisibility&&
this.scaleVisibility.setExtent(a)},l.prototype._updateClippingExtent=function(){var a=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(a,this.owner.view.spatialReference)&&(this.updateClippingExtent(a)||this.graphicsCore.recreateAllGraphics())},l.prototype._getGraphicsInExtent=function(a,b,c){this.getGraphicsInExtent?this.getGraphicsInExtent(a,b,c):this.spatialIndex?this.spatialIndex.intersects(a,b,c):c([],0)},l}()})},"esri/views/3d/layers/graphics/Graphics3DLabeling":function(){define("require exports dojo/promise/all ../../../../core/HandleRegistry ../../../../core/watchUtils ../../../../layers/support/LabelClass ../../../../symbols/callouts/calloutUtils ../../webgl-engine/lib/TextTextureAtlas ../../webgl-engine/lib/MaterialCollection ./Graphics3DWebStyleSymbol ./Graphics3DCalloutSymbolLayerFactory ./labelPlacement ../../support/debugFlags".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){return function(){function l(){this.calloutMaterialCollection=this.hudMaterialCollection=this.textTextureAtlas=null;this.labelVisibilityDirty=!1;this.labelClasses=[];this.eventHandles=new d;this.graphicsCore=this.spatialIndex=this.layer=this.layerView=null}return l.prototype.initialize=function(a,c,d,e,f){var g=this;this.layerView=a;this.layer=c;this.spatialIndex=d;this.graphicsCore=e;this.scaleVisibility=f;this.eventHandles.add(b.whenNot(this.layerView,"suspended",
function(){return g.resume()}))},l.prototype.destroy=function(){this.textTextureAtlas&&(this.textTextureAtlas.dispose(),this.textTextureAtlas=null);this.hudMaterialCollection&&(this.hudMaterialCollection.dispose(),this.hudMaterialCollection=null);this.calloutMaterialCollection&&(this.calloutMaterialCollection.dispose(),this.calloutMaterialCollection=null);this.labelClasses=null;this.eventHandles.destroy();this.graphicsCore=this.layer=this.layerView=this.eventHandles=null},l.prototype.clear=function(){this.layerView.view.deconflictor.setDirty();
this.textTextureAtlas&&(this.textTextureAtlas.dispose(),this.textTextureAtlas=null);this.hudMaterialCollection&&(this.hudMaterialCollection.dispose(),this.hudMaterialCollection=null);this.calloutMaterialCollection&&(this.calloutMaterialCollection.dispose(),this.calloutMaterialCollection=null)},l.prototype.updateLabelingInfo=function(){var a=this;return this.removeLabels(),this.layer.when(function(){a.scaleVisibility&&a.scaleVisibility.updateScaleRangeActive();var b=a.layer.labelingInfo&&a.layer.labelingInfo.filter(function(a){return!!a.symbol});
if(b&&0<b.length){var d=Array(b.length),b=b.map(function(b,f){var g=b.symbol,h;h=a.graphicsCore.getOrCreateGraphics3DSymbol(g);h=h instanceof e?h.graphics3DSymbol:h;var l=null;return k.isCalloutSupport(g)&&g.hasVisibleCallout()&&(l=c.make(g,a.graphicsCore.symbolCreationContext)),d[f]={labelClass:b,graphics3DSymbol:h,graphics3DCalloutSymbolLayer:l,options:b.getOptions()},h});return h(b).then(function(){return d})}return null}).then(function(b){a.labelClasses=b;a.labelVisibilityChanged()})},l.prototype.createLabelsForGraphic=
function(b,c){var d=!1;if(this.labelClasses&&0!==this.labelClasses.length&&c._graphics[0]){for(var e=this.layerLabelsEnabled(),h=0;h<this.labelClasses.length;h++){var k=this.labelClasses[h],l=k.labelClass;if(g.evaluateWhere(l.where,b.attributes)&&(l=l.getLabelExpression(),l.expression)){var m=g.buildLabelText(l.expression,b,this.layer.fields,k.options);if(m){l=null;k.graphics3DSymbol&&k.graphics3DSymbol.symbol&&"label-3d"===k.graphics3DSymbol.symbol.type&&(l=k.graphics3DSymbol.symbol);var r=k.graphics3DSymbol.childGraphics3DSymbols[0],
u=q.get({graphic:b,graphics3DGraphic:c,labelSymbol:l,labelClass:k.labelClass});if(r&&u.isValid){null==this.textTextureAtlas&&(this.textTextureAtlas=new f(this.layer.id,this.layerView.view._stage));null==this.hudMaterialCollection&&(this.hudMaterialCollection=new a(this.layerView.view._stage));h={text:m,centerOffset:u.centerOffset,translation:u.translation,elevationOffset:u.elevationOffset,screenOffset:u.screenOffset,anchor:u.anchor,needsOffsetAdjustment:u.needsOffsetAdjustment,centerOffsetUnits:u.centerOffsetUnits,
verticalOffset:u.verticalOffset,debugDrawBorder:t.LABELS_SHOW_BORDER};(r=r.createGraphics3DGraphic(b,h,this.hudMaterialCollection,this.textTextureAtlas))&&(r._labelClass=k.labelClass,c.addLabelGraphic(r,this.graphicsCore.labelStageLayer,this.graphicsCore.stage),this.spatialIndex&&!c.addedToSpatialIndex&&this.spatialIndex.shouldAddToSpatialIndex(b,c,this.scaleVisibility.scaleRangeActive())&&this.spatialIndex.addGraphicToSpatialIndex(b,c),c.setVisibilityFlag(0,e,1),c.setVisibilityFlag(1,void 0,1),this.layerView.view.deconflictor.initializeLabelVisibility(c),
d=!0,k.graphics3DCalloutSymbolLayer&&u.hasLabelVerticalOffset)&&(null==this.calloutMaterialCollection&&(this.calloutMaterialCollection=new a(this.layerView.view._stage)),(e=k.graphics3DCalloutSymbolLayer.createGraphics3DGraphic(b,{symbol:l,needsOffsetAdjustment:u.needsOffsetAdjustment,translation:h.translation,elevationOffset:h.elevationOffset,screenOffset:h.screenOffset,centerOffset:h.centerOffset,centerOffsetUnits:h.centerOffsetUnits,materialCollection:this.calloutMaterialCollection}))&&c.addLabelGraphic(e,
this.graphicsCore.labelStageLayer,this.graphicsCore.stage));break}}}}d&&this.scaleVisibility&&this.scaleVisibility.updateGraphicLabelScaleVisibility(b,c)}},l.prototype.layerLabelsEnabled=function(){return this.layer.labelsVisible},l.prototype.getGraphics3DGraphics=function(){return this.graphicsCore.getGraphics3DGraphics()},l.prototype.getGraphics3DGraphicsKeys=function(){return this.graphicsCore.getGraphics3DGraphicsKeys()},l.prototype.labelVisibilityChanged=function(){var a=this;if(this.layerView.suspended)return void(this.labelVisibilityDirty=
!0);if(this.layerView.loadedGraphics){var b=this.layerLabelsEnabled();this.layerView.loadedGraphics.forEach(function(c){var d=a.graphicsCore.getGraphics3DGraphicById(c.uid);d&&(b&&0===d._labelGraphics.length&&a.createLabelsForGraphic(c,d),d.setVisibilityFlag(0,b,1))});this.layerView.view.deconflictor.setDirty();this.labelVisibilityDirty=!1}},l.prototype.elevationInfoChange=function(){this.labelClasses&&this.labelClasses.forEach(function(a){a.graphics3DSymbol.layerPropertyChanged("elevationInfo",{})})},
l.prototype.resume=function(){this.labelVisibilityDirty&&this.labelVisibilityChanged()},l.prototype.removeLabels=function(){var a=this;this.layerView.loadedGraphics&&(this.layerView.loadedGraphics.forEach(function(b){(b=a.graphicsCore.getGraphics3DGraphicById(b.uid))&&(b._labelGraphics&&b._labelGraphics.forEach(function(a){return a._labelClass=null}),b.clearLabelGraphics())}),this.labelClasses=null,this.layerView.view.deconflictor.setDirty())},l}()})},"esri/views/3d/webgl-engine/lib/TextTextureAtlas":function(){define("require exports ./Texture ./TextTexture ./ModelContentType ../../../webgl/Texture ../../../webgl/enums".split(" "),
function(m,l,h,d,b,g,k){var f=d.preferredAtlasSize(),a=function(){function a(a){this.textTextures={};this.dirty=!1;this._glTexture=null;this.id=h.idGen.gen(a)}return a.prototype.getId=function(){return this.id},a.prototype.dispose=function(){},a.prototype.deferredLoading=function(){return!1},a.prototype.getWidth=function(){return f},a.prototype.getHeight=function(){return f},a.prototype.initializeThroughRender=function(a,b){b.wrapMode=33071;b.samplingMode=9987;b.flipped=!0;b.preMultiplyAlpha=!0;b.hasMipmap=
!0;var c=this._drawToCanvas();return this._glTexture=new g(a,b,c),this.dirty=!1,this._glTexture},a.prototype.redraw=function(){if(this.dirty&&this._glTexture){var a=this._drawToCanvas();this._glTexture.setData(a);this.dirty=!1}},a.prototype.setUnloadFunc=function(a){this._unloadFunc=a},a.prototype.unload=function(){null!=this._unloadFunc&&(this._unloadFunc(this.id),this._unloadFunc=null)},a.prototype._drawToCanvas=function(){var b=a._create2Dcanvas(),d=b.getContext("2d");d.clearRect(0,0,f,f);for(var e in this.textTextures){var g=
this.textTextures[e];g.textTexture.renderText(g.placement.width,g.placement.height,d,g.placement.atlasOffX,g.placement.atlasOffY)}return b},a._create2Dcanvas=function(){return a._textCanvas2D||(a._textCanvas2D=document.createElement("canvas"),a._textCanvas2D.setAttribute("id","canvas2d"),a._textCanvas2D.setAttribute("width",f.toString()),a._textCanvas2D.setAttribute("height",f.toString()),a._textCanvas2D.setAttribute("style","display:none")),a._textCanvas2D},a}();return function(){function d(a,b){this._textureAtlasSubtextures=
[];this._curLineHeight=this._curY=this._curX=0;this._idHint=a;this._stage=b}return d.prototype.dispose=function(){for(var a=0;a<this._textureAtlasSubtextures.length;a++)this._stage.remove(b.TEXTURE,this._textureAtlasSubtextures[a].getId());this._textureAtlasSubtextures=[]},d.prototype.canHoldTextTexture=function(a){return a.getRenderedWidth()<=f&&a.getRenderedHeight()<=f},d.prototype.addTextTexture=function(c){for(var d=JSON.stringify(c.getParams())+"_"+c.getText(),e=0;e<this._textureAtlasSubtextures.length;e++){var g=
this._textureAtlasSubtextures[e].textTextures[d];if(null!=g)return g.placement}var h=null;0===this._textureAtlasSubtextures.length&&(h=new a(this._idHint),this._textureAtlasSubtextures.push(h));var k,l,e=c.getRenderedWidth(),g=c.getRenderedHeight(),m=e+2,n=g+2+2;this._curLineHeight=Math.max(this._curLineHeight,n);this._curX+m<f&&this._curY+this._curLineHeight<f?(k=this._curX,l=this._curY,this._curX+=m):this._curY+this._curLineHeight+n<f?(this._curX=0,this._curY+=this._curLineHeight,k=this._curX,l=
this._curY,this._curX+=m):(h=new a(this._idHint),this._textureAtlasSubtextures.push(h),this._curX=0,this._curY=0,this._curLineHeight=n,k=this._curX,l=this._curY,this._curX+=m);null!=h&&this._stage.add(b.TEXTURE,h);h=this._textureAtlasSubtextures[this._textureAtlasSubtextures.length-1];k={uvMinMax:[k/f,1-(l+g)/f,(k+e)/f,1-l/f],atlasOffX:k,atlasOffY:l,width:e,height:g,texture:h};return h.textTextures[d]={placement:k,textTexture:c},h.dirty=!0,k},d}()})},"esri/views/3d/webgl-engine/lib/MaterialCollection":function(){define(["require",
"exports","./ModelContentType"],function(m,l,h){return function(){function d(b){this.materials={};this.stage=b}return d.prototype.getMaterial=function(b){return this.materials[b]},d.prototype.addMaterial=function(b,d){this.materials[b]=d;this.stage.add(h.MATERIAL,d)},d.prototype.dispose=function(){for(var b in this.materials)this.stage.remove(h.MATERIAL,this.materials[b].getId());this.materials={}},d}()})},"esri/views/3d/layers/graphics/labelPlacement":function(){define("require exports ../../../../core/Logger ../../../../core/Scheduler ../../lib/glMatrix ../../webgl-engine/materials/HUDMaterial ./Graphics3DWebStyleSymbol".split(" "),
function(m,l,h,d,b,g,k){function f(c,d){switch(d.graphic.geometry.type){case "polyline":case "polygon":case "extent":c.anchor="center";break;case "point":var e=d.graphics3DGraphic,f=a(e.graphics3DSymbol).symbol.symbolLayers.getItemAt(0),e=e.getCenterObjectSpace();switch(b.vec3d.set(e,c.translation),f.type){case "icon":case "text":e=d.graphics3DGraphic;f=e._graphics[0].getScreenSize();e.isDraped()?c.hasLabelVerticalOffset||(c.anchor="center"):(e=void 0,void 0===e&&(e=y),d=d.graphics3DGraphic._graphics[0].stageObject.getGeometryRecords()[0].materials[0],
d instanceof g?(d=d.getParams().anchorPos,e[0]=2*(d[0]-.5),e[1]=2*(d[1]-.5)):(e[0]=0,e[1]=0),d=e,x[0]=f[0]/2*(c.normalizedOffset[0]-d[0]),x[1]=f[1]/2*(c.normalizedOffset[1]-d[1]),c.screenOffset[0]=x[0],c.hasLabelVerticalOffset?(c.centerOffset[1]=x[1],c.centerOffsetUnits="screen"):c.screenOffset[1]=x[1]);break;case "object":d=d.graphics3DGraphic._graphics[0].getBoundingBoxObjectSpace(),d=[d[3]-d[0],d[4]-d[1],d[5]-d[2]],c.centerOffset[0]=1.1*Math.max(d[0],d[1])/2*c.normalizedOffset[0],f=d[2]/2*c.normalizedOffset[1]+
c.translation[2],c.translation[2]=f*(1.1-1),c.elevationOffset=f,d=b.vec3d.length(d),c.centerOffset[2]=1.1*d/2*c.normalizedOffset[2]}}}function a(a){return a instanceof k?a.graphics3DSymbol:a}function e(b,d){var e=d.labelSymbol;d=d.graphics3DGraphic;var f=a(d.graphics3DSymbol).symbol;if("point-3d"===f.type&&f.supportsCallout()&&f.hasVisibleVerticalOffset()&&!d.isDraped())b.verticalOffset=c(f.verticalOffset);else if(e&&e.hasVisibleVerticalOffset()&&("point-3d"!==f.type||!f.supportsCallout()||!f.verticalOffset||
d.isDraped())){a:switch(b.placement){case "above-center":d=!0;break a;default:d=!1}d?(b.verticalOffset=c(e.verticalOffset),b.anchor="bottom",b.normalizedOffset=[0,b.normalizedOffset[1],0],b.hasLabelVerticalOffset=!0):(q.error("verticalOffset","Callouts and vertical offset on labels are currently only supported with above-center label placement (not with "+b.placement+" placement)"),b.isValid=!1)}}function c(a){return{screenLength:a.screenLength,minWorldLength:a.minWorldLength,maxWorldLength:a.maxWorldLength}}
Object.defineProperty(l,"__esModule",{value:!0});var q=h.getLogger("esri.views.3d.layers.graphics.labelPlacement"),t=null;l.get=function(a){var b=a.labelClass.labelPlacement,c=r[b];c||(null!=b&&null==t&&(q.warn("labelPlacement","'"+b+"' is not a valid label placement"),t=d.schedule(function(){t.remove();t=null})),c=r["default"]);var b=a.graphics3DGraphic._graphics[0],g=b.graphics3DSymbolLayer.getGraphicElevationContext(a.graphics3DGraphic.graphic),c={placement:c.placement,anchor:c.anchor,normalizedOffset:c.normalizedOffset,
needsOffsetAdjustment:b.isDraped()?void 0:g.hasOffsetAdjustment,verticalOffset:null,screenOffset:[0,0],centerOffset:[0,0,0,-1],centerOffsetUnits:"world",translation:[0,0,0],elevationOffset:0,hasLabelVerticalOffset:!1,isValid:!0};return e(c,a),f(c,a),c};var r={"above-center":{placement:"above-center",normalizedOffset:[0,1,0],anchor:"bottom"},"above-left":{placement:"above-left",normalizedOffset:[-1,1,0],anchor:"bottom-right"},"above-right":{placement:"above-right",normalizedOffset:[1,1,0],anchor:"bottom-left"},
"below-center":{placement:"below-center",normalizedOffset:[0,-1,2],anchor:"top"},"below-left":{placement:"below-left",normalizedOffset:[-1,-1,0],anchor:"top-right"},"below-right":{placement:"below-right",normalizedOffset:[1,-1,0],anchor:"top-left"},"center-center":{placement:"center-center",normalizedOffset:[0,0,1],anchor:"center"},"center-left":{placement:"center-left",normalizedOffset:[-1,0,0],anchor:"right"},"center-right":{placement:"center-right",normalizedOffset:[1,0,0],anchor:"left"}},u={"above-center":["default",
"esriServerPointLabelPlacementAboveCenter"],"above-left":["esriServerPointLabelPlacementAboveLeft"],"above-right":["esriServerPointLabelPlacementAboveRight"],"below-center":["esriServerPointLabelPlacementBelowCenter"],"below-left":["esriServerPointLabelPlacementBelowLeft"],"below-right":["esriServerPointLabelPlacementBelowRight"],"center-center":["esriServerPointLabelPlacementCenterCenter"],"center-left":["esriServerPointLabelPlacementCenterLeft"],"center-right":["esriServerPointLabelPlacementCenterRight"]};
m=function(a){var b=r[a];u[a].forEach(function(a){r[a]=b})};for(var v in u)m(v);Object.freeze&&(Object.freeze(r),Object.keys(r).forEach(function(a){Object.freeze(r[a]);Object.freeze(r[a].normalizedOffset)}));var x=[0,0],y=[0,0]})},"esri/views/3d/layers/graphics/Graphics3DScaleVisibility":function(){define(["require","exports"],function(m,l){function h(d,b){return null!==d&&0<d&&8E7>d||50<b}return function(){function d(){this._scaleRangeActive=!1;this.layerScaleRangeVisibilityDirty=this.layerScaleRangeVisibility=
!0;this.layerScaleRangeVisibilityQuery=!1;this.basemapTerrain=this.graphicsCore=this.extent=this.spatialIndex=this.layer=this.layerView=this.scaleChangeEventHandle=null}return d.prototype.initialize=function(b,d,h,f,a){this.layerView=b;this.layer=d;this.spatialIndex=h;this.graphicsCore=f;this.basemapTerrain=a;this.updateScaleRangeActive()},d.prototype.destroy=function(){this.scaleChangeEventHandle&&(this.scaleChangeEventHandle.remove(),this.scaleChangeEventHandle=null);this.graphicsCore=this.spatialIndex=
this.extent=this.layerView=null},d.prototype.needsIdleUpdate=function(){return this.layerView.view.basemapTerrain&&this.layerScaleRangeVisibilityDirty},d.prototype.canResume=function(){return this.layerScaleRangeVisibility},d.prototype.setExtent=function(b){this.extent=b;this.layerScaleRangeVisibilityDirty=!0},d.prototype.idleUpdate=function(b){this.layerView.view.basemapTerrain&&(b.done()||this.layerScaleRangeVisibilityDirty&&(this.updateSuspendScaleVisible(),this.layerScaleRangeVisibilityDirty=
!1))},d.prototype.scaleRangeActive=function(){return this._scaleRangeActive},d.prototype.updateScaleRangeActive=function(){var b=this;if(!this.spatialIndex)return this._scaleRangeActive=!1,!1;var d=this.layer,k=!1;d.labelingInfo&&(k=k||d.labelingInfo.some(function(b){return b&&h(b.minScale,b.maxScale)}));k=k||h(d.minScale,d.maxScale);d=this._scaleRangeActive!==k;return this._scaleRangeActive=k,k&&!this.scaleChangeEventHandle&&this.basemapTerrain?this.scaleChangeEventHandle=this.basemapTerrain.on("scale-change",
function(d){return b.scaleUpdateHandler(d)}):!k&&this.scaleChangeEventHandle&&(this.scaleChangeEventHandle.remove(),this.scaleChangeEventHandle=null),d},d.prototype.updateSuspendScaleVisibleFinish=function(b){this.layerScaleRangeVisibilityQuery=!1;this.layerScaleRangeVisibility!==b&&(this.layerScaleRangeVisibility=b,this.layerView._notifySuspendedChange())},d.prototype.updateSuspendScaleVisible=function(){var b=this,d=this.layerView.view.basemapTerrain;this.extent&&d&&this._scaleRangeActive?this.layerScaleRangeVisibilityQuery||
(this.layerScaleRangeVisibilityQuery=!0,d.queryVisibleScaleRange(this.extent,this.layer.minScale,this.layer.maxScale,function(d){return b.updateSuspendScaleVisibleFinish(d)})):this.updateSuspendScaleVisibleFinish(!0)},d.prototype.visibleAtScale=function(b,d,h){return null==b?!0:b>h&&(!d||d>b)},d.prototype.visibleAtLayerScale=function(b){return this.visibleAtScale(b,this.layer.minScale,this.layer.maxScale)},d.prototype.visibleAtLabelScale=function(b,d){return this.visibleAtScale(b,d.minScale,d.maxScale)},
d.prototype.graphicScale=function(b,d){var g;return(d.centroid?g=d.centroid:"point"===b.geometry.type&&(g=b.geometry),g)?this.layerView.view.basemapTerrain?this.layerView.view.basemapTerrain.getScale(g):1:null},d.prototype.graphicVisible=function(b,d){b=this.graphicScale(b,d);return this.visibleAtLayerScale(b)},d.prototype.updateGraphicScaleVisibility=function(b,d){return this._scaleRangeActive?(d.addedToSpatialIndex||this.spatialIndex.addGraphicToSpatialIndex(b,d),b=this.graphicVisible(b,d),d.setVisibilityFlag(1,
b)):!1},d.prototype.updateGraphicLabelScaleVisibility=function(b,d){if(!this._scaleRangeActive||!d._labelGraphics||0===d._labelGraphics.length)return!1;d.addedToSpatialIndex||this.spatialIndex.addGraphicToSpatialIndex(b,d);b=this.graphicScale(b,d);d=this.updateLabelScaleVisibility(d,b);return d&&this.layerView.view.deconflictor.setDirty(),d},d.prototype.updateLabelScaleVisibility=function(b,d){if(!b._labelGraphics||0===b._labelGraphics.length)return!1;1<b._labelGraphics.length&&console.warn("Multiple label classes are not supported");
var g=b._labelGraphics[0]._labelClass;return g&&null!=g.minScale&&null!=g.maxScale&&(d=this.visibleAtLabelScale(d,g),b.setVisibilityFlag(1,d,1))?!0:!1},d.prototype.scaleUpdateHandler=function(b){var d=this;if(!this.layerView.suspended&&this.spatialIndex.hasGraphics()){var h=b.extent,f=b.scale;this.spatialIndex.intersects(h,b.spatialReference,function(a,b){for(var c=d.visibleAtLayerScale(f),e=!1,g=!1,k=0;b>k;k++){var l=d.graphicsCore.getGraphics3DGraphicById(a[k]);if(l){var m=l.centroid;m&&(h[0]>m.x||
h[1]>m.y||h[2]<m.x||h[3]<m.y)||(m=!1,l.setVisibilityFlag(1,c)&&(m=!0),d.updateLabelScaleVisibility(l,f)&&(m=!0),m&&(g=!0,l.isDraped()&&(e=!0)))}}g&&d.layerView.view.deconflictor.setDirty();e&&d.layerView._notifyDrapedDataChange()})}this.layerScaleRangeVisibilityDirty=!0},d.prototype.layerMinMaxScaleChangeHandler=function(){this.updateScaleRangeActive()&&(this._scaleRangeActive?this.graphicsCore.updateAllGraphicsVisibility():this.graphicsCore.forEachGraphics3DGraphic(function(b){return b.setVisibilityFlag(1,
void 0)}));this.layerScaleRangeVisibilityDirty=!0},d}()})},"esri/views/3d/layers/graphics/Graphics3DFrustumVisibility":function(){define("require exports ../../support/earthUtils ../../support/projectionUtils ../../support/intersectionUtils ../../support/mathUtils ../../support/aaBoundingBox ../../support/aaBoundingRect ../../lib/glMatrix".split(" "),function(m,l,h,d,b,g,k,f,a){var e=-.3*h.earthRadius;m=.5*Math.PI;var c=m/Math.PI*180,q=m*h.earthRadius,t=.9*h.earthRadius,r=function(){function e(){this.extent=
Array(4);this.planes=Array(4);this.maxSpan=0;this.center={origin:a.vec3d.create(),direction:a.vec3d.create()};for(var b=0;4>b;b++)this.extent[b]={origin:a.vec3d.create(),originLength:0,direction:a.vec3d.create(),cap:{next:null,direction:a.vec3d.create()}},this.planes[b]=a.vec4d.create();this.planes[4]=a.vec4d.create()}return e.prototype.toRenderBoundingExtent=function(b,c,e,h){f.center(b,v);v[2]=h;d.computeLinearTransformation(e,v,x,c);a.mat4d.inverse(x,y);k.set(n,k.NEGATIVE_INFINITY);for(var l=0,
m=u;l<m.length;l++)for(var q=m[l],r=q.x0,t=q.x1,w=q.y0,q=q.y1,z=0;5>z;z++){var C=z/4;v[0]=g.lerp(b[r],b[t],C);v[1]=g.lerp(b[w],b[q],C);v[2]=h;d.vectorToVector(v,e,v,c);a.mat4d.multiplyVec3(y,v);k.expand(n,v)}a.mat4d.multiplyVec3(x,a.vec3d.set3(n[0],n[1],n[2],this.extent[0].origin));a.mat4d.multiplyVec3(x,a.vec3d.set3(n[3],n[1],n[2],this.extent[1].origin));a.mat4d.multiplyVec3(x,a.vec3d.set3(n[3],n[4],n[2],this.extent[2].origin));a.mat4d.multiplyVec3(x,a.vec3d.set3(n[0],n[4],n[2],this.extent[3].origin))},
e.prototype.update=function(b,c,d,e,f,g){f=this.extent;this.toRenderBoundingExtent(b,d,e,g);a.vec3d.add(f[0].origin,f[2].origin,this.center.origin);a.vec3d.scale(this.center.origin,.5);c(this.center.origin,this.center.direction);for(d=0;4>d;d++)e=f[d],c(e.origin,e.direction),e.originLength=a.vec3d.length(e.origin),g=f[3===d?0:d+1],e.cap.next=g.origin,a.vec3d.direction(g.origin,e.origin,e.cap.direction),this._computePlane(e.cap.direction,e.direction,e.origin,this.planes[d]);this._computePlane(f[1].cap.direction,
f[0].cap.direction,f[0].origin,this.planes[4]);this.maxSpan=Math.max(Math.abs(b[0]-b[2]),Math.abs(b[1]-b[3]))},e.prototype.isVisibleInFrustumGlobal=function(b){if(0>a.vec3d.dot(this.center.direction,b.direction))return!0;for(var c=0;4>c;c++)if(0>a.vec3d.dot(this.extent[c].direction,b.direction))return!0;return!1},e.prototype.isVisibleInFrustum=function(a,d,e){if("global"===a.viewingMode){if(this.maxSpan>(a.spatialReference.isWGS84?c:q))return!0;if(d.altitude>=t)return this.isVisibleInFrustumGlobal(d)}for(a=
0;a<this.extent.length;a++)if(e=this.extent[a],b.frustumRay(d.planes,e.origin,null,e.direction)||b.frustumLineSegment(d.planes,e.origin,e.cap.next,e.cap.direction))return!0;for(a=0;a<d.lines.length;a++)if(e=d.lines[a],b.frustumLineSegment(this.planes,e.origin,e.endpoint,e.direction))return!0;return!1},e.prototype._computePlane=function(b,c,d,e){a.vec3d.cross(b,c,e);e[3]=-a.vec3d.dot(e,d)},e}();h=function(){function a(){this.frustumVisibilityDirty=this.frustumVisibility=!0;this.extent=null;this.extentEngine=
new r;this.extentEngineDirty=!0;this.renderSREqualsViewSR=null;this._isVisibleBelowSurface=!1;this.layerView=null}return a.prototype.initialize=function(a){this.layerView=a;this.renderSREqualsViewSR=a.view.renderSpatialReference.equals(a.view.spatialReference)},a.prototype.destroy=function(){this.extentEngine=this.extent=this.layerView=null},a.prototype.needsIdleUpdate=function(){return this.frustumVisibilityDirty},a.prototype.canResume=function(){return this.frustumVisibility},a.prototype.setExtent=
function(a){this.extent=a;this.frustumVisibilityDirty=this.extentEngineDirty=!0},a.prototype.viewChange=function(){this.frustumVisibilityDirty=!0},a.prototype.elevationBoundsChange=function(){this.extentEngineDirty=this.frustumVisibilityDirty=!0},Object.defineProperty(a.prototype,"isVisibleBelowSurface",{set:function(a){this._isVisibleBelowSurface=a;this.extentEngineDirty=this.frustumVisibilityDirty=!0},enumerable:!0,configurable:!0}),a.prototype.idleUpdate=function(a){a.done()||this.frustumVisibilityDirty&&
(this.updateSuspendFrustumVisible(),this.frustumVisibilityDirty=!1)},a.prototype.updateExtentEngine=function(){if(this.extentEngineDirty){this.extentEngineDirty=!1;var a,b=this.layerView.view,c=b.renderCoordsHelper.worldUpAtPosition.bind(b.renderCoordsHelper);if(this._isVisibleBelowSurface)a=e;else{a=b.basemapTerrain.getElevationBounds();var d=a[0];a=d-Math.max(1,(a[1]-d)*(1.2-1))}this.extentEngine.update(this.extent,c,b.renderSpatialReference,b.spatialReference,this.renderSREqualsViewSR,a)}},a.prototype.updateSuspendFrustumVisible=
function(){if(!this.extent)return void(this.frustumVisibility=!0);this.updateExtentEngine();var a=this.extentEngine.isVisibleInFrustum(this.layerView.view,this.layerView.view.frustum,this._isVisibleBelowSurface);a!==this.frustumVisibility&&(this.frustumVisibility=a,this.layerView._notifySuspendedChange())},a}();var u=[{x0:0,y0:1,x1:2,y1:1},{x0:0,y0:3,x1:2,y1:3},{x0:0,y0:1,x1:0,y1:3},{x0:2,y0:1,x1:2,y1:3}],v=a.vec3d.create(),x=a.mat4d.create(),y=a.mat4d.create(),n=k.create();return h})},"esri/views/3d/layers/graphics/Graphics3DVerticalScale":function(){define(["require",
"exports","../../../../geometry/support/scaleUtils"],function(m,l,h){return function(){function d(b){this.sourceSpatialReference=b.sourceSpatialReference;this.destSpatialReference=b.destSpatialReference}return d.prototype.adjust=function(b){var d=this._getVerticalUnitScale();return 1!==d?(b=b.slice(),this._scaleVerticalUnits(b,d),b):b},d.prototype._getVerticalUnitScale=function(){if(this.sourceSpatialReference&&!this.sourceSpatialReference.equals(this.destSpatialReference)){var b=h.getMetersPerVerticalUnitForSR(this.sourceSpatialReference),
d=h.getMetersPerVerticalUnitForSR(this.destSpatialReference);return b/d}return 1},d.prototype._vertexListsScaleZ=function(b,d){for(var g=0;g<b.length;++g)for(var f=b[g],a=0;a<f.length;++a)f[a][2]*=d},d.prototype._scaleVerticalUnits=function(b,d){for(var g=0;g<b.length;++g){var f=b[g].geometry;if(!f.hasZ)break;this._geometryIsPoint(f)?null!==f.z&&(f.z*=d):this._geometryIsPolyline(f)?this._vertexListsScaleZ(f.paths,d):this._geometryIsPolygon(f)&&this._vertexListsScaleZ(f.rings,d)}},d.prototype._geometryIsPoint=
function(b){return"point"===b.type},d.prototype._geometryIsPolygon=function(b){return"polygon"===b.type},d.prototype._geometryIsPolyline=function(b){return"polyline"===b.type},d}()})},"esri/views/3d/layers/graphics/Graphics3DHighlights":function(){define(["require","exports","./Graphics3DHighlightSet"],function(m,l,h){return function(){function d(){this.graphicsCore=null;this.highlights=[]}return d.prototype.destroy=function(){this.highlights.forEach(function(b){return b.highlightSet.removeAll()});
this.highlights=null},d.prototype.initialize=function(b){this.graphicsCore=b},d.prototype.acquireSet=function(b,d){var g=this,f=new h(b,d);this.highlights.push(f);return{set:f,handle:{remove:function(){return g.releaseSet(f)}}}},d.prototype.releaseSet=function(b){b.highlightSet.removeAll();b=this.highlights?this.highlights.indexOf(b):-1;-1!==b&&this.highlights.splice(b,1)},d.prototype.setUids=function(b,d){var g=this.graphicsCore.graphics;d.forEach(function(d){b.ids.add(d);(d=g[d])&&d.addHighlight(b.highlightSet,
b.options)})},d.prototype.setObjectIds=function(b,d){var g=this.graphicsCore.graphics;d.forEach(function(a){return b.ids.add(a)});for(var f in g)(d=g[f])&&b.hasGraphic(d)&&d.addHighlight(b.highlightSet,b.options)},d.prototype.graphicCreated=function(b){this.highlights.forEach(function(d){d.hasGraphic(b)&&b.addHighlight(d.highlightSet,d.options)})},d.prototype.graphicDeleted=function(b){this.highlights.forEach(function(d){d.hasGraphic(b)&&b.removeHighlight(d.highlightSet)})},d.prototype.allGraphicsDeleted=
function(){this.highlights.forEach(function(b){return b.highlightSet.removeAll()})},d}()})},"esri/views/3d/layers/graphics/Graphics3DHighlightSet":function(){define(["require","exports","../../webgl-engine/lib/HighlightSet"],function(m,l,h){return function(){function d(b,d){this.highlightSet=new h;this.ids=new Set;this.options=b;this.objectIdField=d}return d.prototype.hasGraphic=function(b){return this.objectIdField?this.ids.has(b.graphic.attributes[this.objectIdField]):this.ids.has(b.graphic.uid)},
d}()})},"esri/views/3d/layers/support/projectExtentUtils":function(){define(["require","exports","../../../../portal/support/geometryServiceUtils","../../../../core/promiseUtils","../../../../geometry/support/webMercatorUtils"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});l.toView=function(g){var k=g.view.spatialReference,f=g.layer.fullExtent&&g.layer.fullExtent.spatialReference;return!f||f.equals(k)||"local"!==g.view.viewingMode?d.resolve(null):b.canProject(f,k)?d.resolve(b.project(g.layer.fullExtent,
k)):h.projectGeometry(g.layer.fullExtent,k,g.layer.portalItem).then(function(a){return!g.destroyed&&a?a:void 0}).otherwise(function(){return null})}})},"esri/layers/graphics/controllers/SnapshotController":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/assignHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/HandleRegistry ../../../core/Promise ../../../core/promiseUtils ../../support/GraphicsManager ../../../geometry/support/scaleUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){var v=e.getLogger("esri.layers.graphics.controllers.SnapshotController");return function(a){function b(){var b=a.call(this)||this;return b._cancelErrorMsg="SnapshotController: query cancelled",b._featureResolution={value:.25,scale:945},b._gManager=null,b._handles=new c,b._maxFeatures={point:16E3,multipoint:8E3,polyline:4E3,polygon:4E3,multipatch:4E3},b._source=null,b._started=!1,b._pendingQueries=new Map,b.extent=null,b.hasAllFeatures=!1,b.hasFeatures=!1,b.layer=
null,b.layerView=null,b.maxPageSize=null,b.pageSize=null,b.paginationEnabled=!1,b}return h(b,a),b.prototype.initialize=function(){var a=this,b=this.layer.when(function(){return a._verifyCapabilities()}).then(function(){return a._init()});this.addResolvingPromise(b)},b.prototype.destroy=function(){this.cancelQuery();this._gManager&&(this._gManager.destroy(),this._gManager=null);this._handles.destroy();this._pendingQueries=this._handles=null},Object.defineProperty(b.prototype,"updating",{get:function(){return!!(this._pendingQueries&&
0<this._pendingQueries.size)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"graphics",{set:function(a){this._get("graphics")!==a&&(this._handles.remove("graphics"),a&&(this._collectionChanged({added:a.toArray()}),this._handles.add(a.on("change",this._collectionChanged.bind(this)),"graphics")),this._set("graphics",a))},enumerable:!0,configurable:!0}),b.prototype.cancelQuery=function(){var a=this;this._pendingQueries&&(this._pendingQueries.forEach(function(b,c){b.isFulfilled()||
b.cancel(Error(a._cancelErrorMsg))}),this._pendingQueries.clear(),this.notifyChange("updating"))},b.prototype.refresh=function(){this.isResolved()&&this._started&&this._queryFeatures()},b.prototype.startup=function(){this._started||(this._started=!0,this._resolutionParams=this._getResolutionParams(),this._queryFeatures())},b.prototype.update=function(){this.startup()},b.prototype._init=function(){var a=this.layer;this.paginationEnabled=!!a.get("capabilities.query.supportsPagination");this._source=
a.source;this.pageSize=null==this.maxPageSize?a.maxRecordCount:Math.min(a.maxRecordCount,this.maxPageSize);this._gManager=new r({graphics:this.graphics,objectIdField:a.objectIdField});this._setupStateWatchers()},b.prototype._getResolutionParams=function(){var a,b=this.layer,c=b.get("capabilities.query.supportsQuantization");if("polyline"===b.geometryType||"polygon"===b.geometryType){var d=u.getMetersPerUnit(this.layerView.view.spatialReference);null!=d&&(a=this._featureResolution.scale,d=this._featureResolution.value/
d,a=b.maxScale?b.maxScale:b.minScale?Math.min(a,b.minScale):Math.min(a,u.getScale(this.layerView.view,b.fullExtent)),a*=d/this._featureResolution.scale)}return a?{maxAllowableOffset:c?null:a,quantizationParameters:c?{mode:"view",originPosition:"upperLeft",tolerance:a,extent:b.fullExtent}:null}:null},b.prototype._setupStateWatchers=function(){this._handles.add([this.watch("extent",this.refresh.bind(this)),this.layer.watch("definitionExpression",this.refresh.bind(this)),this.layer.on("edits",this._editsHandler.bind(this))])},
b.prototype._createQueryParams=function(){var a=this.layerView,b=this.layer.createQuery();return b.outSpatialReference=a.view.spatialReference,b.geometry=this.extent,b.set(this._resolutionParams),this.paginationEnabled&&(b.start=0,b.num=this.pageSize),b},b.prototype._queryFeatures=function(){this.cancelQuery();this.hasAllFeatures=this.hasFeatures=!1;this._gManager.beginPagedUpdate();this.emit("query-start");this._executeQuery(this._createQueryParams())},b.prototype._executeQuery=function(a){var b=
this,c=this._source.queryFeatures(a),d=this._gManager.createIntentToAdd();this._querySetup(d,c);c.then(this._processFeatureSet.bind(this,a,d))["catch"](function(a){return b._queryError(d,a)}).always(function(){return b._queryTeardown(d)})},b.prototype._processFeatureSet=function(a,b,c){var d=c.exceededTransferLimit,e=c.features,f=this._maxFeatures[this.layer.geometryType]||0,g=e?e.length:0,h=this._gManager.numGraphics+g,k=h>=f;k&&(v.warn('Feature limit exceeded on layer "',this.layer.title,'". Not all features are shown.'),
(f=h-f)&&e.splice(g-f,f));a=d&&this.paginationEnabled&&!k?this._queryNextPage(a):!1;return e&&this._gManager.addPage(e,b),this.hasFeatures=!0,a||(this._gManager.endPagedUpdate(),this.hasAllFeatures=!d,this.emit("query-end",{success:!0})),c},b.prototype._queryNextPage=function(a){return a.start+=this.pageSize,this._executeQuery(a),!0},b.prototype._queryError=function(a,b){if(b&&"cancel"===b.dojoType&&!this.hasFeatures?this._gManager.revertPagedUpdate():this._gManager.endPagedUpdate(),this.emit("query-end",
{success:!1}),b&&"cancel"===b.dojoType)return t.reject(b);a=new f("snapshotcontroller:tile-request-failed","Failed to query for features",{error:b});return v.error(a),t.reject(a)},b.prototype._querySetup=function(a,b){this._pendingQueries.set(a,b);this.notifyChange("updating")},b.prototype._queryTeardown=function(a){this._gManager.removeIntent(a);this._pendingQueries["delete"](a);this.notifyChange("updating")},b.prototype._processRefetch=function(a,b){(b=b.features)&&this._gManager.add(b,a)},b.prototype._refetchError=
function(a,b){},b.prototype._verifyCapabilities=function(){if(!this.layer.get("capabilities.operations.supportsQuery"))throw new f("graphicscontroller:query-capability-required","Service requires query capabilities to be used as a feature layer",{layer:this.layer});},b.prototype._collectionChanged=function(a){var b=a.added;if(b)for(var c=0;c<b.length;c++)b[c].layer=this.layer;if(b=a.removed)for(c=0;c<b.length;c++)b[c].layer=null},b.prototype._editsHandler=function(a){var b=function(a){return a.objectId},
c=a.deletedFeatures.map(b);this._gManager["delete"](c);a=a.addedFeatures.concat(a.updatedFeatures).map(b);a.length&&(b=this._createQueryParams(),b.objectIds=a,b=this._source.queryFeatures(b),a=this._gManager.createIntentToAdd(a),this._querySetup(a,b),b.then(this._processRefetch.bind(this,a)).otherwise(this._refetchError.bind(this,a)).always(this._queryTeardown.bind(this,a)))},d([g.property()],b.prototype,"_pendingQueries",void 0),d([g.property({dependsOn:["_pendingQueries"]})],b.prototype,"updating",
null),d([g.property()],b.prototype,"graphics",null),d([g.property()],b.prototype,"extent",void 0),d([g.property()],b.prototype,"hasAllFeatures",void 0),d([g.property()],b.prototype,"hasFeatures",void 0),d([g.property()],b.prototype,"layer",void 0),d([g.property()],b.prototype,"layerView",void 0),d([g.property()],b.prototype,"maxPageSize",void 0),d([g.property()],b.prototype,"pageSize",void 0),d([g.property()],b.prototype,"paginationEnabled",void 0),b=d([g.subclass("esri.layers.graphics.controllers.SnapshotController")],
b)}(g.declared(k,q,a))})},"esri/layers/support/GraphicsManager":function(){define(["../../core/Accessor"],function(m){var l=0;return m.createSubclass({constructor:function(){this._deletedGraphicsIndex=new Set;this._intentsIndex=new Map},destroy:function(){this.removeAll();this._intentsIndex=this._deletedGraphicsIndex=null},properties:{graphics:null,indexById:{value:null,dependsOn:["graphics","objectIdField"],get:function(){return this._createIndexById(this.graphics&&this.graphics.toArray(),this.objectIdField)}},
numGraphics:{value:0,dependsOn:["indexById"],get:function(){return this.indexById?this.indexById.size:0}},objectIdField:null,updating:{value:!1,dependsOn:["_intentsIndex"],get:function(){return!!(this._intentsIndex&&0<this._intentsIndex.size)}},_intentsIndex:{value:null}},_oldIndex:null,_deletedGraphicsIndex:null,beginPagedUpdate:function(){this._oldIndex=this.indexById;this.indexById=null;this.notifyChange("numGraphics")},addPage:function(h,d){this.add(h,d)},revertPagedUpdate:function(){var h=this._removeLeftOnly(this.indexById,
this._oldIndex);this.indexById=this._oldIndex;this._oldIndex=null;this.graphics.removeMany(h);this.notifyChange("numGraphics")},endPagedUpdate:function(){var h=this._removeLeftOnly(this._oldIndex,this.indexById);this._oldIndex=null;this.graphics.removeMany(h);this.notifyChange("numGraphics")},findGraphic:function(h){return(h=this.indexById&&this.indexById.get(h))&&h.graphic},removeAll:function(){this.indexById=this._oldIndex=null;this.graphics.removeAll();this.notifyChange("numGraphics")},add:function(h,
d){h&&h.length&&(this.indexById=this.indexById||new Map,h=this._updateAndExtractNew(h,this.indexById,this._oldIndex,d),this.graphics.removeMany(h.toRemove),this.graphics.addMany(h.toAdd),this.notifyChange("numGraphics"))},remove:function(h){this._remove(h,!1)},"delete":function(h){this._remove(h,!0)},isDeleted:function(h){return this._deletedGraphicsIndex.has(h)},createIntentToAdd:function(h){h&&this._intentsIndex.forEach(function(b,d){h.forEach(function(d){b.ignoredIds.add(d)})},this);var d=l++;
return this._intentsIndex.set(d,{ignoredIds:new Set}),this.notifyChange("updating"),d},findIntent:function(h){return this._intentsIndex.get(h)},removeIntent:function(h){this._intentsIndex["delete"](h);this.notifyChange("updating")},_createIndexById:function(h,d){var b;if(h&&h.length&&d){var g,k,f;b=new Map;for(g=0;k=h[g];g++)f=k.attributes&&k.attributes[d],null!=f&&b.set(f,{graphic:k,refCount:1})}return b},_updateAndExtractNew:function(h,d,b,g){var k=[],f=[],a=h?h.length:0,e=this.objectIdField,c=
this.findIntent(g);for(g=0;a>g;g++){var l=h[g],m=l.attributes&&l.attributes[e];if(null!=m){var r=b&&b.get(m);(r=d.get(m)||r)?c&&c.ignoredIds.has(m)||(d.set(m,{graphic:l,refCount:r.refCount+1}),f.push(r.graphic),k.push(l)):this.isDeleted(m)||(d.set(m,{graphic:l,refCount:1}),k.push(l))}else k.push(l)}return{toRemove:f,toAdd:k}},_remove:function(h,d){h=h||[];h="object"==typeof h[0]?h.map(function(b){return b.attributes&&b.attributes[this.objectIdField]}.bind(this)):h;var b=this._extractGraphics(h,this._oldIndex),
g=this._extractGraphics(h,this.indexById);h.forEach(function(b){d&&this._deletedGraphicsIndex.add(b);this._removeFromIndex(b,this._oldIndex,d);this._removeFromIndex(b,this.indexById,d)}.bind(this));this.graphics.removeMany(b.concat(g));this.notifyChange("numGraphics")},_removeFromIndex:function(h,d,b){if(d&&d.has(h))if(b)d["delete"](h);else{b=d.get(h);var g=b.refCount-1;0===g?d["delete"](h):b.refCount=g}},_removeLeftOnly:function(h,d){var b=[];return h&&h.forEach(function(g,k){var f=g.graphic;!f||
d&&d.has(k)||(--g.refCount,0===g.refCount&&h["delete"](k),b.push(f))}),b},_extractGraphics:function(h,d){return h&&d?h.map(function(b){return(b=d.get(b))&&b.graphic}):[]}})})},"esri/WebMap":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./Map ./Viewpoint ./core/Error ./core/JSONSupport ./core/Loadable ./core/promiseUtils ./core/requireUtils ./core/Logger ./geometry/SpatialReference ./geometry/support/webMercatorUtils ./portal/Portal ./portal/PortalItem ./portal/support/geometryServiceUtils ./tasks/support/ProjectParameters ./webmap/InitialViewProperties ./core/accessorSupport/decorators dojo/_base/lang".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z){var C=q.getLogger("esri.WebMap");return function(a){function b(b){b=a.call(this)||this;return b.applicationProperties=null,b.authoringApp=null,b.authoringAppVersion=null,b.bookmarks=null,b.initialViewProperties=null,b.portalItem=null,b.presentation=null,b.sourceVersion=null,b.tables=null,b.widgets=null,b}return h(b,a),f=b,b.prototype.initialize=function(){if(this.when()["catch"](function(a){C.error("#load()","Failed to load web map",a)}),this.resourceInfo){var a=
void 0;try{a=this._validateJSON(this.resourceInfo)}catch(M){return void this.addResolvingPromise(e.reject(M))}this.read(a)}},b.prototype.readInitialViewProperties=function(a,b){a={};return b.spatialReference&&(a.spatialReference=t.fromJSON(b.spatialReference)),new n(a)},b.prototype.readSourceVersion=function(a,b){a=b.version.split(".");b=a[1];return{major:parseInt(a[0],10),minor:parseInt(b,10)}},b.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},b.prototype.toJSON=
function(){throw new k("internal:not-yet-implemented","WebMap.toJSON is not yet implemented");},b.fromJSON=function(a){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");return new f({resourceInfo:a})},b.prototype._loadFromSource=function(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-map"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):e.resolve(null)},b.prototype._loadFromItem=function(a){var b=this;return a.load().otherwise(function(a){throw new k("webmap:load-portal-item",
"Failed to load portal item",{error:a});}).then(function(){if("Web Map"!==a.type)throw new k("webmap:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Map'",{type:a.type});}).then(function(){return a.fetchData()}).then(function(c){return b.resourceInfo=c,b._readAndLoadFromJSON(c,{origin:"web-map",portal:a.portal||u.getDefault()})}).then(function(){return b._getInitialExtent()}).then(function(a){if(a){var c=b.initialViewProperties?b.initialViewProperties.clone():new n;c.viewpoint=
new g;c.viewpoint.targetGeometry=a;b.initialViewProperties=c}})},b.prototype._readAndLoadFromJSON=function(a,b){a=this._validateJSON(a);return this.read(a,b),this._loadFromJSON(a,b)},b.prototype._validateJSON=function(a){a=this._sanitizeJSON(a);var b=this._validateVersion(a.version);return a.version=b.major+"."+b.minor,a},b.prototype._sanitizeJSON=function(a){return{authoringApp:a.authoringApp||"",authoringAppVersion:a.authoringAppVersion||"",applicationProperties:a.applicationProperties,baseMap:a.baseMap,
bookmarks:a.bookmarks,operationalLayers:a.operationalLayers,presentation:a.presentation,spatialReference:a.spatialReference,tables:a.tables,version:a.version||"0.0",widgets:a.widgets}},b.prototype._validateVersion=function(a){var b=a.split("."),c=b[0],b=b[1],d=/^\s*\d+\s*$/;if(!d.test(c))throw new k("webmap:invalid-version","Expected major version to be a number, but got '"+a+"'",{version:a});if(!d.test(b))throw new k("webmap:invalid-version","Expected minor version to be a number, but got '"+a+"'",
{version:a});c=parseInt(c,10);b=parseInt(b,10);if(2!==c)throw new k("webmap:unsupported-version","Required major version is '2', but got '"+c+"'",{version:a});return{major:c,minor:b}},b.prototype._loadFromJSON=function(a,b){var d=this,f={context:z.mixin({},b,{layerContainerType:"operational-layers"})};return this.portalItem&&(f.context.portal=this.portalItem.portal||u.getDefault()),c.when(m,"./portal/support/layersCreator").then(function(b){var c=[],g=a.operationalLayers;return g&&g.length&&c.push.apply(c,
b.populateOperationalLayers(d.layers,g,f)),e.eachAlways(c).then(function(){})})},b.prototype._getInitialExtent=function(){var a=null,b=this.initialViewProperties&&this.initialViewProperties.spatialReference,c=this.portalItem&&this.portalItem.extent;if(b&&c)if(b.isWGS84)a=c.clone();else{if(!b.isWebMercator)return x.create(this.portalItem).then(function(a){var d=new y;return d.geometries=[c],d.outSpatialReference=b,a.project(d)}).then(function(a){return a[0]}).otherwise(function(a){return console.log("Error projecting item's extent:",
a),null});a=r.geographicToWebMercator(c)}return e.resolve(a)},d([w.property()],b.prototype,"applicationProperties",void 0),d([w.property()],b.prototype,"authoringApp",void 0),d([w.property()],b.prototype,"authoringAppVersion",void 0),d([w.property({json:{read:{source:"baseMap"}}})],b.prototype,"basemap",void 0),d([w.property()],b.prototype,"bookmarks",void 0),d([w.property({type:n})],b.prototype,"initialViewProperties",void 0),d([w.reader("initialViewProperties",["spatialReference"])],b.prototype,
"readInitialViewProperties",null),d([w.property({type:v})],b.prototype,"portalItem",void 0),d([w.property()],b.prototype,"presentation",void 0),d([w.property()],b.prototype,"resourceInfo",void 0),d([w.property({readOnly:!0})],b.prototype,"sourceVersion",void 0),d([w.reader("sourceVersion",["version"])],b.prototype,"readSourceVersion",null),d([w.property()],b.prototype,"tables",void 0),d([w.property()],b.prototype,"widgets",void 0),b=f=d([w.subclass("esri.WebMap")],b);var f}(w.declared(b,a,f))})},
"esri/webmap/InitialViewProperties":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Viewpoint ../core/Accessor ../geometry/SpatialReference ../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g,k,f){return function(a){function e(b){b=a.call(this,b)||this;return b.spatialReference=null,b.viewpoint=null,b}return h(e,a),c=e,e.prototype.clone=function(){return new c({spatialReference:this.spatialReference?this.spatialReference.clone():
null,viewpoint:this.viewpoint?this.viewpoint.clone():null})},d([f.shared("esri.webmap.InitialViewProperties")],e.prototype,"declaredClass",void 0),d([f.property({value:null,type:k})],e.prototype,"spatialReference",void 0),d([f.property({value:null,type:b})],e.prototype,"viewpoint",void 0),e=c=d([f.subclass()],e);var c}(f.declared(g))})},"esri/WebScene":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/tsSupport/paramHelper ./Map ./core/Error ./core/requireUtils ./core/promiseUtils ./core/JSONSupport ./core/Loadable ./core/Collection ./core/urlUtils ./core/Logger ./core/accessorSupport/read ./core/accessorSupport/originUtils ./support/webSceneUtils ./Viewpoint ./kernel ./geometry/support/jsonUtils ./geometry/Extent ./geometry/HeightModelInfo ./geometry/SpatialReference ./geometry/support/heightModelInfoUtils ./webscene/Presentation ./webscene/InitialViewProperties ./webscene/Environment ./webscene/Version ./portal/PortalItem ./portal/Portal dojo/has dojo/_base/lang ./core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C,B,F,G,N,M,R,P,Q,T,O,S){var H=r.getLogger("esri.WebScene"),Y=T("dojo-debug-messages"),W=new R["default"](1,9);return function(c){function g(a){a=c.call(this)||this;return a.clippingArea=null,a.clippingEnabled=!1,a.heightModelInfo=null,a.sourceVersion=null,a.supportsHeightModelInfo=!0,a.presentation=null,a.initialViewProperties=null,a.portalItem=null,a.resourceInfo=null,a.authoringApp=null,a.authoringAppVersion=null,a._isAuthoringAppSetByUser=!1,
a._isAuthoringAppVersionSetByUser=!1,a}return h(g,c),g.prototype.initialize=function(){if(this.when()["catch"](function(a){H.error("#load()","Failed to load web scene",a)}),this.resourceInfo){var b=void 0;try{b=this._validateJSON(this.resourceInfo)}catch(K){return void this.addResolvingPromise(a.reject(K))}this.read(b);this.addResolvingPromise(this._validateSpatialReference());this.addResolvingPromise(this._validateHeightModelInfo())}},g.prototype.getDefaults=function(a){return O.mixin(this.inherited(arguments),
{presentation:{},initialViewProperties:{}})},g.prototype.writeClippingArea=function(a,b){b.clippingArea||(b.clippingArea={});b.clippingArea.geometry=a.toJSON()},g.prototype.readClippingEnabled=function(a,b){return b.clippingArea?!!b.clippingArea.clip:!1},g.prototype.writeClippingEnabled=function(a,b){this.clippingArea&&(b.clippingArea||(b.clippingArea={}),b.clippingArea.clip=a)},g.prototype.writeLayers=function(a,b,c,d){var e=this,f=O.mixin({},d,{layerContainerType:"operational-layers"});a=a.filter(function(a){return e.verifyWriteLayer(a,
f)}).map(function(a){return a.write(null,f)}).filter(function(a){return!!a});b[c]=a.toArray()},g.prototype.verifyWriteLayer=function(a,b){return a.write?!0:(b&&b.messages&&b.messages.push(new k("layer:unsupported","Layers ("+a.title+", "+a.id+") of type '"+a.declaredClass+"' cannot be persisted in web scenes",{layer:a})),!1)},g.prototype.readSourceVersion=function(a,b){a=b.version.split(".");b=a[1];return new R["default"](parseInt(a[0],10),parseInt(b,10))},g.prototype.writeSourceVersion=function(a,
b,c){b[c]=W.major+"."+W.minor},Object.defineProperty(g.prototype,"authoringApp",{set:function(a){this._isAuthoringAppSetByUser=!0;this._set("authoringApp",a)},enumerable:!0,configurable:!0}),g.prototype.writeAuthoringApp=function(a,b){a&&this._isAuthoringAppSetByUser?b.authoringApp=a:b.authoringApp="ArcGIS API for JavaScript"},Object.defineProperty(g.prototype,"authoringAppVersion",{set:function(a){this._isAuthoringAppVersionSetByUser=!0;this._set("authoringAppVersion",a)},enumerable:!0,configurable:!0}),
g.prototype.writeAuthoringAppVersion=function(a,b){a&&this._isAuthoringAppVersionSetByUser?b.authoringAppVersion=a:b.authoringAppVersion=n.version},g.prototype.writeGround=function(a,b,c,d){a?b[c]=a.write(null,d):b[c]={layers:[]}},g.prototype.readInitialViewProperties=function(a,b){a={};return b.initialState&&b.initialState.environment&&(a.environment=M.fromJSON(b.initialState.environment)),b.spatialReference&&(a.spatialReference=B.fromJSON(b.spatialReference)),a.viewingMode=b.viewingMode||"global",
b.initialState&&b.initialState.viewpoint&&(a.viewpoint=y.fromJSON(b.initialState.viewpoint)),new N(a)},g.prototype.writeInitialViewProperties=function(a,b,c,d){a&&(c={},a.environment&&(c.environment=a.environment.write({},d)),a.viewpoint&&(c.viewpoint=a.viewpoint.write({},d)),0!==Object.keys(c).length&&(b.initialState=c),b.spatialReference=a.spatialReference?a.spatialReference.write({},d):B.WebMercator.toJSON(),b.viewingMode=null!=a.viewingMode?a.viewingMode:"global")},g.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),
this.when()},g.prototype.read=function(a,b){var c=this;b=O.mixin({},b,{origin:"web-scene"});var d=this._isAuthoringAppVersionSetByUser,e=this._isAuthoringAppSetByUser,f=arguments;if(u.readLoadable(this,a,function(b){return c.inherited(f,[a,b])},b),e||(this._isAuthoringAppSetByUser=!1),d||(this._isAuthoringAppVersionSetByUser=!1),a.baseMap&&Array.isArray(a.baseMap.elevationLayers)&&this.sourceVersion.supportsVisibleElevationLayersInSlides){var d=a.baseMap.elevationLayers.map(function(a){return{id:a.id}}),
g=this.presentation.slides,h=function(a,b){return a.visibleLayers.some(function(a){return a.id===b})},k=d.filter(function(a){return!g.some(function(b){return h(b,a.id)})});g.forEach(function(a){a.visibleLayers.addMany(k)})}return this},g.prototype._writeBasemapElevationLayers=function(a){var b=a.ground&&a.ground.layers;!a.baseMap&&b&&b.length&&(a.baseMap={title:"Basemap",baseMapLayers:[]});a.baseMap&&(a.baseMap.elevationLayers=O.clone(b))},g.prototype.write=function(a,b){if("loaded"!==this.loadStatus){var c=
new k("webscene:not-loaded","Web scene must be loaded before it can be serialized");throw H.error("#toJSON()","Web scene must be loaded before it can be serialized",this.loadError||this.loadStatus),c;}b=O.mixin({},b,{origin:"web-scene"});c=this.inherited(arguments,[a,b]);return this._writeBasemapElevationLayers(c),c},g.prototype.save=function(b){var c=this;if(!this.portalItem)return H.error("save(): requires the .portalItem property to be set"),a.reject(new k("webscene:portal-item-not-set","Portal item to save to has not been set on the WebScene"));
if("Web Scene"!==this.portalItem.type)return a.reject(new k("webscene:portal-item-wrong-type",'Portal item needs to have type "Web Scene"'));var d,e;return this.load().then(function(){return c._loadObjectsWithLayers()}).then(function(){return d=c._enableVerifyItemRelativeUrls({origin:"web-scene",url:c.portalItem.itemUrl&&t.urlToObject(c.portalItem.itemUrl),messages:[],portal:c.portalItem.portal||Q.getDefault(),writtenProperties:[],blockedRelativeUrls:[]}),e=c.write(null,d),c._verifySave(e,d,b).then(function(){return c._updateTypeKeywords(c.portalItem),
c.portalItem.update({data:e})})}).then(function(){return v.updateOrigins(d),a.resolve(c.portalItem)})},g.prototype.saveAs=function(b,c){var d=this;if(!b)return H.error("saveAs(portalItem): requires a portal item parameter"),a.reject(new k("webscene:portal-item-required","saveAs requires a portal item to save to"));if(b.type&&"Web Scene"!==b.type||b.id)return a.reject(new k("webscene:portal-item-already-exists","WebScene can only saveAs to a new and empty portal item"));var f,g,h=b.portal||Q.getDefault();
return this.load().then(function(){return d._loadObjectsWithLayers()}).then(function(){return f=d._enableVerifyItemRelativeUrls({origin:"web-scene",url:null,messages:[],portal:h,writtenProperties:[],blockedRelativeUrls:[]}),g=d.write(null,f),d._verifySaveAs(g,f,c).then(function(){return h._signIn()})}).then(function(){return b.type="Web Scene",b.portal=h,d._updateTypeKeywords(b),h.user.addItem({item:b,folder:c&&c.folder,data:g})}).then(function(){return d.portalItem=b,e.prototype.read.call(d,{version:g.version,
authoringApp:g.authoringApp,authoringAppVersion:g.authoringAppVersion},{name:"web-scene",url:b.itemUrl&&t.urlToObject(b.itemUrl)}),v.updateOrigins(f),a.resolve(b)})},g.prototype._verifySave=function(b,c,d,e){void 0===e&&(e=!1);var g=c.messages.filter(function(a){return"error"===a.type}).map(function(a){return new k(a.name,a.message,a.details)});c.blockedRelativeUrls&&(g=g.concat(c.blockedRelativeUrls.map(function(a){return new k("url:unsupported","Relative url '"+a+"' is not supported in Web Scene")})));
d&&d.ignoreUnsupported&&(g=g.filter(function(a){return"layer:unsupported"!==a.name&&"symbol:unsupported"!==a.name&&"property:unsupported"!==a.name}));d&&d.strictSchemaValidationEnabled||(g=g.filter(function(a){return"web-document-write:property-required"!==a.name}));var h,l=d&&d.strictSchemaValidationEnabled;return h=Y||l?f.when(m,"./webscene/validator").then(function(a){a=a.validate(b);if(0<a.length){var c="webscene did not validate:\n"+a.join("\n");H.error((e?"saveAs":"save")+"(): "+c)}return a.map(function(a){return new k("webscene:schema-validation",
a)})}).then(function(b){return l&&0<b.length?(b=x.createSchemaValidationError(b.concat(g)),a.reject(b)):g}):a.resolve(g),h.then(function(b){return 0<b.length?a.reject(new k("webscene:save","Failed to save webscene due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:b})):void 0})},g.prototype._verifySaveAs=function(b,c,d){return this.canSaveAs(c)?a.reject(x.createCopyError()):this._verifySave(b,c,d,!0)},g.prototype.verifySaveAs=function(a){var b=this._enableVerifyItemRelativeUrls({origin:"web-scene",
messages:[]}),c=this.write(null,b);return this._verifySaveAs(c,b,a)},g.prototype.canSaveAs=function(a){return a||(a=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),this.write(null,a)),a.verifyItemRelativeUrls&&0<a.verifyItemRelativeUrls.writtenUrls.length},g.prototype.updateFrom=function(a,b){void 0===b&&(b={});b.environmentExcluded||(this.initialViewProperties.environment=M.prototype.clone.apply(a.environment));b.viewpointExcluded||(this.initialViewProperties.viewpoint=a.viewpoint.clone());
this.initialViewProperties.spatialReference=a.spatialReference.clone();this.initialViewProperties.viewingMode=a.viewingMode;a.clippingArea?a.clippingArea!==this.clippingArea&&(this.clippingArea=a.clippingArea.clone(),this.clippingEnabled=!0):this.clippingEnabled=!1;a.heightModelInfo&&(this.heightModelInfo=a.heightModelInfo.clone());a.map===this&&a.allLayerViews.forEach(function(a){a.layer.visible=a.visible})},g.prototype._loadFromSource=function(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,
{origin:"web-scene"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):this._loadObjectsWithLayers()},g.prototype._readAndLoadFromJSON=function(a,b){a=this._validateJSON(a,b&&b.url&&b.url.path);return this.read(a,b),this._loadFromJSON(a,b)},g.prototype._extractOperationalLayers=function(a){var b=this,c=[];if(!this.sourceVersion.supportsGround&&a.baseMap&&Array.isArray(a.baseMap.elevationLayers))for(var d=0,e=a.baseMap.elevationLayers;d<e.length;d++)c.push(e[d]);var f=[],g=function(a){return a.layers&&
(a.layers=a.layers.filter(g)),"ArcGISTiledElevationServiceLayer"===a.layerType?(b.sourceVersion.supportsGround||f.push(a),!1):!0};return{operationalLayers:a.operationalLayers?a.operationalLayers.filter(g):[],operationalElevationLayers:f,basemapElevationLayers:c}},g.prototype._loadFromJSON=function(b,c){var d=this,e=new q;return this._validateSpatialReference().then(function(){return d._validateHeightModelInfo()}).then(function(){return f.when(m,"./portal/support/layersCreator")}).then(function(f){var g=
d._extractOperationalLayers(b),h=g.operationalLayers,k=g.operationalElevationLayers,g=g.basemapElevationLayers,l=[],m={context:O.mixin({},c,{layerContainerType:"operational-layers"})};if(d.portalItem&&(m.context.portal=d.portalItem.portal||Q.getDefault()),0<g.length){var n=O.mixin({},m,{context:O.mixin({},m.context,{layerContainerType:"ground"})});n.defaultLayerType="ArcGISTiledElevationServiceLayer";l.push.apply(l,f.populateOperationalLayers(d.ground.layers,g,n))}0<k.length&&(n=O.mixin({},m,{context:O.mixin({},
m.context,{layerContainerType:"ground"})}),n.defaultLayerType="ArcGISTiledElevationServiceLayer",l.push.apply(l,f.populateOperationalLayers(e,k,n)));return h&&0<h.length&&l.push.apply(l,f.populateOperationalLayers(d.layers,h,m)),a.eachAlways(l).then(function(){})}).then(function(){return d._loadObjectsWithLayers()}).then(function(){d.ground.layers.addMany(e)})},g.prototype._loadObjectsWithLayers=function(){var b=[];return this.ground&&b.push(this.ground.load()),this.basemap&&b.push(this.basemap.load()),
this.presentation.slides.forEach(function(a){a.basemap&&b.push(a.basemap.load())}),a.eachAlways(b).then(function(){})},g.prototype._loadFromItem=function(a){var b=this;return a.load().otherwise(function(a){throw new k("webscene:load-portal-item","Failed to load portal item",{error:a});}).then(function(){if("Web Scene"!==a.type)throw new k("webscene:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Scene'",{type:a.type});}).then(function(){return a.fetchData()}).then(function(c){return b.resourceInfo=
c,b._readAndLoadFromJSON(c,{origin:"web-scene",url:t.urlToObject(a.itemUrl),portal:a.portal||Q.getDefault()})})},g.prototype._validateSpatialReference=function(){var b,c=this.initialViewProperties,d=this._sceneSpatialReference;if("local"!==c.viewingMode){if(!d.isWGS84&&!d.isWebMercator)return a.reject(new k("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in global mode, only Web Mercator or WGS84 GCS are supported",{spatialReference:d,viewingMode:c.viewingMode}));
b=function(a){return!a||a.isWGS84||a.isWebMercator}}else{if(d.isGeographic)return a.reject(new k("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in local mode, only projected coordinate systems are supported",{spatialReference:d,viewingMode:c.viewingMode}));b=function(a){return!a||a.equals(d)}}var e=function(a){return a&&(a.camera&&a.camera.position&&a.camera.position.spatialReference||a.targetGeometry&&a.targetGeometry.spatialReference)},f=e(c.viewpoint);
return f&&!b(f)?a.reject(new k("webscene:incompatible-camera-spatial-reference","Camera spatial reference (${cameraSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{cameraSpatialReference:f,sceneSpatialReference:d,viewingMode:c.viewingMode})):(f=this.presentation.slides.find(function(a){return!b(e(a.viewpoint))}))?(f=e(f.viewpoint),a.reject(new k("webscene:incompatible-slide-spatial-reference","Slide spatial reference (${slideSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",
{slideSpatialReference:f,sceneSpatialReference:d,viewingMode:c.viewingMode}))):a.resolve()},g.prototype._validateHeightModelInfo=function(){var b=F.validateWebSceneError(this.heightModelInfo,this._sceneSpatialReference);return b?a.reject(b):a.resolve()},g.prototype._validateJSON=function(a,b){void 0===b&&(b=null);a=this._sanitizeJSON(a,b);b=R["default"].parse(a.version,"webscene");return W.validate(b),a.version=b.major+"."+b.minor,1===b.major&&2>=b.minor&&(a.spatialReference=B.WebMercator.toJSON()),
a},g.prototype._sanitizeJSON=function(a,b){void 0===b&&(b=null);return{version:a.version||"",baseMap:a.baseMap,ground:a.ground,operationalLayers:a.operationalLayers,authoringApp:a.authoringApp||"",authoringAppVersion:a.authoringAppVersion||"",viewingMode:a.viewingMode||"global",presentation:a.presentation&&G.sanitizeJSON(a.presentation)||{},initialState:a.initialState,spatialReference:a.spatialReference||B.WebMercator.toJSON(),heightModelInfo:a.heightModelInfo||null,clippingArea:a.clippingArea}},
g.prototype._updateTypeKeywords=function(a){"local"===this.initialViewProperties.viewingMode?a.typeKeywords?-1===a.typeKeywords.indexOf("ViewingMode-Local")&&a.typeKeywords.push("ViewingMode-Local"):a.typeKeywords=["ViewingMode-Local"]:"global"===this.initialViewProperties.viewingMode&&a.typeKeywords&&(a.typeKeywords=a.typeKeywords.filter(function(a){return"ViewingMode-Local"!==a}));a.typeKeywords&&(a.typeKeywords=a.typeKeywords.filter(function(a,b,c){return c.indexOf(a)===b}))},Object.defineProperty(g.prototype,
"_sceneSpatialReference",{get:function(){return this.initialViewProperties.spatialReference||B.WebMercator},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"_verifyItemRelativeRootPath",{get:function(){return this.portalItem&&this.portalItem.itemUrl?t.urlToObject(this.portalItem.itemUrl).path:null},enumerable:!0,configurable:!0}),g.prototype._enableVerifyItemRelativeUrls=function(a){var b=this._verifyItemRelativeRootPath;return b&&(a.verifyItemRelativeUrls={rootPath:b,writtenUrls:[]}),
a},g.fromJSON=function(a){if(!a)throw new k("webscene:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:a})},g.VERSION=W,d([S.property({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],g.prototype,"basemap",void 0),d([S.property({type:z,json:{read:{source:"clippingArea.geometry",reader:w.fromJSON},write:{target:"clippingArea.geometry"}}})],g.prototype,"clippingArea",void 0),d([S.writer("clippingArea")],g.prototype,"writeClippingArea",null),d([S.property({type:Boolean,
json:{write:{target:"clippingArea.clip"}}})],g.prototype,"clippingEnabled",void 0),d([S.reader("clippingEnabled",["clippingArea"])],g.prototype,"readClippingEnabled",null),d([S.writer("clippingEnabled")],g.prototype,"writeClippingEnabled",null),d([S.property({type:C,json:{write:!0}})],g.prototype,"heightModelInfo",void 0),d([S.property({json:{write:{target:"operationalLayers"}}})],g.prototype,"layers",void 0),d([S.writer("layers")],g.prototype,"writeLayers",null),d([S.property({readOnly:!0,type:R["default"],
json:{type:String,write:{allowNull:!0,target:"version",isRequired:!0}}})],g.prototype,"sourceVersion",void 0),d([S.reader("sourceVersion",["version"])],g.prototype,"readSourceVersion",null),d([S.writer("sourceVersion")],g.prototype,"writeSourceVersion",null),d([S.property({type:String,json:{write:{allowNull:!0}}})],g.prototype,"authoringApp",null),d([S.writer("authoringApp")],g.prototype,"writeAuthoringApp",null),d([S.property({type:String,json:{write:{allowNull:!0}}})],g.prototype,"authoringAppVersion",
null),d([S.writer("authoringAppVersion")],g.prototype,"writeAuthoringAppVersion",null),d([S.property({json:{write:{isRequired:!0,allowNull:!0,enabled:!0}}})],g.prototype,"ground",void 0),d([S.writer("ground")],g.prototype,"writeGround",null),d([S.property({type:G,json:{write:!0}})],g.prototype,"presentation",void 0),d([S.property({type:N})],g.prototype,"initialViewProperties",void 0),d([S.reader("initialViewProperties",["initialState.environment","spatialReference","viewingMode","initialState.viewpoint"])],
g.prototype,"readInitialViewProperties",null),d([S.writer("initialViewProperties",{"initialState.environment":{type:M},spatialReference:{type:B},viewingMode:{type:String},"initialState.viewpoint":{type:y}})],g.prototype,"writeInitialViewProperties",null),d([S.property({type:P})],g.prototype,"portalItem",void 0),d([S.property()],g.prototype,"resourceInfo",void 0),d([b(0,S.cast(P))],g.prototype,"saveAs",null),d([S.property()],g.prototype,"_sceneSpatialReference",null),d([S.property()],g.prototype,"_verifyItemRelativeRootPath",
null),g=d([S.subclass("esri.WebScene")],g)}(S.declared(g,c,e))})},"esri/core/accessorSupport/originUtils":function(){define(["require","exports","../MultiOriginJSONSupport"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.updateOrigins=function(d){d&&d.writtenProperties&&d.writtenProperties.forEach(function(b){var d=b.target;b.newOrigin&&b.oldOrigin!==b.newOrigin&&d.isInstanceOf(h)&&d.updateOrigin(b.propName,b.newOrigin)})}})},"esri/support/webSceneUtils":function(){define(["require",
"exports","../core/Error"],function(m,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.createCopyError=function(){return new h("webscene:failed-to-copy-embedded-resources","Copying of embedded resources is currently not supported")};l.isCopyError=function(d){return d&&"webscene:failed-to-copy-embedded-resources"===d.name};l.createSchemaValidationError=function(d){return new h("webscene:schema-validation","Failed to save webscene due to schema validation errors. See 'details.errors' for more detailed information",
{errors:d})};l.isSchemaValidationError=function(d){return d&&"webscene:schema-validation"===d.name}})},"esri/webscene/Presentation":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/Collection ../core/collectionUtils ../core/accessorSupport/decorators ./Slide".split(" "),function(m,l,h,d,b,g,k,f,a){var e=g.ofType(a);return function(b){function c(a){a=b.call(this,a)||this;return a.slides=new e,a}return h(c,b),Object.defineProperty(c.prototype,
"slides",{set:function(a){this._set("slides",k.referenceSetter(a,this._get("slides"),e))},enumerable:!0,configurable:!0}),c.prototype.clone=function(){return new this.constructor({slides:this.slides.clone()})},c.sanitizeJSON=function(b){var c;return c=void 0!==b.slides&&Array.isArray(b.slides)?b.slides.filter(function(a){return a&&!!a.viewpoint}).map(function(b){return a.sanitizeJSON(b)}):[],{slides:c}},d([f.property({type:e,json:{write:!0}}),f.cast(k.castForReferenceSetter)],c.prototype,"slides",
null),c=d([f.subclass("esri.webscene.Presentation")],c)}(f.declared(b))})},"esri/webscene/Slide":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../Viewpoint ../Basemap ../support/basemapUtils ../core/JSONSupport ../core/lang ../core/Logger ../core/Collection ../core/collectionUtils ../core/promiseUtils ./Environment ./Lighting ./support/Description ./support/Title ./support/Thumbnail dojo/_base/lang dojo/promise/all ../views/3d/lib/glMatrix".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C){var B=0,F=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;return b.id="",b}return h(c,a),e=c,c.prototype.clone=function(){return new e({id:this.id})},d([b.property({type:String,json:{write:!0}})],c.prototype,"id",void 0),c=e=d([b.subclass()],c);var e}(b.declared(a)),G=q.ofType(F),N=c.getLogger("esri.webscene.Slide");return function(a){function c(b){b=a.call(this,b)||this;return b._currentAnimation=null,b.id=Date.now().toString(16)+
"-slide-"+B++,b.title=new y["default"],b.description=new x["default"],b.thumbnail=new n["default"],b.viewpoint=null,b.basemap=null,b.environment=new u,b.visibleLayers=new G,b}return h(c,a),c.prototype.castBasemap=function(a){return f.ensureType(a)},Object.defineProperty(c.prototype,"visibleLayers",{set:function(a){this._set("visibleLayers",t.referenceSetter(a,this._get("visibleLayers"),G))},enumerable:!0,configurable:!0}),c.prototype.castVisibleLayers=function(a){return a&&"function"==typeof a.map?
a.map(function(a){return"string"==typeof a?{id:a}:a.id?{id:a.id}:(N.warn('Invalid visible layer, expected { id }, Layer or "id"'),a)}):a},c.prototype.clone=function(){return new this.constructor({id:this.id,title:this.title.clone(),thumbnail:this.thumbnail.clone(),description:this.description&&this.description.clone()||null,viewpoint:this.viewpoint&&this.viewpoint.clone()||null,basemap:this.basemap&&this.basemap.clone()||null,visibleLayers:this.visibleLayers.clone(),environment:this.environment&&
this.environment.clone()||null})},c.prototype._updateVisibleLayersFrom=function(a){var b=this,c=[];return r.eachAlways(this._allLayers(a.map).map(function(b){return a.whenLayerView(b).then(function(a){a.visible&&c.push(new F({id:a.layer.id}))})}).toArray()).then(function(){b.visibleLayers.removeAll();b.visibleLayers.addMany(c)})},c.prototype.updateFrom=function(a,b){var c=this;return b=w.mixin({screenshot:w.mixin({format:"jpeg",quality:80,width:120,height:75},b&&b.screenshot)},b),a.when(function(){return c.viewpoint=
a.viewpoint.clone(),c.environment.lighting=v.prototype.clone.apply(a.environment.lighting),c.basemap=a.map.basemap&&a.map.basemap.clone()||null,c._updateVisibleLayersFrom(a)}).then(function(){return a.takeScreenshot(b.screenshot)}).then(function(a){return c.thumbnail=new n["default"]({url:a.dataURL}),c})},c.prototype.applyTo=function(a,b){var c=this,d=w.mixin({animate:!0},b);return this._applyBasemap(a).then(function(){return z([c._applyViewpoint(a,d),c._applyLayerVisibility(a,d)])}).then(function(){return c})},
c.prototype._applyBasemap=function(a){var b=this;return this.basemap?this.basemap.load().always(function(){a.map.basemap=f.clonePreservingTiledLayers(b.basemap,a.map.basemap)}):r.resolve()},c.prototype._allLayers=function(a){var b=new q;return this._collectLayers(a,b),this._collectLayers(a.ground,b),b},c.prototype._collectLayers=function(a,b){var c=this;a.layers.forEach(function(a){b.add(a);a.layers&&c._collectLayers(a,b)})},c.prototype._applyLayerVisibility=function(a,b){var c=this;if(this.visibleLayers){var d=
this._allLayers(a.map);return b.applyToLayerViews?r.eachAlways(d.map(function(b){return a.whenLayerView(b).then(function(a){a.visible=c.visibleLayers.some(function(b){return b.id===a.layer.id})})}).toArray()):(d.forEach(function(a){return a.visible=c.visibleLayers.some(function(b){return b.id===a.id})}),r.resolve())}},c.prototype._applyViewpoint=function(a,b){if(this.viewpoint){if(this.viewpoint.camera.fov=a.camera.fov,b.animate)return this.get("environment.lighting.date")?this._animateToLighting(a,
b):(a.environment.lighting=this.environment.lighting.clone(),a.goTo(this.viewpoint,b));a.viewpoint=this.viewpoint;a.environment.lighting=this.environment.lighting.clone()}return r.resolve()},c.prototype._animateToLighting=function(a,b){var c,d=this;"global"===a.viewingMode&&(c=this._animateLightingWithCamera(a));this._currentAnimation&&(this._currentAnimation.cancel(),this._currentAnimation=null);a.environment.lighting.cameraTrackingEnabled=!1;a.environment.lighting.directShadowsEnabled=this.environment.lighting.directShadowsEnabled;
null!=this.environment.lighting.displayUTCOffset&&(a.environment.lighting.displayUTCOffset=this.environment.lighting.displayUTCOffset);var e=a.goTo(this.viewpoint,b);return this._currentAnimation=e,this._currentAnimation.always(function(){c&&c.remove();d._currentAnimation===e&&(a.environment.lighting.cameraTrackingEnabled=!0)}),this._currentAnimation.then(function(){a.environment.lighting=d.environment.lighting.clone()}),this._currentAnimation},c.prototype._getTime=function(a){var b=a.getTime();a=
3600*a.getUTCHours()+60*a.getUTCMinutes()+a.getUTCSeconds();return[b,a]},c.prototype._setTime=function(a,b,c){return a.setTime(b),a.setUTCHours(c/3600),a.setUTCMinutes(c%3600/60),a.setUTCSeconds(c%3600%60),a},c.prototype._animateLightingWithCamera=function(a){var b=this,c=C.vec3d,d=this._getTime(new Date(a.environment.lighting.date.toString())),e=d[0],f=d[1],d=this._getTime(this.environment.lighting.date),g=d[0],h=d[1],k=a.renderCoordsHelper,l=[0,0,0];k.toRenderCoords(a.camera.position,l);var m=[0,
0,0];k.toRenderCoords(this.viewpoint.camera.position,m);var n=[0,0,0],q=new Date;return a.watch("camera",function(d){k.toRenderCoords(d.position,n);d=c.dist2(l,n);var p=c.dist2(m,n),r=0;0!==d+p&&(r=d/(d+p));a.environment.lighting.date=b._setTime(q,e+(g-e)*r,f+(h-f)*r)})},c.createFrom=function(a,b){return(new this).updateFrom(a,b)},c.sanitizeJSON=function(a){var b;b=void 0!==a.visibleLayers&&Array.isArray(a.visibleLayers)?e.clone(a.visibleLayers):[];b={id:a.id||"",title:a.title||{text:""},thumbnail:a.thumbnail||
{url:""},viewpoint:a.viewpoint,baseMap:a.baseMap,visibleLayers:b};return void 0!==a.description&&(b.description=a.description),void 0!==a.environment&&(b.environment=u.sanitizeJSON(a.environment)),b},d([b.property({type:String,json:{write:{isRequired:!0}}})],c.prototype,"id",void 0),d([b.property({type:y["default"],json:{write:{isRequired:!0}}})],c.prototype,"title",void 0),d([b.property({type:x["default"],json:{write:!0}})],c.prototype,"description",void 0),d([b.property({type:n["default"],json:{write:{isRequired:!0}}})],
c.prototype,"thumbnail",void 0),d([b.property({type:g,json:{write:{isRequired:!0}}})],c.prototype,"viewpoint",void 0),d([b.property({type:k,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],c.prototype,"basemap",void 0),d([b.cast("basemap")],c.prototype,"castBasemap",null),d([b.property({type:G,json:{write:{isRequired:!0}}})],c.prototype,"visibleLayers",null),d([b.cast("visibleLayers")],c.prototype,"castVisibleLayers",null),d([b.property({type:u,json:{write:!0}})],c.prototype,"environment",
void 0),c=d([b.subclass("esri.webscene.Slide")],c)}(b.declared(a))})},"esri/webscene/support/Description":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function f(){var a=null!==b&&b.apply(this,arguments)||this;return a.text="",a}return h(f,b),a=f,f.prototype.clone=function(){return new a({text:this.text})},
d([g.property({type:String,json:{write:!0}})],f.prototype,"text",void 0),f=a=d([g.subclass("esri.webscene.support.Description")],f);var a}(g.declared(b));l["default"]=m})},"esri/webscene/support/Title":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function f(){var a=null!==b&&
b.apply(this,arguments)||this;return a.text="",a}return h(f,b),a=f,f.prototype.clone=function(){return new a({text:this.text})},d([g.property({type:String,json:{write:{isRequired:!0}}})],f.prototype,"text",void 0),f=a=d([g.subclass("esri.webscene.support.Title")],f);var a}(g.declared(b));l["default"]=m})},"esri/webscene/support/Thumbnail":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function f(){var a=null!==b&&b.apply(this,arguments)||this;return a.url="",a}return h(f,b),a=f,f.prototype.clone=function(){return new a({url:this.url})},d([g.property({type:String,json:{write:{isRequired:!0}}})],f.prototype,"url",void 0),f=a=d([g.subclass("esri.webscene.support.Thumbnail")],f);var a}(g.declared(b));l["default"]=m})},"esri/webscene/InitialViewProperties":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Viewpoint ../core/Accessor ../geometry/SpatialReference ./Environment ../core/accessorSupport/decorators".split(" "),
function(m,l,h,d,b,g,k,f,a){return function(e){function c(a){a=e.call(this,a)||this;return a.environment=new f,a.spatialReference=null,a.viewpoint=null,a}return h(c,e),g=c,Object.defineProperty(c.prototype,"viewingMode",{set:function(a){"local"!==a&&"global"!==a||this._set("viewingMode",a)},enumerable:!0,configurable:!0}),c.prototype.clone=function(){return new g({environment:this.environment.clone(),spatialReference:this.spatialReference?this.spatialReference.clone():null,viewingMode:this.viewingMode,
viewpoint:this.viewpoint?this.viewpoint.clone():null})},d([a.property({type:f,json:{write:{isRequired:!0}}})],c.prototype,"environment",void 0),d([a.property({type:k})],c.prototype,"spatialReference",void 0),d([a.property()],c.prototype,"viewingMode",null),d([a.property({type:b,json:{write:{isRequired:!0}}})],c.prototype,"viewpoint",void 0),c=g=d([a.subclass("esri.webscene.InitialViewProperties")],c);var g}(a.declared(g))})},"esri/webscene/Version":function(){define(["require","exports","../core/tsSupport/extendsHelper",
"../core/Version"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(d,f){return b.call(this,d,f,"webscene")||this}return h(d,b),Object.defineProperty(d.prototype,"supportsGround",{get:function(){return this.since(1,8)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"supportsVisibleElevationLayersInSlides",{get:function(){return this.lessThan(1,8)},enumerable:!0,configurable:!0}),d}(d.Version);l.Version=m;l["default"]=m})},"esri/views/2d/layers/VectorTileLayerView2D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper dojo/has ../../../core/Logger ../../../core/accessorSupport/decorators ../../../core/HandleRegistry ../../../core/promiseUtils ../../../Graphic ./LayerView2D ../engine/StageGL ../tiling/TileInfoViewPOT ../tiling/TileStrategy ../tiling/TileKey ../tiling/TileQueue ../../../views/vectorTiles/TileHandler ../../../views/vectorTiles/VectorTileContainer ../../../views/vectorTiles/VectorTileDisplayObject ../../support/screenshotUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w){var z=g.getLogger("esri.views.2d.layers.VectorTileLayerView2D");return function(c){function g(){var a=null!==c&&c.apply(this,arguments)||this;return a._handles=new f,a._fetchQueue=null,a._tileRequests=new Map,a.container=new q,a}return h(g,c),g.prototype.hitTest=function(a,b){var c=this;return this._vectorTileContainer.hittest(a,b).then(function(a){var b=c._tileHandler.getStyleRepository().layers;if(null===a||0>a||a>=b.length)return null;a=new e({attributes:{layerId:a,
layerName:b[a].id}});return a.layer=c.layer,a})},g.prototype.update=function(a){if(this._vectorTileContainer&&this._vectorTileContainer.isInitialized){if(a.devicePixelRatio!==this._tileHandler.devicePixelRatio)return void this._start();this._fetchQueue.pause();this._fetchQueue.state=a.state;this._tileStrategy.update(a);this._fetchQueue.resume();for(var b=0,c=this._vectorTileContainer.children;b<c.length;b++)this._tileHandler.updateTile(c[b],a);this.notifyChange("updating")}},g.prototype.attach=function(){b("esri-webgl")?
this._start():z.error("WebGL is required but not supported!")},g.prototype.detach=function(){this._stop()},g.prototype.moveStart=function(){this.requestUpdate()},g.prototype.viewChange=function(){this.requestUpdate()},g.prototype.moveEnd=function(){this.requestUpdate()},g.prototype.destroy=function(){this.container.dispose();this._vectorTileContainer.destroy();this._tileHandler.destroy()},g.prototype.takeScreenshot=function(b,c){return this.container?(b=w.adjustScreenshotSettings(b,c),this.container.takeScreenshot(b)):
a.reject("Could not find an object capable of capturing screenshot!")},g.prototype.isUpdating=function(){var a=!0;return this._tileRequests.forEach(function(b){a=a&&b.isFulfilled()}),!a},g.prototype.acquireTile=function(a){var b=this,c=u.pool.acquire();c.set(a.level,a.row,a.col,a.world);a=this._tileHandler.getRefKey(c);var d=this.updateParameters.state.rotation,e=this._tileHandler.getStyleRepository(),f=n.pool.acquire(c,a,this.layer.tileInfo,e,this._tileHandler.glyphMosaic,d);a=this._fetchQueue.push(f.key).then(function(a){f.setData(a.tileData,
a.workerId,a.connection);f.once("attach",function(){return b.requestUpdate()});b._vectorTileContainer.addChild(f);b.notifyChange("updating")});return this._tileRequests.set(c.id,a),this.notifyChange("updating"),f},g.prototype.releaseTile=function(a){var b=a.key.id,c=this._tileRequests.get(b);c.isFulfilled()||c.cancel();this._tileRequests["delete"](b);this._vectorTileContainer.removeChild(a);this.requestUpdate();a.once("detach",function(){return n.pool.release(a)});this.notifyChange("updating")},g.prototype._stop=
function(){this._handles.removeAll();this._tileStrategy&&this._tileStrategy.destroy();this._vectorTileContainer&&(this._vectorTileContainer.removeAllChildren(),this.container.removeChild(this._vectorTileContainer));this._tileHandler&&this._tileHandler.stop();n.pool.prune();this._vectorTileContainer=this._tileHandler=this._tileStrategy=this._tileInfoView=null},g.prototype._start=function(){var a=this;this._stop();this._handles.add(this.watch("layer.currentStyleInfo",function(){return a.attach()}));
this._vectorTileContainer=new y;this.container.addChild(this._vectorTileContainer);this._tileInfoView=new t(this.layer.tileInfo,this.layer.fullExtent);this._tileStrategy=new r({cachePolicy:"keep",acquireTile:function(b){return a.acquireTile(b)},releaseTile:function(b){return a.releaseTile(b)},tileInfoView:this._tileInfoView});this._fetchQueue=new v({tileInfoView:this._tileInfoView,process:function(b){return a._getTileData(b)}});this._tileHandler=new x(this.layer,function(){return a.requestUpdate()},
window.devicePixelRatio||1,!0,this._tileInfoView);this._tileHandler.start().then(function(){a._vectorTileContainer.initialize(a._tileHandler.spriteMosaic,a._tileHandler.glyphMosaic,a.layer.tileInfo,a._tileInfoView);a.requestUpdate()})},g.prototype._getTileData=function(a){return this._tileHandler.getTileData(a,this.updateParameters.state.rotation)},g=d([k.subclass("esri.views.2d.layers.VectorTileLayerView2D")],g)}(k.declared(c))})},"esri/views/2d/tiling/TileInfoViewPOT":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./TileKey ./TileInfoView".split(" "),
function(m,l,h,d,b,g){return function(d){function f(){return null!==d&&d.apply(this,arguments)||this}return h(f,d),f.prototype.getTileParentId=function(a){a=b.pool.acquire(a);var d=0===a.level?null:b.getId(a.level-1,a.row>>1,a.col>>1,a.world);return b.pool.release(a),d},f.prototype.getTileIdAtParent=function(a,d){d=b.pool.acquire(d);var c=this._infoByLevel[d.level];if(a.resolution<c.resolution)throw b.pool.release(d),Error("Cannot calculate parent tile. destination LOD's resolution "+a.resolution+
" is not a parent resolution of "+c.resolution);if(a.resolution===c.resolution)return a=d.id,b.pool.release(d),a;c=d.level-a.level;if(0>c)throw b.pool.release(d),Error("Wrong way...!");a=b.getId(a.level,d.row>>c,d.col>>c,d.world);return b.pool.release(d),a},f}(g)})},"esri/views/vectorTiles/VectorTileContainer":function(){define("require exports ../../core/tsSupport/extendsHelper dojo/has ../../core/promiseUtils ../../core/libs/gl-matrix/vec3 ../../core/libs/gl-matrix/mat4 ../2d/engine/Container ./renderers/Renderer ./GeometryUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e){return function(c){function f(){var a=c.call(this)||this;return a.isInitialized=!1,a._displayWidth=0,a._displayHeight=0,a._pointToCallbacks=new Map,a._tileCoordinateScale=g.create(),a._orientationVec=g.create(),a._displayScale=g.create(),a._orientationVec.set([0,0,1]),a._defaultTransform=k.create(),a}return h(f,c),f.prototype.initialize=function(b,c,d,e){this._renderer=new a;this._renderer.initialize(b,c);this._tileInfoView=e;this._tileInfo=d;this.isInitialized=!0},f.prototype.destroy=
function(){this._renderer&&(this._renderer.dispose(),this._renderer=null)},f.prototype.hittest=function(a,c){var d=this,e=[a,c];return b.create(function(a,b){d._pointToCallbacks.set(e,{resolve:a,reject:b});d.requestRender()},function(){d._pointToCallbacks.has(e)&&d._pointToCallbacks["delete"](e)})},f.prototype.prepareChildrenRenderParameters=function(a){var b=a.state;return b&&this._tileInfo&&this.isInitialized?(a.displayLevel=this._tileInfo.scaleToZoom(b.scale),a.requiredLevel=this._tileInfoView.getClosestInfoForScale(b.scale).level,
a.renderer=this._renderer,a):a},f.prototype.renderChildren=function(a){var b=this;if(0!==this.children.length&&this.isInitialized&&a&&a.state){this.sortChildren(function(a,b){return a.key.level-b.key.level});for(var e=this.children.length,f=1;e>=f;f++){var g=this.children[f-1];g.attached&&(g.stencilData.reference=f,g.stencilData.mask=255)}this._updateTilesTransform(a.state,this._tileInfoView.getClosestInfoForScale(a.state.scale).level,this.children);e=a.context;if(e.setDepthWriteEnabled(!0),this._renderer.setStateParams(a.state,
a.devicePixelRatio,a.displayLevel),this._renderer.drawClippingMasks(e,this.children),e.setStencilWriteMask(0),e.setBlendFunctionSeparate(1,771,1,771),e.setStencilOp(7680,7680,7681),e.setDepthFunction(515),e.setBlendingEnabled(!1),e.setStencilTestEnabled(!0),e.setDepthTestEnabled(!0),e.setDepthWriteEnabled(!0),a.drawphase=0,c.prototype.renderChildren.call(this,a),e.setDepthWriteEnabled(!1),e.setBlendingEnabled(!0),a.drawphase=1,c.prototype.renderChildren.call(this,a),a.drawphase=2,c.prototype.renderChildren.call(this,
a),e.setStencilTestEnabled(!1),e.setDepthTestEnabled(!1),d("esri-vector-tiles-debug"))for(f=0,g=this.children;f<g.length;f++){var h=g[f];h.attached&&h.visible&&this._renderer.renderTileInfo(e,h)}0<this._pointToCallbacks.size&&(this._pointToCallbacks.forEach(function(c,d){c.resolve(b._hitTest(a,d[0],d[1]))}),this._pointToCallbacks.clear());this._renderer.needsRedraw()&&this.requestRender()}},f.prototype.removeAllChildren=function(){for(var a=0;a<this.children.length;a++)this.children[a].dispose();
c.prototype.removeAllChildren.call(this)},f.prototype._hitTest=function(a,b,c){var d=this._tileInfoView.getClosestInfoForScale(a.state.scale).level,e=[0,0];a.state.toMap(e,[b,c]);var f=a.state.clone(),g=f.viewpoint.clone(),h=g.targetGeometry;h.x=e[0];h.y=e[1];g.targetGeometry=h;f.viewpoint=g;f.size=[3,3];this._renderer.setStateParams(f,a.devicePixelRatio,a.displayLevel);return(a=this._renderer.hitTest({budget:a.budget,devicePixelRatio:a.devicePixelRatio,stationary:a.stationary,opacity:a.opacity,context:a.context,
displayLevel:a.displayLevel,requiredLevel:a.requiredLevel,renderer:a.renderer,layerOpacity:a.layerOpacity,state:f,drawphase:3},b,c,this.children,d,3,this._updateTilesTransform.bind(this)))&&0!==a.length?a[0]:null},f.prototype._updateTilesTransform=function(a,b,c){var d=1/a.width,e=1/a.height,f=[0,0];this._calculateRelativeViewProjMat(this._tileInfo.lodAt(b).resolution,a.resolution,a.rotation,this._tileInfo.size[1],4096,a.width,a.height,this._defaultTransform);for(var g=0;g<c.length;g++){var h=c[g];
a.toScreen(f,h.coords);f[1]=a.height-f[1];h.tileTransform.displayCoord[0]=2*f[0]*d-1;h.tileTransform.displayCoord[1]=2*f[1]*e-1;h.key.level===b&&4096===h.coordRange?h.tileTransform.transform.set(this._defaultTransform):this._calculateRelativeViewProjMat(this._tileInfo.lodAt(h.key.level).resolution,a.resolution,a.rotation,this._tileInfo.size[1],h.coordRange,a.width,a.height,h.tileTransform.transform)}},f.prototype._calculateRelativeViewProjMat=function(a,b,c,d,f,g,h,l){var m=.125;512!==d&&4096!==f&&
(m=d/f);a=a/b*m;this._tileCoordinateScale.set([a,a,1]);(g!==this._displayWidth||h!==this._displayHeight)&&(this._displayScale.set([2/g,-2/h,1]),this._displayWidth=g,this._displayHeight=h);k.identity(l);k.scale(l,l,this._tileCoordinateScale);k.rotate(l,l,-c*e.C_DEG_TO_RAD,this._orientationVec);k.scale(l,l,this._displayScale);k.transpose(l,l)},f}(f)})},"esri/views/2d/layers/support/FeatureLayerView2DWebGL":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/accessorSupport/decorators ../../../../core/HandleRegistry ../../../../core/promiseUtils ../../../../core/Logger ../../../../Graphic ../../../../layers/support/TileInfo ../../../../renderers/support/diffUtils ../../engine/StageGL ../../engine/webgl/rendererInfoUtils ../../engine/webgl/visualVariablesUtils ../../engine/webgl/TileHandler ../../engine/webgl/WGLTile ../../engine/webgl/WGLFeatureView ../../tiling/TileQueue ../../tiling/TileInfoView ../../tiling/TileStrategy ../LayerView2D".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u,v,x,y,n,w,z,C){var B=a.getLogger("esri.views.2d.layers.FeatureLayerView2D");return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b._tileRequests=new Map,b._hasVV=!1,b._handles=new k,b._wglFeatureView=new y(512,512,b),b.container=new t,b}return h(b,a),b.prototype.initialize=function(){this._tileHandler=new v(this,this._wglFeatureView,512,512,1,1);this.addResolvingPromise(this._tileHandler.start())},b.prototype.destroy=function(){this._tileHandler.stop();
this._tileHandler=null},Object.defineProperty(b.prototype,"numFeatures",{get:function(){var a=0;return this.attached?this._tileStrategy.tiles.forEach(function(b){a+=b.iconDisplayRecords?b.iconDisplayRecords.length:0}):0,a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"visualVariablesInfo",{get:function(){return this._visualVariablesInfo},enumerable:!0,configurable:!0}),b.prototype.highlight=function(a){var b=this._wglFeatureView;return b.addHighlight(a),{remove:function(){b.removeHighlight(a)}}},
b.prototype.hitTest=function(a,b){var c=this;return this.suspended?f.resolve(null):this._wglFeatureView.hitTest(a,b).then(function(a){return 0===a.length?null:c._tileHandler.getFeatures(a).then(function(a){if(0===a.features.length)return null;a=e.fromJSON(a.features[0]);return a.layer=c.layer,a.geometry.spatialReference=c.view.spatialReference,a})})},b.prototype.update=function(a){this._configurationPromise||this._fetchQueue&&(this._fetchQueue.pause(),this._fetchQueue.state=a.state,this._tileStrategy.update(a),
this._fetchQueue.resume(),this.notifyChange("numFeatures"),this.notifyChange("updating"))},b.prototype.attach=function(){var a=this,b=this._tileInfo=c.create({spatialReference:this.view.spatialReference,size:512});this._tileInfoView=new w(b);this._wglFeatureView.highlightOptions=this.view.highlightOptions;this._wglFeatureView.initialize(this._tileInfoView);this._configure(this.layer.renderer);this._normalizedRenderer=r.getNormalizedRenderer(this.layer.renderer,this.view.spatialReference);this._visualVariablesInfo=
u.convertVisualVariables(this._normalizedRenderer.visualVariables);this._handles.add(this.layer.watch("renderer",function(b){return a._rendererChangeHhandler(b)}));this._handles.add(this.layer.watch("definitionExpression, processing, outFields",function(b,c,d){"outFields"!==d?a.refresh():b.sort().join()!==c.sort().join()&&a.refresh()}))},b.prototype.detach=function(){this.container.removeChild(this._wglFeatureView);this._tileHandler.stop();this._tileStrategy.destroy();this._tileStrategy=null;this._handles.removeAll()},
b.prototype.moveStart=function(){this.requestUpdate()},b.prototype.viewChange=function(){this.requestUpdate()},b.prototype.moveEnd=function(){this.requestUpdate()},b.prototype.isUpdating=function(){return this._fetchQueue&&0!==this._fetchQueue.length},b.prototype.refresh=function(){var a=this;this._configure(this.layer.renderer).then(function(){a._fetchQueue.resume();a._wglFeatureView.requestRender();a.requestUpdate()})},b.prototype.acquireTile=function(a){var b=this,c=this._tileInfoView.getTileBounds([0,
0,0,0],a),d=x.pool.acquire(a,c,512,512,512);a=this._fetchQueue.push(d.key).then(function(a){a&&d.setData(a,b._hasVV,!1);b._wglFeatureView.addChild(d);d.once("attach",function(){b.notifyChange("updating");b.requestUpdate()});b.notifyChange("updating")}).otherwise(function(a){"cancel"!==a.dojoType&&B.error("query-error",a)});return this._tileRequests.set(d.key.id,a),this.notifyChange("updating"),d},b.prototype.releaseTile=function(a){var b=this,c=a.key.id,d=this._tileRequests.get(c);d&&(d.isFulfilled()||
d.cancel(),this._tileRequests["delete"](c),this._wglFeatureView.removeChild(a),this.requestUpdate(),a.once("detach",function(){b._tileHandler.removeTile(a.key);x.pool.release(a)}),this.notifyChange("updating"))},b.prototype._configure=function(a){var b=this;return this._configurationPromise&&(this._configurationPromise.cancel(),this._configurationPromise=null),this._fetchQueue&&(this._fetchQueue.pause(),this._fetchQueue.clear(),this._tileStrategy.clear()),this._configurationPromise=this._tileHandler.configure(this.layer.renderer,
this.layer.processing).then(function(){b._fetchQueue||(b._fetchQueue=new n({tileInfoView:b._tileInfoView,concurrency:50,process:function(a){return b._tileHandler.registerTile(a)}}),b._tileStrategy=new z({cachePolicy:"purge",acquireTile:function(a){return b.acquireTile(a)},releaseTile:function(a){return b.releaseTile(a)},tileInfoView:b._tileInfoView}),b.container.addChild(b._wglFeatureView));b.requestUpdate()}).always(function(){b._configurationPromise=null}),this._configurationPromise},b.prototype._applyRendererDiff=
function(a,b){var c;a:{for(c in a.diff){var d=a.diff[c];if("collection"===d.type){if(0!==d.changed.length||0!==d.added.length||0!==d.removed.length){c=!0;break a}}else if("visualVariables"!==c&&"authoringInfo"!==c){c=!0;break a}}c=!1}if(c)return!1;if(a.diff.visualVariables){a=b.vvRanges;b=q.diff(this._visualVariablesInfo.vvFields,b.vvFields);if(this._visualVariablesInfo.vvRanges=a,b)return!1;this._wglFeatureView.requestRender()}return!0},b.prototype._rendererChangeHhandler=function(a){a=r.getNormalizedRenderer(a,
this.view.spatialReference);var b=q.diff(this._normalizedRenderer,a);if(b)if("complete"===b.type)this._normalizedRenderer=a,this._visualVariablesInfo=u.convertVisualVariables(a.visualVariables),this.refresh();else if("partial"===b.type){var c=u.convertVisualVariables(a.visualVariables);this._applyRendererDiff(b,c)||(this._normalizedRenderer=a,this._visualVariablesInfo=c,this.refresh())}},d([g.property()],b.prototype,"numFeatures",null),b=d([g.subclass("esri.views.2d.layers.FeatureLayerView2DWebGL")],
b)}(g.declared(C))})},"esri/views/2d/engine/webgl/rendererInfoUtils":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../support/arcadeUtils ../../../../arcade/Feature ./visualVariablesUtils".split(" "),function(m,l,h,d,b,g){function k(a,e){if(!a)return null;var c=0,g={};a=a.clone();var k=a.valueExpression,l=a.visualVariables,m=null;if(!a.field&&k){f||(f=new b(null));var v="$$fake"+c++,x=d.createFunction(k);g[v]=function(a,b){return f.attributes=a.attributes,d.executeFunction(x,
{vars:{$feature:f,$view:d.getViewInfo(b)},spatialReference:e})};a.field=v;a.valueExpression=null;m=function(a,b){return b.attributes[v]=g[v](b),a.getSymbol(b)}}return l&&(a.visualVariables=l.map(function(a){if(a.normalizationField){var k=a.field,l=a.normalizationField,m="$$fake"+c++;g[m]=function(a,b){return a.attributes[k]/a.attributes[l]};a=h({},a);return a.field=m,delete a.normalizationField,a}if(a.valueExpression&&"$view.scale"!==a.valueExpression){var q=a.valueExpression,m="$$fake"+c++,r=d.createFunction(q);
f||(f=new b(null));g[m]=function(a,b){return f.attributes=a.attributes,d.executeFunction(r,{vars:{$feature:f,$view:d.getViewInfo(b)},spatialReference:e})};a=h({},a);return a.field=m,delete a.valueExpression,a}return a})),{renderer:a,normalizingFunctions:g,getSymbolFunction:m}}Object.defineProperty(l,"__esModule",{value:!0});var f;l.createRendererInfo=function(a,b){var c=(b=k(a,b)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},b.normalizingFunctions),d=b&&b.getSymbolFunction;a=b&&
b.renderer||a;b=null;if("heatmap"===a.type){var e=a.offset;b=9*Math.round(a.blurRadius)+1;b={getIntensity:function(a){return"function"==typeof a?a:a?"abs"===e?function(b){return Math.abs(b.attributes[a])}:function(b){return b.attributes[a]+e}:function(a){return 1}}(a.field),kernelSize:b,radius:a.blurRadius}}var f=g.convertVisualVariables(a.visualVariables);return{renderer:a,vvFields:f.vvFields,vvRanges:f.vvRanges,heatmapInfo:b,getValue:function(a,b){var d=c[b];return d?d(a):a.attributes[b]},getSymbol:function(a){return d?
d(this.renderer,a):this.renderer.getSymbol?this.renderer.getSymbol(a):null}}};l.getNormalizedRenderer=function(a,b){return(b=k(a,b)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},b.renderer)||a};l.getSymbol=function(a,b){return a.getSymbol(b)}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/screenUtils ../../../3d/layers/support/FastSymbolUpdates ./Utils ./enums".split(" "),function(m,l,h,d,b,g){function k(a){return b.isNumber(a.minDataValue)&&
b.isNumber(a.maxDataValue)&&null!=a.minSize&&null!=a.maxSize?g.WGLVVFlag.SIZE_MINMAX_VALUE:(a.expression&&"view.scale"===a.expression||a.valueExpression&&"$view.scale"===a.valueExpression)&&Array.isArray(a.stops)?g.WGLVVFlag.SIZE_SCALE_STOPS:(null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&Array.isArray(a.stops)?g.WGLVVFlag.SIZE_FIELD_STOPS:(null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==
a.valueExpression)&&null!=a.valueUnit?g.WGLVVFlag.SIZE_UNIT_VALUE:g.WGLVVFlag.NONE}function f(a){return{value:a.value,size:h.toPt(a.size)}}function a(a){return a.map(function(a){return f(a)})}function e(b){return"string"==typeof b||"number"==typeof b?h.toPt(b):{type:"size",expression:b.expression,stops:a(b.stops)}}function c(a){var c={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(b.isString(a.field))if(a.stops){if(8<a.stops.length)return null;a=a.stops;for(var d=0;8>d;++d){var e=a[Math.min(d,
a.length-1)];c.values[d]=e.value;c.opacities[d]=e.opacity}}else{if(!a.opacityValues||!b.isDefined(a.minDataValue)||!b.isDefined(a.maxDataValue)||2!==a.opacityValues.length)return null;c.values[0]=a.minDataValue;c.opacities[0]=a.opacityValues[0];c.values[1]=a.maxDataValue;c.opacities[1]=a.opacityValues[1];for(d=2;8>d;++d)c.values[d]=a.maxDataValue,c.opacities[d]=a.opacityValues[1]}else{if(!(a.stops&&0<=a.stops.length||a.opacityValues&&0<=a.opacityValues.length))return null;a=a.stops&&0<=a.stops.length?
a.stops[0].opacity:a.opacityValues[0];for(d=0;8>d;d++)c.values[d]=1/0,c.opacities[d]=a}return c}Object.defineProperty(l,"__esModule",{value:!0});l.getTypeOfSizeVisualVariable=k;l.getVisualVariableSizeValueRepresentationRatio=function(a,b){if(!a||!b)return a;switch(b){case "radius":case "distance":return 2*a;case "area":return Math.sqrt(a)}return a};l.stopToSizeStop=f;l.normalizeSizeStops=a;l.normalizeSizeElement=e;l.getVisualVariablesFields=function(a){var b=a&&0<a.length?{}:null;return b&&a.forEach(function(a){var c=
a.type;a.field&&(b[c]=a.field)}),b};l.convertVisualVariables=function(f){var l=f&&0<f.length?{}:null,m=l?{}:null;return l&&f.forEach(function(f){var q=f.type;if(f.field&&(l[q]=f.field),"size"===q)switch(m.size||(m.size={}),k(f)){case g.WGLVVFlag.SIZE_MINMAX_VALUE:m.size.minMaxValue={minDataValue:f.minDataValue,maxDataValue:f.maxDataValue,minSize:e(f.minSize),maxSize:e(f.maxSize)};break;case g.WGLVVFlag.SIZE_SCALE_STOPS:m.size.scaleStops={stops:a(f.stops)};break;case g.WGLVVFlag.SIZE_FIELD_STOPS:var q=
[],r=[];f=a(f.stops);for(var t=f.length,n=0;6>n;n++){var u=f[Math.min(n,t-1)];q.push(u.value);r.push(h.pt2px(u.size))}m.size.fieldStops={values:q,sizes:r};break;case g.WGLVVFlag.SIZE_UNIT_VALUE:m.size.unitValue={unit:f.valueUnit,valueRepresentation:f.valueRepresentation}}else if("color"===q)for(q=d.convertVisualVariables([f],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null}),m.color=q.color,n=0;32>n;n+=4)b.premultiplyAlpha(m.color.colors,n,!0);else"opacity"===q?m.opacity=c(f):"rotation"===
q&&(m.rotation={type:f.rotationType})}),{vvFields:l,vvRanges:m}}})},"esri/views/2d/engine/webgl/TileHandler":function(){define("require exports module ../../../../core/Error ../../../../core/promiseUtils ../../../../core/promiseUtils ../../../../core/kebabDictionary ../../../../core/workers/workers ../../../../core/requireUtils ../../../../tasks/QueryTask ../../../../tasks/support/Query ./TileData".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q){var t=k({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",
esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});return function(){function k(a,b,c,d,e,f){this._parent=a;this._tilecoordRange=d;this._tileCoordRatio=e;this._quantizationFactor=f;this._wglFeatureView=b}return k.prototype.start=function(){var b=this;return f.open(this,a.getAbsMid("./WorkerTileHandler",m,h),!0).then(function(a){b._connection=a})},k.prototype.configure=function(a,b){var c=this._parent.layer;this._queryTask=new e(c.parsedUrl.path);this._returnCentroid=
this._getReturnCentroid(c.renderer);var d=c.createQuery();return this._connection.invoke("configure",{renderer:a.toJSON(),spatialReference:this._parent.view.spatialReference.toJSON(),capabilities:c.capabilities,url:c.parsedUrl.path,geometryType:t.toJSON(c.geometryType),query:d.toJSON(),outFields:d.outFields,objectIdField:c.objectIdField,tileCoordRange:this._tilecoordRange,tileCoordRatio:this._tileCoordRatio,returnCentroid:this._returnCentroid,quantizationFactor:this._quantizationFactor,pixelRatio:window.devicePixelRatio||
1,processing:b&&b.toWorker()||null,queryInMainThread:!0})},k.prototype.stop=function(){this._connection&&(this._connection.close(),this._connection=null)},k.prototype.registerTile=function(a){return this._connection.invoke("registerTile",{key:a.id}).then(function(a){return a&&a.displayData&&a.bufferData?q.deserialize(a):null})},k.prototype.removeTile=function(a){this._connection.invoke("unregisterTile",{key:a.id})},k.prototype.getFeatures=function(a){return this._connection.invoke("getFeatures",{featureIds:a})},
k.prototype.getMaterialItems=function(a){(a=a.items)&&0!==a.length||b.resolve({data:{items:[]},buffers:[]});var c=this._wglFeatureView.textureManager,d=[];return a.forEach(function(a){d.push(c.rasterizeItem(a.symbol,a.glyphIds))}),g.all(d).then(function(a){return{data:{items:a.map(function(a,b){return{id:b,mosaicItem:a}})},buffers:[]}})},k.prototype.executeProcessing=function(a){var e=this;return b.resolve().then(function(){var f=e._parent.layer.processing;return f?(f=f.process(JSON.parse(a.featureSet),
c.fromJSON(a.query),f.options))?f:b.reject(new d("FeatureLayer","invalid processing.process() method, returns nothing")):b.resolve({data:a.featureSet})}).then(function(a){return{data:{featureSet:JSON.stringify(a)},buffers:[]}})},k.prototype.queryFeatures=function(a){var e=this,f=c.fromJSON(a.query);a=this._queryTask;var g=this._parent.layer,h=g.source&&"esri.layers.graphics.sources.CSVSource"===g.source.declaredClass;f.returnGeometry=!this._returnCentroid||g.renderer.backgroundFillSymbol;f.returnJSON=
!0;f.returnCentroid=this._returnCentroid;return(h?g.source.queryFeaturesJSON(f):a.rawExecute(f).then(function(a){return a.data})).then(function(a){var c=e._parent.layer.processing;return c?(a=c.process(a,f,c.options))?a:b.reject(new d("FeatureLayer","invalid processing.process() method, returns nothing")):a}).then(function(a){return{data:{featureSet:JSON.stringify(a)},buffers:[]}})},k.prototype._getReturnCentroid=function(a){function b(a){if(!a)return!1;a=a.type;return"simple-marker"===a||"picture-marker"===
a||"text"===a}if("polygon"!==this._parent.layer.geometryType)return!1;switch(a.type){case "simple":return b(a.symbol);case "unique-value":return b(a.defaultSymbol)||a.uniqueValueInfos.some(function(a){return b(a.symbol)});case "class-breaks":return b(a.defaultSymbol)||a.classBreakInfos.some(function(a){return b(a.symbol)});default:return!0}},k}()})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ../../../../core/ObjectPool ./TileDisplayData ./TileBufferData ./WGLDisplayRecord ./enums".split(" "),
function(m,l,h,d,b,g,k){return function(){function f(){this.tileBufferData=this.tileDisplayData=null}return f.prototype.release=function(){d.pool.release(this.tileDisplayData);this.tileDisplayData=null;b.pool.release(this.tileBufferData);this.tileBufferData=null},f.prototype.serialize=function(){var a=this.tileBufferData.serialize(),b=this.tileBufferData.getBuffers(),c=d.serialize(this.tileDisplayData,null,0),c=new Uint8Array(c);d.serialize(this.tileDisplayData,c,0);b.push(c.buffer);return{data:{displayData:c.buffer,
bufferData:a},buffers:b}},f.deserialize=function(a){var e=d.pool.acquire();d.deserialize(e,new Uint8Array(a.displayData),0);a=b.deserialize(a.bufferData);var c=new f;return c.tileDisplayData=e,c.tileBufferData=a,c},f.prototype.deserializeMeshData=function(){var a=this;this.tileDisplayData.displayObjectRegistry.forEach(function(b,c){b=0;for(c=a.tileDisplayData.displayObjectRegistry.get(c).displayRecords;b<c.length;b++){var d=c[b],e=d.geometryType;d.readMeshDataFromBuffers(a.tileBufferData.geometries[e].vertexBuffer,
a.tileBufferData.geometries[e].indexBuffer)}})},f.bind=function(a,b){var c=new f;return c.tileDisplayData=a,c.tileBufferData=b,c},f.create=function(a,e){var c=new f;c.tileDisplayData=new d;for(var h=[0,0,0,0],l=[0,0,0,0],m=0;m<a.length;m++){var u=a[m];c.tileDisplayData.displayObjects.push(u);c.tileDisplayData.displayObjectRegistry.set(u.id,u);for(var v=0,u=u.displayRecords;v<u.length;v++){var x=u[v];c.tileDisplayData.displayRecords[x.geometryType].push(x);h[x.geometryType]+=x.meshData.vertexCount;
l[x.geometryType]+=x.meshData.indexData.length}}m=function(a,b){return a.sortKey-b.sortKey};for(a=0;a<c.tileDisplayData.displayRecords.length;a++)c.tileDisplayData.displayRecords[a].sort(m);m=[e.fill||{},e.line||{},e.icon||{},e.text||{}];v=new b;for(a=0;4>a;a++){v.geometries[a].indexBuffer=new Uint32Array(l[a]);v.geometries[a].vertexBuffer={};e=m[a];for(var y in e)v.geometries[a].vertexBuffer[y]={data:new Uint32Array(h[a]*e[y]/4),stride:e[y]}}c.tileBufferData=v;(h=c.tileBufferData.geometries[k.WGLGeometryType.FILL])&&
g.writeAllMeshDataToBuffers(c.tileDisplayData.displayRecords[k.WGLGeometryType.FILL],h.vertexBuffer,h.indexBuffer);(h=c.tileBufferData.geometries[k.WGLGeometryType.LINE])&&g.writeAllMeshDataToBuffers(c.tileDisplayData.displayRecords[k.WGLGeometryType.LINE],h.vertexBuffer,h.indexBuffer);(h=c.tileBufferData.geometries[k.WGLGeometryType.MARKER])&&g.writeAllMeshDataToBuffers(c.tileDisplayData.displayRecords[k.WGLGeometryType.MARKER],h.vertexBuffer,h.indexBuffer);h=c.tileBufferData.geometries[k.WGLGeometryType.TEXT];
return h&&g.writeAllMeshDataToBuffers(c.tileDisplayData.displayRecords[k.WGLGeometryType.TEXT],h.vertexBuffer,h.indexBuffer),c.tileDisplayData.displayList.addToList(c.tileDisplayData.displayRecords[k.WGLGeometryType.FILL]),c.tileDisplayData.displayList.addToList(c.tileDisplayData.displayRecords[k.WGLGeometryType.LINE]),c.tileDisplayData.displayList.addToList(c.tileDisplayData.displayRecords[k.WGLGeometryType.MARKER]),c.tileDisplayData.displayList.addToList(c.tileDisplayData.displayRecords[k.WGLGeometryType.TEXT]),
c},f.pool=new h(f),f}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define("require exports ../../../../core/ObjectPool ./WGLDisplayObject ./WGLDisplayRecord ./WGLDisplayList ./enums ./Utils".split(" "),function(m,l,h,d,b,g,k,f){function a(a,c,d,e){a=a[c];c=0;c+=f.serializeInteger(a.length,d,e+c);for(var g=0;g<a.length;g++)c+=b.serialize(a[g],d,e+c,!1);return c}function e(a,d,e,g){a=a[d];var h=0,h=h+f.deserializeInteger(c,e,g+h);a.length=c.n;for(var k=0;k<c.n;++k)h+=b.deserialize(q,
e,g+h,!1),a[k]=q.displayRecord,a[k].geometryType=d;return h}var c={n:void 0},q={displayRecord:null},t={n:void 0},r={n:void 0},u={n:void 0};return function(){function b(){this.displayList=new g;this.displayRecords=[[],[],[],[]];this.displayObjects=[];this.displayObjectRegistry=new Map}return b.prototype.release=function(){},b.serialize=function(b,c,d){var e=b.displayRecords,h=b.displayObjects,l=0,l=l+g.serialize(b.displayList,c,d+l),l=l+a(e,k.WGLGeometryType.FILL,c,d+l),l=l+a(e,k.WGLGeometryType.LINE,
c,d+l),l=l+a(e,k.WGLGeometryType.MARKER,c,d+l);b=l+=a(e,k.WGLGeometryType.TEXT,c,d+l);d+=l;for(var l=0,l=l+f.serializeInteger(h.length,c,d+l),m=new Map,n=0,q=e.length;q>n;n++)for(var r=e[n],t=0,u=r.length;u>t;t++)m.set(r[t],t);n=0;for(q=h.length;q>n;n++)for(e=h[n],r=e.displayRecords,l+=f.serializeInteger(e.id,c,d+l),l+=f.serializeInteger(r.length,c,d+l),t=0,u=r.length;u>t;t++)e=r[t],m.has(e)&&(c&&(c[d+l]=e.geometryType),++l,l+=f.serializeInteger(m.get(e),c,d+l));return l=b+l},b.deserialize=function(a,
b,c){var h=0;a.displayList=g.pool.acquire();var h=h+g.deserialize(a.displayList,b,c+h),h=h+e(a.displayRecords,k.WGLGeometryType.FILL,b,c+h),h=h+e(a.displayRecords,k.WGLGeometryType.LINE,b,c+h),h=h+e(a.displayRecords,k.WGLGeometryType.MARKER,b,c+h),l=h+=e(a.displayRecords,k.WGLGeometryType.TEXT,b,c+h);c+=h;var h=a.displayObjects,m=a.displayObjectRegistry;a=a.displayRecords;var n=0;m.clear();for(var q={n:void 0},n=n+f.deserializeInteger(q,b,c+n),v=0;v<q.n;++v){var n=n+f.deserializeInteger(t,b,c+n),
n=n+f.deserializeInteger(r,b,c+n),x=d.pool.acquire();h.push(x);x.id=t.n;for(var y=0;y<r.n;++y){var R=void 0;n&&(R=b[c+n]);++n;n+=f.deserializeInteger(u,b,c+n);R=a[R][u.n];R.id=x.id;x.displayRecords[y]=R}m.set(x.id,x)}return h=l+n},b.pool=new h(b),b}()})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","../../../../core/ObjectPool","./WGLDisplayRecord","./Utils"],function(m,l,h,d,b){return function(){function g(){this.displayRecords=[]}return g.prototype.acquire=
function(b){this.id=b},g.prototype.release=function(){this.id=void 0;this.displayRecords.length=0},g.serialize=function(g,f,a){var e=0,e=e+b.serializeInteger(g.id,f,a+e),e=e+b.serializeInteger(g.displayRecords.length,f,a+e),c=0;for(g=g.displayRecords;c<g.length;c++)e+=d.serialize(g[c],f,a+e,!0);return e},g.deserialize=function(h,f,a){var e=0,c={n:0},e=e+b.deserializeInteger(c,f,a+e),k={n:0},e=e+b.deserializeInteger(k,f,a+e),l={displayRecord:void 0};h.displayObject=g.pool.acquire();h.displayObject.id=
c.n;h.displayObject.displayRecords.length=k.n;for(var m=0;m<k.n;++m)e+=d.deserialize(l,f,a+e,!0),h.displayObject.displayRecords[m]=l.displayRecord,h.displayObject.displayRecords[m].id=c.n;return e},g.pool=new h(g),g}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define("require exports ../../../../core/ObjectPool ./MeshData ./MaterialInfo ./enums ./Utils".split(" "),function(m,l,h,d,b,g,k){return function(){function f(){this.id=-1;this.geometryType=g.WGLGeometryType.UNKNOWN;this.materialInfo=
this.meshData=null;this.sortKey=this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}return f.prototype.acquire=function(a,b,c,d,f,g){this.setData(a,b,c,d,f,g)},f.prototype.release=function(){this.id=-1;this.geometryType=g.WGLGeometryType.UNKNOWN;this.materialInfo=this.meshData=null;this.sortKey=this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0},f.prototype.setData=function(a,b,c,d,f,g){this.id=a;this.geometryType=
b;this.meshData=c;this.materialInfo=d;this.symbolLevel=f;this.zOrder=g;this._computeSortKey()},f.prototype.readMeshDataFromBuffers=function(a,b){this.meshData?this.meshData.clear():this.meshData=d.pool.acquire();for(var c in a){for(var e=a[c].stride,f=a[c].data,g=[],h=0;h<e*this.vertexCount/4;++h)g[h]=f[h+e*this.vertexFrom/4];this.meshData.vertexData.set(c,g)}for(h=this.meshData.indexData.length=0;h<this.indexCount;++h)this.meshData.indexData[h]=b[h+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=
this.vertexCount},f.prototype.writeMeshDataToBuffers=function(a,b,c,d){for(var e in b)for(var f=b[e].stride,g=this.meshData.vertexData.get(e),h=b[e].data,k=0;k<f*this.meshData.vertexCount/4;++k)h[k+f*a/4]=g[k];for(k=0;k<this.meshData.indexData.length;++k)d[k+c]=this.meshData.indexData[k]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=c;this.indexCount=this.meshData.indexData.length},f.writeAllMeshDataToBuffers=function(a,b,c){for(var d=0,e=0,f=0;f<a.length;f++){var g=
a[f];g.writeMeshDataToBuffers(d,b,e,c);d+=g.vertexCount;e+=g.indexCount}},f.prototype._computeSortKey=function(){this.sortKey=(31&this.symbolLevel)<<12|(127&this.zOrder)<<4|7&this.geometryType},f.serialize=function(a,d,c,f){var e=0;return f&&(d&&(d[c+e]=a.geometryType),++e),e+=b.serialize(a.materialInfo,d,c+e),d&&(d[c+e]=a.symbolLevel),++e,d&&(d[c+e]=a.zOrder),++e,e+=k.serializeInteger(a.vertexFrom,d,c+e),e+=k.serializeInteger(a.vertexCount,d,c+e),e+=k.serializeInteger(a.indexFrom,d,c+e),e+=k.serializeInteger(a.indexCount,
d,c+e)},f.deserialize=function(a,d,c,g){var e=0;a.displayRecord=f.pool.acquire();a.displayRecord.id=-1;g&&(a.displayRecord.geometryType=d[c+e],++e);a.displayRecord.meshData=null;g={materialInfo:null};e+=b.deserialize(g,d,c+e);a.displayRecord.materialInfo=g.materialInfo;a.displayRecord.symbolLevel=d[c+e];++e;a.displayRecord.zOrder=d[c+e];++e;g={n:void 0};return e+=k.deserializeInteger(g,d,c+e),a.displayRecord.vertexFrom=g.n,e+=k.deserializeInteger(g,d,c+e),a.displayRecord.vertexCount=g.n,e+=k.deserializeInteger(g,
d,c+e),a.displayRecord.indexFrom=g.n,e+=k.deserializeInteger(g,d,c+e),a.displayRecord.indexCount=g.n,a.displayRecord._computeSortKey(),e},f.pool=new h(f),f}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports","../../../../core/ObjectPool"],function(m,l,h){return function(){function d(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}return d.prototype.release=function(){this.clear()},d.prototype.clear=function(){this.vertexData.clear();this.vertexCount=0;
this.indexData=[]},d.prototype.update=function(b,d,h){for(var f in b)this.vertexData.set(f,b[f]);for(f in this.vertexData)null===b[f]&&this.vertexData["delete"](f);this.vertexCount=d;this.indexData=h},d.pool=new h(d),d}()})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define("require exports ../../../../core/ObjectPool ./enums ./MaterialInfo ./Utils".split(" "),function(m,l,h,d,b,g){m=function(){function c(){this.symbolLevels=[]}return c.prototype.release=function(){this.symbolLevels.forEach(function(a){e.pool.release(a)});
this.symbolLevels.length=0},Object.defineProperty(c.prototype,"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0}),c.prototype.addToList=function(a){var b=this;a.forEach(function(a){b._addToList(a)})},c.prototype.removeFromList=function(a){var b=this;a.forEach(function(a){b._removeFromList(a)})},c.prototype._addToList=function(a){var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=0<b.length?b[b.length-1]:null;null!==c&&g.isSameMaterialInfo(c.materialInfo,
a.materialInfo)&&c.indexFrom+c.indexCount===a.indexFrom?c.indexCount+=a.indexCount:(c=k.pool.acquire(),c.indexFrom=a.indexFrom,c.indexCount=a.indexCount,c.materialInfo=a.materialInfo,c.geometryType=a.geometryType,b.push(c))},c.prototype._removeFromList=function(a){for(var c=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),d=c.length,e=void 0,f=0;d>f;++f){var g=c[f];a.indexFrom+a.indexCount>g.indexFrom&&a.indexFrom<g.indexFrom+g.indexCount&&(e=f)}if(void 0!==e)if(g=c[e],a.indexFrom<g.indexFrom)g.indexCount-=
a.indexCount,g.indexFrom+=a.indexCount;else if(a.indexFrom+a.indexCount>g.indexFrom+g.indexCount)g.indexCount-=a.indexCount;else{var d=g.indexFrom,f=a.indexFrom-g.indexFrom,h=a.indexCount;a=g.indexFrom+g.indexCount-(a.indexFrom+a.indexCount);g.indexCount=f;var l=k.pool.acquire();l.geometryType=g.geometryType;l.materialInfo=b.pool.acquire();l.materialInfo.copy(g.materialInfo);l.indexFrom=d+f+h;l.indexCount=a;c.splice(e+1,0,l)}},c.prototype._getDisplayList=function(b,c,g){for(var h,k=this.symbolLevels.length,
l=0;k>l;l++)if(this.symbolLevels[l].symbolLevel===b){h=this.symbolLevels[l];break}h||(h=e.pool.acquire(),h.symbolLevel=b,this.symbolLevels.push(h));var m;b=h.zLevels.length;for(k=0;b>k;k++)if(h.zLevels[k].zLevel===c){m=h.zLevels[k];break}m||(m=a.pool.acquire(),m.geometryDPInfo=f.pool.acquire(),m.zLevel=c,h.zLevels.push(m));var n;switch(g){case d.WGLGeometryType.FILL:m.geometryDPInfo.fill||(m.geometryDPInfo.fill=[]);n=m.geometryDPInfo.fill;break;case d.WGLGeometryType.LINE:m.geometryDPInfo.line||(m.geometryDPInfo.line=
[]);n=m.geometryDPInfo.line;break;case d.WGLGeometryType.MARKER:m.geometryDPInfo.marker||(m.geometryDPInfo.marker=[]);n=m.geometryDPInfo.marker;break;case d.WGLGeometryType.TEXT:m.geometryDPInfo.text||(m.geometryDPInfo.text=[]);n=m.geometryDPInfo.text;break;default:console.error("Trying to add a record with geometry type '"+g+"'.")}return n},c.serialize=function(a,b,c){var d=0;b&&(b[c+d]=a.symbolLevels.length);++d;var e=0;for(a=a.symbolLevels;e<a.length;e++){var f=a[e];b&&(b[c+d]=f.symbolLevel);++d;
b&&(b[c+d]=f.zLevels.length);++d;for(var g=0,f=f.zLevels;g<f.length;g++){var h=f[g];b&&(b[c+d]=h.zLevel);++d;h=h.geometryDPInfo;d+=this._serializeDisplayListInfo(h.fill,b,c+d);d+=this._serializeDisplayListInfo(h.line,b,c+d);d+=this._serializeDisplayListInfo(h.marker,b,c+d);d+=this._serializeDisplayListInfo(h.text,b,c+d)}}return d},c.deserialize=function(b,c,f){var g=0,h=c[f+g];++g;for(var k=0;h>k;++k){var l=e.pool.acquire();l.symbolLevel=c[f+g];++g;b.symbolLevels.push(l);var m=c[f+g];++g;for(var q=
0;m>q;++q){var r=a.pool.acquire();r.zLevel=c[f+g];++g;l.zLevels.push(r);var t=[],g=g+this._deserializeDisplayListInfo(t,d.WGLGeometryType.FILL,c,f+g);0<t.length?r.geometryDPInfo.fill=t:r.geometryDPInfo.fill=null;t=[];g+=this._deserializeDisplayListInfo(t,d.WGLGeometryType.LINE,c,f+g);0<t.length?r.geometryDPInfo.line=t:r.geometryDPInfo.line=null;t=[];g+=this._deserializeDisplayListInfo(t,d.WGLGeometryType.MARKER,c,f+g);0<t.length?r.geometryDPInfo.marker=t:r.geometryDPInfo.marker=null;t=[];g+=this._deserializeDisplayListInfo(t,
d.WGLGeometryType.TEXT,c,f+g);0<t.length?r.geometryDPInfo.text=t:r.geometryDPInfo.text=null}}return g},c._serializeDisplayListInfo=function(a,c,d){var e=0;if(a)for(var e=e+g.serializeInteger(a.length,c,d+e),f=0;f<a.length;f++)var h=a[f],e=e+b.serialize(h.materialInfo,c,d+e),e=e+g.serializeInteger(h.indexFrom,c,d+e),e=e+g.serializeInteger(h.indexCount,c,d+e);else c&&(c[d+e]=0),++e;return e},c._deserializeDisplayListInfo=function(a,c,d,e){var f={n:void 0},h=0,h=h+g.deserializeInteger(f,d,e+h),l=f.n;
a.length=l;for(var m=0;l>m;++m){var q=k.pool.acquire();q.geometryType=c;var r={materialInfo:null},h=h+b.deserialize(r,d,e+h);q.materialInfo=r.materialInfo;h+=g.deserializeInteger(f,d,e+h);q.indexFrom=f.n;h+=g.deserializeInteger(f,d,e+h);q.indexCount=f.n;a[m]=q}return h},c.pool=new h(c),c}();var k=function(){function a(){this.materialInfo=null;this.indexCount=this.indexFrom=0}return a.prototype.release=function(){this.geometryType=d.WGLGeometryType.UNKNOWN;this.materialInfo=null;this.indexCount=this.indexFrom=
0},a.pool=new h(a),a}(),f=function(){function a(){this.text=this.marker=this.line=this.fill=null}return a.prototype.release=function(){this.fill&&(this.fill.forEach(function(a){return k.pool.release(a)}),this.fill.length=0);this.line&&(this.line.forEach(function(a){return k.pool.release(a)}),this.line.length=0);this.marker&&(this.marker.forEach(function(a){return k.pool.release(a)}),this.marker.length=0);this.text&&(this.text.forEach(function(a){return k.pool.release(a)}),this.text.length=0)},a.pool=
new h(a),a}(),a=function(){function a(){}return a.prototype.acquire=function(){this.geometryDPInfo=f.pool.acquire()},a.prototype.release=function(){this.zLevel=null;f.pool.release(this.geometryDPInfo);this.geometryDPInfo=null},a.pool=new h(a),a}(),e=function(){function b(){this.zLevels=[]}return b.prototype.release=function(){this.symbolLevel=null;this.zLevels.forEach(function(b){return a.pool.release(b)});this.zLevels.length=0},b.pool=new h(b),b}();return m})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require",
"exports","../../../../core/ObjectPool"],function(m,l,h){return function(){function d(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}return d.prototype.release=function(){},d.deserialize=function(b){for(var g=d.pool.acquire(),h=0;4>h;++h){g.geometries[h].indexBuffer=new Uint32Array(b.geometries[h].indexBuffer);g.geometries[h].vertexBuffer={};for(var f in b.geometries[h].vertexBuffer)g.geometries[h].vertexBuffer[f]=
{data:new Uint32Array(b.geometries[h].vertexBuffer[f].data),stride:b.geometries[h].vertexBuffer[f].stride}}return g},d.prototype.serialize=function(){for(var b={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}}]},d=0;4>d;++d)for(var h in this.geometries[d].vertexBuffer)b.geometries[d].vertexBuffer[h]=
{data:this.geometries[d].vertexBuffer[h].data.buffer,stride:this.geometries[d].vertexBuffer[h].stride};return b},d.prototype.getBuffers=function(){for(var b=[],d=0;4>d;++d){b.push(this.geometries[d].indexBuffer.buffer);for(var h in this.geometries[d].vertexBuffer)b.push(this.geometries[d].vertexBuffer[h].data.buffer)}return b},d.pool=new h(d),d}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/ObjectPool ../../../../core/libs/gl-matrix/vec2 ../../../../core/libs/gl-matrix/mat4 ../../tiling/TileKey ../DisplayObject ./WGLDisplayRecord ./WGLGeometry ./enums ./Utils ./WGLDisplayList".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t){return function(f){function l(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];c=f.call(this)||this;return c.displayList=null,c.hlDisplayList=null,c.displayObjectRegistry=new Map,c.iconDisplayRecords=null,c.textDisplayRecords=null,c.lineDisplayRecords=null,c.fillDisplayRecords=null,c.iconGeometry=null,c.textGeometry=null,c.lineGeometry=null,c.fillGeometry=null,c.coords=[0,0],c.bounds=[0,0,0,0],c.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]},
c._hasVisualVariables=!1,0<a.length&&(d=c.acquire).call.apply(d,[c].concat(a)),c.tileTransform.transform=g.create(),c.tileTransform.displayCoord=b.create(),c;var d}return h(l,f),l.prototype.acquire=function(a,b,c,d,e){this.key=k.pool.acquire(a);this.coords[0]=b[0];this.coords[1]=b[3];this.bounds=b;this.coordRange=c;this.width=d;this.height=e},l.prototype.release=function(){this.clear();k.pool.release(this.key);this.key=null},Object.defineProperty(l.prototype,"canDisplay",{get:function(){return!!this.attached&&
!!this.displayList},enumerable:!0,configurable:!0}),l.prototype.setData=function(a,b,d){a&&a.tileDisplayData&&(this._hasVisualVariables=b,this.displayList&&a.tileDisplayData.displayList!==this.displayList&&t.pool.release(this.displayList),this.displayList=a.tileDisplayData.displayList,this.fillDisplayRecords=a.tileDisplayData.displayRecords[c.WGLGeometryType.FILL],this.lineDisplayRecords=a.tileDisplayData.displayRecords[c.WGLGeometryType.LINE],this.iconDisplayRecords=a.tileDisplayData.displayRecords[c.WGLGeometryType.MARKER],
this.textDisplayRecords=a.tileDisplayData.displayRecords[c.WGLGeometryType.TEXT],this.displayObjectRegistry=a.tileDisplayData.displayObjectRegistry,this.fillDisplayRecords&&0<this.fillDisplayRecords.length&&(this.fillGeometry=new e,this.fillGeometry.initializeWithBuffers(this._hasVisualVariables?q.C_FILL_VERTEX_DEF_VV:q.C_FILL_VERTEX_DEF,a.tileBufferData.geometries[c.WGLGeometryType.FILL],35044)),this.lineDisplayRecords&&0<this.lineDisplayRecords.length&&(this.lineGeometry=new e,this.lineGeometry.initializeWithBuffers(this._hasVisualVariables?
q.C_LINE_VERTEX_DEF_VV:q.C_LINE_VERTEX_DEF,a.tileBufferData.geometries[c.WGLGeometryType.LINE],35044)),this.iconDisplayRecords&&0<this.iconDisplayRecords.length&&(this.iconGeometry=new e,this.iconGeometry.initializeWithBuffers(this._hasVisualVariables?q.C_ICON_VERTEX_DEF_VV:q.C_ICON_VERTEX_DEF,a.tileBufferData.geometries[c.WGLGeometryType.MARKER],35044)),this.textDisplayRecords&&0<this.textDisplayRecords.length&&(this.textGeometry=new e,this.textGeometry.initializeWithBuffers(this._hasVisualVariables?
q.C_TEXT_VERTEX_DEF_VV:q.C_TEXT_VERTEX_DEF,a.tileBufferData.geometries[c.WGLGeometryType.TEXT],35044)))},l.prototype.appendData=function(a){},l.prototype.updateObjects=function(a){var b=(a.remove||[]).slice();a=a.update||[];for(var d=[],f=[],g=[],h=[],k=[],l=0;l<a.length;l++){var m=a[l];this.displayObjectRegistry.get(m.id)&&b.push(m.id)}for(var r=0;r<b.length;r++){var u=b[r];if(m=this.displayObjectRegistry.get(u)){for(var v=0,m=m.displayRecords;v<m.length;v++)switch(l=m[v],d.push(l),l.geometryType){case c.WGLGeometryType.FILL:f.push(l);
break;case c.WGLGeometryType.LINE:g.push(l);break;case c.WGLGeometryType.MARKER:h.push(l);break;case c.WGLGeometryType.TEXT:k.push(l)}this.displayObjectRegistry["delete"](u)}}this.displayList||(this.displayList=t.pool.acquire());(m=this.displayList)&&m.removeFromList(d);this._removeRecords(this.fillGeometry,this.fillDisplayRecords,f);this._removeRecords(this.lineGeometry,this.lineDisplayRecords,g);this._removeRecords(this.iconGeometry,this.iconDisplayRecords,h);this._removeRecords(this.textGeometry,
this.textDisplayRecords,k);b=[];for(d=0;d<a.length;d++){m=a[d];f=0;for(g=m.displayRecords;f<g.length;f++)switch(l=g[f],b.push(l),l.geometryType){case c.WGLGeometryType.FILL:this.fillDisplayRecords=this.fillDisplayRecords||[];this.fillDisplayRecords.push(l);break;case c.WGLGeometryType.LINE:this.lineDisplayRecords=this.lineDisplayRecords||[];this.lineDisplayRecords.push(l);break;case c.WGLGeometryType.MARKER:this.iconDisplayRecords=this.iconDisplayRecords||[];this.iconDisplayRecords.push(l);break;
case c.WGLGeometryType.TEXT:this.textDisplayRecords=this.textDisplayRecords||[],this.textDisplayRecords.push(l)}this.displayObjectRegistry.set(m.id,m)}a=!1;(this.fillGeometry||(this.fillGeometry=new e),this.lineGeometry||(this.lineGeometry=new e),this.iconGeometry||(this.iconGeometry=new e),a=a||this._updateRecords(this.iconGeometry,this.iconDisplayRecords,this._hasVisualVariables?q.C_ICON_VERTEX_DEF_VV:q.C_ICON_VERTEX_DEF),this.textGeometry||(this.textGeometry=new e),a)?(this.displayList&&t.pool.release(this.displayList),
a=t.pool.acquire(),a.addToList(this.fillDisplayRecords),a.addToList(this.lineDisplayRecords),a.addToList(this.iconDisplayRecords),a.addToList(this.textDisplayRecords),this.displayList=a):(a=this.displayList)?a.addToList(b):(a=t.pool.acquire(),a.addToList(b),this.displayList=a)},l.prototype._updateRecords=function(a,b,d){return a.update(b)===c.WGLGeometryTransactionStatus.FAILED_OUT_OF_MEMORY?(a.initializeWithRecords(d,b,35044),this.attached=!1,!0):(a.invalidateIndexBuffer(),a.invalidateVertexBuffers(),
!1)},l.prototype._removeRecords=function(a,b,c){if(a){this.iconGeometry.remove(c);for(var d=a=b.length,e=0;a>e;++e){for(var f=void 0,f=0;d>f&&b[e]!==c[f];++f);f<c.length&&(b.splice(e,1),e--)}}},l.prototype.clear=function(){this.iconGeometry&&(this.iconGeometry.clear(),this.iconGeometry=null);this.textGeometry&&(this.textGeometry.clear(),this.textGeometry=null);this.lineGeometry&&(this.lineGeometry.clear(),this.lineGeometry=null);this.fillGeometry&&(this.fillGeometry.clear(),this.fillGeometry=null);
this.displayObjectRegistry.clear();this.displayList&&(t.pool.release(this.displayList),this.displayList=null);this.hlDisplayList&&(t.pool.release(this.hlDisplayList),this.hlDisplayList=null);this.iconDisplayRecords&&(this.iconDisplayRecords.length=0);this.textDisplayRecords&&(this.textDisplayRecords.length=0);this.lineDisplayRecords&&(this.lineDisplayRecords.length=0);this.fillDisplayRecords&&(this.fillDisplayRecords.length=0)},l.prototype.dispose=function(){this.release()},l.prototype.attach=function(a){var b=
!0;return this.fillGeometry&&(this.fillGeometry.attached||(b=b&&this.fillGeometry.attach(a))),this.lineGeometry&&(this.lineGeometry.attached||(b=b&&this.lineGeometry.attach(a))),this.iconGeometry&&(this.iconGeometry.attached||(b=b&&this.iconGeometry.attach(a))),this.textGeometry&&(this.textGeometry.attached||(b=b&&this.textGeometry.attach(a))),b},l.prototype.detach=function(a){},l.prototype.doRender=function(a){},l.prototype.buildHLList=function(b){var c=this;this.hlDisplayList&&t.pool.release(this.hlDisplayList);
this.hlDisplayList=t.pool.acquire();b.forEach(function(b){if(b=c.displayObjectRegistry.get(b)){b=b.displayRecords.map(function(b){var c=a.pool.acquire();return c.id=b.id,c.geometryType=b.geometryType,c.vertexFrom=b.vertexFrom,c.vertexCount=b.vertexCount,c.indexFrom=b.indexFrom,c.indexCount=b.indexCount,c.materialInfo=b.materialInfo,c.meshData=null,c.sortKey=0,c.symbolLevel=0,c.zOrder=0,c});b.sort(function(a,b){return a.sortKey-b.sortKey});c.hlDisplayList.addToList(b);for(var d=0;d<b.length;d++)a.pool.release(b[d])}})},
l.pool=new d(l),l}(f)})},"esri/views/2d/engine/webgl/WGLGeometry":function(){define(["require","exports","../../../webgl/BufferObject","./FreeList","./enums"],function(m,l,h,d,b){return function(){function g(){this._bufferSpec={};this._ibFreeList=this._vbFreeList=null;this.vertexBufferMap={};this.vertexBufferMapCPU={};this.vao=this.indexBufferCPU=this.indexBuffer=null;this.usage=35044}return Object.defineProperty(g.prototype,"attached",{get:function(){return null!==this.indexBuffer},enumerable:!0,
configurable:!0}),g.prototype.attach=function(b){for(var d in this._bufferSpec)this.vertexBufferMap[d]=h.createVertex(b.context,this.usage,this.vertexBufferMapCPU[d].buffer);return this.indexBufferCPU&&(this.indexBuffer=h.createIndex(b.context,this.usage,this.indexBufferCPU)),!0},g.prototype.initializeEmpty=function(b,f,a,e){void 0===e&&(e=35044);this.clear();this.usage=e;a&&(this.indexBufferCPU=new Uint32Array(a));var c;for(e=0;e<b.length;e++){var g=b[e];c=0!==g.divisor?Math.ceil(f/g.divisor):f;
c*=g.strideInBytes;this._bufferSpec[g.name]=g;this.vertexBufferMapCPU[g.name]=new Uint32Array(c/4)}this._vbFreeList=d.create(f);a&&(this._ibFreeList=d.create(a))},g.prototype.initializeWithRecords=function(b,d,a){void 0===a&&(a=35044);d.sort(function(a,b){return a.sortKey-b.sortKey});for(var e=0,c=0,f=0;f<d.length;f++){var g=d[f],e=e+g.meshData.vertexCount;g.meshData.indexData&&(c+=g.meshData.indexData.length);g.indexFrom=void 0;g.indexCount=0;g.vertexFrom=void 0;g.vertexCount=0}this.initializeEmpty(b,
Math.floor(1.5*e),Math.floor(1.5*c),a);this.update(d)},g.prototype.initializeWithBuffers=function(b,f,a){void 0===a&&(a=35044);this.clear();this.usage=a;this.indexBufferCPU=f.indexBuffer;a=this.indexBufferCPU.length;for(var e=void 0,c=0;c<b.length;c++){var g=b[c];this._bufferSpec[g.name]=g;this.vertexBufferMapCPU[g.name]=f.vertexBuffer[g.name].data;g=f.vertexBuffer[g.name].data.buffer.byteLength/g.strideInBytes;void 0!==e&&e!==g?console.error("Buffers with different vertex counts."):e=g}this._vbFreeList=
d.create(e);this._vbFreeList.allocate(e);this._ibFreeList=d.create(a);this._ibFreeList.allocate(a)},g.prototype.clear=function(){this.indexBuffer&&(this.indexBuffer.dispose(),this.indexBuffer=null);this.indexBufferCPU=null;for(var b in this.vertexBufferMap)this.vertexBufferMap[b].dispose(),delete this.vertexBufferMap[b];this.vertexBufferMap={};this.vertexBufferMapCPU={};this.vao&&(this.vao.dispose(),this.vao=null);this._bufferSpec={};this._ibFreeList=this._vbFreeList=null},g.prototype.update=function(d){for(var f=
0;f<d.length;f++){var a=this._updateRecord(d[f]);if(a!==b.WGLGeometryTransactionStatus.SUCCEEDED)return a}return b.WGLGeometryTransactionStatus.SUCCEEDED},g.prototype._updateRecord=function(d){var f;void 0===d.vertexFrom||d.vertexCount!==d.meshData.vertexCount?(void 0!==d.vertexFrom&&this._vbFreeList.free(d.vertexFrom,d.vertexCount),f=0<d.meshData.vertexCount?this._vbFreeList.allocate(d.meshData.vertexCount):-1):f=d.vertexFrom;-1!==f?(d.vertexFrom=f,d.vertexCount=d.meshData.vertexCount):(d.vertexFrom=
void 0,d.vertexCount=0);var a=d.meshData.indexData?d.meshData.indexData.length:0;if(void 0===d.indexFrom||d.indexCount!==a?(void 0!==d.indexFrom&&this._ibFreeList.free(d.indexFrom,d.indexCount),f=0<a?this._ibFreeList.allocate(a):-1):f=d.indexFrom,-1!==f?(d.indexFrom=f,d.indexCount=a):(d.indexFrom=void 0,d.indexCount=0),void 0!==d.vertexFrom&&void 0!==d.indexFrom){var e;e=a=f=f=void 0;for(var c in d.meshData.vertexData){f=this._bufferSpec[c].divisor;e=0!==f?d.vertexFrom/f:d.vertexFrom;f=this.vertexBufferMapCPU[c];
var a=d.meshData.vertexData[c],g=a.length;e=e*this._bufferSpec[c].strideInBytes/4;for(var h=0;g>h;h++)f[e+h]=a[h]}c=d.vertexFrom;a=(f=d.meshData.indexData)?f.length:0;for(g=0;a>g;++g)this.indexBufferCPU[d.indexFrom+g]=c+f[g];return b.WGLGeometryTransactionStatus.SUCCEEDED}return b.WGLGeometryTransactionStatus.FAILED_OUT_OF_MEMORY},g.prototype.remove=function(b){for(var d=0;d<b.length;d++)this._removeRecord(b[d])},g.prototype._removeRecord=function(b){this._vbFreeList.free(b.vertexFrom,b.vertexCount);
b.vertexFrom=void 0;b.vertexCount=0;this._ibFreeList.free(b.indexFrom,b.indexCount);b.indexFrom=void 0;b.indexCount=0},g.prototype.invalidateIndexBuffer=function(){var b=this.indexBuffer;b&&b.setData(this.indexBufferCPU)},g.prototype.invalidateVertexBuffers=function(b){if(!b){b=[];for(var d in this.vertexBufferMap)b.push(d)}for(var a=0;a<b.length;a++){d=b[a];var e=this.vertexBufferMap[d];e&&e.setData(this.vertexBufferMapCPU[d].buffer)}},g}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require",
"exports"],function(m,l){Object.defineProperty(l,"__esModule",{value:!0});var h=function(){function b(b){this._parent=b}return b.prototype.rangeCreated=function(b){},b.prototype.rangeResized=function(b,d,f){},b.prototype.findBestRange=function(b){for(var d=this._parent._freeHead;null!==d&&b>d.count;)d=d.next;return d},b.prototype.findAdjacentRanges=function(b,d){for(var f=!0,a=!1,e=null,c=this._parent._freeHead;f&&!a;){var g=null!==c?c.from:this._parent._size;b>=(null!==e?e.from+e.count:0)&&g>=b+
d?(f=!1,a=!0):null!==c?(e=c,c=c.next):f=!1}return[e,c]},b}();m=function(){function b(){this._rangesSortedByFrom=[];this._rangesSortedByCount=[]}return b.prototype.rangeCreated=function(b){this._rangesSortedByFrom.push(b);this._rangesSortedByFrom.sort(function(b,d){return b.from-d.from});this._rangesSortedByCount.push(b);this._rangesSortedByCount.sort(function(b,d){return b.count-d.count})},b.prototype.rangeResized=function(b,d,f){0===b.count?(this._rangesSortedByFrom.splice(this._rangesSortedByFrom.indexOf(b),
1),this._rangesSortedByCount.splice(this._rangesSortedByCount.indexOf(b),1)):this._rangesSortedByCount.sort(function(a,b){return a.count-b.count})},b.prototype.findBestRange=function(b){if(0===this._rangesSortedByCount.length)return null;for(var d=0,f=this._rangesSortedByCount.length-1,a=void 0;f>=d;){var e=Math.floor((d+f)/2),c=this._rangesSortedByCount[e].count;if(c===b){a=e;break}b>c?d=e+1:c>b&&(f=e-1,a=e)}return void 0===a?null:this._rangesSortedByCount[a]},b.prototype.findAdjacentRanges=function(b,
d){if(0===this._rangesSortedByFrom.length)return[null,null];if(b+d<=this._rangesSortedByFrom[0].from)return[null,this._rangesSortedByFrom[0]];if(b>=this._rangesSortedByFrom[this._rangesSortedByFrom.length-1].from+this._rangesSortedByFrom[this._rangesSortedByFrom.length-1].count)return[this._rangesSortedByFrom[this._rangesSortedByFrom.length-1],null];for(var f=0;f<this._rangesSortedByFrom.length-1;++f){var a=this._rangesSortedByFrom[f],e=this._rangesSortedByFrom[f+1];if(b>=a.from+a.count&&b+d<=e.from)return[a,
e]}throw Error("Could not find adjacent ranges.");},b}();l.SortingBookKeeper=m;var d=function(){function b(b,d){this._size=b;this._bookKeeper=d||new h(this);0<b?(this._freeHead={from:0,count:b,prev:null,next:null},this._bookKeeper.rangeCreated(this._freeHead)):this._freeHead=null}return b.prototype.allocate=function(d){var g=this._bookKeeper.findBestRange(d);if(null===g)return-1;var f=g.from,a=g.count;if(g.from+=d,g.count-=d,this._bookKeeper.rangeResized(g,f,a),0===g.count)d=null!==g.prev?this._freeHead:
g.next,b._removeRange(g),this._freeHead=d;return f},b.prototype.free=function(d,h){var f=this._bookKeeper.findAdjacentRanges(d,h),a=f[0],f=f[1];d={from:d,count:h,prev:a,next:f};if(null!==a&&(a.next=d),null!==f&&(f.prev=d),this._bookKeeper.rangeCreated(d),null!==f&&d.from+d.count===f.from){h=d.from;var e=d.count;b._fuse(d,f);b._removeRange(f);this._bookKeeper.rangeResized(d,h,e);this._bookKeeper.rangeResized(f,void 0,0)}null!==a&&a.from+a.count===d.from&&(h=a.from,e=a.count,b._fuse(a,d),b._removeRange(d),
this._bookKeeper.rangeResized(a,h,e),this._bookKeeper.rangeResized(d,void 0,0));this._freeHead=null!==d.prev?this._freeHead:d},b._removeRange=function(b){null!==b.prev?null!==b.next?(b.prev.next=b.next,b.next.prev=b.prev):b.prev.next=null:null!==b.next&&(b.next.prev=null)},b._fuse=function(b,d){b.count+=d.count;b.next=d.next;d.from+=d.count;d.count=0;null!==d.next&&(d.next.prev=b)},b}();l.DefaultFreeList=d;l.create=function(b){return new d(b)}})},"esri/views/2d/engine/webgl/WGLFeatureView":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix/vec3 ../../../../core/libs/gl-matrix/mat4 ../../../../core/promiseUtils ../../../../geometry/Point ../Container ./GeometryUtils ./WGLRendererInfo ./TextureManager ./Utils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q){return function(f){function l(a,e,g){var h=f.call(this)||this;return h._displayWidth=0,h._displayHeight=0,h._pointToCallbacks=new Map,h._highlightIDs=new Set,h._highlightOptionsUpToDate=!1,h.textureManager=new c,h._tileCoordRange=e,h._tileCoordRatio=e/a,h._parentLayerView=g,h._oneOverTileRatio=1/h._tileCoordRatio,h._tileCoordinateScale=d.create(),h._orientationVec=d.create(),h._displayScale=d.create(),h._orientationVec.set([0,0,1]),h._defaultTransform=b.create(),
h}return h(l,f),Object.defineProperty(l.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){this._highlightOptions=a;this._highlightOptionsUpToDate=!1},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"displayWidth",{get:function(){return this._displayWidth},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"displayHeight",{get:function(){return this._displayHeight},enumerable:!0,configurable:!0}),l.prototype.initialize=function(a){this._tileInfoView=
a;this.wglRendererInfo=new e(this)},l.prototype.updateHeatmapParameters=function(a){this.wglRendererInfo.updateHeatmapParameters(a);this.requestRender()},l.prototype.hitTest=function(a,b){var c=this,d=[a,b];return g.create(function(a,b){c._pointToCallbacks.set(d,{resolve:a,reject:b});c.requestRender()},function(){c._pointToCallbacks.has(d)&&c._pointToCallbacks["delete"](d)})},l.prototype.setHighlight=function(a){this._highlightIDs.clear();this.addHighlight(a)},l.prototype.addHighlight=function(a){var b=
this;a.forEach(function(a){b._highlightIDs.add(a)});this._buildHLList()},l.prototype.removeHighlight=function(a){var b=this;a.forEach(function(a){b._highlightIDs["delete"](a)});this._buildHLList()},l.prototype.addChild=function(a){a=f.prototype.addChild.call(this,a);return this._buildHLList(),a},l.prototype.removeChild=function(a){a=f.prototype.removeChild.call(this,a);return this._buildHLList(),a},l.prototype.prepareChildrenRenderParameters=function(a){return a},l.prototype.renderChildren=function(a){var b=
this;this.wglRendererInfo.updateVisualVariables(this._parentLayerView.visualVariablesInfo.vvRanges,a.state);var c=this.parent.glPainter;this.sortChildren(function(a,b){return a.key.level-b.key.level});var d=this._tileInfoView.getClosestInfoForScale(a.state.scale).level;this.wglRendererInfo.heatmapParameters?c.drawHeatmap(a.context,this,d,a.devicePixelRatio):c.draw(a.context,this,d,a.devicePixelRatio,a.stationary);0<this._highlightIDs.size&&c.highlight(a.context,this,d,a.devicePixelRatio);0!==this._pointToCallbacks.size&&
(this._pointToCallbacks.forEach(function(c,d){c.resolve(b._hitTest(a,d[0],d[1]))}),this._pointToCallbacks.clear())},l.prototype.attachChild=function(a,b){return a.attach(b)},l.prototype.detachChild=function(a,b){a.detach(b)},l.prototype.renderChild=function(a,b){a.doRender(b)},l.prototype.beforeRenderChildren=function(a,b){this._updateTilesTransform(a.state,this._tileInfoView.getClosestInfoForScale(a.state.scale).level);this._updateHighlightOptions()},l.prototype._hitTest=function(a,b,c){var d=this.parent.glPainter,
e=this._tileInfoView.getClosestInfoForScale(a.state.scale).level,f=[0,0];a.state.toMap(f,[b,c]);var g=a.state.clone(),h=g.viewpoint.clone();return h.targetGeometry=new k(f[0],f[1],a.state.spatialReference),g.viewpoint=h,g.size=[q.C_HITTEST_SEARCH_SIZE,q.C_HITTEST_SEARCH_SIZE],this._updateTilesTransform(g,e),d.update(g,a.devicePixelRatio),d.hitTest({context:a.context,budget:a.budget,state:g,devicePixelRatio:a.devicePixelRatio,stationary:a.stationary},b,c,this,e)},l.prototype._updateTilesTransform=
function(a,b){var c=1/a.width,d=1/a.height,e=[0,0];this._calculateRelativeViewProjMat(this._tileInfoView.tileInfo.lods[b].resolution,a.resolution,a.rotation,this._tileInfoView.tileInfo.size[0],this._tileCoordRange,a.width,a.height,this._defaultTransform);for(var f=0,g=this.children;f<g.length;f++){var h=g[f];a.toScreen(e,h.coords);e[1]=a.height-e[1];h.tileTransform.displayCoord[0]=2*e[0]*c-1;h.tileTransform.displayCoord[1]=2*e[1]*d-1;h.key.level===b?h.tileTransform.transform.set(this._defaultTransform):
this._calculateRelativeViewProjMat(this._tileInfoView.tileInfo.lods[h.key.level].resolution,a.resolution,a.rotation,this._tileInfoView.tileInfo.size[0],h.coordRange,a.width,a.height,h.tileTransform.transform)}},l.prototype._calculateRelativeViewProjMat=function(c,d,e,f,g,h,k,l){c=c/d*this._oneOverTileRatio;this._tileCoordinateScale.set([c,c,1]);(h!==this._displayWidth||k!==this._displayHeight)&&(this._displayScale.set([2/h,-2/k,1]),this._displayWidth=h,this._displayHeight=k);b.identity(l);b.scale(l,
l,this._tileCoordinateScale);b.rotate(l,l,-e*a.C_DEG_TO_RAD,this._orientationVec);b.scale(l,l,this._displayScale);b.transpose(l,l)},l.prototype._updateHighlightOptions=function(){this._highlightOptionsUpToDate||this._setHighlightOptions(this._highlightOptions)&&(this._highlightOptionsUpToDate=!0)},l.prototype._setHighlightOptions=function(a){if(!this.parent)return!1;var b=this.parent.glPainter;if(!b)return!1;var c=a.color.toRgba();c[0]/=255;c[1]/=255;c[2]/=255;var d=c.slice();return c[3]*=a.fillOpacity,
d[3]*=a.haloOpacity,b.setHighlightOptions({fillColor:c,outlineColor:d,outlineWidth:2,outerHaloWidth:.3,innerHaloWidth:.3,outlinePosition:0}),!0},l.prototype._buildHLList=function(){var a=this;this.children.forEach(function(b){b.buildHLList(a._highlightIDs)});this.requestRender()},l}(f)})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../geometry/support/scaleUtils ../../../../core/screenUtils ../../../../renderers/support/utils ./Utils".split(" "),function(m,
l,h,d,b,g){function k(b,a){var d=a.length;if(b<a[0].value||1===d)return a[0].size;for(var c=1;d>c;c++)if(b<a[c].value)return a[c-1].size+(b-a[c-1].value)/(a[c].value-a[c-1].value)*(a[c].size-a[c-1].size);return a[d-1].size}return function(){function f(a){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.vvSizeFieldStopsValues=new Float32Array(6);
this.vvSizeFieldStopsSizes=new Float32Array(6);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this.symbolLevels.push(0)}return Object.defineProperty(f.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"heatmapParameters",{get:function(){return this._heatmapParameters},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,
"vvMaterialParams",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0}),f.prototype.updateHeatmapParameters=function(a){var b=a.blurRadius,c=Math.round(4.5*a.blurRadius),d=2*c+1;this._heatmapParameters||(this._heatmapParameters={radius:b,blurRadius:c,kernelSize:d,refreshIntensityKernel:!0,intensityKernel:null,color:null,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity});for(var f=this._heatmapParameters,h=a.colorStops,k,l=[0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0],m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],y=0;16>y;y++){var n=h[Math.min(y,h.length-1)];l[y]=n.ratio;k=4*y;m[k+0]=n.color[0]/255;m[k+1]=n.color[1]/255;m[k+2]=n.color[2]/255;m[k+3]=1<n.color[3]?n.color[3]/255:n.color[3];g.premultiplyAlpha(m,k,!0)}f.color={values:l,colors:m,refreshColorRamp:!0};1E-6<Math.abs(f.radius-a.radius)&&(f.radius=b,f.blurRadius=c,f.kernelSize=d,f.refreshIntensityKernel=!0);
f.maxPixelIntensity=a.maxPixelIntensity;f.minPixelIntensity=a.minPixelIntensity},f.prototype.updateVisualVariables=function(a,e){var c=this._vvMaterialParameters;if(c.vvOpacityEnabled=!1,c.vvSizeEnabled=!1,c.vvColorEnabled=!1,c.vvRotationEnabled=!1,a){var f=a.size;if(f){if(c.vvSizeEnabled=!0,f.minMaxValue){var l=f.minMaxValue,m=void 0,u=void 0;g.isDefined(l.minSize)&&g.isDefined(l.maxSize)&&(g.isNumber(l.minSize)&&g.isNumber(l.maxSize)?(m=d.pt2px(l.minSize),u=d.pt2px(l.maxSize)):(u=e.scale,m=d.pt2px(k(u,
l.minSize.stops)),u=d.pt2px(k(u,l.maxSize.stops))));this.vvSizeMinMaxValue.set([l.minDataValue,l.maxDataValue,m,u])}if(f.scaleStops&&(this.vvSizeScaleStopsValue=d.pt2px(k(e.scale,f.scaleStops.stops))),f.unitValue)this.vvSizeUnitValueToPixelsRatio=h.getMetersPerUnitForSR(e.spatialReference)/b.meterIn[f.unitValue.unit]/e.resolution;f.fieldStops&&(this.vvSizeFieldStopsValues.set(f.fieldStops.values),this.vvSizeFieldStopsSizes.set(f.fieldStops.sizes))}(e=a.color)&&(c.vvColorEnabled=!0,this.vvColorValues.set(e.values),
this.vvColors.set(e.colors));(e=a.opacity)&&(c.vvOpacityEnabled=!0,this.vvOpacityValues.set(e.values),this.vvOpacities.set(e.opacities));(a=a.rotation)&&(c.vvRotationEnabled=!0,c.vvRotationType=a.type)}},f}()})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports dojo/Deferred ../../../../core/promiseUtils ../../../3d/support/imageUtils ./SpriteMosaic ./Utils ./CIMSymbolHelper ./SDFHelper ./GlyphSource ./GlyphMosaic".split(" "),function(m,l,h,d,b,g,k,f,a,e,c){var q=[];return function(){function l(){this._rasterizeQueue=
new Map;this._spriteMosaic=new g(1024,1024,250);this._glyphSource=new e("https://basemaps.arcgis.com/v1/arcgis/rest/services/World_Basemap/VectorTileServer/resources/fonts/{fontstack}/{range}.pbf");this._glyphMosaic=new c(1024,1024,this._glyphSource)}return Object.defineProperty(l.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0}),l.prototype.processItems=
function(a){var b=this;if(a.done)return!1;for(;this._spriteMosaic.hasItemsToProcess();)this._spriteMosaic.processNextItem();this._rasterizeQueue.forEach(function(c,d){if(a.done)return!1;var e=b._rasterizeJSON(d);c.resolve(e);q.push(d)});for(var c=0;c<q.length;c++)this._rasterizeQueue["delete"](q[c]);return q.length=0,!0},l.prototype.rasterizeItem=function(a,b){return void 0===b&&(b=null),a?!a.type||"text"!==a.type&&"esriTS"!==a.type?this._rasterizeSpriteSymbol(a).then(function(a){return{spriteMosaicItem:a}}):
this._rasterizeTextSymbol(a,b).then(function(a){return{glyphMosaicItems:a}}):d.resolve(null)},l.prototype.bindSpritePage=function(a,b,c,d){d||(d=9729);this._spriteMosaic.bind(a,d,b,c)},l.prototype.bindGlyphsPage=function(a,b,c){this._glyphMosaic.bind(a,9729,b,c)},l.prototype._rasterizeTextSymbol=function(a,b){return this._glyphMosaic.getGlyphItems(a,b)},l.prototype._rasterizeSpriteSymbol=function(a){var c=this;return!k.isFillSymbol(a)&&!k.isLineSymbol(a)||"solid"!==a.style&&"esriSFSSolid"!==a.style&&
"esriSLSSolid"!==a.style&&"none"!==a.style?this._spriteMosaic.has(a)?d.resolve(this._spriteMosaic.getSpriteItem(a)):a.url||a.imageData?b.requestImage(a.url?a.url:"data:"+a.contentType+";base64,"+a.imageData).then(function(b){return c._rasterizeResource(b).then(function(b){return c._addItemToMosaic(a,b.size,b.anchor,b.image,!k.isMarkerSymbol(a),b.sdf)})}):this._rasterizeResource(a).then(function(b){return c._addItemToMosaic(a,b.size,b.anchor,b.image,!k.isMarkerSymbol(a),b.sdf)}):d.resolve(null)},l.prototype._rasterizeResource=
function(a){var b=this;if(this._rasterizeQueue.has(a))return this._rasterizeQueue.get(a).promise;var c=new h(function(){b._rasterizeQueue.has(a)&&b._rasterizeQueue["delete"](a)});if(a instanceof HTMLImageElement){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var d=this._rasterizationCanvas.getContext("2d");d.drawImage(a,0,0,a.width,a.height);for(var d=d.getImageData(0,0,a.width,
a.height),d=new Uint8Array(d.data),e=void 0,f=0;f<d.length;f+=4)e=d[f+3]/255,d[f]*=e,d[f+1]*=e,d[f+2]*=e;c.resolve({size:[a.width,a.height],anchor:[0,0],image:new Uint32Array(d.buffer),sdf:!1})}else d=this._rasterizeJSON(a),c.resolve(d);return c.promise},l.prototype._addItemToMosaic=function(a,b,c,d,e,f){return this._spriteMosaic.addSpriteItem(a,b,c,d,e,f)},l.prototype._rasterizeJSON=function(b){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===
b.type||"esriSFS"===b.type){var c=f.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,b.style);b=c[0];var d=c[1],c=c[2];return{size:[d,c],anchor:[0,0],image:new Uint32Array(b.buffer),sdf:!1}}if("simple-line"===b.type||"esriSLS"===b.type)return c=f.SymbolHelper.rasterizeSimpleLine(this._rasterizationCanvas,b.style),b=c[0],d=c[1],c=c[2],{size:[d,c],anchor:[0,0],image:new Uint32Array(b.buffer),sdf:!0};if("simple-marker"===b.type||"esriSMS"===b.type?(d=f.CIMSymbolHelper.fromSimpleMarker(b),c=
!0):(d=b,c=a.SDFHelper.checkSDF(d)),c)return d=(new a.SDFHelper).buildSDF(d),b=d[0],{size:[d[1],d[2]],anchor:[0,0],image:new Uint32Array(b.buffer),sdf:!0};var e=f.CIMSymbolHelper.rasterize(this._rasterizationCanvas,d);b=e[0];d=e[1];c=e[2];return{size:[d,c],anchor:[e[3],e[4]],image:new Uint32Array(b.buffer),sdf:!1}},l}()})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ./Rect ./GeometryUtils ./RectangleBinPack ../../../webgl/Texture".split(" "),function(m,l,h,d,b,g){return function(){function k(d,
a,e){void 0===e&&(e=0);this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=d||0>=a)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=d;this._pageHeight=a;0<e&&(this._maxItemSize=e);this.pixelRatio=1|window.devicePixelRatio;this._binPack=new b(this._pageWidth,this._pageHeight);this._mosaicsData[0]=
new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight));this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}return k.prototype.getWidth=function(b){return b>=this._size.length?-1:this._size[b][0]},k.prototype.getHeight=function(b){return b>=this._size.length?-1:this._size[b][1]},k.prototype.getPage=function(b){return b<this._textures.length?this._textures[b]:null},k.prototype.has=function(b){return this._mosaicRects.has(JSON.stringify(b))},
k.prototype.getSpriteItem=function(b){return this._mosaicRects.get(JSON.stringify(b))},k.prototype.addSpriteItem=function(b,a,d,c,g,h){b=JSON.stringify(b);if(this._mosaicRects.has(b))return this._mosaicRects.get(b);var e=this._allocateImage(a[0],a[1]),f=e[0],k=e[1],e=e[2];if(0>=f.width||0>=f.height)return null;d={rect:f,width:a[0],height:a[1],anchorX:d[0],anchorY:d[1],sdf:h,pixelRatio:1,page:k};return this._mosaicRects.set(b,d),this._copy({rect:f,spriteSize:a,spriteData:c,page:k,pageSize:e,repeat:g,
sdf:h}),d},k.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length},k.prototype.processNextItem=function(){var b=this._spriteCopyQueue.pop();b&&this._copy(b)},k.prototype.getSpriteItems=function(b){for(var a={},d=0;d<b.length;d++){var c=b[d];a[c]=this.getSpriteItem(c)}return a},k.prototype.getMosaicItemPosition=function(b,a){a=(b=this.getSpriteItem(b))&&b.rect;if(!a)return null;a.width=b.width;a.height=b.height;return{size:[b.width,b.height],tl:[(a.x+1)/this._size[b.page][0],
(a.y+1)/this._size[b.page][1]],br:[(a.x+1+b.width)/this._size[b.page][0],(a.y+1+b.height)/this._size[b.page][1]],page:b.page}},k.prototype.bind=function(b,a,d,c){void 0===d&&(d=0);void 0===c&&(c=0);this._textures[d]||(this._textures[d]=new g(b,{pixelFormat:6408,dataType:5121,width:this._size[d][0],height:this._size[d][1]},new Uint8Array(this._mosaicsData[d].buffer)));var e=this._textures[d];e.setSamplingMode(a);this._dirties[d]&&(e.setData(new Uint8Array(this._mosaicsData[d].buffer)),e.generateMipmap());
b.bindTexture(e,c);this._dirties[d]=!1},k._copyBits=function(b,a,d,c,g,h,k,l,m,x,y){var e=c*a+d;k=l*h+k;if(y)for(k-=h,y=-1;x>=y;y++,e=((y+x)%x+c)*a+d,k+=h)for(l=-1;m>=l;l++)g[k+l]=b[e+(l+m)%m];else for(y=0;x>y;y++){for(l=0;m>l;l++)g[k+l]=b[e+l];e+=a;k+=h}},k.prototype._copy=function(b){if(!(b.page>=this._mosaicsData.length)){var a=b.spriteData,d=this._mosaicsData[b.page];d&&a||console.error("Source or target images are uninitialized!");k._copyBits(a,b.spriteSize[0],0,0,d,b.pageSize[0],b.rect.x+1,
b.rect.y+1,b.spriteSize[0],b.spriteSize[1],b.repeat);this._dirties[b.page]=!0}},k.prototype._allocateImage=function(f,a){f+=2;a+=2;var e=Math.max(f,a);if(this._maxItemSize&&this._maxItemSize<e){var e=Math.pow(2,Math.ceil(d.log2(f))),c=Math.pow(2,Math.ceil(d.log2(a)));f=new h(0,0,f,a);return this._mosaicsData.push(new Uint32Array(e*c)),this._dirties.push(!0),this._size.push([e,c]),this._textures.push(void 0),[f,this._mosaicsData.length-1,[e,c]]}e=this._binPack.allocate(f+(f%4?4-f%4:0),a+(a%4?4-a%4:
0));return 0>=e.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new b(this._pageWidth,this._pageHeight),this._allocateImage(f,a)):[e,this._currentPage,[this._pageWidth,this._pageHeight]]},k.prototype._dispose=function(){this._binPack=
null;this._mosaicRects.clear()},k}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["require","exports"],function(m,l){return function(){function h(d,b,g,h){void 0===d&&(d=0);void 0===b&&(b=0);void 0===g&&(g=0);void 0===h&&(h=0);this.x=d;this.y=b;this.width=g;this.height=h}return Object.defineProperty(h.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0}),h}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require",
"exports","./Rect"],function(m,l,h){return function(){function d(b,d){this._height=this._width=0;this._free=[];this._width=b;this._height=d;this._free.push(new h(0,0,b,d))}return Object.defineProperty(d.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),d.prototype.allocate=function(b,d){if(b>this._width||d>this._height)return new h;for(var g=null,f=-1,
a=0;a<this._free.length;++a){var e=this._free[a];b<=e.width&&d<=e.height&&(null===g||e.y<=g.y&&e.x<=g.x)&&(g=e,f=a)}return null===g?new h:(this._free.splice(f,1),g.width<g.height?(g.width>b&&this._free.push(new h(g.x+b,g.y,g.width-b,d)),g.height>d&&this._free.push(new h(g.x,g.y+d,g.width,g.height-d))):(g.width>b&&this._free.push(new h(g.x+b,g.y,g.width-b,g.height)),g.height>d&&this._free.push(new h(g.x,g.y+d,b,g.height-d))),new h(g.x,g.y,b,d))},d.prototype.release=function(b){for(var d=0;d<this._free.length;++d){var h=
this._free[d];if(h.y===b.y&&h.height===b.height&&h.x+h.width===b.x)h.width+=b.width;else if(h.x===b.x&&h.width===b.width&&h.y+h.height===b.y)h.height+=b.height;else if(b.y===h.y&&b.height===h.height&&b.x+b.width===h.x)h.x=b.x,h.width+=b.width;else{if(b.x!==h.x||b.width!==h.width||b.y+b.height!==h.y)continue;h.y=b.y;h.height+=b.height}this._free.splice(d,1);this.release(b)}this._free.push(b)},d}()})},"esri/views/2d/engine/webgl/CIMSymbolHelper":function(){define(["require","exports","../../../vectorTiles/GeometryUtils",
"./CIMSymbolDrawHelper","./SDFHelper"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function b(){}return b.getEnvelope=function(b){if("CIMPointSymbol"!==b.type)return null;var f=new d.EnvDrawHelper;return f.drawSymbol(b,{type:"point",x:0,y:0}),f.envelope()},b.rasterize=function(b,f){var a=this.getEnvelope(f);if(!a||0>=a.width||0>=a.height)return[null,0,0,0,0];var e=96/72,c=(a.x+.5*a.width)*e,g=-(a.y+.5*a.height)*e;b.width=a.width*e+2;b.height=a.height*e+2;a=b.getContext("2d");
e=d.Transformation.createScale(e,-e);e.translate(.5*b.width-c,.5*b.height-g);(new d.CanvasDrawHelper(a,e)).drawSymbol(f,{type:"point",x:0,y:0});f=a.getImageData(0,0,b.width,b.height);e=new Uint8Array(f.data);for(a=0;a<e.length;a+=4)f=e[a+3]/255,e[a]*=f,e[a+1]*=f,e[a+2]*=f;return[e,b.width,b.height,c/b.width,g/b.height]},b.fromSimpleMarker=function(b){var d,a,e=b.style;if("circle"===e||"esriSMSCircle"===e){d=Math.acos(.995);a=Math.ceil(h.C_PI/d/4);0===a&&(a=1);d=h.C_PI_BY_2/a;a*=4;e=[];e.push([50,
0]);for(var c=1;a>c;c++)e.push([50*Math.cos(c*d),-50*Math.sin(c*d)]);e.push([50,0]);d={rings:[e]};a={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===e||"esriSMSCross"===e)d=10,d={rings:[[[d,50],[d,d],[50,d],[50,-d],[d,-d],[d,-50],[-d,-50],[-d,-d],[-50,-d],[-50,d],[-d,d],[-d,50],[d,50]]]},a={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===e||"esriSMSDiamond"===e)d={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},a={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===e||"esriSMSSquare"===
e)d={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},a={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===e||"esriSMSX"===e)d=14.142135623730951,d={rings:[[[0,d],[50-d,50],[50,50-d],[d,0],[50,d-50],[50-d,-50],[0,-d],[d-50,-50],[-50,d-50],[-d,0],[-50,50-d],[d-50,50],[0,d]]]},a={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===e||"esriSMSTriangle"===e)a=2/3*100,e=a-100,d={rings:[[[-57.735026918962575,e],[0,a],[57.735026918962575,e],[-57.735026918962575,e]]]},a={xmin:-57.735026918962575,
ymin:e,xmax:57.735026918962575,ymax:a};var g;d&&a&&(g=[{type:"CIMSolidFill",enable:!0,color:b.color}],b.outline&&g.push({type:"CIMSolidStroke",enable:!0,width:b.outline.width,color:b.outline.color}),g={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:b.angle,size:b.size,offsetX:b.xoffset,offsetY:b.yoffset,frame:a,markerGraphics:[{type:"CIMMarkerGraphic",geometry:d,symbol:{type:"CIMPolygonSymbol",symbolLayers:g}}]}]});return g},b}();l.CIMSymbolHelper=m;m=function(){function d(){}
return d.rasterizeSimpleFill=function(b,d){"solid"!==d&&"none"!==d&&"esriSFSSolid"!==d&&"esriSFSNull"!==d||console.error("Unexpected: style does not require rasterization");b.width=8;b.height=8;var a=b.getContext("2d");a.strokeStyle="#FFFFFF";a.beginPath();"vertical"!==d&&"cross"!==d&&"esriSFSCross"!==d&&"esriSFSVertical"!==d||(a.moveTo(0,0),a.lineTo(0,8));"horizontal"!==d&&"cross"!==d&&"esriSFSCross"!==d&&"esriSFSHorizontal"!==d||(a.moveTo(0,0),a.lineTo(8,0));"forward-diagonal"!==d&&"diagonal-cross"!==
d&&"esriSFSDiagonalCross"!==d&&"esriSFSForwardDiagonal"!==d||(a.moveTo(0,0),a.lineTo(8,8));"backward-diagonal"!==d&&"diagonal-cross"!==d&&"esriSFSBackwardDiagonal"!==d&&"esriSFSDiagonalCross"!==d||(a.moveTo(8,0),a.lineTo(0,8));a.stroke();d=a.getImageData(0,0,b.width,b.height);for(var a=new Uint8Array(d.data),e=0;e<a.length;e+=4)d=a[e+3]/255,a[e]*=d,a[e+1]*=d,a[e+2]*=d;return[a,b.width,b.height]},d.rasterizeSimpleLine=function(d,f){var a;switch(f){case "dash":case "esriSLSDash":a=[3,2];break;case "dash-dot":case "esriSLSDashDot":a=
[2,2,0,2];break;case "dot":case "esriSLSDot":a=[0,3];break;case "long-dash":case "esriSLLongDash":a=[6,3];break;case "long-dash-dot":case "esriSLLongDashDot":a=[6,3,0,3];break;case "long-dash-dot-dot":case "esriSLLongDashDotDot":a=[2,2,0,2,0,2];break;case "short-dash":case "esriSLSShortDash":a=[2,2];break;case "short-dash-dot":case "esriSLSShortDashDot":a=[2,2,0,2];break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":a=[2,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":a=[0,2];break;
case "solid":case "esriSLSSolid":throw Error("Unexpected: style does not require rasterization");case "none":throw Error("Unexpected: style does not require rasterization");}f=d=0;for(var e=a;f<e.length;f++){var c=e[f];d+=c}d*=16;e=31*d;f=new Float32Array(e);for(c=0;e>c;++c)f[c]=257;for(var g=e=.5,h=!0,k=0;k<a.length;k++){for(var c=a[k],e=g,g=g+16*c,l=e;g>l;){for(var m=.5;31>m;){var c=(31-m+1.5)*d+l-.5,x=(m-15.5)*(m-15.5);h?f[c]=x:f[c]=Math.min((l-e)*(l-e)+x,(l-g)*(l-g)+x);m++}l++}h=!h}a=f.length;
e=new Uint8Array(4*a);for(c=0;a>c;++c)b.packFloat(Math.sqrt(f[c])/15,e,4*c);return[e,d,31]},d}();l.SymbolHelper=m})},"esri/views/2d/engine/webgl/CIMSymbolDrawHelper":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ./Rect ./GeometryUtils".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});var k=function(){function b(a){this._t=a}return b.createIdentity=function(){return new b([1,0,0,0,1,0])},b.prototype.clone=
function(){return new b(this._t.slice())},b.prototype.transform=function(a){var b=this._t;return[b[0]*a[0]+b[1]*a[1]+b[2],b[3]*a[0]+b[4]*a[1]+b[5]]},b.createScale=function(a,d){return new b([a,0,0,0,d,0])},b.prototype.scale=function(a,b){var c=this._t;return c[0]*=a,c[1]*=a,c[2]*=a,c[3]*=b,c[4]*=b,c[5]*=b,this},b.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])},b.createTranslate=function(a,d){return new b([0,0,a,0,0,d])},b.prototype.translate=function(a,
b){var c=this._t;return c[2]+=a,c[5]+=b,this},b.createRotate=function(a){var d=Math.cos(a);a=Math.sin(a);return new b([d,-a,0,a,d,0])},b.prototype.rotate=function(a){return this.multiply(b.createRotate(a))},b.prototype.multiply=function(a){var b=this._t;a=a._t;var c=b[1]*a[0]+b[4]*a[1],d=b[2]*a[0]+b[5]*a[1]+a[2],f=b[0]*a[3]+b[3]*a[4],g=b[1]*a[3]+b[4]*a[4],h=b[2]*a[3]+b[5]*a[4]+a[5];return b[0]=b[0]*a[0]+b[3]*a[1],b[1]=c,b[2]=d,b[3]=f,b[4]=g,b[5]=h,this},b}();l.Transformation=k;m=function(){function b(a){this._transfos=
[];this._sizeTransfos=[];this._transfos.push(a||k.createIdentity());this._sizeTransfos.push(a?a.scaleRatio():1)}return b.prototype.transformPt=function(a){return this._transfos[this._transfos.length-1].transform(a)},b.prototype.transformSize=function(a){return a*this._sizeTransfos[this._sizeTransfos.length-1]},b.prototype.back=function(){return this._transfos[this._transfos.length-1]},b.prototype.push=function(a){var b=a.scaleRatio();a.multiply(this.back());this._transfos.push(a);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-
1]*b)},b.prototype.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)},b.prototype.drawSolidFill=function(a,b){},b.prototype.drawSolidStroke=function(a,b,c){},b.prototype.drawSymbol=function(a,b){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(a,b)}},b.prototype.drawMultiLayerSymbol=function(a,b){if(a&&(a=a.symbolLayers))for(var c=a.length;c--;){var d=a[c];if(d&&d.enable)switch(d.type){case "CIMSolidFill":this.drawSolidFill(b,
d.color);break;case "CIMSolidStroke":this.drawSolidStroke(b,d.color,d.width);break;case "CIMVectorMarker":this.drawVectorMarker(d,b)}}},b.prototype.drawVectorMarker=function(a,b){if(a){var c=a.markerGraphics;if(c){var d=a.size,e=a.frame,f=e?e.ymax-e.ymin:0,f=d&&f?d/f:1,h=k.createIdentity();e&&h.translate(.5*-(e.xmax+e.xmin),.5*-(e.ymax+e.ymin));var l=a.anchorPt;if(l){var m=l.x,l=l.y;"relative"===a.anchorPtUnits&&e&&(m*=(e.xmax-e.xmin)*f,l*=d);h.translate(-m,-l)}1!==f&&h.scale(f,f);a.rotation&&h.rotate(a.rotation*
g.C_DEG_TO_RAD);h.translate(a.offsetX||0,a.offsetY||0);h.translate(b.x,b.y);this.push(h);for(a=0;a<c.length;a++)(b=c[a])&&this.drawSymbol(b.symbol,b.geometry);this.pop()}}},b}();l.CIMSymbolDrawHelper=m;d=function(d){function a(){var a=d.call(this)||this;return a._xmin=a._ymin=1/0,a._xmax=a._ymax=-(1/0),a}return h(a,d),a.prototype.envelope=function(){return new b(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)},a.prototype._merge=function(a,b){a[0]-b<this._xmin&&(this._xmin=a[0]-
b);a[0]+b>this._xmax&&(this._xmax=a[0]+b);a[1]-b<this._ymin&&(this._ymin=a[1]-b);a[1]+b>this._ymax&&(this._ymax=a[1]+b)},a.prototype.drawSolidFill=function(a,b){b=0;for(a=a.rings;b<a.length;b++){var c=a[b],d=c?c.length:0;if(2<d){this._merge(this.transformPt(c[0]),0);for(var e=1;d>e;++e)this._merge(this.transformPt(c[e]),0)}}},a.prototype.drawSolidStroke=function(a,b,d){b=.5*this.transformSize(d);d=0;for(a=a.rings||a.paths;d<a.length;d++){var c=a[d],e=c?c.length:0;if(1<e){this._merge(this.transformPt(c[0]),
b);for(var f=1;e>f;++f)this._merge(this.transformPt(c[f]),b)}}},a}(m);l.EnvDrawHelper=d;m=function(b){function a(a,c){c=b.call(this,c)||this;return c._ctx=a,c}return h(a,b),a.prototype.drawSolidFill=function(a,b){var c=this._ctx;c.fillStyle="rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";c.beginPath();b=0;for(a=a.rings;b<a.length;b++){var d=a[b],e=d?d.length:0;if(2<e){var f=this.transformPt(d[0]);c.moveTo(f[0],f[1]);for(var g=1;e>g;++g)f=this.transformPt(d[g]),
c.lineTo(f[0],f[1]);c.closePath()}}c.fill("evenodd")},a.prototype.drawSolidStroke=function(a,b,d){var c=this._ctx;c.strokeStyle="rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";c.lineWidth=this.transformSize(d)+.5;c.beginPath();b=!!a.rings;d=0;for(a=a.rings||a.paths;d<a.length;d++){var e=a[d],f=e?e.length:0;if(1<f){var g=this.transformPt(e[0]);c.moveTo(g[0],g[1]);for(var h=1;f>h;++h)g=this.transformPt(e[h]),c.lineTo(g[0],g[1]);b&&c.closePath()}}c.stroke()},a}(m);
l.CanvasDrawHelper=m})},"esri/views/2d/engine/webgl/SDFHelper":function(){define(["require","exports","./Geometry","./Rect"],function(m,l,h,d){function b(a){return a-Math.floor(a)}function g(a,d,c){a=0>a?0:.9999991<a?.9999991:a;var e=b(a*k[0]),g=b(a*k[1]),h=b(a*k[2]);a=b(a*k[3]);d[c+0]=256*(e-e*f[0]);d[c+1]=256*(g-e*f[1]);d[c+2]=256*(h-g*f[2]);d[c+3]=256*(a-h*f[3])}Object.defineProperty(l,"__esModule",{value:!0});var k=[16777216,65536,256,1],f=[0,1/256,1/256,1/256];l.packFloat=g;m=function(){function a(){}
return a.checkSDF=function(a){return!0},a.prototype._extractGeometry=function(a){if(!a)return null;a=a.symbolLayers;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;a=a.markerGraphics;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;var b=a.geometry;if(!b||!b.rings)return null;a=[];for(var d=0,b=b.rings;d<b.length;d++){for(var e=[],f=0,g=b[d];f<g.length;f++){var k=g[f];e.push(new h.Point(k[0],k[1]))}a.push(e)}return a},a.prototype._getEnvelope=function(a){for(var b=1/0,e=-(1/0),f=
1/0,g=-(1/0),h=0;h<a.length;h++)for(var k=0,l=a[h];k<l.length;k++){var m=l[k];m.x<b&&(b=m.x);m.x>e&&(e=m.x);m.y<f&&(f=m.y);m.y>g&&(g=m.y)}return new d(b,f,e-b,g-f)},a.prototype.buildSDF=function(a){a=this._extractGeometry(a);if(!a)return null;var b=this._getEnvelope(a);if(0>=b.width||0>=b.height)return null;for(var d=Math.floor(31.5),e=(128-2*(d+0+1))/Math.max(b.width,b.height),f=Math.round(b.width*e),g=Math.round(b.height*e),h=f+2*d,k=g+2*d,l=0;l<a.length;l++)for(var m=0,w=a[l];m<w.length;m++){var z=
w[m];z.x-=b.x;z.y-=b.y;z.x*=e;z.y*=e;z.x+=d-.5;z.y+=d-.5}b=this._dist_map(a,h,k,d);return this._sign_dist_map(a,h,k,d,b),[this._encodeDistMap(b,d),h,k,f,g,e]},a.prototype._dist_map=function(a,b,d,f){for(var c=b*d,e=new Float32Array(c),g=f*f+1,h=0;c>h;++h)e[h]=g;for(g=0;g<a.length;g++)for(var k=a[g],l=k.length,h=1;l>h;++h){var m=k[h-1],q=k[h],t=void 0,B=void 0;m.x<q.x?(t=m.x,B=q.x):(t=q.x,B=m.x);var F=void 0,G=void 0;m.y<q.y?(F=m.y,G=q.y):(F=q.y,G=m.y);var N=Math.floor(t)-f,B=Math.floor(B)+f,F=Math.floor(F)-
f,G=Math.floor(G)+f;0>N&&(N=0);B>b&&(B=b);0>F&&(F=0);G>d&&(G=d);for(var t=q.x-m.x,M=q.y-m.y,R=t*t+M*M;B>N;N++)for(var P=F;G>P;P++){var Q=(N-m.x)*t+(P-m.y)*M,T=void 0,O=void 0;0>Q?(T=m.x,O=m.y):Q>R?(T=q.x,O=q.y):(Q/=R,T=m.x+Q*t,O=m.y+Q*M);Q=(N-T)*(N-T)+(P-O)*(P-O);T=(d-P-1)*b+N;Q<e[T]&&(e[T]=Q)}}for(h=0;c>h;++h)e[h]=Math.sqrt(e[h]);return e},a.prototype._sign_dist_map=function(a,b,d,f,g){for(var c=0;c<a.length;c++)for(var e=a[c],h=e.length,k=1;h>k;++k){var l=e[k-1],m=e[k],q=void 0,r=void 0;l.x<m.x?
(q=l.x,r=m.x):(q=m.x,r=l.x);var t=void 0,F=void 0;l.y<m.y?(t=l.y,F=m.y):(t=m.y,F=l.y);q=Math.floor(q);r=Math.floor(r)+1;t=Math.floor(t);F=Math.floor(F)+1;f>q&&(q=f);r>b-f&&(r=b-f);f>t&&(t=f);for(F>d-f&&(F=d-f);F>t;++t)if(l.y>t!=m.y>t){for(var G=(d-t-1)*b,N=q;r>N;++N)N<(m.x-l.x)*(t-l.y)/(m.y-l.y)+l.x&&(g[G+N]=-g[G+N]);for(N=f;q>N;++N)g[G+N]=-g[G+N]}}},a.prototype._encodeDistMap=function(a,b){b*=2;for(var c=a.length,d=new Uint8Array(4*c),e=0;c>e;++e)g(.5-a[e]/b,d,4*e);return d},a}();l.SDFHelper=m})},
"esri/views/2d/engine/webgl/GlyphSource":function(){define(["require","exports","../../../../core/promiseUtils","../../../../request","../../../../core/pbf"],function(m,l,h,d,b){var g=function(){function b(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var c=b.getMessage(),d=void 0,f=void 0,g=void 0,h=void 0,k=void 0,l=void 0,m=void 0;c.next();)switch(c.tag()){case 1:d=c.getUInt32();break;case 2:f=c.getBytes();
break;case 3:g=c.getUInt32();break;case 4:h=c.getUInt32();break;case 5:k=c.getSInt32();break;case 6:l=c.getSInt32();break;case 7:m=c.getUInt32();break;default:c.skip()}d&&(this._metrics[d]={width:g,height:h,left:k,top:l,advance:m},this._bitmaps[d]=f);break;default:b.skip()}break;default:a.skip()}}return b.prototype.getMetrics=function(a){return this._metrics[a]},b.prototype.getBitmap=function(a){return this._bitmaps[a]},b}(),k=function(){function b(){this._ranges=[]}return b.prototype.getRange=function(a){return this._ranges[a]},
b.prototype.addRange=function(a,b){this._ranges[a]=b},b}();return function(){function f(a){this._glyphInfo={};this._baseURL=a}return f.prototype.getRange=function(a,e){var c=this._getFontStack(a);if(c.getRange(e))return h.resolve();var f=256*e,k=f+255;a=this._baseURL.replace("{fontstack}",a).replace("{range}",f+"-"+k);return d(a,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){c.addRange(e,new g(new b(new Uint8Array(a.data),new DataView(a.data))))})},f.prototype.getGlyph=
function(a,b){if(a=this._getFontStack(a)){var c=Math.floor(b/256);if(!(256<c)&&(a=a.getRange(c)))return{metrics:a.getMetrics(b),bitmap:a.getBitmap(b)}}},f.prototype._getFontStack=function(a){var b=this._glyphInfo[a];return b||(b=this._glyphInfo[a]=new k),b},f}()})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports dojo/promise/all dojo/has ../../../webgl/Texture ./Rect ./RectangleBinPack".split(" "),function(m,l,h,d,b,g,k){var f;d("stable-symbol-rendering")&&(f=new Set);
return function(){function a(a,b,d){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;(0>=a||0>=b)&&console.error("Glyph mosaic width and height must be greater than zero!");this.width=a;this.height=b;this._glyphSource=d;this._binPack=new k(a-4,b-4);this._glyphData.push(new Uint8Array(a*b));this._dirties.push(!0);this._textures.push(void 0)}return a.prototype.getGlyphItems=function(a,b){var c=this,e=[],
l=this._glyphSource,m=new Set;a=1/256;for(var v=0;v<b.length;v++)m.add(Math.floor(b[v]*a));var x=[];return m.forEach(function(a){if(256>=a){var b="Arial Regular"+a;c._rangePromises.has(b)?x.push(c._rangePromises.get(b)):(a=l.getRange("Arial Regular",a).always(function(){c._rangePromises["delete"](b)}),c._rangePromises.set(b,a),x.push(a))}}),h(x).then(function(a){(a=c._glyphIndex["Arial Regular"])||(a={},c._glyphIndex["Arial Regular"]=a);var h;if(d("stable-symbol-rendering")){f.clear();for(var q=0;q<
b.length;q++)h=b[q],f.add(h);var r=[];m.forEach(function(a){r.push(a)});r.sort();h=[];for(q=0;q<r.length;q++)for(var t=r[q],u=0;256>u;++u)h.push(256*t+u)}else h=b;q=0;for(t=h;q<t.length;q++)if(h=t[q],u=a[h])d("stable-symbol-rendering")&&!f.has(h)||(e[h]={rect:u.rect,metrics:u.metrics,page:u.page});else{var v=l.getGlyph("Arial Regular",h);if(v&&v.metrics){var u=v.metrics,x=void 0;if(0===u.width)x=new g(0,0,0,0);else{var y=u.width+6,M=u.height+6,R=y%4?4-y%4:4,P=M%4?4-M%4:4;1===R&&(R=5);1===P&&(P=5);
x=c._binPack.allocate(y+R,M+P);x.isEmpty&&(c._dirties[c._currentPage]||(c._glyphData[c._currentPage]=null),c._currentPage=c._glyphData.length,c._glyphData.push(new Uint8Array(c.width*c.height)),c._dirties.push(!0),c._textures.push(void 0),c._binPack=new k(c.width-4,c.height-4),x=c._binPack.allocate(y+R,M+P));var R=c._glyphData[c._currentPage],v=v.bitmap,Q=P=void 0;if(v)for(var T=0;M>T;T++)for(var P=y*T,Q=c.width*(x.y+T+1)+x.x,O=0;y>O;O++)R[Q+O+1]=v[P+O]}a[h]={rect:x,metrics:u,tileIDs:null,page:c._currentPage};
d("stable-symbol-rendering")&&!f.has(h)||(e[h]={rect:x,metrics:u,page:c._currentPage});c._dirties[c._currentPage]=!0}}return e})},a.prototype.bind=function(a,c,d,f){this._textures[d]||(this._textures[d]=new b(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var e=this._textures[d];e.setSamplingMode(c);this._dirties[d]&&e.setData(this._glyphData[d]);a.bindTexture(e,f);this._dirties[d]=!1},a.prototype.dispose=function(){this._binPack=null;
for(var a=0,b=this._textures;a<b.length;a++){var d=b[a];d&&d.dispose()}this._textures.length=0},a}()})},"esri/core/workers/WorkerConnection":function(){define(["require","exports","./WorkerProxy"],function(m,l,h){return function(){function d(b,d,k){this.id=k;"function"==typeof b?this._target=new b(this):this._target=b;this.proxy=new h(this._target,d,this)}return d.prototype.invoke=function(b,d,h){return this.proxy.invoke(b,d,h,this.id)},d}()})},"esri/core/workers/WorkerProxy":function(){define(["require",
"exports","dojo/Deferred","../Error"],function(m,l,h,d){return function(){function b(b,d,f){this.parentModule=b;this.worker=d;this.connection=f;this.msgCount=0;this.outgoingJobs=new Map;this.incomingJobs=new Map}return b.prototype.invoke=function(b,d,f,a){var e=this,c=++this.msgCount,g=new h(function(b){e.worker.postMessage({type:"\x3ccancel\x3e",id:c,connection:a,data:{reason:b}});e.outgoingJobs.has(c)&&e.outgoingJobs["delete"](c)});return this.outgoingJobs.set(c,g),this.worker.postMessage({type:b,
id:c,connection:a,data:d},f),g.promise},b.prototype.message=function(b){var g=this;if(b&&b.data){var f=b.data.type;if(f){var a=b.data,e=b.data.id,c=b.data.connection;if("\x3cresponse\x3e"===f&&e){if(b=this.outgoingJobs.get(e))this.outgoingJobs["delete"](e),a.error?b.reject(d.fromJSON(JSON.parse(a.error))):b.resolve(a.data)}else"\x3ccancel\x3e"===f&&e?(b=this.incomingJobs.get(e))&&b.cancel(a.data.reason||"cancel"):(b=this.parentModule[f],"function"==typeof b&&(a=b.call(this.parentModule,a.data,this.connection),
this.incomingJobs.set(e,a),a.then(function(a){g.worker.postMessage({type:"\x3cresponse\x3e",id:e,connection:c,data:a&&null!=a.data?a.data:a},a&&a.buffers||[])}).otherwise(function(a){a||(a={message:"Error encountered at method "+f});g.worker.postMessage({type:"\x3cresponse\x3e",id:e,connection:c,data:null,error:a.toJSON?JSON.stringify(a):JSON.stringify({name:a.name,message:a.message,details:a.details,stack:a.stack})})}).always(function(){g.incomingJobs["delete"](e)})))}}},b}()})},"esri/views/vectorTiles/WorkerTileHandler":function(){define("require exports dojo/Deferred ../../core/promiseUtils ./WorkerTile ./style/StyleRepository".split(" "),
function(m,l,h,d,b,g){return function(){function k(){this._tiles=new Map;this._spriteInfo={};this._glyphInfo={}}return k.prototype.reset=function(){var b=new h;this._spriteInfo={};this._glyphInfo={};var a=this._tiles;return a.forEach(function(a){return a.setObsolete()}),a.clear(),b.resolve(),b.promise},k.prototype.getLayers=function(){return this._layers},k.prototype.setLayers=function(b){return this._layers=(new g(b)).layers,d.resolve({data:""})},k.prototype.getTile=function(f,a){var e=this,c=f.key,
g=b.pool.acquire();g.initialize(f.key,f.refKey,this,f.rotation);var h=f.cacheTile;return a.invoke("fetchTileData",f.refKey).then(function(f){return g.setDataAndParse(f.protobuff,a).then(function(a){return h&&6!==g.status&&e._tiles.set(c,g),a}).otherwise(function(a){return g.setObsolete(),b.pool.release(g),e._tiles["delete"](g.tileKey),d.reject(a)})}).otherwise(function(a){return g.setObsolete(),e._tiles.has(g.tileKey)&&e._tiles["delete"](g.tileKey),d.reject(a)}).always(function(a){return h||b.pool.release(g),
a})},k.prototype.update=function(b){var a=this._tiles.get(b.key);return a?a.updateSymbols(b.rotation):d.reject()},k.prototype.destructTileData=function(f){return this._tiles.has(f.key)&&(b.pool.release(this._tiles.get(f.key)),this._tiles["delete"](f.key)),d.resolve()},k.prototype.fetchSprites=function(b,a){var e=[],c=this._spriteInfo;return b.forEach(function(a){void 0===c[a]&&e.push(a)}),0===e.length?d.resolve():a.invoke("getSprites",{sprites:e}).then(function(a){a=a.spriteItems;for(var b in a)c[b]=
a[b]})},k.prototype.getSpriteItems=function(){return this._spriteInfo},k.prototype.fetchGlyphs=function(b,a,e,c){var f=[],g=this._glyphInfo[a];return g?e.forEach(function(a){g[a]||f.push(a)}):(g=this._glyphInfo[a]=[],e.forEach(function(a){return f.push(a)})),0===f.length?d.resolve():c.invoke("getGlyphs",{tileID:b,font:a,codePoints:f}).then(function(a){a=a.glyphItems;for(var b in a)g[b]=a[b]})},k.prototype.getGlyphItems=function(b){return this._glyphInfo[b]},k}()})},"esri/views/vectorTiles/WorkerTile":function(){define("require exports dojo/Deferred ../../core/promiseUtils ../../core/executeAsync ../../core/ObjectPool ./VertexMemoryBuffer ./IndexMemoryBuffer ./TileParser ./BackgroundBucket ./FillBucket ./LineBucket ./SymbolBucket ./Placement ./GeometryUtils".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c,q,t,r,u){return function(){function l(){this.status=this.rotation=0;this._symbolBuckets=[];this.placementEngine=new r.PlacementEngine;this.fillVertexBuffer=new k.FillVertexBuffer(!1);this.fillDDVertexBuffer=new k.FillVertexBuffer(!0);this.fillIndexBuffer=new f.TriangleIndexBuffer;this.outlineVertexBuffer=new k.OutlineVertexBuffer(!1);this.outlineDDVertexBuffer=new k.OutlineVertexBuffer(!0);this.outlineIndexBuffer=new f.TriangleIndexBuffer;this.lineVertexBuffer=new k.LineVertexBuffer(!1);
this.lineDDVertexBuffer=new k.LineVertexBuffer(!0);this.lineIndexBuffer=new f.TriangleIndexBuffer;this.iconVertexBuffer=new k.SymbolVertexBuffer(!1);this.iconDDVertexBuffer=new k.SymbolVertexBuffer(!0);this.iconIndexBuffer=new f.TriangleIndexBuffer;this.textVertexBuffer=new k.SymbolVertexBuffer(!1);this.textDDVertexBuffer=new k.SymbolVertexBuffer(!0);this.textIndexBuffer=new f.TriangleIndexBuffer}return l.prototype.initialize=function(a,b,c,d){void 0===d&&(d=0);this.tileKey=a;this.refKey=b;this._workerTileHandler=
c;this.rotation=d;this.placementEngine.setAngle(u.C_DEG_TO_RAD*d)},l.prototype.release=function(){this.tileKey=this.refKey="";this.rotation=this.status=0;this.fillVertexBuffer.reset();this.fillDDVertexBuffer.reset();this.fillIndexBuffer.reset();this.outlineVertexBuffer.reset();this.outlineDDVertexBuffer.reset();this.outlineIndexBuffer.reset();this.lineVertexBuffer.reset();this.lineDDVertexBuffer.reset();this.lineIndexBuffer.reset();this.iconVertexBuffer.reset();this.iconDDVertexBuffer.reset();this.iconIndexBuffer.reset();
this.textVertexBuffer.reset();this.textDDVertexBuffer.reset();this.textIndexBuffer.reset();this.placementEngine.reset();this._symbolBuckets.length=0;this._workerTileHandler=null},l.prototype.setDataAndParse=function(a,b){var d=this,f=new h(function(a){d.status=6});return this._parse(a,b).then(function(a){d.status=4;for(var b=new Uint32Array([1,d.fillVertexBuffer.sizeInBytes,2,d.fillDDVertexBuffer.sizeInBytes,3,d.fillIndexBuffer.sizeInBytes,4,d.outlineVertexBuffer.sizeInBytes,5,d.outlineDDVertexBuffer.sizeInBytes,
6,d.outlineIndexBuffer.sizeInBytes,7,d.lineVertexBuffer.sizeInBytes,8,d.lineDDVertexBuffer.sizeInBytes,9,d.lineIndexBuffer.sizeInBytes,10,d.iconVertexBuffer.sizeInBytes,11,d.iconDDVertexBuffer.sizeInBytes,12,d.iconIndexBuffer.sizeInBytes,13,d.textVertexBuffer.sizeInBytes,14,d.textDDVertexBuffer.sizeInBytes,15,d.textIndexBuffer.sizeInBytes]),g=[],h=a.length,k=0;h>k;k++){var l=a[k];if(l instanceof c)g.push(l.layerIndex),g.push(1),g.push(l.fillIndexStart),g.push(l.fillIndexCount),g.push(l.outlineIndexStart),
g.push(l.outlineIndexCount);else if(l instanceof q)g.push(l.layerIndex),g.push(2),g.push(l.lineIndexStart),g.push(l.lineIndexCount),g.push(l.connectorStart),g.push(l.connectorCount);else if(l instanceof t){g.push(l.layerIndex);g.push(3);g.push(l.sdfMarker?1:0);var m=l.markerPageMap;g.push(m.size);m.forEach(function(a,b){g.push(b);g.push(a[0]);g.push(a[1])});l=l.glyphsPageMap;g.push(l.size);l.forEach(function(a,b){g.push(b);g.push(a[0]);g.push(a[1])})}else l instanceof e&&(g.push(l.layerIndex),g.push(0))}a=
new Uint32Array(g);var h=d.fillVertexBuffer.toBuffer(),k=d.fillDDVertexBuffer.toBuffer(),l=d.fillIndexBuffer.toBuffer(),m=d.outlineVertexBuffer.toBuffer(),n=d.outlineDDVertexBuffer.toBuffer(),r=d.outlineIndexBuffer.toBuffer(),u=d.lineVertexBuffer.toBuffer(),v=d.lineDDVertexBuffer.toBuffer(),w=d.lineIndexBuffer.toBuffer(),x=d.iconVertexBuffer.toBuffer(),y=d.iconDDVertexBuffer.toBuffer(),z=d.iconIndexBuffer.toBuffer(),W=d.textVertexBuffer.toBuffer(),E=d.textDDVertexBuffer.toBuffer(),p=d.textIndexBuffer.toBuffer();
f.resolve({data:{bufferDataInfo:b.buffer,bucketDataInfo:a.buffer,bufferData:[h,k,l,m,n,r,u,v,w,x,y,z,W,E,p]},buffers:[h,k,l,m,n,r,u,v,w,x,y,z,W,E,p,b.buffer,a.buffer]})}),f.promise},l.prototype.addBucket=function(a){this._symbolBuckets.push(a)},l.prototype.updateSymbols=function(a){var c=this,e=this._symbolBuckets;if(!e||0===e.length)return d.resolve({data:null,buffers:null});this.rotation=a;var f=this.placementEngine;f.reset();f.setAngle(a/256*360*u.C_DEG_TO_RAD);var g=this.iconVertexBuffer;g.reset();
var h=this.iconDDVertexBuffer;h.reset();var k=this.iconIndexBuffer;k.reset();var l=this.textVertexBuffer;l.reset();var m=this.textDDVertexBuffer;m.reset();var q=this.textIndexBuffer;q.reset();var r=[],t=e.length,v=0;return b(function(){if(6===c.status||0===c.status)return!0;if(t>v){var a=e[v++],b=a.layer;(a=a.copy(b.hasDataDrivenIcon?h:g,k,b.hasDataDrivenText?m:l,q,f))&&(r.push(a),a.updateSymbols())}return v>=t},5).then(function(){if(6===c.status||0===c.status||0===g.sizeInBytes&&0===h.sizeInBytes&&
0===k.sizeInBytes&&0===l.sizeInBytes&&0===m.sizeInBytes&&0===q.sizeInBytes)return{data:null,buffers:null};var a=new Uint32Array([10,g.sizeInBytes,11,h.sizeInBytes,12,k.sizeInBytes,13,l.sizeInBytes,14,m.sizeInBytes,15,q.sizeInBytes]),b=[];t=r.length;for(var d=0;t>d;d++){var e=r[d];b.push(e.layerIndex);b.push(3);b.push(e.sdfMarker?1:0);var f=e.markerPageMap;b.push(f.size);f.forEach(function(a,c){b.push(c);b.push(a[0]);b.push(a[1])});e=e.glyphsPageMap;b.push(e.size);e.forEach(function(a,c){b.push(c);
b.push(a[0]);b.push(a[1])})}var d=new Uint32Array(b),e=g.toBuffer(),f=h.toBuffer(),n=k.toBuffer(),u=l.toBuffer(),v=m.toBuffer(),p=q.toBuffer();return{data:{bufferDataInfo:a.buffer,bucketDataInfo:d.buffer,bufferData:[e,f,n,u,v,p]},buffers:[e,f,n,u,v,p,a.buffer,d.buffer]}}).otherwise(function(a){return d.resolve({data:null,buffers:null})})},l.prototype.setObsolete=function(){this.status=6},l.prototype.getLayers=function(){return this._workerTileHandler.getLayers()},l.prototype.getWorkerTileHandler=
function(){return this._workerTileHandler},l.prototype._parse=function(b,c){if(!b||0===b.byteLength)return d.resolve([]);this.status=2;return(new a(b,this,c)).parse()},l.pool=new g(l),l}()})},"esri/core/executeAsync":function(){define(["require","exports","dojo/Deferred","./now"],function(m,l,h,d){return function(b,g){var k;(!g||0>=g)&&(g=500);var f=new h(function(){k&&clearTimeout(k)}),a=function(){if(!f.isFulfilled()){for(var e=d(),c=!1;!c&&d()-e<g;)c=!0===b();c?f.resolve():k=setTimeout(a,0)}};
return k=setTimeout(a,0),f.promise}})},"esri/views/vectorTiles/VertexMemoryBuffer":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ./MemoryBuffer ./GeometryUtils".split(" "),function(m,l,h,d,b,g){Object.defineProperty(l,"__esModule",{value:!0});var k=new Float32Array(1),f=new Uint32Array(k.buffer);m=function(a){function d(b){var c=a.call(this,b?20:12)||this;return c._isDataDriven=b,c}return h(d,a),d.prototype.isDataDriven=function(){return this._isDataDriven},
d.prototype.add=function(a,d,e,g,h,l,m,y){var c=this.array;a=b.i1616to32(a,d);c.push(a);if(a=b.i8888to32(Math.round(31*e),Math.round(31*g),Math.round(31*h),Math.round(31*l)),c.push(a),a=b.i1616to32(m,0),c.push(a),this._isDataDriven){if(!y)throw Error("Expecting data driven values.");e=y.color;g=e[3]*y.opacity*255;c.push(b.i8888to32(e[0]*g,e[1]*g,e[2]*g,g));k[0]=y.size;c.push(f[0])}},d}(b);l.LineVertexBuffer=m;m=function(a){function d(b){var c=a.call(this,b?8:4)||this;return c._isDataDriven=b,c}return h(d,
a),d.prototype.isDataDriven=function(){return this._isDataDriven},d.prototype.add=function(a,d,e){var c=this.array;if(c.push(b.i1616to32(a,d)),this._isDataDriven){if(!e)throw Error("Expecting data driven values.");a=e.color;e=a[3]*e.opacity*255;c.push(b.i8888to32(a[0]*e,a[1]*e,a[2]*e,e))}},d}(b);l.FillVertexBuffer=m;m=function(a){function d(b){var c=a.call(this,b?12:8)||this;return c._isDataDriven=b,c}return h(d,a),d.prototype.isDataDriven=function(){return this._isDataDriven},d.prototype.add=function(a,
d,e,f,g,h,k){var c=this.array,l=this.index;a=b.i1616to32(a,d);c.push(a);if(a=b.i8888to32(Math.round(15*e),Math.round(15*f),g,h),c.push(a),this._isDataDriven){if(!k)throw Error("Expecting data driven values.");e=k.color;k=e[3]*k.opacity*255;c.push(b.i8888to32(e[0]*k,e[1]*k,e[2]*k,k))}return l},d}(b);l.OutlineVertexBuffer=m;m=function(a){function d(b){var c=a.call(this,b?24:16)||this;return c._isDataDriven=b,c}return h(d,a),d.prototype.isDataDriven=function(){return this._isDataDriven},d.prototype.add=
function(a,d,e,h,l,m,x,y,n,w,z){var c=this.array;a=b.i1616to32(a,d);if(c.push(a),a=b.i1616to32(Math.round(32*e),Math.round(32*h)),c.push(a),a=b.i8888to32(l/4,m/4,0,0),c.push(a),a=b.i8888to32(Math.ceil(10*w),g.radToByte(x),10*y,Math.min(10*n,255)),c.push(a),this._isDataDriven){if(!z)throw Error("Expecting data driven values.");e=z.color;h=e[3]*z.opacity*255;c.push(b.i8888to32(e[0]*h,e[1]*h,e[2]*h,h));k[0]=z.size;c.push(f[0])}},d}(b);l.SymbolVertexBuffer=m})},"esri/views/vectorTiles/IndexMemoryBuffer":function(){define(["require",
"exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper","./MemoryBuffer"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(b){function d(){return b.call(this,12)||this}return h(d,b),d.prototype.add=function(b,a,d){var c=this.array;c.push(b);c.push(a);c.push(d)},d}(b);l.TriangleIndexBuffer=m;b=function(b){function d(){return b.call(this,4)||this}return h(d,b),d.prototype.add=function(b){this.array.push(b)},d}(b);l.PointElementMemoryBuffer=
b})},"esri/views/vectorTiles/TileParser":function(){define("require exports dojo/promise/all ../../core/promiseUtils ../../core/executeAsync ../../core/pbf ./SourceLayerData ./Feature ./BackgroundBucket ./FillBucket ./LineBucket ./SymbolBucket ../2d/engine/webgl/TileClipper".split(" "),function(m,l,h,d,b,g,k,f,a,e,c,q,t){return function(){function l(a,b,c){this._pbfTile=new g(new Uint8Array(a),new DataView(a));this._tile=b;this._connection=c;this._layers=b.getLayers();c=b.tileKey.split("/").map(parseFloat);
var d=c[0];a=c[1];c=c[2];this._level=d;b.refKey&&(b=b.refKey.split("/").map(parseFloat)[0],b=d-b,0<b&&(d=(1<<b)-1,this._tileClipper=new t.TileClipper(b,a&d,c&d)));this._tileClipper||(this._tileClipper=new t.SimpleBuilder)}return l.prototype.parse=function(){for(var a,c=this,e=this._parseTileData(this._pbfTile),g=this._layers,k=g.length,l=this._level,m=[],q={},r=new Set,k=k-1;0<=k;k--)if(a=g[k],!(a.minzoom&&l<a.minzoom||a.maxzoom&&l>=a.maxzoom||a.layout&&"none"===a.layout.visibility))if(0!==a.type){var t=
a.sourceLayer,G=e[t];if(G){r.add(t);var N=this._createBucket(a);N&&(N.layerIndex=k,N.layerExtent=G.extent,(G=q[t])||(G=q[t]=[]),G.push(N))}}else N=this._createBucket(a),N.layerIndex=k,m.push(N);var M=10*this._level,R=10*(this._level+1),P=[],Q=[],T=[],O=[],S=this._tileClipper,H=new Set,Y={},W=[];r.forEach(function(a){return W.push(a)});var E=0,p=0,A=W.length;return b(function(){if(6===c._tile.status)return!0;switch(E){case 0:if(A>p){var a=W[p++],b=e[a],d=q[a];if(d&&0!==d.length)for(a=b.getData();a.next(2);){var g=
new f(a.getMessage(),b),h=g.values;if(h){var k=h._minzoom;if(k&&k>=R)continue;if((h=h._maxzoom)&&M>=h)continue}for(var k=0,l=d;k<l.length;k++)h=l[k],h.pushFeature(g)}}else{b=c._tile;for(a in q)for(d=q[a],g=0;g<d.length;g++)h=d[g],h.hasFeatures()&&(3===h.layer.type?(P.push(h),b.addBucket(h)):h.layer.refLayerId?T.push(h):(Q.push(h),O[h.layer.id]=h));E=1;p=0;A=P.length}break;case 1:A>p?P[p++].getResources(S,H,Y):E=2}return 2===E},50).then(function(){if(6===c._tile.status)return[];var a,e=[],f=c._tile.getWorkerTileHandler();
0<H.size&&(a=f.fetchSprites(H,c._connection),e.push(a));var g,k;for(k in Y)a=Y[k],0<a.size&&(g=f.fetchGlyphs(c._tile.tileKey,k,a,c._connection),e.push(g));return h(e).then(function(a){if(6===c._tile.status)return[];var d=0,e=0,f=Q.length;return b(function(){if(6===c._tile.status)return!0;switch(d){case 0:if(f>e){var a=Q[e++];a.processFeatures(S,c._tile);m.push(a)}else d=1,e=0,f=T.length;break;case 1:for(var b=0;b<T.length;b++){var a=T[b],g=O[a.layer.refLayerId];g&&(g.assignBufferInfo(a),m.push(a))}d=
2;e=0;f=P.length;break;case 2:f>e?(a=P[e++],a.processFeatures(S,c._tile),m.push(a)):d=3}return 3===d},50).then(function(){return m.sort(function(a,b){return a.layerIndex-b.layerIndex}),m})}).otherwise(function(a){return d.reject(Error(a))})}).otherwise(function(a){return d.reject(Error(a))})},l.prototype._parseTileData=function(a){for(var b={};a.next();)switch(a.tag()){case 3:var c=new k(a.getMessage());b[c.name]=c;break;default:a.skip()}return b},l.prototype._createBucket=function(a){switch(a.type){case 0:return this._createBackgroundBucket(a);
case 1:return this._createFillBucket(a);case 2:return this._createLineBucket(a);case 3:return this._createSymbolBucket(a)}},l.prototype._createBackgroundBucket=function(b){return new a(b,this._level)},l.prototype._createFillBucket=function(a){var b=this._tile;return new e(a,this._level,a.hasDataDrivenFill?b.fillDDVertexBuffer:b.fillVertexBuffer,b.fillIndexBuffer,a.hasDataDrivenOutline?b.outlineDDVertexBuffer:b.outlineVertexBuffer,b.outlineIndexBuffer)},l.prototype._createLineBucket=function(a){var b=
this._tile;return new c(a,this._level,a.hasDataDrivenLine?b.lineDDVertexBuffer:b.lineVertexBuffer,b.lineIndexBuffer)},l.prototype._createSymbolBucket=function(a){var b=this._tile;return new q(a,this._level,a.hasDataDrivenIcon?b.iconDDVertexBuffer:b.iconVertexBuffer,b.iconIndexBuffer,a.hasDataDrivenText?b.textDDVertexBuffer:b.textVertexBuffer,b.textIndexBuffer,b.placementEngine,b.getWorkerTileHandler())},l}()})},"esri/views/vectorTiles/SourceLayerData":function(){define(["require","exports"],function(m,
l){return function(){function h(d){this.extent=4096;this.keys=[];this.values=[];for(this._pbfLayer=d.clone();d.next();)switch(d.tag()){case 1:this.name=d.getString();break;case 3:this.keys.push(d.getString());break;case 4:this.values.push(h._parseValue(d.getMessage()));break;case 5:this.extent=d.getUInt32();break;default:d.skip()}}return h.prototype.getData=function(){return this._pbfLayer},h._parseValue=function(d){for(;d.next();)switch(d.tag()){case 1:return d.getString();case 2:return d.getFloat();
case 3:return d.getDouble();case 4:return d.getInt64();case 5:return d.getUInt64();case 6:return d.getSInt64();case 7:return d.getBool();default:d.skip()}return null},h}()})},"esri/views/vectorTiles/Feature":function(){define(["require","exports","../2d/engine/webgl/Geometry"],function(m,l,h){return function(){function d(b,d){this.values={};var g=d.keys;for(d=d.values;b.next();)switch(b.tag()){case 1:this.id=b.getUInt64();break;case 2:for(var f=b.getMessage(),a=this.values;!f.empty();){var e=f.getUInt32(),
c=f.getUInt32();a[g[e]]=d[c]}break;case 3:this.type=b.getUInt32();break;case 4:this._pbfGeometry=b.getMessage();break;default:b.skip()}}return d.prototype.getGeometry=function(b){if(void 0!==this._geometry)return this._geometry;var d,k,f=this._pbfGeometry;b?b.reset(this.type):d=[];for(var a=1,e=0,c=0,l=0;!f.empty();)switch(0===e&&(e=f.getUInt32(),a=7&e,e>>=3),e--,a){case 1:c+=f.getSInt32();l+=f.getSInt32();b?b.moveTo(c,l):(k&&d.push(k),k=[],k.push(new h.Point(c,l)));break;case 2:c+=f.getSInt32();
l+=f.getSInt32();b?b.lineTo(c,l):k.push(new h.Point(c,l));break;case 7:b?b.close():k&&!k[0].equals(c,l)&&k.push(k[0].clone());break;default:throw Error("Invalid path operation");}var m;return b?m=b.result():(k&&d.push(k),m=d),this._geometry=m,m},d}()})},"esri/views/vectorTiles/BackgroundBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper","./Bucket"],function(m,l,h,d,b){return function(b){function d(d,a){return b.call(this,d,a)||
this}return h(d,b),d}(b)})},"esri/views/vectorTiles/Bucket":function(){define(["require","exports"],function(m,l){return function(){function h(d,b){this.layerExtent=4096;this._features=[];this.layer=d;this.zoom=b;this._filter=d.getFeatureFilter()}return h.prototype.pushFeature=function(d){this._filter.filter(d)&&this._features.push(d)},h.prototype.hasFeatures=function(){return 0<this._features.length},h.prototype.processFeatures=function(d,b){},h.prototype.assignBufferInfo=function(d){},h}()})},"esri/views/vectorTiles/FillBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/ArrayPool ./Bucket ../2d/engine/webgl/Geometry ../../core/libs/earcut/earcut".split(" "),
function(m,l,h,d,b,g,k,f){return function(a){function d(b,d,e,f,g,h){d=a.call(this,b,d)||this;if(b.hasDataDrivenFill!==e.isDataDriven())throw Error("incompatible fill buffer");if(b.hasDataDrivenOutline!==g.isDataDriven())throw Error("incompatible outline buffer");return d._fillVertexBuffer=e,d._fillIndexBuffer=f,d._outlineVertexBuffer=g,d._outlineIndexBuffer=h,d}return h(d,a),Object.defineProperty(d.prototype,"fillIndexStart",{get:function(){return this._fillIndexStart},enumerable:!0,configurable:!0}),
Object.defineProperty(d.prototype,"fillIndexCount",{get:function(){return this._fillIndexCount},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"outlineIndexStart",{get:function(){return this._outlineIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"outlineIndexCount",{get:function(){return this._outlineIndexCount},enumerable:!0,configurable:!0}),d.prototype.assignBufferInfo=function(a){a._fillIndexStart=this._fillIndexStart;a._fillIndexCount=this._fillIndexCount;
a.layer.getPaintProperty("fill-outline-color")?(a._outlineIndexStart=this._outlineIndexStart,a._outlineIndexCount=this._outlineIndexCount):(a._outlineIndexStart=0,a._outlineIndexCount=0)},d.prototype.processFeatures=function(a,b){this._fillIndexStart=this._fillIndexBuffer.index;this._fillIndexCount=0;this._outlineIndexStart=this._outlineIndexBuffer.index;this._outlineIndexCount=0;b=this.layer;var c=this.zoom,d=b.hasDataDrivenFill,e=b.hasDataDrivenOutline;a&&a.setExtent(this.layerExtent);for(var f=
b.getPaintValue("fill-pattern",c),g=b.getPaintValue("fill-antialias",c)&&void 0===f,h=0,k=this._features;h<k.length;h++){var l=k[h],m=void 0;d&&(m={color:f?[1,1,1,1]:b.getPaintValue("fill-color",c,l),opacity:b.getPaintValue("fill-opacity",c,l)});var q=void 0;e&&(q={color:f?[1,1,1,1]:b.getPaintValue("fill-outline-color",c,l),opacity:b.getPaintValue("fill-opacity",c,l)});l=l.getGeometry(a);this._processFeature(l,g,m,q)}},d.prototype._processFeature=function(a,b,e,f){if(a){var c=a.length;if(b)for(b=
0;c>b;b++)this._processOutline(a[b],f);var g;for(b=0;c>b;b++)f=d._area(a[b]),128<f?(void 0!==g&&this._processFill(a,g,e),g=[b]):-128>f&&void 0!==g&&g.push(b);void 0!==g&&this._processFill(a,g,e)}},d.prototype._processOutline=function(a,b){var c,d,e,f=this._outlineVertexBuffer,g=this._outlineIndexBuffer,h=g.index,l=new k.Point(0,0),m=new k.Point(0,0),q=new k.Point(0,0),C=-1,B=-1,F=-1,G=-1,N=-1,M=!1,R=a.length;if(!(2>R)){for(var P=a[0],Q=a[R-1];R&&Q.isEqual(P);)--R,Q=a[R-1];if(!(2>R-0)){for(P=0;R>P;++P){0===
P?(c=a[R-1],d=a[0],e=a[1],l.assignSub(d,c),l.normalize(),l.rightPerpendicular()):(c=d,d=e,e=P!==R-1?a[P+1]:a[0],l.assign(m));Q=this._isClipEdge(c,d);-1===G&&(M=Q);m.assignSub(e,d);m.normalize();m.rightPerpendicular();var T=l.x*m.y-l.y*m.x;q.assignAdd(l,m);q.normalize();var O=-q.x*-l.x+-q.y*-l.y,O=Math.abs(0!==O?1/O:1);8<O&&(O=8);0<=T?(F=f.add(d.x,d.y,l.x,l.y,0,1,b),-1===G&&(G=F),0<=C&&0<=B&&0<=F&&!Q&&g.add(C,B,F),B=f.add(d.x,d.y,O*-q.x,O*-q.y,0,-1,b),-1===N&&(N=B),0<=C&&0<=B&&0<=F&&!Q&&g.add(C,B,
F),C=B,B=F,F=f.add(d.x,d.y,q.x,q.y,0,1,b),0<=C&&0<=B&&0<=F&&!Q&&g.add(C,B,F),B=f.add(d.x,d.y,m.x,m.y,0,1,b),0<=C&&0<=B&&0<=F&&!Q&&g.add(C,B,F)):(F=f.add(d.x,d.y,O*q.x,O*q.y,0,1,b),-1===G&&(G=F),0<=C&&0<=B&&0<=F&&!Q&&g.add(C,B,F),B=f.add(d.x,d.y,-l.x,-l.y,0,-1,b),-1===N&&(N=B),0<=C&&0<=B&&0<=F&&!Q&&g.add(C,B,F),C=B,B=F,F=f.add(d.x,d.y,-q.x,-q.y,0,-1,b),0<=C&&0<=B&&0<=F&&!Q&&g.add(C,B,F),C=f.add(d.x,d.y,-m.x,-m.y,0,-1,b),0<=C&&0<=B&&0<=F&&!Q&&g.add(C,B,F))}0<=C&&0<=B&&0<=G&&!M&&g.add(C,B,G);0<=C&&0<=
G&&0<=N&&!M&&g.add(C,N,G);this._outlineIndexCount+=3*(g.index-h)}}},d.prototype._processFill=function(a,d,e){var c;1<d.length&&(c=[]);for(var g=0,h=0;h<d.length;h++){var k=d[h];0!==g&&c.push(g);g+=a[k].length}for(var h=2*g,g=b.acquire(),l=0;l<d.length;l++)for(var k=d[l],k=a[k],m=k.length,q=0;m>q;++q)g.push(k[q].x),g.push(k[q].y);a=f(g,c,2);d=a.length;if(0<d){c=this._fillVertexBuffer.index;for(l=0;h>l;)this._fillVertexBuffer.add(g[l++],g[l++],e);for(e=0;d>e;)this._fillIndexBuffer.add(c+a[e++],c+a[e++],
c+a[e++]);this._fillIndexCount+=d}b.release(g)},d.prototype._isClipEdge=function(a,b){return a.x===b.x?-64>=a.x||4160<=a.x:a.y===b.y?-64>=a.y||4160<=a.y:!1},d._area=function(a){for(var b=0,c=a.length-1,d=0;c>d;d++)b+=(a[d].x-a[d+1].x)*(a[d].y+a[d+1].y);return b+=(a[c].x-a[0].x)*(a[c].y+a[0].y),.5*b},d}(g)})},"esri/core/libs/earcut/earcut":function(){define([],function(){function m(b,c,e){e=e||2;w=b.length/e+(c?2*c.length:0);z=!1;var f=c&&c.length,m=f?c[0]*e:b.length,n=l(b,0,m,e,!0),q=[];if(!n)return q;
var r,t,v,x;if(f)a:{var y=e,C,B,F;x=[];f=0;for(C=c.length;C>f;f++)B=c[f]*y,F=C-1>f?c[f+1]*y:b.length,B=l(b,B,F,y,!1),B===B.next&&(B.steiner=!0),x.push(a(B));x.sort(g);for(f=0;f<x.length;f++){if(!n){n=null;break a}c=x[f];y=n;if(y=k(c,y))c=u(y,c),h(c,c.next);n=h(n,n.next)}}if(z)return q;if(b.length>80*e){r=v=b[0];t=f=b[1];for(y=e;m>y;y+=e)x=b[y],c=b[y+1],r>x&&(r=x),t>c&&(t=c),x>v&&(v=x),c>f&&(f=c);v=Math.max(v-r,f-t)}return d(n,q,e,r,t,v),q}function l(a,b,c,d,e){var f;if(e===0<n(a,b,c,d))for(e=b;c>
e;e+=d)f=v(e,a[e],a[e+1],f);else for(e=c-d;e>=b;e-=d)f=v(e,a[e],a[e+1],f);return f&&q(f,f.next)&&(x(f),f=f.next),f}function h(a,b){if(!a)return a;b||(b=a);var d=a,e=0,f=w*w/2;do{if(a=!1,d.steiner||!q(d,d.next)&&0!==c(d.prev,d,d.next))d=d.next;else{if(x(d),d=b=d.prev,d===d.next)return null;a=!0}if(e++>f)return z=!0,null}while(a||d!==b);return b}function d(a,g,k,l,m,n,v){if(a){if(!v&&n){var w=a,y=w;do null===y.z&&(y.z=f(y.x,y.y,l,m,n)),y.prevZ=y.prev,y=y.nextZ=y.next;while(y!==w);y.prevZ.nextZ=null;
y.prevZ=null;var w=y,C,B,F,H,G,M,E=1;do{y=w;H=w=null;for(G=0;y;){G++;B=y;for(C=M=0;E>C&&(M++,B=B.nextZ,B);C++);for(C=E;0<M||0<C&&B;)0===M?(F=B,B=B.nextZ,C--):0!==C&&B?y.z<=B.z?(F=y,y=y.nextZ,M--):(F=B,B=B.nextZ,C--):(F=y,y=y.nextZ,M--),H?H.nextZ=F:w=F,F.prevZ=H,H=F;y=B}H.nextZ=null;E*=2}while(1<G)}for(y=a;a.prev!==a.next;){F=a.prev;w=a.next;if(n)a:{B=a;C=l;var p=m,A=n;H=B.prev;G=B;M=B.next;if(0<=c(H,G,M))B=!1;else{var K=H.x>G.x?H.x>M.x?H.x:M.x:G.x>M.x?G.x:M.x,N=H.y>G.y?H.y>M.y?H.y:M.y:G.y>M.y?G.y:
M.y,E=f(H.x<G.x?H.x<M.x?H.x:M.x:G.x<M.x?G.x:M.x,H.y<G.y?H.y<M.y?H.y:M.y:G.y<M.y?G.y:M.y,C,p,A);C=f(K,N,C,p,A);for(p=B.nextZ;p&&p.z<=C;){if(p!==B.prev&&p!==B.next&&e(H.x,H.y,G.x,G.y,M.x,M.y,p.x,p.y)&&0<=c(p.prev,p,p.next)){B=!1;break a}p=p.nextZ}for(p=B.prevZ;p&&p.z>=E;){if(p!==B.prev&&p!==B.next&&e(H.x,H.y,G.x,G.y,M.x,M.y,p.x,p.y)&&0<=c(p.prev,p,p.next)){B=!1;break a}p=p.prevZ}B=!0}}else B=b(a);if(B)g.push(F.i/k),g.push(a.i/k),g.push(w.i/k),x(a),y=a=w.next;else{if(z)break;if(a=w,a===y){if(v)if(1===
v){v=g;F=k;w=a;do y=w.prev,B=w.next.next,!q(y,B)&&t(y,w,w.next,B)&&r(y,B)&&r(B,y)&&(v.push(y.i/F),v.push(w.i/F),v.push(B.i/F),x(w),x(w.next),w=a=B),w=w.next;while(w!==a);a=w;d(a,g,k,l,m,n,2)}else{if(2===v)a:{v=a;do{for(F=v.next.next;F!==v.prev;){if(w=v.i!==F.i){w=v;y=F;B=void 0;if(B=w.next.i!==y.i&&w.prev.i!==y.i){B=void 0;b:{B=w;do{if(B.i!==w.i&&B.next.i!==w.i&&B.i!==y.i&&B.next.i!==y.i&&t(B,B.next,w,y)){B=!0;break b}B=B.next}while(B!==w);B=!1}B=!B}H=void 0;if(H=B&&r(w,y)&&r(y,w)){B=w;H=!1;G=(w.x+
y.x)/2;y=(w.y+y.y)/2;do B.y>y!=B.next.y>y&&G<(B.next.x-B.x)*(y-B.y)/(B.next.y-B.y)+B.x&&(H=!H),B=B.next;while(B!==w)}w=H}if(w){a=u(v,F);v=h(v,v.next);a=h(a,a.next);d(v,g,k,l,m,n);d(a,g,k,l,m,n);break a}F=F.next}v=v.next}while(v!==a)}}else d(h(a),g,k,l,m,n,1);break}}}}}function b(a){var b=a.prev,d=a.next;if(0<=c(b,a,d))return!1;for(var f=a.next.next,g=0;f!==a.prev;){if(e(b.x,b.y,a.x,a.y,d.x,d.y,f.x,f.y)&&0<=c(f.prev,f,f.next))return!1;if(f=f.next,g++>w)return z=!0,!1}return!0}function g(a,b){return a.x-
b.x}function k(a,b){var c,d=b,f=a.x,g=a.y,h=-(1/0);do{if(!d)return null;if(g<=d.y&&g>=d.next.y){var k=d.x+(g-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(f>=k&&k>h){if(h=k,k===f){if(g===d.y)return d;if(g===d.next.y)return d.next}c=d.x<d.next.x?d:d.next}}d=d.next}while(d!==b);if(!c)return null;if(f===h)return c.prev;var l;b=c;for(var k=c.x,m=c.y,n=1/0,d=c.next;d!==b;)f>=d.x&&d.x>=k&&e(m>g?f:h,g,k,m,m>g?h:f,g,d.x,d.y)&&(l=Math.abs(g-d.y)/(f-d.x),(n>l||l===n&&d.x>c.x)&&r(d,a)&&(c=d,n=l)),d=d.next;return c}
function f(a,b,c,d,e){return a=32767*(a-c)/e,b=32767*(b-d)/e,a=16711935&(a|a<<8),a=252645135&(a|a<<4),a=858993459&(a|a<<2),a=1431655765&(a|a<<1),b=16711935&(b|b<<8),b=252645135&(b|b<<4),b=858993459&(b|b<<2),b=1431655765&(b|b<<1),a|b<<1}function a(a){var b=a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function e(a,b,c,d,e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function c(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function q(a,
b){return a.x===b.x&&a.y===b.y}function t(a,b,d,e){return q(a,b)&&q(d,e)||q(a,e)&&q(d,b)?!0:0<c(a,b,d)!=0<c(a,b,e)&&0<c(d,e,a)!=0<c(d,e,b)}function r(a,b){return 0>c(a.prev,a,a.next)?0<=c(a,b,a.next)&&0<=c(a,a.prev,b):0>c(a,b,a.prev)||0>c(a,a.next,b)}function u(a,b){var c=new y(a.i,a.x,a.y),d=new y(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function v(a,b,c,d){a=new y(a,b,c);return d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=
a):(a.prev=a,a.next=a),a}function x(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function y(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function n(a,b,c,d){for(var e=0,f=c-d;c>b;b+=d)e+=(a[f]-a[b])*(a[b+1]+a[f+1]),f=b;return e}var w,z;return m.deviation=function(a,b,c,d){var e=b&&b.length,f=Math.abs(n(a,0,e?b[0]*c:a.length,c));if(e)for(var e=0,g=b.length;g>e;e++)f-=Math.abs(n(a,
b[e]*c,g-1>e?b[e+1]*c:a.length,c));for(e=b=0;e<d.length;e+=3){var g=d[e]*c,h=d[e+1]*c,k=d[e+2]*c;b+=Math.abs((a[g]-a[k])*(a[h+1]-a[g+1])-(a[g]-a[h])*(a[k+1]-a[g+1]))}return 0===f&&0===b?0:Math.abs((b-f)/f)},m.flatten=function(a){for(var b=a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,e=0;e<a.length;e++){for(var f=0;f<a[e].length;f++)for(var g=0;b>g;g++)c.vertices.push(a[e][f][g]);0<e&&(d+=a[e-1].length,c.holes.push(d))}return c},m})},"esri/views/vectorTiles/LineBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ./Bucket ../2d/engine/webgl/LineTess ./style/StyleLayer".split(" "),
function(m,l,h,d,b,g,k){var f=new g.Tessellator({distanceAlongCorrection:!0});return function(a){function b(b,d,e,f){d=a.call(this,b,d)||this;if(d.extrudeVectorsDoubleBuffer=[g.allocExtrudeVectors(),g.allocExtrudeVectors()],d.firstExtrudeVectors=g.allocExtrudeVectors(),d.recycledTriangleBridge=g.allocTriangles(20),d.recycledTrianglePie=g.allocTriangles(20),b.hasDataDrivenLine!==e.isDataDriven())throw Error("incompatible line buffer");return d._lineVertexBuffer=e,d._lineIndexBuffer=f,d}return h(b,
a),Object.defineProperty(b.prototype,"lineIndexStart",{get:function(){return this._lineIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"lineIndexCount",{get:function(){return this._lineIndexCount},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"connectorStart",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"connectorCount",{get:function(){return 0},enumerable:!0,configurable:!0}),b.prototype.assignBufferInfo=
function(a){a._lineIndexStart=this._lineIndexStart;a._lineIndexCount=this._lineIndexCount},b.prototype.processFeatures=function(a,b){this._lineIndexStart=this._lineIndexBuffer.index;this._lineIndexCount=0;b=this.layer;var c=this.zoom,d=b.hasDataDrivenLine;a&&a.setExtent(this.layerExtent);for(var e=b.getPaintValue("line-pattern",c),f=0,g=this._features;f<g.length;f++){var h=g[f],l=new k.LineLayout(b,c,h),m=void 0;d&&(m={color:e?[1,1,1,1]:b.getPaintValue("line-color",c,h),opacity:b.getPaintValue("line-opacity",
c,h),size:Math.max(Math.min(b.getPaintValue("line-width",c,h),256),0)},0>=m.size||0>=m.opacity||0>=m.color[3])||(h=h.getGeometry(a),this._processFeature(l,h,m))}},b.prototype._processFeature=function(a,b,d){if(b)for(var c=b.length,e=0;c>e;e++)this._processGeometry(b[e],a,d)},b.prototype._processGeometry=function(a,b,d){if(!(2>a.length)){for(var c=a[0],e=a[a.length-1],f=e.x-c.x,e=e.y-c.y,c=1E-6>f*f+e*e,h=a[0],k=1;k<a.length;)f=a[k].x-h.x,e=a[k].y-h.y,1E-6>f*f+e*e?a.splice(k,1):(h=a[k],++k);if(!(2>
a.length)){this.vertices=a;this.verticesLen=a.length;this.isClosed=c;this.cap=b.cap;this.join=b.join;this.almostParallelRads=.05;this.veryShallowRads=.1;this.miterSafeRads=g.MITER_SAFE_RADS;this.miterLimitMag=Math.min(b.miterLimit,g.SYSTEM_MAG_LIMIT);this.roundLimitRads=Math.min(b.roundLimit,.5);this.newRoundJoinsSafeRads=2.3;b=this._lineIndexBuffer.index;for(var f=0,l=void 0,e=this.verticesLen,h=0;e>h;++h){var k=a[h],m=a[(h+e-1)%e],q=c&&this._isClipEdge(m,k),m=l===this.extrudeVectorsDoubleBuffer[h%
2]?this.extrudeVectorsDoubleBuffer[(h+1)%2]:this.extrudeVectorsDoubleBuffer[h%2];if(e-1>h||!c||this.hasPattern?(this._computeExtrudeVectors(m,h),this._writeGPUVertices(k.x,k.y,f,m,d),!m.capCenter||c&&h===e-1||this._writeGPUPieElements(m,q),c&&0===h&&!this.hasPattern&&g.copyExtrudeVectors(this.firstExtrudeVectors,m)):g.copyExtrudeVectors(m,this.firstExtrudeVectors),l&&this._writeGPUBridgeElements(l,m,q),e-1>h)l=a[h+1],k=g.length([l.x-k.x,l.y-k.y]),f+=k;l=m}this._lineIndexCount+=3*(this._lineIndexBuffer.index-
b)}}},b.prototype._computeExtrudeVectors=function(a,b){var c=this.vertices,d=this.verticesLen,e=this.isClosed,f=c[b],h=[void 0,void 0],k=[void 0,void 0];if(0<b&&d-1>b){var l=c[(b+d-1)%d],m=c[(b+1)%d];g.normalize(h,[f.x-l.x,f.y-l.y]);g.normalize(k,[m.x-f.x,m.y-f.y])}else if(0===b)m=c[(b+1)%d],(g.normalize(k,[m.x-f.x,m.y-f.y]),e)?(c=c[d-2],g.normalize(h,[f.x-c.x,f.y-c.y])):h=k;else{if(b!==d-1)return void console.error("Vertex index 'i' out of range.");l=c[(b+d-1)%d];(g.normalize(h,[f.x-l.x,f.y-l.y]),
e)?(c=c[1],g.normalize(k,[c.x-f.x,c.y-f.y])):k=h}e||0!==b?e||b!==d-1?this._computeJoinExtrudeVectors(a,h,k):this._computeCapExtrudeVectors(a,h,k,g.CapPosition.END):this._computeCapExtrudeVectors(a,h,k,g.CapPosition.START)},b.prototype._computeCapExtrudeVectors=function(a,b,d,e){0===this.cap?f.buttCap(a,b,d):1===this.cap?f.roundCap(a,b,d,e,g.getNumberOfSlices(Math.PI),e===g.CapPosition.START?-1:1):2===this.cap?f.squareCap(a,b,d,e):f.buttCap(a,b,d)},b.prototype._computeJoinExtrudeVectors=function(a,
b,d){var c=g.getRads(b,d);if(c>Math.PI-this.almostParallelRads)f.rectJoin(a,b,d);else if(0===this.join&&c>=this.veryShallowRads)f.bevelJoin(a,b,d,1);else if(1===this.join&&c>=this.veryShallowRads){var e=g.getNumberOfSlices(c);c<this.newRoundJoinsSafeRads?2>e||c<this.roundLimitRads?f.bevelJoin(a,b,d,1):f.roundJoin(a,b,d,e):f.unitRoundJoin(a,b,d,e)}else c<this.almostParallelRads?f.fastMiterJoin(a,b,d):c<this.miterSafeRads?f.miterJoin(a,b,d):f.bevelJoin(a,b,d,this.miterLimitMag)},b.prototype._writeGPUVertices=
function(a,b,d,e,f){for(var c=0;c<e.vectors.count;++c){var g=e.vectors.items[c].vector[0],h=e.vectors.items[c].vector[1],k=e.vectors.items[c].texCoords[0],l=e.vectors.items[c].texCoords[1];e.vectors.items[c].base=this._lineVertexBuffer.index;this._lineVertexBuffer.add(a,b,g,h,k,l,d,f)}},b.prototype._writeGPUBridgeElements=function(a,b,d){if(f.bridge(this.recycledTriangleBridge,a,b),!d)for(a=0;a<this.recycledTriangleBridge.count;++a)b=this.recycledTriangleBridge.items[a],this._lineIndexBuffer.add(b.v1.base,
b.v2.base,b.v3.base)},b.prototype._writeGPUPieElements=function(a,b){if(f.pie(this.recycledTrianglePie,a),!b)for(a=0;a<this.recycledTrianglePie.count;++a)b=this.recycledTrianglePie.items[a],this._lineIndexBuffer.add(b.v1.base,b.v2.base,b.v3.base)},b.prototype._isClipEdge=function(a,b){return a.x===b.x?-64>=a.x||4160<=a.x:a.y===b.y?-64>=a.y||4160<=a.y:!1},b}(b)})},"esri/views/2d/engine/webgl/LineTess":function(){define(["require","exports"],function(m,l){function h(a){var b,c={items:[],count:0};for(b=
0;a>b;++b)c.items.push(void 0);return c}function d(a,b){w.vector[0]=a.vector[0];w.vector[1]=a.vector[1];w.texCoords[0]=a.texCoords[0];w.texCoords[1]=a.texCoords[1];w.direction[0]=a.direction[0];w.direction[1]=a.direction[1];w.base=a.base;a.vector[0]=b.vector[0];a.vector[1]=b.vector[1];a.texCoords[0]=b.texCoords[0];a.texCoords[1]=b.texCoords[1];a.direction[0]=b.direction[0];a.direction[1]=b.direction[1];a.base=b.base;b.vector[0]=w.vector[0];b.vector[1]=w.vector[1];b.texCoords[0]=w.texCoords[0];b.texCoords[1]=
w.texCoords[1];b.direction[0]=w.direction[0];b.direction[1]=w.direction[1];b.base=w.base}function b(a,b){return a[0]*b[0]+a[1]*b[1]}function g(a){return Math.sqrt(b(a,a))}function k(a,b){var c=g(b);return a[0]=b[0]/c,a[1]=b[1]/c,a}function f(a,b){return a[0]=-b[1],a[1]=b[0],a}function a(a,b){return a[0]*b[1]-a[1]*b[0]}function e(a,b){return a[0]=-b[0],a[1]=-b[1],a}function c(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a}function q(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a}function t(a,c){a=b(a,c);return.999<
a?0:-.999>a?Math.PI:Math.acos(a)}function r(a,b,d,e,f){if(0===e)return void(a.count=0);var h=g(b),k=c(z[0],b,1/h);d=c(z[1],d,1/h);k=t(k,d);k=(f?-1:1)*k/e;f=Math.cos(k);k=Math.sin(k);d=b[0];var l=b[1];for(b=0;e-1>b;++b)h=d,d=f*h-k*l,l=k*h+f*l,a.items[b][0]=d,a.items[b][1]=l;a.count=e-1}function u(a){var b,c=a.count,d=Math.floor(c/2);for(b=0;d>b;++b){var e=a.items[b];a.items[b]=a.items[c-b-1];a.items[c-b-1]=e}}Object.defineProperty(l,"__esModule",{value:!0});var v;!function(a){a[a.ENTRY=1]="ENTRY";
a[a.EXIT=2]="EXIT";a[a.CAP=3]="CAP"}(v=l.VectorRole||(l.VectorRole={}));var x;!function(a){a[a.START=1]="START";a[a.END=2]="END"}(x=l.CapPosition||(l.CapPosition={}));l.SYSTEM_MAG_LIMIT=3.8;l.MITER_SAFE_RADS=2*Math.acos(1/l.SYSTEM_MAG_LIMIT);var y=l.SYSTEM_MAG_LIMIT*l.SYSTEM_MAG_LIMIT,n=16/(2*Math.PI);l.allocTriangles=function(a){var b,c={items:[],count:0};for(b=0;a>b;++b)c.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,
void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return c};l.allocExtrudeVectors=function(){var a,b={items:[],count:0};for(a=0;30>a;++a)b.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});a={};a[v.ENTRY]=h(20);a[v.EXIT]=h(20);a[v.CAP]=h(20);return{vectors:b,lists:a}};l.copyExtrudeVectors=function(a,b){var c;for(c=0;c<b.vectors.count;++c)a.vectors.items[c].vector[0]=b.vectors.items[c].vector[0],
a.vectors.items[c].vector[1]=b.vectors.items[c].vector[1],a.vectors.items[c].texCoords[0]=b.vectors.items[c].texCoords[0],a.vectors.items[c].texCoords[1]=b.vectors.items[c].texCoords[1],a.vectors.items[c].direction[0]=b.vectors.items[c].direction[0],a.vectors.items[c].direction[1]=b.vectors.items[c].direction[1],a.vectors.items[c].base=b.vectors.items[c].base;a.vectors.count=b.vectors.count;var d=b.lists[v.ENTRY],e=a.lists[v.ENTRY],f=b.lists[v.EXIT],g=a.lists[v.EXIT],h=b.lists[v.CAP],k=a.lists[v.CAP];
for(c=0;c<d.count;++c)e.items[c]=d.items[c];e.count=d.count;for(c=0;c<f.count;++c)g.items[c]=f.items[c];g.count=f.count;for(c=0;c<h.count;++c)k.items[c]=h.items[c];k.count=h.count;a.capCenter=b.capCenter};var w={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};l.swapExtrudeVectors=d;var z=[];for(m=0;32>m;++m)z.push([void 0,void 0]);var C=function(a){var b,c={items:[],count:0};for(b=0;a>b;++b)c.items.push([void 0,void 0]);return c}(16);l.length=g;l.normalize=
k;l.getNumberOfSlices=function(a){return Math.max(Math.round(a*n),1)};l.getRads=t;l.reverse=u;var B=[void 0,void 0],F=[void 0,void 0],G=[0,0],N=[0,0],M=[0,0],R=[0,0],P=Math.cos(Math.PI/4),Q=Math.sin(Math.PI/4),T=Math.sqrt(2);m=function(){function g(a){this._distanceAlongCorrection=a.distanceAlongCorrection}return g.prototype.bridge=function(a,b,c){var e,f,g=b.vectors,h=b.lists[v.EXIT];f=c.vectors;var k=c.lists[v.ENTRY];if(h.count===k.count+1)c=h.items,b=g.items,e=k.items,f=f.items;else{if(k.count!==
h.count+1&&h.count!==k.count)return console.error("Cannot bridge "+h.count+" to "+k.count+"."),void(a.count=0);c=k.items;b=f.items;e=h.items;f=g.items}g=h.count+k.count-2;a.count=g;B[0]=c;B[1]=e;F[0]=b;F[1]=f;for(c=0;g>c;++c)b=a.items[c],e=(c+0)%2,e=F[e][B[e][Math.floor((c+0)/2)]],b.v1.vector[0]=e.vector[0],b.v1.vector[1]=e.vector[1],b.v1.texCoords[0]=e.texCoords[0],b.v1.texCoords[1]=e.texCoords[1],b.v1.direction[0]=e.direction[0],b.v1.direction[1]=e.direction[1],b.v1.base=e.base,e=(c+1)%2,e=F[e][B[e][Math.floor((c+
1)/2)]],b.v2.vector[0]=e.vector[0],b.v2.vector[1]=e.vector[1],b.v2.texCoords[0]=e.texCoords[0],b.v2.texCoords[1]=e.texCoords[1],b.v2.direction[0]=e.direction[0],b.v2.direction[1]=e.direction[1],b.v2.base=e.base,e=(c+2)%2,e=F[e][B[e][Math.floor((c+2)/2)]],b.v3.vector[0]=e.vector[0],b.v3.vector[1]=e.vector[1],b.v3.texCoords[0]=e.texCoords[0],b.v3.texCoords[1]=e.texCoords[1],b.v3.direction[0]=e.direction[0],b.v3.direction[1]=e.direction[1],b.v3.base=e.base,e=b.v1.base&&b.v1.base.point||G,h=b.v2.base&&
b.v2.base.point||G,f=b.v3.base&&b.v3.base.point||G,N[0]=e[0]+b.v1.vector[0],N[1]=e[1]+b.v1.vector[1],M[0]=h[0]+b.v2.vector[0],M[1]=h[1]+b.v2.vector[1],R[0]=f[0]+b.v3.vector[0],R[1]=f[1]+b.v3.vector[1],0>(M[0]-N[0])*(R[1]-N[1])-(R[0]-N[0])*(M[1]-N[1])||d(b.v2,b.v3)},g.prototype.pie=function(a,b){if(0===b.lists[v.CAP].count)return void(a.count=0);if(1===b.lists[v.CAP].count)return console.error("A single vector is not enough to define a pie."),void(a.count=0);a.count=b.lists[v.CAP].count-1;var c;for(c=
0;c<a.count;++c){var e=a.items[c],f=b.vectors.items[b.lists[v.CAP].items[c]];e.v1.vector[0]=f.vector[0];e.v1.vector[1]=f.vector[1];e.v1.texCoords[0]=f.texCoords[0];e.v1.texCoords[1]=f.texCoords[1];e.v1.direction[0]=f.direction[0];e.v1.direction[1]=f.direction[1];e.v1.base=f.base;f=b.vectors.items[b.lists[v.CAP].items[c+1]];e.v2.vector[0]=f.vector[0];e.v2.vector[1]=f.vector[1];e.v2.texCoords[0]=f.texCoords[0];e.v2.texCoords[1]=f.texCoords[1];e.v2.direction[0]=f.direction[0];e.v2.direction[1]=f.direction[1];
e.v2.base=f.base;f=b.vectors.items[b.capCenter];e.v3.vector[0]=f.vector[0];e.v3.vector[1]=f.vector[1];e.v3.texCoords[0]=f.texCoords[0];e.v3.texCoords[1]=f.texCoords[1];e.v3.direction[0]=f.direction[0];e.v3.direction[1]=f.direction[1];e.v3.base=f.base;var f=e.v1.base&&e.v1.base.point||G,g=e.v2.base&&e.v2.base.point||G,h=e.v3.base&&e.v3.base.point||G;N[0]=f[0]+e.v1.vector[0];N[1]=f[1]+e.v1.vector[1];M[0]=g[0]+e.v2.vector[0];M[1]=g[1]+e.v2.vector[1];R[0]=h[0]+e.v3.vector[0];R[1]=h[1]+e.v3.vector[1];
0>(M[0]-N[0])*(R[1]-N[1])-(R[0]-N[0])*(M[1]-N[1])||d(e.v2,e.v3)}},g.prototype.buttCap=function(a,b,c){this.fastMiterJoin(a,b,c)},g.prototype.roundCap=function(a,b,c,d,e,f){void 0===f&&(f=0);this.fastMiterJoin(a,b,c);c=d===x.START?0:1;d=d===x.START?1:0;a.capCenter=a.vectors.count;b=a.vectors.items[a.capCenter];b.vector[0]=0;b.vector[1]=0;b.texCoords[0]=0;b.texCoords[1]=0;b.direction[0]=0;b.direction[1]=0;++a.vectors.count;r(C,a.vectors.items[c].vector,a.vectors.items[d].vector,e,!1);e=a.vectors.count;
b=a.lists[v.CAP];b.items[0]=c;var g=a.vectors.items[c].texCoords[1],h=a.vectors.items[d].texCoords[1];for(c=0;c<C.count;++c){var k=f*(1-Math.abs(C.count/2-c)/(C.count/2)),l=g+c/(C.count-1)*(h-g),m=C.items[c],n=a.vectors.items[e+c];n.vector[0]=m[0];n.vector[1]=m[1];n.texCoords[0]=k;n.texCoords[1]=l;n.direction[0]=0;n.direction[1]=0;b.items[c+1]=e+c}b.items[C.count+1]=d;b.count=C.count+2;a.vectors.count=e+C.count},g.prototype.squareCap=function(a,b,d,e){this.fastMiterJoin(a,b,d);b=e===x.START?0:1;d=
e===x.START?1:0;var f=z[0],g=z[1],h=z[2],k=z[3];e=z[4];var l=a.vectors.items[b].vector;f[0]=P*l[0]-Q*l[1];f[1]=Q*l[0]+P*l[1];c(k,f,T);g[0]=P*f[0]-Q*f[1];g[1]=Q*f[0]+P*f[1];h[0]=P*g[0]-Q*g[1];h[1]=Q*g[0]+P*g[1];c(e,h,T);b=a.vectors.items[b];b.vector[0]=k[0];b.vector[1]=k[1];a=a.vectors.items[d];a.vector[0]=e[0];a.vector[1]=e[1]},g.prototype.fastMiterJoin=function(a,b,c){c=f(z[0],c);b=e(z[1],c);var d=a.vectors.items[0];d.vector[0]=c[0];d.vector[1]=c[1];d.texCoords[0]=0;d.texCoords[1]=-1;d.direction[0]=
0;d.direction[1]=0;c=a.vectors.items[1];c.vector[0]=b[0];c.vector[1]=b[1];c.texCoords[0]=0;c.texCoords[1]=1;c.direction[0]=0;c.direction[1]=0;a.vectors.count=2;b=a.lists[v.ENTRY];b.items[0]=0;b.items[1]=1;b.count=2;b=a.lists[v.EXIT];b.items[0]=0;b.items[1]=1;b.count=2;a.lists[v.CAP].count=0;a.capCenter=void 0},g.prototype.miterJoin=function(a,d,g){var h=f(z[0],d),l=f(z[1],g),m=z[2];m[0]=h[0]+l[0];m[1]=h[1]+l[1];l=k(z[3],m);h=b(l,h);l=c(z[4],l,1/h);h=e(z[5],l);this._distanceAlongCorrection?(m=a.vectors.items[0],
m.vector[0]=l[0],m.vector[1]=l[1],m.texCoords[0]=0,m.texCoords[1]=-1,m.direction[0]=d[0],m.direction[1]=d[1],m=a.vectors.items[1],m.vector[0]=h[0],m.vector[1]=h[1],m.texCoords[0]=0,m.texCoords[1]=1,m.direction[0]=d[0],m.direction[1]=d[1],d=a.vectors.items[2],d.vector[0]=l[0],d.vector[1]=l[1],d.texCoords[0]=0,d.texCoords[1]=-1,d.direction[0]=g[0],d.direction[1]=g[1],d=a.vectors.items[3],d.vector[0]=h[0],d.vector[1]=h[1],d.texCoords[0]=0,d.texCoords[1]=1,d.direction[0]=g[0],d.direction[1]=g[1],a.vectors.count=
4,g=a.lists[v.ENTRY],g.items[0]=0,g.items[1]=1,g.count=2,g=a.lists[v.EXIT],g.items[0]=2,g.items[1]=3):(m=a.vectors.items[0],m.vector[0]=l[0],m.vector[1]=l[1],m.texCoords[0]=0,m.texCoords[1]=-1,m.direction[0]=0,m.direction[1]=0,m=a.vectors.items[1],m.vector[0]=h[0],m.vector[1]=h[1],m.texCoords[0]=0,m.texCoords[1]=1,m.direction[0]=0,m.direction[1]=0,a.vectors.count=2,g=a.lists[v.ENTRY],g.items[0]=0,g.items[1]=1,g.count=2,g=a.lists[v.EXIT],g.items[0]=0,g.items[1]=1);g.count=2;a.lists[v.CAP].count=0;
a.capCenter=void 0},g.prototype.bevelJoin=function(d,g,h,l){var m=l*l;l=a(g,h);var n=0<l?[-1,1]:[1,-1],r=n[0],n=n[1],t=0<l?e(z[0],f(z[1],g)):f(z[2],g),w=0<l?e(z[3],f(z[4],h)):f(z[5],h),x=z[6];x[0]=t[0]+w[0];x[1]=t[1]+w[1];var B=k(z[7],x),C=e(z[8],B),F=b(B,t),x=a(B,t),H=Math.abs(x/F),x=1+H*H,G=y>x?[H,this._distanceAlongCorrection]:[Math.sqrt(y-1),!0],M=G[0],G=G[1],N=m>x?[H,this._distanceAlongCorrection]:[Math.sqrt(m-1),!0],H=N[0];(N=N[1])&&G?(G=d.vectors.items[0],q(G.vector,e(z[9],t),c(z[10],e(z[11],
g),M)),G.texCoords[0]=0,G.texCoords[1]=r,G.direction[0]=this._distanceAlongCorrection?g[0]:0,G.direction[1]=this._distanceAlongCorrection?g[1]:0,C=d.vectors.items[1],q(C.vector,e(z[12],w),c(z[13],h,M)),C.texCoords[0]=0,C.texCoords[1]=r,C.direction[0]=this._distanceAlongCorrection?h[0]:0,C.direction[1]=this._distanceAlongCorrection?h[1]:0,r=d.vectors.items[2],r.vector[0]=0,r.vector[1]=0,r.texCoords[0]=0,r.texCoords[1]=0,r.direction[0]=0,r.direction[1]=0,r=d.vectors.items[3],q(r.vector,t,c(z[14],g,
H)),r.texCoords[0]=0,r.texCoords[1]=n,r.direction[0]=this._distanceAlongCorrection?g[0]:0,r.direction[1]=this._distanceAlongCorrection?g[1]:0,g=d.vectors.items[4],q(g.vector,w,c(z[15],e(z[16],h),H)),g.texCoords[0]=0,g.texCoords[1]=n,g.direction[0]=this._distanceAlongCorrection?h[0]:0,g.direction[1]=this._distanceAlongCorrection?h[1]:0,d.vectors.count=5,h=d.lists[v.ENTRY],h.items[0]=0,h.items[1]=2,h.items[2]=3,h.count=3,h=d.lists[v.EXIT],(h.items[0]=1,h.items[1]=2,h.items[2]=4,h.count=3,m>x)?(m=d.lists[v.CAP],
m.count=0,d.capCenter=void 0):(m=d.lists[v.CAP],m.items[0]=3,m.items[1]=4,m.count=2,d.capCenter=2)):!N&&G?(G=d.vectors.items[0],q(G.vector,e(z[9],t),c(z[10],e(z[11],g),M)),G.texCoords[0]=0,G.texCoords[1]=r,G.direction[0]=this._distanceAlongCorrection?g[0]:0,G.direction[1]=this._distanceAlongCorrection?g[1]:0,C=d.vectors.items[1],q(C.vector,e(z[12],w),c(z[13],h,M)),C.texCoords[0]=0,C.texCoords[1]=r,C.direction[0]=this._distanceAlongCorrection?h[0]:0,C.direction[1]=this._distanceAlongCorrection?h[1]:
0,r=d.vectors.items[2],r.vector[0]=0,r.vector[1]=0,r.texCoords[0]=0,r.texCoords[1]=0,r.direction[0]=0,r.direction[1]=0,r=d.vectors.items[3],c(r.vector,B,1/F),r.texCoords[0]=0,r.texCoords[1]=n,r.direction[0]=0,r.direction[1]=0,d.vectors.count=4,h=d.lists[v.ENTRY],h.items[0]=0,h.items[1]=2,h.items[2]=3,h.count=3,h=d.lists[v.EXIT],h.items[0]=1,h.items[1]=2,h.items[2]=3,h.count=3,d.lists[v.CAP].count=0,d.capCenter=void 0):N&&!G?(G=d.vectors.items[0],c(G.vector,C,1/F),G.texCoords[0]=0,G.texCoords[1]=r,
G.direction[0]=0,G.direction[1]=0,C=d.vectors.items[1],C.vector[0]=0,C.vector[1]=0,C.texCoords[0]=0,C.texCoords[1]=0,C.direction[0]=0,C.direction[1]=0,r=d.vectors.items[2],q(r.vector,t,c(z[9],g,H)),r.texCoords[0]=0,r.texCoords[1]=n,r.direction[0]=this._distanceAlongCorrection?g[0]:0,r.direction[1]=this._distanceAlongCorrection?g[1]:0,r=d.vectors.items[3],q(r.vector,w,c(z[10],e(z[11],h),H)),r.texCoords[0]=0,r.texCoords[1]=n,r.direction[0]=this._distanceAlongCorrection?h[0]:0,r.direction[1]=this._distanceAlongCorrection?
h[1]:0,d.vectors.count=4,h=d.lists[v.ENTRY],h.items[0]=0,h.items[1]=1,h.items[2]=2,h.count=3,h=d.lists[v.EXIT],(h.items[0]=0,h.items[1]=1,h.items[2]=3,h.count=3,m>x)?(m=d.lists[v.CAP],m.count=0,d.capCenter=void 0):(m=d.lists[v.CAP],m.items[0]=2,m.items[1]=3,m.count=2,d.capCenter=1)):N||G||(G=d.vectors.items[0],c(G.vector,C,1/F),G.texCoords[0]=0,G.texCoords[1]=r,G.direction[0]=0,G.direction[1]=0,C=d.vectors.items[1],c(C.vector,B,1/F),C.texCoords[0]=0,C.texCoords[1]=n,C.direction[0]=0,C.direction[1]=
0,d.vectors.count=2,h=d.lists[v.ENTRY],h.items[0]=0,h.items[1]=1,h.count=2,h=d.lists[v.EXIT],h.items[0]=0,h.items[1]=1,h.count=2,d.lists[v.CAP].count=0,d.capCenter=void 0);0>l&&(u(d.lists[v.ENTRY]),u(d.lists[v.EXIT]))},g.prototype.roundJoin=function(d,g,h,l){var m=a(g,h),n=0<m?[-1,1]:[1,-1],t=n[0],n=n[1],w=0<m?e(z[0],f(z[1],g)):f(z[2],g),x=0<m?e(z[3],f(z[4],h)):f(z[5],h),B=z[6];B[0]=w[0]+x[0];B[1]=w[1]+x[1];var F=k(z[7],B),B=e(z[8],F),H=b(F,w),F=a(F,w),F=Math.abs(F/H),G=y>1+F*F?[F,this._distanceAlongCorrection]:
[Math.sqrt(y-1),!0],F=G[0];G[1]?(G=d.vectors.items[0],G.vector[0]=w[0],G.vector[1]=w[1],G.texCoords[0]=0,G.texCoords[1]=n,G.direction[0]=0,G.direction[1]=0,G=d.vectors.items[1],G.vector[0]=x[0],G.vector[1]=x[1],G.texCoords[0]=0,G.texCoords[1]=n,G.direction[0]=0,G.direction[1]=0,G=d.vectors.items[2],q(G.vector,e(z[9],w),c(z[10],e(z[11],g),F)),G.texCoords[0]=0,G.texCoords[1]=t,G.direction[0]=this._distanceAlongCorrection?g[0]:0,G.direction[1]=this._distanceAlongCorrection?g[1]:0,g=d.vectors.items[3],
q(g.vector,e(z[12],x),c(z[13],h,F)),g.texCoords[0]=0,g.texCoords[1]=t,g.direction[0]=this._distanceAlongCorrection?h[0]:0,g.direction[1]=this._distanceAlongCorrection?h[1]:0,h=d.vectors.items[4],h.vector[0]=0,h.vector[1]=0,h.texCoords[0]=0,h.texCoords[1]=0,h.direction[0]=0,h.direction[1]=0,d.vectors.count=5,h=d.lists[v.ENTRY],h.items[0]=2,h.items[1]=4,h.items[2]=0,h.count=3,h=d.lists[v.EXIT],h.items[0]=3,h.items[1]=4,h.items[2]=1,h.count=3,d.capCenter=4):(G=d.vectors.items[0],G.vector[0]=w[0],G.vector[1]=
w[1],G.texCoords[0]=0,G.texCoords[1]=n,G.direction[0]=0,G.direction[1]=0,G=d.vectors.items[1],G.vector[0]=x[0],G.vector[1]=x[1],G.texCoords[0]=0,G.texCoords[1]=n,G.direction[0]=0,G.direction[1]=0,G=d.vectors.items[2],c(G.vector,B,1/H),G.texCoords[0]=0,G.texCoords[1]=t,G.direction[0]=0,G.direction[1]=0,g=d.vectors.items[3],g.vector[0]=0,g.vector[1]=0,g.texCoords[0]=0,g.texCoords[1]=0,g.direction[0]=0,g.direction[1]=0,d.vectors.count=4,h=d.lists[v.ENTRY],h.items[0]=2,h.items[1]=3,h.items[2]=0,h.count=
3,h=d.lists[v.EXIT],h.items[0]=2,h.items[1]=3,h.items[2]=1,h.count=3,d.capCenter=3);r(C,w,x,l,0>m);l=d.vectors.count;w=d.lists[v.CAP];for(x=w.items[0]=0;x<C.count;++x)h=C.items[x],t=d.vectors.items[l+x],t.vector[0]=h[0],t.vector[1]=h[1],t.texCoords[0]=0,t.texCoords[1]=n,t.direction[0]=0,t.direction[1]=0,w.items[x+1]=l+x;w.items[C.count+1]=1;w.count=C.count+2;d.vectors.count=l+C.count;0>m&&(u(d.lists[v.ENTRY]),u(d.lists[v.EXIT]))},g.prototype.unitRoundJoin=function(b,c,d,g){var h=a(c,d),k=0<h?[-1,
1]:[1,-1],l=k[0],k=k[1];c=0<h?e(z[0],f(z[1],c)):f(z[2],c);d=0<h?e(z[3],f(z[4],d)):f(z[5],d);var m=b.vectors.items[0];m.vector[0]=c[0];m.vector[1]=c[1];m.texCoords[0]=0;m.texCoords[1]=k;m.direction[0]=0;m.direction[1]=0;m=b.vectors.items[1];m.vector[0]=d[0];m.vector[1]=d[1];m.texCoords[0]=0;m.texCoords[1]=k;m.direction[0]=0;m.direction[1]=0;m=b.vectors.items[2];e(m.vector,c);m.texCoords[0]=0;m.texCoords[1]=l;m.direction[0]=0;m.direction[1]=0;m=b.vectors.items[3];e(m.vector,d);m.texCoords[0]=0;m.texCoords[1]=
l;m.direction[0]=0;m.direction[1]=0;l=b.vectors.items[4];l.vector[0]=0;l.vector[1]=0;l.texCoords[0]=0;l.texCoords[1]=0;l.direction[0]=0;l.direction[1]=0;b.vectors.count=5;l=b.lists[v.ENTRY];l.items[0]=2;l.items[1]=0;l.count=2;l=b.lists[v.EXIT];l.items[0]=3;l.items[1]=1;l.count=2;b.capCenter=4;r(C,c,d,g,0>h);g=b.vectors.count;c=b.lists[v.CAP];for(l=c.items[0]=0;l<C.count;++l)d=C.items[l],m=b.vectors.items[g+l],m.vector[0]=d[0],m.vector[1]=d[1],m.texCoords[0]=0,m.texCoords[1]=k,m.direction[0]=0,m.direction[1]=
0,c.items[l+1]=g+l;c.items[C.count+1]=1;c.count=C.count+2;b.vectors.count=g+C.count;0>h&&(u(b.lists[v.ENTRY]),u(b.lists[v.EXIT]))},g.prototype.rectJoin=function(a,b,c){b=f(z[0],b);c=f(z[1],c);var d=a.vectors.items[0];d.vector[0]=b[0];d.vector[1]=b[1];d.texCoords[0]=0;d.texCoords[1]=-1;d.direction[0]=0;d.direction[1]=0;d=a.vectors.items[1];d.vector[0]=c[0];d.vector[1]=c[1];d.texCoords[0]=0;d.texCoords[1]=-1;d.direction[0]=0;d.direction[1]=0;d=a.vectors.items[2];e(d.vector,b);d.texCoords[0]=0;d.texCoords[1]=
1;d.direction[0]=0;d.direction[1]=0;b=a.vectors.items[3];e(b.vector,c);b.texCoords[0]=0;b.texCoords[1]=1;b.direction[0]=0;b.direction[1]=0;a.vectors.count=4;b=a.lists[v.ENTRY];b.items[0]=0;b.items[1]=2;b.count=2;b=a.lists[v.EXIT];b.items[0]=1;b.items[1]=3;b.count=2;a.capCenter=void 0},g}();l.Tessellator=m})},"esri/views/vectorTiles/SymbolBucket":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ./Bucket ../2d/engine/webgl/Geometry ./style/StyleLayer ./Placement ./GeometryUtils ./TextShaping dojox/string/BidiEngine".split(" "),
function(m,l,h,d,b,g,k,f,a,e,c){function q(a,b){return a.iconMosaicItem&&b.iconMosaicItem?a.iconMosaicItem.page===b.iconMosaicItem.page?0:a.iconMosaicItem.page<b.iconMosaicItem.page?-1:1:a.iconMosaicItem&&!b.iconMosaicItem?1:!a.iconMosaicItem&&b.iconMosaicItem?-1:0}return function(){return function(){}}(),function(b){function d(a,c,d,e,f,g,h,k){c=b.call(this,a,c)||this;if(c._markerMap=new Map,c._glyphMap=new Map,c._glyphBufferDataStorage=new Map,c._sdfMarkers=!1,a.hasDataDrivenIcon!==d.isDataDriven())throw Error("incompatible icon buffer");
if(a.hasDataDrivenText!==f.isDataDriven())throw Error("incompatible text buffer");return c._iconVertexBuffer=d,c._iconIndexBuffer=e,c._textVertexBuffer=f,c._textIndexBuffer=g,c._placementEngine=h,c._workerTileHandler=k,c}return h(d,b),Object.defineProperty(d.prototype,"markerPageMap",{get:function(){return this._markerMap},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"glyphsPageMap",{get:function(){return this._glyphMap},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,
"sdfMarker",{get:function(){return this._sdfMarkers},enumerable:!0,configurable:!0}),d.prototype.copy=function(a,b,c,e,f){a=new d(this.layer,this.zoom,a,b,c,e,f,this._workerTileHandler);return a.layerIndex=this.layerIndex,a.layerExtent=this.layerExtent,a._iconIndexStart=b.index,a._textIndexStart=e.index,a._iconIndexCount=0,a._textIndexCount=0,a._symbolInstances=this._symbolInstances,a._workerTileHandler=this._workerTileHandler,a._fontArray=this._fontArray,a._textLayout=this._textLayout,a._iconLayout=
this._iconLayout,a._isLinePlacement=this._isLinePlacement,a._avoidEdges=this._avoidEdges,a},d.prototype.getResources=function(a,b,c){var e=this.layer,f=this.zoom,g=e.hasDataDrivenIcon,h=e.hasDataDrivenText;a&&a.setExtent(this.layerExtent);for(var k=e.getLayoutProperty("icon-image"),l=e.getLayoutProperty("text-field"),m=e.getLayoutValue("text-font",f),q=e.getLayoutValue("text-transform",f),r=[],t=0,u=this._features;t<u.length;t++){var v=u[t],x=v.getGeometry(a);if(x&&0!==x.length){var T=void 0;k&&(T=
e.getLayoutValue("icon-image",f,v),k.isDataDriven||(T=this._replaceKeys(T,v.values)),T&&b.add(T));var O=void 0,S=!1;if(l&&(O=e.getLayoutValue("text-field",f,v),l.isDataDriven||(O=this._replaceKeys(O,v.values)),O)){switch(q){case 2:O=O.toLowerCase();break;case 1:O=O.toUpperCase()}d._bidiEngine.hasBidiChar(O)&&(S=void 0,S="rtl"===d._bidiEngine.checkContextual(O)?"IDNNN":"ICNNN",O=d._bidiEngine.bidiTransform(O,S,"VLYSN"),S=!0);var H=O.length;if(0<H)for(var Y=0,W=m;Y<W.length;Y++){var E=W[Y],p=c[E];p||
(p=c[E]=new Set);for(E=0;H>E;E++){var A=O.charCodeAt(E);p.add(A)}}}if(T||O)H=e.getLayoutValue("icon-size",f,v),Y=e.getLayoutValue("text-size",f,v),v={sprite:T,label:O,rtl:S,geometry:x,iconSize:H,iconRotate:e.getLayoutValue("icon-rotate",f,v),ddIconValues:g?{color:e.getPaintValue("icon-color",f,v),opacity:e.getPaintValue("icon-opacity",f,v),size:H}:null,textSize:Y,textRotate:e.getLayoutValue("text-rotate",f,v),ddTextValues:h?{color:e.getPaintValue("text-color",f,v),opacity:e.getPaintValue("text-opacity",
f,v),size:Y}:null},r.push(v)}}this._symbolFeatures=r},d.prototype.processFeatures=function(b,c){b&&b.setExtent(this.layerExtent);var g,h,l=this.layer,m=this.zoom;c=this._isLinePlacement=1===l.getLayoutValue("symbol-placement",m);b=this._avoidEdges=l.getLayoutValue("symbol-avoid-edges",m)&&!c;var r=8*l.getLayoutValue("symbol-spacing",m),t=l.getLayoutProperty("icon-image"),u=l.getLayoutProperty("text-field"),v=this._workerTileHandler;t&&(this._iconLayout=new k.IconLayout(l,m,c),g=v.getSpriteItems(),
h=this._getTranslate(!0));var G,N,M;if(u){G=this._textLayout=new k.TextLayout(l,m,c);this._fontArray=G.fontArray;M=.5;switch(G.anchor){case 5:case 1:case 7:M=0;break;case 6:case 2:case 8:M=1}N=.5;switch(G.anchor){case 5:case 3:case 6:N=0;break;case 7:case 4:case 8:N=1}l=.5;switch(G.justify){case 0:l=0;break;case 2:l=1}var m=24*G.letterSpacing,t=c?0:24*G.maxWidth,u=24*G.lineHeight,R=[24*G.offset[0],24*G.offset[1]];G=this._fontArray.map(function(a){return v.getGlyphItems(a)});N=new e(G,t,u,m,R,M,N,
l);M=this._getTranslate(!1)}this._iconIndexStart=this._iconIndexBuffer.index;this._textIndexStart=this._textIndexBuffer.index;this._textIndexCount=this._iconIndexCount=0;this._markerMap.clear();this._glyphMap.clear();this._symbolInstances=l=[];m=this._textLayout;t=1;m&&m.size&&(t=m.size/24);u=m?m.maxAngle*a.C_DEG_TO_RAD:0;G=m?8*m.size:0;for(var R=0,P=this._symbolFeatures;R<P.length;R++){var Q=P[R],T=void 0;Q.sprite&&(T=g[Q.sprite],T&&T.sdf&&(this._sdfMarkers=!0));var O=void 0,S=Q.label,H=0;if(S&&
(O=N.getShaping(S,Q.rtl),O&&0<O.length)){for(var H=1E30,S=-1E30,Y=0,W=O;Y<W.length;Y++)var E=W[Y],H=Math.min(H,E.x),S=Math.max(S,E.x);H=(S-H+48)*t*8}S=0;for(Y=Q.geometry;S<Y.length;S++){var W=Y[S],p=void 0;c?(O&&0<O.length&&m&&m.size&&d._smoothVertices(W,8*m.size*(2+Math.min(2,4*Math.abs(m.offset[1])))),p=d._findAnchors(W,r,H)):p=[new f.Anchor(W[0].x,W[0].y)];for(E=0;E<p.length;E++){var A=p[E];0>A.x||4096<A.x||0>A.y||4096<A.y||c&&0<H&&0===m.rotationAlignment&&!d._honorsTextMaxAngle(W,A,H,u,G)||l.push({shaping:O,
line:W,iconMosaicItem:T,anchor:A,iconSize:Q.iconSize,iconRotate:Q.iconRotate,ddIconValues:Q.ddIconValues,textSize:Q.textSize,textRotate:Q.textRotate,ddTextValues:Q.ddTextValues})}}}l.sort(q);for(g=0;g<l.length;g++)this._processFeature(l[g],h,M,b);this._addPlacedGlyphs()},d.prototype.updateSymbols=function(){this._iconIndexStart=this._iconIndexBuffer.index;this._textIndexStart=this._textIndexBuffer.index;this._textIndexCount=this._iconIndexCount=0;this._markerMap.clear();this._glyphMap.clear();var a,
b=this._avoidEdges,c=this.layer;c.getLayoutProperty("icon-image")&&(a=this._getTranslate(!0));var d;c.getLayoutProperty("text-field")&&(d=this._getTranslate(!1));for(var c=0,e=this._symbolInstances;c<e.length;c++)this._processFeature(e[c],a,d,b);this._addPlacedGlyphs()},d.prototype._getTranslate=function(a){var b=this.layer.getPaintValue(a?"icon-translate":"text-translate",this.zoom);if(0!==b[0]||0!==b[1]){var c=this._placementEngine.mapAngle;return 0!==c&&0===this.layer.getPaintValue(a?"icon-translate-anchor":
"text-translate-anchor",this.zoom)?(a=Math.sin(c),c=Math.cos(c),[8*(b[0]*c-b[1]*a),8*(b[0]*a+b[1]*c)]):[8*b[0],8*b[1]]}},d.prototype._replaceKeys=function(a,b){return a.replace(/{([^{}]+)}/g,function(a,c){return c in b?b[c]:""})},d.prototype._processFeature=function(b,c,d,e){var f=b.line,h=b.iconMosaicItem,k=b.shaping,l=b.anchor,m=this._iconLayout,q=m&&!!h,r=!0,t=1;q&&(m.size=b.iconSize,m.rotate=b.iconRotate,t=8*m.size,r=m.optional||!h);var u=this._textLayout,v=u&&k&&0<k.length,x=1,y=x,T=!0;v&&(u.size=
b.textSize,u.rotate=b.textRotate,x=u.size/24,y=8*x,T=u.optional||!k||0===k.length);var O,x=new g.Point(0,-17);if(q){if(O=this._placementEngine.getIconPlacement(l,c,h,t,f,m,e),O.footprint.minzoom===a.C_INFINITY&&!r)return;l.minzoom>O.footprint.minzoom&&(O.footprint.minzoom=l.minzoom)}var S;if(v&&(S=this._placementEngine.getTextPlacement(l,d,x,k,y,f,u,e))){if(S.footprint.minzoom===a.C_INFINITY&&!T)return;l.minzoom>S.footprint.minzoom&&(S.footprint.minzoom=l.minzoom)}if(!T&&!r||!r&&S&&S.footprint.minzoom!==
a.C_INFINITY||!T&&O&&O.footprint.minzoom!==a.C_INFINITY)c=Math.max(O.footprint.minzoom,S.footprint.minzoom),O.footprint.minzoom=c,S.footprint.minzoom=c;S&&S.footprint.minzoom!==a.C_INFINITY&&(u.ignorePlacement||this._placementEngine.add(S),this._storePlacedGlyphs(S.shapes,S.footprint.minzoom,this.zoom,b.ddTextValues));O&&O.footprint.minzoom!==a.C_INFINITY&&(m.ignorePlacement||this._placementEngine.add(O),this._addPlacedIcons(O.shapes,O.footprint.minzoom,this.zoom,h.page,b.ddIconValues))},d.prototype._addPlacedIcons=
function(b,c,d,e,f){c=Math.max(d+a.log2(c),0);for(var g=this._iconVertexBuffer,h=this._iconIndexBuffer,k=0;k<b.length;k++){var l=b[k],m=Math.max(d+a.log2(l.minzoom),c),n=Math.min(d+a.log2(l.maxzoom),25);if(!(m>=n)){var q=l.tl,r=l.tr,t=l.bl,u=l.br,v=l.mosaicRect,x=l.labelAngle,l=l.anchor,y=g.index,S=v.x,H=v.y,Y=S+v.width,v=H+v.height;g.add(l.x,l.y,q.x,q.y,S,H,x,m,n,c,f);g.add(l.x,l.y,r.x,r.y,Y,H,x,m,n,c,f);g.add(l.x,l.y,t.x,t.y,S,v,x,m,n,c,f);g.add(l.x,l.y,u.x,u.y,Y,v,x,m,n,c,f);h.add(y+0,y+1,y+2);
h.add(y+1,y+2,y+3);this._markerMap.has(e)?this._markerMap.get(e)[1]+=6:this._markerMap.set(e,[this._iconIndexStart+this._iconIndexCount,6]);this._iconIndexCount+=2}}},d.prototype._addPlacedGlyphs=function(){var a=this,b=this._textVertexBuffer,c=this._textIndexBuffer;this._glyphBufferDataStorage.forEach(function(d,e){for(var f=0;f<d.length;f++){var g=d[f],h=b.index;b.add(g.glyphAnchor[0],g.glyphAnchor[1],g.tl[0],g.tl[1],g.xmin,g.ymin,g.labelAngle,g.minLod,g.maxLod,g.placementLod,g.ddValues);b.add(g.glyphAnchor[0],
g.glyphAnchor[1],g.tr[0],g.tr[1],g.xmax,g.ymin,g.labelAngle,g.minLod,g.maxLod,g.placementLod,g.ddValues);b.add(g.glyphAnchor[0],g.glyphAnchor[1],g.bl[0],g.bl[1],g.xmin,g.ymax,g.labelAngle,g.minLod,g.maxLod,g.placementLod,g.ddValues);b.add(g.glyphAnchor[0],g.glyphAnchor[1],g.br[0],g.br[1],g.xmax,g.ymax,g.labelAngle,g.minLod,g.maxLod,g.placementLod,g.ddValues);c.add(h+0,h+1,h+2);c.add(h+1,h+2,h+3);a._glyphMap.has(e)?a._glyphMap.get(e)[1]+=6:a._glyphMap.set(e,[a._textIndexStart+a._textIndexCount,6]);
a._textIndexCount+=2}});this._glyphBufferDataStorage.clear()},d.prototype._storePlacedGlyphs=function(b,c,d,e){c=Math.max(d+a.log2(c),0);for(var f=0;f<b.length;f++){var g=b[f],h=Math.max(d+a.log2(g.minzoom),c),k=Math.min(d+a.log2(g.maxzoom),25);if(!(h>=k)){var l=g.tl,m=g.tr,q=g.bl,r=g.br,t=g.labelAngle,u=g.anchor,v=g.mosaicRect;this._glyphBufferDataStorage.has(g.page)||this._glyphBufferDataStorage.set(g.page,[]);this._glyphBufferDataStorage.get(g.page).push({glyphAnchor:[u.x,u.y],tl:[l.x,l.y],tr:[m.x,
m.y],bl:[q.x,q.y],br:[r.x,r.y],xmin:v.x,ymin:v.y,xmax:v.x+v.width,ymax:v.y+v.height,labelAngle:t,minLod:h,maxLod:k,placementLod:c,ddValues:e})}}},d._findAnchors=function(b,c,d){c+=d;for(var e=0,h=b.length-1,k=0;h>k;k++)e+=g.Point.distance(b[k],b[k+1]);k=d||c;if(k*=.5,k>=e)return[];d=k/e;c=e/Math.max(Math.round(e/c),1);for(var e=0,h=-c/2,l=[],m=b.length-1,k=0;m>k;k++){for(var q=b[k],r=b[k+1],t=r.x-q.x,u=r.y-q.y,v=Math.sqrt(t*t+u*u),x=void 0;e+v>h+c;){var h=h+c,P=(h-e)/v,Q=a.interpolate(q.x,r.x,P),
P=a.interpolate(q.y,r.y,P);void 0===x&&(x=Math.atan2(u,t));l.push(new f.Anchor(Q,P,x,k,d))}e+=v}return l},d.deviation=function(a,b,c){return Math.atan2((b.x-a.x)*(c.y-b.y)-(b.y-a.y)*(c.x-b.x),(b.x-a.x)*(c.x-b.x)+(b.y-a.y)*(c.y-b.y))},d._honorsTextMaxAngle=function(a,b,c,d,e){var f=0;c/=2;for(var h=new g.Point(b.x,b.y),k=b.segment+1;f>-c;){if(--k,0>k)return!1;f-=g.Point.distance(a[k],h);h=a[k]}f+=g.Point.distance(a[k],a[k+1]);b=[];for(var h=0,l=a.length;c>f;){var m=a[k],n=void 0;do{if(++k,k===l)return!1;
n=a[k]}while(n.isEqual(m));var q=k,r=void 0;do{if(++q,q===l)return!1;r=a[q]}while(r.isEqual(n));m=this.deviation(m,n,r);b.push({deviation:m,distToAnchor:f});for(h+=m;f-b[0].distToAnchor>e;)h-=b.shift().deviation;if(Math.abs(h)>d)return!1;f+=g.Point.distance(n,r)}return!0},d._smoothVertices=function(a,b){if(!(0>=b)){var c=a.length;if(!(3>c)){var d=[],e=0;d.push(0);for(var f=1;c>f;f++)e+=g.Point.distance(a[f],a[f-1]),d.push(e);b=Math.min(b,.2*e);e=[];e.push(a[0].x);e.push(a[0].y);var h=a[c-1].x,k=a[c-
1].y,f=g.Point.sub(a[0],a[1]);f.normalize();a[0].x+=b*f.x;a[0].y+=b*f.y;f.assignSub(a[c-1],a[c-2]);f.normalize();a[c-1].x+=b*f.x;a[c-1].y+=b*f.y;for(f=1;c>f;f++)d[f]+=b;d[c-1]+=b;for(var l=.5*b,f=1;c-1>f;f++){for(var m=0,q=0,r=0,t=f-1;0<=t&&!(d[t+1]<d[f]-l);t--){var u=l+d[t+1]-d[f],v=d[t+1]-d[t],Q=d[f]-d[t]<l?1:u/v;if(1E-6>Math.abs(Q))break;var T=Q*Q,O=Q*u-.5*T*v,S=Q*v/b,H=a[t+1],Y=a[t].x-H.x,W=a[t].y-H.y,m=m+S/O*(H.x*Q*u+.5*T*(u*Y-v*H.x)-T*Q*v*Y/3),q=q+S/O*(H.y*Q*u+.5*T*(u*W-v*H.y)-T*Q*v*W/3),r=
r+S}for(t=f+1;c>t&&!(d[t-1]>d[f]+l);t++){u=l-d[t-1]+d[f];v=d[t]-d[t-1];Q=d[t]-d[f]<l?1:u/v;if(1E-6>Math.abs(Q))break;T=Q*Q;O=Q*u-.5*T*v;S=Q*v/b;H=a[t-1];Y=a[t].x-H.x;W=a[t].y-H.y;m+=S/O*(H.x*Q*u+.5*T*(u*Y-v*H.x)-T*Q*v*Y/3);q+=S/O*(H.y*Q*u+.5*T*(u*W-v*H.y)-T*Q*v*W/3);r+=S}e.push(m/r);e.push(q/r)}e.push(h);e.push(k);for(t=f=0;c>f;f++)a[f].x=e[t++],a[f].y=e[t++]}}},d._bidiEngine=new c,d}(b)})},"esri/views/vectorTiles/Placement":function(){define(["require","exports","../2d/engine/webgl/Geometry","./GeometryUtils",
"./Conflict"],function(m,l,h,d,b){Object.defineProperty(l,"__esModule",{value:!0});m=function(){return function(b,c,d,f,g){void 0===d&&(d=0);void 0===f&&(f=-1);void 0===g&&(g=a);this.x=b;this.y=c;this.angle=d;this.segment=f;this.minzoom=g}}();l.Anchor=m;m=function(){return function(a,b,d,f){this.glyph=a;this.x=b;this.y=d;this.glyphItem=f}}();l.ShapedGlyph=m;var g=function(){return function(b,c,f,g,h,k,l){void 0===h&&(h=!1);void 0===k&&(k=a);void 0===l&&(l=d.C_INFINITY);this.anchor=b;this.labelAngle=
c;this.glyphAngle=f;this.page=g;this.upsideDown=h;this.minzoom=k;this.maxzoom=l}}(),k=function(){return function(a,b,d,f,g,h,k,l,m,n){this.tl=a;this.tr=b;this.bl=d;this.br=f;this.mosaicRect=g;this.labelAngle=h;this.anchor=k;this.minzoom=l;this.maxzoom=m;this.page=n}}();l.PlacedSymbol=k;var f=function(){return function(a,b){this.footprint=a;this.shapes=b}}();l.Placement=f;var a=.5;m=function(){function e(){this.mapAngle=0;this._conflictEngine=new b.ConflictEngine}return e.prototype.reset=function(){this._conflictEngine.reset()},
e.prototype.setAngle=function(a){this.mapAngle=a;this._conflictEngine.setAngle(a)},e.prototype.getIconPlacement=function(c,e,g,l,m,v,x){var q=g.width/(g.sdfRatio*g.pixelRatio),n=g.height/(g.sdfRatio*g.pixelRatio);m=v.offset[0]-q/2;var r=v.offset[1]-n/2,q=m+q,n=r+n,t=g.rect,u=(g.sdf?17:2)/g.sdfRatio,B=m-u,F=r-u,G=B+t.width/(g.pixelRatio*g.sdfRatio),N=F+t.height/(g.pixelRatio*g.sdfRatio);g=new h.Point(B,F);u=new h.Point(G,N);N=new h.Point(B,N);F=new h.Point(G,F);G=v.rotate*d.C_DEG_TO_RAD;B=1===v.rotationAlignment;
if(0<=c.segment&&!B&&(G+=c.angle),0!==G){var M=Math.cos(G),R=Math.sin(G);g.rotate(M,R);u.rotate(M,R);N.rotate(M,R);F.rotate(M,R)}M=8*v.padding;R=new h.Point(c.x,c.y);c=new b.Footprint(this.mapAngle,M,B);c.addBox(R,new b.Box(m,r,q,n),l,G,e,a,d.C_INFINITY);e=new k(g,F,N,u,t,0,R,a,d.C_INFINITY,0);e=new f(c,[e]);l=a;return v.allowOverlap||(l=this._conflictEngine.getMinZoom(e.footprint,l,x,B)),c.minzoom=l,e},e.prototype.getTextPlacement=function(c,e,l,m,u,v,x,y){for(var n,q=new h.Point(c.x,c.y),r=x.rotate*
d.C_DEG_TO_RAD,t=0===x.rotationAlignment,B=x.keepUpright,F=a,G=!t,N=G?0:c.angle,M=0<=c.segment&&t,R=new b.Footprint(this.mapAngle,8*x.padding,G),P=[],Q=!M,T=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY,S=T,H=O,Y=M?B:t&&B,W=0;W<m.length;W++){var E=m[W],p=E.glyphItem;if(p&&!p.rect.isEmpty){var A=p.rect,K=p.metrics,U=p.page;Q&&(n&&n!==E.y&&(R.addBox(q,new b.Box(T,S,O,H),u,r,e,a,d.C_INFINITY),T=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY,S=T,H=O),n=E.y);var V=[];if(M){if(p=(l.x+E.x+K.left-
4+.5*p.metrics.width)*u,F=this._placeGlyph(c,F,p,v,c.segment,1,U,V),B&&(F=this._placeGlyph(c,F,p,v,c.segment,-1,U,V)),2<=F)break}else V.push(new g(q,N,N,U)),t&&B&&V.push(new g(q,N+d.C_PI,N+d.C_PI,U,!0));for(var U=E.x+l.x+K.left,E=E.y+l.y-K.top,p=U+K.width,K=E+K.height,X=new h.Point(U-4,E-4),ba=new h.Point(X.x+A.width,X.y+A.height),fa=new h.Point(X.x,ba.y),ha=new h.Point(ba.x,X.y),ca=0;ca<V.length;ca++){var ea=V[ca],ja=X.clone(),na=fa.clone(),za=ha.clone(),ua=ba.clone(),wa=E,da=K,ra=ea.glyphAngle+
r;if(0!==ra){var ga=Math.cos(ra),pa=Math.sin(ra);ja.rotate(ga,pa);ua.rotate(ga,pa);na.rotate(ga,pa);za.rotate(ga,pa)}P.push(new k(ja,za,na,ua,A,ea.labelAngle,ea.anchor,ea.minzoom,ea.maxzoom,ea.page));(!Y||this._legible(ea.labelAngle))&&(Q?(T>U&&(T=U),S>wa&&(S=wa),p>O&&(O=p),da>H&&(H=da)):2>ea.minzoom&&R.addBox(ea.anchor,new b.Box(U,wa,p,da),u,ra,e,ea.minzoom,ea.maxzoom))}}}if(2<=F)return null;Q&&R.addBox(q,new b.Box(T,S,O,H),u,r,e,a,d.C_INFINITY);c=new f(R,P);return x.allowOverlap||(F=this._conflictEngine.getMinZoom(c.footprint,
F,y,G)),R.minzoom=F,c},e.prototype.add=function(a){this._conflictEngine.add(a.footprint)},e.prototype._legible=function(a){a=d.radToByte(a);return 65>a||193<=a},e.prototype._placeGlyph=function(a,b,e,f,k,l,m,y){var c=0>l?d.positiveMod(a.angle+d.C_PI,d.C_2PI):a.angle,q=this._legible(c),r=0;0>e&&(l*=-1,e*=-1,r=d.C_PI);0<l&&++k;a=new h.Point(a.x,a.y);var t=f[k],u=d.C_INFINITY;if(f.length<=k)return u;for(;;){var v=t.x-a.x,x=t.y-a.y,N=Math.sqrt(v*v+x*x),M=Math.max(e/N,b),v=d.positiveMod(Math.atan2(x/N,
v/N)+r,d.C_2PI);if(y.push(new g(a,c,v,m,q,M,u)),b>=M)return M;a=t.clone();do{if(k+=l,f.length<=k||0>k)return M;t=f[k]}while(a.isEqual(t));u=t.x-a.x;v=t.y-a.y;x=Math.sqrt(u*u+v*v);u*=N/x;v*=N/x;a.x-=u;a.y-=v;u=M}},e}();l.PlacementEngine=m})},"esri/views/vectorTiles/Conflict":function(){define(["require","exports","../2d/engine/webgl/Geometry","./GeometryUtils"],function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});m=function(){function b(b,a,d,c){this.left=b;this.top=a;this.right=d;this.bottom=
c}return b.prototype.clone=function(){return new b(this.left,this.top,this.right,this.bottom)},b.prototype.move=function(b,a){this.left+=b;this.top+=a;this.right+=b;this.bottom+=a},b.prototype.rotate=function(b,a){var d=this.left,c=this.right,f=this.top,g=this.bottom,h=d*b-f*a,k=d*a+f*b,l=c*b-f*a,f=c*a+f*b,m=d*b-g*a,d=d*a+g*b,y=c*b-g*a;b=c*a+g*b;this.left=Math.min(h,l,m,y);this.top=Math.min(k,f,d,b);this.right=Math.max(h,l,m,y);this.bottom=Math.max(k,f,d,b)},b.overlaps=function(b,a){return b.right>
a.left&&b.left<a.right&&b.bottom>a.top&&b.top<a.bottom},b}();l.Box=m;var b=function(){function b(b,a,d,c){this.anchor=b;this.corners=a;this.minzoom=d;this.maxzoom=c}return b.prototype.left=function(){return this.corners[0].x},b.prototype.right=function(){return this.corners[2].x},b.prototype.top=function(){return this.corners[1].y},b.prototype.bottom=function(){return this.corners[3].y},b}();l.Obstacle=b;m=function(){function d(b,a,d){this.obstacles=[];this.mapAngle=b;this.padding=a;this.isScreenAligned=
d;this.minzoom=g}return d.prototype.addBox=function(d,a,e,c,g,k,l){var f=a.left*e-this.padding,m=a.top*e-this.padding,q=a.right*e+this.padding;a=a.bottom*e+this.padding;f=[new h.Point(f,m),new h.Point(q,m),new h.Point(q,a),new h.Point(f,a)];0!==this.mapAngle&&(m=Math.cos(this.mapAngle),q=Math.sin(this.mapAngle),d=d.clone(),d.rotate(m,q));if(this.isScreenAligned||(c+=this.mapAngle),0!==c){m=Math.cos(c);q=Math.sin(c);f[0].rotate(m,q);f[1].rotate(m,q);f[2].rotate(m,q);f[3].rotate(m,q);c=0;for(m=1;4>
m;m++)f[m].x<f[c].x?c=m:f[m].x===f[c].x&&f[m].y<f[c].y&&(c=m);if(c){q=[];for(m=0;4>m;m++)q.push(f[(m+c)%4]);f=q}}if(g)for(c=0,m=f;c<m.length;c++)m[c].move(g[0],g[1]);this.obstacles.push(new b(d,f,k,l))},d}();l.Footprint=m;var g=.5;m=function(){function b(){this._grid=[]}return b.prototype.setAngle=function(b){},b.prototype.reset=function(){this._grid=[]},b.prototype.add=function(d){var a=this._grid,e=0;for(d=d.obstacles;e<d.length;e++)for(var c=d[e],f=c.anchor,g=b._gridClamp(Math.min(c.left()+f.x,
f.x)),h=b._gridClamp(Math.max(c.right()+f.x,f.x)),k=b._gridClamp(Math.min(c.top()+f.y,f.y)),f=b._gridClamp(Math.max(c.bottom()+f.y,f.y));f>=k;k++)for(var l=g;h>=l;l++){var m=a[16*k+l];m||(m=a[16*k+l]=[]);m.push(c)}},b.prototype.getMinZoom=function(f,a,e,c){if(0===f.obstacles.length)return d.C_INFINITY;e=this._grid;c=0;for(f=f.obstacles;c<f.length;c++)for(var g=f[c],h=g.anchor,k=b._gridClamp(Math.min(g.left()+h.x,h.x)),l=b._gridClamp(Math.max(g.right()+h.x,h.x)),m=b._gridClamp(Math.min(g.top()+h.y,
h.y)),h=b._gridClamp(Math.max(g.bottom()+h.y,h.y));h>=m;m++)for(var x=k;l>=x;x++){var y=e[16*m+x];if(y)for(var n=0;n<y.length;n++){var w=y[n];if(!(g.minzoom>=w.maxzoom||w.minzoom>=g.maxzoom)&&(a=b._calcPlacementZoom(g,w,a),2<=a))return d.C_INFINITY}}return 2>a?a:d.C_INFINITY},b._gridClamp=function(b){return d.clamp(b>>9,-7,8)},b._calcPlacementZoom=function(f,a,e){var c=a.anchor.x-f.anchor.x;if(0===c&&(f.right()<a.left()||a.right()<f.left()))return e;var g=a.anchor.y-f.anchor.y;if(0===g&&(f.bottom()<
a.top()||a.bottom()<f.top()))return e;var h=d.C_INFINITY;if(0!==c){var k=(0<c?f.right()-a.left():f.left()-a.right())/c;h>k&&(h=k);c=0<c?b._calcExtZoomX(f,a,k):b._calcExtZoomX(a,f,k);h>c&&(h=c)}0!==g&&(c=(0<g?f.bottom()-a.top():f.top()-a.bottom())/g,h>c&&(h=c),g=0<g?b._calcExtZoomY(f,a,c):b._calcExtZoomY(a,f,c),h>g&&(h=g));return h<f.minzoom||h<a.minzoom?e:(h=Math.min(h,f.maxzoom,a.maxzoom),e>h&&(h=e),h)},b._calcExtZoomX=function(b,a,d){var c,e,f,g;if(a.anchor.y+a.corners[0].y/d>b.anchor.y+b.corners[2].y/
d){var h=b.corners[2].x-b.corners[3].x,k=b.corners[2].y-b.corners[3].y,l=a.corners[1].x-a.corners[0].x,m=a.corners[1].y-a.corners[0].y;0<=h*m-k*l?b.anchor.y+b.corners[3].y/d<a.anchor.y+a.corners[0].y/d?(c=b.corners[3],e=a.corners[0],f=a.corners[1],g=1):(c=a.corners[0],e=b.corners[3],f=b.corners[2],g=-1):b.anchor.y+b.corners[2].y/d>a.anchor.y+a.corners[1].y/d?(c=b.corners[2],e=a.corners[0],f=a.corners[1],g=1):(c=a.corners[1],e=b.corners[3],f=b.corners[2],g=-1)}else h=b.corners[2].x-b.corners[1].x,
k=b.corners[2].y-b.corners[1].y,l=a.corners[3].x-a.corners[0].x,m=a.corners[3].y-a.corners[0].y,0>h*m-k*l?b.anchor.y+b.corners[1].y/d>a.anchor.y+a.corners[0].y/d?(c=b.corners[1],e=a.corners[0],f=a.corners[3],g=1):(c=a.corners[0],e=b.corners[1],f=b.corners[2],g=-1):b.anchor.y+b.corners[2].y/d<a.anchor.y+a.corners[3].y/d?(c=b.corners[2],e=a.corners[0],f=a.corners[3],g=1):(c=a.corners[3],e=b.corners[1],f=b.corners[2],g=-1);d=f.x-e.x;f=f.y-e.y;return g*((c.y-e.y)*d-(c.x-e.x)*f)/((b.anchor.x-a.anchor.x)*
f-(b.anchor.y-a.anchor.y)*d)},b._calcExtZoomY=function(b,a,d){var c,e,f,g;if(a.anchor.x+a.corners[1].x/d>b.anchor.x+b.corners[3].x/d){var h=b.corners[3].x-b.corners[2].x,k=b.corners[3].y-b.corners[2].y,l=a.corners[0].x-a.corners[1].x,m=a.corners[0].y-a.corners[1].y;0>h*m-k*l?b.anchor.x+b.corners[2].x/d<a.anchor.x+a.corners[1].x/d?(c=b.corners[2],e=a.corners[1],f=a.corners[0],g=1):(c=a.corners[1],e=b.corners[2],f=b.corners[3],g=-1):b.anchor.x+b.corners[3].x/d>a.anchor.x+a.corners[0].x/d?(c=b.corners[3],
e=a.corners[1],f=a.corners[0],g=1):(c=a.corners[0],e=b.corners[2],f=b.corners[3],g=-1)}else h=b.corners[3].x-b.corners[0].x,k=b.corners[3].y-b.corners[0].y,l=a.corners[2].x-a.corners[1].x,m=a.corners[2].y-a.corners[1].y,0<h*m-k*l?b.anchor.x+b.corners[0].x/d>a.anchor.x+a.corners[1].x/d?(c=b.corners[0],e=a.corners[1],f=a.corners[2],g=1):(c=a.corners[1],e=b.corners[0],f=b.corners[3],g=-1):b.anchor.x+b.corners[3].x/d<a.anchor.x+a.corners[2].x/d?(c=b.corners[3],e=a.corners[1],f=a.corners[2],g=1):(c=a.corners[2],
e=b.corners[0],f=b.corners[3],g=-1);d=f.x-e.x;f=f.y-e.y;return g*((c.y-e.y)*d-(c.x-e.x)*f)/((b.anchor.x-a.anchor.x)*f-(b.anchor.y-a.anchor.y)*d)},b}();l.ConflictEngine=m})},"esri/views/vectorTiles/TextShaping":function(){define(["require","exports","./Placement"],function(m,l,h){return function(){function d(b,d,h,f,a,e,c,l){this._glyphItems=b;this._maxWidth=d;this._lineHeight=h;this._letterSpacing=f;this._offset=a;this._hAnchor=e;this._vAnchor=c;this._justify=l}return d.prototype.getShaping=function(b,
d){for(var g=this._letterSpacing,f=this._offset[0],a=this._offset[1],e=[],c=b.length,l=0;c>l;l++){for(var m=b.charCodeAt(l),r=void 0,u=0,v=this._glyphItems;u<v.length&&!(r=v[u][m]);u++);r&&(e.push(new h.ShapedGlyph(m,f,a,r)),f+=r.metrics.advance+g)}if(0<e.length){r=this._maxWidth;b=this._lineHeight;f=this._justify;a=e.length;m=c=g=0;if(0!==r)for(l=v=u=0;a>l;l++){var x=e[l];if(x.x-=v,d?x.y-=b*g:x.y+=b*g,x.x>r&&0<u){for(var y=e[u+1].x,m=Math.max(y,m),n=u+1;l>=n;n++)d?e[n].y-=b:e[n].y+=b,e[n].x-=y;f&&
this._applyJustification(e,c,u-1);c=u+1;u=0;v+=y;g++}32===x.glyph&&(u=l)}l=e[a-1];m=Math.max(m,l.x+l.glyphItem.metrics.advance);f&&this._applyJustification(e,c,a-1);l=(f-this._hAnchor)*m;f=(-this._vAnchor*(g+1)+.5)*b;d&&g&&(f+=g*b);for(d=0;d<e.length;d++)b=e[d],b.x+=l,b.y+=f}return e},d.prototype._applyJustification=function(b,d,h){for(var f=b[h],f=(f.x+f.glyphItem.metrics.advance)*this._justify;h>=d;d++)b[d].x-=f},d}()})},"dojox/string/BidiEngine":function(){define(["dojo/_base/lang","dojo/_base/declare",
"dojo/Stateful"],function(m,l,h){function d(a,c,e,h,k){var l=a;void 0===c&&(c=k.defInFormat);void 0===e&&(e=k.defOutFormat);void 0===h&&(h=k.defSwap);if(c!==e){var m,n=c.substring(0,1);m=c.substring(1,4);var p=e.substring(0,1),q=e.substring(1,4);"C"===m.charAt(0)&&(m=b(l),m="ltr"===m||"rtl"===m?m.toUpperCase():"L"===c.charAt(2)?"LTR":"RTL",c=n+m);"C"===q.charAt(0)&&(m=b(l),"rtl"===m?q="RTL":"ltr"===m?(l=l.split(""),l.reverse(),m=b(l.join("")),q=m.toUpperCase()):q="L"===e.charAt(2)?"LTR":"RTL",e=p+
q)}if(c===e)return a;p=c.substring(0,1);l=c.substring(1,4);n=e.substring(0,1);q=e.substring(1,4);k.inFormat=c;k.outFormat=e;k.swap=h;if("L"===p&&"VLTR"===e){if("LTR"===l)return k.dir=F,g(a,k);if("RTL"===l)return k.dir=G,g(a,k)}if("V"===p&&"V"===n)return k.dir="RTL"===l?G:F,f(a,k);if("L"===p&&"VRTL"===e)return k.dir="LTR"===l?F:G,a=g(a,k),f(a);if("VLTR"===c&&"LLTR"===e)return k.dir=F,g(a,k);if("V"===p&&"L"===n&&l!==q)return a=f(a),"RTL"===l?d(a,"LLTR","VLTR",h,k):d(a,"LRTL","VRTL",h,k);if("VRTL"===
c&&"LRTL"===e)return d(a,"LRTL","VRTL",h,k);if("L"===p&&"L"===n)return c=k.swap,k.swap=c.substr(0,1)+"N","RTL"===l?(k.dir=G,a=g(a,k),k.swap="N"+c.substr(1,2),k.dir=F,a=g(a,k)):(k.dir=F,a=g(a,k),k.swap="N"+c.substr(1,2),a=d(a,"VLTR","LRTL",k.swap,k)),a}function b(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?"z">=a[0]?"ltr":"rtl":""}function g(a,b){a=a.split("");var d=[];k(a,d,b);if(0!==b.hiLevel&&b.swap.substr(0,1)!==b.swap.substr(1,2))for(var e=
0;e<a.length;e++)if(1===d[e]){var f=e,g;b:{g=a[e];for(var h=void 0,l=0,m=R.length-1;l<=m;)if(h=Math.floor((l+m)/2),g<R[h][0])m=h-1;else if(g>R[h][0])l=h+1;else{g=R[h][1];break b}}a[f]=g}c(2,a,d,b);c(1,a,d,b);w=d;return a.join("")}function k(a,b,c){var d=a.length,e=c.dir?V:U,f=null,g=null,h=null,f=0,g=g=null,k=-1,l=g=null,m=[],n=[];c.hiLevel=c.dir;c.lastArabic=!1;c.hasUbatAl=!1;c.hasUbatB=!1;c.hasUbatS=!1;for(g=0;g<d;g++){var l=g,h=a[g].charCodeAt(0),p=ma[h>>8];m[l]=p<ra?p:Pa[p-ra][h&255]}for(l=0;l<
d;l++){n[l]=g=q(a,m,n,l,c);f=e[f][g];g=f&240;f&=15;b[l]=h=e[f][C];if(0<g){if(16===g)for(g=k;g<l;g++)b[g]=1;k=-1}if(g=e[f][B])-1===k&&(k=l);else if(-1<k){for(g=k;g<l;g++)b[g]=h;k=-1}m[l]===ea&&(b[l]=0);c.hiLevel|=h}if(c.hasUbatS)for(a=0;a<d;a++)if(m[a]===ja)for(b[a]=c.dir,e=a-1;0<=e;e--)if(m[e]===za)b[e]=c.dir;else break}function f(a,b){a=a.split("");if(b){var c=[];k(a,c,b);w=c}a.reverse();y.reverse();return a.join("")}function a(a){for(var b=0;b<A.length;b++)if(a>=A[b]&&a<=K[b])return!0;return!1}
function e(b,c,d,e){for(;c*d<e&&r(b[c]);)c+=d;return c*d<e&&a(b[c])?!0:!1}function c(a,b,c,d){if(!(d.hiLevel<a))if(1!==a||d.dir!==G||d.hasUbatB){d=b.length;for(var e=0,f,g,h;e<d;){if(c[e]>=a){for(f=e+1;f<d&&c[f]>=a;)f++;for(g=f-1;e<g;e++,g--)h=b[e],b[e]=b[g],b[g]=h,h=y[e],y[e]=y[g],y[g]=h;e=f}e++}}else b.reverse(),y.reverse()}function q(a,b,c,d,e){return{UBAT_L:function(){e.lastArabic=!1;return X},UBAT_R:function(){e.lastArabic=!1;return ba},UBAT_ON:function(){return ca},UBAT_AN:function(){return ha},
UBAT_EN:function(){return e.lastArabic?ha:fa},UBAT_AL:function(){e.lastArabic=!0;e.hasUbatAl=!0;return ba},UBAT_WS:function(){return ca},UBAT_CS:function(){var a,f;if(1>d||d+1>=b.length||(a=c[d-1])!==fa&&a!==ha||(f=b[d+1])!==fa&&f!==ha)return ca;e.lastArabic&&(f=ha);return f===a?f:ca},UBAT_ES:function(){return(0<d?c[d-1]:ea)===fa&&d+1<b.length&&b[d+1]===fa?fa:ca},UBAT_ET:function(){if(0<d&&c[d-1]===fa)return fa;if(e.lastArabic)return ca;for(var a=d+1,f=b.length;a<f&&b[a]===ua;)a++;return a<f&&b[a]===
fa?fa:ca},UBAT_NSM:function(){if("VLTR"===e.inFormat){for(var f=b.length,g=d+1;g<f&&b[g]===wa;)g++;if(g<f&&(f=a[d],g=b[g],(1425<=f&&2303>=f||64286===f)&&(g===ba||g===na)))return ba}return 1>d||b[d-1]===ea?ca:c[d-1]},UBAT_B:function(){e.lastArabic=!0;e.hasUbatB=!0;return e.dir},UBAT_S:function(){e.hasUbatS=!0;return ca},UBAT_LRE:function(){e.lastArabic=!1;return ca},UBAT_RLE:function(){e.lastArabic=!1;return ca},UBAT_LRO:function(){e.lastArabic=!1;return ca},UBAT_RLO:function(){e.lastArabic=!1;return ca},
UBAT_PDF:function(){e.lastArabic=!1;return ca},UBAT_BN:function(){return ca}}[da[b[d]]]()}function t(a,b){for(var c=0;c<O.length;c++)if(a===O[c])return b[c];return a}function r(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function u(a){if("L"===a)return"LTR";if("R"===a)return"RTL";if("C"===a)return"CLR";if("D"===a)return"CRL"}function v(a,b){for(var c=0;c<P.length;c++)if(a===P[c])return b[c];return a}function x(a,b,c,d){for(var e=0;e<a.length;e++)if(a[e]>b||!c&&a[e]===b)a[e]+=d}m.getObject("string",!0,
dojox);m=l("dojox.string.BidiEngine",h,{inputFormat:"ILYNN",outputFormat:"VLNNN",sourceToTarget:[],targetToSource:[],levels:[],bidiTransform:function(b,c,f){this.sourceToTarget=[];this.targetToSource=[];if(!b)return"";var g=this.sourceToTarget,h=this.targetToSource,k=b.length;y=[];w=[];for(var l=0;l<k;l++)g[l]=l,h[l]=l,y[l]=l;if(!this.checkParameters(c,f))return b;c=this.inputFormat;f=this.outputFormat;var g=b,g=z,l=u(c.charAt(1)),h=u(f.charAt(1)),m="I"===c.charAt(0)?"L":c.charAt(0),k="I"===f.charAt(0)?
"L":f.charAt(0),l=m+l,h=k+h,k=c.charAt(2)+f.charAt(2);g.defInFormat=l;g.defOutFormat=h;g.defSwap=k;b=d(b,l,h,k,g);g=!1;if("R"===f.charAt(1))g=!0;else if("C"===f.charAt(1)||"D"===f.charAt(1))g=this.checkContextual(b);h=this.sourceToTarget=y;k=Array(h.length);for(l=0;l<h.length;l++)k[h[l]]=l;n=this.targetToSource=k;if(c.charAt(3)===f.charAt(3))g=b;else if("S"===f.charAt(3))if(c=g,f=!0,0===b.length)g=void 0;else{void 0===c&&(c=!0);void 0===f&&(f=!0);b=String(b);b=b.split("");var q=0,h=1,g=b.length;c||
(q=b.length-1,h=-1,g=1);for(var k=g,l=f,A=0,g=[],m=0;q*h<k;q+=h)if(a(b[q])||r(b[q])){var B;if(B="\u0644"===b[q])b:{for(var C=b,D=q+h,F=h,G=k;D*F<G&&r(C[D]);)D+=F;B=" ";if(D*F<G)for(B=C[D],C=0;C<P.length;C++)if(P[C]===B){B=!0;break b}B=!1}if(B){b[q]=0===A?v(b[q+h],Q):v(b[q+h],T);q+=h;A=b;B=q;C=h;for(D=k;B*C<D&&r(A[B]);)B+=C;B*C<D&&(A[B]=" ");l&&(g[m]=q,m++);A=0}else{B=b[q];if(1===A){C=q;if(e(b,q+h,h,k))b:for(D=b[q],F=0;F<O.length;F++){if(D===O[F]){D=Y[F];break b}}else D=t(b[q],H);b[C]=D}else!0===e(b,
q+h,h,k)?b[q]=t(b[q],W):b[q]=t(b[q],S);r(B)||(A=1);b:{for(C=0;C<E.length;C++)if(E[C]===B){B=!0;break b}B=!1}!0===B&&(A=0)}}else A=0;h="";for(k=0;k<b.length;k++){if(l=f){b:{for(l=0;l<g.length;l++)if(g[l]===k)break b;l=-1}l=-1<l}l?(x(n,k,!c,-1),y.splice(k,1)):h+=b[k]}g=h}else if(c=b,f=g,b=!0,0===c.length)g=void 0;else for(void 0===b&&(b=!0),void 0===f&&(f=!0),c=String(c),g="",h=[],h=c.split(""),k=0;k<c.length;k++)l=!1,"\ufe70"<=h[k]&&"\ufeff">h[k]?(m=c.charCodeAt(k),"\ufef5"<=h[k]&&"\ufefc">=h[k]?(f?
(0<k&&b&&" "===h[k-1]?g=g.substring(0,g.length-1)+"\u0644":(g+="\u0644",l=!0),g+=P[(m-65269)/2]):(g+=P[(m-65269)/2],g+="\u0644",k+1<c.length&&b&&" "===h[k+1]?k++:l=!0),l&&(x(n,k,!0,1),y.splice(k,0,y[k]))):g+=p[m-65136]):g+=h[k];this.sourceToTarget=y;this.targetToSource=n;this.levels=w;return g},_inputFormatSetter:function(a){if(!N.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=a},_outputFormatSetter:function(a){if(!N.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.outputFormat=a},checkParameters:function(a,b){a?this.set("inputFormat",a):a=this.inputFormat;b?this.set("outputFormat",b):b=this.outputFormat;return a===b?!1:!0},checkContextual:function(a){a=b(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(Ha){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a},hasBidiChar:function(a){return M.test(a)}});var y=[],n=[],w=[],z={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,
hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1},C=5,B=6,F=0,G=1,N=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,M=/[\u0591-\u06ff\ufb1d-\ufefc]/,R=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],
["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],P=["\u0622","\u0623","\u0625","\u0627"],Q=["\ufef5","\ufef7","\ufef9","\ufefb"],T=["\ufef6","\ufef8","\ufefa","\ufefc"],O="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split(""),
S="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split(""),H="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split(""),
Y="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split(""),W="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split(""),
E="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split(""),p="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split(""),
A=["\u0621","\u0641"],K=["\u063a","\u064a"],U=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],V=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],X=0,ba=1,fa=2,ha=3,ca=4,ea=5,ja=6,na=7,za=8,ua=11,wa=12,da="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" "),ra=100;l=X;h=ba;var ga=fa,pa=ha,J=ca,D=ea,Ea=ja,L=na,Fa=za,
sa=ua,Z=wa,ma=[ra+0,l,l,l,l,ra+1,ra+2,ra+3,h,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,ra+4,J,J,J,l,J,l,J,l,J,J,J,l,l,J,J,l,l,l,l,l,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,l,l,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,l,l,J,J,l,l,J,J,l,l,J,J,J,J,J,J,J,J,J,J,J,
J,J,J,J,J,J,J,J,J,J,J,J,l,l,l,ra+5,L,L,ra+6,ra+7],Pa=[[18,18,18,18,18,18,18,18,18,Ea,D,Ea,Fa,D,18,18,18,18,18,18,18,18,18,18,18,18,18,18,D,D,D,Ea,Fa,J,J,sa,sa,sa,J,J,J,J,J,10,9,10,9,9,ga,ga,ga,ga,ga,ga,ga,ga,ga,ga,9,J,J,J,J,J,J,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,J,J,J,J,J,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,J,J,J,18,18,18,18,18,18,D,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,J,sa,sa,sa,sa,J,J,J,J,l,J,J,18,J,J,sa,sa,ga,ga,J,
l,J,J,J,ga,l,J,J,J,J,J,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,l,l,l,l,l,l,l,l],[l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,J,J,J,J,J,J,J,J,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,J,l,l,l,l,l,l,l,J,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,l,J,J,J,J,J,J,J,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,
Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,h,Z,h,Z,Z,h,Z,Z,h,Z,J,J,J,J,J,J,J,J,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,J,J,J,J,J,h,h,h,h,h,J,J,J,J,J,J,J,J,J,J,J],[pa,pa,pa,pa,J,J,J,J,L,sa,sa,L,9,L,J,J,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,L,J,J,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,pa,pa,pa,pa,pa,pa,pa,pa,pa,pa,sa,pa,pa,L,L,L,Z,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,
L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,Z,Z,Z,Z,Z,Z,Z,pa,J,Z,Z,Z,Z,Z,Z,L,L,Z,Z,J,Z,Z,Z,Z,L,L,ga,ga,ga,ga,ga,ga,ga,ga,ga,ga,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,J,L,L,Z,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,J,J,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,
L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,L,J,J,J,J,J,J,J,J,J,J,J,J,J,J,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,Z,Z,Z,Z,Z,Z,Z,Z,Z,h,h,J,J,J,J,h,J,J,J,J,J],[Fa,Fa,Fa,Fa,Fa,Fa,Fa,Fa,Fa,Fa,Fa,18,18,18,l,h,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,Fa,D,13,14,15,16,17,9,sa,sa,sa,sa,sa,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,9,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,Fa,18,18,18,18,18,J,J,J,J,J,18,18,18,18,18,18,ga,l,J,J,ga,ga,ga,
ga,ga,ga,10,10,J,J,J,l,ga,ga,ga,ga,ga,ga,ga,ga,ga,ga,10,10,J,J,J,J,l,l,l,l,l,l,l,l,l,l,l,l,l,J,J,J,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,sa,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J],[l,l,l,l,l,l,l,J,J,J,J,J,J,J,J,J,J,J,J,l,l,l,l,l,J,J,J,J,J,h,Z,h,h,h,h,h,h,h,h,h,h,10,h,h,h,h,h,h,h,h,h,h,h,h,h,J,h,h,h,h,h,J,h,J,h,h,J,h,h,J,h,h,h,h,h,h,h,h,h,h,L,L,L,L,L,L,L,L,L,L,L,
L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,Z,Z,Z,Z,Z,Z,Z,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,9,J,9,J,J,
9,J,J,J,J,J,J,J,J,J,sa,J,J,10,10,J,J,J,J,J,sa,sa,J,J,J,J,J,L,L,L,L,L,J,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,J,J,18],[J,J,J,sa,sa,sa,J,J,J,J,J,10,9,10,9,9,ga,ga,ga,ga,ga,ga,ga,ga,ga,ga,9,J,J,J,J,J,J,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,J,J,J,J,J,l,l,l,
l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,J,J,J,J,J,J,J,J,J,J,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,J,J,J,l,l,l,l,l,l,J,J,l,l,l,l,l,l,J,J,l,l,l,l,l,l,J,J,l,l,l,J,J,J,sa,sa,J,J,J,sa,sa,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J]];return m})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["require","exports","./Geometry","./GeometryUtils"],
function(m,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});var b=function(){return function(b,d,a){this.ratio=b;this.x=d;this.y=a}}();m=function(){function d(b,a,d,c,g){void 0===c&&(c=8);void 0===g&&(g=8);this.lines=[];this.starts=[];this.pixelRatio=c;this.pixelMargin=g;this.tileSize=512*c;this.dz=b;this.yPos=a;this.xPos=d}return d.prototype.setExtent=function(b){this.finalRatio=this.tileSize/b*(1<<this.dz);var a=this.pixelRatio*this.pixelMargin,a=a/this.finalRatio;b>>=this.dz;a>b&&(a=b);
this.margin=a;this.xmin=b*this.xPos-a;this.ymin=b*this.yPos-a;this.xmax=this.xmin+b+2*a;this.ymax=this.ymin+b+2*a},d.prototype.reset=function(b){this.type=b;this.lines=[];this.starts=[];this.line=null;this.start=0},d.prototype.moveTo=function(b,a){this._pushLine();this._prevIsIn=this._isIn(b,a);this._moveTo(b,a,this._prevIsIn);this._prevPt=new h.Point(b,a);this._firstPt=new h.Point(b,a);this._dist=0},d.prototype.lineTo=function(d,a){var e,c,f,g,k,l,m,x,y=this._isIn(d,a),n=new h.Point(d,a),w=h.Point.distance(this._prevPt,
n);if(y)this._prevIsIn?this._lineTo(d,a,!0):(e=this._prevPt,c=n,f=this._intersect(c,e),this.start=this._dist+w*(1-this._r),this._lineTo(f.x,f.y,!0),this._lineTo(c.x,c.y,!0));else if(this._prevIsIn)c=this._prevPt,e=n,f=this._intersect(c,e),this._lineTo(f.x,f.y,!0),this._lineTo(e.x,e.y,!1);else{a=this._prevPt;if(!(a.x<=this.xmin&&n.x<=this.xmin||a.x>=this.xmax&&n.x>=this.xmax||a.y<=this.ymin&&n.y<=this.ymin||a.y>=this.ymax&&n.y>=this.ymax))if(d=[],(a.x<this.xmin&&n.x>this.xmin||a.x>this.xmin&&n.x<this.xmin)&&
(g=(this.xmin-a.x)/(n.x-a.x),x=a.y+g*(n.y-a.y),x<=this.ymin?l=!1:x>=this.ymax?l=!0:d.push(new b(g,this.xmin,x))),(a.x<this.xmax&&n.x>this.xmax||a.x>this.xmax&&n.x<this.xmax)&&(g=(this.xmax-a.x)/(n.x-a.x),x=a.y+g*(n.y-a.y),x<=this.ymin?l=!1:x>=this.ymax?l=!0:d.push(new b(g,this.xmax,x))),(a.y<this.ymin&&n.y>this.ymin||a.y>this.ymin&&n.y<this.ymin)&&(g=(this.ymin-a.y)/(n.y-a.y),m=a.x+g*(n.x-a.x),m<=this.xmin?k=!1:m>=this.xmax?k=!0:d.push(new b(g,m,this.ymin))),(a.y<this.ymax&&n.y>this.ymax||a.y>this.ymax&&
n.y<this.ymax)&&(g=(this.ymax-a.y)/(n.y-a.y),m=a.x+g*(n.x-a.x),m<=this.xmin?k=!1:m>=this.xmax?k=!0:d.push(new b(g,m,this.ymax))),0===d.length)k?l?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):l?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<d.length&&d[0].ratio>d[1].ratio)this.start=this._dist+w*d[1].ratio,this._lineTo(d[1].x,d[1].y,!0),this._lineTo(d[0].x,d[0].y,!0);else for(this.start=this._dist+w*d[0].ratio,g=0;g<d.length;g++)this._lineTo(d[g].x,
d[g].y,!0);this._lineTo(n.x,n.y,!1)}this._dist+=w;this._prevIsIn=y;this._prevPt=n},d.prototype.close=function(){var b,a;0<this.line.length&&(b=this._firstPt,a=this._prevPt,b.x===a.x&&b.y===a.y||this.lineTo(b.x,b.y),b=this.line,a=b.length,4<=a&&(b[0].x===b[1].x&&b[0].x===b[a-2].x||b[0].y===b[1].y&&b[0].y===b[a-2].y)&&(b.pop(),b[0].x=b[a-2].x,b[0].y=b[a-2].y))},d.prototype.result=function(){return this._pushLine(),0===this.lines.length?null:(3===this.type&&g.simplify(this.margin*this.finalRatio,this.lines),
this.lines)},d.prototype.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();var b=this.lines,a=b.length;if(0===a)return null;for(var d=[],c=0;a>c;c++)d.push({line:b[c],start:this.starts[c]||0});return d},d.prototype._isIn=function(b,a){return b>=this.xmin&&b<=this.xmax&&a>=this.ymin&&a<=this.ymax},d.prototype._intersect=function(b,a){var d,c,f;if(a.x>=this.xmin&&a.x<=this.xmax)c=a.y<=this.ymin?this.ymin:this.ymax,f=(c-b.y)/(a.y-b.y),d=b.x+f*(a.x-b.x);
else if(a.y>=this.ymin&&a.y<=this.ymax)d=a.x<=this.xmin?this.xmin:this.xmax,f=(d-b.x)/(a.x-b.x),c=b.y+f*(a.y-b.y);else{c=a.y<=this.ymin?this.ymin:this.ymax;d=a.x<=this.xmin?this.xmin:this.xmax;var g=(d-b.x)/(a.x-b.x),k=(c-b.y)/(a.y-b.y);k>g?(f=g,c=b.y+g*(a.y-b.y)):(f=k,d=b.x+k*(a.x-b.x))}return this._r=f,new h.Point(d,c)},d.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),
this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0},d.prototype._moveTo=function(b,a,d){3!==this.type?d&&(b=Math.round((b-(this.xmin+this.margin))*this.finalRatio),a=Math.round((a-(this.ymin+this.margin))*this.finalRatio),this.line.push(new h.Point(b,a))):(d||(b<this.xmin&&(b=this.xmin),b>this.xmax&&(b=this.xmax),a<this.ymin&&(a=this.ymin),a>this.ymax&&(a=this.ymax)),b=Math.round((b-(this.xmin+this.margin))*
this.finalRatio),a=Math.round((a-(this.ymin+this.margin))*this.finalRatio),this.line.push(new h.Point(b,a)),this._is_h=!1,this._is_v=!1)},d.prototype._lineTo=function(b,a,d){var c,e;if(3!==this.type)d?(b=Math.round((b-(this.xmin+this.margin))*this.finalRatio),a=Math.round((a-(this.ymin+this.margin))*this.finalRatio),0<this.line.length&&(c=this.line[this.line.length-1],c.equals(b,a)))||this.line.push(new h.Point(b,a)):this.line&&0<this.line.length&&this._pushLine();else if(d||(b<this.xmin&&(b=this.xmin),
b>this.xmax&&(b=this.xmax),a<this.ymin&&(a=this.ymin),a>this.ymax&&(a=this.ymax)),b=Math.round((b-(this.xmin+this.margin))*this.finalRatio),a=Math.round((a-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){c=this.line[this.line.length-1];d=c.x===b;var f=c.y===a;d&&f||(this._is_h&&d?(c.x=b,c.y=a,e=this.line[this.line.length-2],this._is_h=e.x===b,this._is_v=e.y===a):this._is_v&&f?(c.x=b,c.y=a,e=this.line[this.line.length-2],this._is_h=e.x===b,this._is_v=e.y===a):(this.line.push(new h.Point(b,
a)),this._is_h=d,this._is_v=f))}else this.line.push(new h.Point(b,a))},d}();l.TileClipper=m;m=function(){function b(){}return b.prototype.setExtent=function(b){this._ratio=4096===b?1:4096/b},b.prototype.reset=function(b){this.type=b;this.lines=[];this.line=null},b.prototype.moveTo=function(b,a){this.line&&this.lines.push(this.line);this.line=[];var d=this._ratio;this.line.push(new h.Point(Math.round(b*d),Math.round(a*d)))},b.prototype.lineTo=function(b,a){var d=this._ratio;this.line.push(new h.Point(Math.round(b*
d),Math.round(a*d)))},b.prototype.close=function(){var b=this.line;b&&!b[0].isEqual(b[b.length-1])&&b.push(b[0])},b.prototype.result=function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:(3===this.type&&1!==this._ratio&&g.simplify(64,this.lines),this.lines)},b}();l.SimpleBuilder=m;var g=function(){function b(){}return b.simplify=function(d,a){if(a){var e=-d,c=4096+d,f=-d,g=4096+d;d=[];for(var h=[],k=a.length,l=0;k>l;++l){var m=a[l];if(m&&!(2>m.length))for(var y=m[0],n=
void 0,w=m.length,z=1;w>z;++z)n=m[z],y.x===n.x&&(y.x<=e&&(y.y>n.y?(d.push(l),d.push(z),d.push(0),d.push(-1)):(h.push(l),h.push(z),h.push(0),h.push(-1))),y.x>=c&&(y.y<n.y?(d.push(l),d.push(z),d.push(1),d.push(-1)):(h.push(l),h.push(z),h.push(1),h.push(-1)))),y.y===n.y&&(y.y<=f&&(y.x<n.x?(d.push(l),d.push(z),d.push(2),d.push(-1)):(h.push(l),h.push(z),h.push(2),h.push(-1))),y.y>=g&&(y.x>n.x?(d.push(l),d.push(z),d.push(3),d.push(-1)):(h.push(l),h.push(z),h.push(3),h.push(-1)))),y=n}0!==d.length&&0!==
h.length&&(b.fillParent(a,h,d),b.fillParent(a,d,h),e=[],b.calcDeltas(e,h,d),b.calcDeltas(e,d,h),b.addDeltas(e,a))}},b.fillParent=function(b,a,e){for(var c=e.length,f=a.length,g=0;f>g;g+=4){for(var h=a[g],k=a[g+1],l=a[g+2],m=b[h][k-1],h=b[h][k],k=8092,y=-1,n=0;c>n;n+=4)if(e[n+2]===l){var w=e[n],z=e[n+1],C=b[w][z-1],w=b[w][z];switch(l){case 0:case 1:d.between(m.y,C.y,w.y)&&d.between(h.y,C.y,w.y)&&(C=Math.abs(w.y-C.y),k>C&&(k=C,y=n));break;case 2:case 3:d.between(m.x,C.x,w.x)&&d.between(h.x,C.x,w.x)&&
(C=Math.abs(w.x-C.x),k>C&&(k=C,y=n))}}a[g+3]=y}},b.calcDeltas=function(d,a,e){for(var c=a.length,f=0;c>f;f+=4){var g=b.calcDelta(f,a,e,[]);d.push(a[f]);d.push(a[f+1]);d.push(a[f+2]);d.push(g)}},b.calcDelta=function(d,a,e,c){d=a[d+3];if(-1===d)return 0;var f=c.length;return 1<f&&c[f-2]===d?0:(c.push(d),b.calcDelta(d,e,a,c)+1)},b.addDeltas=function(b,a){for(var d=b.length,c=0,f=0;d>f;f+=4){var g=b[f+3];g>c&&(c=g)}for(f=0;d>f;f+=4){var h=a[b[f]],k=b[f+1],g=c-b[f+3];switch(b[f+2]){case 0:h[k-1].x-=g;
h[k].x-=g;break;case 1:h[k-1].x+=g;h[k].x+=g;break;case 2:h[k-1].y-=g;h[k].y-=g;break;case 3:h[k-1].y+=g,h[k].y+=g}}b=a.length;for(d=0;b>d;++d)h=a[d],!h||2>h.length||h[h.length-1].x!==h[0].x&&h[h.length-1].y!==h[0].y&&h.push(h[0])},b}()})},"url:esri/core/request/iframe.html":'\x3c!DOCTYPE html\x3e\n\x3chtml\x3e\n\x3chead\x3e\n  \x3cmeta http-equiv\x3d"Content-Security-Policy" content\x3d"default-src \'none\'; script-src * \'unsafe-inline\'"\x3e\n\n  \x3cscript\x3e\n    var dojoConfig \x3d {\n      async: true,\n      baseUrl: "../../../dojo/",\n      has: {\n        "csp-restrictions": true,\n        "dojo-preload-i18n-Api": false\n      }\n    };\n  \x3c/script\x3e\n  \x3c!--\n  This src is relative to this page and assumes dojo is a sibling to esri.\n  It is updated when this file is set as the iframe\'s `srcdoc` value.\n  --\x3e\n  \x3cscript src\x3d"../../../dojo/dojo.js"\x3e\x3c/script\x3e\n\n  \x3cscript\x3e\n    function windowMessageHandler(event) {\n      window.removeEventListener("message", windowMessageHandler);\n\n      var port \x3d event.ports[0];\n\n      require([\n        "dojo/request/script"\n      ], function(script) {\n        port.postMessage("ready");\n\n        port.addEventListener("message", function(event) {\n          var data \x3d event.data;\n          script.get(data.url, data.options)\n              .then(function(response) {\n                port.postMessage({\n                  id: data.id,\n                  response: response\n                });\n              })\n              .otherwise(function(error) {\n                port.postMessage({\n                  id: data.id,\n                  isError: true,\n                  message: error.message\n                });\n              });\n        });\n        port.start();\n      });\n    }\n\n    window.addEventListener("message", windowMessageHandler);\n  \x3c/script\x3e\n\x3c/head\x3e\n\x3cbody\x3e\n\x3c/body\x3e\n\x3c/html\x3e\n',
"url:esri/views/vectorTiles/renderers/shaders/backgroundShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  // YF TODO: (doc)\n--\x3e\n\x3csnippets\x3e\n  \x3csnippet name\x3d"backgroundVS"\x3e\n    \x3c![CDATA[\n    precision mediump float;\n\n    attribute vec2 a_pos;\n\n  #ifdef ID\n    uniform mediump vec4 u_id;\n    varying mediump vec4 v_id;\n  #endif // ID\n\n    uniform highp mat4 u_transformMatrix;\n    uniform mediump vec2 u_normalized_origin;\n    uniform mediump float u_coord_range;\n    uniform mediump float u_depth;\n\n  #ifdef PATTERN\n    uniform mediump mat3 u_pattern_matrix; // can we use medium precision?\n    varying mediump vec2 v_tileTextureCoord;\n  #endif // PATTERN\n\n    void main() {\n      gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\n\n  #ifdef PATTERN\n      // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n      // The pattern matrix is a 3x3 scale matrix which \'tiles\' the texture inside the tile, translating from tile coordinates\n      v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n  #endif // PATTERN\n\n  #ifdef ID\n      v_id \x3d u_id / 255.0;\n  #endif // ID\n    }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"backgroundFS"\x3e\n    \x3c![CDATA[\n  #ifdef PATTERN\n    uniform lowp float u_opacity;\n    uniform mediump vec2 u_pattern_tl;\n    uniform mediump vec2 u_pattern_br;\n    uniform sampler2D u_texture;\n\n    varying mediump vec2 v_tileTextureCoord;\n  #else\n    uniform lowp vec4 u_color;\n  #endif // PATTERN\n\n  #ifdef ID\n    varying mediump vec4 v_id;\n  #endif // ID\n\n    void main() {\n  #ifdef PATTERN\n      // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n      mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n\n      // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n      // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n      // we need to only sample from area that has our sprite in the mosaic.\n      mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n\n      // sample the sprite mosaic\n      lowp vec4 color \x3d texture2D(u_texture, samplePos);\n      gl_FragColor \x3d u_opacity * color;\n  #else\n      gl_FragColor \x3d u_color;\n  #endif // PATTERN\n\n  #ifdef ID\n      if (gl_FragColor.a \x3c 1.0 / 255.0) {\n        discard;\n      }\n      gl_FragColor \x3d v_id;\n  #endif // ID\n    }\n    ]]\x3e\n  \x3c/snippet\x3e\n\x3c/snippets\x3e\n',
"url:esri/views/vectorTiles/renderers/shaders/fillShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  // YF TODO: (doc)\n--\x3e\n\x3csnippets\x3e\n  \x3csnippet name\x3d"fillVS"\x3e\n    \x3c![CDATA[\n      precision mediump float;\n\n      attribute vec2 a_pos;\n\n      uniform highp mat4 u_transformMatrix;\n      uniform highp vec2 u_normalized_origin;\n      uniform mediump float u_depth;\n\n    #ifdef PATTERN\n      uniform mediump mat3 u_pattern_matrix;\n      varying mediump vec2 v_tileTextureCoord;\n    #endif // PATTERN\n\n    #ifdef ID\n      uniform mediump vec4 u_id;\n      varying mediump vec4 v_id;\n    #endif // ID\n\n    #ifdef DD\n      attribute vec4 a_color;\n    #else\n      uniform lowp vec4 u_color;\n    #endif // DD\n      varying lowp vec4 v_color;\n\n      void main()\n      {\n      #ifdef DD\n        v_color \x3d a_color;\n      #else\n        v_color \x3d u_color;\n      #endif // DD\n\n      #ifdef ID\n        v_id \x3d u_id / 255.0;\n      #endif // ID\n\n      #ifdef PATTERN\n        // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n        // The pattern matrix is a 3x3 scale matrix which \'tiles\' the texture inside the tile, translating from tile coordinates\n        // (-4k to 8k -1) to texture coordinates.\n        v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n      #endif // PATTERN\n\n        gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"fillFS"\x3e\n    \x3c![CDATA[\n      precision lowp float;\n\n    #ifdef PATTERN\n      uniform mediump vec2 u_pattern_tl;\n      uniform mediump vec2 u_pattern_br;\n      uniform lowp sampler2D u_texture;\n      varying mediump vec2 v_tileTextureCoord;\n    #endif // PATTERN\n\n    #ifdef ID\n      varying mediump vec4 v_id;\n    #endif // ID\n\n      varying lowp vec4 v_color;\n\n      vec4 mixColors(vec4 color1, vec4 color2) {\n        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Alpha_blending)\n        // we use pre-multiplied colors hence the need for this kind of mixing. At lease we save ourselves an extra division...\n        float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n        vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n\n        return vec4(compositeColor, compositeAlpha);\n      }\n      void main()\n      {\n      #ifdef PATTERN\n        // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n        mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n\n        // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n        // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n        // we need to only sample from area that has our sprite in the mosaic.\n        mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n\n        // sample the sprite mosaic\n        lowp vec4 color \x3d texture2D(u_texture, samplePos);\n        gl_FragColor \x3d v_color[3] * color;\n      #else\n        gl_FragColor \x3d v_color;\n      #endif // PATTERN\n\n      #ifdef ID\n        if (gl_FragColor.a \x3c 1.0 / 255.0) {\n          discard;\n        }\n        gl_FragColor \x3d v_id;\n      #endif // ID\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\x3c/snippets\x3e\n',
"url:esri/views/vectorTiles/renderers/shaders/outlineShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  // YF TODO: (doc)\n--\x3e\n\x3csnippets\x3e\n  \x3csnippet name\x3d"outlineVS"\x3e\n    \x3c![CDATA[\n      attribute vec2 a_pos;\n      attribute vec2 a_offset;\n      attribute vec2 a_xnormal;\n\n    #ifdef DD\n      attribute vec4 a_color;\n    #else\n      uniform lowp vec4 u_color;\n    #endif // DD\n      varying lowp vec4 v_color;\n\n    #ifdef ID\n      uniform mediump vec4 u_id;\n      varying mediump vec4 v_id;\n    #endif // ID\n\n      uniform highp mat4 u_transformMatrix;\n      uniform highp mat4 u_extrudeMatrix;\n      uniform highp vec2 u_normalized_origin;\n      uniform mediump float u_depth;\n      uniform mediump float u_outline_width;\n\n      varying lowp vec2 v_normal;\n\n      const float scale \x3d 1.0 / 15.0;\n\n      void main()\n      {\n      #ifdef DD\n        v_color \x3d a_color;\n      #else\n        v_color \x3d u_color;\n      #endif // DD\n\n      #ifdef ID\n        v_id \x3d u_id / 255.0;\n      #endif // ID\n\n        v_normal \x3d a_xnormal;\n\n        // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n        // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n        mediump vec4 dist \x3d vec4(u_outline_width * a_offset * scale, 0.0, 0.0);\n\n        // Remove the texture normal bit of the position before scaling it with the\n        // model/view matrix. Add the extrusion vector *after* the model/view matrix\n        // because we\'re extruding the line in pixel space, regardless of the current\n        // tile\'s zoom level.\n        gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * dist;\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"outlineFS"\x3e\n    \x3c![CDATA[\n      varying lowp vec4 v_color;\n      varying mediump vec2 v_normal;\n\n    #ifdef ID\n      varying mediump vec4 v_id;\n    #endif // ID\n\n      void main()\n      {\n        // Calculate the distance of the pixel from the line in pixels.\n        lowp float dist \x3d abs(v_normal.y);\n\n        lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n        gl_FragColor \x3d alpha * v_color;\n\n      #ifdef ID\n        if (gl_FragColor.a \x3c 1.0 / 255.0) {\n          discard;\n        }\n        gl_FragColor \x3d v_id;\n      #endif // ID\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\x3c/snippets\x3e\n',
"url:esri/views/vectorTiles/renderers/shaders/lineShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  // YF TODO: (doc)\n--\x3e\n\x3csnippets\x3e\n  \x3csnippet name\x3d"lineVS"\x3e\n    \x3c![CDATA[\n      /* The implementation of the renderer is based on the article and implementation of MB described here:\n      * https://www.mapbox.com/blog/drawing-antialiased-lines/\n      */\n\n      attribute vec2 a_pos;\n      attribute vec4 a_offsetAndNormal;\n      attribute vec2 a_accumulatedDistance;\n\n      // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n      // relative to the tile\'s upper left corner\n      // the extrusion vector.\n      uniform highp mat4 u_transformMatrix;\n\n      // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\n      uniform highp mat4 u_extrudeMatrix;\n\n      // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\n      uniform highp vec2 u_normalized_origin;\n\n      uniform mediump float u_blur; // the feather distance at which the line edge fades out\n\n      // the z of the layer. Given by the order of the layers in the style\n      uniform mediump float u_depth;\n\n      // the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\n      varying mediump vec2 v_normal;\n\n      // the accumulated distance along the line. We need this information in order to render the dashes.\n      varying highp float v_accumulatedDistance;\n\n      const float scale \x3d 1.0 / 31.0;\n\n    #ifdef DD\n      attribute vec4 a_color;\n      attribute mediump float a_width;\n    #else\n      uniform lowp vec4 u_color;\n      uniform mediump float u_width;\n    #endif // DD\n\n    #ifdef ID\n      uniform mediump vec4 u_id;\n      varying mediump vec4 v_id;\n    #endif // ID\n\n      varying lowp vec4 v_color;\n      varying mediump float v_lineHalfWidth; // the inset and outset of the line\n\n    #ifndef PATTERN\n      uniform mediump vec2 u_dasharray;\n      varying mediump vec2 v_dasharray;\n    #endif\n\n      void main()\n      {\n        v_normal \x3d a_offsetAndNormal.zw * scale;\n\n      #ifdef DD\n        v_lineHalfWidth \x3d a_width + u_blur;\n      #else\n        v_lineHalfWidth \x3d u_width + u_blur;\n      #endif // DD\n\n        v_lineHalfWidth *\x3d 0.5;\n\n      #ifndef PATTERN\n      #ifdef DD\n        v_dasharray \x3d u_dasharray * a_width;\n      #else\n        v_dasharray \x3d u_dasharray * u_width;\n      #endif // DD\n      #endif\n\n        // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n        // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n        mediump vec2 dist \x3d v_lineHalfWidth * a_offsetAndNormal.xy * scale;\n\n        // transform the vertex\n        gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n\n        // the accumulated distance will be used to calculate the dashes (or the no-data...)\n        v_accumulatedDistance \x3d a_accumulatedDistance.x;\n\n        #ifdef DD\n          v_color \x3d a_color;\n        #else\n          v_color \x3d u_color;\n        #endif // DD\n\n        #ifdef ID\n          v_id \x3d u_id / 255.0;\n        #endif // ID\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"lineFS"\x3e\n    \x3c![CDATA[\n      uniform mediump float u_blur;\n\n      varying mediump vec2 v_normal;\n      varying highp float v_accumulatedDistance;\n\n      varying mediump float v_lineHalfWidth;\n      varying lowp vec4 v_color;\n\n    #ifdef PATTERN\n      uniform mediump vec2 u_pattern_tl;\n      uniform mediump vec2 u_pattern_br;\n      uniform mediump vec2 u_spriteSize;\n      uniform sampler2D u_texture;\n\n      // Horizontal scale is used to scale the horizontal texture coordinate v_normal.x before adding it as an offset to the\n      // accumulated distance. Most vertices will have v_normal.x \x3d\x3d 0, because the pattern must be sampled only depending on\n      // the v_accumulatedDistance value. But tessellation at caps can have vertices with v_normal.x !\x3d 0, thus allowing to\n      // "keep moving" for a few more pixel even when the line has ended or has not started yet.\n      const mediump float tileCoordRatio \x3d 8.0;\n    #else\n      varying mediump vec2 v_dasharray;\n    #endif\n\n    #ifdef ID\n      varying mediump vec4 v_id;\n    #endif // ID\n\n      void main()\n      {\n        // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n        // and any value in between will be inside the line (the sign represent the direction - right or left).\n        // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n        mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n\n        // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n        // We need to count for both sides of the line.\n        lowp float alpha \x3d clamp(min(fragDist + u_blur + 1.0, v_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\n\n      #ifdef PATTERN\n        // we need to calculate the relative portion of the line texture along the line given the accumulated distance aliong the line\n        // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\n        mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n\n        // in order to calculate the texture coordinates perpendicular to the line (Y axis), we use the interpolated normal values\n        // which range from -1.0 to 1.0. On the line\'s centerline, the value of the interpolated normal is 0.0, however the relative\n        // texture value should be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\n        // (TL) ---------------------------      --\x3e left edge of line. Interpolated normal is 1.0\n        //              | -\x3e line-width / 2\n        //      - - - - - - - - - - - - - -\n        //              | -\x3e line-width / 2\n        //      ---------------------------- (BR)--\x3e right edge of line. Interpolated normal is -1.0\n\n        mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n\n        // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n        mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n\n        // get the color from the texture\n        lowp vec4 color \x3d texture2D(u_texture, texCoord);\n\n        // finally write the fragment value\n        gl_FragColor \x3d alpha * v_color[3] * color;\n      #else\n        // now calculate the dashes given the accumulated distance of the line:\n        // start with calculating a normalized position along the line\n        lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n\n        // calculate the contribution to the alpha of the dash part. It is provided by the shortest portion of the position along the dash.\n        // we must clamp since the value might be bigger than 1 or smaller than zero (when over a dash).\n        //   | \x3c--- pos along the dash part\n        // -------_______-------_______\n        // when the dashPos is over the \'gap\' part of the dash dasharray.x - dashPos is negative and therefore the alpha will\n        // get clamped to zero.\n        // when dasharray.x - dashPos is positive, or when dashPos is smaller than 1.0, it gives us a soft edge to each dash part.\n        // along the direction of the line.\n        lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n\n        // if we don\'t have a no-data part to the dash then it is a solid line\n        dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n        // finally multiply the fragment\'s alpha by the calculated dash-alpha\n        alpha *\x3d dashAlpha;\n\n        // output the fragment color\n        gl_FragColor \x3d alpha * v_color;\n      #endif // PATTERN\n\n      #ifdef ID\n        if (gl_FragColor.a \x3c 1.0 / 255.0) {\n          discard;\n        }\n        gl_FragColor \x3d v_id;\n      #endif // ID\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\x3c/snippets\x3e\n',
"url:esri/views/vectorTiles/renderers/shaders/iconShaders.xml":"\x3c?xml version\x3d\"1.0\" encoding\x3d\"UTF-8\"?\x3e\n\x3c!--\n  Add your GLSL snippets to this file. You should start from\n  importing your old GLSL files. For instance, if you have a\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d\"myShaderVS\"\x3e\n  and then copy and paste the GLSL source as the content. You will then convert your\n  code to use the {@link module:esri/views/vectorTiles/renderers/vtShaderSnippets vtShaderSnippets}\n  instance to access the GLSL code, instead of importing it directly with require(\"dojo/text!...\").\n--\x3e\n\x3csnippets\x3e\n  \x3csnippet name\x3d\"rgba2floatFunc\"\x3e\n    \x3c![CDATA[\n    float rgba2float(vec4 rgba) {\n      return dot(rgba,  vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0));\n    }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d\"iconVS\"\x3e\n    \x3c![CDATA[\n      attribute vec2 a_pos;\n      attribute vec2 a_vertexOffset;\n      attribute vec4 a_tex;\n      attribute vec4 a_levelInfo;\n\n    #ifdef DD\n      attribute vec4 a_color;\n      attribute mediump float a_size;\n    #else\n      uniform lowp vec4 u_color;\n      uniform mediump float u_size;\n    #endif // DD\n\n    #ifdef ID\n      uniform mediump vec4 u_id;\n      varying mediump vec4 v_id;\n    #endif // ID\n\n      varying lowp vec4 v_color;\n\n      // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n      // relative to the tile's upper left corner\n      // the extrusion vector.\n      uniform highp mat4 u_transformMatrix;\n\n      // the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\n      uniform highp mat4 u_extrudeMatrix;\n\n      // u_normalized_origin is the tile's upper left corner given in normalized coordinates\n      uniform highp vec2 u_normalized_origin;\n\n      // the size of the mosaic given in pixels\n      uniform vec2 u_mosaicSize;\n\n      // the z of the layer. Given by the order of the layers in the style\n      uniform mediump float u_depth;\n\n      // the map's rotation from the north\n      uniform mediump float u_mapRotation;\n      uniform mediump float u_level;\n\n      // indicate whether the current set of iconst should be kept upright when the map is rotated\n      uniform lowp float u_keepUpright;\n\n      // the rate of the change in the opacity (fade) of the icons\n      uniform mediump float u_fadeSpeed;\n\n      // the low level we transition (to/from)\n      uniform mediump float u_minfadeLevel;\n\n      // the high level we transition (to/from)\n      uniform mediump float u_maxfadeLevel;\n\n      // the amount of fade given teh current time past the last recorded level\n      uniform mediump float u_fadeChange;\n\n      // the opacity of the layer given by the painter\n      uniform mediump float u_opacity;\n\n      // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\n      varying mediump vec2 v_tex;\n\n      // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n      // opacity of the layer given by the painter\n      varying lowp float v_transparency;\n\n      varying mediump vec2 v_size;\n\n      // the vertex offsets are given in integers, therefore in order to maintain a reasonable precision we multiply the values\n      // by 16 and then at the shader devide by the same number\n      const float C_OFFSET_PRECISION \x3d 1.0 / 32.0;\n\n      const float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\n      const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\n      const float tileCoordRatio \x3d 1.0 / 8.0;\n\n      void main()\n      {\n        mediump float a_labelMinLevel \x3d a_levelInfo[0];\n        mediump float a_angle         \x3d a_levelInfo[1];\n        mediump float a_minLevel      \x3d a_levelInfo[2];\n        mediump float a_maxLevel      \x3d a_levelInfo[3];\n\n        // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\n        mediump float delta_z \x3d 0.0;\n\n        // If the label rotates with the map, and if the rotated label is upside down, hide it\n        mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n        delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (64 \x3c\x3d rotated) \x26\x26 (rotated \x3c 192)\n\n        // u_level is the current service level adjusted for the change in font size\n        delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\n        delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\n\n        // calculate the alpha given the change in the fade and the fade-speed\n        lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\n\n        // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\n        v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n\n        // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\n        if (u_maxfadeLevel \x3c a_labelMinLevel)\n        {\n          v_transparency \x3d 0.0;\n        }\n        if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n        {\n          v_transparency \x3d 1.0;\n        }\n\n        // if label had been faded out, clip it\n        delta_z +\x3d step(v_transparency, 0.0);\n\n        vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n\n        v_size \x3d abs(offset);\n\n      #ifdef SDF\n        offset \x3d (120.0 / 86.0) * offset;\n      #endif // SDF\n\n      #ifdef DD\n        mediump float icon_size \x3d a_size;\n      #else\n        mediump float icon_size \x3d u_size;\n      #endif // DD\n        gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * icon_size * vec4(offset, delta_z, 0.0);\n\n        float opacity;\n\n      #ifdef SDF\n      #ifdef DD\n        v_color \x3d a_color;\n      #else\n        v_color \x3d u_color;\n      #endif // DD\n        opacity \x3d u_opacity;\n      #else // SDF\n      #ifdef DD\n        opacity \x3d a_color.w;\n      #else\n        opacity \x3d u_opacity;\n      #endif // DD\n      #endif // SDF\n\n      #ifdef ID\n        v_id \x3d u_id / 255.0;\n      #endif // ID\n\n        v_tex \x3d a_tex.xy / u_mosaicSize;\n        v_transparency *\x3d opacity;\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d\"iconFS\"\x3e\n    \x3c![CDATA[\n      precision mediump float;\n\n      uniform lowp sampler2D u_texture; // SDF texture\n    #ifdef SDF\n      uniform lowp vec4 u_color; // a color to override the one of the vertex\n      uniform lowp vec4 u_outlineColor;\n      uniform mediump float u_outlineSize;\n    #endif // SDF\n\n      varying mediump vec2 v_tex;\n      // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n      // opacity of the layer given by the painter\n      varying lowp float v_transparency;\n\n      varying mediump vec2 v_size;\n\n    #ifdef SDF\n      varying lowp vec4 v_color;\n    #endif // SDF\n\n    #ifdef ID\n      varying mediump vec4 v_id;\n    #endif // ID\n\n      // we need the conversion function from RGBA to float\n      $rgba2floatFunc\n\n      vec4 mixColors(vec4 color1, vec4 color2) {\n        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Alpha_blending)\n        // we use pre-multiplied colors hence the need for this kind of mixing. At lease we save ourselves an extra division...\n        float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n        vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n\n        return vec4(compositeColor, compositeAlpha);\n      }\n\n      void main()\n      {\n      #ifdef SDF\n        lowp vec4 fillPixelColor \x3d v_color;\n\n        // calculate the distance from the edge [-0.5, 0.5]\n        float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n\n        // Work around loss of precision for 'd \x3d 0.0'.\n        // '0' gets normalised to 0.5 * 256 \x3d 128 before float packing, but can only\n        // be stored in the texture as 128 / 255 \x3d 0.502.\n        // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603110\n        const float diff \x3d (128.0 / 255.0 - 0.5);\n\n        // adjust all values, not just those close to 0, to avoid discontinuities in\n        // the outlines of other shapes e.g. circles\n        d \x3d d - diff;\n\n        // the soft edge ratio is about 1.5 pixels allocated for the soft edge.\n        // 1 / 86 represents a single pixel given the the size of the SDF is 128 and we add 4 pixels margins to deal with\n        // other non SDF types.\n        // The rasterized geometry takes only 86 pixels because of the extra 16 pixels margin for the outline.\n        const float sofetEdgeRatio \x3d 0.248062016; // \x3d\x3d\x3e (32.0 / 86.0) / 1.5;\n        float size \x3d max(v_size.x, v_size.y);\n        float dist \x3d d * sofetEdgeRatio * size;\n\n        // set the fragment's transparency according to the distance from the edge\n        fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n\n        // count for the outline\n        // therefore tint the entire icon area.\n        if (u_outlineSize \x3e 0.25) {\n          lowp vec4 outlinePixelColor \x3d u_outlineColor;\n          // the outline limit ratio is derived from the 16 pixels allocated for the outline and the fact that 1/86 represents\n          // a single pixel.\n          const float outlineLimitRatio \x3d (16.0 / 86.0);\n          float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n\n          outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n\n          // finally combine the outline and the fill colors\n          gl_FragColor \x3d v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n        }\n        else {\n          gl_FragColor \x3d v_transparency * fillPixelColor;\n        }\n      #else // not an SDF\n        lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n        gl_FragColor \x3d v_transparency * texColor;\n      #endif // SDF\n\n      #ifdef ID\n        if (gl_FragColor.a \x3c 1.0 / 255.0) {\n          discard;\n        }\n        gl_FragColor \x3d v_id;\n      #endif // ID\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n\x3c/snippets\x3e\n\n",
"url:esri/views/vectorTiles/renderers/shaders/textShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  Add your GLSL snippets to this file. You should start from\n  importing your old GLSL files. For instance, if you have a\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\n  and then copy and paste the GLSL source as the content. You will then convert your\n  code to use the {@link module:esri/views/vectorTiles/renderers/vtShaderSnippets vtShaderSnippets}\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\n--\x3e\n\x3csnippets\x3e\n  \x3csnippet name\x3d"rgba2floatFunc"\x3e\n    \x3c![CDATA[\n    float rgba2float(vec4 rgba) {\n      return dot(rgba, vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0));\n    }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"textVS"\x3e\n    \x3c![CDATA[\n      attribute vec2 a_pos;\n      attribute vec2 a_vertexOffset;\n      attribute vec4 a_tex;\n      attribute vec4 a_levelInfo;\n\n      uniform lowp vec4 u_color; // always defined as halo does not support data driven but text does\n    #ifdef DD\n      attribute vec4 a_color;\n    #endif // DD\n      varying lowp vec4 v_color;\n\n    #ifdef DD\n      attribute mediump float a_size;\n    #else\n      uniform mediump float u_size;\n    #endif // DD\n      varying mediump float v_size;\n\n    #ifdef ID\n      uniform mediump vec4 u_id;\n      varying mediump vec4 v_id;\n    #endif // ID\n\n\n      // attribute bool a_visible; // --\x3e a one bit controlling the visibility of the vertex\n\n      // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n      // relative to the tile\'s upper left corner\n      // the extrusion vector.\n      uniform highp mat4 u_transformMatrix;\n\n      // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\n      uniform highp mat4 u_extrudeMatrix;\n\n      // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\n      uniform highp vec2 u_normalized_origin;\n\n      // the size of the mosaic given in pixels\n      uniform vec2 u_mosaicSize;\n\n      // the z of the layer. Given by the order of the layers in the style\n      uniform mediump float u_depth;\n\n      // the map\'s rotation from the north\n      uniform mediump float u_mapRotation;\n      uniform mediump float u_level;\n\n      // indicate whether the current set of iconst should be kept upright when the map is rotated\n      uniform lowp float u_keepUpright;\n\n      // the rate of the change in the opacity (fade) of the icons\n      uniform mediump float u_fadeSpeed;\n\n      // the low level we transition (to/from)\n      uniform mediump float u_minfadeLevel;\n\n      // the high level we transition (to/from)\n      uniform mediump float u_maxfadeLevel;\n\n      // the amount of fade given teh current time past the last recorded level\n      uniform mediump float u_fadeChange;\n\n      // the opacity of the layer given by the painter\n      uniform mediump float u_opacity;\n\n      // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\n      varying lowp vec2 v_tex;\n\n      // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n      // opacity of the layer given by the painter\n      varying lowp float v_transparency;\n\n      // the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n      // by 16 and then at the shader devide by the same number\n      const float offsetPrecision \x3d 1.0 / 32.0;\n\n      // outline position and appearance\n      const mediump float edgePos \x3d 0.75; // defined by the SDF encoding\n      uniform mediump float u_edgeDistance;\n      uniform mediump float u_edgeBlur;\n      uniform mediump float u_antialiasingWidth; // antialiasing (factors in the pixel_ratio for high res devices)\n\n      varying mediump float v_edgeDistance; // will factor in the size\n      varying mediump float v_edgeWidth; // will factor in the size\n\n      uniform lowp float u_halo; // needed to avoid using the color attribute for halo\n\n      void main()\n      {\n        mediump float a_labelMinLevel \x3d a_levelInfo[0];\n        mediump float a_angle        \x3d a_levelInfo[1];\n        mediump float a_minLevel    \x3d a_levelInfo[2];\n        mediump float a_maxLevel    \x3d a_levelInfo[3];\n\n        // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\n        mediump float delta_z \x3d 0.0;\n\n        // TODO: force clipping the vertex in case that the vertex isn\'t visible\n        //delta_z +\x3d a_visible ? 0.0 : 1.0;\n\n        // If the label rotates with the map, and if the rotated label is upside down, hide it\n        mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n        delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (64 \x3c\x3d rotated) \x26\x26 (rotated \x3c 192)\n\n        // u_level is the current service level adjusted for the change in font size\n        delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\n        delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\n\n        // calculate the alpha given the change in the fade and the fade-speed\n        lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\n\n        // if the speed is positive we are zooming in and therefore we need to \'fade-in\'. Else we need to \'fade-out\'\n        v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n\n        // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\n        if (u_maxfadeLevel \x3c a_labelMinLevel)\n        {\n          v_transparency \x3d 0.0;\n        }\n        if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n        {\n          v_transparency \x3d 1.0;\n        }\n\n        // if label has been faded out, clip it\n        delta_z +\x3d step(v_transparency, 0.0);\n\n        v_tex \x3d a_tex.xy / u_mosaicSize;\n\n      #ifdef DD\n        if (u_halo \x3e 0.5)\n        {\n          v_color \x3d u_color;\n          v_transparency *\x3d u_opacity;\n        }\n        else\n        {\n          v_color \x3d a_color;\n          // opacity already factored in a_color\n        }\n      #else\n        v_color \x3d u_color;\n        v_transparency *\x3d u_opacity;\n      #endif // DD\n\n      #ifdef DD\n        v_size \x3d a_size;\n      #else\n        v_size \x3d u_size;\n      #endif // DD\n\n      #ifdef ID\n        v_id \x3d u_id / 255.0;\n      #endif // ID\n\n        v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n        v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n\n        gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * v_size * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"textFS"\x3e\n    \x3c![CDATA[\n      uniform lowp sampler2D u_texture;\n      uniform mediump float u_edgeDistance;\n\n      varying lowp vec2 v_tex;\n      varying lowp float v_transparency;\n      varying lowp vec4 v_color;\n      varying mediump float v_edgeWidth;\n      varying mediump float v_edgeDistance;\n\n    #ifdef ID\n      varying mediump vec4 v_id;\n    #endif // ID\n\n      // this is taken from http://www.valvesoftware.com/publications/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\n      // and https://www.mapbox.com/blog/text-signed-distance-fields/\n      // http://metalbyexample.com/rendering-text-in-metal-with-signed-distance-fields/\n\n      void main()\n      {\n        // read the distance from the SDF texture\n        lowp float dist \x3d texture2D(u_texture, v_tex).a;\n\n        // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n        mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n\n        gl_FragColor \x3d alpha * v_color;\n\n      #ifdef ID\n        if (gl_FragColor.a \x3c 1.0 / 255.0) {\n          discard;\n        }\n        gl_FragColor \x3d v_id;\n      #endif // ID\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n\x3c/snippets\x3e\n\n',
"url:esri/views/vectorTiles/renderers/shaders/tileInfo.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump float u_coord_ratio;\nuniform mediump vec2 u_delta; // in tile coordinates\nuniform mediump vec2 u_dimensions; // in tile coordinates\n\nvarying mediump vec2 v_tex;\n\nvoid main() {\n  mediump vec2 offests \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\n\n  v_tex \x3d a_pos;\n}\n",
"url:esri/views/vectorTiles/renderers/shaders/tileInfo.fs.glsl":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\n\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}\n","url:esri/views/2d/engine/webgl/shaders/bitblit.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_tex;\n\nvarying mediump vec2 v_uv;\n\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}\n","url:esri/views/2d/engine/webgl/shaders/bitblit.fs.glsl":"\tuniform lowp sampler2D u_tex;\n\tuniform lowp float u_opacity;\n\n\tvarying mediump vec2 v_uv;\n\n\tvoid main() {\n\t\tlowp vec4 color \x3d texture2D(u_tex, v_uv);\n\n    // Note: output in pre-multiplied alpha for correct alpha compositing\n\t\tgl_FragColor \x3d color *  u_opacity;\n\t}\n",
"url:esri/views/2d/engine/webgl/shaders/stencil.vs.glsl":"attribute vec2 a_pos;\n\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}\n","url:esri/views/2d/engine/webgl/shaders/stencil.fs.glsl":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}\n","url:esri/views/2d/engine/webgl/shaders/background.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n\nvoid main() {\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\n}\n",
"url:esri/views/2d/engine/webgl/shaders/background.fs.glsl":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","url:esri/views/2d/engine/webgl/shaders/tileInfo.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump float u_coord_ratio;\nuniform mediump vec2 u_delta; // in tile coordinates\nuniform mediump vec2 u_dimensions; // in tile coordinates\n\nvarying mediump vec2 v_tex;\n\nvoid main() {\n  mediump vec2 offests \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\n\n  v_tex \x3d a_pos;\n}\n",
"url:esri/views/2d/engine/webgl/shaders/tileInfo.fs.glsl":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\n\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}\n","url:esri/views/2d/engine/webgl/shaders/textShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  Add your GLSL snippets to this file. You should start from\n  importing your old GLSL files. For instance, if you have a\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\n  and then copy and paste the GLSL source as the content. You will then convert your\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\n--\x3e\n\x3csnippets\x3e\n\n  \x3csnippet name\x3d"textVS"\x3e\n    \x3c![CDATA[\n      precision mediump float;\n\n      attribute vec2 a_pos;           // 2 * 2 (2 x signed 16)\n      attribute vec4 a_id;            // 4 (4 x unsigned byte)\n      attribute vec4 a_color;         // 4 (4 x unsigned byte)\n      attribute vec2 a_vertexOffset; // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\n      attribute vec4 a_texFontSize; // 4 (4 x unsigned byte) texture coordinatesm and font size\n\n      attribute lowp float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\n\n      // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n      // relative to the tile\'s upper left corner\n      // the extrusion vector.\n      uniform highp mat4 u_transformMatrix;\n      // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\n      uniform highp mat4 u_extrudeMatrix;\n      // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\n      uniform highp vec2 u_normalized_origin;\n      // the size of the mosaic given in pixels\n      uniform vec2 u_mosaicSize;\n      uniform float u_pixelRatio;\n\n      // the opacity of the layer\n      uniform mediump float u_opacity;\n\n      varying mediump vec4 v_color;\n      varying mediump float v_antialiasingWidth;\n      varying mediump float v_edgeDistanceOffset;\n\n      // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\n      varying mediump vec2 v_tex;\n      // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n      // opacity of the layer given by the painter\n      varying lowp float v_transparency;\n\n      // the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n      // by 16 and then at the shader devide by the same number\n      const float offsetPrecision \x3d 1.0 / 32.0;\n      const float outlineScale \x3d 1.0 / 10.0;\n      const float sdfFontSize \x3d 24.0;\n\n      // maximum SDF distance of 8 pixels represent the distance values that range from -2 inside the geometry to 6 on the outside.\n      // 6 is actually the maximum distance outside the glyph, therefore it is the limitation of the halo which is 1/4 of the geometry size.\n      const float maxSdfDistance \x3d 8.0;\n\n      void main()\n      {\n        // make sure to clip the vertices in case that given record is marked as invisible\n        float z \x3d 2.0 * step(1.0, a_visible);\n\n        // we use the list significant bit of the position in order to store the indication whethe the vertex is of a halow of a glyph\n        mediump float halo \x3d mod(a_pos, 2.0).x;\n\n        float fontScale \x3d a_texFontSize.z / sdfFontSize;\n        // we need to scale the extrude matrix by the font-scale in order to get the right text size\n        mat4 extrudeMatrix \x3d fontScale * u_extrudeMatrix;\n\n        // If the label rotates with the map, and if the rotated label is upside down, hide it\n        gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\n\n        v_transparency \x3d u_opacity;\n        v_tex \x3d a_texFontSize.xy / u_mosaicSize;\n        v_color \x3d a_color;\n        v_antialiasingWidth \x3d 0.105 * sdfFontSize / a_texFontSize.z / u_pixelRatio;\n        // if halo.x is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\n        v_edgeDistanceOffset \x3d halo * outlineScale * a_texFontSize.w / fontScale / maxSdfDistance;\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"textFS"\x3e\n    \x3c![CDATA[\n      precision lowp float;\n\n      uniform lowp sampler2D u_texture;\n\n      varying mediump vec4 v_color;\n      varying mediump float v_antialiasingWidth;\n      varying mediump float v_edgeDistanceOffset;\n      varying mediump vec2 v_tex;\n      varying lowp float v_transparency;\n\n\n      void main()\n      {\n        // read the distance from the SDF texture\n        lowp float dist \x3d texture2D(u_texture, v_tex).a;\n\n        // the edge distance if a factor of the outline width\n        float glyphEdgeDistance \x3d 0.75 - v_edgeDistanceOffset;\n\n        // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n        lowp float alpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\n\n        gl_FragColor \x3d alpha * v_color;\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/2d/engine/webgl/shaders/iconShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  Add your GLSL snippets to this file. You should start from\n  importing your old GLSL files. For instance, if you have a\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\n  and then copy and paste the GLSL source as the content. You will then convert your\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\n--\x3e\n\x3csnippets\x3e\n\n  \x3csnippet name\x3d"rgba2floatFunc"\x3e\n    \x3c![CDATA[\n    float rgba2float(vec4 rgba) {\n      return dot(rgba,  vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0));\n    }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"iconVVUniformsVS"\x3e\n    \x3c![CDATA[\n  #if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n    attribute vec4 a_vv;\n  #endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY || VV_ROTATION\n\n  #ifdef VV_COLOR\n    uniform float u_vvColorValues[8];\n    uniform vec4 u_vvColors[8];\n  #endif // VV_COLOR\n\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n    uniform vec4 u_vvSizeMinMaxValue;\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_SCALE_STOPS\n    uniform float u_vvSizeScaleStopsValue;\n  #endif // VV_SIZE_SCALE_STOPS\n\n  #ifdef VV_SIZE_FIELD_STOPS\n    uniform float u_vvSizeFieldStopsValues[6];\n    uniform float u_vvSizeFieldStopsSizes[6];\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n    uniform float u_vvSizeUnitValueWorldToPixelsRatio;\n  #endif // VV_SIZE_UNIT_VALUE\n\n  #ifdef VV_OPACITY\n    uniform float u_vvOpacityValues[8];\n    uniform float u_vvOpacities[8];\n  #endif // VV_OPACITY\n\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"iconVVFunctions"\x3e\n    \x3c![CDATA[\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n    float getVVMinMaxSize(float sizeValue) {\n      // we need to multiply by 8 in order to translate to tile coordinates\n      float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n      return clamp(u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\n    }\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_FIELD_STOPS\n    const int VV_SIZE_N \x3d 6;\n    float getVVStopsSize(float sizeValue) {\n      if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n        return u_vvSizeFieldStopsSizes[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n        if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n          float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n          return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n        }\n      }\n\n      return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n    }\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n    float getVVUnitValue(float sizeValue) {\n      return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n    }\n  #endif // VV_SIZE_UNIT_VALUE\n\n  #ifdef VV_OPACITY\n    const int VV_OPACITY_N \x3d 8;\n    float getVVOpacity(float opacityValue) {\n      if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n        return u_vvOpacities[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n        if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n          float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n        }\n      }\n\n      return u_vvOpacities[VV_OPACITY_N - 1];\n    }\n  #endif // VV_OPACITY\n\n  #ifdef VV_ROTATION\n    mat4 getVVRotation(float rotationValue) {\n      // YF TODO: if the symbol has rotation we need to combine the symbo\'s rotation with the VV one\n      float angle \x3d C_DEG_TO_RAD * rotationValue;\n\n      float sinA \x3d sin(angle);\n      float cosA \x3d cos(angle);\n\n      return mat4(cosA, sinA, 0, 0,\n                  -sinA,  cosA, 0, 0,\n                  0,     0, 1, 0,\n                  0,     0, 0, 1);\n    }\n  #endif // VV_ROTATION\n\n  #ifdef VV_COLOR\n    const int VV_COLOR_N \x3d 8;\n\n    vec4 getVVColor(float colorValue) {\n      if (colorValue \x3c\x3d u_vvColorValues[0]) {\n        return u_vvColors[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n        if (u_vvColorValues[i] \x3e\x3d colorValue) {\n          float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\n        }\n      }\n\n      return u_vvColors[VV_COLOR_N - 1];\n    }\n  #endif // VV_COLOR\n    ]]\x3e\n  \x3c/snippet\x3e\n\n\n  \x3csnippet name\x3d"iconVS"\x3e\n  \x3c![CDATA[\n    precision mediump float;\n\n    //const float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\n    const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\n    const float C_OFFSET_PRECISION \x3d 1.0 / 64.0;\n\n    // per-vertex attributes (4 bytes)\n    attribute vec4 a_vertexOffsetAndTex;\n\n    // per quad (instance) attributes (20 bytes \x3d\x3d\x3e equivalent of 5 bytes per vertex)\n    attribute vec2 a_pos;\n    attribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\n    attribute vec4 a_color;\n    attribute vec4 a_outlineColor;\n    attribute vec4 a_sizeAndOutlineWidth;\n\n    // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n    // relative to the tile\'s upper left corner\n    // the extrusion vector.\n    uniform highp mat4 u_transformMatrix;\n    // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\n    uniform highp mat4 u_extrudeMatrix;\n    // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\n    uniform highp vec2 u_normalized_origin;\n\n    // the size of the mosaic given in pixels\n    uniform vec2 u_mosaicSize;\n\n    // the opacity of the layer given by the painter\n    uniform mediump float u_opacity;\n\n    // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\n    varying mediump vec2 v_tex;\n    // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n    // opacity of the layer given by the painter\n    varying lowp float v_transparency;\n    // the of the icon given in pixels\n    varying mediump vec2 v_size;\n\n    // icon color. If is a picture-marker it is used to tint the texture color\n    varying lowp vec4 v_color;\n\n #ifdef SDF\n    varying lowp vec4 v_outlineColor;\n    varying mediump float v_outlineWidth;\n #endif // SDF\n\n #ifdef ID\n    varying highp vec4 v_id;\n #endif // ID\n\n #ifdef HEATMAP\n    attribute float a_heatmapWeight;\n    varying mediump float v_heatmapWeight;\n #endif // HEATMAP\n\n    // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n    $iconVVUniformsVS\n    $iconVVFunctions\n\n    void main()\n    {\n      vec2 a_offset \x3d a_vertexOffsetAndTex.xy;\n      vec2 a_tex \x3d a_vertexOffsetAndTex.zw;\n      vec2 a_size \x3d a_sizeAndOutlineWidth.xy;\n\n      // default values (we need them for the variations to come)\n      float a_angle \x3d 0.0;\n      float delta_z \x3d 0.0;\n      float depth \x3d 0.0;\n      v_transparency \x3d 1.0;\n\n  #if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n      // vv size override the original symbol\'s size\n      vec2 size \x3d vec2(getVVMinMaxSize(a_vv.x));\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_SCALE_STOPS\n      vec2 size \x3d vec2(u_vvSizeScaleStopsValue);\n  #endif // VV_SIZE_SCALE_STOPS\n\n  #ifdef VV_SIZE_FIELD_STOPS\n      vec2 size \x3d vec2(getVVStopsSize(a_vv.x));\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n      vec2 size \x3d vec2(getVVUnitValue(a_vv.x));\n  #endif // VV_SIZE_UNIT_VALUE\n\n      vec2 offset \x3d C_OFFSET_PRECISION * a_offset * size;\n      v_size \x3d size;\n  #else\n  #ifdef HEATMAP\n      // reconstruct the kernel size\n      a_size \x3d 9.0 * a_size + 1.0;\n  #endif // HEATMAP\n\n      vec2 offset \x3d C_OFFSET_PRECISION * a_offset * a_size;\n      v_size \x3d a_size;\n  #endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n  #ifdef SDF\n    offset *\x3d 2.0;\n  #endif // SDF\n\n  #ifdef VV_ROTATION\n      gl_Position \x3d vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * getVVRotation(a_vv.w) * vec4(offset, delta_z, 0.0);\n  #else\n      gl_Position \x3d vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offset, delta_z, 0.0);\n  #endif // VV_ROTATION\n\n  #ifdef VV_OPACITY\n      v_transparency \x3d getVVOpacity(a_vv.z);\n  #else\n      v_transparency \x3d u_opacity;\n  #endif // VV_OPACITY\n\n  #ifdef VV_COLOR\n      v_color \x3d getVVColor(a_vv.y);\n  #else\n      v_color \x3d a_color;\n  #endif // VV_COLOR\n\n      // output the texture coordinates and the transparency\n      v_tex \x3d a_tex / u_mosaicSize;\n\n #ifdef SDF\n      v_outlineColor \x3d a_outlineColor;\n      v_outlineWidth \x3d a_sizeAndOutlineWidth.z;\n #endif // SDF\n\n #ifdef ID\n      v_id \x3d a_id;\n #endif // ID\n\n #ifdef HEATMAP\n    v_heatmapWeight \x3d a_heatmapWeight;\n #endif // HEATMAP\n    }\n  ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"iconFS"\x3e\n   \x3c![CDATA[\n    precision mediump float;\n\n    uniform lowp sampler2D u_texture;\n\n    varying lowp vec2 v_tex;\n    varying lowp float v_transparency;\n    varying mediump vec2 v_size;\n    varying lowp vec4 v_color;\n\n #ifdef SDF\n    varying lowp vec4 v_outlineColor;\n    varying mediump float v_outlineWidth;\n\n    // we need the conversion function from RGBA to float\n    $rgba2floatFunc\n #endif // SDF\n\n #ifdef ID\n    varying highp vec4 v_id;\n #endif // ID\n\n #ifdef HEATMAP\n    varying mediump float v_heatmapWeight;\n #endif // HEATMAP\n\n    const float softEdgeRatio \x3d 1.0; // use blur here if needed\n\n    void main()\n    {\n #ifdef SDF\n      lowp vec4 fillPixelColor \x3d v_color;\n\n      // calculate the distance from the edge [-0.5, 0.5]\n      float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n\n      // Work around loss of precision for \'d \x3d 0.0\'.\n      // \'0\' gets normalised to 0.5 * 256 \x3d 128 before float packing, but can only\n      // be stored in the texture as 128 / 255 \x3d 0.502.\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603110\n      const float diff \x3d (128.0/255.0 - 0.5);\n\n      // adjust all values, not just those close to 0, to avoid discontinuities in\n      // the outlines of other shapes e.g. circles\n      d \x3d d - diff;\n\n      // the soft edge ratio is about 1.5 pixels allocated for the soft edge.\n      float size \x3d max(v_size.x, v_size.y);\n      float dist \x3d d * size * softEdgeRatio;\n\n      // set the fragment\'s transparency according to the distance from the edge\n      fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n\n      // count for the outline\n      // therefore tint the entire icon area.\n      if (v_outlineWidth \x3e 0.25) {\n        lowp vec4 outlinePixelColor \x3d v_outlineColor;\n\n        // outlines can\'t be larger than the size of the symbol\n        float clampedOutlineSize \x3d min(v_outlineWidth, size);\n\n        outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n\n        // finally combine the outline and the fill colors (outline draws on top of fill)\n        gl_FragColor \x3d v_transparency * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n      }\n      else {\n        gl_FragColor \x3d v_transparency * fillPixelColor;\n      }\n #else // not an SDF\n      lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n\n #ifdef HEATMAP\n      texColor.r *\x3d v_heatmapWeight;\n #endif // HEATMAP\n\n      gl_FragColor \x3d v_transparency * texColor;\n #endif // SDF\n\n #ifdef HIGHLIGHT\n      gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n #endif // HIGHLIGHT\n\n #ifdef ID\n      if (gl_FragColor.a \x3c 1.0 / 255.0) {\n        discard;\n      }\n      gl_FragColor \x3d v_id;\n #endif // ID\n    }\n   ]]\x3e\n  \x3c/snippet\x3e\n\x3c/snippets\x3e\n\n',
"url:esri/views/2d/engine/webgl/shaders/fillShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  // YF TODO: (doc)\n--\x3e\n\x3csnippets\x3e\n  \x3csnippet name\x3d"fillVVUniformsVS"\x3e\n    \x3c![CDATA[\n  #if defined(VV_COLOR)|| defined(VV_OPACITY)\n    attribute vec4 a_vv;\n  #endif // VV_COLOR || VV_OPACITY\n\n  #ifdef VV_COLOR\n    uniform float u_vvColorValues[8];\n    uniform vec4 u_vvColors[8];\n  #endif // VV_COLOR\n\n  #ifdef VV_OPACITY\n    uniform float u_vvOpacityValues[8];\n    uniform float u_vvOpacities[8];\n  #endif // VV_OPACITY\n\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"fillVVFunctions"\x3e\n    \x3c![CDATA[\n  #ifdef VV_OPACITY\n    const int VV_OPACITY_N \x3d 8;\n\n    float getVVOpacity(float opacityValue) {\n      if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n        return u_vvOpacities[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n        if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n          float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n        }\n      }\n\n      return u_vvOpacities[VV_OPACITY_N - 1];\n    }\n  #endif // VV_OPACITY\n\n  #ifdef VV_COLOR\n    const int VV_COLOR_N \x3d 8;\n\n    vec4 getVVColor(float colorValue) {\n      if (colorValue \x3c\x3d u_vvColorValues[0]) {\n        return u_vvColors[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n        if (u_vvColorValues[i] \x3e\x3d colorValue) {\n          float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\n        }\n      }\n\n      return u_vvColors[VV_COLOR_N - 1];\n    }\n  #endif // VV_COLOR\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"fillVS"\x3e\n    \x3c![CDATA[\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\n      attribute vec4 a_color;\n      attribute vec4 a_tlbr;\n      attribute vec4 a_aux;\n\n      uniform highp mat4 u_transformMatrix;\n      uniform highp vec2 u_normalized_origin;\n\n      varying lowp vec4 v_color;\n      varying lowp float v_opacity;\n\n      // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n      $fillVVUniformsVS\n      $fillVVFunctions\n\n  #ifdef PATTERN\n    uniform mediump float u_zoomFactor;\n    uniform mediump vec2 u_mosaicSize;\n\n    varying mediump vec4 v_tlbr;\n    varying mediump vec2 v_tileTextureCoord;\n  #endif // PATTERN\n\n  #ifdef ID\n    varying highp vec4 v_id;\n  #endif // ID\n\n      void main()\n      {\n  #ifdef VV_OPACITY\n        v_opacity \x3d getVVOpacity(a_vv.y);\n  #else\n        v_opacity \x3d 1.0;\n  #endif\n\n    #ifdef VV_COLOR\n       v_color \x3d getVVColor(a_vv.x);\n  #else\n       v_color \x3d a_color;\n  #endif // VV_COLOR\n\n  #ifdef ID\n      v_id \x3d a_id;\n  #endif // ID\n\n  #ifdef PATTERN\n       // calculate the pattern matrix\n       mat3 patternMatrix \x3d mat3(1.0, 0.0, 0.0,\n                                 0.0, 1.0, 0.0,\n                                 0.0, 0.0, 1.0);\n       patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux.x);\n       patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux.y);\n\n       // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n       // The pattern matrix is a 3x3 scale matrix which \'tiles\' the texture inside the tile, translating from\n       // tile coordinates to texture coordinates.\n       v_tileTextureCoord \x3d (patternMatrix * vec3(a_pos, 1.0)).xy;\n       v_tlbr \x3d vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\n  #endif // PATTERN\n\n        gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"fillFS"\x3e\n    \x3c![CDATA[\n      precision lowp float;\n      uniform lowp float u_opacity;\n\n  #ifdef PATTERN\n      uniform lowp sampler2D u_texture;\n\n      varying mediump vec4 v_tlbr;\n      varying mediump vec2 v_tileTextureCoord;\n  #endif // PATTERN\n\n  #ifdef ID\n    varying highp vec4 v_id;\n  #endif // ID\n\n      varying lowp vec4 v_color;\n      varying lowp float v_opacity;\n\n      void main()\n      {\n  #ifdef PATTERN\n         // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n         mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n         // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n         // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n         // we need to only sample from area that has our sprite in the mosaic.\n         mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n         // sample the sprite mosaic\n         lowp vec4 color \x3d texture2D(u_texture, samplePos);\n         gl_FragColor \x3d u_opacity * v_opacity * v_color * color;\n  #else\n        gl_FragColor \x3d u_opacity * v_opacity * v_color;\n  #endif // PATTERN\n\n  #ifdef HIGHLIGHT\n        gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n  #endif // HIGHLIGHT\n\n  #ifdef ID\n      if (gl_FragColor.a \x3c 1.0 / 255.0) {\n        discard;\n      }\n      gl_FragColor \x3d v_id;\n  #endif // ID\n      }\n    ]]\x3e\n  \x3c/snippet\x3e\n\x3c/snippets\x3e\n',
"url:esri/views/2d/engine/webgl/shaders/lineShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  // YF TODO: (doc)\n--\x3e\n\x3csnippets\x3e\n  \x3csnippet name\x3d"lineVVUniformsVS"\x3e\n    \x3c![CDATA[\n  #if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY)\n    attribute vec3 a_vv;\n  #endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY\n\n  #ifdef VV_COLOR\n    uniform float u_vvColorValues[8];\n    uniform vec4 u_vvColors[8];\n  #endif // VV_COLOR\n\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n    uniform vec4 u_vvSizeMinMaxValue;\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_SCALE_STOPS\n    uniform float u_vvSizeScaleStopsValue;\n  #endif\n\n  #ifdef VV_SIZE_FIELD_STOPS\n    uniform float u_vvSizeFieldStopsValues[6];\n    uniform float u_vvSizeFieldStopsSizes[6];\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n    uniform float u_vvSizeUnitValueWorldToPixelsRatio;\n  #endif // VV_SIZE_UNIT_VALUE\n\n  #ifdef VV_OPACITY\n    uniform float u_vvOpacityValues[8];\n    uniform float u_vvOpacities[8];\n  #endif // VV_OPACITY\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"lineVVFunctions"\x3e\n    \x3c![CDATA[\n  #ifdef VV_SIZE_MIN_MAX_VALUE\n    float getVVMinMaxSize(float sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n      return clamp(mix(u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w, f), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\n    }\n  #endif // VV_SIZE_MIN_MAX_VALUE\n\n  #ifdef VV_SIZE_FIELD_STOPS\n    const int VV_SIZE_N \x3d 6;\n    float getVVStopsSize(float sizeValue) {\n      if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n        return u_vvSizeFieldStopsSizes[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n        if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n          float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n          return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n        }\n      }\n\n      return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n    }\n  #endif // VV_SIZE_FIELD_STOPS\n\n  #ifdef VV_SIZE_UNIT_VALUE\n    float getVVUnitValue(float sizeValue) {\n      return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n    }\n  #endif // VV_SIZE_UNIT_VALUE\n\n  #ifdef VV_OPACITY\n    const int VV_OPACITY_N \x3d 8;\n    float getVVOpacity(float opacityValue) {\n      if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n        return u_vvOpacities[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n        if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n          float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n        }\n      }\n\n      return u_vvOpacities[VV_OPACITY_N - 1];\n    }\n  #endif // VV_OPACITY\n\n  #ifdef VV_COLOR\n    const int VV_COLOR_N \x3d 8;\n\n    vec4 getVVColor(float colorValue) {\n      if (colorValue \x3c\x3d u_vvColorValues[0]) {\n        return u_vvColors[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n        if (u_vvColorValues[i] \x3e\x3d colorValue) {\n          float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\n        }\n      }\n\n      return u_vvColors[VV_COLOR_N - 1];\n    }\n  #endif // VV_COLOR\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"lineVS"\x3e\n    \x3c![CDATA[\n     precision mediump float;\n\n     attribute vec2 a_pos;\n     attribute vec4 a_id;\n     attribute vec4 a_color;\n     attribute vec4 a_offsetAndNormal;\n     attribute vec2 a_accumulatedDistanceAndHalfWidth;\n     attribute vec4 a_tlbr;\n     attribute vec4 a_segmentDirection;\n\n     // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n     // relative to the tile\'s upper left corner\n     // the extrusion vector.\n     uniform highp mat4 u_transformMatrix;\n     // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\n     uniform highp mat4 u_extrudeMatrix;\n     // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\n     uniform highp vec2 u_normalized_origin;\n     uniform lowp float u_opacity; // the layer\'s opacity\n     uniform mediump float u_tileCoordRatio;\n     uniform mediump float u_antialiasing;\n\n     // the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\n     varying mediump vec2 v_normal;\n     // the accumulated distance along the line. We need this information in order to render the dashes.\n     varying highp float v_accumulatedDistance;\n     varying mediump float v_lineHalfWidth;\n     varying lowp vec4 v_color;\n     varying lowp float v_transparency;\n\n#ifdef SDF\n     const float scale \x3d 1.0 / 15.5;\n#else\n     const float scale \x3d 1.0 / 31.0;\n#endif\n\n\n#ifdef PATTERN\n     uniform mediump vec2 u_mosaicSize;\n\n     varying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\n     varying mediump vec2 v_patternSize;\n#endif // PATTERN\n\n#ifdef ID\n     varying highp vec4 v_id;\n#endif // ID\n\n     // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\n     $lineVVUniformsVS\n     $lineVVFunctions\n\n     void main()\n     {\n     // size VV block\n#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef VV_SIZE_MIN_MAX_VALUE\n       mediump float lineHalfWidth \x3d 0.5 * getVVMinMaxSize(a_vv.x);\n#endif // VV_SIZE_MIN_MAX_VALUE\n\n#ifdef VV_SIZE_SCALE_STOPS\n       mediump float lineHalfWidth \x3d 0.5 * u_vvSizeScaleStopsValue;\n#endif // VV_SIZE_SCALE_STOPS\n\n#ifdef VV_SIZE_FIELD_STOPS\n        mediump float lineHalfWidth \x3d 0.5 * getVVStopsSize(a_vv.x);\n#endif // VV_SIZE_FIELD_STOPS\n\n#ifdef VV_SIZE_UNIT_VALUE\n  mediump float lineHalfWidth \x3d 0.5 * getVVUnitValue(a_vv.x);\n#endif // VV_SIZE_UNIT_VALUE\n\n#else // no VV\n       mediump float lineHalfWidth \x3d a_accumulatedDistanceAndHalfWidth.y * scale;\n#endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n\n#ifdef HIGHLIGHT\n       // TODO: Decide what to do here. Do we want the\n       // highlight of line features to be slighly larger\n       // than the feature itself, when the line is too\n       // thin?\n       // lineHalfWidth \x3d max(lineHalfWidth, 3.0);\n#endif\n\n#ifdef VV_OPACITY\n      v_transparency \x3d u_opacity * getVVOpacity(a_vv.z);\n#else\n    v_transparency \x3d u_opacity;\n#endif // VV_OPACITY\n\n #ifdef VV_COLOR\n    v_color \x3d getVVColor(a_vv.y);\n#else\n    v_color \x3d a_color;\n#endif // VV_COLOR\n\n       // make sure to clip the vertices in case that the width of the line is 0 (or negative)\n       float z \x3d 2.0 * step(lineHalfWidth, 0.0);\n\n       // add the antialiasing factor to the line width. Limit the line width to 0.5 pixels (otherwise it does not look good)\n       lineHalfWidth \x3d max(lineHalfWidth, 0.5) + u_antialiasing;\n\n       v_lineHalfWidth \x3d lineHalfWidth;\n\n       // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n       // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n       mediump vec2 dist \x3d lineHalfWidth * a_offsetAndNormal.xy * scale;\n\n       // transform the vertex\n       gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, z, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n\n       // the accumulated distance will be used to calculate the dashes (or the no-data...)\n       v_accumulatedDistance \x3d a_accumulatedDistanceAndHalfWidth.x + dot(scale * a_segmentDirection.xy, dist / u_tileCoordRatio);\n       v_normal \x3d a_offsetAndNormal.zw * scale;\n\n#ifdef PATTERN\n      v_tlbr \x3d vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\n      v_patternSize \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif // PATTERN\n\n#ifdef ID\n      v_id \x3d a_id;\n#endif // ID\n     }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"lineFS"\x3e\n    \x3c![CDATA[\n       precision lowp float;\n\n       uniform lowp float u_blur;\n       uniform mediump float u_antialiasing;\n\n       varying mediump vec2 v_normal;\n       varying highp float v_accumulatedDistance;\n       varying mediump float v_lineHalfWidth;\n       varying lowp vec4 v_color;\n       varying lowp float v_transparency;\n\n#if defined(PATTERN) || defined(SDF)\n      uniform sampler2D u_texture;\n\n      varying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\n      varying mediump vec2 v_patternSize;\n      uniform mediump float u_zoomFactor;\n      uniform mediump float u_tileCoordRatio;\n#endif // PATTERN\n\n#ifdef SDF\n      const float sdfPatternHalfWidth \x3d 15.5; // YF: assumed that the width will be set to 32\n\n      float rgba2float(vec4 rgba) {\n        return dot(rgba,  vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0));\n      }\n#endif // SDF\n\n#ifdef ID\n     varying highp vec4 v_id;\n#endif // ID\n\n       void main()\n       {\n          // add an antialiasing factor as long as we are under two pixels\n          mediump float antialiasingFactor \x3d u_antialiasing * step(v_lineHalfWidth, 2.0);\n\n         // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n         // and any value in between will be inside the line (the sign represent the direction - right or left).\n         // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n         mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n\n         // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n         lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist - 0.5 * antialiasingFactor) / (u_blur + 2.0 * antialiasingFactor), 0.0, 1.0);\n\n#if defined(SDF)\n         mediump float lineWidthRatio \x3d v_lineHalfWidth / sdfPatternHalfWidth;\n         mediump float relativeTexX \x3d mod((u_zoomFactor * u_tileCoordRatio * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n         mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n\n          // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n         mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n\n         // calculate the distance from the edge [-0.5, 0.5]\n         mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n\n         // the distance is a proportional to the line width\n         float dist \x3d d * v_lineHalfWidth;\n\n         lowp vec4 fillPixelColor \x3d v_transparency * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n        gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN)\n         // we need to calculate the relative portion of the line texture along the line given the accumulated distance along the line\n         // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\n         mediump float relativeTexX \x3d mod((u_zoomFactor * u_tileCoordRatio * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n\n         // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\n         // which range from -1.0 to 1.0. On the line\'s centerline, the value of the interpolated normal is 0.0, however the relative\n         // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\n         // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\n         //              | -\x3e line-width / 2\n         //      - - - - - - - - - - - - - -\n         //              | -\x3e line-width / 2\n         //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\n\n         mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n\n         // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n         mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n\n         // get the color from the texture\n         lowp vec4 color \x3d texture2D(u_texture, texCoord);\n\n         gl_FragColor \x3d v_transparency * alpha * v_color * color;\n#else // solid line (no texture, no pattern)\n         // output the fragment color\n         gl_FragColor \x3d v_transparency * alpha * v_color;\n#endif // SDF\n\n#ifdef HIGHLIGHT\n         gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif // HIGHLIGHT\n\n #ifdef ID\n         if (gl_FragColor.a \x3c 1.0 / 255.0) {\n           discard;\n         }\n         gl_FragColor \x3d v_id;\n #endif // ID\n       }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/2d/engine/webgl/shaders/hlShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  Highlight generation and rendering shaders.\n\n  These shader sources are loaded by hlShaderSnippets.ts which in turn\n  is used by HighlightRenderer to instantiate the programs needed for\n  generating and rendering the highlights.\n\n  These shaders are intended to be used with full screen quads.\n--\x3e\n\x3csnippets\x3e\n  \x3c!--\n    Vertex shader: texturedVS\n\n    Identity vertex shader that outputs an untransformed 2-D vertex\n    and passes its texture coordinates unchanged to the interpolator.\n  --\x3e\n  \x3csnippet name\x3d"texturedVS"\x3e\n    \x3c![CDATA[\n    // Vertex position.\n    attribute mediump vec2 a_position;\n\n    // Texture coordinates.\n    attribute mediump vec2 a_texcoord;\n\n    // Texture coordinates to be interpolated.\n    varying mediump vec2 v_texcoord;\n\n    void main(void) {\n      // Pass the position unchanged.\n      gl_Position \x3d vec4(a_position, 0.0, 1.0);\n\n      // Pass the texture coordinates unchanged.\n      v_texcoord \x3d a_texcoord;\n    }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3c!--\n    Fragment shader: blurFS\n\n    A gaussian blur shader. It blurs the alpha channel of its input\n    according to 4 different sigma and stores the results into the\n    four channel of the target framebuffer.\n\n    It is intended to be called twice; the first time to perform an\n    horizontal blur, and a second time to perform a vertical blur.\n\n    This shader is used to turn the highlight mask into a highlight\n    map. The highlight map is an approximation of the signed distance\n    field of the mask.\n  --\x3e\n  \x3csnippet name\x3d"blurFS"\x3e\n    \x3c![CDATA[\n    // Interpolated texture coordinates.\n    varying mediump vec2 v_texcoord;\n\n    // Blur direction information. There are two possible\n    // configurations that the host code can use.\n    //  - [1, 0, 1/WIDTH, 0] Used when blurring horizontally. In this\n    //    case u_direction[0] \x3d 1 is expressed in pixel and is fed to\n    //    the gauss function to produce the value of the gaussian weight\n    //    for that pixel, while u_direction[2] \x3d 1/WIDTH is in texel units\n    //    and is used to sample the right texel from the texture map.\n    //  - [0, 1, 0, 1/HEIGHT] Used when blurring vertically. In this\n    //    case u_direction[1] \x3d 1 is expressed in pixel and is fed to\n    //    the gauss function to produce the value of the gaussian weight\n    //    for that pixel, while u_direction[3] \x3d 1/HEIGHT is in texel units\n    //    and is used to sample the right texel from the texture map.\n    uniform mediump vec4 u_direction;\n\n    // Source to destination channel selection matrix.\n    uniform mediump mat4 u_channelSelector;\n\n    // The highlight map is obtained by blurring the alpha channel of the highlight\n    // mask accroding to these 4 values of the gaussian\'s sigma parameter.\n    uniform mediump vec4 u_sigmas;\n\n    // This is the highlight mask if we have not blurred horizontally yet, otherwise\n    // it is the horizontally blurred highlight map and blurring it one more time\n    // vertically will complete the process.\n    uniform sampler2D u_texture;\n\n    // The gaussian kernel. Note that it lacks the normalization constant, because\n    // we want to store it unnormalized in the highlight map (i.e. having a peak\n    // value of 1). Note also that we are using the SIMD (single instruction, multiple\n    // data) capabilities of the GPU to compute four different gaussian kernels, one\n    // for each sigma.\n    mediump vec4 gauss(mediump vec2 dir) {\n      return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n    }\n\n    mediump vec4 selectChannel(mediump vec4 sample) {\n      return u_channelSelector * sample;\n    }\n\n    // Sample the input texture and accumulated its gaussian weighted value and the\n    // total weight.\n    void accumGauss(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n      // Computes the gaussian weights, one for each sigma.\n      // Note that u_direction.xy is [1, 0] when blurring horizontally and [0, 1] when blurring vertically.\n      mediump vec4 w \x3d gauss(i * u_direction.xy);\n\n      // Accumumates the values.\n      // Note that u_direction.xy is [1/WIDTH, 0] when blurring horizontally and [0, 1/HEIGHT] when blurring vertically.\n      tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n\n      // Accumulates the weights.\n      weight +\x3d w;\n    }\n\n    void main(void) {\n      // Initialize accumulated values and weights to zero.\n      mediump vec4 tot \x3d vec4(0.0, 0.0, 0.0, 0.0);\n      mediump vec4 weight \x3d vec4(0.0, 0.0, 0.0, 0.0);\n\n      // Accumulates enough samples. These will be taken\n      // horizontally or vertically depending on the value\n      // of u_direction.\n      accumGauss(-5.0, tot, weight);\n      accumGauss(-4.0, tot, weight);\n      accumGauss(-3.0, tot, weight);\n      accumGauss(-2.0, tot, weight);\n      accumGauss(-1.0, tot, weight);\n      accumGauss(0.0, tot, weight);\n      accumGauss(1.0, tot, weight);\n      accumGauss(2.0, tot, weight);\n      accumGauss(3.0, tot, weight);\n      accumGauss(4.0, tot, weight);\n      accumGauss(5.0, tot, weight);\n\n      // Compute blurred values.\n      mediump vec4 rgba \x3d tot / weight;\n\n      // Return the values. Note that each channel will contain\n      // the result of a different blur operation, one for each\n      // of the four chosen sigma.\n      gl_FragColor \x3d vec4(rgba);\n    }\n    ]]\x3e\n  \x3c/snippet\x3e\n\n  \x3c!--\n    Fragment shader: highlightFS\n\n    Takes as input the highlight map, estimated the signed distance field,\n    and shades the fragments according to their estimated distance from the\n    edge of the highlighted feature.\n\n    A shade texture is used to turn distance values into colors; the shade\n    texture is basically a color gradient and is recomputed on the host\n    every time that the user alters the highlight options.\n  --\x3e\n  \x3csnippet name\x3d"highlightFS"\x3e\n    \x3c![CDATA[\n    // Interpolated texture coordinates.\n    varying mediump vec2 v_texcoord;\n\n    // The highlight map. Each channel is a blurred\n    // version of the alpha channel of the highlight mask.\n    //  - Channel 0 (red) corresponds to a gaussian blur with sigma \x3d u_sigmas[0];\n    //  - Channel 1 (green) corresponds to a gaussian blur with sigma \x3d u_sigmas[1];\n    //  - Channel 2 (blue) corresponds to a gaussian blur with sigma \x3d u_sigmas[2];\n    //  - Channel 3 (alpha) corresponds to a gaussian blur with sigma \x3d u_sigmas[3];\n    // As of today, only channel 3 is used for distance estimation.\n    // But the availability of different amounts of blur leaves the\n    // door open to multi-scale approaches.\n    uniform sampler2D u_texture;\n\n    // The highlight map was obtained by blurring the alpha channel of the highlight\n    // mask accroding to these 4 values of the gaussian\'s sigma parameter.\n    uniform mediump vec4 u_sigmas;\n\n    // A 1-D texture used to shade the highlight.\n    uniform sampler2D u_shade;\n\n    // The 1-D shade texture is spreaded between u_minMaxDistance[0] and u_minMaxDistance[1].\n    uniform mediump vec2 u_minMaxDistance;\n\n    // Signed distance estimation.\n    mediump float distance() {\n      // Use the largest sigma and the corresponding distance value stored in the\n      // last channel of the highlight map.\n      mediump float sigma \x3d u_sigmas[3];\n      mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n\n      // Estimates the distance by linearization and local inversion around\n      // the inflection point. The inflection point is in x \x3d 0.\n      const mediump float y0 \x3d 0.5;                           // Value of the convolution at the inflection point.\n      mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);  // Slope of the convolution at the inflection point.\n      mediump float d \x3d (y - y0) / m0;                        // Inversion of a local linearization.\n\n      // Return the estimated distance.\n      return d;\n    }\n\n    // Shading based on estimated distance.\n    mediump vec4 shade(mediump float d) {\n      // Maps the sampled distance from the [A, D] range (see HighlightRenderer::setHighlightOptions) to [0, 1].\n      mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n\n      // Force to [0, 1]; it should not be necessary because the shade texture uses the CLAMP address mode, so\n      // this should happen anyway internally to the sampler, but in practice it is needed to avoid weird\n      // banding artifacts.\n      // We don\'t really know if we need this or not.\n      mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n\n      // Sample the 1-D shade texture on its center line (i.e. on t\x3d0.5).\n      return texture2D(u_shade, vec2(mappedDistance, 0.5));\n    }\n\n    void main(void) {\n      // Estimate the distance.\n      mediump float d \x3d distance();\n\n      // Shade the distance.\n      gl_FragColor \x3d shade(d);\n    }\n    ]]\x3e\n  \x3c/snippet\x3e\n\x3c/snippets\x3e\n',
"url:esri/views/2d/engine/webgl/shaders/heatmap.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_tex;\n\nuniform mediump vec2 u_minmax;\n\nvarying mediump vec2 v_uv;\nvarying mediump float v_slope;\n\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n  v_slope \x3d 1.0 / (u_minmax.y - u_minmax.x);\n}\n","url:esri/views/2d/engine/webgl/shaders/heatmap.fs.glsl":"\tprecision mediump float;\n\n\tuniform lowp sampler2D u_texture;\n\tuniform lowp float u_opacity;\n\tuniform mediump vec2 u_minmax;\n\tuniform lowp sampler2D u_gradient;\n\n\tvarying mediump vec2 v_uv;\n  varying mediump float v_slope;\n\n\tvec4 getColor(float intensity) {\n\t  float normalizedIntensity \x3d clamp((intensity - u_minmax.x) * v_slope, 0.0, 1.0);\n\n\t\treturn texture2D(u_gradient, vec2(0.5, normalizedIntensity));\n  }\n\n\tvoid main() {\n\t// sample the intnsity value\n\t\tlowp vec4 color \x3d texture2D(u_texture, v_uv);\n\n    // interpolate the color from the ramp using the intensity value\n\t\tgl_FragColor \x3d getColor(color.r) *  u_opacity;\n\t}\n",
"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\n\t\t\x3c/span\x3e\n\t\x3c/div\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\n\t${!actionBarTemplate}\n\x3c/div\x3e\n\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\n\t\t\t\tid\x3d"${id}_label"\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\n\t\t\t\x3e\x3c/span\n\t\t\x3e\x3c/span\n\t\x3e\x3c/span\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\n\t\ttabIndex\x3d"-1" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\n/\x3e\x3c/span\x3e\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}" role\x3d"presentation"\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:esri/views/3d/environment/materials/SimpleAtmosphereMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vsSimpleAtmosphere"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  uniform mat4 proj;\n  uniform mat4 view;\n\n#ifndef PANORAMIC\n\n  const float TWICEPI \x3d 2.0*3.14159265;\n  const float ATMOSPHERE_RIM_SEGMENTS \x3d 128.0;\n\n  uniform vec3 silCircleCenter;\n  uniform vec3 silCircleV1;\n  uniform vec3 silCircleV2;\n  uniform vec2 texV;\n\n#endif\n\n  uniform vec3 lightDirection;\n\n  attribute vec3 $position;\n  varying vec2 vtc;\n  varying float falloff;\n\n  void main(void) {\n\n#ifdef PANORAMIC\n\n    vec3 pos \x3d $position;\n    float ndotl \x3d lightDirection.z;\n    vtc \x3d vec2(0, $position.z+0.05);\n\n#else\n\n    float phi \x3d $position.x * (TWICEPI / ATMOSPHERE_RIM_SEGMENTS) + 1.0;\n    vec3 pos \x3d (sin(phi) * silCircleV1 + cos(phi) * silCircleV2 + silCircleCenter) * $position.y;\n    float ndotl \x3d dot(normalize(pos), lightDirection);\n\n    vtc.x \x3d $position.x / ATMOSPHERE_RIM_SEGMENTS;\n    vtc.y \x3d texV.x * (1.0 - $position.z) + texV.y * $position.z;\n\n#endif\n\n    falloff \x3d max(0.0, (smoothstep(-1.0, 0.8, ndotl + ndotl)));\n\n    gl_Position \x3d proj * view * vec4(pos, 1.0);\n    gl_Position.z \x3d gl_Position.w; // project atmosphere onto the far plane\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsSimpleAtmosphere"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n  uniform sampler2D tex;\n  uniform vec4 color;\n  varying vec2 vtc;\n  varying float falloff;\n\n  void main() {\n    vec4 texColor \x3d texture2D(tex, vtc);\n    gl_FragColor \x3d texColor * color * falloff;\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/environment/materials/RealisticAtmosphereMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3c!--Vertex Shader for Atmosphere--\x3e\n\x3csnippet name\x3d"vsRealisticAtmosphere"\x3e\x3c![CDATA[\n//\n// Based on Atmospheric scattering vertex shader by Sean O\'Neil from GPU Gems 2 Chapter 16.\n//\n// Link:                   http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\n// Download Portal:        http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Index.html\n// Unmodified Source Code: http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Content/16.zip\n//\n// Adapted for WebGIS by Jascha Gr\u00fcbel (jgruebel@esri.com), Z\u00fcrich 2015\n//\n\n  $vsprecisionf\n\n  //Camera\n  uniform vec2 halfSizeNearPlane;\n  uniform vec3 v3CameraUp;\n  uniform vec3 v3CameraRight;\n  uniform vec3 v3CameraDir;\n  uniform vec2 v2CameraCenterOffset;\n\n  //Attributes\n  attribute vec3 $position;\n  attribute vec2 $uv0;\n\n  //Varyings\n  varying vec3 v3WorldRay;\n  varying vec2 vtc;\n\n#ifdef HAZE\n  varying vec3 v3EyeDir;\n#endif\n\n  void main(void) {\n    vec3 v3Pos \x3d $position;\n    vtc \x3d $uv0;\n    vec2 rayvtc \x3d $uv0 - v2CameraCenterOffset;\n\n#ifdef HAZE\n    v3EyeDir \x3d vec3((2.0*halfSizeNearPlane *rayvtc)-halfSizeNearPlane,-1.0);\n#else\n    vec3 v3EyeDir \x3d vec3((2.0*halfSizeNearPlane *rayvtc)-halfSizeNearPlane,-1.0);\n#endif\n    v3WorldRay \x3d v3EyeDir.z*v3CameraDir + v3EyeDir.y*v3CameraUp + v3EyeDir.x*v3CameraRight;\n    gl_Position \x3d vec4(v3Pos, 1.0);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"atmosphereScaleFunction"\x3e\x3c![CDATA[\n  //Approximation for inner integral based on a radii ratio of 10.25:10\n  float scale(float fCos){\n    float x \x3d 1.0 - fCos;\n    return exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"toneMapperConstants"\x3e\x3c![CDATA[\n#ifdef HAZE\n  const float fOneOverGamma \x3d 1.0;//Gamma \x3d 1.0\n#else\n  const float fOneOverGamma \x3d 0.454545; // Gamma \x3d 2.2\n#endif\n  const vec3 v3OneOverGamma \x3d vec3(fOneOverGamma);\n\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"exponentialToneMapper"\x3e\x3c![CDATA[\n  //ToneMapping operators\n  vec3 expTM(vec3 inputColor,float exposure){\n      return pow(1.0 - exp(inputColor * -exposure), v3OneOverGamma);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"reinhardToneMapper"\x3e\x3c![CDATA[\n  vec3 reinhardTM(vec3 inputColor, float exposure){\n      vec3 intermediate \x3d inputColor *exposure;\n      intermediate /\x3d (1.0+intermediate);\n      return pow(intermediate, v3OneOverGamma);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\n\x3csnippet name\x3d"HSVColorSpace"\x3e\x3c![CDATA[\n//based on http://gamedev.stackexchange.com/a/59808\n// Hue in range [0,1] instead of 360\u00b0\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p \x3d mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q \x3d mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d \x3d q.x - min(q.w, q.y);\n    float e \x3d 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"atmosphereUniformsConstantsVaryings"\x3e\x3c![CDATA[\n\n  //Light\n  uniform vec3 v3LightDir;      // The direction vector to the light source\n  uniform vec3 v3InvWavelength; // 1 / pow(wavelength, 4) for the red, green, and blue channels\n  uniform vec3 v3InvWavelengthScaled; //v3InvWavelength * fKr4PI + fKm4PI\n\n  //Radii\n  uniform vec4 v4Radii; // inner, inner^2, outer, outer^2,\n\n  //Atmosphere\n  const float fKrESun \x3d 0.075;        // Kr * ESun \x3d 0.005 * 15.0\n  const float fKmESun \x3d 0.015;        // Km * ESun \x3d 0.005 * 15\n  //uniform float fScale;         // 1 / (fOuterRadius - fInnerRadius)\n  //uniform float fScaleDepth;    // The scale depth (i.e. the altitude at which the atmosphere\'s average density is found)\n  //uniform float fScaleOverScaleDepth; // fScale / fScaleDepth\n  //uniform float fOneOverScaleDepth; // 1.0 / fScaleDepth\n\n  //uniform float fScaleDepthBlue;    // The scale depth (i.e. the altitude at which the atmosphere\'s average density is found)\n  //uniform float fScaleOverScaleDepthBlue; // fScale / fScaleDepth\n  //uniform float fOneOverScaleDepthBlue; // 1.0 / fScaleDepth\n\n  uniform vec4 v4AtmosParams1; //(fScale,fScaleDepth,fScaleOverScaleDepth,fOneOverScaleDepth)\n  uniform vec4 v4AtmosParams2; //(g,fScaleDepthBlue,fScaleOverScaleDepthBlue,fOneOverScaleDepthBlue)\n#ifndef HAZE\n  uniform vec4 v4AtmosParams3; //(g2,fMiePhaseCoefficients,fLowerAlphaBlendBound,fOneOverOuterRadiusMinusAlphaBlendBound)\n#endif\n\n  //Camera\n  uniform vec3 v3CameraPos;     // The camera\'s current position\n  //uniform float fCameraHeight;  // The camera\'s current height\n  //uniform float fCameraHeight2; // fCameraHeight^2\n  //uniform float fC; //fCameraHeight2 - fOuterRadius2; // C \x3d ||o-c||^2 - r^2\n  //uniform float fCSur; //fCameraHeight2 - (fInnerRadius2 - 63756370000.0); // C \x3d ||o-c||^2 - r^2\n  uniform vec4 v4SphereComp; //The camera\'s current height, CameraHeight^2,fC,fCSur\n  uniform vec2 nearFar;\n\n  //Camera HDR\n#ifdef HAZE\n  const float fExposure \x3d 1.5;\n#else\n  const float fExposure \x3d 2.0;\n#endif\n\n#ifdef HAZE\n  //Depth texture\n  uniform sampler2D tDepth;\n#endif\n\n  //Testing variables\n  uniform float showTest;\n\n  //Varyings\n  varying vec3 v3EyeDir;\n  varying vec3 v3WorldRay;\n  varying vec2 vtc;\n\n  //Loop constants for integral approximation\n  const float fSamples \x3d 5.0;\n  const int maxSamples \x3d 5;\n]]\x3e\x3c/snippet\x3e\n\n\n\x3csnippet name\x3d"atmospherePrecomputation"\x3e\x3c![CDATA[\n    float fInnerRadius \x3d v4Radii[0];   // The inner (planetary) radius\n    float fInnerRadius2 \x3d v4Radii[1];  // fInnerRadius^2\n    float fOuterRadius \x3d v4Radii[2];   // The outer (atmosphere) radius\n    float fOuterRadius2 \x3d v4Radii[3];  // fOuterRadius^2\n\n    float fCameraHeight \x3d v4SphereComp[0];\n    float fCameraHeight2 \x3d v4SphereComp[1];\n    float fC \x3d v4SphereComp[2];\n    float fCSur \x3d v4SphereComp[3];\n\n#ifdef PLANAR\n    vec3 cameraPosition \x3d vec3(0.0,0.0,fCameraHeight);\n#else\n    vec3 cameraPosition \x3d v3CameraPos;\n#endif\n\n    //Debug variables\n    vec3 test \x3d vec3(0.0,0.0,0.0);\n\n    //Obtain ray from Camera\n    vec3 worldSpaceRay \x3d normalize(v3WorldRay);\n\n    //Compute Atmosphere intersection; i.e. ray/sphere intersection\n    float B \x3d 2.0 * dot(cameraPosition, worldSpaceRay); // B \x3d 2(l * (o-c))\n    float det \x3d B*B - 4.0 * fC; // det \x3d B^2 - 4.0* C\n\n    //idealized sphere intersection to discard early some pixels\n    float detSur \x3d B*B - 4.0 * fCSur; // det \x3d B^2 - 4.0* C\n\n]]\x3e\x3c/snippet\x3e\n\n\n\x3csnippet name\x3d"atmosphereDiscardPixels"\x3e\x3c![CDATA[\n      bool continueComputation \x3d true;\n#ifdef HAZE\n      // only use red channel from depth texture.\n      // see \'Issues\' at https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture\n      float depthSample \x3d texture2D(tDepth, vtc).r;\n\n      float zNear \x3d nearFar[0];\n      float zFar \x3d nearFar[1];\n\n      // http://web.archive.org/web/20130416194336/http://olivers.posterous.com/linear-depth-in-glsl-for-real\n      float zNorm \x3d 2.0 * depthSample - 1.0;\n      float linDepth \x3d 2.0 * zNear * zFar /\n        (zFar + zNear - zNorm * (zFar - zNear));\n\n      float nearSurfaceT;\n      if (detSur\x3e0.0){\n        nearSurfaceT \x3d 0.5 *(-B - sqrt(detSur));\n      }\n\n      float rayEndT;\n\n      // find intersections with ground, but only between the near and far\n      // clipping planes.\n      if (depthSample \x3c 1.0 \x26\x26 depthSample \x3e 0.0) {\n        vec3 cameraSpaceRay \x3d normalize(v3EyeDir);\n        cameraSpaceRay /\x3d cameraSpaceRay.z;\n        cameraSpaceRay *\x3d linDepth;\n#ifndef PLANAR\n        if((fCameraHeight-fInnerRadius)\x3e8000000.0 \x26\x26 detSur\x3e0.0){\n          rayEndT \x3d nearSurfaceT;\n        } else  if ((fCameraHeight-fInnerRadius)\x3e2000000.0 \x26\x26 detSur\x3e0.0){\n          rayEndT \x3d mix(length(cameraSpaceRay),nearSurfaceT,((fCameraHeight-fInnerRadius)-2000000.0)/6000000.0);\n        } else {\n          rayEndT \x3d length(cameraSpaceRay);\n        }\n#else\n        rayEndT \x3d length(cameraSpaceRay);\n#endif\n      } else {\n        continueComputation \x3d false;\n      }\n#ifdef PLANAR\n      if (16500.0+ fInnerRadius \x3c fCameraHeight){\n        continueComputation \x3d false;\n      }\n#endif\n#else\n      if (detSur\x3e0.0){\n        float nearSurfaceT \x3d 0.5 *(-B - sqrt(detSur));\n        if (nearSurfaceT \x3e 0.0){\n          continueComputation \x3d false;\n        }\n      }\n#endif\n\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"atmosphereUnpackAddUniforms"\x3e\x3c![CDATA[\n        float fScale \x3d v4AtmosParams1.x;\n        vec2 v2ScaleDepth \x3d vec2(v4AtmosParams1.y,v4AtmosParams2.y);//fScaleDepth, fScaleDepthBlue\n        vec2 v2ScaleOverScaleDepth \x3d vec2(v4AtmosParams1.z,v4AtmosParams2.z);//fScaleOverScaleDepth, fScaleOverScaleDepthBlue\n        vec2 v2OneOverScaleDepth \x3d vec2(v4AtmosParams1.w,v4AtmosParams2.w);//fOneOverScaleDepth, fOneOverScaleDepthBlue\n\n#ifndef HAZE\n        float g \x3d v4AtmosParams2.x;\n        float g2 \x3d v4AtmosParams3.x;\n        float fMiePhaseCoefficients \x3d v4AtmosParams3.y;\n        float fLowerAlphaBlendBound \x3d v4AtmosParams3.z;\n        float fOneOverOuterRadiusMinusAlphaBlendBound \x3d v4AtmosParams3.w;\n#endif\n]]\x3e\x3c/snippet\x3e\n\n\n\x3csnippet name\x3d"atmosphereComputeRayAndLoopSetup"\x3e\x3c![CDATA[\n        float rayStartT \x3d 0.5 *(-B - sqrt(det)); //near intersection with atmosphere\n#ifdef HAZE\n        float nearT \x3d abs(rayStartT);\n        float farT \x3d abs(rayEndT);\n#else\n        float rayEndT \x3d 0.5 *(-B + sqrt(det)); //far intersection with atmosphere\n\n#endif\n\n        float fDistance;//calculate its scattering offset\n        // Calculate the ray\'s starting position\n        if (rayStartT \x3c 0.0)\n        { //ray starts from camera to far\n          rayStartT \x3d 0.0;\n#ifndef HAZE\n          fDistance \x3d fScale*(fInnerRadius - fCameraHeight);\n#endif\n        }\n#ifndef HAZE\n        else\n        {//outside atmosphere\n          fDistance \x3d -1.0;\n        }\n#endif\n\n        // Initialize the scattering loop variables\n        vec3 v3Start \x3d cameraPosition + worldSpaceRay * rayStartT;\n\n#ifdef HAZE\n        vec3 v3End \x3d cameraPosition + worldSpaceRay * rayEndT;\n\n        float fEndLength \x3d length(v3End);\n        float fLocalCameraHeight \x3d length(v3Start);\n\n        //computed for the original end point to get consistent light angles after possible inversions\n        float fLightAngle \x3d dot(v3LightDir, v3End) / fEndLength;\n\n        if (nearT \x3e farT)\n        {\n          if (fLocalCameraHeight \x3c fEndLength)\n          {\n            //Switch positive slopes for flipped rays\n            v3End \x3d cameraPosition + worldSpaceRay * rayStartT;\n            v3Start \x3d cameraPosition + worldSpaceRay * rayEndT;\n            worldSpaceRay *\x3d -1.0;\n            fEndLength \x3d length(v3End);\n            fLocalCameraHeight \x3d length(v3Start);\n          }\n          else if (fLocalCameraHeight \x3d\x3d fEndLength)\n          {// create minuscule fake slope for integration if the slope is zero\n            fLocalCameraHeight +\x3d 1.0; //BUGFIX, if the height of camera and ground is equal the equation breaks, add fake meter to camera height to get\n            //slope for the camera function\n          }\n        }\n\n        //Calculate its scattering offset\n        // Assumes camera constrains of WSV 3.8\n        float fCameraDepth;\n        float fCameraDepthBlue;\n        if (fLocalCameraHeight \x3e fOuterRadius)\n        {\n          fDistance \x3d fInnerRadius - fOuterRadius;\n        } else\n        {//outside atmosphere\n          fDistance \x3d fEndLength - fLocalCameraHeight;\n        }\n\n#endif\n        vec2 v2OpticalStartDepth \x3d exp(fDistance * v2OneOverScaleDepth);\n\n        float fRayLength \x3d rayEndT - rayStartT;\n        float fSampleLength \x3d fRayLength / fSamples;\n        float fScaledLength \x3d fSampleLength * fScale;\n        vec3 v3SampleRay \x3d worldSpaceRay * fSampleLength;\n        vec3 v3SamplePoint \x3d v3Start + v3SampleRay * 0.5;\n\n#ifdef HAZE\n        float fCameraAngle \x3d dot(-worldSpaceRay, v3End) / fEndLength;\n        float fScaleCameraAngle \x3d scale(fCameraAngle);\n        vec2 v2CameraOffset \x3d fScaleCameraAngle*v2OpticalStartDepth;\n\n        float scaledValues \x3d scale(fLightAngle) + fScaleCameraAngle;\n        vec2 v2ScaledValuesDepth \x3d scaledValues * v2ScaleDepth;\n#else\n        float fCameraAngle \x3d dot(worldSpaceRay, v3Start / length(v3Start));\n        float angleMultiplier \x3d fCameraAngle\x3e0.0?fCameraAngle:0.0;\n\n        float fScaleCameraAngle \x3d scale(fCameraAngle);\n        vec2 v2CameraOffset \x3d fScaleCameraAngle*v2OpticalStartDepth * v2ScaleDepth;\n#endif\n\n        //Loop variables\n        vec3 v3FrontColor \x3d vec3(0.0, 0.0, 0.0);\n        vec3 v3FrontColorBlue \x3d vec3(0.0, 0.0, 0.0);\n        vec3 v3Attenuate\x3d vec3(0.0, 0.0, 0.0);\n        vec3 v3AttenuateBlue \x3d vec3(0.0, 0.0, 0.0);\n]]\x3e\x3c/snippet\x3e\n\n\n\x3csnippet name\x3d"atmosphereComputeSampleContribution"\x3e\x3c![CDATA[\n          float fHeight \x3d length(v3SamplePoint);\n          vec2 v2Depth \x3d exp(v2ScaleOverScaleDepth * (fInnerRadius - fHeight));\n#ifdef HAZE\n          vec2 v2Scatter \x3d v2Depth*v2ScaledValuesDepth-v2CameraOffset;\n#else\n          float fLightAngle \x3d dot(v3LightDir, v3SamplePoint) / fHeight;\n          float fCameraAngle \x3d dot(worldSpaceRay, v3SamplePoint) / fHeight;\n          float fTempScaledValues \x3d scale(fLightAngle) - scale(fCameraAngle);\n          vec2 v2Scatter \x3d v2CameraOffset + fTempScaledValues*v2Depth* v2ScaleDepth;\n#endif\n          v3Attenuate \x3d exp(-v2Scatter.x * v3InvWavelengthScaled);\n          v3AttenuateBlue \x3d exp(-v2Scatter.y * v3InvWavelengthScaled);\n\n          v3FrontColor +\x3d v3Attenuate * v2Depth.x;\n          v3FrontColorBlue +\x3d v3AttenuateBlue * v2Depth.y;\n\n          v3SamplePoint +\x3d v3SampleRay;\n]]\x3e\x3c/snippet\x3e\n\n\n\x3csnippet name\x3d"atmosphereComputeHDRColors"\x3e\x3c![CDATA[\n        //Phase computation\n        //clamp to avoid numerical instability at fCos \x3d\x3d -1.0 (and close values) to display fake sun\n        float fCos \x3d clamp(dot(v3LightDir, -worldSpaceRay ),-0.9999999,1.0);\n        float fOnePlusCos2 \x3d fCos*fCos + 1.0;\n#ifdef HAZE\n        // Finally, scale the Rayleigh colors and set up the varying variables for the pixel shader\n        vec3 colorCoefficients \x3d (fScaledLength* 0.75 * fOnePlusCos2)*(fKrESun*v3InvWavelength+fKmESun);\n\n        //Scaled Length is only applied afterwards to save multiplications\n        vec3 v3Color \x3d colorCoefficients *v3FrontColor;\n        vec3 v3ColorBlue \x3d colorCoefficients *v3FrontColorBlue;\n#else\n        vec3 v3RayleighCoefficients \x3d (fScaledLength*0.75 * fOnePlusCos2*fKrESun)*v3InvWavelength;\n        float fMieCoefficients \x3d fScaledLength*fKmESun * fMiePhaseCoefficients * fOnePlusCos2 / pow(1.0 + g2 - 2.0*g*fCos, 1.5);\n\n        // Calculate the attenuation factor for the ground\n        vec3 v3Color \x3d v3RayleighCoefficients * v3FrontColor + fMieCoefficients * v3FrontColor;\n        vec3 v3ColorBlue \x3d v3RayleighCoefficients * v3FrontColorBlue + fMieCoefficients * v3FrontColorBlue;\n#endif\n]]\x3e\x3c/snippet\x3e\n\n\n\x3csnippet name\x3d"atmosphereComputePixelColor"\x3e\x3c![CDATA[\n\n\n        //HDR to LDR conversion\n        vec3 ldrBlue \x3d expTM(v3ColorBlue,2.0*fExposure);\n        vec3 ldrRed \x3d expTM(v3Color,fExposure);\n\n        //mix reddish and blueish atmosphere\n        vec3 LDR \x3d mix(ldrBlue,ldrRed,0.2);\n#ifdef HAZE\n        LDR *\x3d (1.0-fCameraAngle);\n        vec3 hsv \x3d rgb2hsv(LDR);\n        hsv.y \x3d clamp(hsv.y*1.5,0.0,1.0);//boost haze saturation by 50%\n        LDR \x3d hsv2rgb(hsv);\n        vec3 finalColor \x3d LDR;\n        // when rendering we specify the blend functions such that\n        // newDestColor \x3d oldDestColor*(1.0-finalColor) + finalColor\n#else\n        //reinhard tonemapper for looking upwards\n        vec3 ldrReinhard \x3d reinhardTM(v3Color,fExposure);\n        LDR +\x3d angleMultiplier*ldrReinhard;\n\n        //height dependent parameter to smooth out reddish atmosphere\n        float side \x3d (rayEndT+rayStartT)*0.5;\n        float atmoHeight \x3d sqrt(fCameraHeight2 - side*side);\n        float h2 \x3d clamp(1.0-(atmoHeight-fLowerAlphaBlendBound)/(fOuterRadius-fLowerAlphaBlendBound),0.0,1.0);\n\n        vec3 finalColor \x3d LDR*h2;\n        vec3 hsv \x3d rgb2hsv(finalColor);\n        hsv.y \x3d clamp(hsv.y*1.5,0.0,1.0);//boost sky saturation by 50%\n        finalColor \x3d hsv2rgb(hsv);\n#endif\n#ifdef PLANAR\n#ifndef HAZE\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,7000.0,30000.0);\n        alpha \x3d alpha / (30000.0-7000.0);\n        gl_FragColor \x3d vec4(finalColor, 1.0-alpha);\n#else\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,0.0,16500.0);\n        alpha \x3d alpha / (16500.0-0.0);\n        gl_FragColor \x3d vec4(finalColor, 1.0-alpha);\n#endif\n#else\n#ifndef HAZE\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,7000.0,30000.0);\n        alpha \x3d alpha / (30000.0-7000.0);\n        float atmosStrength \x3d clamp((length(ldrRed)-0.05)*1.05,0.0,1.0);\n        gl_FragColor \x3d vec4(finalColor, atmosStrength*clamp(1.0-(atmoHeight-fInnerRadius)/(fOuterRadius-fInnerRadius),0.0,1.0));\n#else\n        gl_FragColor \x3d vec4(finalColor, 1.0);\n#endif\n#endif\n\n\n]]\x3e\x3c/snippet\x3e\n\n\x3c!--Fragment Shader for Atmosphere--\x3e\n\x3csnippet name\x3d"fsRealisticAtmosphere"\x3e\x3c![CDATA[\n\n  $fsprecisionf\n\n$atmosphereUniformsConstantsVaryings\n\n$atmosphereScaleFunction\n\n  //Conversion implementation found in util.xml\n$rgba2float\n\n\n$toneMapperConstants\n$exponentialToneMapper\n#ifndef HAZE\n$reinhardToneMapper\n#endif\n\n$HSVColorSpace\n\n  void main()\n  {\n\n    $atmospherePrecomputation\n\n    //Inside Atmosphere\n    if (det \x3e\x3d 0.0){\n\n      $atmosphereDiscardPixels\n\n      if(continueComputation){\n\n        $atmosphereUnpackAddUniforms\n\n        $atmosphereComputeRayAndLoopSetup\n\n        // Now loop through the sample rays\n        for(int i\x3d0; i\x3cmaxSamples; i++)\n        {\n          $atmosphereComputeSampleContribution\n        }\n\n        $atmosphereComputeHDRColors\n\n        $atmosphereComputePixelColor\n\n        //Debug variable overlay\n        if(showTest\x3e0.0){\n          gl_FragColor \x3d vec4(test,1.0);\n        }\n\n      } else {//Not on surface\n        gl_FragColor \x3d vec4(0.0);\n      }\n    } else {//Outside Atmosphere\n      gl_FragColor \x3d vec4(0.0);\n    }\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/internal/offscreen.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vsOffscreenRenderer"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  attribute vec2 $position;\n  attribute vec2 $uv0;\n  varying vec2 vtc;\n\n  void main(void) {\n    gl_Position \x3d vec4(position.xy, 0.0, 1.0);\n    vtc \x3d $uv0.xy * 0.5 + 0.5;\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsOffscreenRenderer"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n  uniform sampler2D tex;\n  varying vec2 vtc;\n\n  void main() {\n    vec4 texColor \x3d texture2D(tex, vtc);\n    gl_FragColor \x3d texColor;\n  }\n\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/environment/materials/StarMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vertexShaderStar"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tuniform mat4 view;\n\tuniform mat4 model;\n\tuniform vec4 viewport;\n\n\tattribute vec3 $position;\n\tattribute vec4 $color;\n  attribute float $size;\n\n\tvarying vec4 vcolor;\n\tvarying float vsize;\n\n\t$alignToPixelCenter\n\n\tvoid main(void) {\n\t\tvec4 posProj \x3d proj * view * model*vec4($position*1.0e25,1.0);//move infinitely far away\n\t\tgl_Position \x3d alignToPixelCenter(posProj, viewport.zw); //pixel align position\n    gl_Position.z \x3d gl_Position.w; // project atmosphere onto the far plane\n\t\tvcolor \x3d $color/1.2;\n\t\tvsize \x3d size*5.0;\n\t\tgl_PointSize \x3d vsize;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderStar"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tvarying vec4 vcolor;\n\tvarying float vsize;\n\n\tvoid main() {\n\t\tfloat cap \x3d 0.7;\n\t\tfloat scale \x3d 1.0/cap;\n\t\tfloat helper \x3d clamp(length(abs(gl_PointCoord-vec2(0.5))),0.0,cap);\n\t\tfloat alpha \x3d clamp((cap-helper)*scale,0.0,1.0);\n\t\tfloat intensity \x3d alpha*alpha*alpha;\n\t\tif (vsize \x3c 3.0)\n\t\t\tintensity *\x3d 0.5;\n\t\tgl_FragColor \x3d vec4(1.0,1.0,1.0,intensity);\n\t\tgl_FragColor.xyz *\x3d vcolor.xyz;\n\t}\n]]\x3e\x3c/snippet\x3e\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/HUDMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vertexShaderHUD"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  $commonAttributesAndUniformsHUD\n\n  uniform float pixelRatio;\n  uniform vec2 screenOffset;\n  uniform vec2 anchorPos;\n\n#ifdef SCREEN_SIZE_PERSPECTIVE\n\n  uniform vec4 screenSizePerspective;\n\n#endif\n\n#ifdef DEBUG_DRAW_BORDER\n  varying vec3 debugBorderCoords;\n#endif\n\n  attribute vec2 $uv0;\n  attribute vec4 $color;\n  attribute vec2 $size;\n  attribute vec4 $auxpos2;\n\n  varying vec4 vcolor;\n\n  varying vec2 vtc;\n  varying vec2 vsize;\n\n#ifdef BINARY_HIGHLIGHT_OCCLUSION\n  varying float voccluded;\n#endif\n\n  $vvUniforms\n\n  $alignToPixelCenter\n  $alignToPixelOrigin\n  $projectPositionHUD\n  $vvFunctions\n\n  void main(void) {\n    ProjectHUDAux projectAux;\n    vec4 posProj \x3d projectPositionHUD(projectAux);\n\n    vec2 inputSize;\n\n#ifdef SCREEN_SIZE_PERSPECTIVE\n\n    inputSize \x3d screenSizePerspectiveScaleVec2($size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);\n\n    vec2 screenOffsetScaled \x3d screenSizePerspectiveScaleVec2(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);\n\n#else\n\n    inputSize \x3d $size;\n\n    vec2 screenOffsetScaled \x3d screenOffset;\n#endif\n\n#ifdef VV_SIZE\n    // only use width (.xx) for proportional scaling\n    // (if no width was defined in vv, width\n    //  will be a copy of height vv)\n    inputSize *\x3d vvGetScale($auxpos2).xx;\n#endif\n\n    vec2 combinedSize \x3d inputSize * pixelRatio;\n    vec4 quadOffset \x3d vec4(0);\n\n#if defined(OCCL_TEST) || defined(BINARY_HIGHLIGHT_OCCLUSION)\n    bool visible \x3d testVisibilityHUD(posProj);\n#endif\n\n#ifdef BINARY_HIGHLIGHT_OCCLUSION\n  voccluded \x3d visible ? 0.0 : 1.0;\n#endif\n\n#ifdef OCCL_TEST\n    if (visible) {\n#endif\n      // UV goes from 0 to 1.99999, where the integer part is used\n      // for the normalized vertex coordinates, and the fractional\n      // part is used for texture sampling\n      vec2 uv01 \x3d floor($uv0);\n      vec2 uv \x3d $uv0 - uv01;\n\n      // Displace icon based on anchor position (normalized for size) and\n      // absolute screen offset. anchorPos is [-0.5, 0.5]\n      quadOffset.xy \x3d ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffsetScaled) / viewport.zw * posProj.w;\n\n#ifdef SIGNED_DISTANCE_FIELD\n\n      // SDF primitives might be scaled so that the SDF texture resolution does\n      // not match the resolution of the canvas, but we still want to render\n      // outline-only (\'cross\' and \'x\') primitives cleanly. Aligning to a screen\n      // pixel border at the geometry center achieves this, since SDF textures\n      // always have power of 2 dimensions.\n      posProj \x3d alignToPixelOrigin(posProj, viewport.zw) + quadOffset;\n#else\n      posProj +\x3d quadOffset;\n\n      // Aligning vertex positions to the nearest (using \'floor\') screen pixel\n      // border renders textures with pixel-perfect results. If the texture\n      // resolution does not match the canvas resolution then aligning is\n      // redundant.\n      if (inputSize.x \x3d\x3d $size.x) {\n        posProj \x3d alignToPixelOrigin(posProj, viewport.zw);\n      }\n#endif\n\n      gl_Position \x3d posProj;\n\n      vtc \x3d uv;\n\n#ifdef DEBUG_DRAW_BORDER\n      debugBorderCoords \x3d vec3(uv01, 1.0 / combinedSize);\n#endif\n\n      vsize \x3d inputSize;\n#ifdef OCCL_TEST\n    } else {\n      vtc \x3d vec2(.0);\n\n#ifdef DEBUG_DRAW_BORDER\n      debugBorderCoords \x3d vec3(0);\n#endif\n\n    }\n#endif\n\n    gl_Position \x3d posProj;\n\n#ifdef VV_COLOR\n    vcolor \x3d vvGetColor($auxpos2, vvColorValues, vvColorColors);\n#else\n    vcolor \x3d $color / 255.0;\n#endif\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderHUDBaseVariables"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n  #extension GL_OES_standard_derivatives : require\n\n  uniform sampler2D tex;\n  uniform vec4 overrideColor;\n  uniform vec4 outlineColor;\n  uniform float outlineSize;\n\n  varying vec4 vcolor;\n\n  varying vec2 vtc;\n  varying vec2 vsize;\n\n#ifdef BINARY_HIGHLIGHT_OCCLUSION\n  varying float voccluded;\n#endif\n\n#ifdef DEBUG_DRAW_BORDER\n  varying vec3 debugBorderCoords;\n#endif\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderHUDBaseMain"\x3e\x3c![CDATA[\n  vec4 premultiply(vec4 v) {\n    return vec4(v.rgb * v.a, v.a);\n  }\n\n  void main() {\n\n#ifdef SIGNED_DISTANCE_FIELD\n    vec4 color \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    vec4 fillPixelColor \x3d overrideColor * vcolor;\n\n    // Attempt to sample texel centers to avoid thin cross outline\n    // disappearing with large symbol sizes.\n    // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603041\n    const float txSize \x3d 128.0;\n    vec2 scaleFactor \x3d ((vsize - txSize) / txSize);\n    vec2 samplePos \x3d vtc + vec2(1.0, -1.0) * (1.0 / txSize) * scaleFactor;\n\n    // Distance in [-0.5, 0.5]\n    float d \x3d dot(texture2D(tex, samplePos), vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0)) - 0.5;\n\n    // Work around loss of precision for \'d \x3d 0.0\'.\n    // \'0\' gets normalised to 0.5 * 256 \x3d 128 before float packing, but can only\n    // be stored in the texture as 128 / 255 \x3d 0.502.\n    // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603110\n    const float diff \x3d (128.0/255.0 - 0.5);\n\n    // adjust all values, not just those close to 0, to avoid discontinuities in\n    // the outlines of other shapes e.g. circles\n    d \x3d d - diff;\n\n    // Distance in output units\n    float dist \x3d d * vsize.x;\n\n    fillPixelColor.a *\x3d clamp(0.5 - dist, 0.0, 1.0);\n\n    if (outlineSize \x3e 0.25) {\n      vec4 outlinePixelColor \x3d outlineColor;\n      float clampedOutlineSize \x3d min(outlineSize, 0.5*vsize.x);\n      outlinePixelColor.a *\x3d clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\n\n      // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\n      float compositeAlpha \x3d outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\n      vec3 compositeColor \x3d vec3(outlinePixelColor) * outlinePixelColor.a +\n        vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\n\n      gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\n    }\n    else {\n      gl_FragColor \x3d premultiply(fillPixelColor);\n    }\n\n    // visualize SDF:\n    // gl_FragColor \x3d vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\n#else\n\n    // HUDMaterial is rendered with a blending mode that assumes a pre-multiplied\n    // fragment color. Input textures should already be pre-multiplied and so\n    // don\'t require adjustment, but the override and vertex colors must be\n    // modulated by their alpha values.\n\n    gl_FragColor \x3d texture2D(tex, vtc, -0.5) * premultiply(overrideColor * vcolor);\n\n#endif\n\n#ifdef DEBUG_DRAW_BORDER\n     float isBorder \x3d float(any(lessThan(debugBorderCoords.xy, vec2(debugBorderCoords.z))) || any(greaterThan(debugBorderCoords.xy, vec2(1.0 - debugBorderCoords.z))));\n     gl_FragColor \x3d mix(gl_FragColor, vec4(1, 0, 1, 1), isBorder);\n#endif\n\n    if (gl_FragColor.a \x3c 0.1) {\n      discard;\n    }\n\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderHUD"\x3e\x3c![CDATA[\n$fragmentShaderHUDBaseVariables\n$fragmentShaderHUDBaseMain\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderHUDHighlight"\x3e\x3c![CDATA[\n$fragmentShaderHUDBaseVariables\n\n  uniform sampler2D depthTex;\n  uniform vec4 highlightViewportPixelSz;\n\n$fragmentShaderHUDBaseMain\n#ifdef BINARY_HIGHLIGHT_OCCLUSION\n    // Instead of deciding on a per-pixel basis if the highlight is occluded,\n    // do it for all highlight pixel based on the centroid occlusion. This\n    // is a temporary solution for:\n    // https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/9645\n    if (voccluded \x3d\x3d 1.0) {\n      gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n    } else {\n      gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n    }\n#else\n    $highlightWrite\n#endif\n  }\n]]\x3e\x3c/snippet\x3e\n\n\n\x3csnippet name\x3d"vertexShaderOcclusionTestPixel"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  $commonAttributesAndUniformsHUD\n\n  $alignToPixelCenter\n  $projectPositionHUD\n\n  void main(void) {\n    vec4 posProjCenter;\n\n    // Check for special value of position (0, 0, 0) which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just project outside\n    // of clip space.\n    if (dot($position, $position) \x3e 0.0) {\n      // Render single point to center of the pixel to avoid subpixel filtering to affect\n      // the marker color\n      ProjectHUDAux projectAux;\n      vec4 posProj \x3d projectPositionHUD(projectAux);\n\n      posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\n    }\n    else {\n      // Project out of clip space\n      posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n\n    gl_Position \x3d posProjCenter;\n    gl_PointSize \x3d 1.0;\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/internal/TexOnlyGLMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vertexShaderTexOnly"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tuniform mat4 view;\n\tuniform mat4 model;\n\tattribute vec3 $position;\n\tattribute vec2 $uv0;\n\tvarying vec2 vtc;\n\n\tvoid main(void) {\n\t\tgl_Position \x3d proj * view * vec4((model * vec4(position, 1.0)).xyz, 1.0);\n\t\tvtc \x3d $uv0;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderTexOnly"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform sampler2D tex;\n\tuniform vec4 color;\n\tvarying vec2 vtc;\n\n\tvoid main() {\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\n\t\tgl_FragColor \x3d texColor * color;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/internal/ssao.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\t\x3csnippet name\x3d"createFsSSAOSrc"\x3e\x3c![CDATA[\n\n\t$fsprecisionf\n\n\tuniform sampler2D rnm;\n\tuniform sampler2D normalMap;\n\tuniform sampler2D depthMap;\n\tuniform float\t\tssaoAtt;\n\tuniform vec2\t\trnmScale;\n\tuniform float\t\tradius;\n\tuniform vec2\t\tnearFar;\n\tuniform vec3\t\tpSphere[64];\n\n\tvarying vec2\t\tuv;\n\n\tconst\tfloat\t\tstrength \x3d .07;\n\tconst\tfloat\t\tfalloff \x3d .000002;\n\n\t$rgba2float\n\tvoid main(void) {\n\t\tvec3 fres \x3d normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\n\t\tfloat currentPixelDepth \x3d rgba2float(texture2D(depthMap, uv));\n\t\tvec3 ep \x3d vec3(uv.xy, currentPixelDepth);\n\t\tvec3 norm \x3d vec3(-1.0) + 2.0 * texture2D(normalMap, uv).xyz;\n\t\tfloat bl \x3d .0;\n\t\tfloat f \x3d mix(nearFar.x, nearFar.y, currentPixelDepth) / nearFar.x;\n\t\tfloat radD \x3d radius / f;\n\t\tradD \x3d min(radD, .5);\n\t\tfloat depthDifference;\n\t\tvec3 ray;\n\n\t\tfor(int i \x3d 0; i \x3c NUM_TAP_SAMPLES; ++i) {\n\t\t\tray \x3d radD*reflect(pSphere[i], fres);\n\t\t\tvec2 tc \x3d ep.xy + sign(dot(ray, norm) ) * ray.xy;\n\t\t\tif (tc.x \x3e\x3d .0 \x26\x26 tc.y \x3e\x3d .0 \x26\x26 tc.x \x3c\x3d 1.0 \x26\x26 tc.y \x3c\x3d 1.0) {\n\t\t\t\tfloat occluderDepth \x3d rgba2float(texture2D(depthMap, tc));\n\t\t\t\tvec3 occluderNormal \x3d vec3(-1.0) + 2.0 * texture2D(normalMap, tc).xyz;\n\t\t\t\tdepthDifference \x3d currentPixelDepth - occluderDepth;\n\t\t\t\tbl +\x3d step(falloff, depthDifference) * (1.0 - dot(occluderNormal, norm)) * (1.0 - smoothstep(falloff, strength, depthDifference));\n\t\t\t};\n\t\t}\n\n\t\tfloat ao \x3d 1.0 + bl * (-1.38 / float(NUM_TAP_SAMPLES)) * ssaoAtt;\n\t\tgl_FragColor.a \x3d ao;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\t\x3csnippet name\x3d"getDepthLinear"\x3e\x3c![CDATA[\n\tfloat getDepthLinear(vec2 ssC) {\n\t\treturn -(rgba2float(texture2D(depthMap, ssC))*(nearFar[1] - nearFar[0])+nearFar[0]);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"createFsSSAOSrcObscurance"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform mat4 projMatrixInv;\n\n\tuniform sampler2D normalMap;\n\tuniform sampler2D depthMap;\n\n\tuniform float     intensity;\n\n\tuniform float projScale;\n\tuniform float     radius;\n\tuniform vec2      nearFar;\n\n\tuniform vec4      projInfo;\n\n\tuniform vec2\t  screenDimensions;\n\n\t//noise texture lookup could be replaced with hash function if WebGL gets XOR functionality\n\tuniform vec3\t\tpSphere[NUM_TAP_SAMPLES]; //tap position\n\tuniform vec2\t\trnmScale;\n\tuniform sampler2D rnm; //noise texture\n\n\t//set z scaling, used to prevent division in ortho mode\n\tuniform vec2 zScale;\n\n\tvarying vec2  uv;\n\tvarying vec4  camPos;\n\n\t$rgba2float\n\t$getDepthLinear\n\n\t/** Returns a unit vector and a screen-space radius for the tap on a unit disk (the caller should scale by the actual disk radius) */\n\t/*uniform float numSpiralTurns;\n\tvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\n\t\t// Radius relative to ssR\n\t\tfloat alpha \x3d (float(sampleNumber) + 0.5) * (1.0 / float(NUM_TAP_SAMPLES));\n\t\tfloat angle \x3d alpha * (numSpiralTurns * 6.28) + spinAngle;\n\n\t\tssR \x3d alpha;\n\t\treturn vec2(cos(angle), sin(angle));\n\t}*/\n\n\n\tfloat fallOffFunction(float vv, float vn, float bias) {\n\t  float radius2 \x3d radius * radius;\n\n\t\t// A: From the HPG12 paper\n\t\t// Note large epsilon to avoid overdarkening within cracks\n\t\t// return float(vv \x3c radius2) * max((vn - bias) / (epsilon + vv), 0.0) * radius2 * 0.6;\n\n\t\t// B: Smoother transition to zero (lowers contrast, smoothing out corners). [Recommended]\n\t\tfloat f \x3d max(radius2 - vv, 0.0); return f * f * f * max(vn-bias, 0.0);\n\n\t\t// C: Medium contrast (which looks better at high radii), no division.  Note that the\n\t\t// contribution still falls off with radius^2, but we\'ve adjusted the rate in a way that is\n\t\t// more computationally efficient and happens to be aesthetically pleasing.\n\t\t// return 4.0 * max(1.0 - vv * invRadius2, 0.0) * max(vn - bias, 0.0);\n\n\t\t// D: Low contrast, no division operation\n\t\t// return 2.0 * float(vv \x3c radius * radius) * max(vn - bias, 0.0);\n\t}\n\n\n\t/** Compute the occlusion due to sample point \\a Q about camera-space point \\a C with unit normal \\a n_C */\n\tfloat aoValueFromPositionsAndNormal(vec3 C, vec3 n_C, vec3 Q) {\n\t\tvec3 v \x3d Q - C;\n\t\tfloat vv \x3d dot(v, v);\n\t\tfloat vn \x3d dot(normalize(v), n_C);\n\t\treturn fallOffFunction(vv, vn, 0.1);\n\t}\n\n\n\t/** Reconstruct camera-space P.xyz from screen-space S \x3d (x, y) in\n\t\tpixels and camera-space z \x3c 0.  Assumes that the upper-left pixel center\n\t\tis at (0.5, 0.5) [but that need not be the location at which the sample tap\n\t\twas placed!]\n\n\t\tCosts 3 MADD.  Error is on the order of 10^3 at the far plane, partly due to z precision.\n\t  */\n\tvec3 reconstructCSPosition(vec2 S, float z) {\n\t\treturn vec3(( (S.xy) * projInfo.xy + projInfo.zw)*(z*zScale.x+zScale.y), z);\n\t}\n\n\tvoid main(void)\n\t{\n\n\t\t//Hash function used in the HPG12 AlchemyAO paper\n\t\t//Not supported in WebGL -\x3e using texture lookup as in old SSAO shader instead\n\t\t//ivec2 ssC \x3d ivec2(gl_FragCoord.xy);\n\t\t//float randomPatternRotationAngle \x3d float((3 * ssC.x ^ ssC.y + ssC.x * ssC.y) * 10);\n\t\tvec3 fres \x3d normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\n\n\t   float currentPixelDepth \x3d getDepthLinear(uv);\n\n\t   if (-currentPixelDepth\x3enearFar.y || -currentPixelDepth\x3cnearFar.x) {\n\t\tgl_FragColor \x3d vec4(0);\n\t\treturn;\n\t   }\n\n\t   vec3 currentPixelPos \x3d reconstructCSPosition(gl_FragCoord.xy,currentPixelDepth);\n\n\t   // get the normal of current fragment\n\t   vec4 norm4 \x3d texture2D(normalMap, uv);\n\t   vec3 norm \x3d vec3(-1.0) + 2.0 * norm4.xyz;\n\t   bool isTerrain \x3d norm4.w\x3c0.5;\n\n\t   float sum \x3d .0;\n\n\t   vec4 occluderFragment;\n\t   vec3 ray;\n\n\t   vec3 tapPixelPos;\n\n\t   // note: the factor 2.0 should not be necessary, but makes ssao much nicer.\n\t   // bug or deviation from CE somewhere else?\n\t   float ps \x3d projScale/(2.0*currentPixelPos.z*zScale.x+zScale.y);\n\n\t   for(int i \x3d 0; i \x3c NUM_TAP_SAMPLES; ++i)\n\t   {\n\t\t  // get a vector (randomized inside of a sphere with radius 1.0) from a texture and reflect it\n\t\t  //float ssR;\n\t\t  //vec2 unitOffset \x3d tapLocation(i, randomPatternRotationAngle, ssR);\n\t\t  // get the depth of the occluder fragment\n\t\t  //vec2 offset \x3d vec2(-unitOffset*radius*ssR*ps);\n\n\t\t  vec2 unitOffset \x3d reflect(pSphere[i], fres).xy;\n\t\t  vec2 offset \x3d vec2(-unitOffset*radius*ps);\n\n\n\t\t  //don\'t use current or very nearby samples\n\t\t  if ( abs(offset.x)\x3c2.0 || abs(offset.y)\x3c2.0) continue;\n\n\n\t\t  vec2 tc \x3d vec2(gl_FragCoord.xy + offset);\n\t\t  if (tc.x \x3c 0.0 || tc.y \x3c 0.0 || tc.x \x3e screenDimensions.x || tc.y \x3e screenDimensions.y) continue;\n\t\t  vec2 tcTap \x3d tc/screenDimensions;\n\t\t  float occluderFragmentDepth \x3d getDepthLinear(tcTap);\n\n\t\t  if (isTerrain) {\n\t\t  \tbool isTerrainTap \x3d texture2D(normalMap, tcTap).w\x3c0.5;\n\t\t  \tif (isTerrainTap)\n\t\t  \t\tcontinue;\n\t\t  }\n\n\t\t  tapPixelPos \x3d reconstructCSPosition(tc, occluderFragmentDepth);\n\n\t\t  sum+\x3d aoValueFromPositionsAndNormal(currentPixelPos, norm, tapPixelPos);\n\t   }\n\n\t   // output the result\n\n\t\tfloat A \x3d max(1.0-sum*intensity/float(NUM_TAP_SAMPLES),0.0);\n\n\t\t// Anti-tone map to reduce contrast and drag dark region farther\n\t\t// (x^0.2 + 1.2 * x^4)/2.2\n\t\tA \x3d (pow(A, 0.2) + 1.2 * A*A*A*A) / 2.2;\n\n\n\t   //gl_FragColor \x3d vec4(norm/2.0+0.5, 1.0);\n\t   //gl_FragColor \x3d vec4(-currentPixelDepth/1000.0);\n\t   //gl_FragColor \x3d vec4(tapPixelPos.x/100.0);\n\t   gl_FragColor \x3d vec4(A);\n\n\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsBlurEdgeAware"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform sampler2D normalMap;\n\tuniform sampler2D depthMap;\n\tuniform sampler2D tex;\n\n\n\tuniform vec2 blurSize;\n\n\n\tuniform float g_BlurFalloff;\n\tuniform float projScale;\n\n\n\tvarying vec2 uv;\n\n\tuniform vec2\t\tnearFar;\n\n\t//set z scaling, used to prevent division in ortho mode\n\tuniform vec2 zScale;\n\n\t$rgba2float\n\t$getDepthLinear\n\n\tfloat BlurFunction(vec2 uv, float r, float center_d, inout float w_total, float sharpness)\n\t{\n\t\tfloat c \x3d texture2D(tex, uv).r;\n\t\tfloat d \x3d getDepthLinear(uv);\n\n\t\tfloat ddiff \x3d d - center_d;\n\n\t\tfloat w \x3d exp(-r*r*g_BlurFalloff - ddiff*ddiff*sharpness);\n\n\t\tw_total +\x3d w;\n\n\t\treturn w*c;\n\t}\n\n\tvoid main(void)\n\t{\n\n\t\tfloat b \x3d 0.0;\n\t\tfloat w_total \x3d 0.0;\n\n\t\tfloat center_d \x3d  getDepthLinear(uv);\n\n\t\tfloat sharpness \x3d -0.05*projScale/(center_d*zScale.x+zScale.y);\n\t\tfor (int r \x3d -RADIUS; r \x3c\x3d RADIUS; ++r)\n\t\t{\n\t\t\tfloat rf \x3d float(r);\n\t\t\tvec2 uvOffset \x3d uv + rf*blurSize;\n\t\t\tb +\x3d BlurFunction(uvOffset, rf, center_d, w_total, sharpness);\n\t\t}\n\n\t\tgl_FragColor \x3d vec4(b/w_total);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\n\t\x3csnippet name\x3d"fsBlurSrc0"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform sampler2D tex;\n\tuniform float blurSize;\n\tvarying vec2 uv;\n\n\tvoid main() {\n\t\tint rad \x3d RADIUS - 1;\n\n\t\tvec4 sum \x3d vec4(0.0);\n\t\tfor (int k \x3d -RADIUS; k \x3c\x3d RADIUS; ++k) { \t\t// NOTE for-variable-init must be a const expression\n\t\t\tfloat fi \x3d float(k);\n]]\x3e\x3c/snippet\x3e\n\n\t\x3csnippet name\x3d"fsBlurSrc1"\x3e\x3c![CDATA[\n\t\t}\n\n\t\tgl_FragColor \x3d sum / float(RADIUS * RADIUS);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\t\x3csnippet name\x3d"fsBlurH"\x3e\x3c![CDATA[\n\t$fsBlurSrc0\n\t\t\tsum +\x3d texture2D(tex, vec2(uv.x + fi * blurSize, uv.y)) * (float(rad) - abs(fi) + 1.0);\n\t$fsBlurSrc1\n]]\x3e\x3c/snippet\x3e\n\n\t\x3csnippet name\x3d"fsBlurV"\x3e\x3c![CDATA[\n\t$fsBlurSrc0\n\t\t\tsum +\x3d texture2D(tex, vec2(uv.x, uv.y + fi * blurSize)) * (float(rad) - abs(fi) + 1.0);\n\t$fsBlurSrc1\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/internal/highlight.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3c!--\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\nSmartly downsamples a texture, halfing its resolution. This allows for a square\nscreen region to check if none, any or all pixels were set.\n\nThe red channel is always ceiled after interpolating the 4 merged pixels.\nThis allows to evaluate:\nany(pixels.red !\x3d 0.0) as red \x3d\x3d 1.0\nnone(pixels.red !\x3d 0.0) as red \x3d\x3d 0.0\n\nThe green and blue channels are set to floor(max(green, blue)).\nThis allows to evaluate:\nall(pixels.green || pixels.blue) as green \x3d\x3d 1.0\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\n--\x3e\n\n\x3csnippet name\x3d"vsConservativeDownsample"\x3e\x3c![CDATA[\n\n  $vsprecisionf\n\n  attribute vec2 $position;\n\n  void main()\n  {\n    gl_Position \x3d vec4(vec2(1.0) - $position * 2.0, .0, 1.0);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsConservativeDownsample"\x3e\x3c![CDATA[\n\n  $fsprecisionf\n\n  uniform sampler2D tex;\n  uniform vec2 invFramebufferDim;\n\n  void main()\n  {\n    vec2 coord \x3d gl_FragCoord.xy * invFramebufferDim;\n    vec4 value \x3d texture2D(tex, coord);\n    float mx \x3d floor(max(value.g, value.b));\n    gl_FragColor \x3d vec4(ceil(value.r), mx, mx, 1.0);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3c!--\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\nGaussian blur with linear sampling. Supports different number of samples, but\nonly 5 samples have proper weights. Uses linear texture interpolation to reduce\nthe number of samples taken.\n\nDefines:\nGRID_OPTIMIZATION (set or !set)\nGAUSSIAN_SAMPLES (3,5,7)\n\nThis technique requires linear filtering on source texture\nhttp://rastergrid.com/blog/2010/09/efficient-gaussian-blur-with-linear-sampling/\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\n--\x3e\n\x3csnippet name\x3d"vsHighlightBlurFastGaussian"\x3e\x3c![CDATA[\n\n  $vsprecisionf\n\n  attribute vec2 $position;\n  attribute vec2 $uv0;\n\n  #ifdef GRID_OPTIMIZATION\n    uniform sampler2D coverageTex;\n    varying vec3 blurCoordinate;\n  #else\n    uniform vec2 blurSize;\n    varying vec2 blurCoordinates[GAUSSIAN_SAMPLES];\n  #endif\n\n  void main()\n  {\n    gl_Position \x3d vec4($position, 0.0, 1.0);\n\n    #ifdef GRID_OPTIMIZATION\n      // sample the coverage texture at the block center\n      // and if no coverage detected, create degenerate triangle\n      vec4 cov \x3d texture2D(coverageTex, $uv0);\n      if (cov.r \x3d\x3d 0.0) {\n        gl_Position \x3d vec4(0,0,0,0);\n      }\n\n      // create texture coordinate for blur center\n      // encode information about fully inside block in z coordinate\n      blurCoordinate \x3d vec3(gl_Position.xy * .5 + vec2(.5), max(cov.g, cov.b));\n    #else\n      vec2 uv \x3d $position.xy * .5 + vec2(.5);\n\n      #if GAUSSIAN_SAMPLES \x3d\x3d 3\n        // not proper gaussian weights\n        blurCoordinates[0] \x3d uv;\n        blurCoordinates[1] \x3d uv + blurSize * 1.407333;\n        blurCoordinates[2] \x3d uv - blurSize * 1.407333;\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 5\n        blurCoordinates[0] \x3d uv;\n        blurCoordinates[1] \x3d uv + blurSize * 1.407333;\n        blurCoordinates[2] \x3d uv - blurSize * 1.407333;\n        blurCoordinates[3] \x3d uv + blurSize * 3.294215;\n        blurCoordinates[4] \x3d uv - blurSize * 3.294215;\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 7\n        // not proper gaussian weights\n        blurCoordinates[0] \x3d uv;\n        blurCoordinates[1] \x3d uv + blurSize * 1.407333;\n        blurCoordinates[2] \x3d uv - blurSize * 1.407333;\n        blurCoordinates[3] \x3d uv + blurSize * 3.294215;\n        blurCoordinates[4] \x3d uv - blurSize * 3.294215;\n        blurCoordinates[5] \x3d uv + blurSize * 5.1;\n        blurCoordinates[6] \x3d uv - blurSize * 5.1;\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 9\n        // not proper gaussian weights\n        blurCoordinates[0] \x3d uv;\n        blurCoordinates[1] \x3d uv + blurSize * 1.407333;\n        blurCoordinates[2] \x3d uv - blurSize * 1.407333;\n        blurCoordinates[3] \x3d uv + blurSize * 3.294215;\n        blurCoordinates[4] \x3d uv - blurSize * 3.294215;\n        blurCoordinates[5] \x3d uv + blurSize * 5.1;\n        blurCoordinates[6] \x3d uv - blurSize * 5.1;\n        blurCoordinates[7] \x3d uv + blurSize * 7.1;\n        blurCoordinates[8] \x3d uv - blurSize * 7.1;\n      #endif\n    #endif\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsHighlightBlurFastGaussian"\x3e\x3c![CDATA[\n\n  $fsprecisionf\n\n  uniform sampler2D tex;\n\n  #ifdef GRID_OPTIMIZATION\n    uniform vec2 blurSize;\n    varying vec3 blurCoordinate;\n  #else\n    varying vec2 blurCoordinates[GAUSSIAN_SAMPLES];\n  #endif\n\n  void main()\n  {\n    #ifdef GRID_OPTIMIZATION\n      vec2 uv \x3d blurCoordinate.xy;\n      vec4 center \x3d texture2D(tex, uv);\n\n      // do not blur if no pixel or all pixels in neighborhood are set\n      if (blurCoordinate.z \x3d\x3d 1.0) {\n        gl_FragColor \x3d center;\n      }\n      else {\n        vec4 sum \x3d vec4(0.0);\n\n        #if GAUSSIAN_SAMPLES \x3d\x3d 3\n          // not proper gaussian weights\n          sum +\x3d center * 0.204164;\n          sum +\x3d texture2D(tex, uv + blurSize * 1.407333) * 0.304005;\n          sum +\x3d texture2D(tex, uv - blurSize * 1.407333) * 0.304005;\n        #elif GAUSSIAN_SAMPLES \x3d\x3d 5\n          sum +\x3d center * 0.204164;\n          sum +\x3d texture2D(tex, uv + blurSize * 1.407333) * 0.304005;\n          sum +\x3d texture2D(tex, uv - blurSize * 1.407333) * 0.304005;\n          sum +\x3d texture2D(tex, uv + blurSize * 3.294215) * 0.093913;\n          sum +\x3d texture2D(tex, uv - blurSize * 3.294215) * 0.093913;\n        #elif GAUSSIAN_SAMPLES \x3d\x3d 7\n          // not proper gaussian weights\n          sum +\x3d center * 0.204164;\n          sum +\x3d texture2D(tex, uv + blurSize * 1.407333) * 0.304005;\n          sum +\x3d texture2D(tex, uv - blurSize * 1.407333) * 0.304005;\n          sum +\x3d texture2D(tex, uv + blurSize * 3.294215) * 0.093913;\n          sum +\x3d texture2D(tex, uv - blurSize * 3.294215) * 0.093913;\n          sum +\x3d texture2D(tex, uv + blurSize * 5.1) * 0.03;\n          sum +\x3d texture2D(tex, uv - blurSize * 5.1) * 0.03;\n        #elif GAUSSIAN_SAMPLES \x3d\x3d 9\n          // not proper gaussian weights\n          sum +\x3d center * 0.154164;\n          sum +\x3d texture2D(tex, uv + blurSize * 1.5) * 0.204005;\n          sum +\x3d texture2D(tex, uv - blurSize * 1.5) * 0.204005;\n          sum +\x3d texture2D(tex, uv + blurSize * 3.5) * 0.123913;\n          sum +\x3d texture2D(tex, uv - blurSize * 3.5) * 0.123913;\n          sum +\x3d texture2D(tex, uv + blurSize * 5.5) * 0.123913;\n          sum +\x3d texture2D(tex, uv - blurSize * 5.5) * 0.123913;\n          sum +\x3d texture2D(tex, uv + blurSize * 7.5) * 0.05;\n          sum +\x3d texture2D(tex, uv - blurSize * 7.5) * 0.05;\n        #endif\n\n        gl_FragColor \x3d sum;\n      }\n    #else\n      vec4 sum \x3d vec4(0.0);\n\n      #if GAUSSIAN_SAMPLES \x3d\x3d 3\n        // not proper gaussian weights\n        sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.204164;\n        sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.304005;\n        sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.304005;\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 5\n        sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.204164;\n        sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.304005;\n        sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.304005;\n        sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.093913;\n        sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.093913;\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 7\n        // not proper gaussian weights\n        sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.204164;\n        sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.304005;\n        sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.304005;\n        sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.093913;\n        sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.093913;\n        sum +\x3d texture2D(tex, blurCoordinates[5]) * 0.03;\n        sum +\x3d texture2D(tex, blurCoordinates[6]) * 0.03;\n      #elif GAUSSIAN_SAMPLES \x3d\x3d 9\n        // not proper gaussian weights\n        sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.154164;\n        sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.204005;\n        sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.204005;\n        sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.123913;\n        sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.123913;\n        sum +\x3d texture2D(tex, blurCoordinates[5]) * 0.09;\n        sum +\x3d texture2D(tex, blurCoordinates[6]) * 0.09;\n        sum +\x3d texture2D(tex, blurCoordinates[7]) * 0.05;\n        sum +\x3d texture2D(tex, blurCoordinates[8]) * 0.05;\n      #endif\n\n      gl_FragColor \x3d sum;\n    #endif\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3c!--\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\nMerging blurred outlines with source image, advanced version\n\nDefines:\nGRID_OPTIMIZATION (set or !set)\nGRID_DEBUG (set or !set)\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\n--\x3e\n\x3csnippet name\x3d"vsHighlightApply"\x3e\x3c![CDATA[\n\n  $vsprecisionf\n\n  attribute vec2 $position;\n  varying vec2 uv;\n\n  #ifdef GRID_OPTIMIZATION\n    attribute vec2 $uv0;\n    uniform sampler2D coverageTex;\n  #endif\n\n  void main()\n  {\n    #ifdef GRID_OPTIMIZATION\n      #ifdef GRID_DEBUG\n        vec4 cov \x3d texture2D(coverageTex, $uv0);\n        // if no highlight pixel set in this block,\n        // or all pixels set, hide block\n        if (cov.r \x3d\x3d 0.0 || cov.g \x3d\x3d 1.0 || cov.b \x3d\x3d 1.0) {\n          gl_Position \x3d vec4(0,0,0,0);\n          return;\n        }\n        gl_Position \x3d vec4($position, .0, 1.0);\n        uv \x3d $uv0;\n        return;\n      #else\n        vec4 cov \x3d texture2D(coverageTex, $uv0);\n        // if no highlight pixel set in this block, hide block\n        if (cov.r \x3d\x3d 0.0) {\n          gl_Position \x3d vec4(0,0,0,0);\n          return;\n        }\n      #endif\n    #endif\n\n    gl_Position \x3d vec4($position, .0, 1.0);\n    uv \x3d $position.xy * .5 + vec2(.5);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsHighlightApply"\x3e\x3c![CDATA[\n\n  $fsprecisionf\n\n  uniform sampler2D tex;\n  uniform sampler2D origin;\n\n  uniform vec4 color;\n  uniform float outlineSize;\n  uniform float blurSize;\n  uniform vec4 opacities; // [outline, outlineOccluded, fill, fillOccluded]\n\n  varying vec2 uv;\n\n  void main()\n  {\n    #if defined(GRID_OPTIMIZATION) \x26\x26 defined(GRID_DEBUG)\n      gl_FragColor \x3d vec4(uv, 0, 1.0);\n    #else\n      // Read the highlight intensity from the blurred highlight image\n      vec4 blurredHighlightValue \x3d texture2D(tex, uv);\n      float highlightIntensity \x3d blurredHighlightValue.a;\n\n      // Discard all pixels which are not affected by highlight\n      if (highlightIntensity \x3d\x3d 0.0) {\n        discard;\n      }\n\n      vec4 origin_color \x3d texture2D(origin, uv);\n\n      float outlineIntensity;\n      float fillIntensity;\n\n      // if occluded\n      if (blurredHighlightValue.g \x3e blurredHighlightValue.b) {\n        outlineIntensity \x3d color.w * opacities[1];\n        fillIntensity \x3d color.w * opacities[3];\n      }\n      // if unoccluded\n      else {\n        outlineIntensity \x3d color.w * opacities[0];\n        fillIntensity \x3d color.w * opacities[2];\n      }\n\n      float inner \x3d 1.0 - outlineSize / 9.0;\n      float outer \x3d 1.0 - (outlineSize + blurSize) / 9.0;\n\n      float outlineFactor \x3d smoothstep(outer, inner, highlightIntensity);\n      //float fillFactor \x3d smoothstep(0.6, 0.72, highlightIntensity);\n      float fillFactor \x3d any(notEqual(origin_color, vec4(0.0, 0.0, 0.0, 0.0))) ? 1.0 : 0.0;\n      float intensity \x3d outlineIntensity * outlineFactor * (1.0 - fillFactor) + fillIntensity * fillFactor;\n\n      // Blending equation: gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n      // I.e., color should not be premultiplied with alpha\n      gl_FragColor \x3d vec4(color.xyz, intensity);\n    #endif\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/internal/occluded.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vsRenderOccludedApply"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  attribute vec2 $position;\n  varying vec2 uv;\n\n  void main(void) {\n    gl_Position \x3d vec4($position, 0.0, 1.0);\n    uv \x3d $position.xy * 0.5 + vec2(0.5);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsRenderOccludedApply"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n  uniform sampler2D occludedColorMap;\n\n  varying vec2 uv;\n\n  void main() {\n    vec4 occludedColor \x3d texture2D(occludedColorMap, uv);\n    gl_FragColor \x3d occludedColor * vec4(1.0, 1.0, 1.0, 0.4);\n  }\n\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/internal/util.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"alignToPixelCenter"\x3e\x3c![CDATA[\n  vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {\n    // From clip space to (0 : 1), bias towards right pixel edge\n    vec2 xy \x3d vec2(.500123) + .5 * clipCoord.xy / clipCoord.w;\n\n    // Size of a pixel in range (0 : 1)\n    vec2 pixelSz \x3d vec2(1.0) / widthHeight;\n\n    // Round to nearest pixel center\n    vec2 ij \x3d (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;\n\n    // Convert back to clip space\n    vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\n\n    return vec4(result, clipCoord.zw);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"alignToPixelOrigin"\x3e\x3c![CDATA[\n  vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {\n    // From clip space to (0 : 1),\n    vec2 xy \x3d vec2(.5) + .5 * clipCoord.xy / clipCoord.w;\n\n    // Size of a pixel in range (0 : 1)\n    vec2 pixelSz \x3d vec2(1.0) / widthHeight;\n\n    // Round to nearest pixel border, (0 : 1)\n    vec2 ij \x3d floor((xy + .5 * pixelSz) * widthHeight) * pixelSz;\n\n    // Convert back to clip space\n    vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\n\n    return vec4(result, clipCoord.zw);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"float2rgba"\x3e\x3c![CDATA[\n\tvec4 float2rgba(const in float v) {\n\t\tvec4 enc \x3d vec4(1.0, 255.0, 65025.0, 16581375.0) * v;\n\t\tenc \x3d fract(enc);\n\t\tenc -\x3d enc.yzww * vec4(1.0/255.0, 1.0/255.0, 1.0/255.0, 0.0);\n\t\treturn enc;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"rgba2float"\x3e\x3c![CDATA[\n\tfloat rgba2float(vec4 rgba) {\n\t\treturn dot(rgba, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0));\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"calcFragDepth"\x3e\x3c![CDATA[\n\t#extension GL_OES_standard_derivatives : enable\n\n\tfloat calcFragDepth(const in float depth) {\n\t\t//calc polygon offset\n\t\tconst float SLOPE_SCALE \x3d 2.0;\n\t\tconst float BIAS \x3d 2.0 * .000015259;\t\t// 1 / (2^16 - 1)\n\t\tfloat m \x3d max(abs(dFdx(depth)), abs(dFdy(depth)));\n\t\tfloat result \x3d depth + SLOPE_SCALE * m + BIAS;\n\t\treturn clamp(result, .0, .999999);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"evalShadow"\x3e\x3c![CDATA[\n\t$rgba2float\n\n\t// "matrix" parameter used to have const qualifier as well, but IE11 couldn\'t deal with it at time of writing.\n\t// once IE11 is fine with it, const should probably be re-introduced\n\tfloat evalShadow(const in vec3 vpos, const in float depth, const in sampler2D depthTex, const int num, const in vec4 distance, in mat4 matrix[4], const in float halfPxSz) {\n\t\t//choose correct cascade\n\t\tint i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\n\n\t\tif (i \x3e\x3d num) return .0;\n\n\t\tmat4 mat \x3d i \x3d\x3d 0 ? matrix[0] : i \x3d\x3d 1 ? matrix[1] : i \x3d\x3d 2 ? matrix[2] : matrix[3];\n\n\t\tvec4 lv \x3d mat * vec4(vpos, 1.0);\n\t\tlv.xy /\x3d lv.w;\n\n\t\t//vertex completely outside? -\x3e no shadow\n\t\tvec3 lvpos \x3d .5 * lv.xyz + vec3(.5);\n\t\tif (lvpos.z \x3e\x3d 1.0) return .0;\n\t\tif (lvpos.x \x3c .0 || lvpos.x \x3e 1.0 || lvpos.y \x3c .0 || lvpos.y \x3e 1.0) return .0;\n\n\t\t//calc coord in cascade texture\n\t\tvec2 uv \x3d vec2(float(i - 2 * (i / 2)) *.5, float(i / 2) * .5) + .5 * lvpos.xy;\n\n\t\tfloat texSize \x3d .5 / halfPxSz;\n\n\t\t//filter, offset by half pixels\n\t\tvec2 st \x3d fract((vec2(halfPxSz) + uv) * texSize);\n\n\t\tfloat s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPxSz, -halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\n\t\tfloat s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPxSz, -halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\n\t\tfloat s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPxSz, halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\n\t\tfloat s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPxSz, halfPxSz))) \x3c lvpos.z ? 1.0 : .0;\n\n\t\treturn mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\n\x3c!--\n\tScene Lighting Definitions:\n\t\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\n\n\tdefines:\n\t\t- SH_ORDER: 1|2|3\n\tinput:\n\t\t- normal: vec3\n\t\t- albedo: vec3\n\t  - shadow: float\n\t\t- ssao: float\n\treturn:\n\t  - color: vec3\n--\x3e\n\x3csnippet name\x3d"sceneLightingDefinitions"\x3e\x3c![CDATA[\n\t$viewingMode\n\n\t// main light\n\t/////////////////////////////////////////\n\tuniform vec3 lightingMainDirection;\n\tuniform vec3 lightingMainIntensity;\n\n\t// ambient lighting\n\t/////////////////////////////////////////\n\t#ifndef SH_ORDER\n\t\t#define SH_ORDER 2\n\t#endif\n\n\t#if SH_ORDER \x3d\x3d 0\n\t\tuniform vec3 lightingAmbientSH0;\n\t#elif SH_ORDER \x3d\x3d 1\n\t\tuniform vec4 lightingAmbientSH_R;\n\t\tuniform vec4 lightingAmbientSH_G;\n\t\tuniform vec4 lightingAmbientSH_B;\n\t#elif SH_ORDER \x3d\x3d 2\n\t\tuniform vec3 lightingAmbientSH0;\n\t\tuniform vec4 lightingAmbientSH_R1;\n\t\tuniform vec4 lightingAmbientSH_G1;\n\t\tuniform vec4 lightingAmbientSH_B1;\n\t\tuniform vec4 lightingAmbientSH_R2;\n\t\tuniform vec4 lightingAmbientSH_G2;\n\t\tuniform vec4 lightingAmbientSH_B2;\n\t#endif\n\n\t// special tweaking\n\t//////////////////////////////////////////\n\t\tuniform float lightingFixedFactor;\n\t\tuniform float lightingGlobalFactor;\n\n\t\tuniform float ambientBoostFactor;\n\n\t// evaluation\n\t//////////////////////////////////////////\n\n\tvec3 evaluateSceneLighting(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight) {\n\t\t// evaluate the main light\n\t\tfloat dotVal \x3d mix(clamp(-dot(normal, lightingMainDirection), 0.0, 1.0), 1.0, lightingFixedFactor);\n\t\tvec3 mainLight \x3d (1.0 - shadow) * lightingMainIntensity * dotVal;\n\n\t\t// evaluate the sh ambient light\n\t\t#if SH_ORDER \x3d\x3d 0\n\t\t\tvec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\n\t\t#elif SH_ORDER \x3d\x3d 1\n\t\t\tvec4 sh0 \x3d vec4(\n\t\t\t\t0.282095,\n\t\t\t\t0.488603 * normal.x,\n\t\t\t\t0.488603 * normal.z,\n\t\t\t\t0.488603 * normal.y\n\t\t\t);\n\t\t\tvec3 ambientLight \x3d vec3(\n\t\t\t\tdot(lightingAmbientSH_R, sh0),\n\t\t\t\tdot(lightingAmbientSH_G, sh0),\n\t\t\t\tdot(lightingAmbientSH_B, sh0)\n\t\t\t);\n\t\t#elif SH_ORDER \x3d\x3d 2\n\t\t\tvec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\n\n\t\t\tvec4 sh1 \x3d vec4(\n\t\t\t\t0.488603 * normal.x,\n\t\t\t\t0.488603 * normal.z,\n\t\t\t\t0.488603 * normal.y,\n\t\t\t\t1.092548 * normal.x * normal.y\n\t\t\t);\n\t\t\tvec4 sh2 \x3d vec4(\n\t\t\t\t1.092548 * normal.y * normal.z,\n\t\t\t\t0.315392 * (3.0 * normal.z * normal.z - 1.0),\n\t\t\t\t1.092548 * normal.x * normal.z,\n\t\t\t\t0.546274 * (normal.x * normal.x - normal.y * normal.y)\n\t\t\t);\n\t\t\tambientLight +\x3d vec3(\n\t\t\t\tdot(lightingAmbientSH_R1, sh1),\n\t\t\t\tdot(lightingAmbientSH_G1, sh1),\n\t\t\t\tdot(lightingAmbientSH_B1, sh1)\n\t\t\t);\n\t\t\tambientLight +\x3d vec3(\n\t\t\t\tdot(lightingAmbientSH_R2, sh2),\n\t\t\t\tdot(lightingAmbientSH_G2, sh2),\n\t\t\t\tdot(lightingAmbientSH_B2, sh2)\n\t\t\t);\n\t\t#endif\n\t\tambientLight *\x3d (1.0 - ssao);\n\n\t\t// inverse gamma correction on the albedo color\n\t\tfloat gamma \x3d 2.1;\n\t\tvec3 albedoGammaC \x3d pow(albedo, vec3(gamma));\n\n\t\t// physically correct BRDF normalizes by PI\n\t\tconst float PI \x3d 3.14159;\n\t\tvec3 totalLight \x3d mainLight + ambientLight + additionalLight;\n\t\ttotalLight \x3d min(totalLight, vec3(PI, PI, PI));\n\t\tvec3 outColor \x3d vec3((albedoGammaC / PI) * (totalLight));\n\n\t\t// apply gamma correction to the computed color\n\t\toutColor \x3d pow(outColor, vec3(1.0/gamma));\n\n\t\treturn outColor;\n\t}\n\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"sceneLightingAdditionalLightGlobal"\x3e\x3c![CDATA[\n\t// heuristic lighting model originally used in the terrain shading\n\t// now used to generated additional ambient light\n\t#ifdef VIEWING_MODE_GLOBAL\n\t\tfloat vndl \x3d -dot(normalize(vpos + localOrigin), lightingMainDirection);\n\t#else\n\t\tfloat vndl \x3d -dot(vec3(0,0,1), lightingMainDirection);\n\t#endif\n\tfloat additionalAmbientScale \x3d smoothstep(0.0, 1.0, clamp(vndl*2.5, 0.0, 1.0));\n\tvec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"normal2envTC"\x3e\x3c![CDATA[\n\tvec2 normal2envTC(vec3 normal) {\n\t\tfloat v \x3d .5 + .5 * asin(normal.y) * 0.63661977;\n\t\tfloat u \x3d .5 - .5 * atan(normal.z, normal.x) * 0.31830988;\n\t\treturn vec2(u, v);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vertexShaderShowDepth"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tattribute vec2 $position;\n\tattribute vec2 $uv0;\n\tvarying vec2 vtc;\n\n\tvoid main(void) {\n\t\tgl_Position \x3d proj * vec4($position.x, $position.y, .0, 1.0);\n\t\tvtc \x3d $uv0;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\t\x3csnippet name\x3d"fragmentShaderShowDepth"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform sampler2D depthTex;\n\tvarying vec2 vtc;\n\t$rgba2float\n\tvoid main() {\n\t//\tgl_FragColor \x3d vec4(vec3(texture2D(depthTex, vtc).a), 1.0);\n\t\tgl_FragColor \x3d vec4(rgba2float(texture2D(depthTex, vtc)));\n\t//\tgl_FragColor \x3d texture2D(depthTex, vtc);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsUVQuad"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tattribute vec2 $position;\n\tvarying vec2 uv;\n\n\tvoid main(void) {\n\t\tgl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\n\t\tuv \x3d $position * .5 + vec2(.5);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"toScreenCoords"\x3e\x3c![CDATA[\n\tvec4 toScreenCoords(vec3 vertex) {\n\t\tvec4 vClipSpace \x3d proj * view * vec4((model * vec4(vertex, 1.0)).xyz, 1.0);\n\t\tvClipSpace.xy *\x3d screenSize;\n\t\treturn vClipSpace/abs(vClipSpace.w);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vvUniforms"\x3e\x3c![CDATA[\n#if defined(VV_SIZE)\n\t#define VV_CUSTOM_MODEL_MATRIX\n#endif\n\n#if defined(VV_SIZE)\n\tuniform vec3 vvSizeMinSize;\n\tuniform vec3 vvSizeMaxSize;\n\tuniform vec3 vvSizeOffset;\n\tuniform vec3 vvSizeFactor;\n#elif defined(VV_CUSTOM_MODEL_MATRIX)\n\tuniform vec3 vvSizeValue;\n#endif\n\n#ifdef VV_CUSTOM_MODEL_MATRIX\n\tuniform mat3 vvSymbolRotation;\n#endif\n\n#ifdef VV_CUSTOM_MODEL_MATRIX\n\tuniform vec3 vvSymbolAnchor;\n#endif\n\n#ifdef VV_COLOR\n\t#define VV_COLOR_N 8\n\tuniform float vvColorValues[VV_COLOR_N];\n\tuniform vec4 vvColorColors[VV_COLOR_N];\n#endif\n\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vvFunctions"\x3e\x3c![CDATA[\n// Evaluation of size\n#if defined(VV_SIZE)\n\tvec3 vvGetScale(vec4 featureAttribute) {\n\t\treturn clamp(vvSizeOffset + featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n\t}\n#elif defined(VV_CUSTOM_MODEL_MATRIX)\n\tvec3 vvGetScale(vec4 featureAttribute) {\n\t\treturn vvSizeValue;\n\t}\n#endif\n\n// Applying the model matrix\n#ifdef VV_CUSTOM_MODEL_MATRIX\n\tvec4 vvTransformPosition(vec3 position, vec4 featureAttribute) {\n\t\treturn vec4(vvSymbolRotation * (vvGetScale(featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n\t}\n\n\tvec4 vvTransformNormal(vec3 normal, vec4 featureAttribute) {\n\t\t// Normal transform is the inverse transpose of model transform\n\t\treturn vec4(vvSymbolRotation * normal / vvGetScale(featureAttribute), 1.0);\n\t}\n#endif\n\n#ifdef VV_COLOR\n\tvec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n\t\tfloat value \x3d featureAttribute.y;\n\t\tif (value \x3c\x3d values[0]) {\n\t\t\treturn colors[0];\n\t\t}\n\n\t\tfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n\t\t\tif (values[i] \x3e\x3d value) {\n\t\t\t\tfloat f \x3d (value - values[i-1]) / (values[i] - values[i-1]);\n\t\t\t\treturn mix(colors[i-1], colors[i], f);\n\t\t\t}\n\t\t}\n\n\t\treturn colors[VV_COLOR_N - 1];\n\t}\n#endif\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"rgb2hsv"\x3e\x3c![CDATA[\nvec3 rgb2hsv(vec3 c)\n{\n\tvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\tvec4 p \x3d mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n\tvec4 q \x3d mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n\tfloat d \x3d q.x - min(q.w, q.y);\n\tfloat e \x3d 1.0e-10;\n\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"hsv2rgb"\x3e\x3c![CDATA[\nvec3 hsv2rgb(vec3 c)\n{\n\tvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"colorMixMode"\x3e\x3c![CDATA[\n$rgb2hsv\n$hsv2rgb\n\n\n/*\n * The color mix modes are encoded in the symbol color as follows:\n *  - Fully transparent symbols are represented with alpha 0 for\n *    all color mix modes (except ignore).\n *  - color mix mode ignore is encoded as multiply with white\n *  - the other 3 color mix modes (tint, replace, multiply) are\n *    equally distributed on the remaining 255 alpha values, which\n *    gives us 85 possible alpha values\n *\n * alpha             0 : fully transparent\n * alpha in [  1 -  85]: tint\n * alpha in [ 86 - 170]: replace\n * alpha in [171 - 255]: multiply\n */\nvec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n  float symbolAlpha \x3d 0.0;\n\n  const float maxTint \x3d 85.0;\n  const float maxReplace \x3d 170.0;\n  const float scaleAlpha \x3d 3.0;\n\n  if (symbolColor.a \x3d\x3d 0.0) {\n    colorMixMode \x3d 1; // fully transparent -\x3e multiply\n    symbolAlpha \x3d 0.0;\n  }\n  else if (symbolColor.a \x3c\x3d maxTint) {\n    colorMixMode \x3d 0; // tint\n    symbolAlpha \x3d scaleAlpha * symbolColor.a;\n  }\n  else if (symbolColor.a \x3c\x3d maxReplace) {\n    colorMixMode \x3d 3; // replace\n    symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxTint);\n  }\n  else {\n    colorMixMode \x3d 1;  // multiply\n    symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxReplace);\n  }\n\n  return vec4(symbolColor.rgb, symbolAlpha);\n}\n\nvec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\n\n  // workaround for artifacts in OSX using Intel Iris Pro\n  // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n  vec3 internalMixed \x3d internalColor * textureColor;\n  vec3 allMixed \x3d internalMixed * externalColor;\n\n  if (mode \x3d\x3d 1 /* multiply */) {\n    return allMixed;\n  }\n  else if (mode \x3d\x3d 2 /* ignore */ ) {\n    return internalMixed;\n  }\n  else if (mode \x3d\x3d 3 /* replace */ ) {\n    return externalColor;\n  }\n  else {\n    // tint (or something invalid)\n    vec3 hsvIn \x3d rgb2hsv(internalMixed);\n    vec3 hsvTint \x3d rgb2hsv(externalColor);\n    vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, hsvIn.z * hsvTint.z);\n    return hsv2rgb(hsvOut);\n  }\n}\n\nfloat mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\n\n  // workaround for artifacts in OSX using Intel Iris Pro\n  // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n  float internalMixed \x3d internalOpacity * textureOpacity;\n  float allMixed \x3d internalMixed * externalOpacity;\n\n  if (mode \x3d\x3d 2 /* ignore */ ) {\n    return internalMixed;\n  }\n  else if (mode \x3d\x3d 3 /* replace */ ) {\n    return externalOpacity;\n  }\n  else {\n    // multiply or tint (or something invalid)\n    return allMixed;\n  }\n}\n\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"highlightWrite"\x3e\x3c![CDATA[\n  // the following uniforms are common to all highlight shaders:\n  // uniform sampler2D depthTex\n  // uniform vec4 highlightViewportPixelSz\n  float sceneDepth \x3d texture2D(depthTex, (gl_FragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n  if (gl_FragCoord.z \x3e sceneDepth + 5e-6) {\n    gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n  }\n  else {\n    gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"screenSizePerspective"\x3e\x3c![CDATA[\n#ifdef SCREEN_SIZE_PERSPECTIVE\n\n// Note that the implementation here should be kept in sync with the corresponding\n// CPU implementation (used for hitTest etc) in screenSizePerspectiveUtils.ts\n\n/**\n * Compute the screen size perspective lower bound from pre-computed screen\n * size perspective factors (or parameters, since both store the pixel lower\n * bound information in the same place). When computing the minimum size,\n * the padding (e.g. text halo) is scaled with the same factor as the\n * original size scales to reach the minimum size.\n *\n * {\n *    x: N/A\n *    y: N/A\n *    z: minPixelSize (abs),\n *    w: sizePaddingInPixels (abs)\n * }\n */\nfloat screenSizePerspectiveMinSize(float size, vec4 factor) {\n\n  // Original calculation:\n  //   padding \x3d 2 * factor.w\n  //   minSize \x3d factor.z\n  //\n  //   minSize + minSize / size * padding\n  //\n  // Incorporates padding (factor.w, e.g. text halo size) into the\n  // minimum bounds calculation, taking into account that padding\n  // would scale down proportionally to the size.\n  //\n  // Calculation below is the same, but avoids division by zero when\n  // size would be zero, without branching using step.\n  // https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10683\n\n  // nonZeroSize is 1 if size \x3e 0, and 0 otherwise\n  float nonZeroSize \x3d 1.0 - step(size, 0.0);\n\n  return (\n    factor.z * (\n      1.0 +\n      nonZeroSize *                // Multiply by nzs ensures if size is 0, then we ignore\n                                   // proportionally scaled padding\n      2.0 * factor.w / (\n        size + (1.0 - nonZeroSize) // Adding 1 - nzs ensures we divide either by size, or by 1\n      )\n    )\n  );\n}\n\n/**\n * Computes the view angle dependent screen size perspective factor. The goal\n * of this factor is that:\n *\n *   1. There is no perspective when looking top-down\n *   2. There is a smooth and quick transition to full perspective when\n *      tilting.\n */\nfloat screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {\n  return absCosAngle * absCosAngle * absCosAngle;\n}\n\n/**\n * Precomputes a set of factors that can be used to apply screen size perspective\n * The factors are based on the viewing angle, distance to camera and the screen size\n * perspective parameters:\n * {\n *    x: distanceDivisor,\n *    y: distanceOffset,\n *    z: minPixelSize (abs),\n *    w: sizePaddingInPixels (abs)\n * }\n *\n * The result is a set of factors that can be used to apply the perspective:\n *\n * {\n *    x: distance based relative scale factor (0 -\x3e 1)\n *    y: view dependent scale factor\n *    z: minPixelSize (abs)\n *    w: sizePaddingInPixels (abs)\n * }\n */\nvec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {\n  return vec4(min(params.x / (distanceToCamera - params.y), 1.0), screenSizePerspectiveViewAngleDependentFactor(absCosAngle), params.z, params.w);\n}\n\n/**\n * Applies screen size perspective factors to a single dimension size, given the viewing angle,\n * distance to camera and perspective parameters. The factors can be calculated from the screen size\n * perspective parameters using screenSizePerspectiveScaleFactorFloat.\n *\n * Note that for single scale application, the screenSizePerspectiveScaleFloat can be used, which\n * will call this method, providing it the factors calculated from screenSizePerspectiveScaleFactorFloat.\n */\n\nfloat applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {\n  return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));\n}\n\n/**\n * Applies screen size perspective parameters to a single dimension size, given the viewing angle,\n * distance to camera and perspective parameters\n * {\n *    x: distanceDivisor,\n *    y: distanceOffset,\n *    z: minPixelSize (abs),\n *    w: sizePaddingInPixels (abs)\n * }\n */\nfloat screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {\n  return applyScreenSizePerspectiveScaleFactorFloat(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n}\n\n/**\n * Applies screen size perspective factors to a vec2 size (width/height), given the viewing angle,\n * distance to camera and perspective parameters. The factors can be calculated from the screen size\n * perspective parameters using screenSizePerspectiveScaleFactorVec2.\n *\n * Note that for single scale application, the screenSizePerspectiveScaleVec2 can be used, which\n * will call this method, providing it the factors calculated from screenSizePerspectiveScaleFactorVec2.\n */\nvec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {\n  return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);\n}\n\n/**\n * Applies screen size perspective parameters to a vec2 size (width/height), given the viewing angle,\n * distance to camera and perspective parameters\n * {\n *    x: distanceDivisor,\n *    y: distanceOffset,\n *    z: minPixelSize (abs),\n *    w: sizePaddingInPixels (abs)\n * }\n */\nvec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {\n  return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n}\n\n#endif\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"computeNormal"\x3e\x3c![CDATA[\n\t#ifdef GROUND_NORMAL_SHADING\n\t\t#ifdef VIEWING_MODE_GLOBAL\n\t\t\tvec3 normal \x3d normalize(vpos + localOrigin);\n\t\t#else\n\t\t\tvec3 normal \x3d vec3(0,0,1);\n\t\t#endif\n\t#else\n\t\t\t// compute normal\n\t\t#ifndef DOUBLESIDED\n\t\t\t\tvec3 normal \x3d vnormal;\n\t\t#else\n\t\t\t\tvec3 normal \x3d dot(vnormal, viewDir)\x3e0.0 ? -vnormal : vnormal;\n\t\t#endif\n\t\tnormal \x3d normalize(normal);\n\t#endif\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/internal/hud.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"commonAttributesAndUniformsHUD"\x3e\x3c![CDATA[\n  attribute vec3 $position;\n  attribute vec3 $normal;\n  attribute vec4 $auxpos1;\n\n  uniform mat4 proj;\n\n  uniform mat4 view;\n  uniform mat4 viewNormal;\n\n  uniform mat4 model;\n  uniform mat4 modelNormal;\n\n  uniform vec4 viewport;\n\n  uniform vec3 camPos;\n\n  uniform float polygonOffset;\n  uniform float cameraGroundRelative;\n\n#ifdef VERTICAL_OFFSET\n\n  // [ screenLength, distanceFactor, minWorldLength, maxWorldLength ]\n  uniform vec4 verticalOffset;\n\n#endif\n\n#ifdef SCREEN_SIZE_PERSPECTIVE\n\n  // [ divisor, offset, minPixelSize, paddingPixels ]\n  uniform vec4 screenSizePerspectiveAlignment;\n\n#endif\n\n  uniform sampler2D hudVisibilityTexture;\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"projectPositionHUD"\x3e\x3c![CDATA[\n  $screenSizePerspective\n\n  // Corresponds to cos(10 deg), used to compare against dot product of two vectors\n  const float SMALL_OFFSET_ANGLE \x3d 0.984807753012208;\n\n  struct ProjectHUDAux {\n    vec3 posModel;\n    vec3 posView;\n    vec3 vnormal;\n\n    float distanceToCamera;\n    float absCosAngle;\n  };\n\n\n  /**\n   * Apply the simulated polygon offset for HUD objects that improves\n   * issues with Z-fighting.\n   *\n   * @param posView {vec3} (inout) the position in view space. Will be modified in place.\n   * @param pointGroundDistance {float} the distance from the point geometry to the ground surface.\n   * @param absCosAngle {float} the absolute cosine of the angle between the world-up at the point geometry\n   *   and the view direction.\n   *\n   * Dependencies:\n   *\n   *   Attributes:\n   *     - auxpos1: contains centerOffset and pointGroundDistance\n   *\n   *   Uniforms:\n   *     - cameraGroundRelative: indicates whether camera is above (1) or below (-1) ground.\n   *         This is used for emulated polygon offset for improved visibility of points sitting on the surface.\n   *     - polygonOffset: a constant polygon offset to bring the point closer to the viewer for\n   *         reduced flickering.\n   *     - viewport: the viewport [x, y, width, height]\n   */\n  float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {\n    float pointGroundSign \x3d sign(pointGroundDistance);\n\n    if (pointGroundSign \x3d\x3d 0.0) {\n      pointGroundSign \x3d 1.0;\n    }\n\n    // cameraGroundRelative is -1 if camera is below ground, 1 if above ground\n    // groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise\n    float groundRelative \x3d cameraGroundRelative * pointGroundSign;\n\n    // view angle dependent part of polygon offset emulation\n    // we take the absolute value because the sign that is dropped is\n    // instead introduced using the ground-relative position of the symbol and the camera\n    if (polygonOffset \x3e .0) {\n      float cosAlpha \x3d clamp(absCosAngle, 0.01, 1.0);\n\n      float tanAlpha \x3d sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;\n      float factor \x3d (1.0 - tanAlpha / viewport[2]);\n\n      // same side of the terrain\n      if (groundRelative \x3e 0.0) {\n        posView *\x3d factor;\n      }\n      // opposite sides of the terrain\n      else {\n        posView /\x3d factor;\n      }\n    }\n\n    return groundRelative;\n  }\n\n  /**\n   * Project the 3d position of a HUD object from world space to clip space. In addition\n   * to standard model view projection, it also emulates a polygon offset to\n   * help with points above/below ground and icon flickering. The resulting location\n   * is the anchor of the HUD object, i.e. the position that is used also for testing\n   * visibility of the HUD object. Note that the returned projected position is not\n   * aligned to a pixel center or border, it is up to the caller to align if necessary.\n   *\n   * Dependencies:\n   *\n   *   Attributes:\n   *     - position: contains the point world position\n   *     - normal: contains the world normal pointing up at the point\n   *     - auxpos1: contains centerOffset and pointGroundDistance\n   *\n   *   Uniforms:\n   *     - model: the object -\x3e world transformation matrix\n   *     - modelNormal: the object -\x3e world normal transformation matrix (inv transp of model)\n   *     - view: the world -\x3e view transformation matrix\n   *     - viewNormal: the world -\x3e view normal transformation matrix (inv transp of view)\n   *     - proj: the view -\x3e clip projection matrix\n   *     - verticalOffset: a vec4 containing:\n   *         - the screen height of the vertical offset\n   *         - the screen height of the vertical offset as a fraction of camera distance.\n   *         - the minimum world size vertical offset.\n   *         - the maximum world size vertical offset.\n   *       This will do a screen sized offset of the point along its normal (used for line callouts)\n   *     - screenSizePerspectiveAlignment: a vec3 containing\n   *         - the view distance dependent divisor\n   *         - the view distance dependent offset\n   *         - the minimum pixel size\n   *         - the amount of padding in pixels around the region to be scaled (not used for alignment)\n   *     - cameraGroundRelative: indicates whether camera is above (1) or below (-1) ground.\n   *         This is used for emulated polygon offset for improved visibility of points sitting on the surface.\n   *     - polygonOffset: a constant polygon offset to bring the point closer to the viewer for\n   *         reduced flickering.\n   *     - camPos: the position of the camera in world space\n   *     - viewport: the viewport [x, y, width, height]\n   */\n  vec4 projectPositionHUD(out ProjectHUDAux aux) {\n    // centerOffset is in view space and is used to implement world size offsetting\n    // of labels with respect to objects. It also pulls the label towards the viewer\n    // so that the label is visible in front of the object.\n    vec3 centerOffset \x3d $auxpos1.xyz;\n\n    // The pointGroundDistance is the distance of the geometry to the ground and is\n    // negative if the point is below the ground, or positive if the point is above\n    // ground.\n    float pointGroundDistance \x3d $auxpos1.w;\n\n    aux.posModel \x3d (model * vec4($position, 1.0)).xyz;\n    aux.posView \x3d (view * vec4(aux.posModel, 1.0)).xyz;\n    aux.vnormal \x3d (modelNormal * vec4($normal, 1.0)).xyz;\n\n    // Screen sized offset in world space, used for example for line callouts\n    // Note: keep this implementation in sync with the CPU implementation, see\n    //   - MaterialUtil.verticalOffsetAtDistance\n    //   - HUDMaterial.applyVerticalOffsetTransformation\n\n    aux.distanceToCamera \x3d length(aux.posView);\n\n    vec3 viewDirObjSpace \x3d normalize(camPos - aux.posModel);\n    float cosAngle \x3d dot(aux.vnormal, viewDirObjSpace);\n\n    aux.absCosAngle \x3d abs(cosAngle);\n\n#ifdef SCREEN_SIZE_PERSPECTIVE\n\n#if defined(VERTICAL_OFFSET) || defined(CENTER_OFFSET_UNITS_SCREEN)\n    vec4 perspectiveFactor \x3d screenSizePerspectiveScaleFactor(aux.absCosAngle, aux.distanceToCamera, screenSizePerspectiveAlignment);\n#endif\n\n#endif\n\n#ifdef VERTICAL_OFFSET\n\n#ifdef SCREEN_SIZE_PERSPECTIVE\n    float verticalOffsetScreenHeight \x3d applyScreenSizePerspectiveScaleFactorFloat(verticalOffset.x, perspectiveFactor);\n#else\n    float verticalOffsetScreenHeight \x3d verticalOffset.x;\n#endif\n\n    float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);\n    vec3 modelOffset \x3d aux.vnormal * worldOffset;\n\n    aux.posModel +\x3d modelOffset;\n\n    vec3 viewOffset \x3d (viewNormal * vec4(modelOffset, 1.0)).xyz;\n    aux.posView +\x3d viewOffset;\n\n    // Since we elevate the object, we need to take that into account\n    // in the distance to ground\n    pointGroundDistance +\x3d worldOffset;\n\n#endif\n\n    float groundRelative \x3d applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);\n\n#ifndef CENTER_OFFSET_UNITS_SCREEN\n    // Apply x/y in view space, but z in screen space (i.e. along posView direction)\n    aux.posView +\x3d vec3(centerOffset.x, centerOffset.y, 0);\n\n    // Same material all have same z !\x3d 0.0 condition so should not lead to\n    // branch fragmentation and will save a normalization if it\'s not needed\n    if (centerOffset.z !\x3d 0.0) {\n      aux.posView -\x3d normalize(aux.posView) * centerOffset.z;\n    }\n#endif\n\n    vec4 posProj \x3d proj * vec4(aux.posView, 1.0);\n\n#ifdef CENTER_OFFSET_UNITS_SCREEN\n\n#ifdef SCREEN_SIZE_PERSPECTIVE\n    float centerOffsetY \x3d applyScreenSizePerspectiveScaleFactorFloat(centerOffset.y, perspectiveFactor);\n#else\n    float centerOffsetY \x3d centerOffset.y;\n#endif\n\n    posProj.xy +\x3d vec2(centerOffset.x, centerOffsetY) * 2.0 / viewport.zw * posProj.w;\n\n#endif\n\n    // constant part of polygon offset emulation\n    posProj.z -\x3d groundRelative * polygonOffset * posProj.w;\n\n    return posProj;\n  }\n\n  /**\n   * Test for visibility of a HUD object.\n   *\n   * Dependencies:\n   *\n   *   Uniforms:\n   *     - hudVisibilityTexture: the texture that contains the visibility information\n   *     - markerColor: the special marker color that is used to write visibility information\n   *     - viewport: the viewport\n   */\n  bool testVisibilityHUD(vec4 posProj) {\n    // For occlusion testing, use the nearest pixel center to avoid\n    // subpixel filtering messing up the color we use to test for\n    vec4 posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\n\n    return texture2D(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w).r \x3e 0.0;\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/BillboardMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vertexShaderBillboard"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tuniform mat4 view;\n\tuniform mat4 model;\n\tuniform mat4 modelNormal;\n\tattribute vec3 $position;\n\tattribute vec3 $normal;\n\tattribute vec2 $uv0;\n\tvarying vec2 vtc;\n\tvarying vec3 vnormal;\n\tconst float size \x3d 1.05;\n\n\tvoid main(void) {\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\n\t\tvec2 uv01 \x3d floor($uv0);\n\t\tvec2 uv \x3d $uv0 - uv01;\n\t\tvec3 zDir \x3d normalize(-pos);\n\t\tvec3 xDir \x3d normalize(cross(vec3(.0, 1.0, .0), zDir));\n\t\tvec3 yDir \x3d cross(zDir, xDir);\n\t\tpos +\x3d xDir * (uv01.x - .5) * size;\n\t\tpos +\x3d yDir * (uv01.y - .5) * size;\n\t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\n\t\tgl_Position \x3d pos4;\n\t\tvtc \x3d uv;\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal, 1.0)).xyz);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderBillboard"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform vec4 lightAmbient;\n\tuniform vec4 lightDiffuse;\n\tuniform vec3 lightDirection;\n\tuniform sampler2D tex;\n\tvarying vec2 vtc;\n\tvarying vec3 vnormal;\n\n\tvoid main() {\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\n\t\tif (texColor.a \x3c .15) discard;\n\t\tgl_FragColor \x3d texColor;\n\t\tgl_FragColor.rgb *\x3d lightAmbient.rgb * lightAmbient.w + lightDiffuse.rgb * lightDiffuse.w * dot(lightDirection, vnormal);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vertexShaderBillboardDepth"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tuniform mat4 view;\n\tuniform mat4 model;\n\tuniform vec2 nearFar;\n\tattribute vec3 $position;\n\tattribute vec2 $uv0;\n\tvarying vec2 vtc;\n\tvarying float depth;\n\tconst float size \x3d 1.05;\n\n\tvoid main(void) {\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\n\t\tvec2 uv01 \x3d floor($uv0);\n\t\tvec2 uv \x3d $uv0 - uv01;\n\t\tpos.x +\x3d (uv01.x - .5) * size;\n\t\tpos.y +\x3d (uv01.y - .5) * size;\n\t\tvec4 eye \x3d vec4(pos, 1.0);\n\t\tgl_Position \x3d proj * eye;\n\t\tdepth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]);\n\t\tvtc \x3d uv;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/ColorMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vertexShaderColorMaterial"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tuniform mat4 view;\n\tuniform mat4 model;\n\n\tattribute vec3 $position;\n#ifdef VERTEXCOLORS\n\tattribute vec4 $color;\n\n\tvarying vec4 vColor;\n#endif\n\n\tvoid main(void) {\n#ifdef VERTEXCOLORS\n\t\tvColor \x3d $color * 0.003921568627451; // \x3d 1/255;\n#endif\n\t\tgl_Position \x3d proj * view * vec4((model * vec4($position, 1.0)).xyz, 1.0);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderColorMaterial"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform vec4 eColor;\n#ifdef VERTEXCOLORS\n\tvarying vec4 vColor;\n#endif\n\n\tvoid main() {\n#ifdef VERTEXCOLORS\n\t\tgl_FragColor \x3d vColor * eColor;\n#else\n\t\tgl_FragColor \x3d eColor;\n#endif\n\t}\n]]\x3e\x3c/snippet\x3e\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/LineCalloutMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vertexShaderLineCallout"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  $commonAttributesAndUniformsHUD\n\n  attribute vec2 $uv0;\n\n  uniform float lineSize;\n  uniform vec2 pixelToNDC;\n  uniform float borderSize;\n  uniform vec2 screenOffset;\n\n  varying vec4 coverageSampling;\n  varying vec2 lineSizes;\n\n  $alignToPixelOrigin\n  $alignToPixelCenter\n\n  $projectPositionHUD\n\n  void main(void) {\n    ProjectHUDAux projectAux;\n    vec4 endPoint \x3d projectPositionHUD(projectAux);\n\n#ifdef OCCL_TEST\n    if (!testVisibilityHUD(endPoint)) {\n      gl_Position \x3d vec4(1e38, 1e38, 1e38, 1);\n    }\n    else {\n#endif\n\n#ifdef SCREEN_SIZE_PERSPECTIVE\n      vec4 perspectiveFactor \x3d screenSizePerspectiveScaleFactor(projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);\n      vec2 screenOffsetScaled \x3d applyScreenSizePerspectiveScaleFactorVec2(screenOffset, perspectiveFactor);\n#else\n      vec2 screenOffsetScaled \x3d screenOffset;\n#endif\n\n      // Add view dependent polygon offset to get exact same original starting point. This is mostly\n      // used to get the correct depth value\n      vec3 posView \x3d (view * model * vec4($position, 1.0)).xyz;\n      applyHUDViewDependentPolygonOffset($auxpos1.w, projectAux.absCosAngle, posView);\n\n      vec4 startPoint \x3d proj * vec4(posView, 1);\n\n      // Apply screen offset to both start and end point\n      vec2 screenOffsetNorm \x3d screenOffsetScaled * 2.0 / viewport.zw;\n\n      startPoint.xy +\x3d screenOffsetNorm * startPoint.w;\n      endPoint.xy +\x3d screenOffsetNorm * endPoint.w;\n\n      // Align start and end to pixel origin\n      vec4 startAligned \x3d alignToPixelOrigin(startPoint, viewport.zw);\n      vec4 endAligned \x3d alignToPixelOrigin(endPoint, viewport.zw);\n\n#ifdef DEPTH_HUD\n\n#ifdef DEPTH_HUD_ALIGN_START\n      endAligned \x3d vec4(endAligned.xy / endAligned.w * startAligned.w, startAligned.zw);\n#else\n      startAligned \x3d vec4(startAligned.xy / startAligned.w * endAligned.w, endAligned.zw);\n#endif\n\n#endif\n\n      vec4 projectedPosition \x3d mix(startAligned, endAligned, $uv0.y);\n\n      // The direction of the line in screen space\n      vec2 screenSpaceDirection \x3d normalize(endAligned.xy / endAligned.w - startAligned.xy / startAligned.w);\n      vec2 perpendicularScreenSpaceDirection \x3d vec2(screenSpaceDirection.y, -screenSpaceDirection.x);\n\n#ifdef SCREEN_SIZE_PERSPECTIVE\n\n      float lineSizeScaled \x3d applyScreenSizePerspectiveScaleFactorFloat(lineSize, perspectiveFactor);\n      float borderSizeScaled \x3d applyScreenSizePerspectiveScaleFactorFloat(borderSize, perspectiveFactor);\n\n#else\n\n      float lineSizeScaled \x3d lineSize;\n      float borderSizeScaled \x3d borderSize;\n\n#endif\n\n      float halfPixelSize \x3d lineSizeScaled * 0.5;\n\n      // Calculate a pixel offset from the edge of the pixel, s.t. we keep the line aligned\n      // to pixels if it has a full pixel size. Since pixel aligned biases to the bottom-left,\n      // we bias the size to the right (for odd sizes) to balance out the bias. Grow sub-pixel\n      // sizes towards the left or right s.t. there is a smooth transition (e.g. from 2 to 3 px).\n      float halfWholePixelSize \x3d floor(lineSizeScaled) * 0.5;\n      float halfPixelSizeInt \x3d floor(halfWholePixelSize);\n\n      // Sub-pixel offset if we need to grow sub-pixels to the left\n      float subpixelOffset \x3d -fract(lineSizeScaled) * float(halfWholePixelSize \x3e 0.0);\n\n      // Pixel offset aligning to whole pixels and adding subpixel offset if needed\n      float pixelOffset \x3d -halfPixelSizeInt + subpixelOffset;\n\n      // Compute full ndc offset, adding 1px padding for doing anti-aliasing and the border size\n      float padding \x3d 1.0 + borderSizeScaled;\n      vec2 ndcOffset \x3d (pixelOffset - padding + $uv0 * (lineSizeScaled + padding + padding)) * pixelToNDC;\n\n      // Offset x/y from the center of the line in screen space\n      projectedPosition.xy +\x3d perpendicularScreenSpaceDirection * ndcOffset * projectedPosition.w;\n\n      // Compute a coverage varying which we can use in the fragment shader to determine\n      // how much a pixel is actually covered by the line (i.e. to anti alias the line).\n      // This works by computing two coordinates that can be linearly interpolated and then\n      // subtracted to find out how far away from the line edge we are.\n      float edgeDirection \x3d ($uv0.x * 2.0 - 1.0);\n\n      float halfBorderSize \x3d 0.5 * borderSizeScaled;\n      float halfPixelSizeAndBorder \x3d halfPixelSize + halfBorderSize;\n      float outerEdgeCoverageSampler \x3d edgeDirection * (halfPixelSizeAndBorder + halfBorderSize + 1.0);\n\n      float isOneSided \x3d float(lineSizeScaled \x3c 2.0 \x26\x26 borderSize \x3c 2.0);\n\n      coverageSampling \x3d vec4(\n        // Edge coordinate\n        outerEdgeCoverageSampler,\n\n        // Border edge coordinate\n        outerEdgeCoverageSampler - halfPixelSizeAndBorder * isOneSided,\n\n        // Line offset\n        halfPixelSize - 0.5,\n\n        // Border offset\n        halfBorderSize - 0.5 + halfPixelSizeAndBorder * (1.0 - isOneSided)\n      );\n\n      lineSizes \x3d vec2(lineSizeScaled, borderSizeScaled);\n\n      gl_Position \x3d projectedPosition;\n\n#ifdef OCCL_TEST\n    }\n#endif\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet\x3e\x3c![CDATA[\n\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderLineCallout"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n  uniform vec4 color;\n  uniform vec4 borderColor;\n\n  varying vec4 coverageSampling;\n  varying vec2 lineSizes;\n\n  void main() {\n    // Mix between line and border coverage offsets depending on whether we need\n    // a border (based on the sidedness).\n    vec2 coverage \x3d min(1.0 - clamp(abs(coverageSampling.xy) - coverageSampling.zw, 0.0, 1.0), lineSizes);\n\n    // Mix between border and line color based on the line coverage (conceptually the line\n    // blends on top of the border background).\n    //\n    // Anti-alias by blending final result using the full (including optional border) coverage\n    // and the color alpha\n    float borderAlpha \x3d color.a * borderColor.a * coverage.y;\n    float colorAlpha \x3d color.a * coverage.x;\n\n    float finalAlpha \x3d mix(borderAlpha, 1.0, colorAlpha);\n\n#ifdef DEPTH_HUD\n\n    if (finalAlpha \x3c 0.01) {\n      discard;\n    }\n\n#else\n\n    // Compute the finalRgb, but keep it pre-multiplied (for unpre-multiplied you\n    // need to divide by finalAlpha). We avoid the division here by setting the\n    // appropriate blending function in the material.\n    vec3 finalRgb \x3d mix(borderColor.rgb * borderAlpha, color.rgb, colorAlpha);\n\n    gl_FragColor \x3d vec4(finalRgb, finalAlpha);\n\n#endif\n\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/LeafCardMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vertexShaderLeafCard"\x3e\n\t\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tuniform mat4 view;\n\tuniform mat4 model;\n\tuniform mat4 modelNormal;\n\n\tuniform vec3 localOrigin;\n\n\tattribute vec3 $position;\n\tattribute vec4 $normal;\n\tattribute vec4 $uv0;\n\tvarying vec2 vtc;\n\tvarying vec3 vnormal;\n\tvarying float ambientLeaf;\n\n\tuniform float trafoScale;\n\tvarying vec3 vpos;\n\n\tvec2 rotate(vec2 pos, float angle) {\n\t\tfloat c \x3d cos(angle);\n\t\tfloat s \x3d sin(angle);\n\t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\n\t}\n\n\tvoid main(void) {\n\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\n\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\n\t\tvec2 uv01 \x3d floor($uv0.xy);\n\t\tvec2 uv \x3d $uv0.xy - uv01;\n\n   \t\tvec2 up \x3d rotate(vec2(1,0), $uv0.z);\n   \t\tvec3 xDir \x3d  vec3(up.x,up.y,0.0);\n   \t\tvec3 yDir \x3d  vec3(-up.y,up.x,0.0);\n\n\t\tpos +\x3d xDir * (uv01.x - .5) * $uv0.w *trafoScale;\n\t\tpos +\x3d yDir * (uv01.y - .5) * $uv0.w *trafoScale;;\n\t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\n\t\tgl_Position \x3d pos4;\n\t\tvtc \x3d uv;\n\t\tambientLeaf \x3d normal.w;\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal.xyz, 1.0)).xyz);\n\t}\n]]\x3e\n\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderLeafCard"\x3e\n\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform vec3 camPos;\n\n\tuniform vec3 diffuse;\n\n\tuniform vec3 localOrigin;\n\n\tuniform sampler2D tex;\n\tvarying vec2 vtc;\n\tvarying vec3 vnormal;\n\tvarying float ambientLeaf;\n\n\tvarying vec3 vpos;\n\n\t$sceneLightingDefinitions\n\n\tvoid main() {\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\n\t\tif (texColor.a \x3c .33) discard;\n\n\t\tvec3 normal \x3d normalize(vnormal);\n\t\tvec3 albedo \x3d diffuse * ambientLeaf * texColor.rgb;\n\n\t\tfloat ssao \x3d 1.0;\n\n\t\t$sceneLightingAdditionalLightGlobal\n\n\t\tvec3 color \x3d evaluateSceneLighting(normal, albedo, 1.0, 1.0 - ssao, additionalLight);\n\n\t\tgl_FragColor \x3d vec4(color, texColor.a);\n\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\n\x3csnippet name\x3d"vertexShaderLeafCardDepth"\x3e\x3c![CDATA[\n    $vsprecisionf\n\n   \tuniform mat4 proj;\n   \tuniform mat4 view;\n   \tuniform mat4 model;\n   \tuniform vec2 nearFar;\n\n   \tattribute vec3 $position;\n   \tattribute vec4 $uv0;\n\n   \tuniform float trafoScale;\n\n   \tvarying vec2 vtc;\n   \tvarying float depth;\n\n   \tvec2 rotate(vec2 pos, float angle) {\n   \t\tfloat c \x3d cos(angle);\n   \t\tfloat s \x3d sin(angle);\n   \t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\n   \t}\n\n   \tvoid main(void) {\n   \t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\n   \t\tvec2 uv01 \x3d floor($uv0.xy);\n   \t\tvec2 uv \x3d $uv0.xy - uv01;\n\n   \t\tvec2 up \x3d rotate(vec2(1,0), $uv0.z);\n   \t\tvec3 xDir \x3d  vec3(up.x,up.y,0.0);\n   \t\tvec3 yDir \x3d  vec3(-up.y,up.x,0.0);\n\n   \t\tpos +\x3d xDir * (uv01.x - .5) * $uv0.w*trafoScale;\n   \t\tpos +\x3d yDir * (uv01.y - .5) * $uv0.w*trafoScale;\n   \t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\n   \t\tgl_Position \x3d pos4;\n   \t\tvtc \x3d uv;\n\n   \t\tdepth \x3d (-pos.z - nearFar[0]) / (nearFar[1] - nearFar[0]);\n\n   \t}\n ]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/Material.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"calculateVerticalOffset"\x3e\x3c![CDATA[\n  $viewingMode\n\n#ifdef VERTICAL_OFFSET\n  // [ verticalOffsetPerDistance, minWorldLength, maxWorldLength ]\n  uniform vec4 verticalOffset;\n\n#ifdef SCREEN_SIZE_PERSPECTIVE\n\n  uniform vec4 screenSizePerspectiveAlignment;\n\n  $screenSizePerspective\n\n#endif\n\n  vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n    float viewDistance \x3d length((view * vec4(worldPos, 1)).xyz);\n    float verticalOffsetOffsetDistance \x3d verticalOffset.x * viewDistance;\n\n#ifdef VIEWING_MODE_GLOBAL\n    vec3 worldNormal \x3d normalize(worldPos + localOrigin);\n#else\n    vec3 worldNormal \x3d vec3(0, 0, 1);\n#endif\n\n#ifdef SCREEN_SIZE_PERSPECTIVE\n    float cosAngle \x3d dot(worldNormal, normalize(worldPos - camPos));\n\n    float verticalOffsetScreenHeight \x3d screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);\n#else\n    float verticalOffsetScreenHeight \x3d verticalOffset.x;\n#endif\n\n    // Screen sized offset in world space, used for example for line callouts\n    float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n\n    return worldNormal * worldOffset;\n  }\n#endif\n]]\x3e\n\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsPhongSrc"\x3e\x3c![CDATA[\n\tuniform mat4 proj;\n\tuniform mat4 view;\n  uniform vec3 camPos;\n\n\tuniform vec3 localOrigin;\n\n#ifdef INSTANCED\n    attribute mat4 model;\n    attribute mat4 modelNormal;\n#else\n\tuniform mat4 model;\n\tuniform mat4 modelNormal;\n#endif\n#ifdef INSTANCEDCOLOR\n\tattribute vec4 instanceColor;\n#endif\n\tattribute vec3 $position;\n\tattribute vec3 $normal;\n\tvarying vec3 vpos;\n\tvarying vec3 vnormal;\n\n#ifdef RECEIVE_SHADOWS\n\tvarying float linearDepth;\n#endif\n\n#ifdef VERTEXCOLORS\n\tattribute vec4 $color;\n#endif\n\n#ifdef SYMBOLVERTEXCOLORS\n  attribute vec4 $symbolColor;\n#endif\n\n#if defined(VV_SIZE) || defined(VV_COLOR)\n\tattribute vec4 instanceFeatureAttribute;\n#endif\n\n$vvUniforms\n\n#if defined(VERTEXCOLORS)\n\tvarying vec4 vcolor;\n#endif\n\n#if defined(INSTANCEDCOLOR) || defined(VV_COLOR) || defined(SYMBOLVERTEXCOLORS)\n\tuniform vec4 externalColor;\n\tvarying vec4 vcolorExt;\n#endif\n\n#if defined(SYMBOLVERTEXCOLORS)\n\tvarying mediump float colorMixMode; // varying int is not supported in WebGL\n#endif\n\n\t$vvFunctions\n\n\t$colorMixMode\n\n  $calculateVerticalOffset\n\n\tvoid main(void) {\n\n#ifdef VV_CUSTOM_MODEL_MATRIX\n\n\t\tvpos \x3d (model * vvTransformPosition($position, instanceFeatureAttribute)).xyz;\n\t\tvnormal \x3d normalize((modelNormal * vvTransformNormal($normal, instanceFeatureAttribute)).xyz);\n\n#ifdef VERTICAL_OFFSET\n\t\tvec3 centerPos \x3d (model * vvTransformPosition(vec3(0, 0, 0), instanceFeatureAttribute)).xyz;\n#endif\n\n#else /* VV_CUSTOM_MODEL_MATRIX */\n\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal, 1.0)).xyz);\n\n#ifdef VERTICAL_OFFSET\n\t\tvec3 centerPos \x3d (model * vec4(vec3(0, 0, 0), 1.0)).xyz;\n#endif\n\n#endif /* VV_CUSTOM_MODEL_MATRIX */\n\n#ifdef VERTICAL_OFFSET\n    vpos +\x3d calculateVerticalOffset(centerPos, localOrigin);\n#endif\n\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1.0);\n\n#ifdef RECEIVE_SHADOWS\n\t\t// Shadowmap\'s cascading index used to be based on \'1.0 / gl_FragCoord.w\'\n\t\t// (i.e. the perspective interpolation of \'gl_Position.w\'). Precision\n\t\t// issues on iPad/iPhone with the \'w\' component require the depth to be\n\t\t// passed as varying to properly drive the cascading shadow map index.\n\t\tlinearDepth \x3d gl_Position.w;\n#endif\n\n#ifdef VERTEXCOLORS\n\t\tvcolor \x3d $color * 0.003921568627451; // \x3d 1/255\n#endif\n\n#if defined(INSTANCEDCOLOR) || defined(VV_COLOR) || defined(SYMBOLVERTEXCOLORS)\n\t\tvcolorExt \x3d externalColor;\n#endif\n#ifdef INSTANCEDCOLOR\n\t\tvcolorExt *\x3d instanceColor;\n#endif\n#ifdef VV_COLOR\n\t\tvcolorExt *\x3d vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n#endif\n#ifdef SYMBOLVERTEXCOLORS\n    int symbolColorMixMode;\n    vcolorExt *\x3d decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451; // \x3d 1/255;\n    colorMixMode \x3d float(symbolColorMixMode) + 0.5; // add 0.5 to avoid interpolation artifacts\n#endif\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsPhongSrc"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n\tuniform vec3 camPos;\n\tuniform vec3 localOrigin;\n\n\t$sceneLightingDefinitions\n\n\t// material parameters\n\t//////////////////////////////////////////\n\tuniform vec3 ambient;\n\tuniform vec3 diffuse;\n\tuniform vec3 specular;\n\tuniform float shininess;\n\tuniform float opacity;\n\tuniform float layerOpacity;\n\n#ifdef SYMBOLVERTEXCOLORS\n\tvarying mediump float colorMixMode; // varying int is not supported in WebGL\n#else\n  uniform int colorMixMode;\n#endif\n\n#ifdef RECEIVE_SHADOWS\n\tuniform sampler2D depthTex;\n\tuniform int shadowMapNum;\n\tuniform vec4 shadowMapDistance;\n\tuniform mat4 shadowMapMatrix[4];\n\tuniform float depthHalfPixelSz;\n#endif\n\n#ifdef RECEIVE_SSAO\n\tuniform sampler2D ssaoTex;\n\tuniform vec4 viewportPixelSz;\n#endif\n\n\n\tvarying vec3 vpos;\n\tvarying vec3 vnormal;\n#if defined(VERTEXCOLORS)\n\tvarying vec4 vcolor;\n#endif\n#if defined(INSTANCEDCOLOR) || defined(VV_COLOR) || defined(SYMBOLVERTEXCOLORS)\n\tvarying vec4 vcolorExt;\n#else\n\tuniform vec4 externalColor;\n#endif\n\n#ifdef RECEIVE_SHADOWS\n\tvarying float linearDepth;\n\t$evalShadow\n#endif\n\n\t$colorMixMode\n\n\tvoid main() {\n\t\tvec3 viewDir \x3d normalize(vpos - camPos);\n\n\t\t$computeNormal\n\n\t\tvec3 reflDir \x3d normalize(reflect(viewDir, normal));\n\n\t\t// compute ssao\n\t\t#ifdef RECEIVE_SSAO\n\t\t\t\tfloat ssao \x3d texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n\t\t\t\tssao \x3d viewportPixelSz.z \x3c 0.0 ? 1.0 : ssao;\n\t\t#else\n\t\t\t\tfloat ssao \x3d 1.0;\n\t\t#endif\n\n\t\t// At global scale we create some additional ambient light based on the main light to simulate global illumination\n\t\t// This also defines "additionalAmbientScale" which might be used as a shadow fallback further down\n\t\t$sceneLightingAdditionalLightGlobal\n\n\t\t// compute shadowing\n\t\tfloat shadow \x3d 0.0;\n\t\t#ifdef RECEIVE_SHADOWS\n\t\t\tshadow \x3d evalShadow(vpos, linearDepth, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\n\t\t#elif defined(VIEWING_MODE_GLOBAL)\n\t\t\t// at global scale (and in global scenes) we fall back to this approximation\n\t\t\t// to shadow objects on the dark side of the earth\n\t\t\tshadow \x3d lightingGlobalFactor * (1.0 - additionalAmbientScale);\n\t\t#endif\n\n\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"externalColorMix"\x3e\x3c![CDATA[\n\tvec3 matColor \x3d max(ambient, diffuse); // combine the old material parameters into a single one\n\t#if defined(VERTEXCOLORS) \x26\x26 (defined(INSTANCEDCOLOR) || defined(VV_COLOR) || defined(SYMBOLVERTEXCOLORS))\n\t\t\t// Internal colors: varying vcolor + uniform ambient/diffuse, external colors: varying vcolorExt\n\t\t\tvec3 albedo_ \x3d mixExternalColor(vcolor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n\t\t\tfloat opacity_ \x3d layerOpacity * mixExternalOpacity(vcolor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n\t#elif defined(VERTEXCOLORS)\n\t\t\t// Internal colors: varying vcolor + uniform ambient/diffuse, external colors: uniform externalColor\n\t\t\tvec3 albedo_ \x3d mixExternalColor(vcolor.rgb * matColor, texColor.rgb, externalColor.rgb, int(colorMixMode));\n\t\t\tfloat opacity_ \x3d layerOpacity * mixExternalOpacity(vcolor.a * opacity, texColor.a, externalColor.a, int(colorMixMode));\n\t#elif defined(INSTANCEDCOLOR) || defined(VV_COLOR) || defined(SYMBOLVERTEXCOLORS)\n\t\t\t// Internal colors: uniform ambient/diffuse, external colors: varying vcolorExt\n\t\t\tvec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n\t\t\tfloat opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n\t#else\n\t\t\t// Internal colors: uniform ambient/diffuse, external colors: uniform externalColor\n\t\t\tvec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, externalColor.rgb, int(colorMixMode));\n\t\t\tfloat opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, externalColor.a, int(colorMixMode));\n\t#endif\n\talbedo_+\x3d 0.25 * specular; // don\'t completely ignore specular for now\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsPhong"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\t$vsPhongSrc\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsPhong"\x3e\x3c![CDATA[\n\t\t$fsprecisionf\n\n\t\t$fsPhongSrc\n\n\t\tvec4 texColor \x3d vec4(1,1,1,1);\n\t\t$externalColorMix\n\n\t\tvec3 shadedColor \x3d evaluateSceneLighting(normal, albedo_, shadow, 1.0 - ssao, additionalLight);\n\t\tgl_FragColor \x3d vec4(shadedColor, opacity_);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsPhongTextured"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tattribute vec2 $uv0;\n\tvarying vec2 vtc;\n\t$vsPhongSrc\n#ifndef FLIPV\n\t\tvtc \x3d $uv0;\n#else\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\n#endif\n\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsPhongTextured"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform sampler2D tex;\n\tvarying vec2 vtc;\n\n\t$fsPhongSrc\n\n\t\t// read texture color\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\n\t\tif (texColor.a \x3c .33) discard;\n\n\t\t$externalColorMix\n\n\t\tvec3 shadedColor \x3d evaluateSceneLighting(normal, albedo_, shadow, 1.0 - ssao, additionalLight);\n\n\t\tgl_FragColor \x3d vec4(shadedColor, opacity_);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsPhongAtlasTextured"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tattribute vec4 $uv0;\n\tattribute vec4 $region;\n\tvarying vec2 vtc;\n\tvarying vec4 regionV;\n\t$vsPhongSrc\n#ifndef FLIPV\n\t\tvtc \x3d $uv0.xy;\n#else\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\n#endif\n\t\tregionV \x3d $region/65535.0;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsPhongAtlasTextured"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform sampler2D tex;\n\tuniform vec2 texSize;\n\tvarying vec2 vtc;\n\tvarying vec4 regionV;\n\n\tfloat calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\n\t\t// from:\n\t\t//   - OpenGLES Common Profile Specification Version 2.0.25, Section 3.7.7 - Texture Minification\n\t\t//   - https://www.opengl.org/discussion_boards/showthread.php/171485-Texture-LOD-calculation-(useful-for-atlasing)\n\t\t//   - http://www.linedef.com/virtual-texture-demo.html\n\t\tfloat deltaMaxSqr \x3d max(dot(ddx, ddx), dot(ddy, ddy));\n\t\treturn max(0.5 * log2(deltaMaxSqr), 0.0);\n\t}\n\n\t$fsPhongSrc\n\n\t\tvec2 uv \x3d vtc;\n\t\tuv \x3d fract(uv);\n\t\t//[umin, vmin, umax, vmax]\n\n\t\tvec2 atlasScale \x3d regionV.zw - regionV.xy;\n\t\tuv \x3d uv.xy * atlasScale + regionV.xy;\n\n\t\tvec4 texColor;\n\t\t#ifdef GL_OES_standard_derivatives\n\t\t\t#extension GL_OES_standard_derivatives : enable\n\n\t\t\t// calculate derivative of continuous texture coordinate\n\t\t\t// to avoid mipmapping artifacts caused by manual wrapping in shader\n\t\t\tvec2 dUVdx \x3d dFdx(vtc) * atlasScale;\n\t\t\tvec2 dUVdy \x3d dFdy(vtc) * atlasScale;\n\n\t\t\t#ifdef GL_EXT_shader_texture_lod\n\t\t\t\t#extension GL_EXT_shader_texture_lod : enable\n\n\t\t\t\t// workaround for artifacts in Windows 10 using Intel HD Graphics 4000 series\n\t\t\t\t// see: https://devtopia.esri.com/Zurich-R-D-Center/arcgis-js-api-canvas3d-issues/issues/768\n\t\t\t\tconst float epsilon \x3d 1.0E-32;\n\t\t\t\tfloat zeroUVShift \x3d uv.x \x3d\x3d 0.0 \x26\x26 uv.y \x3d\x3d 0.0 ? epsilon : 0.0;\n\n\t\t\t\ttexColor \x3d texture2DGradEXT(tex, uv + zeroUVShift, dUVdx, dUVdy);\n\t\t\t#else\n\t\t\t\t// use bias to compensate for difference in automatic vs desired mipmap level\n\t\t\t\tvec2 dUVdxAuto \x3d dFdx(uv);\n\t\t\t\tvec2 dUVdyAuto \x3d dFdy(uv);\n\t\t\t\tfloat mipMapLevel \x3d calcMipMapLevel(dUVdx * texSize, dUVdy * texSize);\n\t\t\t\tfloat autoMipMapLevel \x3d calcMipMapLevel(dUVdxAuto * texSize, dUVdyAuto * texSize);\n\t\t\t\ttexColor \x3d texture2D(tex, uv, mipMapLevel - autoMipMapLevel);\n\t\t\t#endif\n\t\t#else\n\t\t\ttexColor \x3d texture2D(tex, uv);\n\t\t#endif\n\n\t\tif (texColor.a \x3c .33) discard;\n\n\t\t$externalColorMix\n\n\t\tvec3 shadedColor \x3d evaluateSceneLighting(normal, albedo_, shadow, 1.0 - ssao, additionalLight);\n\t\tgl_FragColor \x3d vec4(shadedColor, opacity_);\n\t}\n\t]]\x3e\x3c/snippet\x3e\n\n\t\x3csnippet name\x3d"fsPhongTexturedRefl"\x3e\x3c![CDATA[\n\t\t$fsprecisionf\n\n\t\tuniform sampler2D tex;\n\t\tuniform sampler2D reflTex;\n\t\tuniform float reflectivity;\n\t\tvarying vec2 vtc;\n\n\t\t$normal2envTC\n\n\t\t$fsPhongSrc\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\n\t\tif (texColor.a \x3c .33) discard;\n\t\tvec4 reflColor \x3d texture2D(reflTex, normal2envTC(reflDir));\n\n\t\t$externalColorMix\n\n\t\tvec3 shadedColor \x3d evaluateSceneLighting(normal, albedo_, shadow, 1.0 - ssao, additionalLight);\n\t\tshadedColor.rgb \x3d mix(shadedColor.rgb, reflColor.rgb, reflectivity);\n\n\t\tgl_FragColor \x3d vec4(shadedColor, opacity_);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsDepthSrc"\x3e\x3c![CDATA[\n\tuniform mat4 proj;\n\tuniform mat4 view;\n  uniform vec3 camPos;\n  uniform vec3 localOrigin;\n\n#ifdef INSTANCED\n\tattribute mat4 model;\n  attribute mat4 modelNormal;\n#else\n\tuniform mat4 model;\n  uniform mat4 modelNormal;\n#endif\n\tuniform vec2 nearFar;\n\tattribute vec3 $position;\n\tvarying float depth;\n\n\t$vvUniforms\n#if defined(VV_CUSTOM_MODEL_MATRIX)\n\tattribute vec4 instanceFeatureAttribute;\n#endif\n\t$vvFunctions\n\n  $calculateVerticalOffset\n\n\tvoid main(void) {\n\n#ifdef VV_CUSTOM_MODEL_MATRIX\n\n    vec3 vpos \x3d (model * vvTransformPosition($position, instanceFeatureAttribute)).xyz;\n\n#ifdef VERTICAL_OFFSET\n    vec3 centerPos \x3d (model * vvTransformPosition(vec3(0, 0, 0), instanceFeatureAttribute)).xyz;\n#endif\n\n#else /* VV_CUSTOM_MODEL_MATRIX */\n\n\t\tvec3 vpos \x3d (model * vec4($position, 1.0)).xyz;\n\n#ifdef VERTICAL_OFFSET\n\t\tvec3 centerPos \x3d (model * vec4(vec3(0, 0, 0), 1.0)).xyz;\n#endif\n\n#endif /* VV_CUSTOM_MODEL_MATRIX */\n\n#ifdef VERTICAL_OFFSET\n    vpos +\x3d calculateVerticalOffset(centerPos, localOrigin);\n#endif\n\n    vec4 eye \x3d view * vec4(vpos, 1);\n\n\t\tgl_Position \x3d proj * eye;\n\t\tdepth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsDepth"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\t$vsDepthSrc\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsDepthTextured"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tattribute vec2 $uv0;\n\tvarying vec2 vtc;\n\t$vsDepthSrc\n#ifndef FLIPV\n        vtc \x3d $uv0;\n#else\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\n#endif\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsNormalSrc"\x3e\x3c![CDATA[\n\tuniform mat4 proj;\n\tuniform mat4 view;\n  uniform vec3 camPos;\n  uniform vec3 localOrigin;\n\n#ifdef INSTANCED\n\tattribute mat4 model;\n\tattribute mat4 modelNormal;\n#else\n\tuniform mat4 model;\n\tuniform mat4 modelNormal;\n#endif\n\tuniform mat4 viewNormal;\n\tattribute vec3 $position;\n\tattribute vec3 $normal;\n\tvarying vec3 vnormal;\n\n\t$vvUniforms\n#if defined(VV_CUSTOM_MODEL_MATRIX)\n\tattribute vec4 instanceFeatureAttribute;\n#endif\n\t$vvFunctions\n\n  $calculateVerticalOffset\n\n\tvoid main(void) {\n\n#ifdef VV_CUSTOM_MODEL_MATRIX\n\n    vec3 vpos \x3d (model * vvTransformPosition($position, instanceFeatureAttribute)).xyz;\n\t\tvnormal \x3d normalize((viewNormal * modelNormal * vvTransformNormal($normal, instanceFeatureAttribute)).xyz);\n\n#ifdef VERTICAL_OFFSET\n    vec3 centerPos \x3d (model * vvTransformPosition(vec3(0, 0, 0), instanceFeatureAttribute)).xyz;\n#endif\n\n#else /* VV_CUSTOM_MODEL_MATRIX */\n\t\tvec3 vpos \x3d (model * vec4($position, 1.0)).xyz;\n\t\tvnormal \x3d normalize((viewNormal * modelNormal * vec4($normal, 1.0)).xyz);\n\n#ifdef VERTICAL_OFFSET\n    vec3 centerPos \x3d (model * vec4(vec3(0, 0, 0), 1.0)).xyz;\n#endif\n\n#endif /* VV_CUSTOM_MODEL_MATRIX */\n\n#ifdef VERTICAL_OFFSET\n    vpos +\x3d calculateVerticalOffset(centerPos, localOrigin);\n#endif\n\n    gl_Position \x3d proj * view * vec4(vpos, 1);\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsNormal"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\t$vsNormalSrc\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsNormalTextured"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tattribute vec2 $uv0;\n\tvarying vec2 vtc;\n\t$vsNormalSrc\n#ifndef FLIPV\n\t\tvtc \x3d $uv0;\n#else\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\n#endif\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsHighlightSrc"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tuniform mat4 view;\n  uniform vec3 camPos;\n  uniform vec3 localOrigin;\n\n#ifdef INSTANCED\n\tattribute mat4 model;\n  attribute mat4 modelNormal;\n#else\n\tuniform mat4 model;\n  uniform mat4 modelNormal;\n#endif\n\tattribute vec3 $position;\n\n\t$vvUniforms\n#if defined(VV_CUSTOM_MODEL_MATRIX)\n\tattribute vec4 instanceFeatureAttribute;\n#endif\n\t$vvFunctions\n\n  $calculateVerticalOffset\n\n\tvoid main(void) {\n\n#ifdef VV_CUSTOM_MODEL_MATRIX\n\n    vec3 vpos \x3d (model * vvTransformPosition($position, instanceFeatureAttribute)).xyz;\n\n#ifdef VERTICAL_OFFSET\n    vec3 centerPos \x3d (model * vvTransformPosition(vec3(0, 0, 0), instanceFeatureAttribute)).xyz;\n#endif\n\n#else /* VV_CUSTOM_MODEL_MATRIX */\n\n    vec3 vpos \x3d (model * vec4($position, 1.0)).xyz;\n\n#ifdef VERTICAL_OFFSET\n    vec3 centerPos \x3d (model * vec4(vec3(0, 0, 0), 1.0)).xyz;\n#endif\n\n#endif /* VV_CUSTOM_MODEL_MATRIX */\n\n#ifdef VERTICAL_OFFSET\n    vpos +\x3d calculateVerticalOffset(centerPos, localOrigin);\n#endif\n\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1);\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsHighlight"\x3e\x3c![CDATA[\n\t$vsHighlightSrc\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsHighlightTextured"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tattribute vec2 $uv0;\n\tvarying vec2 vtc;\n\t$vsHighlightSrc\n#ifndef FLIPV\n\t\tvtc \x3d $uv0;\n#else\n\t\tvtc \x3d vec2($uv0.x, 1.0-$uv0.y);\n#endif\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsDepthSrc"\x3e\x3c![CDATA[\n  $fsprecisionf\n\tvarying float depth;\n\n\tvoid main() {\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsDepth"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\t$calcFragDepth\n\t$float2rgba\n\t$fsDepthSrc\n#ifndef BIAS_SHADOWMAP\n\t\tgl_FragColor \x3d float2rgba(depth);\n#else\n\t\tgl_FragColor \x3d float2rgba(calcFragDepth(depth));\n#endif\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsDepthTextured"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform sampler2D tex;\n\tvarying vec2 vtc;\n\t$calcFragDepth\n\t$float2rgba\n\n\t$fsDepthSrc\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\n#ifndef BIAS_SHADOWMAP\n\t\tgl_FragColor \x3d float2rgba(depth);\n#else\n\t\tgl_FragColor \x3d float2rgba(calcFragDepth(depth));\n#endif\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsNormal"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tvarying vec3 vnormal;\n\tvoid main() {\n\t\tvec3 normal \x3d normalize(vnormal);\n\t\tif (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;\n\n#ifndef ALPHA_ZERO\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 1.0);\n#else\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 0.0);\n#endif\n\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsNormalTextured"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tvarying vec3 vnormal;\n\tvarying vec2 vtc;\n\tuniform sampler2D tex;\n\tvoid main() {\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\n\t\tvec3 normal \x3d normalize(vnormal);\n\t\tif (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;\n#ifndef ALPHA_ZERO\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 1.0);\n#else\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 0.0);\n#endif\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsHighlight"\x3e\x3c![CDATA[\n\t$fsprecisionf\n  uniform sampler2D depthTex;\n  uniform vec4 highlightViewportPixelSz;\n\n\tvoid main() {\n\t\t$highlightWrite\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsHighlightTextured"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tvarying vec2 vtc;\n\tuniform sampler2D tex;\n  uniform sampler2D depthTex;\n  uniform vec4 highlightViewportPixelSz;\n\n\tvoid main() {\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\n\n\t\t$highlightWrite\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/RibbonLineMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vsRibbonLine"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tuniform mat4 view;\n\tuniform mat4 model;\n\n\tuniform float extLineWidth;\n\tuniform float nearPlane;\n\n\tattribute vec3 $position;\n\tattribute vec2 $uv0;\n\tvarying vec2 vtc;\n\n\tattribute vec4 $color;\n\tvarying vec4 vColor;\n\n\tattribute float size;\n\n#ifndef WALL\n\tuniform float miterLimit;\n\tattribute vec3 $auxpos1;\n\tattribute vec3 $auxpos2;\n#endif\n\n#ifdef SCREENSCALE\n\tuniform vec2 screenSize;\n\t$toScreenCoords\n#define VECTYPE vec2\n#define ZEROVEC vec2(0.0, 0.0)\n#define PERPENDICULAR(v) vec2(v.y, -v.x);\n#define ISOUTSIDE (left.x * right.y - left.y * right.x)*$uv0.y \x3e 0.0\n\n#else //ifdef SCREENSCALE\n\n#define VECTYPE vec3\n#define ZEROVEC vec3(0.0, 0.0, 0.0)\n// these macros are only valid for "strip" type lines:\n#define PERPENDICULAR(v) cross(up/*vec3(0.0, 1.0, 0.0)*/, v)\n#define ISOUTSIDE dot(cross(left, right), up/*vec3(0.0, 1.0, 0.0)*/)*$uv0.y \x3c 0.0\n\n#endif //ifdef SCREENSCALE\n\n\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t}\n\n#ifdef SCREENSCALE\n\n  void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next) {\n\t\tfloat vnp \x3d nearPlane*0.99;\n\n\t\t//We have four vertices per point on the line. Start and end vertices\n\t\t//are treated differently --\x3e d \x3e 0, d \x3c 0\n\t\tfloat d \x3d abs($uv0.y) - 1.1;\n\n\t\t//current pos behind ncp --\x3e we need to clip\n\t\tif(pos.z \x3e -nearPlane) {\n\t\t\tif (d \x3c 0.0) {\n\t\t\t\t//previous in front of ncp\n\t\t\t\tif(prev.z \x3c -nearPlane) {\n\t\t\t\t\tpos \x3d mix(prev, pos, interp(vnp, prev, pos));\n\t\t\t\t\tnext \x3d pos;\n\t\t\t\t} else {\n\t\t\t\t  pos \x3d vec4(0, 0, 0, 1);\n\t\t\t  }\n\t\t\t}\n\t\t\t//next in front of ncp\n\t\t\tif(d \x3e 0.0) {\n\t\t\t\tif(next.z \x3c -nearPlane) {\n\t\t\t\t\tpos \x3d mix(pos, next, interp(vnp, pos, next));\n\t\t\t\t\tprev \x3d pos;\n\t\t\t\t} else {\n\t\t\t\t\tpos \x3d vec4(0, 0, 0, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\telse {\n\t\t\t//current position visible\n\t\t\t//previous behind ncp\n\t\t\tif (prev.z \x3e -nearPlane) {\n\t\t\t\tprev \x3d mix(pos, prev, interp(vnp, pos, prev));\n\t\t\t}\n\t\t\t//next behind ncp\n\t\t\tif (next.z \x3e -nearPlane) {\n\t\t\t\tnext \x3d mix(next, pos, interp(vnp, next, pos));\n\t\t\t}\n\t\t}\n\n\t\tpos\x3d proj * pos;\n\t\tpos.xy *\x3d screenSize;\n\t\tpos /\x3d pos.w;\n\n\t\tnext \x3d proj * next;\n\t\tnext.xy *\x3d screenSize;\n\t\tnext /\x3d next.w;\n\n\t\tprev \x3d proj * prev;\n\t\tprev.xy *\x3d screenSize;\n\t\tprev /\x3d prev.w;\n  }\n\n#endif // SCREENSCALE\n\n\tvoid main(void) {\n\n\tfloat lineWidth \x3d extLineWidth + $size;\n\n#ifdef SCREENSCALE\n\n#if 0\n\t\tvec4 pos \x3d toScreenCoords($position.xyz);\n\t\tvec2 left \x3d (pos - toScreenCoords($auxpos1)).xy;\n\t\tvec2 right \x3d (toScreenCoords($auxpos2) - pos).xy;\n#else\n\t\tvec4 pos  \x3d view * vec4((model * vec4($position.xyz, 1.0)).xyz, 1.0);\n\t\tvec4 prev \x3d view * vec4((model * vec4($auxpos1.xyz, 1.0)).xyz, 1.0);\n\t\tvec4 next \x3d view * vec4((model * vec4($auxpos2.xyz, 1.0)).xyz, 1.0);\n\n\t\tclipAndTransform(pos, prev, next);\n\n\t\tvec2 left \x3d (pos - prev).xy;\n\t\tvec2 right \x3d (next - pos).xy;\n#endif\n\n#else // ifdef SCREENSCALE\n\t\tvec4 pos \x3d vec4($position, 1.0);\n#ifndef WALL\n\t\tvec3 left \x3d $position.xyz - $auxpos1;\n\t\tvec3 right \x3d $auxpos2 - $position.xyz;\n\t\tvec3 up \x3d normalize($position.xyz);\n#endif // ifndef WALL\n#endif // ifdef SCREENSCALE\n\n#ifdef WALL\n\t\tfloat displacementLen \x3d lineWidth;\n\t\tvec3 displacementDir \x3d normalize($position.xyz);//vec3(0.0, 1.0, 0.0);\n#else // ifdef WALL\n\n\t\tfloat leftLen \x3d length(left);\n\t\tleft \x3d (leftLen \x3e 0.001) ? left/leftLen : ZEROVEC;\n\n\t\tfloat rightLen \x3d length(right);\n\t\tright \x3d (rightLen \x3e 0.001) ? right/rightLen : ZEROVEC;\n\n\t\t// determine if vertex is on the "outside or "inside" of the join\n\t\tbool isOutside \x3d ISOUTSIDE;\n\n\t\t// compute miter join position first\n\t\tfloat displacementLen \x3d lineWidth;\n\t\tVECTYPE displacementDir \x3d normalize(left + right);\n\t\tdisplacementDir \x3d PERPENDICULAR(displacementDir);\n\t\tif (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\n\t\t\tfloat nDotSeg \x3d dot(displacementDir, left);\n\t\t\tdisplacementLen /\x3d length(nDotSeg*left - displacementDir);\n\n\t\t\t// limit displacement of inner vertices\n\t\t\tif (!isOutside)\n\t\t\t\tdisplacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n\t\t}\n\n\t\tif (isOutside \x26\x26 (displacementLen \x3e miterLimit*lineWidth)) {\n\t\t\t// convert to bevel join if miterLimit is exceeded\n\t\t\tif (leftLen \x3c 0.001)\n\t\t\t    displacementDir \x3d right;\n\t\t\telse if (rightLen \x3c 0.001)\n\t\t\t\tdisplacementDir \x3d left;\n\t\t\telse\n\t\t\t\tdisplacementDir \x3d (abs($uv0.y) - 1.1 \x3c 0.0) ? left : right;\n\t\t\tdisplacementDir \x3d normalize(displacementDir);\n\t\t\tdisplacementDir \x3d PERPENDICULAR(displacementDir);\n\t\t\tdisplacementLen \x3d lineWidth;\n\t\t}\n\n#endif // ifdef WALL\n\n#ifdef SCREENSCALE\n\t\tpos.xy +\x3d displacementDir * floor($uv0.y + 0.5) * displacementLen;\n\t\tpos.xy /\x3d screenSize;\n#else\n\t\tpos.xyz +\x3d displacementDir * floor($uv0.y + 0.5) * displacementLen;\n\t\tpos \x3d proj * view * model * pos;\n#endif\n\n\t\tvtc \x3d $uv0;\n\t\tvColor \x3d $color * 0.003921568627451; // \x3d 1/255\n\t\tgl_Position \x3d pos;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\n\x3csnippet name\x3d"fsRibbonLine"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n\tuniform vec4 eColor;\n\tvarying vec4 vColor;\n\tvarying vec2 vtc;\n\n#ifdef STIPPLE\n  uniform float stippleLengthDoubleInv;\n#endif\n\n\tvoid main() {\n\n#ifdef STIPPLE\n    if (fract(vtc.x * stippleLengthDoubleInv) \x3e 0.5) {\n      discard;\n    }\n#endif\n\n    gl_FragColor \x3d eColor * vColor;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsRibbonLineHighlight"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n#ifdef STIPPLE\n  uniform float stippleLengthDoubleInv;\n#endif\n\n\tvoid main() {\n#ifdef STIPPLE\n    if (fract(vtc.x * stippleLengthDoubleInv) \x3e 0.5) {\n      discard;\n    }\n#endif\n\n\t\tgl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/WaterMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vertexShaderWater"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tuniform mat4 view;\n\tuniform mat4 model;\n\tattribute vec3 $position;\n\tvarying vec3 vpos;\n\tvarying float linearDepth;\n\n\tvoid main(void) {\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1.0);\n\t\tlinearDepth \x3d gl_Position.w;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderWater"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform vec3 color;\n\tuniform float scale;\n\tuniform float speed;\n\n\tuniform vec4 lightAmbient;\n\tuniform vec4 lightDiffuse;\n\tuniform vec4 lightSpecular;\n\tuniform vec3 lightDirection;\n\n\tuniform vec3 camPos;\n\n\tuniform sampler2D noiseTex;\n\tuniform sampler2D reflTex;\n\n\tuniform sampler2D depthTex;\n\tuniform int shadowMapNum;\n\tuniform vec4 shadowMapDistance;\n\tuniform mat4 shadowMapMatrix[4];\n\tuniform float depthHalfPixelSz;\n\n\tvarying vec3 vpos;\n\tvarying float linearDepth;\n\n\t$evalShadow\n\n\t$normal2envTC\n\n\tvec2 rotate(vec2 pos, float angle) {\n\t\tfloat c \x3d cos(angle);\n\t\tfloat s \x3d sin(angle);\n\t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\n\t}\n\n\tfloat compDelta(vec2 pos) {\n\t\tconst float PI_THIRD \x3d 1.04719755;\n\n\t\tfloat result \x3d .0;\n\t\tfloat s \x3d 1.0;\n\t\tfor (int i \x3d 0; i \x3c 6; ++i) {\n\t\t\tvec2 tc \x3d pos / (20.0 * s);\n\t\t\ttc +\x3d rotate(vec2(1.0 + speed, .0), PI_THIRD * float(i));\n\t\t\tresult +\x3d s * texture2D(noiseTex, tc).r;\n\t\t\ts *\x3d 1.5;\n\t\t}\n\t\treturn result * scale * .2;\n\t}\n\n\tvoid main() {\n\t\tvec3 viewVec \x3d normalize(camPos - vpos);\n\n\t\tfloat d0 \x3d compDelta(vpos.xz);\n\t\tfloat dx \x3d compDelta(vpos.xz + vec2(.05, .0));\n\t\tfloat dz \x3d compDelta(vpos.xz + vec2(.0, .05));\n\n\t\tvec3 normal \x3d normalize(vec3(d0 - dx, .05, d0 - dz));\n\n\t\tfloat fresnel \x3d clamp(1.0 - 1.25 * dot(viewVec, normal), .0, 1.0);\n\n\t\tfloat shadow \x3d 0.0;\n\t\tif (halfPxSz \x3e\x3d .0) {\n\t\t\tshadow \x3d evalShadow(vpos, linearDepth, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\n\t\t}\n\n\t\tvec3 reflDir \x3d reflect(-viewVec, normal);\n\t\tif (reflDir.y \x3c .02) reflDir.y \x3d 0.04 - reflDir.y;\n\n\t\tvec3 reflCol \x3d texture2D(reflTex, normal2envTC(reflDir)).rgb * lightAmbient.rgb*lightSpecular.w;\n\t\treflCol *\x3d .5 + max(lightDirection.y, .0) * .5; // ?\t+\n\t\tvec3 waterColor \x3d color * (lightAmbient.rgb * lightAmbient.w + (1.0 - shadow) * max(lightDirection.y, .0) * lightDiffuse.rgb * lightDiffuse.w);\n\t\tvec3 finalColor \x3d mix(waterColor, reflCol, .15 + .6 * fresnel);\n\n\t\tvec3 spec \x3d pow(max(dot(reflDir, lightDirection), .001), 80.0) * lightSpecular.rgb * lightSpecular.w * 2.0;\n\t\tfinalColor +\x3d (1.0 - shadow) * lightDiffuse.w * spec;\n\n\t\tgl_FragColor \x3d vec4(finalColor, 1.0);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/MeasurementArrowMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vsMeasurementArrow"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  uniform mat4 proj;\n  uniform mat4 view;\n  uniform mat4 model;\n\n  uniform float width;\n\n  attribute vec3 $position;\n  attribute vec3 $normal;\n  attribute vec2 $uv0;\n  attribute float $auxpos1;\n\n  varying vec2 vtc;\n  varying float vlength;\n  varying float vradius;\n\n  void main(void) {\n    vec3 bitangent \x3d $normal;\n\n    vtc \x3d $uv0;\n    vlength \x3d $auxpos1;\n    vradius \x3d 0.5 * width;\n\n    vec4 pos \x3d view * vec4((model * vec4($position + vradius * bitangent * $uv0.y, 1.0)).xyz, 1.0);\n    gl_Position \x3d proj * pos;\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsMeasurementArrow"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n  uniform float outlineSize;\n  uniform vec4 outlineColor;\n  uniform float stripeLength;\n  uniform vec4 stripeEvenColor;\n  uniform vec4 stripeOddColor;\n\n  varying vec2 vtc;\n  varying float vlength;\n  varying float vradius;\n\n  #define INV_SQRT2 (1.0 / sqrt(2.0))\n\n  vec4 arrowColor(vec2 tc, float len) {\n    float d \x3d INV_SQRT2 * (tc.x - abs(tc.y));\n    d \x3d min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));\n    d \x3d min(d, 1.0 - abs(tc.y));\n\n    if (d \x3c 0.0) {\n      return vec4(0.0);\n    } else if (d \x3c outlineSize) {\n      return outlineColor;\n    } else {\n      return fract(0.5 / stripeLength * tc.x * vradius) \x3e\x3d 0.5 ? stripeOddColor : stripeEvenColor;\n    }\n  }\n\n  void main(void) {\n    vec2 ntc \x3d vec2(vtc.x / vradius, vtc.y);\n    vec4 color \x3d arrowColor(ntc, vlength / vradius);\n    if (color.a \x3d\x3d 0.0) {\n      discard;\n    }\n    gl_FragColor \x3d color;\n  }\n\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/internal/SimpleGLMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vertexShaderSimple"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tuniform mat4 proj;\n\tuniform mat4 view;\n\tuniform mat4 model;\n\tattribute vec3 $position;\n\n\tvoid main(void) {\n\t\tgl_Position \x3d proj * view * vec4((model * vec4($position, 1.0)).xyz, 1.0);\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderSimple"\x3e\x3c![CDATA[\n\t$fsprecisionf\n\n\tuniform vec4 color;\n\n\tvoid main() {\n\t\tgl_FragColor \x3d color;\n\t}\n]]\x3e\x3c/snippet\x3e\n\x3c/snippets\x3e\n',
"url:esri/views/3d/webgl-engine/materials/internal/BlendLayers.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vertexShaderBlendLayers"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n\tattribute vec3 $position;\n\tattribute vec2 $uv0;\n\n\tuniform float scale;\n\tuniform vec2 offset;\n\n\tvarying vec2 uv;\n\n\tvoid main(void) {\n\t\tgl_Position \x3d vec4($position, 1.0);\n\t\tuv \x3d $uv0 * scale + offset;;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fragmentShaderBlendLayers"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n\tvarying vec2 uv;\n\n\tuniform sampler2D tex;\n\tuniform float opacity;\n\n\tvoid main() {\n\t\tvec4 color \x3d texture2D(tex, uv);\n\n    // Note: output in pre-multiplied alpha for correct alpha compositing\n\t\tgl_FragColor \x3d vec4(color.xyz, 1.0) * color.a * opacity;\n\t}\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"url:esri/views/3d/terrain/TerrainMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\n\x3csnippets\x3e\n\n\x3csnippet name\x3d"vsTerrain"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  uniform mat4 proj;\n  uniform mat4 view;\n  uniform vec3 origin;\n  uniform vec2 texOffset;\n  uniform float texScale;\n  uniform mat4 viewNormal;\n\n  attribute vec3 $position;\n  attribute vec2 $uv0;\n  varying vec2 vtc;\n  varying vec3 vpos;\n  varying vec3 vnormal;\n\n#ifdef RECEIVE_SHADOWS\n  varying float linearDepth;\n#endif\n\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\n  varying vec2 vuv;\n#endif\n\n#ifdef ATMOSPHERE\n  uniform vec3 lightDirection;\n  varying vec3 wpos;\n  varying vec3 wview;\n  varying vec3 wnormal;\n  varying vec3 wlight;\n#endif\n\n#ifdef OVERLAY\n  uniform vec2 overlayTexOffset;\n  uniform vec2 overlayTexScale;\n  varying vec2 vtcOverlay;\n#endif\n\n#ifdef SCREEN_SIZE_PERSPECTIVE /* debug only */\n\n  uniform vec4 screenSizePerspective;\n\n  varying float screenSizeDistanceToCamera;\n  varying float screenSizeCosAngle;\n\n#endif\n\n  void main(void) {\n    vpos \x3d $position;\n\n#ifdef SPHERICAL\n    vnormal \x3d normalize(vpos + origin);\n#else\n    vnormal \x3d vec3(0, 0, 1); // WARNING: up-axis dependent code\n#endif\n\n#ifdef ATMOSPHERE\n    wpos \x3d (view * vec4(vpos, 1.0)).xyz;\n    wnormal \x3d (viewNormal * vec4(normalize(vpos+origin), 1.0)).xyz;\n    wlight \x3d (view  * vec4(lightDirection, 1.0)).xyz;\n#endif\n\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\n    vuv \x3d $uv0;\n#endif\n\n#ifdef SCREEN_SIZE_PERSPECTIVE /* debug only */\n\n    vec3 viewPos \x3d (view * vec4(vpos, 1.0)).xyz;\n\n    screenSizeDistanceToCamera \x3d length(viewPos);\n\n    vec3 viewSpaceNormal \x3d (viewNormal * vec4(normalize(vpos + origin), 1.0)).xyz;\n    screenSizeCosAngle \x3d abs(viewSpaceNormal.z);\n\n#endif\n\n    gl_Position \x3d proj * view * vec4(vpos, 1.0);\n\n#ifdef RECEIVE_SHADOWS\n    // Shadowmap\'s cascading index used to be based on \'1.0 / gl_FragCoord.w\'\n    // (i.e. the perspective interpolation of \'gl_Position.w\'). Precision\n    // issues on iPad/iPhone with the \'w\' component require the depth to be\n    // passed as varying to properly drive the cascading shadow map index.\n    linearDepth \x3d gl_Position.w;\n#endif\n\n    vtc \x3d $uv0*texScale + texOffset;\n\n#ifdef OVERLAY\n    vtcOverlay \x3d $uv0*overlayTexScale + overlayTexOffset;\n#endif\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsTerrainCommon"\x3e\x3c![CDATA[\n  uniform vec3 lightDirection;\n  uniform vec3 viewDirection;\n  uniform sampler2D depthTex;\n  uniform int shadowMapNum;\n  uniform vec4 shadowMapDistance;\n  uniform mat4 shadowMapMatrix[4];\n  uniform float depthHalfPixelSz;\n  uniform sampler2D ssaoTex;\n  uniform vec4 viewportPixelSz;\n  uniform sampler2D tex;\n  uniform float opacity;\n\n  varying vec3 vpos;\n  varying vec3 vnormal;\n  varying vec2 vtc;\n\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\n  varying vec2 vuv;\n#endif\n\n#ifdef ATMOSPHERE\n  varying vec3 wpos;\n  varying vec3 wview;\n  varying vec3 wnormal;\n  varying vec3 wlight;\n#endif\n\n  $sceneLightingDefinitions\n\n#ifdef SCREEN_SIZE_PERSPECTIVE /* debug only */\n  $screenSizePerspective\n\n  uniform vec4 screenSizePerspective;\n\n  varying float screenSizeDistanceToCamera;\n  varying float screenSizeCosAngle;\n#endif\n\n  const vec3 ambient \x3d vec3(0.2,0.2,0.2);\n  const vec3 diffuse \x3d vec3(0.8,0.8,0.8);\n  const float diffuseHardness \x3d 2.5;\n\n#ifdef OVERLAY\n  uniform sampler2D overlayTex;\n  uniform float overlayOpacity;\n  varying vec2 vtcOverlay;\n#endif\n\n#ifdef RECEIVE_SHADOWS\n\tvarying float linearDepth;\n\t$evalShadow\n#endif\n\n  float lum(vec3 c) {\n    float max \x3d max(max(c.r, c.g), c.b);\n    float min \x3d min(min(c.r, c.g), c.b);\n    return (min + max) * 0.5;\n  }\n\n#ifdef ATMOSPHERE\n  vec3 atmosphere(vec3 lightPos, vec3 normal, vec3 view) {\n    vec3 surfaceColor   \x3d vec3(0.0);\n    vec3 fuzzySpecColor \x3d vec3(1.0);\n    vec3 subColor       \x3d vec3(0.0);\n    float rollOff       \x3d 1.0;\n\n    vec3 Ln \x3d normalize(lightPos);\n    vec3 Nn \x3d normalize(normal);\n    vec3 Hn \x3d normalize(view + Ln);\n\n    float ldn \x3d dot(Ln, Nn);\n    float diffComp \x3d max(0.0, ldn);\n    float vdn \x3d 1.0 - dot(view, Nn);\n    float ndv \x3d dot(view, Ln);\n\n    vec3 diffContrib \x3d surfaceColor * diffComp;\n    float subLamb \x3d max(0.0, smoothstep(-rollOff, 1.0, ldn) - smoothstep(0.0, 1.0, ldn));\n\n    vec3 subContrib \x3d subLamb * subColor;\n    vec3 vecColor \x3d vec3(vdn);\n\n    vec3 diffuseContrib \x3d (subContrib + diffContrib);\n    vec3 specularContrib \x3d (vecColor * fuzzySpecColor);\n\n    return (diffContrib + specularContrib) * rollOff;\n  }\n#endif\n\n  void main() {\n    vec3 a \x3d ambient;\n\n    float shadow \x3d 0.0;\n#ifdef RECEIVE_SHADOWS\n    shadow \x3d evalShadow(vpos, linearDepth, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\n#endif\n    float vndl \x3d dot(normalize(vnormal), lightDirection);\n    float k \x3d smoothstep(0.0, 1.0, clamp(vndl*diffuseHardness, 0.0, 1.0));\n    vec3 d \x3d (1.0 - shadow/1.8) * diffuse * k;\n\n    float ssao \x3d viewportPixelSz.w \x3c .0 ? 1.0 : texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n    vec4 texCol \x3d texture2D(tex, vtc);\n\n#ifdef OVERLAY\n    if ((vtcOverlay.x \x3e 0.0) \x26\x26 (vtcOverlay.y \x3e 0.0) \x26\x26 (vtcOverlay.x \x3c 1.0) \x26\x26 (vtcOverlay.y \x3c 1.0)) {\n      vec4 overlayTexCol \x3d texture2D(overlayTex, vtcOverlay);\n      overlayTexCol *\x3d overlayOpacity;\n      texCol \x3d texCol * (1.0 - overlayTexCol.a) + overlayTexCol; // texCol and overlayTexCol have pre-multiplied alpha\n    }\n#endif\n\n    vec3 atm \x3d vec3(0.0);\n#ifdef ATMOSPHERE\n    float ndotl \x3d max(0.0, min(1.0, vndl));\n    atm \x3d atmosphere(wlight, wnormal, -viewDirection);\n    atm *\x3d max(0.0, min(1.0, (1.0-lum(texCol.rgb)*1.5))); //avoid atmosphere on bright base maps\n    atm *\x3d max(0.0, min(1.0, ndotl*2.0)); // avoid atmosphere on dark side of the globe\n#endif\n\n    vec3 albedo \x3d atm + texCol.rgb;\n    vec3 normal \x3d normalize(vnormal);\n\n    // heuristic shading function used in the old terrain, now used to add ambient lighting\n    float additionalAmbientScale \x3d smoothstep(0.0, 1.0, clamp(vndl*2.5, 0.0, 1.0));\n\t\tvec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n\n    gl_FragColor \x3d vec4(evaluateSceneLighting(normal, albedo, shadow, 1.0 - ssao, additionalLight), texCol.a) * opacity;\n\n#ifdef SCREEN_SIZE_PERSPECTIVE /* debug only */\n    // This is only used for debug rendering the screenSize perspective\n\n    float perspectiveScale \x3d screenSizePerspectiveScaleFloat(1.0, screenSizeCosAngle, screenSizeDistanceToCamera, screenSizePerspective);\n\n    if (perspectiveScale \x3c\x3d 0.25) {\n      gl_FragColor \x3d mix(gl_FragColor, vec4(1, 0, 0, 1), perspectiveScale * 4.0);\n    }\n    else if (perspectiveScale \x3c\x3d 0.5) {\n      gl_FragColor \x3d mix(gl_FragColor, vec4(0, 0, 1, 1), (perspectiveScale - 0.25) * 4.0);\n    }\n    else if (perspectiveScale \x3e\x3d 0.99) {\n      gl_FragColor \x3d mix(gl_FragColor, vec4(0, 1, 0, 1), 0.2);\n    }\n    else {\n      gl_FragColor \x3d mix(gl_FragColor, vec4(1, 0, 1, 1), (perspectiveScale - 0.5) * 2.0);\n    }\n\n#endif\n\n  // closing } is missing here, it\'s in the shaders using this snippet below\n\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsTerrainWireframe"\x3e\x3c![CDATA[\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n  $fsprecisionf\n\n  struct WireframeSettings {\n    float width;\n    float falloff;\n    float subdivision;\n    vec4 color;\n    float wireOpacity;\n    float surfaceOpacity;\n  };\n\n  uniform WireframeSettings wireframe;\n\n    $fsTerrainCommon\n\n    vec2 vuvScaled \x3d vuv * wireframe.subdivision;\n    vec2 vuvMod \x3d fract(vuvScaled);\n\n#ifdef GL_OES_standard_derivatives\n    vec2 dVuv \x3d fwidth(vuvScaled);\n    dVuv \x3d max(vec2(0.00001), dVuv); // workaround against flickering skirts, see #10245\n#else\n    // Something that reasonably works\n    vec2 dVuv \x3d vec2(0.05);\n#endif\n\n    vec2 edgeFactors \x3d smoothstep((wireframe.width - wireframe.falloff) * dVuv,\n                                  wireframe.width * dVuv, min(vuvMod, 1.0 - vuvMod));\n\n    float edgeFactor \x3d 1.0 - min(edgeFactors.x, edgeFactors.y);\n\n#ifdef WIREFRAME\n    gl_FragColor \x3d vec4(mix(gl_FragColor.rgb, wireframe.color.rgb, edgeFactor * wireframe.color.a),\n                        mix(wireframe.surfaceOpacity, wireframe.wireOpacity, edgeFactor));\n#endif\n\n\n#ifdef TILE_BORDERS\n    dVuv \x3d fwidth(vuv);\n    edgeFactors \x3d smoothstep((wireframe.width - wireframe.falloff) * dVuv,\n                              wireframe.width * dVuv, min(vuv, 1.0 - vuv));\n    edgeFactor \x3d 1.0 - min(edgeFactors.x, edgeFactors.y);\n\n    gl_FragColor \x3d mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), edgeFactor);\n#endif\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsTerrain"\x3e\x3c![CDATA[\n    $fsprecisionf\n    $fsTerrainCommon\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsTerrainNormal"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  uniform vec3 origin;\n  uniform mat4 proj;\n  uniform mat4 view;\n  uniform mat4 viewNormal;\n  attribute vec3 $position;\n  varying vec3 vnormal;\n\n  void main(void) {\n#ifdef SPHERICAL\n    vec4 normal \x3d vec4(normalize($position + origin), 1.0);\n#else\n    vec4 normal \x3d vec4(0.0, 1.0, 0.0, 1.0);\n#endif\n\n    gl_Position \x3d proj * view * vec4($position, 1.0);\n    vnormal \x3d normalize((viewNormal * normal).xyz);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsTerrainDepthOnly"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  uniform mat4 proj;\n  uniform mat4 view;\n\n  attribute vec3 $position;\n\n  void main() {\n    gl_Position \x3d proj * view * vec4($position, 1.0);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsTerrainDepthOnly"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n  void main() {\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"vsTerrainHighlight"\x3e\x3c![CDATA[\n  $vsprecisionf\n\n  uniform mat4 proj;\n  uniform mat4 view;\n  uniform vec2 overlayTexScale;\n  uniform vec2 overlayTexOffset;\n\n  attribute vec3 $position;\n  attribute vec2 $uv0;\n\n  varying vec2 vtcOverlay;\n\n  void main() {\n    vtcOverlay \x3d $uv0*overlayTexScale + overlayTexOffset;\n\n    gl_Position \x3d proj * view * vec4($position, 1.0);\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3csnippet name\x3d"fsTerrainHighlight"\x3e\x3c![CDATA[\n  $fsprecisionf\n\n  uniform sampler2D overlayTex;\n\n  uniform sampler2D depthTex;\n  uniform vec4 highlightViewportPixelSz;\n\n  varying vec2 vtcOverlay;\n\n  void main() {\n    vec4 texCol \x3d vec4(0,0,0,0);\n    if ((vtcOverlay.x \x3e 0.0) \x26\x26 (vtcOverlay.y \x3e 0.0) \x26\x26 (vtcOverlay.x \x3c 1.0) \x26\x26 (vtcOverlay.y \x3c 1.0)) {\n      texCol \x3d texture2D(overlayTex, vtcOverlay);\n    }\n\n    if (texCol.a \x3d\x3d 0.0) {\n      // Here we have to write black, instead of discarding the fragment in order to overwrite\n      // the highlights which might have been written by skirts of other tiles.\n      // As a consequence skirts are not visible, but terrain overwrites draped highlights.\n      gl_FragColor \x3d vec4(0,0,0,0);\n      return;\n    }\n\n    $highlightWrite\n  }\n]]\x3e\x3c/snippet\x3e\n\n\x3c/snippets\x3e\n',
"*now":function(m){m(['dojo/i18n!*preload*dojo/nls/dojo*["ar","ca","cs","da","de","el","en-gb","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn"]'])},"*noref":1}});(function(){var m=this.require;m({cache:{}});!m.async&&m(["dojo"]);m.boot&&m.apply(null,m.boot)})();